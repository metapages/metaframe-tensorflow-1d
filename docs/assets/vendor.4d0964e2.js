var Z0,ht,TU,J0,OU,IU,NU,C2={},DU=[],h1e=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Hl(e,t){for(var n in t)e[n]=t[n];return e}function RU(e){var t=e.parentNode;t&&t.removeChild(e)}function ue(e,t,n){var r,i,a,o={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?Z0.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return Q0(e,o,r,i,null)}function Q0(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++TU};return ht.vnode!=null&&ht.vnode(a),a}function p1e(){return{current:null}}function Ii(e){return e.children}function Ds(e,t){this.props=e,this.context=t}function Ug(e,t){if(t==null)return e.__?Ug(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Ug(e):null}function FU(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return FU(e)}}function $N(e){(!e.__d&&(e.__d=!0)&&J0.push(e)&&!k2.__r++||IU!==ht.debounceRendering)&&((IU=ht.debounceRendering)||OU)(k2)}function k2(){for(var e;k2.__r=J0.length;)e=J0.sort(function(t,n){return t.__v.__b-n.__v.__b}),J0=[],e.some(function(t){var n,r,i,a,o,s;t.__d&&(o=(a=(n=t).__v).__e,(s=n.__P)&&(r=[],(i=Hl({},a)).__v=a.__v+1,LN(s,a,i,n.__n,s.ownerSVGElement!==void 0,a.__h!=null?[o]:null,r,o??Ug(a),a.__h),jU(r,a),a.__e!=o&&FU(a)))})}function MU(e,t,n,r,i,a,o,s,u,l){var c,f,d,h,p,g,m,v=r&&r.__k||DU,y=v.length;for(n.__k=[],c=0;c<t.length;c++)if((h=n.__k[c]=(h=t[c])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?Q0(null,h,null,null,h):Array.isArray(h)?Q0(Ii,{children:h},null,null,null):h.__b>0?Q0(h.type,h.props,h.key,null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(d=v[c])===null||d&&h.key==d.key&&h.type===d.type)v[c]=void 0;else for(f=0;f<y;f++){if((d=v[f])&&h.key==d.key&&h.type===d.type){v[f]=void 0;break}d=null}LN(e,h,d=d||C2,i,a,o,s,u,l),p=h.__e,(f=h.ref)&&d.ref!=f&&(m||(m=[]),d.ref&&m.push(d.ref,null,h),m.push(f,h.__c||p,h)),p!=null?(g==null&&(g=p),typeof h.type=="function"&&h.__k!=null&&h.__k===d.__k?h.__d=u=PU(h,u,e):u=$U(e,h,d,v,p,u),l||n.type!=="option"?typeof n.type=="function"&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=Ug(d))}for(n.__e=g,c=y;c--;)v[c]!=null&&(typeof n.type=="function"&&v[c].__e!=null&&v[c].__e==n.__d&&(n.__d=Ug(r,c+1)),WU(v[c],v[c]));if(m)for(c=0;c<m.length;c++)UU(m[c],m[++c],m[++c])}function PU(e,t,n){var r,i;for(r=0;r<e.__k.length;r++)(i=e.__k[r])&&(i.__=e,t=typeof i.type=="function"?PU(i,t,n):$U(n,i,i,e.__k,i.__e,t));return t}function Gl(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){Gl(n,t)}):t.push(e)),t}function $U(e,t,n,r,i,a){var o,s,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break e;e.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function g1e(e,t,n,r,i){var a;for(a in n)a==="children"||a==="key"||a in t||T2(e,a,null,n[a],r);for(a in t)i&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||T2(e,a,t[a],n[a],r)}function LU(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||h1e.test(t)?n:n+"px"}function T2(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||LU(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||LU(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?zU:BU,a):e.removeEventListener(t,a?zU:BU,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch(o){}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function BU(e){this.l[e.type+!1](ht.event?ht.event(e):e)}function zU(e){this.l[e.type+!0](ht.event?ht.event(e):e)}function LN(e,t,n,r,i,a,o,s,u){var l,c,f,d,h,p,g,m,v,y,b,x=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,s=t.__e=n.__e,t.__h=null,a=[s]),(l=ht.__b)&&l(t);try{e:if(typeof x=="function"){if(m=t.props,v=(l=x.contextType)&&r[l.__c],y=l?v?v.props.value:l.__:r,n.__c?g=(c=t.__c=n.__c).__=c.__E:("prototype"in x&&x.prototype.render?t.__c=c=new x(m,y):(t.__c=c=new Ds(m,y),c.constructor=x,c.render=v1e),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,f=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Hl({},c.__s)),Hl(c.__s,x.getDerivedStateFromProps(m,c.__s))),d=c.props,h=c.state,f)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&m!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(m,y),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(m,c.__s,y)===!1||t.__v===n.__v){c.props=m,c.state=c.__s,t.__v!==n.__v&&(c.__d=!1),c.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(w){w&&(w.__=t)}),c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(m,c.__s,y),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,h,p)})}c.context=y,c.props=m,c.state=c.__s,(l=ht.__r)&&l(t),c.__d=!1,c.__v=t,c.__P=e,l=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(r=Hl(Hl({},r),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(p=c.getSnapshotBeforeUpdate(d,h)),b=l!=null&&l.type===Ii&&l.key==null?l.props.children:l,MU(e,Array.isArray(b)?b:[b],t,n,r,i,a,o,s,u),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=m1e(n.__e,t,n,r,i,a,o,u);(l=ht.diffed)&&l(t)}catch(w){t.__v=null,(u||a!=null)&&(t.__e=s,t.__h=!!u,a[a.indexOf(s)]=null),ht.__e(w,t,n)}}function jU(e,t){ht.__c&&ht.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){ht.__e(r,n.__v)}})}function m1e(e,t,n,r,i,a,o,s){var u,l,c,f=n.props,d=t.props,h=t.type,p=0;if(h==="svg"&&(i=!0),a!=null){for(;p<a.length;p++)if((u=a[p])&&(u===e||(h?u.localName==h:u.nodeType==3))){e=u,a[p]=null;break}}if(e==null){if(h===null)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,d.is&&d),a=null,s=!1}if(h===null)f===d||s&&e.data===d||(e.data=d);else{if(a=a&&Z0.call(e.childNodes),l=(f=n.props||C2).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(a!=null)for(f={},p=0;p<e.attributes.length;p++)f[e.attributes[p].name]=e.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(g1e(e,d,f,i,s),c)t.__k=[];else if(p=t.props.children,MU(e,Array.isArray(p)?p:[p],t,n,r,i&&h!=="foreignObject",a,o,a?a[0]:n.__k&&Ug(n,0),s),a!=null)for(p=a.length;p--;)a[p]!=null&&RU(a[p]);s||("value"in d&&(p=d.value)!==void 0&&(p!==e.value||h==="progress"&&!p)&&T2(e,"value",p,f.value,!1),"checked"in d&&(p=d.checked)!==void 0&&p!==e.checked&&T2(e,"checked",p,f.checked,!1))}return e}function UU(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){ht.__e(r,n)}}function WU(e,t,n){var r,i;if(ht.unmount&&ht.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||UU(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ht.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&WU(r[i],t,typeof e.type!="function");n||e.__e==null||RU(e.__e),e.__e=e.__d=void 0}function v1e(e,t,n){return this.constructor(e,n)}function Wg(e,t,n){var r,i,a;ht.__&&ht.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],LN(t,e=(!r&&n||t).__k=ue(Ii,null,[e]),i||C2,C2,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?Z0.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r),jU(a,e)}function VU(e,t){Wg(e,t,VU)}function y1e(e,t,n){var r,i,a,o=Hl({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?Z0.call(arguments,2):n),Q0(e.type,o,r||e.key,i||e.ref,null)}function ha(e,t){var n={__c:t="__cC"+NU++,__:e,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,a;return this.getChildContext||(i=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some($N)},this.sub=function(o){i.push(o);var s=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),s&&s.call(o)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Z0=DU.slice,ht={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(a){e=a}throw e}},TU=0,Ds.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Hl({},this.state),typeof e=="function"&&(e=e(Hl({},n),this.props)),e&&Hl(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),$N(this))},Ds.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),$N(this))},Ds.prototype.render=Ii,J0=[],OU=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,k2.__r=0,NU=0;var Vg,pa,qU,qg=0,BN=[],HU=ht.__b,GU=ht.__r,KU=ht.diffed,XU=ht.__c,YU=ht.unmount;function ey(e,t){ht.__h&&ht.__h(pa,e,qg||t),qg=0;var n=pa.__H||(pa.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function an(e){return qg=1,zN(JU,e)}function zN(e,t,n){var r=ey(Vg++,2);return r.t=e,r.__c||(r.__=[n?n(t):JU(void 0,t),function(i){var a=r.t(r.__[0],i);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=pa),r.__}function qt(e,t){var n=ey(Vg++,3);!ht.__s&&UN(n.__H,t)&&(n.__=e,n.__H=t,pa.__H.__h.push(n))}function lf(e,t){var n=ey(Vg++,4);!ht.__s&&UN(n.__H,t)&&(n.__=e,n.__H=t,pa.__h.push(n))}function Jt(e){return qg=5,gr(function(){return{current:e}},[])}function b1e(e,t,n){qg=6,lf(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function gr(e,t){var n=ey(Vg++,7);return UN(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function st(e,t){return qg=8,gr(function(){return e},t)}function Un(e){var t=pa.context[e.__c],n=ey(Vg++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(pa)),t.props.value):e.__}function x1e(e,t){ht.useDebugValue&&ht.useDebugValue(t?t(e):e)}function w1e(){BN.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(O2),e.__H.__h.forEach(jN),e.__H.__h=[]}catch(t){e.__H.__h=[],ht.__e(t,e.__v)}}),BN=[]}ht.__b=function(e){pa=null,HU&&HU(e)},ht.__r=function(e){GU&&GU(e),Vg=0;var t=(pa=e.__c).__H;t&&(t.__h.forEach(O2),t.__h.forEach(jN),t.__h=[])},ht.diffed=function(e){KU&&KU(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(BN.push(t)!==1&&qU===ht.requestAnimationFrame||((qU=ht.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),ZU&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);ZU&&(r=requestAnimationFrame(i))})(w1e)),pa=void 0},ht.__c=function(e,t){t.some(function(n){try{n.__h.forEach(O2),n.__h=n.__h.filter(function(r){return!r.__||jN(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],ht.__e(r,n.__v)}}),XU&&XU(e,t)},ht.unmount=function(e){YU&&YU(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(O2)}catch(n){ht.__e(n,t.__v)}};var ZU=typeof requestAnimationFrame=="function";function O2(e){var t=pa;typeof e.__c=="function"&&e.__c(),pa=t}function jN(e){var t=pa;e.__c=e.__(),pa=t}function UN(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function JU(e,t){return typeof t=="function"?t(e):t}function QU(e,t){for(var n in t)e[n]=t[n];return e}function WN(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function I2(e){this.props=e}function eW(e,t){function n(i){var a=this.props.ref,o=a==i.ref;return!o&&a&&(a.call?a(null):a.current=null),t?!t(this.props,i)||!o:WN(this.props,i)}function r(i){return this.shouldComponentUpdate=n,ue(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(I2.prototype=new Ds).isPureReactComponent=!0,I2.prototype.shouldComponentUpdate=function(e,t){return WN(this.props,e)||WN(this.state,t)};var tW=ht.__b;ht.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),tW&&tW(e)};var _1e=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Kl(e){function t(n,r){var i=QU({},n);return delete i.ref,e(i,(r=n.ref||r)&&(typeof r!="object"||"current"in r)?r:null)}return t.$$typeof=_1e,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var nW=function(e,t){return e==null?null:Gl(Gl(e).map(t))},N2={map:nW,forEach:nW,count:function(e){return e?Gl(e).length:0},only:function(e){var t=Gl(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Gl},S1e=ht.__e;ht.__e=function(e,t,n){if(e.then){for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}S1e(e,t,n)};var rW=ht.unmount;function D2(){this.__u=0,this.t=null,this.__b=null}function iW(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function E1e(e){var t,n,r;function i(a){if(t||(t=e()).then(function(o){n=o.default||o},function(o){r=o}),r)throw r;if(!n)throw t;return ue(n,a)}return i.displayName="Lazy",i.__f=!0,i}function ty(){this.u=null,this.o=null}ht.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),rW&&rW(e)},(D2.prototype=new Ds).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var i=iW(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__e){var l=r.state.__e;r.__v.__k[0]=function f(d,h,p){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(g){return f(g,h,p)}),d.__c&&d.__c.__P===h&&(d.__e&&p.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=p)),d}(l,l.__c.__P,l.__c.__O)}var c;for(r.setState({__e:r.__b=null});c=r.t.pop();)c.forceUpdate()}},u=t.__h===!0;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},D2.prototype.componentWillUnmount=function(){this.t=[]},D2.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(o,s,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),o.__c.__H=null),(o=QU({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=s),o.__c=null),o.__k=o.__k&&o.__k.map(function(l){return a(l,s,u)})),o}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&ue(Ii,null,e.fallback);return i&&(i.__h=null),[ue(Ii,null,t.__e?null:e.children),i]};var aW=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function A1e(e){return this.getChildContext=function(){return e.context},e.children}function C1e(e){var t=this,n=e.i;t.componentWillUnmount=function(){Wg(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Wg(ue(A1e,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function VN(e,t){return ue(C1e,{__v:e,i:t})}(ty.prototype=new Ds).__e=function(e){var t=this,n=iW(t.__v),r=t.o.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),aW(t,e,r)):i()};n?n(a):a()}},ty.prototype.render=function(e){this.u=null,this.o=new Map;var t=Gl(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},ty.prototype.componentDidUpdate=ty.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){aW(e,n,t)})};var oW=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,k1e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,T1e=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function O1e(e,t,n){return t.__k==null&&(t.textContent=""),Wg(e,t),typeof n=="function"&&n(),e?e.__c:null}function I1e(e,t,n){return VU(e,t),typeof n=="function"&&n(),e?e.__c:null}Ds.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Ds.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var sW=ht.event;function N1e(){}function D1e(){return this.cancelBubble}function R1e(){return this.defaultPrevented}ht.event=function(e){return sW&&(e=sW(e)),e.persist=N1e,e.isPropagationStopped=D1e,e.isDefaultPrevented=R1e,e.nativeEvent=e};var uW,lW={configurable:!0,get:function(){return this.class}},cW=ht.vnode;ht.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){for(var i in r={},n){var a=n[i];i==="value"&&"defaultValue"in n&&a==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&a===!0?a="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!T1e(n.type)?i="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(i)?i=i.toLowerCase():k1e.test(i)?i=i.replace(/[A-Z0-9]/,"-$&").toLowerCase():a===null&&(a=void 0),r[i]=a)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Gl(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=Gl(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),e.props=r}t&&n.class!=n.className&&(lW.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",lW)),e.$$typeof=oW,cW&&cW(e)};var fW=ht.__r;ht.__r=function(e){fW&&fW(e),uW=e.__c};var F1e={ReactCurrentDispatcher:{current:{readContext:function(e){return uW.__n[e.__c].props.value}}}};function M1e(e){return ue.bind(null,e)}function mh(e){return!!e&&e.$$typeof===oW}function cf(e){return mh(e)?y1e.apply(null,arguments):e}function P1e(e){return!!e.__k&&(Wg(null,e),!0)}function $1e(e){return e&&(e.base||e.nodeType===1&&e)||null}var L1e=function(e,t){return e(t)},B1e=function(e,t){return e(t)},zt={useState:an,useReducer:zN,useEffect:qt,useLayoutEffect:lf,useRef:Jt,useImperativeHandle:b1e,useMemo:gr,useCallback:st,useContext:Un,useDebugValue:x1e,version:"17.0.2",Children:N2,render:O1e,hydrate:I1e,unmountComponentAtNode:P1e,createPortal:VN,createElement:ue,createContext:ha,createFactory:M1e,cloneElement:cf,createRef:p1e,Fragment:Ii,isValidElement:mh,findDOMNode:$1e,Component:Ds,PureComponent:I2,memo:eW,forwardRef:Kl,flushSync:B1e,unstable_batchedUpdates:L1e,StrictMode:Ii,Suspense:D2,SuspenseList:ty,lazy:E1e,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:F1e};const qN=(e,t)=>{const[n,r]=an(HN()[1][e]||t);qt(()=>{const a=o=>{const s=HN()[1];r(s[e])};return window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const i=st((a,o)=>{const s=HN()[1];let u=!1;if(s.hasOwnProperty(e)&&a===null||a===void 0?(delete s[e],u=!0):s[e]!==a&&(s[e]=a,u=!0),!u)return[];const l=Object.keys(s);l.sort();const c=l.map((g,m)=>`${g}=${s[g]}`).join("&");let f=window.location.hash.substr(1);const d=f.indexOf("?");let h="";d>-1&&(h=f.substr(0,d));const p=new URL(window.location.href);p.hash=`${h}?${c}`,(o==null?void 0:o.modifyHistory)?window.location.hash=`${h}?${c}`:(window.history.replaceState(null,document.title,`${p.pathname}${p.search}${p.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},[]);return[n,i]},HN=()=>{let e=window.location.hash.substr(1);const t=e.indexOf("?");if(t===-1)return[e,{}];const n=e.substr(0,t);e=e.substr(t+1);const r=Object.fromEntries(e.split("&").filter(i=>i.length>0).map(i=>i.split("=")));return[n,r]},z1e=(e,t)=>{const[n,r]=qN(e,t?`${t}`:void 0),[i,a]=an(n==="true");qt(()=>{a(n==="true")},[e,n,a]);const o=st((s,u)=>{s==null||s===!1?r(void 0,u):r("true",u)},[r]);return[i,o]},j1e=(e,t)=>{const[n,r]=qN(e,t?t.toString():void 0),[i,a]=an(n?parseInt(n):void 0);qt(()=>{a(n?parseInt(n):void 0)},[e,n,a]);const o=st((s,u)=>{r(s?s.toString():void 0,u)},[r]);return[i,o]},dW=(e,t)=>{const[n,r]=qN(e,t?hW(t):void 0),[i,a]=an(pW(n));qt(()=>{a(pW(n))},[e,n,a]);const o=st((s,u)=>{if(s==null)r(void 0,u);else{const l=hW(s);r(l,u)}},[r]);return[i,o]},hW=e=>btoa(JSON.stringify(e)),pW=e=>{if(e&&e.length>0)try{return JSON.parse(atob(e))}catch(t){console.error(t)}};var Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function vh(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}function ff(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var U1e={},W1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:U1e}),V1e=vh(W1e),q1e=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r],r);H1e(i)?n.push.apply(n,i):n.push(i)}return n},H1e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},G1e=gW;function gW(e,t,n){e instanceof RegExp&&(e=mW(e,n)),t instanceof RegExp&&(t=mW(t,n));var r=vW(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function mW(e,t){var n=t.match(e);return n?n[0]:null}gW.range=vW;function vW(e,t,n){var r,i,a,o,s,u=n.indexOf(e),l=n.indexOf(t,u+1),c=u;if(u>=0&&l>0){if(e===t)return[u,l];for(r=[],a=n.length;c>=0&&!s;)c==u?(r.push(c),u=n.indexOf(e,c+1)):r.length==1?s=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,o=l),l=n.indexOf(t,c+1)),c=u<l&&u>=0?u:l;r.length&&(s=[a,o])}return s}var K1e=q1e,yW=G1e,X1e=J1e,bW="\0SLASH"+Math.random()+"\0",xW="\0OPEN"+Math.random()+"\0",GN="\0CLOSE"+Math.random()+"\0",wW="\0COMMA"+Math.random()+"\0",_W="\0PERIOD"+Math.random()+"\0";function KN(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Y1e(e){return e.split("\\\\").join(bW).split("\\{").join(xW).split("\\}").join(GN).split("\\,").join(wW).split("\\.").join(_W)}function Z1e(e){return e.split(bW).join("\\").split(xW).join("{").split(GN).join("}").split(wW).join(",").split(_W).join(".")}function SW(e){if(!e)return[""];var t=[],n=yW("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=SW(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function J1e(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),Hg(Y1e(e),!0).map(Z1e)):[]}function Q1e(e){return"{"+e+"}"}function exe(e){return/^-?0\d/.test(e)}function txe(e,t){return e<=t}function nxe(e,t){return e>=t}function Hg(e,t){var n=[],r=yW("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||a,s=r.body.indexOf(",")>=0;if(!o&&!s)return r.post.match(/,.*\}/)?(e=r.pre+"{"+r.body+GN+r.post,Hg(e)):[e];var u;if(o)u=r.body.split(/\.\./);else if(u=SW(r.body),u.length===1&&(u=Hg(u[0],!1).map(Q1e),u.length===1)){var c=r.post.length?Hg(r.post,!1):[""];return c.map(function(k){return r.pre+u[0]+k})}var l=r.pre,c=r.post.length?Hg(r.post,!1):[""],f;if(o){var d=KN(u[0]),h=KN(u[1]),p=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(KN(u[2])):1,m=txe,v=h<d;v&&(g*=-1,m=nxe);var y=u.some(exe);f=[];for(var b=d;m(b,h);b+=g){var x;if(a)x=String.fromCharCode(b),x==="\\"&&(x="");else if(x=String(b),y){var w=p-x.length;if(w>0){var S=new Array(w+1).join("0");b<0?x="-"+S+x.slice(1):x=S+x}}f.push(x)}}else f=K1e(u,function(C){return Hg(C,!1)});for(var A=0;A<f.length;A++)for(var _=0;_<c.length;_++){var E=l+f[A]+c[_];(!t||o||E)&&n.push(E)}return n}var rxe=ns;ns.Minimatch=gi;var ny={sep:"/"};try{ny=V1e}catch(e){}var XN=ns.GLOBSTAR=gi.GLOBSTAR={},ixe=X1e,EW={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},YN="[^/]",ZN=YN+"*?",axe="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",oxe="(?:(?!(?:\\/|^)\\.).)*?",AW=sxe("().*{}+?[]^$\\!");function sxe(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var CW=/\/+/;ns.filter=uxe;function uxe(e,t){return t=t||{},function(n,r,i){return ns(n,e,t)}}function kW(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(r){n[r]=t[r]}),Object.keys(e).forEach(function(r){n[r]=e[r]}),n}ns.defaults=function(e){if(!e||!Object.keys(e).length)return ns;var t=ns,n=function(i,a,o){return t.minimatch(i,a,kW(e,o))};return n.Minimatch=function(i,a){return new t.Minimatch(i,kW(e,a))},n},gi.defaults=function(e){return!e||!Object.keys(e).length?gi:ns.defaults(e).Minimatch};function ns(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new gi(t,n).match(e)}function gi(e,t){if(!(this instanceof gi))return new gi(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),ny.sep!=="/"&&(e=e.split(ny.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}gi.prototype.debug=function(){},gi.prototype.make=lxe;function lxe(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(r){return r.split(CW)}),this.debug(this.pattern,n),n=n.map(function(r,i,a){return r.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}gi.prototype.parseNegate=cxe;function cxe(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,a=e.length;i<a&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}ns.braceExpand=function(e,t){return TW(e,t)},gi.prototype.braceExpand=TW;function TW(e,t){if(t||(this instanceof gi?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:ixe(e)}gi.prototype.parse=fxe;var R2={};function fxe(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return XN;if(e==="")return"";var r="",i=!!n.nocase,a=!1,o=[],s=[],u,l=!1,c=-1,f=-1,d=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function p(){if(u){switch(u){case"*":r+=ZN,i=!0;break;case"?":r+=YN,i=!0;break;default:r+="\\"+u;break}h.debug("clearStateChar %j %j",u,r),u=!1}}for(var g=0,m=e.length,v;g<m&&(v=e.charAt(g));g++){if(this.debug("%s	%s %s %j",e,g,r,v),a&&AW[v]){r+="\\"+v,a=!1;continue}switch(v){case"/":return!1;case"\\":p(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,g,r,v),l){this.debug("  in class"),v==="!"&&g===f+1&&(v="^"),r+=v;continue}h.debug("call clearStateChar %j",u),p(),u=v,n.noext&&p();continue;case"(":if(l){r+="(";continue}if(!u){r+="\\(";continue}o.push({type:u,start:g-1,reStart:r.length,open:EW[u].open,close:EW[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(l||!o.length){r+="\\)";continue}p(),i=!0;var y=o.pop();r+=y.close,y.type==="!"&&s.push(y),y.reEnd=r.length;continue;case"|":if(l||!o.length||a){r+="\\|",a=!1;continue}p(),r+="|";continue;case"[":if(p(),l){r+="\\"+v;continue}l=!0,f=g,c=r.length,r+=v;continue;case"]":if(g===f+1||!l){r+="\\"+v,a=!1;continue}if(l){var b=e.substring(f+1,g);try{RegExp("["+b+"]")}catch(K){var x=this.parse(b,R2);r=r.substr(0,c)+"\\["+x[0]+"\\]",i=i||x[1],l=!1;continue}}i=!0,l=!1,r+=v;continue;default:p(),a?a=!1:AW[v]&&!(v==="^"&&l)&&(r+="\\"),r+=v}}for(l&&(b=e.substr(f+1),x=this.parse(b,R2),r=r.substr(0,c)+"\\["+x[0],i=i||x[1]),y=o.pop();y;y=o.pop()){var w=r.slice(y.reStart+y.open.length);this.debug("setting tail",r,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(K,ee,ce){return ce||(ce="\\"),ee+ee+ce+"|"}),this.debug(`tail=%j
   %s`,w,w,y,r);var S=y.type==="*"?ZN:y.type==="?"?YN:"\\"+y.type;i=!0,r=r.slice(0,y.reStart)+S+"\\("+w}p(),a&&(r+="\\\\");var A=!1;switch(r.charAt(0)){case".":case"[":case"(":A=!0}for(var _=s.length-1;_>-1;_--){var E=s[_],C=r.slice(0,E.reStart),k=r.slice(E.reStart,E.reEnd-8),T=r.slice(E.reEnd-8,E.reEnd),I=r.slice(E.reEnd);T+=I;var N=C.split("(").length-1,O=I;for(g=0;g<N;g++)O=O.replace(/\)[+*?]?/,"");I=O;var D="";I===""&&t!==R2&&(D="$");var L=C+k+I+D+T;r=L}if(r!==""&&i&&(r="(?=.)"+r),A&&(r=d+r),t===R2)return[r,i];if(!i)return pxe(e);var W=n.nocase?"i":"";try{var G=new RegExp("^"+r+"$",W)}catch(K){return new RegExp("$.")}return G._glob=e,G._src=r,G}ns.makeRe=function(e,t){return new gi(e,t||{}).makeRe()},gi.prototype.makeRe=dxe;function dxe(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?ZN:t.dot?axe:oxe,r=t.nocase?"i":"",i=e.map(function(a){return a.map(function(o){return o===XN?n:typeof o=="string"?gxe(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(a){this.regexp=!1}return this.regexp}ns.match=function(e,t,n){n=n||{};var r=new gi(t,n);return e=e.filter(function(i){return r.match(i)}),r.options.nonull&&!e.length&&e.push(t),e},gi.prototype.match=hxe;function hxe(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;ny.sep!=="/"&&(e=e.split(ny.sep).join("/")),e=e.split(CW),this.debug(this.pattern,"split",e);var r=this.set;this.debug(this.pattern,"set",r);var i,a;for(a=e.length-1;a>=0&&(i=e[a],!i);a--);for(a=0;a<r.length;a++){var o=r[a],s=e;n.matchBase&&o.length===1&&(s=[i]);var u=this.matchOne(s,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}gi.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,a=0,o=e.length,s=t.length;i<o&&a<s;i++,a++){this.debug("matchOne loop");var u=t[a],l=e[i];if(this.debug(t,u,l),u===!1)return!1;if(u===XN){this.debug("GLOBSTAR",[t,u,l]);var c=i,f=a+1;if(f===s){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}for(;c<o;){var d=e[c];if(this.debug(`
globstar while`,e,c,t,f,d),this.matchOne(e.slice(c),t.slice(f),n))return this.debug("globstar found match!",c,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,c,t,f);break}this.debug("globstar swallow a segment, and continue"),c++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,c,t,f),c===o))}var h;if(typeof u=="string"?(r.nocase?h=l.toLowerCase()===u.toLowerCase():h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===o&&a===s)return!0;if(i===o)return n;if(a===s){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function pxe(e){return e.replace(/\\(.)/g,"$1")}function gxe(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var F2;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(F2||(F2={}));var Rs;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(Rs||(Rs={}));const OW=Object.keys(F2);F2.V0_4;const IW=Object.keys(Rs),M2=Rs.V0_3;var jt;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(jt||(jt={}));var ga;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(ga||(ga={}));var Xl;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(Xl||(Xl={}));var JN;(function(e){e.State="metapage/state"})(JN||(JN={}));const Du="metapage/definition",df="metapage/state",NW=IW[IW.length-1],mxe=OW[OW.length-1];var ry={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ye,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function r(f,d){return f.indexOf(d)===-1?f.length:f.indexOf(d)}function i(f){var d=f.replace(/^v/,"").replace(/\+.*$/,""),h=r(d,"-"),p=d.substring(0,h).split(".");return p.push(d.substring(h+1)),p}function a(f){return isNaN(Number(f))?f:Number(f)}function o(f){if(typeof f!="string")throw new TypeError("Invalid argument expected string");if(!n.test(f))throw new Error("Invalid argument not valid semver ('"+f+"' received)")}function s(f,d){[f,d].forEach(o);for(var h=i(f),p=i(d),g=0;g<Math.max(h.length-1,p.length-1);g++){var m=parseInt(h[g]||0,10),v=parseInt(p[g]||0,10);if(m>v)return 1;if(v>m)return-1}var y=h[h.length-1],b=p[p.length-1];if(y&&b){var x=y.split(".").map(a),w=b.split(".").map(a);for(g=0;g<Math.max(x.length,w.length);g++){if(x[g]===void 0||typeof w[g]=="string"&&typeof x[g]=="number")return-1;if(w[g]===void 0||typeof x[g]=="string"&&typeof w[g]=="number"||x[g]>w[g])return 1;if(w[g]>x[g])return-1}}else if(y||b)return y?-1:1;return 0}var u=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function c(f){if(typeof f!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof f);if(u.indexOf(f)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return s.validate=function(f){return typeof f=="string"&&n.test(f)},s.compare=function(f,d,h){c(h);var p=s(f,d);return l[h].indexOf(p)>-1},s})})(ry);var P2={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,f||u,d),p=n?n+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount==0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},s.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,d,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,d),!0;case 5:return m.fn.call(m.context,c,f,d,h),!0;case 6:return m.fn.call(m.context,c,f,d,h,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var x=m.length,w;for(b=0;b<x;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,f);break;case 4:m[b].fn.call(m[b].context,c,f,d);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];m[b].fn.apply(m[b].context,y)}}return!0},s.prototype.on=function(l,c,f){return a(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return a(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,d){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!d||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||f&&p[g].context!==f)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(P2);var $2;(function(e){e.mp_debug="mp_debug"})($2||($2={}));const vxe=()=>{try{return window!==window.top}catch(e){return!1}};class yxe extends P2.exports.EventEmitter{constructor(){super();this._definition={version:Rs.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var bxe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};const DW=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch(n){throw`Cannot parse into JSON:
${e}`}let t;switch(wxe(e.version)){case Rs.V0_2:{t=DW(xxe(e));break}case Rs.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${M2}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},xxe=e=>(e.version=Rs.V0_3,e),L2=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(r=>{n=!0,t[r]===void 0?delete e[r]:e[r]=t[r]}),n},wxe=e=>{if(e=="latest")return M2;if(ry.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return ry.exports.compare(e,"0.2",">=")&&ry.exports.compare(e,Rs.V0_3,"<")?Rs.V0_2:ry.exports.compare(e,"0.3",">=")?Rs.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${M2}`),M2)},QN=()=>{const e=new URLSearchParams(window.location.search).get($2.mp_debug);return e==="true"||e==="1"},_xe=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,Sxe=(e=8)=>Exe(e),RW="abcdefghijklmnopqrstuvwxyz0123456789",Exe=(e=8)=>{for(var t="",n=RW.length,r=0;r<e;r++)t+=RW.charAt(Math.floor(Math.random()*n));return t},eD=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let r;if(typeof e=="string"?r=e:typeof e=="number"?r=e+"":r=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var i=`color: #${t}`;n&&(i=`${i}; background: #${n}`),r=`%c${r}`,window.console.log(r,i)}else window.console.log(r)},FW=e=>Cxe(Axe(e)),Axe=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},Cxe=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},tD=()=>document.readyState=="complete"||document.readyState=="interactive",nD=()=>bxe(void 0,void 0,void 0,function*(){return tD()?Promise.resolve():new Promise(e=>{if(tD()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&tD()&&(t=!0,e())},200)})});var MW=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};class PW extends P2.exports.EventEmitter{constructor(t,n,r,i,a,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var s=new URL(this.url);o&&s.searchParams.set($2.mp_debug,"true"),this.url=s.href,this.id=r,this._debug=o,this._parentId=i,this._color=FW(this.id),this._consoleBackgroundColor=a,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(l=>{nD().then(()=>MW(this,void 0,void 0,function*(){if(u._iframe){const c=yield u.getDefinition();if(!u._iframe)return;(c==null?void 0:c.allow)&&(u._iframe.allow=c.allow),u._iframe.src=this.url,l(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[df]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Du]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return MW(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const r=yield n.json();return this._definition=r,this._definition}else this.emit(jt.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(jt.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var r={};r[t]=n,this.setInputs(r)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!L2(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(jt.Inputs,this.inputs),this._metapage.listenerCount(jt.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(jt.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){if(!!L2(this.outputs,t)&&(this.emit(jt.Outputs,t),this._metapage.listenerCount(jt.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(jt.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(jt.Inputs,t)}onInput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Inputs,r)}onOutputs(t){return this.addListenerReturnDisposer(jt.Outputs,t)}onOutput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Outputs,r)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:NW};this.sendRpcInternal(Xl.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(Xl.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const r=this;this._onLoaded.push(()=>{r.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(Xl.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),eD(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const r={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(r):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(r).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(r=>n._iframe.contentWindow.postMessage(r,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var kxe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},$W;(function(e){e.all="all",e.delta="delta"})($W||($W={}));const LW=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),Txe="bcbcbc";class Fs extends yxe{constructor(t){super();this._state=LW(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=QN(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:Sxe(),this._consoleBackgroundColor=t&&t.color?t.color:Txe,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),nD().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch(i){throw"Cannot parse into JSON:\n${metaPageDef}"}var r=new Fs;return r.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=_xe(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(jt.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const r=DW(t);return r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(r.plugins&&r.plugins.includes(i))throw this.emitErrorMessage(`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var a=r.metaframes[i];if(typeof a!="object")throw this.emitErrorMessage(`Metaframe "${i}" is not an object`),`Metaframe "${i}" is not an object`;if(!a.url)throw this.emitErrorMessage(`Metaframe "${i}" missing field: url`),`Metaframe "${i}" missing field: url`}),this._definition=r,Object.keys(this._metaframes).forEach(i=>{(!r.metaframes||!r.metaframes[i])&&this.removeMetaframe(i)}),Object.keys(this._plugins).forEach(i=>{r.plugins&&!r.plugins.includes(i)&&this.removePlugin(i)}),this._pluginOrder=r.plugins?r.plugins:[],n&&(this._state=n),r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(!this._metaframes.hasOwnProperty(i)){const a=r.metaframes[i];this.addMetaframe(i,a)}}),r.plugins&&r.plugins.forEach(i=>{this._plugins.hasOwnProperty(i)||this.addPlugin(i)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(jt.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(jt.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var r;const i=this._inputMap[n];let a=0;for(;a<=i.length;)((r=i[a])===null||r===void 0?void 0:r.metaframe)===t?i.splice(a,1):a++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=LW(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var r=new PW(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=r,r.addListener(jt.Error,i=>{this.emit(jt.Error,{metaframeId:r.id,metaframeUrl:r.url,error:i})}),n.inputs&&n.inputs.forEach(i=>this.addPipe(t,i)),r.setInputs(this._state.metaframes.inputs[t]),r}addPlugin(t){if(!t)throw"Plugin missing url";const n=new PW(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return Oxe(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,r){!this.debug||this.logInternal(t,n,r)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(jt.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var r=[];this._cachedInputLookupMap[t][n]=r,Object.keys(this._inputMap).forEach(i=>{i!==t&&this._inputMap[i].forEach(a=>{if(a.metaframe==t&&rxe(n,a.source)){var o=a.target;(!a.target||a.target.startsWith("*")||a.target==="")&&(o=n),r.push({metaframe:i,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case ga.SetupIframeClientRequest:return!0;default:var r=t.iframeId;return!(r&&!(t.parentId===this._id&&(this._metaframes[r]||this._plugins[r])))}}setInput(t,n,r){this.setInputStateOnly(t,n,r),this.setMetaframeClientInputAndSentClientEvent(t,n,r),this.emit(jt.State,this._state),this.emit(jt.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,r){if(typeof t=="object"){if(n||r)throw"bad arguments, see API docs";const i=t;Object.keys(i).forEach(a=>{var o=a,s=i[o];if(typeof s!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(s):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const i=this._metaframes[t];if(i==null&&this.error(`No iframe id=${t}`),typeof n=="string")i.setInput(n,r);else if(typeof n=="object")i.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,r){this.setInput(t,n,r)}setOutputStateOnly(t,n,r){this._setStateOnly(!1,t,n,r)}setInputStateOnly(t,n,r){this._setStateOnly(!0,t,n,r)}_setStateOnly(t,n,r,i){if(typeof n=="object"){if(r||i)throw"If first argument is an object, subsequent args should be undefined";const a=n;Object.keys(a).forEach(o=>{var s=a[o];if(typeof s!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const l=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;l[o]=l[o]?l[o]:{},Object.keys(s).forEach(c=>{s[c]===void 0?delete l[o][c]:l[o][c]=s[c]})})}else if(typeof n=="string"){const a=n,o=this._metaframes.hasOwnProperty(a);if(!o&&!this._plugins.hasOwnProperty(a))throw`No metaframe or plugin: ${a}`;const s=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof r=="string"){s[a]=s[a]?s[a]:{};const u=r;i===void 0?delete s[a][u]:s[a][u]=i}else if(typeof r=="object"){s[a]=s[a]?s[a]:{};const u=r;Object.keys(u).forEach(l=>{u[l]===void 0?delete s[a][l]:s[a][l]=u[l]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const s=o.iframeId;if(!s)return;const u=this.getMetaframeOrPlugin(s),l=this._plugins[s];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case ga.SetupIframeClientRequest:u&&u.register();break;case ga.SetupIframeServerResponseAck:if(u){const f=o.params;u.registered(f.version)}break;case ga.OutputsUpdate:const c=o.params;if(this._metaframes[s]){var r=this._metaframes[s];this.setOutputStateOnly(s,c),r.setOutputs(c),this.emit(jt.State,this._state);var i=!1;const f=Object.keys(c),d={};f.forEach((h,p)=>{const g=this.getInputsFromOutput(s,h);g.length>0&&g.forEach(m=>{d[m.metaframe]||(d[m.metaframe]={}),d[m.metaframe][m.pipe]=c[h],this.setInputStateOnly(m.metaframe,m.pipe,c[h]),i=!0})}),Object.keys(d).forEach(h=>{this._metaframes[h].setInputs(d[h])}),i&&this.emit(jt.State,this._state),this.debug&&r.ack({jsonrpc:o,state:this._state})}else if(this._plugins[s]){const f=!c[df]&&!c[Du];f&&this.setOutputStateOnly(s,c),this._plugins[s].setOutputs(c),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case ga.InputsUpdate:var a=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(a)} from ${s}`),this._metaframes[s])this.setInputStateOnly(s,a),this._metaframes[s].setInputs(a),this.emit(jt.State,this._state),this.debug&&this._metaframes[s].ack({jsonrpc:o,state:this._state});else if(this._plugins[s]){const f=!a[df]&&!a[Du];f&&this.setInputStateOnly(s,a),this._plugins[s].setInputs(a),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`);break;case ga.PluginRequest:l&&u&&u.hasPermissionsState()&&(u.setInput(df,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case ga.HashParamsUpdate:if(!l&&u){const f=o.params,d=new URL(u.url);d.hash=f.hash,u.url=d.href,this._definition.metaframes[f.metaframe].url=d.href,this.emit(jt.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(jt.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&Ixe(t)})}logInternal(t,n,r){r=r||this._consoleBackgroundColor;let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),i=this._id?`Metapage[${this._id}] ${i}`:i,eD(i,n,r)}}Fs.version=NW,Fs.DEFINITION=jt.Definition,Fs.DEFINITION_UPDATE_REQUEST=jt.DefinitionUpdateRequest,Fs.ERROR=jt.Error,Fs.INPUTS=jt.Inputs,Fs.MESSAGE=jt.Message,Fs.OUTPUTS=jt.Outputs,Fs.STATE=jt.State,Fs.URL_HASH_UPDATE=jt.UrlHashUpdate;const Oxe=(e,t)=>kxe(void 0,void 0,void 0,function*(){try{const i=yield t.getDefinition();if(!i)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(jt.Definition,a=>{t.setInput(Du,a.definition)});t._disposables.push(n);var r=e.getDefinition();if(r&&(t.setInput(Du,r),i.outputs)){var n=t.onOutput(Du,o=>{e.emit(jt.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&i.outputs){var n=t.onOutput(df,o=>{e.setState(o)});t._disposables.push(n)}}catch(i){console.error(i),e.emit(jt.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${i}`)}}),Ixe=e=>{const t=e._metapage.getDefinition();e.setInput(Du,t)};var Nxe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},hf;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(hf||(hf={}));var mi;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(mi||(mi={}));class Ms extends P2.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=hf.WaitingForPageLoad,this._messageSendCount=0,this.debug=QN(),this.id=window.name,this.debug=QN(),this._isIframe=vxe(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;nD().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(ga.SetupIframeClientRequest,{version:Ms.version}),n._state=hf.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===hf.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=FW(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=hf.Ready,this.sendRpc(ga.SetupIframeServerResponseAck,{version:Ms.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(mi.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(mi.Input,n,this._inputPipeValues[n]))),this.emit(mi.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new Dxe(this)),this.emit(mi.Connected))}connected(){return Nxe(this,void 0,void 0,function*(){if(this._state!==hf.Ready)return new Promise((t,n)=>{let r;r=this.addListenerReturnDisposer(mi.Connected,()=>{t(),r()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,r){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,r){let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),n=n&&n+"",i=(this.id?`Metaframe[${this.id}] `:"")+`${i}`,eD(i,n,r)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===mi.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(mi.Input,(r,i)=>{t===r&&n(i)})}onInputs(t){return this.addListenerReturnDisposer(mi.Inputs,t)}setInput(t,n){var r={};r[t]=n,this.setInputs(r)}setInputs(t){this.sendRpc(ga.InputsUpdate,t)}setInternalInputsAndNotify(t){!L2(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(mi.Input,n,t[n])),this.emit(mi.Inputs,t))}getInput(t){return console.assert(t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(t),this._outputPipeValues[t]}setOutput(t,n){console.assert(t),console.assert(n);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){!L2(this._outputPipeValues,t)||this.sendRpc(ga.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(ga.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const r={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(r,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let r=t.data;if(r.jsonrpc==="2.0"){var n=r.method;if(!(n==Xl.SetupIframeServerResponse||r.parentId==this._parentId&&r.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${r.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${r.iframeId} id=${this.id}`);return}switch(n){case Xl.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(r.params);break;case Xl.InputsUpdate:if(this._state!==hf.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(r.params.inputs);break;case Xl.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(r)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(r)}`);break}this.emit(mi.Message,r)}}}}Ms.version=mxe,Ms.ERROR=mi.Error,Ms.CONNECTED=mi.Connected,Ms.INPUT=mi.Input,Ms.INPUTS=mi.Inputs,Ms.MESSAGE=mi.Message;class Dxe{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:JN.State};this._metaframe.sendRpc(ga.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(df,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(df)}setState(t){this._metaframe.setOutput(df,t)}onDefinition(t){var n=this._metaframe.onInput(Du,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(Du,t)}getDefinition(){return this._metaframe.getInput(Du)}}const Rxe={inputs:{}},BW=ha(Rxe),Fxe=()=>Un(BW),Mxe=e=>{const[t,n]=an({inputs:{}}),[r,i]=an(void 0),[a,o]=an(t.inputs);return qt(()=>{const s=new Ms,u=l=>{o(l)};return s.onInputs(u),i(s),()=>{s.removeListener(Ms.INPUTS,u),s.dispose()}},[i,o]),qt(()=>{a&&r&&n({metaframe:r,inputs:a,setOutputs:r.setOutputs})},[a,r]),zt.createElement(BW.Provider,{value:t},e.children)},Pxe=()=>{try{return window!==window.top}catch(e){return!1}};function $xe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function Lxe(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var zW=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?a=r.prepend?r.container.firstChild:r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(Lxe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=$xe(i);try{a.insertRule(r,a.cssRules.length)}catch(o){}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),qi="-ms-",B2="-moz-",Cn="-webkit-",jW="comm",rD="rule",iD="decl",Bxe="@import",zxe="@keyframes",jxe=Math.abs,z2=String.fromCharCode;function Uxe(e,t){return(((t<<2^Ya(e,0))<<2^Ya(e,1))<<2^Ya(e,2))<<2^Ya(e,3)}function UW(e){return e.trim()}function Wxe(e,t){return(e=t.exec(e))?e[0]:e}function Mn(e,t,n){return e.replace(t,n)}function WW(e,t){return e.indexOf(t)}function Ya(e,t){return e.charCodeAt(t)|0}function iy(e,t,n){return e.slice(t,n)}function Ru(e){return e.length}function aD(e){return e.length}function j2(e,t){return t.push(e),e}function Vxe(e,t){return e.map(t).join("")}var U2=1,Gg=1,VW=0,Ao=0,Ur=0,Kg="";function W2(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:U2,column:Gg,length:o,return:""}}function ay(e,t,n){return W2(e,t.root,t.parent,n,t.props,t.children,0)}function qxe(){return Ur}function Hxe(){return Ur=Ao>0?Ya(Kg,--Ao):0,Gg--,Ur===10&&(Gg=1,U2--),Ur}function rs(){return Ur=Ao<VW?Ya(Kg,Ao++):0,Gg++,Ur===10&&(Gg=1,U2++),Ur}function Yl(){return Ya(Kg,Ao)}function V2(){return Ao}function q2(e,t){return iy(Kg,e,t)}function H2(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function qW(e){return U2=Gg=1,VW=Ru(Kg=e),Ao=0,[]}function HW(e){return Kg="",e}function oD(e){return UW(q2(Ao-1,sD(e===91?e+2:e===40?e+1:e)))}function Gxe(e){for(;(Ur=Yl())&&Ur<33;)rs();return H2(e)>2||H2(Ur)>3?"":" "}function Kxe(e,t){for(;--t&&rs()&&!(Ur<48||Ur>102||Ur>57&&Ur<65||Ur>70&&Ur<97););return q2(e,V2()+(t<6&&Yl()==32&&rs()==32))}function sD(e){for(;rs();)switch(Ur){case e:return Ao;case 34:case 39:return sD(e===34||e===39?e:Ur);case 40:e===41&&sD(e);break;case 92:rs();break}return Ao}function Xxe(e,t){for(;rs()&&e+Ur!==47+10;)if(e+Ur===42+42&&Yl()===47)break;return"/*"+q2(t,Ao-1)+"*"+z2(e===47?e:rs())}function GW(e){for(;!H2(Yl());)rs();return q2(e,Ao)}function Yxe(e){return HW(G2("",null,null,null,[""],e=qW(e),0,[0],e))}function G2(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,f=o,d=0,h=0,p=0,g=1,m=1,v=1,y=0,b="",x=i,w=a,S=r,A=b;m;)switch(p=y,y=rs()){case 34:case 39:case 91:case 40:A+=oD(y);break;case 9:case 10:case 13:case 32:A+=Gxe(p);break;case 92:A+=Kxe(V2()-1,7);continue;case 47:switch(Yl()){case 42:case 47:j2(Zxe(Xxe(rs(),V2()),t,n),u);break;default:A+="/"}break;case 123*g:s[l++]=Ru(A)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:h>0&&Ru(A)-f&&j2(h>32?XW(A+";",r,n,f-1):XW(Mn(A," ","")+";",r,n,f-2),u);break;case 59:A+=";";default:if(j2(S=KW(A,t,n,l,c,i,s,b,x=[],w=[],f),a),y===123)if(c===0)G2(A,t,S,S,x,a,f,s,w);else switch(d){case 100:case 109:case 115:G2(e,S,S,r&&j2(KW(e,S,S,0,0,i,s,b,i,x=[],f),w),i,w,f,s,r?x:w);break;default:G2(A,S,S,S,[""],w,f,s,w)}}l=c=h=0,g=v=1,b=A="",f=o;break;case 58:f=1+Ru(A),h=p;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&Hxe()==125)continue}switch(A+=z2(y),y*g){case 38:v=c>0?1:(A+="\f",-1);break;case 44:s[l++]=(Ru(A)-1)*v,v=1;break;case 64:Yl()===45&&(A+=oD(rs())),d=Yl(),c=Ru(b=A+=GW(V2())),y++;break;case 45:p===45&&Ru(A)==2&&(g=0)}}return a}function KW(e,t,n,r,i,a,o,s,u,l,c){for(var f=i-1,d=i===0?a:[""],h=aD(d),p=0,g=0,m=0;p<r;++p)for(var v=0,y=iy(e,f+1,f=jxe(g=o[p])),b=e;v<h;++v)(b=UW(g>0?d[v]+" "+y:Mn(y,/&\f/g,d[v])))&&(u[m++]=b);return W2(e,t,n,i===0?rD:s,u,l,c)}function Zxe(e,t,n){return W2(e,t,n,jW,z2(qxe()),iy(e,2,-2),0)}function XW(e,t,n,r){return W2(e,t,n,iD,iy(e,0,r),iy(e,r+1,-1),r)}function YW(e,t){switch(Uxe(e,t)){case 5103:return Cn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Cn+e+B2+e+qi+e+e;case 6828:case 4268:return Cn+e+qi+e+e;case 6165:return Cn+e+qi+"flex-"+e+e;case 5187:return Cn+e+Mn(e,/(\w+).+(:[^]+)/,Cn+"box-$1$2"+qi+"flex-$1$2")+e;case 5443:return Cn+e+qi+"flex-item-"+Mn(e,/flex-|-self/,"")+e;case 4675:return Cn+e+qi+"flex-line-pack"+Mn(e,/align-content|flex-|-self/,"")+e;case 5548:return Cn+e+qi+Mn(e,"shrink","negative")+e;case 5292:return Cn+e+qi+Mn(e,"basis","preferred-size")+e;case 6060:return Cn+"box-"+Mn(e,"-grow","")+Cn+e+qi+Mn(e,"grow","positive")+e;case 4554:return Cn+Mn(e,/([^-])(transform)/g,"$1"+Cn+"$2")+e;case 6187:return Mn(Mn(Mn(e,/(zoom-|grab)/,Cn+"$1"),/(image-set)/,Cn+"$1"),e,"")+e;case 5495:case 3959:return Mn(e,/(image-set\([^]*)/,Cn+"$1$`$1");case 4968:return Mn(Mn(e,/(.+:)(flex-)?(.*)/,Cn+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cn+e+e;case 4095:case 3583:case 4068:case 2532:return Mn(e,/(.+)-inline(.+)/,Cn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ru(e)-1-t>6)switch(Ya(e,t+1)){case 109:if(Ya(e,t+4)!==45)break;case 102:return Mn(e,/(.+:)(.+)-([^]+)/,"$1"+Cn+"$2-$3$1"+B2+(Ya(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~WW(e,"stretch")?YW(Mn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Ya(e,t+1)!==115)break;case 6444:switch(Ya(e,Ru(e)-3-(~WW(e,"!important")&&10))){case 107:return Mn(e,":",":"+Cn)+e;case 101:return Mn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cn+(Ya(e,14)===45?"inline-":"")+"box$3$1"+Cn+"$2$3$1"+qi+"$2box$3")+e}break;case 5936:switch(Ya(e,t+11)){case 114:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Cn+e+qi+e+e}return e}function oy(e,t){for(var n="",r=aD(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function Jxe(e,t,n,r){switch(e.type){case Bxe:case iD:return e.return=e.return||e.value;case jW:return"";case rD:e.value=e.props.join(",")}return Ru(n=oy(e.children,r))?e.return=e.value+"{"+n+"}":""}function Qxe(e){var t=aD(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}function ewe(e){return function(t){t.root||(t=t.return)&&e(t)}}function twe(e,t,n,r){if(!e.return)switch(e.type){case iD:e.return=YW(e.value,e.length);break;case zxe:return oy([ay(Mn(e.value,"@","@"+Cn),e,"")],r);case rD:if(e.length)return Vxe(e.props,function(i){switch(Wxe(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return oy([ay(Mn(i,/:(read-\w+)/,":"+B2+"$1"),e,"")],r);case"::placeholder":return oy([ay(Mn(i,/:(plac\w+)/,":"+Cn+"input-$1"),e,""),ay(Mn(i,/:(plac\w+)/,":"+B2+"$1"),e,""),ay(Mn(i,/:(plac\w+)/,qi+"input-$1"),e,"")],r)}return""})}}var ZW=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function JW(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var nwe=function(t,n){var r=-1,i=44;do switch(H2(i)){case 0:i===38&&Yl()===12&&(n[r]=1),t[r]+=GW(Ao-1);break;case 2:t[r]+=oD(i);break;case 4:if(i===44){t[++r]=Yl()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=z2(i)}while(i=rs());return t},rwe=function(t,n){return HW(nwe(qW(t),n))},QW=new WeakMap,iwe=function(t){if(!(t.type!=="rule"||!t.parent||!t.length)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!QW.get(r))&&!i){QW.set(t,!0);for(var a=[],o=rwe(n,a),s=r.props,u=0,l=0;u<o.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=a[u]?o[u].replace(/&\f/g,s[c]):s[c]+" "+o[u]}}},awe=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}},owe=[twe],swe=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||owe,a={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),v=1;v<m.length;v++)a[m[v]]=!0;s.push(g)});var u,l=[iwe,awe];{var c,f=[Jxe,ewe(function(g){c.insert(g)})],d=Qxe(l.concat(i,f)),h=function(m){return oy(Yxe(m),d)};u=function(m,v,y,b){c=y,h(m?m+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new zW({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:a,registered:{},insert:u};return p.sheet.hydrate(s),p};function yh(){return yh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yh.apply(this,arguments)}var eV={exports:{}},Pn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vi=typeof Symbol=="function"&&Symbol.for,uD=vi?Symbol.for("react.element"):60103,lD=vi?Symbol.for("react.portal"):60106,K2=vi?Symbol.for("react.fragment"):60107,X2=vi?Symbol.for("react.strict_mode"):60108,Y2=vi?Symbol.for("react.profiler"):60114,Z2=vi?Symbol.for("react.provider"):60109,J2=vi?Symbol.for("react.context"):60110,cD=vi?Symbol.for("react.async_mode"):60111,Q2=vi?Symbol.for("react.concurrent_mode"):60111,e_=vi?Symbol.for("react.forward_ref"):60112,t_=vi?Symbol.for("react.suspense"):60113,uwe=vi?Symbol.for("react.suspense_list"):60120,n_=vi?Symbol.for("react.memo"):60115,r_=vi?Symbol.for("react.lazy"):60116,lwe=vi?Symbol.for("react.block"):60121,cwe=vi?Symbol.for("react.fundamental"):60117,fwe=vi?Symbol.for("react.responder"):60118,dwe=vi?Symbol.for("react.scope"):60119;function Co(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case uD:switch(e=e.type,e){case cD:case Q2:case K2:case Y2:case X2:case t_:return e;default:switch(e=e&&e.$$typeof,e){case J2:case e_:case r_:case n_:case Z2:return e;default:return t}}case lD:return t}}}function tV(e){return Co(e)===Q2}Pn.AsyncMode=cD,Pn.ConcurrentMode=Q2,Pn.ContextConsumer=J2,Pn.ContextProvider=Z2,Pn.Element=uD,Pn.ForwardRef=e_,Pn.Fragment=K2,Pn.Lazy=r_,Pn.Memo=n_,Pn.Portal=lD,Pn.Profiler=Y2,Pn.StrictMode=X2,Pn.Suspense=t_,Pn.isAsyncMode=function(e){return tV(e)||Co(e)===cD},Pn.isConcurrentMode=tV,Pn.isContextConsumer=function(e){return Co(e)===J2},Pn.isContextProvider=function(e){return Co(e)===Z2},Pn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===uD},Pn.isForwardRef=function(e){return Co(e)===e_},Pn.isFragment=function(e){return Co(e)===K2},Pn.isLazy=function(e){return Co(e)===r_},Pn.isMemo=function(e){return Co(e)===n_},Pn.isPortal=function(e){return Co(e)===lD},Pn.isProfiler=function(e){return Co(e)===Y2},Pn.isStrictMode=function(e){return Co(e)===X2},Pn.isSuspense=function(e){return Co(e)===t_},Pn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===K2||e===Q2||e===Y2||e===X2||e===t_||e===uwe||typeof e=="object"&&e!==null&&(e.$$typeof===r_||e.$$typeof===n_||e.$$typeof===Z2||e.$$typeof===J2||e.$$typeof===e_||e.$$typeof===cwe||e.$$typeof===fwe||e.$$typeof===dwe||e.$$typeof===lwe)},Pn.typeOf=Co,eV.exports=Pn;var nV=eV.exports,hwe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},pwe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},rV={};rV[nV.ForwardRef]=hwe,rV[nV.Memo]=pwe;var gwe=!0;function mwe(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var iV=function(t,n,r){var i=t.key+"-"+n.name;if((r===!1||gwe===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles),t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function vwe(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var ywe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},bwe=/[A-Z]|^ms/g,xwe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aV=function(t){return t.charCodeAt(1)===45},oV=function(t){return t!=null&&typeof t!="boolean"},fD=JW(function(e){return aV(e)?e:e.replace(bwe,"-$&").toLowerCase()}),sV=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(xwe,function(r,i,a){return Fu={name:i,styles:a,next:Fu},i})}return ywe[t]!==1&&!aV(t)&&typeof n=="number"&&n!==0?n+"px":n};function sy(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Fu={name:n.name,styles:n.styles,next:Fu},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Fu={name:r.name,styles:r.styles,next:Fu},r=r.next;var i=n.styles+";";return i}return wwe(e,t,n)}case"function":{if(e!==void 0){var a=Fu,o=n(e);return Fu=a,sy(e,t,o)}break}}if(t==null)return n;var s=t[n];return s!==void 0?s:n}function wwe(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=sy(e,t,n[i])+";";else for(var a in n){var o=n[a];if(typeof o!="object")t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":oV(o)&&(r+=fD(a)+":"+sV(a,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var s=0;s<o.length;s++)oV(o[s])&&(r+=fD(a)+":"+sV(a,o[s])+";");else{var u=sy(e,t,o);switch(a){case"animation":case"animationName":{r+=fD(a)+":"+u+";";break}default:r+=a+"{"+u+"}"}}}return r}var uV=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Fu,dD=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";Fu=void 0;var o=t[0];o==null||o.raw===void 0?(i=!1,a+=sy(r,n,o)):a+=o[0];for(var s=1;s<t.length;s++)a+=sy(r,n,t[s]),i&&(a+=o[s]);uV.lastIndex=0;for(var u="",l;(l=uV.exec(a))!==null;)u+="-"+l[1];var c=vwe(a)+u;return{name:c,styles:a,next:Fu}},lV=ha(typeof HTMLElement!="undefined"?swe({key:"css"}):null);lV.Provider;var cV=function(t){return Kl(function(n,r){var i=Un(lV);return t(n,i,r)})},uy=ha({}),_we=function(t,n){if(typeof n=="function"){var r=n(t);return r}return yh({},t,n)},Swe=ZW(function(e){return ZW(function(t){return _we(e,t)})}),Ewe=function(t){var n=Un(uy);return t.theme!==n&&(n=Swe(n)(t.theme)),ue(uy.Provider,{value:n},t.children)},hD=cV(function(e,t){var n=e.styles,r=dD([n],void 0,Un(uy)),i=Jt();return lf(function(){var a=t.key+"-global",o=new zW({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",a),o.hydrate([u])),i.current=[o,s],function(){o.flush()}},[t]),lf(function(){var a=i.current,o=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&iV(t,r.next,!0),o.tags.length){var u=o.tags[o.tags.length-1].nextElementSibling;o.before=u,o.flush()}t.insert("",r,o,!1)},[t,r.name]),null});function Awe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return dD(t)}var fV=function(){var t=Awe.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Cwe=()=>ue(hD,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;      
        -moz-osx-font-smoothing: grayscale; 
        touch-action: manipulation; 
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
        vertical-align: middle;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }
    `}),kwe=Cwe;function Twe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function pf(e){return typeof e=="number"}function pD(e){return Array.isArray(e)}function dV(e){return typeof e=="function"}function Ps(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")&&!pD(e)}function Owe(e){return Ps(e)&&Object.keys(e).length===0}function hV(e){return e==null}function gD(e){return Object.prototype.toString.call(e)==="[object String]"}function pV(e){return/^var\(--.+\)$/.test(e)}var i_=!1,mD={exports:{}};(function(e,t){var n=200,r="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",y="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",A="[object Undefined]",_="[object WeakMap]",E="[object ArrayBuffer]",C="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",I="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",D="[object Uint8Array]",L="[object Uint8ClampedArray]",W="[object Uint16Array]",G="[object Uint32Array]",K=/[\\^$.*+?()[\]{}|]/g,ee=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,he={};he[k]=he[T]=he[I]=he[N]=he[O]=he[D]=he[L]=he[W]=he[G]=!0,he[s]=he[u]=he[E]=he[c]=he[C]=he[f]=he[d]=he[h]=he[g]=he[m]=he[y]=he[x]=he[w]=he[S]=he[_]=!1;var Oe=typeof Ye=="object"&&Ye&&Ye.Object===Object&&Ye,Te=typeof self=="object"&&self&&self.Object===Object&&self,Re=Oe||Te||Function("return this")(),me=t&&!t.nodeType&&t,P=me&&!0&&e&&!e.nodeType&&e,F=P&&P.exports===me,V=F&&Oe.process,ae=function(){try{var H=P&&P.require&&P.require("util").types;return H||V&&V.binding&&V.binding("util")}catch(ne){}}(),Y=ae&&ae.isTypedArray;function M(H,ne,de){switch(de.length){case 0:return H.call(ne);case 1:return H.call(ne,de[0]);case 2:return H.call(ne,de[0],de[1]);case 3:return H.call(ne,de[0],de[1],de[2])}return H.apply(ne,de)}function B(H,ne){for(var de=-1,Xe=Array(H);++de<H;)Xe[de]=ne(de);return Xe}function R(H){return function(ne){return H(ne)}}function X(H,ne){return H==null?void 0:H[ne]}function ge(H,ne){return function(de){return H(ne(de))}}var xe=Array.prototype,ze=Function.prototype,Ke=Object.prototype,Ze=Re["__core-js_shared__"],Bt=ze.toString,Je=Ke.hasOwnProperty,Zt=function(){var H=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return H?"Symbol(src)_1."+H:""}(),mn=Ke.toString,Hn=Bt.call(Object),ni=RegExp("^"+Bt.call(Je).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tr=F?Re.Buffer:void 0,Dn=Re.Symbol,es=Re.Uint8Array,Ka=tr?tr.allocUnsafe:void 0,Ul=ge(Object.getPrototypeOf,Object),Os=Object.create,Is=Ke.propertyIsEnumerable,Wl=xe.splice,Vl=Dn?Dn.toStringTag:void 0,af=function(){try{var H=Pe(Object,"defineProperty");return H({},"",{}),H}catch(ne){}}(),x2=tr?tr.isBuffer:void 0,w2=Math.max,Iu=Date.now,_2=Pe(Re,"Map"),dh=Pe(Object,"create"),S2=function(){function H(){}return function(ne){if(!gh(ne))return{};if(Os)return Os(ne);H.prototype=ne;var de=new H;return H.prototype=void 0,de}}();function ql(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function sN(){this.__data__=dh?dh(null):{},this.size=0}function uN(H){var ne=this.has(H)&&delete this.__data__[H];return this.size-=ne?1:0,ne}function lN(H){var ne=this.__data__;if(dh){var de=ne[H];return de===r?void 0:de}return Je.call(ne,H)?ne[H]:void 0}function cN(H){var ne=this.__data__;return dh?ne[H]!==void 0:Je.call(ne,H)}function fN(H,ne){var de=this.__data__;return this.size+=this.has(H)?0:1,de[H]=dh&&ne===void 0?r:ne,this}ql.prototype.clear=sN,ql.prototype.delete=uN,ql.prototype.get=lN,ql.prototype.has=cN,ql.prototype.set=fN;function Ns(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function dN(){this.__data__=[],this.size=0}function hN(H){var ne=this.__data__,de=Nu(ne,H);if(de<0)return!1;var Xe=ne.length-1;return de==Xe?ne.pop():Wl.call(ne,de,1),--this.size,!0}function pN(H){var ne=this.__data__,de=Nu(ne,H);return de<0?void 0:ne[de][1]}function E2(H){return Nu(this.__data__,H)>-1}function gN(H,ne){var de=this.__data__,Xe=Nu(de,H);return Xe<0?(++this.size,de.push([H,ne])):de[Xe][1]=ne,this}Ns.prototype.clear=dN,Ns.prototype.delete=hN,Ns.prototype.get=pN,Ns.prototype.has=E2,Ns.prototype.set=gN;function of(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function mN(){this.size=0,this.__data__={hash:new ql,map:new(_2||Ns),string:new ql}}function vN(H){var ne=Fe(this,H).delete(H);return this.size-=ne?1:0,ne}function yN(H){return Fe(this,H).get(H)}function bN(H){return Fe(this,H).has(H)}function xN(H,ne){var de=Fe(this,H),Xe=de.size;return de.set(H,ne),this.size+=de.size==Xe?0:1,this}of.prototype.clear=mN,of.prototype.delete=vN,of.prototype.get=yN,of.prototype.has=bN,of.prototype.set=xN;function sf(H){var ne=this.__data__=new Ns(H);this.size=ne.size}function wN(){this.__data__=new Ns,this.size=0}function _N(H){var ne=this.__data__,de=ne.delete(H);return this.size=ne.size,de}function SN(H){return this.__data__.get(H)}function EN(H){return this.__data__.has(H)}function AN(H,ne){var de=this.__data__;if(de instanceof Ns){var Xe=de.__data__;if(!_2||Xe.length<n-1)return Xe.push([H,ne]),this.size=++de.size,this;de=this.__data__=new of(Xe)}return de.set(H,ne),this.size=de.size,this}sf.prototype.clear=wN,sf.prototype.delete=_N,sf.prototype.get=SN,sf.prototype.has=EN,sf.prototype.set=AN;function CN(H,ne){var de=DN(H),Xe=!de&&jg(H),un=!de&&!Xe&&_U(H),Gn=!de&&!Xe&&!un&&EU(H),ur=de||Xe||un||Gn,rn=ur?B(H.length,String):[],lr=rn.length;for(var ts in H)(ne||Je.call(H,ts))&&!(ur&&(ts=="length"||un&&(ts=="offset"||ts=="parent")||Gn&&(ts=="buffer"||ts=="byteLength"||ts=="byteOffset")||Ft(ts,lr)))&&rn.push(ts);return rn}function V0(H,ne,de){(de!==void 0&&!zg(H[ne],de)||de===void 0&&!(ne in H))&&$g(H,ne,de)}function A2(H,ne,de){var Xe=H[ne];(!(Je.call(H,ne)&&zg(Xe,de))||de===void 0&&!(ne in H))&&$g(H,ne,de)}function Nu(H,ne){for(var de=H.length;de--;)if(zg(H[de][0],ne))return de;return-1}function $g(H,ne,de){ne=="__proto__"&&af?af(H,ne,{configurable:!0,enumerable:!0,value:de,writable:!0}):H[ne]=de}var uf=De();function Lg(H){return H==null?H===void 0?A:v:Vl&&Vl in Object(H)?je(H):ph(H)}function hh(H){return X0(H)&&Lg(H)==s}function q0(H){if(!gh(H)||_r(H))return!1;var ne=FN(H)?ni:ee;return ne.test(NN(H))}function kN(H){return X0(H)&&SU(H.length)&&!!he[Lg(H)]}function TN(H){if(!gh(H))return Xa(H);var ne=sr(H),de=[];for(var Xe in H)Xe=="constructor"&&(ne||!Je.call(H,Xe))||de.push(Xe);return de}function Bg(H,ne,de,Xe,un){H!==ne&&uf(ne,function(Gn,ur){if(un||(un=new sf),gh(Gn))ON(H,ne,ur,de,Bg,Xe,un);else{var rn=Xe?Xe(G0(H,ur),Gn,ur+"",H,ne,un):void 0;rn===void 0&&(rn=Gn),V0(H,ur,rn)}},AU)}function ON(H,ne,de,Xe,un,Gn,ur){var rn=G0(H,de),lr=G0(ne,de),ts=ur.get(lr);if(ts){V0(H,de,ts);return}var Eo=Gn?Gn(rn,lr,de+"",H,ne,ur):void 0,Y0=Eo===void 0;if(Y0){var MN=DN(lr),PN=!MN&&_U(lr),kU=!MN&&!PN&&EU(lr);Eo=lr,MN||PN||kU?DN(rn)?Eo=rn:s1e(rn)?Eo=oe(rn):PN?(Y0=!1,Eo=Z(lr,!0)):kU?(Y0=!1,Eo=re(lr,!0)):Eo=[]:u1e(lr)||jg(lr)?(Eo=rn,jg(rn)?Eo=l1e(rn):(!gh(rn)||FN(rn))&&(Eo=it(lr))):Y0=!1}Y0&&(ur.set(lr,Eo),un(Eo,lr,Xe,Gn,ur),ur.delete(lr)),V0(H,de,Eo)}function IN(H,ne){return K0(H0(H,ne,CU),H+"")}var z=af?function(H,ne){return af(H,"toString",{configurable:!0,enumerable:!1,value:f1e(ne),writable:!0})}:CU;function Z(H,ne){if(ne)return H.slice();var de=H.length,Xe=Ka?Ka(de):new H.constructor(de);return H.copy(Xe),Xe}function q(H){var ne=new H.constructor(H.byteLength);return new es(ne).set(new es(H)),ne}function re(H,ne){var de=ne?q(H.buffer):H.buffer;return new H.constructor(de,H.byteOffset,H.length)}function oe(H,ne){var de=-1,Xe=H.length;for(ne||(ne=Array(Xe));++de<Xe;)ne[de]=H[de];return ne}function te(H,ne,de,Xe){var un=!de;de||(de={});for(var Gn=-1,ur=ne.length;++Gn<ur;){var rn=ne[Gn],lr=Xe?Xe(de[rn],H[rn],rn,de,H):void 0;lr===void 0&&(lr=H[rn]),un?$g(de,rn,lr):A2(de,rn,lr)}return de}function Ae(H){return IN(function(ne,de){var Xe=-1,un=de.length,Gn=un>1?de[un-1]:void 0,ur=un>2?de[2]:void 0;for(Gn=H.length>3&&typeof Gn=="function"?(un--,Gn):void 0,ur&&bn(de[0],de[1],ur)&&(Gn=un<3?void 0:Gn,un=1),ne=Object(ne);++Xe<un;){var rn=de[Xe];rn&&H(ne,rn,Xe,Gn)}return ne})}function De(H){return function(ne,de,Xe){for(var un=-1,Gn=Object(ne),ur=Xe(ne),rn=ur.length;rn--;){var lr=ur[H?rn:++un];if(de(Gn[lr],lr,Gn)===!1)break}return ne}}function Fe(H,ne){var de=H.__data__;return An(ne)?de[typeof ne=="string"?"string":"hash"]:de.map}function Pe(H,ne){var de=X(H,ne);return q0(de)?de:void 0}function je(H){var ne=Je.call(H,Vl),de=H[Vl];try{H[Vl]=void 0;var Xe=!0}catch(Gn){}var un=mn.call(H);return Xe&&(ne?H[Vl]=de:delete H[Vl]),un}function it(H){return typeof H.constructor=="function"&&!sr(H)?S2(Ul(H)):{}}function Ft(H,ne){var de=typeof H;return ne=ne??o,!!ne&&(de=="number"||de!="symbol"&&ce.test(H))&&H>-1&&H%1==0&&H<ne}function bn(H,ne,de){if(!gh(de))return!1;var Xe=typeof ne;return(Xe=="number"?RN(de)&&Ft(ne,de.length):Xe=="string"&&ne in de)?zg(de[ne],H):!1}function An(H){var ne=typeof H;return ne=="string"||ne=="number"||ne=="symbol"||ne=="boolean"?H!=="__proto__":H===null}function _r(H){return!!Zt&&Zt in H}function sr(H){var ne=H&&H.constructor,de=typeof ne=="function"&&ne.prototype||Ke;return H===de}function Xa(H){var ne=[];if(H!=null)for(var de in Object(H))ne.push(de);return ne}function ph(H){return mn.call(H)}function H0(H,ne,de){return ne=w2(ne===void 0?H.length-1:ne,0),function(){for(var Xe=arguments,un=-1,Gn=w2(Xe.length-ne,0),ur=Array(Gn);++un<Gn;)ur[un]=Xe[ne+un];un=-1;for(var rn=Array(ne+1);++un<ne;)rn[un]=Xe[un];return rn[ne]=de(ur),M(H,this,rn)}}function G0(H,ne){if(!(ne==="constructor"&&typeof H[ne]=="function")&&ne!="__proto__")return H[ne]}var K0=wU(z);function wU(H){var ne=0,de=0;return function(){var Xe=Iu(),un=a-(Xe-de);if(de=Xe,un>0){if(++ne>=i)return arguments[0]}else ne=0;return H.apply(void 0,arguments)}}function NN(H){if(H!=null){try{return Bt.call(H)}catch(ne){}try{return H+""}catch(ne){}}return""}function zg(H,ne){return H===ne||H!==H&&ne!==ne}var jg=hh(function(){return arguments}())?hh:function(H){return X0(H)&&Je.call(H,"callee")&&!Is.call(H,"callee")},DN=Array.isArray;function RN(H){return H!=null&&SU(H.length)&&!FN(H)}function s1e(H){return X0(H)&&RN(H)}var _U=x2||d1e;function FN(H){if(!gh(H))return!1;var ne=Lg(H);return ne==h||ne==p||ne==l||ne==b}function SU(H){return typeof H=="number"&&H>-1&&H%1==0&&H<=o}function gh(H){var ne=typeof H;return H!=null&&(ne=="object"||ne=="function")}function X0(H){return H!=null&&typeof H=="object"}function u1e(H){if(!X0(H)||Lg(H)!=y)return!1;var ne=Ul(H);if(ne===null)return!0;var de=Je.call(ne,"constructor")&&ne.constructor;return typeof de=="function"&&de instanceof de&&Bt.call(de)==Hn}var EU=Y?R(Y):kN;function l1e(H){return te(H,AU(H))}function AU(H){return RN(H)?CN(H,!0):TN(H)}var c1e=Ae(function(H,ne,de,Xe){Bg(H,ne,de,Xe)});function f1e(H){return function(){return H}}function CU(H){return H}function d1e(){return!1}e.exports=c1e})(mD,mD.exports);var Zl=mD.exports;function vD(e,t){var n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n}function Iwe(e,t){var n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n}function Nwe(e,t){var n={},r={};return Object.keys(e).forEach(i=>{t.includes(i)?n[i]=e[i]:r[i]=e[i]}),[n,r]}function Dwe(e,t,n,r){var i=typeof t=="string"?t.split("."):[t];for(r=0;r<i.length&&e;r+=1)e=e[i[r]];return e===void 0?n:e}var Rwe=e=>{var t=new WeakMap,n=(r,i,a,o)=>{if(typeof r=="undefined")return e(r,i,a);t.has(r)||t.set(r,new Map);var s=t.get(r);if(s.has(i))return s.get(i);var u=e(r,i,a,o);return s.set(i,u),u};return n},a_=Rwe(Dwe);function gV(e,t){var n={};return Object.keys(e).forEach(r=>{var i=e[r],a=t(i,r,e);a&&(n[r]=i)}),n}var o_=e=>gV(e,t=>t!=null),s_=e=>Object.keys(e),Fwe=e=>e.reduce((t,n)=>{var[r,i]=n;return t[r]=i,t},{});function Mwe(e){var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}}function yD(e){if(e==null)return e;var{unitless:t}=Mwe(e);return t||pf(e)?e+"px":e}var mV=(e,t)=>parseInt(e[1],10)>parseInt(t[1],10)?1:-1,bD=e=>Fwe(Object.entries(e).sort(mV));function vV(e){var t=bD(e);return Object.assign(Object.values(t),t)}function Pwe(e){var t=Object.keys(bD(e));return new Set(t)}function $we(e){var t;if(!e)return e;e=(t=yD(e))!=null?t:e;var n=e.endsWith("px")?-1:-.0635;return pf(e)?""+(e+n):e.replace(/([0-9]+\.?[0-9]*)/,r=>""+(parseFloat(r)+n))}function u_(e,t){var n=[];return e&&n.push("@media screen and (min-width: "+yD(e)+")"),n.length>0&&t&&n.push("and"),t&&n.push("@media screen and (max-width: "+yD(t)+")"),n.join(" ")}function Lwe(e){var t;if(!e)return null;e.base=(t=e.base)!=null?t:"0px";var n=vV(e),r=Object.entries(e).sort(mV).map((o,s,u)=>{var l,[c,f]=o,[,d]=(l=u[s+1])!=null?l:[];return d=parseFloat(d)>0?$we(d):void 0,{breakpoint:c,minW:f,maxW:d,maxWQuery:u_(null,d),minWQuery:u_(f),minMaxQuery:u_(f,d)}}),i=Pwe(e),a=Array.from(i.values());return{keys:i,normalized:n,isResponsive(o){var s=Object.keys(o);return s.length>0&&s.every(u=>i.has(u))},asObject:bD(e),asArray:vV(e),details:r,media:[null,...n.map(o=>u_(o)).slice(1)],toArrayValue(o){if(!Ps(o))throw new Error("toArrayValue: value must be an object");for(var s=a.map(u=>{var l;return(l=o[u])!=null?l:null});Twe(s)===null;)s.pop();return s},toObjectValue(o){if(!Array.isArray(o))throw new Error("toObjectValue: value must be an array");return o.reduce((s,u,l)=>{var c=a[l];return c!=null&&u!=null&&(s[c]=u),s},{})}}}function yV(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function xD(e){var t;if(!yV(e))return!1;var n=(t=e.ownerDocument.defaultView)!=null?t:window;return e instanceof n.HTMLElement}function bV(e){var t;return yV(e)&&(t=e.ownerDocument)!=null?t:document}function Bwe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Xg=Bwe(),Ni=e=>e?"":void 0,wD=e=>e?!0:void 0,Wn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter(Boolean).join(" ")};function zwe(e){var{key:t,keyCode:n}=e,r=n>=37&&n<=40&&t.indexOf("Arrow")!==0,i=r?"Arrow"+t:t;return i}function xV(e){return e.button!==0}var jwe=e=>e.hasAttribute("tabindex");function Uwe(e){return Boolean(e.getAttribute("disabled"))===!0||Boolean(e.getAttribute("aria-disabled"))===!0}function Wwe(e){return xD(e)&&e.tagName.toLowerCase()==="input"&&"select"in e}function Vwe(e){var t=xD(e)?bV(e):document;return t.activeElement===e}function wV(e){return e.parentElement&&wV(e.parentElement)?!0:e.hidden}function qwe(e){var t=e.getAttribute("contenteditable");return t!=="false"&&t!=null}function Hwe(e){if(!xD(e)||wV(e)||Uwe(e))return!1;var{localName:t}=e,n=["input","select","textarea","button"];if(n.indexOf(t)>=0)return!0;var r={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in r?r[t]():qwe(e)?!0:jwe(e)}var Gwe=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","embed","iframe","object","a[href]","area[href]","button:not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],Kwe=Gwe.join();function Xwe(e){var t=Array.from(e.querySelectorAll(Kwe));return t.unshift(e),t.filter(Hwe).filter(n=>window.getComputedStyle(n).display!=="none")}function $s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return dV(e)?e(...n):e}function Sr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){t.some(a=>(a==null||a(i),i==null?void 0:i.defaultPrevented))}}function Ywe(e){var t;return function(){if(e){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=e.apply(this,i),e=null}return t}}var ly=()=>{},_D=Ywe(e=>()=>{var{condition:t,message:n}=e;t&&i_&&console.warn(n)});function Yg(e,t){t===void 0&&(t={});var{isActive:n=Vwe,nextTick:r,preventScroll:i=!0,selectTextIfInput:a=!0}=t;if(!e||n(e))return-1;function o(){if(!e){_D({condition:!0,message:"[chakra-ui]: can't call focus() on `null` or `undefined` element"});return}if(Zwe())e.focus({preventScroll:i});else if(e.focus(),i){var s=Jwe(e);Qwe(s)}Wwe(e)&&a&&e.select()}return r?requestAnimationFrame(o):(o(),-1)}var l_=null;function Zwe(){if(l_==null){l_=!1;try{var e=document.createElement("div");e.focus({get preventScroll(){return l_=!0,!0}})}catch(t){}}return l_}function Jwe(e){for(var t,n=bV(e),r=(t=n.defaultView)!=null?t:window,i=e.parentNode,a=[],o=n.scrollingElement||n.documentElement;i instanceof r.HTMLElement&&i!==o;)(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth)&&a.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),i=i.parentNode;return o instanceof r.HTMLElement&&a.push({element:o,scrollTop:o.scrollTop,scrollLeft:o.scrollLeft}),a}function Qwe(e){for(var{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function e2e(e){var{hasBeenSelected:t,isLazy:n,isSelected:r,lazyBehavior:i="unmount"}=e;return!!(!n||r||i==="keepMounted"&&t)}var _V=1/60*1e3,t2e=typeof performance!="undefined"?function(){return performance.now()}:function(){return Date.now()},SV=typeof window!="undefined"?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(t2e())},_V)};function n2e(e){var t=[],n=[],r=0,i=!1,a=new WeakSet,o={schedule:function(s,u,l){u===void 0&&(u=!1),l===void 0&&(l=!1);var c=l&&i,f=c?t:n;return u&&a.add(s),f.indexOf(s)===-1&&(f.push(s),c&&i&&(r=t.length)),s},cancel:function(s){var u=n.indexOf(s);u!==-1&&n.splice(u,1),a.delete(s)},process:function(s){var u;if(i=!0,u=[n,t],t=u[0],n=u[1],n.length=0,r=t.length,r)for(var l=0;l<r;l++){var c=t[l];c(s),a.has(c)&&(o.schedule(c),e())}i=!1}};return o}var r2e=40,SD=!0,cy=!1,ED=!1,Zg={delta:0,timestamp:0},fy=["read","update","preRender","render","postRender"],c_=fy.reduce(function(e,t){return e[t]=n2e(function(){return cy=!0}),e},{}),Mu=fy.reduce(function(e,t){var n=c_[t];return e[t]=function(r,i,a){return i===void 0&&(i=!1),a===void 0&&(a=!1),cy||a2e(),n.schedule(r,i,a)},e},{}),dy=fy.reduce(function(e,t){return e[t]=c_[t].cancel,e},{}),Jg=fy.reduce(function(e,t){return e[t]=function(){return c_[t].process(Zg)},e},{}),i2e=function(e){return c_[e].process(Zg)},EV=function(e){cy=!1,Zg.delta=SD?_V:Math.max(Math.min(e-Zg.timestamp,r2e),1),Zg.timestamp=e,ED=!0,fy.forEach(i2e),ED=!1,cy&&(SD=!1,SV(EV))},a2e=function(){cy=!0,SD=!0,ED||SV(EV)},f_=function(){return Zg};Object.freeze(["base","sm","md","lg","xl","2xl"]);function hy(e,t){return pD(e)?e.map(n=>n===null?null:t(n)):Ps(e)?s_(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):e!=null?t(e):null}function o2e(e,t){function n(r,i){return i===void 0&&(i=[]),pD(r)?r.map((a,o)=>n(a,[...i,String(o)])):Ps(r)?Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,n(s,[...i,o])]})):t(r,i)}return n(e)}function s2e(e,t){if(e!=null){if(dV(e)){e(t);return}try{e.current=t}catch(n){throw new Error("Cannot assign value '"+t+"' to ref '"+e+"'")}}}function gf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=>{t.forEach(i=>s2e(i,r))}}function Pu(e){e===void 0&&(e={});var{strict:t=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=e,i=ha(void 0);i.displayName=r;function a(){var o=Un(i);if(!o&&t){var s=new Error(n);throw s.name="ContextError",Error.captureStackTrace==null||Error.captureStackTrace(s,a),s}return o}return[i.Provider,a,i]}function AD(e){return N2.toArray(e).filter(t=>mh(t))}var[u2e,l2e]=Pu({strict:!1,name:"PortalManagerContext"});function AV(e){var{children:t,zIndex:n}=e;return ue(u2e,{value:{zIndex:n}},t)}i_&&(AV.displayName="PortalManager");function CD(e){e===void 0&&(e=!1);var[t,n]=an(e),r=st(()=>{n(!0)},[]),i=st(()=>{n(!1)},[]),a=st(()=>{n(o=>!o)},[]);return[t,{on:r,off:i,toggle:a}]}var Qg=Xg?lf:qt;function py(e,t){t===void 0&&(t=[]);var n=Jt(e);return Qg(()=>{n.current=e}),st(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.current==null?void 0:n.current(...i)},t)}function c2e(e,t){var n=e!==void 0,r=n&&typeof e!="undefined"?e:t;return[n,r]}function f2e(e){var{value:t,defaultValue:n,onChange:r,shouldUpdate:i=(d,h)=>d!==h}=e,a=py(r),o=py(i),[s,u]=an(n),l=t!==void 0,c=l?t:s,f=st(d=>{var h=$s(d,c);!o(c,h)||(l||u(h),a(h))},[l,a,c,o]);return[c,f]}var CV={prefix:Math.round(Math.random()*1e10),current:0},kD=ha(CV),d2e=eW(e=>{var{children:t}=e,n=Un(kD),r=n===CV,i=gr(()=>({prefix:r?0:++n.prefix,current:0}),[r,n]);return ue(kD.Provider,{value:i},t)});function kV(e,t){var n=Un(kD);return gr(()=>e||[t,n.prefix,++n.current].filter(Boolean).join("-"),[e,t])}function h2e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=kV(e);return gr(()=>n.map(a=>a+"-"+i),[i,n])}function p2e(e,t){return t===void 0&&(t=[]),qt(()=>()=>e(),t)}function TV(){var e=Jt(!1),[t,n]=an(0);return p2e(()=>{e.current=!0}),st(()=>{e.current||n(t+1)},[t])}function TD(){return TD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},TD.apply(this,arguments)}function g2e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[OV,m2e]=Pu({strict:!1,name:"PortalContext"}),OD="chakra-portal",v2e=".chakra-portal",y2e=e=>ue("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0}},e.children),b2e=e=>{var{appendToParentPortal:t,children:n}=e,r=Jt(null),i=Jt(null),a=TV(),o=m2e(),s=l2e();Qg(()=>{if(!!r.current){var l=r.current.ownerDocument,c=t?o??l.body:l.body;if(!!c){i.current=l.createElement("div"),i.current.className=OD,c.appendChild(i.current),a();var f=i.current;return()=>{c.contains(f)&&c.removeChild(f)}}}},[]);var u=s!=null&&s.zIndex?ue(y2e,{zIndex:s==null?void 0:s.zIndex},n):n;return i.current?VN(ue(OV,{value:i.current},u),i.current):ue("span",{ref:r})},x2e=e=>{var{children:t,containerRef:n,appendToParentPortal:r}=e,i=n.current,a=i??(Xg?document.body:void 0),o=gr(()=>{var u=i==null?void 0:i.ownerDocument.createElement("div");return u&&(u.className=OD),u},[i]),s=TV();return Qg(()=>{s()},[]),Qg(()=>{if(!(!o||!a))return a.appendChild(o),()=>{a.removeChild(o)}},[o,a]),a&&o?VN(ue(OV,{value:r?o:null},t),o):null};function d_(e){var{containerRef:t}=e,n=g2e(e,["containerRef"]);return t?ue(x2e,TD({containerRef:t},n)):ue(b2e,n)}d_.defaultProps={appendToParentPortal:!0},d_.className=OD,d_.selector=v2e;var h_={light:"chakra-ui-light",dark:"chakra-ui-dark"},w2e={classList:{add:ly,remove:ly}},_2e=()=>Xg?document.body:w2e;function S2e(e){var t=_2e();t.classList.add(e?h_.dark:h_.light),t.classList.remove(e?h_.light:h_.dark)}function E2e(e){var t=window.matchMedia==null?void 0:window.matchMedia(e);if(!!t)return!!t.media===t.matches}var IV={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"};function A2e(e){var t,n=(t=E2e(IV.dark))!=null?t:e==="dark";return n?"dark":"light"}function C2e(e){if(!("matchMedia"in window))return ly;var t=window.matchMedia(IV.dark),n=()=>{e(t.matches?"dark":"light")};return n(),t.addListener(n),()=>{t.removeListener(n)}}var NV={get:()=>document.documentElement.style.getPropertyValue("--chakra-ui-color-mode"),set:e=>{Xg&&document.documentElement.style.setProperty("--chakra-ui-color-mode",e)}},DV=()=>typeof Storage!="undefined",RV="chakra-ui-color-mode",k2e={get(e){if(!DV())return e;try{var t=localStorage.getItem(RV);return t??e}catch(n){return e}},set(e){if(!!DV())try{localStorage.setItem(RV,e)}catch(t){}},type:"localStorage"},ID=ha({});i_&&(ID.displayName="ColorModeContext");var ND=()=>{var e=Un(ID);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e};function FV(e){var{value:t,children:n,options:{useSystemColorMode:r,initialColorMode:i},colorModeManager:a=k2e}=e,[o,s]=an(a.type==="cookie"?a.get(i):i);qt(()=>{if(Xg&&a.type==="localStorage"){var f=r?A2e(i):NV.get()||a.get();f&&s(f)}},[a,r,i]),qt(()=>{var f=o==="dark";S2e(f),NV.set(f?"dark":"light")},[o]);var u=st(f=>{a.set(f),s(f)},[a]),l=st(()=>{u(o==="light"?"dark":"light")},[o,u]);qt(()=>{var f;return r&&(f=C2e(u)),()=>{f&&r&&f()}},[u,r]);var c=gr(()=>({colorMode:t??o,toggleColorMode:t?ly:l,setColorMode:t?ly:u}),[o,u,l,t]);return ue(ID.Provider,{value:c},n)}i_&&(FV.displayName="ColorModeProvider");function T2e(e,t){var{colorMode:n}=ND();return n==="dark"?t:e}var O2e=(e,t)=>n=>{var r=String(t),i=e?e+"."+r:r;return Ps(n.__cssMap)&&i in n.__cssMap?n.__cssMap[i].varRef:t};function gy(e){var{scale:t,transform:n,compose:r}=e,i=(a,o)=>{var s,u=O2e(t,a)(o),l=(s=n==null?void 0:n(u,o))!=null?s:u;return r&&(l=r(l,o)),l};return i}function Ls(e,t){return n=>{var r={property:n,scale:e};return r.transform=gy({scale:e,transform:t}),r}}var I2e=e=>{var{rtl:t,ltr:n}=e;return r=>r.direction==="rtl"?t:n};function N2e(e){var{property:t,scale:n,transform:r}=e;return{scale:n,property:I2e(t),transform:n?gy({scale:n,compose:r}):r}}var MV=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function D2e(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...MV].join(" ")}function R2e(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...MV].join(" ")}var F2e={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},M2e={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function P2e(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var $2e={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},PV="& > :not(style) ~ :not(style)",L2e={[PV]:{marginInlineStart:"calc(var(--chakra-space-x) * calc(1 - var(--chakra-space-x-reverse)))",marginInlineEnd:"calc(var(--chakra-space-x) * var(--chakra-space-x-reverse))"}},B2e={[PV]:{marginTop:"calc(var(--chakra-space-y) * calc(1 - var(--chakra-space-y-reverse)))",marginBottom:"calc(var(--chakra-space-y) * var(--chakra-space-y-reverse))"}};function DD(e,t){DD=function(u,l){return new a(u,void 0,l)};var n=RD(RegExp),r=RegExp.prototype,i=new WeakMap;function a(s,u,l){var c=n.call(this,s,u);return i.set(c,l||i.get(s)),c}z2e(a,n),a.prototype.exec=function(s){var u=r.exec.call(this,s);return u&&(u.groups=o(u,this)),u},a.prototype[Symbol.replace]=function(s,u){if(typeof u=="string"){var l=i.get(this);return r[Symbol.replace].call(this,s,u.replace(/\$<([^>]+)>/g,function(f,d){return"$"+l[d]}))}else if(typeof u=="function"){var c=this;return r[Symbol.replace].call(this,s,function(){var f=[];return f.push.apply(f,arguments),typeof f[f.length-1]!="object"&&f.push(o(f,c)),u.apply(this,f)})}else return r[Symbol.replace].call(this,s,u)};function o(s,u){var l=i.get(u);return Object.keys(l).reduce(function(c,f){return c[f]=s[l[f]],c},Object.create(null))}return DD.apply(this,arguments)}function z2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&my(e,t)}function RD(e){var t=typeof Map=="function"?new Map:void 0;return RD=function(r){if(r===null||!U2e(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return p_(r,arguments,FD(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),my(i,r)},RD(e)}function p_(e,t,n){return j2e()?p_=Reflect.construct:p_=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&my(l,o.prototype),l},p_.apply(null,arguments)}function j2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function U2e(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function my(e,t){return my=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},my(e,t)}function FD(e){return FD=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},FD(e)}var MD={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},W2e=new Set(Object.values(MD)),$V=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),V2e=e=>e.trim();function q2e(e,t){var n,r;if(e==null||$V.has(e))return e;var i=DD(/(^[\x2DA-Za-z]+)\(((.*))\)/g,{type:1,values:2}),{type:a,values:o}=(n=(r=i.exec(e))==null?void 0:r.groups)!=null?n:{};if(!a||!o)return e;var s=a.includes("-gradient")?a:a+"-gradient",[u,...l]=o.split(",").map(V2e).filter(Boolean);if((l==null?void 0:l.length)===0)return e;var c=u in MD?MD[u]:u;l.unshift(c);var f=l.map(d=>{if(W2e.has(d))return d;var h=d.indexOf(" "),[p,g]=h!==-1?[d.substr(0,h),d.substr(h+1)]:[d],m=LV(g)?g:g&&g.split(" "),v="colors."+p,y=v in t.__cssMap?t.__cssMap[v].varRef:p;return m?[y,m].join(" "):y});return s+"("+f.join(", ")+")"}var LV=e=>gD(e)&&e.includes("(")&&e.includes(")"),H2e=(e,t)=>q2e(e,t??{}),G2e=e=>{var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}},$u=e=>t=>e+"("+t+")",$n={filter(e){return e!=="auto"?e:F2e},backdropFilter(e){return e!=="auto"?e:M2e},ring(e){return P2e($n.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?D2e():e==="auto-gpu"?R2e():e},px(e){if(e==null)return e;var{unitless:t}=G2e(e);return t||pf(e)?e+"px":e},fraction(e){return!pf(e)||e>1?e:e*100+"%"},float(e,t){var n={left:"right",right:"left"};return t.direction==="rtl"?n[e]:e},degree(e){if(pV(e)||e==null)return e;var t=gD(e)&&!e.endsWith("deg");return pf(e)||t?e+"deg":e},gradient:H2e,blur:$u("blur"),opacity:$u("opacity"),brightness:$u("brightness"),contrast:$u("contrast"),dropShadow:$u("drop-shadow"),grayscale:$u("grayscale"),hueRotate:$u("hue-rotate"),invert:$u("invert"),saturate:$u("saturate"),sepia:$u("sepia"),bgImage(e){if(e==null)return e;var t=LV(e)||$V.has(e);return t?e:"url("+e+")"},outline(e){var t=String(e)==="0"||String(e)==="none";return e!==null&&t?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var t,{space:n,divide:r}=(t=$2e[e])!=null?t:{},i={flexDirection:e};return n&&(i[n]=1),r&&(i[r]=1),i}};function PD(){return PD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PD.apply(this,arguments)}var se={borderWidths:Ls("borderWidths"),borderStyles:Ls("borderStyles"),colors:Ls("colors"),borders:Ls("borders"),radii:Ls("radii",$n.px),space:Ls("space",$n.px),spaceT:Ls("space",$n.px),degreeT(e){return{property:e,transform:$n.degree}},prop(e,t,n){return PD({property:e,scale:t},t&&{transform:gy({scale:t,transform:n})})},propT(e,t){return{property:e,transform:t}},sizes:Ls("sizes",$n.px),sizesT:Ls("sizes",$n.fraction),shadows:Ls("shadows"),logical:N2e,blur:Ls("blur",$n.blur)},g_={background:se.colors("background"),backgroundColor:se.colors("backgroundColor"),backgroundImage:se.propT("backgroundImage",$n.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:$n.bgClip},bgSize:se.prop("backgroundSize"),bgPosition:se.prop("backgroundPosition"),bg:se.colors("background"),bgColor:se.colors("backgroundColor"),bgPos:se.prop("backgroundPosition"),bgRepeat:se.prop("backgroundRepeat"),bgAttachment:se.prop("backgroundAttachment"),bgGradient:se.propT("backgroundImage",$n.gradient),bgClip:{transform:$n.bgClip}};Object.assign(g_,{bgImage:g_.backgroundImage,bgImg:g_.backgroundImage});var kn={border:se.borders("border"),borderWidth:se.borderWidths("borderWidth"),borderStyle:se.borderStyles("borderStyle"),borderColor:se.colors("borderColor"),borderRadius:se.radii("borderRadius"),borderTop:se.borders("borderTop"),borderBlockStart:se.borders("borderBlockStart"),borderTopLeftRadius:se.radii("borderTopLeftRadius"),borderStartStartRadius:se.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:se.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:se.radii("borderTopRightRadius"),borderStartEndRadius:se.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:se.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:se.borders("borderRight"),borderInlineEnd:se.borders("borderInlineEnd"),borderBottom:se.borders("borderBottom"),borderBlockEnd:se.borders("borderBlockEnd"),borderBottomLeftRadius:se.radii("borderBottomLeftRadius"),borderBottomRightRadius:se.radii("borderBottomRightRadius"),borderLeft:se.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:se.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:se.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:se.borders(["borderLeft","borderRight"]),borderInline:se.borders("borderInline"),borderY:se.borders(["borderTop","borderBottom"]),borderBlock:se.borders("borderBlock"),borderTopWidth:se.borderWidths("borderTopWidth"),borderBlockStartWidth:se.borderWidths("borderBlockStartWidth"),borderTopColor:se.colors("borderTopColor"),borderBlockStartColor:se.colors("borderBlockStartColor"),borderTopStyle:se.borderStyles("borderTopStyle"),borderBlockStartStyle:se.borderStyles("borderBlockStartStyle"),borderBottomWidth:se.borderWidths("borderBottomWidth"),borderBlockEndWidth:se.borderWidths("borderBlockEndWidth"),borderBottomColor:se.colors("borderBottomColor"),borderBlockEndColor:se.colors("borderBlockEndColor"),borderBottomStyle:se.borderStyles("borderBottomStyle"),borderBlockEndStyle:se.borderStyles("borderBlockEndStyle"),borderLeftWidth:se.borderWidths("borderLeftWidth"),borderInlineStartWidth:se.borderWidths("borderInlineStartWidth"),borderLeftColor:se.colors("borderLeftColor"),borderInlineStartColor:se.colors("borderInlineStartColor"),borderLeftStyle:se.borderStyles("borderLeftStyle"),borderInlineStartStyle:se.borderStyles("borderInlineStartStyle"),borderRightWidth:se.borderWidths("borderRightWidth"),borderInlineEndWidth:se.borderWidths("borderInlineEndWidth"),borderRightColor:se.colors("borderRightColor"),borderInlineEndColor:se.colors("borderInlineEndColor"),borderRightStyle:se.borderStyles("borderRightStyle"),borderInlineEndStyle:se.borderStyles("borderInlineEndStyle"),borderTopRadius:se.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:se.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:se.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:se.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(kn,{rounded:kn.borderRadius,roundedTop:kn.borderTopRadius,roundedTopLeft:kn.borderTopLeftRadius,roundedTopRight:kn.borderTopRightRadius,roundedTopStart:kn.borderStartStartRadius,roundedTopEnd:kn.borderStartEndRadius,roundedBottom:kn.borderBottomRadius,roundedBottomLeft:kn.borderBottomLeftRadius,roundedBottomRight:kn.borderBottomRightRadius,roundedBottomStart:kn.borderEndStartRadius,roundedBottomEnd:kn.borderEndEndRadius,roundedLeft:kn.borderLeftRadius,roundedRight:kn.borderRightRadius,roundedStart:kn.borderInlineStartRadius,roundedEnd:kn.borderInlineEndRadius,borderStart:kn.borderInlineStart,borderEnd:kn.borderInlineEnd,borderTopStartRadius:kn.borderStartStartRadius,borderTopEndRadius:kn.borderStartEndRadius,borderBottomStartRadius:kn.borderEndStartRadius,borderBottomEndRadius:kn.borderEndEndRadius,borderStartRadius:kn.borderInlineStartRadius,borderEndRadius:kn.borderInlineEndRadius,borderStartWidth:kn.borderInlineStartWidth,borderEndWidth:kn.borderInlineEndWidth,borderStartColor:kn.borderInlineStartColor,borderEndColor:kn.borderInlineEndColor,borderStartStyle:kn.borderInlineStartStyle,borderEndStyle:kn.borderInlineEndStyle});var K2e={color:se.colors("color"),textColor:se.colors("color"),fill:se.colors("fill"),stroke:se.colors("stroke")},$D={boxShadow:se.shadows("boxShadow"),mixBlendMode:!0,blendMode:se.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:se.prop("backgroundBlendMode"),opacity:!0};Object.assign($D,{shadow:$D.boxShadow});var X2e={filter:{transform:$n.filter},blur:se.blur("--chakra-blur"),brightness:se.propT("--chakra-brightness",$n.brightness),contrast:se.propT("--chakra-contrast",$n.contrast),hueRotate:se.degreeT("--chakra-hue-rotate"),invert:se.propT("--chakra-invert",$n.invert),saturate:se.propT("--chakra-saturate",$n.saturate),dropShadow:se.propT("--chakra-drop-shadow",$n.dropShadow),backdropFilter:{transform:$n.backdropFilter},backdropBlur:se.blur("--chakra-backdrop-blur"),backdropBrightness:se.propT("--chakra-backdrop-brightness",$n.brightness),backdropContrast:se.propT("--chakra-backdrop-contrast",$n.contrast),backdropHueRotate:se.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:se.propT("--chakra-backdrop-invert",$n.invert),backdropSaturate:se.propT("--chakra-backdrop-saturate",$n.saturate)},m_={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:$n.flexDirection},experimental_spaceX:{static:L2e,transform:gy({scale:"space",transform:e=>e!==null?{"--chakra-space-x":e}:null})},experimental_spaceY:{static:B2e,transform:gy({scale:"space",transform:e=>e!=null?{"--chakra-space-y":e}:null})},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:se.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0};Object.assign(m_,{flexDir:m_.flexDirection});var BV={gridGap:se.space("gridGap"),gridColumnGap:se.space("gridColumnGap"),gridRowGap:se.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},Y2e={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:$n.outline},outlineOffset:!0,outlineColor:se.colors("outlineColor")},is={width:se.sizesT("width"),inlineSize:se.sizesT("inlineSize"),height:se.sizes("height"),blockSize:se.sizes("blockSize"),boxSize:se.sizes(["width","height"]),minWidth:se.sizes("minWidth"),minInlineSize:se.sizes("minInlineSize"),minHeight:se.sizes("minHeight"),minBlockSize:se.sizes("minBlockSize"),maxWidth:se.sizes("maxWidth"),maxInlineSize:se.sizes("maxInlineSize"),maxHeight:se.sizes("maxHeight"),maxBlockSize:se.sizes("maxBlockSize"),d:se.prop("display"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:se.propT("float",$n.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(is,{w:is.width,h:is.height,minW:is.minWidth,maxW:is.maxWidth,minH:is.minHeight,maxH:is.maxHeight,overscroll:is.overscrollBehavior,overscrollX:is.overscrollBehaviorX,overscrollY:is.overscrollBehaviorY});var Z2e={listStyleType:!0,listStylePosition:!0,listStylePos:se.prop("listStylePosition"),listStyleImage:!0,listStyleImg:se.prop("listStyleImage")},J2e={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},Q2e={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},LD=(e,t,n)=>{var r={},i=a_(e,t,{});for(var a in i){var o=a in n&&n[a]!=null;o||(r[a]=i[a])}return r},e_e={srOnly:{transform(e){return e===!0?J2e:e==="focusable"?Q2e:{}}},layerStyle:{processResult:!0,transform:(e,t,n)=>LD(t,"layerStyles."+e,n)},textStyle:{processResult:!0,transform:(e,t,n)=>LD(t,"textStyles."+e,n)},apply:{processResult:!0,transform:(e,t,n)=>LD(t,e,n)}},vy={position:!0,pos:se.prop("position"),zIndex:se.prop("zIndex","zIndices"),inset:se.spaceT(["top","right","bottom","left"]),insetX:se.spaceT(["left","right"]),insetInline:se.spaceT("insetInline"),insetY:se.spaceT(["top","bottom"]),insetBlock:se.spaceT("insetBlock"),top:se.spaceT("top"),insetBlockStart:se.spaceT("insetBlockStart"),bottom:se.spaceT("bottom"),insetBlockEnd:se.spaceT("insetBlockEnd"),left:se.spaceT("left"),insetInlineStart:se.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:se.spaceT("right"),insetInlineEnd:se.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(vy,{insetStart:vy.insetInlineStart,insetEnd:vy.insetInlineEnd});var t_e={ring:{transform:$n.ring},ringColor:se.colors("--chakra-ring-color"),ringOffset:se.prop("--chakra-ring-offset-width"),ringOffsetColor:se.colors("--chakra-ring-offset-color"),ringInset:se.prop("--chakra-ring-inset")},nr={margin:se.spaceT("margin"),marginTop:se.spaceT("marginTop"),marginBlockStart:se.spaceT("marginBlockStart"),marginRight:se.spaceT("marginRight"),marginInlineEnd:se.spaceT("marginInlineEnd"),marginBottom:se.spaceT("marginBottom"),marginBlockEnd:se.spaceT("marginBlockEnd"),marginLeft:se.spaceT("marginLeft"),marginInlineStart:se.spaceT("marginInlineStart"),marginX:se.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:se.spaceT("marginInline"),marginY:se.spaceT(["marginTop","marginBottom"]),marginBlock:se.spaceT("marginBlock"),padding:se.space("padding"),paddingTop:se.space("paddingTop"),paddingBlockStart:se.space("paddingBlockStart"),paddingRight:se.space("paddingRight"),paddingBottom:se.space("paddingBottom"),paddingBlockEnd:se.space("paddingBlockEnd"),paddingLeft:se.space("paddingLeft"),paddingInlineStart:se.space("paddingInlineStart"),paddingInlineEnd:se.space("paddingInlineEnd"),paddingX:se.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:se.space("paddingInline"),paddingY:se.space(["paddingTop","paddingBottom"]),paddingBlock:se.space("paddingBlock")};Object.assign(nr,{m:nr.margin,mt:nr.marginTop,mr:nr.marginRight,me:nr.marginInlineEnd,marginEnd:nr.marginInlineEnd,mb:nr.marginBottom,ml:nr.marginLeft,ms:nr.marginInlineStart,marginStart:nr.marginInlineStart,mx:nr.marginX,my:nr.marginY,p:nr.padding,pt:nr.paddingTop,py:nr.paddingY,px:nr.paddingX,pb:nr.paddingBottom,pl:nr.paddingLeft,ps:nr.paddingInlineStart,paddingStart:nr.paddingInlineStart,pr:nr.paddingRight,pe:nr.paddingInlineEnd,paddingEnd:nr.paddingInlineEnd});var n_e={textDecorationColor:se.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:se.shadows("textShadow")},r_e={clipPath:!0,transform:se.propT("transform",$n.transform),transformOrigin:!0,translateX:se.spaceT("--chakra-translate-x"),translateY:se.spaceT("--chakra-translate-y"),skewX:se.degreeT("--chakra-skew-x"),skewY:se.degreeT("--chakra-skew-y"),scaleX:se.prop("--chakra-scale-x"),scaleY:se.prop("--chakra-scale-y"),scale:se.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:se.degreeT("--chakra-rotate")},i_e={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:se.prop("transitionDuration","transition.duration"),transitionProperty:se.prop("transitionProperty","transition.property"),transitionTimingFunction:se.prop("transitionTimingFunction","transition.easing")},a_e={fontFamily:se.prop("fontFamily","fonts"),fontSize:se.prop("fontSize","fontSizes",$n.px),fontWeight:se.prop("fontWeight","fontWeights"),lineHeight:se.prop("lineHeight","lineHeights"),letterSpacing:se.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"},isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}},em={hover:e=>e+":hover &, "+e+"[data-hover] &",focus:e=>e+":focus &, "+e+"[data-focus] &",active:e=>e+":active &, "+e+"[data-active] &",disabled:e=>e+":disabled &, "+e+"[data-disabled] &",invalid:e=>e+":invalid &, "+e+"[data-invalid] &",checked:e=>e+":checked &, "+e+"[data-checked] &",indeterminate:e=>e+":indeterminate &, "+e+"[aria-checked=mixed] &, "+e+"[data-indeterminate] &",readOnly:e=>e+":read-only &, "+e+"[readonly] &, "+e+"[data-read-only] &",expanded:e=>e+":read-only &, "+e+"[aria-expanded=true] &, "+e+"[data-expanded] &"},tm=e=>o_e(e,"[role=group]","[data-group]",".group"),o_e=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(t).join(", ")},BD={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible",_disabled:"&[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:tm(em.hover),_groupFocus:tm(em.focus),_groupActive:tm(em.active),_groupDisabled:tm(em.disabled),_groupInvalid:tm(em.invalid),_groupChecked:tm(em.checked),_placeholder:"&::placeholder",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &",_mediaDark:"@media (prefers-color-scheme: dark)",_dark:".chakra-ui-dark &, [data-theme=dark] &, &[data-theme=dark]",_light:".chakra-ui-light &, [data-theme=light] &, &[data-theme=light]"},s_e=s_(BD);function zD(){return zD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zD.apply(this,arguments)}var jD=Zl({},g_,kn,K2e,m_,is,X2e,t_e,Y2e,BV,e_e,vy,$D,nr,a_e,n_e,r_e,Z2e,i_e),u_e=Object.assign({},nr,is,m_,BV,vy),l_e=s_(u_e),c_e=[...s_(jD),...s_e],f_e=zD({},jD,BD),d_e=e=>e in f_e,h_e=e=>t=>{if(!t.__breakpoints)return e;var{isResponsive:n,toArrayValue:r,media:i}=t.__breakpoints,a={};for(var o in e){var s=$s(e[o],t);if(s!=null){if(s=Ps(s)&&n(s)?r(s):s,!Array.isArray(s)){a[o]=s;continue}for(var u=s.slice(0,i.length).length,l=0;l<u;l+=1){var c=i==null?void 0:i[l];if(!c){a[o]=s[l];continue}a[c]=a[c]||{},s[l]!=null&&(a[c][o]=s[l])}}}return a},p_e=(e,t)=>e.startsWith("--")&&gD(t)&&!pV(t),g_e=(e,t)=>{var n,r;if(t==null)return t;var i=l=>{var c,f;return(c=e.__cssMap)==null||(f=c[l])==null?void 0:f.varRef},a=l=>{var c;return(c=i(l))!=null?c:l},o=t.split(",").map(l=>l.trim()),[s,u]=o;return t=(n=(r=i(s))!=null?r:a(u))!=null?n:a(t),t};function m_e(e){var{configs:t={},pseudos:n={},theme:r}=e,i=function a(o,s){s===void 0&&(s=!1);var u=$s(o,r),l=h_e(u)(r),c={};for(var f in l){var d,h,p,g,m,v=l[f],y=$s(v,r);f in n&&(f=n[f]),p_e(f,y)&&(y=g_e(r,y));var b=t[f];if(b===!0&&(b={property:f}),Ps(y)){var x;c[f]=(x=c[f])!=null?x:{},c[f]=Zl({},c[f],a(y,!0));continue}var w=(d=(h=b)==null||h.transform==null?void 0:h.transform(y,r,u))!=null?d:y;w=(p=b)!=null&&p.processResult?a(w,!0):w;var S=$s((g=b)==null?void 0:g.property,r);if(!s&&(m=b)!=null&&m.static){var A=$s(b.static,r);c=Zl({},c,A)}if(S&&Array.isArray(S)){for(var _ of S)c[_]=w;continue}if(S){S==="&"&&Ps(w)?c=Zl({},c,w):c[S]=w;continue}if(Ps(w)){c=Zl({},c,w);continue}c[f]=w}return c};return i}var zV=e=>t=>{var n=m_e({theme:t,pseudos:BD,configs:jD});return n(e)};function jV(e){return Ps(e)&&e.reference?e.reference:String(e)}var v_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(jV).join(" "+t+" ").replace(/calc/g,"")},UV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("+",...n)+")"},WV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("-",...n)+")"},UD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("*",...n)+")"},VV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("/",...n)+")"},qV=e=>{var t=jV(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:UD(t,-1)},bh=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(UV(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(WV(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(UD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(VV(e,...r))},negate:()=>bh(qV(e)),toString:()=>e.toString()}),{add:UV,subtract:WV,multiply:UD,divide:VV,negate:qV});function v_e(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function HV(e){var t=v_e(e.toString());if(t.includes("\\."))return e;var n=!Number.isInteger(parseFloat(e.toString()));return n?t.replace(".","\\."):e}function y_e(e,t){return t===void 0&&(t=""),[t,HV(e)].filter(Boolean).join("-")}function b_e(e,t){return"var("+HV(e)+(t?", "+t:"")+")"}function x_e(e,t){return t===void 0&&(t=""),"--"+y_e(e,t)}function GV(e,t,n){var r=x_e(e,n);return{variable:r,reference:b_e(r,t)}}function WD(){return WD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WD.apply(this,arguments)}function w_e(e,t){var n={cssMap:{},cssVars:{}};return o2e(e,(r,i)=>{var a,[o]=i,s=(a=VD[o])!=null?a:VD.defaultHandler,{cssVars:u,cssMap:l}=s(i,r,t);Object.assign(n.cssVars,u),Object.assign(n.cssMap,l)}),n}var VD={space:(e,t,n)=>{var r=VD.defaultHandler(e,t,n),[i,...a]=e,o=i+".-"+a.join("."),s=e.join("-"),{variable:u,reference:l}=GV(s,void 0,n.cssVarPrefix),c=bh.negate(t),f=bh.negate(l);return{cssVars:r.cssVars,cssMap:WD({},r.cssMap,{[o]:{value:""+c,var:""+u,varRef:f}})}},defaultHandler:(e,t,n)=>{var r=e.join("."),i=e.join("-"),{variable:a,reference:o}=GV(i,void 0,n.cssVarPrefix);return{cssVars:{[a]:t},cssMap:{[r]:{value:t,var:a,varRef:o}}}}};function __e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var S_e=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur"];function E_e(e){var t=S_e;return Iwe(e,t)}function A_e(e){var t=__e(e,["__cssMap","__cssVars","__breakpoints"]);return t}function qD(){return qD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qD.apply(this,arguments)}function C_e(e){var t,n=A_e(e),r=E_e(n),i=(t=n.config)==null?void 0:t.cssVarPrefix,{cssMap:a,cssVars:o}=w_e(r,{cssVarPrefix:i}),s={"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"};return Object.assign(n,{__cssVars:qD({},s,o),__cssMap:a,__breakpoints:Lwe(n.breakpoints)}),n}var k_e=typeof Element!="undefined",T_e=typeof Map=="function",O_e=typeof Set=="function",I_e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function y_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(!y_(e[r],t[r]))return!1;return!0}var a;if(T_e&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;for(a=e.entries();!(r=a.next()).done;)if(!y_(r.value[1],t.get(r.value[0])))return!1;return!0}if(O_e&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(I_e&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(k_e&&e instanceof Element)return!1;for(r=n;r--!=0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!y_(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var N_e=function(t,n){try{return y_(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},D_e=e=>{var{cssVarsRoot:t=":host, :root",theme:n,children:r}=e,i=gr(()=>C_e(n),[n]);return ue(Ewe,{theme:i},ue(hD,{styles:a=>({[t]:a.__cssVars})}),r)};function KV(){var e=Un(uy);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var[yy,yi]=Pu({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "}),R_e=()=>{var{colorMode:e}=ND();return ue(hD,{styles:t=>{var n=a_(t,"styles.global"),r=$s(n,{theme:t,colorMode:e});if(!!r){var i=zV(r)(t);return i}}})},F_e=["a","b","article","aside","blockquote","button","caption","cite","circle","code","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","img","input","kbd","label","li","main","mark","nav","ol","p","path","pre","q","rect","s","svg","section","select","strong","small","span","sub","sup","table","tbody","td","textarea","tfoot","th","thead","tr","ul"];function ko(e){return vD(e,["styleConfig","size","variant","colorScheme"])}function HD(){return HD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HD.apply(this,arguments)}function M_e(){var e=ND(),t=KV();return HD({},e,{theme:t})}var P_e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,$_e=JW(function(e){return P_e.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),L_e=$_e,B_e=function(t){return t!=="theme"},XV=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?L_e:B_e},YV=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},z_e=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,o;n!==void 0&&(a=n.label,o=n.target);var s=YV(t,n,r),u=s||XV(i),l=!u("as");return function(){var c=arguments,f=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),c[0]==null||c[0].raw===void 0)f.push.apply(f,c);else{f.push(c[0][0]);for(var d=c.length,h=1;h<d;h++)f.push(c[h],c[0][h])}var p=cV(function(g,m,v){var y=l&&g.as||i,b="",x=[],w=g;if(g.theme==null){w={};for(var S in g)w[S]=g[S];w.theme=Un(uy)}typeof g.className=="string"?b=mwe(m.registered,x,g.className):g.className!=null&&(b=g.className+" ");var A=dD(f.concat(x),m.registered,w);iV(m,A,typeof y=="string"),b+=m.key+"-"+A.name,o!==void 0&&(b+=" "+o);var _=l&&s===void 0?XV(y):u,E={};for(var C in g)l&&C==="as"||_(C)&&(E[C]=g[C]);E.className=b,E.ref=v;var k=ue(y,E);return k});return p.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=i,p.__emotion_styles=f,p.__emotion_forwardProp=s,Object.defineProperty(p,"toString",{value:function(){return"."+o}}),p.withComponent=function(g,m){return e(g,yh({},n,m,{shouldForwardProp:YV(p,m,!0)})).apply(void 0,f)},p}},j_e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],GD=z_e.bind();j_e.forEach(function(e){GD[e]=GD(e)});var U_e=new Set([...c_e,"textStyle","layerStyle","apply","isTruncated","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),W_e=new Set(["htmlWidth","htmlHeight","htmlSize"]),V_e=e=>W_e.has(e)||!U_e.has(e);function ZV(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var q_e=e=>{var{baseStyle:t}=e;return n=>{var{css:r,__css:i,sx:a}=n,o=ZV(n,["theme","css","__css","sx"]),s=gV(o,(f,d)=>d_e(d)),u=$s(t,n),l=Object.assign({},i,u,o_(s),a),c=zV(l)(n.theme);return r?[c,r]:c}};function H_e(e,t){var n=t??{},{baseStyle:r}=n,i=ZV(n,["baseStyle"]);i.shouldForwardProp||(i.shouldForwardProp=V_e);var a=q_e({baseStyle:r});return GD(e,i)(a)}var xt=H_e;F_e.forEach(e=>{xt[e]=xt(e)});function Mt(e){return Kl(e)}function G_e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function xh(e,t,n){var r;t===void 0&&(t={}),n===void 0&&(n={});var{styleConfig:i}=t,a=G_e(t,["styleConfig"]),{theme:o,colorMode:s}=M_e(),u=a_(o,"components."+e),l=i||u,c=Zl({theme:o,colorMode:s},(r=l==null?void 0:l.defaultProps)!=null?r:{},o_(vD(a,["children"]))),f=Jt({});if(l){var d,h,p,g,m,v,y=$s((d=l.baseStyle)!=null?d:{},c),b=$s((h=(p=l.variants)==null?void 0:p[c.variant])!=null?h:{},c),x=$s((g=(m=l.sizes)==null?void 0:m[c.size])!=null?g:{},c),w=Zl({},y,x,b);(v=n)!=null&&v.isMultiPart&&l.parts&&l.parts.forEach(A=>{var _;w[A]=(_=w[A])!=null?_:{}});var S=N_e(f.current,w);S||(f.current=w)}return f.current}function mf(e,t){return xh(e,t,{isMultiPart:!0})}var K_e={body:{classList:{add(){},remove(){}}},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}}},JV=K_e,nm=()=>{},X_e={document:JV,navigator:{userAgent:""},CustomEvent:function(){return this},addEventListener:nm,removeEventListener:nm,getComputedStyle(){return{getPropertyValue(){return""}}},matchMedia(){return{matches:!1,addListener:nm,removeListener:nm}},requestAnimationFrame(e){return typeof setTimeout=="undefined"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout!="undefined"&&clearTimeout(e)},setTimeout:()=>0,clearTimeout:nm,setInterval:()=>0,clearInterval:nm},Y_e=X_e,Z_e={window:Y_e,document:JV},QV=Xg?{window,document}:Z_e,J_e=ha(QV);function Q_e(e){var{children:t,environment:n}=e,[r,i]=an(null),a=gr(()=>{var s,u=r==null?void 0:r.ownerDocument,l=r==null?void 0:r.ownerDocument.defaultView,c=u?{document:u,window:l}:void 0,f=(s=n??c)!=null?s:QV;return f},[r,n]),o=!r&&!n;return zt.createElement(J_e.Provider,{value:a},t,o&&zt.createElement("span",{ref:s=>{s&&i(s)}}))}var eSe=e=>{var{children:t,colorModeManager:n,portalZIndex:r,resetCSS:i=!0,theme:a={},environment:o,cssVarsRoot:s}=e,u=ue(Q_e,{environment:o},t);return ue(d2e,null,ue(D_e,{theme:a,cssVarsRoot:s},ue(FV,{colorModeManager:n,options:a.config},i&&ue(kwe,null),ue(R_e,null),r?ue(AV,{zIndex:r},u):u)))},eq={exports:{}};(function(e){(function(t){var n=/^\s+/,r=/\s+$/,i=0,a=t.round,o=t.min,s=t.max,u=t.random;function l(M,B){if(M=M||"",B=B||{},M instanceof l)return M;if(!(this instanceof l))return new l(M,B);var R=c(M);this._originalInput=M,this._r=R.r,this._g=R.g,this._b=R.b,this._a=R.a,this._roundA=a(100*this._a)/100,this._format=B.format||R.format,this._gradientType=B.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=R.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var M=this.toRgb();return(M.r*299+M.g*587+M.b*114)/1e3},getLuminance:function(){var M=this.toRgb(),B,R,X,ge,xe,ze;return B=M.r/255,R=M.g/255,X=M.b/255,B<=.03928?ge=B/12.92:ge=t.pow((B+.055)/1.055,2.4),R<=.03928?xe=R/12.92:xe=t.pow((R+.055)/1.055,2.4),X<=.03928?ze=X/12.92:ze=t.pow((X+.055)/1.055,2.4),.2126*ge+.7152*xe+.0722*ze},setAlpha:function(M){return this._a=G(M),this._roundA=a(100*this._a)/100,this},toHsv:function(){var M=p(this._r,this._g,this._b);return{h:M.h*360,s:M.s,v:M.v,a:this._a}},toHsvString:function(){var M=p(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.v*100);return this._a==1?"hsv("+B+", "+R+"%, "+X+"%)":"hsva("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHsl:function(){var M=d(this._r,this._g,this._b);return{h:M.h*360,s:M.s,l:M.l,a:this._a}},toHslString:function(){var M=d(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.l*100);return this._a==1?"hsl("+B+", "+R+"%, "+X+"%)":"hsla("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHex:function(M){return m(this._r,this._g,this._b,M)},toHexString:function(M){return"#"+this.toHex(M)},toHex8:function(M){return v(this._r,this._g,this._b,this._a,M)},toHex8String:function(M){return"#"+this.toHex8(M)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(K(this._r,255)*100)+"%",g:a(K(this._g,255)*100)+"%",b:a(K(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%)":"rgba("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:L[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(M){var B="#"+y(this._r,this._g,this._b,this._a),R=B,X=this._gradientType?"GradientType = 1, ":"";if(M){var ge=l(M);R="#"+y(ge._r,ge._g,ge._b,ge._a)}return"progid:DXImageTransform.Microsoft.gradient("+X+"startColorstr="+B+",endColorstr="+R+")"},toString:function(M){var B=!!M;M=M||this._format;var R=!1,X=this._a<1&&this._a>=0,ge=!B&&X&&(M==="hex"||M==="hex6"||M==="hex3"||M==="hex4"||M==="hex8"||M==="name");return ge?M==="name"&&this._a===0?this.toName():this.toRgbString():(M==="rgb"&&(R=this.toRgbString()),M==="prgb"&&(R=this.toPercentageRgbString()),(M==="hex"||M==="hex6")&&(R=this.toHexString()),M==="hex3"&&(R=this.toHexString(!0)),M==="hex4"&&(R=this.toHex8String(!0)),M==="hex8"&&(R=this.toHex8String()),M==="name"&&(R=this.toName()),M==="hsl"&&(R=this.toHslString()),M==="hsv"&&(R=this.toHsvString()),R||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(M,B){var R=M.apply(null,[this].concat([].slice.call(B)));return this._r=R._r,this._g=R._g,this._b=R._b,this.setAlpha(R._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(A,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(M,B){return M.apply(null,[this].concat([].slice.call(B)))},analogous:function(){return this._applyCombination(N,arguments)},complement:function(){return this._applyCombination(C,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},l.fromRatio=function(M,B){if(typeof M=="object"){var R={};for(var X in M)M.hasOwnProperty(X)&&(X==="a"?R[X]=M[X]:R[X]=Re(M[X]));M=R}return l(M,B)};function c(M){var B={r:0,g:0,b:0},R=1,X=null,ge=null,xe=null,ze=!1,Ke=!1;return typeof M=="string"&&(M=ae(M)),typeof M=="object"&&(V(M.r)&&V(M.g)&&V(M.b)?(B=f(M.r,M.g,M.b),ze=!0,Ke=String(M.r).substr(-1)==="%"?"prgb":"rgb"):V(M.h)&&V(M.s)&&V(M.v)?(X=Re(M.s),ge=Re(M.v),B=g(M.h,X,ge),ze=!0,Ke="hsv"):V(M.h)&&V(M.s)&&V(M.l)&&(X=Re(M.s),xe=Re(M.l),B=h(M.h,X,xe),ze=!0,Ke="hsl"),M.hasOwnProperty("a")&&(R=M.a)),R=G(R),{ok:ze,format:M.format||Ke,r:o(255,s(B.r,0)),g:o(255,s(B.g,0)),b:o(255,s(B.b,0)),a:R}}function f(M,B,R){return{r:K(M,255)*255,g:K(B,255)*255,b:K(R,255)*255}}function d(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=(X+ge)/2;if(X==ge)xe=ze=0;else{var Ze=X-ge;switch(ze=Ke>.5?Ze/(2-X-ge):Ze/(X+ge),X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,l:Ke}}function h(M,B,R){var X,ge,xe;M=K(M,360),B=K(B,100),R=K(R,100);function ze(Bt,Je,Zt){return Zt<0&&(Zt+=1),Zt>1&&(Zt-=1),Zt<1/6?Bt+(Je-Bt)*6*Zt:Zt<1/2?Je:Zt<2/3?Bt+(Je-Bt)*(2/3-Zt)*6:Bt}if(B===0)X=ge=xe=R;else{var Ke=R<.5?R*(1+B):R+B-R*B,Ze=2*R-Ke;X=ze(Ze,Ke,M+1/3),ge=ze(Ze,Ke,M),xe=ze(Ze,Ke,M-1/3)}return{r:X*255,g:ge*255,b:xe*255}}function p(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=X,Ze=X-ge;if(ze=X===0?0:Ze/X,X==ge)xe=0;else{switch(X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,v:Ke}}function g(M,B,R){M=K(M,360)*6,B=K(B,100),R=K(R,100);var X=t.floor(M),ge=M-X,xe=R*(1-B),ze=R*(1-ge*B),Ke=R*(1-(1-ge)*B),Ze=X%6,Bt=[R,ze,xe,xe,Ke,R][Ze],Je=[Ke,R,R,ze,xe,xe][Ze],Zt=[xe,xe,Ke,R,R,ze][Ze];return{r:Bt*255,g:Je*255,b:Zt*255}}function m(M,B,R,X){var ge=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return X&&ge[0].charAt(0)==ge[0].charAt(1)&&ge[1].charAt(0)==ge[1].charAt(1)&&ge[2].charAt(0)==ge[2].charAt(1)?ge[0].charAt(0)+ge[1].charAt(0)+ge[2].charAt(0):ge.join("")}function v(M,B,R,X,ge){var xe=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16)),Te(me(X))];return ge&&xe[0].charAt(0)==xe[0].charAt(1)&&xe[1].charAt(0)==xe[1].charAt(1)&&xe[2].charAt(0)==xe[2].charAt(1)&&xe[3].charAt(0)==xe[3].charAt(1)?xe[0].charAt(0)+xe[1].charAt(0)+xe[2].charAt(0)+xe[3].charAt(0):xe.join("")}function y(M,B,R,X){var ge=[Te(me(X)),Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return ge.join("")}l.equals=function(M,B){return!M||!B?!1:l(M).toRgbString()==l(B).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s-=B/100,R.s=ee(R.s),l(R)}function x(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s+=B/100,R.s=ee(R.s),l(R)}function w(M){return l(M).desaturate(100)}function S(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l+=B/100,R.l=ee(R.l),l(R)}function A(M,B){B=B===0?0:B||10;var R=l(M).toRgb();return R.r=s(0,o(255,R.r-a(255*-(B/100)))),R.g=s(0,o(255,R.g-a(255*-(B/100)))),R.b=s(0,o(255,R.b-a(255*-(B/100)))),l(R)}function _(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l-=B/100,R.l=ee(R.l),l(R)}function E(M,B){var R=l(M).toHsl(),X=(R.h+B)%360;return R.h=X<0?360+X:X,l(R)}function C(M){var B=l(M).toHsl();return B.h=(B.h+180)%360,l(B)}function k(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+120)%360,s:B.s,l:B.l}),l({h:(R+240)%360,s:B.s,l:B.l})]}function T(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+90)%360,s:B.s,l:B.l}),l({h:(R+180)%360,s:B.s,l:B.l}),l({h:(R+270)%360,s:B.s,l:B.l})]}function I(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+72)%360,s:B.s,l:B.l}),l({h:(R+216)%360,s:B.s,l:B.l})]}function N(M,B,R){B=B||6,R=R||30;var X=l(M).toHsl(),ge=360/R,xe=[l(M)];for(X.h=(X.h-(ge*B>>1)+720)%360;--B;)X.h=(X.h+ge)%360,xe.push(l(X));return xe}function O(M,B){B=B||6;for(var R=l(M).toHsv(),X=R.h,ge=R.s,xe=R.v,ze=[],Ke=1/B;B--;)ze.push(l({h:X,s:ge,v:xe})),xe=(xe+Ke)%1;return ze}l.mix=function(M,B,R){R=R===0?0:R||50;var X=l(M).toRgb(),ge=l(B).toRgb(),xe=R/100,ze={r:(ge.r-X.r)*xe+X.r,g:(ge.g-X.g)*xe+X.g,b:(ge.b-X.b)*xe+X.b,a:(ge.a-X.a)*xe+X.a};return l(ze)},l.readability=function(M,B){var R=l(M),X=l(B);return(t.max(R.getLuminance(),X.getLuminance())+.05)/(t.min(R.getLuminance(),X.getLuminance())+.05)},l.isReadable=function(M,B,R){var X=l.readability(M,B),ge,xe;switch(xe=!1,ge=Y(R),ge.level+ge.size){case"AAsmall":case"AAAlarge":xe=X>=4.5;break;case"AAlarge":xe=X>=3;break;case"AAAsmall":xe=X>=7;break}return xe},l.mostReadable=function(M,B,R){var X=null,ge=0,xe,ze,Ke,Ze;R=R||{},ze=R.includeFallbackColors,Ke=R.level,Ze=R.size;for(var Bt=0;Bt<B.length;Bt++)xe=l.readability(M,B[Bt]),xe>ge&&(ge=xe,X=l(B[Bt]));return l.isReadable(M,X,{level:Ke,size:Ze})||!ze?X:(R.includeFallbackColors=!1,l.mostReadable(M,["#fff","#000"],R))};var D=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=l.hexNames=W(D);function W(M){var B={};for(var R in M)M.hasOwnProperty(R)&&(B[M[R]]=R);return B}function G(M){return M=parseFloat(M),(isNaN(M)||M<0||M>1)&&(M=1),M}function K(M,B){he(M)&&(M="100%");var R=Oe(M);return M=o(B,s(0,parseFloat(M))),R&&(M=parseInt(M*B,10)/100),t.abs(M-B)<1e-6?1:M%B/parseFloat(B)}function ee(M){return o(1,s(0,M))}function ce(M){return parseInt(M,16)}function he(M){return typeof M=="string"&&M.indexOf(".")!=-1&&parseFloat(M)===1}function Oe(M){return typeof M=="string"&&M.indexOf("%")!=-1}function Te(M){return M.length==1?"0"+M:""+M}function Re(M){return M<=1&&(M=M*100+"%"),M}function me(M){return t.round(parseFloat(M)*255).toString(16)}function P(M){return ce(M)/255}var F=function(){var M="[-\\+]?\\d+%?",B="[-\\+]?\\d*\\.\\d+%?",R="(?:"+B+")|(?:"+M+")",X="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",ge="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";return{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+X),rgba:new RegExp("rgba"+ge),hsl:new RegExp("hsl"+X),hsla:new RegExp("hsla"+ge),hsv:new RegExp("hsv"+X),hsva:new RegExp("hsva"+ge),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function V(M){return!!F.CSS_UNIT.exec(M)}function ae(M){M=M.replace(n,"").replace(r,"").toLowerCase();var B=!1;if(D[M])M=D[M],B=!0;else if(M=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var R;return(R=F.rgb.exec(M))?{r:R[1],g:R[2],b:R[3]}:(R=F.rgba.exec(M))?{r:R[1],g:R[2],b:R[3],a:R[4]}:(R=F.hsl.exec(M))?{h:R[1],s:R[2],l:R[3]}:(R=F.hsla.exec(M))?{h:R[1],s:R[2],l:R[3],a:R[4]}:(R=F.hsv.exec(M))?{h:R[1],s:R[2],v:R[3]}:(R=F.hsva.exec(M))?{h:R[1],s:R[2],v:R[3],a:R[4]}:(R=F.hex8.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),a:P(R[4]),format:B?"name":"hex8"}:(R=F.hex6.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),format:B?"name":"hex"}:(R=F.hex4.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),a:P(R[4]+""+R[4]),format:B?"name":"hex8"}:(R=F.hex3.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),format:B?"name":"hex"}:!1}function Y(M){var B,R;return M=M||{level:"AA",size:"small"},B=(M.level||"AA").toUpperCase(),R=(M.size||"small").toLowerCase(),B!=="AA"&&B!=="AAA"&&(B="AA"),R!=="small"&&R!=="large"&&(R="small"),{level:B,size:R}}e.exports?e.exports=l:window.tinycolor=l})(Math)})(eq);var b_=eq.exports,ri=(e,t,n)=>{var r=a_(e,"colors."+t,t),i=b_(r).isValid();return i?r:n},tSe=e=>t=>{var n=ri(t,e),r=b_(n).isDark();return r?"dark":"light"},nSe=e=>t=>tSe(e)(t)==="dark",rm=(e,t)=>n=>{var r=ri(n,e);return b_(r).setAlpha(t).toRgbString()};function tq(e,t){return e===void 0&&(e="1rem"),t===void 0&&(t="rgba(255, 255, 255, 0.15)"),{backgroundImage:`linear-gradient(
    45deg,
    `+t+` 25%,
    transparent 25%,
    transparent 50%,
    `+t+` 50%,
    `+t+` 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:e+" "+e}}function rSe(e){var t=b_.random().toHexString();return!e||Owe(e)?t:e.string&&e.colors?aSe(e.string,e.colors):e.string&&!e.colors?iSe(e.string):e.colors&&!e.string?oSe(e.colors):t}function iSe(e){var t=0;if(e.length===0)return t.toString();for(var n=0;n<e.length;n+=1)t=e.charCodeAt(n)+((t<<5)-t),t=t&t;for(var r="#",i=0;i<3;i+=1){var a=t>>i*8&255;r+=("00"+a.toString(16)).substr(-2)}return r}function aSe(e,t){var n=0;if(e.length===0)return t[0];for(var r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]}function oSe(e){return e[Math.floor(Math.random()*e.length)]}function Ce(e,t){return n=>n.colorMode==="dark"?t:e}function by(e){var{orientation:t,vertical:n,horizontal:r}=e;return t?t==="vertical"?n:r:{}}function KD(){return KD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KD.apply(this,arguments)}var sSe=e=>(_D({condition:!0,message:["[chakra-ui]: createBreakpoints(...) will be deprecated pretty soon","simply pass the breakpoints as an object. Remove the createBreakpoint(..) call"].join("")}),KD({base:"0em"},e));function wh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uSe{constructor(t){var n=this;this.name=t,wh(this,"map",{}),wh(this,"called",!1),wh(this,"assert",()=>{if(!this.called){this.called=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}),wh(this,"parts",function(){n.assert();for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o of i)n.map[o]=n.toPart(o);return n}),wh(this,"extend",function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o of i)o in n.map||(n.map[o]=n.toPart(o));return n}),wh(this,"toPart",r=>{var i=["container","root"].includes(r??"")?[this.name]:[this.name,r],a=i.filter(Boolean).join("__"),o="chakra-"+a,s={className:o,selector:"."+o,toString:()=>r};return s}),wh(this,"__type",{})}get selectors(){var t=Object.fromEntries(Object.entries(this.map).map(n=>{var[r,i]=n;return[r,i.selector]}));return t}get classNames(){var t=Object.fromEntries(Object.entries(this.map).map(n=>{var[r,i]=n;return[r,i.className]}));return t}get keys(){return Object.keys(this.map)}}function Kn(e){return new uSe(e)}function nq(e){return Ps(e)&&e.reference?e.reference:String(e)}var x_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(nq).join(" "+t+" ").replace(/calc/g,"")},rq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+x_("+",...n)+")"},iq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+x_("-",...n)+")"},XD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+x_("*",...n)+")"},aq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+x_("/",...n)+")"},oq=e=>{var t=nq(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:XD(t,-1)},Jl=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(rq(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(iq(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(XD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(aq(e,...r))},negate:()=>Jl(oq(e)),toString:()=>e.toString()}),{add:rq,subtract:iq,multiply:XD,divide:aq,negate:oq});function lSe(e){return!Number.isInteger(parseFloat(e.toString()))}function cSe(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function sq(e){var t=cSe(e.toString());return t.includes("\\.")?e:lSe(e)?t.replace(".","\\."):e}function fSe(e,t){return t===void 0&&(t=""),[t,sq(e)].filter(Boolean).join("-")}function dSe(e,t){return"var("+sq(e)+(t?", "+t:"")+")"}function hSe(e,t){return t===void 0&&(t=""),"--"+fSe(e,t)}function To(e,t){var n=hSe(e,t==null?void 0:t.prefix);return{variable:n,reference:dSe(n,pSe(t==null?void 0:t.fallback))}}function pSe(e){return typeof e=="string"?e:e==null?void 0:e.reference}var gSe=Kn("accordion").parts("container","item","button","panel").extend("icon"),mSe=Kn("alert").parts("title","description","container").extend("icon"),vSe=Kn("avatar").parts("label","badge","container").extend("excessLabel","group"),ySe=Kn("breadcrumb").parts("link","item").extend("separator");Kn("button").parts();var bSe=Kn("checkbox").parts("control","icon").extend("label");Kn("progress").parts("track","filledTrack").extend("label");var xSe=Kn("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),wSe=Kn("editable").parts("preview","input"),_Se=Kn("form").parts("container","requiredIndicator","helperText"),SSe=Kn("formError").parts("text","icon"),ESe=Kn("input").parts("addon","field","element"),ASe=Kn("list").parts("container","item","icon"),CSe=Kn("menu").parts("button","list","item").extend("groupTitle","command","divider"),kSe=Kn("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),TSe=Kn("numberinput").parts("root","field","stepperGroup","stepper");Kn("pininput").parts("field");var OSe=Kn("popover").parts("content","header","body","footer").extend("popper","arrow"),ISe=Kn("progress").parts("label","filledTrack","track"),NSe=Kn("radio").parts("container","control","label"),DSe=Kn("select").parts("field","icon"),RSe=Kn("slider").parts("container","track","thumb","filledTrack"),FSe=Kn("stat").parts("container","label","helpText","number","icon"),MSe=Kn("switch").parts("container","track","thumb"),PSe=Kn("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),$Se=Kn("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),LSe=Kn("tag").parts("container","label","closeButton"),BSe={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},zSe={transitionProperty:"common",transitionDuration:"normal",fontSize:"1rem",_focus:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:4,py:2},jSe={pt:2,px:4,pb:5},USe={fontSize:"1.25em"},WSe={container:BSe,button:zSe,panel:jSe,icon:USe},VSe={parts:gSe.keys,baseStyle:WSe},qSe={container:{px:4,py:3},title:{fontWeight:"bold",lineHeight:6,marginEnd:2},description:{lineHeight:6},icon:{flexShrink:0,marginEnd:3,w:5,h:6}};function YD(e){var{theme:t,colorScheme:n}=e,r=ri(t,n+".100",n),i=rm(n+".200",.16)(t);return Ce(r,i)(e)}var HSe=e=>{var{colorScheme:t}=e;return{container:{bg:YD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},GSe=e=>{var{colorScheme:t}=e;return{container:{paddingStart:3,borderStartWidth:"4px",borderStartColor:Ce(t+".500",t+".200")(e),bg:YD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},KSe=e=>{var{colorScheme:t}=e;return{container:{pt:2,borderTopWidth:"4px",borderTopColor:Ce(t+".500",t+".200")(e),bg:YD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},XSe=e=>{var{colorScheme:t}=e;return{container:{bg:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e)}}},YSe={subtle:HSe,"left-accent":GSe,"top-accent":KSe,solid:XSe},ZSe={variant:"subtle",colorScheme:"blue"},JSe={parts:mSe.keys,baseStyle:qSe,variants:YSe,defaultProps:ZSe},uq={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"};function ZD(){return ZD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZD.apply(this,arguments)}var QSe={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem"},eEe={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},tEe=ZD({},uq,QSe,{container:eEe}),lq=tEe,nEe=e=>({transform:"translate(25%, 25%)",borderRadius:"full",border:"0.2em solid",borderColor:Ce("white","gray.800")(e)}),rEe=e=>({bg:Ce("gray.200","whiteAlpha.400")(e)}),iEe=e=>{var{name:t,theme:n}=e,r=t?rSe({string:t}):"gray.400",i=nSe(r)(n),a="white";i||(a="gray.800");var o=Ce("white","gray.800")(e);return{bg:r,color:a,borderColor:o,verticalAlign:"top"}},aEe=e=>({badge:nEe(e),excessLabel:rEe(e),container:iEe(e)});function vf(e){var t=lq[e];return{container:{width:e,height:e,fontSize:"calc("+(t??e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(t??e)+" / 2.5)",lineHeight:e!=="100%"?t??e:void 0}}}var oEe={"2xs":vf("4"),xs:vf("6"),sm:vf("8"),md:vf("12"),lg:vf("16"),xl:vf("24"),"2xl":vf("32"),full:vf("100%")},sEe={size:"md"},uEe={parts:vSe.keys,baseStyle:aEe,sizes:oEe,defaultProps:sEe},lEe={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"},cEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".500",.6)(n);return{bg:Ce(t+".500",r)(e),color:Ce("white","whiteAlpha.800")(e)}},fEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".200",.16)(n);return{bg:Ce(t+".100",r)(e),color:Ce(t+".800",t+".200")(e)}},dEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".200",.8)(n),i=ri(n,t+".500"),a=Ce(i,r)(e);return{color:a,boxShadow:"inset 0 0 0px 1px "+a}},hEe={solid:cEe,subtle:fEe,outline:dEe},pEe={variant:"subtle",colorScheme:"gray"},xy={baseStyle:lEe,variants:hEe,defaultProps:pEe},gEe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},mEe={link:gEe},vEe={parts:ySe.keys,baseStyle:mEe};function JD(){return JD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JD.apply(this,arguments)}var yEe={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},cq=e=>{var{colorScheme:t,theme:n}=e;if(t==="gray")return{color:Ce("inherit","whiteAlpha.900")(e),_hover:{bg:Ce("gray.100","whiteAlpha.200")(e)},_active:{bg:Ce("gray.200","whiteAlpha.300")(e)}};var r=rm(t+".200",.12)(n),i=rm(t+".200",.24)(n);return{color:Ce(t+".600",t+".200")(e),bg:"transparent",_hover:{bg:Ce(t+".50",r)(e)},_active:{bg:Ce(t+".100",i)(e)}}},bEe=e=>{var{colorScheme:t}=e,n=Ce("gray.200","whiteAlpha.300")(e);return JD({border:"1px solid",borderColor:t==="gray"?n:"currentColor"},cq(e))},xEe={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},wEe=e=>{var t,{colorScheme:n}=e;if(n==="gray"){var r=Ce("gray.100","whiteAlpha.200")(e);return{bg:r,_hover:{bg:Ce("gray.200","whiteAlpha.300")(e),_disabled:{bg:r}},_active:{bg:Ce("gray.300","whiteAlpha.400")(e)}}}var{bg:i=n+".500",color:a="white",hoverBg:o=n+".600",activeBg:s=n+".700"}=(t=xEe[n])!=null?t:{},u=Ce(i,n+".200")(e);return{bg:u,color:Ce(a,"gray.800")(e),_hover:{bg:Ce(o,n+".300")(e),_disabled:{bg:u}},_active:{bg:Ce(s,n+".400")(e)}}},_Ee=e=>{var{colorScheme:t}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Ce(t+".500",t+".200")(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Ce(t+".700",t+".500")(e)}}},SEe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0},EEe={ghost:cq,outline:bEe,solid:wEe,link:_Ee,unstyled:SEe},AEe={lg:{h:12,minW:12,fontSize:"lg",px:6},md:{h:10,minW:10,fontSize:"md",px:4},sm:{h:8,minW:8,fontSize:"sm",px:3},xs:{h:6,minW:6,fontSize:"xs",px:2}},CEe={variant:"solid",size:"md",colorScheme:"gray"},kEe={baseStyle:yEe,variants:EEe,sizes:AEe,defaultProps:CEe},TEe=e=>{var{colorScheme:t}=e;return{w:"100%",transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Ce(t+".500",t+".200")(e),borderColor:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e),_hover:{bg:Ce(t+".600",t+".300")(e),borderColor:Ce(t+".600",t+".300")(e)},_disabled:{borderColor:Ce("gray.200","transparent")(e),bg:Ce("gray.200","whiteAlpha.300")(e),color:Ce("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Ce(t+".500",t+".200")(e),borderColor:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e)},_disabled:{bg:Ce("gray.100","whiteAlpha.100")(e),borderColor:Ce("gray.100","transparent")(e)},_focus:{boxShadow:"outline"},_invalid:{borderColor:Ce("red.500","red.300")(e)}}},OEe={userSelect:"none",_disabled:{opacity:.4}},IEe={transitionProperty:"transform",transitionDuration:"normal"},NEe=e=>({icon:IEe,control:TEe(e),label:OEe}),DEe={sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45rem"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625rem"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625rem"}}},REe={size:"md",colorScheme:"blue"},QD={parts:bSe.keys,baseStyle:NEe,sizes:DEe,defaultProps:REe},wy=To("close-button-size"),FEe=e=>{var t=Ce("blackAlpha.100","whiteAlpha.100")(e),n=Ce("blackAlpha.200","whiteAlpha.200")(e);return{w:[wy.reference],h:[wy.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{bg:t},_active:{bg:n},_focus:{boxShadow:"outline"}}},MEe={lg:{[wy.variable]:"40px",fontSize:"16px"},md:{[wy.variable]:"32px",fontSize:"12px"},sm:{[wy.variable]:"24px",fontSize:"10px"}},PEe={size:"md"},$Ee={baseStyle:FEe,sizes:MEe,defaultProps:PEe},{variants:LEe,defaultProps:BEe}=xy,zEe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},jEe={baseStyle:zEe,variants:LEe,defaultProps:BEe},UEe={w:"100%",mx:"auto",maxW:"60ch",px:"1rem"},WEe={baseStyle:UEe},VEe={opacity:.6,borderColor:"inherit"},qEe={borderStyle:"solid"},HEe={borderStyle:"dashed"},GEe={solid:qEe,dashed:HEe},KEe={variant:"solid"},XEe={baseStyle:VEe,variants:GEe,defaultProps:KEe};function eR(){return eR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eR.apply(this,arguments)}function im(e){return e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}}}var YEe={bg:"blackAlpha.600",zIndex:"overlay"},ZEe={display:"flex",zIndex:"modal",justifyContent:"center"},JEe=e=>{var{isFullHeight:t}=e;return eR({},t&&{height:"100vh"},{zIndex:"modal",maxH:"100vh",bg:Ce("white","gray.700")(e),color:"inherit",boxShadow:Ce("lg","dark-lg")(e)})},QEe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},eAe={position:"absolute",top:2,insetEnd:3},tAe={px:6,py:2,flex:1,overflow:"auto"},nAe={px:6,py:4},rAe=e=>({overlay:YEe,dialogContainer:ZEe,dialog:JEe(e),header:QEe,closeButton:eAe,body:tAe,footer:nAe}),iAe={xs:im("xs"),sm:im("md"),md:im("lg"),lg:im("2xl"),xl:im("4xl"),full:im("full")},aAe={size:"xs"},oAe={parts:xSe.keys,baseStyle:rAe,sizes:iAe,defaultProps:aAe},sAe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal"},uAe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal",width:"full",_focus:{boxShadow:"outline"},_placeholder:{opacity:.6}},lAe={preview:sAe,input:uAe},cAe={parts:wSe.keys,baseStyle:lAe},fAe=e=>({marginStart:1,color:Ce("red.500","red.300")(e)}),dAe=e=>({mt:2,color:Ce("gray.500","whiteAlpha.600")(e),lineHeight:"normal",fontSize:"sm"}),hAe=e=>({container:{width:"100%",position:"relative"},requiredIndicator:fAe(e),helperText:dAe(e)}),pAe={parts:_Se.keys,baseStyle:hAe},gAe={fontSize:"md",marginEnd:3,mb:2,fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},mAe={baseStyle:gAe},vAe={fontFamily:"heading",fontWeight:"bold"},yAe={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},bAe={size:"xl"},xAe={baseStyle:vAe,sizes:yAe,defaultProps:bAe},wAe={field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal"}},yf={lg:{fontSize:"lg",px:4,h:12,borderRadius:"md"},md:{fontSize:"md",px:4,h:10,borderRadius:"md"},sm:{fontSize:"sm",px:3,h:8,borderRadius:"sm"},xs:{fontSize:"xs",px:2,h:6,borderRadius:"sm"}},_Ae={lg:{field:yf.lg,addon:yf.lg},md:{field:yf.md,addon:yf.md},sm:{field:yf.sm,addon:yf.sm},xs:{field:yf.xs,addon:yf.xs}};function tR(e){var{focusBorderColor:t,errorBorderColor:n}=e;return{focusBorderColor:t||Ce("blue.500","blue.300")(e),errorBorderColor:n||Ce("red.500","red.300")(e)}}var SAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=tR(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Ce("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ri(t,r),boxShadow:"0 0 0 1px "+ri(t,r)},_focus:{zIndex:1,borderColor:ri(t,n),boxShadow:"0 0 0 1px "+ri(t,n)}},addon:{border:"1px solid",borderColor:Ce("inherit","whiteAlpha.50")(e),bg:Ce("gray.100","whiteAlpha.300")(e)}}},EAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=tR(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Ce("gray.100","whiteAlpha.50")(e),_hover:{bg:Ce("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ri(t,r)},_focus:{bg:"transparent",borderColor:ri(t,n)}},addon:{border:"2px solid",borderColor:"transparent",bg:Ce("gray.100","whiteAlpha.50")(e)}}},AAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=tR(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:ri(t,r),boxShadow:"0px 1px 0px 0px "+ri(t,r)},_focus:{borderColor:ri(t,n),boxShadow:"0px 1px 0px 0px "+ri(t,n)}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent"}}},CAe={field:{bg:"transparent",px:0,height:"auto"},addon:{bg:"transparent",px:0,height:"auto"}},kAe={outline:SAe,filled:EAe,flushed:AAe,unstyled:CAe},TAe={size:"md",variant:"outline"},cr={parts:ESe.keys,baseStyle:wAe,sizes:_Ae,variants:kAe,defaultProps:TAe},OAe=e=>({bg:Ce("gray.100","whiteAlpha")(e),borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"}),IAe={baseStyle:OAe},NAe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},DAe={baseStyle:NAe},RAe={marginEnd:"0.5rem",display:"inline",verticalAlign:"text-bottom"},FAe={container:{},item:{},icon:RAe},MAe={parts:ASe.keys,baseStyle:FAe},PAe=e=>({bg:Ce("#fff","gray.700")(e),boxShadow:Ce("sm","dark-lg")(e),color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px"}),$Ae=e=>({py:"0.4rem",px:"0.8rem",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:Ce("gray.100","whiteAlpha.100")(e)},_active:{bg:Ce("gray.200","whiteAlpha.200")(e)},_expanded:{bg:Ce("gray.100","whiteAlpha.100")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}),LAe={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},BAe={opacity:.6},zAe={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"0.5rem",opacity:.6},jAe={transitionProperty:"common",transitionDuration:"normal"},UAe=e=>({button:jAe,list:PAe(e),item:$Ae(e),groupTitle:LAe,command:BAe,divider:zAe}),WAe={parts:CSe.keys,baseStyle:UAe},VAe={bg:"blackAlpha.600",zIndex:"modal"},qAe=e=>{var{isCentered:t,scrollBehavior:n}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:t?"center":"flex-start",overflow:n==="inside"?"hidden":"auto"}},HAe=e=>{var{scrollBehavior:t}=e;return{borderRadius:"md",bg:Ce("white","gray.700")(e),color:"inherit",my:"3.75rem",zIndex:"modal",maxH:t==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:Ce("lg","dark-lg")(e)}},GAe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},KAe={position:"absolute",top:2,insetEnd:3},XAe=e=>{var{scrollBehavior:t}=e;return{px:6,py:2,flex:1,overflow:t==="inside"?"auto":void 0}},YAe={px:6,py:4},ZAe=e=>({overlay:VAe,dialogContainer:qAe(e),dialog:HAe(e),header:GAe,closeButton:KAe,body:XAe(e),footer:YAe});function Bs(e){return e==="full"?{dialog:{maxW:"100vw",minH:"100vh",my:0}}:{dialog:{maxW:e}}}var JAe={xs:Bs("xs"),sm:Bs("sm"),md:Bs("md"),lg:Bs("lg"),xl:Bs("xl"),"2xl":Bs("2xl"),"3xl":Bs("3xl"),"4xl":Bs("4xl"),"5xl":Bs("5xl"),"6xl":Bs("6xl"),full:Bs("full")},QAe={size:"md"},eCe={parts:kSe.keys,baseStyle:ZAe,sizes:JAe,defaultProps:QAe},tCe={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2","3":".75rem","4":"1rem","5":"1.25rem","6":"1.5rem","7":"1.75rem","8":"2rem","9":"2.25rem","10":"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},fq=tCe,dq,hq;function nR(){return nR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nR.apply(this,arguments)}var{variants:nCe,defaultProps:rCe}=cr,rR=To("number-input-stepper-width"),pq=To("number-input-input-padding"),iCe=Jl(rR).add("0.5rem").toString(),aCe={[rR.variable]:"24px",[pq.variable]:iCe},oCe=(dq=(hq=cr.baseStyle)==null?void 0:hq.field)!=null?dq:{},sCe={width:[rR.reference]},uCe=e=>({borderStart:"1px solid",borderStartColor:Ce("inherit","whiteAlpha.300")(e),color:Ce("inherit","whiteAlpha.800")(e),_active:{bg:Ce("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}),lCe=e=>({root:aCe,field:oCe,stepperGroup:sCe,stepper:uCe(e)});function w_(e){var t,n,r=cr.sizes[e],i={lg:"md",md:"md",sm:"sm",xs:"sm"},a=(t=(n=r.field)==null?void 0:n.fontSize)!=null?t:"md",o=fq.fontSizes[a.toString()];return{field:nR({},r.field,{paddingInlineEnd:pq.reference,verticalAlign:"top"}),stepper:{fontSize:Jl(o).multiply(.75).toString(),_first:{borderTopEndRadius:i[e]},_last:{borderBottomEndRadius:i[e],mt:"-1px",borderTopWidth:1}}}}var cCe={xs:w_("xs"),sm:w_("sm"),md:w_("md"),lg:w_("lg")},fCe={parts:TSe.keys,baseStyle:lCe,sizes:cCe,variants:nCe,defaultProps:rCe},gq;function iR(){return iR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iR.apply(this,arguments)}var dCe=iR({},cr.baseStyle.field,{textAlign:"center"}),hCe={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},pCe={outline:e=>{var t;return(t=cr.variants.outline(e).field)!=null?t:{}},flushed:e=>{var t;return(t=cr.variants.flushed(e).field)!=null?t:{}},filled:e=>{var t;return(t=cr.variants.filled(e).field)!=null?t:{}},unstyled:(gq=cr.variants.unstyled.field)!=null?gq:{}},gCe=cr.defaultProps,mCe={baseStyle:dCe,sizes:hCe,variants:pCe,defaultProps:gCe},aR=To("popper-bg"),vCe=To("popper-arrow-bg"),yCe=To("popper-arrow-shadow-color"),bCe={zIndex:10},xCe=e=>{var t=Ce("white","gray.700")(e),n=Ce("gray.200","whiteAlpha.300")(e);return{[aR.variable]:"colors."+t,bg:aR.reference,[vCe.variable]:aR.reference,[yCe.variable]:"colors."+n,width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focus:{outline:0,boxShadow:"outline"}}},wCe={px:3,py:2,borderBottomWidth:"1px"},_Ce={px:3,py:2},SCe={px:3,py:2,borderTopWidth:"1px"},ECe=e=>({popper:bCe,content:xCe(e),header:wCe,body:_Ce,footer:SCe,arrow:{}}),ACe={parts:OSe.keys,baseStyle:ECe};function __(){return __=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},__.apply(this,arguments)}function CCe(e){var{colorScheme:t,theme:n,isIndeterminate:r,hasStripe:i}=e,a=Ce(tq(),tq("1rem","rgba(0,0,0,0.1)"))(e),o=Ce(t+".500",t+".200")(e),s=`linear-gradient(
    to right,
    transparent 0%,
    `+ri(n,o)+` 50%,
    transparent 100%
  )`,u=!r&&i;return __({},u&&a,r?{bgImage:s}:{bgColor:o})}var kCe={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},TCe=e=>({bg:Ce("gray.100","whiteAlpha.300")(e)}),OCe=e=>__({transitionProperty:"common",transitionDuration:"slow"},CCe(e)),ICe=e=>({label:kCe,filledTrack:OCe(e),track:TCe(e)}),NCe={xs:{track:{h:"0.25rem"}},sm:{track:{h:"0.5rem"}},md:{track:{h:"0.75rem"}},lg:{track:{h:"1rem"}}},DCe={size:"md",colorScheme:"blue"},RCe={parts:ISe.keys,sizes:NCe,baseStyle:ICe,defaultProps:DCe};function S_(){return S_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S_.apply(this,arguments)}var FCe=e=>{var{control:t={}}=QD.baseStyle(e);return S_({},t,{borderRadius:"full",_checked:S_({},t._checked,{_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}})})},MCe=e=>({label:QD.baseStyle(e).label,control:FCe(e)}),PCe={md:{control:{w:4,h:4},label:{fontSize:"md"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"}},sm:{control:{width:3,height:3},label:{fontSize:"sm"}}},$Ce={size:"md",colorScheme:"blue"},LCe={parts:NSe.keys,baseStyle:MCe,sizes:PCe,defaultProps:$Ce};function _y(){return _y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_y.apply(this,arguments)}var BCe=e=>_y({},cr.baseStyle.field,{bg:Ce("white","gray.700")(e),appearance:"none",paddingBottom:"1px",lineHeight:"normal","> option, > optgroup":{bg:Ce("white","gray.700")(e)}}),zCe={width:"1.5rem",height:"100%",insetEnd:"0.5rem",position:"relative",color:"currentColor",fontSize:"1.25rem",_disabled:{opacity:.5}},jCe=e=>({field:BCe(e),icon:zCe}),UCe=_y({},cr.sizes,{xs:_y({},cr.sizes.xs,{icon:{insetEnd:"0.25rem"}})}),WCe={parts:DSe.keys,baseStyle:jCe,sizes:UCe,variants:cr.variants,defaultProps:cr.defaultProps},VCe=(e,t)=>fV({from:{borderColor:e,background:e},to:{borderColor:t,background:t}}),qCe=e=>{var t=Ce("gray.100","gray.800")(e),n=Ce("gray.400","gray.600")(e),{startColor:r=t,endColor:i=n,speed:a,theme:o}=e,s=ri(o,r),u=ri(o,i);return{opacity:.7,borderRadius:"2px",borderColor:s,background:u,animation:a+"s linear infinite alternate "+VCe(s,u)}},HCe={baseStyle:qCe},GCe=e=>({borderRadius:"md",fontWeight:"semibold",_focus:{boxShadow:"outline",padding:"1rem",position:"fixed",top:"1.5rem",insetStart:"1.5rem",bg:Ce("white","gray.700")(e)}}),KCe={baseStyle:GCe};function E_(){return E_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E_.apply(this,arguments)}function XCe(e){return by({orientation:e.orientation,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})}var YCe=e=>{var{orientation:t}=e;return E_({_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"}},by({orientation:t,vertical:{h:"100%"},horizontal:{w:"100%"}}))},ZCe=e=>({borderRadius:"sm",bg:Ce("gray.200","whiteAlpha.200")(e),_disabled:{bg:Ce("gray.300","whiteAlpha.300")(e)}}),JCe=e=>E_({zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{bg:"gray.300"}},XCe(e)),QCe=e=>{var{colorScheme:t}=e;return{bg:Ce(t+".500",t+".200")(e)}},eke=e=>({container:YCe(e),track:ZCe(e),thumb:JCe(e),filledTrack:QCe(e)}),tke=e=>({thumb:{w:"16px",h:"16px"},track:by({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}),nke=e=>({thumb:{w:"14px",h:"14px"},track:by({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}),rke=e=>({thumb:{w:"10px",h:"10px"},track:by({orientation:e.orientation,horizontal:{h:"2px"},vertical:{w:"2px"}})}),ike={lg:tke,md:nke,sm:rke},ake={size:"md",colorScheme:"blue"},oke={parts:RSe.keys,sizes:ike,baseStyle:eke,defaultProps:ake},_h=To("spinner-size"),ske={width:[_h.reference],height:[_h.reference]},uke={xs:{[_h.variable]:"0.75rem"},sm:{[_h.variable]:"1rem"},md:{[_h.variable]:"1.5rem"},lg:{[_h.variable]:"2rem"},xl:{[_h.variable]:"3rem"}},lke={size:"md"},cke={baseStyle:ske,sizes:uke,defaultProps:lke},fke={fontWeight:"medium"},dke={opacity:.8,marginBottom:2},hke={verticalAlign:"baseline",fontWeight:"semibold"},pke={marginEnd:1,w:"14px",h:"14px",verticalAlign:"middle"},gke={container:{},label:fke,helpText:dke,number:hke,icon:pke},mke={md:{label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}}},vke={size:"md"},yke={parts:FSe.keys,baseStyle:gke,sizes:mke,defaultProps:vke},Sy=To("switch-track-width"),Sh=To("switch-track-height"),oR=To("switch-track-diff"),bke=Jl.subtract(Sy,Sh),sR=To("switch-thumb-x"),xke=e=>{var{colorScheme:t}=e;return{borderRadius:"full",p:"2px",width:[Sy.reference],height:[Sh.reference],transitionProperty:"common",transitionDuration:"fast",bg:Ce("gray.300","whiteAlpha.400")(e),_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{bg:Ce(t+".500",t+".200")(e)}}},wke={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[Sh.reference],height:[Sh.reference],_checked:{transform:"translateX("+sR.reference+")"}},_ke=e=>({container:{[oR.variable]:bke,[sR.variable]:oR.reference,_rtl:{[sR.variable]:Jl(oR).negate().toString()}},track:xke(e),thumb:wke}),Ske={sm:{container:{[Sy.variable]:"1.375rem",[Sh.variable]:"0.75rem"}},md:{container:{[Sy.variable]:"1.875rem",[Sh.variable]:"1rem"}},lg:{container:{[Sy.variable]:"2.875rem",[Sh.variable]:"1.5rem"}}},Eke={size:"md",colorScheme:"blue"},Ake={parts:MSe.keys,baseStyle:_ke,sizes:Ske,defaultProps:Eke};function am(){return am=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},am.apply(this,arguments)}var Cke={table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}},A_={"&[data-is-numeric=true]":{textAlign:"end"}},kke=e=>{var{colorScheme:t}=e;return{th:am({color:Ce("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},A_),td:am({borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},A_),caption:{color:Ce("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},Tke=e=>{var{colorScheme:t}=e;return{th:am({color:Ce("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},A_),td:am({borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},A_),caption:{color:Ce("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Ce(t+".100",t+".700")(e)},td:{background:Ce(t+".100",t+".700")(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},Oke={simple:kke,striped:Tke,unstyled:{}},Ike={sm:{th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}},md:{th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}},lg:{th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}}},Nke={variant:"simple",size:"md",colorScheme:"gray"},Dke={parts:PSe.keys,baseStyle:Cke,variants:Oke,sizes:Ike,defaultProps:Nke},Rke=e=>{var{orientation:t}=e;return{display:t==="vertical"?"flex":"block"}},Fke=e=>{var{isFitted:t}=e;return{flex:t?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focus:{zIndex:1,boxShadow:"outline"}}},Mke=e=>{var{align:t="start",orientation:n}=e,r={end:"flex-end",center:"center",start:"flex-start"};return{justifyContent:r[t],flexDirection:n==="vertical"?"column":"row"}},Pke={p:4},$ke=e=>({root:Rke(e),tab:Fke(e),tablist:Mke(e),tabpanel:Pke}),Lke={sm:{tab:{py:1,px:4,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:4}}},Bke=e=>{var{colorScheme:t,orientation:n}=e,r=n==="vertical",i=n==="vertical"?"borderStart":"borderBottom",a=r?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[a]:"-2px",_selected:{color:Ce(t+".600",t+".300")(e),borderColor:"currentColor"},_active:{bg:Ce("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}},zke=e=>{var{colorScheme:t}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",_selected:{color:Ce(t+".600",t+".300")(e),borderColor:"inherit",borderBottomColor:Ce("white","gray.800")(e)}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}},jke=e=>{var{colorScheme:t}=e;return{tab:{border:"1px solid",borderColor:"inherit",bg:Ce("gray.50","whiteAlpha.50")(e),mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{bg:Ce("#fff","gray.800")(e),color:Ce(t+".600",t+".300")(e),borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}},Uke=e=>{var{colorScheme:t,theme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:ri(n,t+".700"),bg:ri(n,t+".100")}}}},Wke=e=>{var{colorScheme:t}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:Ce("gray.600","inherit")(e),_selected:{color:Ce("#fff","gray.800")(e),bg:Ce(t+".600",t+".300")(e)}}}},Vke={},qke={line:Bke,enclosed:zke,"enclosed-colored":jke,"soft-rounded":Uke,"solid-rounded":Wke,unstyled:Vke},Hke={size:"md",variant:"line",colorScheme:"blue"},Gke={parts:$Se.keys,baseStyle:$ke,sizes:Lke,variants:qke,defaultProps:Hke},Kke={fontWeight:"medium",lineHeight:1.2,outline:0,_focus:{boxShadow:"outline"}},Xke={lineHeight:1.2,overflow:"visible"},Yke={fontSize:"18px",w:"1.25rem",h:"1.25rem",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"0.375rem",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focus:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},Zke={container:Kke,label:Xke,closeButton:Yke},Jke={sm:{container:{minH:"1.25rem",minW:"1.25rem",fontSize:"xs",px:2,borderRadius:"md"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}},md:{container:{minH:"1.5rem",minW:"1.5rem",fontSize:"sm",borderRadius:"md",px:2}},lg:{container:{minH:8,minW:8,fontSize:"md",borderRadius:"md",px:3}}},Qke={subtle:e=>({container:xy.variants.subtle(e)}),solid:e=>({container:xy.variants.solid(e)}),outline:e=>({container:xy.variants.outline(e)})},eTe={size:"md",variant:"subtle",colorScheme:"gray"},tTe={parts:LSe.keys,variants:Qke,baseStyle:Zke,sizes:Jke,defaultProps:eTe},mq,vq,yq,bq,xq;function uR(){return uR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uR.apply(this,arguments)}var nTe=uR({},cr.baseStyle.field,{paddingY:"8px",minHeight:"80px",lineHeight:"short",verticalAlign:"top"}),rTe={outline:e=>{var t;return(t=cr.variants.outline(e).field)!=null?t:{}},flushed:e=>{var t;return(t=cr.variants.flushed(e).field)!=null?t:{}},filled:e=>{var t;return(t=cr.variants.filled(e).field)!=null?t:{}},unstyled:(mq=cr.variants.unstyled.field)!=null?mq:{}},iTe={xs:(vq=cr.sizes.xs.field)!=null?vq:{},sm:(yq=cr.sizes.sm.field)!=null?yq:{},md:(bq=cr.sizes.md.field)!=null?bq:{},lg:(xq=cr.sizes.lg.field)!=null?xq:{}},aTe={size:"md",variant:"outline"},oTe={baseStyle:nTe,sizes:iTe,variants:rTe,defaultProps:aTe},lR=To("tooltip-bg"),sTe=To("popper-arrow-bg"),uTe=e=>{var t=Ce("gray.700","gray.300")(e);return{[lR.variable]:"colors."+t,px:"8px",py:"2px",bg:[lR.reference],[sTe.variable]:[lR.reference],color:Ce("whiteAlpha.900","gray.900")(e),borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"320px",zIndex:"tooltip"}},lTe={baseStyle:uTe},cTe=e=>({color:Ce("red.500","red.300")(e),mt:2,fontSize:"sm"}),fTe=e=>({marginEnd:"0.5em",color:Ce("red.500","red.300")(e)}),dTe=e=>({text:cTe(e),icon:fTe(e)}),hTe={parts:SSe.keys,baseStyle:dTe},pTe={Accordion:VSe,Alert:JSe,Avatar:uEe,Badge:xy,Breadcrumb:vEe,Button:kEe,Checkbox:QD,CloseButton:$Ee,Code:jEe,Container:WEe,Divider:XEe,Drawer:oAe,Editable:cAe,Form:pAe,FormLabel:mAe,Heading:xAe,Input:cr,Kbd:IAe,Link:DAe,List:MAe,Menu:WAe,Modal:eCe,NumberInput:fCe,PinInput:mCe,Popover:ACe,Progress:RCe,Radio:LCe,Select:WCe,Skeleton:HCe,SkipLink:KCe,Slider:oke,Spinner:cke,Stat:yke,Switch:Ake,Table:Dke,Tabs:Gke,Tag:tTe,Textarea:oTe,Tooltip:lTe,FormError:hTe},gTe={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},mTe=gTe,vTe=sSe({sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"}),yTe=vTe,bTe={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},xTe=bTe,wTe={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},_Te=wTe,STe={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},ETe=STe,ATe={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},CTe={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},kTe={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},TTe={property:ATe,easing:CTe,duration:kTe},OTe=TTe,ITe={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},NTe=ITe,DTe={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},RTe=DTe;function cR(){return cR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cR.apply(this,arguments)}var FTe=cR({breakpoints:yTe,zIndices:NTe,radii:_Te,blur:RTe,colors:xTe},fq,{sizes:lq,shadows:ETe,space:uq,borders:mTe,transition:OTe}),MTe=FTe,PTe={global:e=>({body:{fontFamily:"body",color:Ce("gray.800","whiteAlpha.900")(e),bg:Ce("white","gray.800")(e),transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:Ce("gray.400","whiteAlpha.400")(e)},"*, *::before, &::after":{borderColor:Ce("gray.200","whiteAlpha.300")(e),wordWrap:"break-word"}})},$Te=PTe;function fR(){return fR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fR.apply(this,arguments)}var LTe="ltr",BTe={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},zTe=fR({direction:LTe},MTe,{components:pTe,styles:$Te,config:BTe}),jTe=zTe,wq=eSe;wq.defaultProps={theme:jTe};function Ey(){return Ey=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ey.apply(this,arguments)}function UTe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var _q={path:ue("g",{stroke:"currentColor",strokeWidth:"1.5"},ue("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),ue("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),ue("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})),viewBox:"0 0 24 24"},Ay=Mt((e,t)=>{var{as:n,viewBox:r,color:i="currentColor",focusable:a=!1,children:o,className:s,__css:u}=e,l=UTe(e,["as","viewBox","color","focusable","children","className","__css"]),c=Wn("chakra-icon",s),f=Ey({w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i},u),d={ref:t,focusable:a,className:c,__css:f},h=r??_q.viewBox;if(n&&typeof n!="string")return ue(xt.svg,Ey({as:n},d,l));var p=o??_q.path;return ue(xt.svg,Ey({verticalAlign:"middle",viewBox:h},d,l),p)});function dR(){return dR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dR.apply(this,arguments)}function Cy(e){var{viewBox:t="0 0 24 24",d:n,path:r,displayName:i,defaultProps:a={}}=e,o=Mt((s,u)=>ue(Ay,dR({ref:u,viewBox:t},a,s),r??ue("path",{fill:"currentColor",d:n})));return o}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hR=function(e,t){return hR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},hR(e,t)};function Sq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");hR(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ie=function(){return Ie=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ie.apply(this,arguments)};function Oo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function mr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function ma(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var Ql=function(e){return{isEnabled:function(t){return e.some(function(n){return!!t[n]})}}},pR={measureLayout:Ql(["layout","layoutId","drag","_layoutResetTransform"]),animation:Ql(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag"]),exit:Ql(["exit"]),drag:Ql(["drag","dragControls"]),focus:Ql(["whileFocus"]),hover:Ql(["whileHover","onHoverStart","onHoverEnd"]),tap:Ql(["whileTap","onTap","onTapStart","onTapCancel"]),pan:Ql(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),layoutAnimation:Ql(["layout","layoutId"])};function WTe(e){for(var t in e){var n=e[t];n!==null&&(pR[t].Component=n)}}var ky=function(){},Eq=ha({strict:!1}),Aq=Object.keys(pR),VTe=Aq.length;function qTe(e,t,n){var r=[];if(Un(Eq),!t)return null;for(var i=0;i<VTe;i++){var a=Aq[i],o=pR[a],s=o.isEnabled,u=o.Component;s(e)&&u&&r.push(ue(u,Ie({key:a},e,{visualElement:t})))}return r}var C_=ha({transformPagePoint:function(e){return e},isStatic:!1}),k_=ha({});function HTe(){return Un(k_).visualElement}var Ty=ha(null);function Oy(e){var t=Jt(null);return t.current===null&&(t.current=e()),t.current}function gR(){var e=Un(Ty);if(e===null)return[!0,null];var t=e.isPresent,n=e.onExitComplete,r=e.register,i=YTe();qt(function(){return r(i)},[]);var a=function(){return n==null?void 0:n(i)};return!t&&n?[!1,a]:[!0]}function GTe(e){return e===null?!0:e.isPresent}var KTe=0,XTe=function(){return KTe++},YTe=function(){return Oy(XTe)},ZTe=ha(null),Iy=typeof window!="undefined",Cq=Iy?lf:qt;function JTe(e){var t=e.layoutId,n=Un(ZTe);return n&&t!==void 0?n+"-"+t:t}function QTe(e,t,n,r){var i=Un(C_),a=Un(Eq),o=HTe(),s=Un(Ty),u=JTe(n),l=Jt(void 0);r||(r=a.renderer),!l.current&&r&&(l.current=r(e,{visualState:t,parent:o,props:Ie(Ie({},n),{layoutId:u}),presenceId:s==null?void 0:s.id,blockInitialAnimation:(s==null?void 0:s.initial)===!1}));var c=l.current;return Cq(function(){!c||(c.setProps(Ie(Ie(Ie({},i),n),{layoutId:u})),c.isPresent=GTe(s),c.isPresenceRoot=!o||o.presenceId!==(s==null?void 0:s.id),c.syncRender())}),qt(function(){var f;!c||(f=c.animationState)===null||f===void 0||f.animateChanges()}),Cq(function(){return function(){return c==null?void 0:c.notifyUnmount()}},[]),c}function mR(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function eOe(e,t,n){return st(function(r){var i;r&&((i=e.mount)===null||i===void 0||i.call(e,r)),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):mR(n)&&(n.current=r))},[t])}function kq(e){return Array.isArray(e)}function zs(e){return typeof e=="string"||kq(e)}function tOe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.get()}),t}function nOe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.getVelocity()}),t}function Tq(e,t,n,r,i){var a;return r===void 0&&(r={}),i===void 0&&(i={}),typeof t=="string"&&(t=(a=e.variants)===null||a===void 0?void 0:a[t]),typeof t=="function"?t(n??e.custom,r,i):t}function T_(e,t,n){var r=e.getProps();return Tq(r,t,n??r.custom,tOe(e),nOe(e))}function O_(e){var t;return typeof((t=e.animate)===null||t===void 0?void 0:t.start)=="function"||zs(e.initial)||zs(e.animate)||zs(e.whileHover)||zs(e.whileDrag)||zs(e.whileTap)||zs(e.whileFocus)||zs(e.exit)}function Oq(e){return Boolean(O_(e)||e.variants)}function rOe(e,t){if(O_(e)){var n=e.initial,r=e.animate;return{initial:n===!1||zs(n)?n:void 0,animate:zs(r)?r:void 0}}return e.inherit!==!1?t:{}}function iOe(e,t){var n=rOe(e,Un(k_)),r=n.initial,i=n.animate;return gr(function(){return{initial:r,animate:i}},t?[Iq(r),Iq(i)]:[])}function Iq(e){return Array.isArray(e)?e.join(" "):e}function aOe(e){var t=e.preloadedFeatures,n=e.createVisualElement,r=e.useRender,i=e.useVisualState,a=e.Component;t&&WTe(t);function o(s,u){var l=Un(C_).isStatic,c=null,f=iOe(s,l),d=i(s,l);return!l&&Iy&&(f.visualElement=QTe(a,d,s,n),c=qTe(s,f.visualElement)),ue(Ii,null,ue(k_.Provider,{value:f},r(a,s,eOe(d,f.visualElement,u),d,l)),c)}return Kl(o)}function oOe(e){function t(r,i){return i===void 0&&(i={}),aOe(e(r,i))}var n=new Map;return new Proxy(t,{get:function(r,i){return n.has(i)||n.set(i,t(i)),n.get(i)}})}var sOe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function vR(e){return typeof e!="string"||e.includes("-")?!1:!!(sOe.indexOf(e)>-1||/[A-Z]/.test(e))}var Ny={};function uOe(e){for(var t in e)Ny[t]=e[t]}var lOe=["","X","Y","Z"],cOe=["translate","scale","rotate","skew"],Dy=["transformPerspective","x","y","z"];cOe.forEach(function(e){return lOe.forEach(function(t){return Dy.push(e+t)})});function fOe(e,t){return Dy.indexOf(e)-Dy.indexOf(t)}var dOe=new Set(Dy);function I_(e){return dOe.has(e)}var hOe=new Set(["originX","originY","originZ"]);function Nq(e){return hOe.has(e)}function Dq(e,t){var n=t.layout,r=t.layoutId;return I_(e)||Nq(e)||(n||r!==void 0)&&(!!Ny[e]||e==="opacity")}var bf=function(e){return e!==null&&typeof e=="object"&&e.getVelocity},pOe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function gOe(e,t,n,r){var i=e.transform,a=e.transformKeys,o=t.enableHardwareAcceleration,s=o===void 0?!0:o,u=t.allowTransformNone,l=u===void 0?!0:u,c="";a.sort(fOe);for(var f=!1,d=a.length,h=0;h<d;h++){var p=a[h];c+=(pOe[p]||p)+"("+i[p]+") ",p==="z"&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(i,n?"":c):l&&n&&(c="none"),c}function mOe(e){var t=e.originX,n=t===void 0?"50%":t,r=e.originY,i=r===void 0?"50%":r,a=e.originZ,o=a===void 0?0:a;return n+" "+i+" "+o}function Rq(e){return e.startsWith("--")}var vOe=function(e,t){return t&&typeof e=="number"?t.transform(e):e},Fq=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},Ry=function(e){return e%1?Number(e.toFixed(5)):e},Fy=/(-)?([\d]*\.?[\d])+/g,yR=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,yOe=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function My(e){return typeof e=="string"}var Eh={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},Py=Ie(Ie({},Eh),{transform:Fq(0,1)}),N_=Ie(Ie({},Eh),{default:1}),$y=function(e){return{test:function(t){return My(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},xf=$y("deg"),om=$y("%"),Tt=$y("px"),bOe=$y("vh"),xOe=$y("vw"),Mq=Ie(Ie({},om),{parse:function(e){return om.parse(e)/100},transform:function(e){return om.transform(e*100)}}),bR=function(e,t){return function(n){return Boolean(My(n)&&yOe.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},Pq=function(e,t,n){return function(r){var i;if(!My(r))return r;var a=r.match(Fy),o=a[0],s=a[1],u=a[2],l=a[3];return i={},i[e]=parseFloat(o),i[t]=parseFloat(s),i[n]=parseFloat(u),i.alpha=l!==void 0?parseFloat(l):1,i}},sm={test:bR("hsl","hue"),parse:Pq("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,i=e.alpha,a=i===void 0?1:i;return"hsla("+Math.round(t)+", "+om.transform(Ry(n))+", "+om.transform(Ry(r))+", "+Ry(Py.transform(a))+")"}},wOe=Fq(0,255),xR=Ie(Ie({},Eh),{transform:function(e){return Math.round(wOe(e))}}),um={test:bR("rgb","red"),parse:Pq("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,i=e.alpha,a=i===void 0?1:i;return"rgba("+xR.transform(t)+", "+xR.transform(n)+", "+xR.transform(r)+", "+Ry(Py.transform(a))+")"}};function _Oe(e){var t="",n="",r="",i="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),i=e.substr(4,1),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var wR={test:bR("#"),parse:_Oe,transform:um.transform},va={test:function(e){return um.test(e)||wR.test(e)||sm.test(e)},parse:function(e){return um.test(e)?um.parse(e):sm.test(e)?sm.parse(e):wR.parse(e)},transform:function(e){return My(e)?e:e.hasOwnProperty("red")?um.transform(e):sm.transform(e)}},$q="${c}",Lq="${n}";function SOe(e){var t,n,r,i;return isNaN(e)&&My(e)&&((n=(t=e.match(Fy))===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+((i=(r=e.match(yR))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0}function Bq(e){var t=[],n=0,r=e.match(yR);r&&(n=r.length,e=e.replace(yR,$q),t.push.apply(t,r.map(va.parse)));var i=e.match(Fy);return i&&(e=e.replace(Fy,Lq),t.push.apply(t,i.map(Eh.parse))),{values:t,numColors:n,tokenised:e}}function zq(e){return Bq(e).values}function jq(e){var t=Bq(e),n=t.values,r=t.numColors,i=t.tokenised,a=n.length;return function(o){for(var s=i,u=0;u<a;u++)s=s.replace(u<r?$q:Lq,u<r?va.transform(o[u]):Ry(o[u]));return s}}var EOe=function(e){return typeof e=="number"?0:e};function AOe(e){var t=zq(e),n=jq(e);return n(t.map(EOe))}var ec={test:SOe,parse:zq,createTransformer:jq,getAnimatableNone:AOe},COe=new Set(["brightness","contrast","saturate","opacity"]);function kOe(e){var t=e.slice(0,-1).split("("),n=t[0],r=t[1];if(n==="drop-shadow")return e;var i=(r.match(Fy)||[])[0];if(!i)return e;var a=r.replace(i,""),o=COe.has(n)?1:0;return i!==r&&(o*=100),n+"("+o+a+")"}var TOe=/([a-z-]*)\(.*?\)/g,_R=Ie(Ie({},ec),{getAnimatableNone:function(e){var t=e.match(TOe);return t?t.map(kOe).join(" "):e}}),Uq=Ie(Ie({},Eh),{transform:Math.round}),Wq={borderWidth:Tt,borderTopWidth:Tt,borderRightWidth:Tt,borderBottomWidth:Tt,borderLeftWidth:Tt,borderRadius:Tt,radius:Tt,borderTopLeftRadius:Tt,borderTopRightRadius:Tt,borderBottomRightRadius:Tt,borderBottomLeftRadius:Tt,width:Tt,maxWidth:Tt,height:Tt,maxHeight:Tt,size:Tt,top:Tt,right:Tt,bottom:Tt,left:Tt,padding:Tt,paddingTop:Tt,paddingRight:Tt,paddingBottom:Tt,paddingLeft:Tt,margin:Tt,marginTop:Tt,marginRight:Tt,marginBottom:Tt,marginLeft:Tt,rotate:xf,rotateX:xf,rotateY:xf,rotateZ:xf,scale:N_,scaleX:N_,scaleY:N_,scaleZ:N_,skew:xf,skewX:xf,skewY:xf,distance:Tt,translateX:Tt,translateY:Tt,translateZ:Tt,x:Tt,y:Tt,z:Tt,perspective:Tt,transformPerspective:Tt,opacity:Py,originX:Mq,originY:Mq,originZ:Tt,zIndex:Uq,fillOpacity:Py,strokeOpacity:Py,numOctaves:Uq};function SR(e,t,n,r,i,a,o,s){var u,l=e.style,c=e.vars,f=e.transform,d=e.transformKeys,h=e.transformOrigin;d.length=0;var p=!1,g=!1,m=!0;for(var v in t){var y=t[v];if(Rq(v)){c[v]=y;continue}var b=Wq[v],x=vOe(y,b);if(I_(v)){if(p=!0,f[v]=x,d.push(v),!m)continue;y!==((u=b.default)!==null&&u!==void 0?u:0)&&(m=!1)}else if(Nq(v))h[v]=x,g=!0;else if((n==null?void 0:n.isHydrated)&&(r==null?void 0:r.isHydrated)&&Ny[v]){var w=Ny[v].process(y,r,n),S=Ny[v].applyTo;if(S)for(var A=S.length,_=0;_<A;_++)l[S[_]]=w;else l[v]=w}else l[v]=x}r&&n&&o&&s?(l.transform=o(r.deltaFinal,r.treeScale,p?f:void 0),a&&(l.transform=a(f,l.transform)),l.transformOrigin=s(r)):(p&&(l.transform=gOe(e,i,m,a)),g&&(l.transformOrigin=mOe(h)))}var ER=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function Vq(e,t,n){for(var r in t)!bf(t[r])&&!Dq(r,n)&&(e[r]=t[r])}function OOe(e,t,n){var r=e.transformTemplate;return gr(function(){var i=ER();SR(i,t,void 0,void 0,{enableHardwareAcceleration:!n},r);var a=i.vars,o=i.style;return Ie(Ie({},a),o)},[t])}function IOe(e,t,n){var r=e.style||{},i={};return Vq(i,r,e),Object.assign(i,OOe(e,t,n)),e.transformValues&&(i=e.transformValues(i)),i}function NOe(e,t,n){var r={},i=IOe(e,t,n);return Boolean(e.drag)&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":"pan-"+(e.drag==="x"?"y":"x")),r.style=i,r}var DOe=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","_layoutResetTransform","onLayoutAnimationComplete","onViewportBoxUpdate","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover"]);function D_(e){return DOe.has(e)}var qq=function(e){return!D_(e)};try{var ROe=require("@emotion/is-prop-valid").default;qq=function(e){return e.startsWith("on")?!D_(e):ROe(e)}}catch(e){}function FOe(e,t,n){var r={};for(var i in e)(qq(i)||n===!0&&D_(i)||!t&&!D_(i))&&(r[i]=e[i]);return r}function Hq(e,t,n){return typeof e=="string"?e:Tt.transform(t+n*e)}function MOe(e,t,n){var r=Hq(t,e.x,e.width),i=Hq(n,e.y,e.height);return r+" "+i}var AR=function(e,t){return Tt.transform(e*t)},POe={offset:"stroke-dashoffset",array:"stroke-dasharray"},$Oe={offset:"strokeDashoffset",array:"strokeDasharray"};function LOe(e,t,n,r,i,a){r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=!0);var o=a?POe:$Oe;e[o.offset]=AR(-i,t);var s=AR(n,t),u=AR(r,t);e[o.array]=s+" "+u}function CR(e,t,n,r,i,a,o,s){var u=t.attrX,l=t.attrY,c=t.originX,f=t.originY,d=t.pathLength,h=t.pathSpacing,p=h===void 0?1:h,g=t.pathOffset,m=g===void 0?0:g,v=Oo(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);SR(e,v,n,r,i,a,o,s),e.attrs=e.style,e.style={};var y=e.attrs,b=e.style,x=e.dimensions,w=e.totalPathLength;y.transform&&(x&&(b.transform=y.transform),delete y.transform),x&&(c!==void 0||f!==void 0||b.transform)&&(b.transformOrigin=MOe(x,c!==void 0?c:.5,f!==void 0?f:.5)),u!==void 0&&(y.x=u),l!==void 0&&(y.y=l),w!==void 0&&d!==void 0&&LOe(y,w,d,p,m,!1)}var Gq=function(){return Ie(Ie({},ER()),{attrs:{}})};function BOe(e,t){var n=gr(function(){var i=Gq();return CR(i,t,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Ie(Ie({},i.attrs),{style:Ie({},i.style)})},[t]);if(e.style){var r={};Vq(r,e.style,e),n.style=Ie(Ie({},r),n.style)}return n}function zOe(e){e===void 0&&(e=!1);var t=function(n,r,i,a,o){var s=a.latestValues,u=vR(n)?BOe:NOe,l=u(r,s,o),c=FOe(r,typeof n=="string",e),f=Ie(Ie(Ie({},c),l),{ref:i});return ue(n,f)};return t}var jOe=/([a-z])([A-Z])/g,UOe="$1-$2",Kq=function(e){return e.replace(jOe,UOe).toLowerCase()};function Xq(e,t){var n=t.style,r=t.vars;Object.assign(e.style,n);for(var i in r)e.style.setProperty(i,r[i])}var Yq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform"]);function Zq(e,t){Xq(e,t);for(var n in t.attrs)e.setAttribute(Yq.has(n)?n:Kq(n),t.attrs[n])}function kR(e){var t=e.style,n={};for(var r in t)(bf(t[r])||Dq(r,e))&&(n[r]=t[r]);return n}function Jq(e){var t=kR(e);for(var n in e)if(bf(e[n])){var r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;t[r]=e[n]}return t}function TR(e){return typeof e=="object"&&typeof e.start=="function"}var Ly=function(e){return Array.isArray(e)},WOe=function(e){return Boolean(e&&typeof e=="object"&&e.mix&&e.toValue)},VOe=function(e){return Ly(e)?e[e.length-1]||0:e};function qOe(e){var t=bf(e)?e.get():e;return WOe(t)?t.toValue():t}function Qq(e,t,n,r){var i=e.scrapeMotionValuesFromProps,a=e.createRenderState,o=e.onMount,s={latestValues:HOe(t,n,r,i),renderState:a()};return o&&(s.mount=function(u){return o(t,u,s)}),s}var eH=function(e){return function(t,n){var r=Un(k_),i=Un(Ty);return n?Qq(e,t,r,i):Oy(function(){return Qq(e,t,r,i)})}};function HOe(e,t,n,r){var i={},a=(n==null?void 0:n.initial)===!1,o=r(e);for(var s in o)i[s]=qOe(o[s]);var u=e.initial,l=e.animate,c=O_(e),f=Oq(e);t&&f&&!c&&e.inherit!==!1&&(u??(u=t.initial),l??(l=t.animate));var d=a||u===!1?l:u;if(d&&typeof d!="boolean"&&!TR(d)){var h=Array.isArray(d)?d:[d];h.forEach(function(p){var g=Tq(e,p);if(!!g){var m=g.transitionEnd;g.transition;var v=Oo(g,["transitionEnd","transition"]);for(var y in v)i[y]=v[y];for(var y in m)i[y]=m[y]}})}return i}var GOe={useVisualState:eH({scrapeMotionValuesFromProps:Jq,createRenderState:Gq,onMount:function(e,t,n){var r=n.renderState,i=n.latestValues;try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch(a){r.dimensions={x:0,y:0,width:0,height:0}}KOe(t)&&(r.totalPathLength=t.getTotalLength()),CR(r,i,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Zq(t,r)}})};function KOe(e){return e.tagName==="path"}var XOe={useVisualState:eH({scrapeMotionValuesFromProps:kR,createRenderState:ER})};function YOe(e,t,n,r){var i=t.forwardMotionProps,a=i===void 0?!1:i,o=vR(e)?GOe:XOe;return Ie(Ie({},o),{preloadedFeatures:n,useRender:zOe(a),createVisualElement:r,Component:e})}var Er;(function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.Exit="exit"})(Er||(Er={}));function OR(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function IR(e,t,n,r){qt(function(){var i=e.current;if(n&&i)return OR(i,t,n,r)},[e,t,n,r])}function ZOe(e){var t=e.whileFocus,n=e.visualElement,r=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Er.Focus,!0)},i=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Er.Focus,!1)};IR(n,"focus",t?r:void 0),IR(n,"blur",t?i:void 0)}function tH(e){return typeof PointerEvent!="undefined"&&e instanceof PointerEvent?e.pointerType==="mouse":e instanceof MouseEvent}function nH(e){var t=!!e.touches;return t}function JOe(e){return function(t){var n=t instanceof MouseEvent,r=!n||n&&t.button===0;r&&e(t)}}var QOe={pageX:0,pageY:0};function eIe(e,t){t===void 0&&(t="page");var n=e.touches[0]||e.changedTouches[0],r=n||QOe;return{x:r[t+"X"],y:r[t+"Y"]}}function tIe(e,t){return t===void 0&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function NR(e,t){return t===void 0&&(t="page"),{point:nH(e)?eIe(e,t):tIe(e,t)}}function nIe(e){return NR(e,"client")}var rH=function(e,t){t===void 0&&(t=!1);var n=function(r){return e(r,NR(r))};return t?JOe(n):n},rIe=function(){return Iy&&window.onpointerdown===null},iIe=function(){return Iy&&window.ontouchstart===null},aIe=function(){return Iy&&window.onmousedown===null},oIe={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},sIe={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function iH(e){return rIe()?e:iIe()?sIe[e]:aIe()?oIe[e]:e}function lm(e,t,n,r){return OR(e,iH(t),rH(n,t==="pointerdown"),r)}function R_(e,t,n,r){return IR(e,iH(t),n&&rH(n,t==="pointerdown"),r)}function aH(e){var t=null;return function(){var n=function(){t=null};return t===null?(t=e,n):!1}}var oH=aH("dragHorizontal"),sH=aH("dragVertical");function uH(e){var t=!1;if(e==="y")t=sH();else if(e==="x")t=oH();else{var n=oH(),r=sH();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function lH(){var e=uH(!0);return e?(e(),!1):!0}function cH(e,t,n){return function(r,i){var a;!tH(r)||lH()||(n==null||n(r,i),(a=e.animationState)===null||a===void 0||a.setActive(Er.Hover,t))}}function uIe(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,i=e.visualElement;R_(i,"pointerenter",t||r?cH(i,!0,t):void 0),R_(i,"pointerleave",n||r?cH(i,!1,n):void 0)}var fH=function(e,t){return t?e===t?!0:fH(e,t.parentElement):!1};function DR(e){return qt(function(){return function(){return e()}},[])}var F_=function(e,t,n){return Math.min(Math.max(n,e),t)},RR=.001,lIe=.01,cIe=10,fIe=.05,dIe=1;function hIe(e){var t=e.duration,n=t===void 0?800:t,r=e.bounce,i=r===void 0?.25:r,a=e.velocity,o=a===void 0?0:a,s=e.mass,u=s===void 0?1:s,l,c,f=1-i;f=F_(fIe,dIe,f),n=F_(lIe,cIe,n/1e3),f<1?(l=function(g){var m=g*f,v=m*n,y=m-o,b=FR(g,f),x=Math.exp(-v);return RR-y/b*x},c=function(g){var m=g*f,v=m*n,y=v*o+o,b=Math.pow(f,2)*Math.pow(g,2)*n,x=Math.exp(-v),w=FR(Math.pow(g,2),f),S=-l(g)+RR>0?-1:1;return S*((y-b)*x)/w}):(l=function(g){var m=Math.exp(-g*n),v=(g-o)*n+1;return-RR+m*v},c=function(g){var m=Math.exp(-g*n),v=(o-g)*(n*n);return m*v});var d=5/n,h=gIe(l,c,d);if(n=n*1e3,isNaN(h))return{stiffness:100,damping:10,duration:n};var p=Math.pow(h,2)*u;return{stiffness:p,damping:f*2*Math.sqrt(u*p),duration:n}}var pIe=12;function gIe(e,t,n){for(var r=n,i=1;i<pIe;i++)r=r-e(r)/t(r);return r}function FR(e,t){return e*Math.sqrt(1-t*t)}var mIe=["duration","bounce"],vIe=["stiffness","damping","mass"];function dH(e,t){return t.some(function(n){return e[n]!==void 0})}function yIe(e){var t=Ie({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!dH(e,vIe)&&dH(e,mIe)){var n=hIe(e);t=Ie(Ie(Ie({},t),n),{velocity:0,mass:1}),t.isResolvedFromDuration=!0}return t}function MR(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.restSpeed,o=a===void 0?2:a,s=e.restDelta,u=Oo(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=yIe(u),f=c.stiffness,d=c.damping,h=c.mass,p=c.velocity,g=c.duration,m=c.isResolvedFromDuration,v=hH,y=hH;function b(){var x=p?-(p/1e3):0,w=i-n,S=d/(2*Math.sqrt(f*h)),A=Math.sqrt(f/h)/1e3;if(s??(s=Math.abs(i-n)<=1?.01:.4),S<1){var _=FR(A,S);v=function(C){var k=Math.exp(-S*A*C);return i-k*((x+S*A*w)/_*Math.sin(_*C)+w*Math.cos(_*C))},y=function(C){var k=Math.exp(-S*A*C);return S*A*k*(Math.sin(_*C)*(x+S*A*w)/_+w*Math.cos(_*C))-k*(Math.cos(_*C)*(x+S*A*w)-_*w*Math.sin(_*C))}}else if(S===1)v=function(C){return i-Math.exp(-A*C)*(w+(x+A*w)*C)};else{var E=A*Math.sqrt(S*S-1);v=function(C){var k=Math.exp(-S*A*C),T=Math.min(E*C,300);return i-k*((x+S*A*w)*Math.sinh(T)+E*w*Math.cosh(T))/E}}}return b(),{next:function(x){var w=v(x);if(m)l.done=x>=g;else{var S=y(x)*1e3,A=Math.abs(S)<=o,_=Math.abs(i-w)<=s;l.done=A&&_}return l.value=l.done?i:w,l},flipTarget:function(){var x;p=-p,x=[i,n],n=x[0],i=x[1],b()}}}MR.needsInterpolation=function(e,t){return typeof e=="string"||typeof t=="string"};var hH=function(e){return 0},By=function(e,t,n){var r=t-e;return r===0?1:(n-e)/r},Za=function(e,t,n){return-n*e+n*t+e},bIe=function(e,t,n){var r=e*e,i=t*t;return Math.sqrt(Math.max(0,n*(i-r)+r))},xIe=[wR,um,sm],pH=function(e){return xIe.find(function(t){return t.test(e)})},gH=function(e,t){var n=pH(e),r=pH(t);ky(n.transform===r.transform);var i=n.parse(e),a=r.parse(t),o=Ie({},i),s=n===sm?Za:bIe;return function(u){for(var l in o)l!=="alpha"&&(o[l]=s(i[l],a[l],u));return o.alpha=Za(i.alpha,a.alpha,u),n.transform(o)}},PR=function(e){return typeof e=="number"},wIe=function(e,t){return function(n){return t(e(n))}},zy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(wIe)};function mH(e,t){return PR(e)?function(n){return Za(e,t,n)}:va.test(e)?gH(e,t):bH(e,t)}var vH=function(e,t){var n=ma([],e),r=n.length,i=e.map(function(a,o){return mH(a,t[o])});return function(a){for(var o=0;o<r;o++)n[o]=i[o](a);return n}},_Ie=function(e,t){var n=Ie(Ie({},e),t),r={};for(var i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=mH(e[i],t[i]));return function(a){for(var o in r)n[o]=r[o](a);return n}};function yH(e){for(var t=ec.parse(e),n=t.length,r=0,i=0,a=0,o=0;o<n;o++)r||typeof t[o]=="number"?r++:t[o].hue!==void 0?a++:i++;return{parsed:t,numNumbers:r,numRGB:i,numHSL:a}}var bH=function(e,t){var n=ec.createTransformer(t),r=yH(e),i=yH(t);return zy(vH(r.parsed,i.parsed),n)},SIe=function(e,t){return function(n){return Za(e,t,n)}};function EIe(e){if(typeof e=="number")return SIe;if(typeof e=="string")return va.test(e)?gH:bH;if(Array.isArray(e))return vH;if(typeof e=="object")return _Ie}function AIe(e,t,n){for(var r=[],i=n||EIe(e[0]),a=e.length-1,o=0;o<a;o++){var s=i(e[o],e[o+1]);if(t){var u=Array.isArray(t)?t[o]:t;s=zy(u,s)}r.push(s)}return r}function CIe(e,t){var n=e[0],r=e[1],i=t[0];return function(a){return i(By(n,r,a))}}function kIe(e,t){var n=e.length,r=n-1;return function(i){var a=0,o=!1;if(i<=e[0]?o=!0:i>=e[r]&&(a=r-1,o=!0),!o){for(var s=1;s<n&&!(e[s]>i||s===r);s++);a=s-1}var u=By(e[a],e[a+1],i);return t[a](u)}}function xH(e,t,n){var r=n===void 0?{}:n,i=r.clamp,a=i===void 0?!0:i,o=r.ease,s=r.mixer,u=e.length;ky(u===t.length),ky(!o||!Array.isArray(o)||o.length===u-1),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var l=AIe(t,o,s),c=u===2?CIe(e,l):kIe(e,l);return a?function(f){return c(F_(e[0],e[u-1],f))}:c}var M_=function(e){return function(t){return 1-e(1-t)}},$R=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},TIe=function(e){return function(t){return Math.pow(t,e)}},wH=function(e){return function(t){return t*t*((e+1)*t-e)}},OIe=function(e){var t=wH(e);return function(n){return(n*=2)<1?.5*t(n):.5*(2-Math.pow(2,-10*(n-1)))}},_H=1.525,IIe=4/11,NIe=8/11,DIe=9/10,SH=function(e){return e},LR=TIe(2),RIe=M_(LR),EH=$R(LR),AH=function(e){return 1-Math.sin(Math.acos(e))},CH=M_(AH),FIe=$R(CH),BR=wH(_H),MIe=M_(BR),PIe=$R(BR),$Ie=OIe(_H),LIe=4356/361,BIe=35442/1805,zIe=16061/1805,P_=function(e){if(e===1||e===0)return e;var t=e*e;return e<IIe?7.5625*t:e<NIe?9.075*t-9.9*e+3.4:e<DIe?LIe*t-BIe*e+zIe:10.8*e*e-20.52*e+10.72},jIe=M_(P_),UIe=function(e){return e<.5?.5*(1-P_(1-e*2)):.5*P_(e*2-1)+.5};function WIe(e,t){return e.map(function(){return t||EH}).splice(0,e.length-1)}function VIe(e){var t=e.length;return e.map(function(n,r){return r!==0?r/(t-1):0})}function qIe(e,t){return e.map(function(n){return n*t})}function $_(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.ease,o=e.offset,s=e.duration,u=s===void 0?300:s,l={done:!1,value:n},c=Array.isArray(i)?i:[n,i],f=qIe(o&&o.length===c.length?o:VIe(c),u);function d(){return xH(f,c,{ease:Array.isArray(a)?a:WIe(c,a)})}var h=d();return{next:function(p){return l.value=h(p),l.done=p>=u,l},flipTarget:function(){c.reverse(),h=d()}}}function HIe(e){var t=e.velocity,n=t===void 0?0:t,r=e.from,i=r===void 0?0:r,a=e.power,o=a===void 0?.8:a,s=e.timeConstant,u=s===void 0?350:s,l=e.restDelta,c=l===void 0?.5:l,f=e.modifyTarget,d={done:!1,value:i},h=o*n,p=i+h,g=f===void 0?p:f(p);return g!==p&&(h=g-i),{next:function(m){var v=-h*Math.exp(-m/u);return d.done=!(v>c||v<-c),d.value=d.done?g:g+v,d},flipTarget:function(){}}}var kH={keyframes:$_,spring:MR,decay:HIe};function GIe(e){if(Array.isArray(e.to))return $_;if(kH[e.type])return kH[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?$_:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?MR:$_}function TH(e,t,n){return n===void 0&&(n=0),e-t-n}function KIe(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=!0),r?TH(t+-e,t,n):t-(e-t)+n}function XIe(e,t,n,r){return r?e>=t+n:e<=-n}var YIe=function(e){var t=function(n){var r=n.delta;return e(r)};return{start:function(){return Mu.update(t,!0)},stop:function(){return dy.update(t)}}};function OH(e){var t,n,r=e.from,i=e.autoplay,a=i===void 0?!0:i,o=e.driver,s=o===void 0?YIe:o,u=e.elapsed,l=u===void 0?0:u,c=e.repeat,f=c===void 0?0:c,d=e.repeatType,h=d===void 0?"loop":d,p=e.repeatDelay,g=p===void 0?0:p,m=e.onPlay,v=e.onStop,y=e.onComplete,b=e.onRepeat,x=e.onUpdate,w=Oo(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),S=w.to,A,_=0,E=w.duration,C,k=!1,T=!0,I,N=GIe(w);((n=(t=N).needsInterpolation)===null||n===void 0?void 0:n.call(t,r,S))&&(I=xH([0,100],[r,S],{clamp:!1}),r=0,S=100);var O=N(Ie(Ie({},w),{from:r,to:S}));function D(){_++,h==="reverse"?(T=_%2==0,l=KIe(l,E,g,T)):(l=TH(l,E,g),h==="mirror"&&O.flipTarget()),k=!1,b&&b()}function L(){A.stop(),y&&y()}function W(K){if(T||(K=-K),l+=K,!k){var ee=O.next(Math.max(0,l));C=ee.value,I&&(C=I(C)),k=T?ee.done:l<=0}x==null||x(C),k&&(_===0&&(E??(E=l)),_<f?XIe(l,E,g,T)&&D():L())}function G(){m==null||m(),A=s(W),A.start()}return a&&G(),{stop:function(){v==null||v(),A.stop()}}}function IH(e,t){return t?e*(1e3/t):0}function ZIe(e){var t=e.from,n=t===void 0?0:t,r=e.velocity,i=r===void 0?0:r,a=e.min,o=e.max,s=e.power,u=s===void 0?.8:s,l=e.timeConstant,c=l===void 0?750:l,f=e.bounceStiffness,d=f===void 0?500:f,h=e.bounceDamping,p=h===void 0?10:h,g=e.restDelta,m=g===void 0?1:g,v=e.modifyTarget,y=e.driver,b=e.onUpdate,x=e.onComplete,w;function S(D){return a!==void 0&&D<a||o!==void 0&&D>o}function A(D){return a===void 0?o:o===void 0||Math.abs(a-D)<Math.abs(o-D)?a:o}function _(D){w==null||w.stop(),w=OH(Ie(Ie({},D),{driver:y,onUpdate:function(L){var W;b==null||b(L),(W=D.onUpdate)===null||W===void 0||W.call(D,L)},onComplete:x}))}function E(D){_(Ie({type:"spring",stiffness:d,damping:p,restDelta:m},D))}if(S(n))E({from:n,velocity:i,to:A(n)});else{var C=u*i+n;typeof v!="undefined"&&(C=v(C));var k=A(C),T=k===a?-1:1,I,N,O=function(D){I=N,N=D,i=IH(D-I,f_().delta),(T===1&&D>k||T===-1&&D<k)&&E({from:D,to:k,velocity:i})};_({type:"decay",from:n,velocity:i,timeConstant:c,power:u,restDelta:m,modifyTarget:v,onUpdate:S(C)?O:void 0})}return{stop:function(){return w==null?void 0:w.stop()}}}var zR=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},NH=function(e){return zR(e)&&e.hasOwnProperty("z")},L_=function(e,t){return Math.abs(e-t)};function DH(e,t){if(PR(e)&&PR(t))return L_(e,t);if(zR(e)&&zR(t)){var n=L_(e.x,t.x),r=L_(e.y,t.y),i=NH(e)&&NH(t)?L_(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}}var RH=function(e,t){return 1-3*t+3*e},FH=function(e,t){return 3*t-6*e},MH=function(e){return 3*e},B_=function(e,t,n){return((RH(t,n)*e+FH(t,n))*e+MH(t))*e},PH=function(e,t,n){return 3*RH(t,n)*e*e+2*FH(t,n)*e+MH(t)},JIe=1e-7,QIe=10;function eNe(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=B_(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>JIe&&++s<QIe);return o}var tNe=8,nNe=.001;function rNe(e,t,n,r){for(var i=0;i<tNe;++i){var a=PH(t,n,r);if(a===0)return t;var o=B_(t,n,r)-e;t-=o/a}return t}var z_=11,j_=1/(z_-1);function iNe(e,t,n,r){if(e===t&&n===r)return SH;for(var i=new Float32Array(z_),a=0;a<z_;++a)i[a]=B_(a*j_,e,n);function o(s){for(var u=0,l=1,c=z_-1;l!==c&&i[l]<=s;++l)u+=j_;--l;var f=(s-i[l])/(i[l+1]-i[l]),d=u+f*j_,h=PH(d,e,n);return h>=nNe?rNe(s,d,e,n):h===0?d:eNe(s,u,u+j_,e,n)}return function(s){return s===0||s===1?s:B_(o(s),t,r)}}function aNe(e){var t=e.onTap,n=e.onTapStart,r=e.onTapCancel,i=e.whileTap,a=e.visualElement,o=t||n||r||i,s=Jt(!1),u=Jt(null);function l(){var p;(p=u.current)===null||p===void 0||p.call(u),u.current=null}function c(){var p;return l(),s.current=!1,(p=a.animationState)===null||p===void 0||p.setActive(Er.Tap,!1),!lH()}function f(p,g){!c()||(fH(a.getInstance(),p.target)?t==null||t(p,g):r==null||r(p,g))}function d(p,g){!c()||r==null||r(p,g)}function h(p,g){var m;l(),!s.current&&(s.current=!0,u.current=zy(lm(window,"pointerup",f),lm(window,"pointercancel",d)),n==null||n(p,g),(m=a.animationState)===null||m===void 0||m.setActive(Er.Tap,!0))}R_(a,"pointerdown",o?h:void 0),DR(l)}var Ah=function(e){return function(t){return e(t),null}},oNe={tap:Ah(aNe),focus:Ah(ZOe),hover:Ah(uIe)};function $H(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var U_=function(e){return e*1e3},sNe={linear:SH,easeIn:LR,easeInOut:EH,easeOut:RIe,circIn:AH,circInOut:FIe,circOut:CH,backIn:BR,backInOut:PIe,backOut:MIe,anticipate:$Ie,bounceIn:jIe,bounceInOut:UIe,bounceOut:P_},LH=function(e){if(Array.isArray(e)){ky(e.length===4);var t=mr(e,4),n=t[0],r=t[1],i=t[2],a=t[3];return iNe(n,r,i,a)}else if(typeof e=="string")return sNe[e];return e},uNe=function(e){return Array.isArray(e)&&typeof e[0]!="number"},BH=function(e,t){return e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&ec.test(t)&&!t.startsWith("url("))},Ch=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},W_=function(e){return{type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restDelta:.01,restSpeed:10}},jR=function(){return{type:"keyframes",ease:"linear",duration:.3}},lNe=function(e){return{type:"keyframes",duration:.8,values:e}},zH={x:Ch,y:Ch,z:Ch,rotate:Ch,rotateX:Ch,rotateY:Ch,rotateZ:Ch,scaleX:W_,scaleY:W_,scale:W_,opacity:jR,backgroundColor:jR,color:jR,default:W_},cNe=function(e,t){var n;return Ly(t)?n=lNe:n=zH[e]||zH.default,Ie({to:t},n(t))},fNe=Ie(Ie({},Wq),{color:va,backgroundColor:va,outlineColor:va,fill:va,stroke:va,borderColor:va,borderTopColor:va,borderRightColor:va,borderBottomColor:va,borderLeftColor:va,filter:_R,WebkitFilter:_R}),UR=function(e){return fNe[e]};function WR(e,t){var n,r=UR(e);return r!==_R&&(r=ec),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,t)}function dNe(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=Oo(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}function hNe(e){var t=e.ease,n=e.times,r=e.yoyo,i=e.flip,a=e.loop,o=Oo(e,["ease","times","yoyo","flip","loop"]),s=Ie({},o);return n&&(s.offset=n),o.duration&&(s.duration=U_(o.duration)),o.repeatDelay&&(s.repeatDelay=U_(o.repeatDelay)),t&&(s.ease=uNe(t)?t.map(LH):LH(t)),o.type==="tween"&&(s.type="keyframes"),(r||a||i)&&(r?s.repeatType="reverse":a?s.repeatType="loop":i&&(s.repeatType="mirror"),s.repeat=a||r||i||o.repeat),o.type!=="spring"&&(s.type="keyframes"),s}function pNe(e,t){var n,r=VR(e,t)||{};return(n=r.delay)!==null&&n!==void 0?n:0}function gNe(e){return Array.isArray(e.to)&&e.to[0]===null&&(e.to=ma([],mr(e.to)),e.to[0]=e.from),e}function mNe(e,t,n){var r;return Array.isArray(t.to)&&((r=e.duration)!==null&&r!==void 0||(e.duration=.8)),gNe(t),dNe(e)||(e=Ie(Ie({},e),cNe(n,t.to))),Ie(Ie({},t),hNe(e))}function vNe(e,t,n,r,i){var a,o=VR(r,e),s=(a=o.from)!==null&&a!==void 0?a:t.get(),u=BH(e,n);s==="none"&&u&&typeof n=="string"?s=WR(e,n):jH(s)&&typeof n=="string"?s=UH(n):!Array.isArray(n)&&jH(n)&&typeof s=="string"&&(n=UH(s));var l=BH(e,s);function c(){var d={from:s,to:n,velocity:t.getVelocity(),onComplete:i,onUpdate:function(h){return t.set(h)}};return o.type==="inertia"||o.type==="decay"?ZIe(Ie(Ie({},d),o)):OH(Ie(Ie({},mNe(o,d,e)),{onUpdate:function(h){var p;d.onUpdate(h),(p=o.onUpdate)===null||p===void 0||p.call(o,h)},onComplete:function(){var h;d.onComplete(),(h=o.onComplete)===null||h===void 0||h.call(o)}}))}function f(){var d;return t.set(n),i(),(d=o==null?void 0:o.onComplete)===null||d===void 0||d.call(o),{stop:function(){}}}return!l||!u||o.type===!1?f:c}function jH(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function UH(e){return typeof e=="number"?0:WR("",e)}function VR(e,t){return e[t]||e.default||e}function V_(e,t,n,r){return r===void 0&&(r={}),t.start(function(i){var a,o,s=vNe(e,t,n,r,i),u=pNe(r,e),l=function(){return o=s()};return u?a=setTimeout(l,U_(u)):l(),function(){clearTimeout(a),o==null||o.stop()}})}var yNe=function(e){return/^\-?\d*\.?\d+$/.test(e)};function WH(e,t){e.indexOf(t)===-1&&e.push(t)}function VH(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var q_=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(t){var n=this;return WH(this.subscriptions,t),function(){return VH(n.subscriptions,t)}},e.prototype.notify=function(t,n,r){var i=this.subscriptions.length;if(!!i)if(i===1)this.subscriptions[0](t,n,r);else for(var a=0;a<i;a++){var o=this.subscriptions[a];o&&o(t,n,r)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),bNe=function(e){return!isNaN(parseFloat(e))},xNe=function(){function e(t){var n=this;this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new q_,this.velocityUpdateSubscribers=new q_,this.renderSubscribers=new q_,this.canTrackVelocity=!1,this.updateAndNotify=function(r,i){i===void 0&&(i=!0),n.prev=n.current,n.current=r;var a=f_(),o=a.delta,s=a.timestamp;n.lastUpdated!==s&&(n.timeDelta=o,n.lastUpdated=s,Mu.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),i&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Mu.postRender(n.velocityCheck)},this.velocityCheck=function(r){var i=r.timestamp;i!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=bNe(this.current)}return e.prototype.onChange=function(t){return this.updateSubscribers.add(t)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(t){return t(this.get()),this.renderSubscribers.add(t)},e.prototype.attach=function(t){this.passiveEffect=t},e.prototype.set=function(t,n){n===void 0&&(n=!0),!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?IH(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(t){var n=this;return this.stop(),new Promise(function(r){n.hasAnimated=!0,n.stopAnimation=t(r)}).then(function(){return n.clearAnimation()})},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function kh(e){return new xNe(e)}var qH=function(e){return function(t){return t.test(e)}},wNe={test:function(e){return e==="auto"},parse:function(e){return e}},HH=[Eh,Tt,om,xf,xOe,bOe,wNe],H_=function(e){return HH.find(qH(e))},_Ne=ma(ma([],mr(HH)),[va,ec]),SNe=function(e){return _Ne.find(qH(e))};function ENe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,kh(n))}function ANe(e,t){var n=T_(e,t),r=n?e.makeTargetAnimatable(n,!1):{},i=r.transitionEnd,a=i===void 0?{}:i;r.transition;var o=Oo(r,["transitionEnd","transition"]);o=Ie(Ie({},o),a);for(var s in o){var u=VOe(o[s]);ENe(e,s,u)}}function CNe(e,t,n){var r,i,a,o,s=Object.keys(t).filter(function(h){return!e.hasValue(h)}),u=s.length;if(!!u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),d===null&&(d=(i=(r=n[c])!==null&&r!==void 0?r:e.readValue(c))!==null&&i!==void 0?i:t[c]),d!=null&&(typeof d=="string"&&yNe(d)?d=parseFloat(d):!SNe(d)&&ec.test(f)&&(d=WR(c,f)),e.addValue(c,kh(d)),(a=(o=n)[c])!==null&&a!==void 0||(o[c]=d),e.setBaseTarget(c,d))}}function kNe(e,t){if(!!t){var n=t[e]||t.default||t;return n.from}}function TNe(e,t,n){var r,i,a={};for(var o in e)a[o]=(r=kNe(o,t))!==null&&r!==void 0?r:(i=n.getValue(o))===null||i===void 0?void 0:i.get();return a}function ONe(e,t,n){n===void 0&&(n={}),e.notifyAnimationStart();var r;if(Array.isArray(t)){var i=t.map(function(o){return qR(e,o,n)});r=Promise.all(i)}else if(typeof t=="string")r=qR(e,t,n);else{var a=typeof t=="function"?T_(e,t,n.custom):t;r=GH(e,a,n)}return r.then(function(){return e.notifyAnimationComplete(t)})}function qR(e,t,n){var r;n===void 0&&(n={});var i=T_(e,t,n.custom),a=(i||{}).transition,o=a===void 0?e.getDefaultTransition()||{}:a;n.transitionOverride&&(o=n.transitionOverride);var s=i?function(){return GH(e,i,n)}:function(){return Promise.resolve()},u=((r=e.variantChildren)===null||r===void 0?void 0:r.size)?function(h){h===void 0&&(h=0);var p=o.delayChildren,g=p===void 0?0:p,m=o.staggerChildren,v=o.staggerDirection;return INe(e,t,g+h,m,v,n)}:function(){return Promise.resolve()},l=o.when;if(l){var c=mr(l==="beforeChildren"?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}else return Promise.all([s(),u(n.delay)])}function GH(e,t,n){var r,i=n===void 0?{}:n,a=i.delay,o=a===void 0?0:a,s=i.transitionOverride,u=i.type,l=e.makeTargetAnimatable(t),c=l.transition,f=c===void 0?e.getDefaultTransition():c,d=l.transitionEnd,h=Oo(l,["transition","transitionEnd"]);s&&(f=s);var p=[],g=u&&((r=e.animationState)===null||r===void 0?void 0:r.getState()[u]);for(var m in h){var v=e.getValue(m),y=h[m];if(!(!v||y===void 0||g&&DNe(g,m))){var b=V_(m,v,y,Ie({delay:o},f));p.push(b)}}return Promise.all(p).then(function(){d&&ANe(e,d)})}function INe(e,t,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1);var o=[],s=(e.variantChildren.size-1)*r,u=i===1?function(l){return l===void 0&&(l=0),l*r}:function(l){return l===void 0&&(l=0),s-l*r};return Array.from(e.variantChildren).sort(NNe).forEach(function(l,c){o.push(qR(l,t,Ie(Ie({},a),{delay:n+u(c)})).then(function(){return l.notifyAnimationComplete(t)}))}),Promise.all(o)}function NNe(e,t){return e.sortNodePosition(t)}function DNe(e,t){var n=e.protectedKeys,r=e.needsAnimating,i=n.hasOwnProperty(t)&&r[t]!==!0;return r[t]=!1,i}var HR=[Er.Animate,Er.Hover,Er.Tap,Er.Drag,Er.Focus,Er.Exit],RNe=ma([],mr(HR)).reverse(),FNe=HR.length;function MNe(e){return function(t){return Promise.all(t.map(function(n){var r=n.animation,i=n.options;return ONe(e,r,i)}))}}function PNe(e){var t=MNe(e),n=LNe(),r={},i=!0,a=function(c,f){var d=T_(e,f);if(d){d.transition;var h=d.transitionEnd,p=Oo(d,["transition","transitionEnd"]);c=Ie(Ie(Ie({},c),p),h)}return c};function o(c){return r[c]!==void 0}function s(c){t=c(e)}function u(c,f){for(var d,h=e.getProps(),p=e.getVariantContext(!0)||{},g=[],m=new Set,v={},y=1/0,b=function(A){var _=RNe[A],E=n[_],C=(d=h[_])!==null&&d!==void 0?d:p[_],k=zs(C),T=_===f?E.isActive:null;T===!1&&(y=A);var I=C===p[_]&&C!==h[_]&&k;if(I&&i&&e.manuallyAnimateOnMount&&(I=!1),E.protectedKeys=Ie({},v),!E.isActive&&T===null||!C&&!E.prevProp||TR(C)||typeof C=="boolean")return"continue";var N=$Ne(E.prevProp,C)||_===f&&E.isActive&&!I&&k||A>y&&k,O=Array.isArray(C)?C:[C],D=O.reduce(a,{});T===!1&&(D={});var L=E.prevResolvedValues,W=L===void 0?{}:L,G=Ie(Ie({},W),D),K=function(Oe){N=!0,m.delete(Oe),E.needsAnimating[Oe]=!0};for(var ee in G){var ce=D[ee],he=W[ee];v.hasOwnProperty(ee)||(ce!==he?Ly(ce)&&Ly(he)?$H(ce,he)?E.protectedKeys[ee]=!0:K(ee):ce!==void 0?K(ee):m.add(ee):ce!==void 0&&m.has(ee)?K(ee):E.protectedKeys[ee]=!0)}E.prevProp=C,E.prevResolvedValues=D,E.isActive&&(v=Ie(Ie({},v),D)),i&&e.blockInitialAnimation&&(N=!1),N&&!I&&g.push.apply(g,ma([],mr(O.map(function(Oe){return{animation:Oe,options:Ie({type:_},c)}}))))},x=0;x<FNe;x++)b(x);if(r=Ie({},v),m.size){var w={};m.forEach(function(A){var _=e.getBaseTarget(A);_!==void 0&&(w[A]=_)}),g.push({animation:w})}var S=Boolean(g.length);return i&&h.initial===!1&&!e.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function l(c,f,d){var h;return n[c].isActive===f?Promise.resolve():((h=e.variantChildren)===null||h===void 0||h.forEach(function(p){var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(c,f)}),n[c].isActive=f,u(d,c))}return{isAnimated:o,animateChanges:u,setActive:l,setAnimateFunction:s,getState:function(){return n}}}function $Ne(e,t){return typeof t=="string"?t!==e:kq(t)?!$H(t,e):!1}function cm(e){return e===void 0&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function LNe(){var e;return e={},e[Er.Animate]=cm(!0),e[Er.Hover]=cm(),e[Er.Tap]=cm(),e[Er.Drag]=cm(),e[Er.Focus]=cm(),e[Er.Exit]=cm(),e}var BNe={animation:Ah(function(e){var t=e.visualElement,n=e.animate;t.animationState||(t.animationState=PNe(t)),TR(n)&&qt(function(){return n.subscribe(t)},[n])}),exit:Ah(function(e){var t=e.custom,n=e.visualElement,r=mr(gR(),2),i=r[0],a=r[1],o=Un(Ty);qt(function(){var s,u,l=(s=n.animationState)===null||s===void 0?void 0:s.setActive(Er.Exit,!i,{custom:(u=o==null?void 0:o.custom)!==null&&u!==void 0?u:t});!i&&(l==null||l.then(a))},[i])})},KH=function(){function e(t,n,r){var i=this,a=r===void 0?{}:r,o=a.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(!!(i.lastMoveEvent&&i.lastMoveEventInfo)){var d=KR(i.lastMoveEventInfo,i.history),h=i.startEvent!==null,p=DH(d.offset,{x:0,y:0})>=3;if(!(!h&&!p)){var g=d.point,m=f_().timestamp;i.history.push(Ie(Ie({},g),{timestamp:m}));var v=i.handlers,y=v.onStart,b=v.onMove;h||(y&&y(i.lastMoveEvent,d),i.startEvent=i.lastMoveEvent),b&&b(i.lastMoveEvent,d)}}},this.handlePointerMove=function(d,h){if(i.lastMoveEvent=d,i.lastMoveEventInfo=GR(h,i.transformPagePoint),tH(d)&&d.buttons===0){i.handlePointerUp(d,h);return}Mu.update(i.updatePoint,!0)},this.handlePointerUp=function(d,h){i.end();var p=i.handlers,g=p.onEnd,m=p.onSessionEnd,v=KR(GR(h,i.transformPagePoint),i.history);i.startEvent&&g&&g(d,v),m&&m(d,v)},!(nH(t)&&t.touches.length>1)){this.handlers=n,this.transformPagePoint=o;var s=NR(t),u=GR(s,this.transformPagePoint),l=u.point,c=f_().timestamp;this.history=[Ie(Ie({},l),{timestamp:c})];var f=n.onSessionStart;f&&f(t,KR(u,this.history)),this.removeListeners=zy(lm(window,"pointermove",this.handlePointerMove),lm(window,"pointerup",this.handlePointerUp),lm(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(t){this.handlers=t},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),dy.update(this.updatePoint)},e}();function GR(e,t){return t?{point:t(e.point)}:e}function XH(e,t){return{x:e.x-t.x,y:e.y-t.y}}function KR(e,t){var n=e.point;return{point:n,delta:XH(n,YH(t)),offset:XH(n,zNe(t)),velocity:jNe(t,.1)}}function zNe(e){return e[0]}function YH(e){return e[e.length-1]}function jNe(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,i=YH(e);n>=0&&(r=e[n],!(i.timestamp-r.timestamp>U_(t)));)n--;if(!r)return{x:0,y:0};var a=(i.timestamp-r.timestamp)/1e3;if(a===0)return{x:0,y:0};var o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function UNe(e){return e}function ZH(e){var t=e.top,n=e.left,r=e.right,i=e.bottom;return{x:{min:n,max:r},y:{min:t,max:i}}}function WNe(e){var t=e.x,n=e.y;return{top:n.min,bottom:n.max,left:t.min,right:t.max}}function VNe(e,t){var n=e.top,r=e.left,i=e.bottom,a=e.right;t===void 0&&(t=UNe);var o=t({x:r,y:n}),s=t({x:a,y:i});return{top:o.y,left:o.x,bottom:s.y,right:s.x}}function wf(){return{x:{min:0,max:1},y:{min:0,max:1}}}function qNe(e){return{x:Ie({},e.x),y:Ie({},e.y)}}var JH={translate:0,scale:1,origin:0,originPoint:0};function QH(){return{x:Ie({},JH),y:Ie({},JH)}}function Ja(e){return[e("x"),e("y")]}function eG(e,t,n){var r=t.min,i=t.max;return r!==void 0&&e<r?e=n?Za(r,e,n.min):Math.max(e,r):i!==void 0&&e>i&&(e=n?Za(i,e,n.max):Math.min(e,i)),e}function HNe(e,t,n,r,i){var a=e-t*n;return r?eG(a,r,i):a}function tG(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function GNe(e,t){var n=t.top,r=t.left,i=t.bottom,a=t.right;return{x:tG(e.x,r,a),y:tG(e.y,n,i)}}function nG(e,t){var n,r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&(n=mr([i,r],2),r=n[0],i=n[1]),{min:e.min+r,max:e.min+i}}function KNe(e,t){return{x:nG(e.x,t.x),y:nG(e.y,t.y)}}function XNe(e,t,n){var r=e.max-e.min,i=Za(t.min,t.max-r,n);return{min:i,max:i+r}}function YNe(e,t){var n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var rG=.35;function ZNe(e){return e===!1?e=0:e===!0&&(e=rG),{x:iG(e,"left","right"),y:iG(e,"top","bottom")}}function iG(e,t,n){return{min:aG(e,t),max:aG(e,n)}}function aG(e,t){var n;return typeof e=="number"?e:(n=e[t])!==null&&n!==void 0?n:0}function oG(e,t){var n=e.getBoundingClientRect();return ZH(VNe(n,t))}var JNe=function(e){return F_(0,1,e)};function sG(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=.01),DH(e,t)<n}function jy(e){return e.max-e.min}function QNe(e,t){var n=.5,r=jy(e),i=jy(t);return i>r?n=By(t.min,t.max-r,e.min):r>i&&(n=By(e.min,e.max-i,t.min)),JNe(n)}function uG(e,t,n,r){r===void 0&&(r=.5),e.origin=r,e.originPoint=Za(t.min,t.max,e.origin),e.scale=jy(n)/jy(t),sG(e.scale,1,1e-4)&&(e.scale=1),e.translate=Za(n.min,n.max,e.origin)-e.originPoint,sG(e.translate)&&(e.translate=0)}function lG(e,t,n,r){uG(e.x,t.x,n.x,cG(r.originX)),uG(e.y,t.y,n.y,cG(r.originY))}function cG(e){return typeof e=="number"?e:.5}function fG(e,t,n){e.min=n.min+t.min,e.max=e.min+jy(t)}function eDe(e,t){fG(e.target.x,e.relativeTarget.x,t.target.x),fG(e.target.y,e.relativeTarget.y,t.target.y)}var XR=function(e,t){return e.depth-t.depth};function dG(e){var t=e.projection.isEnabled;return t||e.shouldResetTransform()}function G_(e,t){t===void 0&&(t=[]);var n=e.parent;return n&&G_(n,t),dG(e)&&t.push(e),t}function tDe(e){var t=[],n=function(r){dG(r)&&t.push(r),r.children.forEach(n)};return e.children.forEach(n),t.sort(XR)}function K_(e){if(!e.shouldResetTransform()){var t=e.getLayoutState();e.notifyBeforeLayoutMeasure(t.layout),t.isHydrated=!0,t.layout=e.measureViewportBox(),t.layoutCorrected=qNe(t.layout),e.notifyLayoutMeasure(t.layout,e.prevViewportBox||t.layout),Mu.update(function(){return e.rebaseProjectionTarget()})}}function nDe(e){e.shouldResetTransform()||(e.prevViewportBox=e.measureViewportBox(!1),e.rebaseProjectionTarget(!1,e.prevViewportBox))}function rDe(e,t,n,r){e.min=Za(t.min,n.min,r),e.max=Za(t.max,n.max,r)}function hG(e,t){return{min:t.min-e.min,max:t.max-e.min}}function fm(e,t){return{x:hG(e.x,t.x),y:hG(e.y,t.y)}}function iDe(e,t){var n=e.getLayoutId(),r=t.getLayoutId();return n!==r||r===void 0&&e!==t}function pG(e){var t=e.getProps(),n=t.drag,r=t._dragX;return n&&!r}function gG(e,t){e.min=t.min,e.max=t.max}function aDe(e,t){gG(e.x,t.x),gG(e.y,t.y)}function X_(e,t,n){var r=e-n,i=t*r;return n+i}function mG(e,t,n,r,i){return i!==void 0&&(e=X_(e,i,r)),X_(e,n,r)+t}function YR(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),e.min=mG(e.min,t,n,r,i),e.max=mG(e.max,t,n,r,i)}function oDe(e,t){var n=t.x,r=t.y;YR(e.x,n.translate,n.scale,n.originPoint),YR(e.y,r.translate,r.scale,r.originPoint)}function vG(e,t,n,r){var i=mr(r,3),a=i[0],o=i[1],s=i[2];e.min=t.min,e.max=t.max;var u=n[s]!==void 0?n[s]:.5,l=Za(t.min,t.max,u);YR(e,n[a],n[o],l,n.scale)}var yG=["x","scaleX","originX"],bG=["y","scaleY","originY"];function ZR(e,t,n){vG(e.x,t.x,n,yG),vG(e.y,t.y,n,bG)}function xG(e,t,n,r,i){return e-=t,e=X_(e,1/n,r),i!==void 0&&(e=X_(e,1/i,r)),e}function sDe(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=.5);var a=Za(e.min,e.max,r)-t;e.min=xG(e.min,t,n,a,i),e.max=xG(e.max,t,n,a,i)}function wG(e,t,n){var r=mr(n,3),i=r[0],a=r[1],o=r[2];sDe(e,t[i],t[a],t[o],t.scale)}function _G(e,t){wG(e.x,t,yG),wG(e.y,t,bG)}function uDe(e,t,n){var r=n.length;if(!!r){t.x=t.y=1;for(var i,a,o=0;o<r;o++)i=n[o],a=i.getLayoutState().delta,t.x*=a.x.scale,t.y*=a.y.scale,oDe(e,a),pG(i)&&ZR(e,e,i.getLatestValues())}}function lDe(e,t){t===void 0&&(t=!0);var n=e.getProjectionParent();if(!n)return!1;var r;return t?(r=fm(n.projection.target,e.projection.target),_G(r,n.getLatestValues())):r=fm(n.getLayoutState().layout,e.getLayoutState().layout),Ja(function(i){return e.setProjectionTargetAxis(i,r[i].min,r[i].max,!0)}),!0}var Uy=new Set;function SG(e,t,n){e[n]||(e[n]=[]),e[n].push(t)}function JR(e){return Uy.add(e),function(){return Uy.delete(e)}}function QR(){if(!!Uy.size){var e=0,t=[[]],n=[],r=function(s){return SG(t,s,e)},i=function(s){SG(n,s,e),e++};Uy.forEach(function(s){s(r,i),e=0}),Uy.clear();for(var a=n.length,o=0;o<=a;o++)t[o]&&t[o].forEach(EG),n[o]&&n[o].forEach(EG)}}var EG=function(e){return e()},cDe=new WeakMap,AG,fDe=function(){function e(t){var n=t.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=wf(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=n,this.visualElement.enableLayoutProjection(),cDe.set(n,this)}return e.prototype.start=function(t,n){var r=this,i=n===void 0?{}:n,a=i.snapToCursor,o=a===void 0?!1:a,s=i.cursorProgress,u=function(h){var p;r.stopMotion();var g=nIe(h).point;(p=r.cancelLayout)===null||p===void 0||p.call(r),r.cancelLayout=JR(function(m,v){var y=G_(r.visualElement),b=tDe(r.visualElement),x=ma(ma([],mr(y)),mr(b)),w=!1;r.isLayoutDrag()&&r.visualElement.lockProjectionTarget(),v(function(){x.forEach(function(S){return S.resetTransform()})}),m(function(){K_(r.visualElement),b.forEach(K_)}),v(function(){x.forEach(function(S){return S.restoreTransform()}),o&&(w=r.snapToCursor(g))}),m(function(){var S=Boolean(r.getAxisMotionValue("x")&&!r.isExternalDrag());S||r.visualElement.rebaseProjectionTarget(!0,r.visualElement.measureViewportBox(!1)),r.visualElement.scheduleUpdateLayoutProjection();var A=r.visualElement.projection;Ja(function(_){if(!w){var E=A.target[_],C=E.min,k=E.max;r.cursorProgress[_]=s?s[_]:By(C,k,g[_])}var T=r.getAxisMotionValue(_);T&&(r.originPoint[_]=T.get())})}),v(function(){Jg.update(),Jg.preRender(),Jg.render(),Jg.postRender()}),m(function(){return r.resolveDragConstraints()})})},l=function(h,p){var g,m,v,y=r.props,b=y.drag,x=y.dragPropagation;b&&!x&&(r.openGlobalLock&&r.openGlobalLock(),r.openGlobalLock=uH(b),!r.openGlobalLock)||(QR(),r.isDragging=!0,r.currentDirection=null,(m=(g=r.props).onDragStart)===null||m===void 0||m.call(g,h,p),(v=r.visualElement.animationState)===null||v===void 0||v.setActive(Er.Drag,!0))},c=function(h,p){var g,m,v,y,b=r.props,x=b.dragPropagation,w=b.dragDirectionLock;if(!(!x&&!r.openGlobalLock)){var S=p.offset;if(w&&r.currentDirection===null){r.currentDirection=dDe(S),r.currentDirection!==null&&((m=(g=r.props).onDirectionLock)===null||m===void 0||m.call(g,r.currentDirection));return}r.updateAxis("x",p.point,S),r.updateAxis("y",p.point,S),(y=(v=r.props).onDrag)===null||y===void 0||y.call(v,h,p),AG=h}},f=function(h,p){return r.stop(h,p)},d=this.props.transformPagePoint;this.panSession=new KH(t,{onSessionStart:u,onStart:l,onMove:c,onSessionEnd:f},{transformPagePoint:d})},e.prototype.resolveDragConstraints=function(){var t=this,n=this.props,r=n.dragConstraints,i=n.dragElastic,a=this.visualElement.getLayoutState().layoutCorrected;r?this.constraints=mR(r)?this.resolveRefConstraints(a,r):GNe(a,r):this.constraints=!1,this.elastic=ZNe(i),this.constraints&&!this.hasMutatedConstraints&&Ja(function(o){t.getAxisMotionValue(o)&&(t.constraints[o]=YNe(a[o],t.constraints[o]))})},e.prototype.resolveRefConstraints=function(t,n){var r=this.props,i=r.onMeasureDragConstraints,a=r.transformPagePoint,o=n.current;this.constraintsBox=oG(o,a);var s=KNe(t,this.constraintsBox);if(i){var u=i(WNe(s));this.hasMutatedConstraints=!!u,u&&(s=ZH(u))}return s},e.prototype.cancelDrag=function(){var t,n;this.visualElement.unlockProjectionTarget(),(t=this.cancelLayout)===null||t===void 0||t.call(this),this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(Er.Drag,!1)},e.prototype.stop=function(t,n){var r,i,a;(r=this.panSession)===null||r===void 0||r.end(),this.panSession=null;var o=this.isDragging;if(this.cancelDrag(),!!o){var s=n.velocity;this.animateDragEnd(s),(a=(i=this.props).onDragEnd)===null||a===void 0||a.call(i,t,n)}},e.prototype.snapToCursor=function(t){var n=this;return Ja(function(r){var i=n.props.drag;if(!!Y_(r,i,n.currentDirection)){var a=n.getAxisMotionValue(r);if(a){var o=n.visualElement.getLayoutState().layout,s=o[r].max-o[r].min,u=o[r].min+s/2,l=t[r]-u;n.originPoint[r]=t[r],a.set(l)}else return n.cursorProgress[r]=.5,!0}}).includes(!0)},e.prototype.updateAxis=function(t,n,r){var i=this.props.drag;if(!!Y_(t,i,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,r):this.updateVisualElementAxis(t,n)},e.prototype.updateAxisMotionValue=function(t,n){var r=this.getAxisMotionValue(t);if(!(!n||!r)){var i=this.originPoint[t]+n[t],a=this.constraints?eG(i,this.constraints[t],this.elastic[t]):i;r.set(a)}},e.prototype.updateVisualElementAxis=function(t,n){var r,i=this.visualElement.getLayoutState().layout[t],a=i.max-i.min,o=this.cursorProgress[t],s=HNe(n[t],a,o,(r=this.constraints)===null||r===void 0?void 0:r[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,s,s+a)},e.prototype.setProps=function(t){var n=t.drag,r=n===void 0?!1:n,i=t.dragDirectionLock,a=i===void 0?!1:i,o=t.dragPropagation,s=o===void 0?!1:o,u=t.dragConstraints,l=u===void 0?!1:u,c=t.dragElastic,f=c===void 0?rG:c,d=t.dragMomentum,h=d===void 0?!0:d,p=Oo(t,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=Ie({drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:l,dragElastic:f,dragMomentum:h},p)},e.prototype.getAxisMotionValue=function(t){var n=this.props,r=n.layout,i=n.layoutId,a="_drag"+t.toUpperCase();if(this.props[a])return this.props[a];if(!r&&i===void 0)return this.visualElement.getValue(t,0)},e.prototype.isLayoutDrag=function(){return!this.getAxisMotionValue("x")},e.prototype.isExternalDrag=function(){var t=this.props,n=t._dragX,r=t._dragY;return n||r},e.prototype.animateDragEnd=function(t){var n=this,r=this.props,i=r.drag,a=r.dragMomentum,o=r.dragElastic,s=r.dragTransition,u=lDe(this.visualElement,this.isLayoutDrag()&&!this.isExternalDrag()),l=this.constraints||{};if(u&&Object.keys(l).length&&this.isLayoutDrag()){var c=this.visualElement.getProjectionParent();if(c){var f=fm(c.projection.targetFinal,l);Ja(function(h){var p=f[h],g=p.min,m=p.max;l[h]={min:isNaN(g)?void 0:g,max:isNaN(m)?void 0:m}})}}var d=Ja(function(h){var p;if(!!Y_(h,i,n.currentDirection)){var g=(p=l==null?void 0:l[h])!==null&&p!==void 0?p:{},m=o?200:1e6,v=o?40:1e7,y=Ie(Ie({type:"inertia",velocity:a?t[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10},s),g);return n.getAxisMotionValue(h)?n.startAxisValueAnimation(h,y):n.visualElement.startLayoutAnimation(h,y,u)}});return Promise.all(d).then(function(){var h,p;(p=(h=n.props).onDragTransitionEnd)===null||p===void 0||p.call(h)})},e.prototype.stopMotion=function(){var t=this;Ja(function(n){var r=t.getAxisMotionValue(n);r?r.stop():t.visualElement.stopLayoutAnimation()})},e.prototype.startAxisValueAnimation=function(t,n){var r=this.getAxisMotionValue(t);if(!!r){var i=r.get();return r.set(i),r.set(i),V_(t,r,0,n)}},e.prototype.scalePoint=function(){var t=this,n=this.props,r=n.drag,i=n.dragConstraints;if(!(!mR(i)||!this.constraintsBox)){this.stopMotion();var a={x:0,y:0};Ja(function(o){a[o]=QNe(t.visualElement.projection.target[o],t.constraintsBox[o])}),this.updateConstraints(function(){Ja(function(o){if(!!Y_(o,r,null)){var s=XNe(t.visualElement.projection.target[o],t.constraintsBox[o],a[o]),u=s.min,l=s.max;t.visualElement.setProjectionTargetAxis(o,u,l)}})}),setTimeout(QR,1)}},e.prototype.updateConstraints=function(t){var n=this;this.cancelLayout=JR(function(r,i){var a=G_(n.visualElement);i(function(){return a.forEach(function(o){return o.resetTransform()})}),r(function(){return K_(n.visualElement)}),i(function(){return a.forEach(function(o){return o.restoreTransform()})}),r(function(){n.resolveDragConstraints()}),t&&i(t)})},e.prototype.mount=function(t){var n=this,r=t.getInstance(),i=lm(r,"pointerdown",function(u){var l=n.props,c=l.drag,f=l.dragListener,d=f===void 0?!0:f;c&&d&&n.start(u)}),a=OR(window,"resize",function(){n.scalePoint()}),o=t.onLayoutUpdate(function(){n.isDragging&&n.resolveDragConstraints()}),s=t.prevDragCursor;return s&&this.start(AG,{cursorProgress:s}),function(){i==null||i(),a==null||a(),o==null||o(),n.cancelDrag()}},e}();function Y_(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function dDe(e,t){t===void 0&&(t=10);var n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}function hDe(e){var t=e.dragControls,n=e.visualElement,r=Un(C_).transformPagePoint,i=Oy(function(){return new fDe({visualElement:n})});i.setProps(Ie(Ie({},e),{transformPagePoint:r})),qt(function(){return t&&t.subscribe(i)},[i]),qt(function(){return i.mount(n)},[])}function pDe(e){var t=e.onPan,n=e.onPanStart,r=e.onPanEnd,i=e.onPanSessionStart,a=e.visualElement,o=t||n||r||i,s=Jt(null),u=Un(C_).transformPagePoint,l={onSessionStart:i,onStart:n,onMove:t,onEnd:function(f,d){s.current=null,r&&r(f,d)}};qt(function(){s.current!==null&&s.current.updateHandlers(l)});function c(f){s.current=new KH(f,l,{transformPagePoint:u})}R_(a,"pointerdown",o&&c),DR(function(){return s.current&&s.current.end()})}var gDe={pan:Ah(pDe),drag:Ah(hDe)},Wy;(function(e){e[e.Entering=0]="Entering",e[e.Present=1]="Present",e[e.Exiting=2]="Exiting"})(Wy||(Wy={}));var eF;(function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"})(eF||(eF={}));function tF(e){return typeof e=="string"&&e.startsWith("var(--")}var CG=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function mDe(e){var t=CG.exec(e);if(!t)return[,];var n=mr(t,3),r=n[1],i=n[2];return[r,i]}function nF(e,t,n){var r=mr(mDe(e),2),i=r[0],a=r[1];if(!!i){var o=window.getComputedStyle(t).getPropertyValue(i);return o?o.trim():tF(a)?nF(a,t):a}}function vDe(e,t,n){var r,i=Oo(t,[]),a=e.getInstance();if(!(a instanceof HTMLElement))return{target:i,transitionEnd:n};n&&(n=Ie({},n)),e.forEachValue(function(l){var c=l.get();if(!!tF(c)){var f=nF(c,a);f&&l.set(f)}});for(var o in i){var s=i[o];if(!!tF(s)){var u=nF(s,a);!u||(i[o]=u,n&&((r=n[o])!==null&&r!==void 0||(n[o]=s)))}}return{target:i,transitionEnd:n}}function kG(e,t){return e/(t.max-t.min)*100}function yDe(e,t,n){var r=n.target;if(typeof e=="string")if(Tt.test(e))e=parseFloat(e);else return e;var i=kG(e,r.x),a=kG(e,r.y);return i+"% "+a+"%"}var TG="_$css";function bDe(e,t){var n=t.delta,r=t.treeScale,i=e,a=e.includes("var("),o=[];a&&(e=e.replace(CG,function(g){return o.push(g),TG}));var s=ec.parse(e);if(s.length>5)return i;var u=ec.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*r.x,f=n.y.scale*r.y;s[0+l]/=c,s[1+l]/=f;var d=Za(c,f,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);var h=u(s);if(a){var p=0;h=h.replace(TG,function(){var g=o[p];return p++,g})}return h}var Vy={process:yDe},xDe={borderRadius:Ie(Ie({},Vy),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Vy,borderTopRightRadius:Vy,borderBottomLeftRadius:Vy,borderBottomRightRadius:Vy,boxShadow:{process:bDe}},OG=1e3,wDe=function(e){Sq(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.frameTarget=wf(),n.currentAnimationTarget=wf(),n.isAnimating={x:!1,y:!1},n.stopAxisAnimation={x:void 0,y:void 0},n.isAnimatingTree=!1,n.animate=function(r,i,a){a===void 0&&(a={});var o=a.originBox,s=a.targetBox,u=a.visibilityAction,l=a.shouldStackAnimate,c=a.onComplete,f=a.prevParent,d=Oo(a,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete","prevParent"]),h=n.props,p=h.visualElement,g=h.layout;if(l===!1)return n.isAnimatingTree=!1,n.safeToRemove();if(!(n.isAnimatingTree&&l!==!0)){l&&(n.isAnimatingTree=!0),i=o||i,r=s||r;var m=!1,v=p.getProjectionParent();if(v){var y=v.prevViewportBox,b=v.getLayoutState().layout;f&&(s&&(b=f.getLayoutState().layout),o&&!iDe(f,v)&&f.prevViewportBox&&(y=f.prevViewportBox)),y&&ADe(f,o,s)&&(m=!0,i=fm(y,i),r=fm(b,r))}var x=SDe(i,r),w=Ja(function(S){var A,_;if(g==="position"){var E=r[S].max-r[S].min;i[S].max=i[S].min+E}if(!p.projection.isTargetLocked)if(u!==void 0)p.setVisibility(u===eF.Show);else return x?n.animateAxis(S,r[S],i[S],Ie(Ie({},d),{isRelative:m})):((_=(A=n.stopAxisAnimation)[S])===null||_===void 0||_.call(A),p.setProjectionTargetAxis(S,r[S].min,r[S].max,m))});return p.syncRender(),Promise.all(w).then(function(){n.isAnimatingTree=!1,c&&c(),p.notifyLayoutAnimationComplete()})}},n}return t.prototype.componentDidMount=function(){var n=this,r=this.props.visualElement;r.animateMotionValue=V_,r.enableLayoutProjection(),this.unsubLayoutReady=r.onLayoutUpdate(this.animate),r.layoutSafeToRemove=function(){return n.safeToRemove()},uOe(xDe)},t.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),Ja(function(r){var i,a;return(a=(i=n.stopAxisAnimation)[r])===null||a===void 0?void 0:a.call(i)})},t.prototype.animateAxis=function(n,r,i,a){var o=this,s,u,l=a===void 0?{}:a,c=l.transition,f=l.isRelative;if(!(this.isAnimating[n]&&qy(r,this.currentAnimationTarget[n]))){(u=(s=this.stopAxisAnimation)[n])===null||u===void 0||u.call(s),this.isAnimating[n]=!0;var d=this.props.visualElement,h=this.frameTarget[n],p=d.getProjectionAnimationProgress()[n];p.clearListeners(),p.set(0),p.set(0);var g=function(){var b=p.get()/OG;rDe(h,i,r,b),d.setProjectionTargetAxis(n,h.min,h.max,f)};g();var m=p.onChange(g);this.stopAxisAnimation[n]=function(){o.isAnimating[n]=!1,p.stop(),m()},this.currentAnimationTarget[n]=r;var v=c||d.getDefaultTransition()||EDe,y=V_(n==="x"?"layoutX":"layoutY",p,OG,v&&VR(v,"layout")).then(this.stopAxisAnimation[n]);return y}},t.prototype.safeToRemove=function(){var n,r;(r=(n=this.props).safeToRemove)===null||r===void 0||r.call(n)},t.prototype.render=function(){return null},t}(Ds);function _De(e){var t=mr(gR(),2),n=t[1];return ue(wDe,Ie({},e,{safeToRemove:n}))}function SDe(e,t){return!NG(e)&&!NG(t)&&(!qy(e.x,t.x)||!qy(e.y,t.y))}var IG={min:0,max:0};function NG(e){return qy(e.x,IG)&&qy(e.y,IG)}function qy(e,t){return e.min===t.min&&e.max===t.max}var EDe={duration:.45,ease:[.4,0,.1,1]};function ADe(e,t,n){return e||!e&&!(t||n)}var CDe={layoutReady:function(e){return e.notifyLayoutReady()}};function DG(){var e=new Set;return{add:function(t){return e.add(t)},flush:function(t){var n=t===void 0?CDe:t,r=n.layoutReady,i=n.parent;JR(function(a,o){var s=Array.from(e).sort(XR),u=i?G_(i):[];o(function(){var l=ma(ma([],mr(u)),mr(s));l.forEach(function(c){return c.resetTransform()})}),a(function(){s.forEach(K_)}),o(function(){u.forEach(function(l){return l.restoreTransform()}),s.forEach(r)}),a(function(){s.forEach(function(l){l.isPresent&&(l.presence=Wy.Present)})}),o(function(){Jg.preRender(),Jg.render()}),a(function(){Mu.postRender(function(){return s.forEach(kDe)}),e.clear()})}),QR()}}}function kDe(e){e.prevViewportBox=e.projection.target}var RG=ha(DG()),TDe=ha(DG());function Th(e){return!!e.forceUpdate}var ODe=function(e){Sq(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){var n=this.props,r=n.syncLayout,i=n.framerSyncLayout,a=n.visualElement;Th(r)&&r.register(a),Th(i)&&i.register(a),a.onUnmount(function(){Th(r)&&r.remove(a),Th(i)&&i.remove(a)})},t.prototype.getSnapshotBeforeUpdate=function(){var n=this.props,r=n.syncLayout,i=n.visualElement;return Th(r)?r.syncUpdate():(nDe(i),r.add(i)),null},t.prototype.componentDidUpdate=function(){var n=this.props.syncLayout;Th(n)||n.flush()},t.prototype.render=function(){return null},t}(zt.Component);function IDe(e){var t=Un(RG),n=Un(TDe);return zt.createElement(ODe,Ie({},e,{syncLayout:t,framerSyncLayout:n}))}var NDe={measureLayout:IDe,layoutAnimation:_De},DDe=function(){return{isEnabled:!1,isHydrated:!1,isTargetLocked:!1,target:wf(),targetFinal:wf()}};function FG(){return{isHydrated:!1,layout:wf(),layoutCorrected:wf(),treeScale:{x:1,y:1},delta:QH(),deltaFinal:QH(),deltaTransform:""}}var MG=FG();function Z_(e,t,n){var r=e.x,i=e.y,a=r.translate/t.x,o=i.translate/t.y,s="translate3d("+a+"px, "+o+"px, 0) ";if(n){var u=n.rotate,l=n.rotateX,c=n.rotateY;u&&(s+="rotate("+u+") "),l&&(s+="rotateX("+l+") "),c&&(s+="rotateY("+c+") ")}return s+="scale("+r.scale+", "+i.scale+")",!n&&s===RDe?"":s}function PG(e){var t=e.deltaFinal;return t.x.origin*100+"% "+t.y.origin*100+"% 0"}var RDe=Z_(MG.delta,MG.treeScale,{x:1,y:1}),J_=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","SetAxisTarget","Unmount"];function FDe(){var e=J_.map(function(){return new q_}),t={},n={clearAllListeners:function(){return e.forEach(function(r){return r.clear()})},updatePropListeners:function(r){return J_.forEach(function(i){var a;(a=t[i])===null||a===void 0||a.call(t);var o="on"+i,s=r[o];s&&(t[i]=n[o](s))})}};return e.forEach(function(r,i){n["on"+J_[i]]=function(a){return r.add(a)},n["notify"+J_[i]]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.notify.apply(r,ma([],mr(a)))}}),n}function MDe(e,t,n){var r;for(var i in t){var a=t[i],o=n[i];if(bf(a))e.addValue(i,a);else if(bf(o))e.addValue(i,kh(a));else if(o!==a)if(e.hasValue(i)){var s=e.getValue(i);!s.hasAnimated&&s.set(a)}else e.addValue(i,kh((r=e.getStaticValue(i))!==null&&r!==void 0?r:a))}for(var i in n)t[i]===void 0&&e.removeValue(i);return t}function PDe(e,t,n,r){var i=e.delta,a=e.layout,o=e.layoutCorrected,s=e.treeScale,u=t.target;aDe(o,a),uDe(o,s,n),lG(i,o,u,r)}var $De=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(t){WH(this.children,t),this.isDirty=!0},e.prototype.remove=function(t){VH(this.children,t),this.isDirty=!0},e.prototype.forEach=function(t){this.isDirty&&this.children.sort(XR),this.isDirty=!1,this.children.forEach(t)},e}();function LDe(e){var t=e.getProjectionParent();if(!t){e.rebaseProjectionTarget();return}var n=fm(t.getLayoutState().layout,e.getLayoutState().layout);Ja(function(r){e.setProjectionTargetAxis(r,n[r].min,n[r].max,!0)})}var $G=function(e){var t=e.treeType,n=t===void 0?"":t,r=e.build,i=e.getBaseTarget,a=e.makeTargetAnimatable,o=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.resetTransform,c=e.restoreTransform,f=e.removeValueFromRenderState,d=e.sortNodePosition,h=e.scrapeMotionValuesFromProps;return function(p,g){var m=p.parent,v=p.props,y=p.presenceId,b=p.blockInitialAnimation,x=p.visualState;g===void 0&&(g={});var w=x.latestValues,S=x.renderState,A,_=FDe(),E=DDe(),C,k=E,T=w,I,N=FG(),O,D=!1,L=new Map,W=new Map,G={},K,ee=Ie({},w),ce;function he(){!A||(B.isProjectionReady()&&(ZR(k.targetFinal,k.target,T),lG(N.deltaFinal,N.layoutCorrected,k.targetFinal,w)),Oe(),s(A,S))}function Oe(){var R=w;if(O&&O.isActive()){var X=O.getCrossfadeState(B);X&&(R=X)}r(B,S,R,k,N,g,v)}function Te(){_.notifyUpdate(w)}function Re(){if(!!B.isProjectionReady()){var R=N.delta,X=N.treeScale,ge=X.x,xe=X.y,ze=N.deltaTransform;PDe(N,k,B.path,w),D&&B.notifyViewportBoxUpdate(k.target,R),D=!1;var Ke=Z_(R,X);(Ke!==ze||ge!==X.x||xe!==X.y)&&B.scheduleRender(),N.deltaTransform=Ke}}function me(){B.layoutTree.forEach(zDe)}function P(R,X){var ge=X.onChange(function(ze){w[R]=ze,v.onUpdate&&Mu.update(Te,!1,!0)}),xe=X.onRenderRequest(B.scheduleRender);W.set(R,function(){ge(),xe()})}var F=h(v);for(var V in F){var ae=F[V];w[V]!==void 0&&bf(ae)&&ae.set(w[V],!1)}var Y=O_(v),M=Oq(v),B=Ie(Ie({treeType:n,current:null,depth:m?m.depth+1:0,parent:m,children:new Set,path:m?ma(ma([],mr(m.path)),[m]):[],layoutTree:m?m.layoutTree:new $De,presenceId:y,projection:E,variantChildren:M?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(m==null?void 0:m.isMounted()),blockInitialAnimation:b,isMounted:function(){return Boolean(A)},mount:function(R){A=B.current=R,B.pointTo(B),M&&m&&!Y&&(ce=m==null?void 0:m.addVariantChild(B)),m==null||m.children.add(B)},unmount:function(){dy.update(Te),dy.render(he),dy.preRender(B.updateLayoutProjection),W.forEach(function(R){return R()}),B.stopLayoutAnimation(),B.layoutTree.remove(B),ce==null||ce(),m==null||m.children.delete(B),I==null||I(),_.clearAllListeners()},addVariantChild:function(R){var X,ge=B.getClosestVariantNode();if(ge)return(X=ge.variantChildren)===null||X===void 0||X.add(R),function(){return ge.variantChildren.delete(R)}},sortNodePosition:function(R){return!d||n!==R.treeType?0:d(B.getInstance(),R.getInstance())},getClosestVariantNode:function(){return M?B:m==null?void 0:m.getClosestVariantNode()},scheduleUpdateLayoutProjection:m?m.scheduleUpdateLayoutProjection:function(){return Mu.preRender(B.updateTreeLayoutProjection,!1,!0)},getLayoutId:function(){return v.layoutId},getInstance:function(){return A},getStaticValue:function(R){return w[R]},setStaticValue:function(R,X){return w[R]=X},getLatestValues:function(){return w},setVisibility:function(R){B.isVisible!==R&&(B.isVisible=R,B.scheduleRender())},makeTargetAnimatable:function(R,X){return X===void 0&&(X=!0),a(B,R,v,X)},addValue:function(R,X){B.hasValue(R)&&B.removeValue(R),L.set(R,X),w[R]=X.get(),P(R,X)},removeValue:function(R){var X;L.delete(R),(X=W.get(R))===null||X===void 0||X(),W.delete(R),delete w[R],f(R,S)},hasValue:function(R){return L.has(R)},getValue:function(R,X){var ge=L.get(R);return ge===void 0&&X!==void 0&&(ge=kh(X),B.addValue(R,ge)),ge},forEachValue:function(R){return L.forEach(R)},readValue:function(R){var X;return(X=w[R])!==null&&X!==void 0?X:u(A,R,g)},setBaseTarget:function(R,X){ee[R]=X},getBaseTarget:function(R){if(i){var X=i(v,R);if(X!==void 0&&!bf(X))return X}return ee[R]}},_),{build:function(){return Oe(),S},scheduleRender:function(){Mu.render(he,!1,!0)},syncRender:he,setProps:function(R){v=R,_.updatePropListeners(R),G=MDe(B,h(v),G)},getProps:function(){return v},getVariant:function(R){var X;return(X=v.variants)===null||X===void 0?void 0:X[R]},getDefaultTransition:function(){return v.transition},getVariantContext:function(R){if(R===void 0&&(R=!1),R)return m==null?void 0:m.getVariantContext();if(!Y){var X=(m==null?void 0:m.getVariantContext())||{};return v.initial!==void 0&&(X.initial=v.initial),X}for(var ge={},xe=0;xe<jDe;xe++){var ze=LG[xe],Ke=v[ze];(zs(Ke)||Ke===!1)&&(ge[ze]=Ke)}return ge},enableLayoutProjection:function(){E.isEnabled=!0,B.layoutTree.add(B)},lockProjectionTarget:function(){E.isTargetLocked=!0},unlockProjectionTarget:function(){B.stopLayoutAnimation(),E.isTargetLocked=!1},getLayoutState:function(){return N},setCrossfader:function(R){O=R},isProjectionReady:function(){return E.isEnabled&&E.isHydrated&&N.isHydrated},startLayoutAnimation:function(R,X,ge){ge===void 0&&(ge=!1);var xe=B.getProjectionAnimationProgress()[R],ze=ge?E.relativeTarget[R]:E.target[R],Ke=ze.min,Ze=ze.max,Bt=Ze-Ke;return xe.clearListeners(),xe.set(Ke),xe.set(Ke),xe.onChange(function(Je){B.setProjectionTargetAxis(R,Je,Je+Bt,ge)}),B.animateMotionValue(R,xe,0,X)},stopLayoutAnimation:function(){Ja(function(R){return B.getProjectionAnimationProgress()[R].stop()})},measureViewportBox:function(R){R===void 0&&(R=!0);var X=o(A,g);return R||_G(X,w),X},getProjectionAnimationProgress:function(){return K||(K={x:kh(0),y:kh(0)}),K},setProjectionTargetAxis:function(R,X,ge,xe){xe===void 0&&(xe=!1);var ze;xe?(E.relativeTarget||(E.relativeTarget=wf()),ze=E.relativeTarget[R]):(E.relativeTarget=void 0,ze=E.target[R]),E.isHydrated=!0,ze.min=X,ze.max=ge,D=!0,_.notifySetAxisTarget()},rebaseProjectionTarget:function(R,X){X===void 0&&(X=N.layout);var ge=B.getProjectionAnimationProgress(),xe=ge.x,ze=ge.y,Ke=!E.relativeTarget&&!E.isTargetLocked&&!xe.isAnimating()&&!ze.isAnimating();(R||Ke)&&Ja(function(Ze){var Bt=X[Ze],Je=Bt.min,Zt=Bt.max;B.setProjectionTargetAxis(Ze,Je,Zt)})},notifyLayoutReady:function(R){LDe(B),B.notifyLayoutUpdate(N.layout,B.prevViewportBox||N.layout,R)},resetTransform:function(){return l(B,A,v)},restoreTransform:function(){return c(A,S)},updateLayoutProjection:Re,updateTreeLayoutProjection:function(){B.layoutTree.forEach(BDe),Mu.preRender(me,!1,!0)},getProjectionParent:function(){if(C===void 0){for(var R=!1,X=B.path.length-1;X>=0;X--){var ge=B.path[X];if(ge.projection.isEnabled){R=ge;break}}C=R}return C},resolveRelativeTargetBox:function(){var R=B.getProjectionParent();if(!(!E.relativeTarget||!R)&&(eDe(E,R.projection),pG(R))){var X=E.target;ZR(X,X,R.getLatestValues())}},shouldResetTransform:function(){return Boolean(v._layoutResetTransform)},pointTo:function(R){k=R.projection,T=R.getLatestValues(),I==null||I(),I=zy(R.onSetAxisTarget(B.scheduleUpdateLayoutProjection),R.onLayoutAnimationComplete(function(){var X;B.isPresent?B.presence=Wy.Present:(X=B.layoutSafeToRemove)===null||X===void 0||X.call(B)}))},isPresent:!0,presence:Wy.Entering});return B}};function BDe(e){e.resolveRelativeTargetBox()}function zDe(e){e.updateLayoutProjection()}var LG=ma(["initial"],mr(HR)),jDe=LG.length,UDe=new Set(["width","height","top","left","right","bottom","x","y"]),BG=function(e){return UDe.has(e)},WDe=function(e){return Object.keys(e).some(BG)},zG=function(e,t){e.set(t,!1),e.set(t)},jG=function(e){return e===Eh||e===Tt},UG;(function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"})(UG||(UG={}));var WG=function(e,t){return parseFloat(e.split(", ")[t])},VG=function(e,t){return function(n,r){var i=r.transform;if(i==="none"||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return WG(a[1],t);var o=i.match(/^matrix\((.+)\)$/);return o?WG(o[1],e):0}},VDe=new Set(["x","y","z"]),qDe=Dy.filter(function(e){return!VDe.has(e)});function HDe(e){var t=[];return qDe.forEach(function(n){var r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.syncRender(),t}var qG={width:function(e){var t=e.x;return t.max-t.min},height:function(e){var t=e.y;return t.max-t.min},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:VG(4,13),y:VG(5,14)},GDe=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),o=a.display,s=a.top,u=a.left,l=a.bottom,c=a.right,f=a.transform,d={top:s,left:u,bottom:l,right:c,transform:f};o==="none"&&t.setStaticValue("display",e.display||"block"),t.syncRender();var h=t.measureViewportBox();return n.forEach(function(p){var g=t.getValue(p);zG(g,qG[p](r,d)),e[p]=qG[p](h,a)}),e},KDe=function(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),t=Ie({},t),r=Ie({},r);var i=Object.keys(t).filter(BG),a=[],o=!1,s=[];if(i.forEach(function(l){var c=e.getValue(l);if(!!e.hasValue(l)){var f=n[l],d=t[l],h=H_(f),p;if(Ly(d))for(var g=d.length,m=d[0]===null?1:0;m<g;m++)p?ky(H_(d[m])===p):p=H_(d[m]);else p=H_(d);if(h!==p)if(jG(h)&&jG(p)){var v=c.get();typeof v=="string"&&c.set(parseFloat(v)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===Tt&&(t[l]=d.map(parseFloat))}else(h==null?void 0:h.transform)&&(p==null?void 0:p.transform)&&(f===0||d===0)?f===0?c.set(p.transform(f)):t[l]=h.transform(d):(o||(a=HDe(e),o=!0),s.push(l),r[l]=r[l]!==void 0?r[l]:t[l],zG(c,d))}}),s.length){var u=GDe(t,e,s);return a.length&&a.forEach(function(l){var c=mr(l,2),f=c[0],d=c[1];e.getValue(f).set(d)}),e.syncRender(),{target:u,transitionEnd:r}}else return{target:t,transitionEnd:r}};function XDe(e,t,n,r){return WDe(t)?KDe(e,t,n,r):{target:t,transitionEnd:r}}var YDe=function(e,t,n,r){var i=vDe(e,t,r);return t=i.target,r=i.transitionEnd,XDe(e,t,n,r)};function ZDe(e){return window.getComputedStyle(e)}var HG={treeType:"dom",readValueFromInstance:function(e,t){if(I_(t)){var n=UR(t);return n&&n.default||0}else{var r=ZDe(e);return(Rq(t)?r.getPropertyValue(t):r[t])||0}},sortNodePosition:function(e,t){return e.compareDocumentPosition(t)&2?1:-1},getBaseTarget:function(e,t){var n;return(n=e.style)===null||n===void 0?void 0:n[t]},measureViewportBox:function(e,t){var n=t.transformPagePoint;return oG(e,n)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var i=n.transformValues;r===void 0&&(r=!0);var a=t.transition,o=t.transitionEnd,s=Oo(t,["transition","transitionEnd"]),u=TNe(s,a||{},e);if(i&&(o&&(o=i(o)),s&&(s=i(s)),u&&(u=i(u))),r){CNe(e,s,u);var l=YDe(e,s,u,o);o=l.transitionEnd,s=l.target}return Ie({transition:a,transitionEnd:o},s)},scrapeMotionValuesFromProps:kR,build:function(e,t,n,r,i,a,o){e.isVisible!==void 0&&(t.style.visibility=e.isVisible?"visible":"hidden");var s=r.isEnabled&&i.isHydrated;SR(t,n,r,i,a,o.transformTemplate,s?Z_:void 0,s?PG:void 0)},render:Xq},JDe=$G(HG),QDe=$G(Ie(Ie({},HG),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return I_(t)?((n=UR(t))===null||n===void 0?void 0:n.default)||0:(t=Yq.has(t)?t:Kq(t),e.getAttribute(t))},scrapeMotionValuesFromProps:Jq,build:function(e,t,n,r,i,a,o){var s=r.isEnabled&&i.isHydrated;CR(t,n,r,i,a,o.transformTemplate,s?Z_:void 0,s?PG:void 0)},render:Zq})),eRe=function(e,t){return vR(e)?QDe(t,{enableHardwareAcceleration:!1}):JDe(t,{enableHardwareAcceleration:!0})},tRe=Ie(Ie(Ie(Ie({},BNe),oNe),gDe),NDe),GG=oOe(function(e,t){return YOe(e,t,tRe,eRe)});function nRe(){var e=Jt(!1),t=mr(an(0),2),n=t[0],r=t[1];return DR(function(){return e.current=!0}),st(function(){!e.current&&r(n+1)},[n])}var KG=0;function rRe(){var e=KG;return KG++,e}var rF=function(e){var t=e.children,n=e.initial,r=e.isPresent,i=e.onExitComplete,a=e.custom,o=e.presenceAffectsLayout,s=Oy(iRe),u=Oy(rRe),l=gr(function(){return{id:u,initial:n,isPresent:r,custom:a,onExitComplete:function(c){s.set(c,!0);var f=!0;s.forEach(function(d){d||(f=!1)}),f&&(i==null||i())},register:function(c){return s.set(c,!1),function(){return s.delete(c)}}}},o?void 0:[r]);return gr(function(){s.forEach(function(c,f){return s.set(f,!1)})},[r]),qt(function(){!r&&!s.size&&(i==null||i())},[r]),ue(Ty.Provider,{value:l},t)};function iRe(){return new Map}function dm(e){return e.key||""}function aRe(e,t){e.forEach(function(n){var r=dm(n);t.set(r,n)})}function oRe(e){var t=[];return N2.forEach(e,function(n){mh(n)&&t.push(n)}),t}var XG=function(e){var t=e.children,n=e.custom,r=e.initial,i=r===void 0?!0:r,a=e.onExitComplete,o=e.exitBeforeEnter,s=e.presenceAffectsLayout,u=s===void 0?!0:s,l=nRe(),c=Un(RG);Th(c)&&(l=c.forceUpdate);var f=Jt(!0),d=oRe(t),h=Jt(d),p=Jt(new Map).current,g=Jt(new Set).current;if(aRe(d,p),f.current)return f.current=!1,ue(Ii,null,d.map(function(S){return ue(rF,{key:dm(S),isPresent:!0,initial:i?void 0:!1,presenceAffectsLayout:u},S)}));for(var m=ma([],mr(d)),v=h.current.map(dm),y=d.map(dm),b=v.length,x=0;x<b;x++){var w=v[x];y.indexOf(w)===-1?g.add(w):g.delete(w)}return o&&g.size&&(m=[]),g.forEach(function(S){if(y.indexOf(S)===-1){var A=p.get(S);if(!!A){var _=v.indexOf(S),E=function(){p.delete(S),g.delete(S);var C=h.current.findIndex(function(k){return k.key===S});h.current.splice(C,1),g.size||(h.current=d,l(),a&&a())};m.splice(_,0,ue(rF,{key:dm(A),isPresent:!1,onExitComplete:E,custom:n,presenceAffectsLayout:u},A))}}}),m=m.map(function(S){var A=S.key;return g.has(A)?S:ue(rF,{key:dm(S),isPresent:!0,presenceAffectsLayout:u},S)}),h.current=m,ue(Ii,null,g.size?m:m.map(function(S){return cf(S)}))};function Q_(){return Q_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q_.apply(this,arguments)}var iF={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},Hy={scale:{enter:{scale:1},exit:{scale:.95}},fade:{enter:{opacity:1},exit:{opacity:0}},pushLeft:{enter:{x:"100%"},exit:{x:"-30%"}},pushRight:{enter:{x:"-100%"},exit:{x:"30%"}},pushUp:{enter:{y:"100%"},exit:{y:"-30%"}},pushDown:{enter:{y:"-100%"},exit:{y:"30%"}},slideLeft:{position:{left:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"-100%"}},slideRight:{position:{right:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"100%"}},slideUp:{position:{top:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"-100%"}},slideDown:{position:{bottom:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"100%"}}};function aF(e){var t,n=(t=e==null?void 0:e.direction)!=null?t:"right";switch(n){case"right":return Hy.slideRight;case"left":return Hy.slideLeft;case"bottom":return Hy.slideDown;case"top":return Hy.slideUp;default:return Hy.slideRight}}var YG={enter:{duration:.2,ease:iF.easeOut},exit:{duration:.1,ease:iF.easeIn}},eS={enter:(e,t)=>Q_({},e,{delay:pf(t)?t:t==null?void 0:t.enter}),exit:(e,t)=>Q_({},e,{delay:pf(t)?t:t==null?void 0:t.exit})},sRe={enter:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:1,transition:(n=r==null?void 0:r.enter)!=null?n:eS.enter(YG.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:0,transition:(n=r==null?void 0:r.exit)!=null?n:eS.exit(YG.exit,a),transitionEnd:i==null?void 0:i.exit}}},uRe={initial:"exit",animate:"enter",exit:"exit",variants:sRe};function lRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Gy(){return Gy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gy.apply(this,arguments)}var ZG={exit:{duration:.15,ease:iF.easeInOut},enter:{type:"spring",damping:25,stiffness:180}},cRe={exit:e=>{var t,{direction:n,transition:r,transitionEnd:i,delay:a}=e,{exit:o}=aF({direction:n});return Gy({},o,{transition:(t=r==null?void 0:r.exit)!=null?t:eS.exit(ZG.exit,a),transitionEnd:i==null?void 0:i.exit})},enter:e=>{var t,{direction:n,transitionEnd:r,transition:i,delay:a}=e,{enter:o}=aF({direction:n});return Gy({},o,{transition:(t=i==null?void 0:i.enter)!=null?t:eS.enter(ZG.enter,a),transitionEnd:r==null?void 0:r.enter})}},fRe=Kl((e,t)=>{var{direction:n="right",style:r,unmountOnExit:i,in:a,className:o,transition:s,transitionEnd:u,delay:l}=e,c=lRe(e,["direction","style","unmountOnExit","in","className","transition","transitionEnd","delay"]),f=aF({direction:n}),d=Object.assign({position:"fixed"},f.position,r),h=i?a&&i:!0,p=a||i?"enter":"exit",g={transitionEnd:u,transition:s,direction:n,delay:l};return ue(XG,{custom:g},h&&ue(GG.div,Gy({ref:t,initial:"exit",className:Wn("chakra-slide",o),animate:p,exit:"exit",custom:g,variants:cRe,style:d},c)))});function JG(e){return e.sort((t,n)=>{var r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var dRe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function QG(e,t,n){var r=e+1;return n&&r>=t&&(r=0),r}function eK(e,t,n){var r=e-1;return n&&r<0&&(r=t),r}var oF=typeof window!="undefined"?lf:qt,tS=e=>e;function sF(){return sF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sF.apply(this,arguments)}function Ar(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hRe{constructor(){var t=this;Ar(this,"descendants",new Map),Ar(this,"register",n=>{if(n!=null)return dRe(n)?this.registerNode(n):r=>{this.registerNode(r,n)}}),Ar(this,"unregister",n=>{this.descendants.delete(n);var r=JG(Array.from(this.descendants.keys()));this.assignIndex(r)}),Ar(this,"destroy",()=>{this.descendants.clear()}),Ar(this,"assignIndex",n=>{this.descendants.forEach(r=>{var i=n.indexOf(r.node);r.index=i,r.node.dataset.index=r.index.toString()})}),Ar(this,"count",()=>this.descendants.size),Ar(this,"enabledCount",()=>this.enabledValues().length),Ar(this,"values",()=>{var n=Array.from(this.descendants.values());return n.sort((r,i)=>r.index-i.index)}),Ar(this,"enabledValues",()=>this.values().filter(n=>!n.disabled)),Ar(this,"item",n=>{if(this.count()!==0)return this.values()[n]}),Ar(this,"enabledItem",n=>{if(this.enabledCount()!==0)return this.enabledValues()[n]}),Ar(this,"first",()=>this.item(0)),Ar(this,"firstEnabled",()=>this.enabledItem(0)),Ar(this,"last",()=>this.item(this.descendants.size-1)),Ar(this,"lastEnabled",()=>{var n=this.enabledValues().length-1;return this.enabledItem(n)}),Ar(this,"indexOf",n=>{var r,i;return n&&(r=(i=this.descendants.get(n))==null?void 0:i.index)!=null?r:-1}),Ar(this,"enabledIndexOf",n=>n==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(n))),Ar(this,"next",function(n,r){r===void 0&&(r=!0);var i=QG(n,t.count(),r);return t.item(i)}),Ar(this,"nextEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=QG(a,t.enabledCount(),r);return t.enabledItem(o)}}),Ar(this,"prev",function(n,r){r===void 0&&(r=!0);var i=eK(n,t.count()-1,r);return t.item(i)}),Ar(this,"prevEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=eK(a,t.enabledCount()-1,r);return t.enabledItem(o)}}),Ar(this,"registerNode",(n,r)=>{if(!(!n||this.descendants.has(n))){var i=Array.from(this.descendants.keys()).concat(n),a=JG(i);r!=null&&r.disabled&&(r.disabled=!!r.disabled);var o=sF({node:n,index:-1},r);this.descendants.set(n,o),this.assignIndex(a)}})}}function pRe(){var[e]=an(()=>new hRe);return oF(()=>()=>e.destroy()),e}var[gRe,tK]=Pu({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function mRe(e){var t=tK(),[n,r]=an(-1),i=Jt(null);oF(()=>()=>{!i.current||t.unregister(i.current)},[]),oF(()=>{if(!!i.current){var o=Number(i.current.dataset.index);n!=o&&!Number.isNaN(o)&&r(o)}});var a=tS(e?t.register(e):t.register);return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(i.current),register:gf(a,i)}}function vRe(){var e=tS(gRe),t=()=>tS(tK()),n=i=>mRe(i),r=()=>pRe();return[e,t,r,n]}function Ky(){return Ky=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ky.apply(this,arguments)}var yRe=e=>ue(Ay,Ky({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})),bRe=e=>ue(Ay,Ky({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})),nK=e=>ue(Ay,Ky({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"}));function tc(){return tc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tc.apply(this,arguments)}function xRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var rK={info:{icon:bRe,colorScheme:"blue"},warning:{icon:nK,colorScheme:"orange"},success:{icon:yRe,colorScheme:"green"},error:{icon:nK,colorScheme:"red"}},[wRe,_Re]=Pu({name:"AlertContext",errorMessage:"useAlertContext: `context` is undefined. Seems you forgot to wrap alert components in `<Alert />`"}),SRe=Mt((e,t)=>{var n,r=ko(e),{status:i="info"}=r,a=xRe(r,["status"]),o=(n=e.colorScheme)!=null?n:rK[i].colorScheme,s=mf("Alert",tc({},e,{colorScheme:o})),u=tc({width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden"},s.container);return ue(wRe,{value:{status:i}},ue(yy,{value:s},ue(xt.div,tc({role:"alert",ref:t},a,{className:Wn("chakra-alert",e.className),__css:u}))))}),ERe=Mt((e,t)=>{var n=yi();return ue(xt.div,tc({ref:t},e,{className:Wn("chakra-alert__title",e.className),__css:n.title}))}),ARe=Mt((e,t)=>{var n=yi(),r=tc({display:"inline"},n.description);return ue(xt.div,tc({ref:t},e,{className:Wn("chakra-alert__desc",e.className),__css:r}))}),CRe=e=>{var{status:t}=_Re(),{icon:n}=rK[t],r=yi();return ue(xt.span,tc({display:"inherit"},e,{className:Wn("chakra-alert__icon",e.className),__css:r.icon}),ue(n,{w:"100%",h:"100%"}))},[uIt,kRe]=Pu({strict:!1,name:"ButtonGroupContext"}),uF={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},TRe=xt("span",{baseStyle:uF});xt("input",{baseStyle:uF});function nS(){return nS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nS.apply(this,arguments)}function ORe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var IRe=fV({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),NRe=Mt((e,t)=>{var n=xh("Spinner",e),r=ko(e),{label:i="Loading...",thickness:a="2px",speed:o="0.45s",emptyColor:s="transparent",className:u}=r,l=ORe(r,["label","thickness","speed","emptyColor","className"]),c=Wn("chakra-spinner",u),f=nS({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:a,borderBottomColor:s,borderLeftColor:s,animation:IRe+" "+o+" linear infinite"},n);return ue(xt.div,nS({ref:t,__css:f,className:c},l),i&&ue(TRe,null,i))});function rS(){return rS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rS.apply(this,arguments)}function DRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iK=e=>{var{label:t,placement:n,children:r=ue(NRe,{color:"currentColor",width:"1em",height:"1em"}),className:i,__css:a}=e,o=DRe(e,["label","placement","spacing","children","className","__css"]),s=Wn("chakra-button__spinner",i),u=n==="start"?"marginEnd":"marginStart",l=gr(()=>rS({display:"flex",alignItems:"center",position:t?"relative":"absolute",[u]:t?"0.5rem":0,fontSize:"1em",lineHeight:"normal"},a),[a,t,u]);return ue(xt.div,rS({className:s},o,{__css:l}),r)};function lF(){return lF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lF.apply(this,arguments)}function RRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var aK=e=>{var{children:t,className:n}=e,r=RRe(e,["children","className"]),i=mh(t)?cf(t,{"aria-hidden":!0,focusable:!1}):t,a=Wn("chakra-button__icon",n);return ue(xt.span,lF({display:"inline-flex",alignSelf:"center",flexShrink:0},r,{className:a}),i)};function FRe(e){var[t,n]=an(!e),r=st(a=>{!a||n(a.tagName==="BUTTON")},[]),i=t?"button":void 0;return{ref:r,type:i}}function MRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Xy(){return Xy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xy.apply(this,arguments)}var oK=Mt((e,t)=>{var n=kRe(),r=xh("Button",Xy({},n,e)),i=ko(e),{isDisabled:a=n==null?void 0:n.isDisabled,isLoading:o,isActive:s,isFullWidth:u,children:l,leftIcon:c,rightIcon:f,loadingText:d,iconSpacing:h="0.5rem",type:p,spinner:g,spinnerPlacement:m="start",className:v,as:y}=i,b=MRe(i,["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"]),x=gr(()=>{var _,E=Zl({},(_=r==null?void 0:r._focus)!=null?_:{},{zIndex:1});return Xy({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:u?"100%":"auto"},r,!!n&&{_focus:E})},[r,n,u]),{ref:w,type:S}=FRe(y),A={rightIcon:f,leftIcon:c,iconSpacing:h,children:l};return ue(xt.button,Xy({disabled:a||o,ref:gf(t,w),as:y,type:p??S,"data-active":Ni(s),"data-loading":Ni(o),__css:x,className:Wn("chakra-button",v)},b),o&&m==="start"&&ue(iK,{className:"chakra-button__spinner--start",label:d,placement:"start"},g),o?d||ue(xt.span,{opacity:0},ue(sK,A)):ue(sK,A),o&&m==="end"&&ue(iK,{className:"chakra-button__spinner--end",label:d,placement:"end"},g))});function sK(e){var{leftIcon:t,rightIcon:n,children:r,iconSpacing:i}=e;return ue(Ii,null,t&&ue(aK,{marginEnd:i},t),r,n&&ue(aK,{marginStart:i},n))}function cF(){return cF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cF.apply(this,arguments)}function PRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iS=Mt((e,t)=>{var{icon:n,children:r,isRound:i,"aria-label":a}=e,o=PRe(e,["icon","children","isRound","aria-label"]),s=n||r,u=mh(s)?cf(s,{"aria-hidden":!0,focusable:!1}):null;return ue(oK,cF({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":a},o),u)});function hm(){return hm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hm.apply(this,arguments)}function $Re(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function LRe(e){e===void 0&&(e={});var{defaultIsChecked:t,defaultChecked:n=t,isChecked:r,isFocusable:i,isDisabled:a,isReadOnly:o,isRequired:s,onChange:u,isIndeterminate:l,isInvalid:c,name:f,value:d,id:h,onBlur:p,onFocus:g,"aria-label":m,"aria-labelledby":v,"aria-invalid":y,"aria-describedby":b}=e,x=$Re(e,["defaultIsChecked","defaultChecked","isChecked","isFocusable","isDisabled","isReadOnly","isRequired","onChange","isIndeterminate","isInvalid","name","value","id","onBlur","onFocus","aria-label","aria-labelledby","aria-invalid","aria-describedby"]),w=py(u),S=py(p),A=py(g),[_,E]=CD(),[C,k]=CD(),[T,I]=CD(),N=Jt(null),[O,D]=an(!0),[L,W]=an(!!n),[G,K]=c2e(r,L);_D({condition:!!t,message:'The "defaultIsChecked" prop has been deprecated and will be removed in a future version. Please use the "defaultChecked" prop instead, which mirrors default React checkbox behavior.'});var ee=st(F=>{if(o||a){F.preventDefault();return}G||W(K?F.target.checked:l?!0:F.target.checked),w==null||w(F)},[o,a,K,G,l,w]);Qg(()=>{N.current&&(N.current.indeterminate=Boolean(l))},[l]);var ce=a&&!i,he=st(F=>{F.key===" "&&I.on()},[I]),Oe=st(F=>{F.key===" "&&I.off()},[I]);Qg(()=>{if(!!N.current){var F=N.current.checked!==K;F&&W(N.current.checked)}},[N.current]);var Te=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=Y=>{Y.preventDefault(),I.on()};return hm({},F,{ref:V,"data-active":Ni(T),"data-hover":Ni(C),"data-checked":Ni(K),"data-focus":Ni(_),"data-indeterminate":Ni(l),"data-disabled":Ni(a),"data-invalid":Ni(c),"data-readonly":Ni(o),"aria-hidden":!0,onMouseDown:Sr(F.onMouseDown,ae),onMouseUp:Sr(F.onMouseUp,I.off),onMouseEnter:Sr(F.onMouseEnter,k.on),onMouseLeave:Sr(F.onMouseLeave,k.off)})},[T,K,a,_,C,l,c,o,I,k.off,k.on]),Re=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},x,F,{ref:gf(V,ae=>{!ae||D(ae.tagName==="LABEL")}),onClick:Sr(F.onClick,()=>{if(!O){var ae;(ae=N.current)==null||ae.click(),Yg(N.current,{nextTick:!0})}}),"data-disabled":Ni(a)})},[x,a,O]),me=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},F,{ref:gf(N,V),type:"checkbox",name:f,value:d,id:h,onChange:Sr(F.onChange,ee),onBlur:Sr(F.onBlur,S,E.off),onFocus:Sr(F.onFocus,A,E.on),onKeyDown:Sr(F.onKeyDown,he),onKeyUp:Sr(F.onKeyUp,Oe),required:s,checked:K,disabled:ce,readOnly:o,"aria-label":m,"aria-labelledby":v,"aria-invalid":y?Boolean(y):c,"aria-describedby":b,"aria-disabled":a,style:uF})},[f,d,h,ee,E.off,E.on,S,A,he,Oe,s,K,ce,o,m,v,y,c,b,a]),P=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},F,{ref:V,onMouseDown:Sr(F.onMouseDown,uK),onTouchStart:Sr(F.onTouchStart,uK),"data-disabled":Ni(a),"data-checked":Ni(K),"data-invalid":Ni(c)})},[K,a,c]);return{state:{isInvalid:c,isFocused:_,isChecked:K,isActive:T,isHovered:C,isIndeterminate:l,isDisabled:a,isReadOnly:o,isRequired:s},getRootProps:Re,getCheckboxProps:Te,getInputProps:me,getLabelProps:P,htmlProps:x}}function uK(e){e.preventDefault(),e.stopPropagation()}function BRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Yy(){return Yy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yy.apply(this,arguments)}var zRe=e=>ue(Ay,Yy({focusable:"false","aria-hidden":!0},e),ue("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})),jRe=Mt((e,t)=>{var n=xh("CloseButton",e),r=ko(e),{children:i,isDisabled:a,__css:o}=r,s=BRe(r,["children","isDisabled","__css"]),u={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return ue(xt.button,Yy({type:"button","aria-label":"Close",ref:t,disabled:a,__css:Yy({},u,n,o)},s),i||ue(zRe,{width:"1em",height:"1em"}))}),[lIt,URe]=Pu({strict:!1,name:"FormControlContext"});function aS(){return aS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aS.apply(this,arguments)}function lK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function cK(e){var t=WRe(e),{isDisabled:n,isInvalid:r,isReadOnly:i,isRequired:a}=t,o=lK(t,["isDisabled","isInvalid","isReadOnly","isRequired"]);return aS({},o,{disabled:n,readOnly:i,required:a,"aria-invalid":wD(r),"aria-required":wD(a),"aria-readonly":wD(i)})}function WRe(e){var t,n,r,i=URe(),{id:a,disabled:o,readOnly:s,required:u,isRequired:l,isInvalid:c,isReadOnly:f,isDisabled:d,onFocus:h,onBlur:p}=e,g=lK(e,["id","disabled","readOnly","required","isRequired","isInvalid","isReadOnly","isDisabled","onFocus","onBlur"]),m=e["aria-describedby"]?[e["aria-describedby"]]:[];return i!=null&&i.hasFeedbackText&&i!=null&&i.isInvalid&&m.push(i.feedbackId),i!=null&&i.hasHelpText&&m.push(i.helpTextId),aS({},g,{"aria-describedby":m.join(" ")||void 0,id:a??(i==null?void 0:i.id),isDisabled:(t=o??d)!=null?t:i==null?void 0:i.isDisabled,isReadOnly:(n=s??f)!=null?n:i==null?void 0:i.isReadOnly,isRequired:(r=u??l)!=null?r:i==null?void 0:i.isRequired,isInvalid:c??(i==null?void 0:i.isInvalid),onFocus:Sr(i==null?void 0:i.onFocus,h),onBlur:Sr(i==null?void 0:i.onBlur,p)})}function fF(){return fF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fF.apply(this,arguments)}var fK=Mt((e,t)=>{var n=mf("Input",e),r=ko(e),i=cK(r),a=Wn("chakra-input",e.className);return ue(xt.input,fF({},i,{__css:n.field,ref:t,className:a}))});fK.id="Input";var oS=xt("div");function dF(){return dF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dF.apply(this,arguments)}function VRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var qRe=Mt((e,t)=>{var{direction:n,align:r,justify:i,wrap:a,basis:o,grow:s,shrink:u}=e,l=VRe(e,["direction","align","justify","wrap","basis","grow","shrink"]),c={display:"flex",flexDirection:n,alignItems:r,justifyContent:i,flexWrap:a,flexBasis:o,flexGrow:s,flexShrink:u};return ue(xt.div,dF({ref:t,__css:c},l))});function sS(){return sS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sS.apply(this,arguments)}function dK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var hK=Mt((e,t)=>{var{area:n,templateAreas:r,gap:i,rowGap:a,columnGap:o,column:s,row:u,autoFlow:l,autoRows:c,templateRows:f,autoColumns:d,templateColumns:h}=e,p=dK(e,["area","templateAreas","gap","rowGap","columnGap","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns"]),g={display:"grid",gridArea:n,gridTemplateAreas:r,gridGap:i,gridRowGap:a,gridColumnGap:o,gridAutoColumns:d,gridColumn:s,gridRow:u,gridAutoFlow:l,gridAutoRows:c,gridTemplateRows:f,gridTemplateColumns:h};return ue(xt.div,sS({ref:t,__css:g},p))});function pK(e){return hy(e,t=>t==="auto"?"auto":"span "+t+"/span "+t)}var Oh=Mt((e,t)=>{var{colSpan:n,colStart:r,colEnd:i,rowEnd:a,rowSpan:o,rowStart:s}=e,u=dK(e,["colSpan","colStart","colEnd","rowEnd","rowSpan","rowStart"]),l=o_({gridColumn:pK(n),gridRow:pK(o),gridColumnStart:r,gridColumnEnd:i,gridRowStart:s,gridRowEnd:a});return ue(xt.div,sS({ref:t,__css:l},u))});function hF(){return hF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hF.apply(this,arguments)}function HRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var GRe=Mt((e,t)=>{var n=xh("Heading",e),r=ko(e),i=HRe(r,["className"]);return ue(xt.h2,hF({ref:t,className:Wn("chakra-heading",e.className)},i,{__css:n}))});function pF(){return pF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pF.apply(this,arguments)}function KRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var XRe=Mt((e,t)=>{var n=xh("Link",e),r=ko(e),{className:i,isExternal:a}=r,o=KRe(r,["className","isExternal"]);return ue(xt.a,pF({target:a?"_blank":void 0,rel:a?"noopener noreferrer":void 0,ref:t,className:Wn("chakra-link",i)},o,{__css:n}))});function pm(){return pm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pm.apply(this,arguments)}function gK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var YRe=Mt((e,t)=>{var n=mf("List",e),r=ko(e),{children:i,styleType:a="none",stylePosition:o,spacing:s}=r,u=gK(r,["children","styleType","stylePosition","spacing"]),l=AD(i),c="& > *:not(style) ~ *:not(style)",f=s?{[c]:{mt:s}}:{};return ue(yy,{value:n},ue(xt.ul,pm({ref:t,listStyleType:a,listStylePosition:o,role:"list",__css:pm({},n.container,f)},u),l))}),ZRe=Mt((e,t)=>{var n=gK(e,["as"]);return ue(YRe,pm({ref:t,as:"ul",styleType:"initial",marginStart:"1em"},n))}),JRe=Mt((e,t)=>{var n=yi();return ue(xt.li,pm({ref:t},e,{__css:n.item}))});function gF(){return gF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gF.apply(this,arguments)}function QRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var eFe=Mt((e,t)=>{var{columns:n,spacingX:r,spacingY:i,spacing:a,minChildWidth:o}=e,s=QRe(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),u=o?nFe(o):rFe(n);return ue(hK,gF({ref:t,gap:a,columnGap:r,rowGap:i,templateColumns:u},s))});function tFe(e){return pf(e)?e+"px":e}function nFe(e){return hy(e,t=>hV(t)?null:"repeat(auto-fit, minmax("+tFe(t)+", 1fr))")}function rFe(e){return hy(e,t=>hV(t)?null:"repeat("+t+", minmax(0, 1fr))")}var iFe=xt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}}),mF="& > *:not(style) ~ *:not(style)";function aFe(e){var{spacing:t,direction:n}=e,r={column:{marginTop:t,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:t},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:t,marginStart:0},"row-reverse":{marginTop:0,marginEnd:t,marginBottom:0,marginStart:0}};return{flexDirection:n,[mF]:hy(n,i=>r[i])}}function oFe(e){var{spacing:t,direction:n}=e,r={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":hy(n,i=>r[i])}}function sFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function gm(){return gm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gm.apply(this,arguments)}var uFe=e=>ue(xt.div,gm({className:"chakra-stack__item"},e,{__css:gm({display:"inline-block",flex:"0 0 auto",minWidth:0},e.__css)})),mK=Mt((e,t)=>{var{isInline:n,direction:r,align:i,justify:a,spacing:o="0.5rem",wrap:s,children:u,divider:l,className:c,shouldWrapChildren:f}=e,d=sFe(e,["isInline","direction","align","justify","spacing","wrap","children","divider","className","shouldWrapChildren"]),h=n?"row":r??"column",p=gr(()=>aFe({direction:h,spacing:o}),[h,o]),g=gr(()=>oFe({spacing:o,direction:h}),[o,h]),m=!!l,v=!f&&!m,y=AD(u),b=v?y:y.map((w,S)=>{var A=typeof w.key!="undefined"?w.key:S,_=S+1===y.length,E=ue(uFe,{key:A},w),C=f?E:w;if(!m)return C;var k=cf(l,{__css:g}),T=_?null:k;return ue(Ii,{key:A},C,T)}),x=Wn("chakra-stack",c);return ue(xt.div,gm({ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:p.flexDirection,flexWrap:s,className:x,__css:m?{}:{[mF]:p[mF]}},d),b)}),lFe=Mt((e,t)=>ue(mK,gm({align:"center"},e,{direction:"row",ref:t})));function vF(){return vF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vF.apply(this,arguments)}function cFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var fFe=Mt((e,t)=>{var n=xh("Text",e),r=ko(e),i=cFe(r,["className","align","decoration","casing"]),a=o_({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return ue(xt.p,vF({ref:t,className:Wn("chakra-text",e.className)},a,i,{__css:n}))});function _f(){return _f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_f.apply(this,arguments)}function yF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var dFe=Mt((e,t)=>{var n=mf("Table",e),r=ko(e),{className:i}=r,a=yF(r,["className"]);return ue(yy,{value:n},ue(xt.table,_f({role:"table",ref:t,__css:n.table,className:Wn("chakra-table",i)},a)))}),hFe=Mt((e,t)=>{var n=yi();return ue(xt.thead,_f({},e,{ref:t,__css:n.thead}))}),pFe=Mt((e,t)=>{var n=yi();return ue(xt.tbody,_f({},e,{ref:t,__css:n.tbody}))}),gFe=Mt((e,t)=>{var{isNumeric:n}=e,r=yF(e,["isNumeric"]),i=yi();return ue(xt.th,_f({},r,{ref:t,__css:i.th,"data-is-numeric":n}))}),mFe=Mt((e,t)=>{var n=yi();return ue(xt.tr,_f({role:"row"},e,{ref:t,__css:n.tr}))}),vFe=Mt((e,t)=>{var{isNumeric:n}=e,r=yF(e,["isNumeric"]),i=yi();return ue(xt.td,_f({role:"gridcell"},r,{ref:t,__css:i.td,"data-is-numeric":n}))});function yFe(){var e=Jt(new Map),t=e.current,n=st((i,a,o,s)=>{e.current.set(o,{type:a,el:i,options:s}),i.addEventListener(a,o,s)},[]),r=st((i,a,o,s)=>{i.removeEventListener(a,o,s),e.current.delete(o)},[]);return qt(()=>()=>{t.forEach((i,a)=>{r(i.el,i.type,a,i.options)})},[r,t]),{add:n,remove:r}}function uS(){return uS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uS.apply(this,arguments)}function bFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function bF(e){var t=e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function xFe(e){e===void 0&&(e={});var{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:i=!0,clickOnSpace:a=!0,onMouseDown:o,onMouseUp:s,onClick:u,onKeyDown:l,onKeyUp:c,tabIndex:f,onMouseOver:d,onMouseLeave:h}=e,p=bFe(e,["ref","isDisabled","isFocusable","clickOnEnter","clickOnSpace","onMouseDown","onMouseUp","onClick","onKeyDown","onKeyUp","tabIndex","onMouseOver","onMouseLeave"]),[g,m]=an(!0),[v,y]=an(!1),b=yFe(),x=L=>{!L||L.tagName!=="BUTTON"&&m(!1)},w=g?f:f||0,S=n&&!r,A=st(L=>{if(n){L.stopPropagation(),L.preventDefault();return}var W=L.currentTarget;W.focus(),u==null||u(L)},[n,u]),_=st(L=>{v&&bF(L)&&(L.preventDefault(),L.stopPropagation(),y(!1),b.remove(document,"keyup",_,!1))},[v,b]),E=st(L=>{if(l==null||l(L),!(n||L.defaultPrevented||L.metaKey)&&!(!bF(L.nativeEvent)||g)){var W=i&&L.key==="Enter",G=a&&L.key===" ";if(G&&(L.preventDefault(),y(!0)),W){L.preventDefault();var K=L.currentTarget;K.click()}b.add(document,"keyup",_,!1)}},[n,g,l,i,a,b,_]),C=st(L=>{if(c==null||c(L),!(n||L.defaultPrevented||L.metaKey)&&!(!bF(L.nativeEvent)||g)){var W=a&&L.key===" ";if(W){L.preventDefault(),y(!1);var G=L.currentTarget;G.click()}}},[a,g,n,c]),k=st(L=>{L.button===0&&(y(!1),b.remove(document,"mouseup",k,!1))},[b]),T=st(L=>{if(!xV(L)){if(n){L.stopPropagation(),L.preventDefault();return}g||y(!0);var W=L.currentTarget;W.focus({preventScroll:!0}),b.add(document,"mouseup",k,!1),o==null||o(L)}},[n,g,o,b,k]),I=st(L=>{xV(L)||(g||y(!1),s==null||s(L))},[s,g]),N=st(L=>{if(n){L.preventDefault();return}d==null||d(L)},[n,d]),O=st(L=>{v&&(L.preventDefault(),y(!1)),h==null||h(L)},[v,h]),D=gf(t,x);return g?uS({},p,{ref:D,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:A,onMouseDown:o,onMouseUp:s,onKeyUp:c,onKeyDown:l,onMouseOver:d,onMouseLeave:h}):uS({},p,{ref:D,role:"button","data-active":Ni(v),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:w,onClick:A,onMouseDown:T,onMouseUp:I,onKeyUp:C,onKeyDown:E,onMouseOver:N,onMouseLeave:O})}function wFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var _Fe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",SFe=_Fe,EFe=SFe;function vK(){}function yK(){}yK.resetWarningCache=vK;var AFe=function(){function e(r,i,a,o,s,u){if(u!==EFe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:yK,resetWarningCache:vK};return n.PropTypes=n,n};AFe();var xF="data-focus-lock",bK="data-focus-lock-disabled",CFe="data-no-focus-lock",kFe="data-autofocus-inside";function TFe(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function OFe(e,t){var n=an(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function xK(e,t){return OFe(t,function(n){return e.forEach(function(r){return TFe(r,n)})})}var wF={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lS=function(){return lS=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},lS.apply(this,arguments)};function IFe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function wK(e){return e}function _K(e,t){t===void 0&&(t=wK);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=t(a,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(r=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(a),o=n}var u=function(){var c=o;o=[],c.forEach(a)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){o.push(c),l()},filter:function(c){return o=o.filter(c),n}}}};return i}function _F(e,t){return t===void 0&&(t=wK),_K(e,t)}function SK(e){e===void 0&&(e={});var t=_K(null);return t.options=lS({async:!0,ssr:!1},e),t}var EK=function(e){var t=e.sideCar,n=IFe(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return ue(r,lS({},n))};EK.isSideCarExport=!0;function NFe(e,t){return e.useMedium(t),EK}var AK=_F({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),CK=_F(),DFe=_F(),RFe=SK({async:!0}),FFe=[],SF=Kl(function(t,n){var r,i=an(),a=i[0],o=i[1],s=Jt(),u=Jt(!1),l=Jt(null),c=t.children,f=t.disabled,d=t.noFocusGuards,h=t.persistentFocus,p=t.crossFrame,g=t.autoFocus;t.allowTextSelection;var m=t.group,v=t.className,y=t.whiteList,b=t.shards,x=b===void 0?FFe:b,w=t.as,S=w===void 0?"div":w,A=t.lockProps,_=A===void 0?{}:A,E=t.sideCar,C=t.returnFocus,k=t.onActivation,T=t.onDeactivation,I=an({}),N=I[0],O=st(function(){l.current=l.current||document&&document.activeElement,s.current&&k&&k(s.current),u.current=!0},[k]),D=st(function(){u.current=!1,T&&T(s.current)},[T]),L=st(function(Te){var Re=l.current;if(Boolean(C)&&Re&&Re.focus){var me=typeof C=="object"?C:void 0;l.current=null,Te?Promise.resolve().then(function(){return Re.focus(me)}):Re.focus(me)}},[C]),W=st(function(Te){u.current&&AK.useMedium(Te)},[]),G=CK.useMedium,K=st(function(Te){s.current!==Te&&(s.current=Te,o(Te))},[]),ee=yh((r={},r[bK]=f&&"disabled",r[xF]=m,r),_),ce=d!==!0,he=ce&&d!=="tail",Oe=xK([n,K]);return ue(Ii,null,ce&&[ue("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:wF}),ue("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:wF})],!f&&ue(E,{id:N,sideCar:RFe,observed:a,disabled:f,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:y,shards:x,onActivation:O,onDeactivation:D,returnFocus:L}),ue(S,yh({ref:Oe},ee,{className:v,onBlur:G,onFocus:W}),c),he&&ue("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:wF}))});SF.propTypes={},SF.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var kK=SF;function EF(e,t){return EF=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},EF(e,t)}function MFe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,EF(e,t)}function PFe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Fe(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var a=[],o;function s(){o=e(a.map(function(l){return l.props})),t(o)}var u=function(l){MFe(c,l);function c(){return l.apply(this,arguments)||this}c.peek=function(){return o};var f=c.prototype;return f.componentDidMount=function(){a.push(this),s()},f.componentDidUpdate=function(){s()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),s()},f.render=function(){return zt.createElement(i,this.props)},c}(I2);return PFe(u,"displayName","SideEffect("+n(i)+")"),u}}var Sf=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},AF=function(e){return Array.isArray(e)?e:[e]},LFe=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var a=e[r].compareDocumentPosition(e[i]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,s){return!t.has(s)})},TK=function(e){return e.parentNode?TK(e.parentNode):e},CF=function(e){var t=AF(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(xF);return n.push.apply(n,i?LFe(Sf(TK(r).querySelectorAll("["+xF+'="'+i+'"]:not(['+bK+'="disabled"])'))):[r]),n},[])},BFe=function(e){return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},OK=function(e){return!e||e===document||e&&e.nodeType===Node.DOCUMENT_NODE||!BFe(window.getComputedStyle(e,null))&&OK(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode)},zFe=function(e){return!((e.tagName==="INPUT"||e.tagName==="BUTTON")&&(e.type==="hidden"||e.disabled))},kF=function(e){return Boolean(e&&e.dataset&&e.dataset.focusGuard)},cS=function(e){return!kF(e)},jFe=function(e){return Boolean(e)},UFe=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},IK=function(e,t,n){return Sf(e).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!t||r.tabIndex>=0}).sort(UFe)},WFe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],TF=WFe.join(","),VFe=TF+", [data-focus-guard]",OF=function(e,t){return e.reduce(function(n,r){return n.concat(Sf(r.querySelectorAll(t?VFe:TF)),r.parentNode?Sf(r.parentNode.querySelectorAll(TF)).filter(function(i){return i===r}):[])},[])},qFe=function(e){var t=e.querySelectorAll("["+kFe+"]");return Sf(t).map(function(n){return OF([n])}).reduce(function(n,r){return n.concat(r)},[])},IF=function(e){return Sf(e).filter(function(t){return OK(t)}).filter(function(t){return zFe(t)})},NF=function(e,t){return IK(IF(OF(e,t)),!0,t)},NK=function(e){return IK(IF(OF(e)),!1)},HFe=function(e){return IF(qFe(e))},DF=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&DF(e.parentNode,t),t},RF=function(e,t){for(var n=DF(e),r=DF(t),i=0;i<n.length;i+=1){var a=n[i];if(r.indexOf(a)>=0)return a}return!1},DK=function(e,t,n){var r=AF(e),i=AF(t),a=r[0],o=!1;return i.filter(Boolean).forEach(function(s){o=RF(o||s,s)||o,n.filter(Boolean).forEach(function(u){var l=RF(a,u);l&&(!o||l.contains(o)?o=l:o=RF(l,o))})}),o},GFe=function(e){return e.reduce(function(t,n){return t.concat(HFe(n))},[])},KFe=function(e){var t=CF(e).filter(cS),n=DK(e,e,t),r=NF([n],!0),i=NF(t).filter(function(a){var o=a.node;return cS(o)}).map(function(a){var o=a.node;return o});return r.map(function(a){var o=a.node,s=a.index;return{node:o,index:s,lockItem:i.indexOf(o)>=0,guard:kF(o)}})},XFe=function(e){return e===document.activeElement},YFe=function(e){return Boolean(Sf(e.querySelectorAll("iframe")).some(function(t){return XFe(t)}))},RK=function(e){var t=document&&document.activeElement;return!t||t.dataset&&t.dataset.focusGuard?!1:CF(e).reduce(function(n,r){return n||r.contains(t)||YFe(r)},!1)},ZFe=function(){return document&&Sf(document.querySelectorAll("["+CFe+"]")).some(function(e){return e.contains(document.activeElement)})},FK=function(e){return e.tagName==="INPUT"&&e.type==="radio"},JFe=function(e,t){return t.filter(FK).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},FF=function(e,t){return FK(e)&&e.name?JFe(e,t):e},QFe=function(e){var t=new Set;return e.forEach(function(n){return t.add(FF(n,e))}),e.filter(function(n){return t.has(n)})},MK=function(e){return e[0]&&e.length>1?FF(e[0],e):e[0]},PK=function(e,t){return e.length>1?e.indexOf(FF(e[t],e)):t},$K="NEW_FOCUS",e3e=function(e,t,n,r){var i=e.length,a=e[0],o=e[i-1],s=kF(n);if(!(e.indexOf(n)>=0)){var u=t.indexOf(n),l=r?t.indexOf(r):u,c=r?e.indexOf(r):-1,f=u-l,d=t.indexOf(a),h=t.indexOf(o),p=QFe(t),g=p.indexOf(n)-(r?p.indexOf(r):u),m=PK(e,0),v=PK(e,i-1);if(u===-1||c===-1)return $K;if(!f&&c>=0)return c;if(u<=d&&s&&Math.abs(f)>1)return v;if(u>=h&&s&&Math.abs(f)>1)return m;if(f&&Math.abs(g)>1)return c;if(u<=d)return v;if(u>h)return m;if(f)return Math.abs(f)>1?c:(i+c+f)%i}},t3e=function(e){return function(t){return t.autofocus||t.dataset&&!!t.dataset.autofocus||e.indexOf(t)>=0}},n3e=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(jFe)},r3e=function(e,t){var n=document&&document.activeElement,r=CF(e).filter(cS),i=DK(n||e,e,r),a=NK(r),o=NF(r).filter(function(d){var h=d.node;return cS(h)});if(!(!o[0]&&(o=a,!o[0]))){var s=NK([i]).map(function(d){var h=d.node;return h}),u=n3e(s,o),l=u.map(function(d){var h=d.node;return h}),c=e3e(l,s,n,t);if(c===$K){var f=a.map(function(d){var h=d.node;return h}).filter(t3e(GFe(r)));return{node:f&&f.length?MK(f):MK(l)}}return c===void 0?c:u[c]}},i3e=function(e){e.focus(),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},MF=0,PF=!1,a3e=function(e,t){var n=r3e(e,t);if(!PF&&n){if(MF>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),PF=!0,setTimeout(function(){PF=!1},1);return}MF++,i3e(n.node),MF--}},LK=a3e;function BK(e){var t=window,n=t.setImmediate;typeof n!="undefined"?n(e):setTimeout(e,1)}var o3e=function(){return document&&document.activeElement===document.body},s3e=function(){return o3e()||ZFe()},mm=null,vm=null,ym=null,Zy=!1,u3e=function(){return!0},l3e=function(t){return(mm.whiteList||u3e)(t)},c3e=function(t,n){ym={observerNode:t,portaledElement:n}},f3e=function(t){return ym&&ym.portaledElement===t};function zK(e,t,n,r){var i=null,a=e;do{var o=r[a];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(a!==e)return;i=null}else break}while((a+=n)!==t);i&&(i.node.tabIndex=0)}var d3e=function(t){return t&&"current"in t?t.current:t},h3e=function(t){return t?Boolean(Zy):Zy==="meanwhile"},fS=function(){var t=!1;if(mm){var n=mm,r=n.observed,i=n.persistentFocus,a=n.autoFocus,o=n.shards,s=n.crossFrame,u=r||ym&&ym.portaledElement,l=document&&document.activeElement;if(u){var c=[u].concat(o.map(d3e).filter(Boolean));if((!l||l3e(l))&&(i||h3e(s)||!s3e()||!vm&&a)&&(u&&!(RK(c)||f3e(l))&&(document&&!vm&&l&&!a?(l.blur&&l.blur(),document.body.focus()):(t=LK(c,vm),ym={})),Zy=!1,vm=document&&document.activeElement),document){var f=document&&document.activeElement,d=KFe(c),h=d.map(function(p){var g=p.node;return g}).indexOf(f);h>-1&&(d.filter(function(p){var g=p.guard,m=p.node;return g&&m.dataset.focusAutoGuard}).forEach(function(p){var g=p.node;return g.removeAttribute("tabIndex")}),zK(h,d.length,1,d),zK(h,-1,-1,d))}}}return t},jK=function(t){fS()&&t&&(t.stopPropagation(),t.preventDefault())},$F=function(){return BK(fS)},p3e=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||c3e(r,n)},g3e=function(){return null},UK=function(){Zy="just",setTimeout(function(){Zy="meanwhile"},0)},m3e=function(){document.addEventListener("focusin",jK,!0),document.addEventListener("focusout",$F),window.addEventListener("blur",UK)},v3e=function(){document.removeEventListener("focusin",jK,!0),document.removeEventListener("focusout",$F),window.removeEventListener("blur",UK)};function y3e(e){return e.filter(function(t){var n=t.disabled;return!n})}function b3e(e){var t=e.slice(-1)[0];t&&!mm&&m3e();var n=mm,r=n&&t&&t.id===n.id;mm=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var a=i.id;return a===n.id}).length||n.returnFocus(!t)),t?(vm=null,(!r||n.observed!==t.observed)&&t.onActivation(),fS(),BK(fS)):(v3e(),vm=null)}AK.assignSyncMedium(p3e),CK.assignMedium($F),DFe.assignMedium(function(e){return e({moveFocusInside:LK,focusInside:RK})});var x3e=$Fe(y3e,b3e)(g3e),WK=Kl(function(t,n){return ue(kK,yh({sideCar:x3e,ref:n},t))}),VK=kK.propTypes||{};VK.sideCar,wFe(VK,["sideCar"]),WK.propTypes={};var w3e=WK,_3e=e=>{var{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:i,children:a,isDisabled:o,autoFocus:s,persistentFocus:u,lockFocusAcrossFrames:l}=e,c=st(()=>{if(t!=null&&t.current)t.current.focus();else if(r!=null&&r.current){var h=Xwe(r.current);h.length===0&&Yg(r.current,{nextTick:!0})}},[t,r]),f=st(()=>{var h;n==null||(h=n.current)==null||h.focus()},[n]),d=i&&!n;return ue(w3e,{crossFrame:l,persistentFocus:u,autoFocus:s,disabled:o,onActivation:c,onDeactivation:f,returnFocus:d},a)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bm=function(){return bm=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},bm.apply(this,arguments)};function S3e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var dS="right-scroll-bar-position",hS="width-before-scroll-bar",E3e="with-scroll-bars-hidden",A3e="--removed-body-scroll-bar-size",qK=SK(),LF=function(){},pS=Kl(function(e,t){var n=Jt(null),r=an({onScrollCapture:LF,onWheelCapture:LF,onTouchMoveCapture:LF}),i=r[0],a=r[1],o=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,f=e.shards,d=e.sideCar,h=e.noIsolation,p=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,y=S3e(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=d,x=xK([n,t]),w=bm({},y,i);return ue(Ii,null,c&&ue(b,{sideCar:qK,removeScrollBar:l,shards:f,noIsolation:h,inert:p,setCallbacks:a,allowPinchZoom:!!g,lockRef:n}),o?cf(N2.only(s),bm({},w,{ref:x})):ue(v,bm({},w,{className:u,ref:x}),s))});pS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},pS.classNames={fullWidth:hS,zeroRight:dS};var C3e=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function k3e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=C3e();return t&&e.setAttribute("nonce",t),e}function T3e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function O3e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var I3e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=k3e())&&(T3e(t,n),O3e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},N3e=function(){var e=I3e();return function(t){qt(function(){return e.add(t),function(){e.remove()}},[])}},HK=function(){var e=N3e(),t=function(n){var r=n.styles;return e(r),null};return t},D3e={left:0,top:0,right:0,gap:0},BF=function(e){return parseInt(e||"",10)||0},R3e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[BF(n),BF(r),BF(i)]},GK=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return D3e;var t=R3e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},F3e=HK(),M3e=function(e,t,n,r){var i=e.left,a=e.top,o=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`+E3e+` {
   overflow: hidden `+r+`;
   padding-right: `+s+"px "+r+`;
  }
  body {
    overflow: hidden `+r+`;
    `+[t&&"position: relative "+r+";",n==="margin"&&`
    padding-left: `+i+`px;
    padding-top: `+a+`px;
    padding-right: `+o+`px;
    margin-left:0;
    margin-top:0;
    margin-right: `+s+"px "+r+`;
    `,n==="padding"&&"padding-right: "+s+"px "+r+";"].filter(Boolean).join("")+`
  }
  
  .`+dS+` {
    right: `+s+"px "+r+`;
  }
  
  .`+hS+` {
    margin-right: `+s+"px "+r+`;
  }
  
  .`+dS+" ."+dS+` {
    right: 0 `+r+`;
  }
  
  .`+hS+" ."+hS+` {
    margin-right: 0 `+r+`;
  }
  
  body {
    `+A3e+": "+s+`px;
  }
`},P3e=function(e){var t=an(GK(e.gapMode)),n=t[0],r=t[1];qt(function(){r(GK(e.gapMode))},[e.gapMode]);var i=e.noRelative,a=e.noImportant,o=e.gapMode,s=o===void 0?"margin":o;return ue(F3e,{styles:M3e(n,!i,s,a?"":"!important")})},$3e=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},L3e=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},KK=function(e,t){var n=t;do{var r=XK(e,n);if(r){var i=YK(e,n),a=i[1],o=i[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},B3e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},z3e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},XK=function(e,t){return e==="v"?$3e(t):L3e(t)},YK=function(e,t){return e==="v"?B3e(t):z3e(t)},j3e=function(e,t,n,r,i){var a=r,o=n.target,s=t.contains(o),u=!1,l=a>0,c=0,f=0;do{var d=YK(e,o),h=d[0],p=d[1],g=d[2],m=p-g-h;(h||m)&&XK(e,o)&&(c+=m,f+=h),o=o.parentNode}while(!s&&o!==document.body||s&&(t.contains(o)||t===o));return(l&&(i&&c===0||!i&&a>c)||!l&&(i&&f===0||!i&&-a>f))&&(u=!0),u},zF=!1;if(typeof window!="undefined")try{var gS=Object.defineProperty({},"passive",{get:function(){return zF=!0,!0}});window.addEventListener("test",gS,gS),window.removeEventListener("test",gS,gS)}catch(e){zF=!1}var xm=zF?{passive:!1}:!1,mS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ZK=function(e){return[e.deltaX,e.deltaY]},JK=function(e){return e&&"current"in e?e.current:e},U3e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},W3e=function(e){return`
  .block-interactivity-`+e+` {pointer-events: none;}
  .allow-interactivity-`+e+` {pointer-events: all;}
`},V3e=0,wm=[];function q3e(e){var t=Jt([]),n=Jt([0,0]),r=Jt(),i=an(V3e++)[0],a=an(function(){return HK()})[0],o=Jt(e);qt(function(){o.current=e},[e]),qt(function(){if(e.inert){document.body.classList.add("block-interactivity-"+i);var g=[e.lockRef.current].concat((e.shards||[]).map(JK)).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-"+i)}),function(){document.body.classList.remove("block-interactivity-"+i),g.forEach(function(m){return m.classList.remove("allow-interactivity-"+i)})}}},[e.inert,e.lockRef.current,e.shards]);var s=st(function(g,m){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var v=mS(g),y=n.current,b="deltaX"in g?g.deltaX:y[0]-v[0],x="deltaY"in g?g.deltaY:y[1]-v[1],w,S=g.target,A=Math.abs(b)>Math.abs(x)?"h":"v",_=KK(A,S);if(!_)return!0;if(_?w=A:(w=A==="v"?"h":"v",_=KK(A,S)),!_)return!1;if(!r.current&&"changedTouches"in g&&(b||x)&&(r.current=w),!w)return!0;var E=r.current||w;return j3e(E,m,g,E==="h"?b:x,!0)},[]),u=st(function(g){var m=g;if(!(!wm.length||wm[wm.length-1]!==a)){var v="deltaY"in m?ZK(m):mS(m),y=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&U3e(w.delta,v)})[0];if(y&&y.should){m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(JK).filter(Boolean).filter(function(w){return w.contains(m.target)}),x=b.length>0?s(m,b[0]):!o.current.noIsolation;x&&m.preventDefault()}}},[]),l=st(function(g,m,v,y){var b={name:g,delta:m,target:v,should:y};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(x){return x!==b})},1)},[]),c=st(function(g){n.current=mS(g),r.current=void 0},[]),f=st(function(g){l(g.type,ZK(g),g.target,s(g,e.lockRef.current))},[]),d=st(function(g){l(g.type,mS(g),g.target,s(g,e.lockRef.current))},[]);qt(function(){return wm.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",u,xm),document.addEventListener("touchmove",u,xm),document.addEventListener("touchstart",c,xm),function(){wm=wm.filter(function(g){return g!==a}),document.removeEventListener("wheel",u,xm),document.removeEventListener("touchmove",u,xm),document.removeEventListener("touchstart",c,xm)}},[]);var h=e.removeScrollBar,p=e.inert;return ue(Ii,null,p?ue(a,{styles:W3e(i)}):null,h?ue(P3e,{gapMode:"margin"}):null)}var H3e=NFe(qK,q3e),QK=Kl(function(e,t){return ue(pS,bm({},e,{ref:t,sideCar:H3e}))});QK.classNames=pS.classNames;var G3e=QK,K3e=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},_m=new WeakMap,vS=new WeakMap,yS={},jF=0,X3e=function(e,t,n){t===void 0&&(t=K3e(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];yS[n]||(yS[n]=new WeakMap);var i=yS[n],a=[],o=new Set,s=function(l){!l||o.has(l)||(o.add(l),s(l.parentNode))};r.forEach(s);var u=function(l){!l||r.indexOf(l)>=0||Array.prototype.forEach.call(l.children,function(c){if(o.has(c))u(c);else{var f=c.getAttribute("aria-hidden"),d=f!==null&&f!=="false",h=(_m.get(c)||0)+1,p=(i.get(c)||0)+1;_m.set(c,h),i.set(c,p),a.push(c),h===1&&d&&vS.set(c,!0),p===1&&c.setAttribute(n,"true"),d||c.setAttribute("aria-hidden","true")}})};return u(t),o.clear(),jF++,function(){a.forEach(function(l){var c=_m.get(l)-1,f=i.get(l)-1;_m.set(l,c),i.set(l,f),c||(vS.has(l)||l.removeAttribute("aria-hidden"),vS.delete(l)),f||l.removeAttribute(n)}),jF--,jF||(_m=new WeakMap,_m=new WeakMap,vS=new WeakMap,yS={})}};function Y3e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Z3e{constructor(){Y3e(this,"modals",void 0),this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(n=>n!==t)}isTopModal(t){var n=this.modals[this.modals.length-1];return n===t}}var UF=new Z3e;function J3e(e,t){qt(()=>(t&&UF.add(e),()=>{UF.remove(e)}),[t,e])}function bS(){return bS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bS.apply(this,arguments)}function Q3e(e){var{isOpen:t,onClose:n,id:r,closeOnOverlayClick:i=!0,closeOnEsc:a=!0,useInert:o=!0,onOverlayClick:s,onEsc:u}=e,l=Jt(null),c=Jt(null),[f,d,h]=h2e(r,"chakra-modal","chakra-modal--header","chakra-modal--body");eMe(l,t&&o),J3e(l,t);var p=Jt(null),g=st(_=>{p.current=_.target},[]),m=st(_=>{_.key==="Escape"&&(_.stopPropagation(),a&&(n==null||n()),u==null||u())},[a,n,u]),[v,y]=an(!1),[b,x]=an(!1),w=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),bS({role:"dialog"},_,{ref:gf(E,l),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":v?d:void 0,"aria-describedby":b?h:void 0,onClick:Sr(_.onClick,C=>C.stopPropagation())})},[h,b,f,d,v]),S=st(_=>{_.stopPropagation(),p.current===_.target&&(!UF.isTopModal(l)||(i&&(n==null||n()),s==null||s()))},[n,i,s]),A=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),bS({},_,{ref:gf(E,c),onClick:Sr(_.onClick,S),onKeyDown:Sr(_.onKeyDown,m),onMouseDown:Sr(_.onMouseDown,g)})},[m,g,S]);return{isOpen:t,onClose:n,headerId:d,bodyId:h,setBodyMounted:x,setHeaderMounted:y,dialogRef:l,overlayRef:c,getDialogProps:w,getDialogContainerProps:A}}function eMe(e,t){qt(()=>{if(!!e.current){var n=null;return t&&e.current&&(n=X3e(e.current)),()=>{t&&(n==null||n())}}},[t,e])}function xS(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function nc(){return nc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nc.apply(this,arguments)}var[tMe,Sm]=Pu({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),eX=e=>{var{portalProps:t,children:n,autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d}=e,h=mf("Modal",e),p=Q3e(e),g=nc({},p,{autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d});return ue(tMe,{value:g},ue(yy,{value:h},ue(XG,null,g.isOpen&&ue(d_,t,n))))};eX.defaultProps={lockFocusAcrossFrames:!0,returnFocusOnClose:!0,scrollBehavior:"outside",trapFocus:!0,autoFocus:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale"};var nMe=xt(GG.div);function rMe(e){var{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:i,blockScrollOnMount:a,allowPinchZoom:o,finalFocusRef:s,returnFocusOnClose:u,preserveScrollBarGap:l,lockFocusAcrossFrames:c}=Sm(),[f,d]=gR();return qt(()=>{!f&&d&&setTimeout(d)},[f,d]),ue(_3e,{autoFocus:t,isDisabled:!n,initialFocusRef:i,finalFocusRef:s,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:c},ue(G3e,{removeScrollBar:!l,allowPinchZoom:o,enabled:a,forwardProps:!0},e.children))}var tX=Mt((e,t)=>{var{className:n}=e,r=xS(e,["className","transition"]),i=Wn("chakra-modal__overlay",n),a=yi(),o=nc({pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh"},a.overlay),{motionPreset:s}=Sm(),u=s==="none"?{}:uRe;return ue(nMe,nc({},u,{__css:o,ref:t,className:i},r))}),iMe=Mt((e,t)=>{var{className:n}=e,r=xS(e,["className"]),{headerId:i,setHeaderMounted:a}=Sm();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__header",n),s=yi(),u=nc({flex:0},s.header);return ue(xt.header,nc({ref:t,className:o,id:i},r,{__css:u}))}),nX=Mt((e,t)=>{var{className:n}=e,r=xS(e,["className"]),{bodyId:i,setBodyMounted:a}=Sm();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__body",n),s=yi();return ue(xt.div,nc({ref:t,className:o,id:i},r,{__css:s.body}))}),aMe=Mt((e,t)=>{var{onClick:n,className:r}=e,i=xS(e,["onClick","className"]),{onClose:a}=Sm(),o=Wn("chakra-modal__close-btn",r),s=yi();return ue(jRe,nc({ref:t,__css:s.closeButton,className:o,onClick:Sr(n,u=>{u.stopPropagation(),a()})},i))});function Ih(){return Ih=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ih.apply(this,arguments)}function rX(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[oMe,sMe]=Pu();function iX(e){var t,{isOpen:n,onClose:r,placement:i="right",children:a}=e,o=rX(e,["isOpen","onClose","placement","children"]),s=KV(),u=(t=s.components)==null?void 0:t.Drawer;return ue(oMe,{value:{placement:i}},ue(eX,Ih({isOpen:n,onClose:r,styleConfig:u},o),a))}var uMe=xt(fRe),aX=Mt((e,t)=>{var{className:n,children:r}=e,i=rX(e,["className","children"]),{getDialogProps:a,getDialogContainerProps:o,isOpen:s}=Sm(),u=a(i,t),l=o(),c=Wn("chakra-modal__content",n),f=yi(),d=Ih({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0},f.dialog),h=Ih({display:"flex",width:"100vw",height:"100vh",position:"fixed",left:0,top:0},f.dialogContainer),{placement:p}=sMe();return ue(xt.div,Ih({},l,{className:"chakra-modal__content-container",__css:h}),ue(rMe,null,ue(uMe,Ih({direction:p,in:s,className:c},u,{__css:d}),r)))});function Ef(){return Ef=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ef.apply(this,arguments)}function WF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var lMe=Mt((e,t)=>{var{children:n,placeholder:r,className:i}=e,a=WF(e,["children","placeholder","className"]),o=cK(a);return ue(xt.select,Ef({},o,{ref:t,className:Wn("chakra-select",i)}),r&&ue("option",{value:""},r),n)}),cMe=Mt((e,t)=>{var n=mf("Select",e),r=ko(e),{rootProps:i,placeholder:a,icon:o,color:s,height:u,h:l,minH:c,minHeight:f,iconColor:d,iconSize:h}=r,p=WF(r,["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"]),[g,m]=Nwe(p,l_e),v={width:"100%",height:"fit-content",position:"relative",color:s},y=Zl({},n.field,{paddingEnd:"2rem",_focus:{zIndex:"unset"}});return ue(xt.div,Ef({className:"chakra-select__wrapper",__css:v},g,i),ue(lMe,Ef({ref:t,height:l??u,minH:c??f,placeholder:a},m,{__css:y}),e.children),ue(hMe,Ef({"data-disabled":e.isDisabled},(d||s)&&{color:d||s},{__css:n.icon},h&&{fontSize:h}),o))}),fMe=e=>ue("svg",Ef({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})),dMe=xt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),hMe=e=>{var{children:t=ue(fMe,null)}=e,n=WF(e,["children"]),r=cf(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return ue(dMe,Ef({},n,{className:"chakra-select__icon-wrapper"}),mh(t)?r:null)};function rc(){return rc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rc.apply(this,arguments)}function pMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var gMe=Mt((e,t)=>{var n=mf("Switch",e),r=ko(e),{spacing:i="0.5rem",children:a}=r,o=pMe(r,["spacing","children"]),{state:s,getInputProps:u,getCheckboxProps:l,getRootProps:c,getLabelProps:f}=LRe(o),d=gr(()=>rc({display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},n.container),[n.container]),h=gr(()=>rc({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer"},n.track),[n.track]),p=gr(()=>rc({userSelect:"none",marginStart:i},n.label),[i,n.label]);return ue(xt.label,rc({},c(),{className:Wn("chakra-switch",e.className),__css:d}),ue("input",rc({className:"chakra-switch__input"},u({},t))),ue(xt.span,rc({},l(),{className:"chakra-switch__track",__css:h}),ue(xt.span,{__css:n.thumb,className:"chakra-switch__thumb","data-checked":Ni(s.isChecked),"data-hover":Ni(s.isHovered)})),a&&ue(xt.span,rc({className:"chakra-switch__label"},f(),{__css:p}),a))});function Nh(){return Nh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nh.apply(this,arguments)}function VF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[mMe,vMe,yMe,bMe]=vRe();function xMe(e){var{defaultIndex:t,onChange:n,index:r,isManual:i,isLazy:a,lazyBehavior:o="unmount",orientation:s="horizontal",direction:u="ltr"}=e,l=VF(e,["defaultIndex","onChange","index","isManual","isLazy","lazyBehavior","orientation","direction"]),[c,f]=an(t??0),[d,h]=f2e({defaultValue:t??0,value:r,onChange:n});qt(()=>{r!=null&&f(r)},[r]);var p=yMe(),g=kV(e.id,"tabs");return{id:g,selectedIndex:d,focusedIndex:c,setSelectedIndex:h,setFocusedIndex:f,isManual:i,isLazy:a,lazyBehavior:o,orientation:s,descendants:p,direction:u,htmlProps:l}}var[wMe,wS]=Pu({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function _Me(e){var{focusedIndex:t,orientation:n,direction:r}=wS(),i=vMe(),a=st(o=>{var s=()=>{var y=i.nextEnabled(t);y&&Yg(y.node)},u=()=>{var y=i.prevEnabled(t);y&&Yg(y.node)},l=()=>{var y=i.firstEnabled();y&&Yg(y.node)},c=()=>{var y=i.lastEnabled();y&&Yg(y.node)},f=n==="horizontal",d=n==="vertical",h=zwe(o),p=r==="ltr"?"ArrowLeft":"ArrowRight",g=r==="ltr"?"ArrowRight":"ArrowLeft",m={[p]:()=>f&&u(),[g]:()=>f&&s(),ArrowDown:()=>d&&s(),ArrowUp:()=>d&&u(),Home:l,End:c},v=m[h];v&&(o.preventDefault(),v(o))},[i,t,n,r]);return Nh({},e,{role:"tablist","aria-orientation":n,onKeyDown:Sr(e.onKeyDown,a)})}function SMe(e){var{isDisabled:t,isFocusable:n}=e,r=VF(e,["isDisabled","isFocusable"]),{setSelectedIndex:i,isManual:a,id:o,setFocusedIndex:s,selectedIndex:u}=wS(),{index:l,register:c}=bMe({disabled:t&&!n}),f=l===u,d=()=>{i(l)},h=()=>{s(l);var m=t&&n,v=!a&&!m;v&&i(l)},p=xFe(Nh({},r,{ref:gf(c,e.ref),isDisabled:t,isFocusable:n,onClick:Sr(e.onClick,d)})),g="button";return Nh({},p,{id:oX(o,l),role:"tab",tabIndex:f?0:-1,type:g,"aria-selected":f,"aria-controls":sX(o,l),onFocus:t?void 0:Sr(e.onFocus,h)})}function EMe(e){var t=wS(),{id:n,selectedIndex:r}=t,i=AD(e.children),a=i.map((o,s)=>cf(o,{isSelected:s===r,id:sX(n,s),"aria-labelledby":oX(n,s)}));return Nh({},e,{children:a})}function AMe(e){var{isSelected:t,id:n,children:r}=e,i=VF(e,["isSelected","id","children"]),{isLazy:a,lazyBehavior:o}=wS(),s=Jt(!1);t&&(s.current=!0);var u=e2e({hasBeenSelected:s.current,isSelected:t,isLazy:a,lazyBehavior:o});return Nh({tabIndex:0},i,{children:u?r:null,role:"tabpanel",hidden:!t,id:n})}function oX(e,t){return e+"--tab-"+t}function sX(e,t){return e+"--tabpanel-"+t}function as(){return as=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},as.apply(this,arguments)}function uX(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var CMe=Mt((e,t)=>{var n=mf("Tabs",e),r=ko(e),{children:i,className:a}=r,o=uX(r,["children","className"]),s=xMe(o),{htmlProps:u,descendants:l}=s,c=uX(s,["htmlProps","descendants"]),f=gr(()=>c,[c]),d=vD(u,["isFitted"]);return ue(mMe,{value:l},ue(wMe,{value:f},ue(yy,{value:n},ue(xt.div,as({className:Wn("chakra-tabs",a),ref:t},d,{__css:n.root}),i))))}),kMe=Mt((e,t)=>{var n=yi(),r=SMe(as({},e,{ref:t})),i=as({outline:"0",display:"flex",alignItems:"center",justifyContent:"center"},n.tab);return ue(xt.button,as({},r,{className:Wn("chakra-tabs__tab",e.className),__css:i}))}),TMe=Mt((e,t)=>{var n=_Me(as({},e,{ref:t})),r=yi(),i=as({display:"flex"},r.tablist);return ue(xt.div,as({},n,{className:Wn("chakra-tabs__tablist",e.className),__css:i}))}),OMe=Mt((e,t)=>{var n=AMe(as({},e,{ref:t})),r=yi();return ue(xt.div,as({outline:"0"},n,{className:Wn("chakra-tabs__tab-panel",e.className),__css:r.tabpanel}))}),IMe=Mt((e,t)=>{var n=EMe(e),r=yi();return ue(xt.div,as({},n,{width:"100%",ref:t,className:Wn("chakra-tabs__tab-panels",e.className),__css:r.tabpanels}))}),NMe=Cy({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),DMe=Cy({displayName:"ExternalLinkIcon",path:ue("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},ue("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),ue("path",{d:"M15 3h6v6"}),ue("path",{d:"M10 14L21 3"}))}),RMe=Cy({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),FMe=Cy({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,19a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,12,19Zm1.6-6.08a1,1,0,0,0-.6.917,1,1,0,1,1-2,0,3,3,0,0,1,1.8-2.75A2,2,0,1,0,10,9.255a1,1,0,1,1-2,0,4,4,0,1,1,5.6,3.666Z",displayName:"QuestionIcon"}),lX=Cy({viewBox:"0 0 14 14",path:ue("g",{fill:"currentColor"},ue("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"}))});const MMe=({options:e})=>{const[t,n]=an(!1),r=st(()=>{n(!t)},[t]);return zt.createElement(zt.Fragment,null,zt.createElement(iS,{verticalAlign:"top","aria-label":"Metaframe settings",icon:zt.createElement(NMe,null),size:"lg",onClick:r}),zt.createElement(PMe,{isOpen:t,setOpen:n,options:e}))},PMe=({isOpen:e,setOpen:t,options:n})=>{const[r,i]=dW("options",Object.fromEntries(n.filter(d=>d.default).map(d=>[d.name,d.default]))),[a,o]=an(r||{}),[s,u]=an(void 0),l=st(d=>{const{name:h,value:p}=d.target,g=n.find(m=>m.name===h);if(!g){console.error(`No option found for name=${h}`);return}g.type==="boolean"?o(Object.assign(Object.assign({},a),{[h]:p==="1"})):o(Object.assign(Object.assign({},a),{[h]:p}))},[a,o,n]),c=st(()=>{t(!e)},[t,e]),f=st(()=>{const d={};if(Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);if(g&&g.validator&&g.type!=="boolean"){const m=g.validator(a[p]);m&&(d[p]=m)}}),Object.keys(d).length>0){u(d);return}u(void 0);const h={};Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);g?g.map?h[p]=g.map(a[p]):g.type==="boolean"?h[p]=a[p]===!0||a[p]==="1"||a[p]==="true":h[p]=a[p]:h[p]=a[p]}),t(!e),i(h)},[t,e,n,a,i,u]);return qt(()=>{const d=h=>{h.key==="Enter"&&e&&f()};return window.addEventListener("keyup",d),()=>{window.removeEventListener("keyup",d)}},[f,e]),zt.createElement(iX,{placement:"top",onClose:f,isOpen:e},zt.createElement(tX,null,zt.createElement(aX,null,zt.createElement(iMe,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),zt.createElement(nX,null,zt.createElement(oS,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},zt.createElement(hK,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(d=>zt.createElement(zt.Fragment,null,zt.createElement(Oh,{rowSpan:1,colSpan:4},zt.createElement(oS,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},zt.createElement(fFe,{textAlign:"right",verticalAlign:"bottom"},d.displayName||d.name,":"))),zt.createElement(Oh,{rowSpan:1,colSpan:8}," ",$Me(d,a[d.name],l)))),zt.createElement(Oh,{rowSpan:1,colSpan:12}),zt.createElement(Oh,{rowSpan:1,colSpan:12}),zt.createElement(Oh,{rowSpan:1,colSpan:12}),zt.createElement(Oh,{rowSpan:1,colSpan:10}),zt.createElement(Oh,{rowSpan:0,colSpan:2},zt.createElement(lFe,{spacing:2,justify:"flex-end",direction:"row"},zt.createElement(iS,{size:"lg",color:"red",icon:zt.createElement(RMe,null),onClick:c}),zt.createElement(iS,{size:"lg",color:"green",icon:zt.createElement(lX,null),onClick:f})))))))))},$Me=(e,t,n)=>{switch(e.type){case"option":return zt.createElement(cMe,{name:e.name,value:t,onChange:n,placeholder:"Select option"},e.options.map(r=>zt.createElement("option",{value:r},r)));case"boolean":return zt.createElement(gMe,{name:e.name,rightIcon:zt.createElement(lX,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return zt.createElement(oS,{w:"100%",h:"10"},zt.createElement(fK,{name:e.name,type:"text",placeholder:"",value:t,onInput:n}))}};var cX={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof ff=="function"&&ff;if(!c&&f)return f(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+l+"'")}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(h){var p=r[l][1][h];return o(p||h)},d,d.exports,n,r,i,a)}return i[l].exports}for(var s=typeof ff=="function"&&ff,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("crypto");function g(S,A){return function(_,E){var C;if(C=E.algorithm!=="passthrough"?p.createHash(E.algorithm):new w,C.write===void 0&&(C.write=C.update,C.end=C.update),x(E,C).dispatch(_),C.update||C.end(""),C.digest)return C.digest(E.encoding==="buffer"?void 0:E.encoding);var k=C.read();return E.encoding!=="buffer"?k.toString(E.encoding):k}(S,A=y(S,A))}(i=r.exports=g).sha1=function(S){return g(S)},i.keys=function(S){return g(S,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(S){return g(S,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(S){return g(S,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"];m.push("passthrough");var v=["buffer","hex","binary","base64"];function y(S,A){A=A||{};var _={};if(_.algorithm=A.algorithm||"sha1",_.encoding=A.encoding||"hex",_.excludeValues=!!A.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=A.ignoreUnknown===!0,_.respectType=A.respectType!==!1,_.respectFunctionNames=A.respectFunctionNames!==!1,_.respectFunctionProperties=A.respectFunctionProperties!==!1,_.unorderedArrays=A.unorderedArrays===!0,_.unorderedSets=A.unorderedSets!==!1,_.unorderedObjects=A.unorderedObjects!==!1,_.replacer=A.replacer||void 0,_.excludeKeys=A.excludeKeys||void 0,S===void 0)throw new Error("Object argument required.");for(var E=0;E<m.length;++E)m[E].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=m[E]);if(m.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+m.join(", "));if(v.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+v.join(", "));return _}function b(S){if(typeof S=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(S))!=null}function x(S,A,_){_=_||[];function E(C){return A.update?A.update(C,"utf8"):A.write(C,"utf8")}return{dispatch:function(C){return S.replacer&&(C=S.replacer(C)),this["_"+(C===null?"null":typeof C)](C)},_object:function(C){var k=Object.prototype.toString.call(C),T=/\[object (.*)\]/i.exec(k);T=(T=T?T[1]:"unknown:["+k+"]").toLowerCase();var I;if(0<=(I=_.indexOf(C)))return this.dispatch("[CIRCULAR:"+I+"]");if(_.push(C),s!==void 0&&s.isBuffer&&s.isBuffer(C))return E("buffer:"),E(C);if(T==="object"||T==="function"||T==="asyncfunction"){var N=Object.keys(C);S.unorderedObjects&&(N=N.sort()),S.respectType===!1||b(C)||N.splice(0,0,"prototype","__proto__","constructor"),S.excludeKeys&&(N=N.filter(function(D){return!S.excludeKeys(D)})),E("object:"+N.length+":");var O=this;return N.forEach(function(D){O.dispatch(D),E(":"),S.excludeValues||O.dispatch(C[D]),E(",")})}if(!this["_"+T]){if(S.ignoreUnknown)return E("["+T+"]");throw new Error('Unknown object type "'+T+'"')}this["_"+T](C)},_array:function(C,k){k=k!==void 0?k:S.unorderedArrays!==!1;var T=this;if(E("array:"+C.length+":"),!k||C.length<=1)return C.forEach(function(O){return T.dispatch(O)});var I=[],N=C.map(function(O){var D=new w,L=_.slice();return x(S,D,L).dispatch(O),I=I.concat(L.slice(_.length)),D.read().toString()});return _=_.concat(I),N.sort(),this._array(N,!1)},_date:function(C){return E("date:"+C.toJSON())},_symbol:function(C){return E("symbol:"+C.toString())},_error:function(C){return E("error:"+C.toString())},_boolean:function(C){return E("bool:"+C.toString())},_string:function(C){E("string:"+C.length+":"),E(C.toString())},_function:function(C){E("fn:"),b(C)?this.dispatch("[native]"):this.dispatch(C.toString()),S.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(C.name)),S.respectFunctionProperties&&this._object(C)},_number:function(C){return E("number:"+C.toString())},_xml:function(C){return E("xml:"+C.toString())},_null:function(){return E("Null")},_undefined:function(){return E("Undefined")},_regexp:function(C){return E("regex:"+C.toString())},_uint8array:function(C){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint8clampedarray:function(C){return E("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(C))},_int8array:function(C){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint16array:function(C){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(C))},_int16array:function(C){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(C))},_uint32array:function(C){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(C))},_int32array:function(C){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(C))},_float32array:function(C){return E("float32array:"),this.dispatch(Array.prototype.slice.call(C))},_float64array:function(C){return E("float64array:"),this.dispatch(Array.prototype.slice.call(C))},_arraybuffer:function(C){return E("arraybuffer:"),this.dispatch(new Uint8Array(C))},_url:function(C){return E("url:"+C.toString())},_map:function(C){E("map:");var k=Array.from(C);return this._array(k,S.unorderedSets!==!1)},_set:function(C){E("set:");var k=Array.from(C);return this._array(k,S.unorderedSets!==!1)},_file:function(C){return E("file:"),this.dispatch([C.name,C.size,C.type,C.lastModfied])},_blob:function(){if(S.ignoreUnknown)return E("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return E("domwindow")},_bigint:function(C){return E("bigint:"+C.toString())},_process:function(){return E("process")},_timer:function(){return E("timer")},_pipe:function(){return E("pipe")},_tcp:function(){return E("tcp")},_udp:function(){return E("udp")},_tty:function(){return E("tty")},_statwatcher:function(){return E("statwatcher")},_securecontext:function(){return E("securecontext")},_connection:function(){return E("connection")},_zlib:function(){return E("zlib")},_context:function(){return E("context")},_nodescript:function(){return E("nodescript")},_httpparser:function(){return E("httpparser")},_dataview:function(){return E("dataview")},_signal:function(){return E("signal")},_fsevent:function(){return E("fsevent")},_tlswrap:function(){return E("tlswrap")}}}function w(){return{buf:"",write:function(S){this.buf+=S},end:function(S){this.buf+=S},read:function(){return this.buf}}}i.writeToStream=function(S,A,_){return _===void 0&&(_=A,A={}),x(A=y(S,A),_).dispatch(S)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){(function(p){var g=typeof Uint8Array!="undefined"?Uint8Array:Array,m="+".charCodeAt(0),v="/".charCodeAt(0),y="0".charCodeAt(0),b="a".charCodeAt(0),x="A".charCodeAt(0),w="-".charCodeAt(0),S="_".charCodeAt(0);function A(_){var E=_.charCodeAt(0);return E===m||E===w?62:E===v||E===S?63:E<y?-1:E<y+10?E-y+26+26:E<x+26?E-x:E<b+26?E-b+26:void 0}p.toByteArray=function(_){var E,C;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var k=_.length,T=_.charAt(k-2)==="="?2:_.charAt(k-1)==="="?1:0,I=new g(3*_.length/4-T),N=0<T?_.length-4:_.length,O=0;function D(L){I[O++]=L}for(E=0;E<N;E+=4,0)D((16711680&(C=A(_.charAt(E))<<18|A(_.charAt(E+1))<<12|A(_.charAt(E+2))<<6|A(_.charAt(E+3))))>>16),D((65280&C)>>8),D(255&C);return T==2?D(255&(C=A(_.charAt(E))<<2|A(_.charAt(E+1))>>4)):T==1&&(D((C=A(_.charAt(E))<<10|A(_.charAt(E+1))<<4|A(_.charAt(E+2))>>2)>>8&255),D(255&C)),I},p.fromByteArray=function(_){var E,C,k,T,I=_.length%3,N="";function O(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(E=0,k=_.length-I;E<k;E+=3)C=(_[E]<<16)+(_[E+1]<<8)+_[E+2],N+=O((T=C)>>18&63)+O(T>>12&63)+O(T>>6&63)+O(63&T);switch(I){case 1:N+=O((C=_[_.length-1])>>2),N+=O(C<<4&63),N+="==";break;case 2:N+=O((C=(_[_.length-2]<<8)+_[_.length-1])>>10),N+=O(C>>4&63),N+=O(C<<2&63),N+="="}return N}})(i===void 0?this.base64js={}:i)}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("base64-js"),g=n("ieee754");function s(P,F,V){if(!(this instanceof s))return new s(P,F,V);var ae,Y,M,B,R,X=typeof P;if(F==="base64"&&X=="string")for(P=(ae=P).trim?ae.trim():ae.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(X=="number")Y=L(P);else if(X=="string")Y=s.byteLength(P,F);else{if(X!="object")throw new Error("First argument needs to be a number, array or string.");Y=L(P.length)}if(s._useTypedArrays?M=s._augment(new Uint8Array(Y)):((M=this).length=Y,M._isBuffer=!0),s._useTypedArrays&&typeof P.byteLength=="number")M._set(P);else if(W(R=P)||s.isBuffer(R)||R&&typeof R=="object"&&typeof R.length=="number")for(B=0;B<Y;B++)s.isBuffer(P)?M[B]=P.readUInt8(B):M[B]=P[B];else if(X=="string")M.write(P,0,F);else if(X=="number"&&!s._useTypedArrays&&!V)for(B=0;B<Y;B++)M[B]=0;return M}function m(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M=[],B=0;B<Y.length;B++)M.push(255&Y.charCodeAt(B));return M}(F),P,V,ae)}function v(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M,B,R,X=[],ge=0;ge<Y.length;ge++)M=Y.charCodeAt(ge),B=M>>8,R=M%256,X.push(R),X.push(B);return X}(F),P,V,ae)}function y(P,F,V){var ae="";V=Math.min(P.length,V);for(var Y=F;Y<V;Y++)ae+=String.fromCharCode(P[Y]);return ae}function b(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(Y=P[F],F+1<M&&(Y|=P[F+1]<<8)):(Y=P[F]<<8,F+1<M&&(Y|=P[F+1])),Y}function x(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(F+2<M&&(Y=P[F+2]<<16),F+1<M&&(Y|=P[F+1]<<8),Y|=P[F],F+3<M&&(Y+=P[F+3]<<24>>>0)):(F+1<M&&(Y=P[F+1]<<16),F+2<M&&(Y|=P[F+2]<<8),F+3<M&&(Y|=P[F+3]),Y+=P[F]<<24>>>0),Y}function w(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=b(P,F,V,!0);return 32768&Y?-1*(65535-Y+1):Y}}function S(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=x(P,F,V,!0);return 2147483648&Y?-1*(4294967295-Y+1):Y}}function A(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+3<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,23,4)}function _(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+7<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,52,8)}function E(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"trying to write beyond buffer length"),Oe(F,65535));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,2);B<R;B++)P[V+B]=(F&255<<8*(ae?B:1-B))>>>8*(ae?B:1-B)}function C(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"trying to write beyond buffer length"),Oe(F,4294967295));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,4);B<R;B++)P[V+B]=F>>>8*(ae?B:3-B)&255}function k(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"Trying to write beyond buffer length"),Te(F,32767,-32768)),P.length<=V||E(P,0<=F?F:65535+F+1,V,ae,Y)}function T(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Te(F,2147483647,-2147483648)),P.length<=V||C(P,0<=F?F:4294967295+F+1,V,ae,Y)}function I(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Re(F,34028234663852886e22,-34028234663852886e22)),P.length<=V||g.write(P,F,V,ae,23,4)}function N(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+7<P.length,"Trying to write beyond buffer length"),Re(F,17976931348623157e292,-17976931348623157e292)),P.length<=V||g.write(P,F,V,ae,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var P=new ArrayBuffer(0),F=new Uint8Array(P);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(V){return!1}}(),s.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(P){return!(P==null||!P._isBuffer)},s.byteLength=function(P,F){var V;switch(P+="",F||"utf8"){case"hex":V=P.length/2;break;case"utf8":case"utf-8":V=K(P).length;break;case"ascii":case"binary":case"raw":V=P.length;break;case"base64":V=ee(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=2*P.length;break;default:throw new Error("Unknown encoding")}return V},s.concat=function(P,F){if(me(W(P),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),P.length===0)return new s(0);if(P.length===1)return P[0];if(typeof F!="number")for(Y=F=0;Y<P.length;Y++)F+=P[Y].length;for(var V=new s(F),ae=0,Y=0;Y<P.length;Y++){var M=P[Y];M.copy(V,ae),ae+=M.length}return V},s.prototype.write=function(P,F,V,ae){var Y;isFinite(F)?isFinite(V)||(ae=V,V=void 0):(Y=ae,ae=F,F=V,V=Y),F=Number(F)||0;var M,B,R,X,ge,xe,ze,Ke,Ze,Bt=this.length-F;switch((!V||Bt<(V=Number(V)))&&(V=Bt),ae=String(ae||"utf8").toLowerCase()){case"hex":M=function(Je,Zt,mn,Hn){mn=Number(mn)||0;var ni=Je.length-mn;(!Hn||ni<(Hn=Number(Hn)))&&(Hn=ni);var tr=Zt.length;me(tr%2==0,"Invalid hex string"),tr/2<Hn&&(Hn=tr/2);for(var Dn=0;Dn<Hn;Dn++){var es=parseInt(Zt.substr(2*Dn,2),16);me(!isNaN(es),"Invalid hex string"),Je[mn+Dn]=es}return s._charsWritten=2*Dn,Dn}(this,P,F,V);break;case"utf8":case"utf-8":xe=this,ze=P,Ke=F,Ze=V,M=s._charsWritten=ce(K(ze),xe,Ke,Ze);break;case"ascii":case"binary":M=m(this,P,F,V);break;case"base64":B=this,R=P,X=F,ge=V,M=s._charsWritten=ce(ee(R),B,X,ge);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":M=v(this,P,F,V);break;default:throw new Error("Unknown encoding")}return M},s.prototype.toString=function(P,F,V){var ae,Y,M,B,R=this;if(P=String(P||"utf8").toLowerCase(),F=Number(F)||0,(V=V!==void 0?Number(V):V=R.length)===F)return"";switch(P){case"hex":ae=function(X,ge,xe){var ze=X.length;(!ge||ge<0)&&(ge=0),(!xe||xe<0||ze<xe)&&(xe=ze);for(var Ke="",Ze=ge;Ze<xe;Ze++)Ke+=G(X[Ze]);return Ke}(R,F,V);break;case"utf8":case"utf-8":ae=function(X,ge,xe){var ze="",Ke="";xe=Math.min(X.length,xe);for(var Ze=ge;Ze<xe;Ze++)X[Ze]<=127?(ze+=he(Ke)+String.fromCharCode(X[Ze]),Ke=""):Ke+="%"+X[Ze].toString(16);return ze+he(Ke)}(R,F,V);break;case"ascii":case"binary":ae=y(R,F,V);break;case"base64":Y=R,B=V,ae=(M=F)===0&&B===Y.length?p.fromByteArray(Y):p.fromByteArray(Y.slice(M,B));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ae=function(X,ge,xe){for(var ze=X.slice(ge,xe),Ke="",Ze=0;Ze<ze.length;Ze+=2)Ke+=String.fromCharCode(ze[Ze]+256*ze[Ze+1]);return Ke}(R,F,V);break;default:throw new Error("Unknown encoding")}return ae},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(P,F,V,ae){if(V=V||0,ae||ae===0||(ae=this.length),F=F||0,ae!==V&&P.length!==0&&this.length!==0){me(V<=ae,"sourceEnd < sourceStart"),me(0<=F&&F<P.length,"targetStart out of bounds"),me(0<=V&&V<this.length,"sourceStart out of bounds"),me(0<=ae&&ae<=this.length,"sourceEnd out of bounds"),ae>this.length&&(ae=this.length),P.length-F<ae-V&&(ae=P.length-F+V);var Y=ae-V;if(Y<100||!s._useTypedArrays)for(var M=0;M<Y;M++)P[M+F]=this[M+V];else P._set(this.subarray(V,V+Y),F)}},s.prototype.slice=function(P,F){var V=this.length;if(P=D(P,V,0),F=D(F,V,V),s._useTypedArrays)return s._augment(this.subarray(P,F));for(var ae=F-P,Y=new s(ae,void 0,!0),M=0;M<ae;M++)Y[M]=this[M+P];return Y},s.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},s.prototype.set=function(P,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,F)},s.prototype.readUInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},s.prototype.readUInt16LE=function(P,F){return b(this,P,!0,F)},s.prototype.readUInt16BE=function(P,F){return b(this,P,!1,F)},s.prototype.readUInt32LE=function(P,F){return x(this,P,!0,F)},s.prototype.readUInt32BE=function(P,F){return x(this,P,!1,F)},s.prototype.readInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},s.prototype.readInt16LE=function(P,F){return w(this,P,!0,F)},s.prototype.readInt16BE=function(P,F){return w(this,P,!1,F)},s.prototype.readInt32LE=function(P,F){return S(this,P,!0,F)},s.prototype.readInt32BE=function(P,F){return S(this,P,!1,F)},s.prototype.readFloatLE=function(P,F){return A(this,P,!0,F)},s.prototype.readFloatBE=function(P,F){return A(this,P,!1,F)},s.prototype.readDoubleLE=function(P,F){return _(this,P,!0,F)},s.prototype.readDoubleBE=function(P,F){return _(this,P,!1,F)},s.prototype.writeUInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"trying to write beyond buffer length"),Oe(P,255)),F>=this.length||(this[F]=P)},s.prototype.writeUInt16LE=function(P,F,V){E(this,P,F,!0,V)},s.prototype.writeUInt16BE=function(P,F,V){E(this,P,F,!1,V)},s.prototype.writeUInt32LE=function(P,F,V){C(this,P,F,!0,V)},s.prototype.writeUInt32BE=function(P,F,V){C(this,P,F,!1,V)},s.prototype.writeInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"Trying to write beyond buffer length"),Te(P,127,-128)),F>=this.length||(0<=P?this.writeUInt8(P,F,V):this.writeUInt8(255+P+1,F,V))},s.prototype.writeInt16LE=function(P,F,V){k(this,P,F,!0,V)},s.prototype.writeInt16BE=function(P,F,V){k(this,P,F,!1,V)},s.prototype.writeInt32LE=function(P,F,V){T(this,P,F,!0,V)},s.prototype.writeInt32BE=function(P,F,V){T(this,P,F,!1,V)},s.prototype.writeFloatLE=function(P,F,V){I(this,P,F,!0,V)},s.prototype.writeFloatBE=function(P,F,V){I(this,P,F,!1,V)},s.prototype.writeDoubleLE=function(P,F,V){N(this,P,F,!0,V)},s.prototype.writeDoubleBE=function(P,F,V){N(this,P,F,!1,V)},s.prototype.fill=function(P,F,V){if(P=P||0,F=F||0,V=V||this.length,typeof P=="string"&&(P=P.charCodeAt(0)),me(typeof P=="number"&&!isNaN(P),"value is not a number"),me(F<=V,"end < start"),V!==F&&this.length!==0){me(0<=F&&F<this.length,"start out of bounds"),me(0<=V&&V<=this.length,"end out of bounds");for(var ae=F;ae<V;ae++)this[ae]=P}},s.prototype.inspect=function(){for(var P=[],F=this.length,V=0;V<F;V++)if(P[V]=G(this[V]),V===i.INSPECT_MAX_BYTES){P[V+1]="...";break}return"<Buffer "+P.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var P=new Uint8Array(this.length),F=0,V=P.length;F<V;F+=1)P[F]=this[F];return P.buffer};var O=s.prototype;function D(P,F,V){return typeof P!="number"?V:F<=(P=~~P)?F:0<=P||0<=(P+=F)?P:0}function L(P){return(P=~~Math.ceil(+P))<0?0:P}function W(P){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(P)}function G(P){return P<16?"0"+P.toString(16):P.toString(16)}function K(P){for(var F=[],V=0;V<P.length;V++){var ae=P.charCodeAt(V);if(ae<=127)F.push(P.charCodeAt(V));else{var Y=V;55296<=ae&&ae<=57343&&V++;for(var M=encodeURIComponent(P.slice(Y,V+1)).substr(1).split("%"),B=0;B<M.length;B++)F.push(parseInt(M[B],16))}}return F}function ee(P){return p.toByteArray(P)}function ce(P,F,V,ae){for(var Y=0;Y<ae&&!(Y+V>=F.length||Y>=P.length);Y++)F[Y+V]=P[Y];return Y}function he(P){try{return decodeURIComponent(P)}catch(F){return String.fromCharCode(65533)}}function Oe(P,F){me(typeof P=="number","cannot write a non-number as a number"),me(0<=P,"specified a negative value for writing an unsigned value"),me(P<=F,"value is larger than maximum value for type"),me(Math.floor(P)===P,"value has a fractional component")}function Te(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value"),me(Math.floor(P)===P,"value has a fractional component")}function Re(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value")}function me(P,F){if(!P)throw new Error(F||"Failed assertion")}s._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=O.get,P.set=O.set,P.write=O.write,P.toString=O.toString,P.toLocaleString=O.toString,P.toJSON=O.toJSON,P.copy=O.copy,P.slice=O.slice,P.readUInt8=O.readUInt8,P.readUInt16LE=O.readUInt16LE,P.readUInt16BE=O.readUInt16BE,P.readUInt32LE=O.readUInt32LE,P.readUInt32BE=O.readUInt32BE,P.readInt8=O.readInt8,P.readInt16LE=O.readInt16LE,P.readInt16BE=O.readInt16BE,P.readInt32LE=O.readInt32LE,P.readInt32BE=O.readInt32BE,P.readFloatLE=O.readFloatLE,P.readFloatBE=O.readFloatBE,P.readDoubleLE=O.readDoubleLE,P.readDoubleBE=O.readDoubleBE,P.writeUInt8=O.writeUInt8,P.writeUInt16LE=O.writeUInt16LE,P.writeUInt16BE=O.writeUInt16BE,P.writeUInt32LE=O.writeUInt32LE,P.writeUInt32BE=O.writeUInt32BE,P.writeInt8=O.writeInt8,P.writeInt16LE=O.writeInt16LE,P.writeInt16BE=O.writeInt16BE,P.writeInt32LE=O.writeInt32LE,P.writeInt32BE=O.writeInt32BE,P.writeFloatLE=O.writeFloatLE,P.writeFloatBE=O.writeFloatBE,P.writeDoubleLE=O.writeDoubleLE,P.writeDoubleBE=O.writeDoubleBE,P.fill=O.fill,P.inspect=O.inspect,P.toArrayBuffer=O.toArrayBuffer,P}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=4,g=new s(p);g.fill(0),r.exports={hash:function(m,v,y,b){return s.isBuffer(m)||(m=new s(m)),function(x,w,S){for(var A=new s(w),_=S?A.writeInt32BE:A.writeInt32LE,E=0;E<x.length;E++)_.call(A,x[E],4*E,!0);return A}(v(function(x,w){var S;x.length%p!=0&&(S=x.length+(p-x.length%p),x=s.concat([x,g],S));for(var A=[],_=w?x.readInt32BE:x.readInt32LE,E=0;E<x.length;E+=p)A.push(_.call(x,E));return A}(m,b),8*m.length),y,b)}}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=n("./sha"),g=n("./sha256"),m=n("./rng"),v={sha1:p,sha256:g,md5:n("./md5")},y=64,b=new s(y);function x(S,A){var _=v[S=S||"sha1"],E=[];return _||w("algorithm:",S,"is not yet supported"),{update:function(C){return s.isBuffer(C)||(C=new s(C)),E.push(C),C.length,this},digest:function(C){var k=s.concat(E),T=A?function(I,N,O){s.isBuffer(N)||(N=new s(N)),s.isBuffer(O)||(O=new s(O)),N.length>y?N=I(N):N.length<y&&(N=s.concat([N,b],y));for(var D=new s(y),L=new s(y),W=0;W<y;W++)D[W]=54^N[W],L[W]=92^N[W];var G=I(s.concat([D,O]));return I(s.concat([L,G]))}(_,A,k):_(k);return E=null,C?T.toString(C):T}}}function w(){var S=[].slice.call(arguments).join(" ");throw new Error([S,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}b.fill(0),i.createHash=function(S){return x(S)},i.createHmac=x,i.randomBytes=function(S,A){if(!A||!A.call)return new s(m(S));try{A.call(this,void 0,new s(m(S)))}catch(_){A(_)}},function(S,A){for(var _ in S)A(S[_],_)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(S){i[S]=function(){w("sorry,",S,"is not implemented yet")}})}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(S,A){S[A>>5]|=128<<A%32,S[14+(A+64>>>9<<4)]=A;for(var _=1732584193,E=-271733879,C=-1732584194,k=271733878,T=0;T<S.length;T+=16){var I=_,N=E,O=C,D=k,_=v(_,E,C,k,S[T+0],7,-680876936),k=v(k,_,E,C,S[T+1],12,-389564586),C=v(C,k,_,E,S[T+2],17,606105819),E=v(E,C,k,_,S[T+3],22,-1044525330);_=v(_,E,C,k,S[T+4],7,-176418897),k=v(k,_,E,C,S[T+5],12,1200080426),C=v(C,k,_,E,S[T+6],17,-1473231341),E=v(E,C,k,_,S[T+7],22,-45705983),_=v(_,E,C,k,S[T+8],7,1770035416),k=v(k,_,E,C,S[T+9],12,-1958414417),C=v(C,k,_,E,S[T+10],17,-42063),E=v(E,C,k,_,S[T+11],22,-1990404162),_=v(_,E,C,k,S[T+12],7,1804603682),k=v(k,_,E,C,S[T+13],12,-40341101),C=v(C,k,_,E,S[T+14],17,-1502002290),_=y(_,E=v(E,C,k,_,S[T+15],22,1236535329),C,k,S[T+1],5,-165796510),k=y(k,_,E,C,S[T+6],9,-1069501632),C=y(C,k,_,E,S[T+11],14,643717713),E=y(E,C,k,_,S[T+0],20,-373897302),_=y(_,E,C,k,S[T+5],5,-701558691),k=y(k,_,E,C,S[T+10],9,38016083),C=y(C,k,_,E,S[T+15],14,-660478335),E=y(E,C,k,_,S[T+4],20,-405537848),_=y(_,E,C,k,S[T+9],5,568446438),k=y(k,_,E,C,S[T+14],9,-1019803690),C=y(C,k,_,E,S[T+3],14,-187363961),E=y(E,C,k,_,S[T+8],20,1163531501),_=y(_,E,C,k,S[T+13],5,-1444681467),k=y(k,_,E,C,S[T+2],9,-51403784),C=y(C,k,_,E,S[T+7],14,1735328473),_=b(_,E=y(E,C,k,_,S[T+12],20,-1926607734),C,k,S[T+5],4,-378558),k=b(k,_,E,C,S[T+8],11,-2022574463),C=b(C,k,_,E,S[T+11],16,1839030562),E=b(E,C,k,_,S[T+14],23,-35309556),_=b(_,E,C,k,S[T+1],4,-1530992060),k=b(k,_,E,C,S[T+4],11,1272893353),C=b(C,k,_,E,S[T+7],16,-155497632),E=b(E,C,k,_,S[T+10],23,-1094730640),_=b(_,E,C,k,S[T+13],4,681279174),k=b(k,_,E,C,S[T+0],11,-358537222),C=b(C,k,_,E,S[T+3],16,-722521979),E=b(E,C,k,_,S[T+6],23,76029189),_=b(_,E,C,k,S[T+9],4,-640364487),k=b(k,_,E,C,S[T+12],11,-421815835),C=b(C,k,_,E,S[T+15],16,530742520),_=x(_,E=b(E,C,k,_,S[T+2],23,-995338651),C,k,S[T+0],6,-198630844),k=x(k,_,E,C,S[T+7],10,1126891415),C=x(C,k,_,E,S[T+14],15,-1416354905),E=x(E,C,k,_,S[T+5],21,-57434055),_=x(_,E,C,k,S[T+12],6,1700485571),k=x(k,_,E,C,S[T+3],10,-1894986606),C=x(C,k,_,E,S[T+10],15,-1051523),E=x(E,C,k,_,S[T+1],21,-2054922799),_=x(_,E,C,k,S[T+8],6,1873313359),k=x(k,_,E,C,S[T+15],10,-30611744),C=x(C,k,_,E,S[T+6],15,-1560198380),E=x(E,C,k,_,S[T+13],21,1309151649),_=x(_,E,C,k,S[T+4],6,-145523070),k=x(k,_,E,C,S[T+11],10,-1120210379),C=x(C,k,_,E,S[T+2],15,718787259),E=x(E,C,k,_,S[T+9],21,-343485551),_=w(_,I),E=w(E,N),C=w(C,O),k=w(k,D)}return Array(_,E,C,k)}function m(S,A,_,E,C,k){return w((T=w(w(A,S),w(E,k)))<<(I=C)|T>>>32-I,_);var T,I}function v(S,A,_,E,C,k,T){return m(A&_|~A&E,S,A,C,k,T)}function y(S,A,_,E,C,k,T){return m(A&E|_&~E,S,A,C,k,T)}function b(S,A,_,E,C,k,T){return m(A^_^E,S,A,C,k,T)}function x(S,A,_,E,C,k,T){return m(_^(A|~E),S,A,C,k,T)}function w(S,A){var _=(65535&S)+(65535&A);return(S>>16)+(A>>16)+(_>>16)<<16|65535&_}r.exports=function(S){return p.hash(S,g,16)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p;p=function(g){for(var m,v=new Array(g),y=0;y<g;y++)(3&y)==0&&(m=4294967296*Math.random()),v[y]=m>>>((3&y)<<3)&255;return v},r.exports=p}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(y,b){y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var x,w,S,A,_,E=Array(80),C=1732584193,k=-271733879,T=-1732584194,I=271733878,N=-1009589776,O=0;O<y.length;O+=16){for(var D=C,L=k,W=T,G=I,K=N,ee=0;ee<80;ee++){E[ee]=ee<16?y[O+ee]:v(E[ee-3]^E[ee-8]^E[ee-14]^E[ee-16],1);var ce=m(m(v(C,5),(S=k,A=T,_=I,(w=ee)<20?S&A|~S&_:!(w<40)&&w<60?S&A|S&_|A&_:S^A^_)),m(m(N,E[ee]),(x=ee)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),N=I,I=T,T=v(k,30),k=C,C=ce}C=m(C,D),k=m(k,L),T=m(T,W),I=m(I,G),N=m(N,K)}return Array(C,k,T,I,N)}function m(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function v(y,b){return y<<b|y>>>32-b}r.exports=function(y){return p.hash(y,g,20,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function g(y,b){return y>>>b|y<<32-b}function m(y,b){var x,w,S,A,_,E,C,k,T,I,N=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64);y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var L,W,G,K,ee,ce,he,Oe,Te=0;Te<y.length;Te+=16){x=O[0],w=O[1],S=O[2],A=O[3],_=O[4],E=O[5],C=O[6],k=O[7];for(var Re=0;Re<64;Re++)D[Re]=Re<16?y[Re+Te]:p(p(p((Oe=D[Re-2],g(Oe,17)^g(Oe,19)^Oe>>>10),D[Re-7]),(he=D[Re-15],g(he,7)^g(he,18)^he>>>3)),D[Re-16]),T=p(p(p(p(k,g(ce=_,6)^g(ce,11)^g(ce,25)),(ee=_)&E^~ee&C),N[Re]),D[Re]),I=p(g(K=x,2)^g(K,13)^g(K,22),(L=x)&(W=w)^L&(G=S)^W&G),k=C,C=E,E=_,_=p(A,T),A=S,S=w,w=x,x=p(T,I);O[0]=p(x,O[0]),O[1]=p(w,O[1]),O[2]=p(S,O[2]),O[3]=p(A,O[3]),O[4]=p(_,O[4]),O[5]=p(E,O[5]),O[6]=p(C,O[6]),O[7]=p(k,O[7])}return O}var v=n("./helpers");r.exports=function(y){return v.hash(y,m,32,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(){}(a=r.exports={}).nextTick=function(){var g=typeof window!="undefined"&&window.setImmediate,m=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(g)return function(y){return window.setImmediate(y)};if(m){var v=[];return window.addEventListener("message",function(y){var b=y.source;b!==window&&b!==null||y.data!=="process-tick"||(y.stopPropagation(),0<v.length&&v.shift()())},!0),function(y){v.push(y),window.postMessage("process-tick","*")}}return function(y){setTimeout(y,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){i.read=function(p,g,m,v,y){var b,x,w=8*y-v-1,S=(1<<w)-1,A=S>>1,_=-7,E=m?y-1:0,C=m?-1:1,k=p[g+E];for(E+=C,b=k&(1<<-_)-1,k>>=-_,_+=w;0<_;b=256*b+p[g+E],E+=C,_-=8);for(x=b&(1<<-_)-1,b>>=-_,_+=v;0<_;x=256*x+p[g+E],E+=C,_-=8);if(b===0)b=1-A;else{if(b===S)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,v),b-=A}return(k?-1:1)*x*Math.pow(2,b-v)},i.write=function(p,g,m,v,y,b){var x,w,S,A=8*b-y-1,_=(1<<A)-1,E=_>>1,C=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=v?0:b-1,T=v?1:-1,I=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,x=_):(x=Math.floor(Math.log(g)/Math.LN2),g*(S=Math.pow(2,-x))<1&&(x--,S*=2),2<=(g+=1<=x+E?C/S:C*Math.pow(2,1-E))*S&&(x++,S/=2),_<=x+E?(w=0,x=_):1<=x+E?(w=(g*S-1)*Math.pow(2,y),x+=E):(w=g*Math.pow(2,E-1)*Math.pow(2,y),x=0));8<=y;p[m+k]=255&w,k+=T,w/=256,y-=8);for(x=x<<y|w,A+=y;0<A;p[m+k]=255&x,k+=T,x/=256,A-=8);p[m+k-T]|=128*I}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)})})(cX);var LMe=cX.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fX=function(e,t){return(fX=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function js(e,t){function n(){this.constructor=e}fX(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function tt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function nt(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var dX=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return BMe(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(a){var o=a.split(":"),s=o[0],u=o[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function BMe(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function pe(){return qF}var qF=null,Em=new Map,Jy=new Map;function HF(e,t){var n=YF(e,t);return Em.get(n)}function GF(e){return Jy.get(e)}function KF(e){for(var t=Em.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===e&&n.push(s)}return n}function XF(e){var t=e.kernelName,n=e.backendName,r=YF(t,n);if(Em.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Em.set(r,e)}function hX(e){var t=e.kernelName;Jy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Jy.set(t,e)}function zMe(e,t){var n=YF(e,t);if(!Em.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");Em.delete(n)}function jMe(e){if(!Jy.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Jy.delete(e)}function YF(e,t){return t+"_"+e}function pX(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function _S(e,t,n){return Math.max(e,Math.min(t,n))}function ZF(e){return e%2==0?e:e+1}function gX(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function U(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function ln(e,t,n){n===void 0&&(n=""),U(Wr(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Dh(e){U(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function ic(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Di(e)&&!n)for(var r=0;r<e.length;++r)ic(e[r],t,n);else t.push(e);return t}function et(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Wr(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function vr(e){return e%1==0}function mX(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function SS(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Rh(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function JF(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?i():setTimeout(o,s)}};o()})}function vX(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function Vr(e,t){var n=t.length;return U((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),U(e.every(function(r){return vr(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Af(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Vr(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Fh(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Qy(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function yX(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function bX(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function xX(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Di(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function QF(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function wX(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Cf(e){return typeof e=="string"||e instanceof String}function _X(e){return typeof e=="boolean"}function SX(e){return typeof e=="number"}function Am(e){return Array.isArray(e)?Am(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":SX(e)?"float32":Cf(e)?"string":_X(e)?"bool":"float32"}function kf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ES(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Qa(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function e3(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=ic(e)),n&&yX(e,t),function(a,o){return a instanceof Float32Array&&o==="float32"||a instanceof Int32Array&&o==="int32"||a instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function t3(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,a,o){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=o[i+l];else{u=a[0];var c=a.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(i+l*f,c,o)}return s}(0,e,t)}function n3(e,t){for(var n=Cm(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Cm(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Us(){return pe().platform.now()}function r3(e){e.forEach(function(t){U(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function EX(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.encode(e,t)}function eb(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.decode(e,t)}function AS(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function i3(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var pt=Object.freeze({shuffle:pX,clamp:_S,nearestLargerEven:ZF,sum:gX,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:U,assertShapesMatch:ln,assertNonNull:Dh,flatten:ic,sizeFromShape:et,isScalarShape:function(e){return e.length===0},arraysEqual:Wr,isInt:vr,tanh:mX,sizeToSquarishShape:SS,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return pX(t),t},rightPad:Rh,repeatedTry:JF,inferFromImplicitShape:vX,parseAxisParam:Vr,squeezeShape:Af,getTypedArrayFromDType:Fh,getArrayFromDType:Qy,checkConversionForErrors:yX,isValidDtype:bX,hasEncodingLoss:xX,isTypedArray:Di,bytesPerElement:QF,bytesFromStringArray:wX,isString:Cf,isBoolean:_X,isNumber:SX,inferDtype:Am,isFunction:kf,nearestDivisor:ES,computeStrides:Qa,toTypedArray:e3,toNestedArray:t3,makeOnesTypedArray:n3,makeZerosTypedArray:Cm,now:Us,assertNonNegativeIntegerDimensions:r3,fetch:function(e,t){return pe().platform.fetch(e,t)},encodeString:EX,decodeString:eb,locToIndex:AS,indexToLoc:i3}),UMe=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new WMe)}return e.prototype.profileKernel=function(t,n,r){var i,a=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),o.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),i},e}(),WMe=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?Rh(i+"ms",9):i.error,u=Rh(t,25),l=n.rank,c=n.size,f=Rh(n.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||n.shape,g=p.length;d+=h+": "+g+"D "+(g>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),AX=20,tb=3,a3=7;function VMe(e,t,n,r){var i=Qa(t),a=function(l,c,f,d){var h=et(c),p=d[d.length-1],g=new Array(p).fill(0),m=c.length,v=f==="complex64"?rb(l):l;if(m>1)for(var y=0;y<h/p;y++)for(var b=y*p,x=0;x<p;x++)g[x]=Math.max(g[x],nb(v[b+x],0,f).length);return g}(e,t,n,i),o=t.length,s=function l(c,f,d,h,p,g){g===void 0&&(g=!0);var m=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[nb(rb(c)[0],0,d)]:d==="bool"?[CX(c[0])]:[c[0].toString()];if(y===1){if(v>AX){var b=tb*m,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-tb)*m,v*m));return d==="complex64"&&(x=rb(x),w=rb(w)),["["+x.map(function(O,D){return nb(O,p[D],d)}).join(", ")+", ..., "+w.map(function(O,D){return nb(O,p[v-tb+D],d)}).join(", ")+"]"]}return["["+(d==="complex64"?rb(c):Array.from(c)).map(function(O,D){return nb(O,p[D],d)}).join(", ")+"]"]}var S=f.slice(1),A=h.slice(1),_=h[0]*m,E=[];if(v>AX){for(var C=0;C<tb;C++){var k=(T=C*_)+_;E.push.apply(E,l(c.slice(T,k),S,d,A,p,!1))}for(E.push("..."),C=v-tb;C<v;C++)k=(T=C*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,A,p,C===v-1))}else for(C=0;C<v;C++){var T;k=(T=C*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,A,p,C===v-1))}var I=y===2?",":"";for(E[0]="["+E[0]+I,C=1;C<E.length-1;C++)E[C]=" "+E[C]+I;var N=`,
`;for(C=2;C<y;C++)N+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(g?"":N),E}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function nb(e,t,n){return Rh(Array.isArray(e)?parseFloat(e[0].toFixed(a3))+" + "+parseFloat(e[1].toFixed(a3))+"j":Cf(e)?"'"+e+"'":n==="bool"?CX(e):parseFloat(e.toFixed(a3)).toString(),t)}function CX(e){return e===0?"false":"true"}function rb(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var km=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=et(t),r!=null){var a=r.length;U(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Qy(n,this.size),this.strides=Qa(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),U(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Lu().makeTensor(this.values,this.shape,this.dtype)},e}(),Lu=null,ye=null,kX=null,Ht=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=et(t),this.strides=Qa(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),ye.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,ye.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ye.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,t3(this.shape,t)]}})})},e.prototype.arraySync=function(){return t3(this.shape,this.dataSync())},e.prototype.data=function(){return tt(this,void 0,void 0,function(){var t,n;return nt(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Lu().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return eb(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Lu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return eb(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Lu().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Lu().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ye.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ye.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ye.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),ye.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ye.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ye.clone(this)},e.prototype.toString=function(t){return t===void 0&&(t=!1),VMe(this.dataSync(),this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ye.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),ye.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),ye.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),ye.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ye.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ye.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),ye.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ye.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),kX("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ye.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ye.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ye.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ye.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ye.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ye.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ye.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ye.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ye.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ye.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ye.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ye.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ye.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ye.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ye.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ye.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ye.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ye.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ye.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ye.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ye.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ye.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ye.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ye.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ye.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ye.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ye.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ye.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ye.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ye.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ye.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ye.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ye.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ye.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),ye.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),ye.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ye.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ye.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ye.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ye.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ye.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ye.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ye.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ye.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ye.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ye.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ye.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ye.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ye.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ye.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ye.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ye.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),ye.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ye.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ye.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ye.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ye.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ye.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ye.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ye.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ye.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ye.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ye.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ye.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ye.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ye.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ye.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ye.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ye.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ye.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ye.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ye.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ye.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ye.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ye.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ye.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ye.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ye.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),ye.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),ye.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),ye.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),ye.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),ye.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),ye.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),ye.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Lu().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ye.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),ye.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),ye.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),ye.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ye.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),ye.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),ye.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ye.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ye.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ye.spectral.irfft(this)},e}();Object.defineProperty(Ht,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var o3,s3,u3,l3,c3,ib=function(e){function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return js(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Wr(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Lu().disposeTensor(this),this.dataId=n.dataId,Lu().incRef(this,null)},t.prototype.dispose=function(){Lu().disposeVariable(this),this.isDisposedInternal=!0},t}(Ht);Object.defineProperty(ib,Symbol.hasInstance,{value:function(e){return e instanceof Ht&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(o3||(o3={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(s3||(s3={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(u3||(u3={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(l3||(l3={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(c3||(c3={}));var qMe={float32:l3,int32:s3,bool:u3,complex64:c3};function bi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return qMe[e][t]}function CS(e){return bi(e,"int32")}function fr(e,t){if(e.dtype===t.dtype)return[e,t];var n=bi(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function TX(e,t){U(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function f3(e){var t=[];return function n(r,i,a){if(r!=null){if(r instanceof Ht)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,i,a))}}}}(e,t,new Set),t}var d3,Bu=Object.freeze({makeTypesMatch:fr,assertTypesMatch:TX,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:f3}),OX=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),HMe=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new OX}return e.prototype.ready=function(){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=a.sent(),[3,3];case 2:i=r,a.label=3;case 3:if(!i)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new UMe(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;KF(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;KF(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var a=++this.pendingBackendInitId,o=i.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),a=i.success,o=i.asyncInit;if(o||a)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return i.startScope(a)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[],{}),n},e.prototype.runKernel=function(t,n,r,i,a){return this.runKernelFunc(null,n,null,t,r,i,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-a-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,a,o,s){var u,l=this,c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=HF(i,this.backendName);if(m!=null)d=function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:a,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b);var x=b.map(function(A){var _=A.dataId,E=A.shape,C=A.dtype;return l.makeTensorFromDataId(_,E,C)});if(f){var w=l.getTensorsForGradient(i,n,x);if(w==null){s==null&&(s=[]);var S=x.filter(function(A,_){return s[_]});w=(o||[]).slice().concat(S)}c=l.saveTensorsForBackwardMode(w)}return x};else{var v=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))};d=function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,v)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b),b}}return this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,n,function(){return d()}):d()}),f&&this.addTapeNode(i,n,u,r,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.saveTensorsForBackwardMode=function(t){var n=this;return t.map(function(r){return n.keep(n.clone(r))})},e.prototype.getTensorsForGradient=function(t,n,r){var i=GF(t);if(i!=null){var a=i.inputsToSave||[],o=i.outputsToSave||[],s=void 0;i.saveAllInputs?(U(Array.isArray(n),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(n).map(function(l){return n[l]})):s=a.map(function(l){return n[l]});var u=r.filter(function(l,c){return o[c]});return s.concat(u)}return null},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var a=t;r==="string"&&Cf(t[0])&&(a=t.map(function(c){return EX(c)}));var o=i.write(a,n,r),s=new Ht(n,r,o,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(o),l=wX(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var a=new Ht(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,i),a},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var a=new ib(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*QF(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof ib||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,a,o){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=GF(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=function(c){return c=c.map(function(f,d){if(f==null){var h=r[d],p=Cm(h.size,h.dtype);return s.makeTensor(p,h.shape,h.dtype)}return f}),i(c.length>1?c:c[0],a,o)}),this.state.activeTape.push(u)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=f3(t),i=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||i.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var a=this;if(i===void 0&&(i=!1),U(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});U(o instanceof Ht,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var g in p){for(var m=p[g],v=!1,y=0;y<l.length;y++)if(f[m.id]){S.outputs.forEach(function(C){return f[C.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var g in p)b[p[g].id]=!0,x[S.id]=!0;break}var w=[];for(h=0;h<u.length;h++){var S;if(d[(S=u[h]).id]&&x[S.id]){var A={};for(var g in S.inputs){var _=S.inputs[g];f[_.id]&&(A[g]=_)}var E=Object.assign({},S);E.inputs=A,E.outputs=S.outputs,w.push(E)}}return w}(this.state.activeTape,n,o);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[o.id]=r??(u=o.shape,l=n3(et(u),"float32"),J.makeTensor(l,u,"float32")),function(d,h,p){for(var g=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(A){var _=d[A.id];_!=null?b.push(_):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(A){if(!(A in x))throw new Error("Cannot backprop through input "+A+". Available gradients found: "+Object.keys(x)+".");var _=p(function(){return x[A]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+A+" must have 'float32' dtype, but has '"+_.dtype+"'");var E=y.inputs[A];if(!Wr(_.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+A+"' has shape '"+_.shape+"', which does not match the shape of the input '"+E.shape+"'");if(d[E.id]==null)d[E.id]=_;else{var C=d[E.id];d[E.id]=C.add(_),C.dispose()}};for(var S in y.inputs)w(S)},m=h.length-1;m>=0;m--)g(m)}(c,s,function(d){return a.tidy(d)});var f=n.map(function(d){return c[d.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:o,grads:f}})},e.prototype.customGrad=function(t){var n=this;return U(kf(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];U(i.every(function(s){return s instanceof Ht}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(s,u){o[u]=s}),n.runKernelFunc(function(s,u){return U((r=t.apply(void 0,i.concat([u]))).value instanceof Ht,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),U(kf(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];U(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),U(c.every(function(d){return d instanceof Ht}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){switch(i.label){case 0:return n=Us(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=Us()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new OX,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),J=function(){var e=function(){if(d3==null){var n=void 0;if(typeof window!="undefined")n=window;else if(typeof global!="undefined")n=global;else if(typeof process!="undefined")n=process;else{if(typeof self=="undefined")throw new Error("Could not find a global object");n=self}d3=n}return d3}();if(e._tfengine==null){var t=new dX(e);e._tfengine=new HMe(t)}return function(n){qF=n}(e._tfengine.ENV),Lu=function(){return e._tfengine},e._tfengine}();function IX(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var ac=pe();ac.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ac.registerFlag("IS_BROWSER",function(){return IX()}),ac.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&process.versions!==void 0&&process.versions.node!==void 0}),ac.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ac.registerFlag("PROD",function(){return!1}),ac.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ac.getBool("DEBUG")}),ac.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ac.registerFlag("IS_TEST",function(){return!1});var ab,Io,No,Mh={},h3={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function NX(e,t){Mh[e]=t}function zu(e){e in Mh||(Mh[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Mh[n]},!1),n===1?r.getContext("webgl",h3)||r.getContext("experimental-webgl",h3):r.getContext("webgl2",h3)}(e));var t=Mh[e];return t.isContextLost()?(delete Mh[e],zu(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Mh[e])}function kS(e,t){return[t,e]}function ob(e){var t=et(e);return SS(Math.ceil(t/4))}function sb(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function p3(e,t){var n,r,i,a,o,s,u,l,c,f=e;return pe().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,i=f.RGBA16F,a=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=f.RGBA,o=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function Qe(e,t,n){var r=n();return t&&function(i){var a=i.getError();if(a!==i.NO_ERROR)throw new Error("WebGL Error: "+RX(i,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(ab||(ab={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Io||(Io={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(No||(No={}));var GMe=596e-10,KMe=65504;function DX(e){return!!(pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||GMe<Math.abs(e)&&Math.abs(e)<KMe)}function RX(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function ub(e,t,n){return oc(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function FX(e,t,n){var r=oc(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function MX(e,t,n){var r=oc(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,a){var o=XMe.exec(a);if(o==null)return console.log("Couldn't parse line number in error: "+a),void console.log(i);for(var s=+o[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,v){return Rh((v+1).toString(),l)+m}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+Rh(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var TS,OS,XMe=/ERROR: [0-9]+:([0-9]+):/g;function PX(e,t){return oc(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function $X(e,t,n){if(Qe(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function IS(e,t,n){if(Qe(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function LX(e,t,n){var r=oc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function BX(e,t,n){var r=oc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function zX(e,t){return oc(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function jX(e,t){var n=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function UX(e,t){return oc(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function g3(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return u!==-1&&(Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),Qe(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)}),Qe(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function WX(e,t,n,r){KX(e,r),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function VX(e,t,n,r){return oc(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function qX(e,t,n){return e.getUniformLocation(t,n)}function HX(e,t,n,r,i,a){Qe(e,t,function(){return WX(e,t,r,a)}),Qe(e,t,function(){return e.uniform1i(i,a)})}function NS(e,t,n,r){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function m3(e,t,n){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function lb(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+GX(e,t))}function GX(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function oc(e,t,n,r){var i=Qe(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function KX(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function cb(e,t){return t===void 0&&(t=2),et(e.slice(0,e.length-t))}function fb(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function DS(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[cb(e)].concat(fb(e))),t}function XX(e,t){var n;t===void 0&&(t=!1);var r=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?ZF(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=Af(e);e=i.newShape}var a=et(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=cb(e),s=2,u=2;return e.length&&(s=(n=fb(e))[0],u=n[1]),SS(a=o*(s/2)*(u/2)).map(function(l){return 2*l})}return SS(a)}function RS(e){return e%2==0}function db(e,t){if(Wr(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||RS(n)&&RS(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&RS(e[0])&&RS(t[0])}function YX(e){if(TS==null){var t=zu(e);TS=t.getParameter(t.MAX_TEXTURE_SIZE)}return TS}function ZX(e){if(OS==null){var t=zu(e);OS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,OS)}function JX(e){if(e===0)return 0;var t=zu(e);return Do(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Do(t,"EXT_disjoint_timer_query")?1:0}function Do(e,t){return e.getExtension(t)!=null}function v3(e){try{if(zu(e)!=null)return!0}catch(t){return!1}return!1}function QX(e){if(e===0)return!1;var t=zu(e);if(e===1){if(!Do(t,"OES_texture_float"))return!1}else if(!Do(t,"EXT_color_buffer_float"))return!1;return y3(t)}function eY(e){if(e===0)return!1;var t=zu(e);if(e!==1){if(Do(t,"EXT_color_buffer_float"))return y3(t);if(Do(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var a=p3(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Do(t,"OES_texture_float")&&!!Do(t,"WEBGL_color_buffer_float")&&y3(t)}function y3(e){var t=p3(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function tY(e){return e===2&&zu(e).fenceSync!=null}var YMe=Object.freeze({callAndCheck:Qe,canBeRepresented:DX,getWebGLErrorMessage:RX,getExtensionOrThrow:ub,createVertexShader:FX,createFragmentShader:MX,createProgram:PX,linkProgram:$X,validateProgram:IS,createStaticVertexBuffer:LX,createStaticIndexBuffer:BX,getNumChannels:function(){return pe().getNumber("WEBGL_VERSION")===2?1:4},createTexture:zX,validateTextureSize:jX,createFramebuffer:UX,bindVertexBufferToProgramAttribute:g3,bindTextureUnit:WX,unbindTextureUnit:function(e,t,n){KX(e,n),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:VX,getProgramUniformLocation:qX,bindTextureToProgramUniformSampler:HX,bindCanvasToFramebuffer:function(e,t){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Qe(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),Qe(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:NS,unbindColorTextureFromFramebuffer:m3,validateFramebuffer:lb,getFramebufferErrorMessage:GX,getBatchDim:cb,getRowsCols:fb,getShapeAs3D:DS,getTextureShapeFromLogicalShape:XX,isReshapeFree:db,getWebGLMaxTextureSize:YX,resetMaxTextureSize:function(){TS=null},resetMaxTexturesInShader:function(){OS=null},getMaxTexturesInShader:ZX,getWebGLDisjointQueryTimerVersion:JX,hasExtension:Do,isWebGLVersionEnabled:v3,isCapableOfRenderingToFloatTexture:QX,isDownloadFloatTextureEnabled:eY,isWebGLFenceEnabled:tY}),At=pe();function ZMe(){pe().set("PROD",!0)}function JMe(){pe().set("DEBUG",!0)}function QMe(){pe().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function FS(e){pe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ePe(){J.disposeVariables()}function tPe(){return J}function MS(){return J.memory()}function nPe(e){return J.profile(e)}function le(e,t){return J.tidy(e,t)}function Ut(e){f3(e).forEach(function(t){return t.dispose()})}function ju(e){return J.keep(e)}function rPe(e){return J.time(e)}function iPe(e){return J.setBackend(e)}function aPe(){return J.ready()}function oPe(){return J.backendName}function sPe(e){J.removeBackend(e)}function uPe(e){return J.findBackend(e)}function lPe(e){return J.findBackendFactory(e)}function cPe(e,t,n){return n===void 0&&(n=1),J.registerBackend(e,t,n)}function nY(){return J.backend}function fPe(e,t){pe().setPlatform(e,t)}function PS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pe().getBool("IS_TEST")||console.warn.apply(console,e)}function Uu(e,t){var n=e;if(Di(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Di(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&pe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(a,o,s){if(s=s||[],!Array.isArray(a)&&!Di(a))return void U(o.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});U(o.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),U(a.length===o[0],function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+a.length+" elements"});for(var u=o.slice(1),l=0;l<a.length;++l)i(a[l],u,s.concat(l))}(e,r,[]),r}function rY(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function j(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Ht)return rY(r,e.dtype,t,n),e;var i=Am(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),rY(r,i,t,n),e==null||!Di(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=Uu(e,i);Di(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?e3(e,i,pe().getBool("DEBUG")):ic(e,[],!0);return J.makeTensor(s,o,i)}function hb(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,a){return j(i,t+"["+a+"]",n)},r)}function b3(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function iY(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function Ri(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(a){return e[a]})]}function ya(e,t){return iY(e,t.map(function(n){return 1}),t)}function eo(e,t,n){U(b3(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Ws(e,t){if(b3(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function $S(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Vs(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function aY(e,t){var n=e[0].length;e.forEach(function(i,a){U(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),U(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)U(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function Ph(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Q(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];J.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),J.endScope(s),s}catch(u){throw J.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}At.registerFlag("HAS_WEBGL",function(){return At.getNumber("WEBGL_VERSION")>0}),At.registerFlag("WEBGL_VERSION",function(){return v3(2)?2:v3(1)?1:0}),At.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return At.get("WEBGL_VERSION")===2}),At.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),At.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),At.registerFlag("WEBGL_PACK",function(){return At.getBool("HAS_WEBGL")}),At.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_CLIP",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),At.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_REDUCE",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_LAZILY_UNPACK",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_CONV_IM2COL",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return YX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return ZX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=At.getNumber("WEBGL_VERSION");return e===0?0:JX(e)}),At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return At.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),At.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return QX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!At.getBool("WEBGL_FORCE_F16_TEXTURES")&&At.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),At.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return eY(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return tY(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return At.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),kX=FS;var ii=Q({complex_:function(e,t){var n=j(e,"real","complex"),r=j(t,"imag","complex");return ln(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),J.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),to=Q({real_:function(e){var t=j(e,"input","real");return J.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),os=Q({imag_:function(e){var t=j(e,"input","imag");return J.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Mr(e,t,n){return Tf(e,t,Uu(e,n),n)}function Tf(e,t,n,r){if(r==null&&(r=Am(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Di(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){r3(t);var i=et(t),a=et(n);U(i===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a});for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==et(t.slice(o));U(n[o]===t[o]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Di(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?e3(e,r,pe().getBool("DEBUG")):ic(e,[],!0),J.makeTensor(e,t,r)}function Ve(e,t){if((Di(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Di(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Tf(e,[],[],t)}function ba(e,t){Dh(e);var n=Uu(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Tf(e,null,n,t)}function Wu(e,t,n){if(Dh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Uu(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Tf(e,t,r,n)}function LS(e,t,n){if(Dh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Uu(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function Of(e,t,n){if(Dh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Uu(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function oY(e,t,n){if(Dh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Uu(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function sY(e,t,n){if(Dh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Uu(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Tf(e,t=t||r,r,n)}function x3(e,t,n,r){return t===void 0&&(t=!0),J.makeVariable(e,t,n,r)}function Vu(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Vu(e,"float32"),r=Tn(e,"float32");return ii(n,r)}var i=n3(et(e),t);return J.makeTensor(i,e,t)}function Tn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Tn(e,"float32"),r=Tn(e,"float32");return ii(n,r)}var i=Cm(et(e),t);return J.makeTensor(i,e,t)}function Tm(e,t,n){return J.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function w3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return J.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Om(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Tn([0],r);var i=Cm(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return ba(i,r)}var Ro=Q({onesLike_:function(e){var t=j(e,"x","onesLike");if(t.dtype==="complex64"){var n=Ro(to(t)),r=en(os(t));return ii(n,r)}return J.runKernelFunc(function(i){return i.onesLike(t)},{x:t},function(i,a){return{x:function(){return en(i)}}},"OnesLike")}}),en=Q({zerosLike_:function(e){var t=j(e,"x","zerosLike");return J.runKernelFunc(function(n){return n.zerosLike(t)},{x:t},function(n,r){return{x:function(){return en(n)}}},"ZerosLike")}}),Hi=Q({concat_:function(e,t){t===void 0&&(t=0),U(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=hb(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Vr(t,n[0].shape)[0];var r=Ph(n.map(function(s){return s.shape}),t);if(et(r)===0)return Mr([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});aY(i,t);var a=n,o={axis:t};return J.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=i.map(function(l){return l[t]});return sc(s,u,t).map(function(l){return function(){return l}})},"Concat",o)}}),_3=Q({concat1d_:function(e){return Hi(e,0)}}),S3=Q({concat2d_:function(e,t){return Hi(e,t)}}),E3=Q({concat3d_:function(e,t){return Hi(e,t)}}),A3=Q({concat4d_:function(e,t){return Hi(e,t)}}),sc=Q({split_:function(e,t,n){n===void 0&&(n=0);var r,i=j(e,"x","split");return n=Vr(n,i.shape)[0],typeof t=="number"?(U(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(U(i.shape[n]===t.reduce(function(a,o){return a+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),J.runKernelFunc(function(a){return a.split(i,r,n)},{$x:i},function(a){return{$x:function(){return Hi(a,n)}}})}});function Ot(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",r3(e),new km(e,t,n)}function uY(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var BS=Q({batchToSpaceND_:function(e,t,n){var r=j(e,"x","batchToSpaceND"),i=t.reduce(function(a,o){return a*o});return U(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),U(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),U(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),J.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),zS=Q({cast_:function(e,t){var n=j(e,"x","cast");if(!bX(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return J.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),lY=Q({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=j(e,"x","cumsum"),a=Ws([t|=0],i.rank),o=i;a!=null&&(o=i.transpose(a));var s=Vs(1,i.rank)[0],u=J.runKernelFunc(function(l){return l.cumsum(o,s,n,r)},{permutedX:o},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),C3=Q({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=j(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return U(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),U(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),U(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),J.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Fo=Q({expandDims_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","expandDims",null);U(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(U(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),qs(n,r)}}),qs=Q({reshape_:function(e,t){var n=j(e,"x","reshape",null);t=vX(t,n.size),U(n.size===et(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return J.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),jS=Q({spaceToBatchND_:function(e,t,n){var r=j(e,"x","spaceToBatchND");return U(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),U(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),U(r.shape.reduce(function(i,a,o){return o>0&&o<=t.length?i&&(a+n[o-1][0]+n[o-1][1])%t[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),J.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),pb=Q({squeeze_:function(e,t){var n=j(e,"x","squeeze");return qs(n,Af(n.shape,t).newShape)}}),ss=Q({stack_:function(e,t){t===void 0&&(t=0);var n=hb(e,"tensors","stack");if(U(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;U(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){ln(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){U(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(s){return s.expandDims(t)});return Hi(o,t)}}),If=Q({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=j(e,"x","unstack");U(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return J.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return ss(i,t)}}},"Unpack",r)}}),k3=function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return n=j(e,"x","setdiff1d"),r=j(t,"y","setdiff1d"),U(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),U(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),U(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(a=d.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(u=new km([s],n.dtype),l=new km([s],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function US(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function WS(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function VS(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function cY(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function fY(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var T3="Add",dPe="AddN",gb="Div",hPe="FusedBatchNorm",mb="SquaredDifference",pPe="Square",gPe="Transpose",mPe="NonMaxSuppressionV5",O3="BroadcastTo",I3="OneHot",N3="Identity",D3="Tile",R3="PadV2",vPe="FromPixels",yPe="MaxPoolWithArgmax",Wt=Q({add_:function(e,t){var n,r=j(e,"a","add"),i=j(t,"b","add");n=fr(r,i),r=n[0],i=n[1];var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.add(r,i);return s([r,i]),u},a,null,T3)}});function uc(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function qr(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function Qt(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}var Nf=Q({abs_:function(e){var t=j(e,"x","abs");return t.dtype==="complex64"?J.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):J.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),F3=Q({acos_:function(e){var t=j(e,"x","acos");return J.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),M3=Q({acosh_:function(e){var t=j(e,"x","acosh");return J.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),P3=Q({asin_:function(e){var t=j(e,"x","asin");return J.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt())}}})}}),$3=Q({asinh_:function(e){var t=j(e,"x","asinh");return J.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).add(i.toFloat().square()).sqrt())}}})}}),L3=Q({atan_:function(e){var t=j(e,"x","atan");return J.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),B3=Q({atanh_:function(e){var t=j(e,"x","atanh");return J.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(Ve(1).sub(i.toFloat().square()))}}})}}),z3=Q({ceil_:function(e){var t=j(e,"x","ceil");return J.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),xa=Q({clipByValue_:function(e,t,n){var r=j(e,"x","clipByValue");U(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],a={min:t,max:n};return J.runKernelFunc(function(o,s){var u=o.clip(r,t,n);return s([r]),u},{x:r},function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),en(o))}}},"ClipByValue",a,i)}}),j3=Q({cos_:function(e){var t=j(e,"x","cos"),n=[t];return J.runKernelFunc(function(r,i){var a=r.cos(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),U3=Q({cosh_:function(e){var t=j(e,"x","cosh");return J.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),W3=Q({erf_:function(e){var t=j(e,"x","erf");return U(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),J.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),V3=Q({exp_:function(e){var t=j(e,"x","exp");return J.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),q3=Q({expm1_:function(e){var t=j(e,"x","expm1");return J.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),qS=Q({floor_:function(e){var t=j(e,"x","floor");return J.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),lc=Q({log_:function(e){var t=j(e,"x","log"),n=[t];return J.runKernelFunc(function(r,i){var a=r.log(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),H3=Q({log1p_:function(e){var t=j(e,"x","log1p");return J.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),dY=Q({logSigmoid_:function(e){var t=j(e,"x","logSigmoid");return J.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),Df=Q({neg_:function(e){var t=j(e,"x","neg"),n=[t];return J.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),G3=Q({reciprocal_:function(e){var t=j(e,"x","reciprocal");return J.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),K3=Q({round_:function(e){var t=j(e,"x","round");return J.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),HS=Q({rsqrt_:function(e){var t=j(e,"x","rsqrt"),n=[t];return J.runKernelFunc(function(r,i){var a=r.rsqrt(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),GS=Q({sigmoid_:function(e){var t=j(e,"x","sigmoid");return J.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(Ve(1).sub(i)))}}},"Sigmoid")}}),X3=Q({sign_:function(e){var t=j(e,"x","sign");return J.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),hY=Q({isNaN_:function(e){var t=j(e,"x","isNaN");return J.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),pY=Q({isInf_:function(e){var t=j(e,"x","isInf");return J.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),gY=Q({isFinite_:function(e){var t=j(e,"x","isFinite");return J.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),Y3=Q({sin_:function(e){var t=j(e,"x","sin"),n=[t];return J.runKernelFunc(function(r,i){var a=r.sin(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),Z3=Q({sinh_:function(e){var t=j(e,"x","sinh");return J.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),vb=Q({softplus_:function(e){var t=j(e,"x","softplus");return J.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),yb=Q({sqrt_:function(e){var t=j(e,"x","sqrt");return J.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),mY=Q({step_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","step");return J.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return en(r)}}})}}),J3=Q({tan_:function(e){var t=j(e,"x","tan");return J.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),KS=Q({tanh_:function(e){var t=j(e,"x","tanh");return J.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return Ve(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}}),vY=Q({addStrict_:function(e,t){var n=j(e,"a","addStrict"),r=j(t,"b","addStrict");return ln(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Q3=Q({atan2_:function(e,t){var n,r=j(e,"a","atan2"),i=j(t,"b","atan2");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Wt(u.square(),l.square()),f=o.mul(l.div(c)),d=qr(u.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Wt(u.square(),l.square()),f=Df(o.mul(u.div(c))),d=qr(l.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),yY=Q({divStrict_:function(e,t){var n=j(e,"a","div"),r=j(t,"b","div");return ln(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),XS=Q({floorDiv_:function(e,t){var n,r=j(e,"a","floorDiv"),i=j(t,"b","floorDiv");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.div(l.toFloat()),f=qr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=qr(l.shape,a);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),qu=Q({maximum_:function(e,t){var n,r=j(e,"a","maximum"),i=j(t,"b","maximum");return n=fr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.maximum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),bY=Q({maximumStrict_:function(e,t){var n=j(e,"a","maximumStrict"),r=j(t,"b","maximumStrict");return ln(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Im=Q({minimum_:function(e,t){var n,r=j(e,"a","minimum"),i=j(t,"b","minimum");return n=fr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.minimum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),xY=Q({minimumStrict_:function(e,t){var n=j(e,"a","minimumStrict"),r=j(t,"b","minimumStrict");return ln(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),eM=Q({mod_:function(e,t){var n,r=j(e,"a","mod"),i=j(t,"b","mod");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=qr(u.shape,a);return c.length>0?o.sum(c).reshape(u.shape):o},$b:function(){var c=o.mul(u.div(l).floor().neg()),f=qr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),wY=Q({modStrict_:function(e,t){var n=j(e,"a","modStrict"),r=j(t,"b","modStrict");return ln(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),rt=Q({mul_:function(e,t){var n,r=j(e,"a","mul"),i=j(t,"b","mul");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.mul(l.toFloat()),f=qr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=qr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),YS=Q({mulStrict_:function(e,t){var n=j(e,"a","mul"),r=j(t,"b","mul");return ln(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Nm=Q({pow_:function(e,t){var n,r=j(e,"base","pow"),i=j(t,"exp","pow");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape),o=[r,i];return J.runKernelFunc(function(s,u){var l=s.pow(r,i);return u([r,i,l]),l},{a:r,b:i},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(Ve(1))))),p=qr(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,en(l)),p=s.mul(f.mul(h)),g=qr(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),_Y=Q({powStrict_:function(e,t){return ln(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),SY=Q({squaredDifferenceStrict_:function(e,t){var n=j(e,"a","squaredDifferenceStrict"),r=j(t,"b","squaredDifferenceStrict");return ln(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Cr=Q({sub_:function(e,t){var n,r=j(e,"a","sub"),i=j(t,"b","sub");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var s=o,u=qr(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=o,u=qr(i.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),EY=Q({subStrict_:function(e,t){var n=j(e,"a","subStrict"),r=j(t,"b","subStrict");return ln(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),kr=Q({div_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");if(n=fr(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return XS(r,i);var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.realDivide(r,i);return s([r,i]),u},a,null,gb,{})}});function tM(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var l=Qa(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var bPe=Object.freeze({prepareAndValidate:tM}),nM=30;function ZS(e){return e<=nM?e:ES(e,Math.floor(Math.sqrt(e)))}function AY(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}function CY(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}AY(n,t,e)}function bb(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:et(t.shape)/u,sliceSize:o,strides:Qa(n.slice(0,i)).concat([1]),outputSize:et(n)}}var xPe=Object.freeze({validateUpdateShape:AY,validateInput:CY,calculateShapes:bb});function kY(e,t,n){U(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),U(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){U(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},i=0;i<e.rank;++i)r(i)}function rM(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function JS(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function TY(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=_S(0,a,s-1)}function OY(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?_S(0,a,s):_S(-1,a,s-1)}function iM(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function aM(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}var wPe=Object.freeze({assertParamsValid:kY,maskToAxes:rM,computeOutShape:JS,startForAxis:TY,stopForAxis:OY,isSliceContinous:iM,computeFlatOffset:aM});function _Pe(e){return U(kf(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var r=j(t,"x","tf.grad",null),i=n!=null?j(n,"dy","tf.grad"):null;return J.tidy(function(){var a=J.gradients(function(){return e(r)},[r],i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),QS(s),s[0]})}}function SPe(e){return U(kf(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){U(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=hb(t,"args","tf.grads",null),i=n!=null?j(n,"dy","tf.grads"):null;return J.tidy(function(){var a=J.gradients(function(){return e.apply(void 0,r)},r,i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),QS(s),s})}}function EPe(e){return U(kf(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){U(t instanceof Ht,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=J.gradients(function(){return e(t)},[t],n),i=r.grads,a=r.value;return QS(i),{grad:i[0],value:a}}}function APe(e){return U(kf(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){U(Array.isArray(t)&&t.every(function(i){return i instanceof Ht}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=J.gradients(function(){return e.apply(void 0,t)},t,n);return n!=null&&ln(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),QS(r.grads),r}}function IY(e,t){U(kf(e),function(){return"The f passed in variableGrads(f) must be a function"}),U(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof ib}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],J.registeredVariables)t.push(J.registeredVariables[r]);var i=n?t.filter(function(c){return!c.trainable}):null,a=t.length;U((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var o=J.gradients(e,t,null,!0),s=o.value,u=o.grads;U(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),U(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function xb(e){return J.customGrad(e)}function QS(e){if(e.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var $h=Q({softmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return J.runKernelFunc(function(r,i){var a=r.softmax(n,t);return i([a]),a},{logits:n},function(r,i){var a=i[0],o=r.mul(a);return{logits:function(){return o.sub(o.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),eE=Q({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return xb(function(r,i){var a=r.max(t,!0),o=r.sub(a),s=o.toFloat().sub(o.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),cn=Q({transpose_:function(e,t){var n=j(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){U(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return J.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}}),oM=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),sM=function(){function e(){}return e.prototype.time=function(t){return fe("time")},e.prototype.read=function(t){return fe("read")},e.prototype.readSync=function(t){return fe("readSync")},e.prototype.numDataIds=function(){return fe("numDataIds")},e.prototype.disposeData=function(t){return fe("disposeData")},e.prototype.write=function(t,n,r){return fe("write")},e.prototype.move=function(t,n,r,i){return fe("move")},e.prototype.memory=function(){return fe("memory")},e.prototype.floatPrecision=function(){return fe("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return fe("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,fe("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return fe("slice")},e.prototype.stridedSlice=function(t,n,r,i){return fe("stridedSlice")},e.prototype.unstack=function(t,n){return fe("unstack")},e.prototype.reverse=function(t,n){return fe("reverse")},e.prototype.concat=function(t,n){return fe("concat")},e.prototype.neg=function(t){return fe("neg")},e.prototype.add=function(t,n){return fe("add")},e.prototype.addN=function(t){return fe("addN")},e.prototype.subtract=function(t,n){return fe("subtract")},e.prototype.multiply=function(t,n){return fe("multiply")},e.prototype.realDivide=function(t,n){return fe("realDivide")},e.prototype.floorDiv=function(t,n){return fe("floorDiv")},e.prototype.sum=function(t,n){return fe("sum")},e.prototype.prod=function(t,n){return fe("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return fe("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return fe("argMin")},e.prototype.argMax=function(t,n){return fe("argMax")},e.prototype.equal=function(t,n){return fe("equal")},e.prototype.notEqual=function(t,n){return fe("notEqual")},e.prototype.less=function(t,n){return fe("less")},e.prototype.lessEqual=function(t,n){return fe("lessEqual")},e.prototype.greater=function(t,n){return fe("greater")},e.prototype.greaterEqual=function(t,n){return fe("greaterEqual")},e.prototype.logicalNot=function(t){return fe("logicalNot")},e.prototype.logicalAnd=function(t,n){return fe("logicalAnd")},e.prototype.logicalOr=function(t,n){return fe("logicalOr")},e.prototype.where=function(t){return fe("where")},e.prototype.select=function(t,n,r){return fe("select")},e.prototype.topk=function(t,n,r){return fe("topk")},e.prototype.min=function(t,n){return fe("min")},e.prototype.minimum=function(t,n){return fe("minimum")},e.prototype.mod=function(t,n){return fe("mod")},e.prototype.max=function(t,n){return fe("max")},e.prototype.maximum=function(t,n){return fe("maximum")},e.prototype.all=function(t,n){return fe("all")},e.prototype.any=function(t,n){return fe("any")},e.prototype.squaredDifference=function(t,n){return fe("squaredDifference")},e.prototype.ceil=function(t){return fe("ceil")},e.prototype.floor=function(t){return fe("floor")},e.prototype.round=function(t){return fe("round")},e.prototype.sign=function(t){return fe("sign")},e.prototype.isNaN=function(t){return fe("isNaN")},e.prototype.isInf=function(t){return fe("isInf")},e.prototype.isFinite=function(t){return fe("isFinite")},e.prototype.pow=function(t,n){return fe("pow")},e.prototype.exp=function(t){return fe("exp")},e.prototype.expm1=function(t){return fe("expm1")},e.prototype.softmax=function(t,n){return fe("softmax")},e.prototype.log=function(t){return fe("log")},e.prototype.log1p=function(t){return fe("log1p")},e.prototype.sqrt=function(t){return fe("sqrt")},e.prototype.rsqrt=function(t){return fe("rsqrt")},e.prototype.square=function(t){return fe("square")},e.prototype.reciprocal=function(t){return fe("reciprocal")},e.prototype.relu=function(t){return fe("relu")},e.prototype.relu6=function(t){return fe("relu6")},e.prototype.prelu=function(t,n){return fe("prelu")},e.prototype.elu=function(t){return fe("elu")},e.prototype.eluDer=function(t,n){return fe("eluDer")},e.prototype.selu=function(t){return fe("selu")},e.prototype.int=function(t){return fe("int")},e.prototype.clip=function(t,n,r){return fe("clip")},e.prototype.abs=function(t){return fe("abs")},e.prototype.complexAbs=function(t){return fe("complexAbs")},e.prototype.sigmoid=function(t){return fe("sigmoid")},e.prototype.softplus=function(t){return fe("softplus")},e.prototype.sin=function(t){return fe("sin")},e.prototype.cos=function(t){return fe("cos")},e.prototype.tan=function(t){return fe("tan")},e.prototype.asin=function(t){return fe("asin")},e.prototype.acos=function(t){return fe("acos")},e.prototype.atan=function(t){return fe("atan")},e.prototype.atan2=function(t,n){return fe("atan2")},e.prototype.sinh=function(t){return fe("sinh")},e.prototype.cosh=function(t){return fe("cosh")},e.prototype.tanh=function(t){return fe("tanh")},e.prototype.asinh=function(t){return fe("asinh")},e.prototype.acosh=function(t){return fe("acosh")},e.prototype.atanh=function(t){return fe("atanh")},e.prototype.erf=function(t){return fe("erf")},e.prototype.step=function(t,n){return fe("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return fe("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return fe("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return fe("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return fe("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return fe("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return fe("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return fe("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return fe("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return fe("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return fe("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return fe("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return fe("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return fe("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return fe("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return fe("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return fe("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return fe("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return fe("reshape")},e.prototype.cast=function(t,n){return fe("cast")},e.prototype.tile=function(t,n){return fe("tile")},e.prototype.pad=function(t,n,r){return fe("pad")},e.prototype.transpose=function(t,n){return fe("transpose")},e.prototype.gather=function(t,n,r){return fe("gather")},e.prototype.gatherND=function(t,n){return fe("gatherND")},e.prototype.scatterND=function(t,n,r){return fe("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return fe("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return fe("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return fe("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return fe("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return fe("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return fe("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,a,o){return fe("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,a){return fe("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,a,o,s){return fe("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return fe("multinomial")},e.prototype.oneHot=function(t,n,r,i){return fe("oneHot")},e.prototype.cumsum=function(t,n,r,i){return fe("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,a){return fe("nonMaxSuppression")},e.prototype.fft=function(t){return fe("fft")},e.prototype.ifft=function(t){return fe("ifft")},e.prototype.complex=function(t,n){return fe("complex")},e.prototype.real=function(t){return fe("real")},e.prototype.imag=function(t){return fe("imag")},e.prototype.cropAndResize=function(t,n,r,i,a,o){return fe("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return fe("depthToSpace")},e.prototype.split=function(t,n,r){return fe("split")},e.prototype.sparseToDense=function(t,n,r,i){return fe("sparseToDense")},e.prototype.diag=function(t){return fe("diag")},e.prototype.fill=function(t,n,r){return fe("fill")},e.prototype.onesLike=function(t){return fe("onesLike")},e.prototype.zerosLike=function(t){return fe("zerosLike")},e.prototype.linspace=function(t,n,r){return fe("linspace")},e.prototype.dispose=function(){return fe("dispose")},e}();function fe(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Rf(e,t,n,r,i,a,o){o===void 0&&(o="channelsLast");var s,u=tE(t),l=u[0],c=u[1];if(o==="channelsLast")s=[l,c,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,c,e[1],e[1]]}return Ff(e,s,n,r,i,a,!1,o)}function wb(e,t,n,r,i,a,o){o===void 0&&(o="NDHWC");var s,u,l=lM(t),c=l[0],f=l[1],d=l[2];if(o==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return _b(e,s,n,r,i,!1,u,a)}function Ff(e,t,n,r,i,a,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],g=t[1],m=t[3],v=tE(n),y=v[0],b=v[1],x=tE(r),w=x[0],S=x[1],A=Dm(p,w),_=Dm(g,S),E=function(N,O,D,L,W,G,K,ee){var ce,he,Oe;if(typeof N=="number"){ce={top:N,bottom:N,left:N,right:N,type:N===0?"VALID":"NUMBER"};var Te=function(ae,Y,M,B,R){B==null&&(B=uM(ae,Y,M));var X=ae[0],ge=ae[1],xe=Sb((X-Y+2*B)/M+1,R);U(vr(xe),function(){return"The output # of rows ("+xe+") must be an integer. Change the stride and/or zero pad parameters"});var ze=Sb((ge-Y+2*B)/M+1,R);return U(vr(ze),function(){return"The output # of columns ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}),[xe,ze]}([O,D],G,L,N,ee);he=Te[0],Oe=Te[1]}else if(N==="same"){he=Math.ceil(O/L),Oe=Math.ceil(D/W);var Re=Math.max(0,(he-1)*L+G-O),me=Math.max(0,(Oe-1)*W+K-D),P=Math.floor(Re/2),F=Re-P,V=Math.floor(me/2);ce={top:P,bottom:F,left:V,right:me-V,type:"SAME"}}else{if(N!=="valid")throw Error("Unknown padding parameter: "+N);ce={top:0,bottom:0,left:0,right:0,type:"VALID"},he=Math.ceil((O-G+1)/L),Oe=Math.ceil((D-K+1)/W)}return{padInfo:ce,outHeight:he,outWidth:Oe}}(i,c,f,y,b,A,_,a),C=E.padInfo,k=E.outHeight,T=E.outWidth,I=o?m*d:m;return s==="channelsFirst"?h=[l,I,k,T]:s==="channelsLast"&&(h=[l,k,T,I]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:k,outWidth:T,outChannels:I,padInfo:C,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:A,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function _b(e,t,n,r,i,a,o,s){a===void 0&&(a=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(o==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],y=t[4],b=lM(n),x=b[0],w=b[1],S=b[2],A=lM(r),_=A[0],E=A[1],C=A[2],k=Dm(g,_),T=Dm(m,E),I=Dm(v,C),N=function(K,ee,ce,he,Oe,Te,Re,me,P,F,V){var ae,Y,M,B;if(typeof K=="number"){ae={top:K,bottom:K,left:K,right:K,front:K,back:K,type:K===0?"VALID":"NUMBER"};var R=function(Zt,mn,Hn,ni,tr,Dn){tr==null&&(tr=uM(Zt,mn,ni));var es=Zt[0],Ka=Zt[1],Ul=Zt[2],Os=Sb((es-mn+2*tr)/ni+1,Dn);U(vr(Os),function(){return"The output # of depths ("+Os+") must be an integer. Change the stride and/or zero pad parameters"});var Is=Sb((Ka-mn+2*tr)/ni+1,Dn);U(vr(Is),function(){return"The output # of rows ("+Is+") must be an integer. Change the stride and/or zero pad parameters"});var Wl=Sb((Ul-mn+2*tr)/ni+1,Dn);return U(vr(Wl),function(){return"The output # of columns ("+Wl+") must be an integer. Change the stride and/or zero pad parameters"}),[Os,Is,Wl,Hn]}([ee,ce,he,1],me,1,Oe,K,V);Y=R[0],M=R[1],B=R[2]}else if(K==="same"){Y=Math.ceil(ee/Oe),M=Math.ceil(ce/Te),B=Math.ceil(he/Re);var X=(Y-1)*Oe+me-ee,ge=(M-1)*Te+P-ce,xe=(B-1)*Re+F-he,ze=Math.floor(X/2),Ke=X-ze,Ze=Math.floor(ge/2),Bt=ge-Ze,Je=Math.floor(xe/2);ae={top:Ze,bottom:Bt,left:Je,right:xe-Je,front:ze,back:Ke,type:"SAME"}}else{if(K!=="valid")throw Error("Unknown padding parameter: "+K);ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Y=Math.ceil((ee-me+1)/Oe),M=Math.ceil((ce-P+1)/Te),B=Math.ceil((he-F+1)/Re)}return{padInfo:ae,outDepth:Y,outHeight:M,outWidth:B}}(i,c,f,d,x,w,S,k,T,I,s),O=N.padInfo,D=N.outDepth,L=N.outHeight,W=N.outWidth,G=a?y*h:y;return o==="channelsFirst"?p=[l,G,D,L,W]:o==="channelsLast"&&(p=[l,D,L,W,G]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:D,outHeight:L,outWidth:W,outChannels:G,padInfo:O,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:_,dilationHeight:E,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function uM(e,t,n,r){r===void 0&&(r=1);var i=Dm(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function tE(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function lM(e){return typeof e=="number"?[e,e,e]:e}function Dm(e,t){return t<=1?e:e+(e-1)*(t-1)}function Sb(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Lh(e){var t=tE(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Gi(e,t){return Lh(e)||Lh(t)}function nE(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function cM(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Tn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!xX(e.dtype,t))return J.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=Ve(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function rE(e,t){return J.makeTensorFromDataId(e.dataId,t,e.dtype)}function fM(e,t,n){var r=(t-e)/(n-1),i=Cm(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return ba(i,"float32")}var CPe=Object.freeze({castTensor:cM,reshapeTensor:rE,linspaceImpl:fM,upcastType:bi,axesAreInnerMostDims:b3,combineLocations:iY,computeOutAndReduceShapes:Ri,expandShapeToKeepDim:ya,assertAxesAreInnerMostDims:eo,getAxesPermutation:Ws,getUndoAxesPermutation:$S,getInnerMostAxes:Vs,getBroadcastDims:uc,getReductionAxes:qr,assertAndGetBroadcastShape:Qt,assertParamsConsistent:aY,computeOutShape:Ph,computePool2DInfo:Rf,computePool3DInfo:wb,computeConv2DInfo:Ff,computeConv3DInfo:_b,computeDefaultPad:uM,tupleValuesAreOne:Lh,eitherStridesOrDilationsAreOne:Gi,convertConv2DDataFormat:nE,PARALLELIZE_THRESHOLD:nM,computeOptimalWindowSize:ZS});function dM(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function NY(e,t){return{real:e[2*t],imag:e[2*t+1]}}function kPe(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function TPe(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function OPe(e,t,n){var r=function(a,o,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var g=c(l,u[h=f+(d-f>>>1)]);g>0?f=h+1:(d=h,p=!g)}return p?f:-f-1}(a,o,s||IPe)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function IPe(e,t){return e>t?1:e<t?-1:0}function hM(e,t,n,r,i){return DY(e,t,n,r,i,0).selectedIndices}function pM(e,t,n,r,i,a){var o=DY(e,t,n,r,i,a);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function DY(e,t,n,r,i,a,o,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>i}).sort(RY),l=a>0?-.5/a:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(h<i)break;for(var m=!1,v=c.length-1;v>=g;--v){var y=NPe(e,p,c[v]);if(y>=r){m=!0;break}if(d.score=d.score*DPe(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,m||(d.score===h?(c.push(p),f.push(d.score)):d.score>i&&OPe(u,d,RY))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:ba(c,"int32"),selectedScores:ba(f,"float32"),numValidOutputs:Ve(b,"int32")}}function NPe(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var g=Math.max(a,l),m=Math.max(o,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(h+p-b)}function DPe(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function RY(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function FY(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(a){i[n]=a;var o=e.slice(r,i);return r[n]+=a,o})}function MY(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=Ot(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function PY(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],l=Fh(n,s*r),c=Fh("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort(function(x,w){return w.value-x.value});var m=f*r,v=l.subarray(m,m+r),y=c.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,y[g]=p[g].index}var b=t.slice();return b[b.length-1]=r,[Mr(l,b,n),Mr(c,b,"int32")]}function gM(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=Ot(e,"int32"),a=Ot([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var RPe=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},FPe=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},MPe=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function $Y(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function no(e,t){return t===1?[e]:$Y(e,t)}function Ki(){var e,t,n,r,i,a,o,s,u,l;return pe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Bh(e,t,n){n===void 0&&(n="index");var r=Qa(t);return r.map(function(i,a){return"int "+e[a]+" = "+n+" / "+i+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+i:"index -= "+e[a]+" * "+i)+";"}).join("")}function mM(e){var t=Qa(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var LY=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function PPe(e,t,n,r){var i=[];e.forEach(function(h){var p=et(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var a,o,s=i.join(`
`),u=e.map(function(h){return function(p,g,m){m===void 0&&(m=!1);var v="";v+=m?BY(p):Rm(p);var y=p.shapeInfo.logicalShape,b=g.logicalShape;return y.length<=b.length&&(v+=m?function(x,w){var S,A=x.name,_=A.charAt(0).toUpperCase()+A.slice(1),E="get"+_+"AtOutCoords",C=x.shapeInfo.logicalShape.length,k=w.logicalShape.length,T=uc(x.shapeInfo.logicalShape,w.logicalShape),I=Jn(k),N=k-C,O=["x","y","z","w","u","v"];S=C===0?"":k<2&&T.length>=1?"coords = 0;":T.map(function(ce){return"coords."+O[ce+N]+" = 0;"}).join(`
`);var D="";D=k<2&&C>0?"coords":x.shapeInfo.logicalShape.map(function(ce,he){return"coords."+O[he+N]}).join(", ");var L="return outputValue;",W=et(x.shapeInfo.logicalShape)===1,G=et(w.logicalShape)===1;if(C!==1||W||G){if(W&&!G)L=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var K=C-2,ee=C-1;T.indexOf(K)>-1&&T.indexOf(ee)>-1?L="return vec4(outputValue.x);":T.indexOf(K)>-1?L="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(ee)>-1&&(L="return vec4(outputValue.xx, outputValue.zz);")}}else L=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+I+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+_+"("+D+`);
      `+L+`
    }
  `}(p,g):function(x,w){var S=x.name,A=S.charAt(0).toUpperCase()+S.slice(1),_="get"+A+"AtOutCoords",E=w.texShape,C=x.shapeInfo.texShape,k=x.shapeInfo.logicalShape.length,T=w.logicalShape.length;if(!x.shapeInfo.isUniform&&k===T&&x.shapeInfo.flatOffset==null&&Wr(C,E))return`
      float `+_+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var I,N=Jn(T),O=uc(x.shapeInfo.logicalShape,w.logicalShape),D=T-k,L=["x","y","z","w","u","v"];I=k===0?"":T<2&&O.length>=1?"coords = 0;":O.map(function(G){return"coords."+L[G+D]+" = 0;"}).join(`
`);var W="";return W=T<2&&k>0?"coords":x.shapeInfo.logicalShape.map(function(G,K){return"coords."+L[K+D]}).join(", "),`
    float `+_+`() {
      `+N+` coords = getOutputCoords();
      `+I+`
      return get`+A+"("+W+`);
    }
  `}(p,g)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Ki(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+$Pe+`
    `+LPe+`
    `+BPe+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(Wr(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var A=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+A+`);
      int c = imod(index, `+A+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=h,m=p,v=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(g[2]/2),b=y*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],A=Math.ceil(x[x.length-1]/2),_=A*Math.ceil(x[x.length-2]/2),E=_,C="",k="b, r, c",T=2;T<x.length-1;T++)E*=x[x.length-T-1],C=`
      int b`+T+" = index / "+E+`;
      index -= b`+T+" * "+E+`;
    `+C,k="b"+T+", "+k;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+C+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+A+`);
      int c = imod(index, `+A+`) * 2;

      return ivec`+x.length+"("+k+`);
    }
  `}(h,p)}var g,m,v,y,b}(t.logicalShape,l),o=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return Wr(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=p,m=Bh(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=Bh(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=Bh(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=Bh(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,m}(t.logicalShape,l),o=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=zPe),[d,f,o,s,a,u,n].join(`
`)}function Rm(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(o===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=zh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Fm(n)+`
      }
    `;var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(s===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=zh(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Wr(r,o)){var s=o[0],u=o[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Af(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=Mm(n,d);return`
      `+Rm(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+Pm(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Fm(n)+`
      }
    `;var p=o[0],g=o[1],m=zh(i);return g===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+p+", "+g+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],s=r[2],u=Af(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=Mm(n,f);return`
        `+Rm(d)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+Pm(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+Fm(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],g=h[1],m=n.shapeInfo.flatOffset;if(g===o&&m==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(g===s&&m==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=zh(i);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+g+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],s=r[2]*o,u=r[1]*s,l=Af(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=Mm(n,c);return`
      `+Rm(d)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+Pm(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+Fm(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=zh(i);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+m+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],s=r[3]*o,u=r[2]*s,l=r[1]*u,c=Af(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=Mm(n,f);return`
      `+Rm(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+Pm(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+Fm(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],v=g[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===o&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=zh(i);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Af(r),s=o.newShape,u=o.keptDims;if(s.length<r.length){var l=Mm(n,s);return`
      `+Rm(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+Pm(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Fm(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],y=m[1];if(y===p&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=zh(i);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function BY(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ki(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var a=i.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Ki();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],f=Ki();if(u!=null&&Wr(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),f=Mm(i,c);return`
        `+BY(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Pm(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(a[2]/2),g=p*Math.ceil(a[1]/2),m=Ki();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+g+", "+p+`, b, row, col);
      return `+m.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(i){for(var a=i.shapeInfo.logicalShape,o=a.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),g="int b, int row, int col",m="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<o-1;v++)g="int b"+v+", "+g,p*=a[o-v-1],m="b"+v+" * "+p+" + "+m;var y=Ki();return`
    vec4 `+u+"("+g+`) {
      int index = `+m+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var $Pe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,LPe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,BPe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,zPe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function zh(e){return"offset"+e}function Fm(e){var t=e.name,n=et(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Mm(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Pm(e,t){return t.map(function(n){return e[n]}).join(", ")}var jPe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,c=Jn(l),f=no("coords",l);if(a===1){var d=Jn(s=l+1);o=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,o=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],g=h.map(function(_){return"int "+_}),m=no("sourceLocR",s-1).concat("inIdx.r"),v=no("sourceLocG",s-1).concat("inIdx.g"),y=no("sourceLocB",s-1).concat("inIdx.b"),b=no("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",A=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+A+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},UPe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},WPe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+g+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},VPe=function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="0.0";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},qPe=function(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="vec4(0.0)";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},HPe="return areal * breal - aimag * bimag;",GPe="return areal * bimag + aimag * breal;",zY=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},vM="return a + b;",yM="return a - b;",jY="return a * b;",KPe=`
if (a == b) {
  return 1.0;
};
return a / b;`,UY="return (a < 0.) ? b * a : a;",Tr=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},XPe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,WY=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Hu=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qt(t,n);var i=this.outputShape.length,a="";if(r)if(i===0||et(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+Jn(i)+` coords = getOutputCoords();
        `,i===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=no("coords",i);a+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},YPe=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),ZPe=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),JPe=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},QPe=function(e){this.outputShape=[],this.outputShape=Ph(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},e$e=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ph(e,t);var n=this.outputShape,r=n.length,i=Jn(r),a=no("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(m,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=o[t],c=o.slice(-2),f=o.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+iE(o,l,h)+`),
            vec2(`+iE(c,l,h)+`));
        }`}var p=s.length,g=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+iE(o,l,g)+`),
          vec2(`+iE(c,l,g)+"));",this.userCode=`
      float getValue(`+o.map(function(m){return"int "+m})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function iE(e,t,n){var r=e.indexOf(t);return e.map(function(i,a){return a===r?i+" - "+n:i}).join()}var t$e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},n$e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},r$e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},i$e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},a$e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},o$e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},VY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,m=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},s$e=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+a+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},qY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+m+`
        setOutput(result);
      }
    `},HY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<h;v++)g+=`
          vec4 xTexelR`+m+"C"+2*v+` = vec4(0.);
          vec4 wR`+m+"C"+v+` = vec4(0.);
          vec4 xR`+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<p;y++){if(g+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+m+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+`.xy);
                } else {
                  xR`+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xR`+m+"C"+v+" = xTexelR"+m+"C"+v+`;
              `,v+1<h)){var b=s%2==0?ZF(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+`;
                `}}else v<h&&(g+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
              `,v+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+`.xy);
              `,v+1<h&&(g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
                `)),g+="}");v<h&&(g+=`
            vec4 wTexelR`+m+"C"+v+" = getW("+m+", "+v+`, d1, q);
            wR`+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+`.xz);
          `,v+1<h&&(g+=`
              vec4 wTexelR`+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+`, d1, q);
              wR`+m+"C"+(v+1)+` =
                vec4(wTexelR`+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<h;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},u$e=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[o-1+".0",s-1+".0"],p=h[0],g=h[1],m=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=x[0],S=x[1],A=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+A+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},l$e=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Jn(r)+` coords = getOutputCoords();
        int end = `+GY(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+GY(r,"coords")+` = idx;
          val += getX(`+function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function GY(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var c$e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ab.DENSE;var t=ob(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Bh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},f$e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ab.DENSE;var t=ob(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Bh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},d$e=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),h$e=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},p$e=function(e){this.variableNames=["A"],this.outTexUsage=Io.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+LY+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},g$e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Io.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+LY+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},m$e=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+mM(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},v$e=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+mM(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+s+`;
      }
    `},y$e="return real * expR - imag * expI;",b$e="return real * expI + imag * expR;",KY=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},x$e=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),w$e=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Jn(this.rank),a=function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},_$e=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Jn(t.length),i=Jn(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function XY(e,t){var n=Ki();return FX(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function YY(e,t){return LX(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ZY(e,t){return BX(e,t,new Uint16Array([0,1,2,2,1,3]))}function Eb(e,t,n,r,i,a,o){jX(n,r);var s=zX(e,t),u=e.TEXTURE_2D;return Qe(e,t,function(){return e.bindTexture(u,s)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function JY(e,t,n,r,i){var a=kS(n,r);return Eb(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function QY(e,t,n,r,i){var a=kS(n,r);return Eb(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function eZ(e,t,n,r,i){var a=kS(n,r);return Eb(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function tZ(e,t,n,r,i){var a=sb(n,r);return Eb(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function nZ(e,t,n,r,i){var a=sb(n,r);return Eb(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function rZ(e,t,n,r){return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),g3(e,t,n,"clipSpacePos",r,3,20,0)&&g3(e,t,n,"uv",r,2,20,12)}function iZ(e,t,n,r,i,a,o){var s,u,l;Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=o.internalFormatPackedFloat),s.set(a),Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function aZ(e,t,n,r){Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function oZ(e,t,n,r,i){var a=e.createBuffer();Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var o=16*n*r;return Qe(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function sZ(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function uZ(e,t,n,r,i){var a=kS(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function lZ(e,t,n,r,i,a,o,s){var u=e,l=new Float32Array(function(c,f){var d=sb(c,f);return d[0]*d[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function cZ(e,t,n,r){var i=new Float32Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var S$e=Object.freeze({createVertexShader:XY,createVertexBuffer:YY,createIndexBuffer:ZY,createFloat32MatrixTexture:JY,createFloat16MatrixTexture:QY,createUnsignedBytesMatrixTexture:eZ,createPackedMatrixTexture:tZ,createFloat16PackedMatrixTexture:nZ,bindVertexProgramAttributeStreams:rZ,uploadDenseMatrixToTexture:iZ,uploadPixelDataToTexture:aZ,createBufferFromOutputTexture:oZ,downloadFloat32MatrixFromBuffer:sZ,downloadByteEncodedFloatMatrixFromOutputTexture:uZ,downloadPackedMatrixFromBuffer:lZ,downloadMatrixFromPackedOutputTexture:cZ}),fZ=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=pe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,NX(n,t)):this.gl=zu(n);var r="WEBGL_color_buffer_float";if(pe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=ub(this.gl,this.debug,"OES_texture_float"),Do(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ub(this.gl,this.debug,"OES_texture_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Do(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ub(this.gl,this.debug,"EXT_color_buffer_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Do(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Do(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=YY(this.gl,this.debug),this.indexBuffer=ZY(this.gl,this.debug),this.framebuffer=UX(this.gl,this.debug),this.textureConfig=p3(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return pe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;Qe(n,this.debug,function(){return n.finish()}),Qe(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),Qe(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),JY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),QY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),eZ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),aZ(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),iZ(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),nZ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),tZ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(m3(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Qe(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return uZ(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,a,o){return lZ(this.gl,t,0,0,0,a,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return sZ(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=oZ(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(pe().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(o,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=o}else pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return cZ(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=MX(n,this.debug,t),i=XY(n,this.debug),a=PX(n,this.debug);return Qe(n,this.debug,function(){return n.attachShader(a,i)}),Qe(n,this.debug,function(){return n.attachShader(a,r)}),$X(n,this.debug,a),this.debug&&IS(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=rZ(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Qe(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&IS(this.gl,this.debug,this.program),Qe(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?VX(this.gl,this.debug,t,n):qX(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),HX(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=sb(n,r),a=i[0],o=i[1];this.setOutputMatrixTextureDriver(t,a,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&IS(this.gl,this.debug,this.program),lb(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Qe(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=ub(this.gl,this.debug,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){switch(r.label){case 0:return[4,JF(function(){return n.disposed||n.isQueryAvailable(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||JF(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),NS(this.gl,this.debug,t,this.framebuffer),this.debug&&lb(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(NS(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&lb(this.gl)):m3(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;NS(i,this.debug,t,this.framebuffer),this.debug&&lb(i),this.outputTexture=t,Qe(i,this.debug,function(){return i.viewport(0,0,n,r)}),Qe(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var a=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function dZ(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,a=t[r],o=a.shape;if(!Wr(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!Wr(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var E$e=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=i*r,g=Ki(),m=f==="channelsLast",v=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},A$e=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},C$e=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},k$e=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},T$e=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},O$e=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},bM=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),a===void 0&&(a=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+p+`

        setOutput(result);
      }
    `},I$e=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),N$e=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},D$e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=no("rc",t),r=Jn(t),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var g=0;g<=1;g++){for(var m=(p===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<f;v++)m=d[d.length-1-v]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},R$e=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,i=Jn(r),a=t.map(function(u){return u[0]}).join(","),o=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+a+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},F$e=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(m,v){return m[0]+e[v]+m[1]});for(var r=e.length,i=Jn(r),a=t.map(function(m){return m[0]}).join(","),o=t.map(function(m,v){return m[0]+e[v]}).join(","),s=no("rc",r),u=no("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,g=r===1?2:4;p<g;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+a+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Ab=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",g="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",v="0.0";if(p||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+s+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(r?i?g:m:"wR * "+f+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(a/4),x=a%4,w=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+w+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+w+`
          }
        }
        setOutput(`+y+`);
      }
    `}},xM=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+s+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = `+(r?i?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+h+" * "+p+` +
                      wR * `+p+" + wC")+`;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var w=4*Math.floor(a/4),S=a%4,A=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+s+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},M$e=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",s="min"):t==="max"&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},P$e=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Bh(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+mM(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},$$e=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},L$e=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},B$e=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},z$e=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},j$e=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},U$e=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,o){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(o)}).join(","),i=Jn(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},W$e=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=no("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Jn(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},hZ=function(e,t,n,r,i,a,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Jn(i.length),u=Jn(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},V$e=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},q$e=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var l=Jn(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},H$e=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Jn(this.rank),i="uniform int start["+this.rank+"];",a=function(o){if(o===1)return"sourceLoc";if(o<=6)return wM.slice(0,o).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,s){return"sourceLoc."+wM[s]+" = start["+s+"] + coords."+wM[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),wM=["x","y","z","w","u","v"],G$e=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Jn(this.rank),r=no("coords",this.rank),i=no("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+a+")",s=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),K$e=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Jn(n.length),a=Jn(n.length),o="";if(r===1)o="coords * strides + begin";else{var s=0;o=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},X$e=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,a=pZ(n,r),o=gZ(t,a,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),a===No.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===No.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===No.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===No.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===No.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var a=gZ(n,pZ(r,i),i);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[a],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function pZ(e,t){if(e===Io.UPLOAD)return No.PACKED_2X2_FLOAT32;if(e===Io.RENDER||e==null)return function(n){return pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?No.PACKED_2X2_FLOAT32:No.UNPACKED_FLOAT32:n?No.PACKED_2X2_FLOAT16:No.UNPACKED_FLOAT16}(t);if(e===Io.DOWNLOAD||e===Io.PIXELS)return No.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function gZ(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var Y$e=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Jn(this.rank),a=function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<o.length;c++)l.push("imod("+u[c]+", "+o[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},_M=1.7580993408473768,SM=1.0507009873554805,Pt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Hs="if (isnan(x)) return x;",Z$e="return x;",mZ="return abs(x);",vZ=Hs+`
  return (x < 0.0) ? 0.0 : x;
`,yZ=Hs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,bZ="return (x >= 0.0) ? x : (exp(x) - 1.0);",J$e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+_M+`;
  float scale = `+SM+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,xZ="return -x;",wZ="return ceil(x);",_Z="return floor(x);",SZ="return exp(x);",EZ="return exp(x) - 1.0;",Q$e=Hs+`
  return sin(x);
`,eLe=Hs+`
  return cos(x);
`,tLe=Hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,nLe=Hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,rLe=Hs+`
  return atan(x);
`,iLe=Hs+"return log(x + sqrt(x * x + 1.0));",aLe=Hs+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,oLe=Hs+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,aE="return x;",sLe="return x;",AZ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,CZ=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kZ=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Cb=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},uLe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=no("rc",t),r=Jn(t),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},oE={};function sE(e,t){if(t===void 0&&(t=!1),e==="linear")return t?sLe:Z$e;if(e==="relu")return t?AZ:vZ;if(e==="elu")return t?kZ:bZ;if(e==="relu6")return t?CZ:yZ;if(e==="prelu")return t?WY:UY;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var lLe=600,TZ=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!pe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=zu(pe().getNumber("WEBGL_VERSION"));i.binaryCache=((r=pe().getNumber("WEBGL_VERSION"))in oE||(oE[r]={}),oE[r]),i.gpgpu=new fZ(a),i.canvas=a.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new X$e(i.gpgpu),i.numMBBeforeWarning=pe().global.screen==null?1024:pe().global.screen.height*pe().global.screen.width*window.devicePixelRatio*lLe/1024/1024,i.texData=new oM(i,J),i}return js(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:i,values:n,usage:Io.UPLOAD}),a},t.prototype.move=function(n,r,i,a){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:a,values:r,usage:Io.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,a=r.dtype,o=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Cb(u,aE):new Pt(u,aE);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return i;var h,p,g=this.activeTimers!=null;return g&&(h=Us()),a==="complex64"?p=dM(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=Us()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_;return nt(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(C){return r.push(C)})];if(i=this.texData.get(n),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return f=void 0,f=c?new Cb(o,aE):new Pt(o,aE),d=this.runWebGLProgram(f,[{dataId:n,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&pe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&pe().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),m=this.texData.get(g.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(ob(o)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=E.sent(),b=y[0],x=y[1],v=dM(b,x),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(w=et(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),E.label=5;case 5:return g!=null&&this.disposeData(g.dataId),S=this.convertAndCacheOnCPU(n,v),A=this.pendingRead.get(n),this.pendingRead.delete(n),A.forEach(function(C){return C(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!DX(i))throw pe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.isPacked,u=et(a);if(pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(ob(a))).subarray(0,u);return this.disposeData(l.dataId),f}var d=pe().getBool("WEBGL_PACK")&&s===!0,h=d?DS(a):a,p=d?new g$e(h):new p$e(h),g=this.runWebGLProgram(p,[{shape:h,dtype:o,dataId:n}],"float32"),m=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l;return nt(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],a=!1,this.programTimersStack==null?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,n(),o=ic(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=ic(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=c.sent(),u.kernelMs=gX(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Us(),endMs:null}},t.prototype.endTimer=function(n){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Us(),n)},t.prototype.getQueryTime=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,a=r.dtype,o=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,a),this.textureManager.releaseTexture(i,o,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return pe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=J.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return i.texData.get(a.dataId).texture==null&&et(a.shape)<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(et(i)===0)return Mr([],i,n.dtype);var a=this.texData.get(n.dataId).isPacked,o=iM(n.shape,r,i);if(a||!o){var s=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new G$e(i):new H$e(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var a=this.texData.get(n.dataId),o=this.makeOutput(i,n.dtype),s=this.texData.get(o.dataId);Object.assign(s,a),s.shape=i,s.dtype=n.dtype;var u=aM(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},t.prototype.stridedSlice=function(n,r,i,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,a);var o=JS(r,i,a);if(o.some(function(u){return u===0}))return Mr([],o);var s=new K$e(r,a,o);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new W$e(n.shape,r):new U$e(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return to(h)}),a=n.map(function(h){return os(h)});return ii(this.concat(i,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>pe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),s=this.concat(n.slice(0,o),r),u=this.concat(n.slice(o),r);return this.concat([s,u],r)}if(pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new e$e(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Ph(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,et(h.shape.slice(r)))}),d=new QPe(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,xZ,n.dtype);var r=new Pt(n.shape,xZ);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,a){var o=i?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],l=n.shape[0];if((o===1||s===1)&&u>1e3){i&&(n=cn(n,[0,2,1])),a&&(r=cn(r,[0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=bi(n.dtype,r.dtype),p=new bM(n.shape,[l,o,s],i,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],d=r.shape[0],h=bi(r.dtype,i.dtype),p=s!=null,g=l!=null,m=u?sE(u,!0):null,v=new bM(r.shape,[d,c,f],a,o,p,m,g),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),a=this.texData.get(r.dataId),o=new zY(HPe,n.shape,r.shape),s=new zY(GPe,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(o,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,jY,n.dtype);var d=new Tr(jY,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){var u=[n,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(o!=null&&(c=o.shape,u.push(o)),pe().getBool("WEBGL_PACK_NORMALIZATION")){var f=new qPe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(f,u)}var d=new VPe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){var s=pe().getBool("WEBGL_PACK_NORMALIZATION")?new k$e(n.shape,r,i,a,o):new A$e(n.shape,r,i,a,o);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){var l=new C$e(r.shape,a,o,s,u);return this.compileAndRun(l,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(o){return eb(o)});return MY(Ot(n.shape,n.dtype,i),r)}var a=new Y$e(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,i){var a=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new F$e(n.shape,r,i):new R$e(n.shape,r,i);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var a=new w$e(n.shape,r.size,i);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){U(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,d){return f*d}),o=US(n.shape,r,a),s=WS(o.length,r.length),u=VS(n.shape,r,a),l=cY(i,r.length),c=fY(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){U(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=US(u.shape,r,a,!1),c=WS(l.length,r.length,!1),f=VS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.reduce=function(n,r,i){var a=n.shape[0],o=n.shape[1],s=ZS(o),u=new M$e({windowSize:s,inSize:o,batchSize:a},r),l=this.compileAndRun(u,[n],i);return l.shape[1]===1?l:this.reduce(l,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var a=n.shape[0],o=n.shape[1];i!=null&&(a=i.shape[0],o=i.shape[1]);var s=ZS(o),u=new MPe({windowSize:s,inSize:o,batchSize:a},r,i==null),l=[n];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var a=i!=null?i.shape:n.shape,o=ZS(a[a.length-1]),s=new jPe(a,o,r,i==null),u=i==null?[n]:[n,i],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){eo("sum",r,n.rank);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=CS(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=CS(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,i){var a=0,o=Ws([a],n.rank),s=n;o!=null&&(s=cn(n,o),a=Vs(1,n.rank)[0]);var u=function(h,p,g){for(var m=[],v=h.length,y=0;y<v;y++)y!==p?m.push(h[y]):m.push(g);return m}(s.shape,a,i),l=et([s.shape[a]]),c=s.as2D(-1,l),f=CS(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(u);return o!=null&&(d=cn(d,$S(o))),d},t.prototype.segOpCompute=function(n,r,i,a,o){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,g=!1;for(d<=nM?(p=d,g=!0):p=ES(d,Math.floor(Math.sqrt(d)));!g;)p>h||p===d?g=!0:p=ES(d,p+1);return p}(u,o),c=new V$e({windowSize:l,inSize:u,batchSize:s,numSegments:o},r),f=this.compileAndRun(c,[n,i],a);return f.shape[1]===o?f:(i=Om(0,o).tile([u/l]),this.segOpCompute(f,r,i,a,o))},t.prototype.argMinMaxReduce=function(n,r,i){var a=[r];if(eo("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,n.rank),!pe().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=Ri(n.shape,a),s=o[0],u=et(o[1]),l=n.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new l$e(n.shape,i,a);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Tr("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Tr("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Tr("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Tr("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Tr("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Tr("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Pt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Tr("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Tr("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var a=new q$e(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,i],bi(r.dtype,i.dtype))},t.prototype.where=function(n){PS("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return gM(n.shape,r)},t.prototype.topk=function(n,r,i){return PY(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){eo("min",r,n.rank);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Tr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Tr(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);eo("max",r,n.rank);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Tr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){eo("all",r,n.rank);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){eo("any",r,n.rank);var i=Ri(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.floorDiv=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Tr(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,vM);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=bi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,vM,i);var a=new Tr(vM,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var a=new Cb(n.shape,r);return this.compileAndRun(a,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,a,o){o===void 0&&(o=!1);var s=new Hu(i,n.shape,r.shape,o);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var a=this,o=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],g=a.makeComplexComponentTensorInfo(n,h),m=a.makeComplexComponentTensorInfo(r,p),v=new Tr(i,n.shape,r.shape);return a.compileAndRun(v,[g,m],bi(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>pe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([i,a])}var o=n.map(function(l){return l.dtype}).reduce(function(l,c){return bi(l,c)}),s=n.map(function(l){return l.shape}),u=pe().getBool("WEBGL_PACK")?new FPe(n[0].shape,s):new RPe(n[0].shape,s);return this.compileAndRun(u,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,yM);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=bi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,yM,n.dtype);var a=new Tr(yM,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.pow=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Tr(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=bi(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,wZ,n.dtype);var r=new Pt(n.shape,wZ);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,_Z,n.dtype);var r=new Pt(n.shape,_Z);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Pt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Pt(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Pt(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Pt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Pt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,SZ,n.dtype);var r=new Pt(n.shape,SZ);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,EZ,n.dtype);var r=new Pt(n.shape,EZ);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=Vr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return kr(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Pt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Pt(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Pt(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Pt(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Pt(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new Cb(n.shape,AZ):new Pt(n.shape,vZ),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new Cb(n.shape,CZ):new Pt(n.shape,yZ),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(WY,n.shape,r.shape):new Tr(UY,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,kZ,n.dtype);var r=new Pt(n.shape,bZ);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Tr("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new Pt(n.shape,J$e);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Pt(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var a,o=(a=pe().getBool("WEBGL_PACK_CLIP")?new ZPe(n.shape):new YPe(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(a,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,mZ,n.dtype);var r=new Pt(n.shape,mZ);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new JPe(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,a)},t.prototype.sigmoid=function(n){var r=new Pt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Pt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Pt(n.shape,Q$e);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Pt(n.shape,eLe);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Pt(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Pt(n.shape,tLe);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Pt(n.shape,nLe);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Pt(n.shape,rLe);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Tr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Pt(n.shape,iLe);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Pt(n.shape,aLe);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Pt(n.shape,oLe);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Pt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new Pt(n.shape,function(a){return a===void 0&&(a=0),Hs+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,a,o,s){var u=n.shape,l=this.texData.get(n.dataId),c=i.inChannels,f=u[0]*u[1]*u[2],d=i.outChannels,h=i.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(p||!pe().getBool("WEBGL_LAZILY_UNPACK")||!pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,m,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(db(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,i.inChannels,i.outChannels]),A=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),_=this.texData.get(A.dataId);return U(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,_.shape=i.outShape,J.makeTensorFromDataId(A.dataId,i.outShape,A.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,a,o,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,f=i.outWidth,d=i.outHeight,h=i.dataFormat==="channelsLast",p=u*l*c,g=d*f,m=[p,g],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new E$e(m,v.shape,i),x=this.compileAndRun(b,[v]).reshape([1,m[0],m[1]]),w=a!=null,S=s!=null,A=o?sE(o,!0):null,_=new bM(x.shape,[1,g,i.outChannels],!0,!1,w,A,S),E=[x,y];a&&E.push(a),S&&E.push(s);var C=this.compileAndRun(_,E);return h?C.reshape([1,d,f,i.outChannels]):C.reshape([1,i.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,a,o,s,u);if(pe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,a,o,s,u);var l=o!=null,c=u!=null,f=s?sE(s,!1):null,d=new VY(a,l,f,c),h=[r,i];return o&&h.push(o),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(pe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var a=new VY(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var a=new n$e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var a=new t$e(i);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,a=n.filter,o=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=u?sE(u,c):null,d=[i,a],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new HY(o,h,f,p),this.compileAndRun(r,d)):(r=new qY(o,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,i){var a;return pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(a=new HY(i),this.compileAndRun(a,[n,r])):(a=new qY(i),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var a=new o$e(i);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var a=new a$e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,i){var a=new s$e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var a=new i$e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var a=new r$e(i);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var i=new Ab(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new Ab(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,a){var o=new Ab(a,"max",!0),s=this.compileAndRun(o,[r]),u=new T$e(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,i){var a=new UPe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return cM(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var i=new xM(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var a=new WPe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new xM(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,a){var o=new xM(a,"max",!0),s=this.compileAndRun(o,[r]),u=new O$e(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!db(n.shape,r)&&(i.texture===null||!db(i.shape,r))){var a=this.packedReshape(n,r);return J.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return rE(n,r)},t.prototype.resizeBilinear=function(n,r,i,a){var o=pe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new B$e(n.shape,r,i,a):new L$e(n.shape,r,i,a);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var a=new $$e(n,r,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,a){var o=new j$e(n.shape,r,i,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var a=new z$e(n,r,i);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,i,a){var o=r?n:$h(n),s=o.shape[0],u=o.shape[1],l=new I$e(s,u,i),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[o],"int32",c)},t.prototype.oneHot=function(n,r,i,a){var o=new N$e(n.size,r,i,a);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new h$e(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return PS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),hM(n.dataSync(),r.dataSync(),i,a,o)},t.prototype.cropAndResize=function(n,r,i,a,o,s){var u=new u$e(n.shape,r.shape,a,o,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],o=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],l=o*r,c=s*r,f=u/(r*r),d=new d$e(i==="NHWC"?[a,l,c,f]:[a,f,l,c],r,i);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,i){return FY(n,r,i)},t.prototype.scatterND=function(n,r,i){var a=bb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=[c/u,u],d=n.reshape([s,o]),h=r.reshape([s,u]);if(c===0)return rE(Mr([]),i);var p=Ve(0),g=new hZ(s,o,d.rank,h.rank,l,f);return this.compileAndRun(g,[h,d,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,a){var o=bb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.strides,c=o.outputSize,f=new hZ(u,s,n.rank,r.rank,l,[c,1],!1);return this.compileAndRun(f,[r,n,a]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),a=new KY(y$e,n.shape,r),o=new KY(b$e,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(o,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=tM(n,r),s=o[0],u=o[1],l=o[2],c=o[3],f=r.reshape([u,a]),d=n.reshape([n.size/l,l]),h=new _$e(a,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||Am(r))==="string"){var a=Qy(i,et(n));return a.fill(r),J.makeTensor(a,n,i,this)}var o=new x$e(n,r),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return fM(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return J.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new uLe(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new D$e(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[cb(n.shape)].concat(fb(n.shape)),a={dtype:n.dtype,shape:i,dataId:n.dataId},o=[cb(r)].concat(fb(r)),s=new P$e(o,i),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),a=i.isPacked,o=i.shape,s=i.dtype,u=DS(o);return r=a?new f$e(u):new c$e(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,a,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(n.outputShape,i),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===ab.DENSE){var c=ob(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),et(u.shape)===0)return l.values=Fh(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&et(b.shape)<=pe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!db(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},g=function(b,x,w){var S="";x.concat(w).forEach(function(E){var C=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,k=E.isUniform?"uniform":E.texData.texShape;S+=E.shape+"_"+k+"_"+C});var A=b.userCode,_=b.constructor.name;return _+="_"+S+"_"+A}(n,d,p),m=this.getAndSaveBinary(g,function(){return function(b,x,w,S){var A=x.userCode,_=w.map(function(W,G){var K={logicalShape:W.shape,texShape:W.isUniform?null:W.texData.texShape,isUniform:W.isUniform,isPacked:!W.isUniform&&W.texData.isPacked,flatOffset:null};return W.texData!=null&&W.texData.slice!=null&&W.texData.slice.flatOffset>0&&(K.flatOffset=W.texData.slice.flatOffset),{name:x.variableNames[G],shapeInfo:K}}),E=_.map(function(W){return W.shapeInfo}),C={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},k=PPe(_,C,A,x.packedInputs),T=b.createProgram(k),I=null,N=b.getUniformLocation(T,"NAN",!1);pe().getNumber("WEBGL_VERSION")===1&&(I=b.getUniformLocation(T,"INFINITY",!1));for(var O={},D=0;D<x.variableNames.length;D++){var L=x.variableNames[D];O[L]=b.getUniformLocation(T,L,!1),O["offset"+L]=b.getUniformLocation(T,"offset"+L,!1)}return{program:x,source:k,webGLProgram:T,uniformLocations:O,inShapeInfos:E,outShapeInfo:C,infLoc:I,nanLoc:N}}(s.gpgpu,n,d,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,x,w,S,A){dZ(x.inShapeInfos,w),dZ([x.outShapeInfo],[S]);var _=S.texData.texture,E=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(_,E[0],E[1]):b.setOutputMatrixTexture(_,E[0],E[1]),b.setProgram(x.webGLProgram),pe().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(C,k){var T=x.program.variableNames[k],I=x.uniformLocations[T],N=x.uniformLocations["offset"+T];if(I!=null)if(C.isUniform)if(et(C.shape)<2)b.gl.uniform1f(I,C.uniformValues[0]);else{var O=C.uniformValues;O instanceof Float32Array||(O=new Float32Array(O)),b.gl.uniform1fv(I,O)}else C.texData.slice!=null&&N!=null&&b.gl.uniform1i(N,C.texData.slice.flatOffset),b.setInputMatrixTexture(C.texData.texture,I,k)}),A!=null&&A(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,m,d,p,a),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!pe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,a,o){o===void 0&&(o=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,a,o);return J.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(pe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=le(function(){if(!pe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=pe().getBool("DEBUG");pe().set("DEBUG",!1);var i=n.abs(Ve(1e-8)).dataSync()[0];if(pe().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=Us());var h=i.texShape;if(h==null&&(h=XX(a,c),i.texShape=h),s!=null){var p=DS(a),g=void 0,m=h[1],v=h[0],y=s instanceof Uint8Array;c?(m=(r=sb(h[0],h[1]))[0],v=r[1],g=new v$e(p,[v,m],y)):g=new m$e(p,[v,m],y);var b=this.makeTensorInfo([v,m],o);this.texData.get(b.dataId).usage=y?Io.PIXELS:Io.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,v,s);var x=this.runWebGLProgram(g,[b],o,null,!0),w=this.texData.get(x.dataId);i.texture=w.texture,i.texShape=w.texShape,i.isPacked=w.isPacked,i.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),i.values=null,d&&(this.uploadWaitMs+=Us()-f)}else{var S=this.acquireTexture(h,l,o,c);i.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),a=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),i.values},t.prototype.acquireTexture=function(n,r,i,a){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*QF(r)},t}(sM);IX()&&J.registerBackend("webgl",function(){return new TZ},2);function jh(e,t){return e(t={exports:{}},t.exports),t.exports}var cLe=jh(function(e){(function(t,n,r){function i(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new i(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,e,!1)}),fLe=jh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,e,!1)}),dLe=jh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,e,!1)}),hLe=jh(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,e,!1)}),pLe=jh(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,g,m=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(g=g+1640531527|0,h=(f=m[127&p]^=d+g)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=m[h+34&127],f=m[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,m[h]=d^f;l.w=g,l.X=m,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,e,!1)}),gLe=jh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,e,!1)}),Uh=jh(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(v,y,b){var x=[],w=g(function _(E,C){var k,T=[],I=typeof E;if(C&&I=="object")for(k in E)try{T.push(_(E[k],C-1))}catch(N){}return T.length?T:I=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,m(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(_)),m(_)}catch(k){var E=i.navigator,C=E&&E.plugins;return[+new Date,i,C,i.screen,m(t)]}}(),3),x),S=new h(x),A=function(){for(var _=S.g(o),E=u,C=0;_<l;)_=(_+C)*a,E*=a,C=S.g(1);for(;_>=c;)_/=2,E/=2,C>>>=1;return(_+C)/E};return A.int32=function(){return 0|S.g(4)},A.quick=function(){return S.g(4)/4294967296},A.double=A,g(m(S.S),t),(y.pass||b||function(_,E,C,k){return k&&(k.S&&p(k,S),_.state=function(){return p(S,{})}),C?(n[s]=_,E):_})(A,w,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,A=x.S=[];for(b||(v=[b++]);w<a;)A[w]=w++;for(w=0;w<a;w++)A[w]=A[S=f&S+v[w%b]+(y=A[w])],A[S]=y;(x.g=function(_){for(var E,C=0,k=x.i,T=x.j,I=x.S;_--;)E=I[k=f&k+1],C=C*a+I[f&(I[k]=I[T=f&T+E])+(I[T]=E)];return x.i=k,x.j=T,C})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function g(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return m(y)}function m(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,g(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(v){}}})([],Math)});Uh.alea=cLe,Uh.xor128=fLe,Uh.xorwow=dLe,Uh.xorshift7=hLe,Uh.xor4096=pLe,Uh.tychei=gLe;var uE=Uh.alea,EM=Q({addN_:function(e){U(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),U(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,a){return j(i,"tensors"+a,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!Wr(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return J.runKernelFunc(function(i,a){return i.addN(t)},r,null,"AddN")}});function lE(){FS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function OZ(e){return e.rank===0||e.rank===1?e.as4D(1,1,1,e.size):e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function IZ(e,t,n,r,i,a){a==null&&(a=.001);var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(l.rank===c.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),U(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),U(o==null||l.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f={x:u,scale:o,offset:s,mean:l,variance:c},d={varianceEpsilon:a};return J.runKernelFunc(function(h,p){var g=OZ(u),m=h.batchNormalization(g,cE(l),cE(c),a,cE(o),cE(s));return p([u,l,c,o]),m},f,null,"FusedBatchNorm",d).reshape(u.shape)}function cE(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var NZ=Q({batchNormalization_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),lE(),IZ(e,t,n,a,i,r)}}),Wh=Q({batchNorm_:IZ});function DZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),U(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Wh(u,l,c,s,o,a)}var RZ=Q({batchNormalization2d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),lE(),DZ(e,t,n,a,i,r)}}),AM=Q({batchNorm2d_:DZ});function FZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),U(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Wh(u,l,c,s,o,a)}var MZ=Q({batchNormalization3d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),lE(),FZ(e,t,n,a,i,r)}}),CM=Q({batchNorm3d_:FZ});function PZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),U(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),U(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Wh(u,l,c,s,o,a)}var $Z=Q({batchNormalization4d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),lE(),PZ(e,t,n,a,i,r)}}),kM=Q({batchNorm4d_:PZ}),TM=Q({broadcastTo_:function(e,t){var n=j(e,"broadcastTo","x"),r=n.shape;if(t.some(function(f){return!(f>0)||f%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(f,d){return f>1?d:-1}).filter(function(f){return f>=0});if(u.length===0)return n.clone();var l={x:n},c={shape:t,inputShape:a};return J.runKernelFunc(function(f){return f.tile(n,o)},l,function(f){return{x:function(){return f.sum(u,!0)}}},O3,c)}}),LZ=Q({clone_:function(e){var t=j(e,"x","clone",null);return J.runKernelFunc(function(){return J.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{x:t},null,N3)}}),Gu=Q({logicalAnd_:function(e,t){var n=j(e,"a","logicalAnd","bool"),r=j(t,"b","logicalAnd","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),OM=Q({logicalNot_:function(e){var t=j(e,"x","logicalNot","bool");return J.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),fE=Q({logicalOr_:function(e,t){var n=j(e,"a","logicalOr","bool"),r=j(t,"b","logicalOr","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),BZ=Q({logicalXor_:function(e,t){var n=j(e,"a","logicalXor","bool"),r=j(t,"b","logicalXor","bool");return Qt(n.shape,r.shape),fE(e,t).logicalAnd(Gu(e,t).logicalNot())}}),Gs=Q({where_:function(e,t,n){var r=j(t,"a","where"),i=j(n,"b","where"),a=j(e,"condition","where","bool");return ln(r.shape,i.shape,"Error in where: "),a.rank===1?U(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ln(a.shape,i.shape,"Error in where: "),J.runKernelFunc(function(o,s){var u=o.select(a,r,i);return s([a]),u},{$condition:a,$a:r,$b:i},function(o,s){var u=s[0];return{$condition:function(){return en(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}})}}),dE=function(e){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:return[4,(t=j(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=gM(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},hE=Q({divNoNan_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");r=(n=fr(r,i))[0],i=n[1];var a=kr(r,i),o=en(a),s=i.equal(o);return Gs(s,o,a)}}),cc=Q({tile_:function(e,t){var n=j(e,"x","tile",null);U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={x:n},a={reps:t};return J.runKernelFunc(function(o,s){var u=o.tile(n,t);return s([n]),u},i,null,D3,a,r)}}),pE=Q({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=Ot([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return cc(Fo(s,0),[n[0],1,1]);if(n.length===2)return cc(Fo(Fo(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return cc(Fo(Fo(Fo(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),IM=Q({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=j(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=o===1?i.as2D(1,-1):i,u=J.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return o===1?u.as1D():u}}),Vh=Q({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=j(e,"indices","oneHot","int32"),a=i.shape.concat([t]),o={indices:i=i.flatten()},s={depth:t,onValue:n,offValue:r};return J.runKernelFunc(function(u,l){return l([i]),u.oneHot(i,t,n,r)},o,null,I3,s).reshape(a)}}),Ku=Q({pad_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n},a={x:r};return J.runKernelFunc(function(o,s){return s([r]),o.pad(r,t,n)},a,null,R3,i)}}),zZ=Q({pad1d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Ku(e,[t],n)}}),jZ=Q({pad2d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),UZ=Q({pad3d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),WZ=Q({pad4d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),VZ=Q({rand_:function(e,t,n){var r=et(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return J.makeTensor(i,e,n)}}),mLe=.001,qZ=.1;function NM(){return J.backend.floatPrecision()===32?mLe:qZ}function DM(e,t,n){var r=!0;if((Di(e)||Di(t))&&(r=!1),Di(e)&&Di(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=Uu(e),s=Uu(t);if(!Wr(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=Di(e)?e:ic(e),l=Di(t)?t:ic(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function RM(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var vLe=Object.freeze({TEST_EPSILON_FLOAT16:qZ,expectArraysClose:function(e,t,n){return n==null&&(n=NM()),DM(e,t,function(r,i){return RM(r,i,n)})},testEpsilon:NM,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Cf(e)||Cf(e[0])||Cf(t)||Cf(t[0])?DM(e,n,function(r,i){return r==i}):DM(e,t,function(r,i){return RM(r,i,0)})},expectNumbersClose:function(e,t,n){if(n==null&&(n=NM()),!RM(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),FM=function(){function e(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=uE(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var a=void 0,o=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),yLe=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=uE(a.toString()),this.randn=new FM(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,a,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),bLe=function(){function e(t,n,r,i){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=uE(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),HZ=Q({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new yLe(t,n,r,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),MM=Q({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new FM(t,n,r,!1,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),qh=Q({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Ot(e,r),o=new bLe(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),gE=Q({square_:function(e){var t=j(e,"x","square"),n=[t];return J.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),mE=Q({squaredDifference_:function(e,t){var n,r=j(e,"a","squaredDifference"),i=j(t,"b","squaredDifference");n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return J.runKernelFunc(function(s,u){var l=s.squaredDifference(r,i);return u([r,i]),l},a,function(s,u){var l=u[0],c=u[1],f=Ve(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},mb,{},o,[])}}),kb=Q({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new FM(t,n,r,!0,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Hh=Q({equal_:function(e,t){var n,r=j(e,"a","equal"),i=j(t,"b","equal");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.equal(r,i)},{$a:r,$b:i})}}),GZ=Q({equalStrict_:function(e,t){var n=j(e,"a","equalStrict"),r=j(t,"b","equalStrict");return ln(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),$m=Q({greater_:function(e,t){var n,r=j(e,"a","greater"),i=j(t,"b","greater");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.greater(r,i)},{a:r,b:i},null,"Greater")}}),Tb=Q({greaterEqual_:function(e,t){var n,r=j(e,"a","greaterEqual"),i=j(t,"b","greaterEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.greaterEqual(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return en(s)},b:function(){return en(u)}}},"GreaterEqual")}}),KZ=Q({greaterEqualStrict_:function(e,t){var n=j(e,"a","greaterEqualStrict"),r=j(t,"b","greaterEqualStrict");return ln(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),XZ=Q({greaterStrict_:function(e,t){var n=j(e,"a","greaterStrict"),r=j(t,"b","greaterStrict");return ln(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),PM=Q({less_:function(e,t){var n,r=j(e,"a","less"),i=j(t,"b","less");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.less(r,i)},{a:r,b:i},null,"Less")}}),$M=Q({lessEqual_:function(e,t){var n,r=j(e,"a","lessEqual"),i=j(t,"b","lessEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.lessEqual(r,i);return o([r,i]),s},{a:r,b:i},null,"LessEqual")}}),YZ=Q({lessEqualStrict_:function(e,t){var n=j(e,"a","lessEqualStrict"),r=j(t,"b","lessEqualStrict");return ln(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),ZZ=Q({lessStrict_:function(e,t){var n=j(e,"a","lessStrict"),r=j(t,"b","lessStrict");return ln(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Lm=Q({notEqual_:function(e,t){var n,r=j(e,"a","notEqual"),i=j(t,"b","notEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),JZ=Q({notEqualStrict_:function(e,t){var n=j(e,"a","notEqualStrict"),r=j(t,"b","notEqualStrict");return ln(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function QZ(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function eJ(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Bm=Q({gather_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","gather"),i=j(t,"indices","gather","int32");n=Vr(n,r.shape)[0];var a=function(o,s,u){for(var l=o.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(o.shape[h]),f*=o.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<o.rank;h++)c.push(o.shape[h]),d*=o.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,i,n);return J.runKernelFunc(function(o,s){var u=o.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(o,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,g=QZ(0,d),m=QZ(d+1,d+1+p),v=eJ([f,[c],h]),y=o.reshape(v),b=u.reshape([c]),x=eJ([[d],g,m]),w=y.transpose(x),S=LM(w,b,r.shape[n]),A=$S(x);return S=S.transpose(A)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),LM=Q({unsortedSegmentSum_:function(e,t,n){var r=j(e,"x","unsortedSegmentSum"),i=j(t,"segmentIds","unsortedSegmentSum","int32");return U(vr(n),function(){return"numSegments must be of dtype int"}),J.runKernelFunc(function(a,o){var s=a.unsortedSegmentSum(r,i,n);return o([i]),s},{$x:r},function(a,o){var s=o[0];return{$x:function(){return function(u,l){for(var c=qu(l,en(l)),f=Bm(u,c),d=Tb(l,Ve(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Fo(d,p+1);d=Gu(d,Vu(f.shape,"bool"));var g=en(f);return Gs(d,f,g)}(a,s)}}})}}),tJ=function(e,t,n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g;return nt(this,function(m){switch(m.label){case 0:for(r=j(e,"tensor","boolMask"),i=j(t,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,U(o>0,function(){return"mask cannot be scalar"}),ln(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+o)),f=r.reshape(c),d=i.reshape([-1]),[4,dE(d)];case 1:return h=m.sent(),p=h.squeeze([1]),g=Bm(f,p,a),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,g]}})})};function nJ(e,t,n,r,i,a,o){a===void 0&&(a="NHWC"),U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),U(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),U(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),U(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],f=a==="NHWC"?u.shape[3]:u.shape[1];U(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),U(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&U(vr(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=nE(a),h=Ff(s,n.shape,r,1,i,o,!1,d),p=J.runKernelFunc(function(g,m){var v=g.conv2dDerInput(u,n,h);return m([n,u]),v},{dy4D:u,filter:n},function(g,m){var v=m[0],y=m[1];return{dy4D:function(){return Gh(g,v,r,i,a,1,o)},filter:function(){return zM(g,y,v.shape,r,i,a,o)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function BM(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function rJ(e,t,n,r,i){U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,o=t,s=!1;t.rank===4&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=o.shape[4];U(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),U(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),U(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),U(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),U(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=_b(a,n.shape,r,1,i),f=J.runKernelFunc(function(d){return d.conv3dDerInput(o,n,c)},{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var vE=Q({conv1d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NWC"),a===void 0&&(a=1);var s=j(e,"x","conv1d"),u=j(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),U(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),o!=null&&U(vr(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),U(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),U(Gi(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),U(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Gh(d,f,[1,n],r,"NHWC",[1,a],o);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Gh=Q({conv2d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]);var s=j(e,"x","conv2d"),u=j(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),o!=null&&U(vr(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),U(Gi(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var d=nE(i),h=Ff(l.shape,u.shape,n,a,r,o,!1,d),p=[u,l],g=J.runKernelFunc(function(m,v){var y=m.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(m,v){var y=v,b=y[0],x=y[1];return U(Lh(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return iJ(x.shape,m,b,n,r,i)},filter:function(){return zM(x,m,b.shape,n,r,i)}}},"Conv2D",h,p);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),yE=Q({conv3d_:function(e,t,n,r,i,a){i===void 0&&(i="NDHWC"),a===void 0&&(a=[1,1,1]);var o=j(e,"x","conv3d"),s=j(t,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),U(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),U(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),U(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),U(function(d,h){return BM(d)||BM(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),U(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=_b(u.shape,s.shape,n,a,r),f=J.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){U(BM(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],g=h[1];return{x:function(){return rJ(p.shape,d,g,n,r)},$filter:function(){return function(m,v,y,b,x){var w=m;m.rank===4&&(w=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),U(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),U(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),U(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),U(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),U(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var A=_b(w.shape,y,b,1,x);return J.runKernelFunc(function(_){return _.conv3dDerFilter(w,S,A)},{x5D:w,dy5D:S})}(p,d,g.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),zM=Q({conv2dDerFilter_:function(e,t,n,r,i,a,o){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),U(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),U(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),U(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];U(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),U(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),o!=null&&U(vr(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=nE(a),d=Ff(s.shape,n,r,1,i,o,!1,f);return J.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),iJ=Q({conv2dDerInput_:nJ}),zm=Q({depthwiseConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]);var s=j(e,"x","depthwiseConv2d"),u=j(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),U(Gi(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&U(vr(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=Ff(l.shape,u.shape,n,a,r,o,!0),d=[l,u],h=J.runKernelFunc(function(p,g){var m=p.depthwiseConv2D(l,u,f);return g([l,u]),m},{x:l,filter:u},function(p,g){U(Lh(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var m=g[0],v=g[1];return{x:function(){return aJ(m.shape,p,v,f)},filter:function(){return oJ(m,p,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),aJ=Q({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;t.rank===3&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=J.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),oJ=Q({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,a,r)},{x4D:i,dy4D:a})}}),jM=Q({separableConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC");var s=j(e,"x","separableConv2d"),u=j(t,"depthwiseFilter","separableConv2d"),l=j(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),U(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),U(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];U(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=zm(c,u,r,i,o,a),g=Gh(p,l,1,"valid",o);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),bE=Q({conv2dTranspose_:function(e,t,n,r,i,a){return nJ(n,j(e,"x","conv2dTranspose"),j(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),sJ=Q({conv3dTranspose_:function(e,t,n,r,i){return rJ(n,j(e,"x","conv3dTranspose"),j(t,"filter","conv3dTranspose"),r,i)}}),xE=Q({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=j(e,"a","matMul"),o=j(t,"b","matMul");i=fr(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=et(f),p=et(d);U(a.rank>=2&&o.rank>=2&&a.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."}),U(Wr(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."}),U(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=a.shape.slice(0,-2).concat([l,c]),m=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?o.as3D(p,c,u):o.as3D(p,u,c),y={transposeA:n,transposeB:r};return J.runKernelFunc(function(b,x){var w=b.batchMatMul(m,v,n,r);return x([m,v]),w},{a:m,b:v},function(b,x){var w=x,S=w[0],A=w[1];return n||r?!n&&r?{a:function(){return b.matMul(A,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return A.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return A.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(A,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(g)}}),uJ=Q({dot_:function(e,t){var n=j(e,"t1","dot"),r=j(t,"t2","dot");U(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return U(i===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),lJ=Q({outerProduct_:function(e,t){var n=j(e,"v1","outerProduct"),r=j(t,"v2","outerProduct");return U(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Xu=Q({reverse_:function(e,t){var n=j(e,"x","reverse");if(n.rank===0)return n.clone();var r=Vr(t,n.shape);return J.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),cJ=Q({reverse1d_:function(e){var t=j(e,"x","reverse");return U(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Xu(t,0)}}),fJ=Q({reverse2d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Xu(n,t)}}),dJ=Q({reverse3d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Xu(n,t)}}),hJ=Q({reverse4d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Xu(n,t)}});function pJ(e,t,n,r,i,a){var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),r==null&&(r=[1,1]),U(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),U(Gi(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&U(vr(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Rf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Wr(l.inShape,l.outShape))return o.clone();var c=[s],f=J.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,A){var _=j(m,"dy","maxPoolBackprop"),E=j(v,"input","maxPoolBackprop"),C=j(y,"output","maxPoolBackprop");U(E.rank===_.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+_.rank+")"}),w==null&&(w=[1,1]),U(Gi(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),U(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),U(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."}),A!=null&&U(vr(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+S+"."});var k=Rf(E.shape,b,x,w,S,A);return J.runKernelFunc(function(T){return T.maxPoolBackprop(_,E,C,k)},{$dy:_,$input:E})}(d,p,g,t,n,r,i)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function gJ(e,t,n,r,i,a){var o=j(e,"x","avgPool","float32");r==null&&(r=[1,1]),U(Gi(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&U(vr(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Rf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Wr(l.inShape,l.outShape))return o.clone();var c=J.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,g,m,v){var y=j(d,"dy","avgPoolBackprop"),b=j(h,"input","avgPoolBackprop");U(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),m==null&&(m=[1,1]),U(Gi(g,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),U(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),U(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var A=Rf(x.shape,p,g,m,v),_=J.runKernelFunc(function(E){return E.avgPoolBackprop(w,x,A)},{dy4D:w,input4D:x});return S?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var wE=Q({maxPool_:function(e,t,n,r,i){return pJ(e,t,n,1,r,i)}}),_E=Q({avgPool_:function(e,t,n,r,i){return gJ(e,t,n,1,r,i)}}),mJ=Q({pool_:function(e,t,n,r,i,a){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(Gi(a,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"});var l,c=Rf(s.shape,t,a,i,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(E,C){return E+(E-1)*(w[C]-1)}).map(function(E){return E-1}),A=S.map(function(E){return Math.floor(E/2)}),_=S.map(function(E,C){return E-A[C]});return S.map(function(E,C){return[A[C],_[C]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(x,w,S){var A=S.map(function(N){return N[0]}),_=S.map(function(N){return N[1]}),E=x.concat(A,_),C=w.map(function(N,O){return(N-E[O]%N)%N}),k=_.map(function(N,O){return N+C[O]}),T=w.map(function(N,O){return[A[O],k[O]]}),I=w.map(function(N,O){return[0,C[O]]});return[T,I]}([c.inHeight,c.inWidth],f,l),p=h[0],g=h[1],m=d?r:"valid",v=d?s:jS(s,f,p),y=(n==="avg"?function(){return gJ(v,t,a,1,m)}:function(){return pJ(v,t,a,1,m)})(),b=d?y:BS(y,f,g);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),SE=Q({maxPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(vr(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=wb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,A){var _=j(m,"dy","maxPool3dBackprop"),E=j(v,"input","maxPool3dBackprop"),C=j(y,"output","maxPool3dBackprop"),k=_,T=E,I=C,N=!1;E.rank===4&&(N=!0,k=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),I=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3])),U(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),U(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),U(I.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+I.rank+"."}),w==null&&(w=[1,1,1]),U(Gi(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),A!=null&&U(vr(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+S+"."});var O=wb(T.shape,b,x,w,S,A),D=J.runKernelFunc(function(L){return L.maxPool3dBackprop(k,T,I,O)},{dy5D:k,input5D:T});return N?D.as4D(D.shape[1],D.shape[2],D.shape[3],D.shape[4]):D}(d,p,g,t,n,o,r,i)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),EE=Q({avgPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(vr(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=wb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,g,m,v,y,b){var x=j(h,"dy","avgPool3dBackprop"),w=j(p,"input","avgPool3dBackprop"),S=x,A=w,_=!1;w.rank===4&&(_=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),A=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),U(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),U(A.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),v==null&&(v=[1,1,1]),U(Gi(m,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"}),b!=null&&U(vr(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=wb(A.shape,g,m,v,y,b),C=J.runKernelFunc(function(k){return k.avgPool3dBackprop(S,A,E)},{dy5D:S,input5D:A});return _?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}(d,u,t,n,o,r,i)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),UM=Q({maxPoolWithArgmax_:function(e,t,n,r,i){i===void 0&&(i=!1);var a=j(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=J.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Mo=Q({slice_:function(e,t,n){var r,i,a=j(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){U(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(U(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),kY(a,r,i);var o=a.shape,s={begin:r,size:i};return J.runKernelFunc(function(u){return u.slice(a,r,i)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return Ku(u,l)}}},"Slice",s)}}),Ob=Q({slice1d_:function(e,t,n){var r=j(e,"x","slice1d");return U(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,[t],[n])}}),AE=Q({slice2d_:function(e,t,n){var r=j(e,"x","slice2d");return U(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,t,n)}}),Ib=Q({slice3d_:function(e,t,n){var r=j(e,"x","slice3d");return U(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,t,n)}}),jm=Q({slice4d_:function(e,t,n){var r=j(e,"x","slice4d");return U(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,t,n)}});function vJ(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(ya(t.shape,r))),e.rank<n.rank&&(e=e.reshape(ya(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return i==null?a:a.transpose(i)}}}var CE=Q({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","all","bool"),i=Vr(t,r.shape),a=i,o=Ws(a,r.rank);o!=null&&(r=r.transpose(o),a=Vs(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Nb=Q({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","any","bool"),i=Vr(t,r.shape),a=i,o=Ws(a,r.rank);o!=null&&(r=r.transpose(o),a=Vs(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Db=Q({argMax_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMax");t==null&&(t=0);var r=Vr(t,n.shape),i=Ws(r,n.rank);i!=null&&(n=n.transpose(i),r=Vs(r.length,n.rank));var a={axis:r[0]},o=[n];return J.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return en(l)}}},"ArgMax",a,o)}}),WM=Q({argMin_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMin");t==null&&(t=0);var r=Vr(t,n.shape),i=Ws(r,n.rank);return i!=null&&(n=n.transpose(i),r=Vs(r.length,n.rank)),J.runKernelFunc(function(a,o){var s=a.argMin(n,r[0]);return o([n]),s},{$x:n},function(a,o){var s=o[0];return{$x:function(){return en(s)}}})}}),yJ=Q({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","logSumExp"),i=Vr(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Mf=Q({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","max"),i=r,a=Vr(t,r.shape),o=a,s=Ws(o,r.rank);s!=null&&(r=r.transpose(s),o=Vs(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.max(r,o);return d([i,h]),h},{x:r},function(f,d){return vJ(f,d[1],d[0],a,s)},"Max",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Pr=Q({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","mean"),i=Vr(t,r.shape),a=et(Ri(r.shape,i)[1]);return xb(function(o){var s=Ve(a);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=o.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(Vu(o.shape,"float32")).div(a)}}})(r)}}),kE=Q({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","min"),i=r,a=Vr(t,r.shape),o=a,s=Ws(o,r.rank);s!=null&&(r=r.transpose(s),o=Vs(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.min(r,o);return d([i,h]),h},{x:r},function(f,d){return vJ(f,d[1],d[0],a,s)},"Min",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Rb=Q({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Vr(t,(e=j(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=ya(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),Hr=Q({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Vr(t,r.shape);return xb(function(a){var o=Ws(i,a.rank),s=i,u=a;o!=null&&(u=a.transpose(o),s=Vs(s.length,a.rank));var l=function(h){var p=a.shape.slice();return i.forEach(function(g){p[g]=1}),h.reshape(p).mul(Vu(a.shape,"float32"))},c={axes:s},f=J.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=ya(f.shape,i);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),TE=Q({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Vr(t,r.shape),a=Ws(i,r.rank),o=i,s=r;a!=null&&(s=r.transpose(a),o=Vs(o.length,r.rank));var u=J.runKernelFunc(function(c){return c.prod(s,o)},{permutedX:s});if(n){var l=ya(u.shape,i);u=u.reshape(l)}return u}}),Um=Q({elu_:function(e){var t=j(e,"x","elu");return J.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return J.runKernelFunc(function(a){return a.eluDer(n,i)},{dy:n,y:i})}}})}}),OE=Q({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=j(e,"x","leakyRelu");return qu(Ve(t).mul(n),n)}}),Fb=Q({prelu_:function(e,t){var n=j(e,"x","prelu"),r=j(t,"alpha","prelu");return J.runKernelFunc(function(i,a){var o=i.prelu(n,r);return a([n,r]),o},{x:n,alpha:r},function(i,a){var o=a[0],s=a[1],u=o.greater(0);return{x:function(){return Gs(u,i,i.mul(s))},alpha:function(){var l=Gs(u,en(i),i.mul(o)),c=qr(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Pf=Q({relu_:function(e){var t=j(e,"x","relu");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),VM=Q({relu6_:function(e){var t=j(e,"x","relu6");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],a=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),IE=Q({selu_:function(e){var t=j(e,"x","selu");return J.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var a=i.greater(Ve(0)),o=Ve(_M),s=Ve(SM),u=n.mul(s),l=n.mul(o).mul(i.toFloat().exp());return Gs(a,u,l)}}})}}),qM=Q({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var a=j(e,"x","localResponseNormalization");U(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),U(vr(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=a,s=!1;a.rank===3&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=J.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(o,t,n,r,i);return c([o,f]),f},{x4D:o},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return J.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),HM=Q({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ve(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=j(e,"x","norm"),t,n),a=i.shape;if(r){var o=Vr(n,e.shape);a=ya(i.shape,o)}return i.reshape(a)}}),bJ=Q({basicLSTMCell_:function(e,t,n,r,i,a){var o=j(e,"forgetBias","basicLSTMCell"),s=j(t,"lstmKernel","basicLSTMCell"),u=j(n,"lstmBias","basicLSTMCell"),l=j(r,"data","basicLSTMCell"),c=j(i,"c","basicLSTMCell"),f=j(a,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,g=[h,p],m=d.slice([0,0],g),v=d.slice([0,p],g),y=d.slice([0,2*p],g),b=d.slice([0,3*p],g),x=m.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),xJ=Q({multiRNNCell_:function(e,t,n,r){for(var i=j(t,"data","multiRNNCell"),a=hb(n,"c","multiRNNCell"),o=hb(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),wJ=Q({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var a=j(e,"v","movingAverage"),o=j(t,"x","movingAverage"),s=j(n,"decay","movingAverage");TX(a,o),U(Wr(a.shape,o.shape),function(){return"Shape mismatch in v and x"});var u=Ve(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){U(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=j(r,"step","movingAverage");c=c.div(u.sub(Nm(s,f)))}return a.add(c)}}),GM=Q({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=j(e,"x","stridedSlice"),c=rM(s),f=l.shape.slice();c.forEach(function(m){t[m]=0,n[m]=1,f.splice(m,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=TY(i,t,r,l.shape,d),n[d]=OY(a,n,r,l.shape,d),r[d]=r[d]||1;var h=rM(u);h.forEach(function(m){n[m]=t[m]+1,r[m]=1});var p=JS(t,n,r),g=p.filter(function(m,v){return h.indexOf(v)===-1});return r.every(function(m){return m===1})?Mo(l,t,p).reshape(g):J.runKernelFunc(function(m){return m.stridedSlice(l,t,n,r)},{$x:l}).reshape(g)}}),KM=Q({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=j(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=J.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),XM=Q({scatterND_:function(e,t,n){var r=j(e,"indices","scatterND","int32"),i=j(t,"updates","scatterND");return CY(i,r,n),J.runKernelFunc(function(a){return a.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Mb=Q({fft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),Wm=Q({ifft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),Pb=Q({rfft_:function(e,t){U(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),o=e.shape.map(function(v){return v});o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Tn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=ii(n,u).as2D(i,r),c=Mb(l),f=Math.floor(r/2)+1,d=to(c),h=os(c),p=d.split([f,r-f],d.shape.length-1),g=h.split([f,r-f],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,ii(p[0],g[0]).reshape(m)}}),NE=Q({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=Wm(r);return to(i)}var a=[n,2*(t-1)],o=to(e).as2D(n,t),s=os(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(Ve(-1)),c=o.concat(u,1),f=s.concat(l,1);return r=ii(c,f).as2D(a[0],a[1]),i=Wm(r),to(i)}}),_J=Object.freeze({fft:Mb,ifft:Wm,rfft:Pb,irfft:NE}),DE=Q({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=j(e,"sparseIndices","sparseToDense","int32"),a=j(t,"sparseValues","sparseToDense"),o=j(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),J.runKernelFunc(function(s){return s.sparseToDense(i,a,n,o)},{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),YM=Q({gatherND_:function(e,t){var n=j(t,"indices","gatherND","int32"),r=j(e,"x","gatherND");return J.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),SJ=Q({diag_:function(e){var t=j(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return J.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),ZM=Q({dropout_:function(e,t,n,r){var i=j(e,"x","dropout");if(U(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),U(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Ht?i.clone():i;var a=function(u,l){if(l==null)return u.shape.slice();if(Wr(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(i,n),o=1-t,s=qh(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function EJ(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return ba(i,"float32")}var RE=Q({hannWindow_:function(e){return EJ(e,.5,.5)}}),JM=Q({hammingWindow_:function(e){return EJ(e,.54,.46)}}),FE=Q({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Mo(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Hi([Mo(e,a,t-s),Tm([s],i)]);o.push(u),a+=n}return o.length===0?Wu([],[0,t]):Hi(o).as2D(o.length,t)}}),QM=Q({stft_:function(e,t,n,r,i){var a;i===void 0&&(i=RE),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=FE(e,t,n),s=rt(o,i(t)),u=[],l=0;l<o.shape[0];l++)u.push(Pb(s.slice([l,0],[1,t]),r));return Hi(u)}}),AJ=Object.freeze({hannWindow:RE,hammingWindow:JM,frame:FE,stft:QM}),Fi,CJ=function(e,t,n){return n===void 0&&(n=1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m;return nt(this,function(v){switch(v.label){case 0:return r=j(e,"predictions","inTopK"),i=j(t,"targets","inTopK"),U(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),U(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),ln(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],U(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[o.length/a,a],c=u[1],f=Fh("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=o.subarray(h,h+c),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(y,b){return b.value-y.value}),f[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Mr(f,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Fi||(Fi={}));var xLe=Q({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Fi.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","absoluteDifference"),a=j(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=j(n,"weights","absoluteDifference")),ln(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return fc(s,o,r)}}),fc=Q({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Fi.SUM_BY_NONZERO_WEIGHTS);var r=j(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=j(t,"weights","computeWeightedLoss"));var a=i==null?r:r.mul(i);if(n===Fi.NONE)return a;if(n===Fi.SUM)return a.sum();if(n===Fi.MEAN){if(i==null)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(Ve(o)):s}if(n===Fi.SUM_BY_NONZERO_WEIGHTS){if(i==null)return a.sum().div(Ve(r.size));var u=i.mul(Vu(r.shape)).notEqual(Ve(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),wLe=Q({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=Fi.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","cosineDistance"),o=j(t,"predictions","cosineDistance"),s=null;r!=null&&(s=j(r,"weights","cosineDistance")),ln(a.shape,o.shape,"Error in cosineDistance: ");var u=Ve(1).sub(a.mul(o).sum(n,!0));return fc(u,s,i)}}),_Le=Q({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Fi.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","hingeLoss"),a=j(t,"predictions","hingeLoss"),o=null;n!=null&&(o=j(n,"weights","hingeLoss")),ln(i.shape,a.shape,"Error in hingeLoss: ");var s=Ve(1);i=Ve(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return fc(u,o,r)}}),SLe=Q({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=Fi.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","huberLoss"),o=j(t,"predictions","huberLoss"),s=null;n!=null&&(s=j(n,"weights","huberLoss")),ln(a.shape,o.shape,"Error in huberLoss: ");var u=Ve(r),l=o.sub(a).abs(),c=Im(l,u),f=l.sub(c),d=Ve(.5).mul(c.square()).add(u.mul(f));return fc(d,s,i)}}),ELe=Q({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Fi.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","logLoss"),o=j(t,"predictions","logLoss"),s=null;n!=null&&(s=j(n,"weights","logLoss")),ln(a.shape,o.shape,"Error in logLoss: ");var u=Ve(1),l=Ve(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return fc(c,s,i)}}),ALe=Q({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Fi.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","meanSquaredError"),a=j(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=j(n,"weights","meanSquaredError")),ln(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return fc(s,o,r)}}),CLe=Q({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Fi.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"multiClassLabels","sigmoidCrossEntropy"),o=j(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","sigmoidCrossEntropy")),ln(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=j(d,"labels","sigmoidCrossEntropyWithLogits"),g=j(h,"logits","sigmoidCrossEntropyWithLogits");ln(p.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=g.relu(),v=g.mul(p),y=g.abs().neg().exp().log1p();return m.sub(v).add(y)}(a,o);return fc(f,s,i)}}),kLe=Q({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Fi.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"onehotLabels","softmaxCrossEntropy"),o=j(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","softmaxCrossEntropy")),ln(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return xb(function(g,m,v){var y=m.logSumExp([p],!0),b=m.toFloat().sub(y);return v([g,b]),{value:b.mul(g).neg().sum([p]),gradFunc:function(x,w){var S=w[0],A=w[1],_=ya(x.shape,[p]);return[x.reshape(_).mul(S.toFloat().sub(A.exp())),x.reshape(_).mul(A.exp().sub(S.toFloat()))]}}})(d,h)}(a,o);return fc(f,s,i)}}),kJ=Object.freeze({get Reduction(){return Fi},absoluteDifference:xLe,computeWeightedLoss:fc,cosineDistance:wLe,hingeLoss:_Le,huberLoss:SLe,logLoss:ELe,meanSquaredError:ALe,sigmoidCrossEntropy:CLe,softmaxCrossEntropy:kLe});function TJ(e,t){return t===void 0&&(t=!1),J.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=pE(n),a=e.clone(),o=Wu([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(f){var d,h=a,p=s,g=i;d=J.tidy(function(){var m=a.slice([f,f],[n-f,1]),v=m.norm(),y=a.slice([f,f],[1,1]),b=Wu([[-1]]).where(y.greater(0),Wu([[1]])),x=y.sub(b.mul(v)),w=m.div(x);s=w.shape[0]===1?o.clone():o.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),A=a.slice([f,0],[n-f,r]),_=S.mul(s),E=s.transpose();if(f===0)a=A.sub(_.matMul(E.matMul(A)));else{var C=A.sub(_.matMul(E.matMul(A)));a=a.slice([0,0],[f,r]).concat(C,0)}var k=_.transpose(),T=i.slice([0,f],[n,i.shape[1]-f]);if(f===0)i=T.sub(T.matMul(s).matMul(k));else{var I=T.sub(T.matMul(s).matMul(k));i=i.slice([0,0],[n,f]).concat(I,1)}return[s,a,i]}),s=d[0],a=d[1],i=d[2],Ut([h,p,g])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}var TLe=Q({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=j(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=Om(0,o,1,"int32").reshape([-1,1]),l=Om(0,s,1,"int32"),c=Cr(u,l),f=Gu(c.lessEqual(Ve(+t,"int32")),c.greaterEqual(Ve(-n,"int32"))),d=Tn([o,s],r.dtype);return ss(If(r.reshape([-1,o,s])).map(function(h){return Gs(f,h,d)})).reshape(i)}}),OLe=Q({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,U(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){U(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=sc(e,e.shape[0],0).map(function(u){return pb(u,[0])});U(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],o=e,s=function(u){a.push(J.tidy(function(){var l=o[u];if(u>0)for(var c=0;c<u;++c){var f=Hr(a[c].mulStrict(l)).mul(a[c]);l=l.sub(f)}return l.div(HM(l,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?ss(a,0):a}}),ILe=Q({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return TJ(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,s){return o*s}),r=If(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(function(o){var s=TJ(o,t),u=s[0],l=s[1];i.push(u),a.push(l)}),[ss(i,0).reshape(e.shape),ss(a,0).reshape(e.shape)]}}),eP=Object.freeze({bandPart:TLe,gramSchmidt:OLe,qr:ILe});function ME(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);var o=e.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),U(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),U(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),U(t.rank===1,function(){return"scores must be a 1D tensor"}),U(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),U(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var NLe=Q({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeBilinear");U(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,o,s,n)},{x:i},function(l,c){return{x:function(){return J.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),DLe=Q({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeNearestNeighbor");U(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),U(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,o,s,n)},{batchImages:i},function(l,c){return{batchImages:function(){return J.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),RLe=Q({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var a=j(e,"boxes","nonMaxSuppression"),o=j(t,"scores","nonMaxSuppression"),s=ME(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return J.runKernelFunc(function(l){return l.nonMaxSuppression(a,o,n,r,i)},{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),FLe=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),tt(this,void 0,void 0,function(){var a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return a=j(e,"boxes","nonMaxSuppressionAsync"),o=j(t,"scores","nonMaxSuppressionAsync"),s=ME(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=hM(l,c,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,f]}})})},MLe=Q({nonMaxSuppressionWithScore_:function(e,t,n,r,i,a){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var o=j(e,"boxes","nonMaxSuppression"),s=j(t,"scores","nonMaxSuppression"),u=ME(o,s,n,r,i,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=J.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),PLe=function(e,t,n,r,i,a){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),tt(this,void 0,void 0,function(){var o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return o=j(e,"boxes","nonMaxSuppressionAsync"),s=j(t,"scores","nonMaxSuppressionAsync"),u=ME(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=pM(c,f,n,r,i,a),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},$Le=Q({cropAndResize_:function(e,t,n,r,i,a){var o=j(e,"image","cropAndResize"),s=j(t,"boxes","cropAndResize","float32"),u=j(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return U(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),U(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),U(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),U(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),U(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),U(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),J.runKernelFunc(function(c,f){return c.cropAndResize(o,s,u,r,i,a)},{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),$f=Object.freeze({resizeBilinear:NLe,resizeNearestNeighbor:DLe,nonMaxSuppression:RLe,nonMaxSuppressionAsync:FLe,nonMaxSuppressionWithScore:MLe,nonMaxSuppressionWithScoreAsync:PLe,cropAndResize:$Le}),tP=function(e,t){return!(e>0)||t==="linear"},nP=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},rP=function(e,t){var n=t,r=qr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},iP=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Pf(e);if(t==="elu")return Um(e);if(t==="relu6")return VM(e);if(t==="prelu")return Fb(e,n);throw new Error("Unknown fused activation "+t+".")},LLe=Q({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=i!==void 0&&i,o=e.transposeB,s=o!==void 0&&o,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(tP(J.state.gradientDepth,c)===!1){var d=xE(n,r,a,s);return u!=null&&(d=Wt(d,u)),iP(d,c,f)}var h=j(n,"a","fused matMul"),p=j(r,"b","fused matMul");t=fr(h,p),h=t[0],p=t[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),w=et(b),S=et(x);U(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),U(Wr(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),U(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var A,_,E=h.shape.slice(0,-2).concat([v,y]),C=a?h.as3D(w,g,v):h.as3D(w,v,g),k=s?p.as3D(S,y,m):p.as3D(S,m,y);u!=null&&Qt(E,(A=fr(A=j(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=j(f,"prelu weights","fused matMul"));var T={a:C,b:k};u!=null&&(T.bias=A),f!=null&&(T.preluActivationWeights=_);var I=[C,k];return J.runKernelFunc(function(N,O){var D=N.fusedBatchMatMul({a:C,b:k,transposeA:a,transposeB:s,bias:A,activation:c,preluActivationWeights:_});return O([C,k,D]),D},T,function(N,O){var D=O[0],L=O[1],W=O[2],G=nP(N,W,c),K={};return u!=null&&(K={bias:function(){return rP(A,G)}}),Object.assign(a||s?!a&&s?{a:function(){return G.matMul(L,!1,!1)},b:function(){return G.matMul(D,!0,!1)}}:a&&!s?{a:function(){return L.matMul(G,!1,!0)},b:function(){return D.matMul(G,!1,!1)}}:{a:function(){return L.matMul(G,!0,!0)},b:function(){return G.matMul(D,!0,!0)}}:{a:function(){return G.matMul(L,!1,!0)},b:function(){return D.matMul(G,!0,!1)}},K)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},I,[!0]).reshape(E)}}),BLe=Q({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",tP(J.state.gradientDepth,d)===!1){var p=Gh(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),iP(p,d,h)}var g=j(t,"x","conv2d"),m=j(n,"filter","conv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&U(vr(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),U(Gi(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),U(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,w=Ff(v.shape,m.shape,r,u,i,l);c!=null&&(b=fr(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused conv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var A=[m,v],_=J.runKernelFunc(function(E,C){var k=E.fusedConv2d({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return C([m,v,k]),k},S,function(E,C){var k=C,T=k[0],I=k[1],N=k[2],O=nP(E,N,d);U(Lh(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var D={};return c!=null&&(D={bias:function(){return rP(b,O)}}),Object.assign({x:function(){return iJ(I.shape,O,T,r,i)},filter:function(){return zM(I,O,T.shape,r,i)}},D)},"FusedConv2D",{convInfo:w,activation:d},A,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),zLe=Q({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(tP(J.state.gradientDepth,d)===!1){var p=zm(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),iP(p,d,h)}var g=j(t,"x","depthwiseConv2d"),m=j(n,"filter","depthwiseConv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),U(Gi(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&U(vr(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=Ff(v.shape,m.shape,r,u,i,l,!0);c!=null&&(b=fr(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var A=[m,v],_=J.runKernelFunc(function(E,C){var k=E.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return C([m,v,k]),k},S,function(E,C){U(Lh(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=C[0],T=C[1],I=C[2],N=nP(E,I,d),O={};return c!=null&&(O={bias:function(){return rP(b,N)}}),Object.assign({x:function(){return aJ(T.shape,N,k,w)},filter:function(){return oJ(T,N,k.shape,w)}},O)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},A,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Lf=Object.freeze({matMul:LLe,conv2d:BLe,depthwiseConv2d:zLe}),jLe=Object.freeze({image:$f,linalg:eP,losses:kJ,spectral:_J,fused:Lf,signal:AJ,add:Wt,addN:EM,batchNorm:Wh,batchNormalization:NZ,batchNorm2d:AM,batchNormalization2d:RZ,batchNorm3d:CM,batchNormalization3d:MZ,batchNorm4d:kM,batchNormalization4d:$Z,broadcastTo:TM,clone:LZ,div:kr,divNoNan:hE,eye:pE,multinomial:IM,oneHot:Vh,pad:Ku,pad1d:zZ,pad2d:jZ,pad3d:UZ,pad4d:WZ,rand:VZ,randomGamma:HZ,randomNormal:MM,randomUniform:qh,square:gE,squaredDifference:mE,tile:cc,truncatedNormal:kb,conv1d:vE,conv2d:Gh,conv3d:yE,depthwiseConv2d:zm,separableConv2d:jM,conv2dTranspose:bE,conv3dTranspose:sJ,op:Q,booleanMaskAsync:tJ,complex:ii,real:to,imag:os,concat:Hi,concat1d:_3,concat2d:S3,concat3d:E3,concat4d:A3,split:sc,matMul:xE,dot:uJ,outerProduct:lJ,reverse:Xu,reverse1d:cJ,reverse2d:fJ,reverse3d:dJ,reverse4d:hJ,maxPool:wE,avgPool:_E,pool:mJ,maxPool3d:SE,avgPool3d:EE,maxPoolWithArgmax:UM,slice:Mo,slice1d:Ob,slice2d:AE,slice3d:Ib,slice4d:jm,abs:Nf,acos:F3,acosh:M3,asin:P3,asinh:$3,atan:L3,atanh:B3,ceil:z3,clipByValue:xa,cos:j3,cosh:U3,erf:W3,exp:V3,expm1:q3,floor:qS,log:lc,log1p:H3,logSigmoid:dY,neg:Df,reciprocal:G3,round:K3,rsqrt:HS,sigmoid:GS,sign:X3,isNaN:hY,isInf:pY,isFinite:gY,sin:Y3,sinh:Z3,softplus:vb,sqrt:yb,step:mY,tan:J3,tanh:KS,all:CE,any:Nb,argMax:Db,argMin:WM,logSumExp:yJ,max:Mf,mean:Pr,min:kE,moments:Rb,sum:Hr,prod:TE,equal:Hh,equalStrict:GZ,greater:$m,greaterEqual:Tb,greaterEqualStrict:KZ,greaterStrict:XZ,less:PM,lessEqual:$M,lessEqualStrict:YZ,lessStrict:ZZ,notEqual:Lm,notEqualStrict:JZ,addStrict:vY,atan2:Q3,divStrict:yY,floorDiv:XS,maximum:qu,maximumStrict:bY,minimum:Im,minimumStrict:xY,mod:eM,modStrict:wY,mul:rt,mulStrict:YS,pow:Nm,powStrict:_Y,squaredDifferenceStrict:SY,sub:Cr,subStrict:EY,elu:Um,leakyRelu:OE,prelu:Fb,relu:Pf,relu6:VM,selu:IE,logicalAnd:Gu,logicalNot:OM,logicalOr:fE,logicalXor:BZ,where:Gs,whereAsync:dE,buffer:Ot,print:uY,batchToSpaceND:BS,cast:zS,cumsum:lY,depthToSpace:C3,expandDims:Fo,reshape:qs,spaceToBatchND:jS,squeeze:pb,stack:ss,unstack:If,setdiff1dAsync:k3,fill:Tm,linspace:w3,ones:Vu,range:Om,scalar:Ve,tensor:Mr,tensor1d:ba,tensor2d:Wu,tensor3d:LS,tensor4d:Of,tensor5d:oY,tensor6d:sY,variable:x3,zeros:Tn,onesLike:Ro,zerosLike:en,transpose:cn,softmax:$h,logSoftmax:eE,localResponseNormalization:qM,norm:HM,gather:Bm,unsortedSegmentSum:LM,basicLSTMCell:bJ,multiRNNCell:xJ,movingAverage:wJ,stridedSlice:GM,topk:KM,scatterND:XM,fft:Mb,ifft:Wm,rfft:Pb,irfft:NE,sparseToDense:DE,gatherND:YM,diag:SJ,dropout:ZM,hannWindow:RE,hammingWindow:JM,frame:FE,stft:QM,inTopKAsync:CJ});function ke(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&U(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function aP(e,t,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ot(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],x=0;x<i.batchSize;++x)for(var w=x*v,S=x*r[0],A=0;A<i.inChannels;++A)for(var _=0;_<i.outHeight;++_)for(var E=_*o-d,C=Math.max(0,E),k=Math.min(i.inHeight,c+E),T=w+_*y,I=0;I<i.outWidth;++I){for(var N=I*s-h,O=Math.max(0,N),D=Math.min(i.inWidth,f+N),L=p,W=0,G=0,K=C;K<k;K+=u){for(var ee=S+K*r[1],ce=O;ce<D;ce+=l){var he=e[ee+ce*r[2]+A];a==="max"&&he>L?L=he:a==="avg"&&(W+=he,G++)}if(isNaN(L))break}m[T+I*b+A]=a==="avg"?W/G:L}return g}function OJ(e,t,n,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);for(var o=Ot(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Ot(t,n,e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=l;for(var w=Math.min(r.inHeight,f+b),S=0;S<r.outWidth;++S){for(var A=S*u-p,_=A;_<0;)_+=c;for(var E=Math.min(r.inWidth,d+A),C=Number.NEGATIVE_INFINITY,k=-1,T=x;T<w;T+=l)for(var I=T-b,N=_;N<E;N+=c){var O=N-A,D=g.get(m,T,N,v);D>C&&(C=D,k=i?a?((m*r.inHeight+T)*r.inWidth+N)*r.inChannels+v:(T*r.inWidth+N)*r.inChannels+v:I*d+O)}o.set(k,m,y,S,v)}}return o}function oP(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var ULe=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new oM(n,J),n}return js(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,pe().get("IS_NODE")&&PS(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:i}),a},t.prototype.move=function(n,r,i,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,a=r.complexTensors;return i==="complex64"?dM(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(a){return eb(a)})}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ot(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var a=this.write(n,r,i);return J.makeTensorFromDataId(a,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return r=Us(),n(),[2,{kernelMs:Us()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(ke(n,"slice"),iM(n.shape,r,i)){var a=aM(r,n.strides),o=et(i);return Mr(this.readSync(n.dataId).subarray(a,a+o),i,n.dtype)}for(var s=Ot(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,a){ke(n,"stridedSlice");var o=JS(r,i,a);if(o.some(function(h){return h===0}))return Mr([],o);for(var s=Ot(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*a[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=Ot([n.size,n.size],n.dtype),a=i.values,o=0;o<r.length;o++)a[o*n.size+o]=r[o];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){ke(n,"reverse");for(var i=Ot(n.shape,n.dtype),a=this.bufferSync(n),o=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),i.set.apply(i,[a.get.apply(a,c)].concat(l))},s=0;s<i.size;s++)o(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return to(h)}),o=n.map(function(h){return os(h)});return ii(this.concat(a,r),this.concat(o,r))}var s=n.map(function(h){var p=et(h.shape.slice(r));return h.as2D(-1,p)}),u=Ph(s.map(function(h){return h.shape}),1),l=Ot(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(i.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),g=0,m=0;m<h.shape[0];++m)for(var v=m*u[1]+f,y=0;y<h.shape[1];++y)l[v+y]=p[g++];f+=h.shape[1]})}var d=Ph(n.map(function(h){return h.shape}),r);return Mr(l,d,n[0].dtype)},t.prototype.neg=function(n){return ke(n,"neg"),this.multiply(Ve(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i+o,imag:a+s}}):this.broadcastedBinaryOp(n,r,bi(n.dtype,r.dtype),function(i,a){return i+a})},t.prototype.addN=function(n){var r=this;ke(n,"addN");for(var i=n.map(function(c){return r.readSync(c.dataId)}),a=Ot(n[0].shape,n[0].dtype),o=a.values,s=0;s<n.length;s++)for(var u=i[s],l=0;l<o.length;l++)o[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var i=Vr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return kr(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i-o,imag:a-s}}):this.broadcastedBinaryOp(n,r,bi(n.dtype,r.dtype),function(i,a){return i-a})},t.prototype.pow=function(n,r){return ke([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.pow(i,a)})},t.prototype.batchMatMul=function(n,r,i,a){ke([n,r],"matMul");for(var o=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],g=d[2],m=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=m[0],y=m[1],b=m[2],x=s*u,w=Ot([l,s,u],n.dtype),S=w.values,A=this.blockSize,_=0;_<l;_++)for(var E=0;E<s;E+=A)for(var C=0;C<u;C+=A)for(var k=0;k<o;k+=A)for(var T=Math.min(E+A,s),I=Math.min(C+A,u),N=Math.min(k+A,o),O=E;O<T;O++)for(var D=C;D<I;D++){for(var L=0,W=k;W<N;W++)L+=c[_*h+O*p+W*g]*f[W*v+D*y+_*b];S[_*x+(O*u+D)]+=L}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,i,a,o);return s&&(c=this.add(c,s)),u&&(c=oP(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i*o-a*s,imag:i*s+a*o}}):this.broadcastedBinaryOp(n,r,bi(n.dtype,r.dtype),function(i,a){return i*a})},t.prototype.floorDiv=function(n,r){return ke([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,a){return Math.floor(i/a)})},t.prototype.sum=function(n,r){ke(n,"sum"),eo("sum",r,n.rank);for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,bi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){ke(n,"sum");for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,bi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){ke(n,"unsortedSegmentSum");for(var a=[],o=n.rank-r.rank,s=0;s<o;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ve(s,"int32"),l=Hh(u,r).asType("float32").mul(n).sum(0);a.push(l)}return ss(a)},t.prototype.argMin=function(n,r){ke(n,"argMin");var i=[r];eo("argMin",i,n.rank);for(var a=Ri(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v<p&&(p=v,g=m)}c[d]=g}return u},t.prototype.argMax=function(n,r){ke(n,"argMax");var i=[r];eo("argMax",i,n.rank);for(var a=Ri(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v>p&&(p=v,g=m)}c[d]=g}return u},t.prototype.cumsum=function(n,r,i,a){if(ke(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=bi(n.dtype,"int32"),s=Tn(n.shape,o),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=a?function(m,v){return m+c-v-1}:function(m,v){return m+v},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=i?0:l[p];else{var g=f(d,h-1);u[p]=i?l[g]+u[g]:l[p]+u[g]}}return s},t.prototype.equal=function(n,r){return ke([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i===a?1:0})},t.prototype.notEqual=function(n,r){return ke([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i!==a?1:0})},t.prototype.less=function(n,r){return ke([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<a?1:0})},t.prototype.lessEqual=function(n,r){return ke([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<=a?1:0})},t.prototype.greater=function(n,r){return ke([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>a?1:0})},t.prototype.greaterEqual=function(n,r){return ke([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>=a?1:0})},t.prototype.logicalNot=function(n){ke(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)i[a]=r[a]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return ke([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i&&a})},t.prototype.logicalOr=function(n,r){return ke([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i||a})},t.prototype.select=function(n,r,i){ke([n,r,i],"select");for(var a=this.readSync(n.dataId),o=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Tn(r.shape,bi(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:et(r.shape.slice(1)),d=0;d<a.length;d++)for(var h=0;h<f;h++)a[d]===1?l[c++]=o[d]:l[c++]=s[d];return u},t.prototype.where=function(n){ke([n],"where");var r=this.readSync(n.dataId);return gM(n.shape,r)},t.prototype.topk=function(n,r,i){return ke(n,"topk"),PY(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){ke(n,"min"),eo("min",r,n.rank);for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g<h&&(h=g)}l[f]=h}return s},t.prototype.minimum=function(n,r){return ke([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.min(i,a)})},t.prototype.mod=function(n,r){return ke([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i%a;return i<0&&a<0||i>=0&&a>=0?o:(o+a)%a})},t.prototype.max=function(n,r){ke(n,"max"),eo("max",r,n.rank);for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g>h&&(h=g)}l[f]=h}return s},t.prototype.maximum=function(n,r){return ke([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.max(i,a)})},t.prototype.all=function(n,r){ke(n,"all"),eo("all",r,n.rank);for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h&&g}l[f]=h}return s},t.prototype.any=function(n,r){ke(n,"any"),eo("any",r,n.rank);for(var i=Ri(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h||g}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return ke([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i-a;return o*o})},t.prototype.ceil=function(n){ke(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.ceil(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){ke(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.floor(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?i[a]=-1:r[a]>0?i[a]=1:i[a]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){ke(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=Math.floor(r[a]);r[a]-o<.5?i[a]=Math.floor(r[a]):r[a]-o>.5?i[a]=Math.ceil(r[a]):i[a]=o%2==0?o:o+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){ke(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.exp(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){ke(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.expm1(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){ke(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){ke(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log1p(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){ke(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){ke(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=1/Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){ke(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=1/r[a];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.max(0,a[o]);return r},t.prototype.relu6=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.min(Math.max(0,a[o]),6);return r},t.prototype.prelu=function(n,r){return ke([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return i<0?a*i:i})},t.prototype.elu=function(n){ke(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){ke([n,r],"eluDer");for(var i=new Float32Array(r.size),a=this.readSync(r.dataId),o=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){ke(n,"selu");for(var r=_M,i=SM,a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,i){ke(n,"clip");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>i?i:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.abs(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<n.size;++a){var o=i[2*a],s=i[2*a+1];r[a]=Math.hypot(o,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){ke(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=i[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){ke(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=1/(1+Math.exp(-i[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){ke(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o]>-r,u=a[o]<r,l=Math.exp(a[o]),c=void 0;c=u?l:s?a[o]:Math.log(1+l),i[o]=c}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){ke(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){ke(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){ke(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.tan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){ke(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){ke(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){ke(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return ke([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.atan2(i,a)})},t.prototype.sinh=function(n){ke(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){ke(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){ke(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=mX(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){ke(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){ke(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){ke(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atanh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){ke(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=Math.sign(i[a]),s=Math.abs(i[a]),u=1/(1+.3275911*s);r[a]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),ke(n,"step");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o];isNaN(s)?i[o]=NaN:i[o]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,i,a);return o&&(l=this.add(l,o)),s&&(l=oP(this,l,s,u)),l},t.prototype.conv2d=function(n,r,i){ke([n,r],"conv2d");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",d=Ot(i.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],g=f?n.strides[2]:1,m=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),A=d.values,_=0;_<i.batchSize;++_)for(var E=_*h,C=_*v,k=0;k<i.outHeight;++k)for(var T=C+k*y,I=k*i.strideHeight-c,N=0;N<a;N++){var O=I+N*s;if(!(O<0||O>=i.inHeight))for(var D=N*r.strides[0],L=E+O*p,W=0;W<i.outWidth;++W)for(var G=T+W*b,K=W*i.strideWidth-l,ee=0;ee<o;ee++){var ce=K+ee*u;if(!(ce<0||ce>=i.inWidth))for(var he=L+ce*g,Oe=D+ee*r.strides[1],Te=0;Te<i.inChannels;++Te){for(var Re=w[he+Te*m],me=0;me<i.outChannels;++me)A[G+me*x]+=Re*S[Oe+me];Oe+=i.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,i){for(var a=i.filterDepth,o=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,d=i.padInfo.left,h=i.padInfo.top,p=Ot(i.outShape,n.dtype),g=this.readSync(n.dataId),m=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],x=y*p.strides[0],w=0;w<i.outDepth;++w)for(var S=x+w*p.strides[1],A=w*i.strideDepth-f,_=0;_<a;_++){var E=A+_*u;if(!(E<0||E>=i.inDepth))for(var C=_*r.strides[0],k=b+E*n.strides[1],T=0;T<i.outHeight;++T)for(var I=S+T*p.strides[2],N=T*i.strideHeight-h,O=0;O<o;O++){var D=N+O*l;if(!(D<0||D>=i.inHeight))for(var L=C+O*r.strides[1],W=k+D*n.strides[2],G=0;G<i.outWidth;++G)for(var K=I+G*i.outChannels,ee=G*i.strideWidth-d,ce=0;ce<s;ce++){var he=ee+ce*c;if(!(he<0||he>=i.inWidth))for(var Oe=L+ce*r.strides[2],Te=W+he*i.inChannels,Re=Oe,me=0;me<i.inChannels;++me){for(var P=g[Te+me],F=0;F<i.outChannels;++F)v[K+F]+=P*m[Re+F];Re+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){ke([n,r],"conv2dDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=i.batchSize,p=i.filterHeight,g=i.filterWidth,m=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,x=i.outHeight,w=i.outWidth,S=i.strideHeight,A=i.strideWidth,_=i.dataFormat,E=p-1-i.padInfo.top,C=g-1-i.padInfo.left,k=_==="channelsLast",T=a.strides[0],I=k?a.strides[1]:a.strides[2],N=k?a.strides[2]:1,O=k?1:a.strides[1],D=n.strides[0],L=k?n.strides[1]:n.strides[2],W=k?n.strides[2]:1,G=k?1:n.strides[1],K=0;K<h;++K)for(var ee=0;ee<m;++ee)for(var ce=0;ce<v;++ce)for(var he=ce-E,Oe=Math.max(0,Math.ceil(he/S)),Te=Math.min(x,(p+he)/S),Re=0;Re<y;++Re){for(var me=Re-C,P=Math.max(0,Math.ceil(me/A)),F=Math.min(w,(g+me)/A),V=0,ae=Oe;ae<Te;++ae)for(var Y=ae*S-he,M=P;M<F;++M)for(var B=D*K+L*ae+W*M,R=c*(p-1-Y)+f*(g-1-(M*A-me))+d*ee,X=0;X<b;++X)V+=s[B+G*X]*u[R+X];o[T*K+I*ce+N*Re+O*ee]=V}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],A=b[3],_=i.batchSize,E=i.filterDepth,C=i.filterHeight,k=i.filterWidth,T=i.inChannels,I=i.inDepth,N=i.inHeight,O=i.inWidth,D=i.outChannels,L=i.outDepth,W=i.outHeight,G=i.outWidth,K=i.strideDepth,ee=i.strideHeight,ce=i.strideWidth,he=E-1-i.padInfo.front,Oe=C-1-i.padInfo.top,Te=k-1-i.padInfo.left,Re=0;Re<_;++Re)for(var me=0;me<T;++me)for(var P=0;P<I;++P)for(var F=P-he,V=Math.max(0,Math.ceil(F/K)),ae=Math.min(L,(E+F)/K),Y=0;Y<N;++Y)for(var M=Y-Oe,B=Math.max(0,Math.ceil(M/ee)),R=Math.min(W,(C+M)/ee),X=0;X<O;++X){for(var ge=X-Te,xe=Math.max(0,Math.ceil(ge/ce)),ze=Math.min(G,(k+ge)/ce),Ke=0,Ze=V;Ze<ae;++Ze)for(var Bt=Ze*K-F,Je=B;Je<R;++Je)for(var Zt=Je*ee-M,mn=xe;mn<ze;++mn)for(var Hn=p*Re+g*Ze+m*Je+v*mn,ni=x*(E-1-Bt)+w*(C-1-Zt)+S*(k-1-(mn*ce-ge))+A*me,tr=0;tr<D;++tr)Ke+=d[Hn+tr]*y[ni+tr];o[u*Re+l*P+c*Y+f*X+me]=Ke}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){ke([n,r],"conv2dDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=Ot(i.filterShape,"float32"),f=i.padInfo.left,d=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((d-g)/a)),v=Math.min(i.outHeight,(i.inHeight+d-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/o)),x=Math.min(i.outWidth,(i.inWidth+f-y)/o),w=0;w<i.inChannels;++w)for(var S=0;S<i.outChannels;++S){for(var A=0,_=0;_<i.batchSize;++_)for(var E=m;E<v;++E)for(var C=g+E*a-d,k=b;k<x;++k){var T=y+k*o-f;A+=l?h.get(_,C,T,w)*p.get(_,E,k,S):h.get(_,w,C,T)*p.get(_,S,E,k)}c.set(A,g,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=Ot(i.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],A=b[3],_=this.readSync(n.dataId),E=n.strides,C=E[0],k=E[1],T=E[2],I=E[3],N=i.padInfo.front,O=i.padInfo.left,D=i.padInfo.top,L=0;L<u;++L)for(var W=Math.max(0,Math.ceil((N-L)/a)),G=Math.min(i.outDepth,(i.inDepth+N-L)/a),K=L*p,ee=0;ee<l;++ee)for(var ce=Math.max(0,Math.ceil((D-ee)/o)),he=Math.min(i.outHeight,(i.inHeight+D-ee)/o),Oe=ee*g+K,Te=0;Te<c;++Te)for(var Re=Math.max(0,Math.ceil((O-Te)/s)),me=Math.min(i.outWidth,(i.inWidth+O-Te)/s),P=Te*m+Oe,F=0;F<i.inChannels;++F)for(var V=F*v+P,ae=0;ae<i.outChannels;++ae){for(var Y=0,M=0;M<i.batchSize;++M)for(var B=M*C,R=M*x,X=W;X<G;++X)for(var ge=(L+X*a-N)*k+B,xe=X*w+R,ze=ce;ze<he;++ze)for(var Ke=(ee+ze*o-D)*T+ge,Ze=ze*S+xe,Bt=Re;Bt<me;++Bt){var Je=Bt*A+Ze;Y+=_[(Te+Bt*s-O)*I+Ke+F]*y[Je+ae]}d[V+ae]=Y}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,i,a);return o&&(l=this.add(l,o)),s&&(l=oP(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,i){ke([n,r],"depthwiseConv2D");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,d=Ot(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),g=d.values,m=0;m<i.batchSize;++m)for(var v=m*n.strides[0],y=m*d.strides[0],b=0;b<i.outHeight;++b)for(var x=y+b*d.strides[1],w=b*i.strideHeight-l,S=0;S<a;++S){var A=w+S*s;if(!(A<0||A>=i.inHeight))for(var _=S*r.strides[0],E=v+A*n.strides[1],C=0;C<i.outWidth;++C)for(var k=x+C*d.strides[2],T=C*i.strideWidth-c,I=0;I<o;++I){var N=T+I*u;if(!(N<0||N>=i.inWidth))for(var O=_+I*r.strides[1],D=E+N*i.inChannels,L=k,W=O,G=0;G<i.inChannels;++G){for(var K=h[D+G],ee=0;ee<f;++ee)g[L+ee]+=K*p[W+ee];L+=f,W+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){ke([n,r],"depthwiseConv2DDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],g=d[2],m=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=i.batchSize,S=i.filterHeight,A=i.filterWidth,_=i.inChannels,E=i.inHeight,C=i.inWidth,k=i.outChannels,T=i.outHeight,I=i.outWidth,N=i.strideHeight,O=i.strideWidth,D=S-1-i.padInfo.top,L=A-1-i.padInfo.left,W=k/_,G=0;G<w;++G)for(var K=0;K<_;++K)for(var ee=0;ee<E;++ee)for(var ce=ee-D,he=Math.max(0,Math.ceil(ce/N)),Oe=Math.min(T,(S+ce)/N),Te=0;Te<C;++Te){for(var Re=Te-L,me=Math.max(0,Math.ceil(Re/O)),P=Math.min(I,(A+Re)/O),F=0,V=he;V<Oe;++V)for(var ae=V*N-ce,Y=me;Y<P;++Y)for(var M=h*G+p*V+g*Y,B=y*(S-1-ae)+b*(A-1-(Y*O-Re))+x*K,R=0;R<W;++R)F+=f[M+(K*W+R)]*m[B+R];o[u*G+l*ee+c*Te+K]=F}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){ke([n,r],"depthwiseConv2DDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=Ot(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,d=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((f-g)/a)),v=Math.min(i.outHeight,(i.inHeight+f-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/o)),x=Math.min(i.outWidth,(i.inWidth+c-y)/o),w=0;w<i.outChannels;++w){for(var S=Math.trunc(w/d),A=w%d,_=0,E=0;E<i.batchSize;++E)for(var C=m;C<v;++C)for(var k=g+C*a-f,T=b;T<x;++T){var I=y+T*o-c;_+=h.get(E,k,I,S)*p.get(E,C,T,w)}l.set(_,g,y,S,A)}return l.toTensor()},t.prototype.tile=function(n,r){return ke(n,"tile"),MY(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){ke(n,"pad");var a=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),o=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ot(a,n.dtype);i!==0&&u.values.fill(i);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+o[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.gather=function(n,r,i){ke([n,r],"gather");var a=n.shape.slice(),o=this.readSync(r.dataId);a[i]=o.length;for(var s=Ot(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[i]=o[c[i]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){ke([n],"batchToSpaceND");var a=r.reduce(function(f,d){return f*d}),o=US(n.shape,r,a),s=WS(o.length,r.length),u=VS(n.shape,r,a),l=cY(i,r.length),c=fY(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){ke([n],"spaceToBatchND");var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=US(u.shape,r,a,!1),c=WS(l.length,r.length,!1),f=VS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.maxPool=function(n,r){return ke(n,"maxPool"),aP(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"max").toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,a){ke([r,i],"maxPoolBackprop");for(var o=this.readSync(r.dataId),s=Ot(a.outShape,r.dtype,OJ(o,r.shape,r.dtype,a).values),u=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=h-1-a.padInfo.left,g=d-1-a.padInfo.top,m=Ot(r.shape,"float32"),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var x=0;x<a.inHeight;++x)for(var w=0;w<a.inWidth;++w){for(var S=x-g,A=w-p,_=0,E=0;E<d;E+=c){var C=(S+E)/u;if(!(C<0||C>=a.outHeight||Math.floor(C)!==C))for(var k=0;k<h;k+=f){var T=(A+k)/l;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var I=d*h-1-s.get(y,C,T,b)===E*h+k?1:0;I!==0&&(_+=v.get(y,C,T,b)*I)}}}m.set(_,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){ke([n,r],"avgPoolBackprop");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,g=Ot(r.shape,"float32"),m=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-p,A=w-h,_=0,E=0;E<f;E+=l){var C=(S+E)/a;if(!(C<0||C>=i.outHeight||Math.floor(C)!==C))for(var k=0;k<d;k+=c){var T=(A+k)/o;T<0||T>=i.outWidth||Math.floor(T)!==T||(_+=v.get(y,C,T,b))}}g.set(_*m,y,x,w,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,i){ke(n,"pool3d");for(var a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Ot(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[3]*r.outShape[4],_=r.outShape[4],E=0;E<r.batchSize;++E)for(var C=E*w,k=E*n.strides[0],T=0;T<r.inChannels;++T)for(var I=0;I<r.outDepth;++I){for(var N=I*a-p,O=N;O<0;)O+=u;for(var D=Math.min(r.inDepth,f+N),L=C+I*S,W=0;W<r.outHeight;++W){for(var G=W*o-g,K=G;K<0;)K+=l;for(var ee=Math.min(r.inHeight,d+G),ce=L+W*A,he=0;he<r.outWidth;++he){for(var Oe=he*s-m,Te=Oe;Te<0;)Te+=c;for(var Re=Math.min(r.inWidth,h+Oe),me=ce+he*_,P=v,F=0,V=0,ae=O;ae<D;ae+=u){for(var Y=k+ae*n.strides[1],M=K;M<ee;M+=l){for(var B=Y+M*n.strides[2],R=Te;R<Re;R+=c){var X=y[B+R*n.strides[3]+T];if(i==="max"&&X>P?P=X:i==="avg"&&(F+=X,V++),isNaN(P))break}if(isNaN(P))break}if(isNaN(P))break}x[me+T]=i==="avg"?F/V:P}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return ke(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){ke([n,r],"avgPool3dBackprop");for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=m-1-i.padInfo.left,b=g-1-i.padInfo.top,x=Ot(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),A=0;A<i.batchSize;++A)for(var _=0;_<i.inChannels;++_)for(var E=0;E<i.inDepth;++E)for(var C=0;C<i.inHeight;++C)for(var k=0;k<i.inWidth;++k){for(var T=E-v,I=C-b,N=k-y,O=0,D=0;D<p;D+=f){var L=(T+D)/a;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var W=0;W<g;W+=d){var G=(I+W)/o;if(!(G<0||G>=i.outHeight||Math.floor(G)!==G))for(var K=0;K<m;K+=h){var ee=(N+K)/s;ee<0||ee>=i.outWidth||Math.floor(ee)!==ee||(O+=S.get(A,L,G,ee,_))}}}x.set(O*w,A,E,C,k,_)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return ke(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=Ot(r.outShape,"int32"),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*a-p,S=w;S<0;)S+=u;for(var A=Math.min(r.inDepth,f+w),_=0;_<r.outHeight;++_){for(var E=_*o-g,C=E;C<0;)C+=l;for(var k=Math.min(r.inHeight,d+E),T=0;T<r.outWidth;++T){for(var I=T*s-m,N=I;N<0;)N+=c;for(var O=Math.min(r.inWidth,h+I),D=Number.NEGATIVE_INFINITY,L=-1,W=S;W<A;W+=u)for(var G=W-w,K=C;K<k;K+=l)for(var ee=K-E,ce=N;ce<O;ce+=c){var he=ce-I,Oe=v.get(y,W,K,ce,b);Oe>=D&&(D=Oe,L=G*d*h+ee*d+he)}i.set(L,y,x,_,T,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,a){ke([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=h-1-a.padInfo.front,v=g-1-a.padInfo.left,y=p-1-a.padInfo.top,b=Ot(r.shape,"float32"),x=this.bufferSync(o),w=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var A=0;A<a.inChannels;++A)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var C=0;C<a.inWidth;++C){for(var k=_-m,T=E-y,I=C-v,N=0,O=0;O<h;O+=c){var D=(k+O)/s;if(!(D<0||D>=a.outDepth||Math.floor(D)!==D))for(var L=0;L<p;L+=f){var W=(T+L)/u;if(!(W<0||W>=a.outHeight||Math.floor(W)!==W))for(var G=0;G<g;G+=d){var K=(I+G)/l;if(!(K<0||K>=a.outWidth||Math.floor(K)!==K)){var ee=h*p*g-1-x.get(S,D,W,K,A)===O*p*g+L*g+G?1:0;ee!==0&&(N+=w.get(S,D,W,K,A)*ee)}}}}b.set(N,S,_,E,C,A)}return b.toTensor()},t.prototype.cast=function(n,r){return cM(n,r,this)},t.prototype.reshape=function(n,r){return rE(n,r)},t.prototype.avgPool=function(n,r){return ke(n,"avgPool"),ke(n,"maxPool"),aP(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(n,r,i,a){ke(n,"resizeBilinear");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(et([s,r,i,c])),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=0,m=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=m*b,w=Math.floor(x),S=x-w,A=Math.min(u-1,Math.ceil(x)),_=y*n.strides[0]+w*n.strides[1],E=y*n.strides[0]+A*n.strides[1],C=0;C<i;C++)for(var k=v*C,T=Math.floor(k),I=k-T,N=Math.min(l-1,Math.ceil(k)),O=_+T*n.strides[2],D=E+T*n.strides[2],L=_+N*n.strides[2],W=E+N*n.strides[2],G=0;G<c;G++){var K=f[O+G],ee=f[D+G],ce=K+(f[L+G]-K)*I,he=ce+(ee+(f[W+G]-ee)*I-ce)*S;d[g++]=he}return Mr(d,[s,r,i,c])},t.prototype.resizeBilinearBackprop=function(n,r,i){ke([n,r],"resizeBilinearBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=[i&&f>1?s-1:s,i&&d>1?u-1:u],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],m=p[0]/g[0],v=p[1]/g[1],y=this.readSync(n.dataId),b=0,x=0;x<o;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var A=S*m,_=Math.floor(A),E=Math.min(Math.ceil(A),s-1),C=w+_*r.strides[1],k=w+E*r.strides[1],T=A-_,I=1-T,N=0;N<d;N++)for(var O=N*v,D=Math.floor(O),L=Math.min(Math.ceil(O),u-1),W=O-D,G=1-W,K=C+D*r.strides[2],ee=C+L*r.strides[2],ce=k+D*r.strides[2],he=k+L*r.strides[2],Oe=I*G,Te=I*W,Re=T*G,me=T*W,P=0;P<l;P++){var F=y[b++];h[K+P]+=F*Oe,h[ee+P]+=F*Te,h[ce+P]+=F*Re,h[he+P]+=F*me}return Of(h,[o,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,a){ke(n,"resizeNearestNeighbor");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*i*c),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=h[0]/p[0],m=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=g*x,S=b+Math.min(u-1,a?Math.round(w):Math.floor(w))*n.strides[1],A=0;A<i;A++)for(var _=m*A,E=S+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],C=0;C<c;C++){var k=f[E+C];d[v++]=k}return Mr(d,[s,r,i,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){ke([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=this.readSync(n.dataId),g=[i&&f>1?s-1:s,i&&d>1?u-1:u],m=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,A=0;A<o;A++)for(var _=A*r.strides[0],E=0;E<s;E++)for(var C=_+E*r.strides[1],k=Math.floor(E*b),T=Math.floor(k-w/2),I=0;I<u;I++)for(var N=C+I*r.strides[2],O=Math.floor(I*x),D=Math.floor(O-S/2),L=0;L<l;L++){for(var W=0,G=0;G<w;G++){var K=G+T;if(!(K<0||K>=f)){var ee=_+K*n.strides[1],ce=K*v;if(E===Math.min(s-1,i?Math.round(ce):Math.floor(ce)))for(var he=0;he<S;he++){var Oe=he+D;if(!(Oe<0||Oe>=d)){var Te=ee+Oe*n.strides[2],Re=Oe*y;I===Math.min(u-1,i?Math.round(Re):Math.floor(Re))&&(W+=p[Te+L])}}}}h[N+L]=W}return Of(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){ke([n,r,i,o,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,g=f.length,m=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)h[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+a),y>=p&&(y=0),b>=v&&(b=0),x>=g&&(x=0),w>=m&&(w=0);return Of(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){ke(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(m){for(var v=m%s,y=m-v+Math.max(0,v-r),b=m-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var h=0;h<c;h++){var p=d(h),g=l[h]*Math.pow(i+a*p,-o);f[h]=g}return Of(f,n.shape)},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){ke(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,g=0;g<p;g++){for(var m=g%l,v=g-m+Math.max(0,m-a),y=g-m+Math.min(l,m+a+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+o,x=v;x<y;x++){var w=-2*s*u*f[x]*d[g]/b;g===x&&(w+=Math.pow(b,-u)),w*=c[g],h[x]+=w}}return Of(h,n.shape)},t.prototype.multinomial=function(n,r,i,a){ke(n,"multinomial");for(var o=r?n:$h(n),s=o.shape[0],u=o.shape[1],l=Tn([s,i],"int32"),c=this.readSync(l.dataId),f=this.readSync(o.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var g=1;g<p.length;++g)p[g]=p[g-1]+f[h+g];for(var m=uE(a.toString()),v=d*i,y=0;y<i;++y){var b=m();c[v+y]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,i,a){ke(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(o[u*r+s[u]]=i);return Wu(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return ke(n,"nonMaxSuppression"),hM(this.readSync(n.dataId),this.readSync(r.dataId),i,a,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],a=n.shape[1],o=Ot(n.shape,"float32"),s=Ot(n.shape,"float32"),u=to(n).as2D(i,a),l=os(n).as2D(i,a),c=0;c<i;c++)for(var f=u.slice([c,0],[1,a]),d=l.slice([c,0],[1,a]),h=ii(f,d),p=this.readSync(this.fftImpl(h,r).dataId),g=0;g<a;g++){var m=NY(p,g);o.values[c*a+g]=m.real,s.values[c*a+g]=m.imag}return ii(o.toTensor(),s.toTensor()).as2D(i,a)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),a=i.size;if(this.isExponentOf2(a)){var o=this.fftRadix2(i,a,r).as2D(n.shape[0],n.shape[1]);return r&&(o=ii(to(o).div(Ve(a)),os(o).div(Ve(a)))),o}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,a,r));return ii(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var a=this.readSync(n.dataId),o=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),u=ii(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),c=ii(l.real,l.imag).as1D();u=this.fftRadix2(u,o,i),c=this.fftRadix2(c,o,i);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,i),d=ii(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),g=to(h).concat(to(p)),m=os(h).concat(os(p));return ii(g,m).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var a=new Float32Array(2*r),o=0;o<r;o++){for(var s=0,u=0,l=0;l<r;l++){var c=TPe(o*l,r,i),f=NY(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}i&&(s/=r,u/=r),kPe(a,s,u,o)}return a},t.prototype.depthToSpace=function(n,r,i){U(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],o=n.shape[1],s=n.shape[2],u=n.shape[3],l=o*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(a*l*c*f),p=0,g=0;g<a;++g)for(var m=0;m<l;++m)for(var v=Math.floor(m/r),y=m%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var A=S+w+u*(x+s*(v+o*g));h[p++]=d[A]}return Of(h,[a,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,i,a){var o=Qt(n.shape,r.shape),s=Ot(o,i),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=uc(n.shape,o),f=uc(r.shape,o),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),g=this.bufferSync(r),m=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(A){return b[A]=0});var x=p.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(A){return w[A]=0});var S=g.locToIndex(w);d[v]=a(u[x],l[S])};for(h=0;h<d.length;++h)m(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var a=Qt(n.shape,r.shape),o=Ot(a,"float32"),s=Ot(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=uc(n.shape,a),f=uc(r.shape,a),d=o.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var g=p%u.length,m=p%l.length,v=i(u[2*g],u[2*g+1],l[2*m],l[2*m+1]);d[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=o.indexToLoc(w),A=S.slice(-n.rank);c.forEach(function(T){return A[T]=0});var _=y.locToIndex(A),E=S.slice(-r.rank);f.forEach(function(T){return E[T]=0});var C=b.locToIndex(E),k=i(u[2*_],u[2*_+1],l[2*C],l[2*C+1]);d[w]=k.real,h[w]=k.imag};for(p=0;p<d.length;p++)x(p)}return this.complex(o.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return FY(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,a,o,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=a[0],g=a[1],m=Ot([h,p,g,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),x=n.strides,w=m.strides,S=0;S<h;S++){var A=4*S,_=v[A],E=v[A+1],C=v[A+2],k=v[A+3],T=y[S];if(!(T>=l))for(var I=p>1?(C-_)*(c-1)/(p-1):0,N=g>1?(k-E)*(f-1)/(g-1):0,O=0;O<p;O++){var D=p>1?_*(c-1)+O*I:.5*(_+C)*(c-1);if(D<0||D>c-1)for(var L=0;L<g;L++)for(var W=0;W<d;W++){var G=W+L*w[2]+O*w[1]+S*w[0];m.values[G]=s}else if(o==="bilinear"){var K=Math.floor(D),ee=Math.ceil(D),ce=D-K;for(L=0;L<g;L++)if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var he=Math.floor(ae),Oe=Math.ceil(ae),Te=ae-he;for(W=0;W<d;W++){var Re=b[G=W+he*x[2]+K*x[1]+T*x[0]],me=b[G=W+Oe*x[2]+K*x[1]+T*x[0]],P=b[G=W+he*x[2]+ee*x[1]+T*x[0]],F=Re+(me-Re)*Te,V=P+(b[G=W+Oe*x[2]+ee*x[1]+T*x[0]]-P)*Te;G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=F+(V-F)*ce}}}else for(L=0;L<g;++L){var ae;if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var Y=Math.round(ae),M=Math.round(D);for(W=0;W<d;W++){var B=W+Y*x[2]+M*x[1]+T*x[0],R=W+L*w[2]+O*w[1]+S*w[0];m.values[R]=b[B]}}}}}return m.toTensor()},t.prototype.sparseToDense=function(n,r,i,a){var o=bb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(n,r,i,f,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=tM(n,r),s=o[0],u=o[1],l=o[2],c=o[3];if(u===0)return Mr([],s,n.dtype);for(var f=new km([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var g=[],m=0,v=0;v<a;v++){var y=d[p*a+v];m+=y*c[v],g.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[p*l+b]=h[m*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var a=bb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=Ve(0);return this.scatter(n,r,i,c,u,s,o,l,f,!0)},t.prototype.fill=function(n,r,i){var a=Qy(i=i||Am(r),et(n));return a.fill(r),J.makeTensor(a,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Qy(n.dtype,et(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return fM(n,r,i)},t.prototype.scatter=function(n,r,i,a,o,s,u,l,c,f){var d=[a/o,o],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return Mr([],i,r.dtype);var g=new km(d,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var v=[],y=0,b=0;b<u;b++){var x=h[m*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=a/o)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var w=0;w<o;w++)f?g.values[y*o+w]+=p[m*o+w]:g.values[y*o+w]=r.rank===0?p[0]:p[m*o+w]}return g.toTensor().reshape(i)},t}(sM);function IJ(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;ke([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,f=t(o.shape,s.shape,l,c,o.dtype),d=f[0],h=f[1];return{dataId:u.write(d,h,o.dtype),shape:h,dtype:o.dtype}}}}function NJ(e){return function(t,n,r,i,a){var o=Qt(t,n),s=o.length,u=Qa(o),l=Fh(a,et(o)),c=t.length,f=n.length,d=Qa(t),h=Qa(n),p=uc(t,o),g=uc(n,o);if(p.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],i[m%i.length]);else{var v=function(y){var b=i3(y,s,u),x=b.slice(-c);p.forEach(function(_){return x[_]=0});var w=AS(x,c,d),S=b.slice(-f);g.forEach(function(_){return S[_]=0});var A=AS(S,f,h);l[y]=e(r[w],i[A])};for(m=0;m<l.length;++m)v(m)}return[l,o]}}J.registerBackend("cpu",function(){return new ULe},1);var WLe=NJ(function(e,t){return e/t}),VLe=IJ(gb,WLe),qLe={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;ke(i,"MaxPoolWithArgmax");var f=c.data.get(i.dataId).values,d=Rf(i.shape,o,s,[1,1],u),h=function(y,b,x,w,S){var A=aP(y,0,x,Qa(b),S,"max"),_=OJ(y,b,x,S,!0,w);return[A.values,_.values]}(f,i.shape,i.dtype,l,d),p=h[0],g=h[1],m=c.write(p,d.outShape,i.dtype),v=c.write(g,d.outShape,i.dtype);return[{dataId:m,shape:d.outShape,dtype:i.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}},HLe={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;ke(a,"NonMaxSuppressionWithScore");var h=pM(d.data.get(a.dataId).values,d.data.get(o.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},GLe={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;ke(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},KLe=NJ(function(e,t){var n=e-t;return n*n});function DJ(e,t,n,r,i){for(var a=et(t),o=t.length,s=Qa(t),u=Qa(i),l=Fh(n,et(i)),c=0;c<a;++c){for(var f=i3(c,o,s),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];l[AS(d,o,u)]=e[c]}return l}for(var sP=0,RJ=[HLe,GLe,IJ(mb,KLe),VLe,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n.perm,o=r;ke(i,"transpose");for(var s=i.shape.length,u=new Array(s),l=0;l<u.length;l++)u[l]=i.shape[a[l]];var c=DJ(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(c,u,i.dtype),shape:u,dtype:i.dtype}}},qLe];sP<RJ.length;sP++)XF(RJ[sP]);for(var Vm,XLe=function(e){this.variableNames=["A"];var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},YLe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `},ZLe=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Jn(this.rank),a=function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<o.length;c++)l[o[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},JLe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Jn(this.rank),a=$Y("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},uP=0,FJ=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,a=r.numChannels,o=typeof HTMLVideoElement!="undefined"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],f=[c,l],d=[c,l,a];(s||o)&&(Vm==null&&(Vm=document.createElement("canvas").getContext("2d")),Vm.canvas.width=l,Vm.canvas.height=c,Vm.drawImage(i,0,0,l,c),i=Vm.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=Io.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=pe().getBool("WEBGL_PACK")?new YLe(d):new XLe(d),g=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:gb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(i,a,o){var s=new Tr(KPe,i.shape,a.shape);return pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(s=new Hu(XPe,i.shape,a.shape,!0)),o.runWebGLProgram(s,[i,a],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;PS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=pM(d.readSync(a.dataId),d.readSync(o.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,a=new Pt(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:mb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,a=r.b,o=n,s=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu("return (a - b) * (a - b);",i.shape,a.shape):new Tr("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,i=e.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=a.shape[o[c]];if(s.shouldExecuteOnCPU([a])){var f=DJ(s.texData.get(a.dataId).values,a.shape,a.dtype,o,l);t=s.makeTensorInfo(l,a.dtype),s.texData.get(t.dataId).values=f}else t=function(d,h,p){var g=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JLe(d.shape,h):new ZLe(d.shape,h);return p.runWebGLProgram(g,[d],d.dtype)}(a,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;U(i.shape.length===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."});var f=[1,1];U(Gi(s,f),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"});var d=Rf(i.shape,o,s,f,u),h=function(p,g,m,v){var y=new Ab(m,"max",!1),b=v.runWebGLProgram(y,[p],"float32");return y=new Ab(m,"max",!0,!0,g),[b,v.runWebGLProgram(y,[p],"float32")]}(i,l,d,c);return[h[0],h[1]]}}];uP<FJ.length;uP++)XF(FJ[uP]);for(var lP=0,MJ=[{kernelName:T3,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=e,o=qr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var a=e,o=qr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach(function(r,i){n[i]=function(){return e.clone()}}),n}},{kernelName:O3,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(i[s]!==1)throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:gb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=kr(e,r.toFloat()),o=qr(n.shape,i);return o.length>0?Hr(a,o).reshape(n.shape):a},b:function(){var a=e.mul(n.toFloat()),o=qr(r.shape,i);o.length>0&&(a=Hr(a,o).reshape(r.shape));var s=gE(r);return Df(kr(a,s.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,i=t[0],a=t[1],o=t[2],s=t[3],u=OZ(i),l=s??Ve(1),c=qr(a.shape,u.shape),f=[];if(a.rank===1){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var h=Cr(i,a),p=rt(e,l),g=HS(Wt(o,Ve(r))),m=rt(rt(rt(g,g),g),Ve(-.5));return{x:function(){return a.rank===1?qs(rt(rt(e,cc(g.as4D(1,1,1,a.shape[0]),f)),l),i.shape):qs(rt(rt(e,g),l),i.shape)},mean:function(){var v=rt(rt(g,Ve(-1)),p);return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)},variance:function(){var v=rt(rt(m,h),p);return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)},scale:function(){var v=rt(h,g),y=rt(e,v);return a.rank===1&&(y=Hr(y,c)),qs(y,a.shape)},offset:function(){var v=e;return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)}}}},{kernelName:N3,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:I3,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Tn(n.shape,"float32")}}}},{kernelName:R3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map(function(a){return a[0]});return{x:function(){return e.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:mb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Ve(2);return{a:function(){return rt(e,rt(i,Cr(n,r)))},b:function(){return rt(e,rt(i,Cr(r,n)))}}}},{kernelName:D3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.reps;return{x:function(){var a=en(r);if(r.rank===1)for(var o=0;o<i[0];++o)a=a.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(o=0;o<i[0];++o)for(var s=0;s<i[1];++s)a=a.add(e.slice([o*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(var u=0;u<i[2];++u)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(r.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(u=0;u<i[2];++u)for(var l=0;l<i[3];++l)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2],l*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return a}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=$S(n.perm);return{x:function(){return cn(e,r)}}}}];lP<MJ.length;lP++)hX(MJ[lP]);var QLe=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();pe().get("IS_BROWSER")&&pe().setPlatform("browser",new QLe);var cP,e4e=function(){return require("node-fetch")},t4e=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return pe().global.fetch!=null?pe().global.fetch(t,n):(cP==null&&(cP=e4e()),cP(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();pe().get("IS_NODE")&&pe().setPlatform("node",new t4e);var fP={float32:4,int32:4,uint16:2,uint8:1,bool:1},PE=4;function PJ(e,t){for(var n={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,f=et(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=fP[h.dtype],g=e.slice(r,r+f*p),m=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")d=Float32Array.from(m,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(m,function(S){return Math.round(S*h.scale+h.min)})}r+=f*p}else if(l==="string"){var v=et(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+PE))[0];r+=PE;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=fP[l];if(g=e.slice(r,r+f*w),l==="float32")d=new Float32Array(g);else if(l==="int32")d=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(g)}r+=f*w}n[u]=Mr(d,c,l)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function n4e(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var dP=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function $J(e){return dP?Buffer.byteLength(e):new Blob([e]).size}function hP(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function LJ(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function $b(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:$J(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:$J(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Po=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var o=a(t,r);o!==null&&i.push(o)}),i},e}(),qm="://",Bf=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){U(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(qm)&&(t=t.slice(0,t.indexOf(qm))),U(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();U(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function $E(e){if(e.indexOf(qm)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Bf.getSchemes().join(","));return{scheme:e.split(qm)[0],path:e.split(qm)[1]}}function BJ(e,t,n){return n===void 0&&(n=!1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return U(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),U((r=Po.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),U(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],U((a=Po.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),U(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=a[0],s=$E(e).scheme,u=$E(e).path,l=s===$E(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,Bf.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,Bf.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Kh="models_store",zf="model_info_store";function zJ(){if(!pe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function pP(e){var t=e.result;t.createObjectStore(Kh,{keyPath:"modelPath"}),t.createObjectStore(zf,{keyPath:"modelPath"})}var Hm=function(){function e(t){if(this.indexedDB=zJ(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,a){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return pP(o)},o.onsuccess=function(){var s=o.result;if(n==null){var u=s.transaction(Kh,"readonly"),l=u.objectStore(Kh).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=$b(n),d=s.transaction(zf,"readwrite"),h=d.objectStore(zf),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var g=(c=s.transaction(Kh,"readwrite")).objectStore(Kh).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});g.onsuccess=function(){return i({modelArtifactsInfo:f})},g.onerror=function(m){var v=(h=d.objectStore(zf)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(g.error)},v.onerror=function(y){return s.close(),a(g.error)}}},p.onerror=function(g){return s.close(),a(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return a(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),jJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Hm.URL_SCHEME)?(t=e.slice(Hm.URL_SCHEME.length),new Hm(t)):null;var t};Po.registerSaveRouter(jJ),Po.registerLoadRouter(jJ);var r4e=function(){function e(){this.indexedDB=zJ()}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t=this;return nt(this,function(n){return[2,new Promise(function(r,i){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return pP(a)},a.onsuccess=function(){var o=a.result,s=o.transaction(zf,"readonly"),u=s.objectStore(zf).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return o.close(),i(u.error)},s.oncomplete=function(){return o.close()}},a.onerror=function(o){return i(a.error)}})]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){var i;return t=(i=t).startsWith(Hm.URL_SCHEME)?i.slice(Hm.URL_SCHEME.length):i,[2,new Promise(function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return pP(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(zf,"readwrite"),f=c.objectStore(zf),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var g=(u=l.transaction(Kh,"readwrite")).objectStore(Kh).delete(t);g.onsuccess=function(){return a(d.result.modelArtifactsInfo)},g.onerror=function(m){return o(d.error)}};h.onsuccess=p,h.onerror=function(g){return p(),l.close(),o(d.error)}},d.onerror=function(h){return l.close(),o(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}})]})})},e}();if(pe().getBool("IS_BROWSER"))try{Bf.registerManager(Hm.URL_SCHEME,new r4e)}catch(e){}var dc="/",Gm="tensorflowjs_models",UJ="info",i4e="model_topology",a4e="weight_specs",o4e="weight_data",s4e="model_metadata";function WJ(e){return{info:[Gm,e,UJ].join(dc),topology:[Gm,e,i4e].join(dc),weightSpecs:[Gm,e,a4e].join(dc),weightData:[Gm,e,o4e].join(dc),modelMetadata:[Gm,e,s4e].join(dc)}}function u4e(e){var t=e.split(dc);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(dc)}var Km=function(){function e(t){if(!pe().getBool("IS_BROWSER")||typeof window=="undefined"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=WJ(this.modelPath)}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=$b(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(dP)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return nt(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(dP){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),VJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Km.URL_SCHEME)?(t=e.slice(Km.URL_SCHEME.length),new Km(t)):null;var t};Po.registerSaveRouter(VJ),Po.registerLoadRouter(VJ);var l4e=function(){function e(){U(pe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),U(typeof window=="undefined"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o;return nt(this,function(s){for(t={},n=Gm+dc,r=dc+UJ,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(o=u4e(a),t[o]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){var a;if(t=(a=t).startsWith(Km.URL_SCHEME)?a.slice(Km.URL_SCHEME.length):a,n=WJ(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(pe().getBool("IS_BROWSER"))try{Bf.registerManager(Km.URL_SCHEME,new l4e)}catch(e){}var c4e="model",f4e=".json",d4e=".weights.bin";function qJ(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var gP=function(){function e(t){if(!pe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=c4e),this.modelTopologyFileName=t+f4e,this.weightDataFileName=t+d4e}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s;return nt(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=a,[4,qJ(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,qJ(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:$b(t)}]}})})},e.URL_SCHEME="downloads://",e}(),h4e=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r=this;return nt(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(m){return void o(m)}var h=[],p=[],g=[];f.forEach(function(m){m.paths.forEach(function(v){p.push(v),g.push(null)}),h.push.apply(h,m.weights)}),f.forEach(function(m){m.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=p.indexOf(v);g[w]=x,g.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:hP(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return LJ(u.name)}),a={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(u){var l=LJ(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[i.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function HJ(e,t,n,r){(function(a){U(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,o){U(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),U(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),U(o>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+o})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(a){return a.then(function(o){var s=n+ ++i/e.length*(r-n);return t(s),o}),a}))}function GJ(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return nt(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?pe().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),i=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,HJ(r,t.onProgress,i,a)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,HJ(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function KJ(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),tt(t,void 0,void 0,function(){var a,o,s,u,l,c,f,d,h,p;return nt(this,function(g){switch(g.label){case 0:if(a=n.map(function(){return!1}),o={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(m,v){var y=0;m.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=fP[x]*et(b.shape),S=function(){a[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};i!=null?i.forEach(function(A,_){A===b.name&&(S(),s[_]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(m){return m}))throw l=i.filter(function(m,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(m,v,y){return v&&m.push(y),m},[]),f=[],c.forEach(function(m){n[m].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=g.sent(),h={},p=0,c.forEach(function(m){for(var v=n[m].paths.length,y=0,b=0;b<v;b++)y+=d[p+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,A=0;A<v;A++){var _=new Uint8Array(d[p+A]);w.set(_,S),S+=_.byteLength}o[m].forEach(function(E){var C=PJ(x.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var k in C)h[k]=C[k]}),p+=v}),[2,h]}})})}}Po.registerSaveRouter(function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(gP.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new gP(t)}(e.slice(gP.URL_SCHEME.length)):null});var XJ=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=pe().platform.fetch,U(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&U(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a;return nt(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:$b(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,i==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var g=p.lastIndexOf("/"),m=p.lastIndexOf("?"),v=p.substring(0,g),y=m>g?p.substring(m):"";return[v+"/",y]}(n),i=r[0],a=r[1],o=this.weightPathPrefix||i,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(g){f.push(o+g+a)})}),[4,GJ(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,hP(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function mP(e){return e.match(XJ.URL_SCHEME_REGEX)!=null}var YJ=function(e,t){return typeof fetch=="undefined"?null:(Array.isArray(e)?e.every(function(n){return mP(n)}):mP(e))?vP(e,{onProgress:t}):null};function vP(e,t){return new XJ(e,t)}Po.registerSaveRouter(YJ),Po.registerLoadRouter(YJ);var yP=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.modelArtifacts]})})},e}(),p4e=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,this.saveHandler(t)]})})},e}(),wa=Object.freeze({browserFiles:function(e){return new h4e(e)},browserHTTPRequest:function(e,t){return vP(e,t)},concatenateArrayBuffers:hP,decodeWeights:PJ,encodeWeights:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s=this;return nt(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=i[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return tt(s,void 0,void 0,function(){var g,m,v,y,b,x,w;return nt(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(g=S.sent(),m=g.reduce(function(A,_){return A+_.length},0)+PE*g.length,v=new Uint8Array(m),y=0,b=0;b<g.length;b++)x=g[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=PE,v.set(x,y),y+=x.length;return p(v),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:n4e(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new yP(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yP({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yP({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Po.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:$b,getSaveHandlers:function(e){return Po.getSaveHandlers(e)},http:vP,isHTTPScheme:mP,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),tt(this,void 0,void 0,function(){return nt(this,function(i){return[2,KJ(function(a){return GJ(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Po.registerLoadRouter(e)},registerSaveRouter:function(e){return Po.registerSaveRouter(e)},weightsLoaderFactory:KJ,withSaveHandler:function(e){return new p4e(e)},copyModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,BJ(e,t,!1)]})})},listModels:function(){return tt(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return nt(this,function(s){switch(s.label){case 0:e=Bf.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,Bf.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+qm+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,BJ(e,t,!0)]})})},removeModel:function(e){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){return t=$E(e),[2,Bf.getManager(t.scheme).removeModel(t.path)]})})}}),Xm,g4e=Q({confusionMatrix_:function(e,t,n){var r=j(e,"labels","confusionMatrix"),i=j(t,"predictions","confusionMatrix");U(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),U(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),U(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),U(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),U(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=Vh(r.asType("int32"),n),o=Vh(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),m4e=Object.freeze({confusionMatrix:g4e}),v4e=Q({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement!="undefined"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(HF("FromPixels",J.backendName)!=null)return J.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(o?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(a||i)&&(Xm==null&&(Xm=document.createElement("canvas").getContext("2d")),Xm.canvas.width=c,Xm.canvas.height=f,Xm.drawImage(e,0,0,c,f),s=Xm.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return LS(u,[f,c,t],"int32")}}),ZJ=Object.freeze({toPixels:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_;return nt(this,function(E){switch(E.label){case 0:if(n=j(e,"img","toPixels"),e instanceof Ht||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=E.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=E.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(g=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(a*i*4),v=0;v<i*a;++v)y=void 0,b=void 0,x=void 0,w=void 0,o===1?(y=s[v]*g,b=s[v]*g,x=s[v]*g,w=255):o===3?(y=s[3*v]*g,b=s[3*v+1]*g,x=s[3*v+2]*g,w=255):o===4&&(y=s[4*v]*g,b=s[4*v+1]*g,x=s[4*v+2]*g,w=s[4*v+3]*g),m[(S=4*v)+0]=Math.round(y),m[S+1]=Math.round(b),m[S+2]=Math.round(x),m[S+3]=Math.round(w);return t!=null&&(t.width=a,t.height=i,A=t.getContext("2d"),_=new ImageData(m,a,i),A.putImageData(_,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:v4e}),JJ=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),QJ=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function jf(e){U(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),U(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),U(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),QJ.register(e)}var Ne=Object.freeze({Serializable:JJ,SerializationMap:QJ,registerClass:jf}),y4e="1.7.4",b4e=Object.freeze({gpgpu_util:S$e,webgl_util:YMe,forceHalfFloat:function(){pe().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:TZ,setWebGLContext:NX,GPGPUContext:fZ}),hc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return js(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var a=this.computeGradients(n,i),o=a.value,s=a.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ut(s),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return IY(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Ut(this.iterations_)},t.prototype.saveIterations=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ve(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(JJ);Object.defineProperty(hc,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var bP=function(e){function t(n,r,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],i==null&&(a.epsilon=J.backend.epsilon()),a}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accum_grad",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:i+"/accum_var",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;le(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(o);o.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ut(this.accumulatedGrads.map(function(n){return n.variable})),Ut(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(hc);jf(bP);var xP=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accumulator",variable:le(function(){return Tm(o.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable;le(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(J.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Ut(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(hc);jf(xP);var wP=function(e){function t(n,r,i,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=i,o.epsilon=a,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],le(function(){o.accBeta1=Ve(r).variable(),o.accBeta2=Ve(i).variable()}),a==null&&(o.epsilon=J.backend.epsilon()),o}return js(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Cr(1,r.accBeta1),o=Cr(1,r.accBeta2);i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:le(function(){return en(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:le(function(){return en(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(a),m=p.div(o);f.assign(h),d.assign(p);var v=g.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Ut(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r,i=this;return nt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),le(function(){i.accBeta1.assign(Nm(i.beta1,i.iterations_+1)),i.accBeta2.assign(Nm(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(hc);jf(wP);var _P=function(e){function t(n,r,i,a,o){a===void 0&&(a=null),o===void 0&&(o=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=a,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],le(function(){s.iteration=Ve(0).variable(),s.accBeta1=Ve(r).variable()}),a==null&&(s.epsilon=J.backend.epsilon()),s}return js(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Cr(1,r.accBeta1),o=kr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:en(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:en(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),g=c.abs(),m=p.maximum(g);f.assign(h),d.assign(m);var v=o.div(a).mul(h.div(m.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Ut(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(hc);jf(_P);var LE=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=Array.isArray(n)?n[a].tensor:n[i];if(o!=null){var s=J.registeredVariables[i];le(function(){var u=r.c.mul(o).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=ju(Ve(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(hc);jf(LE);var SP=function(e){function t(n,r,i){i===void 0&&(i=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Ve(a.momentum),a}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulations[a]==null&&(r.accumulations[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[i];u!=null&&le(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),s.assign(c),o.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ut(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(LE);jf(SP);var EP=function(e){function t(n,r,i,a,o){r===void 0&&(r=.9),i===void 0&&(i=0),a===void 0&&(a=null),o===void 0&&(o=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,a==null&&(s.epsilon=J.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:i+"/rms",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:i+"/mg",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;le(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[a].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=o.sub(h);o.assign(p)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(h),p=o.sub(h),o.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ut(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ut(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Ut(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(hc);jf(EP);var Xh=function(){function e(){}return e.sgd=function(t){return new LE(t)},e.momentum=function(t,n,r){return r===void 0&&(r=!1),new SP(t,n,r)},e.rmsprop=function(t,n,r,i,a){return n===void 0&&(n=.9),r===void 0&&(r=0),i===void 0&&(i=null),a===void 0&&(a=!1),new EP(t,n,r,i,a)},e.adam=function(t,n,r,i){return t===void 0&&(t=.001),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new wP(t,n,r,i)},e.adadelta=function(t,n,r){return t===void 0&&(t=.001),n===void 0&&(n=.95),r===void 0&&(r=null),new bP(t,n,r)},e.adamax=function(t,n,r,i,a){return t===void 0&&(t=.002),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),a===void 0&&(a=0),new _P(t,n,r,i,a)},e.adagrad=function(t,n){return n===void 0&&(n=.1),new xP(t,n)},e}(),Uf={sgd:Xh.sgd,momentum:Xh.momentum,adadelta:Xh.adadelta,adagrad:Xh.adagrad,rmsprop:Xh.rmsprop,adamax:Xh.adamax,adam:Xh.adam},x4e=typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(e){return e()};function BE(){return new Promise(function(e){return x4e(function(){return e()})})}Ht.prototype.add=function(e){return Wt(this,e)},Ht.prototype.broadcastTo=function(e){return TM(this,e)},Ht.prototype.div=function(e){return kr(this,e)},Ht.prototype.divNoNan=function(e){return hE(this,e)},Ht.prototype.squaredDifference=function(e){return mE(this,e)},Ht.prototype.tile=function(e){return cc(this,e)},Ht.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),Vh(this,e,t,n)},Ht.prototype.transpose=function(e){return cn(this,e)},Ht.prototype.pad=function(e,t){return Ku(this,e,t)},Ht.prototype.batchNorm=function(e,t,n,r,i){return Wh(this,e,t,n,r,i)},ye=jLe;var w4e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:bP,AdagradOptimizer:xP,AdamOptimizer:wP,AdamaxOptimizer:_P,Add:T3,AddN:dPe,BroadcastTo:O3,DataStorage:oM,Div:gb,get ENV(){return qF},Environment:dX,FromPixels:vPe,FusedBatchNorm:hPe,Identity:N3,KernelBackend:sM,MaxPoolWithArgmax:yPe,MomentumOptimizer:SP,NonMaxSuppressionV5:mPe,OneHot:I3,Optimizer:hc,PadV2:R3,RMSPropOptimizer:EP,get Rank(){return o3},get Reduction(){return Fi},SGDOptimizer:LE,Square:pPe,SquaredDifference:mb,Tensor:Ht,TensorBuffer:km,Tile:D3,Transpose:gPe,Variable:ib,abs:Nf,acos:F3,acosh:M3,add:Wt,addN:EM,addStrict:vY,all:CE,any:Nb,argMax:Db,argMin:WM,asin:P3,asinh:$3,atan:L3,atan2:Q3,atanh:B3,avgPool:_E,avgPool3d:EE,backend:nY,backend_util:CPe,basicLSTMCell:bJ,batchNorm:Wh,batchNorm2d:AM,batchNorm3d:CM,batchNorm4d:kM,batchNormalization:NZ,batchNormalization2d:RZ,batchNormalization3d:MZ,batchNormalization4d:$Z,batchToSpaceND:BS,booleanMaskAsync:tJ,broadcastTo:TM,browser:ZJ,buffer:Ot,cast:zS,ceil:z3,clipByValue:xa,clone:LZ,complex:ii,concat:Hi,concat1d:_3,concat2d:S3,concat3d:E3,concat4d:A3,conv1d:vE,conv2d:Gh,conv2dTranspose:bE,conv3d:yE,conv3dTranspose:sJ,cos:j3,cosh:U3,cumsum:lY,customGrad:xb,deprecationWarn:FS,depthToSpace:C3,depthwiseConv2d:zm,diag:SJ,disableDeprecationWarnings:QMe,dispose:Ut,disposeVariables:ePe,div:kr,divNoNan:hE,divStrict:yY,dot:uJ,dropout:ZM,elu:Um,enableDebugMode:JMe,enableProdMode:ZMe,engine:tPe,env:pe,equal:Hh,equalStrict:GZ,erf:W3,exp:V3,expandDims:Fo,expm1:q3,eye:pE,fft:Mb,fill:Tm,findBackend:uPe,findBackendFactory:lPe,floor:qS,floorDiv:XS,frame:FE,fused:Lf,gather:Bm,gatherND:YM,gather_util:bPe,getBackend:oPe,getGradient:GF,getKernel:HF,getKernelsForBackend:KF,grad:_Pe,grads:SPe,greater:$m,greaterEqual:Tb,greaterEqualStrict:KZ,greaterStrict:XZ,hammingWindow:JM,hannWindow:RE,ifft:Wm,imag:os,image:$f,inTopKAsync:CJ,io:wa,irfft:NE,isFinite:gY,isInf:pY,isNaN:hY,keep:ju,leakyRelu:OE,less:PM,lessEqual:$M,lessEqualStrict:YZ,lessStrict:ZZ,linalg:eP,linspace:w3,localResponseNormalization:qM,log:lc,log1p:H3,logSigmoid:dY,logSoftmax:eE,logSumExp:yJ,logicalAnd:Gu,logicalNot:OM,logicalOr:fE,logicalXor:BZ,losses:kJ,matMul:xE,math:m4e,max:Mf,maxPool:wE,maxPool3d:SE,maxPoolWithArgmax:UM,maximum:qu,maximumStrict:bY,mean:Pr,memory:MS,min:kE,minimum:Im,minimumStrict:xY,mod:eM,modStrict:wY,moments:Rb,movingAverage:wJ,mul:rt,mulStrict:YS,multiRNNCell:xJ,multinomial:IM,neg:Df,nextFrame:BE,norm:HM,notEqual:Lm,notEqualStrict:JZ,oneHot:Vh,ones:Vu,onesLike:Ro,op:Q,outerProduct:lJ,pad:Ku,pad1d:zZ,pad2d:jZ,pad3d:UZ,pad4d:WZ,pool:mJ,pow:Nm,powStrict:_Y,prelu:Fb,print:uY,prod:TE,profile:nPe,rand:VZ,randomGamma:HZ,randomNormal:MM,randomUniform:qh,range:Om,ready:aPe,real:to,reciprocal:G3,registerBackend:cPe,registerGradient:hX,registerKernel:XF,relu:Pf,relu6:VM,removeBackend:sPe,reshape:qs,reverse:Xu,reverse1d:cJ,reverse2d:fJ,reverse3d:dJ,reverse4d:hJ,rfft:Pb,round:K3,rsqrt:HS,scalar:Ve,scatterND:XM,scatter_util:xPe,selu:IE,separableConv2d:jM,serialization:Ne,setBackend:iPe,setPlatform:fPe,setdiff1dAsync:k3,sigmoid:GS,sign:X3,signal:AJ,sin:Y3,sinh:Z3,slice:Mo,slice1d:Ob,slice2d:AE,slice3d:Ib,slice4d:jm,slice_util:wPe,softmax:$h,softplus:vb,spaceToBatchND:jS,sparseToDense:DE,spectral:_J,split:sc,sqrt:yb,square:gE,squaredDifference:mE,squaredDifferenceStrict:SY,squeeze:pb,stack:ss,step:mY,stft:QM,stridedSlice:GM,sub:Cr,subStrict:EY,sum:Hr,sumOutType:CS,tan:J3,tanh:KS,tensor:Mr,tensor1d:ba,tensor2d:Wu,tensor3d:LS,tensor4d:Of,tensor5d:oY,tensor6d:sY,tensor_util:Bu,test_util:vLe,tidy:le,tile:cc,time:rPe,topk:KM,train:Uf,transpose:cn,truncatedNormal:kb,unregisterGradient:jMe,unregisterKernel:zMe,unsortedSegmentSum:LM,unstack:If,util:pt,valueAndGrad:EPe,valueAndGrads:APe,variable:x3,variableGrads:IY,version_core:y4e,webgl:b4e,where:Gs,whereAsync:dE,zeros:Tn,zerosLike:en});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var eQ=function(e,t){return(eQ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ee(e,t){function n(){this.constructor=e}eQ(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var AP,Lb=function(){return(Lb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Ct(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function St(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Gr(){return AP==null&&(AP=nY().epsilon()),AP}function Ks(){return"channelsLast"}var Yh=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),Yu=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),ie=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),$t=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),_4e=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error);(function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t})(Error);function Zh(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function Zu(e,t){if(!e)throw new _4e(t)}function tQ(e,t){for(var n=0,r=0,i=e;r<i.length;r++)i[r]===t&&n++;return n}function _a(e){return e.length===1?e[0]:e}function Qn(e){return Array.isArray(e)?e:[e]}function pc(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Jh(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,function(t,n){return n.toUpperCase()})}var us={};function CP(e){if(e==null)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function kP(e){if(e!=null&&typeof e=="object")if(Array.isArray(e))e.forEach(function(a){return kP(a)});else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?kP(i):e[r]=i.value)}}function Bb(e,t,n,r,i){var a,o,s;if(t===void 0&&(t={}),n===void 0&&(n={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof e=="string"){var u=e,l=void 0;if(u in n)l=n[u];else if(u in us)l=us[u];else if((l=t[u])==null)throw new ie("Unknown "+r+": "+e+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=e;if(c.className==null||c.config==null)throw new ie(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var f=c.className,d=void 0,h=void 0;if(f in n?(d=(a=n[f])[0],h=a[1]):f in us?(d=(o=us.className)[0],h=o[1]):f in t&&(d=(s=t[f])[0],h=s[1]),d==null)throw new ie("Unknown "+r+": "+f+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(h!=null){for(var p={},g=0,m=Object.keys(us);g<m.length;g++)p[S=m[g]]=us[S];for(var v=0,y=Object.keys(n);v<y.length;v++)p[S=y[v]]=n[S];c.config.customObjects=p;for(var b=Lb({},us),x=0,w=Object.keys(n);x<w.length;x++){var S=w[x];us[S]=n[S]}kP(c.config);var A=h(d,c.config,n,i);return us=Lb({},b),A}b=Lb({},us);for(var _=0,E=Object.keys(n);_<E.length;_++)S=E[_],us[S]=n[S];return A=new d(c.config),us=Lb({},b),A}function S4e(e,t){return e<t?-1:e>t?1:0}function zE(e,t){return-1*S4e(e,t)}function Wf(e){if(e==null)return e;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)===-1&&t.push(i)}return t}function E4e(e){if(e==null)throw new ie("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Ym(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new ie(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function TP(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=1/0),Zu(n>=0),Zu(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(function(i){return typeof i===t})}function Sa(e,t){Array.isArray(e)?(pt.assert(e.length>0,function(){return t+" is unexpectedly an empty array."}),e.forEach(function(n,r){return Sa(n,"element "+(r+1)+" of "+t)})):pt.assert(Number.isInteger(e)&&e>0,function(){return"Expected "+t+" to be a positive integer, but got "+nQ(e)+"."})}function nQ(e){return e===null?"null":Array.isArray(e)?"["+e.map(function(t){return nQ(t)}).join(",")+"]":typeof e=="string"?'"'+e+'"':""+e}function A4e(e,t){var n,r=pt.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=pt.now();return o-r<t?n:(r=o,n=e.apply(void 0,i))}}function rQ(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}function OP(e,t){return le(function(){return yb(Hr(YS(e,e),t,!0))})}var zb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),iQ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=OP(n,r.axis),a=xa(i,0,r.maxValue);return rt(n,kr(a,Wt(Gr(),i)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(zb);Ne.registerClass(iQ);var aQ=function(e){function t(n){var r=e.call(this)||this;return r.defaultAxis=0,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){return kr(n,Wt(Gr(),OP(n,r.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(zb);Ne.registerClass(aQ);var oQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Pf(n)},t.className="NonNeg",t}(zb);Ne.registerClass(oQ);var sQ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=n.minValue!=null?n.minValue:r.defaultMinValue,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.rate=n.rate!=null?n.rate:r.defaultRate,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=OP(n,r.axis),a=Wt(rt(r.rate,xa(i,r.minValue,r.maxValue)),rt(1-r.rate,i));return rt(n,kr(a,Wt(Gr(),i)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(zb);Ne.registerClass(sQ);var uQ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ln(e){return CP(e)}function lQ(e,t){return t===void 0&&(t={}),Bb(e,Ne.SerializationMap.getMap().classNameMap,t,"constraint")}function Kr(e){return e==null?null:typeof e=="string"?lQ({className:e in uQ?uQ[e]:e,config:{}}):e instanceof zb?e:lQ(e)}function C4e(e){return new iQ(e)}function k4e(e){return new aQ(e)}function T4e(){return new oQ}function O4e(e){return new sQ(e)}Object.freeze({maxNorm:C4e,unitNorm:k4e,nonNeg:T4e,minMaxNorm:O4e});var I4e=["channelsFirst","channelsLast"],N4e=["valid","same","causal"],D4e=["max","avg"],R4e=["sum","mul","concat","ave"],Zm=new Map;function Xr(e){Ym(I4e,"DataFormat",e)}function ls(e){Ym(N4e,"PaddingMode",e)}function cQ(e){Ym(D4e,"PoolMode",e)}var jb=[],fQ="/";function Qh(e,t){jb.push(e);try{var n=t();return jb.pop(),n}catch(r){throw jb.pop(),r}}function F4e(){return jb.length===0?"":jb.join(fQ)+fQ}function dQ(e){if(!pQ(e))throw new Error("Not a valid tensor name: '"+e+"'");return F4e()+e}function hQ(e){if(!pQ(e))throw new Error("Not a valid tensor name: '"+e+"'");Zm.has(e)||Zm.set(e,0);var t=Zm.get(e);if(Zm.set(e,Zm.get(e)+1),t>0){var n=e+"_"+t;return Zm.set(n,1),n}return e}var M4e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function pQ(e){return!!e.match(M4e)}function P4e(e){return e===parseInt(e.toString(),10)}function Vf(e,t,n){t==null&&(t=0),n==null&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r}function gQ(e){return e=Array.isArray(e)?new Float32Array(e):e,ba(e)}function Jm(e){return kE(gQ(e)).dataSync()[0]}function qf(e){return Mf(gQ(e)).dataSync()[0]}function Xs(e,t){if(t<e)throw new ie("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function Ub(e,t){return e.asType(t)}function Wb(e,t){t===void 0&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function $4e(e,t){return le(function(){if(e.shape.length!==2)throw new ie("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return NP(Wb(e,1),[1,t,1])})}function L4e(e){var t=[Vf(e.shape)];return e.reshape(t)}function B4e(e){if(e.rank<=1)throw new ie("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],Vf(e.shape,1)];return e.reshape(t)}function ep(e,t,n){return le(function(){switch(e.rank){case 1:return Ob(e,t,n);case 2:return AE(e,[t,0],[n,e.shape[1]]);case 3:return Ib(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return jm(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Mo(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Mo(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ie("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}})}function IP(e,t,n){return le(function(){switch(e.rank){case 1:return Ob(e,t,n);case 2:return AE(e,[0,t],[e.shape[0],n]);case 3:return Ib(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return jm(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function jE(e,t,n,r){return le(function(){switch(e.rank){case 1:return Ob(e,t,n);case 2:switch(r){case 1:return ep(e,t,n);case 2:return IP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return ep(e,t,n);case 2:return Ib(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return IP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return ep(e,t,n);case 2:return jm(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return jm(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return IP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function mQ(e,t){var n;return t===void 0&&(t=-1),t<0&&(t=(n=e[0].rank)!==0?n:0),t===e[0].rank&&(t=-1),Hi(e,t)}function vQ(e,t){switch(e.rank){case 1:return _3([e,t]);case 2:return S3([e,t],0);case 3:return E3([e,t],0);case 4:return A3([e,t],0);default:throw new ie("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function NP(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ie("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return cc(e,t)}function UE(e,t,n,r,i){return t===void 0&&(t=0),n===void 0&&(n=1),MM(e,t,n,r,i)}function gc(e,t,n,r){if(e.rank<2||t.rank<2)throw new $t("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&e.shape.slice(-1)[0]!==(c=t.shape.slice(-2)[0]))throw new $t("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(e.rank===2&&t.rank===2){var i=!1,a=!1;return Lf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?DP(e.rank,r,Ks()):null,activation:n})}var o=e.shape.slice(),s=o.pop();e=e.reshape([-1,s]);var u=t.shape.slice(),l=u.pop(),c=u.pop(),f=u.concat([l]),d=Array.from({length:t.rank},function(p,g){return g===0?t.rank-2:g<=t.rank-2?g-1:g});t=t.transpose(d).reshape([c,-1]);var h=o.concat(f);return i=!1,a=!1,Lf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?DP(e.rank,r,Ks()):null,activation:n}).reshape(h)}function yQ(e,t,n){return le(function(){return t=Array.isArray(t)?ba(t,"int32"):t.toInt(),Bm(e,t,n)})}function Vb(e){return YS(e,e)}function DP(e,t,n){var r=t.shape;if(t.rank!==1&&t.rank!==e)throw new ie("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(e===5){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new ie("Unsupported input rank by biasAdd: "+t.rank)}function mc(e,t,n){return le(function(){return n==null&&(n=Ks()),Xr(n),e.add(DP(e.rank,t,n))})}function z4e(e,t){if(t===void 0&&(t=1),t!==1)throw new $t("Support for alpha values other than 1 ("+t+") is not implemented yet.");return Um(e)}function j4e(e){return le(function(){return kr(e,Nf(e).add(1))})}function bQ(e,t,n,r){return le(function(){return ZM(e,t,n,r)})}function U4e(e){return le(function(){var t=Wt(.5,rt(.2,e));return xa(t,0,1)})}function Qm(e,t,n){return n===void 0&&(n=!1),n?e():t()}var W4e=["fanIn","fanOut","fanAvg"],V4e=["normal","uniform","truncatedNormal"];function q4e(e){Ym(W4e,"FanMode",e)}function H4e(e){Ym(V4e,"Distribution",e)}var Ys=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),xQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Tn(n,r)},t.className="Zeros",t}(Ys);Ne.registerClass(xQ);var RP=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Vu(n,r)},t.className="Ones",t}(Ys);Ne.registerClass(RP);var wQ=function(e){function t(n){var r=e.call(this)||this;if(typeof n!="object")throw new ie("Expected argument of type ConstantConfig but got "+n);if(n.value===void 0)throw new ie("config must have value set but got "+n);return r.value=n.value,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){return rt(Ve(i.value),Vu(n,r))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(Ys);Ne.registerClass(wQ);var _Q=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=n.minval||r.DEFAULT_MINVAL,r.maxval=n.maxval||r.DEFAULT_MAXVAL,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){return qh(n,this.minval,this.maxval,r)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(Ys);Ne.registerClass(_Q);var SQ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("randomNormal does not support dType "+r+".");return UE(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(Ys);Ne.registerClass(SQ);var EQ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("truncatedNormal does not support dType "+r+".");return kb(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(Ys);Ne.registerClass(EQ);var AQ=function(e){function t(n){var r=e.call(this)||this;return r.gain=n.gain!=null?n.gain:1,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2||n[0]!==n[1])throw new ie("Identity matrix initializer can only be used for 2D square matrices.");return rt(i.gain,pE(n[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(Ys);function G4e(e,t){var n,r;if(t===void 0&&(t="channelsLast"),Xr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1)if(t==="channelsFirst"){var i=Vf(e,2);n=e[1]*i,r=e[0]*i}else t==="channelsLast"&&(i=Vf(e,0,e.length-2),n=e[e.length-2]*i,r=e[e.length-1]*i);else{var a=Vf(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}Ne.registerClass(AQ);var ro=function(e){function t(n){var r=e.call(this)||this;if(n.scale<0)throw new ie("scale must be a positive float. Got: "+n.scale);return r.scale=n.scale==null?1:n.scale,r.mode=n.mode==null?"fanIn":n.mode,q4e(r.mode),r.distribution=n.distribution==null?"normal":n.distribution,H4e(r.distribution),r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=G4e(n),a=i[0],o=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,a):this.mode==="fanOut"?s/=Math.max(1,o):s/=Math.max(1,(a+o)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t(this.getClassName()+" does not support dType "+r+".");return kb(n,0,u,r,this.seed)}var l=Math.sqrt(3*s);return qh(n,-l,l,r)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(Ys);Ne.registerClass(ro);var FP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="GlorotUniform",t}(ro);Ne.registerClass(FP);var MP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="GlorotNormal",t}(ro);Ne.registerClass(MP);var PP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="HeNormal",t}(ro);Ne.registerClass(PP);var $P=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="HeUniform",t}(ro);Ne.registerClass($P);var LP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="LeCunNormal",t}(ro);Ne.registerClass(LP);var BP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="LeCunNormal",t}(ro);Ne.registerClass(BP);var CQ=function(e){function t(n){var r=e.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=n.gain==null?r.DEFAULT_GAIN:n.gain,r.seed=n.seed,r.seed!=null)throw new $t("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2)throw new $t("The Orthogonal Initializer does not support non-2D shapes yet.");n[0]*n[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+n[0]*n[1]+") elements: Slowness may result.");var a=UE(n[0]>n[1]?[n[1],n[0]]:n,0,1,"float32"),o=eP.gramSchmidt(a);return n[0]>n[1]&&(o=o.transpose()),rt(i.gain,o)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(Ys);Ne.registerClass(CQ);var kQ={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function TQ(e,t){return t===void 0&&(t={}),Bb(e,Ne.SerializationMap.getMap().classNameMap,t,"initializer")}function vn(e){return CP(e)}function rr(e){if(typeof e=="string"){var t=e in kQ?kQ[e]:e;if(t==="GlorotNormal")return new MP;if(t==="GlorotUniform")return new FP;if(t==="HeNormal")return new PP;if(t==="HeUniform")return new $P;if(t==="LeCunNormal")return new LP;if(t==="LeCunUniform")return new BP;var n={};return n.className=t,n.config={},TQ(n)}return e instanceof Ys?e:TQ(e)}function K4e(){return new xQ}function X4e(){return new RP}function Y4e(e){return new wQ(e)}function Z4e(e){return new _Q(e)}function J4e(e){return new SQ(e)}function Q4e(e){return new EQ(e)}function eBe(e){return new AQ(e)}function tBe(e){return new ro(e)}function nBe(e){return new FP(e)}function rBe(e){return new MP(e)}function iBe(e){return new PP(e)}function aBe(e){return new $P(e)}function oBe(e){return new LP(e)}function sBe(e){return new BP(e)}function uBe(e){return new CQ(e)}Object.freeze({zeros:K4e,ones:X4e,constant:Y4e,randomUniform:Z4e,randomNormal:J4e,truncatedNormal:Q4e,identity:eBe,varianceScaling:tBe,glorotUniform:nBe,glorotNormal:rBe,heNormal:iBe,heUniform:aBe,leCunNormal:oBe,leCunUniform:sBe,orthogonal:uBe});var lBe=0;function OQ(){return lBe++}var WE={};function VE(e){return e===void 0&&(e=""),e in WE||(WE[e]=0),WE[e]+=1,e+WE[e].toString()}function zP(e){return Array.isArray(e)&&Array.isArray(e[0])}function qE(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Dt(e){var t;if(Array.isArray(e)){if(e.length!==1)throw new ie("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function Xn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return(e=e)[0];throw new ie("Expected exactly 1 Shape; got "+e.length)}return e}function HE(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];i.shape.length===0?t+=1:t+=i.shape.reduce(function(a,o){return a*o})}return t}var IQ="Variable",cBe=function(){function e(t,n,r,i,a){n===void 0&&(n="float32"),r===void 0&&(r=IQ),i===void 0&&(i=!0),a===void 0&&(a=null),this.dtype=n??"float32",this.shape=t.shape,this.id=OQ(),r=r??IQ,this.originalName=dQ(r),this.name=hQ(this.originalName),this.trainable_=i,this.constraint=a,this.val=x3(t,this.trainable_,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(t){return this.assertNotDisposed(),fBe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),e}();function fBe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function jP(e){return e.map(function(t){return t.read()})}function UP(e){e.forEach(function(t){t[0].write(t[1])})}var Mi=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}(),Ju=function(){return function(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=OQ(),a!=null&&(this.originalName=dQ(a),this.name=hQ(this.originalName)),this.rank=t.length}}(),dBe=0,GE=function(){function e(t,n){this.callArgs=n,this.id=dBe++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var r=0,i=t.inboundLayers;r<i.length;r++){var a=i[r];a!=null&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var t=[],n=0,r=this.inboundLayers;n<r.length;n++){var i=r[n];i!=null?t.push(i.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),hBe=0,tn=function(e){function t(n){var r=e.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=hBe++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=n.name;if(!i){var a=r.getClassName();i=pc(a)+"_"+VE(a)}if(r.name=i,r.trainable_=n.trainable==null||n.trainable,n.inputShape!=null||n.batchInputShape!=null){var o=void 0;if(n.batchInputShape!=null)o=n.batchInputShape;else if(n.inputShape!=null){var s=null;n.batchSize!=null&&(s=n.batchSize),o=[s].concat(n.inputShape)}r.batchInputShape=o;var u=n.dtype;u==null&&(u=n.inputDType),u==null&&(u="float32"),r.dtype=u}return n.weights!=null?r.initialWeights=n.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return Ee(t,e),t.nodeKey=function(n,r){return n.name+"_ib-"+r.toString()},t.prototype.getNodeAtIndex=function(n,r){if(this.inboundNodes.length===0)throw new Yu("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=n)throw new ie("Asked to get "+r+" at node "+n+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[n]},t.prototype.getInputAt=function(n){return _a(this.getNodeAtIndex(n,"input").inputTensors)},t.prototype.getOutputAt=function(n){return _a(this.getNodeAtIndex(n,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Yh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Yh("Layer "+this.name+" is not connected, no input to return.");return _a(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Yh("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Yh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return _a(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(n){return n()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(n){this._built=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this._trainableWeights.forEach(function(r){return r.trainable=n}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(n){return n.trainable}):[]},set:function(n){this._trainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(n){return!n.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(n){this._nonTrainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(n){if(n=Qn(n),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Qn(this.inputSpec);if(n.length!==r.length)throw new ie("Layer "+this.name+" expects "+r.length+" inputs, but it received "+n.length+" input tensors. Input received: "+n);for(var i=0;i<n.length;i++){var a=n[i],o=r[i];if(o!=null){var s=a.rank;if(o.ndim!=null&&s!==o.ndim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+s);if(o.maxNDim!=null&&s>o.maxNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+s);if(o.minNDim!=null&&s<o.minNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+s+".");if(o.dtype!=null&&a.dtype!==o.dtype)throw new ie("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+a.dtype+".");if(o.axes){var u=a.shape;for(var l in o.axes){var c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+f+" but got shape "+u+".")}}if(o.shape!=null)for(var h=0;h<o.shape.length;++h){var p=o.shape[h],g=a.shape[h];if(p!=null&&g!=null&&p!==g)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape="+a.shape+".")}}}}},t.prototype.call=function(n,r){return n},t.prototype.invokeCallHook=function(n,r){this._callHook!=null&&this._callHook(n,r)},t.prototype.setCallHook=function(n){this._callHook=n},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(n,r){var i=this;r=r||{},this.assertNotDisposed();for(var a=Qn(n),o=!0,s=0,u=a;s<u.length;s++)if(!(u[s]instanceof Ju)){o=!1;break}for(var l=!0,c=0,f=a;c<f.length;c++)if(f[c]instanceof Ju){l=!1;break}if(o===l)throw new ie("Arguments to apply() must be all SymbolicTensors or all Tensors");return Qh(this.name,function(){if(!i.built){i.assertInputCompatibility(n);for(var d=[],h=0,p=Qn(n);h<p.length;h++){var g=p[h];d.push(g.shape)}i.build(_a(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(n),l){for(var m=[],v=0,y=Qn(S=i.call(n,r));v<y.length;v++){var b=y[v];a.indexOf(b)!==-1&&(b=b.clone()),m.push(b)}if(S=_a(m),i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S}var x=pBe(n),w=i.computeOutputShape(x),S=void 0,A=gBe(n);if(i.warnOnIncompatibleInputShape(Array.isArray(n)?x[0]:x),S=w!=null&&w.length>0&&Array.isArray(w[0])?w.map(function(_,E){return new Ju(A,_,i,Qn(n),r,i.name,E)}):new Ju(A,w,i,Qn(n),r,i.name),i.addInboundNode(n,S,null,null,x,w,r),i._refCount++,i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S})},t.prototype.warnOnIncompatibleInputShape=function(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(n)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,a){i!=null&&n[a]!=null&&n[a]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(n)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Yh("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var n=[],r=0,i=this.inboundNodes;r<i.length;r++){var a=i[r],o=JSON.stringify(a.outputShapes);n.indexOf(o)===-1&&n.push(o)}if(n.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new Yh("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new Yu("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return HE(this.weights)},t.prototype.build=function(n){this.built=!0},t.prototype.getWeights=function(n){return n===void 0&&(n=!1),jP(n?this.trainableWeights:this.weights)},t.prototype.setWeights=function(n){var r=this;le(function(){var i=r.weights;if(i.length!==n.length)throw new ie('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+n.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+n+"...");if(i.length!==0){for(var a=[],o=jP(i),s=0;s<o.length;++s){var u=o[s],l=i[s],c=n[s];if(!pt.arraysEqual(u.shape,c.shape))throw new ie("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);a.push([l,c])}UP(a)}})},t.prototype.addWeight=function(n,r,i,a,o,s,u){if(this._addedWeightNames.indexOf(n)!==-1)throw new ie("Duplicate weight name "+n+" for layer "+this.name);this._addedWeightNames.push(n),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(a=rr("zeros"));var l=a.apply(r,i),c=new cBe(l,i,n,s,u);return l.dispose(),o!=null&&this.addLoss(function(){return o.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},t.prototype.setFastWeightInitDuringBuild=function(n){this.fastWeightInitDuringBuild=n},t.prototype.addLoss=function(n){var r;n==null||Array.isArray(n)&&n.length===0||(n=Qn(n),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,n))},t.prototype.computeOutputShape=function(n){return n},t.prototype.computeMask=function(n,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(a){if(a!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},t.prototype.addInboundNode=function(n,r,i,a,o,s,u){u===void 0&&(u=null);var l=Qn(n);r=Qn(r),i=Qn(i),a=Qn(a),o=qE(o),s=qE(s);for(var c=[],f=[],d=[],h=0,p=l;h<p.length;h++){var g=p[h];c.push(g.sourceLayer),f.push(g.nodeIndex),d.push(g.tensorIndex)}new GE({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:a,inputShapes:o,outputShapes:s},u);for(var m=0;m<r.length;m++)r[m].sourceLayer=this,r[m].nodeIndex=this.inboundNodes.length-1,r[m].tensorIndex=m},t.prototype.getConfig=function(){var n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n},t.prototype.disposeWeights=function(){return this.weights.forEach(function(n){return n.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var n=0;return--this._refCount==0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}},t}(Ne.Serializable);function pBe(e){for(var t=[],n=0,r=e=Qn(e);n<r.length;n++){var i=r[n];t.push(i.shape)}return _a(t)}function gBe(e){return"float32"}function NQ(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];var r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],a=0;a<r.inboundLayers.length;a++)for(var o=0,s=NQ(r.inputTensors[a],r.inboundLayers[a],r.nodeIndices[a]);o<s.length;o++){var u=s[o];i.indexOf(u)===-1&&i.push(u)}return i}var DQ,qb=function(e){function t(n){var r=e.call(this,{dtype:n.dtype,name:n.name!=null?n.name:VE("input").toString()})||this;if(n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new ie("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=n.batchInputShape;if(i==null){if(n.inputShape==null)throw new ie("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new ie("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=n.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new Ju(r.dtype,r.batchInputShape,r,[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new GE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return Ee(t,e),t.prototype.apply=function(n,r){throw new ie("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(tn);function RQ(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new ie("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));var n=e.dtype;return n==null&&(n="float32"),new qb({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function Hf(e){return Ct(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(e==null)return[2];for(i in t=[],n=[],r=[],e)typeof(a=e[i])!="number"&&(o=a,t.push(o.data()),n.push(i),r.push(o));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];Ut(r),l.label=2;case 2:return[2]}})})}function FQ(e){if(e!=null)for(var t in e){var n=e[t];typeof n!="number"&&n.dispose()}}Ne.registerClass(qb),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(DQ||(DQ={}));var mBe=125,ev=function(){function e(){this.validationData=null}return e.prototype.setParams=function(t){this.params=t},e.prototype.onEpochBegin=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onEpochEnd=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchBegin=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchEnd=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onTrainBegin=function(t){return Ct(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.onTrainEnd=function(t){return Ct(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.setModel=function(t){},e}(),vBe=function(){function e(t,n){n===void 0&&(n=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=n}return e.prototype.append=function(t){this.callbacks.push(t)},e.prototype.setParams=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setParams(t)},e.prototype.setModel=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setModel(t)},e.prototype.onEpochBegin=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(t){return Ct(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainBegin(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(t){return Ct(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainEnd(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e}(),yBe=function(e){function t(){return e.call(this)||this}return Ee(t,e),t.prototype.onEpochBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u=this;return St(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,a=function(c){var f=r[c];if(typeof f=="number")o.totals.hasOwnProperty(c)||(o.totals[c]=0),o.totals[c]=o.totals[c]+f*i;else{var d=void 0;c in o.totals?d=o.totals[c]:o.totals[c]=0;var h=le(function(){return Wt(u.totals[c],rt(f,i))});o.totals[c]=h,d!=null&&d.dispose()}},o=this,r)a(s);return[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l=this;return St(this,function(c){if(r!=null)for(i=function(f){if(a.totals[f]==null)return"continue";typeof a.totals[f]=="number"?r[f]=a.totals[f]/a.seen:le(function(){var d=rt(kr(1,l.seen),l.totals[f]);r[f]=d,l.totals[f].dispose(),ju(r[f])})},a=this,o=0,s=this.params.metrics;o<s.length;o++)u=s[o],i(u);return[2]})})},t}(ev),bBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){for(i in r==null&&(r={}),this.epoch.push(n),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},t.prototype.syncData=function(){return Ct(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return St(this,function(f){switch(f.label){case 0:for(a in n=[],r=[],i=[],this.history)for(o=this.history[a],s=0;s<o.length;++s)typeof o[s]!="number"&&(u=o[s],n.push(u.data()),r.push(a),i.push(s));return[4,Promise.all(n)];case 1:for(l=f.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},t}(ev),xBe=function(e){function t(n,r){var i=e.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=mBe),i.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return pt.isNumber(i.yieldEvery)&&(i.maybeWait=A4e(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=n.onTrainBegin,i.trainEnd=n.onTrainEnd,i.epochBegin=n.onEpochBegin,i.epochEnd=n.onEpochEnd,i.batchBegin=n.onBatchBegin,i.batchEnd=n.onBatchEnd,i.yield=n.onYield,i}return Ee(t,e),t.prototype.maybeWait=function(n,r,i){return Ct(this,void 0,void 0,function(){var a;return St(this,function(o){switch(o.label){case 0:return a=[],this.yield==null?[3,2]:[4,Hf(i)];case 1:o.sent(),a.push(this.yield(n,r,i)),o.label=2;case 2:return a.push(BE()),[4,Promise.all(a)];case 3:return o.sent(),[2]}})})},t.prototype.onEpochBegin=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.currentEpoch=n,this.epochBegin==null?[3,3]:[4,Hf(r)];case 1:return i.sent(),[4,this.epochBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Hf(r)];case 1:a.sent(),i.push(this.epochEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(BE()),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onBatchBegin=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Hf(r)];case 1:return i.sent(),[4,this.batchBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Hf(r)];case 1:a.sent(),i.push(this.batchEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="batch"?i.push(BE()):pt.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,n,r)),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Hf(n)];case 1:return r.sent(),[4,this.trainBegin(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Hf(n)];case 1:return r.sent(),[4,this.trainEnd(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}(ev);function MQ(e,t){return e==null&&(e={}),e instanceof ev?[e]:Array.isArray(e)&&e[0]instanceof ev?e:Qn(e).map(function(n){return new xBe(n,t)})}var wBe=function(){function e(){}return e.registerCallbackConstructor=function(t,n){pt.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),e.checkForDuplicate(n),e.constructors[t]==null&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach(function(r){if(r===t)throw new ie("Duplicate callback constructor.")})},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var i=+r;t>=i&&n.push.apply(n,e.constructors[i])}return n.map(function(a){return new a})},e.constructors={},e}();function PQ(e,t,n,r,i,a,o,s,u){var l=new bBe,c=[new yBe].concat(wBe.createCallbacks(t));e!=null&&c.push.apply(c,e),c.push(l);var f=new vBe(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:l}}function Zs(e,t,n){return t===void 0&&(t={}),n===void 0&&(n=!1),Bb(e,Ne.SerializationMap.getMap().classNameMap,t,"layer",n)}function KE(e,t){return le(function(){e.dtype!=="float32"&&(e=e.asType("float32"));var n=Hr(Vb(e),t,!0),r=Tm(n.shape,Gr()),i=yb(qu(n,r));return kr(e,i)})}function tp(e,t){return le(function(){return Pr(Vb(Cr(t,e)),-1)})}function XE(e,t){return le(function(){return Pr(Nf(Cr(t,e)),-1)})}function tv(e,t){return le(function(){var n=Cr(e,t),r=xa(Nf(e),Gr(),Number.MAX_VALUE),i=Nf(kr(n,r));return rt(100,Pr(i,-1))})}function _Be(e,t){return le(function(){var n=xa(t,Gr(),Number.MAX_VALUE),r=lc(Wt(1,n)),i=xa(e,Gr(),Number.MAX_VALUE),a=lc(Wt(1,i));return Pr(Vb(Cr(r,a)),-1)})}function SBe(e,t){return le(function(){var n=qu(0,Cr(1,rt(e,t)));return Pr(Vb(n),-1)})}function EBe(e,t){return le(function(){var n=qu(0,Cr(1,rt(e,t)));return Pr(n,-1)})}function ABe(e,t){return le(function(){var n=Hr(rt(e,t),-1),r=Mf(rt(Cr(1,e),t),-1);return qu(0,Wt(1,Cr(r,n)))})}function CBe(e,t){return le(function(){var n=Math.log(2),r=Cr(t,e),i=Cr(Wt(r,vb(rt(-2,r))),n);return Pr(i,-1)})}function Hb(e,t,n){return n===void 0&&(n=!1),le(function(){if(n)t=$h(t);else{var r=Hr(t,t.shape.length-1,!0);t=kr(t,r)}return t=xa(t,Gr(),1-Gr()),Df(Hr(rt(e.toFloat(),lc(t)),t.shape.length-1))})}function YE(e,t){return le(function(){var n=qS(L4e(e)).toInt(),r=(t=xa(t,Gr(),1-Gr())).shape;return Hb(Vh(n,r[r.length-1]).reshape(r),t,!1)})}function kBe(e,t){if(!pt.arraysEqual(e.shape,t.shape))throw new ie("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return le(function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())})}function ZE(e,t){return le(function(){var n;return n=xa(t,Gr(),1-Gr()),n=lc(kr(n,Cr(1,n))),Pr(kBe(e,n),-1)})}function TBe(e,t){return le(function(){var n=xa(e,Gr(),1),r=xa(t,Gr(),1);return Hr(rt(e,lc(kr(n,r))),-1)})}function OBe(e,t){return le(function(){var n=lc(Wt(Gr(),t));return Pr(Cr(t,rt(e,n)),-1)})}function WP(e,t){return le(function(){var n=KE(e,-1),r=KE(t,-1),i=rt(n,r);return Df(Hr(i,-1))})}var JE={meanSquaredError:tp,meanAbsoluteError:XE,meanAbsolutePercentageError:tv,meanSquaredLogarithmicError:_Be,squaredHinge:SBe,hinge:EBe,categoricalHinge:ABe,logcosh:CBe,categoricalCrossentropy:Hb,sparseCategoricalCrossentropy:YE,binaryCrossentropy:ZE,kullbackLeiblerDivergence:TBe,poisson:OBe,cosineProximity:WP};function VP(e){if(typeof e=="string"){if(e in JE)return JE[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ie(t)}return e}function qP(e,t){return le(function(){var n=rt(.5,Ro(t)),r=Ub($m(t,n),e.dtype);return Pr(Hh(e,r),-1)})}function HP(e,t){return le(function(){return Ub(Hh(Db(e,-1),Db(t,-1)),"float32")})}function $Q(e,t){return le(function(){return Gu(e.equal(1),t.equal(1)).sum().cast("float32")})}function IBe(e,t){return le(function(){return Gu(e.equal(1),t.equal(0)).sum().cast("float32")})}function NBe(e,t){return le(function(){return Gu(e.equal(0),t.equal(1)).sum().cast("float32")})}function LQ(e,t){return le(function(){var n=$Q(e,t),r=NBe(e,t),i=n.add(r);return Gs($m(i,0),n.div(i),0).cast("float32")})}function DBe(e,t){return le(function(){var n=$Q(e,t),r=IBe(e,t),i=n.add(r);return Gs($m(i,0),n.div(i),0).cast("float32")})}function BQ(e,t){return ZE(e,t)}function zQ(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),Hh(e,t).asType("float32")}var RBe=tp,FBe=tp,MBe=XE,PBe=XE,$Be=tv,LBe=tv,GP=Hb,BBe=WP,jQ=YE,QE={binaryAccuracy:qP,categoricalAccuracy:HP,precision:LQ,categoricalCrossentropy:GP,sparseCategoricalCrossentropy:jQ,mse:RBe,MSE:FBe,mae:MBe,MAE:PBe,mape:$Be,MAPE:LBe,cosine:BBe};function zBe(e){if(typeof e=="string"&&e in QE)return QE[e];if(typeof e!="string"&&e!=null)return e;throw new ie("Unknown metric "+e)}function eA(e){if(Zu(e!==null,"Unknown LossOrMetricFn "+e),typeof e=="string")return e;for(var t=void 0,n=0,r=Object.keys(JE);n<r.length;n++){var i=r[n];if(JE[i]===e){t=i;break}}if(t!==void 0)return t;for(var a=0,o=Object.keys(QE);a<o.length;a++)if(i=o[a],QE[i]===e){t=i;break}return t!==void 0?t:e.name}function jBe(e){var t={Adagrad:function(){return Uf.adagrad(.01)},Adadelta:function(){return Uf.adadelta(1,.95,Gr())},Adam:function(){return Uf.adam(.001,.9,.999,Gr())},Adamax:function(){return Uf.adamax(.002,.9,.999,Gr(),0)},RMSProp:function(){return Uf.rmsprop(.001,.9,0,Gr())},SGD:function(){return Uf.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ie("Unknown Optimizer "+e)}var UQ=1048576;function WQ(e,t,n){if(n===void 0&&(n=!1),e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!KP(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>UQ&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+UQ+".")}}function KP(e){if(e===null)return!0;if(typeof e=="object"){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(typeof r!="string"||!KP(e[r]))return!1}return!0}if(Array.isArray(e)){for(var i=0,a=e;i<a.length;i++)if(!KP(a[i]))return!1;return!0}return!1}var o=typeof e;return o==="string"||o==="number"||o==="boolean"}function UBe(e,t,n,r){r===void 0&&(r=console.log);var i,a=VBe(e),o=["Layer (type)","Output shape","Param #"];if(a?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(d){return Math.floor(t*d)})),!a)for(var s in o.push("Receives inputs"),i=[],e.nodesByDepth)i.push.apply(i,e.nodesByDepth[s]);r("_".repeat(t)),tA(o,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)a?qBe(u[l],n,r):HBe(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=WBe(e),f=HE(e.nonTrainableWeights);r("Total params: "+(c+f)),r("Trainable params: "+c),r("Non-trainable params: "+f),r("_".repeat(t))}function WBe(e){return e.collectedTrainableWeights!=null?HE(e.collectedTrainableWeights):HE(e.trainableWeights)}function VBe(e){var t=!0,n=[],r=[];for(var i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,f=0,d=l[u].inboundNodes;f<d.length;f++){var h=d[f];if(r.indexOf(h)!==-1){if(c){t=!1;break}c=!0}}if(!t)break}return t}function tA(e,t,n){n===void 0&&(n=console.log);for(var r="",i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[i]).slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function qBe(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(i){r="multiple"}tA([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function HBe(e,t,n,r){var i;try{i=JSON.stringify(e.outputShape)}catch(m){i="multiple"}for(var a=[],o=0,s=e.inboundNodes;o<s.length;o++){var u=s[o];if(!(n!=null&&n.length>0&&n.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,f=u.nodeIndices[l],d=u.tensorIndices[l];a.push(c+"["+f+"]["+d+"]")}}var h=e.name,p=e.getClassName(),g=a.length===0?"":a[0];for(tA([h+" ("+p+")",i,e.countParams().toString(),g],t,r),l=1;l<a.length;++l)tA(["","","",a[l]],t,r)}function VQ(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Gb(e,t){if(e===null)return null;if(typeof e=="string")return Jh(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];VQ(t,i,a)?n.push(a):n.push(Gb(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if(l==="name"&&typeof c=="string")o[l]=c;else{var f=Jh(l);o[f]=Gb(c,f)}}return o}function XP(e,t){if(e==null)return null;if(typeof e=="string")return pc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];VQ(t,i,a)?n.push(a):n.push(XP(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],f=pc(l);o[f]=l!=="name"&&l!=="className"||typeof c!="string"?XP(c,l):c}return o}var qQ="1.7.4";function GBe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return zS(t,e.dtype)}catch(n){throw new ie("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}var nv=function(){function e(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(var r=0,i=t;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return e.prototype.add=function(t,n,r){if(this.id2Value[t.id]!=null)throw new ie("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=GBe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r),this},e.prototype.addFeed=function(t){this.add(t.key,t.value)},e.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(t){if(t instanceof Ju){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Value[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[n]},e.prototype.getMask=function(t){if(t instanceof Ju){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[n]},e.prototype.disposeMasks=function(){this.id2Mask!=null&&Ut(this.id2Mask)},e}(),YP={},HQ={};function Kb(e,t,n,r){for(var i=n!=null&&n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(function(ee){return ee.name}),u=[],l=t.names(),c=0,f=s;c<f.length;c++){var d=f[c];l.indexOf(d)!==-1?u.push(t.getValue(d)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p,g=s.join(",")+"|"+t.names().join(",");if(YP[g]==null){var m=KBe(o,t);h=m.sorted,p=m.recipientCounts,YP[g]=h,HQ[g]=p}h=YP[g],p={},i||Object.assign(p,HQ[g]);for(var v=new nv(t),y=0;y<h.length;++y){if(r!=null){var b=MS().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=h[y],w=x.sourceLayer;if(!(w instanceof qb)){for(var S=[],A=[],_=[],E=!1,C=0,k=x.inputs;C<k.length;C++){var T=k[C],I=v.getValue(T),N=v.getMask(T);S.push(I),A.push(N),N!=null&&(E=!0),i||(p[T.name]--,p[T.name]!==0||t.hasKey(T)||s.indexOf(T.name)!==-1||I.isDisposed||T.sourceLayer.stateful===!0||_.push(I))}E&&((n=n||{}).mask=A[0]);var O=Qn(w.apply(S,n)),D=null;w.supportsMasking&&(D=w.computeMask(S,A));for(var L=YBe(x),W=Array.isArray(L)?L:[L],G=0;G<W.length;++G){v.hasKey(W[G])||v.add(W[G],O[G],Array.isArray(D)?D[0]:D);var K=s.indexOf(W[G].name);K!==-1&&(u[K]=O[G])}i||Ut(_)}}return v.disposeMasks(),a?u:u[0]}function KBe(e,t){pt.assert(e!=null&&e.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(e.length===1){var i=GQ(e[0],t);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=e;o<s.length;o++){for(var u=GQ(s[o],t),l=u.sorted,c=u.recipientMap,f=0,d=l;f<d.length;f++){var h=d[f];a.has(h.name)||(n.push(h),a.add(h.name))}var p=function(m){r[m]==null&&(r[m]=new Set),c[m].forEach(function(v){return r[m].add(v)})};for(var g in c)p(g)}return{sorted:n,recipientCounts:XBe(r)}}function XBe(e){var t={};for(var n in e)t[n]=e[n].size;return t}function GQ(e,t){for(var n=new Set,r=[],i={},a=0,o=t.names();a<o.length;a++){var s=o[a];n.add(s)}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(n.has(c.name))u.pop();else{var f=l[l.length-1]===u.length-1;if(c.inputs.length===0||f)u.pop(),r.push(c),n.add(c.name),f&&l.pop();else{l.push(u.length-1);for(var d=0,h=c.inputs;d<h.length;d++){var p=h[d];i[p.name]==null&&(i[p.name]=new Set),i[p.name].add(c.name),n.has(p.name)||u.push(p)}}}}return{sorted:r,recipientMap:i}}function YBe(e){var t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var i=0,a=e.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var ZBe=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=VE(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],Wf(r.inputs).length!==r.inputs.length)throw new ie("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(Je){return Je.name}));Wf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(Je){return Je.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(C=o[a]).sourceLayer,u=C.nodeIndex,l=C.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,f=r.inputs;c<f.length;c++)s=(C=f[c]).sourceLayer,u=C.nodeIndex,l=C.tensorIndex,Zu(u===0,"input layer has >1 nodes"),Zu(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof qb))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,p=r.outputLayers;h<p.length;h++)s=p[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(Je){return Je.shape}),r.internalOutputShapes=r.outputs.map(function(Je){return Je.shape});for(var g={},m={},v={},y={},b={},x=[],w=function(Je,Zt,mn,Hn,ni,tr){Hn!=null&&ni!=null&&tr!=null||(Hn=Je.sourceLayer,ni=Je.nodeIndex,tr=Je.tensorIndex);var Dn=Hn.inboundNodes[ni];if(mn.indexOf(Dn)!==-1)throw new Yu("The tensor "+Je.name+' at layer "'+Hn.name+'" is part of a cycle.');if(Zt.indexOf(Dn)===-1){r.containerNodes.add(t.nodeKey(Hn,ni)),Hn.id in b||(b[Hn.id]=Object.keys(b).length),mn.indexOf(Dn)===-1&&mn.push(Dn);for(var es=Dn.inboundLayers.length,Ka=0;Ka<es;Ka++){var Ul=Dn.inputTensors[Ka],Os=Dn.inboundLayers[Ka],Is=Dn.nodeIndices[Ka],Wl=Dn.tensorIndices[Ka];w(Ul,Zt,mn,Os,Is,Wl)}for(Zt.push(Dn);mn.indexOf(Dn)>=0;)mn.splice(mn.indexOf(Dn),1);x.push(Dn)}},S=[],A=[],_=0,E=r.outputs;_<E.length;_++){var C=E[_];w(C,S,A)}for(var k=0,T=x.slice().reverse();k<T.length;k++){m[(B=T[k]).id]=B,B.id in g||(g[B.id]=0);var I=g[B.id],N=v[B.outboundLayer.id]==null?0:v[B.outboundLayer.id];for(I=Math.max(I,N),v[B.outboundLayer.id]=I,y[B.outboundLayer.id]=B.outboundLayer,g[B.id]=I,d=0;d<B.inboundLayers.length;d++){var O=B.inboundLayers[d],D=(u=B.nodeIndices[d],O.inboundNodes[u]),L=g[D.id]==null?0:g[D.id];g[D.id]=Math.max(I+1,L),m[D.id]=D}}var W={};for(var G in g)(I=g[G])in W||(W[I]=[]),W[I].push(m[G]);var K={};for(var ee in v)(I=v[ee])in K||(K[I]=[]),K[I].push(y[ee]);var ce=Object.keys(K).map(function(Je){return parseInt(Je,10)}).sort(zE);r.layers=[];for(var he=0,Oe=ce;he<Oe.length;he++){var Te=K[I=Oe[he]];Te.sort(function(Je,Zt){var mn=b[Je.id],Hn=b[Zt.id];return mn<Hn?-1:mn>Hn?1:0});for(var Re=0,me=Te;Re<me.length;Re++)(s=me[Re])instanceof t&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=K,ce=Object.keys(W).map(function(Je){return parseInt(Je,10)}).sort(zE);for(var P=r.inputs.slice(),F=[],V=0,ae=ce;V<ae.length;V++)for(var Y=0,M=W[I=ae[V]];Y<M.length;Y++){var B;if((s=(B=M[Y]).outboundLayer)!=null){for(var R=0,X=B.inputTensors;R<X.length;R++)if(C=X[R],P.indexOf(C)===-1)throw new Yu("Graph disconnected: cannot obtain value for tensor "+C+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+F);for(var ge=0,xe=B.outputTensors;ge<xe.length;ge++)C=xe[ge],P.push(C);F.push(s.name)}}r.nodesByDepth=W;for(var ze=r.layers.map(function(Je){return Je.name}),Ke=function(Je){var Zt=ze.filter(function(mn){return mn===Je}).length;if(Zt!==1)throw new Yu('The name "'+Je+'" is used '+Zt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(ze))},Ze=0,Bt=ze;Ze<Bt.length;Ze++)Ke(Bt[Ze]);return r.outboundNodes=[],r.inboundNodes=[],new GE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(Je){return null}),outputMasks:r.outputs.map(function(Je){return null}),inputShapes:r.inputs.map(function(Je){return Je.shape}),outputShapes:r.outputs.map(function(Je){return Je.shape})}),r.built=!0,r._refCount=1,r}return Ee(t,e),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var a=i[r];n.numDisposedVariables+=a.dispose().numDisposedVariables}for(var o=0,s=this.internalContainerRefs;o<s.length;o++){var u=s[o];n.numDisposedVariables+=u.dispose().numDisposedVariables}}return n.refCountAfterDispose=this._refCount,n},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=n})}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ie("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n=n.concat(a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.layers;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(n,r){r===void 0&&(r=!0);for(var i={},a=0,o=0,s=this.layers;o<s.length;o++)for(var u=0,l=s[o].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new ie("Duplicate weight name: "+c.originalName);i[c.originalName]=c,a++}var f=[];for(var d in n){if(i[d]!=null)f.push([i[d],n[d]]);else if(r)throw new ie("Provided weight data has no target variable: "+d);delete i[d]}if(r){var h=[];for(var p in i)h.push(p);if(h.length>0)throw new ie(h.length+" of "+a+" weights are not set: "+h)}UP(f)},t.prototype.updatedConfig=function(){var n=this.getConfig(),r={};return r.className=this.getClassName(),r.config=n,r.kerasVersion="tfjs-layers "+qQ,r.backend="TensorFlow.js",r},t.prototype.toJSON=function(n,r){r===void 0&&(r=!0);var i=XP(this.updatedConfig());return r?JSON.stringify(i):i},t.prototype.call=function(n,r){var i=this;return le(function(){n=Qn(n);for(var a=new nv,o=0;o<i.inputs.length;++o)a.add(i.inputs[o],n[o]);return Kb(i.outputs,a,r)})},t.prototype.computeMask=function(n,r){var i=this;return le(function(){var a;return n=Qn(n),a=r==null?Zh(null,n.length):Qn(r),i.runInternalGraph(n,a)[1]})},t.prototype.computeOutputShape=function(n){var r=qE(n);if(r.length!==this.inputLayers.length)throw new ie("Invalid inputShape argument "+n+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},a=0;a<r.length;a++){var o=this.inputLayers[a],s=r[a];i[E=o.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(k){return parseInt(k,10)}).sort(zE);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){var p=h[d];if(o=p.outboundLayer,this.inputLayers.map(function(k){return k.id}).indexOf(o.id)===-1){for(var g=[],m=0;m<p.inboundLayers.length;m++){var v=p.inboundLayers[m],y=p.nodeIndices[m],b=p.tensorIndices[m],x=i[E=v.name+"_"+y+"_"+b];g.push(x)}var w=qE(o.computeOutputShape(_a(g))),S=o.inboundNodes.indexOf(p);for(m=0;m<w.length;m++)i[E=o.name+"_"+S+"_"+m]=w[m]}}var A=[],_=[];for(a=0;a<this.outputLayers.length;a++){o=this.outputLayers[a],S=this.outputLayersNodeIndices[a],b=this.outputLayersTensorIndices[a];var E=o.name+"_"+S+"_"+b;_.push(E)}for(a=0;a<_.length;a++){var C=_[a];Zu(C in i),A.push(i[C])}return _a(A)},t.prototype.runInternalGraph=function(n,r){r==null&&(r=Zh(null,n.length));for(var i={},a=0;a<this.inputs.length;++a){var o=this.inputs[a],s=n[a],u=r[a];i[o.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(K){return parseInt(K,10)}).sort(zE);l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){for(var p=h[d],g=p.outboundLayer,m=p.inputTensors,v=p.outputTensors,y=new Array,b=0,x=m;b<x.length;b++)(o=x[b]).id in i&&y.push(i[o.id]);if(y.length===m.length){var w={},S=void 0,A=void 0,_=void 0,E=void 0;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){var C=y[0],k=C[0],T=C[1];w.mask==null&&(w.mask=T),_=Qn(g.call(k,w)),E=Qn(g.computeMask(k,T)),S=[k],A=[T]}else S=y.map(function(K){return K[0]}),A=y.map(function(K){return K[1]}),w.mask==null&&(w.mask=A),_=Qn(g.call(S,w)),E=Qn(g.computeMask(S,A));if(g.activityRegularizer)throw new $t("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<v.length;++a)o=v[a],s=_[a],u=E[a],i[o.id]=[s,u]}}for(var I=[],N=[],O=[],D=0,L=this.outputs;D<L.length;D++){Zu((o=L[D]).id in i,"Could not compute output "+o.name+" : "+o.id);var W=i[o.id],G=W[0];u=W[1],O.push(G.shape),I.push(G),N.push(u)}return[I,N,O]},t.prototype.buildNodeConversionMap=function(n){for(var r,i={},a=0,o=this.layers;a<o.length;a++){var s=o[a];r=s instanceof t?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=t.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},t.prototype.getLayer=function(n,r){if(r!=null){if(this.layers.length<=r)throw new ie("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(n==null)throw new ie("Provide either a layer name or layer index");for(var i=0,a=this.layers;i<a.length;i++){var o=a[i];if(o.name===n)return o}throw new ie("No such layer: "+n)},t.prototype.calculateLosses=function(){var n=this;return le(function(){for(var r=[],i=0,a=n.layers;i<a.length;i++)for(var o=a[i],s=0;s<o.inboundNodes.length;++s){var u=t.nodeKey(o,s);n.containerNodes.has(u)&&r.push.apply(r,o.calculateLosses())}return r})},t.prototype.getConfig=function(){for(var n={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=0,o=this.layers;a<o.length;a++){for(var s=(w=o[a]).getClassName(),u=w.getConfig(),l=[],c=0;c<w.inboundNodes.length;c++){var f=w.inboundNodes[c],d=t.nodeKey(w,c),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(_){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+f.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],v=f.nodeIndices[g],y=f.tensorIndices[g];(A=r[t.nodeKey(m,v)])==null&&(A=0),p.push([m.name,A,y,h])}l.push(p)}}}var b={};b.name=w.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}n.layers=i;var x=[];for(g=0;g<this.inputLayers.length;g++){var w=this.inputLayers[g];v=this.inputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)&&((A=r[d])!==null&&A!==void 0||(A=0),y=this.inputLayersTensorIndices[g],x.push([w.name,A,y]))}n.inputLayers=x;var S=[];for(g=0;g<this.outputLayers.length;g++)if(w=this.outputLayers[g],v=this.outputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)){var A;(A=r[d])!==null&&A!==void 0||(A=0),y=this.outputLayersTensorIndices[g],S.push([w.name,A,y])}return n.outputLayers=S,n},t.fromConfig=function(n,r,i,a){a===void 0&&(a=!1);var o={},s={};function u(D,L){D.name in s?s[D.name].push(L):s[D.name]=[L]}function l(D,L){for(var W,G=[],K=0,ee=L;K<ee.length;K++){var ce=ee[K],he=ce[0],Oe=ce[1],Te=ce[2];if(W=ce[3]==null?{}:ce[3],!(he in o))return void u(D,L);var Re=o[he];if(Re.inboundNodes.length<=Oe)return void u(D,L);var me=Re.inboundNodes[Oe];G.push(me.outputTensors[Te])}G.length>0&&D.apply(_a(G),W)}function c(D){var L=D.name,W=Zs(D,r.customObjects!=null?r.customObjects:{});W.setFastWeightInitDuringBuild(a),o[L]=W,D.inboundNodes.forEach(function(G){if(!(G instanceof Array))throw new ie("Corrupted configuration, expected array for nodeData: "+G);u(W,G)})}for(var f=r.name,d=r.layers,h=0,p=d;h<p.length;h++)c(v=p[h]);for(;!E4e(s);)for(var g=0,m=d;g<m.length;g++){var v=m[g];if((O=o[v.name]).name in s){var y=s[O.name];delete s[O.name];for(var b=0,x=y;b<x.length;b++)l(O,x[b])}}for(var w=[],S=[],A=0,_=r.inputLayers;A<_.length;A++){var E=(v=_[A])[0],C=v[1],k=v[2];Zu(E in o);var T=(O=o[E]).inboundNodes[C].outputTensors;w.push(T[k])}for(var I=0,N=r.outputLayers;I<N.length;I++){E=(v=N[I])[0],C=v[1],k=v[2],Zu(E in o);var O;T=(O=o[E]).inboundNodes[C].outputTensors,S.push(T[k])}return new n({inputs:w,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new ie("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var n=0,r=this.layers;n<r.length;n++)if(r[n].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var n=this;le(function(){n.layers.forEach(function(r){r.stateful&&r.resetStates()})})},t}(tn);function JBe(e,t,n){var r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(a){return null});if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided "+n+" is an array of "+e.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return e}if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){var i=[];return t.forEach(function(a){a in e?i.push(e[a]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+t+" keys. Provided "+n+" not understood: "+JSON.stringify(e))}function KQ(e,t){return JBe(e,t,"classWeight")}function XQ(e,t,n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return n==null?[3,2]:(i=le(function(){if(e.shape.length===1)return e.clone();if(e.shape.length===2){if(e.shape[1]>1)return e.argMax(1);if(e.shape[1]===1)return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+e.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+e.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[l.sent()]),Ut(i),u=[],a.forEach(function(c){if(n[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(n[c])}),[2,ba(u,"float32")];case 2:return[2,null]}})})}function QBe(e,t){return rt(e,t)}var eze=32;function YQ(e,t){var n,r,i=t;n=i.xs,r=i.ys,pt.assert(n!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var a=ZQ("input",e.inputNames,n),o=ZQ("output",e.outputNames,r),s=a[0].shape[0];pt.assert(a.length===e.inputs.length,function(){return"LayersModel has "+e.inputs.length+" inputs, but the dataset provides "+a.length+" inputs.  (Expected input keys: "+JSON.stringify(e.inputNames)+")"}),pt.assert(o.length===e.outputs.length,function(){return"LayersModel has "+e.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(e.outputNames)+")"});for(var u=function(d){pt.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: input "+e.inputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},l=0;l<a.length;l++)u(l);for(var c=function(d){pt.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: output "+e.outputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},f=0;f<o.length;f++)c(f);return{xs:a,ys:o}}function ZQ(e,t,n){if(n instanceof Ht)return[n];if(Array.isArray(n))return pt.assert(n.length===t.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+t.length+" to match the "+e+" keys "+t+"."}),n;for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i];if(n[o]==null)throw new ie("The feature data generated by the dataset lacks the required "+e+" key '"+o+"'.");r.push(n[o])}return r}function tze(e){if(e.length===3)throw new $t("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function nze(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W,G,K;return St(this,function(ee){switch(ee.label){case 0:if(r=n.batchesPerEpoch!=null,pt.assert(e.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),pt.assert(n!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),pt.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),pt.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),pt.assert(n.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,ee.label=1;case 1:return ee.trys.push([1,,26,27]),i=n.validationData!=null,a=void 0,o=void 0,i&&(JQ(n.validationData)?pt.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(s=tze(n.validationData),a=s.xs,o=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(ce){return"val_"+ce})):l.slice(),f=MQ(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,h=PQ(f,d,n.epochs,null,null,rze(t,n),null,i,c),p=h.callbackList,g=h.history,p.setModel(e),e.history=g,[4,p.onTrainBegin()];case 2:return ee.sent(),e.stopTraining_=!1,m=n.initialEpoch==null?0:n.initialEpoch,[4,t.iterator()];case 3:v=ee.sent(),ee.label=4;case 4:return m<n.epochs?(y={},[4,p.onEpochBegin(m)]):[3,23];case 5:return ee.sent(),b=0,x=0,r?[3,7]:[4,t.iterator()];case 6:v=ee.sent(),ee.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,v.next()]:[3,21];case 8:return w=ee.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):w.value==null?[3,15]:(S=YQ(e,w.value),A=S.xs,_=S.ys,(E={}).batch=x,E.size=A[0].shape[0],[4,p.onBatchBegin(x,E)]);case 9:if(ee.sent(),C=[],n.classWeight==null)return[3,13];k=KQ(n.classWeight,e.outputNames),K=0,ee.label=10;case 10:return K<k.length?(I=(T=C).push,[4,XQ(_[K],null,k[K])]):[3,13];case 11:I.apply(T,[ee.sent()]),ee.label=12;case 12:return++K,[3,10];case 13:for(N=A.concat(_).concat(C),O=u(N),Ut(N),K=0;K<l.length;++K)D=l[K],L=O[K],E[D]=L,ju(L);return[4,p.onBatchEnd(x,E)];case 14:ee.sent(),FQ(E),x++,b++,ee.label=15;case 15:return(r?b>=n.batchesPerEpoch:w.done)?i?(W=void 0,JQ(n.validationData)?(G=Qn,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return W=G.apply(void 0,[ee.sent()]),[3,18];case 17:W=Qn(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?eze:n.validationBatchSize,verbose:0})),ee.label=18;case 18:for(K=0;K<e.metricsNames.length;++K)y["val_"+e.metricsNames[K]]=W[K];ee.label=19;case 19:return[3,21];case 20:return e.stopTraining_?[3,21]:[3,7];case 21:return[4,p.onEpochEnd(m,y)];case 22:return ee.sent(),m++,e.stopTraining_?[3,23]:[3,4];case 23:return[4,p.onTrainEnd()];case 24:return ee.sent(),[4,e.history.syncData()];case 25:return ee.sent(),[2,e.history];case 26:return e.isTraining=!1,[7];case 27:return[2]}})})}function rze(e,t){var n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function JQ(e){return typeof e.iterator=="function"}function ize(e){return typeof e.next=="function"}function aze(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:if(r=(n=n||{}).batches!=null,i=e.testFunction,a=[],n.verbose>0)throw new $t("Verbose mode is not implemented yet.");return pt.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),ize(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,l=0,c=function(){var p;return St(this,function(g){switch(g.label){case 0:return[4,o.next()];case 1:return p=g.sent(),a=le(function(){if(p.value){var m=YQ(e,p.value),v=m.xs,y=m.ys,b=v.concat(y),x=le(function(){return i(b)});if(Ut(b),l===0)for(var w=0;w<x.length;++w)a.push(Ve(0));var S=b[0].shape[0],A=function(_){var E=x[_],C=a[_];a[_]=le(function(){return Wt(a[_],rt(S,E))}),l>0&&Ut(C)};for(w=0;w<x.length;++w)A(w);Ut(x),u+=S,++l}return a}),p.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},h.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return h.sent()==="break"?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)d=a[f],a[f]=kr(a[f],u),Ut(d);return[2,_a(a)]}})})}function ZP(e){pt.assert(e>0&&Number.isInteger(e),function(){return"batchSize is required to be a positive integer, but got "+e})}function Xb(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(function(r){return ep(r,t,n-t)}):ep(e,t,n-t)}function JP(e,t){return le(function(){return e==null?null:Array.isArray(e)?e.map(function(n){return JP(n,t)}):yQ(e,t.dtype==="int32"?t:t.toInt())})}function QP(e,t){for(var n=[],r=0,i=null;r<e;)(i=r+t)>=e&&(i=e),n.push([r,i]),r=i;return n}function oze(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p){return Ct(this,void 0,void 0,function(){var g,m,v,y,b,x,w,S;return St(this,function(A){switch(A.label){case 0:if(i==null&&(i=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0),g=!1,u!=null&&l!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new ie("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(m=e.checkNumSamples(n,i,h,"steps_per_epoch"))!=null&&(v=Xs(0,m)),o==null&&(o=1),y=PQ(s,o,a,d,m,h,i,g,f),b=y.callbackList,x=y.history,b.setModel(e),e.history=x,[4,b.onTrainBegin()];case 1:A.sent(),e.stopTraining_=!1,w=function(_){var E,C,k,T,I;return St(this,function(N){switch(N.label){case 0:return[4,b.onEpochBegin(_)];case 1:if(N.sent(),E={},h==null)return[3,2];throw new $t("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new $t("batch shuffling is not implemneted yet");c&&pt.shuffle(v),C=ba(v),k=QP(m,i),T=function(O){var D;return St(this,function(L){switch(L.label){case 0:return D={},[4,b.onBatchBegin(O,D)];case 1:return L.sent(),le(function(){var W=k[O][0],G=k[O][1],K=ep(C,W,G-W);D.batch=O,D.size=G-W;for(var ee=JP(n,K),ce=t(ee),he=0;he<r.length;++he){var Oe=r[he],Te=ce[he];D[Oe]=Te,ju(Te)}if(O===k.length-1&&g){var Re=e.testLoop(u,l,i);for(he=0;he<r.length;++he)Oe=r[he],Te=Re[he],ju(Te),E["val_"+Oe]=Te}}),[4,b.onBatchEnd(O,D)];case 2:return L.sent(),FQ(D),e.stopTraining_?[2,"break"]:[2]}})},I=0,N.label=3;case 3:return I<k.length?[5,T(I)]:[3,6];case 4:if(N.sent()==="break")return[3,6];N.label=5;case 5:return++I,[3,3];case 6:C.dispose(),N.label=7;case 7:return[4,b.onEpochEnd(_,E)];case 8:return N.sent(),e.stopTraining_?[2,"break"]:[2]}})},S=d,A.label=2;case 2:return S<a?[5,w(S)]:[3,5];case 3:if(A.sent()==="break")return[3,5];A.label=4;case 4:return++S,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return A.sent(),[4,e.history.syncData()];case 7:return A.sent(),[2,e.history]}})})}function sze(e,t,n,r){return r===void 0&&(r={}),Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E;return St(this,function(C){switch(C.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,C.label=1;case 1:return C.trys.push([1,,7,8]),ZP(f=r.batchSize==null?32:r.batchSize),d=!1,[4,e.standardizeUserData(t,n,r.sampleWeight,r.classWeight,d,f)];case 2:if(h=C.sent(),i=h[0],a=h[1],c=h[2],p=!1,g=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(p=!0,r.validationData.length!==2)throw r.validationData.length===3?new $t("validationData including sample weights is not supported yet."):new ie("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],m=!0,[4,e.standardizeUserData(o,s,null,null,m,f)];case 3:return v=C.sent(),u=v[0],l=v[1],g=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(p=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=Xb(i,y,b),i=Xb(i,0,y),l=Xb(a,y,b),a=Xb(a,0,y),g=u.concat(l)):r.validationSteps!=null&&(p=!0),C.label=5;case 5:return x=i.concat(a).concat(c),e.checkTrainableWeightsConsistency(),w=e.makeTrainFunction(),S=e.getDedupedMetricsNames(),A=void 0,_=void 0,p?(e.makeTestFunction(),A=e.testFunction,_=S.slice().concat(S.map(function(k){return"val_"+k}))):(A=null,g=[],_=S.slice()),E=MQ(r.callbacks,r.yieldEvery),[4,oze(e,w,x,S,f,r.epochs,r.verbose,E,A,g,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,C.sent()];case 7:return e.isTraining=!1,np(i,t),np(a,n),np(u,o),np(l,s),c!=null&&Ut(c),[7];case 8:return[2]}})})}function QQ(e){var t=[];e instanceof Ht&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(r.rank===1)t.push(Wb(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function np(e,t){if(e!=null){var n=[];if(t instanceof Ht)n.push(t.id);else if(Array.isArray(t))t.forEach(function(u){return n.push(u.id)});else if(t!=null)for(var r in t){var i=t[r];n.push(i.id)}var a=[];if(e instanceof Ht)n.indexOf(e.id)===-1&&a.push(e);else if(Array.isArray(e))e.forEach(function(u){n.indexOf(u.id)===-1&&a.push(u)});else if(e!=null)for(var o in e){var s=e[o];n.indexOf(s.id)===-1&&a.push(s)}a.forEach(function(u){u.isDisposed||u.dispose()})}}function uze(e){return e instanceof Ht}function e$(e){return Array.isArray(e)}function eee(e){return!uze(e)&&!e$(e)}function tee(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),t==null||t.length===0){if(e!=null){var a=!1;if(e$(e)&&e.length>0)a=!0;else if(eee(e)){for(var o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new ie("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(e==null)return t.map(function(m){return null});var s;if(eee(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(e[c]==null)throw new ie('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(e$(e)){if((e=e).length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new ie("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=QQ(s),n!=null){for(var f=0;f<t.length;++f)if(n[f]!=null){var d=s[f];if(d.shape.length!==n[f].length)throw new ie("Error when checking "+i+": expected "+t[f]+" to have "+n[f].length+" dimension(s). but got array with shape "+d.shape);for(var h=0;h<n[f].length;++h)if(h!==0||r){var p=d.shape[h],g=n[f][h];if(g!=null&&g>=0&&p!==g)throw new ie("Error when checking "+i+": expected "+t[f]+" to have shape ["+n[f]+"], but got array with shape ["+d.shape+"].")}}}return s}function lze(e,t,n){var r=Wf(e.map(function(a){return a.shape[0]}));r.sort();var i=Wf(t.map(function(a){return a.shape[0]}));if(i.sort(),r.length>1)throw new ie("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(a){return a.shape})));if(i.length>1)throw new ie("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(a){return a.shape})));if(r.length>0&&i.length>0&&!pt.arraysEqual(r,i))throw new ie("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function cze(e,t,n){for(var r=[tp,ZE,Hb],i=0;i<e.length;++i){var a=e[i],o=t[i],s=n[i];if(o!=null){if(o===Hb&&a.shape[a.shape.length-1]===1)throw new ie("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(o)!==-1)for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var f=u[c],d=l[c];if(d!=null&&f!==d)throw new ie("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function nee(e,t,n,r,i){var a;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(e)){if(e.length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(t.length>1)throw new ie("The model expects "+t.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(n!=null){for(var o=0;o<t.length;++o)if(n[o]!=null){var s=a[o];if(s.shape.length!==n[o].length)throw new ie("Error when checking "+i+": expected "+t[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(u!==0||r){var l=s.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new ie("Error when checking "+i+": expected "+t[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function fze(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(u){return[]});var n;if(typeof e=="string"||typeof e=="function")n=[e];else{if(!Array.isArray(e)&&typeof e!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map(function(u){return n});for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var dze="layers-model",Yb=function(e){function t(n){var r=e.call(this,n)||this;return r.isTraining=!1,r}return Ee(t,e),t.prototype.summary=function(n,r,i){if(i===void 0&&(i=console.log),!this.built)throw new ie("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");UBe(this,n,r,i)},t.prototype.compile=function(n){var r=this;if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=jBe(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof hc))throw new ie("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(n.loss)||typeof n.loss=="string"||typeof n.loss=="function")if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new ie("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+n.loss+".");var a=n.loss;i=a.map(function(m){return VP(m)})}else{var o=VP(n.loss);this.outputs.forEach(function(m){i.push(o)})}else{for(var s in n.loss=n.loss,n.loss)if(this.outputNames.indexOf(s)===-1)throw new ie('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];n.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(VP(n.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],h=this.outputNames[f];this.feedOutputNames.push(h),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var p=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Qh("loss",function(){for(var m=0;m<r.outputs.length;++m)if(p.indexOf(m)===-1){var v=r.lossFunctions[m];r.outputs.length>1&&(r.metricsTensors.push([v,m]),r.metricsNames.push(r.outputNames[m]+"_loss"))}});var g=fze(n.metrics,this.outputNames);Qh("metric",function(){for(var m=function(y){if(p.indexOf(y)!==-1)return"continue";(function(b){for(var x,w,S,A=function(C){if(typeof C=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(C)!==-1){var k=r.internalOutputShapes[y];k[k.length-1]===1||r.lossFunctions[y]===ZE?["accuracy","acc"].indexOf(C)!==-1?w=qP:["crossentropy","ce"].indexOf(C)!==-1&&(w=BQ):r.lossFunctions[y]===YE?["accuracy","acc"].indexOf(C)!==-1?w=zQ:["crossentropy","ce"].indexOf(C)!==-1&&(w=jQ):["accuracy","acc"].indexOf(C)!==-1?w=HP:["crossentropy","ce"].indexOf(C)!==-1&&(w=GP);var T=void 0;["accuracy","acc"].indexOf(C)!==-1?T="acc":["crossentropy","ce"].indexOf(C)!==-1&&(T="ce"),S=w,x=""+T}else{var I=zBe(C);S=I,x=""+eA(C)}var N;Qh(x,function(){N=S}),function(O,D,L){r.outputNames.length>1&&(D=r.outputNames[O]+"_"+D),r.metricsNames.push(D),r.metricsTensors.push([L,O])}(y,x,N)},_=0,E=b;_<E.length;_++)A(E[_])})(g[y])},v=0;v<r.outputs.length;++v)m(v)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(n,r,i){i===void 0&&(i={});var a=i.batchSize==null?32:i.batchSize;ZP(a);var o=this.standardizeUserDataXY(n,r,!0,a);try{var s=o[0].concat(o[1]);this.makeTestFunction();var u=this.testFunction;return _a(this.testLoop(u,s,a,i.verbose,i.steps))}finally{np(o[0],n),np(o[1],r)}},t.prototype.evaluateDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return this.makeTestFunction(),[2,aze(this,n,r)]})})},t.prototype.checkNumSamples=function(n,r,i,a){var o;if(a===void 0&&(a="steps"),i!=null){if(o=null,r!=null)throw new ie("If "+a+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(n==null)throw new ie("Either the input data should have a defined shape, or "+a+" shoud be specified.");o=Array.isArray(n)?n[0].shape[0]:n.shape[0]}return o},t.prototype.execute=function(n,r){if(Array.isArray(r)&&r.length===0)throw new ie("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),a=i?r:[r],o=this.retrieveSymbolicTensors(a),s=new nv;if(n instanceof Ht&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new ie("The number of inputs provided ("+n.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],n[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var f=c[l],d=n[f.name];if(d==null)throw new ie("No value is provided for the model's input "+f.name);s.add(f,d)}var h=Kb(o,s);return i?h:h[0]},t.prototype.retrieveSymbolicTensors=function(n){for(var r=Zh(null,n.length),i=n.length,a=0,o=this.layers;a<o.length;a++){for(var s=o[a],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(h){return h.name}),c=0;c<n.length;++c){var f=l.indexOf(n[c]);if(f!==-1&&(r[c]=u[f],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(h,p){h==null&&d.push(n[p])}),new ie("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},t.prototype.predictLoop=function(n,r,i){var a=this;return r===void 0&&(r=32),i===void 0&&(i=!1),le(function(){var o=a.checkNumSamples(n);if(i)throw new $t("Verbose predictLoop() is not implemented yet.");for(var s=QP(o,r),u=a.outputs.map(function(f){return[]}),l=function(f){le(function(){var d=s[f][0],h=s[f][1],p=Xb(n,d,h),g=[];if(Array.isArray(p))for(var m=0;m<p.length;++m)g.push({key:a.inputs[m],value:p[m]});else g.push({key:a.inputs[0],value:p});var v=new nv(g);return Kb(a.outputs,v)}).forEach(function(d,h){return u[h].push(d)})},c=0;c<s.length;++c)l(c);return _a(u.map(function(f){return Hi(f,0)}))})},t.prototype.predict=function(n,r){r===void 0&&(r={});var i=QQ(n);nee(i,this.inputNames,this.feedInputShapes,!1);try{var a=r.batchSize==null?32:r.batchSize;return ZP(a),this.predictLoop(i,a)}finally{np(i,n)}},t.prototype.predictOnBatch=function(n){nee(n,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)},t.prototype.standardizeUserDataXY=function(n,r,i,a){if(this.optimizer_==null)throw new Yu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===YE?o.push(u.slice(0,u.length-1).concat([1])):o.push(u)}if(lze(n=tee(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=tee(r,this.feedOutputNames,o,!1,"target")),cze(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&n[0].shape[0]%a!=0)throw new ie("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+a+". Found: "+n[0].shape[0]+" sample(s).");return[n,r]},t.prototype.standardizeUserData=function(n,r,i,a,o,s){return o===void 0&&(o=!0),Ct(this,void 0,void 0,function(){var u,l,c,f,d,h,p,g;return St(this,function(m){switch(m.label){case 0:if(u=this.standardizeUserDataXY(n,r,o,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(f=null,a==null)return[3,4];d=KQ(a,this.outputNames),f=[],h=0,m.label=1;case 1:return h<d.length?(g=(p=f).push,[4,XQ(c[h],null,d[h])]):[3,4];case 2:g.apply(p,[m.sent()]),m.label=3;case 3:return++h,[3,1];case 4:return[2,[l,c,f]]}})})},t.prototype.testLoop=function(n,r,i,a,o){var s=this;return a===void 0&&(a=0),le(function(){var u=s.checkNumSamples(r,i,o,"steps"),l=[];if(a>0)throw new $t("Verbose mode is not implemented yet.");if(o!=null)throw new $t("steps mode in testLoop() is not implemented yet");for(var c=QP(u,i),f=ba(Xs(0,u)),d=0;d<c.length;++d){var h=c[d][0],p=c[d][1],g=ep(f,h,p-h),m=JP(r,g),v=n(m);if(d===0)for(var y=0;y<v.length;++y)l.push(Ve(0));for(y=0;y<v.length;++y){var b=v[y];l[y]=Wt(l[y],rt(p-h,b))}}for(y=0;y<l.length;++y)l[y]=kr(l[y],u);return l})},t.prototype.getDedupedMetricsNames=function(){for(var n=this.metricsNames,r=[],i=0;i<n.length;++i){var a=n[i],o=a;tQ(n,a)>1&&(o+="_"+tQ(n.slice(0,i),a)),r.push(o)}return r},t.prototype.makeTrainFunction=function(){var n=this;return function(r){var i=[],a=r.slice(0,n.inputs.length),o=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),s=r.slice(n.inputs.length+n.outputs.length,n.inputs.length+2*n.outputs.length),u=[],l=n.collectedTrainableWeights.map(function(c){return c.read()});return[n.optimizer_.minimize(function(){for(var c=[],f=0;f<n.inputs.length;++f)c.push({key:n.inputs[f],value:a[f]});var d,h=new nv(c),p=Kb(n.outputs,h,{training:!0});for(f=0;f<n.lossFunctions.length;++f){var g=(0,n.lossFunctions[f])(o[f],p[f]);s[f]!=null&&(g=QBe(g,s[f]));var m=Pr(g);i.push(m),d=f===0?g:Wt(d,g)}for(f=0;f<n.metricsTensors.length;++f){var v=void 0;if(n.outputs.length>1&&f<n.outputs.length)v=i[f];else{var y=n.metricsTensors[f][0],b=n.metricsTensors[f][1];v=Pr(y(o[b],p[b]))}ju(v),u.push(v)}return d=Pr(d),n.calculateLosses().forEach(function(x){d=Wt(d,x)}),d},!0,l)].concat(u)}},t.prototype.makeTestFunction=function(){var n=this;this.testFunction=function(r){return le(function(){for(var i,a=[],o=r.slice(0,n.inputs.length),s=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),u=[],l=0;l<n.inputs.length;++l)u.push({key:n.inputs[l],value:o[l]});var c=new nv(u),f=Kb(n.outputs,c);for(l=0;l<n.lossFunctions.length;++l){var d=n.lossFunctions[l],h=Pr(d(s[l],f[l]));i=l===0?h:Wt(i,h),a.push(i)}for(l=0;l<n.metricsTensors.length;++l){var p=n.metricsTensors[l][0],g=n.metricsTensors[l][1],m=Pr(p(s[g],f[g]));a.push(m)}return a})}},t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),Ct(this,void 0,void 0,function(){return St(this,function(a){return[2,sze(this,n,r,i)]})})},t.prototype.fitDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return[2,nze(this,n,r)]})})},t.prototype.trainOnBatch=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(n,r)];case 1:i=h.sent(),a=i[0],o=i[1],s=this.makeTrainFunction(),u=s(a.concat(o)),l=[],c=0,f=u,h.label=2;case 2:return c<f.length?[4,f[c].data()]:[3,5];case 3:d=h.sent(),l.push(d[0]),h.label=4;case 4:return c++,[3,2];case 5:return Ut(u),[2,_a(l)]}})})},t.prototype.getNamedWeights=function(n){for(var r=[],i=n!=null&&n.trainableOnly,a=i?this.trainableWeights:this.weights,o=this.getWeights(i),s=0;s<a.length;++s)i&&!a[s].trainable||r.push({name:a[s].originalName,tensor:o[s]});return r},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(n){this.stopTraining_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=e.prototype.dispose.call(this);if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=MS().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-MS().numTensors}return n},t.prototype.getLossIdentifiers=function(){var n;if(typeof this.loss=="string")n=pc(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(function(c){return pc(c)})}else{var a=Object.keys(this.loss);n={};for(var o=this.loss,s=0,u=a;s<u.length;s++){var l=u[s];if(typeof o[l]!="string")throw new Error("Serialization of non-string loss is not supported.");n[l]=pc(o[l])}}return n},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[pc(eA(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return pc(eA(i))});var n={};for(var r in this.metrics)n[r]=pc(eA(this.metrics[r]));return n},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,a=Zs(Gb(n.optimizer_config));if(typeof n.loss=="string")r=Jh(n.loss);else if(Array.isArray(n.loss))r=n.loss.map(function(s){return Jh(s)});else if(n.loss!=null)for(var o in r={},n.loss)r[o]=Jh(n.loss[o]);if(Array.isArray(n.metrics))i=n.metrics.map(function(s){return Jh(s)});else if(n.metrics!=null)for(var o in i={},n.metrics)i[o]=Jh(n.metrics[o]);this.compile({loss:r,metrics:i,optimizer:a})},t.prototype.save=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v;return St(this,function(y){switch(y.label){case 0:if(typeof n=="string"){if((i=wa.getSaveHandlers(n)).length===0)throw new ie("Cannot find any save handlers for URL '"+n+"'");if(i.length>1)throw new ie("Found more than one ("+i.length+") save handlers for URL '"+n+"'");n=i[0]}if(n.save==null)throw new ie("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,wa.encodeWeights(this.getNamedWeights(r))];case 1:return a=y.sent(),o=!1,s=null,u=this.toJSON(s,o),l={modelTopology:u,format:dze,generatedBy:"TensorFlow.js tfjs-layers v"+qQ,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",g=(p=wa).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,g.apply(p,[y.sent(),c])];case 3:f=y.sent(),d=f.data,h=f.specs,(v=a.specs).push.apply(v,h),a.data=wa.concatenateArrayBuffers([a.data,d]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(m=!0,WQ(this.userDefinedMetadata,this.name,m),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=a.data,l.weightSpecs=a.specs,[2,n.save(l)]}})})},t.prototype.setUserDefinedMetadata=function(n){WQ(n,this.name),this.userDefinedMetadata=n},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(ZBe);function hze(e,t){return Ct(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l;return St(this,function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),(n=(e=e).modelTopology).model_config!=null&&(n=n.model_config),r=Gb(n),i=Zs(r,t),e.weightsManifest==null?[3,2]:[4,wa.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(function(f){return f.originalName}))];case 1:for(a=c.sent(),o={},s=0,u=i.weights;s<u.length;s++)l=u[s],o[l.originalName]=a[l.originalName];i.loadWeights(o),Ut(a),c.label=2;case 2:return[2,i]}})})}function pze(e,t){return Ct(this,void 0,void 0,function(){var n;return St(this,function(r){if(t==null&&(t={}),typeof e=="string"){if((n=wa.getLoadHandlers(e,t.onProgress)).length===0)n.push(wa.browserHTTPRequest(e,t));else if(n.length>1)throw new ie("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,gze(e,void 0,t)]})})}function gze(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return St(this,function(d){switch(d.label){case 0:if(n==null&&(n={}),e.load==null)throw new ie("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),a=n.strict==null||n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=Zs(Gb(i),t,o),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new ie("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=mze(r.weightData,r.weightSpecs),c=l.modelWeights,f=l.optimizerWeights,s.loadWeights(c,a),s.optimizer!=null&&f.length>0?[4,s.optimizer.setWeights(f)]:[3,3];case 2:d.sent(),d.label=3;case 3:Ut(c),Ut(f.map(function(h){return h.tensor})),d.label=4;case 4:return[2,s]}})})}function mze(e,t){var n=wa.decodeWeights(e,t),r={},i=[];return t.forEach(function(a){a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}Ne.registerClass(Yb);var ree=function(e){function t(n){var r=e.call(this,{inputs:[],outputs:[]})||this;if(n=n||{},r.trainable=!0,r.built=!1,r.name=n.name!=null?n.name:VE("sequential_"),n.layers!=null)for(var i=0,a=n.layers;i<a.length;i++){var o=a[i];r.add(o)}return r}return Ee(t,e),t.prototype.checkShape=function(n){if(n.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new ie("Negative dimension size caused by adding layer "+n.name+" with input shape ["+n.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(n){var r,i=n instanceof t||n instanceof Yb;if(i){if((r=n).outputs.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ie("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new ie("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=RQ({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(a)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(n.inboundNodes.length!==1)throw new ie("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+n.name+" which has "+n.inboundNodes.length+" pre-existing inbound connections.");if(n.inboundNodes[0].outputTensors.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=NQ(this.outputs[0])}this.inboundNodes=[],new GE({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Zh(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(n,r){return this.model==null&&this.build(),this.model.call(n,r)},t.prototype.build=function(n){if(Xn(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Yb({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(n,r,i){i===void 0&&(i=console.log),this.built||this.build(),e.prototype.summary.call(this,n,r,i)},t.prototype.setWeights=function(n){this.model==null&&this.build(),this.model.setWeights(n)},t.prototype.evaluate=function(n,r,i){if(i===void 0&&(i={}),!this.built)throw new Yu("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)},t.prototype.evaluateDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(n,r)]})})},t.prototype.predict=function(n,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(n,r)},t.prototype.predictOnBatch=function(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)},t.prototype.compile=function(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(n){this.model.optimizer=n},enumerable:!0,configurable:!0}),t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),Ct(this,void 0,void 0,function(){return St(this,function(a){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.fit(n,r,i)]})})},t.prototype.fitDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.fitDataset(n,r)]})})},t.prototype.trainOnBatch=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return[2,this.model.trainOnBatch(n,r)]})})},t.fromConfig=function(n,r,i,a){var o;a===void 0&&(a=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new ie("Legacy serialization format not supported yet.");o=r}else pt.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=r.layers,delete r.layers,s=r;var u=new n(s);if(!(u instanceof t))throw new $t("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=o;l<c.length;l++){var f=Zs(c[l],void 0,a);a&&f.setFastWeightInitDuringBuild(!0),u.add(f)}return u},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ie("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(n){if(this.model==null)throw new ie("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r],o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}return{name:this.name,layers:n}},t.className="Sequential",t}(Yb);function vze(e){return new ree(e)}function yze(e,t){return t==null&&(t={}),pze(e,t)}function bze(e){return RQ(e)}Ne.registerClass(ree);var $o=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),xze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=1),z4e(n,r)},t.className="elu",t}($o);Ne.registerClass(xze);var wze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return IE(n)},t.className="selu",t}($o);Ne.registerClass(wze);var _ze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Pf(n)},t.className="relu",t}($o);Ne.registerClass(_ze);var Sze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return le(function(){return Im(6,Pf(n))})},t.className="relu6",t}($o);Ne.registerClass(Sze);var Eze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return n},t.className="linear",t}($o);Ne.registerClass(Eze);var Aze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return GS(n)},t.className="sigmoid",t}($o);Ne.registerClass(Aze);var Cze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return U4e(n)},t.className="hardSigmoid",t}($o);Ne.registerClass(Cze);var kze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return vb(n)},t.className="softplus",t}($o);Ne.registerClass(kze);var Tze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return j4e(n)},t.className="softsign",t}($o);Ne.registerClass(Tze);var Oze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return KS(n)},t.className="tanh",t}($o);Ne.registerClass(Oze);var iee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),$h(n,r)},t.className="softmax",t}($o);Ne.registerClass(iee);var Ize=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),eE(n,r)},t.className="logSoftmax",t}($o);function Lo(e){return e.getClassName()}function t$(e,t){return t===void 0&&(t={}),Bb(e,Ne.SerializationMap.getMap().classNameMap,t,"activation")}function Gf(e){var t;return e==null?t$(t={className:"linear",config:{}}):typeof e=="string"?((t={}).className=e,t.config={},t$(t)):e instanceof $o?e:t$(e)}function n$(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}Ne.registerClass(Ize);var aee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(Ne.Serializable),nA=function(e){function t(n){var r=e.call(this)||this;return n$(n),r.l1=n==null||n.l1==null?.01:n.l1,r.l2=n==null||n.l2==null?.01:n.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=Tn([1]);return r.hasL1&&(i=Wt(i,Hr(rt(r.l1,Nf(n))))),r.hasL2&&(i=Wt(i,Hr(rt(r.l2,Vb(n))))),i.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(n,r){return new n({l1:r.l1,l2:r.l2})},t.className="L1L2",t}(aee);function Nze(e){return n$(e),new nA({l1:e!=null?e.l1:null,l2:0})}function Dze(e){return n$(e),new nA({l2:e!=null?e.l2:null,l1:0})}Ne.registerClass(nA);var oee={l1l2:"L1L2"};function Vt(e){return CP(e)}function see(e,t){return t===void 0&&(t={}),Bb(e,Ne.SerializationMap.getMap().classNameMap,t,"regularizer")}function ir(e){return e==null?null:typeof e=="string"?see({className:e in oee?oee[e]:e,config:{}}):e instanceof aee?e:see(e)}var uee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,n!=null&&(r.maxValue=n.maxValue),r}return Ee(t,e),t.prototype.call=function(n,r){n=Dt(n);var i=Pf(n);return this.maxValue!=null&&(i=xa(i,0,this.maxValue)),i},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={maxValue:this.maxValue},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ReLU",t}(tn);Ne.registerClass(uee);var lee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_ALPHA=.3,n==null&&(n={}),r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return OE(i,this.alpha)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LeakyReLU",t}(tn);Ne.registerClass(lee);var cee=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),r.supportsMasking=!0,r.alphaInitializer=rr(n.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=ir(n.alphaRegularizer),r.alphaConstraint=Kr(n.alphaConstraint),n.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(n.sharedAxes))r.sharedAxes=n.sharedAxes;else{if(typeof n.sharedAxes!="number")throw new ie("Expected sharedAxes to be a number or an array of numbers, but got "+n.sharedAxes);r.sharedAxes=[n.sharedAxes]}return r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n)).slice(1);if(this.sharedAxes!=null)for(var i=0,a=this.sharedAxes;i<a.length;i++)r[(s=a[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(this.sharedAxes!=null)for(var s=1;s<n.length;++s)o[s]=n[s];this.inputSpec=[new Mi({ndim:n.length,axes:o})],this.built=!0},t.prototype.call=function(n,r){return n=Dt(n),Fb(n,this.alpha.read())},t.prototype.getConfig=function(){var n={alphaInitializer:vn(this.alphaInitializer),alphaRegularizer:Vt(this.alphaRegularizer),alphaConstraint:Ln(this.alphaConstraint),sharedAxes:this.sharedAxes},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="PReLU",t}(tn);Ne.registerClass(cee);var fee=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==r.DEFAULT_ALPHA)throw new $t("Non-default alpha value ("+n.alpha+") is not supported by the ELU layer yet.");return r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return Um(i)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ELU",t}(tn);Ne.registerClass(fee);var dee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_THETA=1,n==null&&(n={}),r.theta=n.theta==null?r.DEFAULT_THETA:n.theta,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return i.mul(Ub(i.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={theta:this.theta},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ThresholdedReLU",t}(tn);Ne.registerClass(dee);var hee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_AXIS=1,n==null&&(n={}),r.softmax=new iee().apply,r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return this.softmax(i,this.axis)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Softmax",t}(tn);function r$(e,t,n){if(typeof e=="number")return Zh(e,t);if(e.length!==t)throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var i=e[r];if(!P4e(i))throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+i)}return e}function vc(e,t,n,r,i){return i===void 0&&(i=1),e==null?e:(a=n==="same"?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function rA(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+qf([n-t,0]);else{if(r!=="same")throw new ie("Unsupport padding mode: "+r+".");e*=t}return e}function i$(e,t){return le(function(){return Xr(t),t==="channelsFirst"?cn(e,[0,2,3,1]):e})}function pee(e,t){return le(function(){return Xr(t),t==="channelsFirst"?cn(e,[0,2,3,4,1]):e})}function Rze(e,t,n,r,i,a,o){return r===void 0&&(r=1),i===void 0&&(i="valid"),o===void 0&&(o=1),le(function(){if(a==null&&(a=Ks()),Xr(a),e.shape.length!==3)throw new ie("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(t.shape.length!==3)throw new ie("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(n!=null&&n.shape.length!==1)throw new ie("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(a==="channelsFirst"&&(e=cn(e,[0,2,1])),i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=vE(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(s=mc(s,n)),s})}function gee(e,t,n,r,i,a,o,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),le(function(){if(a==null&&(a=Ks()),Xr(a),e.rank!==3&&e.rank!==4)throw new ie("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+e.rank+".");if(t.rank!==3&&t.rank!==4)throw new ie("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+e.rank+".");var u=i$(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Lf.conv2d({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),a==="channelsFirst"&&(u=cn(u,[0,3,1,2])),u})}function Fze(e,t,n,r,i,a,o){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),le(function(){if(a==null&&(a=Ks()),Xr(a),e.rank!==4&&e.rank!==5)throw new ie("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(t.rank!==4&&t.rank!==5)throw new ie("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=pee(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=yE(s,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(s=mc(s,n)),a==="channelsFirst"&&(s=cn(s,[0,4,1,2,3])),s})}Ne.registerClass(hee);var mee=function(e){function t(n,r){var i=e.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(r),i.rank=n,Sa(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new $t("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=r$(r.kernelSize,n,"kernelSize"),i.strides=r$(r.strides==null?1:r.strides,n,"strides"),i.padding=r.padding==null?"valid":r.padding,ls(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Xr(i.dataFormat),i.activation=Gf(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=rr(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Kr(r.biasConstraint),i.biasRegularizer=ir(r.biasRegularizer),i.activityRegularizer=ir(r.activityRegularizer),i.dilationRate=r$(r.dilationRate==null?1:r.dilationRate,n,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new ie("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new ie("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new ie("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return Ee(t,e),t.verifyArgs=function(n){if(Zu("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!TP(n.kernelSize,"number",1,3))throw new ie("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(n.kernelSize)+".")},t.prototype.getConfig=function(){var n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Lo(this.activation),useBias:this.useBias,biasInitializer:vn(this.biasInitializer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),iA=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.kernel=null,t.verifyArgs(r),i.filters=r.filters,Sa(i.filters,"filters"),i.kernelInitializer=rr(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Kr(r.kernelConstraint),i.kernelRegularizer=ir(r.kernelRegularizer),i}return Ee(t,e),t.prototype.build=function(n){var r;n=Xn(n);var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the input should be defined. Found "+n[i]);var a=n[i],o=this.kernelSize.concat([a,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=a,r)}],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;n=Dt(n);var o=i.bias==null?null:i.bias.read(),s=rQ(i.activation.getClassName());if(s!=null&&i.rank===2)a=gee(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)a=Rze(n,i.kernel.read(),o,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)a=gee(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new $t("convolutions greater than 3D are not implemented yet.");a=Fze(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(a=i.activation.apply(a))}return a})},t.prototype.computeOutputShape=function(n){n=Xn(n);for(var r=[],i=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2),a=0;a<i.length;++a){var o=vc(i[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);r.push(o)}var s=[n[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},t.prototype.getConfig=function(){var n={filters:this.filters,kernelInitializer:vn(this.kernelInitializer),kernelRegularizer:Vt(this.kernelRegularizer),kernelConstraint:Ln(this.kernelConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.verifyArgs=function(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new ie("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(n.filters))},t}(mee),a$=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!TP(n.kernelSize,"number",1,2))throw new ie("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv2D",t}(iA);Ne.registerClass(a$);var vee=function(e){function t(n){var r=e.call(this,3,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&(!Array.isArray(n.kernelSize)||n.kernelSize.length!==1&&n.kernelSize.length!==3))throw new ie("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv3D",t}(iA);Ne.registerClass(vee);var yee=function(e){function t(n){var r=e.call(this,n)||this;if(r.inputSpec=[new Mi({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new ie("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Xn(n)).length!==4)throw new ie("Input should have rank 4; Received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the inputs should be defined. Found `None`.");var a=n[i],o=this.kernelSize.concat([this.filters,a]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Mi({ndim:4,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);if(a.shape.length!==4)throw new ie("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+a.shape.length);var o,s,u=a.shape,l=u[0];i.dataFormat==="channelsFirst"?(o=2,s=3):(o=1,s=2);var c=u[o],f=u[s],d=i.kernelSize[0],h=i.kernelSize[1],p=i.strides[0],g=i.strides[1],m=[l,rA(c,p,d,i.padding),rA(f,g,h,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(a=cn(a,[0,2,3,1]));var v=bE(a,i.kernel.read(),m,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(v=cn(v,[0,3,1,2])),i.bias!=null&&(v=mc(v,i.bias.read(),i.dataFormat)),i.activation!=null&&(v=i.activation.apply(v)),v})},t.prototype.computeOutputShape=function(n){var r,i,a,o=(n=Xn(n)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[r]=this.filters,o[i]=rA(o[i],l,s,this.padding),o[a]=rA(o[a],c,u,this.padding),o},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.dilationRate,n},t.className="Conv2DTranspose",t}(a$);Ne.registerClass(yee);var Mze=function(e){function t(n,r){var i=e.call(this,n,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new ie("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new ie("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new ie("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=rr(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=ir(r.depthwiseRegularizer),i.depthwiseConstraint=Kr(r.depthwiseConstraint),i.pointwiseInitializer=rr(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=ir(r.pointwiseRegularizer),i.pointwiseConstraint=Kr(r.pointwiseConstraint),i}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Xn(n)).length<this.rank+2)throw new ie("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null||n[i]<0)throw new ie("The channel dimension of the inputs should be defined, but found "+JSON.stringify(n[i]));for(var a=n[i],o=this.kernelSize.concat([a,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(a*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Mi({ndim:this.rank+2,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;if(n=Dt(n),i.rank===1)throw new $t("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(n=cn(n,[0,2,3,1])),a=jM(n,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(a=mc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),i.dataFormat==="channelsFirst"&&(a=cn(a,[0,3,1,2])),a})},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.pointwiseInitializer=vn(this.pointwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.pointwiseRegularizer=Vt(this.pointwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseConstraint),n.pointwiseConstraint=Ln(this.pointwiseConstraint),n},t.className="SeparableConv",t}(iA),bee=function(e){function t(n){return e.call(this,2,n)||this}return Ee(t,e),t.className="SeparableConv2D",t}(Mze);Ne.registerClass(bee);var xee=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.dataFormat,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!TP(n.kernelSize,"number",1,1))throw new ie("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv1D",t}(iA);Ne.registerClass(xee);var wee=function(e){function t(n){var r=e.call(this,n)||this;return typeof n.cropping=="number"?r.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?r.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:r.cropping=n.cropping,r.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,r.inputSpec=[{ndim:4}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return n=Dt(n),i.dataFormat==="channelsLast"?jE(jE(n,i.cropping[0][0],n.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],n.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):jE(jE(n,i.cropping[0][0],n.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],n.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},t.prototype.getConfig=function(){var n={cropping:this.cropping,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Cropping2D",t}(tn);Ne.registerClass(wee);var _ee=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=n.size==null?r.DEFAULT_SIZE:n.size,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){if(this.dataFormat==="channelsFirst"){var r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}return r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2],[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n),o=a.shape;if(i.dataFormat==="channelsFirst"){a=cn(a,[0,2,3,1]);var s=i.size[0]*o[2],u=i.size[1]*o[3],l=a.resizeNearestNeighbor([s,u]);return cn(l,[0,3,1,2])}return s=i.size[0]*o[1],u=i.size[1]*o[2],a.resizeNearestNeighbor([s,u])})},t.prototype.getConfig=function(){var n={size:this.size,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="UpSampling2D",t}(tn);function Pze(e,t,n,r,i,a){return n===void 0&&(n=[1,1]),r===void 0&&(r="valid"),le(function(){i==null&&(i=Ks()),Xr(i);var o=i$(e,i);if(e.rank!==4)throw new ie("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(t.rank!==4)throw new ie("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=zm(o,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}Ne.registerClass(_ee);var See=function(e){function t(n){var r=e.call(this,2,n)||this;return r.depthwiseKernel=null,r.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,r.depthwiseInitializer=rr(n.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Kr(n.depthwiseConstraint),r.depthwiseRegularizer=ir(n.depthwiseRegularizer),r}return Ee(t,e),t.prototype.build=function(n){if((n=Xn(n)).length<4)throw new ie("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(n)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new ie("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+n[r]+").");var i=n[r],a=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Pze(n=Dt(n),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(a=mc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),a})},t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,o=vc(r,this.kernelSize[0],this.padding,this.strides[0]),s=vc(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],a,o,s]:[n[0],o,s,a]},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseRegularizer),n},t.className="DepthwiseConv2D",t}(mee);Ne.registerClass(See);var o$=function(e){function t(n){var r=e.call(this,n)||this;return r.rate=Math.max(Math.min(n.rate,1),0),r.noiseShape=n.noiseShape,r.seed=n.seed,r.supportsMasking=!0,r}return Ee(t,e),t.prototype.getNoiseShape=function(n){if(this.noiseShape==null)return this.noiseShape;for(var r=n.shape,i=[],a=0;a<this.noiseShape.length;++a)i.push(this.noiseShape[a]==null?r[a]:this.noiseShape[a]);return i},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(0<i.rate&&i.rate<1){var o=r.training!=null&&r.training,s=i.getNoiseShape(a);return Qm(function(){return bQ(a,i.rate,s,i.seed)},function(){return a},o)}return n})},t.prototype.getConfig=function(){var n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.dispose=function(){return e.prototype.dispose.call(this)},t.className="Dropout",t}(tn);Ne.registerClass(o$);var Eee=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getNoiseShape=function(n){var r=n.shape;return[r[0],1,r[2]]},t.className="SpatialDropout1D",t}(o$);Ne.registerClass(Eee);var Aee=function(e){function t(n){var r=e.call(this,n)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){var i=null;n.batchSize!=null&&(i=n.batchSize),r.batchInputShape=[i,n.inputDim]}return r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation),n.useBias!=null&&(r.useBias=n.useBias),r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Kr(n.kernelConstraint),r.biasConstraint=Kr(n.biasConstraint),r.kernelRegularizer=ir(n.kernelRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.activityRegularizer=ir(n.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Ee(t,e),t.prototype.build=function(n){var r,i=(n=Xn(n))[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},t.prototype.computeOutputShape=function(n){var r=(n=Xn(n)).slice();return r[r.length-1]=this.units,r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a,o=Dt(n),s=rQ(i.activation.getClassName());return s!=null?a=gc(o,i.kernel.read(),s,i.bias?i.bias.read():null):(a=gc(o,i.kernel.read()),i.bias!=null&&(a=mc(a,i.bias.read())),i.activation!=null&&(a=i.activation.apply(a))),a})},t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dense",t}(tn);Ne.registerClass(Aee);var Cee=function(e){function t(n){var r=this;return n=n||{},(r=e.call(this,n)||this).inputSpec=[{minNDim:3}],r.dataFormat=n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){for(var r=0,i=(n=Xn(n)).slice(1);r<i.length;r++)if(i[r]==null)throw new ie('The shape of the input to "Flatten" is not fully defined (got '+n.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[n[0],Vf(n,1)]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(i.dataFormat==="channelsFirst"&&a.rank>1){for(var o=[0],s=2;s<a.rank;++s)o.push(s);o.push(1),a=a.transpose(o)}return B4e(a)})},t.prototype.getConfig=function(){var n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);var r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Flatten",t}(tn);Ne.registerClass(Cee);var kee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.activation=Gf(n.activation),r}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.activation.apply(a)})},t.prototype.getConfig=function(){var n={activation:Lo(this.activation)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Activation",t}(tn);Ne.registerClass(kee);var Tee=function(e){function t(n){var r=e.call(this,n)||this;return r.n=n.n,r.inputSpec=[{ndim:2}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],this.n,n[1]]},t.prototype.call=function(n,r){var i=this;return le(function(){return $4e(n=Dt(n),i.n)})},t.prototype.getConfig=function(){var n={n:this.n},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="RepeatVector",t}(tn);Ne.registerClass(Tee);var Oee=function(e){function t(n){var r=e.call(this,n)||this;r.targetShape=n.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return Ee(t,e),t.prototype.isUnknown=function(n){return n<0||n==null},t.prototype.fixUnknownDimension=function(n,r){for(var i="Total size of new array must be unchanged.",a=r.slice(),o=1,s=null,u=0;u<a.length;++u){var l=a[u];if(this.isUnknown(l)){if(s!==null)throw new ie("Can only specifiy one unknown dimension.");s=u}else o*=l}var c=Vf(n);if(s!==null){if(o===0||c%o!=0)throw new ie(i);a[s]=c/o}else if(c!==o)throw new ie(i);return a},t.prototype.computeOutputShape=function(n){for(var r=!1,i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=a.shape,s=o.slice(0,1).concat(i.fixUnknownDimension(o.slice(1),i.targetShape));return a.reshape(s)})},t.prototype.getConfig=function(){var n={targetShape:this.targetShape},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Reshape",t}(tn);Ne.registerClass(Oee);var Iee=function(e){function t(n){var r=e.call(this,n)||this;if(n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+n.dims+" instead.");var i=Xs(1,n.dims.length+1);if(!pt.arraysEqual(n.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=n.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Mi({ndim:r.dims.length+1})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=(n=Xn(n)).slice();return this.dims.forEach(function(i,a){r[a+1]=n[i]}),r},t.prototype.call=function(n,r){return cn(Dt(n),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var n={dims:this.dims},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Permute",t}(tn);Ne.registerClass(Iee);var Nee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,r.maskValue=n!=null?n.maskValue==null?0:n.maskValue:0,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,n),r},t.prototype.computeMask=function(n,r){var i=Dt(n);return Nb(Lm(i,this.maskValue),-1)},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=Nb(Lm(a,i.maskValue),-1,!0);return a.mul(o.asType(a.dtype))})},t.className="Masking",t}(tn);Ne.registerClass(Nee);var Dee=function(e){function t(n){var r=e.call(this,n)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){var i=null;n.batchSize!=null&&(i=n.batchSize),n.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Qn(n.inputLength))}return r.inputDim=n.inputDim,Sa(r.inputDim,"inputDim"),r.outputDim=n.outputDim,Sa(r.outputDim,"outputDim"),r.embeddingsInitializer=rr(n.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=ir(n.embeddingsRegularizer),r.activityRegularizer=ir(n.activityRegularizer),r.embeddingsConstraint=Kr(n.embeddingsConstraint),r.maskZero=n.maskZero,r.supportsMasking=n.maskZero,r.inputLength=n.inputLength,r}return Ee(t,e),t.prototype.build=function(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(n){},t.prototype.computeMask=function(n,r){var i=this;return le(function(){return i.maskZero?(n=Dt(n),Lm(n,en(n))):null})},t.prototype.computeOutputShape=function(n){if(n=Xn(n),this.inputLength==null)return n.concat([this.outputDim]);var r=Qn(this.inputLength);if(r.length!==n.length-1)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);for(var i=0,a=0;a<r.length;++a){var o=r[a],s=n[a+1];if(o!=null&&s!=null&&o!==s)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);o==null&&(r[i]=s),i++}return[n[0]].concat(r,[this.outputDim])},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return a.dtype!=="int32"&&(a=Ub(a,"int32")),yQ(i.embeddings.read(),a.as1D()).reshape(Xn(i.computeOutputShape(a.shape)))})},t.prototype.getConfig=function(){var n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vn(this.embeddingsInitializer),embeddingsRegularizer:Vt(this.embeddingsRegularizer),activityRegularizer:Vt(this.activityRegularizer),embeddingsConstraint:Ln(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Embedding",t}(tn);Ne.registerClass(Dee);var rp=function(e){function t(n){var r=e.call(this,n||{})||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.mergeFunction=function(n){throw new $t},t.prototype.computeElementwiseOpOutputShape=function(n,r){if(n==null||r==null)return null;if(n.length<r.length)return this.computeElementwiseOpOutputShape(r,n);if(r.length===0)return n;for(var i=n.slice(0,n.length-r.length),a=0;a<r.length;++a){var o=n[n.length-r.length+a],s=r[a];if(o==null||s==null||o<0||s<0)i.push(null);else if(o===1)i.push(s);else if(s===1)i.push(o);else{if(o!==s)throw new ie("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(r));i.push(o)}}return i},t.prototype.build=function(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Xn(n)]),(n=n).length<2)throw new ie("A merge layer should be called on an Array of at least 2 inputs. Got "+n.length+" input(s).");for(var r=[],i=0,a=n;i<a.length;i++)(u=a[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=Wf(r)).length>1)throw new ie("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(n)+".");for(var o=n[0]==null?null:n[0].slice(1),s=1;s<n.length;++s){var u=n[s]==null?null:n[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var l=n.map(function(c){return c.length});n.indexOf(null)===-1&&Wf(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if(n=n,i.reshapeRequired){var a=[],o=n.map(function(_){return _.rank});if(o.indexOf(null)===-1){for(var s=qf(o),u=0,l=n;u<l.length;u++){for(var c=(g=l[u]).rank,f=0;f<s-c;++f)g=Wb(g,1);a.push(g)}return i.mergeFunction(a)}for(var d=!1,h=0,p=n;h<p.length;h++){var g;if((c=(g=p[h]).rank)==null){var m=g.shape,v=m[0],y=m.slice(1).concat([v]),b=g.reshape([v].concat(Vf(m.slice(1))));b=(b=cn(b,[1,0])).reshape(y),a.push(b),d=!0}else if(c>1){var x=Xs(1,c).concat([0]);a.push(cn(g,x)),d=!0}else a.push(g)}var w=i.mergeFunction(a),S=w.rank;if(d)if(S==null){var A=w.shape;y=[v=A[A.length-1]].concat(A.slice(0,A.length-1)),w=cn(w.reshape([-1,v]),[1,0]).reshape(y)}else S>1&&(x=[S-1].concat(Xs(0,S-1)),w=cn(w,x));return w}return i.mergeFunction(n)})},t.prototype.computeOutputShape=function(n){var r;r=(n=n)[0]==null?null:n[0].slice(1);for(var i=1;i<n.length;++i){var a=n[i]==null?null:n[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}for(var o=[],s=0,u=n;s<u.length;s++)(a=u[s])!=null&&a[0]!==null&&o.push(a[0]);return r=(o=Wf(o)).length===1?o.concat(r):[null].concat(r)},t.prototype.computeMask=function(n,r){return le(function(){if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an Array");if(!Array.isArray(n))throw new ie("`inputs` should be an Array");if(r.length!==n.length)throw new ie("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+n.length+" vs "+r.length+")");if(r.every(function(o){return o==null}))return null;for(var i=(r=r.map(function(o){return o==null?o:Fo(o,0)}))[0],a=1;a<r.length-1;++a)i=Gu(i,r[a]);return i})},t}(tn),Ree=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return r})},t.className="Add",t}(rp);Ne.registerClass(Ree);var Fee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=rt(r,n[i]);return r})},t.className="Multiply",t}(rp);Ne.registerClass(Fee);var Mee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return rt(1/n.length,r)})},t.className="Average",t}(rp);Ne.registerClass(Mee);var Pee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=qu(r,n[i]);return r})},t.className="Maximum",t}(rp);Ne.registerClass(Pee);var $ee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=Im(r,n[i]);return r})},t.className="Minimum",t}(rp);Ne.registerClass($ee);var Lee=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_AXIS=-1,n==null&&(n={}),r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){if(!Array.isArray(n)||!Array.isArray(n[0])||n.length===1)throw new ie("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,a=n=n;i<a.length;i++)if((d=a[i])!=null){r=!1;break}if(!r){for(var o=[],s=0;s<n.length;++s){var u=n[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,f=o;c<f.length;c++){var d=f[c];if(pt.arraysEqual(d,u)){l=!0;break}}l||o.push(u)}if(o.length>1)throw new ie("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}},t.prototype.mergeFunction=function(n){var r=this;return le(function(){return mQ(n,r.axis)})},t.prototype.computeOutputShape=function(n){if(!Array.isArray(n)||!Array.isArray(n[0]))throw new ie("A `Concatenate` layer should be called on a list of inputs.");for(var r=n,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis,o=0,s=r.slice(1);o<s.length;o++){var u=s[o];if(i[a]==null||u[a]==null){i[a]=null;break}i[a]+=u[a]}return i},t.prototype.computeMask=function(n,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new ie("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new ie("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+n.length+")");return le(function(){var a=!0;if(r.forEach(function(l){l==null||(a=!1)}),a)return null;for(var o=[],s=0;s<n.length;++s)r[s]==null?o.push(Ro(n[s]).asType("bool")):r[s].rank<n[s].rank?o.push(Fo(r[s],-1)):o.push(r[s]);var u=Hi(o,i.axis);return CE(u,-1,!1)})},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Concatenate",t}(rp);function Zb(e,t){for(;e<0;)e+=t;return e}function $ze(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new $t("batchDot is not implemented for tensors of 4D or higher rank yet");if(pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length}),pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new $t("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);var a=n;return le(function(){var o,s;if(r>i){o=r-i;for(var u=[],l=0;l<o;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){for(o=i-r,u=[],l=0;l<o;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else o=0;if(e.shape.length===2&&t.shape.length===2)s=a[0]===a[1]?e.mulStrict(t).sum(a[0]):e.transpose([1,0]).mulStrict(t).sum(a[1]);else{var c=a[0]!==e.shape.length-1,f=a[1]===t.shape.length-1;s=e.matMul(t,c,f)}if(o>0){var d=void 0,h=[];for(l=d=r>i?r+i-3:r-1;l<d+o;++l)h.push(l);s=s.squeeze(h)}return s.shape.length===1&&(s=s.expandDims(1)),s})}Ne.registerClass(Lee);var Bee=function(e){function t(n){var r=e.call(this,n)||this;return r.axes=n.axes,r.normalize=n.normalize!=null&&n.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0],i=n[1];if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);if(r[a[0]]!==i[a[1]])throw new ie("Dimension incompatibility: "+r[a[0]]+" !== "+i[a[1]])},t.prototype.mergeFunction=function(n){if(n.length!==2)throw new ie("A `Dot` layer must be called on exactly 2 inputs, but received "+n.length+" input(s).");var r,i=n[0],a=n[1];return r=Array.isArray(this.axes)?this.axes.map(function(o,s){return Zb(o,n[s].shape.length)}):[Zb(this.axes,i.shape.length),Zb(this.axes,a.shape.length)],this.normalize&&(i=KE(i,r[0]),a=KE(a,r[1])),$ze(i,a,r)},t.prototype.interpretAxes=function(n,r){return Array.isArray(this.axes)?this.axes:[Zb(this.axes,n.length),Zb(this.axes,r.length)]},t.prototype.computeOutputShape=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);r.splice(a[0],1),i.splice(a[1],1),i.splice(0,1);var o=r.concat(i);return o.length===1&&o.push(1),o},t.prototype.computeMask=function(n,r){return null},t.prototype.getConfig=function(){var n={axes:this.axes,normalize:this.normalize},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dot",t}(rp);Ne.registerClass(Bee);var zee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.stddev=n.stddev,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return Qm(function(){return UE(a.shape,0,i.stddev).add(a)},function(){return a},r.training||!1)})},t.className="GaussianNoise",t}(tn);Ne.registerClass(zee);var jee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.rate>0&&i.rate<1?Qm(function(){var o=Math.sqrt(i.rate/(1-i.rate));return a.mul(UE(a.shape,1,o))},function(){return a},r.training||!1):a})},t.className="GaussianDropout",t}(tn);Ne.registerClass(jee);var Uee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r.noiseShape=n.noiseShape,r}return Ee(t,e),t.prototype._getNoiseShape=function(n){return this.noiseShape||Dt(n).shape},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){if(i.rate<1&&i.rate>0){var a=i._getNoiseShape(n);return Qm(function(){var o=Dt(n),s=-1.7580993408473766,u=Tb(qh(a),i.rate);u=Ub(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return o.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Dt(n)},r.training||!1)}return n})},t.className="AlphaDropout",t}(tn);function Jb(e,t,n,r,i,a){var o;if(a===void 0&&(a=.001),e.rank===2)o=AM(e,t,n,r,i,a);else if(e.rank===3)o=CM(e,t,n,r,i,a);else{if(e.rank!==4)throw new $t("batchNormalization is not implemented for array of rank "+e.rank+" yet");o=kM(e,t,n,r,i,a)}return o}function Lze(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){var a=Rb(e,r),o=a.mean,s=a.variance;return[Jb(e,o,s,n,t,i),o,s]})}function Bze(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){for(var a=Rb(e,r),o=a.mean,s=a.variance,u=[],l=0,c=Xs(0,e.rank);l<c.length;l++){var f=c[l];r.indexOf(f)!==-1?u.push(1):u.push(e.shape[f])}var d=o.reshape(u),h=s.reshape(u),p=t==null?null:t.reshape(u),g=n==null?null:n.reshape(u);return[Jb(e,d,h,g,p,i),o,s]})}function zze(e,t,n,r,i){return i===void 0&&(i=.001),pt.arraysEqual(r.slice().sort(),Xs(0,e.rank-1))?Lze(e,t,n,r,i):Bze(e,t,n,r,i)}Ne.registerClass(Uee);var Wee=function(e){function t(n){var r=this;return n==null&&(n={}),(r=e.call(this,n)||this).supportsMasking=!0,r.axis=n.axis==null?-1:n.axis,r.momentum=n.momentum==null?.99:n.momentum,r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=rr(n.betaInitializer||"zeros"),r.gammaInitializer=rr(n.gammaInitializer||"ones"),r.movingMeanInitializer=rr(n.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=rr(n.movingVarianceInitializer||"ones"),r.betaConstraint=Kr(n.betaConstraint),r.gammaConstraint=Kr(n.gammaConstraint),r.betaRegularizer=ir(n.betaRegularizer),r.gammaRegularizer=ir(n.gammaRegularizer),r}return Ee(t,e),t.prototype.build=function(n){var r;n=Xn(n);var i=this.axis>=0?this.axis:this.axis+n.length,a=n[i];if(a==null)throw new ie("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(n)+".");this.inputSpec=[new Mi({ndim:n.length,axes:(r={},r[i]=a,r)})];var o=[a];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training,o=Dt(n),s=o.shape,u=s.length,l=Xs(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var f=Zh(1,u);f[c]=s[c];var d=l.slice();d.sort();var h=!pt.arraysEqual(d,Xs(0,u).slice(0,u-1));if(!a)return function(){if(h){var b=i.movingMean.read().reshape(f),x=i.movingVariance.read().reshape(f),w=i.center?i.beta.read().reshape(f):null,S=i.scale?i.gamma.read().reshape(f):null;return Jb(o,b,x,w,S,i.epsilon)}return Jb(o,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var p=zze(o,i.gamma.read(),i.beta.read(),l,i.epsilon),g=p[0],m=p[1],v=p[2],y=function(b,x,w){le(function(){var S=1-w,A=b.read(),_=A.sub(x).mul(S);b.write(A.sub(_))})};return y(i.movingMean,m,i.momentum),y(i.movingVariance,v,i.momentum),g})},t.prototype.getConfig=function(){var n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),movingMeanInitializer:vn(this.movingMeanInitializer),movingVarianceInitializer:vn(this.movingVarianceInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer),betaConstraint:Ln(this.betaConstraint),gammaConstraint:Ln(this.gammaConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="BatchNormalization",t}(tn);Ne.registerClass(Wee);var Vee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).axis=n.axis==null?-1:n.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,a=r.axis;i<a.length;i++){var o=a[i];if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=rr(n.betaInitializer||"zeros"),r.gammaInitializer=rr(n.gammaInitializer||"ones"),r.betaRegularizer=ir(n.betaRegularizer),r.gammaRegularizer=ir(n.gammaRegularizer),r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var a=0,o=this.axis;a<o.length;a++){var s=o[a];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==Wf(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return n[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(n,r){var i=this,a=Dt(n),o=a.shape,s=o.length;return le(function(){for(var u=Rb(a,i.axis,!0),l=u.mean,c=u.variance,f=Zh(1,s),d=0,h=i.axis;d<h.length;d++){var p=h[d];f[p]=o[p]}for(var g=function(w){return w!=null&&w.shape.length!==s&&i.axis!==[s-1]?w.reshape(f):w},m=g(i.gamma.read()),v=g(i.beta.read()),y=[],b=[],x=0;x<s;++x)i.axis.indexOf(x)!==-1?(y.push(o[x]),b.push(1)):(y.push(1),b.push(o[x]));return l=l.tile(y),c=c.tile(y),m=m.tile(b),v=v.tile(b),Jb(a,l,c,v,m,i.epsilon)})},t.prototype.getConfig=function(){var n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LayerNormalization",t}(tn);function jze(e,t,n){return le(function(){if(e.rank!==4)throw new ie("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ie("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ks()),n!=="channelsLast"&&n!=="channelsFirst")throw new ie("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=n==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Ku(e,r)})}Ne.registerClass(Vee);var qee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).dataFormat=n.dataFormat==null?Ks():n.dataFormat,n.padding==null)r.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")r.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new ie("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+n.padding.length+" array.");var i=void 0,a=void 0;if(typeof n.padding[0]=="number")i=[n.padding[0],n.padding[0]],a=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new ie("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+n.padding[0].length+" array.");if(i=n.padding[0],n.padding[1].length!==2)throw new ie("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+n.padding[1].length+" array.");a=n.padding[1]}r.padding=[i,a]}return r.inputSpec=[new Mi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r,i;return n=Xn(n),this.dataFormat==="channelsFirst"?(r=n[2]!=null&&n[2]>=0?n[2]+this.padding[0][0]+this.padding[0][1]:null,i=n[3]!=null&&n[3]>=0?n[3]+this.padding[1][0]+this.padding[1][1]:null,[n[0],n[1],r,i]):(r=n[1]!=null&&n[1]>=0?n[1]+this.padding[0][0]+this.padding[0][1]:null,i=n[2]!=null&&n[2]>=0?n[2]+this.padding[1][0]+this.padding[1][1]:null,[n[0],r,i,n[3]])},t.prototype.call=function(n,r){var i=this;return le(function(){return jze(Dt(n),i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={padding:this.padding,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ZeroPadding2D",t}(tn);function aA(e,t,n,r,i,a){return le(function(){var o;Xr(i),cQ(a),ls(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Ks()),a==null&&(a="max"),e=i$(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?wE(e,t,n,s):_E(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}function Hee(e,t,n,r,i,a){return le(function(){var o;Xr(i),cQ(a),ls(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Ks()),a==null&&(a="max"),e=pee(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?SE(e,t,n,s):EE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,4,1,2,3])),o})}Ne.registerClass(qee);var Gee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=2),r=e.call(this,n)||this,typeof n.poolSize=="number")r.poolSize=[n.poolSize];else{if(!Array.isArray(n.poolSize)||n.poolSize.length!==1||typeof n.poolSize[0]!="number")throw new ie("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.poolSize));r.poolSize=n.poolSize}if(Sa(r.poolSize,"poolSize"),n.strides==null)r.strides=r.poolSize;else if(typeof n.strides=="number")r.strides=[n.strides];else{if(!Array.isArray(n.strides)||n.strides.length!==1||typeof n.strides[0]!="number")throw new ie("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.strides));r.strides=n.strides}return Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,ls(r.padding),r.inputSpec=[new Mi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=vc((n=Xn(n))[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],r,n[2]]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r),n=Wb(Dt(n),2);var a=i.poolingFunction(Dt(n),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return pb(a,[2])})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Kee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),aA(n,r,i,a,o,"max")},t.className="MaxPooling1D",t}(Gee);Ne.registerClass(Kee);var Xee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),aA(n,r,i,a,o,"avg")},t.className="AveragePooling1D",t}(Gee);Ne.registerClass(Xee);var Yee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new ie("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),ls(r.padding),r.inputSpec=[new Mi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2];return r=vc(r,this.poolSize[0],this.padding,this.strides[0]),i=vc(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i]:[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Zee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),aA(n,r,i,a,o,"max")},t.className="MaxPooling2D",t}(Yee);Ne.registerClass(Zee);var Jee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),aA(n,r,i,a,o,"avg")},t.className="AveragePooling2D",t}(Yee);Ne.registerClass(Jee);var Qee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new ie("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),ls(r.padding),r.inputSpec=[new Mi({ndim:5})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[4]:n[3];return r=vc(r,this.poolSize[0],this.padding,this.strides[0]),i=vc(i,this.poolSize[1],this.padding,this.strides[1]),a=vc(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i,a]:[n[0],r,i,a,n[4]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),ete=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),Hee(n,r,i,a,o,"max")},t.className="MaxPooling3D",t}(Qee);Ne.registerClass(ete);var tte=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),Hee(n,r,i,a,o,"avg")},t.className="AveragePooling3D",t}(Qee);Ne.registerClass(tte);var nte=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[new Mi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],n[2]]},t.prototype.call=function(n,r){throw new $t},t}(tn),rte=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Pr(i,1)})},t.className="GlobalAveragePooling1D",t}(nte);Ne.registerClass(rte);var ite=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Mf(i,1)})},t.className="GlobalMaxPooling1D",t}(nte);Ne.registerClass(ite);var ate=function(e){function t(n){var r=e.call(this,n)||this;return r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),r.inputSpec=[new Mi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]},t.prototype.call=function(n,r){throw new $t},t.prototype.getConfig=function(){var n={dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),ote=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Pr(a,[1,2]):Pr(a,[2,3])})},t.className="GlobalAveragePooling2D",t}(ate);Ne.registerClass(ote);var ste=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Mf(a,[1,2]):Mf(a,[2,3])})},t.className="GlobalMaxPooling2D",t}(ate);function ute(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new ie("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function lte(e,t,n,r,i,a,o,s){return r===void 0&&(r=!1),o===void 0&&(o=!1),s===void 0&&(s=!1),le(function(){var u=t.shape.length;if(u<3)throw new ie("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Xs(2,u));if(t=cn(t,l),a!=null)throw new $t("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Fo(i,-1)),i=cn(i,l)),r&&(t=Xu(t,0),i!=null&&(i=Xu(i,0)));var c,f,d=[],h=n,p=t.shape[0],g=If(t);i!=null&&(f=If(i));for(var m,v=function(b){var x=g[b],w=le(function(){return e(x,h)});if(i==null)c=w[0],h=w[1];else{var S=le(function(){var A=f[b],_=Ro(A).sub(A);return{output:w[0].mul(A).addStrict(h[0].mul(_)),newStates:h.map(function(E,C){return w[1][C].mul(A).addStrict(E.mul(_))})}});c=S.output,h=S.newStates}s&&d.push(c)},y=0;y<p;++y)v(y);return s&&(m=ss(d,1)),[c,m,h]})}Ne.registerClass(ste);var rv=function(e){function t(n){var r,i=e.call(this,n)||this;if(n.cell==null)throw new ie("cell property is missing for the constructor of RNN.");if((r=Array.isArray(n.cell)?new c$({cells:n.cell}):n.cell).stateSize==null)throw new ie("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=n.returnSequences!=null&&n.returnSequences,i.returnState=n.returnState!=null&&n.returnState,i.goBackwards=n.goBackwards!=null&&n.goBackwards,i._stateful=n.stateful!=null&&n.stateful,i.unroll=n.unroll!=null&&n.unroll,i.supportsMasking=!0,i.inputSpec=[new Mi({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return Ee(t,e),t.prototype.getStates=function(){return this.states_==null?Xs(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(n){return null}):this.states_},t.prototype.setStates=function(n){this.states_=n},t.prototype.computeOutputShape=function(n){zP(n)&&(n=n[0]),n=n;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[n[0],n[1],a]:[n[0],a],this.returnState){for(var o=[],s=0,u=r;s<u.length;s++){var l=u[s];o.push([n[0],l])}return[i].concat(o)}return i},t.prototype.computeMask=function(n,r){var i=this;return le(function(){Array.isArray(r)&&(r=r[0]);var a=i.returnSequences?r:null;if(i.returnState){var o=i.states.map(function(s){return null});return[a].concat(o)}return a})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<n;++i)r.push(null);return r}return this.states_},set:function(n){this.states_=n},enumerable:!0,configurable:!0}),t.prototype.build=function(n){if(this.numConstants!=null)throw new $t("Constants support is not implemented in RNN yet.");zP(n)&&(n=n[0]),n=n;var r=this.stateful?n[0]:null,i=n[n.length-1];this.inputSpec[0]=new Mi({shape:[r,null,i]});var a,o=[n[0]].concat(n.slice(2));if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!pt.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),a))throw new ie("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map(function(s){return new Mi({shape:[null,s]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(n,r){var i=this;r===void 0&&(r=!1),le(function(){if(!i.stateful)throw new Yh("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=i.inputSpec[0].shape[0];if(a==null)throw new ie("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_=[Tn([a,i.cell.stateSize])];else if(n==null)Ut(i.states_),i.keptStates!=null&&(Ut(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_[0]=Tn([a,i.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==i.states_.length)throw new ie("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+n.length+" state value(s). Input received: "+n);r===!0?i.keptStates.push(i.states_.slice()):Ut(i.states_);for(var o=0;o<i.states_.length;++o){var s=n[o],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[o]:i.cell.stateSize,l=[a,u];if(!pt.arraysEqual(s.shape,l))throw new ie("State "+o+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[o]=s}}i.states_=i.states_.map(function(c){return ju(c.clone())})})},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=ute(n,i,a,this.numConstants);n=o.inputs,i=o.initialState,a=o.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var f=c[l];this.stateSpec.push(new Mi({shape:f.shape}))}u=u.concat(this.stateSpec)}if(a!=null&&(r.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof Ju){var d=[n].concat(s),h=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=h;var g=e.prototype.apply.call(this,d,r);return this.inputSpec=p,g}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=Dt(n),s==null&&(s=i.stateful?i.states_:i.getInitialState(n));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new ie("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:o},c=lte(function(g,m){var v=i.cell.call([g].concat(m),l);return[v[0],v.slice(1)]},n,s,i.goBackwards,a,null,i.unroll,i.returnSequences),f=c[0],d=c[1],h=c[2];i.stateful&&i.resetStates(h,o);var p=i.returnSequences?d:f;return i.returnState?[p].concat(h):p})},t.prototype.getInitialState=function(n){var r=this;return le(function(){var i=Tn(n.shape);return i=Wb(i=Hr(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(a){return a>1?NP(i,[1,a]):i}):r.cell.stateSize>1?[NP(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);var r=this.cell.getConfig();n.cell={className:this.cell.getClassName(),config:r};var i=e.prototype.getConfig.call(this);return Object.assign(n,i),n},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Zs(r.cell,i);return new n(Object.assign(r,{cell:a}))},t.className="RNN",t}(tn);Ne.registerClass(rv);var Qb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(tn),s$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation==null?r.DEFAULT_ACTIVATION:n.activation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Jm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Jm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){n=Xn(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("SimpleRNNCell expects 2 input Tensors, got "+n.length+".");var a=n[1];n=n[0];var o,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=iv(function(){return Ro(n)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=iv(function(){return Ro(a)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;o=gc(u!=null?rt(n,u):n,i.kernel.read()),i.bias!=null&&(o=mc(o,i.bias.read())),l!=null&&(a=rt(a,l));var c=Wt(o,gc(a,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="SimpleRNNCell",t}(Qb);Ne.registerClass(s$);var cte=function(e){function t(n){return n.cell=new s$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return new n(r)},t.className="SimpleRNN",t}(rv);Ne.registerClass(cte);var u$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Gf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Jm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Jm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n))[n.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("GRUCell expects 2 input Tensors (inputs, h, c), got "+n.length+".");var a=r.training!=null&&r.training,o=n[1];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=iv(function(){return Ro(n)},i.dropout,a,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=iv(function(){return Ro(o)},i.recurrentDropout,a,3));var s,u,l,c=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,c[0]));var d=gc(n,i.kernel.read());i.useBias&&(d=mc(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,f[0]));var h=i.recurrentKernel.read(),p=sc(h,[2*i.units,i.units],h.rank-1),g=p[0],m=p[1],v=gc(o,g),y=sc(d,3,d.rank-1),b=y[0],x=y[1],w=y[2],S=sc(v,2,v.rank-1),A=S[0],_=S[1];s=i.recurrentActivation.apply(Wt(b,A)),u=i.recurrentActivation.apply(Wt(x,_));var E=gc(rt(u,o),m);l=i.activation.apply(Wt(w,E));var C=Wt(rt(s,o),rt(Wt(1,Df(s)),l));return[C,C]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),recurrentActivation:Lo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="GRUCell",t}(Qb);Ne.registerClass(u$);var fte=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new u$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),recurrentActivation:Lo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="GRU",t}(rv);Ne.registerClass(fte);var l$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Gf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=n.unitForgetBias,r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Jm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Jm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r,i,a=(n=Xn(n))[n.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return Ee(l,u),l.prototype.apply=function(c,f){var d=o.apply([s]),h=new RP().apply([s]),p=o.apply([2*s]);return vQ(vQ(d,h),p)},l}(Ys)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training;if((n=n).length!==3)throw new ie("LSTMCell expects 3 input Tensors (inputs, h, c), got "+n.length+".");var o=n[1],s=n[2];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=iv(function(){return Ro(n)},i.dropout,a,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=iv(function(){return Ro(o)},i.recurrentDropout,a,4));var u,l,c,f,d=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,d[0]));var p=gc(n,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,h[0])),p=Wt(p,gc(o,i.recurrentKernel.read())),i.useBias&&(p=mc(p,i.bias.read()));var g=sc(p,4,p.rank-1),m=g[0],v=g[1],y=g[2],b=g[3];u=i.recurrentActivation.apply(m),l=i.recurrentActivation.apply(v),c=Wt(rt(l,s),rt(u,i.activation.apply(y))),f=i.recurrentActivation.apply(b);var x=rt(f,i.activation.apply(c));return[x,x,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),recurrentActivation:Lo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LSTMCell",t}(Qb);Ne.registerClass(l$);var dte=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new l$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Lo(this.activation),recurrentActivation:Lo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="LSTM",t}(rv);Ne.registerClass(dte);var c$=function(e){function t(n){var r=e.call(this,n)||this;return r.cells=n.cells,r}return Ee(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var n=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var a=i[r];Array.isArray(a.stateSize)?n.push.apply(n,a.stateSize):n.push(a.stateSize)}return n},enumerable:!0,configurable:!0}),t.prototype.call=function(n,r){var i=this;return le(function(){for(var a=(n=n).slice(1),o=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?o.push(a.splice(0,l.stateSize.length)):o.push(a.splice(0,1))}o.reverse();for(var c,f=[],d=0;d<i.cells.length;++d)l=i.cells[d],a=o[d],c=d===0?[n[0]].concat(a):[c[0]].concat(a),c=l.call(c,r),f.push(c.slice(1));a=[];for(var h=0,p=f.slice().reverse();h<p.length;h++){var g=p[h];a.push.apply(a,g)}return[c[0]].concat(a)})},t.prototype.build=function(n){var r;zP(n)&&(n=n[0]),n=n,this.cells.forEach(function(i,a){Qh("RNNCell_"+a,function(){i.build(n),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,n=[n[0],r]})}),this.built=!0},t.prototype.getConfig=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push({className:a.getClassName(),config:a.getConfig()})}var o={cells:n},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(n,r,i){i===void 0&&(i={});for(var a=[],o=0,s=r.cells;o<s.length;o++){var u=s[o];a.push(Zs(u,i))}return new n({cells:a})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.cells;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.weights)}return jP(n)},t.prototype.setWeights=function(n){for(var r=[],i=0,a=this.cells;i<a.length;i++)for(var o=a[i],s=o.weights.length,u=n.splice(s),l=0;l<o.weights.length;++l)r.push([o.weights[l],u[l]]);UP(r)},t.className="StackedRNNCells",t}(Qb);function iv(e,t,n,r){function i(){return bQ(e(),t)}if(n===void 0&&(n=null),r===void 0&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(Qm(i,e,n));return a.map(function(s){return ju(s.clone())})}return ju(Qm(i,e,n).clone())}Ne.registerClass(c$);var hte=function(e){function t(n){var r=e.call(this,n)||this;return r.layer=n.layer,r}return Ee(t,e),t.prototype.build=function(n){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(n){this.layer!=null&&(this.layer.trainable=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(n){this.layer.setWeights(n)},t.prototype.getConfig=function(){var n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Zs(r.layer,i);delete r.layer;var o={layer:a};return Object.assign(o,r),new n(o)},t}(tn),pte=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){if((n=Xn(n)).length<3)throw new ie("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(n));this.inputSpec=[{shape:n}];var r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),e.prototype.build.call(this,n)},t.prototype.computeOutputShape=function(n){var r=[(n=Xn(n))[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),a=n[1];return[i[0],a].concat(i.slice(1))},t.prototype.call=function(n,r){var i=this;return le(function(){return lte(function(a,o){return[Dt(i.layer.call(a,r)),[]]},n=Dt(n),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(hte);function Uze(e){Ym(R4e,"BidirectionalMergeMode",e)}Ne.registerClass(pte);var Wze="concat",gte=function(e){function t(n){var r=e.call(this,n)||this,i=n.layer.getConfig(),a={};a.className=n.layer.getClassName(),a.config=i,r.forwardLayer=Zs(a),i.goBackwards=i.goBackwards!==!0;var o={};if(o.className=n.layer.getClassName(),o.config=i,r.backwardLayer=Zs(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=n.mergeMode===void 0?Wze:n.mergeMode,Uze(r.mergeMode),n.weights)throw new $t("weights support is not implemented for Bidirectional layer yet.");return r._stateful=n.layer.stateful,r.returnSequences=n.layer.returnSequences,r.returnState=n.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=n.layer.inputSpec,r.numConstants=null,r}return Ee(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(n){var r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))},t.prototype.computeOutputShape=function(n){var r,i,a,o=this.forwardLayer.computeOutputShape(n);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState&&(a=o.slice(1)),r=o[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):_a(i)},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=ute(n,i,a,this.numConstants);if(n=o.inputs,i=o.initialState,a=o.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&a==null)return e.prototype.apply.call(this,n,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new ie("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new Mi({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(a!=null)throw new $t("Support for constants in Bidirectional layers is not implemented yet.");for(var f=s[0]instanceof Ju,d=0,h=s;d<h.length;d++)if(h[d]instanceof Ju!==f)throw new ie("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(f){var p=[n].concat(s),g=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,r);return this.inputSpec=m,v}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a,o,s,u,l=r.initialState;if(l==null)a=i.forwardLayer.call(n,r),o=i.backwardLayer.call(n,r);else{var c=l.slice(0,l.length/2),f=l.slice(l.length/2);a=i.forwardLayer.call(n,Object.assign(r,{initialState:c})),o=i.backwardLayer.call(n,Object.assign(r,{initialState:f}))}return i.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),i.returnSequences&&(o=Xu(o,1)),i.mergeMode==="concat"?u=mQ([a,o]):i.mergeMode==="sum"?u=Wt(a,o):i.mergeMode==="ave"?u=rt(.5,Wt(a,o)):i.mergeMode==="mul"?u=rt(a,o):i.mergeMode==null&&(u=[a,o]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},t.prototype.resetStates=function(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(n){var r=this;Qh(this.forwardLayer.name,function(){r.forwardLayer.build(n)}),Qh(this.backwardLayer.name,function(){r.backwardLayer.build(n)}),this.built=!0},t.prototype.computeMask=function(n,r){var i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?this.mergeMode==null?[r,r]:r:this.mergeMode==null?[null,null]:null,this.returnState){var a=this.forwardLayer.states.map(function(o){return null});return Array.isArray(i)?i.concat(a).concat(a):[i].concat(a).concat(a)}return i},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={mergeMode:this.mergeMode},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.fromConfig=function(n,r){var i=Zs(r.layer);if(delete r.layer,r.numConstants!=null)throw new $t("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=r;return a.layer=i,new n(a)},t.className="Bidirectional",t}(hte);function Vze(e){return new qb(e)}function qze(e){return new fee(e)}function Hze(e){return new uee(e)}function Gze(e){return new lee(e)}function Kze(e){return new cee(e)}function Xze(e){return new hee(e)}function Yze(e){return new dee(e)}function Zze(e){return new xee(e)}function Jze(e){return new a$(e)}function Qze(e){return new yee(e)}function e5e(e){return new vee(e)}function t5e(e){return new bee(e)}function n5e(e){return new wee(e)}function r5e(e){return new _ee(e)}function i5e(e){return new See(e)}function a5e(e){return new kee(e)}function o5e(e){return new Aee(e)}function s5e(e){return new o$(e)}function u5e(e){return new Eee(e)}function l5e(e){return new Cee(e)}function c5e(e){return new Tee(e)}function f5e(e){return new Oee(e)}function d5e(e){return new Iee(e)}function h5e(e){return new Dee(e)}function p5e(e){return new Ree(e)}function g5e(e){return new Mee(e)}function m5e(e){return new Lee(e)}function v5e(e){return new Pee(e)}function y5e(e){return new $ee(e)}function b5e(e){return new Fee(e)}function x5e(e){return new Bee(e)}function w5e(e){return new Wee(e)}function _5e(e){return new Vee(e)}function S5e(e){return new qee(e)}function f$(e){return new Xee(e)}function E5e(e){return f$(e)}function A5e(e){return f$(e)}function d$(e){return new Jee(e)}function C5e(e){return d$(e)}function k5e(e){return d$(e)}function h$(e){return new tte(e)}function T5e(e){return h$(e)}function O5e(e){return h$(e)}function I5e(e){return new rte(e)}function N5e(e){return new ote(e)}function mte(e){return new ite(e)}function vte(e){return new ste(e)}function yte(e){return new Kee(e)}function bte(e){return new Zee(e)}function D5e(e){return new ete(e)}function R5e(e){return new fte(e)}function F5e(e){return new u$(e)}function M5e(e){return new dte(e)}function P5e(e){return new l$(e)}function $5e(e){return new cte(e)}function L5e(e){return new s$(e)}function B5e(e){return new rv(e)}function z5e(e){return new c$(e)}function j5e(e){return new gte(e)}function U5e(e){return new pte(e)}Ne.registerClass(gte);var W5e=mte,V5e=vte,q5e=yte,H5e=bte;function G5e(e){return new zee(e)}function K5e(e){return new jee(e)}function X5e(e){return new Uee(e)}function Y5e(e){return new Nee(e)}var Z5e=Object.freeze({inputLayer:Vze,elu:qze,reLU:Hze,leakyReLU:Gze,prelu:Kze,softmax:Xze,thresholdedReLU:Yze,conv1d:Zze,conv2d:Jze,conv2dTranspose:Qze,conv3d:e5e,separableConv2d:t5e,cropping2D:n5e,upSampling2d:r5e,depthwiseConv2d:i5e,activation:a5e,dense:o5e,dropout:s5e,spatialDropout1d:u5e,flatten:l5e,repeatVector:c5e,reshape:f5e,permute:d5e,embedding:h5e,add:p5e,average:g5e,concatenate:m5e,maximum:v5e,minimum:y5e,multiply:b5e,dot:x5e,batchNormalization:w5e,layerNormalization:_5e,zeroPadding2d:S5e,averagePooling1d:f$,avgPool1d:E5e,avgPooling1d:A5e,averagePooling2d:d$,avgPool2d:C5e,avgPooling2d:k5e,averagePooling3d:h$,avgPool3d:T5e,avgPooling3d:O5e,globalAveragePooling1d:I5e,globalAveragePooling2d:N5e,globalMaxPooling1d:mte,globalMaxPooling2d:vte,maxPooling1d:yte,maxPooling2d:bte,maxPooling3d:D5e,gru:R5e,gruCell:F5e,lstm:M5e,lstmCell:P5e,simpleRNN:$5e,simpleRNNCell:L5e,rnn:B5e,stackedRNNCells:z5e,bidirectional:j5e,timeDistributed:U5e,globalMaxPool1d:W5e,globalMaxPool2d:V5e,maxPool1d:q5e,maxPool2d:H5e,Layer:tn,RNN:rv,RNNCell:Qb,input:bze,gaussianNoise:G5e,gaussianDropout:K5e,alphaDropout:X5e,masking:Y5e});function J5e(e,t){return qP(e,t)}function Q5e(e,t){return BQ(e,t)}function e6e(e,t){return zQ(e,t)}function t6e(e,t){return HP(e,t)}function n6e(e,t){return GP(e,t)}function r6e(e,t){return LQ(e,t)}function i6e(e,t){return DBe(e,t)}function a6e(e,t){return WP(e,t)}function o6e(e,t){return XE(e,t)}function s6e(e,t){return tv(e,t)}function u6e(e,t){return tv(e,t)}function l6e(e,t){return tv(e,t)}function c6e(e,t){return tp(e,t)}function f6e(e,t){return tp(e,t)}function d6e(e,t){return tp(e,t)}Object.freeze({binaryAccuracy:J5e,binaryCrossentropy:Q5e,sparseCategoricalAccuracy:e6e,categoricalAccuracy:t6e,categoricalCrossentropy:n6e,precision:r6e,recall:i6e,cosineProximity:a6e,meanAbsoluteError:o6e,meanAbsolutePercentageError:s6e,MAPE:u6e,mape:l6e,meanSquaredError:c6e,MSE:f6e,mse:d6e}),Object.freeze({modelFromJSON:hze});function h6e(e){return new nA(e)}function p6e(e){return Nze(e)}function g6e(e){return Dze(e)}Object.freeze({l1l2:h6e,l1:p6e,l2:g6e});var m6e=function(e){function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.model=null,n}return Ee(t,e),t.prototype.setModel=function(n){if(!(n instanceof Yb))throw new Error("model must be a LayersModel, not some other Container");this.model=n},t}(ev);function oA(e,t){return e<t}function xte(e,t){return e>t}(function(e){function t(n){var r=e.call(this)||this;if(n==null&&(n={}),n.restoreBestWeights)throw new $t("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=n.monitor||"val_loss",r.minDelta=Math.abs(n.minDelta||0),r.patience=n.patience||0,r.verbose=n.verbose||0,r.mode=n.mode||"auto",r.baseline=n.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=oA:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=xte:r.monitorFunc=oA,r.monitorFunc===oA&&(r.minDelta*=-1),r}return Ee(t,e),t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===oA?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return[4,Hf(r)];case 1:return a.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=n,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(n){n==null&&(n={});var r=n[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(n)),r},t})(m6e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Js,wte,p$=function(){return(p$=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ip(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function ap(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Js||(Js={})),function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(wte||(wte={}));var v6e={};function _te(e){return v6e[e]}function $(e,t,n,r){var i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){var a=i.inputIndexStart,o=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return Ea(t.inputNames[i.inputIndexStart],n,r);if(i.type==="tensors")return t.inputNames.slice(a,o).map(function(l){return Ea(l,n,r)});var s=Array.prototype.slice.call(Ea(t.inputNames.slice(a)[0],n,r).dataSync());return i.type==="number"?s[0]:s}var u=t.attrParams[e];return u&&u.value}function Ea(e,t,n){var r=Bo(e),i=r[0],a=r[1],o=n.currentContextIds.find(function(s){return!!t[sA(i,s)]});return o!==void 0?t[sA(i,o)][a]:void 0}function y6e(e,t,n){return t[sA(e,n.currentContextId)]}function av(e,t){var n=Bo(e),r=n[0],i=n[1];return[sA(r,t&&t.currentContextId),i]}function sA(e,t){return t?e+"-"+t:e}function Bo(e){var t=e.lastIndexOf(":");return t===-1?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function g$(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var b6e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],x6e=Object.freeze({json:b6e}),w6e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_6e=Object.freeze({json:w6e}),S6e=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],E6e=Object.freeze({json:S6e}),A6e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],C6e=Object.freeze({json:A6e}),k6e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],T6e=Object.freeze({json:k6e}),O6e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],I6e=Object.freeze({json:O6e}),N6e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],D6e=Object.freeze({json:N6e}),R6e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],F6e=Object.freeze({json:R6e}),M6e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],P6e=Object.freeze({json:M6e}),$6e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],L6e=Object.freeze({json:$6e}),B6e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],z6e=Object.freeze({json:B6e}),j6e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],U6e=Object.freeze({json:j6e}),W6e=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],V6e=Object.freeze({json:W6e}),q6e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],H6e=Object.freeze({json:q6e}),G6e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],K6e=Object.freeze({json:G6e}),X6e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],Y6e=Object.freeze({json:X6e}),Z6e=function(){function e(){var t=[x6e,_6e,E6e,C6e,T6e,I6e,D6e,L6e,P6e,F6e,z6e,U6e,V6e,H6e,K6e,Y6e],n=[].concat.apply([],t.map(function(r){return r.json}));this.opMappers=n.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(t,n){var r=this;n===void 0&&(n={});var i=[],a=[],o=t.node.reduce(function(d,h){return d[h.name]=r.mapNode(h),h.op.startsWith("Placeholder")&&i.push(d[h.name]),h.op==="Const"&&a.push(d[h.name]),d},{}),s=[],u=[],l={},c={};n!=null&&(l=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var f=Object.keys(o);return f.forEach(function(d){var h=o[d];h.inputNames.forEach(function(p){var g=av(p)[0];h.inputs.push(o[g]),o[g].children.push(h)})}),Object.keys(c).length===0?f.forEach(function(d){var h=o[d];h.children.length===0&&u.push(h)}):Object.keys(c).forEach(function(d){var h=av(d)[0],p=o[h];p!=null&&(p.signatureKey=c[d],u.push(p))}),Object.keys(l).length>0?Object.keys(l).forEach(function(d){var h=av(d)[0],p=o[h];p&&(p.signatureKey=l[d],s.push(p))}):s=i,{nodes:o,inputs:s,outputs:u,weights:a,placeholders:i,signature:n}},e.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce(function(n,r){return n[t[r].name]=r,n},{})},e.prototype.mapNode=function(t){var n=_te(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(r.inputParams=n.inputs.reduce(function(i,a){return i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i},{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce(function(i,a){var o=a.type,s=void 0;switch(a.type){case"string":(s=m$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=m$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":(s=S$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=S$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":(s=y$(t.attr,a.tfName,a.defaultValue||0))===void 0&&a.tfDeprecatedName&&(s=y$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":(s=_$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=_$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":(s=v$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=v$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":(s=A$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=A$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":(s=w$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=w$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":(s=E$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=E$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":(s=b$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=b$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":(s=x$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=x$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+t.op)}return i[a.name]={value:s,type:o},i},{})),r},e}();function J6e(e){var t=pe().global;if(t.atob!==void 0)return t.atob(e);if(typeof Buffer!="undefined")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Ste(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):J6e(e);return t?n:n.toLowerCase()}function m$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i!=null?Ste(i.s,r):n}function v$(e,t,n){var r=e[t];return r?r.b:n}function y$(e,t,n){var r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function Ete(e){switch(typeof e=="string"&&(e=Js[e]),e){case Js.DT_FLOAT:return"float32";case Js.DT_INT32:case Js.DT_INT64:case Js.DT_INT8:case Js.DT_UINT8:return"int32";case Js.DT_BOOL:return"bool";case Js.DT_DOUBLE:return"float32";case Js.DT_STRING:return"string";default:return null}}function b$(e,t,n){var r=e[t];return r&&r.type?Ete(r.type):n}function x$(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map(function(i){return Ete(i)}):n}function Ate(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function w$(e,t,n){var r=e[t];return r&&r.shape?Ate(r.shape):n}function _$(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):n}function S$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i&&i.list&&i.list.s?i.list.s.map(function(a){return Ste(a,r)}):n}function E$(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return Ate(i)}):n}function A$(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var Q6e=function(){function e(t,n,r){var i=this;this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(a){return i.getInput(a)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(a,o){return a[o]=i.getAttr(o),a},{}))}return e.prototype.getInput=function(t){return Ea(t,this.tensorMap,this.context)},e.prototype.getAttr=function(t,n){var r=this.node.rawAttrs[t];if(r.tensor!=null)return Ea(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return y$(this.node.rawAttrs,t,n);if(r.s!=null)return m$(this.node.rawAttrs,t,n);if(r.b!=null)return v$(this.node.rawAttrs,t,n);if(r.shape!=null)return w$(this.node.rawAttrs,t,n);if(r.type!=null)return b$(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return _$(this.node.rawAttrs,t,n);if(r.list.s!=null)return S$(this.node.rawAttrs,t,n);if(r.list.shape!=null)return E$(this.node.rawAttrs,t,n);if(r.list.b!=null)return A$(this.node.rawAttrs,t,n);if(r.list.type!=null)return x$(this.node.rawAttrs,t,n)}return n},e}(),eje=function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Wt($("a",e,t,n),$("b",e,t,n))];case"AddN":return[EM($("tensors",e,t,n))];case"FloorMod":case"Mod":return[eM($("a",e,t,n),$("b",e,t,n))];case"Mul":return[rt($("a",e,t,n),$("b",e,t,n))];case"RealDiv":case"Div":return[kr($("a",e,t,n),$("b",e,t,n))];case"DivNoNan":return[hE($("a",e,t,n),$("b",e,t,n))];case"FloorDiv":return[XS($("a",e,t,n),$("b",e,t,n))];case"Sub":return[Cr($("a",e,t,n),$("b",e,t,n))];case"Minimum":return[Im($("a",e,t,n),$("b",e,t,n))];case"Maximum":return[qu($("a",e,t,n),$("b",e,t,n))];case"Pow":return[Nm($("a",e,t,n),$("b",e,t,n))];case"SquaredDifference":return[mE($("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},tje=function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Nf($("x",e,t,n))];case"Acos":return[F3($("x",e,t,n))];case"Acosh":return[M3($("x",e,t,n))];case"Asin":return[P3($("x",e,t,n))];case"Asinh":return[$3($("x",e,t,n))];case"Atan":return[L3($("x",e,t,n))];case"Atan2":return[Q3($("x",e,t,n),$("y",e,t,n))];case"Atanh":return[B3($("x",e,t,n))];case"Ceil":return[z3($("x",e,t,n))];case"Complex":return[ii($("real",e,t,n),$("imag",e,t,n))];case"Cos":return[j3($("x",e,t,n))];case"Cosh":return[U3($("x",e,t,n))];case"Elu":return[Um($("x",e,t,n))];case"Erf":return[W3($("x",e,t,n))];case"Exp":return[V3($("x",e,t,n))];case"Expm1":return[q3($("x",e,t,n))];case"Floor":return[qS($("x",e,t,n))];case"Log":return[lc($("x",e,t,n))];case"Log1p":return[H3($("x",e,t,n))];case"Imag":return[os($("x",e,t,n))];case"Neg":return[Df($("x",e,t,n))];case"Reciprocal":return[G3($("x",e,t,n))];case"Real":return[to($("x",e,t,n))];case"Relu":return[Pf($("x",e,t,n))];case"Round":return[K3($("x",e,t,n))];case"Selu":return[IE($("x",e,t,n))];case"Sigmoid":return[GS($("x",e,t,n))];case"Sin":return[Y3($("x",e,t,n))];case"Sign":return[X3($("x",e,t,n))];case"Sinh":return[Z3($("x",e,t,n))];case"Softplus":return[vb($("x",e,t,n))];case"Sqrt":return[yb($("x",e,t,n))];case"Square":return[gE($("x",e,t,n))];case"Tanh":return[KS($("x",e,t,n))];case"Tan":return[J3($("x",e,t,n))];case"Relu6":case"ClipByValue":return[xa($("x",e,t,n),$("clipValueMin",e,t,n),$("clipValueMax",e,t,n))];case"Rsqrt":return[HS(Ea(e.inputNames[0],t,n))];case"Prod":return[TE($("x",e,t,n),$("axes",e,t,n))];case"LeakyRelu":return[OE($("x",e,t,n),$("alpha",e,t,n))];case"Prelu":return[Fb($("x",e,t,n),$("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},nje=function(){function e(t,n,r,i,a,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var n=this.tensors[t];if(n.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor},e.prototype.readMany=function(t){var n=this;return t.map(function(r){return n.read(r)})},e.prototype.write=function(t,n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+n.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=n.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,n.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");r.tensor=n,r.written=!0,this.tensors[t]=r},e.prototype.writeMany=function(t,n){var r=this;if(t.length!==n.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+n.length+".");t.forEach(function(i,a){return r.write(i,n[a])})},e.prototype.gather=function(t,n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+n);if(!t){t=[];for(var r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Mr([],[0].concat(this.elementShape));var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),ss(i,0)},e.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return Mr([],[0].concat(this.elementShape));for(var n=[],r=0;r<this.size();r++)n.push(r);var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),Hi(i,0)},e.prototype.scatter=function(t,n){if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);if(t.length!==n.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+n.shape[0]);var r=Math.max.apply(Math,t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(t,If(n,0))},e.prototype.split=function(t,n){var r=this;if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);var i=0,a=t.map(function(c){return i+=c});if(i!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+n.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=i===0?0:n.size/i,s=[];le(function(){n=n.reshape([1,i,o]);for(var c=0;c<t.length;++c){var f=[0,c===0?0:a[c-1],0],d=[1,t[c],o];s[c]=Mo(n,f,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},e.prototype.assertShapesMatchAllowUndefinedSize=function(t,n,r){r===void 0&&(r=""),pt.assert(this.shapesEqualAllowUndefinedSize(t,n),function(){return r+" Shapes "+t+" and "+n+" must match"})},e.prototype.shapesEqualAllowUndefinedSize=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==-1&&n[r]!==-1&&t[r]!==n[r])return!1;return!0},e.nextId=0,e}(),rje=void 0,ije=function(e,t,n){return ip(rje,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W,G,K,ee;return ap(this,function(ce){switch(ce.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[$("pred",e,t,n).clone()]];case 2:return r=$("pred",e,t,n),i=$("data",e,t,n),[4,r.data()];case 3:return[2,ce.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=e.inputNames.find(function(he){return Ea(he,t,n)!==void 0}))?[Ea(a,t,n).clone()]:void 0];case 5:return o=$("frameName",e,t,n),s=$("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=$("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=$("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=$("size",e,t,n),f=$("dtype",e,t,n),d=$("elementShape",e,t,n),h=$("dynamicSize",e,t,n),p=$("clearAfterRead",e,t,n),g=$("identicalElementShapes",e,t,n),m=$("name",e,t,n),v=new nje(m,f,c,d,g,h,p),n.addTensorArray(v),[2,[Ve(v.id),Ve(1)]];case 9:return y=$("tensorArrayId",e,t,n),b=$("index",e,t,n),x=$("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[Ve(1)]];case 10:return w=$("tensorArrayId",e,t,n),S=$("index",e,t,n),[2,[n.getTensorArray(w).read(S)]];case 11:return A=$("tensorArrayId",e,t,n),_=$("indices",e,t,n),E=$("dtype",e,t,n),[2,[n.getTensorArray(A).gather(_,E)]];case 12:return C=$("tensorArrayId",e,t,n),k=$("indices",e,t,n),T=$("tensor",e,t,n),n.getTensorArray(C).scatter(k,T),[2,[Ve(1)]];case 13:return I=$("tensorArrayId",e,t,n),N=n.getTensorArray(I),O=$("dtype",e,t,n),[2,[N.concat(O)]];case 14:return D=$("tensorArrayId",e,t,n),L=$("tensor",e,t,n),W=$("lengths",e,t,n),n.getTensorArray(D).split(W,L),[2,[Ve(1)]];case 15:return G=$("tensorArrayId",e,t,n),K=n.getTensorArray(G),[2,[Ve(K.size(),"int32")]];case 16:return ee=$("tensorArrayId",e,t,n),n.getTensorArray(ee).clearAndClose(),[2,[Ve(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}})})},aje=function(e,t,n){switch(e.op){case"Conv1D":var r=$("stride",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),o=$("dilation",e,t,n);return[vE($("x",e,t,n),$("filter",e,t,n),r,i,a,o)];case"Conv2D":r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase();var s=$("dilations",e,t,n);return[Gh($("x",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=$("fusedOps",e,t,n),l=u[0],c=u[1],f=l==="biasadd",d=c==="prelu",h=l==="fusedbatchnorm",p=$("numArgs",e,t,n);if(f){if(d&&p!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&p!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n);var g=$("args",e,t,n),m=g[0],v=g[1];return[(e.op==="_FusedConv2D"?Lf.conv2d:Lf.depthwiseConv2d)({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:m,activation:c,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=$("outputShape",e,t,n);return r=$("strides",e,t,n),i=$("pad",e,t,n),[bE($("x",e,t,n),$("filter",e,t,n),y,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=$("strides",e,t,n),i=$("pad",e,t,n),s=$("dilations",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),[zm($("input",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n),[yE($("x",e,t,n),$("filter",e,t,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=$("strides",e,t,n),i=$("pad",e,t,n);var b=$("kernelSize",e,t,n);return[_E($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[wE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n);var x=$("includeBatchInIndex",e,t,n),w=UM($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i,x);return[w.result,w.indexes];case"AvgPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[EE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[SE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},oje=function(e,t,n){switch(e.op){case"Fill":var r=$("shape",e,t,n),i=$("dtype",e,t,n),a=$("value",e,t,n);return[Tm(r,a,i)];case"LinSpace":var o=$("start",e,t,n),s=$("stop",e,t,n),u=$("num",e,t,n);return[w3(o,s,u)];case"Multinomial":var l=$("logits",e,t,n),c=$("numSamples",e,t,n),f=$("seed",e,t,n);return[IM(l,c,f)];case"OneHot":var d=$("indices",e,t,n),h=$("depth",e,t,n),p=$("onValue",e,t,n),g=$("offValue",e,t,n);return[Vh(d,h,p,g)];case"Ones":return[Vu($("shape",e,t,n),$("dtype",e,t,n))];case"OnesLike":return[Ro($("x",e,t,n))];case"RandomUniform":return[qh($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("dtype",e,t,n))];case"Range":o=$("start",e,t,n);var m=$("stop",e,t,n),v=$("step",e,t,n);return[Om(o,m,v,$("dtype",e,t,n))];case"TruncatedNormal":r=$("shape",e,t,n);var y=$("mean",e,t,n),b=$("stdDev",e,t,n);return f=$("seed",e,t,n),[kb(r,y,b,$("dtype",e,t,n),f)];case"Zeros":return[Tn($("shape",e,t,n),$("dtype",e,t,n))];case"ZerosLike":return[en($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},sje=void 0,uje=function(e,t,n){return ip(sje,void 0,void 0,function(){var r,i,a,o,s,u,l,c;return ap(this,function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=$("boxes",e,t,n),i=$("scores",e,t,n),a=$("maxOutputSize",e,t,n),o=$("iouThreshold",e,t,n),s=$("scoreThreshold",e,t,n),e.op!=="NonMaxSuppressionV5"?[3,3]:(u=$("softNmsSigma",e,t,n),[4,$f.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u)]);case 2:return[2,[(c=f.sent()).selectedIndices,c.selectedScores]];case 3:return[4,$f.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[f.sent()]];case 5:return l=$("condition",e,t,n).asType("bool"),[4,dE(l)];case 6:return c=[f.sent()],l.dispose(),[2,c];case 7:return[2,k3($("x",e,t,n),$("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}})})},lje=function(e,t,n){switch(e.op){case"TopKV2":var r=$("x",e,t,n),i=$("k",e,t,n),a=$("sorted",e,t,n),o=KM(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},cje=function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=$("default",e,t,n);return[Ea(e.name,t,n)||r];case"Placeholder":return[Ea(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[$("x",e,t,n).clone()];case"IdentityN":return $("x",e,t,n).map(function(l){return l.clone()});case"Snapshot":return[$("x",e,t,n).clone()];case"Shape":return[ba($("x",e,t,n).shape,"int32")];case"ShapeN":return $("x",e,t,n).map(function(l){return ba(l.shape)});case"Size":return[Ve($("x",e,t,n).size,"int32")];case"Rank":return[Ve($("x",e,t,n).rank,"int32")];case"NoOp":return[Ve(1)];case"Print":var i=$("x",e,t,n),a=$("data",e,t,n),o=$("message",e,t,n),s=$("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+e.op+" is not implemented")}},fje=function(e,t,n){switch(e.op){case"ResizeBilinear":var r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n);return[$f.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n),[$f.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=$("image",e,t,n),s=$("boxes",e,t,n),u=$("boxInd",e,t,n),l=$("cropSize",e,t,n),c=$("method",e,t,n),f=$("extrapolationValue",e,t,n);return[$f.cropAndResize(o,s,u,l,c,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},dje=function(e,t,n){switch(e.op){case"Equal":return[Hh($("a",e,t,n),$("b",e,t,n))];case"NotEqual":return[Lm($("a",e,t,n),$("b",e,t,n))];case"Greater":return[$m($("a",e,t,n),$("b",e,t,n))];case"GreaterEqual":return[Tb($("a",e,t,n),$("b",e,t,n))];case"Less":return[PM($("a",e,t,n),$("b",e,t,n))];case"LessEqual":return[$M($("a",e,t,n),$("b",e,t,n))];case"LogicalAnd":return[Gu($("a",e,t,n),$("b",e,t,n))];case"LogicalNot":return[OM($("a",e,t,n))];case"LogicalOr":return[fE($("a",e,t,n),$("b",e,t,n))];case"Select":case"SelectV2":return[Gs($("condition",e,t,n),$("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},hje=function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[xE($("a",e,t,n),$("b",e,t,n),$("transposeA",e,t,n),$("transposeB",e,t,n))];case"Transpose":return[cn($("x",e,t,n),$("perm",e,t,n))];case"_FusedMatMul":var r=$("fusedOps",e,t,n),i=r[0],a=r[1],o=i==="biasadd",s=a==="prelu",u=$("numArgs",e,t,n);if(o){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=$("args",e,t,n),c=l[0],f=l[1];return[Lf.matMul({a:$("a",e,t,n),b:$("b",e,t,n),transposeA:$("transposeA",e,t,n),transposeB:$("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}},pje=function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Wh($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"LRN":return[qM($("x",e,t,n),$("radius",e,t,n),$("bias",e,t,n),$("alpha",e,t,n),$("beta",e,t,n))];case"Softmax":return[$h($("x",e,t,n))];case"LogSoftmax":return[eE($("x",e,t,n))];case"SparseToDense":return[DE($("sparseIndices",e,t,n),$("outputShape",e,t,n),$("sparseValues",e,t,n),$("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},gje=function(e,t,n){switch(e.op){case"Max":var r=$("axis",e,t,n),i=$("keepDims",e,t,n);return[Mf($("x",e,t,n),r,i)];case"Mean":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Pr($("x",e,t,n),r,i)];case"Min":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[kE($("x",e,t,n),r,i)];case"Sum":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Hr($("x",e,t,n),r,i)];case"All":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[CE($("x",e,t,n),r,i)];case"Any":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Nb($("x",e,t,n),r,i)];case"ArgMax":return r=$("axis",e,t,n),[Db($("x",e,t,n),r)];case"ArgMin":return r=$("axis",e,t,n),[WM($("x",e,t,n),r)];case"Prod":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[TE($("x",e,t,n),r,i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},mje=function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=$("n",e,t,n),i=$("axis",e,t,n),a=$("tensors",e,t,n);return a=a.slice(0,r),[Hi(a,i)];case"GatherV2":case"Gather":i=$("axis",e,t,n);var o=$("x",e,t,n),s=$("indices",e,t,n);return[Bm(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=$("axis",e,t,n),o=$("x",e,t,n),[Xu(o,i)];case"Slice":var u=$("begin",e,t,n),l=$("size",e,t,n);return[Mo($("x",e,t,n),u,l)];case"StridedSlice":u=$("begin",e,t,n);var c=$("end",e,t,n),f=$("strides",e,t,n),d=$("beginMask",e,t,n),h=$("endMask",e,t,n),p=$("ellipsisMask",e,t,n),g=$("newAxisMask",e,t,n),m=$("shrinkAxisMask",e,t,n),v=$("x",e,t,n);if(u.length===1&&v.shape.length>1)for(var y=1;y<v.shape.length;y++)u.push(0),c.push(v.shape[y]),f.push(f[0]);return[GM(v,u,c,f,d,h,p,g,m)];case"Pack":return le(function(){var C=$("axis",e,t,n),k=$("tensors",e,t,n),T=k[0].shape,I=k[0].squeeze().shape,N=k.map(function(O){var D=pt.arraysEqual(O.shape,T);if(!D&&!pt.arraysEqual(O.squeeze().shape,I))throw new Error("the input tensors shape does not match");return D?O:O.reshape(T)});return[ss(N,C)]});case"Unpack":return le(function(){var C=$("axis",e,t,n),k=$("tensor",e,t,n);return If(k,C)});case"Tile":var b=$("reps",e,t,n);return[cc($("x",e,t,n),b)];case"Split":case"SplitV":i=$("axis",e,t,n);var x=$("numOrSizeSplits",e,t,n);return sc($("x",e,t,n),x,i);case"ScatterNd":s=$("indices",e,t,n);var w=$("values",e,t,n),S=$("shape",e,t,n);return[XM(s,w,S)];case"GatherNd":var A=$("x",e,t,n);return s=$("indices",e,t,n),[YM(A,s)];case"SparseToDense":s=$("sparseIndices",e,t,n),S=$("outputShape",e,t,n);var _=$("sparseValues",e,t,n),E=$("defaultValue",e,t,n);return[DE(s,_,S,_.dtype===E.dtype?E:E.asType(_.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}},vje=function(e,t,n){switch(e.op){case"FFT":return[Mb($("x",e,t,n))];case"IFFT":return[Wm($("x",e,t,n))];case"RFFT":return[Pb($("x",e,t,n))];case"IRFFT":return[NE($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},yje=function(e,t,n){switch(e.op){case"Cast":return[zS($("x",e,t,n),$("dtype",e,t,n))];case"ExpandDims":var r=$("axis",e,t,n);return[Fo($("x",e,t,n),r)];case"Squeeze":return r=$("axis",e,t,n),[pb($("x",e,t,n),r)];case"Reshape":return[qs($("x",e,t,n),$("shape",e,t,n))];case"PadV2":case"Pad":return[Ku($("x",e,t,n),g$($("padding",e,t,n),2),$("constantValue",e,t,n))];case"SpaceToBatchND":var i=$("blockShape",e,t,n),a=g$($("paddings",e,t,n),2);return[jS($("x",e,t,n),i,a)];case"BatchToSpaceND":i=$("blockShape",e,t,n);var o=g$($("crops",e,t,n),2);return[BS($("x",e,t,n),i,o)];case"DepthToSpace":var s=$("blockSize",e,t,n),u=$("dataFormat",e,t,n).toUpperCase();return[C3($("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function Cte(e,t,n){var r=function(i,a,o){switch(i.category){case"arithmetic":return le(function(){return eje(i,a,o)});case"basic_math":return le(function(){return tje(i,a,o)});case"control":return ije(i,a,o);case"convolution":return le(function(){return aje(i,a,o)});case"creation":return le(function(){return oje(i,a,o)});case"dynamic":return uje(i,a,o);case"evaluation":return le(function(){return lje(i,a,o)});case"image":return le(function(){return fje(i,a,o)});case"graph":return le(function(){return cje(i,a,o)});case"logical":return le(function(){return dje(i,a,o)});case"matrices":return le(function(){return hje(i,a,o)});case"normalization":return le(function(){return pje(i,a,o)});case"reduction":return le(function(){return gje(i,a,o)});case"slice_join":return le(function(){return mje(i,a,o)});case"spectral":return le(function(){return vje(i,a,o)});case"transformation":return le(function(){return yje(i,a,o)});case"custom":var s=_te(i.op);if(s&&s.customExecutor)return s.customExecutor(new Q6e(i,a,o));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var kte=function(){function e(t,n){this.weightMap=t,this.tensorArrayMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(t,n){return{id:t,frameName:n,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var t=[],n=0;n<this.contexts.length-1;n++){var r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t},e.prototype.contextIdforContexts=function(t){return t?t.map(function(n){return n.id===0&&n.iterationId===0?"":n.frameName+"-"+n.iterationId}).join("/"):""},e.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(t){return this.weightMap[t]},e.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},e.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},e}();function Tte(e,t,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(e).map(function(f){return Bo(f)[0]}),l=t.slice();l.length>0;){var c=l.pop();(Ote(c)||_je(c))&&a==null&&(o=(a=c).children.map(function(f){return f.name}).filter(function(f){return r.has(f)})),r.add(c.name),n[c.name]==null&&u.indexOf(c.name)===-1&&(c.inputs.length!==0?c.inputs.forEach(function(f){s.has(f.name)||(s.add(f.name),l.push(f))}):i.push(c.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function bje(e,t,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map(function(l){return Bo(l)[0]}).map(function(l){return e.nodes[l]}).forEach(function(l){r.has(l.name)&&a.push(l)}),e.weights.forEach(function(l){r.has(l.name)&&a.push(l)});for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach(function(l){!o.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return o.has(c.name)})&&a.push(l)})}return s}var xje=["Switch","Merge","Enter","Exit","NextIteration"],wje=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Ote(e){return xje.indexOf(e.op)>=0}function _je(e){return wje.indexOf(e.op)>=0}var Sje=function(){function e(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var n=Object.keys(t).map(function(r){return t[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],n),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(t,n){var r=t.map(function(a){return a.name}).sort(),i=n.map(function(a){return a.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},e.prototype.compile=function(t,n){var r=Tte(t,n,this.weightMap),i=r.missingInputs,a=r.dynamicNode,o=r.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+o+"]");if(i.length>0){var s=n.map(function(l){return l.name}),u=Object.keys(t);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return bje(this.graph,this.weightMap,r)},e.prototype.execute=function(t,n){var r=this;t=this.mapInputs(t);var i=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);var a=i.map(function(c){return r.graph.nodes[Bo(c)[0]]}),o=n.map(function(c){return r.graph.nodes[Bo(c)[0]]}),s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);u==null&&(u=this.compile(t,o),this.compiledMap.set(s,u));var l={};return le(function(){var c=new kte(r._weightMap,l),f=p$({},r.weightMap);Object.keys(t).forEach(function(v){var y=Bo(v),b=y[0],x=[];x[y[1]]=t[v],f[b]=x});for(var d=r.getFrozenTensorIds(f),h={},p=0;p<u.length;p++){var g=u[p];if(!f[g.name]){var m=Cte(g,f,c);if(m instanceof Promise)throw new Error("The execution of the op '"+g.op+"' returned a promise. Please use model.executeAsync() instead.");f[g.name]=m,r.checkTensorForDisposal(g.name,g,f,c,d,n,h)}}return n.map(function(v){return Ea(v,f,c)})})},e.prototype.getFrozenTensorIds=function(t){var n=[].concat.apply([],Object.keys(t).map(function(r){return t[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(n)},e.prototype.checkTensorForDisposal=function(t,n,r,i,a,o,s){n.category!=="control"&&o.indexOf(t)===-1&&(r[t].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+n.children.length)}),n.inputs.forEach(function(u){if(u.category!=="control"){var l=y6e(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!a.has(c.id)){var f=s[c.id];f===1?(c.dispose(),delete s[c.id]):f!=null&&s[c.id]--}})}}))},e.prototype.executeAsync=function(t,n){return ip(this,void 0,void 0,function(){var r,i,a,o,s,u,l=this;return ap(this,function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),r={},i=new kte(this._weightMap,r),[4,this.executeWithControlFlow(t,i,n)];case 1:return a=c.sent(),o=n.map(function(f){return Ea(f,a,i)}),s=new Set(o.map(function(f){return f.id})),u=new Set(Object.keys(t).map(function(f){return t[f].id})),Object.keys(a).forEach(function(f){a[f].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,o]}})})},e.prototype.executeWithControlFlow=function(t,n,r){return ip(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x=this;return ap(this,function(w){switch(w.label){case 0:i=Object.keys(t),a=i.map(function(S){return x.graph.nodes[Bo(S)[0]]}),o=r.map(function(S){return x.graph.nodes[Bo(S)[0]]}),s=Tte(t,o,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,f=s.syncInputs,d=a.concat(this.graph.weights).map(function(S){return{node:S,contexts:n.currentContext}}),h=p$({},this.weightMap),Object.keys(t).forEach(function(S){var A=Bo(S),_=A[0],E=[];E[A[1]]=t[S],h[_]=E}),p={},g=this.getFrozenTensorIds(h),m={},w.label=1;case 1:return d.length>0?(v=this.processStack(a,d,n,h,m,g,r,p,u),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(S){return!Ote(S)&&!Ea(S.name,h,n)}).map(function(S){return S.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+f+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,h]}})})},e.prototype.processStack=function(t,n,r,i,a,o,s,u,l){for(var c=this,f=[],d=function(){var p=n.pop();r.currentContext=p.contexts;var g="";if(p.node.op==="Enter"&&$("isConstant",p.node,i,r)&&(g=av(p.node.name,r)[0]),t.indexOf(p.node)===-1){var m=Cte(p.node,i,r);g||(g=av(p.node.name,r)[0]);var v=r.currentContext;m instanceof Promise?f.push(m.then(function(y){return i[g]=y,r.currentContext=v,c.checkTensorForDisposal(g,p.node,i,r,o,s,u),c.processChildNodes(p.node,n,r,i,a,l),y})):(i[g]=m,h.checkTensorForDisposal(g,p.node,i,r,o,s,u),h.processChildNodes(p.node,n,r,i,a,l))}else h.processChildNodes(p.node,n,r,i,a,l)},h=this;n.length>0;)d();return f},e.prototype.processChildNodes=function(t,n,r,i,a,o){t.children.forEach(function(s){var u=av(s.name,r)[0];!a[u]&&o.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})))})},e.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(n){return t.weightMap[n].forEach(function(r){return r.dispose()})})},e.prototype.checkInputShapeAndType=function(t){var n=this;Object.keys(t).forEach(function(r){var i=t[r],a=Bo(r)[0],o=n.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===i.shape.length&&i.shape.every(function(l,c){return s[c]===-1||s[c]===l});pt.assert(u,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&pt.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},e.prototype.mapInputs=function(t){var n={};for(var r in t)this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null?n[this._signature.inputs[r].name]=t[r]:n[r]=t[r];return n},e.prototype.checkInputs=function(t){var n=this,r=Object.keys(t).filter(function(i){var a=Bo(i)[0];return n.graph.nodes[a]==null});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},e.prototype.mapOutputs=function(t){var n=this;return t.map(function(r){return n._signature!=null&&n._signature.outputs!=null&&n._signature.outputs[r]!=null?n._signature.outputs[r].name:r},{})},e.prototype.checkOutputs=function(t){var n=this;t.forEach(function(r){var i=Bo(r)[0];if(!n.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},e}();(function(){function e(t,n){n===void 0&&(n={}),this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=wa.browserHTTPRequest(t,this.loadOptions);else{var n=wa.getLoadHandlers(t,this.loadOptions.onProgress);if(n.length===0)n.push(wa.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error("Found more than one ("+n.length+") load handlers for URL '"+[t]+"'");this.handler=n[0]}},e.prototype.load=function(){return ip(this,void 0,void 0,function(){var t,n,r,i;return ap(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),n=this.artifacts.modelTopology,r={},this.artifacts.userDefinedMetadata!=null&&(r=this.artifacts.userDefinedMetadata.signature),this.version=n.versions.producer+"."+n.versions.minConsumer,i=wa.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new Sje(Z6e.Instance.transformGraph(n,r)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),[2,!0]}})})},e.prototype.save=function(t,n){return ip(this,void 0,void 0,function(){var r;return ap(this,function(i){if(typeof t=="string"){if((r=wa.getSaveHandlers(t)).length===0)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new Error("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]})})},e.prototype.predict=function(t,n){return this.execute(t,this.outputNodes)},e.prototype.normalizeInputs=function(t){if(!(t instanceof Ht||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(n,r,i){return n[r]=t[i],n},{})},e.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},e.prototype.execute=function(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);var r=this.executor.execute(t,n);return r.length>1?r:r[0]},e.prototype.executeAsync=function(t,n){return ip(this,void 0,void 0,function(){var r;return ap(this,function(i){switch(i.label){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),[4,this.executor.executeAsync(t,n)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},e.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=[t[r]],n},{})},e.prototype.dispose=function(){this.executor.dispose()},e})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ite=function(e,t){return(Ite=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function On(e,t){function n(){this.constructor=e}Ite(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function He(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Ge(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function op(e,t){return e(t={exports:{}},t.exports),t.exports}var Eje=op(function(e){(function(t,n,r){function i(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}function a(o,s){var u=new function(f){var d,h=this,p=(d=4022871197,function(g){g=g.toString();for(var m=0;m<g.length;m++){var v=.02519603282416938*(d+=g.charCodeAt(m));v-=d=v>>>0,d=(v*=d)>>>0,d+=4294967296*(v-=d)}return 23283064365386963e-26*(d>>>0)});h.next=function(){var g=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=g-(h.c=0|g)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(f),h.s0<0&&(h.s0+=1),h.s1-=p(f),h.s1<0&&(h.s1+=1),h.s2-=p(f),h.s2<0&&(h.s2+=1),p=null}(o),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),Aje=op(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s}function a(o,s){var u=new function(f){var d=this,h="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var g=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^g^g>>>8},f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),Cje=op(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s.v=o.v,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^g^g<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),p==h.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),kje=op(function(e){(function(t,n,r){function i(o,s){return s.x=o.x.slice(),s.i=o.i,s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.x,m=d.i;return h=g[m],p=(h^=h>>>7)^h<<24,p^=(h=g[m+1&7])^h>>>10,p^=(h=g[m+3&7])^h>>>3,p^=(h=g[m+4&7])^h<<7,h=g[m+7&7],p^=(h^=h<<13)^h<<9,g[m]=p,d.i=m+1&7,p},function(h,p){var g,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,g=0;g<p.length;++g)m[7&g]=m[7&g]<<15^p.charCodeAt(g)+m[g+1&7]<<13;for(;m.length<8;)m.push(0);for(g=0;g<8&&m[g]===0;++g);for(g==8?m[7]=-1:m[g],h.x=m,h.i=0,g=256;g>0;--g)h.next()}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),Tje=op(function(e){(function(t,n,r){function i(o,s){return s.i=o.i,s.w=o.w,s.X=o.X.slice(),s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.w,m=d.X,v=d.i;return d.w=g=g+1640531527|0,p=m[v+34&127],h=m[v=v+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[v]=p^h,d.i=v,p+(g^g>>>16)|0},function(h,p){var g,m,v,y,b,x=[],w=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,w=Math.max(w,p.length)),v=0,y=-32;y<w;++y)p&&(m^=p.charCodeAt((y+32)%p.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,v=(g=x[127&y]^=m+b)==0?v+1:0);for(v>=128&&(x[127&(p&&p.length||0)]=-1),v=127,y=512;y>0;--y)m=x[v+34&127],g=x[v=v+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,x[v]=m^g;h.w=b,h.X=x,h.i=v}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),Oje=op(function(e){(function(t,n,r){function i(o,s){return s.a=o.a,s.b=o.b,s.c=o.c,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.b,m=d.c,v=d.d,y=d.a;return g=g<<25^g>>>7^m,m=m-v|0,v=v<<24^v>>>8^y,y=y-g|0,d.b=g=g<<20^g>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^y,d.a=y-g|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,f===Math.floor(f)?(d.a=f/4294967296|0,d.b=0|f):h+=f;for(var p=0;p<h.length+20;p++)d.b^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),sp=op(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(m,v,y){var b=[],x=p(function A(_,E){var C,k=[],T=typeof _;if(E&&T=="object")for(C in _)try{k.push(A(_[C],E-1))}catch(I){}return k.length?k:T=="string"?_:_+"\0"}((v=v==1?{entropy:!0}:v||{}).entropy?[m,g(t)]:m??function(){try{var A;return r&&(A=r.randomBytes)?A=A(a):(A=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(A)),g(A)}catch(C){var _=i.navigator,E=_&&_.plugins;return[+new Date,i,E,i.screen,g(t)]}}(),3),b),w=new function(A){var _,E=A.length,C=this,k=0,T=C.i=C.j=0,I=C.S=[];for(E||(A=[E++]);k<a;)I[k]=k++;for(k=0;k<a;k++)I[k]=I[T=f&T+A[k%E]+(_=I[k])],I[T]=_;(C.g=function(N){for(var O,D=0,L=C.i,W=C.j,G=C.S;N--;)O=G[L=f&L+1],D=D*a+G[f&(G[L]=G[W=f&W+O])+(G[W]=O)];return C.i=L,C.j=W,D})(a)}(b),S=function(){for(var A=w.g(o),_=u,E=0;A<l;)A=(A+E)*a,_*=a,E=w.g(1);for(;A>=c;)A/=2,_/=2,E>>>=1;return(A+E)/_};return S.int32=function(){return 0|w.g(4)},S.quick=function(){return w.g(4)/4294967296},S.double=S,p(g(w.S),t),(v.pass||y||function(A,_,E,C){return C&&(C.S&&h(C,w),A.state=function(){return h(w,{})}),E?(n[s]=A,_):A})(S,x,"global"in v?v.global:this==n,v.state)}function h(m,v){return v.i=m.i,v.j=m.j,v.S=m.S.slice(),v}function p(m,v){for(var y,b=m+"",x=0;x<b.length;)v[f&x]=f&(y^=19*v[f&x])+b.charCodeAt(x++);return g(v)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,p(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(m){}}})([],Math)});sp.alea=Eje,sp.xor128=Aje,sp.xorwow=Cje,sp.xorshift7=kje,sp.xor4096=Tje,sp.tychei=Oje;var Ije=sp,Nte=Ije.alea;function Nje(e,t){return uA(e,t)}function uA(e,t,n,r){if(n===void 0&&(n=new Map),r===void 0&&(r=new Set),e==null)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(lA(e)){var a=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=uA(e[o],t,n,r);a[o]=s}return r.delete(e),a}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,i.value),i.value}function Dje(e,t){return t===void 0&&(t=Rte),Dte(e,t)}function Dte(e,t,n){n===void 0&&(n=new Set);var r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(lA(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(u){var l=Dte(e.map(function(c){return c[u]}),t,n);a[u]=l};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function Rte(e){return e===null?null:lA(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function Rje(e,t){return He(this,void 0,void 0,function(){var n,r,i,a,o,s;return Ge(this,function(u){switch(u.label){case 0:n=new Map,uA(e,t,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=i[r],(o=n.get(a))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(a,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,uA(e,t,n)]}})})}function lA(e){return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ht))}function Fje(e){return e==null||Mje(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ht||pt.isTypedArray(e)}function Mje(e){return e===null||typeof e!="object"&&typeof e!="function"}function Pje(e){return Nje(e,$je)}function $je(e){return e instanceof Ht?{value:e.clone(),recurse:!1}:lA(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Fte=function(){function e(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return e.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},e.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},e.prototype.set=function(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n},e.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return this.length()===0},e.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.push(i)}},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},e.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},e.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r},e}(),Lje=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return On(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,n)},t.prototype.unshift=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,n)},t.prototype.expand=function(){for(var n=2*this.capacity,r=new Array(n),i=this.length(),a=0;a<i;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=n,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},t.INITIAL_CAPACITY=32,t}(Fte);function Bje(e){return new Uje(e)}function zje(e){return new Wje(e)}function jje(e,t){return new Pte(e,t)}var ov,ai=function(){function e(){}return e.prototype.toArray=function(){return He(this,void 0,void 0,function(){var t,n;return Ge(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,this.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,t]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){var t,n,r;return Ge(this,function(i){switch(i.label){case 0:return t=this.prefetch(100),n=[],[4,t.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(n.push(r.value),[4,t.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,n]}})})},e.prototype.resolveFully=function(){return He(this,void 0,void 0,function(){var t;return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=n.sent(),[3,2];case 4:return[2]}})})},e.prototype.resolveWhile=function(t){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:n=i.sent(),r=t(n.value),i.label=2;case 2:return n.done||!r?[3,4]:[4,this.next()];case 3:return n=i.sent(),r=t(n.value),[3,2];case 4:return[2]}})})},e.prototype.handleErrors=function(t){return new Yje(this,t)},e.prototype.filter=function(t){return new Kje(this,t)},e.prototype.map=function(t){return new Xje(this,t)},e.prototype.mapAsync=function(t){return new Mte(this,t)},e.prototype.serialMapAsync=function(t){return new Mte(this,t).serial()},e.prototype.flatmap=function(t){return new Zje(this,t)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.map(t).resolveFully()]})})},e.prototype.serialForEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.serialMapAsync(t).resolveWhile(function(r){return r===!0})]})})},e.prototype.rowMajorBatch=function(t,n){return n===void 0&&(n=!0),new Gje(this,t,n)},e.prototype.columnMajorBatch=function(t,n,r){return n===void 0&&(n=!0),r===void 0&&(r=Rte),this.rowMajorBatch(t,n).map(function(i){return Dje(i,r)})},e.prototype.concatenate=function(t,n){return new Pte(Bje([this,t]),n)},e.prototype.take=function(t){return t<0||t==null?this:new Hje(this,t)},e.prototype.skip=function(t){return t<0||t==null?this:new qje(this,t)},e.prototype.prefetch=function(t){return new $te(this,t)},e.prototype.shuffle=function(t,n){return new Jje(this,t,n)},e.prototype.serial=function(){return new Vje(this)},e}(),Uje=function(e){function t(n){var r=e.call(this)||this;return r.items=n,r.trav=0,r}return On(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(n=this.items[this.trav],this.trav++,[2,{value:Pje(n),done:!1}])})})},t}(ai),Wje=function(e){function t(n){var r=e.call(this)||this;return r.nextFn=n,r}return On(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},t}(ai),Vje=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.upstream.next()]})})},t}(ai),qje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(n=r.sent()).done?[2,n]:(Ut(n.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(ai),Hje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(ai),Gje=function(e){function t(n,r,i){i===void 0&&(i=!0);var a=e.call(this)||this;return a.upstream=n,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:n=[],i.label=1;case 1:return n.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&n.length>0?[2,{value:n,done:!1}]:[2,{value:null,done:!0}]:(n.push(r.value),[3,1]);case 3:return[2,{value:n,done:!1}]}})})},t}(ai),Kje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(n=r.sent()).done||this.predicate(n.value)?[2,n]:(Ut(n.value),[3,0]);case 2:return[2]}})})},t}(ai),Xje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,{value:null,done:!0}];for(r=Bu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Bu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ai),Yje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handler(n)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(ai),Mte=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(n=l.sent()).done?[2,{value:null,done:!0}]:(r=Bu.getTensorsInContainer(n.value),[4,this.transform(n.value)]);case 2:for(i=l.sent(),a=Bu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ai),C$=function(e){function t(){var n=e.call(this)||this;return n.outputQueue=new Lje,n.lastRead=Promise.resolve({value:null,done:!1}),n}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return n.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(ai),Zje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,!1];for(r=Bu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Bu.getTensorsInContainer(i),this.outputQueue.pushAll(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,!0]}})})},t}(C$),Pte=function(e){function t(n,r){var i=e.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=n,i}return On(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(n){return He(this,void 0,void 0,function(){var r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,n];case 1:return a.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=a.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),a.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=a.sent()).done?(this.iterator=null,[2,this.readFromChain(n)]):[2,i]}})})},t}(ai);(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(ov||(ov={})),function(e){function t(n,r){r===void 0&&(r=ov.FAIL);var i=e.call(this)||this;return i.iterators=n,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return On(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(n){return He(this,void 0,void 0,function(){function r(s){return s instanceof ai?{value:s.next().then(function(u){return i++,u.done&&a++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,n];case 1:return s.sent(),i=0,a=0,[4,Rje(this.iterators,r)];case 2:if(o=s.sent(),i===a)return[2,{value:null,done:!0}];if(a>0)switch(this.mismatchMode){case ov.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case ov.SHORTEST:return[2,{value:null,done:!0}];case ov.LONGEST:}return this.count++,[2,{value:o,done:!1}]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(ai);var $te=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.bufferSize=r,i.buffer=new Fte(r),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var n=this.upstream.next();this.buffer.push(n)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(ai),Jje=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.upstream=n,a.windowSize=r,a.upstreamExhausted=!1,a.random=Nte(i||pt.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(n){return Math.floor(this.random()*n)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(n=this.chooseIndex(),[4,this.buffer.shuffleExcise(n)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},t}($te),k$=function(){function e(){this.size=null}return e.prototype.batch=function(t,n){var r=this;n===void 0&&(n=!0);var i=this;return pt.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),Qu(function(){return He(r,void 0,void 0,function(){return Ge(this,function(a){switch(a.label){case 0:return[4,i.iterator()];case 1:return[2,a.sent().columnMajorBatch(t,n,Qje)]}})})},this.size===1/0||this.size==null?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t))},e.prototype.concatenate=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){var i,a;return Ge(this,function(o){switch(o.label){case 0:return[4,r.iterator()];case 1:return a=(i=o.sent()).concatenate,[4,t.iterator()];case 2:return[2,a.apply(i,[o.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},e.prototype.filter=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(a){return le(function(){return t(a)})})]}})})},this.size===1/0?1/0:null)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.iterator()];case 1:return[2,n.sent().forEachAsync(t)]}})})},e.prototype.forEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return FS("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},e.prototype.map=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(a){return le(function(){return t(a)})})]}})})},this.size)},e.prototype.mapAsync=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(t)]}})})},this.size)},e.prototype.prefetch=function(t){var n=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(t)]}})})},this.size)},e.prototype.repeat=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){var i=this;return Ge(this,function(a){return[2,jje(zje(function(){return He(i,void 0,void 0,function(){var o;return Ge(this,function(s){switch(s.label){case 0:return o={},[4,r.iterator()];case 1:return[2,(o.value=s.sent(),o.done=!1,o)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},e.prototype.skip=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},e.prototype.shuffle=function(t,n,r){var i=this;if(r===void 0&&(r=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,o=Nte(n||pt.now().toString());return Qu(function(){return He(i,void 0,void 0,function(){var s;return Ge(this,function(u){switch(u.label){case 0:return s=o.int32(),r&&(s+=o.int32()),[4,a.iterator()];case 1:return[2,u.sent().shuffle(t,s.toString())]}})})},this.size)},e.prototype.take=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},e.prototype.toArray=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},e.MAX_BUFFER_SIZE=1e4,e}();function Qu(e,t){return t===void 0&&(t=null),new(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.size=t,i}return On(r,n),r.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(i){return[2,e()]})})},r}(k$))}function Qje(e){return e===null?null:Fje(e[0])?{value:e8e(e),recurse:!1}:{value:null,recurse:!0}}function e8e(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ht?ss(e):Mr(e)}var t8e=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return n=i.sent(),r=n.decodeUTF8(),[2,r.split(`
`).map(function(a){return a.endsWith("\r")&&(a=a.slice(0,-1)),a})]}})})},t}(k$),cA='"',e1=Symbol("out"),Lte=Symbol("field"),fA=Symbol("quote"),T$=Symbol("quoteafterquote"),Bte=Symbol("quoteinquote");(function(e){function t(n,r){var i=e.call(this)||this;return i.input=n,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new t8e(n),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(pt.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return On(t,e),t.prototype.columnNames=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u=this;return Ge(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(n=l.sent(),!this.fullColumnNames&&!n)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&n&&pt.assert(n.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+n.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=n),r=this.fullColumnNames.reduce(function(c,f){return c[f]=c[f]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),pt.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(a=0,o=Object.keys(this.columnConfigs);a<o.length;a++)if(s=o[a],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((n=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=n.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r=this;return Ge(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return n=i.sent(),this.hasHeader&&(n=n.skip(1)),[2,n.map(function(a){return r.makeDataElement(a)})]}})})},t.prototype.makeDataElement=function(n){for(var r=this.parseRow(n),i={},a={},o=0;o<this.fullColumnNames.length;o++){var s=this.fullColumnNames[o],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[o],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+n);c=void 0}else{var f=Number(l);if(isNaN(f))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}else c=f}u&&u.isLabel?a[s]=c:i[s]=c}}return Object.keys(a).length===0?i:{xs:i,ys:a}},t.prototype.getBoolean=function(n){return n==="1"||n.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(n,r){r===void 0&&(r=!0);for(var i=[],a=0,o=n.length,s=e1,u=0;u<o;u++)switch(s){case e1:switch(n.charAt(u)){case cA:a=u+1,s=fA;break;case this.delimiter:if(a=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=e1;break;default:s=Lte,a=u}break;case Lte:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u)),s=e1,a=u+1}break;case fA:switch(n.charAt(u)){case cA:s=T$}break;case T$:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u-1)),s=e1,a=u+1;break;case cA:s=fA;break;default:s=Bte}break;case Bte:switch(n.charAt(u)){case cA:s=fA}}if(s===T$?i.push(n.substring(a,o-1)):i.push(n.substring(a)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},t})(k$),function(e){function t(n){var r=e.call(this)||this;r.microphoneConfig=n,r.isClosed=!1,r.fftSize=n.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=n.numFramesPerSpectrogram||43,r.sampleRateHz=n.sampleRateHz,r.columnTruncateLength=n.columnTruncateLength||r.fftSize,r.audioTrackConstraints=n.audioTrackConstraints,r.smoothingTimeConstant=n.smoothingTimeConstant||0,r.includeSpectrogram=n.includeSpectrogram!==!1,r.includeWaveform=n.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return On(t,e),t.prototype.summary=function(){return"microphone"},t.create=function(n){return n===void 0&&(n={}),He(this,void 0,void 0,function(){var r;return Ge(this,function(i){switch(i.label){case 0:if(pe().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new t(n)).start()];case 1:return i.sent(),[2,r]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i,a;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return n.stream=o.sent(),[3,3];case 2:throw r=o.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return a=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,a.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(a=this.flattenQueue(i.freqDataQueue),n=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(o=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:n,waveform:r},done:!1}]}})})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.getAudioData=function(){return He(this,void 0,void 0,function(){var n,r,i,a=this;return Ge(this,function(o){return n=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){a.includeSpectrogram&&(a.analyser.getFloatFrequencyData(a.freqData),a.freqData[0]===-1/0&&s({freqDataQueue:n,timeDataQueue:r}),n.push(a.freqData.slice(0,a.columnTruncateLength))),a.includeWaveform&&(a.analyser.getFloatTimeDomainData(a.timeData),r.push(a.timeData.slice())),++i===a.numFrames&&(clearInterval(u),s({freqDataQueue:n,timeDataQueue:r}))},a.fftSize/a.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(n){var r=n[0].length,i=new Float32Array(n.length*r);return n.forEach(function(a,o){return i.set(a,o*r)}),i},t.prototype.getTensorFromAudioDataArray=function(n,r){var i=new Float32Array(pt.sizeFromShape(r));return i.set(n,i.length-n.length),Mr(i,r)},t}(ai),function(e){function t(n,r){var i=e.call(this)||this;if(i.webcamVideoElement=n,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=ba([0],"int32"),i.webcamConfig.centerCrop){var a=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,o=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,l=s+a,c=o+u;i.cropBox=Wu([u,s,c,l],[1,4])}else i.cropBox=Wu([0,0,1,1],[1,4]);return i}return On(t,e),t.prototype.summary=function(){return"webcam"},t.create=function(n,r){return r===void 0&&(r={}),He(this,void 0,void 0,function(){var i;return Ge(this,function(a){switch(a.label){case 0:if(pe().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!n){if(n=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");n.width=r.resizeWidth,n.height=r.resizeHeight}return[4,(i=new t(n,r)).start()];case 1:return a.sent(),[2,i]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:this.webcamConfig.facingMode&&pt.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),a.label=1;case 1:return a.trys.push([1,3,,4]),n=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return n.stream=a.sent(),[3,4];case 3:throw(r=a.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(o){console.log(o),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(o){i.webcamVideoElement.onloadedmetadata=function(){o()}})]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{n=ZJ.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:n,done:!1}];try{return[2,{value:this.cropAndResizeFrame(n),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{n.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(n){var r=this;return le(function(){var i,a=n.toFloat().expandDims(0),o=(i=$f.cropAndResize(a,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(o.slice(1))})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(n){return n.stop()});try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(ai);var zte=function(){return function(){}}(),jte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.split=function(n){return new n8e(this,n)},t}(ai),n8e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.impl=new r8e(n,r),i}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(jte),r8e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.separator=r,i.carryover="",i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((n=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=n.value.split(this.separator))[0]=this.carryover+r[0],i=0,a=r.slice(0,-1);i<a.length;i++)o=a[i],this.outputQueue.push(o);return this.carryover=r[r.length-1],[2,!0]}})})},t}(C$),i8e=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.decodeUTF8=function(){return new a8e(this)},t}(ai),a8e=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.impl=new o8e(n),r}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(jte),o8e=function(e){function t(n){var r=e.call(this)||this;if(r.upstream=n,pe().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(n=a.sent()).done?[2,!1]:(r=n.value,i=pe().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},t}(C$),Ute=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.file=n,i.options=r,pt.assert(n instanceof Uint8Array||!!pe().get("IS_BROWSER")&&(n instanceof File||n instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return On(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(n=new Promise(function(o,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)o(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(f){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));o(d)},l.onabort=function(f){return s(new Error("Aborted"))},l.onerror=function(f){return s(new Error(f.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,n]);case 1:return[2,(r.value=a.sent(),r.done=!1,r)]}})})},t}(i8e);function s8e(e,t){return t===void 0&&(t={}),He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return typeof e=="string"?n=e:(n=e.url,r=u8e(e)),[4,pt.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new Ute(a,t)];case 3:throw new Error(i.statusText)}})})}var u8e=function(e){return{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity}};function Wte(e){return typeof e=="string"&&e.substr(0,7)==="file://"}var l8e=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.input=n,i.options=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return Wte(this.input)&&pe().get("IS_NODE")&&(n=require("fs"),this.input=n.readFileSync(this.input.substr(7))),[2,new Ute(this.input,this.options)]})})},t}(zte);(function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.url=n,i.fileOptions=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return Wte(this.url)?[2,new l8e(this.url,this.fileOptions).iterator()]:[2,s8e(this.url,this.fileOptions)]})})},t})(zte);function c8e(e){let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(f!==t){const d=t;t=c?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a=(l,c=i,f=Object.is)=>{let d=c(t);function h(){const p=c(t);if(!f(d,p)){const g=d;l(d=p,g)}}return n.add(h),()=>n.delete(h)},u={setState:r,getState:i,subscribe:(l,c,f)=>c||f?a(l,c,f):(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,i,u),u}const f8e=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Vte=f8e?qt:lf;function d8e(e){const t=typeof e=="function"?c8e(e):e,n=(r=t.getState,i=Object.is)=>{const[,a]=zN(g=>g+1,0),o=t.getState(),s=Jt(o),u=Jt(r),l=Jt(i),c=Jt(!1),f=Jt();f.current===void 0&&(f.current=r(o));let d,h=!1;(s.current!==o||u.current!==r||l.current!==i||c.current)&&(d=r(o),h=!i(f.current,d)),Vte(()=>{h&&(f.current=d),s.current=o,u.current=r,l.current=i,c.current=!1});const p=Jt(o);return Vte(()=>{const g=()=>{try{const v=t.getState(),y=u.current(v);l.current(f.current,y)||(s.current=v,f.current=y,a())}catch(v){c.current=!0,a()}},m=t.subscribe(g);return t.getState()!==p.current&&g(),m},[]),h?d:f.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var qte={},Hte=vh(w4e),h8e={},p8e={},dA={},Yr={},sv={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t="tfjsflags",n=function(){function u(l){this.global=l,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return u.prototype.setPlatform=function(l,c){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+c+".")),this.platformName=l,this.platform=c},u.prototype.registerFlag=function(l,c,f){if(this.flagRegistry[l]={evaluationFn:c,setHook:f},this.urlFlags[l]!=null){var d=this.urlFlags[l];console.warn("Setting feature override from URL "+l+": "+d+"."),this.set(l,d)}},u.prototype.get=function(l){return l in this.flags?this.flags[l]:(this.flags[l]=this.evaluateFlag(l),this.flags[l])},u.prototype.getNumber=function(l){return this.get(l)},u.prototype.getBool=function(l){return this.get(l)},u.prototype.getFlags=function(){return this.flags},Object.defineProperty(u.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),u.prototype.set=function(l,c){if(this.flagRegistry[l]==null)throw new Error("Cannot set flag "+l+" as it has not been registered.");this.flags[l]=c,this.flagRegistry[l].setHook!=null&&this.flagRegistry[l].setHook(c)},u.prototype.evaluateFlag=function(l){if(this.flagRegistry[l]==null)throw new Error("Cannot evaluate flag '"+l+"': no evaluation function found.");return this.flagRegistry[l].evaluationFn()},u.prototype.setFlags=function(l){this.flags=Object.assign({},l)},u.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},u.prototype.populateURLFlags=function(){var l=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var c=r(this.global.location.search);if(t in c){var f=c[t].split(",");f.forEach(function(d){var h=d.split(":"),p=h[0],g=h[1];l.urlFlags[p]=a(p,g)})}}},u}();e.Environment=n;function r(u){var l={};return u.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(c){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];return i(l,f[0],f[1]),f.join("=")}),l}e.getQueryParams=r;function i(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}function a(u,l){if(l=l.toLowerCase(),l==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+u+".")}function o(){return e.ENV}e.env=o,e.ENV=null;function s(u){e.ENV=u}e.setEnvironmentGlobal=s})(sv);var yc={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(yc,"__esModule",{value:!0});var uv=new Map,t1=new Map;function g8e(e,t){var n=O$(e,t);return uv.get(n)}yc.getKernel=g8e;function m8e(e){return t1.get(e)}yc.getGradient=m8e;function v8e(e){for(var t=uv.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1],u=o.split("_")[0];u===e&&n.push(s)}return n}yc.getKernelsForBackend=v8e;function y8e(e){var t=e.kernelName,n=e.backendName,r=O$(t,n);if(uv.has(r))throw new Error("The kernel '"+t+"' for backend "+("'"+n+"' is already registered"));uv.set(r,e)}yc.registerKernel=y8e;function b8e(e){var t=e.kernelName;t1.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),t1.set(t,e)}yc.registerGradient=b8e;function x8e(e,t){var n=O$(e,t);if(!uv.has(n))throw new Error("The kernel '"+e+"' for backend "+("'"+t+"' is not registered"));uv.delete(n)}yc.unregisterKernel=x8e;function w8e(e){if(!t1.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");t1.delete(e)}yc.unregisterGradient=w8e;function O$(e,t){return t+"_"+e}var n1={},qe={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(qe,"__esModule",{value:!0});var hA=sv;function Gte(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,t--,n=e[t],e[t]=e[r],e[r]=n}qe.shuffle=Gte;function _8e(e,t,n){return Math.max(e,Math.min(t,n))}qe.clamp=_8e;function S8e(e){return e%2==0?e:e+1}qe.nearestLargerEven=S8e;function E8e(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}qe.sum=E8e;function A8e(e,t){var n=Math.random();return t*n+(1-n)*e}qe.randUniform=A8e;function C8e(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n}qe.distSquared=C8e;function lv(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}qe.assert=lv;function k8e(e,t,n){n===void 0&&(n=""),lv(Kte(e,t),function(){return n+(" Shapes "+e+" and "+t+" must match")})}qe.assertShapesMatch=k8e;function T8e(e){lv(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}qe.assertNonNull=T8e;function I$(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Jte(e)&&!n)for(var r=0;r<e.length;++r)I$(e[r],t,n);else t.push(e);return t}qe.flatten=I$;function O8e(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}qe.sizeFromShape=O8e;function I8e(e){return e.length===0}qe.isScalarShape=I8e;function Kte(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}qe.arraysEqual=Kte;function Xte(e){return e%1==0}qe.isInt=Xte;function N8e(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}qe.tanh=N8e;function D8e(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}qe.sizeToSquarishShape=D8e;function R8e(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return Gte(t),t}qe.createShuffledIndices=R8e;function F8e(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}qe.rightPad=F8e;function M8e(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e()){r();return}a++;var s=t(a);if(n!=null&&a>=n){i();return}setTimeout(o,s)};o()})}qe.repeatedTry=M8e;function P8e(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+r+" and dim "+i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+t+" / "+n));var a=e.slice();return a[r]=t/n,a}qe.inferFromImplicitShape=P8e;function Yte(e,t){var n=t.length;return e=e==null?t.map(function(r,i){return i}):[].concat(e),lv(e.every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but "+("got axis "+e)}),lv(e.every(function(r){return Xte(r)}),function(){return"All values in axis param must be integers but "+("got axis "+e)}),e.map(function(r){return r<0?n+r:r})}qe.parseAxisParam=Yte;function $8e(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Yte(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}qe.squeezeShape=$8e;function L8e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else throw new Error("Unknown data type "+e);return n}qe.getTypedArrayFromDType=L8e;function B8e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type "+e);return n}qe.getArrayFromDType=B8e;function Zte(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}qe.checkConversionForErrors=Zte;function z8e(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}qe.isValidDtype=z8e;function j8e(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}qe.hasEncodingLoss=j8e;function Jte(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}qe.isTypedArray=Jte;function U8e(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}qe.bytesPerElement=U8e;function W8e(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}qe.bytesFromStringArray=W8e;function Qte(e){return typeof e=="string"||e instanceof String}qe.isString=Qte;function ene(e){return typeof e=="boolean"}qe.isBoolean=ene;function tne(e){return typeof e=="number"}qe.isNumber=tne;function nne(e){return Array.isArray(e)?nne(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":tne(e)?"float32":Qte(e)?"string":ene(e)?"bool":"float32"}qe.inferDtype=nne;function V8e(e){return!!(e&&e.constructor&&e.call&&e.apply)}qe.isFunction=V8e;function q8e(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}qe.nearestDivisor=q8e;function H8e(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}qe.computeStrides=H8e;function G8e(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=I$(e)),n&&Zte(e,t),X8e(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}else throw new Error("Unknown data type "+t)}qe.toTypedArray=G8e;function rne(e,t,n){var r=new Array;if(t.length===1)for(var i=t[0],a=0;a<i;a++)r[a]=n[e+a];else for(var i=t[0],o=t.slice(1),s=o.reduce(function(l,c){return l*c}),a=0;a<i;a++)r[a]=rne(e+a*s,o,n);return r}function K8e(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return rne(0,e,t)}qe.toNestedArray=K8e;function X8e(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Y8e(e,t){for(var n=ine(e,t),r=0;r<n.length;r++)n[r]=1;return n}qe.makeOnesTypedArray=Y8e;function ine(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}qe.makeZerosTypedArray=ine;function Z8e(){return hA.env().platform.now()}qe.now=Z8e;function J8e(e){e.forEach(function(t){lv(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+e+"].")})})}qe.assertNonNegativeIntegerDimensions=J8e;function Q8e(e,t){return hA.env().platform.fetch(e,t)}qe.fetch=Q8e;function e9e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",hA.env().platform.encode(e,t)}qe.encodeString=e9e;function t9e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",hA.env().platform.decode(e,t)}qe.decodeString=t9e;function n9e(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}qe.locToIndex=n9e;function r9e(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}qe.indexToLoc=r9e;/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(n1,"__esModule",{value:!0});var N$=qe,i9e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new one)}return e.prototype.profileKernel=function(t,n,r){var i=this,a,o=function(){a=r()},s=this.backendTimer.time(o);return a.forEach(function(u){u.data().then(function(l){ane(l,u.dtype,t),s.then(function(c){var f="";c.getExtraProfileInfo!=null&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,u,l,c.kernelMs,n,f)})})}),a},e}();n1.Profiler=i9e;function ane(e,t,n){if(t!=="float32")return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}return!1}n1.checkComputationForErrors=ane;var one=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?N$.rightPad(i+"ms",9):i.error,u=N$.rightPad(t,25),l=n.rank,c=n.size,f=N$.rightPad(n.shape.toString(),14),d="";for(var h in a){var p=a[h],g=p.shape||n.shape,m=g.length;d+=h+": "+m+"D "+(m>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();n1.Logger=one;var pA={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(pA,"__esModule",{value:!0});var a9e=qe;function o9e(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(var a=0;a<e.length;a++){var o=e[a],s=o.inputs;for(var u in s){for(var l=s[u],c=!1,f=0;f<t.length;f++)if(r[l.id]){o.outputs.forEach(function(b){return r[b.id]=!0}),c=!0,i[o.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;for(var h={},a=e.length-1;a>=0;a--)for(var o=e[a],s=o.inputs,f=0;f<o.outputs.length;f++)if(d[o.outputs[f].id]){for(var u in s)d[s[u].id]=!0,h[o.id]=!0;break}for(var p=[],a=0;a<e.length;a++){var o=e[a];if(i[o.id]&&h[o.id]){var g={};for(var u in o.inputs){var m=o.inputs[u];r[m.id]&&(g[u]=m)}var v=Object.assign({},o);v.inputs=g,v.outputs=o.outputs,p.push(v)}}return p}pA.getFilteredNodesXToY=o9e;function s9e(e,t,n){for(var r=function(a){var o=t[a],s=[];if(o.outputs.forEach(function(f){var d=e[f.id];d!=null?s.push(d):s.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+o.kernelName+"."));var u=o.gradient(s),l=function(f){if(!(f in u))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(u)+"."));var d=n(function(){return u[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var h=o.inputs[f];if(!a9e.arraysEqual(d.shape,h.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+h.shape+"'"));if(e[h.id]==null)e[h.id]=d;else{var p=e[h.id];e[h.id]=p.add(d),p.dispose()}};for(var c in o.inputs)l(c)},i=t.length-1;i>=0;i--)r(i)}pA.backpropagateGradients=s9e;var Or={},D$={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(D$,"__esModule",{value:!0});var gA=qe,sne=20,r1=3,R$=7;function u9e(e,t,n,r){var i=gA.computeStrides(t),a=l9e(e,t,n,i),o=t.length,s=mA(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}D$.tensorToString=u9e;function l9e(e,t,n,r){var i=gA.sizeFromShape(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u=n==="complex64"?a1(e):e;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,f=0;f<a;f++)o[f]=Math.max(o[f],i1(u[c+f],0,n).length);return o}function i1(e,t,n){var r;return Array.isArray(e)?r=parseFloat(e[0].toFixed(R$))+" + "+(parseFloat(e[1].toFixed(R$))+"j"):gA.isString(e)?r="'"+e+"'":n==="bool"?r=une(e):r=parseFloat(e.toFixed(R$)).toString(),gA.rightPad(r,t)}function une(e){return e===0?"false":"true"}function mA(e,t,n,r,i,a){a===void 0&&(a=!0);var o=n==="complex64"?2:1,s=t[0],u=t.length;if(u===0){if(n==="complex64"){var l=a1(e);return[i1(l[0],0,n)]}return n==="bool"?[une(e[0])]:[e[0].toString()]}if(u===1){if(s>sne){var c=r1*o,f=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-r1)*o,s*o));return n==="complex64"&&(f=a1(f),d=a1(d)),["["+f.map(function(A,_){return i1(A,i[_],n)}).join(", ")+", ..., "+d.map(function(A,_){return i1(A,i[s-r1+_],n)}).join(", ")+"]"]}var h=n==="complex64"?a1(e):Array.from(e);return["["+h.map(function(A,_){return i1(A,i[_],n)}).join(", ")+"]"]}var p=t.slice(1),g=r.slice(1),m=r[0]*o,v=[];if(s>sne){for(var y=0;y<r1;y++){var b=y*m,x=b+m;v.push.apply(v,mA(e.slice(b,x),p,n,g,i,!1))}v.push("...");for(var y=s-r1;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,mA(e.slice(b,x),p,n,g,i,y===s-1))}}else for(var y=0;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,mA(e.slice(b,x),p,n,g,i,y===s-1))}var w=u===2?",":"";v[0]="["+v[0]+w;for(var y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;for(var S=`,
`,y=2;y<u;y++)S+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":S),v}function a1(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var c9e=Ye&&Ye.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vA=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},yA=Ye&&Ye.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Or,"__esModule",{value:!0});var f9e=D$,bc=qe,bA=qe,d9e=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=bc.sizeFromShape(t),r!=null){var a=r.length;bc.assert(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+i.size+"'.")})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||bc.getArrayFromDType(n,this.size),this.strides=bA.computeStrides(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),bc.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must "+("match the rank ("+n.rank+")")});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+". "+("  Buffer shape="+this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return el().makeTensor(this.values,this.shape,this.dtype)},e}();Or.TensorBuffer=d9e;var el=null,be=null,lne=null;function h9e(e){el=e}Or.setTensorTracker=h9e;function p9e(e){be=e}Or.setOpHandler=p9e;function g9e(e){lne=e}Or.setDeprecationWarningFn=g9e;var xA=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=bc.sizeFromShape(t),this.strides=bA.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),bc.assert(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),be.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return vA(this,void 0,void 0,function(){var t;return yA(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,be.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return be.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return vA(this,void 0,void 0,function(){var t;return yA(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,bA.toNestedArray(this.shape,t)]}})})},e.prototype.arraySync=function(){return bA.toNestedArray(this.shape,this.dataSync())},e.prototype.data=function(){return vA(this,void 0,void 0,function(){var t,n;return yA(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=el().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return bc.decodeString(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=el().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return bc.decodeString(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return vA(this,void 0,void 0,function(){var t;return yA(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,el().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(el().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),be.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),be.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),be.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),be.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),be.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),be.clone(this)},e.prototype.toString=function(t){t===void 0&&(t=!1);var n=this.dataSync();return f9e.tensorToString(n,this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),be.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),be.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),be.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),be.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),be.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),be.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),be.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),be.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),lne("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),be.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),be.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),be.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),be.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),be.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),be.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),be.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),be.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),be.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),be.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),be.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),be.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),be.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),be.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),be.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),be.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),be.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),be.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),be.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),be.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),be.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),be.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),be.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),be.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),be.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),be.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),be.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),be.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),be.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),be.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),be.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),be.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),be.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),be.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),be.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),be.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),be.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),be.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),be.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),be.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),be.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),be.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),be.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),be.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),be.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),be.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),be.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),be.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),be.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),be.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),be.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),be.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),be.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),be.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),be.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),be.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),be.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),be.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),be.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),be.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),be.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),be.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),be.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),be.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),be.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),be.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),be.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),be.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),be.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),be.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),be.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),be.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),be.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),be.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),be.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),be.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),be.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),be.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),be.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),be.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),be.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),be.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),be.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),be.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),be.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),el().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),be.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),be.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),be.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),be.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),be.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),be.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),be.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),be.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),be.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),be.spectral.irfft(this)},e}();Or.Tensor=xA,Object.defineProperty(xA,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var cne=function(e){c9e(t,e);function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!bc.arraysEqual(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and "+("previous value ("+this.shape+") must match"));el().disposeTensor(this),this.dataId=n.dataId,el().incRef(this,null)},t.prototype.dispose=function(){el().disposeVariable(this),this.isDisposedInternal=!0},t}(xA);Or.Variable=cne,Object.defineProperty(cne,Symbol.hasInstance,{value:function(e){return e instanceof xA&&e.assign!=null&&e.assign instanceof Function}});var cs={},fne={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),function(u){u.R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6"}(e.Rank||(e.Rank={}));var t;(function(u){u.float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64"})(t||(t={}));var n;(function(u){u.float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64"})(n||(n={}));var r;(function(u){u.float32="float32",u.int32="float32",u.bool="float32",u.complex64="complex64"})(r||(r={}));var i;(function(u){u.float32="complex64",u.int32="complex64",u.bool="complex64",u.complex64="complex64"})(i||(i={}));var a={float32:r,int32:t,bool:n,complex64:i};function o(u,l){if(u==="string"||l==="string"){if(u==="string"&&l==="string")return"string";throw new Error("Can not upcast "+u+" with "+l)}return a[u][l]}e.upcastType=o;function s(u){return o(u,"int32")}e.sumOutType=s})(fne);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(cs,"__esModule",{value:!0});var m9e=Or,v9e=fne,y9e=qe;function b9e(e,t){if(e.dtype===t.dtype)return[e,t];var n=v9e.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}cs.makeTypesMatch=b9e;function x9e(e,t){y9e.assert(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and"+(" second("+t.dtype+") input must match")})}cs.assertTypesMatch=x9e;function w9e(e,t){return t.some(function(n){return n.id===e.id})}cs.isTensorInList=w9e;function _9e(e){var t=[],n=new Set;return dne(e,t,n),t}cs.getTensorsInContainer=_9e;function dne(e,t,n){if(e!=null){if(e instanceof m9e.Tensor){t.push(e);return}if(!!S9e(e)){var r=e;for(var i in r){var a=r[i];n.has(a)||(n.add(a),dne(a,t,n))}}}}function S9e(e){return Array.isArray(e)||typeof e=="object"}(function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(v,y,b,x){return new(b||(b=Promise))(function(w,S){function A(C){try{E(x.next(C))}catch(k){S(k)}}function _(C){try{E(x.throw(C))}catch(k){S(k)}}function E(C){C.done?w(C.value):new b(function(k){k(C.value)}).then(A,_)}E((x=x.apply(v,y||[])).next())})},n=Ye&&Ye.__generator||function(v,y){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},x,w,S,A;return A={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function _(C){return function(k){return E([C,k])}}function E(C){if(x)throw new TypeError("Generator is already executing.");for(;b;)try{if(x=1,w&&(S=C[0]&2?w.return:C[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,C[1])).done)return S;switch(w=0,S&&(C=[C[0]&2,S.value]),C[0]){case 0:case 1:S=C;break;case 4:return b.label++,{value:C[1],done:!1};case 5:b.label++,w=C[1],C=[0];continue;case 7:C=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(C[0]===6||C[0]===2)){b=0;continue}if(C[0]===3&&(!S||C[1]>S[0]&&C[1]<S[3])){b.label=C[1];break}if(C[0]===6&&b.label<S[1]){b.label=S[1],S=C;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(C);break}S[2]&&b.ops.pop(),b.trys.pop();continue}C=y.call(v,b)}catch(k){C=[6,k],w=0}finally{x=S=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=sv,i=yc,a=n1,o=pA,s=Or,u=cs,l=qe,c=qe,f=function(){function v(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return v.prototype.dispose=function(){for(var y in this.registeredVariables)this.registeredVariables[y].dispose()},v}(),d=function(){function v(y){this.ENV=y,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new f}return v.prototype.ready=function(){return t(this,void 0,void 0,function(){var y,b,x,w;return n(this,function(S){switch(S.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];y=this.getSortedBackends(),b=0,S.label=1;case 1:return b<y.length?(x=y[b],[4,this.initializeBackend(x).success]):[3,5];case 2:return w=S.sent(),w?[4,this.setBackend(x)]:[3,4];case 3:return S.sent(),[2];case 4:return b++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(v.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var y=this.initializeBackendsAndReturnBest(),b=y.name,x=y.asyncInit;if(x)throw new Error("The highest priority backend '"+b+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(b)}return this.backendInstance},enumerable:!0,configurable:!0}),v.prototype.backendNames=function(){return Object.keys(this.registryFactory)},v.prototype.findBackend=function(y){if(!(y in this.registry))if(y in this.registryFactory){var b=this.initializeBackend(y).asyncInit;if(b)return null}else return null;return this.registry[y]},v.prototype.findBackendFactory=function(y){return y in this.registryFactory?this.registryFactory[y].factory:null},v.prototype.registerBackend=function(y,b,x){return x===void 0&&(x=1),y in this.registryFactory?(console.warn(y+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[y]={factory:b,priority:x},!0)},v.prototype.setBackend=function(y){return t(this,void 0,void 0,function(){var b,x,w,S,A;return n(this,function(_){switch(_.label){case 0:if(this.registryFactory[y]==null)throw new Error("Backend name '"+y+"' not found in registry");return this.backendName=y,this.registry[y]!=null?[3,4]:(this.backendInstance=null,b=this.initializeBackend(y),x=b.success,w=b.asyncInit,w?[4,x]:[3,2]);case 1:return A=_.sent(),[3,3];case 2:A=x,_.label=3;case 3:if(S=A,!S)return[2,!1];_.label=4;case 4:return this.backendInstance=this.registry[y],this.setupRegisteredKernels(),this.profiler=new a.Profiler(this.backendInstance),[2,!0]}})})},v.prototype.setupRegisteredKernels=function(){var y=this,b=i.getKernelsForBackend(this.backendName);b.forEach(function(x){x.setupFunc!=null&&x.setupFunc(y.backendInstance)})},v.prototype.disposeRegisteredKernels=function(y){var b=this,x=i.getKernelsForBackend(y);x.forEach(function(w){w.disposeFunc!=null&&w.disposeFunc(b.registry[y])})},v.prototype.initializeBackend=function(y){var b=this,x=this.registryFactory[y];if(x==null)throw new Error("Cannot initialize backend "+y+", no registration found.");try{var w=x.factory();if(Promise.resolve(w)===w){var S=++this.pendingBackendInitId,A=w.then(function(_){return S<b.pendingBackendInitId?!1:(b.registry[y]=_,b.pendingBackendInit=null,!0)}).catch(function(_){return S<b.pendingBackendInitId||(b.pendingBackendInit=null,console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message)),!1});return this.pendingBackendInit=A,{success:A,asyncInit:!0}}else return this.registry[y]=w,{success:!0,asyncInit:!1}}catch(_){return console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message),{success:!1,asyncInit:!1}}},v.prototype.removeBackend=function(y){if(!(y in this.registryFactory))throw new Error(y+" backend not found in registry");this.backendName===y&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,y in this.registry&&(this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y]),delete this.registryFactory[y],this.backendName===y&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},v.prototype.getSortedBackends=function(){var y=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(b,x){return y.registryFactory[x].priority-y.registryFactory[b].priority})},v.prototype.initializeBackendsAndReturnBest=function(){for(var y=this.getSortedBackends(),b=0;b<y.length;b++){var x=y[b],w=this.initializeBackend(x),S=w.success,A=w.asyncInit;if(A||S)return{name:x,asyncInit:A}}throw new Error("Could not initialize any backends, all backend initializations failed.")},v.prototype.moveData=function(y,b){var x=this.state.tensorInfo.get(b),w=x.backend,S=this.readSync(b);w.disposeData(b),x.backend=y,y.move(b,S,x.shape,x.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},v.prototype.tidy=function(y,b){var x=this,w=null;if(b==null){if(typeof y!="function")throw new Error("Please provide a function to tidy()");b=y}else{if(typeof y!="string"&&!(y instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");w=y}var S;return this.scopedRun(function(){return x.startScope(w)},function(){return x.endScope(S)},function(){return S=b(),S instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),S})},v.prototype.scopedRun=function(y,b,x){y();try{var w=x();return b(),w}catch(S){throw b(),S}},v.prototype.nextTensorId=function(){return v.nextTensorId++},v.prototype.nextVariableId=function(){return v.nextVariableId++},v.prototype.clone=function(y){var b=this.makeTensorFromDataId(y.dataId,y.shape,y.dtype),x={x:y},w=function(A){return{x:function(){return A.toFloat()}}},S=[];return this.addTapeNode(this.state.activeScope.name,x,[b],w,S,{}),b},v.prototype.runKernel=function(y,b,x,w,S){var A=null,_=null;return this.runKernelFunc(A,b,_,y,x,w,S)},v.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},v.prototype.checkKernelForMemLeak=function(y,b,x){var w=this.backend.numDataIds(),S=0;x.forEach(function(E){S+=E.dtype==="complex64"?3:1});var A=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],_=w-b-S-A;if(_>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+_+" data ids) after running '"+y+"'"))},v.prototype.runKernelFunc=function(y,b,x,w,S,A,_){var E=this,C,k=[],T=this.isTapeOn();w==null&&(w=this.state.activeScope!=null?this.state.activeScope.name:"");var I=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var O,D=i.getKernel(w,this.backendName),L;if(D!=null)O=function(){var G=E.backend.numDataIds();L=D.kernelFunc({inputs:b,attrs:S,backend:E.backend});var K=Array.isArray(L)?L:[L];E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K);var ee=K.map(function(Oe){var Te=Oe.dataId,Re=Oe.shape,me=Oe.dtype;return E.makeTensorFromDataId(Te,Re,me)});if(T){var ce=E.getTensorsForGradient(w,b,ee);if(ce==null){_==null&&(_=[]);var he=ee.filter(function(Oe,Te){return _[Te]});ce=(A||[]).slice().concat(he)}k=E.saveTensorsForBackwardMode(ce)}return ee};else{var W=function(G){!T||(k=G.map(function(K){return E.keep(E.clone(K))}))};O=function(){var G=E.backend.numDataIds();L=E.tidy(function(){return y(E.backend,W)});var K=Array.isArray(L)?L:[L];return E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K),K}}return this.scopedRun(function(){return E.state.kernelDepth++},function(){return E.state.kernelDepth--},function(){E.ENV.getBool("DEBUG")?C=E.profiler.profileKernel(w,b,function(){return O()}):C=O()}),T&&this.addTapeNode(w,b,C,x,k,S),this.state.profiling&&this.state.activeProfile.kernels.push({name:w,bytesAdded:this.state.numBytes-I,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map(function(G){return b[G].shape}),outputShapes:C.map(function(G){return G.shape})}),Array.isArray(L)?C:C[0]},v.prototype.saveTensorsForBackwardMode=function(y){var b=this,x=y.map(function(w){return b.keep(b.clone(w))});return x},v.prototype.getTensorsForGradient=function(y,b,x){var w=i.getGradient(y);if(w!=null){var S=w.inputsToSave||[],A=w.outputsToSave||[],_=void 0;w.saveAllInputs?(l.assert(Array.isArray(b),function(){return"saveAllInputs is true, expected inputs to be an array."}),_=Object.keys(b).map(function(C){return b[C]})):_=S.map(function(C){return b[C]});var E=x.filter(function(C,k){return A[k]});return _.concat(E)}return null},v.prototype.makeTensor=function(y,b,x,w){if(y==null)throw new Error("Values passed to engine.makeTensor() are null");x=x||"float32",w=w||this.backend;var S=y;x==="string"&&l.isString(y[0])&&(S=y.map(function(k){return l.encodeString(k)}));var A=w.write(S,b,x),_=new s.Tensor(b,x,A,this.nextTensorId());if(this.incRef(_,w),x==="string"){var E=this.state.tensorInfo.get(A),C=c.bytesFromStringArray(S);this.state.numBytes+=C-E.bytes,E.bytes=C}return _},v.prototype.makeTensorFromDataId=function(y,b,x,w){x=x||"float32";var S=new s.Tensor(b,x,y,this.nextTensorId());return this.incRef(S,w),S},v.prototype.makeVariable=function(y,b,x,w){b===void 0&&(b=!0),x=x||this.nextVariableId().toString(),w!=null&&w!==y.dtype&&(y=y.asType(w));var S=new s.Variable(y,b,x,this.nextTensorId());if(this.state.registeredVariables[S.name]!=null)throw new Error("Variable with name "+S.name+" was already registered");return this.state.registeredVariables[S.name]=S,this.incRef(S,this.backend),S},v.prototype.incRef=function(y,b){var x=this.state.tensorInfo.has(y.dataId)?this.state.tensorInfo.get(y.dataId).refCount:0;if(this.state.numTensors++,y.dtype==="string"&&this.state.numStringTensors++,x===0){this.state.numDataBuffers++;var w=0;y.dtype!=="complex64"&&y.dtype!=="string"&&(w=y.size*l.bytesPerElement(y.dtype)),this.state.tensorInfo.set(y.dataId,{backend:b||this.backend,dtype:y.dtype,shape:y.shape,bytes:w,refCount:0}),this.state.numBytes+=w}this.state.tensorInfo.get(y.dataId).refCount++,y instanceof s.Variable||this.track(y)},v.prototype.disposeTensor=function(y){if(!!this.state.tensorInfo.has(y.dataId)){this.state.numTensors--,y.dtype==="string"&&this.state.numStringTensors--;var b=this.state.tensorInfo.get(y.dataId),x=b.refCount;x<=1?(y.dtype!=="complex64"&&(this.state.numBytes-=b.bytes),this.state.numDataBuffers--,b.backend.disposeData(y.dataId),this.state.tensorInfo.delete(y.dataId)):this.state.tensorInfo.get(y.dataId).refCount--}},v.prototype.disposeVariables=function(){for(var y in this.state.registeredVariables){var b=this.state.registeredVariables[y];this.disposeVariable(b)}},v.prototype.disposeVariable=function(y){this.disposeTensor(y),this.state.registeredVariables[y.name]!=null&&delete this.state.registeredVariables[y.name]},v.prototype.memory=function(){var y=this.backend.memory();return y.numTensors=this.state.numTensors,y.numDataBuffers=this.state.numDataBuffers,y.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(y.unreliable=!0,y.reasons==null&&(y.reasons=[]),y.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),y},v.prototype.profile=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){return this.state.profiling=!0,b=this.state.numBytes,x=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=y(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(S){return S.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-x,[2,this.state.activeProfile]})})},v.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},v.prototype.addTapeNode=function(y,b,x,w,S,A){var _=this,E={id:this.state.nextTapeNodeId++,kernelName:y,inputs:b,outputs:x,saved:S},C=i.getGradient(y);C!=null&&(w=C.gradFunc),w!=null&&(E.gradient=function(k){return k=k.map(function(T,I){if(T==null){var N=x[I],O=l.makeZerosTypedArray(N.size,N.dtype);return _.makeTensor(O,N.shape,N.dtype)}return T}),w(k.length>1?k:k[0],S,A)}),this.state.activeTape.push(E)},v.prototype.keep=function(y){return y.kept=!0,y},v.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},v.prototype.endTape=function(){this.state.gradientDepth--},v.prototype.startScope=function(y){var b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};y&&(b.name=y),this.state.scopeStack.push(b),this.state.activeScope=b},v.prototype.endScope=function(y){for(var b=this,x=u.getTensorsInContainer(y),w=new Set(x.map(function(E){return E.id})),S=0;S<this.state.activeScope.track.length;S++){var A=this.state.activeScope.track[S];!A.kept&&!w.has(A.id)&&A.dispose()}var _=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],x.forEach(function(E){!E.kept&&E.scopeId===_.id&&b.track(E)})},v.prototype.gradients=function(y,b,x,w){var S=this;if(w===void 0&&(w=!1),l.assert(b.length>0,function(){return"gradients() received an empty list of xs."}),x!=null&&x.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+x.dtype+"'");var A=this.scopedRun(function(){return S.startTape()},function(){return S.endTape()},function(){return S.tidy("forward",y)});l.assert(A instanceof s.Tensor,function(){return"The result y returned by f() must be a tensor."});var _=o.getFilteredNodesXToY(this.state.activeTape,b,A);if(!w&&_.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var E={};E[A.id]=x??h(A.shape),o.backpropagateGradients(E,_,function(k){return S.tidy(k)});var C=b.map(function(k){return E[k.id]});return S.state.gradientDepth===0&&(S.state.activeTape.forEach(function(k){for(var T=0,I=k.saved;T<I.length;T++){var N=I[T];N.dispose()}}),S.state.activeTape=null),{value:A,grads:C}})},v.prototype.customGrad=function(y){var b=this;return l.assert(l.isFunction(y),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];l.assert(x.every(function(_){return _ instanceof s.Tensor}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var S,A={};return x.forEach(function(_,E){A[E]=_}),b.runKernelFunc(function(_,E){return S=y.apply(void 0,x.concat([E])),l.assert(S.value instanceof s.Tensor,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),l.assert(l.isFunction(S.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),S.value},A,function(_,E){var C=S.gradFunc(_,E),k=Array.isArray(C)?C:[C];l.assert(k.length===x.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),l.assert(k.every(function(I){return I instanceof s.Tensor}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var T={};return k.forEach(function(I,N){T[N]=function(){return I}}),T})}},v.prototype.readSync=function(y){var b=this.state.tensorInfo.get(y);return b.backend.readSync(y)},v.prototype.read=function(y){var b=this.state.tensorInfo.get(y);return b.backend.read(y)},v.prototype.time=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){switch(w.label){case 0:return b=c.now(),[4,this.backend.time(y)];case 1:return x=w.sent(),x.wallMs=c.now()-b,[2,x]}})})},v.prototype.track=function(y){return this.state.activeScope!=null&&(y.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(y)),y},Object.defineProperty(v.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),v.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new f;for(var y in this.registry)this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},v.nextTensorId=0,v.nextVariableId=0,v}();e.Engine=d;function h(v){var y=c.makeOnesTypedArray(c.sizeFromShape(v),"float32");return e.ENGINE.makeTensor(y,v,"float32")}var p;function g(){if(p==null){var v=void 0;if(typeof window!="undefined")v=window;else if(typeof Ye!="undefined")v=Ye;else if(typeof process!="undefined")v=process;else if(typeof self!="undefined")v=self;else throw new Error("Could not find a global object");p=v}return p}function m(){var v=g();if(v._tfengine==null){var y=new r.Environment(v);v._tfengine=new d(y)}return r.setEnvironmentGlobal(v._tfengine.ENV),s.setTensorTracker(function(){return v._tfengine}),v._tfengine}e.ENGINE=m()})(Yr);var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),yr.Add="Add",yr.AddN="AddN",yr.Div="Div",yr.FusedBatchNorm="FusedBatchNorm",yr.SquaredDifference="SquaredDifference",yr.Square="Square",yr.Transpose="Transpose",yr.NonMaxSuppressionV5="NonMaxSuppressionV5",yr.BroadcastTo="BroadcastTo",yr.OneHot="OneHot",yr.Identity="Identity",yr.Tile="Tile",yr.PadV2="PadV2",yr.FromPixels="FromPixels",yr.MaxPoolWithArgmax="MaxPoolWithArgmax";var $r={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty($r,"__esModule",{value:!0});var E9e=Yr,hne=sv,A9e=Or,Qs=qe;function pne(e,t){var n=e;if(Qs.isTypedArray(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Qs.isTypedArray(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&hne.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&gne(e,r,[]),r}$r.inferShape=pne;function gne(e,t,n){if(n=n||[],!Array.isArray(e)&&!Qs.isTypedArray(e)){Qs.assert(t.length===0,function(){return"Element arr["+n.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+t[0]+" elements")});return}Qs.assert(t.length>0,function(){return"Element arr["+n.join("][")+"] should be a primitive, "+("but is an array of "+e.length+" elements")}),Qs.assert(e.length===t[0],function(){return"Element arr["+n.join("][")+"] should have "+t[0]+" "+("elements, but has "+e.length+" elements")});for(var r=t.slice(1),i=0;i<e.length;++i)gne(e[i],r,n.concat(i))}function mne(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must "+("be "+e+" tensor, but got "+t+" tensor"))}function vne(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof A9e.Tensor)return mne(r,e.dtype,t,n),e;var i=Qs.inferDtype(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),mne(r,i,t,n),e==null||!Qs.isTypedArray(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var o=pne(e,i);!Qs.isTypedArray(e)&&!Array.isArray(e)&&(e=[e]);var s=!0,u=i!=="string"?Qs.toTypedArray(e,i,hne.env().getBool("DEBUG")):Qs.flatten(e,[],s);return E9e.ENGINE.makeTensor(u,o,i)}$r.convertToTensor=vne;function C9e(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");var i=e;return i.map(function(a,o){return vne(a,t+"["+o+"]",n)},r)}$r.convertToTensorArray=C9e;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var F$=Yr;function k9e(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(t.length+" keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];F$.ENGINE.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),F$.ENGINE.endScope(s),s}catch(u){throw F$.ENGINE.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}oi.op=k9e,Object.defineProperty(dA,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var T9e=Yr,O9e=yr,I9e=cs,yne=$r,N9e=oi;function D9e(e,t){var n,r=yne.convertToTensor(e,"a","add"),i=yne.convertToTensor(t,"b","add");n=I9e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=function(s,u){var l=s.add(r,i);return u([r,i]),l},o={a:r,b:i};return T9e.ENGINE.runKernelFunc(a,o,null,O9e.Add)}dA.add=N9e.op({add_:D9e}),Object.defineProperty(p8e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var R9e=dA,F9e=Or;F9e.Tensor.prototype.add=function(e){return R9e.add(this,e)};var M9e={},M$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(M$,"__esModule",{value:!0});var P9e=Yr,$9e=yr,L9e=$r,B9e=oi;function z9e(e,t){var n=L9e.convertToTensor(e,"broadcastTo","x"),r=n.shape;if(t.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(p,g){return p>1?g:-1}).filter(function(p){return p>=0});if(u.length===0)return n.clone();var l=function(p){return p.tile(n,o)},c=!0,f=function(p){return{x:function(){return p.sum(u,c)}}},d={x:n},h={shape:t,inputShape:a};return P9e.ENGINE.runKernelFunc(l,d,f,$9e.BroadcastTo,h)}M$.broadcastTo=B9e.op({broadcastTo_:z9e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(M9e,"__esModule",{value:!0});var j9e=M$,U9e=Or;U9e.Tensor.prototype.broadcastTo=function(e){return j9e.broadcastTo(this,e)};var W9e={},wA={},si={},up={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(up,"__esModule",{value:!0});function V9e(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1,s=t[t.length-1-i]||1;s>1&&o===1&&r.unshift(a)}return r}up.getBroadcastDims=V9e;function q9e(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}up.getReductionAxes=q9e;function H9e(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){var s="Operands could not be broadcast together with shapes "+(e+" and "+t+".");throw Error(s)}else n.unshift(a)}return n}up.assertAndGetBroadcastShape=H9e;var lp={},o1={};Object.defineProperty(o1,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var P$=Yr,_A=$r,G9e=qe,$$=oi;function K9e(e,t){var n=_A.convertToTensor(e,"real","complex"),r=_A.convertToTensor(t,"imag","complex");return G9e.assertShapesMatch(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),P$.ENGINE.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}function X9e(e){var t=_A.convertToTensor(e,"input","real");return P$.ENGINE.runKernelFunc(function(n){return n.real(t)},{$input:t})}function Y9e(e){var t=_A.convertToTensor(e,"input","imag");return P$.ENGINE.runKernelFunc(function(n){return n.imag(t)},{$input:t})}o1.complex=$$.op({complex_:K9e}),o1.real=$$.op({real_:X9e}),o1.imag=$$.op({imag_:Y9e}),function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Yr,n=sv,r=$r,i=qe,a=o1,o=oi;function s(_,E,C){var k=r.inferShape(_,C);return u(_,E,k,C)}e.tensor=s;function u(_,E,C,k){if(k==null&&(k=i.inferDtype(_)),k==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!i.isTypedArray(_)&&!Array.isArray(_)&&typeof _!="number"&&typeof _!="boolean"&&typeof _!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(E!=null){i.assertNonNegativeIntegerDimensions(E);var T=i.sizeFromShape(E),I=i.sizeFromShape(C);i.assert(T===I,function(){return"Based on the provided shape, ["+E+"], the tensor should have "+(T+" values but has "+I)});for(var N=0;N<C.length;++N){var O=C[N],D=N===C.length-1?O!==i.sizeFromShape(E.slice(N)):!0;i.assert(C[N]===E[N]||!D,function(){return"Error creating a new Tensor. Inferred shape "+("("+C+") does not match the provided ")+("shape ("+E+"). ")})}}return!i.isTypedArray(_)&&!Array.isArray(_)&&(_=[_]),E=E||C,_=k!=="string"?i.toTypedArray(_,k,n.env().getBool("DEBUG")):i.flatten(_,[],!0),t.ENGINE.makeTensor(_,E,k)}function l(_,E){if((i.isTypedArray(_)&&E!=="string"||Array.isArray(_))&&E!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(E==="string"&&i.isTypedArray(_)&&!(_ instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var C=[],k=[];return u(_,C,k,E)}e.scalar=l;function c(_,E){i.assertNonNull(_);var C=r.inferShape(_,E);if(C.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var k=null;return u(_,k,C,E)}e.tensor1d=c;function f(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var k=r.inferShape(_,C);if(k.length!==2&&k.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u(_,E,k,C)}e.tensor2d=f;function d(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var k=r.inferShape(_,C);if(k.length!==3&&k.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor3d=d;function h(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var k=r.inferShape(_,C);if(k.length!==4&&k.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor4d=h;function p(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var k=r.inferShape(_,C);if(k.length!==5&&k.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor5d=p;function g(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var k=r.inferShape(_,C);if(k.length!==6&&k.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return E=E||k,u(_,E,k,C)}e.tensor6d=g;function m(_,E,C,k){return E===void 0&&(E=!0),t.ENGINE.makeVariable(_,E,C,k)}e.variable=m;function v(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var C=v(_,"float32"),k=y(_,"float32");return a.complex(C,k)}var T=i.makeOnesTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.ones=v;function y(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var C=y(_,"float32"),k=y(_,"float32");return a.complex(C,k)}var T=i.makeZerosTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.zeros=y;function b(_,E,C){return t.ENGINE.runKernelFunc(function(k){return k.fill(_,E,C)},{})}e.fill=b;function x(_){var E=r.convertToTensor(_,"x","onesLike");if(E.dtype==="complex64"){var C=e.onesLike(a.real(E)),k=e.zerosLike(a.imag(E));return a.complex(C,k)}var T=function(I,N){return{x:function(){return e.zerosLike(I)}}};return t.ENGINE.runKernelFunc(function(I){return I.onesLike(E)},{x:E},T,"OnesLike")}function w(_){var E=r.convertToTensor(_,"x","zerosLike"),C=function(k,T){return{x:function(){return e.zerosLike(k)}}};return t.ENGINE.runKernelFunc(function(k){return k.zerosLike(E)},{x:E},C,"ZerosLike")}function S(_,E,C){if(C<=0)throw new Error("The number of values should be positive.");return t.ENGINE.runKernelFunc(function(k){return k.linspace(_,E,C)},{})}e.linspace=S;function A(_,E,C,k){if(C===void 0&&(C=1),k===void 0&&(k="float32"),C===0)throw new Error("Cannot have a step of zero");var T=_===E,I=_<E&&C<0,N=E<_&&C>1;if(T||I||N)return y([0],k);var O=Math.abs(Math.ceil((E-_)/C)),D=i.makeZerosTypedArray(O,k);E<_&&C===1&&(C=-1),D[0]=_;for(var L=1;L<D.length;L++)D[L]=D[L-1]+C;return c(D,k)}e.range=A,e.onesLike=o.op({onesLike_:x}),e.zerosLike=o.op({zerosLike_:w})}(lp);var nn={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(nn,"__esModule",{value:!0});var on=Yr,fn=$r,bne=qe,dn=oi,Aa=lp;function Z9e(e){var t=fn.convertToTensor(e,"x","neg"),n=function(a){return{x:function(){return a.neg()}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a){return a.neg(t)},{x:t},n,"Neg",r,i)}function J9e(e){var t=fn.convertToTensor(e,"x","ceil"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.ceil(t)},{$x:t},n)}function Q9e(e){var t=fn.convertToTensor(e,"x","floor"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.floor(t)},{$x:t},n)}function e7e(e){var t=fn.convertToTensor(e,"x","sign"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.sign(t)},{$x:t},n)}function t7e(e){var t=fn.convertToTensor(e,"x","isNaN"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},n)}function n7e(e){var t=fn.convertToTensor(e,"x","isInf"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isInf(t)},{$x:t},n)}function r7e(e){var t=fn.convertToTensor(e,"x","isFinite"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},n)}function i7e(e){var t=fn.convertToTensor(e,"x","round"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.round(t)},{$x:t},n)}function a7e(e){var t=fn.convertToTensor(e,"x","exp"),n=function(o,s){return{x:function(){return o.mulStrict(s[0])}}},r={},i=[],a=[!0];return on.ENGINE.runKernelFunc(function(o,s){var u=o.exp(t);return s([u]),u},{x:t},n,"Exp",r,i,a)}function o7e(e){var t=fn.convertToTensor(e,"x","expm1"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.exp())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.expm1(t);return i([t]),a},{$x:t},n)}function s7e(e){var t=fn.convertToTensor(e,"x","log"),n=function(a,o){var s=o[0];return{x:function(){return a.div(s.toFloat())}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a,o){var s=a.log(t);return o([t]),s},{x:t},n,"Log",r,i)}function u7e(e){var t=fn.convertToTensor(e,"x","log1p"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.log1p(t);return i([t]),a},{$x:t},n)}function l7e(e){var t=fn.convertToTensor(e,"x","sqrt"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sqrt(t);return i([t]),a},{$x:t},n)}function c7e(e){var t=fn.convertToTensor(e,"x","rsqrt"),n=function(i,a){var o=a[0];return{x:function(){return i.div(o.pow(1.5).mul(2)).neg()}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.rsqrt(t);return a([t]),o},{x:t},n,"Rsqrt",{},r)}function f7e(e){var t=fn.convertToTensor(e,"x","reciprocal"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.square().neg())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.reciprocal(t);return i([t]),a},{$x:t},n)}function d7e(e){var t=fn.convertToTensor(e,"x","abs");if(t.dtype==="complex64")return on.ENGINE.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t});var n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.abs(t);return i([t]),a},{x:t},n,"Abs")}function h7e(e,t,n){var r=fn.convertToTensor(e,"x","clipByValue");bne.assert(t<=n,function(){return"Error in clip: min ("+t+") must be "+("less than or equal to max ("+n+").")});var i=function(s,u){var l=u[0];return{x:function(){return s.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Aa.zerosLike(s))}}},a=[r],o={min:t,max:n};return on.ENGINE.runKernelFunc(function(s,u){var l=s.clip(r,t,n);return u([r]),l},{x:r},i,"ClipByValue",o,a)}function p7e(e){var t=fn.convertToTensor(e,"x","sigmoid"),n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.mul(Aa.scalar(1).sub(a)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sigmoid(t);return i([a]),a},{x:t},n,"Sigmoid")}function g7e(e){var t=fn.convertToTensor(e,"x","logSigmoid"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t.neg()).neg();return i([t]),a},{$x:t},n)}function m7e(e){var t=fn.convertToTensor(e,"x","softplus"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t);return i([t]),a},{$x:t},n)}function v7e(e){var t=fn.convertToTensor(e,"x","sin"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.sin(t);return a([t]),o},{x:t},n,"Sin",{},r)}function y7e(e){var t=fn.convertToTensor(e,"x","cos"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.cos(t);return a([t]),o},{x:t},n,"Cos",{},r)}function b7e(e){var t=fn.convertToTensor(e,"x","tan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.cos().square())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.tan(t);return i([t]),a},{$x:t},n)}function x7e(e){var t=fn.convertToTensor(e,"x","asin"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).sub(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asin(t);return i([t]),a},{$x:t},n)}function w7e(e){var t=fn.convertToTensor(e,"x","acos"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).sub(a.toFloat().square()).sqrt()).neg()}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acos(t);return i([t]),a},{$x:t},n)}function _7e(e){var t=fn.convertToTensor(e,"x","atan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atan(t);return i([t]),a},{$x:t},n)}function S7e(e){var t=fn.convertToTensor(e,"x","sinh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sinh(t);return i([t]),a},{$x:t},n)}function E7e(e){var t=fn.convertToTensor(e,"x","cosh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.cosh(t);return i([t]),a},{$x:t},n)}function A7e(e){var t=fn.convertToTensor(e,"x","tanh"),n=function(i,a){var o=a[0];return{x:function(){return Aa.scalar(1).sub(o.square()).mulStrict(i)}}},r=[!0];return on.ENGINE.runKernelFunc(function(i,a){var o=i.tanh(t);return a([o]),o},{x:t},n,"Tanh",{},null,r)}function C7e(e){var t=fn.convertToTensor(e,"x","asinh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).add(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asinh(t);return i([t]),a},{$x:t},n)}function k7e(e){var t=fn.convertToTensor(e,"x","acosh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acosh(t);return i([t]),a},{$x:t},n)}function T7e(e){var t=fn.convertToTensor(e,"x","atanh"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(Aa.scalar(1).sub(a.toFloat().square()))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atanh(t);return i([t]),a},{$x:t},n)}function O7e(e){var t=fn.convertToTensor(e,"x","erf");bne.assert(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat());var n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.erf(t);return i([t]),a},{$x:t},n)}function I7e(e,t){t===void 0&&(t=0);var n=fn.convertToTensor(e,"x","step"),r=function(i){return{$x:function(){return Aa.zerosLike(i)}}};return on.ENGINE.runKernelFunc(function(i){return i.step(n,t)},{$x:n},r)}nn.abs=dn.op({abs_:d7e}),nn.acos=dn.op({acos_:w7e}),nn.acosh=dn.op({acosh_:k7e}),nn.asin=dn.op({asin_:x7e}),nn.asinh=dn.op({asinh_:C7e}),nn.atan=dn.op({atan_:_7e}),nn.atanh=dn.op({atanh_:T7e}),nn.ceil=dn.op({ceil_:J9e}),nn.clipByValue=dn.op({clipByValue_:h7e}),nn.cos=dn.op({cos_:y7e}),nn.cosh=dn.op({cosh_:E7e}),nn.erf=dn.op({erf_:O7e}),nn.exp=dn.op({exp_:a7e}),nn.expm1=dn.op({expm1_:o7e}),nn.floor=dn.op({floor_:Q9e}),nn.log=dn.op({log_:s7e}),nn.log1p=dn.op({log1p_:u7e}),nn.logSigmoid=dn.op({logSigmoid_:g7e}),nn.neg=dn.op({neg_:Z9e}),nn.reciprocal=dn.op({reciprocal_:f7e}),nn.round=dn.op({round_:i7e}),nn.rsqrt=dn.op({rsqrt_:c7e}),nn.sigmoid=dn.op({sigmoid_:p7e}),nn.sign=dn.op({sign_:e7e}),nn.isNaN=dn.op({isNaN_:t7e}),nn.isInf=dn.op({isInf_:n7e}),nn.isFinite=dn.op({isFinite_:r7e}),nn.sin=dn.op({sin_:v7e}),nn.sinh=dn.op({sinh_:S7e}),nn.softplus=dn.op({softplus_:m7e}),nn.sqrt=dn.op({sqrt_:l7e}),nn.step=dn.op({step_:I7e}),nn.tan=dn.op({tan_:b7e}),nn.tanh=dn.op({tanh_:A7e});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(si,"__esModule",{value:!0});var Kf=Yr,Xf=cs,xn=$r,xc=qe,xne=dA,Zr=up,Pi=oi,wne=lp,N7e=nn;function D7e(e,t){var n=xn.convertToTensor(e,"a","addStrict"),r=xn.convertToTensor(t,"b","addStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in addStrict: "),n.add(r)}function R7e(e,t){var n,r=xn.convertToTensor(e,"a","sub"),i=xn.convertToTensor(t,"b","sub");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s){var u=function(){var c=s,f=Zr.getReductionAxes(r.shape,a);return f.length>0&&(c=c.sum(f)),c.reshape(r.shape)},l=function(){var c=s,f=Zr.getReductionAxes(i.shape,a);return f.length>0&&(c=c.sum(f)),c.neg().reshape(i.shape)};return{a:u,b:l}};return Kf.ENGINE.runKernelFunc(function(s){return s.subtract(r,i)},{a:r,b:i},o,"Sub")}function F7e(e,t){var n=xn.convertToTensor(e,"a","subStrict"),r=xn.convertToTensor(t,"b","subStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}function M7e(e,t){var n,r=xn.convertToTensor(e,"base","pow"),i=xn.convertToTensor(t,"exp","pow");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(c,f){var d=f[0],h=f[1],p=f[2],g=function(){var v=h.toFloat(),y=c.mul(v.mul(d.pow(v.sub(wne.scalar(1))))),b=Zr.getReductionAxes(d.shape,a);return b.length>0&&(y=y.sum(b)),y.reshape(d.shape)},m=function(){var v=d.greater(0),y=d.log().where(v,wne.zerosLike(d)),b=c.mul(p.mul(y)),x=Zr.getReductionAxes(h.shape,a);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)};return{a:g,b:m}},s={},u=[r,i],l=[!0];return Kf.ENGINE.runKernelFunc(function(c,f){var d=c.pow(r,i);return f([r,i,d]),d},{a:r,b:i},o,"Pow",s,u,l)}function P7e(e,t){return xc.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}function $7e(e,t){var n,r=xn.convertToTensor(e,"a","mul"),i=xn.convertToTensor(t,"b","mul");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.mul(c.toFloat()),p=Zr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Zr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{a:f,b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.multiply(r,i);return u([r,i]),l},{a:r,b:i},o,"Mul")}function L7e(e,t){var n=xn.convertToTensor(e,"a","mul"),r=xn.convertToTensor(t,"b","mul");return xc.assertShapesMatch(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}function B7e(e,t){var n,r=xn.convertToTensor(e,"a","floorDiv"),i=xn.convertToTensor(t,"b","floorDiv");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.div(c.toFloat()),p=Zr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Zr.getReductionAxes(c.shape,a);p.length>0&&(h=h.sum(p).reshape(c.shape));var g=c.square();return h.div(g.toFloat()).neg()};return{a:f,b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.floorDiv(r,i);return u([r,i]),l},{a:r,b:i},o,"FloorDiv")}function z7e(e,t){var n=xn.convertToTensor(e,"a","div"),r=xn.convertToTensor(t,"b","div");return xc.assertShapesMatch(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}function j7e(e,t){var n,r=xn.convertToTensor(e,"a","mod"),i=xn.convertToTensor(t,"b","mod");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Zr.getReductionAxes(l.shape,a);return h.length>0?s.sum(h).reshape(l.shape):s},d=function(){var h=s.mul(l.div(c).floor().neg()),p=Zr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{$a:f,$b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.mod(r,i);return u([r,i]),l},{$a:r,$b:i},o)}function U7e(e,t){var n=xn.convertToTensor(e,"a","modStrict"),r=xn.convertToTensor(t,"b","modStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}function W7e(e,t){var n,r=xn.convertToTensor(e,"a","minimum"),i=xn.convertToTensor(t,"b","minimum");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Zr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.lessEqual(l).toFloat())},f=function(){return o.mul(u.greater(l).toFloat())};return{a:c,b:f}};return Kf.ENGINE.runKernelFunc(function(o,s){var u=o.minimum(r,i);return s([r,i]),u},{a:r,b:i},a,"Minimum")}function V7e(e,t){var n=xn.convertToTensor(e,"a","minimumStrict"),r=xn.convertToTensor(t,"b","minimumStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}function q7e(e,t){var n,r=xn.convertToTensor(e,"a","maximum"),i=xn.convertToTensor(t,"b","maximum");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Zr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.greaterEqual(l).toFloat())},f=function(){return o.mul(u.less(l).toFloat())};return{a:c,b:f}};return Kf.ENGINE.runKernelFunc(function(o,s){var u=o.maximum(r,i);return s([r,i]),u},{a:r,b:i},a,"Maximum")}function H7e(e,t){var n=xn.convertToTensor(e,"a","maximumStrict"),r=xn.convertToTensor(t,"b","maximumStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}function G7e(e,t){var n=xn.convertToTensor(e,"a","squaredDifferenceStrict"),r=xn.convertToTensor(t,"b","squaredDifferenceStrict");return xc.assertShapesMatch(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}function K7e(e,t){var n,r=xn.convertToTensor(e,"a","atan2"),i=xn.convertToTensor(t,"b","atan2");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=xne.add(l.square(),c.square()),p=s.mul(c.div(h)),g=Zr.getReductionAxes(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},d=function(){var h=xne.add(l.square(),c.square()),p=N7e.neg(s.mul(l.div(h))),g=Zr.getReductionAxes(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)};return{$a:f,$b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.atan2(r,i);return u([r,i]),l},{$a:r,$b:i},o)}si.addStrict=Pi.op({addStrict_:D7e}),si.atan2=Pi.op({atan2_:K7e}),si.divStrict=Pi.op({divStrict_:z7e}),si.floorDiv=Pi.op({floorDiv_:B7e}),si.maximum=Pi.op({maximum_:q7e}),si.maximumStrict=Pi.op({maximumStrict_:H7e}),si.minimum=Pi.op({minimum_:W7e}),si.minimumStrict=Pi.op({minimumStrict_:V7e}),si.mod=Pi.op({mod_:j7e}),si.modStrict=Pi.op({modStrict_:U7e}),si.mul=Pi.op({mul_:$7e}),si.mulStrict=Pi.op({mulStrict_:L7e}),si.pow=Pi.op({pow_:M7e}),si.powStrict=Pi.op({powStrict_:P7e}),si.squaredDifferenceStrict=Pi.op({squaredDifferenceStrict_:G7e}),si.sub=Pi.op({sub_:R7e}),si.subStrict=Pi.op({subStrict_:F7e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(wA,"__esModule",{value:!0});var X7e=Yr,Y7e=yr,Z7e=cs,_ne=$r,J7e=si,Q7e=oi;function eUe(e,t){var n,r=_ne.convertToTensor(e,"a","div"),i=_ne.convertToTensor(t,"b","div");if(n=Z7e.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return J7e.floorDiv(r,i);var a=function(u,l){var c=u.realDivide(r,i);return l([r,i]),c},o={a:r,b:i},s={};return X7e.ENGINE.runKernelFunc(a,o,null,Y7e.Div,s)}wA.div=Q7e.op({div_:eUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(W9e,"__esModule",{value:!0});var tUe=wA,nUe=Or;nUe.Tensor.prototype.div=function(e){return tUe.div(this,e)};var rUe={},L$={},Sne={},B$={},Ene={},tl={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(tl,"__esModule",{value:!0});var iUe=qe;function z$(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}tl.axesAreInnerMostDims=z$;function Ane(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}tl.combineLocations=Ane;function aUe(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);var a=t.map(function(o){return e[o]});return[n,a]}tl.computeOutAndReduceShapes=aUe;function oUe(e,t){var n=t.map(function(r){return 1});return Ane(e,n,t)}tl.expandShapeToKeepDim=oUe;function sUe(e,t,n){iUe.assert(z$(t,n),function(){return e+" supports only inner-most axes for now. "+("Got axes "+t+" and rank-"+n+" input.")})}tl.assertAxesAreInnerMostDims=sUe;function uUe(e,t){if(z$(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}tl.getAxesPermutation=uUe;function lUe(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}tl.getUndoAxesPermutation=lUe;function cUe(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}tl.getInnerMostAxes=cUe;var Cne={},SA={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(SA,"__esModule",{value:!0});var j$=qe;function fUe(e,t){var n=e[0].length;e.forEach(function(i,a){j$.assert(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+n+")")})}),j$.assert(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)j$.assert(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") "+("does not match the shape of the rest ("+r+") ")+("along the non-concatenated axis "+a+".")})})}SA.assertParamsConsistent=fUe;function dUe(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}SA.computeOutShape=dUe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Yr,n=$r,r=qe,i=qe,a=SA,o=oi,s=lp;function u(p){return e.concat(p,0)}function l(p,g){return e.concat(p,g)}function c(p,g){return e.concat(p,g)}function f(p,g){return e.concat(p,g)}function d(p,g){g===void 0&&(g=0),r.assert(p.length>=1,function(){return"Pass at least one tensor to concat"});var m=n.convertToTensorArray(p,"tensors","concat");m[0].dtype==="complex64"&&m.forEach(function(S){if(S.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+S.dtype+". ")}),g=i.parseAxisParam(g,m[0].shape)[0];var v=a.computeOutShape(m.map(function(S){return S.shape}),g);if(r.sizeFromShape(v)===0)return s.tensor([],v);if(m=m.filter(function(S){return S.size>0}),m.length===1)return m[0];var y=m.map(function(S){return S.shape});a.assertParamsConsistent(y,g);var b=function(S){var A=y.map(function(E){return E[g]}),_=e.split(S,A,g);return _.map(function(E){return function(){return E}})},x=m,w={axis:g};return t.ENGINE.runKernelFunc(function(S){return S.concat(m,g)},x,b,"Concat",w)}function h(p,g,m){m===void 0&&(m=0);var v=n.convertToTensor(p,"x","split");m=i.parseAxisParam(m,v.shape)[0];var y;typeof g=="number"?(r.assert(v.shape[m]%g==0,function(){return"Number of splits must evenly divide the axis."}),y=new Array(g).fill(v.shape[m]/g)):(r.assert(v.shape[m]===g.reduce(function(x,w){return x+w}),function(){return"The sum of sizes must match the size of the axis dimension."}),y=g);var b=function(x){return{$x:function(){return e.concat(x,m)}}};return t.ENGINE.runKernelFunc(function(x){return x.split(v,y,m)},{$x:v},b)}e.concat=o.op({concat_:d}),e.concat1d=o.op({concat1d_:u}),e.concat2d=o.op({concat2d_:l}),e.concat3d=o.op({concat3d_:c}),e.concat4d=o.op({concat4d_:f}),e.split=o.op({split_:h})}(Cne),function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(A,_,E,C){return new(E||(E=Promise))(function(k,T){function I(D){try{O(C.next(D))}catch(L){T(L)}}function N(D){try{O(C.throw(D))}catch(L){T(L)}}function O(D){D.done?k(D.value):new E(function(L){L(D.value)}).then(I,N)}O((C=C.apply(A,_||[])).next())})},n=Ye&&Ye.__generator||function(A,_){var E={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},C,k,T,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(D){return function(L){return O([D,L])}}function O(D){if(C)throw new TypeError("Generator is already executing.");for(;E;)try{if(C=1,k&&(T=D[0]&2?k.return:D[0]?k.throw||((T=k.return)&&T.call(k),0):k.next)&&!(T=T.call(k,D[1])).done)return T;switch(k=0,T&&(D=[D[0]&2,T.value]),D[0]){case 0:case 1:T=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,k=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(T=E.trys,!(T=T.length>0&&T[T.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!T||D[1]>T[0]&&D[1]<T[3])){E.label=D[1];break}if(D[0]===6&&E.label<T[1]){E.label=T[1],T=D;break}if(T&&E.label<T[2]){E.label=T[2],E.ops.push(D);break}T[2]&&E.ops.pop(),E.trys.pop();continue}D=_.call(A,E)}catch(L){D=[6,L],k=0}finally{C=T=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=Yr,i=Or,a=$r,o=qe,s=tl,u=Cne,l=oi;function c(A,_){var E=a.convertToTensor(A,"x","reshape",null);_=o.inferFromImplicitShape(_,E.size),o.assert(E.size===o.sizeFromShape(_),function(){return"new shape and old shape must have the same number of elements."});var C=function(T){return{x:function(){return T.reshape(E.shape)}}},k={shape:_};return r.ENGINE.runKernelFunc(function(T){return T.reshape(E,_)},{x:E},C,"Reshape",k)}function f(A,_){var E=a.convertToTensor(A,"x","squeeze");return e.reshape(E,o.squeezeShape(E.shape,_).newShape)}function d(A,_){var E=a.convertToTensor(A,"x","cast");if(!o.isValidDtype(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&E.dtype!=="string"||_!=="string"&&E.dtype==="string")throw new Error("Only strings can be casted to strings");var C=function(T){return{x:function(){return T.clone()}}},k={dtype:_};return r.ENGINE.runKernelFunc(function(T){return T.cast(E,_)},{x:E},C,"Cast",k)}function h(A,_){_===void 0&&(_=0);var E=a.convertToTensorArray(A,"tensors","stack");if(o.assert(E.length>=1,function(){return"Pass at least one tensor to tf.stack"}),E.length===1)return E[0].expandDims(_);var C=E[0].rank,k=E[0].shape,T=E[0].dtype;o.assert(_<=C,function(){return"Axis must be <= rank of the tensor"}),E.forEach(function(N){o.assertShapesMatch(k,N.shape,"All tensors passed to stack must have matching shapes")}),E.forEach(function(N){o.assert(T===N.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var I=E.map(function(N){return N.expandDims(_)});return u.concat(I,_)}function p(A,_,E){var C=a.convertToTensor(A,"x","batchToSpaceND"),k=_.reduce(function(I,N){return I*N});o.assert(C.rank>=1+_.length,function(){return"input rank is "+C.rank+" but should be > than blockShape.length "+_.length}),o.assert(E.length===_.length,function(){return"crops.length is "+E.length+" but should be equal to blockShape.length  "+_.length}),o.assert(C.shape[0]%k==0,function(){return"input tensor batch is "+C.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+_.join(" * ")+" === "+k)});var T=function(I){return{$x:function(){return I.spaceToBatchND(_,E)}}};return r.ENGINE.runKernelFunc(function(I){return I.batchToSpaceND(C,_,E)},{$x:C},T)}function g(A,_,E){var C=a.convertToTensor(A,"x","spaceToBatchND");o.assert(C.rank>=1+_.length,function(){return"input rank "+C.rank+" should be > than [blockShape] "+_.length}),o.assert(E.length===_.length,function(){return"paddings.shape[0] "+E.length+" must be equal to [blockShape] "+_.length}),o.assert(C.shape.reduce(function(T,I,N){return N>0&&N<=_.length?T&&(I+E[N-1][0]+E[N-1][1])%_[N-1]==0:T},!0),function(){return"input spatial dimensions "+C.shape.slice(1)+" with paddings "+E.toString()+" must be divisible by blockShapes "+_.toString()});var k=function(T){return{$x:function(){return T.batchToSpaceND(_,E)}}};return r.ENGINE.runKernelFunc(function(T){return T.spaceToBatchND(C,_,E)},{$x:C},k)}function m(A,_){_===void 0&&(_=0),_=_||0;var E=a.convertToTensor(A,"x","unstack");o.assert(_>=-E.shape.length&&_<E.shape.length,function(){return"Axis = "+_+" is not in [-"+E.shape.length+", "+E.shape.length+")"}),_<0&&(_+=E.shape.length);var C=function(T){return{x:function(){return e.stack(T,_)}}},k={axis:_};return r.ENGINE.runKernelFunc(function(T){return T.unstack(E,_)},{x:E},C,"Unpack",k)}function v(A,_,E,C){_===void 0&&(_=0),E===void 0&&(E=!1),C===void 0&&(C=!1);var k=a.convertToTensor(A,"x","cumsum");_=_|0;var T=s.getAxesPermutation([_],k.rank),I=k;T!=null&&(I=k.transpose(T));var N=s.getInnerMostAxes(1,k.rank)[0],O=function(L){return{permutedX:function(){return L.cumsum(_,E,!C)}}},D=r.ENGINE.runKernelFunc(function(L){return L.cumsum(I,N,E,C)},{permutedX:I},O);return T!=null&&(D=D.transpose(T)),D}function y(A,_){_===void 0&&(_=0);var E=null,C=a.convertToTensor(A,"x","expandDims",E);o.assert(_<=C.rank,function(){return"Axis must be <= rank of the tensor"});var k=C.shape.slice();return _<0&&(o.assert(-(C.rank+1)<=_,function(){return"Axis must be in the interval ["+-(C.rank+1)+", "+C.rank+"]"}),_=C.rank+_+1),k.splice(_,0,1),e.reshape(C,k)}function b(A,_,E){E===void 0&&(E="NHWC");var C=a.convertToTensor(A,"x","depthToSpace"),k=E==="NHWC"?C.shape[1]:C.shape[2],T=E==="NHWC"?C.shape[2]:C.shape[3],I=E==="NHWC"?C.shape[3]:C.shape[1];return o.assert(k*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+k+" and "+_+`  for depthToSpace with input shape
      `+C.shape}),o.assert(T*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+T+" and "+_+` for depthToSpace with input shape
          `+C.shape}),o.assert(I%(_*_)==0,function(){return"Dimension size must be evenly divisible by "+_*_+" but is "+I+" for depthToSpace with input shape "+C.shape}),r.ENGINE.runKernelFunc(function(N){return N.depthToSpace(C,_,E)},{$x:C})}function x(A,_){return t(this,void 0,void 0,function(){var E,C,k,T,I,N,O,D,L,O,W;return n(this,function(G){switch(G.label){case 0:return E=a.convertToTensor(A,"x","setdiff1d"),C=a.convertToTensor(_,"y","setdiff1d"),o.assert(E.dtype===C.dtype,function(){return"x and y should have the same dtype, but got x ("+E.dtype+") and y ("+C.dtype+")."}),o.assert(E.rank===1,function(){return"x should be 1D tensor, but got x ("+E.shape+")."}),o.assert(C.rank===1,function(){return"y should be 1D tensor, but got y ("+C.shape+")."}),[4,E.data()];case 1:return k=G.sent(),[4,C.data()];case 2:for(T=G.sent(),I=new Set(T),N=0,O=0;O<k.length;O++)I.has(k[O])||N++;for(D=new i.TensorBuffer([N],E.dtype),L=new i.TensorBuffer([N],"int32"),O=0,W=0;O<k.length;O++)I.has(k[O])||(D.values[W]=k[O],L.values[W]=O,W++);return[2,[D.toTensor(),L.toTensor()]]}})})}function w(A,_,E){return _===void 0&&(_="float32"),_=_||"float32",o.assertNonNegativeIntegerDimensions(A),new i.TensorBuffer(A,_,E)}e.buffer=w;function S(A,_){_===void 0&&(_=!1),console.log(A.toString(_))}e.print=S,e.batchToSpaceND=l.op({batchToSpaceND_:p}),e.cast=l.op({cast_:d}),e.cumsum=l.op({cumsum_:v}),e.depthToSpace=l.op({depthToSpace_:b}),e.expandDims=l.op({expandDims_:y}),e.reshape=l.op({reshape_:c}),e.spaceToBatchND=l.op({spaceToBatchND_:g}),e.squeeze=l.op({squeeze_:f}),e.stack=l.op({stack_:h}),e.unstack=l.op({unstack_:m}),e.setdiff1dAsync=x}(Ene);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(B$,"__esModule",{value:!0});var kne=Ene;function hUe(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var i=kne.buffer(e,"int32"),a=kne.buffer([n.length,e.length],"int32"),r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}B$.whereImpl=hUe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(m,v,y,b){return new(y||(y=Promise))(function(x,w){function S(E){try{_(b.next(E))}catch(C){w(C)}}function A(E){try{_(b.throw(E))}catch(C){w(C)}}function _(E){E.done?x(E.value):new y(function(C){C(E.value)}).then(S,A)}_((b=b.apply(m,v||[])).next())})},n=Ye&&Ye.__generator||function(m,v){var y={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},b,x,w,S;return S={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function A(E){return function(C){return _([E,C])}}function _(E){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,x&&(w=E[0]&2?x.return:E[0]?x.throw||((w=x.return)&&w.call(x),0):x.next)&&!(w=w.call(x,E[1])).done)return w;switch(x=0,w&&(E=[E[0]&2,w.value]),E[0]){case 0:case 1:w=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,x=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(w=y.trys,!(w=w.length>0&&w[w.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!w||E[1]>w[0]&&E[1]<w[3])){y.label=E[1];break}if(E[0]===6&&y.label<w[1]){y.label=w[1],w=E;break}if(w&&y.label<w[2]){y.label=w[2],y.ops.push(E);break}w[2]&&y.ops.pop(),y.trys.pop();continue}E=v.call(m,y)}catch(C){E=[6,C],x=0}finally{b=w=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=B$,i=Yr,a=$r,o=qe,s=up,u=oi,l=lp;function c(m){var v=a.convertToTensor(m,"x","logicalNot","bool");return i.ENGINE.runKernelFunc(function(y){return y.logicalNot(v)},{$x:v})}function f(m,v){var y=a.convertToTensor(m,"a","logicalAnd","bool"),b=a.convertToTensor(v,"b","logicalAnd","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalAnd(y,b)},{a:y,b},null,"LogicalAnd")}function d(m,v){var y=a.convertToTensor(m,"a","logicalOr","bool"),b=a.convertToTensor(v,"b","logicalOr","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalOr(y,b)},{$a:y,$b:b})}function h(m,v){var y=a.convertToTensor(m,"a","logicalXor","bool"),b=a.convertToTensor(v,"b","logicalXor","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),e.logicalOr(m,v).logicalAnd(e.logicalAnd(m,v).logicalNot())}function p(m,v,y){var b=a.convertToTensor(v,"a","where"),x=a.convertToTensor(y,"b","where"),w=a.convertToTensor(m,"condition","where","bool");o.assertShapesMatch(b.shape,x.shape,"Error in where: "),w.rank===1?o.assert(w.shape[0]===b.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):o.assertShapesMatch(w.shape,x.shape,"Error in where: ");var S=function(A,_){var E=_[0];return{$condition:function(){return l.zerosLike(E).toFloat()},$a:function(){return A.mul(E.cast(A.dtype))},$b:function(){return A.mul(E.logicalNot().cast(A.dtype))}}};return i.ENGINE.runKernelFunc(function(A,_){var E=A.select(w,b,x);return _([w]),E},{$condition:w,$a:b,$b:x},S)}function g(m){return t(this,void 0,void 0,function(){var v,y,b;return n(this,function(x){switch(x.label){case 0:return v=a.convertToTensor(m,"condition","whereAsync","bool"),[4,v.data()];case 1:return y=x.sent(),b=r.whereImpl(v.shape,y),m!==v&&v.dispose(),[2,b]}})})}e.logicalAnd=u.op({logicalAnd_:f}),e.logicalNot=u.op({logicalNot_:c}),e.logicalOr=u.op({logicalOr_:d}),e.logicalXor=u.op({logicalXor_:h}),e.where=u.op({where_:p}),e.whereAsync=g}(Sne);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(L$,"__esModule",{value:!0});var pUe=cs,Tne=$r,gUe=wA,mUe=Sne,vUe=oi,yUe=lp;function bUe(e,t){var n,r=Tne.convertToTensor(e,"a","div"),i=Tne.convertToTensor(t,"b","div");n=pUe.makeTypesMatch(r,i),r=n[0],i=n[1];var a=gUe.div(r,i),o=yUe.zerosLike(a),s=i.equal(o);return mUe.where(s,o,a)}L$.divNoNan=vUe.op({divNoNan_:bUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(rUe,"__esModule",{value:!0});var xUe=L$,wUe=Or;wUe.Tensor.prototype.divNoNan=function(e){return xUe.divNoNan(this,e)};var _Ue={},U$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(U$,"__esModule",{value:!0});var SUe=Yr,EUe=yr,AUe=cs,One=$r,CUe=up,kUe=oi,TUe=lp;function OUe(e,t){var n,r=One.convertToTensor(e,"a","squaredDifference"),i=One.convertToTensor(t,"b","squaredDifference");n=AUe.makeTypesMatch(r,i),r=n[0],i=n[1],CUe.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(f,d){var h=d[0],p=d[1],g=TUe.scalar(2),m=function(){return f.mul(h.sub(p).mul(g))},v=function(){return f.mul(p.sub(h).mul(g))};return{a:m,b:v}},o=function(f,d){var h=f.squaredDifference(r,i);return d([r,i]),h},s={a:r,b:i},u={},l=[r,i],c=[];return SUe.ENGINE.runKernelFunc(o,s,a,EUe.SquaredDifference,u,l,c)}U$.squaredDifference=kUe.op({squaredDifference_:OUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(_Ue,"__esModule",{value:!0});var IUe=U$,NUe=Or;NUe.Tensor.prototype.squaredDifference=function(e){return IUe.squaredDifference(this,e)};var DUe={},W$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(W$,"__esModule",{value:!0});var RUe=Yr,FUe=yr,MUe=$r,PUe=qe,$Ue=oi;function LUe(e,t){var n=null,r=MUe.convertToTensor(e,"x","tile",n);PUe.assert(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" "+("must match length of reps "+t+".")});var i=function(u,l){var c=u.tile(r,t);return l([r]),c},a=[r],o={x:r},s={reps:t};return RUe.ENGINE.runKernelFunc(i,o,null,FUe.Tile,s,a)}W$.tile=$Ue.op({tile_:LUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(DUe,"__esModule",{value:!0});var BUe=W$,zUe=Or;zUe.Tensor.prototype.tile=function(e){return BUe.tile(this,e)};var jUe={},V$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(V$,"__esModule",{value:!0});var UUe=Yr,WUe=yr,VUe=$r,qUe=oi;function HUe(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=VUe.convertToTensor(e,"indices","oneHot","int32"),a=i.shape.concat([t]);i=i.flatten();var o=function(c,f){return f([i]),c.oneHot(i,t,n,r)},s={indices:i},u={depth:t,onValue:n,offValue:r},l=UUe.ENGINE.runKernelFunc(o,s,null,WUe.OneHot,u);return l.reshape(a)}V$.oneHot=qUe.op({oneHot_:HUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(jUe,"__esModule",{value:!0});var GUe=V$,KUe=Or;KUe.Tensor.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),GUe.oneHot(this,e,t,n)};var XUe={},q$={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(q$,"__esModule",{value:!0});var YUe=Yr,ZUe=$r,Ine=qe,JUe=oi;function QUe(e,t){var n=ZUe.convertToTensor(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),Ine.assert(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" "+("must match length of perm "+t+".")}),t.forEach(function(i){Ine.assert(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+(" but got "+t)})}),n.rank<=1)return n.clone();var r={perm:t};return YUe.ENGINE.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}q$.transpose=JUe.op({transpose_:QUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(XUe,"__esModule",{value:!0});var eWe=q$,tWe=Or;tWe.Tensor.prototype.transpose=function(e){return eWe.transpose(this,e)};var nWe={},H$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(H$,"__esModule",{value:!0});var rWe=Yr,iWe=yr,aWe=$r,oWe=oi;function sWe(e,t,n){n===void 0&&(n=0);var r=aWe.convertToTensor(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=function(s,u){return u([r]),s.pad(r,t,n)},a={paddings:t,constantValue:n},o={x:r};return rWe.ENGINE.runKernelFunc(i,o,null,iWe.PadV2,a)}H$.pad=oWe.op({pad_:sWe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(nWe,"__esModule",{value:!0});var uWe=H$,lWe=Or;lWe.Tensor.prototype.pad=function(e,t){return uWe.pad(this,e,t)};var cWe={},EA={},AA={},br={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(br,"__esModule",{value:!0});var Ca=Yr,s1=sv,fWe=Or,dWe=cs;function hWe(){s1.env().set("PROD",!0)}br.enableProdMode=hWe;function pWe(){s1.env().set("DEBUG",!0)}br.enableDebugMode=pWe;function gWe(){s1.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}br.disableDeprecationWarnings=gWe;function Nne(e){s1.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}br.deprecationWarn=Nne,fWe.setDeprecationWarningFn(Nne);function mWe(){Ca.ENGINE.disposeVariables()}br.disposeVariables=mWe;function vWe(){return Ca.ENGINE}br.engine=vWe;function yWe(){return Ca.ENGINE.memory()}br.memory=yWe;function bWe(e){return Ca.ENGINE.profile(e)}br.profile=bWe;function xWe(e,t){return Ca.ENGINE.tidy(e,t)}br.tidy=xWe;function wWe(e){var t=dWe.getTensorsInContainer(e);t.forEach(function(n){return n.dispose()})}br.dispose=wWe;function _We(e){return Ca.ENGINE.keep(e)}br.keep=_We;function SWe(e){return Ca.ENGINE.time(e)}br.time=SWe;function EWe(e){return Ca.ENGINE.setBackend(e)}br.setBackend=EWe;function AWe(){return Ca.ENGINE.ready()}br.ready=AWe;function CWe(){return Ca.ENGINE.backendName}br.getBackend=CWe;function kWe(e){Ca.ENGINE.removeBackend(e)}br.removeBackend=kWe;function TWe(e){return Ca.ENGINE.findBackend(e)}br.findBackend=TWe;function OWe(e){return Ca.ENGINE.findBackendFactory(e)}br.findBackendFactory=OWe;function IWe(e,t,n){return n===void 0&&(n=1),Ca.ENGINE.registerBackend(e,t,n)}br.registerBackend=IWe;function NWe(){return Ca.ENGINE.backend}br.backend=NWe;function DWe(e,t){s1.env().setPlatform(e,t)}br.setPlatform=DWe,Object.defineProperty(AA,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var RWe=br;function FWe(){RWe.deprecationWarn("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}AA.warnDeprecation=FWe;function MWe(e){var t;return e.rank===0||e.rank===1?t=e.as4D(1,1,1,e.size):e.rank===2?t=e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?t=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):t=e,t}AA.xAs4D=MWe;/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(EA,"__esModule",{value:!0});var PWe=Yr,u1=$r,G$=qe,Dne=AA,Rne=oi;function $We(e,t,n,r,i,a){return r===void 0&&(r=.001),Dne.warnDeprecation(),Fne(e,t,n,a,i,r)}function Fne(e,t,n,r,i,a){a==null&&(a=.001);var o=u1.convertToTensor(e,"x","batchNorm"),s=u1.convertToTensor(t,"mean","batchNorm"),u=u1.convertToTensor(n,"variance","batchNorm"),l;i!=null&&(l=u1.convertToTensor(i,"scale","batchNorm"));var c;r!=null&&(c=u1.convertToTensor(r,"offset","batchNorm")),G$.assert(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),G$.assert(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),G$.assert(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f=function(g,m){var v=Dne.xAs4D(o),y=g.batchNormalization(v,CA(s),CA(u),a,CA(l),CA(c));return m([o,s,u,l]),y},d={x:o,scale:l,offset:c,mean:s,variance:u},h={varianceEpsilon:a},p=PWe.ENGINE.runKernelFunc(f,d,null,"FusedBatchNorm",h);return p.reshape(o.shape)}function CA(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}EA.batchNormalization=Rne.op({batchNormalization_:$We}),EA.batchNorm=Rne.op({batchNorm_:Fne}),Object.defineProperty(cWe,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var LWe=EA,BWe=Or;BWe.Tensor.prototype.batchNorm=function(e,t,n,r,i){return LWe.batchNorm(this,e,t,n,r,i)},Object.defineProperty(h8e,"__esModule",{value:!0});var K$={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var zWe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),jWe=Object.prototype.hasOwnProperty;function X$(e,t){return jWe.call(e,t)}function Y$(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)X$(e,r)&&n.push(r);return n}function zo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Z$(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function cp(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Mne(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function J$(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(J$(e[t]))return!0}else if(typeof e=="object"){for(var r=Y$(e),i=r.length,t=0;t<i;t++)if(J$(e[r[t]]))return!0}}return!1}function Pne(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var $ne=function(e){zWe(t,e);function t(n,r,i,a,o){var s=this.constructor,u=e.call(this,Pne(n,{name:r,index:i,operation:a,tree:o}))||this;return u.name=r,u.index=i,u.operation=a,u.tree=o,Object.setPrototypeOf(u,s.prototype),u.message=Pne(n,{name:r,index:i,operation:a,tree:o}),u}return t}(Error),Ir=$ne,UWe=zo,cv={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=kA(n,this.path);r&&(r=zo(r));var i=fp(n,{op:"remove",path:this.from}).removed;return fp(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=kA(n,this.from);return fp(n,{op:"add",path:this.path,value:zo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:l1(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},WWe={add:function(e,t,n){return Z$(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:cv.move,copy:cv.copy,test:cv.test,_get:cv._get};function kA(e,t){if(t=="")return e;var n={op:"_get",path:t};return fp(e,n),n.value}function fp(e,t,n,r,i,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):OA(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=kA(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=l1(e,t.value),o.test===!1)throw new Ir("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Ir("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}}else{r||(e=zo(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=OA;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=Mne(h)),i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Z$(h))throw new Ir("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);Z$(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new Ir("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var o=WWe[t.op].call(t,l,h,e);if(o.test===!1)throw new Ir("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(c>=f){var o=cv[t.op].call(t,l,h,e);if(o.test===!1)throw new Ir("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new Ir("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function TA(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Ir("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=zo(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=fp(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function VWe(e,t,n){var r=fp(e,t);if(r.test===!1)throw new Ir("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function OA(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Ir("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(cv[e.op]){if(typeof e.path!="string")throw new Ir("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Ir('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Ir("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Ir("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&J$(e.value))throw new Ir("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new Ir("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Ir("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},s=Lne([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Ir("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Ir("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Lne(e,t,n){try{if(!Array.isArray(e))throw new Ir("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)TA(zo(t),zo(e),n||!0);else{n=n||OA;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Ir)return i;throw i}}function l1(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){if(a=e.length,a!=t.length)return!1;for(i=a;i--!=0;)if(!l1(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(a=s.length,a!==Object.keys(t).length)return!1;for(i=a;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=a;i--!=0;)if(o=s[i],!l1(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var qWe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:Ir,deepClone:UWe,getValueByPointer:kA,applyOperation:fp,applyPatch:TA,applyReducer:VWe,validator:OA,validate:Lne,_areEquals:l1});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Q$=new WeakMap,HWe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),GWe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function KWe(e){return Q$.get(e)}function XWe(e,t){return e.observers.get(t)}function YWe(e,t){e.observers.delete(t.callback)}function ZWe(e,t){t.unobserve()}function JWe(e,t){var n=[],r,i=KWe(e);if(!i)i=new HWe(e),Q$.set(e,i);else{var a=XWe(i,t);r=a&&a.observer}if(r)return r;if(r={},i.value=zo(e),t){r.callback=t,r.next=null;var o=function(){eL(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){eL(r),clearTimeout(r.next),YWe(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new GWe(t,r)),r}function eL(e,t){t===void 0&&(t=!1);var n=Q$.get(e.object);tL(n.value,e.object,e.patches,"",t),e.patches.length&&TA(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function tL(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=Y$(t),o=Y$(e),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(X$(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?tL(c,f,n,r+"/"+cp(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+cp(l),value:zo(c)}),n.push({op:"replace",path:r+"/"+cp(l),value:zo(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+cp(l),value:zo(c)}),n.push({op:"remove",path:r+"/"+cp(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&a.length==o.length))for(var u=0;u<a.length;u++){var l=a[u];!X$(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+cp(l),value:zo(t[l])})}}}function QWe(e,t,n){n===void 0&&(n=!1);var r=[];return tL(e,t,r,"",n),r}var eVe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:ZWe,observe:JWe,generate:eL,compare:QWe});Object.assign({},qWe,eVe,{JsonPatchError:$ne,deepClone:zo,escapePathComponent:cp,unescapePathComponent:Mne});var tVe=/("(?:[^\\"]|\\.)*")|[:,]/g,nL=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,a=n.replacer,function o(s,u,l){var c,f,d,h,p,g,m,v,y,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,a),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(y=x.replace(tVe,function(S,A){return A||S+" "}),y.length<=m))return y;if(a!=null&&(s=JSON.parse(x),a=void 0),typeof s=="object"&&s!==null){if(v=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(o(s[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(s),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=o(s[h],v,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[b,r+d.join(`,
`+v),c].join(`
`+u)}return x}(t,"",0)},Yf={exports:{}};const nVe="2.0.0",rVe=256,iVe=Number.MAX_SAFE_INTEGER||9007199254740991,aVe=16;var IA={SEMVER_SPEC_VERSION:nVe,MAX_LENGTH:rVe,MAX_SAFE_INTEGER:iVe,MAX_SAFE_COMPONENT_LENGTH:aVe};const oVe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var NA=oVe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=IA,r=NA;t=e.exports={};const i=t.re=[],a=t.src=[],o=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),o[l]=d,a[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${a[o.NUMERICIDENTIFIER]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${a[o.NUMERICIDENTIFIERLOOSE]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${a[o.PRERELEASEIDENTIFIER]}(?:\\.${a[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${a[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${a[o.BUILDIDENTIFIER]}(?:\\.${a[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${a[o.MAINVERSION]}${a[o.PRERELEASE]}?${a[o.BUILD]}?`),u("FULL",`^${a[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${a[o.MAINVERSIONLOOSE]}${a[o.PRERELEASELOOSE]}?${a[o.BUILD]}?`),u("LOOSE",`^${a[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${a[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${a[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:${a[o.PRERELEASE]})?${a[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:${a[o.PRERELEASELOOSE]})?${a[o.BUILD]}?)?)?`),u("XRANGE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",a[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${a[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${a[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${a[o.LONECARET]}${a[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${a[o.LONECARET]}${a[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${a[o.GTLT]}\\s*(${a[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]}|${a[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${a[o.XRANGEPLAIN]})\\s+-\\s+(${a[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${a[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Yf,Yf.exports);const sVe=["includePrerelease","loose","rtl"],uVe=e=>e?typeof e!="object"?{loose:!0}:sVe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var DA=uVe;const Bne=/^[0-9]+$/,zne=(e,t)=>{const n=Bne.test(e),r=Bne.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},lVe=(e,t)=>zne(t,e);var rL={compareIdentifiers:zne,rcompareIdentifiers:lVe};const RA=NA,{MAX_LENGTH:jne,MAX_SAFE_INTEGER:FA}=IA,{re:Une,t:Wne}=Yf.exports,cVe=DA,{compareIdentifiers:c1}=rL;class eu{constructor(t,n){if(n=cVe(n),t instanceof eu){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>jne)throw new TypeError(`version is longer than ${jne} characters`);RA("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?Une[Wne.LOOSE]:Une[Wne.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>FA||this.major<0)throw new TypeError("Invalid major version");if(this.minor>FA||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>FA||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<FA)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(RA("SemVer.compare",this.version,this.options,t),!(t instanceof eu)){if(typeof t=="string"&&t===this.version)return 0;t=new eu(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof eu||(t=new eu(t,this.options)),c1(this.major,t.major)||c1(this.minor,t.minor)||c1(this.patch,t.patch)}comparePre(t){if(t instanceof eu||(t=new eu(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(RA("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return c1(r,i)}while(++n)}compareBuild(t){t instanceof eu||(t=new eu(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(RA("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return c1(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var ka=eu;const{MAX_LENGTH:fVe}=IA,{re:Vne,t:qne}=Yf.exports,Hne=ka,dVe=DA,hVe=(e,t)=>{if(t=dVe(t),e instanceof Hne)return e;if(typeof e!="string"||e.length>fVe||!(t.loose?Vne[qne.LOOSE]:Vne[qne.FULL]).test(e))return null;try{return new Hne(e,t)}catch(r){return null}};var fv=hVe;const pVe=fv,gVe=(e,t)=>{const n=pVe(e,t);return n?n.version:null};var mVe=gVe;const vVe=fv,yVe=(e,t)=>{const n=vVe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var bVe=yVe;const xVe=ka,wVe=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new xVe(e,n).inc(t,r).version}catch(i){return null}};var _Ve=wVe;const Gne=ka,SVe=(e,t,n)=>new Gne(e,n).compare(new Gne(t,n));var tu=SVe;const EVe=tu,AVe=(e,t,n)=>EVe(e,t,n)===0;var iL=AVe;const Kne=fv,CVe=iL,kVe=(e,t)=>{if(CVe(e,t))return null;{const n=Kne(e),r=Kne(t),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return a+s;return o}};var TVe=kVe;const OVe=ka,IVe=(e,t)=>new OVe(e,t).major;var NVe=IVe;const DVe=ka,RVe=(e,t)=>new DVe(e,t).minor;var FVe=RVe;const MVe=ka,PVe=(e,t)=>new MVe(e,t).patch;var $Ve=PVe;const LVe=fv,BVe=(e,t)=>{const n=LVe(e,t);return n&&n.prerelease.length?n.prerelease:null};var zVe=BVe;const jVe=tu,UVe=(e,t,n)=>jVe(t,e,n);var WVe=UVe;const VVe=tu,qVe=(e,t)=>VVe(e,t,!0);var HVe=qVe;const Xne=ka,GVe=(e,t,n)=>{const r=new Xne(e,n),i=new Xne(t,n);return r.compare(i)||r.compareBuild(i)};var aL=GVe;const KVe=aL,XVe=(e,t)=>e.sort((n,r)=>KVe(n,r,t));var YVe=XVe;const ZVe=aL,JVe=(e,t)=>e.sort((n,r)=>ZVe(r,n,t));var QVe=JVe;const eqe=tu,tqe=(e,t,n)=>eqe(e,t,n)>0;var MA=tqe;const nqe=tu,rqe=(e,t,n)=>nqe(e,t,n)<0;var oL=rqe;const iqe=tu,aqe=(e,t,n)=>iqe(e,t,n)!==0;var Yne=aqe;const oqe=tu,sqe=(e,t,n)=>oqe(e,t,n)>=0;var sL=sqe;const uqe=tu,lqe=(e,t,n)=>uqe(e,t,n)<=0;var uL=lqe;const cqe=iL,fqe=Yne,dqe=MA,hqe=sL,pqe=oL,gqe=uL,mqe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return cqe(e,n,r);case"!=":return fqe(e,n,r);case">":return dqe(e,n,r);case">=":return hqe(e,n,r);case"<":return pqe(e,n,r);case"<=":return gqe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Zne=mqe;const vqe=ka,yqe=fv,{re:PA,t:$A}=Yf.exports,bqe=(e,t)=>{if(e instanceof vqe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(PA[$A.COERCE]);else{let r;for(;(r=PA[$A.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),PA[$A.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;PA[$A.COERCERTL].lastIndex=-1}return n===null?null:yqe(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var xqe=bqe,wqe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},_qe=wn;wn.Node=dp,wn.create=wn;function wn(e){var t=this;if(t instanceof wn||(t=new wn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}wn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},wn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},wn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},wn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Eqe(this,arguments[e]);return this.length},wn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Aqe(this,arguments[e]);return this.length},wn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},wn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},wn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next},wn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev},wn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},wn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},wn.prototype.map=function(e,t){t=t||this;for(var n=new wn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n},wn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new wn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n},wn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n},wn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n},wn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},wn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},wn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n},wn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n},wn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var a=[],r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=Sqe(this,i,n[r]);return a},wn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function Sqe(e,t,n){var r=t===e.head?new dp(n,null,t,e):new dp(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function Eqe(e,t){e.tail=new dp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Aqe(e,t){e.head=new dp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function dp(e,t,n,r){if(!(this instanceof dp))return new dp(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{wqe(wn)}catch(e){}const Cqe=_qe,hp=Symbol("max"),wc=Symbol("length"),dv=Symbol("lengthCalculator"),f1=Symbol("allowStale"),pp=Symbol("maxAge"),_c=Symbol("dispose"),Jne=Symbol("noDisposeOnSet"),xi=Symbol("lruList"),nu=Symbol("cache"),Qne=Symbol("updateAgeOnGet"),lL=()=>1;class kqe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[hp]=t.max||1/0;const n=t.length||lL;if(this[dv]=typeof n!="function"?lL:n,this[f1]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[pp]=t.maxAge||0,this[_c]=t.dispose,this[Jne]=t.noDisposeOnSet||!1,this[Qne]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[hp]=t||1/0,d1(this)}get max(){return this[hp]}set allowStale(t){this[f1]=!!t}get allowStale(){return this[f1]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[pp]=t,d1(this)}get maxAge(){return this[pp]}set lengthCalculator(t){typeof t!="function"&&(t=lL),t!==this[dv]&&(this[dv]=t,this[wc]=0,this[xi].forEach(n=>{n.length=this[dv](n.value,n.key),this[wc]+=n.length})),d1(this)}get lengthCalculator(){return this[dv]}get length(){return this[wc]}get itemCount(){return this[xi].length}rforEach(t,n){n=n||this;for(let r=this[xi].tail;r!==null;){const i=r.prev;ere(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[xi].head;r!==null;){const i=r.next;ere(this,t,r,n),r=i}}keys(){return this[xi].toArray().map(t=>t.key)}values(){return this[xi].toArray().map(t=>t.value)}reset(){this[_c]&&this[xi]&&this[xi].length&&this[xi].forEach(t=>this[_c](t.key,t.value)),this[nu]=new Map,this[xi]=new Cqe,this[wc]=0}dump(){return this[xi].map(t=>LA(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[xi]}set(t,n,r){if(r=r||this[pp],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,a=this[dv](n,t);if(this[nu].has(t)){if(a>this[hp])return hv(this,this[nu].get(t)),!1;const u=this[nu].get(t).value;return this[_c]&&(this[Jne]||this[_c](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[wc]+=a-u.length,u.length=a,this.get(t),d1(this),!0}const o=new Tqe(t,n,a,i,r);return o.length>this[hp]?(this[_c]&&this[_c](t,n),!1):(this[wc]+=o.length,this[xi].unshift(o),this[nu].set(t,this[xi].head),d1(this),!0)}has(t){if(!this[nu].has(t))return!1;const n=this[nu].get(t).value;return!LA(this,n)}get(t){return cL(this,t,!0)}peek(t){return cL(this,t,!1)}pop(){const t=this[xi].tail;return t?(hv(this,t),t.value):null}del(t){hv(this,this[nu].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-n;o>0&&this.set(i.k,i.v,o)}}}prune(){this[nu].forEach((t,n)=>cL(this,n,!1))}}const cL=(e,t,n)=>{const r=e[nu].get(t);if(r){const i=r.value;if(LA(e,i)){if(hv(e,r),!e[f1])return}else n&&(e[Qne]&&(r.value.now=Date.now()),e[xi].unshiftNode(r));return i.value}},LA=(e,t)=>{if(!t||!t.maxAge&&!e[pp])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[pp]&&n>e[pp]},d1=e=>{if(e[wc]>e[hp])for(let t=e[xi].tail;e[wc]>e[hp]&&t!==null;){const n=t.prev;hv(e,t),t=n}},hv=(e,t)=>{if(t){const n=t.value;e[_c]&&e[_c](n.key,n.value),e[wc]-=n.length,e[nu].delete(n.key),e[xi].removeNode(t)}};class Tqe{constructor(t,n,r,i,a){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=a||0}}const ere=(e,t,n,r)=>{let i=n.value;LA(e,i)&&(hv(e,n),e[f1]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var Oqe=kqe;class h1{constructor(t,n){if(n=Nqe(n),t instanceof h1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new h1(t.raw,n);if(t instanceof fL)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!nre(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&Pqe(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=tre.get(r);if(i)return i;const a=this.options.loose,o=a?Xi[$i.HYPHENRANGELOOSE]:Xi[$i.HYPHENRANGE];t=t.replace(o,Hqe(this.options.includePrerelease)),Lr("hyphen replace",t),t=t.replace(Xi[$i.COMPARATORTRIM],Rqe),Lr("comparator trim",t,Xi[$i.COMPARATORTRIM]),t=t.replace(Xi[$i.TILDETRIM],Fqe),t=t.replace(Xi[$i.CARETTRIM],Mqe),t=t.split(/\s+/).join(" ");const s=a?Xi[$i.COMPARATORLOOSE]:Xi[$i.COMPARATOR],u=t.split(" ").map(f=>$qe(f,this.options)).join(" ").split(/\s+/).map(f=>qqe(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new fL(f,this.options));u.length;const l=new Map;for(const f of u){if(nre(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return tre.set(r,c),c}intersects(t,n){if(!(t instanceof h1))throw new TypeError("a Range is required");return this.set.some(r=>rre(r,n)&&t.set.some(i=>rre(i,n)&&r.every(a=>i.every(o=>a.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new Dqe(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(Gqe(this.set[n],t,this.options))return!0;return!1}}var ru=h1;const Iqe=Oqe,tre=new Iqe({max:1e3}),Nqe=DA,fL=zA,Lr=NA,Dqe=ka,{re:Xi,t:$i,comparatorTrimReplace:Rqe,tildeTrimReplace:Fqe,caretTrimReplace:Mqe}=Yf.exports,nre=e=>e.value==="<0.0.0-0",Pqe=e=>e.value==="",rre=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(a=>i.intersects(a,t)),i=r.pop();return n},$qe=(e,t)=>(Lr("comp",e,t),e=zqe(e,t),Lr("caret",e),e=Lqe(e,t),Lr("tildes",e),e=Uqe(e,t),Lr("xrange",e),e=Vqe(e,t),Lr("stars",e),e),Ta=e=>!e||e.toLowerCase()==="x"||e==="*",Lqe=(e,t)=>e.trim().split(/\s+/).map(n=>Bqe(n,t)).join(" "),Bqe=(e,t)=>{const n=t.loose?Xi[$i.TILDELOOSE]:Xi[$i.TILDE];return e.replace(n,(r,i,a,o,s)=>{Lr("tilde",e,r,i,a,o,s);let u;return Ta(i)?u="":Ta(a)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:Ta(o)?u=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:s?(Lr("replaceTilde pr",s),u=`>=${i}.${a}.${o}-${s} <${i}.${+a+1}.0-0`):u=`>=${i}.${a}.${o} <${i}.${+a+1}.0-0`,Lr("tilde return",u),u})},zqe=(e,t)=>e.trim().split(/\s+/).map(n=>jqe(n,t)).join(" "),jqe=(e,t)=>{Lr("caret",e,t);const n=t.loose?Xi[$i.CARETLOOSE]:Xi[$i.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,a,o,s,u)=>{Lr("caret",e,i,a,o,s,u);let l;return Ta(a)?l="":Ta(o)?l=`>=${a}.0.0${r} <${+a+1}.0.0-0`:Ta(s)?a==="0"?l=`>=${a}.${o}.0${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.0${r} <${+a+1}.0.0-0`:u?(Lr("replaceCaret pr",u),a==="0"?o==="0"?l=`>=${a}.${o}.${s}-${u} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}-${u} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s}-${u} <${+a+1}.0.0-0`):(Lr("no pr"),a==="0"?o==="0"?l=`>=${a}.${o}.${s}${r} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s} <${+a+1}.0.0-0`),Lr("caret return",l),l})},Uqe=(e,t)=>(Lr("replaceXRanges",e,t),e.split(/\s+/).map(n=>Wqe(n,t)).join(" ")),Wqe=(e,t)=>{e=e.trim();const n=t.loose?Xi[$i.XRANGELOOSE]:Xi[$i.XRANGE];return e.replace(n,(r,i,a,o,s,u)=>{Lr("xRange",e,r,i,a,o,s,u);const l=Ta(a),c=l||Ta(o),f=c||Ta(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(o=0),s=0,i===">"?(i=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):i==="<="&&(i="<",c?a=+a+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:f&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),Lr("xRange return",r),r})},Vqe=(e,t)=>(Lr("replaceStars",e,t),e.trim().replace(Xi[$i.STAR],"")),qqe=(e,t)=>(Lr("replaceGTE0",e,t),e.trim().replace(Xi[t.includePrerelease?$i.GTE0PRE:$i.GTE0],"")),Hqe=e=>(t,n,r,i,a,o,s,u,l,c,f,d,h)=>(Ta(r)?n="":Ta(i)?n=`>=${r}.0.0${e?"-0":""}`:Ta(a)?n=`>=${r}.${i}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Ta(l)?u="":Ta(c)?u=`<${+l+1}.0.0-0`:Ta(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),Gqe=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(Lr(e[r].semver),e[r].semver!==fL.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},p1=Symbol("SemVer ANY");class BA{static get ANY(){return p1}constructor(t,n){if(n=Kqe(n),t instanceof BA){if(t.loose===!!n.loose)return t;t=t.value}hL("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===p1?this.value="":this.value=this.operator+this.semver.version,hL("comp",this)}parse(t){const n=this.options.loose?ire[are.COMPARATORLOOSE]:ire[are.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new ore(r[2],this.options.loose):this.semver=p1}toString(){return this.value}test(t){if(hL("Comparator.test",t,this.options.loose),this.semver===p1||t===p1)return!0;if(typeof t=="string")try{t=new ore(t,this.options)}catch(n){return!1}return dL(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof BA))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new sre(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new sre(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),a=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=dL(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=dL(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||s||u}}var zA=BA;const Kqe=DA,{re:ire,t:are}=Yf.exports,dL=Zne,hL=NA,ore=ka,sre=ru,Xqe=ru,Yqe=(e,t,n)=>{try{t=new Xqe(t,n)}catch(r){return!1}return t.test(e)};var jA=Yqe;const Zqe=ru,Jqe=(e,t)=>new Zqe(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var Qqe=Jqe;const eHe=ka,tHe=ru,nHe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new tHe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new eHe(r,n))}),r};var rHe=nHe;const iHe=ka,aHe=ru,oHe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new aHe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new iHe(r,n))}),r};var sHe=oHe;const pL=ka,uHe=ru,ure=MA,lHe=(e,t)=>{e=new uHe(e,t);let n=new pL("0.0.0");if(e.test(n)||(n=new pL("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let a=null;i.forEach(o=>{const s=new pL(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||ure(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!n||ure(n,a))&&(n=a)}return n&&e.test(n)?n:null};var cHe=lHe;const fHe=ru,dHe=(e,t)=>{try{return new fHe(e,t).range||"*"}catch(n){return null}};var hHe=dHe;const pHe=ka,lre=zA,{ANY:gHe}=lre,mHe=ru,vHe=jA,cre=MA,fre=oL,yHe=uL,bHe=sL,xHe=(e,t,n,r)=>{e=new pHe(e,r),t=new mHe(t,r);let i,a,o,s,u;switch(n){case">":i=cre,a=yHe,o=fre,s=">",u=">=";break;case"<":i=fre,a=bHe,o=cre,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(vHe(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===gHe&&(h=new lre(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:o(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var gL=xHe;const wHe=gL,_He=(e,t,n)=>wHe(e,t,">",n);var SHe=_He;const EHe=gL,AHe=(e,t,n)=>EHe(e,t,"<",n);var CHe=AHe;const dre=ru,kHe=(e,t,n)=>(e=new dre(e,n),t=new dre(t,n),e.intersects(t));var THe=kHe;const OHe=jA,IHe=tu;var NHe=(e,t,n)=>{const r=[];let i=null,a=null;const o=e.sort((c,f)=>IHe(c,f,n));for(const c of o)OHe(c,t,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const hre=ru,UA=zA,{ANY:mL}=UA,g1=jA,vL=tu,DHe=(e,t,n={})=>{if(e===t)return!0;e=new hre(e,n),t=new hre(t,n);let r=!1;e:for(const i of e.set){for(const a of t.set){const o=RHe(i,a,n);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},RHe=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===mL){if(t.length===1&&t[0].semver===mL)return!0;n.includePrerelease?e=[new UA(">=0.0.0-0")]:e=[new UA(">=0.0.0")]}if(t.length===1&&t[0].semver===mL){if(n.includePrerelease)return!0;t=[new UA(">=0.0.0")]}const r=new Set;let i,a;for(const h of e)h.operator===">"||h.operator===">="?i=pre(i,h,n):h.operator==="<"||h.operator==="<="?a=gre(a,h,n):r.add(h.semver);if(r.size>1)return null;let o;if(i&&a){if(o=vL(i.semver,a.semver,n),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!g1(h,String(i),n)||a&&!g1(h,String(a),n))return null;for(const p of t)if(!g1(h,String(p),n))return!1;return!0}let s,u,l,c,f=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=pre(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!g1(i.semver,String(h),n))return!1}if(a){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=gre(a,h,n),u===h&&u!==a)return!1}else if(a.operator==="<="&&!g1(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&o!==0)return!1}return!(i&&l&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},pre=(e,t,n)=>{if(!e)return t;const r=vL(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},gre=(e,t,n)=>{if(!e)return t;const r=vL(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var FHe=DHe;const yL=Yf.exports;var mre={re:yL.re,src:yL.src,tokens:yL.t,SEMVER_SPEC_VERSION:IA.SEMVER_SPEC_VERSION,SemVer:ka,compareIdentifiers:rL.compareIdentifiers,rcompareIdentifiers:rL.rcompareIdentifiers,parse:fv,valid:mVe,clean:bVe,inc:_Ve,diff:TVe,major:NVe,minor:FVe,patch:$Ve,prerelease:zVe,compare:tu,rcompare:WVe,compareLoose:HVe,compareBuild:aL,sort:YVe,rsort:QVe,gt:MA,lt:oL,eq:iL,neq:Yne,gte:sL,lte:uL,cmp:Zne,coerce:xqe,Comparator:zA,Range:ru,satisfies:jA,toComparators:Qqe,maxSatisfying:rHe,minSatisfying:sHe,minVersion:cHe,validRange:hHe,outside:gL,gtr:SHe,ltr:CHe,intersects:THe,simplifyRange:NHe,subset:FHe};function io(e,t,n){return e.fields=t||[],e.fname=n,e}function Nr(e){return e==null?null:e.fname}function Yi(e){return e==null?null:e.fields}function vre(e){return e.length===1?MHe(e[0]):PHe(e)}const MHe=e=>function(t){return t[e]},PHe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Se(e){throw Error(e)}function WA(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||Se("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&Se("Access path missing closing bracket: "+e),r&&Se("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function ao(e,t,n){const r=WA(e);return e=r.length===1?r[0]:e,io((n&&n.get||vre)(r),[e],t||e)}const m1=ao("id"),Oa=io(e=>e,[],"identity"),Zf=io(()=>0,[],"zero"),pv=io(()=>1,[],"one"),fs=io(()=>!0,[],"true"),Jf=io(()=>!1,[],"false");function VA(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const yre=0,bL=1,bre=2,xre=3,wre=4;function _re(e,t){let n=e||yre;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=bL&&VA(t||"error","ERROR",arguments),this},warn(){return n>=bre&&VA(t||"warn","WARN",arguments),this},info(){return n>=xre&&VA(t||"log","INFO",arguments),this},debug(){return n>=wre&&VA(t||"log","DEBUG",arguments),this}}}var ut=Array.isArray;function Nt(e){return e===Object(e)}const Sre=e=>e!=="__proto__";function qA(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=$He(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;HA(t,r,n[r],i)}return t},{})}function HA(e,t,n,r){if(!Sre(t))return;let i,a;if(Nt(n)&&!ut(n)){a=Nt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?HA(a,i,n[i]):Sre(i)&&(a[i]=n[i])}else e[t]=n}function $He(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function sn(e){return e[e.length-1]}function Zi(e){return e==null||e===""?null:+e}const Ere=e=>t=>e*Math.exp(t),Are=e=>t=>Math.log(e*t),Cre=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),kre=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,GA=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function KA(e,t,n,r){const i=n(e[0]),a=n(sn(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Tre(e,t){return KA(e,t,Zi,Oa)}function Ore(e,t){var n=Math.sign(e[0]);return KA(e,t,Are(n),Ere(n))}function Ire(e,t,n){return KA(e,t,GA(n),GA(1/n))}function Nre(e,t,n){return KA(e,t,Cre(n),kre(n))}function XA(e,t,n,r,i){const a=r(e[0]),o=r(sn(e)),s=t!=null?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function xL(e,t,n){return XA(e,t,n,Zi,Oa)}function wL(e,t,n){const r=Math.sign(e[0]);return XA(e,t,n,Are(r),Ere(r))}function YA(e,t,n,r){return XA(e,t,n,GA(r),GA(1/r))}function _L(e,t,n,r){return XA(e,t,n,Cre(r),kre(r))}function Dre(e){return 1+~~(new Date(e).getMonth()/3)}function Rre(e){return 1+~~(new Date(e).getUTCMonth()/3)}function wt(e){return e!=null?ut(e)?e:[e]:[]}function Fre(e,t,n){let r=e[0],i=e[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Lt(e){return typeof e=="function"}const LHe="descending";function SL(e,t,n){n=n||{},t=wt(t)||[];const r=[],i=[],a={},o=n.comparator||BHe;return wt(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===LHe?-1:1),i.push(s=Lt(s)?s:ao(s,null,n)),(Yi(s)||[]).forEach(l=>a[l]=1))}),i.length===0?null:io(o(i,r),Object.keys(a))}const ZA=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),BHe=(e,t)=>e.length===1?zHe(e[0],t[0]):jHe(e,t,e.length),zHe=(e,t)=>function(n,r){return ZA(e(n),e(r))*t},jHe=(e,t,n)=>(t.push(0),function(r,i){let a,o=0,s=-1;for(;o===0&&++s<n;)a=e[s],o=ZA(a(r),a(i));return o*t[s]});function Ji(e){return Lt(e)?e:()=>e}function EL(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Rt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function nl(e,t){let n=0,r,i,a,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(a=o=i;n<r;++n)i=e[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(a=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Mre(e,t){const n=e.length;let r=-1,i,a,o,s,u;if(t==null){for(;++r<n;)if(a=e[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=e[r],a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}else{for(;++r<n;)if(a=t(e[r],r,e),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=t(e[r],r,e),a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}return[s,u]}const UHe=Object.prototype.hasOwnProperty;function _t(e,t){return UHe.call(e,t)}const JA={};function gv(e){let t={},n;function r(a){return _t(t,a)&&t[a]!==JA}const i={size:0,empty:0,object:t,has:r,get(a){return r(a)?t[a]:void 0},set(a,o){return r(a)||(++i.size,t[a]===JA&&--i.empty),t[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,t[a]=JA),this},clear(){i.size=i.empty=0,i.object=t={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const s in t){const u=t[s];u!==JA&&(!n||!n(u))&&(a[s]=u,++o)}i.size=o,i.empty=0,i.object=t=a}};return e&&Object.keys(e).forEach(a=>{i.set(a,e[a])}),i}function Pre(e,t,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let s=e[0],u=sn(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:a}function $e(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Rt(r,n)}function mv(e,t,n,r){let i=t[0],a=t[t.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=a:e<a)}function AL(e){return typeof e=="boolean"}function Qf(e){return Object.prototype.toString.call(e)==="[object Date]"}function $re(e){return e&&Lt(e[Symbol.iterator])}function ed(e){return typeof e=="number"}function Lre(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Bn(e){return typeof e=="string"}function CL(e,t,n){e&&(e=t?wt(e).map(s=>s.replace(/\\(.)/g,"$1")):wt(e));const r=e&&e.length,i=n&&n.get||vre,a=s=>i(t?[s]:WA(s));let o;if(!r)o=function(){return""};else if(r===1){const s=a(e[0]);o=function(u){return""+s(u)}}else{const s=e.map(a);o=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return io(o,e,"key")}function Bre(e,t){const n=e[0],r=sn(e),i=+t;return i?i===1?r:n+i*(r-n):n}const WHe=1e4;function zre(e){e=+e||WHe;let t,n,r;const i=()=>{t={},n={},r=0},a=(o,s)=>(++r>e&&(n=t,t={},r=1),t[o]=s);return i(),{clear:i,has:o=>_t(t,o)||_t(n,o),get:o=>_t(t,o)?t[o]:_t(n,o)?a(o,n[o]):void 0,set:(o,s)=>_t(t,o)?t[o]=s:a(o,s)}}function jre(e,t,n,r){const i=t.length,a=n.length;if(!a)return t;if(!i)return n;const o=r||new t.constructor(i+a);let s=0,u=0,l=0;for(;s<i&&u<a;++l)o[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)o[l]=t[s];for(;u<a;++u,++l)o[l]=n[u];return o}function v1(e,t){let n="";for(;--t>=0;)n+=e;return n}function Ure(e,t,n,r){const i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?v1(i,o)+a:r==="center"?v1(i,~~(o/2))+a+v1(i,Math.ceil(o/2)):a+v1(i,o)}function y1(e){return e&&sn(e)-e[0]||0}function gt(e){return ut(e)?"["+e.map(gt)+"]":Nt(e)||Bn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function kL(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const VHe=e=>ed(e)||Qf(e)?e:Date.parse(e);function TL(e,t){return t=t||VHe,e==null||e===""?null:t(e)}function OL(e){return e==null||e===""?null:e+""}function iu(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Wre(e,t,n,r){const i=r??"\u2026",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-s):n==="center"?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function td(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const a=t(e[i]);a&&n(a,i,e)}}else e.forEach(n)}const qHe=/^([A-Za-z]+:)?\/\//,HHe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,GHe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Vre="file://";function KHe(e,t){return n=>({options:n||{},sanitize:YHe,load:XHe,fileAccess:!!t,file:ZHe(t),http:QHe(e)})}async function XHe(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function YHe(e,t){t=Rt({},this.options,t);const n=this.fileAccess,r={href:null};let i,a,o;const s=HHe.test(e.replace(GHe,""));(e==null||typeof e!="string"||!s)&&Se("Sanitize failure, invalid URI: "+gt(e));const u=qHe.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&o[o.length-1]!=="/"&&(e="/"+e),e=o+e),a=(i=e.startsWith(Vre))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(Vre.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!a}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function ZHe(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,a)=>{i?r(i):n(a)})}):JHe}async function JHe(){Se("No file system access.")}function QHe(e){return e?async function(t,n){const r=Rt({},this.options.http,n),i=n&&n.response,a=await e(t,r);return a.ok?Lt(a[i])?a[i]():a.text():Se(a.status+""+a.statusText)}:eGe}async function eGe(){Se("No HTTP fetch method available.")}const tGe=e=>e!=null&&e===e,nGe=e=>e==="true"||e==="false"||e===!0||e===!1,rGe=e=>!Number.isNaN(Date.parse(e)),qre=e=>!Number.isNaN(+e)&&!(e instanceof Date),iGe=e=>qre(e)&&Number.isInteger(+e),IL={boolean:kL,integer:Zi,number:Zi,date:TL,string:OL,unknown:Oa},QA=[nGe,iGe,qre,rGe],aGe=["boolean","integer","number","date"];function Hre(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=QA.length,i=QA.map((a,o)=>o+1);for(let a=0,o=0,s,u;a<n;++a)for(u=t?e[a][t]:e[a],s=0;s<r;++s)if(i[s]&&tGe(u)&&!QA[s](u)&&(i[s]=0,++o,o===QA.length))return"string";return aGe[i.reduce((a,o)=>a===0?o:a,0)-1]}function Gre(e,t){return t.reduce((n,r)=>(n[r]=Hre(e,r),n),{})}var Kre={},NL={},DL=34,b1=10,RL=13;function Xre(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function oGe(e,t){var n=Xre(e);return function(r,i){return t(n(r),i,e)}}function Yre(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function oo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function sGe(e){return e<0?"-"+oo(-e,6):e>9999?"+"+oo(e,6):oo(e,4)}function uGe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":sGe(e.getUTCFullYear())+"-"+oo(e.getUTCMonth()+1,2)+"-"+oo(e.getUTCDate(),2)+(i?"T"+oo(t,2)+":"+oo(n,2)+":"+oo(r,2)+"."+oo(i,3)+"Z":r?"T"+oo(t,2)+":"+oo(n,2)+":"+oo(r,2)+"Z":n||t?"T"+oo(t,2)+":"+oo(n,2)+"Z":"")}function lGe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?oGe(m,d):Xre(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===b1&&--p,f.charCodeAt(p-1)===RL&&--p;function x(){if(y)return NL;if(b)return b=!1,Kre;var S,A=g,_;if(f.charCodeAt(A)===DL){for(;g++<p&&f.charCodeAt(g)!==DL||f.charCodeAt(++g)===DL;);return(S=g)>=p?y=!0:(_=f.charCodeAt(g++))===b1?b=!0:_===RL&&(b=!0,f.charCodeAt(g)===b1&&++g),f.slice(A+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===b1)b=!0;else if(_===RL)b=!0,f.charCodeAt(g)===b1&&++g;else if(_!==n)continue;return f.slice(A,S)}return y=!0,f.slice(A,p)}for(;(v=x())!==NL;){for(var w=[];v!==Kre&&v!==NL;)w.push(v),v=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function a(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=Yre(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=Yre(f)),a(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?uGe(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function Zre(e){const t=function(n,r){const i={delimiter:e};return FL(n,r?Rt(r,i):i)};return t.responseType="text",t}function FL(e,t){return t.header&&(e=t.header.map(gt).join(t.delimiter)+`
`+e),lGe(t.delimiter).parse(e+"")}FL.responseType="text";function cGe(e){return typeof Buffer=="function"&&Lt(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function ML(e,t){const n=t&&t.property?ao(t.property):Oa;return Nt(e)&&!cGe(e)?fGe(n(e),t):n(JSON.parse(e))}ML.responseType="json";function fGe(e,t){return!ut(e)&&$re(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function dGe(e){return e}function hGe(e){if(e==null)return dGe;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+a,f[1]=(n+=s[1])*i+o;l<c;)f[l]=s[l],++l;return f}}function pGe(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function gGe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Jre(e,n)})}:Jre(e,t)}function Jre(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=Qre(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function Qre(e,t){var n=hGe(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&pGe(f,p)}function a(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function mGe(e,t){var n={},r={},i={},a=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),a.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function vGe(e){return Qre(e,yGe.apply(this,arguments))}function yGe(e,t,n){var r,i,a;if(arguments.length>1)r=bGe(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:mGe(e,r)}}function bGe(e,t,n){var r=[],i=[],a;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:a})}function s(f){f.forEach(o)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(a=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}const xGe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function eie(e,t){let n,r,i,a;return e=ML(e,t),t&&t.feature?(n=gGe,i=t.feature):t&&t.mesh?(n=vGe,i=t.mesh,a=xGe[t.filter]):Se("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,a):Se("Invalid TopoJSON object: "+i),r&&r.features||[r]}eie.responseType="json";const eC={dsv:FL,csv:Zre(","),tsv:Zre("	"),json:ML,topojson:eie};function PL(e,t){return arguments.length>1?(eC[e]=t,this):_t(eC,e)?eC[e]:null}function tie(e){const t=PL(e);return t&&t.responseType||"text"}function vv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function x1(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=wGe(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function wGe(e){return(t,n)=>vv(e(t),n)}function nie(e){return e===null?NaN:+e}function*_Ge(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const rie=x1(vv),tC=rie.right,SGe=rie.left;x1(nie).center;var w1=tC;function EGe(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function AGe(e,t){const n=EGe(e,t);return n&&Math.sqrt(n)}class Ia{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function CGe(e,t){return Array.from(t,n=>e[n])}var $L=Math.sqrt(50),LL=Math.sqrt(10),BL=Math.sqrt(2);function zL(e,t,n){var r,i=-1,a,o,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(s=iie(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)/s}return r&&o.reverse(),o}function iie(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=$L?10:a>=LL?5:a>=BL?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=$L?10:a>=LL?5:a>=BL?2:1)}function nd(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=$L?i*=10:a>=LL?i*=5:a>=BL&&(i*=2),t<e?-i:i}function gp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function jL(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function aie(e,t,n=0,r=e.length-1,i=vv){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));aie(e,t,h,p,i)}const a=e[t];let o=n,s=r;for(_1(e,n,t),i(e[r],a)>0&&_1(e,n,r);o<s;){for(_1(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?_1(e,n,s):(++s,_1(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function _1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function UL(e,t,n){if(e=Float64Array.from(_Ge(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return jL(e);if(t>=1)return gp(e);var r,i=(r-1)*t,a=Math.floor(i),o=gp(aie(e,a).subarray(0,a+1)),s=jL(e.subarray(a+1));return o+(s-o)*(i-a)}}function oie(e,t,n=nie){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function kGe(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function sie(e,t){return UL(e,.5,t)}function*TGe(e){for(const t of e)yield*t}function uie(e){return Array.from(TGe(e))}function jo(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function lie(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function OGe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function nC(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function yv(e){return e=nC(Math.abs(e)),e?e[1]:NaN}function IGe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function NGe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var DGe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function S1(e){if(!(t=DGe.exec(e)))throw new Error("invalid format: "+e);var t;return new WL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}S1.prototype=WL.prototype;function WL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}WL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function RGe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var cie;function FGe(e,t){var n=nC(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(cie=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+nC(e,Math.max(0,t+a-1))[0]}function fie(e,t){var n=nC(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var die={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:OGe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>fie(e*100,t),r:fie,s:FGe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hie(e){return e}var pie=Array.prototype.map,gie=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function mie(e){var t=e.grouping===void 0||e.thousands===void 0?hie:IGe(pie.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?hie:NGe(pie.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=S1(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):die[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",A=g==="$"?r:/[%p]/.test(w)?o:"",_=die[w],E=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(k){var T=S,I=A,N,O,D;if(w==="c")I=_(k)+I,k="";else{k=+k;var L=k<0||1/k<0;if(k=isNaN(k)?u:_(Math.abs(k),b),x&&(k=RGe(k)),L&&+k==0&&p!=="+"&&(L=!1),T=(L?p==="("?p:s:p==="-"||p==="("?"":p)+T,I=(w==="s"?gie[8+cie/3]:"")+I+(L&&p==="("?")":""),E){for(N=-1,O=k.length;++N<O;)if(D=k.charCodeAt(N),48>D||D>57){I=(D===46?i+k.slice(N+1):k.slice(N))+I,k=k.slice(0,N);break}}}y&&!m&&(k=t(k,1/0));var W=T.length+k.length+I.length,G=W<v?new Array(v-W+1).join(d):"";switch(y&&m&&(k=t(G+k,G.length?v-I.length:1/0),G=""),h){case"<":k=T+k+I+G;break;case"=":k=T+G+k+I;break;case"^":k=G.slice(0,W=G.length>>1)+T+k+I+G.slice(W);break;default:k=G+T+k+I;break}return a(k)}return C.toString=function(){return f+""},C}function c(f,d){var h=l((f=S1(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(yv(d)/3)))*3,g=Math.pow(10,-p),m=gie[8+p/3];return function(v){return h(g*v)+m}}return{format:l,formatPrefix:c}}var rC,vie,yie;MGe({thousands:",",grouping:[3],currency:["$",""]});function MGe(e){return rC=mie(e),vie=rC.format,yie=rC.formatPrefix,rC}function PGe(e){return Math.max(0,-yv(Math.abs(e)))}function $Ge(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yv(t)/3)))*3-yv(Math.abs(e)))}function LGe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,yv(t)-yv(e))+1}var VL=new Date,qL=new Date;function wi(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return wi(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},n&&(i.count=function(a,o){return VL.setTime(+a),qL.setTime(+o),e(VL),e(qL),Math.floor(n(VL,qL))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a==0}:function(o){return i.count(0,o)%a==0}):i}),i}var HL=wi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});HL.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?wi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):HL};var GL=HL;const Sc=1e3,ds=Sc*60,Ec=ds*60,mp=Ec*24,KL=mp*7,bie=mp*30,XL=mp*365;var BGe=wi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Sc)},function(e,t){return(t-e)/Sc},function(e){return e.getUTCSeconds()}),rd=BGe,zGe=wi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sc)},function(e,t){e.setTime(+e+t*ds)},function(e,t){return(t-e)/ds},function(e){return e.getMinutes()}),YL=zGe,jGe=wi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sc-e.getMinutes()*ds)},function(e,t){e.setTime(+e+t*Ec)},function(e,t){return(t-e)/Ec},function(e){return e.getHours()}),ZL=jGe,UGe=wi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ds)/mp,e=>e.getDate()-1),id=UGe;function vp(e){return wi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ds)/KL})}var E1=vp(0),JL=vp(1);vp(2),vp(3);var A1=vp(4);vp(5),vp(6);var WGe=wi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),iC=WGe,xie=wi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});xie.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:wi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var ad=xie,VGe=wi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ds)},function(e,t){return(t-e)/ds},function(e){return e.getUTCMinutes()}),QL=VGe,qGe=wi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Ec)},function(e,t){return(t-e)/Ec},function(e){return e.getUTCHours()}),e4=qGe,HGe=wi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/mp},function(e){return e.getUTCDate()-1}),od=HGe;function yp(e){return wi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/KL})}var C1=yp(0),t4=yp(1);yp(2),yp(3);var k1=yp(4);yp(5),yp(6);var GGe=wi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),aC=GGe,wie=wi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});wie.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:wi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var sd=wie;function _ie(e,t,n,r,i,a){const o=[[rd,1,Sc],[rd,5,5*Sc],[rd,15,15*Sc],[rd,30,30*Sc],[a,1,ds],[a,5,5*ds],[a,15,15*ds],[a,30,30*ds],[i,1,Ec],[i,3,3*Ec],[i,6,6*Ec],[i,12,12*Ec],[r,1,mp],[r,2,2*mp],[n,1,KL],[t,1,bie],[t,3,3*bie],[e,1,XL]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=x1(([,,m])=>m).right(o,d);if(h===o.length)return e.every(nd(l/XL,c/XL,f));if(h===0)return GL.every(Math.max(nd(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[s,u]}const[KGe,XGe]=_ie(sd,aC,C1,od,e4,QL),[YGe,ZGe]=_ie(ad,iC,E1,id,ZL,YL),Li="year",so="quarter",Qi="month",ui="week",uo="date",ea="day",rl="dayofyear",Uo="hours",Wo="minutes",hs="seconds",au="milliseconds",n4=[Li,so,Qi,ui,uo,ea,rl,Uo,Wo,hs,au],r4=n4.reduce((e,t,n)=>(e[t]=1+n,e),{});function i4(e){const t=wt(e).slice(),n={};return t.length||Se("Missing time unit."),t.forEach(i=>{_t(r4,i)?n[i]=1:Se("Invalid time unit: ".concat(i,"."))}),(n[ui]||n[ea]?1:0)+(n[so]||n[Qi]||n[uo]?1:0)+(n[rl]?1:0)>1&&Se("Incompatible time units: ".concat(e)),t.sort((i,a)=>r4[i]-r4[a]),t}const JGe={[Li]:"%Y ",[so]:"Q%q ",[Qi]:"%b ",[uo]:"%d ",[ui]:"W%U ",[ea]:"%a ",[rl]:"%j ",[Uo]:"%H:00",[Wo]:"00:%M",[hs]:":%S",[au]:".%L",["".concat(Li,"-").concat(Qi)]:"%Y-%m ",["".concat(Li,"-").concat(Qi,"-").concat(uo)]:"%Y-%m-%d ",["".concat(Uo,"-").concat(Wo)]:"%H:%M"};function Sie(e,t){const n=Rt({},JGe,t),r=i4(e),i=r.length;let a="",o=0,s,u;for(o=0;o<i;)for(s=r.length;s>o;--s)if(u=r.slice(o,s).join("-"),n[u]!=null){a+=n[u],o=s;break}return a.trim()}const bp=new Date;function a4(e){return bp.setFullYear(e),bp.setMonth(0),bp.setDate(1),bp.setHours(0,0,0,0),bp}function Eie(e){return Cie(new Date(e))}function Aie(e){return o4(new Date(e))}function Cie(e){return id.count(a4(e.getFullYear())-1,e)}function o4(e){return E1.count(a4(e.getFullYear())-1,e)}function s4(e){return a4(e).getDay()}function QGe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,a,o);return s.setFullYear(e),s}return new Date(e,t,n,r,i,a,o)}function kie(e){return Oie(new Date(e))}function Tie(e){return u4(new Date(e))}function Oie(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return od.count(t-1,e)}function u4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return C1.count(t-1,e)}function l4(e){return bp.setTime(Date.UTC(e,0,1)),bp.getUTCDay()}function eKe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,a,o));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Iie(e,t,n,r,i){const a=t||1,o=sn(e),s=(v,y,b)=>(b=b||v,tKe(n[b],r[b],v===o&&a,y)),u=new Date,l=iu(e),c=l[Li]?s(Li):Ji(2012),f=l[Qi]?s(Qi):l[so]?s(so):Zf,d=l[ui]&&l[ea]?s(ea,1,ui+ea):l[ui]?s(ui,1):l[ea]?s(ea,1):l[uo]?s(uo,1):l[rl]?s(rl,1):pv,h=l[Uo]?s(Uo):Zf,p=l[Wo]?s(Wo):Zf,g=l[hs]?s(hs):Zf,m=l[au]?s(au):Zf;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function tKe(e,t,n,r){const i=n<=1?e:r?(a,o)=>r+n*Math.floor((e(a,o)-r)/n):(a,o)=>n*Math.floor(e(a,o)/n);return t?(a,o)=>t(i(a,o),o):i}function bv(e,t,n){return t+e*7-(n+6)%7}const nKe={[Li]:e=>e.getFullYear(),[so]:e=>Math.floor(e.getMonth()/3),[Qi]:e=>e.getMonth(),[uo]:e=>e.getDate(),[Uo]:e=>e.getHours(),[Wo]:e=>e.getMinutes(),[hs]:e=>e.getSeconds(),[au]:e=>e.getMilliseconds(),[rl]:e=>Cie(e),[ui]:e=>o4(e),[ui+ea]:(e,t)=>bv(o4(e),e.getDay(),s4(t)),[ea]:(e,t)=>bv(1,e.getDay(),s4(t))},rKe={[so]:e=>3*e,[ui]:(e,t)=>bv(e,0,s4(t))};function Nie(e,t){return Iie(e,t||1,nKe,rKe,QGe)}const iKe={[Li]:e=>e.getUTCFullYear(),[so]:e=>Math.floor(e.getUTCMonth()/3),[Qi]:e=>e.getUTCMonth(),[uo]:e=>e.getUTCDate(),[Uo]:e=>e.getUTCHours(),[Wo]:e=>e.getUTCMinutes(),[hs]:e=>e.getUTCSeconds(),[au]:e=>e.getUTCMilliseconds(),[rl]:e=>Oie(e),[ui]:e=>u4(e),[ea]:(e,t)=>bv(1,e.getUTCDay(),l4(t)),[ui+ea]:(e,t)=>bv(u4(e),e.getUTCDay(),l4(t))},aKe={[so]:e=>3*e,[ui]:(e,t)=>bv(e,0,l4(t))};function Die(e,t){return Iie(e,t||1,iKe,aKe,eKe)}const oKe={[Li]:ad,[so]:iC.every(3),[Qi]:iC,[ui]:E1,[uo]:id,[ea]:id,[rl]:id,[Uo]:ZL,[Wo]:YL,[hs]:rd,[au]:GL},sKe={[Li]:sd,[so]:aC.every(3),[Qi]:aC,[ui]:C1,[uo]:od,[ea]:od,[rl]:od,[Uo]:e4,[Wo]:QL,[hs]:rd,[au]:GL};function xv(e){return oKe[e]}function wv(e){return sKe[e]}function Rie(e,t,n){return e?e.offset(t,n):void 0}function Fie(e,t,n){return Rie(xv(e),t,n)}function Mie(e,t,n){return Rie(wv(e),t,n)}function Pie(e,t,n,r){return e?e.range(t,n,r):void 0}function $ie(e,t,n,r){return Pie(xv(e),t,n,r)}function Lie(e,t,n,r){return Pie(wv(e),t,n,r)}const T1=1e3,O1=T1*60,I1=O1*60,oC=I1*24,uKe=oC*7,Bie=oC*30,c4=oC*365,zie=[Li,Qi,uo,Uo,Wo,hs,au],N1=zie.slice(0,-1),D1=N1.slice(0,-1),R1=D1.slice(0,-1),lKe=R1.slice(0,-1),cKe=[Li,ui],jie=[Li,Qi],Uie=[Li],F1=[[N1,1,T1],[N1,5,5*T1],[N1,15,15*T1],[N1,30,30*T1],[D1,1,O1],[D1,5,5*O1],[D1,15,15*O1],[D1,30,30*O1],[R1,1,I1],[R1,3,3*I1],[R1,6,6*I1],[R1,12,12*I1],[lKe,1,oC],[cKe,1,uKe],[jie,1,Bie],[jie,3,3*Bie],[Uie,1,c4]];function Wie(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(y1(t))/n;let i=x1(s=>s[2]).right(F1,r),a,o;return i===F1.length?(a=Uie,o=nd(t[0]/c4,t[1]/c4,n)):i?(i=F1[r/F1[i-1][2]<F1[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=zie,o=Math.max(nd(t[0],t[1],n),1)),{units:a,step:o}}function f4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function d4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function M1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Vie(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=P1(i),c=$1(i),f=P1(a),d=$1(a),h=P1(o),p=$1(o),g=P1(s),m=$1(s),v=P1(u),y=$1(u),b={a:L,A:W,b:G,B:K,c:null,d:Yie,e:Yie,f:RKe,g:WKe,G:qKe,H:IKe,I:NKe,j:DKe,L:Zie,m:FKe,M:MKe,p:ee,q:ce,Q:rae,s:iae,S:PKe,u:$Ke,U:LKe,V:BKe,w:zKe,W:jKe,x:null,X:null,y:UKe,Y:VKe,Z:HKe,"%":nae},x={a:he,A:Oe,b:Te,B:Re,c:null,d:Qie,e:Qie,f:YKe,g:oXe,G:uXe,H:GKe,I:KKe,j:XKe,L:eae,m:ZKe,M:JKe,p:me,q:P,Q:rae,s:iae,S:QKe,u:eXe,U:tXe,V:nXe,w:rXe,W:iXe,x:null,X:null,y:aXe,Y:sXe,Z:lXe,"%":nae},w={a:C,A:k,b:T,B:I,c:N,d:Kie,e:Kie,f:CKe,g:Gie,G:Hie,H:Xie,I:Xie,j:_Ke,L:AKe,m:wKe,M:SKe,p:E,q:xKe,Q:TKe,s:OKe,S:EKe,u:gKe,U:mKe,V:vKe,w:pKe,W:yKe,x:O,X:D,y:Gie,Y:Hie,Z:bKe,"%":kKe};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(F,V){return function(ae){var Y=[],M=-1,B=0,R=F.length,X,ge,xe;for(ae instanceof Date||(ae=new Date(+ae));++M<R;)F.charCodeAt(M)===37&&(Y.push(F.slice(B,M)),(ge=qie[X=F.charAt(++M)])!=null?X=F.charAt(++M):ge=X==="e"?" ":"0",(xe=V[X])&&(X=xe(ae,ge)),Y.push(X),B=M+1);return Y.push(F.slice(B,M)),Y.join("")}}function A(F,V){return function(ae){var Y=M1(1900,void 0,1),M=_(Y,F,ae+="",0),B,R;if(M!=ae.length)return null;if("Q"in Y)return new Date(Y.Q);if("s"in Y)return new Date(Y.s*1e3+("L"in Y?Y.L:0));if(V&&!("Z"in Y)&&(Y.Z=0),"p"in Y&&(Y.H=Y.H%12+Y.p*12),Y.m===void 0&&(Y.m="q"in Y?Y.q:0),"V"in Y){if(Y.V<1||Y.V>53)return null;"w"in Y||(Y.w=1),"Z"in Y?(B=d4(M1(Y.y,0,1)),R=B.getUTCDay(),B=R>4||R===0?t4.ceil(B):t4(B),B=od.offset(B,(Y.V-1)*7),Y.y=B.getUTCFullYear(),Y.m=B.getUTCMonth(),Y.d=B.getUTCDate()+(Y.w+6)%7):(B=f4(M1(Y.y,0,1)),R=B.getDay(),B=R>4||R===0?JL.ceil(B):JL(B),B=id.offset(B,(Y.V-1)*7),Y.y=B.getFullYear(),Y.m=B.getMonth(),Y.d=B.getDate()+(Y.w+6)%7)}else("W"in Y||"U"in Y)&&("w"in Y||(Y.w="u"in Y?Y.u%7:"W"in Y?1:0),R="Z"in Y?d4(M1(Y.y,0,1)).getUTCDay():f4(M1(Y.y,0,1)).getDay(),Y.m=0,Y.d="W"in Y?(Y.w+6)%7+Y.W*7-(R+5)%7:Y.w+Y.U*7-(R+6)%7);return"Z"in Y?(Y.H+=Y.Z/100|0,Y.M+=Y.Z%100,d4(Y)):f4(Y)}}function _(F,V,ae,Y){for(var M=0,B=V.length,R=ae.length,X,ge;M<B;){if(Y>=R)return-1;if(X=V.charCodeAt(M++),X===37){if(X=V.charAt(M++),ge=w[X in qie?V.charAt(M++):X],!ge||(Y=ge(F,ae,Y))<0)return-1}else if(X!=ae.charCodeAt(Y++))return-1}return Y}function E(F,V,ae){var Y=l.exec(V.slice(ae));return Y?(F.p=c.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function C(F,V,ae){var Y=h.exec(V.slice(ae));return Y?(F.w=p.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function k(F,V,ae){var Y=f.exec(V.slice(ae));return Y?(F.w=d.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function T(F,V,ae){var Y=v.exec(V.slice(ae));return Y?(F.m=y.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function I(F,V,ae){var Y=g.exec(V.slice(ae));return Y?(F.m=m.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function N(F,V,ae){return _(F,t,V,ae)}function O(F,V,ae){return _(F,n,V,ae)}function D(F,V,ae){return _(F,r,V,ae)}function L(F){return o[F.getDay()]}function W(F){return a[F.getDay()]}function G(F){return u[F.getMonth()]}function K(F){return s[F.getMonth()]}function ee(F){return i[+(F.getHours()>=12)]}function ce(F){return 1+~~(F.getMonth()/3)}function he(F){return o[F.getUTCDay()]}function Oe(F){return a[F.getUTCDay()]}function Te(F){return u[F.getUTCMonth()]}function Re(F){return s[F.getUTCMonth()]}function me(F){return i[+(F.getUTCHours()>=12)]}function P(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var V=S(F+="",b);return V.toString=function(){return F},V},parse:function(F){var V=A(F+="",!1);return V.toString=function(){return F},V},utcFormat:function(F){var V=S(F+="",x);return V.toString=function(){return F},V},utcParse:function(F){var V=A(F+="",!0);return V.toString=function(){return F},V}}}var qie={"-":"",_:" ","0":"0"},_i=/^\s*\d+/,fKe=/^%/,dKe=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function hKe(e){return e.replace(dKe,"\\$&")}function P1(e){return new RegExp("^(?:"+e.map(hKe).join("|")+")","i")}function $1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function pKe(e,t,n){var r=_i.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function gKe(e,t,n){var r=_i.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function mKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function vKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function yKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Hie(e,t,n){var r=_i.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Gie(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function bKe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function xKe(e,t,n){var r=_i.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function wKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Kie(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function _Ke(e,t,n){var r=_i.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Xie(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function SKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function EKe(e,t,n){var r=_i.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function AKe(e,t,n){var r=_i.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function CKe(e,t,n){var r=_i.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function kKe(e,t,n){var r=fKe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function TKe(e,t,n){var r=_i.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function OKe(e,t,n){var r=_i.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Yie(e,t){return _n(e.getDate(),t,2)}function IKe(e,t){return _n(e.getHours(),t,2)}function NKe(e,t){return _n(e.getHours()%12||12,t,2)}function DKe(e,t){return _n(1+id.count(ad(e),e),t,3)}function Zie(e,t){return _n(e.getMilliseconds(),t,3)}function RKe(e,t){return Zie(e,t)+"000"}function FKe(e,t){return _n(e.getMonth()+1,t,2)}function MKe(e,t){return _n(e.getMinutes(),t,2)}function PKe(e,t){return _n(e.getSeconds(),t,2)}function $Ke(e){var t=e.getDay();return t===0?7:t}function LKe(e,t){return _n(E1.count(ad(e)-1,e),t,2)}function Jie(e){var t=e.getDay();return t>=4||t===0?A1(e):A1.ceil(e)}function BKe(e,t){return e=Jie(e),_n(A1.count(ad(e),e)+(ad(e).getDay()===4),t,2)}function zKe(e){return e.getDay()}function jKe(e,t){return _n(JL.count(ad(e)-1,e),t,2)}function UKe(e,t){return _n(e.getFullYear()%100,t,2)}function WKe(e,t){return e=Jie(e),_n(e.getFullYear()%100,t,2)}function VKe(e,t){return _n(e.getFullYear()%1e4,t,4)}function qKe(e,t){var n=e.getDay();return e=n>=4||n===0?A1(e):A1.ceil(e),_n(e.getFullYear()%1e4,t,4)}function HKe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function Qie(e,t){return _n(e.getUTCDate(),t,2)}function GKe(e,t){return _n(e.getUTCHours(),t,2)}function KKe(e,t){return _n(e.getUTCHours()%12||12,t,2)}function XKe(e,t){return _n(1+od.count(sd(e),e),t,3)}function eae(e,t){return _n(e.getUTCMilliseconds(),t,3)}function YKe(e,t){return eae(e,t)+"000"}function ZKe(e,t){return _n(e.getUTCMonth()+1,t,2)}function JKe(e,t){return _n(e.getUTCMinutes(),t,2)}function QKe(e,t){return _n(e.getUTCSeconds(),t,2)}function eXe(e){var t=e.getUTCDay();return t===0?7:t}function tXe(e,t){return _n(C1.count(sd(e)-1,e),t,2)}function tae(e){var t=e.getUTCDay();return t>=4||t===0?k1(e):k1.ceil(e)}function nXe(e,t){return e=tae(e),_n(k1.count(sd(e),e)+(sd(e).getUTCDay()===4),t,2)}function rXe(e){return e.getUTCDay()}function iXe(e,t){return _n(t4.count(sd(e)-1,e),t,2)}function aXe(e,t){return _n(e.getUTCFullYear()%100,t,2)}function oXe(e,t){return e=tae(e),_n(e.getUTCFullYear()%100,t,2)}function sXe(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function uXe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?k1(e):k1.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function lXe(){return"+0000"}function nae(){return"%"}function rae(e){return+e}function iae(e){return Math.floor(+e/1e3)}var _v,h4,aae,p4,oae;cXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function cXe(e){return _v=Vie(e),h4=_v.format,aae=_v.parse,p4=_v.utcFormat,oae=_v.utcParse,_v}function L1(e){const t={};return n=>t[n]||(t[n]=e(n))}function fXe(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let a=dXe(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function dXe(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function sae(e){const t=L1(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=S1(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return fXe(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,a,o){o=S1(o??",f");const s=nd(r,i,a),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=$Ge(s,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=LGe(s,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=PGe(s))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let g4;uae();function uae(){return g4=sae({format:vie,formatPrefix:yie})}function lae(e){return sae(mie(e))}function sC(e){return arguments.length?g4=lae(e):g4}function cae(e,t,n){n=n||{},Nt(n)||Se("Invalid time multi-format specifier: ".concat(n));const r=t(hs),i=t(Wo),a=t(Uo),o=t(uo),s=t(ui),u=t(Qi),l=t(so),c=t(Li),f=e(n[au]||".%L"),d=e(n[hs]||":%S"),h=e(n[Wo]||"%I:%M"),p=e(n[Uo]||"%I %p"),g=e(n[uo]||n[ea]||"%a %d"),m=e(n[ui]||"%b %d"),v=e(n[Qi]||"%B"),y=e(n[so]||"%B"),b=e(n[Li]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:a(x)<x?h:o(x)<x?p:u(x)<x?s(x)<x?g:m:c(x)<x?l(x)<x?v:y:b)(x)}function fae(e){const t=L1(e.format),n=L1(e.utcFormat);return{timeFormat:r=>Bn(r)?t(r):cae(t,xv,r),utcFormat:r=>Bn(r)?n(r):cae(n,wv,r),timeParse:L1(e.parse),utcParse:L1(e.utcParse)}}let m4;dae();function dae(){return m4=fae({format:h4,parse:aae,utcFormat:p4,utcParse:oae})}function hae(e){return fae(Vie(e))}function B1(e){return arguments.length?m4=hae(e):m4}const v4=(e,t)=>Rt({},e,t);function pae(e,t){const n=e?lae(e):sC(),r=t?hae(t):B1();return v4(n,r)}function y4(e,t){const n=arguments.length;return n&&n!==2&&Se("defaultLocale expects either zero or two arguments."),n?v4(sC(e),B1(t)):v4(sC(),B1())}function hXe(){return uae(),dae(),y4()}function gae(e,t,n,r){t=t||{};const i=PL(t.type||"json");return i||Se("Unknown data format type: "+t.type),e=i(e,t),t.parse&&pXe(e,t.parse,n,r),_t(e,"columns")&&delete e.columns,e}function pXe(e,t,n,r){if(!e.length)return;const i=B1();n=n||i.timeParse,r=r||i.utcParse;let a=e.columns||Object.keys(e[0]),o,s,u,l,c,f;t==="auto"&&(t=Gre(e,a)),a=Object.keys(t);const d=a.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!IL[p])throw Error("Illegal format pattern: "+h+":"+p);return IL[p]});for(u=0,c=e.length,f=a.length;u<c;++u)for(o=e[u],l=0;l<f;++l)s=a[l],o[s]=d[l](o[s])}const uC=KHe(typeof fetch!="undefined"&&fetch,null);function lC(e){const t=e||Oa,n=[],r={};return n.add=i=>{const a=t(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=t(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function cC(e,t){try{await t(e)}catch(n){e.error(n)}}const mae=Symbol("vega_id");let gXe=1;function fC(e){return!!(e&&lt(e))}function lt(e){return e[mae]}function vae(e,t){return e[mae]=t,e}function In(e){const t=e===Object(e)?e:{data:e};return lt(t)?t:vae(t,gXe++)}function b4(e){return dC(e,In({}))}function dC(e,t){for(const n in e)t[n]=e[n];return t}function yae(e,t){return vae(t,lt(e))}function xp(e,t){return e?t?(n,r)=>e(n,r)||lt(t(n))-lt(t(r)):(n,r)=>e(n,r)||lt(n)-lt(r):null}function bae(e){return e&&e.constructor===wp}function wp(){const e=[],t=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:wp,insert(s){const u=wt(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=Lt(s)?r:t,l=wt(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Ji(l)};return Lt(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return Lt(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return a=s,this},reflow(){return o=!0,this},pulse(s,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[lt(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[lt(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[lt(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=lt(g),l[m]?l[m]=1:s.add.push(In(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[lt(g)]<0&&s.rem.push(g);function v(y,b,x){x?y[b]=x(y):s.encode=b,o||(c[lt(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[lt(g)],m>0&&(v(g,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[lt(y)]>0&&v(y,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=t.length||r.length?u.filter(y=>l[lt(y)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(a||a==null&&(t.length||r.length))&&s.clean(!0),s}}}const hC="_:mod:_";function pC(){Object.defineProperty(this,hC,{writable:!0,value:{}})}pC.prototype={set(e,t,n,r){const i=this,a=i[e],o=i[hC];return t!=null&&t>=0?(a[t]!==n||r)&&(a[t]=n,o[t+":"+e]=-1,o[e]=-1):(a!==n||r)&&(i[e]=n,o[e]=ut(n)?1+n.length:-1),i},modified(e,t){const n=this[hC];if(arguments.length){if(ut(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[hC]={},this}};let mXe=0;const vXe="pulse",yXe=new pC,bXe=1,xXe=2;function Yn(e,t,n,r){this.id=++mXe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function xae(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Yn.prototype={targets(){return this._targets||(this._targets=lC(m1))},set(e){return this.value!==e?(this.value=e,1):0},skip:xae(bXe),modified:xae(xXe),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new pC,i=this._argops=this._argops||[],a=[];let o,s,u,l;const c=(f,d,h)=>{h instanceof Yn?(h!==this&&(t&&h.targets().add(this),a.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(s=e[o],o===vXe)wt(s).forEach(f=>{f instanceof Yn?f!==this&&(f.targets().add(this),a.push(f)):Se("Pulse parameters must be operator instances.")}),this.source=s;else if(ut(s))for(r.set(o,-1,Array(u=s.length)),l=0;l<u;++l)c(o,l,s[l]);else c(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(e){const t=this._argval||yXe,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===e,t.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function wXe(e,t,n,r){let i=1,a;return e instanceof Yn?a=e:e&&e.prototype instanceof Yn?a=new e:Lt(e)?a=new Yn(null,e):(i=0,a=new Yn(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function _Xe(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let SXe=0;function gC(e,t,n){this.id=++SXe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function ud(e,t,n){return new gC(e,t,n)}gC.prototype={_filter:fs,_apply:Oa,targets(){return this._targets||(this._targets=lC(m1))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=ud(e);return this.targets().add(t),t},apply(e){const t=ud(null,e);return this.targets().add(t),t},merge(){const e=ud();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=ud();return this.targets().add(ud(null,null,EL(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(ud(null,null,()=>n=!0)),t.targets().add(ud(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=fs,this._targets=null}};function EXe(e,t,n,r){const i=this,a=ud(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=wt(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,o);return a}function AXe(e,t){const n=this.locale();return gae(e,t,n.timeParse,n.utcParse)}function CXe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function kXe(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:tie(t&&t.type)});try{i=n.parse(i,t)}catch(a){r=-2,n.warn("Data ingestion failed",e,a)}}catch(a){r=-1,n.warn("Loading failed",e,a)}return{data:i,status:r}}async function TXe(e,t,n){const r=this,i=r._pending||OXe(r);i.requests+=1;const a=await r.request(t,n);return r.pulse(e,r.changeset().remove(fs).insert(a.data||[])),i.done(),a}function OXe(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const IXe={skip:!0};function NXe(e,t,n,r,i){return(e instanceof Yn?RXe:DXe)(this,e,t,n,r,i),this}function DXe(e,t,n,r,i,a){const o=Rt({},a,IXe);let s,u;Lt(n)||(n=Ji(n)),r===void 0?s=l=>e.touch(n(l)):Lt(r)?(u=new Yn(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;bae(f)?e.pulse(c,f,a):e.update(c,f,o)}):s=l=>e.update(n(l),r,o),t.apply(s)}function RXe(e,t,n,r,i,a){if(r===void 0)t.targets().add(n);else{const o=a||{},s=new Yn(null,FXe(n,r),i,!1);s.modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function FXe(e,t){return t=Lt(t)?t:Ji(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function MXe(e){e.rank=++this._rank}function PXe(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Se("Cycle detected in dataflow graph.")}const mC={},il=1<<0,ld=1<<1,Ac=1<<2,$Xe=il|ld,wae=il|Ac,Sv=il|ld|Ac,_ae=1<<3,z1=1<<4,Sae=1<<5,Eae=1<<6;function cd(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function x4(e,t){const n=[];return td(e,t,r=>n.push(r)),n}function Aae(e,t){const n={};return e.visit(t,r=>{n[lt(r)]=1}),r=>n[lt(r)]?null:r}function vC(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}cd.prototype={StopPropagation:mC,ADD:il,REM:ld,MOD:Ac,ADD_REM:$Xe,ADD_MOD:wae,ALL:Sv,REFLOW:_ae,SOURCE:z1,NO_SOURCE:Sae,NO_FIELDS:Eae,fork(e){return new cd(this.dataflow).init(this,e)},clone(){const e=this.fork(Sv);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Sv|z1)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new cd(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Eae)&&(n.fields=e.fields),t&il?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ld?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ac?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Sae?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Sv;return t&il&&this.add.length||t&ld&&this.rem.length||t&Ac&&this.mod.length},reflow(e){if(e)return this.fork(Sv).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ac,Aae(this,il))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ut(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ut(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&il&&(n.addF=vC(n.addF,t)),e&ld&&(n.remF=vC(n.remF,t)),e&Ac&&(n.modF=vC(n.modF,t)),e&z1&&(n.srcF=vC(n.srcF,t)),n},materialize(e){e=e||Sv;const t=this;return e&il&&t.addF&&(t.add=x4(t.add,t.addF),t.addF=null),e&ld&&t.remF&&(t.rem=x4(t.rem,t.remF),t.remF=null),e&Ac&&t.modF&&(t.mod=x4(t.mod,t.modF),t.modF=null),e&z1&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&z1)return td(n.source,n.srcF,r),n;e&il&&td(n.add,n.addF,r),e&ld&&td(n.rem,n.remF,r),e&Ac&&td(n.mod,n.modF,r);const i=n.source;if(e&_ae&&i){const a=n.add.length+n.mod.length;a===i.length||(a?td(i,Aae(n,wae),r):td(i,n.srcF,r))}return n}};function w4(e,t,n,r){const i=this,a=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<a;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(o|=i.ADD),u.changed(i.REM)&&(o|=i.REM),u.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}$e(w4,cd,{fork(e){const t=new cd(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ut(e)?e.some(r=>n[r]):n[e]:0},filter(){Se("MultiPulse does not support filtering.")},materialize(){Se("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n}});async function LXe(e,t,n){const r=this,i=[];if(r._pulse)return Cae(r);if(r._pending&&await r._pending,t&&await cC(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new cd(r,a,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=lC(m1);let o=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=mC),u!==mC&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await cC(r,c[f].callback)}return n&&await cC(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function BXe(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function zXe(e,t,n){return this._pulse?Cae(this):(this.evaluate(e,t,n),this)}function jXe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function Cae(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function UXe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function WXe(e,t){const n=e.source,r=this._clock;return n&&ut(n)?new w4(this,r,n.map(i=>i.pulse),t):this._input[e.id]||VXe(this._pulse,n&&n.pulse)}function VXe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==mC&&(e.source=t.source),e)}const _4={skip:!1,force:!1};function qXe(e,t){const n=t||_4;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function HXe(e,t,n){const r=n||_4;return(e.set(t)||r.force)&&this.touch(e,r),this}function GXe(e,t,n){this.touch(e,n||_4);const r=new cd(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function KXe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),kae(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,XXe(t,0,e)):r=n,r}}}function kae(e,t,n,r){let i,a;const o=e[n];for(;n>t;){if(a=n-1>>1,i=e[a],r(o,i)<0){e[n]=i,n=a;continue}break}return e[n]=o}function XXe(e,t,n){const r=t,i=e.length,a=e[t];let o=(t<<1)+1,s;for(;o<i;)s=o+1,s<i&&n(e[o],e[s])>=0&&(o=s),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=a,kae(e,r,t,n)}function Ev(){this.logger(_re()),this.logLevel(bL),this._clock=0,this._rank=0,this._locale=y4();try{this._loader=uC()}catch(e){}this._touched=lC(m1),this._input={},this._pulse=null,this._heap=KXe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function j1(e){return function(){return this._log[e].apply(this,arguments)}}Ev.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:j1("error"),warn:j1("warn"),info:j1("info"),debug:j1("debug"),logLevel:j1("level"),cleanThreshold:1e4,add:wXe,connect:_Xe,rank:MXe,rerank:PXe,pulse:GXe,touch:qXe,update:HXe,changeset:wp,ingest:CXe,parse:AXe,preload:TXe,request:kXe,events:EXe,on:NXe,evaluate:LXe,run:zXe,runAsync:BXe,runAfter:jXe,_enqueue:UXe,_getPulse:WXe};function ve(e,t){Yn.call(this,e,null,t)}$e(ve,Yn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Av={};function Tae(e){const t=Oae(e);return t&&t.Definition||null}function Oae(e){return e=e&&e.toLowerCase(),_t(Av,e)?Av[e]:null}function*Iae(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function S4(e,t,n){const r=Float64Array.from(Iae(e,n));return r.sort(vv),t.map(i=>oie(r,i))}function E4(e,t){return S4(e,[.25,.5,.75],t)}function A4(e,t){const n=e.length,r=AGe(e,t),i=E4(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function Nae(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,u,l,c,f,d;const h=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(a/s+g)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}var ps=Math.random;function YXe(e){ps=e}function Dae(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Iae(e,r)),a=i.length,o=t;let s,u,l,c;for(l=0,c=Array(o);l<o;++l){for(s=0,u=0;u<a;++u)s+=i[~~(ps()*a)];c[l]=s/a}return c.sort(vv),[UL(c,n/2),UL(c,1-n/2)]}function Rae(e,t,n,r){r=r||(d=>d);const i=e.length,a=new Float64Array(i);let o=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;o<s;++o)a[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<s;++o)a[o]=l;return n?ZXe(a,t+t/4):a}function ZXe(e,t){const n=e.length;let r=0,i=1,a,o;for(;e[r]===e[i];)++i;for(;i<n;){for(a=i+1;e[i]===e[a];)++a;if(e[i]-e[i-1]<t){for(o=i+(r+a-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=a}return e}function JXe(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function QXe(e,t){t==null&&(t=e,e=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*ps())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const s=Math.floor(o);return s<n?0:s>=r?1:(s-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(e).max(t)}const Fae=Math.sqrt(2*Math.PI),eYe=Math.SQRT2;let U1=NaN;function yC(e,t){e=e||0,t=t??1;let n=0,r=0,i,a;if(U1===U1)n=U1,U1=NaN;else{do n=ps()*2-1,r=ps()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,U1=r*a}return e+n*t}function C4(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Fae)}function bC(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,a=o*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,a=a/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,a=o/s/2.506628274631)}return r>0?1-a:a}function xC(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*eYe*tYe(2*e-1)}function tYe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function k4(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>yC(n,r),pdf:a=>C4(a,n,r),cdf:a=>bC(a,n,r),icdf:a=>xC(a,n,r)};return i.mean(e).stdev(t)}function T4(e,t){const n=k4();let r=0;const i={data(a){return arguments.length?(e=a,r=a?a.length:0,i.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=A4(e)),i):t},sample(){return e[~~(ps()*r)]+t*n.sample()},pdf(a){let o=0,s=0;for(;s<r;++s)o+=n.pdf((a-e[s])/t);return o/t/r},cdf(a){let o=0,s=0;for(;s<r;++s)o+=n.cdf((a-e[s])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function O4(e,t){return e=e||0,t=t??1,Math.exp(e+yC()*t)}function I4(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Fae*e)}function N4(e,t,n){return bC(Math.log(e),t,n)}function D4(e,t,n){return Math.exp(xC(e,t,n))}function Mae(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>O4(n,r),pdf:a=>I4(a,n,r),cdf:a=>N4(a,n,r),icdf:a=>D4(a,n,r)};return i.mean(e).stdev(t)}function Pae(e,t){let n=0,r;function i(o){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)s[l]/=u;return s}const a={weights(o){return arguments.length?(r=i(t=o||[]),a):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),a.weights(t)):e},sample(){const o=ps();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){s=e[l];break}return s.sample()},pdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(o);return s},cdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(o);return s},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function R4(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ps()}function F4(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function M4(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function P4(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function $ae(e,t){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a??1,i):r},sample:()=>R4(n,r),pdf:a=>F4(a,n,r),cdf:a=>M4(a,n,r),icdf:a=>P4(a,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function W1(e,t,n,r){const i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function wC(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,a=new Float64Array(i),o=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)a[s]=c=+t(d),o[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)a[s]-=u,o[s]-=l;return[a,o,u,l]}function V1(e,t,n,r){let i=-1,a,o;for(const s of e)a=t(s),o=n(s),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function Cv(e,t,n,r,i){let a=0,o=0;return V1(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;a+=l*l,o+=c*c}),1-a/o}function $4(e,t,n){let r=0,i=0,a=0,o=0,s=0;V1(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=W1(r,i,a,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Cv(e,t,n,i,l)}}function Lae(e,t,n){let r=0,i=0,a=0,o=0,s=0;V1(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=W1(r,i,a,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Cv(e,t,n,i,l)}}function Bae(e,t,n){const[r,i,a,o]=wC(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,p;V1(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,s+=(b*h-s)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=W1(u/o,s/o,l/o,c/o),v=y=>Math.exp(g+m*(y-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:Cv(e,t,n,o,v)}}function zae(e,t,n){let r=0,i=0,a=0,o=0,s=0,u=0;V1(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,a+=(h*p-a)/u,o+=(h*h-o)/u,s+=(d-s)/u});const l=W1(r,i,a,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Cv(e,t,n,s,c)}}function L4(e,t,n){const[r,i,a,o]=wC(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<s;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,x=(f*v-d*l)/y,w=-b*u,S=A=>(A=A-a,b*A*A+x*A+w+o);return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:S,rSquared:Cv(e,t,n,o,S)}}function jae(e,t,n,r){if(r===1)return $4(e,t,n);if(r===2)return L4(e,t,n);const[i,a,o,s]=wC(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*a[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=rYe(c),y=b=>{b-=o;let x=s+v[0]+v[1]*b+v[2]*b*b;for(d=3;d<f;++d)x+=v[d]*Math.pow(b,d);return x};return{coef:nYe(f,v,-o,s),predict:y,rSquared:Cv(e,t,n,s,y)}}function nYe(e,t,n,r){const i=Array(e);let a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function rYe(e){const t=e.length-1,n=[];let r,i,a,o,s;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(a=r;a<t+1;++a)s=e[a][r],e[a][r]=e[a][o],e[a][o]=s;for(i=r+1;i<t;++i)for(a=t;a>=r;a--)e[a][i]-=e[a][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*n[a];n[i]=(e[t][i]-s)/e[i][i]}return n}const Uae=2,Wae=1e-12;function Vae(e,t,n,r){const[i,a,o,s]=wC(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=Uae;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,S=0,A=0,_=0,E=0;const C=1/Math.abs(i[x]-v||1);for(let I=y;I<=b;++I){const N=i[I],O=a[I],D=iYe(Math.abs(v-N)*C)*d[I],L=N*D;w+=D,S+=L,A+=O*D,_+=O*L,E+=N*L}const[k,T]=W1(S/w,A/w,_/w,E/w);c[m]=k+T*v,f[m]=Math.abs(a[m]-c[m]),aYe(i,m+1,p)}if(h===Uae)break;const g=sie(f);if(Math.abs(g)<Wae)break;for(let m=0,v,y;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?Wae:(y=1-v*v)*y}return oYe(i,c,o,s)}function iYe(e){return(e=1-e*e*e)*e*e}function aYe(e,t,n){const r=e[t];let i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}function oYe(e,t,n,r){const i=e.length,a=[];let o=0,s=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[o]],a.push(u));return u[1]+=r,a}const sYe=.1*Math.PI/180;function _C(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=h=>[h,e(h)],a=t[0],o=t[1],s=o-a,u=s/r,l=[i(a)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(a+h/n*s));return l.push(i(o)),l}else{c.push(i(o));for(let h=n;--h>0;)c.push(i(a+h/n*s))}let f=l[0],d=c[c.length-1];for(;d;){const h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&uYe(f,h,d)>sYe?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function uYe(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function lYe(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function B4(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:lYe(e)}function qae(e,t,n){return n||e+(t?"_"+t:"")}const z4=()=>{},cYe={init:z4,add:z4,rem:z4,idx:0},q1={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},H1=Object.keys(q1);function fYe(e,t){return n=>Rt({name:e,out:n||e},cYe,t)}H1.forEach(e=>{q1[e]=fYe(e,q1[e])});function Hae(e,t){return q1[e](t)}function Gae(e,t){return e.idx-t.idx}function dYe(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=q1[i]())})};return e.forEach(n),Object.values(t).sort(Gae)}function hYe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function pYe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function gYe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function mYe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function Kae(e,t){const n=t||Oa,r=dYe(e),i=e.slice().sort(Gae);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=hYe,a.prototype.add=pYe,a.prototype.rem=gYe,a.prototype.set=mYe,a.prototype.get=n,a.fields=e.map(o=>o.out),a}function j4(e){this._key=e?ao(e):lt,this.reset()}const Bi=j4.prototype;Bi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Bi.add=function(e){this._add.push(e)},Bi.rem=function(e){this._rem.push(e)},Bi.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};let s,u,l;for(s=0;s<i;++s)o[n(t[s])]=1;for(s=0,u=0;s<r;++s)o[n(l=e[s])]?o[n(l)]=0:a[u++]=l;return this._rem=[],this._add=a},Bi.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,a;for(;--r>=0;)a=e(t[r])+"",_t(n,a)||(n[a]=1,++i);return i},Bi.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Mre(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Bi.argmin=function(e){return this.extent(e)[0]||{}},Bi.argmax=function(e){return this.extent(e)[1]||{}},Bi.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Bi.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Bi.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=E4(this.values(),e),this._get=e),this._q},Bi.q1=function(e){return this.quartile(e)[0]},Bi.q2=function(e){return this.quartile(e)[1]},Bi.q3=function(e){return this.quartile(e)[2]},Bi.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=Dae(this.values(),1e3,.05,e),this._get=e),this._ci},Bi.ci0=function(e){return this.ci(e)[0]},Bi.ci1=function(e){return this.ci(e)[1]};function fd(e){ve.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}fd.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:H1},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},$e(fd,ve,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function a(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}a(e._prev),a(t);function o(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=wt(Yi(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=wt(e.groupby),this._dnames=this._dims.map(m=>{const v=Nr(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:B4(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],o=e.ops||["count"],s=e.as||[],u=a.length,l={};let c,f,d,h,p,g;for(u!==o.length&&Se("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=a[g],f=o[g],c==null&&f!=="count"&&Se("Null aggregate field specified."),h=Nr(c),p=qae(f,h,s[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(Hae(f,p))}return this._measures=this._measures.map(m=>Kae(m,m.field)),{}},cellkey:B4(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new j4),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](e);return t?yae(t.tuple,a):In(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const vYe=1e-14;function U4(e){ve.call(this,null,e)}U4.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},$e(U4,ve,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Yi(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+a*(1+(f-i)/a)}:c=>c[s]=r(c)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Nae(e),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,s;(o=e.anchor)!=null&&(s=o-(i+r*Math.floor((o-i)/r)),i+=s,a+=s);const u=function(l){let c=Zi(t(l));return c==null?null:c<i?-1/0:c>a?1/0:(c=Math.max(i,Math.min(c,a-r)),i+r*Math.floor(vYe+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=io(u,Yi(t),e.name||"bin_"+Nr(t))}});function Xae(e,t,n){const r=e;let i=t||[],a=n||[],o={},s=0;return{add:u=>a.push(u),remove:u=>o[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!o[r(c)]),o={},s=0),l&&u&&i.sort(u),a.length&&(i=u?jre(u,i,a.sort(u)):i.concat(a),a=[]),i)}}function W4(e){ve.call(this,[],e)}W4.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},$e(W4,ve,{transform(e,t){const n=t.fork(t.ALL),r=Xae(lt,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(xp(i),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function Yae(e){Yn.call(this,null,yYe,e)}$e(Yae,Yn);function yYe(e){return this.value&&!e.modified()?this.value:SL(e.fields,e.orders)}function V4(e){ve.call(this,null,e)}V4.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function bYe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}$e(V4,ve,{transform(e,t){const n=f=>d=>{for(var h=bYe(s(d),e.case,a)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=In({}),u[i]=s,u[a]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==l&&(u[a]=l,o.mod.push(u));return o.modifies(t)}});function q4(e){ve.call(this,null,e)}q4.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},$e(q4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=xYe(s,i,a,e.filter||fs)):n.mod=s,n.source=this.value,n.modifies(r)}});function xYe(e,t,n,r){for(var i=[],a={},o=e.length,s=0,u,l;s<o;++s)for(a[t]=l=e[s],u=0;u<o;++u)a[n]=e[u],r(a)&&(i.push(In(a)),a={},a[t]=l);return i}const Zae={kde:T4,mixture:Pae,normal:k4,lognormal:Mae,uniform:$ae},wYe="distributions",Jae="function",_Ye="field";function Qae(e,t){const n=e[Jae];_t(Zae,n)||Se("Unknown distribution function: "+n);const r=Zae[n]();for(const i in e)i===_Ye?r.data((e.from||t()).map(e[i])):i===wYe?r[i](e[i].map(a=>Qae(a,t))):typeof r[i]===Jae&&r[i](e[i]);return r}function H4(e){ve.call(this,null,e)}const eoe=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],SYe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:eoe},{name:"weights",type:"number",array:!0}]};H4.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:eoe.concat(SYe)},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(H4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=Qae(e.distribution,EYe(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Se("Invalid density method: "+o),!e.extent&&!r.data&&Se("Missing density extent parameter."),o=r[o];const s=e.as||["value","density"],u=e.extent||nl(r.data()),l=_C(o,u,i,a).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],In(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function EYe(e){return()=>e.materialize(e.SOURCE).source}function toe(e,t){return e?e.map((n,r)=>t[r]||Nr(n)):null}function G4(e,t,n){const r=[],i=f=>f(u);let a,o,s,u,l,c;if(t==null)r.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)u=e[o],l=t.map(i),c=a[l],c||(a[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const noe="bin";function K4(e){ve.call(this,null,e)}K4.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:noe}]};const AYe=(e,t)=>y1(nl(e,t))/30;$e(K4,ve,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=G4(t.source,e.groupby,Oa),i=e.smooth||!1,a=e.field,o=e.step||AYe(n,a),s=xp((p,g)=>a(p)-a(g)),u=e.as||noe,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(s);h=-1;for(const g of Rae(p,o,i,a))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function roe(e){Yn.call(this,null,CYe,e),this.modified(!0)}$e(roe,Yn);function CYe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:io(n=>t(n,e),Yi(t),Nr(t))}function X4(e){ve.call(this,[void 0,void 0],e)}X4.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},$e(X4,ve,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=Zi(r(s));u!=null&&(u<a&&(a=u),u>o&&(o=u))}),!Number.isFinite(a)||!Number.isFinite(o)){let s=Nr(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function Y4(e,t){Yn.call(this,e),this.parent=t,this.count=0}$e(Y4,Yn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function SC(e){ve.call(this,{},e),this._keys=gv();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}$e(SC,ve,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let a=_t(i,e)&&i[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new Y4(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),i[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=lt(u),c=a.get(l);c!==void 0&&(a.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);a.set(lt(u),l),s(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=lt(u),c=a.get(l),f=r(u);c===f?s(f).mod(u):(a.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(a.get(lt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=lt(u),c=a.get(l),f=r(u);c!==f&&(a.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function ioe(e){Yn.call(this,null,kYe,e)}$e(ioe,Yn);function kYe(e){return this.value&&!e.modified()?this.value:ut(e.name)?wt(e.name).map(t=>ao(t)):ao(e.name,e.as)}function Z4(e){ve.call(this,gv(),e)}Z4.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},$e(Z4,ve,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=lt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?a.push(f):r.set(lt(f),1)});function c(f){const d=lt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),a.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function J4(e){ve.call(this,[],e)}J4.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},$e(J4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=toe(r,e.as||[]),a=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(p=>p(s)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=b4(s),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;a&&(d[a]=c),n.add.push(d)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function Q4(e){ve.call(this,[],e)}Q4.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},$e(Q4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Nr),a=e.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=b4(l),f[o]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(a)}});function eB(e){ve.call(this,null,e)}eB.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},$e(eB,ve,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,o=>o[r]=n(o,e))}});function aoe(e){ve.call(this,[],e)}$e(aoe,ve,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,a=e.size-i.length,o,s,u;if(a>0){for(o=[];--a>=0;)o.push(u=In(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-a);return n.source=this.value=i,n}});const EC={value:"value",median:sie,mean:kGe,min:jL,max:gp},TYe=[];function tB(e){ve.call(this,[],e)}tB.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function OYe(e){var t=e.method||EC.value,n;if(EC[t]==null)Se("Unrecognized imputation method: "+t);else return t===EC.value?(n=e.value!==void 0?e.value:0,()=>n):EC[t]}function IYe(e){const t=e.field;return n=>n?t(n):NaN}$e(tB,ve,{transform(e,t){var n=t.fork(t.ALL),r=OYe(e),i=IYe(e),a=Nr(e.field),o=Nr(e.key),s=(e.groupby||[]).map(Nr),u=NYe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,v,y,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,y=0;y<f;++y)if(d[y]==null){for(g=u.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[s[v]]=p[v];w[o]=g,w[a]=Number.isNaN(h)?h=r(d,i):h,l.push(In(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function NYe(e,t,n,r){var i=v=>v(m),a=[],o=r?r.slice():[],s={},u={},l,c,f,d,h,p,g,m;for(o.forEach((v,y)=>s[v]=y+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=s[p]||(s[p]=o.push(p)),c=(l=t?t.map(i):TYe)+"",(f=u[c])||(f=u[c]=[],a.push(f),f.values=l),f[h-1]=m;return a.domain=o,a}function nB(e){fd.call(this,e)}nB.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:H1},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},$e(nB,fd,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Rt(a,i[n.cellkey(a)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function rB(e){ve.call(this,null,e)}rB.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(rB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=G4(r,e.groupby,e.field),a=(e.groupby||[]).map(Nr),o=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&Se("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=nl(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=T4(h,o)[s],g=e.counts?h.length:1,m=c||nl(h);_C(p,m,f,d).forEach(v=>{const y={};for(let b=0;b<a.length;++b)y[a[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(In(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function ooe(e){Yn.call(this,null,DYe,e)}$e(ooe,Yn);function DYe(e){return this.value&&!e.modified()?this.value:CL(e.fields,e.flat)}function soe(e){ve.call(this,[],e),this._pending=null}$e(soe,ve,{transform(e,t){const n=t.dataflow;return this._pending?iB(this,t,this._pending):RYe(e)?t.StopPropagation:e.values?iB(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=wt(i.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(r=>iB(this,t,wt(r.data)))}});function RYe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function iB(e,t,n){n.forEach(In);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function aB(e){ve.call(this,{},e)}aB.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},$e(aB,ve,{transform(e,t){const n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),s=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&Se('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&Se('The "as" parameter has too few output field names.'),c=c||i.map(Nr),f=function(p){for(var g=0,m=0,v,y;g<s;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<d;++v,++m)p[c[m]]=a;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||Se("Missing output field names."),f=function(p){for(var g=0,m;g<s;++g)m=r.get(n[g](p)),p[c[g]]=m??a}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function uoe(e){Yn.call(this,null,FYe,e)}$e(uoe,Yn);function FYe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=t[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function loe(e){Yn.call(this,null,MYe,e)}$e(loe,Yn);function MYe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function coe(e){ve.call(this,null,e)}$e(coe,ve,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function oB(e){fd.call(this,e)}oB.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:H1,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},$e(oB,fd,{_transform:fd.prototype.transform,transform(e,t){return this._transform(PYe(e,t),t)}});function PYe(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Yi(n).concat(Yi(r)),o=LYe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(s=>$Ye(s,n,r,a)),as:o.map(s=>s+""),modified:e.modified.bind(e)}}function $Ye(e,t,n,r){return io(i=>t(i)===e?n(i):NaN,r,e+"")}function LYe(e,t,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=e(a);r[o]||(r[o]=1,i.push(o))}),i.sort(ZA),t?i.slice(0,t):i}function foe(e){SC.call(this,e)}$e(foe,SC,{transform(e,t){const n=e.subflow,r=e.field,i=a=>this.subflow(lt(a),n,t,a);return(e.modified("field")||r&&t.modified(Yi(r)))&&Se("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,a=>{const o=i(a);r(a).forEach(s=>o.mod(s))}),t.visit(t.ADD,a=>{const o=i(a);r(a).forEach(s=>o.add(In(s)))}),t.visit(t.REM,a=>{const o=i(a);r(a).forEach(s=>o.rem(s))})):(t.visit(t.MOD,a=>i(a).mod(a)),t.visit(t.ADD,a=>i(a).add(a)),t.visit(t.REM,a=>i(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function sB(e){ve.call(this,null,e)}sB.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},$e(sB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=toe(e.fields,e.as||[]),a=r?(s,u)=>BYe(s,u,r,i):dC;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,s=>{const u=lt(s);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,s=>{const u=a(s,In({}));o[lt(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(a(s,o[lt(s)]))}),n}});function BYe(e,t,n,r){for(let i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}function doe(e){ve.call(this,null,e)}$e(doe,ve,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function uB(e){ve.call(this,null,e)}uB.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const zYe=1e-14;$e(uB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,a=G4(i,e.groupby,e.field),o=(e.groupby||[]).map(Nr),s=[],u=e.step||.01,l=e.probs||jo(u/2,1-zYe,u),c=l.length;return a.forEach(f=>{const d=S4(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],s.push(In(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function hoe(e){ve.call(this,null,e)}$e(hoe,ve,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const a=lt(i);n.rem.push(r[a]),r[a]=null}),t.visit(t.ADD,i=>{const a=b4(i);r[lt(i)]=a,n.add.push(a)}),t.visit(t.MOD,i=>{const a=r[lt(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function lB(e){ve.call(this,[],e),this.count=0}lB.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},$e(lB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((c,f)=>(c[lt(f)]=1,c),{});let o=this.value,s=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((s+1)*ps()),d<o.length&&d>=u&&(f=o[d],a[lt(f)]&&n.rem.push(f),o[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=lt(c);a[f]&&(a[f]=-1,n.rem.push(c)),--s}),o=o.filter(c=>a[lt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=s=o.length,t.visit(t.SOURCE,c=>{a[lt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)a[lt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{a[lt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!a[lt(c)])),this.count=s,this.value=n.source=o,n}});function cB(e){ve.call(this,null,e)}cB.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},$e(cB,ve,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=jo(e.start,e.stop,e.step||1).map(i=>{const a={};return a[r]=i,In(a)}),n.add=t.add.concat(this.value),n}});function poe(e){ve.call(this,null,e),this.modified(!0)}$e(poe,ve,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function fB(e){ve.call(this,null,e)}const goe=["unit0","unit1"];fB.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:n4,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:goe}]},$e(fB,ve,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",a=this._floor(e,t),o=(i?wv:xv)(a.unit).offset,s=e.as||goe,u=s[0],l=s[1],c=a.step;let f=a.start||1/0,d=a.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Yi(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=a(g),r&&(p[l]=v=o(m,c)),m<f&&(f=m),v>d&&(d=v))}),a.start=f,a.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Wie({extent:e.extent||nl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=i4(r),o=this.value||{},s=(n?Die:Nie)(a,i);return s.unit=sn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}});function moe(e){ve.call(this,gv(),e)}$e(moe,ve,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,a=s=>i.set(r(s),s);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function voe(e){ve.call(this,null,e)}$e(voe,ve,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(xp(e.sort)):t.source).map(e.field))}});function jYe(e,t,n,r){const i=G1[e](t,n);return{init:i.init||Zf,update:function(a,o){o[r]=i.next(a)}}}const G1={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=G1.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Se("ntile num must be greater than zero.");const n=G1.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Se("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=UYe(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function UYe(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const WYe=Object.keys(G1);function yoe(e){const t=wt(e.ops),n=wt(e.fields),r=wt(e.params),i=wt(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){wt(Yi(h)).forEach(p=>s[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Nr(g),v=qae(h,m,i[p]);if(d(g),a.push(v),_t(G1,h))o.push(jYe(h,n[p],r[p],v));else{if(g==null&&h!=="count"&&Se("Null aggregate field specified."),h==="count"){l.push(v);return}f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(Hae(h,v))}}),(l.length||c.length)&&(this.cell=VYe(c,l,f)),this.inputs=Object.keys(s)}const boe=yoe.prototype;boe.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},boe.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,a=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function VYe(e,t,n){e=e.map(u=>Kae(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var s=r.data=new j4;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)a[l].add(a[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)a[l].rem(a[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=a.length;l<c;++l)a[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)a[u].init()},r}function dB(e){ve.call(this,{},e),this._mlen=0,this._mods=[]}dB.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:WYe.concat(H1)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},$e(dB,ve,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=xp(e.sort),i=B4(e.groupby),a=s=>this.group(i(s));let o=this.state;(!o||n)&&(o=this.state=new yoe(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,s=>a(s).add(s))):(t.visit(t.REM,s=>a(s).remove(s)),t.visit(t.ADD,s=>a(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)qYe(this._mods[s],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Xae(lt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function qYe(e,t,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=e.data(n),u=s.length,l=a?x1(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ji(-1)};t.init();for(let f=0;f<u;++f)HYe(c,o,f,u),a&&GYe(c,l),t.update(c,s[f])}function HYe(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function GYe(e,t){const n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}var KYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:fd,bin:U4,collect:W4,compare:Yae,countpattern:V4,cross:q4,density:H4,dotbin:K4,expression:roe,extent:X4,facet:SC,field:ioe,filter:Z4,flatten:J4,fold:Q4,formula:eB,generate:aoe,impute:tB,joinaggregate:nB,kde:rB,key:ooe,load:soe,lookup:aB,multiextent:uoe,multivalues:loe,params:coe,pivot:oB,prefacet:foe,project:sB,proxy:doe,quantile:uB,relay:hoe,sample:lB,sequence:cB,sieve:poe,subflow:Y4,timeunit:fB,tupleindex:moe,values:voe,window:dB});const hB=Math.PI,pB=2*hB,_p=1e-6,XYe=pB-_p;function gB(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Sp(){return new gB}gB.prototype=Sp.prototype={constructor:gB,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>_p)if(!(Math.abs(c*s-u*l)>_p)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-a,h=r-o,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((hB-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>_p&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>_p||Math.abs(this._y1-l)>_p)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%pB+pB),f>XYe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>_p&&(this._+="A"+n+","+n+",0,"+ +(f>=hB)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Rn(e){return function(){return e}}var xoe=Math.abs,ta=Math.atan2,Ep=Math.cos,YYe=Math.max,mB=Math.min,al=Math.sin,kv=Math.sqrt,na=1e-12,Tv=Math.PI,AC=Tv/2,woe=2*Tv;function ZYe(e){return e>1?0:e<-1?Tv:Math.acos(e)}function _oe(e){return e>=1?AC:e<=-1?-AC:Math.asin(e)}function JYe(e){return e.innerRadius}function QYe(e){return e.outerRadius}function eZe(e){return e.startAngle}function tZe(e){return e.endAngle}function nZe(e){return e&&e.padAngle}function rZe(e,t,n,r,i,a,o,s){var u=n-e,l=r-t,c=o-i,f=s-a,d=f*u-c*l;if(!(d*d<na))return d=(c*(t-a)-f*(e-i))/d,[e+d*u,t+d*l]}function CC(e,t,n,r,i,a,o){var s=e-n,u=t-r,l=(o?a:-a)/kv(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,x=y*y+b*b,w=i-a,S=d*g-p*h,A=(b<0?-1:1)*kv(YYe(0,w*w*x-S*S)),_=(S*b-y*A)/x,E=(-S*y-b*A)/x,C=(S*b+y*A)/x,k=(-S*y+b*A)/x,T=_-m,I=E-v,N=C-m,O=k-v;return T*T+I*I>N*N+O*O&&(_=C,E=k),{cx:_,cy:E,x01:-c,y01:-f,x11:_*(i/w-1),y11:E*(i/w-1)}}function iZe(){var e=JYe,t=QYe,n=Rn(0),r=null,i=eZe,a=tZe,o=nZe,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-AC,p=a.apply(this,arguments)-AC,g=xoe(p-h),m=p>h;if(s||(s=l=Sp()),d<f&&(c=d,d=f,f=c),!(d>na))s.moveTo(0,0);else if(g>woe-na)s.moveTo(d*Ep(h),d*al(h)),s.arc(0,0,d,h,p,!m),f>na&&(s.moveTo(f*Ep(p),f*al(p)),s.arc(0,0,f,p,h,m));else{var v=h,y=p,b=h,x=p,w=g,S=g,A=o.apply(this,arguments)/2,_=A>na&&(r?+r.apply(this,arguments):kv(f*f+d*d)),E=mB(xoe(d-f)/2,+n.apply(this,arguments)),C=E,k=E,T,I;if(_>na){var N=_oe(_/f*al(A)),O=_oe(_/d*al(A));(w-=N*2)>na?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+p)/2),(S-=O*2)>na?(O*=m?1:-1,v+=O,y-=O):(S=0,v=y=(h+p)/2)}var D=d*Ep(v),L=d*al(v),W=f*Ep(x),G=f*al(x);if(E>na){var K=d*Ep(y),ee=d*al(y),ce=f*Ep(b),he=f*al(b),Oe;if(g<Tv&&(Oe=rZe(D,L,ce,he,K,ee,W,G))){var Te=D-Oe[0],Re=L-Oe[1],me=K-Oe[0],P=ee-Oe[1],F=1/al(ZYe((Te*me+Re*P)/(kv(Te*Te+Re*Re)*kv(me*me+P*P)))/2),V=kv(Oe[0]*Oe[0]+Oe[1]*Oe[1]);C=mB(E,(f-V)/(F-1)),k=mB(E,(d-V)/(F+1))}}S>na?k>na?(T=CC(ce,he,D,L,d,k,m),I=CC(K,ee,W,G,d,k,m),s.moveTo(T.cx+T.x01,T.cy+T.y01),k<E?s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,d,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),!m),s.arc(I.cx,I.cy,k,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):(s.moveTo(D,L),s.arc(0,0,d,v,y,!m)):s.moveTo(D,L),!(f>na)||!(w>na)?s.lineTo(W,G):C>na?(T=CC(W,G,K,ee,f,-C,m),I=CC(D,L,ce,he,f,-C,m),s.lineTo(T.cx+T.x01,T.cy+T.y01),C<E?s.arc(T.cx,T.cy,C,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,C,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,f,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),m),s.arc(I.cx,I.cy,C,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Tv/2;return[Ep(c)*l,al(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Rn(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Rn(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Rn(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Rn(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Rn(+l),u):i},u.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Rn(+l),u):a},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Rn(+l),u):o},u.context=function(l){return arguments.length?(s=l??null,u):s},u}function Soe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Eoe(e){this._context=e}Eoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function vB(e){return new Eoe(e)}function Aoe(e){return e[0]}function Coe(e){return e[1]}function koe(e,t){var n=Rn(!0),r=null,i=vB,a=null;e=typeof e=="function"?e:e===void 0?Aoe:Rn(e),t=typeof t=="function"?t:t===void 0?Coe:Rn(t);function o(s){var u,l=(s=Soe(s)).length,c,f=!1,d;for(r==null&&(a=i(d=Sp())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,u,s),+t(c,u,s));if(d)return a=null,d+""||null}return o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Rn(+s),o):e},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:Rn(+s),o):t},o.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Rn(!!s),o):n},o.curve=function(s){return arguments.length?(i=s,r!=null&&(a=i(r)),o):i},o.context=function(s){return arguments.length?(s==null?r=a=null:a=i(r=s),o):r},o}function Toe(e,t,n){var r=null,i=Rn(!0),a=null,o=vB,s=null;e=typeof e=="function"?e:e===void 0?Aoe:Rn(+e),t=typeof t=="function"?t:Rn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Coe:Rn(+n);function u(c){var f,d,h,p=(c=Soe(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(a==null&&(s=o(v=Sp())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(y[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),s.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return s=null,v+""||null}function l(){return koe().defined(i).curve(o).context(a)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Rn(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Rn(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Rn(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,a!=null&&(s=o(a)),u):o},u.context=function(c){return arguments.length?(c==null?a=s=null:s=o(a=c),u):a},u}var aZe={draw:function(e,t){var n=Math.sqrt(t/Tv);e.moveTo(n,0),e.arc(0,0,n,0,woe)}};function oZe(e,t){var n=null;e=typeof e=="function"?e:Rn(e||aZe),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function r(){var i;if(n||(n=i=Sp()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Rn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function dd(){}function kC(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function TC(e){this._context=e}TC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function sZe(e){return new TC(e)}function Ooe(e){this._context=e}Ooe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uZe(e){return new Ooe(e)}function Ioe(e){this._context=e}Ioe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:kC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lZe(e){return new Ioe(e)}function Noe(e,t){this._basis=new TC(e),this._beta=t}Noe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*a),this._beta*t[s]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var cZe=function e(t){function n(r){return t===1?new TC(r):new Noe(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function OC(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function yB(e,t){this._context=e,this._k=(1-t)/6}yB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:OC(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:OC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var fZe=function e(t){function n(r){return new yB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function bB(e,t){this._context=e,this._k=(1-t)/6}bB.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:OC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var dZe=function e(t){function n(r){return new bB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function xB(e,t){this._context=e,this._k=(1-t)/6}xB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:OC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var hZe=function e(t){function n(r){return new xB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function wB(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>na){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>na){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function Doe(e,t){this._context=e,this._alpha=t}Doe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:wB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var pZe=function e(t){function n(r){return t?new Doe(r,t):new yB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Roe(e,t){this._context=e,this._alpha=t}Roe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:wB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var gZe=function e(t){function n(r){return t?new Roe(r,t):new bB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Foe(e,t){this._context=e,this._alpha=t}Foe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:wB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var mZe=function e(t){function n(r){return t?new Foe(r,t):new xB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Moe(e){this._context=e}Moe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function vZe(e){return new Moe(e)}function Poe(e){return e<0?-1:1}function $oe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Poe(a)+Poe(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Loe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function _B(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function IC(e){this._context=e}IC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_B(this,this._t0,Loe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,_B(this,Loe(this,n=$oe(this,e,t)),n);break;default:_B(this,this._t0,n=$oe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Boe(e){this._context=new zoe(e)}(Boe.prototype=Object.create(IC.prototype)).point=function(e,t){IC.prototype.point.call(this,t,e)};function zoe(e){this._context=e}zoe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function yZe(e){return new IC(e)}function bZe(e){return new Boe(e)}function joe(e){this._context=e}joe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Uoe(e),i=Uoe(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Uoe(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function xZe(e){return new joe(e)}function NC(e,t){this._context=e,this._t=t}NC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function wZe(e){return new NC(e,.5)}function _Ze(e){return new NC(e,0)}function SZe(e){return new NC(e,1)}function Ov(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const EZe=()=>typeof Image!="undefined"?Image:null;function ol(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const SB=Symbol("implicit");function EB(){var e=new Map,t=[],n=[],r=SB;function i(a){var o=a+"",s=e.get(o);if(!s){if(r!==SB)return r;e.set(o,s=t.push(a))}return n[(s-1)%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of a){const s=o+"";e.has(s)||e.set(s,t.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return EB(t,n).unknown(r)},ol.apply(i,arguments),i}function Iv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function K1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function pd(){}var Ap=.7,Nv=1/Ap,Dv="\\s*([+-]?\\d+)\\s*",X1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",AZe=/^#([0-9a-f]{3,8})$/,CZe=new RegExp("^rgb\\("+[Dv,Dv,Dv]+"\\)$"),kZe=new RegExp("^rgb\\("+[sl,sl,sl]+"\\)$"),TZe=new RegExp("^rgba\\("+[Dv,Dv,Dv,X1]+"\\)$"),OZe=new RegExp("^rgba\\("+[sl,sl,sl,X1]+"\\)$"),IZe=new RegExp("^hsl\\("+[X1,sl,sl]+"\\)$"),NZe=new RegExp("^hsla\\("+[X1,sl,sl,X1]+"\\)$"),Woe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Iv(pd,Y1,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Voe,formatHex:Voe,formatHsl:DZe,formatRgb:qoe,toString:qoe});function Voe(){return this.rgb().formatHex()}function DZe(){return Yoe(this).formatHsl()}function qoe(){return this.rgb().formatRgb()}function Y1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=AZe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Hoe(t):n===3?new zi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?DC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?DC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=CZe.exec(e))?new zi(t[1],t[2],t[3],1):(t=kZe.exec(e))?new zi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=TZe.exec(e))?DC(t[1],t[2],t[3],t[4]):(t=OZe.exec(e))?DC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=IZe.exec(e))?Xoe(t[1],t[2]/100,t[3]/100,1):(t=NZe.exec(e))?Xoe(t[1],t[2]/100,t[3]/100,t[4]):Woe.hasOwnProperty(e)?Hoe(Woe[e]):e==="transparent"?new zi(NaN,NaN,NaN,0):null}function Hoe(e){return new zi(e>>16&255,e>>8&255,e&255,1)}function DC(e,t,n,r){return r<=0&&(e=t=n=NaN),new zi(e,t,n,r)}function AB(e){return e instanceof pd||(e=Y1(e)),e?(e=e.rgb(),new zi(e.r,e.g,e.b,e.opacity)):new zi}function gd(e,t,n,r){return arguments.length===1?AB(e):new zi(e,t,n,r??1)}function zi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Iv(zi,gd,K1(pd,{brighter:function(e){return e=e==null?Nv:Math.pow(Nv,e),new zi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ap:Math.pow(Ap,e),new zi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Goe,formatHex:Goe,formatRgb:Koe,toString:Koe}));function Goe(){return"#"+CB(this.r)+CB(this.g)+CB(this.b)}function Koe(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function CB(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Xoe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ul(e,t,n,r)}function Yoe(e){if(e instanceof ul)return new ul(e.h,e.s,e.l,e.opacity);if(e instanceof pd||(e=Y1(e)),!e)return new ul;if(e instanceof ul)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new ul(o,s,u,e.opacity)}function RC(e,t,n,r){return arguments.length===1?Yoe(e):new ul(e,t,n,r??1)}function ul(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Iv(ul,RC,K1(pd,{brighter:function(e){return e=e==null?Nv:Math.pow(Nv,e),new ul(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ap:Math.pow(Ap,e),new ul(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new zi(kB(e>=240?e-240:e+120,i,r),kB(e,i,r),kB(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function kB(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Zoe=Math.PI/180,Joe=180/Math.PI,FC=18,Qoe=.96422,ese=1,tse=.82521,nse=4/29,Rv=6/29,rse=3*Rv*Rv,RZe=Rv*Rv*Rv;function ise(e){if(e instanceof ll)return new ll(e.l,e.a,e.b,e.opacity);if(e instanceof Cc)return ase(e);e instanceof zi||(e=AB(e));var t=NB(e.r),n=NB(e.g),r=NB(e.b),i=TB((.2225045*t+.7168786*n+.0606169*r)/ese),a,o;return t===n&&n===r?a=o=i:(a=TB((.4360747*t+.3850649*n+.1430804*r)/Qoe),o=TB((.0139322*t+.0971045*n+.7141733*r)/tse)),new ll(116*i-16,500*(a-i),200*(i-o),e.opacity)}function MC(e,t,n,r){return arguments.length===1?ise(e):new ll(e,t,n,r??1)}function ll(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Iv(ll,MC,K1(pd,{brighter:function(e){return new ll(this.l+FC*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ll(this.l-FC*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Qoe*OB(t),e=ese*OB(e),n=tse*OB(n),new zi(IB(3.1338561*t-1.6168667*e-.4906146*n),IB(-.9787684*t+1.9161415*e+.033454*n),IB(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function TB(e){return e>RZe?Math.pow(e,1/3):e/rse+nse}function OB(e){return e>Rv?e*e*e:rse*(e-nse)}function IB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function NB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function FZe(e){if(e instanceof Cc)return new Cc(e.h,e.c,e.l,e.opacity);if(e instanceof ll||(e=ise(e)),e.a===0&&e.b===0)return new Cc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Joe;return new Cc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function PC(e,t,n,r){return arguments.length===1?FZe(e):new Cc(e,t,n,r??1)}function Cc(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function ase(e){if(isNaN(e.h))return new ll(e.l,0,0,e.opacity);var t=e.h*Zoe;return new ll(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Iv(Cc,PC,K1(pd,{brighter:function(e){return new Cc(this.h,this.c,this.l+FC*(e??1),this.opacity)},darker:function(e){return new Cc(this.h,this.c,this.l-FC*(e??1),this.opacity)},rgb:function(){return ase(this).rgb()}}));var ose=-.14861,DB=1.78277,RB=-.29227,$C=-.90649,Z1=1.97294,sse=Z1*$C,use=Z1*DB,lse=DB*RB-$C*ose;function MZe(e){if(e instanceof Cp)return new Cp(e.h,e.s,e.l,e.opacity);e instanceof zi||(e=AB(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(lse*r+sse*t-use*n)/(lse+sse-use),a=r-i,o=(Z1*(n-i)-RB*a)/$C,s=Math.sqrt(o*o+a*a)/(Z1*i*(1-i)),u=s?Math.atan2(o,a)*Joe-120:NaN;return new Cp(u<0?u+360:u,s,i,e.opacity)}function FB(e,t,n,r){return arguments.length===1?MZe(e):new Cp(e,t,n,r??1)}function Cp(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Iv(Cp,FB,K1(pd,{brighter:function(e){return e=e==null?Nv:Math.pow(Nv,e),new Cp(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ap:Math.pow(Ap,e),new Cp(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Zoe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new zi(255*(t+n*(ose*r+DB*i)),255*(t+n*(RB*r+$C*i)),255*(t+n*(Z1*r)),this.opacity)}}));function cse(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function fse(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return cse((n-r/t)*t,o,i,a,s)}}function dse(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return cse((n-r/t)*t,i,a,o,s)}}var LC=e=>()=>e;function hse(e,t){return function(n){return e+n*t}}function PZe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function BC(e,t){var n=t-e;return n?hse(e,n>180||n<-180?n-360*Math.round(n/360):n):LC(isNaN(e)?t:e)}function $Ze(e){return(e=+e)==1?Si:function(t,n){return n-t?PZe(t,n,e):LC(isNaN(t)?n:t)}}function Si(e,t){var n=t-e;return n?hse(e,n):LC(isNaN(e)?t:e)}var MB=function e(t){var n=$Ze(t);function r(i,a){var o=n((i=gd(i)).r,(a=gd(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=Si(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function pse(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=gd(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=a(u),s+""}}}var LZe=pse(fse),BZe=pse(dse);function PB(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function gse(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zZe(e,t){return(gse(t)?PB:mse)(e,t)}function mse(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=md(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function vse(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ou(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function yse(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=md(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var $B=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LB=new RegExp($B.source,"g");function jZe(e){return function(){return e}}function UZe(e){return function(t){return e(t)+""}}function bse(e,t){var n=$B.lastIndex=LB.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(e=e+"",t=t+"";(r=$B.exec(e))&&(i=LB.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:ou(r,i)})),n=LB.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?UZe(u[0].x):jZe(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function md(e,t){var n=typeof t,r;return t==null||n==="boolean"?LC(t):(n==="number"?ou:n==="string"?(r=Y1(t))?(t=r,MB):bse:t instanceof Y1?MB:t instanceof Date?vse:gse(t)?PB:Array.isArray(t)?mse:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?yse:ou)(e,t)}function WZe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function VZe(e,t){var n=BC(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function J1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var xse=180/Math.PI,BB={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wse(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*xse,skewX:Math.atan(u)*xse,scaleX:o,scaleY:s}}var zC;function qZe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?BB:wse(t.a,t.b,t.c,t.d,t.e,t.f)}function HZe(e){return e==null||(zC||(zC=document.createElementNS("http://www.w3.org/2000/svg","g")),zC.setAttribute("transform",e),!(e=zC.transform.baseVal.consolidate()))?BB:(e=e.matrix,wse(e.a,e.b,e.c,e.d,e.e,e.f))}function _se(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:ou(l,f)},{i:g-2,x:ou(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ou(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ou(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:ou(l,f)},{i:g-2,x:ou(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var GZe=_se(qZe,"px, ","px)","deg)"),KZe=_se(HZe,", ",")",")"),XZe=1e-12;function Sse(e){return((e=Math.exp(e))+1/e)/2}function YZe(e){return((e=Math.exp(e))-1/e)/2}function ZZe(e){return((e=Math.exp(2*e))-1)/(e+1)}var JZe=function e(t,n,r){function i(a,o){var s=a[0],u=a[1],l=a[2],c=o[0],f=o[1],d=o[2],h=c-s,p=f-u,g=h*h+p*p,m,v;if(g<XZe)v=Math.log(d/l)/t,m=function(A){return[s+A*h,u+A*p,l*Math.exp(t*A*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),x=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(x*x+1)-x);v=(S-w)/t,m=function(A){var _=A*v,E=Sse(w),C=l/(n*y)*(E*ZZe(t*_+w)-YZe(w));return[s+C*h,u+C*p,l*E/Sse(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,u=s*s;return e(o,s,u)},i}(Math.SQRT2,2,4);function Ese(e){return function(t,n){var r=e((t=RC(t)).h,(n=RC(n)).h),i=Si(t.s,n.s),a=Si(t.l,n.l),o=Si(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var QZe=Ese(BC),eJe=Ese(Si);function tJe(e,t){var n=Si((e=MC(e)).l,(t=MC(t)).l),r=Si(e.a,t.a),i=Si(e.b,t.b),a=Si(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function Ase(e){return function(t,n){var r=e((t=PC(t)).h,(n=PC(n)).h),i=Si(t.c,n.c),a=Si(t.l,n.l),o=Si(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var nJe=Ase(BC),rJe=Ase(Si);function Cse(e){return function t(n){n=+n;function r(i,a){var o=e((i=FB(i)).h,(a=FB(a)).h),s=Si(i.s,a.s),u=Si(i.l,a.l),l=Si(i.opacity,a.opacity);return function(c){return i.h=o(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var iJe=Cse(BC),aJe=Cse(Si);function zB(e,t){t===void 0&&(t=e,e=md);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function oJe(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var sJe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:md,interpolateArray:zZe,interpolateBasis:fse,interpolateBasisClosed:dse,interpolateDate:vse,interpolateDiscrete:WZe,interpolateHue:VZe,interpolateNumber:ou,interpolateNumberArray:PB,interpolateObject:yse,interpolateRound:J1,interpolateString:bse,interpolateTransformCss:GZe,interpolateTransformSvg:KZe,interpolateZoom:JZe,interpolateRgb:MB,interpolateRgbBasis:LZe,interpolateRgbBasisClosed:BZe,interpolateHsl:QZe,interpolateHslLong:eJe,interpolateLab:tJe,interpolateHcl:nJe,interpolateHclLong:rJe,interpolateCubehelix:iJe,interpolateCubehelixLong:aJe,piecewise:zB,quantize:oJe});function uJe(e){return function(){return e}}function jB(e){return+e}var kse=[0,1];function lo(e){return e}function UB(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:uJe(isNaN(t)?NaN:.5)}function lJe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function cJe(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=UB(i,r),a=n(o,a)):(r=UB(r,i),a=n(a,o)),function(s){return a(r(s))}}function fJe(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=UB(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var u=w1(e,s,1,r)-1;return a[u](i[u](s))}}function Q1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jC(){var e=kse,t=kse,n=md,r,i,a,o=lo,s,u,l;function c(){var d=Math.min(e.length,t.length);return o!==lo&&(o=lJe(e[0],e[d-1])),s=d>2?fJe:cJe,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?a:(u||(u=s(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=s(t,e.map(r),ou)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,jB),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=J1,c()},f.clamp=function(d){return arguments.length?(o=d?!0:lo,c()):o!==lo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function Tse(){return jC()(lo,lo)}function UC(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Fv(e){return e=UC(Math.abs(e)),e?e[1]:NaN}function dJe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function hJe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var pJe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ex(e){return new WB(e)}ex.prototype=WB.prototype;function WB(e){if(!(t=pJe.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}WB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gJe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Ose;function mJe(e,t){var n=UC(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Ose=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+UC(e,Math.max(0,t+a-1))[0]}function Ise(e,t){var n=UC(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Nse={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Ise(e*100,t)},r:Ise,s:mJe,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Dse(e){return e}var Rse=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Fse(e){var t=e.grouping&&e.thousands?dJe(e.grouping,e.thousands):Dse,n=e.currency,r=e.decimal,i=e.numerals?hJe(e.numerals):Dse,a=e.percent||"%";function o(u){u=ex(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,g=u.comma,m=u.precision,v=u.trim,y=u.type;y==="n"?(g=!0,y="g"):Nse[y]||(m==null&&(m=12),v=!0,y="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var b=d==="$"?n[0]:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(y)?a:"",w=Nse[y],S=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function A(_){var E=b,C=x,k,T,I;if(y==="c")C=w(_)+C,_="";else{_=+_;var N=_<0;if(_=w(Math.abs(_),m),v&&(_=gJe(_)),N&&+_==0&&(N=!1),E=(N?f==="("?f:"-":f==="-"||f==="("?"":f)+E,C=(y==="s"?Rse[8+Ose/3]:"")+C+(N&&f==="("?")":""),S){for(k=-1,T=_.length;++k<T;)if(I=_.charCodeAt(k),48>I||I>57){C=(I===46?r+_.slice(k+1):_.slice(k))+C,_=_.slice(0,k);break}}}g&&!h&&(_=t(_,1/0));var O=E.length+_.length+C.length,D=O<p?new Array(p-O+1).join(l):"";switch(g&&h&&(_=t(D+_,D.length?p-C.length:1/0),D=""),c){case"<":_=E+_+C+D;break;case"=":_=E+D+_+C;break;case"^":_=D.slice(0,O=D.length>>1)+E+_+C+D.slice(O);break;default:_=D+E+_+C;break}return i(_)}return A.toString=function(){return u+""},A}function s(u,l){var c=o((u=ex(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Fv(l)/3)))*3,d=Math.pow(10,-f),h=Rse[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:s}}var WC,VC,VB;Mse({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function Mse(e){return WC=Fse(e),VC=WC.format,VB=WC.formatPrefix,WC}function Pse(e){return Math.max(0,-Fv(Math.abs(e)))}function $se(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fv(t)/3)))*3-Fv(Math.abs(e)))}function Lse(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fv(t)-Fv(e))+1}var vJe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",formatDefaultLocale:Mse,get format(){return VC},get formatPrefix(){return VB},formatLocale:Fse,formatSpecifier:ex,precisionFixed:Pse,precisionPrefix:$se,precisionRound:Lse});function Bse(e,t,n,r){var i=nd(e,t,n),a;switch(r=ex(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=$se(i,o))&&(r.precision=a),VB(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Lse(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Pse(i))&&(r.precision=a-(r.type==="%")*2);break}}return VC(r)}function kp(e){var t=e.domain;return e.ticks=function(n){var r=t();return zL(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Bse(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=iie(o,s,n),l===u)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function zse(){var e=Tse();return e.copy=function(){return Q1(e,zse())},ol.apply(e,arguments),kp(e)}function jse(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,jB),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return jse(e).unknown(t)},e=arguments.length?Array.from(e,jB):[0,1],kp(n)}function Use(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function Wse(e){return Math.log(e)}function Vse(e){return Math.exp(e)}function yJe(e){return-Math.log(-e)}function bJe(e){return-Math.exp(-e)}function xJe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function wJe(e){return e===10?xJe:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function _Je(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function qse(e){return function(t){return-e(-t)}}function qB(e){var t=e(Wse,Vse),n=t.domain,r=10,i,a;function o(){return i=_Je(r),a=wJe(r),n()[0]<0?(i=qse(i),a=qse(a),e(yJe,bJe)):e(Wse,Vse),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,g,m,v=s==null?10:+s,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=a(d);g<r;++g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=a(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}y.length*2<v&&(y=zL(l,c,v))}else y=zL(d,h,Math.min(h-d,v)).map(a);return f?y.reverse():y},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=VC(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(Use(n(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function Hse(){var e=qB(jC()).domain([1,10]);return e.copy=function(){return Q1(e,Hse()).base(e.base())},ol.apply(e,arguments),e}function Gse(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Kse(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function HB(e){var t=1,n=e(Gse(t),Kse(t));return n.constant=function(r){return arguments.length?e(Gse(t=+r),Kse(t)):t},kp(n)}function Xse(){var e=HB(jC());return e.copy=function(){return Q1(e,Xse()).constant(e.constant())},ol.apply(e,arguments)}function Yse(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function SJe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function EJe(e){return e<0?-e*e:e*e}function GB(e){var t=e(lo,lo),n=1;function r(){return n===1?e(lo,lo):n===.5?e(SJe,EJe):e(Yse(n),Yse(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},kp(t)}function KB(){var e=GB(jC());return e.copy=function(){return Q1(e,KB()).exponent(e.exponent())},ol.apply(e,arguments),e}function AJe(){return KB.apply(null,arguments).exponent(.5)}function Zse(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=oie(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[w1(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(vv),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return Zse().domain(e).range(t).unknown(r)},ol.apply(a,arguments)}function Jse(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(u){return u!=null&&u<=u?i[w1(r,u,0,n)]:a}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Jse().domain([e,t]).range(i).unknown(a)},ol.apply(kp(o),arguments)}function Qse(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[w1(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Qse().domain(e).range(t).unknown(n)},ol.apply(i,arguments)}function CJe(e){return new Date(e)}function kJe(e){return e instanceof Date?+e:+new Date(+e)}function XB(e,t,n,r,i,a,o,s,u,l){var c=Tse(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:s(S)<S?p:o(S)<S?g:a(S)<S?m:r(S)<S?i(S)<S?v:y:n(S)<S?b:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,kJe)):d().map(CJe)},c.ticks=function(S){var A=d();return e(A[0],A[A.length-1],S??10)},c.tickFormat=function(S,A){return A==null?w:l(A)},c.nice=function(S){var A=d();return(!S||typeof S.range!="function")&&(S=t(A[0],A[A.length-1],S??10)),S?d(Use(A,S)):c},c.copy=function(){return Q1(c,XB(e,t,n,r,i,a,o,s,u,l))},c}function TJe(){return ol.apply(XB(YGe,ZGe,ad,iC,E1,id,ZL,YL,rd,h4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function OJe(){return ol.apply(XB(KGe,XGe,sd,aC,C1,od,e4,QL,rd,p4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function qC(){var e=0,t=1,n,r,i,a,o=lo,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(md),l.rangeRound=c(J1),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function vd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function YB(){var e=kp(qC()(lo));return e.copy=function(){return vd(e,YB())},hd.apply(e,arguments)}function eue(){var e=qB(qC()).domain([1,10]);return e.copy=function(){return vd(e,eue()).base(e.base())},hd.apply(e,arguments)}function tue(){var e=HB(qC());return e.copy=function(){return vd(e,tue()).constant(e.constant())},hd.apply(e,arguments)}function ZB(){var e=GB(qC());return e.copy=function(){return vd(e,ZB()).exponent(e.exponent())},hd.apply(e,arguments)}function IJe(){return ZB.apply(null,arguments).exponent(.5)}function HC(){var e=0,t=.5,n=1,r=1,i,a,o,s,u,l=lo,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-a)*(r*g<r*a?s:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),a=c(t=+t),o=c(n=+n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=zB(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(md),h.rangeRound=p(J1),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),a=g(t),o=g(n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function nue(){var e=kp(HC()(lo));return e.copy=function(){return vd(e,nue())},hd.apply(e,arguments)}function rue(){var e=qB(HC()).domain([.1,1,10]);return e.copy=function(){return vd(e,rue()).base(e.base())},hd.apply(e,arguments)}function iue(){var e=HB(HC());return e.copy=function(){return vd(e,iue()).constant(e.constant())},hd.apply(e,arguments)}function JB(){var e=GB(HC());return e.copy=function(){return vd(e,JB()).exponent(e.exponent())},hd.apply(e,arguments)}function NJe(){return JB.apply(null,arguments).exponent(.5)}function QB(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const DJe="identity",Mv="linear",kc="log",tx="pow",nx="sqrt",GC="symlog",Tp="time",Op="utc",cl="sequential",Pv="diverging",$v="quantile",KC="quantize",XC="threshold",ez="ordinal",tz="point",aue="band",nz="bin-ordinal",li="continuous",rx="discrete",ix="discretizing",gs="interpolating",rz="temporal";function RJe(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function FJe(e){return function(t){const n=e.range();let r=t[0],i=t[1],a=-1,o,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(a<0&&(a=u),o=u);if(!(a<0))return r=e.invertExtent(n[a]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function iz(){const e=EB().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,a,o=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=QB(f,s,u);let g=r[d-0];i=(h-g)/(p||1),o&&(i=Math.floor(i)),g+=(h-g-i*(f-s))*l,a=i*(1-s),o&&(g=Math.round(g),a=Math.round(a));const m=jo(f).map(v=>g+i*v);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>r[1-d])))return v=Math.max(0,tC(h,g)-1),y=g===m?v:tC(h,m)-1,g-h[v]>a+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return iz().domain(t()).range(r).round(o).paddingInner(s).paddingOuter(u).align(l)},c()}function oue(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return oue(t())},e}function MJe(){return oue(iz().paddingInner(1))}var PJe=Array.prototype.map;function $Je(e){return PJe.call(e,Zi)}const LJe=Array.prototype.slice;function sue(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(w1(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=$Je(r),n):e.slice()},n.range=function(r){return arguments.length?(t=LJe.call(r),n):t.slice()},n.tickFormat=function(r,i){return Bse(e[0],sn(e),r??10,i)},n.copy=function(){return sue().domain(n.domain()).range(n.range())},n}const YC={};function BJe(e,t,n){const r=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?RJe(a):a.invertExtent?FJe(a):void 0),a.type=e,a};return r.metadata=iu(wt(n)),r}function Sn(e,t,n){return arguments.length>1?(YC[e]=BJe(e,t,n),this):uue(e)?YC[e]:void 0}Sn(DJe,jse),Sn(Mv,zse,li),Sn(kc,Hse,[li,kc]),Sn(tx,KB,li),Sn(nx,AJe,li),Sn(GC,Xse,li),Sn(Tp,TJe,[li,rz]),Sn(Op,OJe,[li,rz]),Sn(cl,YB,[li,gs]),Sn("".concat(cl,"-").concat(Mv),YB,[li,gs]),Sn("".concat(cl,"-").concat(kc),eue,[li,gs,kc]),Sn("".concat(cl,"-").concat(tx),ZB,[li,gs]),Sn("".concat(cl,"-").concat(nx),IJe,[li,gs]),Sn("".concat(cl,"-").concat(GC),tue,[li,gs]),Sn("".concat(Pv,"-").concat(Mv),nue,[li,gs]),Sn("".concat(Pv,"-").concat(kc),rue,[li,gs,kc]),Sn("".concat(Pv,"-").concat(tx),JB,[li,gs]),Sn("".concat(Pv,"-").concat(nx),NJe,[li,gs]),Sn("".concat(Pv,"-").concat(GC),iue,[li,gs]),Sn($v,Zse,[ix,$v]),Sn(KC,Jse,ix),Sn(XC,Qse,ix),Sn(nz,sue,[rx,ix]),Sn(ez,EB,rx),Sn(aue,iz,rx),Sn(tz,MJe,rx);function uue(e){return _t(YC,e)}function Ip(e,t){const n=YC[e];return n&&n.metadata[t]}function az(e){return Ip(e,li)}function Lv(e){return Ip(e,rx)}function oz(e){return Ip(e,ix)}function lue(e){return Ip(e,kc)}function zJe(e){return Ip(e,rz)}function cue(e){return Ip(e,gs)}function fue(e){return Ip(e,$v)}const jJe=["clamp","base","constant","exponent"];function due(e,t){const n=t[0],r=sn(t)-n;return function(i){return e(n+i*r)}}function ZC(e,t,n){return zB(sz(t||"rgb",n),e)}function hue(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function pue(e,t,n){const r=n-t;let i,a,o;return!r||!Number.isFinite(r)?Ji(.5):(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Sn(a)().domain([t,n]).range([0,1]),jJe.forEach(s=>e[s]?o[s](e[s]()):0),o)}function sz(e,t){const n=sJe[UJe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function UJe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const WJe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},VJe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function gue(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function mue(e,t){for(const n in e)uz(n,t(e[n]))}const vue={};mue(VJe,gue),mue(WJe,e=>ZC(gue(e)));function uz(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(vue[e]=t,this):vue[e]}const JC="symbol",qJe="discrete",HJe="gradient",GJe=e=>ut(e)?e.map(t=>String(t)):String(e),KJe=(e,t)=>e[1]-t[1],XJe=(e,t)=>t[1]-e[1];function lz(e,t,n){let r;return ed(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(y1(e.domain())/n||1)))),Nt(t)&&(r=t.step,t=t.interval),Bn(t)&&(t=e.type===Tp?xv(t):e.type==Op?wv(t):Se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function yue(e,t,n){let r=e.range(),i=r[0],a=sn(r),o=KJe;if(i>a&&(r=a,a=i,i=r,o=XJe),i=Math.floor(i),a=Math.ceil(a),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=a).sort(o).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],sn(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function cz(e,t){return e.bins?yue(e,e.bins):e.ticks?e.ticks(t):e.domain()}function bue(e,t,n,r,i,a){const o=t.type;let s=GJe;if(o===Tp||i===Tp)s=e.timeFormat(r);else if(o===Op||i===Op)s=e.utcFormat(r);else if(lue(o)){const u=e.formatFloat(r);if(a||t.bins)s=u;else{const l=xue(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function xue(e,t,n){const r=cz(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(s):s}const fz={[$v]:"quantiles",[KC]:"thresholds",[XC]:"domain"},wue={[$v]:"quantiles",[KC]:"domain"};function _ue(e,t){return e.bins?JJe(e.bins):e.type===kc?xue(e,t,!0):fz[e.type]?ZJe(e[fz[e.type]]()):cz(e,t)}function YJe(e,t,n){const r=t[wue[t.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,3*10,n)}function ZJe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function JJe(e){const t=e.slice(0,-1);return t.max=sn(e),t}const QJe=e=>fz[e.type]||e.bins;function Sue(e,t,n,r,i,a,o){const s=wue[t.type]&&a!==Tp&&a!==Op?YJe(e,t,i):bue(e,t,n,i,a,o);return r===JC&&QJe(t)?eQe(s):r===qJe?tQe(s):nQe(s)}const eQe=e=>(t,n,r)=>{const i=Eue(r[n+1],Eue(r.max,1/0)),a=Aue(t,e),o=Aue(i,e);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},Eue=(e,t)=>e??t,tQe=e=>(t,n)=>n?e(t):null,nQe=e=>t=>e(t),Aue=(e,t)=>Number.isFinite(e)?t(e):null;function rQe(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+sn(t),a=i-r;if(e.type===XC){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function iQe(e,t,n,r){const i=r||t.type;return Bn(n)&&zJe(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Tp?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Op?e.utcFormat("%A, %d %B %Y, %X UTC"):Sue(e,t,5,null,n,r,!0)}function Cue(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=iQe(e,t,n.format,n.formatType);if(oz(t.type)){const a=_ue(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(Lv(t.type)){const a=t.domain(),o=a.length,s=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(s)}else{const a=t.domain();return"values from ".concat(i(a[0])," to ").concat(i(sn(a)))}}let kue=0;function aQe(){kue=0}const QC="p_";function dz(e){return e&&e.gradient}function Tue(e,t,n){const r=e.gradient;let i=e.id,a=r==="radial"?QC:"";return i||(i=e.id="gradient_"+kue++,r==="radial"?(e.x1=fl(e.x1,.5),e.y1=fl(e.y1,.5),e.r1=fl(e.r1,0),e.x2=fl(e.x2,.5),e.y2=fl(e.y2,.5),e.r2=fl(e.r2,.5),a=QC):(e.x1=fl(e.x1,0),e.y1=fl(e.y1,0),e.x2=fl(e.x2,1),e.y2=fl(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+a+i+")"}function fl(e,t){return e??t}function Oue(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const Iue={basis:{curve:sZe},"basis-closed":{curve:uZe},"basis-open":{curve:lZe},bundle:{curve:cZe,tension:"beta",value:.85},cardinal:{curve:fZe,tension:"tension",value:0},"cardinal-open":{curve:hZe,tension:"tension",value:0},"cardinal-closed":{curve:dZe,tension:"tension",value:0},"catmull-rom":{curve:pZe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:gZe,tension:"alpha",value:.5},"catmull-rom-open":{curve:mZe,tension:"alpha",value:.5},linear:{curve:vB},"linear-closed":{curve:vZe},monotone:{horizontal:bZe,vertical:yZe},natural:{curve:xZe},step:{curve:wZe},"step-after":{curve:SZe},"step-before":{curve:_Ze}};function hz(e,t,n){var r=_t(Iue,e)&&Iue[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const oQe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},ax=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Bv(e){const t=[];let n,r,i,a,o,s,u,l,c,f;const d=e.slice().replace(ax[0],"###$1").split(ax[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(ax[2],"$1###$2").replace(ax[3],"$1###$2").split(ax[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(s=oQe[o.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=s))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=s)t.push([o].concat(i.slice(l,l+s)))}else t.push(i)}return t}const yd=Math.PI/180,sQe=1e-14,Np=Math.PI/2,dl=Math.PI*2,zv=Math.sqrt(3)/2;var pz={},gz={},Nue=[].join;function uQe(e,t,n,r,i,a,o,s,u){const l=Nue.call(arguments);if(pz[l])return pz[l];const c=o*yd,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,x=m*s+v*u,w=y*s+b*u,S=m*e+v*t,A=y*e+b*t,_=(S-x)*(S-x)+(A-w)*(A-w);let E=1/_-.25;E<0&&(E=0);let C=Math.sqrt(E);a==i&&(C=-C);const k=.5*(x+S)-C*(A-w),T=.5*(w+A)+C*(S-x),I=Math.atan2(w-T,x-k);let O=Math.atan2(A-T,S-k)-I;O<0&&a===1?O+=dl:O>0&&a===0&&(O-=dl);const D=Math.ceil(Math.abs(O/(Np+.001))),L=[];for(let W=0;W<D;++W){const G=I+W*O/D,K=I+(W+1)*O/D;L[W]=[k,T,G,K,n,r,f,d]}return pz[l]=L}function lQe(e){const t=Nue.call(e);if(gz[t])return gz[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7];const c=l*o,f=-u*s,d=u*o,h=l*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,S=r+g+x*p,A=n+m,_=r+v,E=A+x*v,C=_-x*m;return gz[t]=[c*w+f*S,d*w+h*S,c*E+f*C,d*E+h*C,c*A+f*_,d*A+h*_]}const ms=["l",0,0,0,0,0,0,0];function cQe(e,t,n){const r=ms[0]=e[0];if(r==="a"||r==="A")ms[1]=t*e[1],ms[2]=n*e[2],ms[3]=e[3],ms[4]=e[4],ms[5]=e[5],ms[6]=t*e[6],ms[7]=n*e[7];else if(r==="h"||r==="H")ms[1]=t*e[1];else if(r==="v"||r==="V")ms[1]=n*e[1];else for(var i=1,a=e.length;i<a;++i)ms[i]=(i%2==1?t:n)*e[i];return ms}function ox(e,t,n,r,i,a){var o,s=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(o=t[m],(i!==1||a!==1)&&(o=cQe(o,i,a)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-p,f=2*l-g):s[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":Due(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":Due(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}s=o}}function Due(e,t,n,r){const i=uQe(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let a=0;a<i.length;++a){const o=lQe(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Rue=.5773502691896257,Fue={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,dl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n,i=r-n*Rue,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n,i=r-n*Rue;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=zv*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Mue(e){return _t(Fue,e)?Fue[e]:fQe(e)}var mz={};function fQe(e){if(!_t(mz,e)){const t=Bv(e);mz[e]={draw:function(n,r){ox(n,t,0,0,Math.sqrt(r)/2)}}}return mz[e]}const bd=.448084975506;function dQe(e){return e.x}function hQe(e){return e.y}function pQe(e){return e.width}function gQe(e){return e.height}function Tc(e){return typeof e=="function"?e:()=>+e}function ek(e,t,n){return Math.max(t,Math.min(e,n))}function Pue(){var e=dQe,t=hQe,n=pQe,r=gQe,i=Tc(0),a=i,o=i,s=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=ek(+i.call(this,c),0,y),x=ek(+a.call(this,c),0,y),w=ek(+o.call(this,c),0,y),S=ek(+s.call(this,c),0,y);if(u||(u=h=Sp()),b<=0&&x<=0&&w<=0&&S<=0)u.rect(p,g,m,v);else{var A=p+m,_=g+v;u.moveTo(p+b,g),u.lineTo(A-x,g),u.bezierCurveTo(A-bd*x,g,A,g+bd*x,A,g+x),u.lineTo(A,_-S),u.bezierCurveTo(A,_-bd*S,A-bd*S,_,A-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+bd*w,_,p,_-bd*w,p,_-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+bd*b,p+bd*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Tc(c),l):e},l.y=function(c){return arguments.length?(t=Tc(c),l):t},l.width=function(c){return arguments.length?(n=Tc(c),l):n},l.height=function(c){return arguments.length?(r=Tc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Tc(c),a=f!=null?Tc(f):i,s=d!=null?Tc(d):i,o=h!=null?Tc(h):a,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function $ue(){var e,t,n,r,i=null,a,o,s,u;function l(f,d,h){const p=h/2;if(a){var g=s-d,m=f-o;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,x=Math.atan2(m,g);i.moveTo(o-y,s-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,x-Math.PI,x),i.lineTo(o+y,s+b),i.arc(o,s,u,x,x+Math.PI)}else i.arc(f,d,p,0,dl);i.closePath()}else a=1;o=f,s=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=Sp()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(a=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function sx(e,t){return e??t}const ux=e=>e.x||0,lx=e=>e.y||0,mQe=e=>e.width||0,vQe=e=>e.height||0,yQe=e=>(e.x||0)+(e.width||0),bQe=e=>(e.y||0)+(e.height||0),xQe=e=>e.startAngle||0,wQe=e=>e.endAngle||0,_Qe=e=>e.padAngle||0,SQe=e=>e.innerRadius||0,EQe=e=>e.outerRadius||0,AQe=e=>e.cornerRadius||0,CQe=e=>sx(e.cornerRadiusTopLeft,e.cornerRadius)||0,kQe=e=>sx(e.cornerRadiusTopRight,e.cornerRadius)||0,TQe=e=>sx(e.cornerRadiusBottomRight,e.cornerRadius)||0,OQe=e=>sx(e.cornerRadiusBottomLeft,e.cornerRadius)||0,IQe=e=>sx(e.size,64),NQe=e=>e.size||1,tk=e=>e.defined!==!1,DQe=e=>Mue(e.shape||"circle"),RQe=iZe().startAngle(xQe).endAngle(wQe).padAngle(_Qe).innerRadius(SQe).outerRadius(EQe).cornerRadius(AQe),FQe=Toe().x(ux).y1(lx).y0(bQe).defined(tk),MQe=Toe().y(lx).x1(ux).x0(yQe).defined(tk),PQe=koe().x(ux).y(lx).defined(tk),$Qe=Pue().x(ux).y(lx).width(mQe).height(vQe).cornerRadius(CQe,kQe,TQe,OQe),LQe=oZe().type(DQe).size(IQe),BQe=$ue().x(ux).y(lx).defined(tk).size(NQe);function vz(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function zQe(e,t){return RQe.context(e)(t)}function jQe(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?MQe:FQe).curve(hz(r,n.orient,n.tension)).context(e)(t)}function UQe(e,t){const n=t[0],r=n.interpolate||"linear";return PQe.curve(hz(r,n.orient,n.tension)).context(e)(t)}function jv(e,t,n,r){return $Qe.context(e)(t,n,r)}function WQe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function VQe(e,t){return LQe.context(e)(t)}function qQe(e,t){return BQe.context(e)(t)}var Lue=1;function Bue(){Lue=1}function yz(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Lue++),o=i.clipping[a]||(i.clipping[a]={id:a});return Lt(r)?o.path=r(null):vz(n)?o.path=jv(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function ci(e){this.clear(),e&&this.union(e)}ci.prototype={clone(){return new ci(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*o+l,u*r+s*o+c,s*a-u*i+l,u*a+s*i+c,s*a-u*o+l,u*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function nk(e){this.mark=e,this.bounds=this.bounds||new ci}function rk(e){nk.call(this,e),this.items=this.items||[]}$e(rk,nk);function bz(e){this._pending=0,this._loader=e||uC()}function zue(e){e._pending+=1}function cx(e){e._pending-=1}bz.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return zue(t),t._loader.sanitize(e,{context:"href"}).then(n=>(cx(t),n)).catch(()=>(cx(t),null))},loadImage(e){const t=this,n=EZe();return zue(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=_t(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>cx(t),a.onerror=()=>cx(t),a.src=i,a}).catch(r=>(cx(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Oc(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?HQe(t,r):0))}return e}function HQe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const GQe=dl-1e-8;let ik,ak,ok,Dp,xz,sk,wz,_z;const xd=(e,t)=>ik.add(e,t),uk=(e,t)=>xd(ak=e,ok=t),jue=e=>xd(e,ik.y1),Uue=e=>xd(ik.x1,e),Rp=(e,t)=>xz*e+wz*t,Fp=(e,t)=>sk*e+_z*t,Sz=(e,t)=>xd(Rp(e,t),Fp(e,t)),Ez=(e,t)=>uk(Rp(e,t),Fp(e,t));function fx(e,t){return ik=e,t?(Dp=t*yd,xz=_z=Math.cos(Dp),sk=Math.sin(Dp),wz=-sk):(xz=_z=1,Dp=sk=wz=0),KQe}const KQe={beginPath(){},closePath(){},moveTo:Ez,lineTo:Ez,rect(e,t,n,r){Dp?(Sz(e+n,t),Sz(e+n,t+r),Sz(e,t+r),Ez(e,t)):(xd(e+n,t+r),uk(e,t))},quadraticCurveTo(e,t,n,r){const i=Rp(e,t),a=Fp(e,t),o=Rp(n,r),s=Fp(n,r);Wue(ak,i,o,jue),Wue(ok,a,s,Uue),uk(o,s)},bezierCurveTo(e,t,n,r,i,a){const o=Rp(e,t),s=Fp(e,t),u=Rp(n,r),l=Fp(n,r),c=Rp(i,a),f=Fp(i,a);Vue(ak,o,u,c,jue),Vue(ok,s,l,f,Uue),uk(c,f)},arc(e,t,n,r,i,a){if(r+=Dp,i+=Dp,ak=n*Math.cos(i)+e,ok=n*Math.sin(i)+t,Math.abs(i-r)>GQe)xd(e-n,t-n),xd(e+n,t+n);else{const o=l=>xd(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(o(r),o(i),i!==r)if(r=r%dl,r<0&&(r+=dl),i=i%dl,i<0&&(i+=dl),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=dl,s=r-r%Np,u=0;u<4&&s>i;++u,s-=Np)o(s);else for(s=r-r%Np+Np,u=0;u<4&&s<i;++u,s=s+Np)o(s)}}};function Wue(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Vue(e,t,n,r,i){const a=r-e+3*t-3*n,o=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(a)>sQe?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(que(u,e,t,n,r)),0<l&&l<1&&i(que(l,e,t,n,r))}function que(e,t,n,r,i){const a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*r+s*e*i}var wd=(wd=Ov(1,1))?wd.getContext("2d"):null;const Az=new ci;function Cz(e){return function(t,n){if(!wd)return!0;e(wd,t),Az.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=Az;for(let s=i;s<=o;++s)for(let u=r;u<=a;++u)if(wd.isPointInPath(u,s))return!0;return!1}}function kz(e,t){return t.contains(e.x||0,e.y||0)}function Hue(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Az.set(n,r,n+i,r+a))}function Gue(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return Uv(t,n,r,i,a)}function Uv(e,t,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(a-t)),m===1&&(h=l,p=s-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Wv(e,t){e.globalCompositeOperation=t.blend||"source-over"}function su(e,t){return e??t}function Kue(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function XQe(e,t,n){const r=n.width(),i=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+su(t.x1,.5)*r,n.y1+su(t.y1,.5)*i,Math.max(r,i)*su(t.r1,0),n.x1+su(t.x2,.5)*r,n.y1+su(t.y2,.5)*i,Math.max(r,i)*su(t.r2,.5));else{const o=su(t.x1,0),s=su(t.y1,0),u=su(t.x2,1),l=su(t.y2,0);if(o===u||s===l||r===i)a=e.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=Ov(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=Kue(f.createLinearGradient(o,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return Kue(a,t.stops)}function Xue(e,t,n){return dz(n)?XQe(e,n,t.bounds):n}function lk(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Xue(e,t,t.fill),!0):!1}var YQe=[];function Vv(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Xue(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||YQe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function ZQe(e,t){return e.zindex-t.zindex||e.index-t.index}function Tz(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(ZQe)}function uu(e,t){var n=e.items,r,i;if(!n||!n.length)return;const a=Tz(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=a}for(r=0,i=n.length;r<i;++r)t(n[r])}function ck(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const a=Tz(e);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===a){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Oz(e){return function(t,n,r){uu(n,i=>{(!r||r.intersects(i.bounds))&&Yue(e,t,i,i)})}}function JQe(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&Yue(e,t,n.items[0],n.items)}}function Yue(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Wv(t,n),n.fill&&lk(t,n,i)&&t.fill(),n.stroke&&Vv(t,n,i)&&t.stroke()))}function fk(e){return e=e||fs,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,ck(n,s=>{const u=s.bounds;if(!(u&&!u.contains(a,o)||!u)&&e(t,s,r,i,a,o))return s})}}function dx(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,s=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:s&&n.isPointInPath(i,a)||u&&n.isPointInStroke(i,a)}}function Iz(e){return fk(dx(e))}function Mp(e,t){return"translate("+e+","+t+")"}function Nz(e){return"rotate("+e+")"}function QQe(e,t){return"scale("+e+","+t+")"}function Zue(e){return Mp(e.x||0,e.y||0)}function eet(e){return Mp(e.x||0,e.y||0)+(e.angle?" "+Nz(e.angle):"")}function tet(e){return Mp(e.x||0,e.y||0)+(e.angle?" "+Nz(e.angle):"")+(e.scaleX||e.scaleY?" "+QQe(e.scaleX||1,e.scaleY||1):"")}function Dz(e,t,n){function r(o,s){o("transform",eet(s)),o("d",t(null,s))}function i(o,s){return t(fx(o,s.angle),s),Oc(o,s).translate(s.x||0,s.y||0)}function a(o,s){var u=s.x||0,l=s.y||0,c=s.angle||0;o.translate(u,l),c&&o.rotate(c*=yd),o.beginPath(),t(o,s),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Oz(a),pick:Iz(a),isect:n||Cz(a)}}var net=Dz("arc",zQe);function ret(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=1/0,o,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<a&&(a=s,o=e[i]));return o}function iet(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],a=e[r].y-t[1],o=i*i+a*a,o<n))return e[r];return null}function aet(e,t){for(var n=e.length,r,i,a;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],a=r*r+i*i,r=e[n].size||1,a<r*r))return e[n];return null}function Rz(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(fx(u),c),Oc(u,c[0]))}function a(u,l){u.beginPath(),t(u,l)}const o=dx(a);function s(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:JQe(a),pick:s,isect:kz,tip:n}}var oet=Rz("area",jQe,ret);function set(e,t){var n=t.clip;e.save(),Lt(n)?(e.beginPath(),n(e),e.clip()):Jue(e,t.group)}function Jue(e,t){e.beginPath(),vz(t)?jv(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Que(e){const t=su(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function uet(e,t){e("transform",Zue(t))}function ele(e,t){const n=Que(t);e("d",jv(null,t,n,n))}function cet(e,t){e("class","background"),e("aria-hidden",!0),ele(e,t)}function fet(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?ele(e,t):e("d","")}function det(e,t,n){const r=t.clip?yz(n,t,t):null;e("clip-path",r)}function het(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Oc(e,t),e.translate(t.x||0,t.y||0)}function hx(e,t,n,r){const i=Que(t);e.beginPath(),jv(e,t,(n||0)+i,(r||0)+i)}const pet=dx(hx),get=dx(hx,!1),met=dx(hx,!0);function vet(e,t,n){uu(t,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(hx(e,r,i,a),Wv(e,r),r.fill&&lk(e,r,s)&&e.fill(),r.stroke&&!o&&Vv(e,r,s)&&e.stroke()),e.save(),e.translate(i,a),r.clip&&Jue(e,r),n&&n.translate(-i,-a),uu(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,a),e.restore(),o&&r.stroke&&s&&(hx(e,r,i,a),Wv(e,r),Vv(e,r,s)&&e.stroke())})}function yet(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;const o=n*e.pixelRatio,s=r*e.pixelRatio;return ck(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,a))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||a<f||a>p))return;if(e.save(),e.translate(c,f),c=i-c,f=a-f,g&&vz(u)&&!met(e,u,o,s))return e.restore(),null;const m=u.strokeForeground,v=t.interactive!==!1;return v&&m&&u.stroke&&get(e,u,o,s)?(e.restore(),u):(l=ck(u,y=>bet(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&pet(e,u,o,s)&&(l=u),e.restore(),l||null)})}function bet(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var xet={type:"group",tag:"g",nested:!1,attr:uet,bound:het,draw:vet,pick:yet,isect:Hue,content:det,background:cet,foreground:fet},px={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Fz(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Mz(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Pz(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function dk(e,t){return e==="center"?t/2:e==="right"?t:0}function hk(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function wet(e,t,n){const r=Fz(t,n),i=Mz(t,r),a=Pz(t,r),o=(t.x||0)-dk(t.align,i),s=(t.y||0)-hk(t.baseline,a),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,px["xmlns:xlink"],"xlink:href"),e("transform",Mp(o,s)),e("width",i),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function _et(e,t){const n=t.image,r=Mz(t,n),i=Pz(t,n),a=(t.x||0)-dk(t.align,r),o=(t.y||0)-hk(t.baseline,i);return e.set(a,o,a+r,o+i)}function Eet(e,t,n){uu(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=Fz(r,this);let a=Mz(r,i),o=Pz(r,i);if(a===0||o===0)return;let s=(r.x||0)-dk(r.align,a),u=(r.y||0)-hk(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=a/c,u+=(o-d)/2,o=d):(d=o*c,s+=(a-d)/2,a=d))),(i.complete||i.toDataURL)&&(Wv(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,a,o))})}var Aet={type:"image",tag:"image",nested:!1,attr:wet,bound:_et,draw:Eet,pick:fk(),isect:fs,get:Fz,xOffset:dk,yOffset:hk},Cet=Rz("line",UQe,iet);function ket(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",tet(t)),e("d",t.path)}function pk(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*yd,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Bv(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),ox(e,u,0,0,a,o),e.rotate(-s),e.translate(-r,-i)):ox(e,u,r,i,a,o)}function Tet(e,t){return pk(fx(e,t.angle),t)?e.set(0,0,0,0):Oc(e,t,!0)}var Oet={type:"path",tag:"path",nested:!1,attr:ket,bound:Tet,draw:Oz(pk),pick:Iz(pk),isect:Cz(pk)};function Iet(e,t){e("d",jv(null,t))}function Net(e,t){var n,r;return Oc(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function tle(e,t){e.beginPath(),jv(e,t)}var Det={type:"rect",tag:"path",nested:!1,attr:Iet,bound:Net,draw:Oz(tle),pick:Iz(tle),isect:Hue};function Ret(e,t){e("transform",Zue(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Fet(e,t){var n,r;return Oc(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function nle(e,t,n){var r,i,a,o;return t.stroke&&Vv(e,t,n)?(r=t.x||0,i=t.y||0,a=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0):!1}function Met(e,t,n){uu(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&nle(e,r,i)&&(Wv(e,r),e.stroke())}})}function Pet(e,t,n,r){return e.isPointInStroke?nle(e,t,1)&&e.isPointInStroke(n,r):!1}var $et={type:"rule",tag:"line",nested:!1,attr:Ret,bound:Fet,draw:Met,pick:fk(Pet),isect:Gue},Let=Dz("shape",WQe),Bet=Dz("symbol",VQe,kz);const rle=zre();var hl={height:pl,measureWidth:Lz,estimateWidth:$z,width:$z,canvas:ile};ile(!0);function ile(e){hl.width=e&&wd?Lz:$z}function $z(e,t){return ale(Sd(e,t),pl(e))}function ale(e,t){return~~(.8*e.length*t)}function Lz(e,t){return pl(e)<=0||!(t=Sd(e,t))?0:ole(t,gk(e))}function ole(e,t){const n=`(${t}) ${e}`;let r=rle.get(n);return r===void 0&&(wd.font=t,r=wd.measureText(e).width,rle.set(n,r)),r}function pl(e){return e.fontSize!=null?+e.fontSize||0:11}function _d(e){return e.lineHeight!=null?e.lineHeight:pl(e)+2}function zet(e){return ut(e)?e.length>1?e:e[0]:e}function gx(e){return zet(e.lineBreak&&e.text&&!ut(e.text)?e.text.split(e.lineBreak):e.text)}function Bz(e){const t=gx(e);return(ut(t)?t.length-1:0)*_d(e)}function Sd(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Uet(e,n):n}function jet(e){if(hl.width===Lz){const t=gk(e);return n=>ole(n,t)}else{const t=pl(e);return n=>ale(n,t)}}function Uet(e,t){var n=+e.limit,r=jet(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",a=e.dir==="rtl",o=0,s=t.length,u;if(n-=r(i),a){for(;o<s;)u=o+s>>>1,r(t.slice(u))>n?o=u+1:s=u;return i+t.slice(o)}else{for(;o<s;)u=1+(o+s>>>1),r(t.slice(0,u))<n?o=u:s=u-1;return t.slice(0,o)+i}}function mx(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function gk(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pl(e)+"px "+mx(e,t)}function zz(e){var t=e.baseline,n=pl(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*_d(e):t==="line-bottom"?.29*n-.5*_d(e):0)}const Wet={left:"start",center:"middle",right:"end"},vx=new ci;function mk(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Np,t+=r*Math.cos(i),n+=r*Math.sin(i)),vx.x1=t,vx.y1=n,vx}function Vet(e,t){var n=t.dx||0,r=(t.dy||0)+zz(t),i=mk(t),a=i.x1,o=i.y1,s=t.angle||0,u;e("text-anchor",Wet[t.align]||"start"),s?(u=Mp(a,o)+" "+Nz(s),(n||r)&&(u+=" "+Mp(n,r))):u=Mp(a+n,o+r),e("transform",u)}function jz(e,t,n){var r=hl.height(t),i=t.align,a=mk(t),o=a.x1,s=a.y1,u=t.dx||0,l=(t.dy||0)+zz(t)-Math.round(.8*r),c=gx(t),f;if(ut(c)?(r+=_d(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,hl.width(t,h)),0)):f=hl.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*yd,o,s);else if(n===2)return e.rotatedPoints(t.angle*yd,o,s);return e}function qet(e,t,n){uu(t,r=>{var i=r.opacity==null?1:r.opacity,a,o,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=gk(r),e.textAlign=r.align||"left",a=mk(r),o=a.x1,s=a.y1,r.angle&&(e.save(),e.translate(o,s),e.rotate(r.angle*yd),o=s=0),o+=r.dx||0,s+=(r.dy||0)+zz(r),c=gx(r),Wv(e,r),ut(c))for(l=_d(r),u=0;u<c.length;++u)f=Sd(r,c[u]),r.fill&&lk(e,r,i)&&e.fillText(f,o,s),r.stroke&&Vv(e,r,i)&&e.strokeText(f,o,s),s+=l;else f=Sd(r,c),r.fill&&lk(e,r,i)&&e.fillText(f,o,s),r.stroke&&Vv(e,r,i)&&e.strokeText(f,o,s);r.angle&&e.restore()}})}function Het(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=mk(t),s=o.x1,u=o.y1,l=jz(vx,t,1),c=-t.angle*yd,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(s-f*s+d*u),p=d*i+f*a+(u-d*s-f*u);return l.contains(h,p)}function Get(e,t){const n=jz(vx,e,2);return Uv(t,n[0],n[1],n[2],n[3])||Uv(t,n[0],n[1],n[4],n[5])||Uv(t,n[4],n[5],n[6],n[7])||Uv(t,n[2],n[3],n[6],n[7])}var Ket={type:"text",tag:"text",nested:!1,attr:Vet,bound:jz,draw:qet,pick:fk(Het),isect:Get},Xet=Rz("trail",qQe,aet),Vo={arc:net,area:oet,group:xet,image:Aet,line:Cet,path:Oet,rect:Det,rule:$et,shape:Let,symbol:Bet,text:Ket,trail:Xet};function Uz(e,t,n){var r=Vo[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new ci),e,n)}var sle={mark:null};function ule(e,t,n){var r=Vo[e.marktype],i=r.bound,a=e.items,o=a&&a.length,s,u,l,c;if(r.nested)return o?l=a[0]:(sle.mark=e,l=sle),c=Uz(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new ci,o)for(s=0,u=a.length;s<u;++s)t.union(Uz(a[s],i,n));return e.bounds=t}const Yet=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function lle(e,t){return JSON.stringify(e,Yet,t)}function cle(e){const t=typeof e=="string"?JSON.parse(e):e;return fle(t)}function fle(e){var t=e.marktype,n=e.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&fle(n[i]);return t&&ule(e),e}function Wz(e){arguments.length?this.root=cle(e):(this.root=dle({marktype:"group",name:"root",role:"frame"}),this.root.items=[new rk(this.root)])}Wz.prototype={toJSON(e){return lle(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=dle(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function dle(e,t){const n={bounds:new ci,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ed(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Vz(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function co(e,t,n,r){var i=e.childNodes[t],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=Ed(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function lu(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function hle(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function vk(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Zet(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Vo[i.marktype]).tip){for(o=vk(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=a.tip(i.items,o)}return e}function Ad(e,t){this._active=null,this._handlers={},this._loader=e||uC(),this._tooltip=t||Jet}function Jet(e,t,n,r){e.element().setAttribute("title",r||"")}Ad.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),a=Ed(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Zet(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}};function gl(e){this._el=null,this._bgcolor=null,this._loader=new bz(e)}gl.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Qet="keydown",ett="keypress",ttt="keyup",ple="dragenter",yk="dragleave",gle="dragover",qz="mousedown",ntt="mouseup",bk="mousemove",yx="mouseout",mle="mouseover",xk="click",rtt="dblclick",itt="wheel",vle="mousewheel",wk="touchstart",_k="touchmove",Sk="touchend",att=[Qet,ett,ttt,ple,yk,gle,qz,ntt,bk,yx,mle,xk,rtt,itt,vle,wk,_k,Sk],Hz=bk,bx=yx,Gz=xk;function xx(e,t){Ad.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const ott=e=>e===wk||e===_k||e===Sk?[wk,_k,Sk]:[e];function yle(e,t){ott(t).forEach(n=>stt(e,n))}function stt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function ble(e,t,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function xle(e){return function(t){this.fire(e,t),this._active=null}}$e(xx,Ad,{initialize(e,t,n){return this._canvas=e&&Vz(e,"canvas"),[xk,qz,bk,yx,yk].forEach(r=>yle(this,r)),Ad.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:att,DOMMouseScroll(e){this.fire(vle,e)},mousemove:ble(bk,mle,yx),dragover:ble(gle,ple,yk),mouseout:xle(yx),dragleave:xle(yk),mousedown(e){this._down=this._active,this.fire(qz,e)},click(e){this._down===this._active&&(this.fire(xk,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(wk,e,!0)},touchmove(e){this.fire(_k,e,!0)},touchend(e){this.fire(Sk,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===Gz&&r&&r.href?this.handleHref(t,r,r.href):(e===Hz||e===bx)&&this.handleTooltip(t,r,e!==bx),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(yle(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=vk(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const a=this.context();return Vo[e.marktype].pick.call(this,a,e,t,n,r,i)}});function utt(){return typeof window!="undefined"&&window.devicePixelRatio||1}var ltt=utt();function ctt(e,t,n,r,i,a){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=o?ltt:i;e.width=t*u,e.height=n*u;for(const l in a)s[l]=a[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function Ek(e){gl.call(this,e),this._options={},this._redraw=!1,this._dirty=new ci,this._tempb=new ci}const wle=gl.prototype,ftt=(e,t,n)=>new ci().set(0,0,t,n).translate(-e[0],-e[1]);function dtt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}$e(Ek,gl,{initialize(e,t,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Ov(1,1,this._options.type),e&&this._canvas&&(lu(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),wle.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(wle.resize.call(this,e,t,n,r),this._canvas)ctt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||Se("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=ftt(n,r,i);t.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):dtt(t,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),a.clear(),this},draw(e,t,n){const r=Vo[t.marktype];t.clip&&set(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(e,t,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,r))}});function Kz(e,t){Ad.call(this,e,t);const n=this;n._hrefHandler=Xz(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=Xz(n,(r,i)=>{n.handleTooltip(r,i,r.type!==bx)})}const Xz=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};$e(Kz,Ad,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(Gz,this._hrefHandler),r.removeEventListener(Hz,this._tooltipHandler),r.removeEventListener(bx,this._tooltipHandler)),this._svg=r=e&&Vz(e,"svg"),r&&(r.addEventListener(Gz,this._hrefHandler),r.addEventListener(Hz,this._tooltipHandler),r.addEventListener(bx,this._tooltipHandler)),Ad.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const a={type:e,handler:t,listener:Xz(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const _le="aria-hidden",Yz="aria-label",Zz="role",Jz="aria-roledescription",Sle="graphics-object",Qz="graphics-symbol",Ele=(e,t,n)=>({[Zz]:e,[Jz]:t,[Yz]:n||void 0}),htt=iu(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Ale={axis:{desc:"axis",caption:mtt},legend:{desc:"legend",caption:vtt},"title-text":{desc:"title",caption:e=>`Title text '${Ole(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Ole(e)}'`}},Cle={ariaRole:Zz,ariaRoleDescription:Jz,description:Yz};function kle(e,t){const n=t.aria===!1;if(e(_le,n||void 0),n||t.description==null)for(const r in Cle)e(Cle[r],void 0);else{const r=t.mark.marktype;e(Yz,t.description),e(Zz,t.ariaRole||(r==="group"?Sle:Qz)),e(Jz,t.ariaRoleDescription||`${r} mark`)}}function Tle(e){return e.aria===!1?{[_le]:!0}:htt[e.role]?null:Ale[e.role]?gtt(e,Ale[e.role]):ptt(e)}function ptt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return Ele(n?Sle:Qz,`${t} mark container`,e.description)}function gtt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return Ele(t.role||Qz,t.desc,n.description||r(n))}catch(n){return null}}function Ole(e){return wt(e.text).join(" ")}function mtt(e){const t=e.datum,n=e.orient,r=t.title?Ile(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),s=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Lv(s)?"discrete":s} scale with ${Cue(o,a,e)}`}function vtt(e){const t=e.datum,n=t.title?Ile(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,a=Object.keys(i),o=e.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return btt(r)+(n?` titled '${n}'`:"")+` for ${ytt(a)} with ${Cue(u,s,e)}`}function Ile(e){try{return wt(sn(e.items).items[0].text).join(" ")}catch(t){return null}}function ytt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+sn(e)}function btt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Nle=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),xtt=e=>Nle(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function e5(){let e="",t="",n="";const r=[],i=()=>t=n="",a=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${xtt(l)}"`),s),s={open(u,...l){a(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:o,text:u=>(n+=Nle(u),s),toString:()=>e};return s}const Dle=e=>Rle(e5(),e)+"";function Rle(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?e.text(a.nodeValue):Rle(e,a)}}return e.close()}const Ak={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Fle={fill:"none","stroke-miterlimit":10},wx=0,Mle="http://www.w3.org/2000/xmlns/",fi=px.xmlns;function t5(e){gl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const n5=gl.prototype;$e(t5,gl,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=co(e,0,"svg",fi),this._svg.setAttributeNS(Mle,"xmlns",fi),this._svg.setAttributeNS(Mle,"xmlns:xlink",px["xmlns:xlink"]),this._svg.setAttribute("version",px.version),this._svg.setAttribute("class","marks"),lu(e,1),this._root=co(this._svg,wx,"g",fi),Cd(this._root,Fle),lu(this._svg,wx+1)),this.background(this._bgcolor),n5.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),n5.background.apply(this,arguments)},resize(e,t,n,r){return n5.resize.call(this,e,t,n,r),this._svg&&(Cd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=co(e,wx,"rect",fi),Cd(n,{width:this._width,height:this._height,fill:t}));const r=Dle(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),lu(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=e.length;o<s;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Vo[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Ple(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Ple(n,t)):this._update(a,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Vo[t.marktype],a=t.interactive===!1?"none":null,o=i.tag==="g";let s=null,u=0;const l=$le(t,e,n,"g",r);l.setAttribute("class",hle(t));const c=Tle(t);for(const d in c)Na(l,d,c[d]);o||Na(l,"pointer-events",a),Na(l,"clip-path",t.clip?yz(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=$le(d,l,s,i.tag,r);h&&(this._update(i,p,d),o&&Stt(this,p,d)),s=p,++u};return i.nested?t.items.length&&f(t.items[0]):uu(t,f),lu(l,u),l},_update(e,t,n){Ic=t,ra=t.__values__,kle(_x,n),e.attr(_x,n,this);const r=Att[e.type];r&&r.call(this,e,t,n),Ic&&this.style(Ic,n)},style(e,t){if(t!=null)for(const n in Ak){let r=n==="font"?mx(t):t[n];if(r===ra[n])continue;const i=Ak[n];r==null?e.removeAttribute(i):(dz(r)&&(r=Tue(r,this._defs.gradient,Lle())),e.setAttribute(i,r+"")),ra[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=co(e,wx+1,"defs",fi)),r=wtt(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=co(e,wx+1,"defs",fi)),r=_tt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):lu(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function Ple(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function wtt(e,t,n){let r,i,a;if(t.gradient==="radial"){let o=co(e,n++,"pattern",fi);Cd(o,{id:QC+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=co(o,0,"rect",fi),Cd(o,{width:1,height:1,fill:`url(${Lle()}#${t.id})`}),e=co(e,n++,"radialGradient",fi),Cd(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=co(e,n++,"linearGradient",fi),Cd(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)a=co(e,r,"stop",fi),a.setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return lu(e,r),n}function _tt(e,t,n){let r;return e=co(e,n,"clipPath",fi),e.setAttribute("id",t.id),t.path?(r=co(e,0,"path",fi),r.setAttribute("d",t.path)):(r=co(e,0,"rect",fi),Cd(r,{x:0,y:0,width:t.width,height:t.height})),lu(e,1),n+1}function Stt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;uu(n,a=>{r=e.mark(t,a,r),++i}),lu(t,1+i)}function $le(e,t,n,r,i){let a=e._svg,o;if(!a&&(o=t.ownerDocument,a=Ed(o,r,fi),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},r==="g"))){const s=Ed(o,"path",fi);a.appendChild(s),s.__data__=e;const u=Ed(o,"g",fi);a.appendChild(u),u.__data__=e;const l=Ed(o,"path",fi);a.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||Ett(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function Ett(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Ic=null,ra=null;const Att={group(e,t,n){const r=Ic=t.childNodes[2];ra=r.__values__,e.foreground(_x,n,this),ra=t.__values__,Ic=t.childNodes[1],e.content(_x,n,this);const i=Ic=t.childNodes[0];e.background(_x,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==ra.events&&(Na(r,"pointer-events",a),Na(i,"pointer-events",a),ra.events=a),n.strokeForeground&&n.stroke){const o=n.fill;Na(r,"display",null),this.style(i,n),Na(i,"stroke",null),o&&(n.fill=null),ra=r.__values__,this.style(r,n),o&&(n.fill=o),Ic=null}else Na(r,"display","none")},image(e,t,n){n.smooth===!1?(r5(t,"image-rendering","optimizeSpeed"),r5(t,"image-rendering","pixelated")):r5(t,"image-rendering",null)},text(e,t,n){const r=gx(n);let i,a,o,s;ut(r)?(a=r.map(u=>Sd(n,u)),i=a.join(`
`),i!==ra.text&&(lu(t,0),o=t.ownerDocument,s=_d(n),a.forEach((u,l)=>{const c=Ed(o,"tspan",fi);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),ra.text=i)):(a=Sd(n,r),a!==ra.text&&(t.textContent=a,ra.text=a)),Na(t,"font-family",mx(n)),Na(t,"font-size",pl(n)+"px"),Na(t,"font-style",n.fontStyle),Na(t,"font-variant",n.fontVariant),Na(t,"font-weight",n.fontWeight)}};function _x(e,t,n){t!==ra[e]&&(n?Ctt(Ic,e,t,n):Na(Ic,e,t),ra[e]=t)}function r5(e,t,n){n!==ra[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ra[t]=n)}function Cd(e,t){for(const n in t)Na(e,n,t[n])}function Na(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Ctt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Lle(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function i5(e){gl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}$e(i5,gl,{svg(){return this._text},_render(e){const t=e5();t.open("svg",Rt({},px,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Fle,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Vo[t.marktype],r=n.tag,i=[kle,n.attr];e.open("g",{class:hle(t),"clip-path":t.clip?yz(this,t,t.group):null},Tle(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const a=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=gx(o);if(ut(u)){const l={x:0,dy:_d(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Sd(o,u[c])).close()}else e.text(Sd(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),uu(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&a(t.items[0]):uu(t,a),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},a=(o,s,u,l)=>{i[l||o]=s};return Array.isArray(n)?n.forEach(o=>o(a,t,this)):n(a,t,this),r&&ktt(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const a=t[i],o=a.stops;a.gradient==="radial"?(e.open("pattern",{id:QC+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let s=0;s<o.length;++s)e.open("stop",{offset:o[s].offset,"stop-color":o[s].color}).close();e.close()}for(const i in n){const a=n[i];e.open("clipPath",{id:i}),a.path?e.open("path",{d:a.path}).close():e.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),e.close()}e.close()}}});function ktt(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=mx(t),e["font-size"]=pl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in Ak){let o=t[a];const s=Ak[a];o==="transparent"&&(s==="fill"||s==="stroke")||o!=null&&(dz(o)&&(o=Tue(o,i.gradient,"")),e[s]=o)}return e}const Ble="canvas",zle="png",jle="svg",Ule="none",kd={Canvas:Ble,PNG:zle,SVG:jle,None:Ule},qv={};qv[Ble]=qv[zle]={renderer:Ek,headless:Ek,handler:xx},qv[jle]={renderer:t5,headless:i5,handler:Kz},qv[Ule]={};function Ck(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(qv[e]=t,this):qv[e]}function Wle(e,t,n){const r=[],i=new ci().union(t),a=e.marktype;return a?Vle(e,i,n,r):a==="group"?qle(e,i,n,r):Se("Intersect scene must be mark node or group item.")}function Vle(e,t,n,r){if(Ttt(e,t,n)){const i=e.items,a=e.marktype,o=i.length;let s=0;if(a==="group")for(;s<o;++s)qle(i[s],t,n,r);else for(const u=Vo[a].isect;s<o;++s){const l=i[s];Hle(l,t,u)&&r.push(l)}}return r}function Ttt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function qle(e,t,n,r){n&&n(e.mark)&&Hle(e,t,Vo.group.isect)&&r.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let u=0;u<a;++u)Vle(i[u],t,n,r);t.translate(o,s)}return r}function Hle(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const a5=new ci;function Gle(e){const t=e.clip;if(Lt(t))t(fx(a5.clear()));else if(t)a5.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(a5)}const Ott=1e-9;function o5(e,t,n){return e===t?!0:n==="path"?Kle(e,t):e instanceof Date&&t instanceof Date?+e==+t:ed(e)&&ed(t)?Math.abs(e-t)<=Ott:!e||!t||!Nt(e)&&!Nt(t)?e==t:Itt(e,t)}function Kle(e,t){return o5(Bv(e),Bv(t))}function Itt(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!o5(e[i],t[i],i))return!1;return typeof e==typeof t}function Ntt(){Bue(),aQe()}const Hv="top",cu="left",fu="right",Td="bottom",Dtt="top-left",Rtt="top-right",Ftt="bottom-left",Mtt="bottom-right",s5="start",u5="middle",Da="end",Ptt="x",$tt="y",kk="group",l5="axis",c5="title",Ltt="frame",Btt="scope",f5="legend",Xle="row-header",Yle="row-footer",Zle="row-title",Jle="column-header",Qle="column-footer",ece="column-title",ztt="padding",jtt="symbol",tce="fit",Utt="fit-x",Wtt="fit-y",Vtt="pad",d5="none",Tk="all",h5="each",p5="flush",Od="column",Id="row";function nce(e){ve.call(this,null,e)}$e(nce,ve,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,a=Vo[i],o=a.bound;let s=r.bounds,u;if(a.nested)r.items.length&&n.dirty(r.items[0]),s=Ok(r,o),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===kk||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(Ok(l,o))),r.role){case l5:case f5:case c5:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Ok(l,o))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Ok(l,o))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return Gle(r),t.modifies("bounds")}});function Ok(e,t,n){return t(e.bounds.clear(),e,n)}const rce=":vega_identifier:";function g5(e){ve.call(this,0,e)}g5.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},$e(g5,ve,{transform(e,t){const n=qtt(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),t}});function qtt(e){return e._signals[rce]||(e._signals[rce]=e.add(0))}function ice(e){ve.call(this,null,e)}$e(ice,ve,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Htt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===kk?rk:nk;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Htt(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function ace(e){ve.call(this,null,e)}const oce={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!sce(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},sce=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),uce=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n)if(sce(i,a=e[n].bounds,t))return!0},Gtt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Ktt=(e,t,n)=>{var r=e.range(),i=new ci;return t===Hv||t===Td?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},lce=e=>(e.forEach(t=>t.opacity=1),e),cce=(e,t)=>e.reflow(t.modified()).modifies("opacity");$e(ace,ve,{transform(e,t){const n=oce[e.method]||oce.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(lce(i),t=cce(t,e)),t;if(i=i.filter(Gtt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),a=lce(i),t=cce(t,e),a.length>=3&&uce(a,r)){do a=n(a,r);while(a.length>=3&&uce(a,r));a.length<3&&!sn(i).opacity&&(a.length>1&&(sn(a).opacity=0),sn(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=Ktt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const s=a[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function fce(e){ve.call(this,null,e)}$e(fce,ve,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ia=new ci;function Gv(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Xtt(e){var t=e.items[0].orient;return t===cu||t===fu}function Ytt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Ztt(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,s=i.orient,u=Ytt(a),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&Bz(p),y=0,b=0,x,w;switch(ia.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case Hv:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&Ik(e,p,w,g,v,0,-1,m);break;case cu:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&Ik(e,p,w,g,v,1,-1,m);break;case fu:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&Ik(e,p,w,g,v,1,1,m);break;case Td:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&Ik(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Oc(m.translate(y,b),i),Gv(i,"x",y+o)|Gv(i,"y",b+o)&&(i.bounds=ia,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function Ik(e,t,n,r,i,a,o,s){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),a?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const dce=(e,t)=>Math.floor(Math.min(e,t)),hce=(e,t)=>Math.ceil(Math.max(e,t));function Jtt(e){var t=e.items,n=t.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],a=i.items,i.marktype===kk)switch(i.role){case l5:case f5:case c5:break;case Xle:o.rowheaders.push(...a);break;case Yle:o.rowfooters.push(...a);break;case Jle:o.colheaders.push(...a);break;case Qle:o.colfooters.push(...a);break;case Zle:o.rowtitle=a[0];break;case ece:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function Qtt(e){return new ci().set(0,0,e.width||0,e.height||0)}function ent(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function dr(e,t,n){const r=Nt(e)?e[t]:e;return r??(n!==void 0?n:0)}function pce(e){return e<0?Math.ceil(-e):0}function gce(e,t,n){var r=!n.nodirty,i=n.bounds===p5?Qtt:ent,a=ia.set(0,0,0,0),o=dr(n.align,Od),s=dr(n.align,Id),u=dr(n.padding,Od),l=dr(n.padding,Id),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),x=Array(d),w=Array(d),S,A,_,E,C,k,T,I,N,O,D;for(A=0;A<c;++A)p[A]=0;for(A=0;A<f;++A)v[A]=0;for(A=0;A<d;++A)k=t[A],C=w[A]=i(k),k.x=k.x||0,b[A]=0,k.y=k.y||0,x[A]=0,_=A%c,E=~~(A/c),g=Math.max(g,T=Math.ceil(C.x2)),y=Math.max(y,I=Math.ceil(C.y2)),p[_]=Math.max(p[_],T),v[E]=Math.max(v[E],I),h[A]=u+pce(C.x1),m[A]=l+pce(C.y1),r&&e.dirty(t[A]);for(A=0;A<d;++A)A%c==0&&(h[A]=0),A<c&&(m[A]=0);if(o===h5)for(_=1;_<c;++_){for(D=0,A=_;A<d;A+=c)D<h[A]&&(D=h[A]);for(A=_;A<d;A+=c)h[A]=D+p[_-1]}else if(o===Tk){for(D=0,A=0;A<d;++A)A%c&&D<h[A]&&(D=h[A]);for(A=0;A<d;++A)A%c&&(h[A]=D+g)}else for(o=!1,_=1;_<c;++_)for(A=_;A<d;A+=c)h[A]+=p[_-1];if(s===h5)for(E=1;E<f;++E){for(D=0,A=E*c,S=A+c;A<S;++A)D<m[A]&&(D=m[A]);for(A=E*c;A<S;++A)m[A]=D+v[E-1]}else if(s===Tk){for(D=0,A=c;A<d;++A)D<m[A]&&(D=m[A]);for(A=c;A<d;++A)m[A]=D+y}else for(s=!1,E=1;E<f;++E)for(A=E*c,S=A+c;A<S;++A)m[A]+=v[E-1];for(N=0,A=0;A<d;++A)N=h[A]+(A%c?N:0),b[A]+=N-t[A].x;for(_=0;_<c;++_)for(O=0,A=_;A<d;A+=c)O+=m[A],x[A]+=O-t[A].y;if(o&&dr(n.center,Od)&&f>1)for(A=0;A<d;++A)C=o===Tk?g:p[A%c],N=C-w[A].x2-t[A].x-b[A],N>0&&(b[A]+=N/2);if(s&&dr(n.center,Id)&&c!==1)for(A=0;A<d;++A)C=s===Tk?y:v[~~(A/c)],O=C-w[A].y2-t[A].y-x[A],O>0&&(x[A]+=O/2);for(A=0;A<d;++A)a.union(w[A].translate(b[A],x[A]));switch(N=dr(n.anchor,Ptt),O=dr(n.anchor,$tt),dr(n.anchor,Od)){case Da:N-=a.width();break;case u5:N-=a.width()/2}switch(dr(n.anchor,Id)){case Da:O-=a.height();break;case u5:O-=a.height()/2}for(N=Math.round(N),O=Math.round(O),a.clear(),A=0;A<d;++A)t[A].mark.bounds.clear();for(A=0;A<d;++A)k=t[A],k.x+=b[A]+=N,k.y+=x[A]+=O,a.union(k.mark.bounds.union(k.bounds.translate(b[A],x[A]))),r&&e.dirty(k);return a}function tnt(e,t,n){var r=Jtt(t),i=r.marks,a=n.bounds===p5?nnt:rnt,o=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,p,g,m;const v=gce(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=dr(n.headerBand,Id,null),c=Nk(e,r.rowheaders,i,s,u,-dr(o,"rowHeader"),dce,0,a,"x1",0,s,1,g)),r.colheaders&&(g=dr(n.headerBand,Od,null),f=Nk(e,r.colheaders,i,s,s,-dr(o,"columnHeader"),dce,1,a,"y1",0,1,s,g)),r.rowfooters&&(g=dr(n.footerBand,Id,null),d=Nk(e,r.rowfooters,i,s,u,dr(o,"rowFooter"),hce,0,a,"x2",s-1,s,1,g)),r.colfooters&&(g=dr(n.footerBand,Od,null),h=Nk(e,r.colfooters,i,s,s,dr(o,"columnFooter"),hce,1,a,"y2",l-s,1,s,g)),r.rowtitle&&(p=dr(n.titleAnchor,Id),m=dr(o,"rowTitle"),m=p===Da?d+m:c-m,g=dr(n.titleBand,Id,.5),mce(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=dr(n.titleAnchor,Od),m=dr(o,"columnTitle"),m=p===Da?h+m:f-m,g=dr(n.titleBand,Od,.5),mce(e,r.coltitle,m,1,v,g))}function nnt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function rnt(e,t){return e.bounds[t]}function Nk(e,t,n,r,i,a,o,s,u,l,c,f,d,h){var p=n.length,g=0,m=0,v,y,b,x,w,S,A,_,E;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=o(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=a,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(S=t[y],w=S.mark.bounds,b=v;b>=0&&(A=n[b])==null;b-=d);s?(_=h==null?A.x:Math.round(A.bounds.x1+h*A.bounds.width()),E=g):(_=g,E=h==null?A.y:Math.round(A.bounds.y1+h*A.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),E-(S.y||0))),S.x=_,S.y=E,e.dirty(S),m=o(m,w[l])}return m}function mce(e,t,n,r,i,a){if(!!t){e.dirty(t);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}function int(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function ant(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function ont(e,t,n,r,i,a,o){const s=int(n,t),u=ant(e,s("offset",0)),l=s("anchor",s5),c=l===Da?1:l===u5?.5:0,f={align:h5,bounds:s("bounds",p5),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case cu:f.anchor={x:Math.floor(r.x1)-u,column:Da,y:c*(o||r.height()+2*r.y1),row:l};break;case fu:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case Hv:f.anchor={y:Math.floor(i.y1)-u,row:Da,x:c*(a||i.width()+2*i.x1),column:l};break;case Td:f.anchor={y:Math.ceil(i.y2)+u,x:c*(a||i.width()+2*i.x1),column:l};break;case Dtt:f.anchor={x:u,y:u};break;case Rtt:f.anchor={x:a-u,y:u,column:Da};break;case Ftt:f.anchor={x:u,y:o-u,row:Da};break;case Mtt:f.anchor={x:a-u,y:o-u,column:Da,row:Da};break}return f}function snt(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),lnt(e,n,n.items[0].items[0]),a=unt(n,a),u=2*n.padding,l=2*n.padding,a.empty()||(u=Math.ceil(a.width()+u),l=Math.ceil(a.height()+l)),r.type===jtt&&cnt(n.items[0].items[0].items[0].items),i!==d5&&(n.x=o=0,n.y=s=0),n.width=u,n.height=l,Oc(a.set(o,s,o+u,s+l),n),n.mark.bounds.clear().union(a),n}function unt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function lnt(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title)(i||a)&&Sx(e,n,i,a);else{var o=t.items[1].items[0],s=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case cu:i+=Math.ceil(o.bounds.width())+u;break;case fu:case Td:break;default:a+=o.bounds.height()+u}switch((i||a)&&Sx(e,n,i,a),o.orient){case cu:c+=Kv(t,n,o,s,1,1);break;case fu:l+=Kv(t,n,o,Da,0,0)+u,c+=Kv(t,n,o,s,1,1);break;case Td:l+=Kv(t,n,o,s,0,0),c+=Kv(t,n,o,Da,-1,0,1)+u;break;default:l+=Kv(t,n,o,s,0,0)}(l||c)&&Sx(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(Sx(e,n,-l,0),Sx(e,o,-l,0))}}function Kv(e,t,n,r,i,a,o){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(a||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&a?c:0,d=u&&a?0:c,h=i<=0?0:Bz(n);return Math.round(r===s5?f:r===Da?d-h:.5*(c-h))}function Sx(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function cnt(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function fnt(e,t,n,r,i){var a=t.items[0],o=a.frame,s=a.orient,u=a.anchor,l=a.offset,c=a.padding,f=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=s===cu||s===fu?r:n,p=0,g=0,m=0,v=0,y=0,b;if(o!==kk?s===cu?(p=i.y2,h=i.y1):s===fu?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):s===cu&&(p=r,h=0),b=u===s5?p:u===Da?h:(p+h)/2,d&&d.text){switch(s){case Hv:case Td:y=f.bounds.height()+c;break;case cu:v=f.bounds.width()+c;break;case fu:v=-f.bounds.width()-c;break}ia.clear().union(d.bounds),ia.translate(v-(d.x||0),y-(d.y||0)),Gv(d,"x",v)|Gv(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(ia),d.mark.bounds.clear().union(ia),e.dirty(d)),ia.clear().union(d.bounds)}else ia.clear();switch(ia.union(f.bounds),s){case Hv:g=b,m=i.y1-ia.height()-l;break;case cu:g=i.x1-ia.width()-l,m=b;break;case fu:g=i.x2+ia.width()+l,m=b;break;case Td:g=b,m=i.y2+l;break;default:g=a.x,m=a.y}return Gv(a,"x",g)|Gv(a,"y",m)&&(ia.translate(g,m),e.dirty(a),a.bounds.clear().union(ia),t.bounds.clear().union(ia),e.dirty(a)),a.bounds}function vce(e){ve.call(this,null,e)}$e(vce,ve,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&tnt(n,r,e.layout),hnt(n,r,e)}),dnt(e.mark.group)?t.reflow():t}});function dnt(e){return e&&e.mark.role!=="legend-entry"}function hnt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=new ci().set(0,0,i,a),s=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case l5:h=Xtt(f)?s:u,h.union(Ztt(e,f,i,a));break;case c5:c=f;break;case f5:l.push(snt(e,f));break;case Ltt:case Btt:case Xle:case Yle:case Zle:case Jle:case Qle:case ece:s.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{d=v.orient||fu,d!==d5&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];gce(e,y,ont(y,v,n.legends,s,u,i,a))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&n.autosize.type===tce)switch(v.orient){case cu:case fu:o.add(y.x1,0).add(y.x2,0);break;case Hv:case Td:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(s).union(u),c&&o.union(fnt(e,c,i,a,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),pnt(e,t,o,n)}function pnt(e,t,n,r){const i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;let o=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===ztt){const p=e.padding();o-=p.left+p.right,s-=p.top+p.bottom}a===d5?(l=0,f=0,u=o,c=s):a===tce?(u=Math.max(0,o-l-d),c=Math.max(0,s-f-h)):a===Utt?(u=Math.max(0,o-l-d),s=c+f+h):a===Wtt?(o=u+l+d,c=Math.max(0,s-f-h)):a===Vtt&&(o=u+l+d,s=c+f+h),e._resizeView(o,s,u,c,[l,f],i.resize)}var gnt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:nce,identifier:g5,mark:ice,overlap:ace,render:fce,viewlayout:vce});function yce(e){ve.call(this,null,e)}$e(yce,ve,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,s=lz(a,o,e.minstep),u=e.format||bue(n,a,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?yue(a,e.values,s):cz(a,s);return i&&(r.rem=i),i=l.map((c,f)=>In({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(In({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function bce(e){ve.call(this,null,e)}function mnt(){return In({})}function vnt(e){const t=gv().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}$e(bce,ve,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||mnt,a=e.key||lt,o=this.value;return ut(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(a))&&Se("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=vnt(a)),t.visit(t.ADD,s=>{const u=a(s);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),o.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=a(s),l=o.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=a(s),l=o.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function xce(e){ve.call(this,null,e)}$e(xce,ve,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,a=t.encode;if(ut(a))if(n.changed()||a.every(f=>i[f]))a=a[0],n.encode=null;else return t.StopPropagation;var o=a==="enter",s=i.update||Jf,u=i.enter||Jf,l=i.exit||Jf,c=(a&&!o?i[a]:s)||Jf;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Jf&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Jf&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Jf){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function wce(e){ve.call(this,[],e)}$e(wce,ve,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||JC,o=e.scale,s=+e.limit,u=lz(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===JC,c=e.format||Sue(n,o,u,a,e.formatSpecifier,e.formatType,l),f=e.values||_ue(o,u),d,h,p,g,m;return i&&(r.rem=i),a===JC?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,Lt(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=Ji(g=p||8),i=i.map((v,y)=>In({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(In({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):a===HJe?(d=o.domain(),h=pue(o,d[0],sn(d)),f.length<3&&!e.values&&d[0]!==sn(d)&&(f=[d[0],sn(d)]),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=rQe(o),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const ynt=e=>e.source.x,bnt=e=>e.source.y,xnt=e=>e.target.x,wnt=e=>e.target.y;function m5(e){ve.call(this,{},e)}m5.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},$e(m5,ve,{transform(e,t){var n=e.sourceX||ynt,r=e.sourceY||bnt,i=e.targetX||xnt,a=e.targetY||wnt,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=Ace.get(u+"-"+s)||Ace.get(u);return l||Se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),a(c))}),t.reflow(e.modified()).modifies(o)}});const _ce=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,_nt=(e,t,n,r)=>_ce(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Sce=(e,t,n,r)=>{var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,s=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+s+" 0 1 "+n+","+r},Snt=(e,t,n,r)=>Sce(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Ece=(e,t,n,r)=>{const i=n-e,a=r-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},Ent=(e,t,n,r)=>Ece(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Ant=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Cnt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,knt=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+r*o+","+r*s},Tnt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Ont=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Int=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s},Ace=gv({line:_ce,"line-radial":_nt,arc:Sce,"arc-radial":Snt,curve:Ece,"curve-radial":Ent,"orthogonal-horizontal":Ant,"orthogonal-vertical":Cnt,"orthogonal-radial":knt,"diagonal-horizontal":Tnt,"diagonal-vertical":Ont,"diagonal-radial":Int});function v5(e){ve.call(this,null,e)}v5.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},$e(v5,ve,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||pv,o=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(a),c=l.length,f=o,d=(s-o)/lie(l),h=jo(c),p,g,m;for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Nnt=5;function Dnt(e){const t=e.type;return!e.bins&&(t===Mv||t===tx||t===nx)}function Cce(e){return az(e)&&e!==cl}const Rnt=iu(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function kce(e){ve.call(this,null,e),this.modified(!0)}$e(kce,ve,{transform(e,t){var n=t.dataflow,r=this.value,i=Fnt(e);(!r||i!==r.type)&&(this.value=r=Sn(i)());for(i in e)if(!Rnt[i]){if(i==="padding"&&Cce(r.type))continue;Lt(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return znt(r,e,Bnt(r,e,Pnt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Fnt(e){var t=e.type,n="",r;return t===cl?cl+"-"+Mv:(Mnt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?cl+"-":r===3?Pv+"-":""),(n+t||Mv).toLowerCase())}function Mnt(e){const t=e.type;return az(t)&&t!==Tp&&t!==Op&&(e.scheme||e.range&&e.range.length&&e.range.every(Bn))}function Pnt(e,t,n){const r=$nt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===void 0&&Dnt(e),s,u;if(!i)return 0;if(Cce(a)&&t.padding&&i[0]!==sn(i)&&(i=Lnt(a,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(Tce(a,i,n)),a===ez&&e.unknown(t.domainImplicit?SB:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&lz(e,t.nice)||null),i.length}function $nt(e,t,n){return t?(e.domain(Tce(e.type,t,n)),t.length):-1}function Lnt(e,t,n,r,i,a){var o=Math.abs(sn(n)-n[0]),s=o/(o-2*r),u=e===kc?wL(t,null,s):e===nx?YA(t,null,s,.5):e===tx?YA(t,null,s,i||1):e===GC?_L(t,null,s,a||1):xL(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Tce(e,t,n){if(lue(e)){var r=Math.abs(t.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+gt(t))}return t}function Bnt(e,t,n){let r=t.bins;if(r&&!ut(r)){const i=e.domain(),a=i[0],o=sn(i),s=r.step;let u=r.start==null?a:r.start,l=r.stop==null?o:r.stop;s||Se("Scale bins parameter missing step property."),u<a&&(u=s*Math.ceil(a/s)),l>o&&(l=s*Math.floor(o/s)),r=jo(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===nz&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function znt(e,t,n){var r=e.type,i=t.round||!1,a=t.range;if(t.rangeStep!=null)a=jnt(r,t,n);else if(t.scheme&&(a=Unt(r,t,n),Lt(a))){if(e.interpolator)return e.interpolator(a);Se("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&cue(r))return e.interpolator(ZC(y5(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(sz(t.interpolate,t.interpolateGamma)):Lt(e.round)?e.round(i):Lt(e.rangeRound)&&e.interpolate(i?J1:md),a&&e.range(y5(a,t.reverse))}function jnt(e,t,n){e!==aue&&e!==tz&&Se("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===tz?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*QB(n,i,r)]}function Unt(e,t,n){var r=t.schemeExtent,i,a;return ut(t.scheme)?a=ZC(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),a=uz(i),a||Se("Unrecognized scheme name: ".concat(t.scheme))),n=e===XC?n+1:e===nz?n-1:e===$v||e===KC?+t.schemeCount||Nnt:n,cue(e)?Oce(a,r,t.reverse):Lt(a)?hue(Oce(a,r),n):e===ez?a:a.slice(0,n)}function Oce(e,t,n){return Lt(e)&&(t||n)?due(e,y5(t||[0,1],n)):e}function y5(e,t){return t?e.slice().reverse():e}function Ice(e){ve.call(this,null,e)}$e(Ice,ve,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(xp(e.sort)),this.modified(n),t}});const Nce="zero",Dce="center",Rce="normalize",Fce=["y0","y1"];function b5(e){ve.call(this,null,e)}b5.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Nce,values:[Nce,Dce,Rce]},{name:"as",type:"string",array:!0,length:2,default:Fce}]},$e(b5,ve,{transform(e,t){var n=e.as||Fce,r=n[0],i=n[1],a=xp(e.sort),o=e.field||pv,s=e.offset===Dce?Wnt:e.offset===Rce?Vnt:qnt,u,l,c,f;for(u=Hnt(t.source,e.groupby,a,o),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function Wnt(e,t,n,r,i){for(var a=(t-e.sum)/2,o=e.length,s=0,u;s<o;++s)u=e[s],u[r]=a,u[i]=a+=Math.abs(n(u))}function Vnt(e,t,n,r,i){for(var a=1/e.sum,o=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=o,c[i]=o=a*(l+=Math.abs(n(c)))}function qnt(e,t,n,r,i){for(var a=0,o=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=a,c[i]=a+=l)}function Hnt(e,t,n,r){var i=[],a=g=>g(c),o,s,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(a),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}var Gnt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:yce,datajoin:bce,encode:xce,legendentries:wce,linkpath:m5,pie:v5,scale:kce,sortitems:Ice,stack:b5}),mt=1e-6,Dk=1e-12,Gt=Math.PI,Dr=Gt/2,Rk=Gt/4,Ra=Gt*2,Br=180/Gt,Kt=Gt/180,hn=Math.abs,Xv=Math.atan,vs=Math.atan2,yt=Math.cos,Fk=Math.ceil,Mce=Math.exp,x5=Math.hypot,Mk=Math.log,w5=Math.pow,ct=Math.sin,ys=Math.sign||function(e){return e>0?1:e<0?-1:0},Fa=Math.sqrt,_5=Math.tan;function Pce(e){return e>1?0:e<-1?Gt:Math.acos(e)}function fo(e){return e>1?Dr:e<-1?-Dr:Math.asin(e)}function ji(){}function Pk(e,t){e&&Lce.hasOwnProperty(e.type)&&Lce[e.type](e,t)}var $ce={Feature:function(e,t){Pk(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Pk(n[r].geometry,t)}},Lce={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){S5(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)S5(n[r],t,0)},Polygon:function(e,t){Bce(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Bce(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Pk(n[r],t)}};function S5(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Bce(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)S5(e[n],t,1);t.polygonEnd()}function Nc(e,t){e&&$ce.hasOwnProperty(e.type)?$ce[e.type](e,t):Pk(e,t)}var $k=new Ia,Lk=new Ia,zce,jce,E5,A5,C5,ml={point:ji,lineStart:ji,lineEnd:ji,polygonStart:function(){$k=new Ia,ml.lineStart=Knt,ml.lineEnd=Xnt},polygonEnd:function(){var e=+$k;Lk.add(e<0?Ra+e:e),this.lineStart=this.lineEnd=this.point=ji},sphere:function(){Lk.add(Ra)}};function Knt(){ml.point=Ynt}function Xnt(){Uce(zce,jce)}function Ynt(e,t){ml.point=Uce,zce=e,jce=t,e*=Kt,t*=Kt,E5=e,A5=yt(t=t/2+Rk),C5=ct(t)}function Uce(e,t){e*=Kt,t*=Kt,t=t/2+Rk;var n=e-E5,r=n>=0?1:-1,i=r*n,a=yt(t),o=ct(t),s=C5*o,u=A5*a+s*yt(i),l=s*r*ct(i);$k.add(vs(l,u)),E5=e,A5=a,C5=o}function Znt(e){return Lk=new Ia,Nc(e,ml),Lk*2}function Bk(e){return[vs(e[1],e[0]),fo(e[2])]}function Pp(e){var t=e[0],n=e[1],r=yt(n);return[r*yt(t),r*ct(t),ct(n)]}function zk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Yv(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function k5(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function jk(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Uk(e){var t=Fa(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var xr,ho,Rr,qo,$p,Wce,Vce,Zv,Ex,Nd,Dc,Rc={point:T5,lineStart:Hce,lineEnd:Gce,polygonStart:function(){Rc.point=Kce,Rc.lineStart=Jnt,Rc.lineEnd=Qnt,Ex=new Ia,ml.polygonStart()},polygonEnd:function(){ml.polygonEnd(),Rc.point=T5,Rc.lineStart=Hce,Rc.lineEnd=Gce,$k<0?(xr=-(Rr=180),ho=-(qo=90)):Ex>mt?qo=90:Ex<-mt&&(ho=-90),Dc[0]=xr,Dc[1]=Rr},sphere:function(){xr=-(Rr=180),ho=-(qo=90)}};function T5(e,t){Nd.push(Dc=[xr=e,Rr=e]),t<ho&&(ho=t),t>qo&&(qo=t)}function qce(e,t){var n=Pp([e*Kt,t*Kt]);if(Zv){var r=Yv(Zv,n),i=[r[1],-r[0],0],a=Yv(i,r);Uk(a),a=Bk(a);var o=e-$p,s=o>0?1:-1,u=a[0]*Br*s,l,c=hn(o)>180;c^(s*$p<u&&u<s*e)?(l=a[1]*Br,l>qo&&(qo=l)):(u=(u+360)%360-180,c^(s*$p<u&&u<s*e)?(l=-a[1]*Br,l<ho&&(ho=l)):(t<ho&&(ho=t),t>qo&&(qo=t))),c?e<$p?Ho(xr,e)>Ho(xr,Rr)&&(Rr=e):Ho(e,Rr)>Ho(xr,Rr)&&(xr=e):Rr>=xr?(e<xr&&(xr=e),e>Rr&&(Rr=e)):e>$p?Ho(xr,e)>Ho(xr,Rr)&&(Rr=e):Ho(e,Rr)>Ho(xr,Rr)&&(xr=e)}else Nd.push(Dc=[xr=e,Rr=e]);t<ho&&(ho=t),t>qo&&(qo=t),Zv=n,$p=e}function Hce(){Rc.point=qce}function Gce(){Dc[0]=xr,Dc[1]=Rr,Rc.point=T5,Zv=null}function Kce(e,t){if(Zv){var n=e-$p;Ex.add(hn(n)>180?n+(n>0?360:-360):n)}else Wce=e,Vce=t;ml.point(e,t),qce(e,t)}function Jnt(){ml.lineStart()}function Qnt(){Kce(Wce,Vce),ml.lineEnd(),hn(Ex)>mt&&(xr=-(Rr=180)),Dc[0]=xr,Dc[1]=Rr,Zv=null}function Ho(e,t){return(t-=e)<0?t+360:t}function ert(e,t){return e[0]-t[0]}function Xce(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function trt(e){var t,n,r,i,a,o,s;if(qo=Rr=-(xr=ho=1/0),Nd=[],Nc(e,Rc),n=Nd.length){for(Nd.sort(ert),t=1,r=Nd[0],a=[r];t<n;++t)i=Nd[t],Xce(r,i[0])||Xce(r,i[1])?(Ho(r[0],i[1])>Ho(r[0],r[1])&&(r[1]=i[1]),Ho(i[0],r[1])>Ho(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t)i=a[t],(s=Ho(r[1],i[0]))>o&&(o=s,xr=i[0],Rr=r[1])}return Nd=Dc=null,xr===1/0||ho===1/0?[[NaN,NaN],[NaN,NaN]]:[[xr,ho],[Rr,qo]]}var Ax,Wk,Vk,qk,Hk,Gk,Kk,Xk,O5,I5,N5,Yce,Zce,Ma,Pa,$a,du={sphere:ji,point:D5,lineStart:Jce,lineEnd:Qce,polygonStart:function(){du.lineStart=irt,du.lineEnd=art},polygonEnd:function(){du.lineStart=Jce,du.lineEnd=Qce}};function D5(e,t){e*=Kt,t*=Kt;var n=yt(t);Cx(n*yt(e),n*ct(e),ct(t))}function Cx(e,t,n){++Ax,Vk+=(e-Vk)/Ax,qk+=(t-qk)/Ax,Hk+=(n-Hk)/Ax}function Jce(){du.point=nrt}function nrt(e,t){e*=Kt,t*=Kt;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),du.point=rrt,Cx(Ma,Pa,$a)}function rrt(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=vs(Fa((o=Pa*a-$a*i)*o+(o=$a*r-Ma*a)*o+(o=Ma*i-Pa*r)*o),Ma*r+Pa*i+$a*a);Wk+=o,Gk+=o*(Ma+(Ma=r)),Kk+=o*(Pa+(Pa=i)),Xk+=o*($a+($a=a)),Cx(Ma,Pa,$a)}function Qce(){du.point=D5}function irt(){du.point=ort}function art(){efe(Yce,Zce),du.point=D5}function ort(e,t){Yce=e,Zce=t,e*=Kt,t*=Kt,du.point=efe;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),Cx(Ma,Pa,$a)}function efe(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=Pa*a-$a*i,s=$a*r-Ma*a,u=Ma*i-Pa*r,l=x5(o,s,u),c=fo(l),f=l&&-c/l;O5.add(f*o),I5.add(f*s),N5.add(f*u),Wk+=c,Gk+=c*(Ma+(Ma=r)),Kk+=c*(Pa+(Pa=i)),Xk+=c*($a+($a=a)),Cx(Ma,Pa,$a)}function srt(e){Ax=Wk=Vk=qk=Hk=Gk=Kk=Xk=0,O5=new Ia,I5=new Ia,N5=new Ia,Nc(e,du);var t=+O5,n=+I5,r=+N5,i=x5(t,n,r);return i<Dk&&(t=Gk,n=Kk,r=Xk,Wk<mt&&(t=Vk,n=qk,r=Hk),i=x5(t,n,r),i<Dk)?[NaN,NaN]:[vs(n,t)*Br,fo(r/i)*Br]}function R5(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function F5(e,t){return[hn(e)>Gt?e+Math.round(-e/Ra)*Ra:e,t]}F5.invert=F5;function tfe(e,t,n){return(e%=Ra)?t||n?R5(rfe(e),ife(t,n)):rfe(e):t||n?ife(t,n):F5}function nfe(e){return function(t,n){return t+=e,[t>Gt?t-Ra:t<-Gt?t+Ra:t,n]}}function rfe(e){var t=nfe(e);return t.invert=nfe(-e),t}function ife(e,t){var n=yt(e),r=ct(e),i=yt(t),a=ct(t);function o(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*n+c*r;return[vs(f*i-h*a,c*n-d*r),fo(h*i+f*a)]}return o.invert=function(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*i-f*a;return[vs(f*i+d*a,c*n+h*r),fo(h*n-c*r)]},o}function urt(e){e=tfe(e[0]*Kt,e[1]*Kt,e.length>2?e[2]*Kt:0);function t(n){return n=e(n[0]*Kt,n[1]*Kt),n[0]*=Br,n[1]*=Br,n}return t.invert=function(n){return n=e.invert(n[0]*Kt,n[1]*Kt),n[0]*=Br,n[1]*=Br,n},t}function lrt(e,t,n,r,i,a){if(!!n){var o=yt(t),s=ct(t),u=r*n;i==null?(i=t+r*Ra,a=t-u/2):(i=afe(o,i),a=afe(o,a),(r>0?i<a:i>a)&&(i+=r*Ra));for(var l,c=i;r>0?c>a:c<a;c-=u)l=Bk([o,-s*yt(c),-s*ct(c)]),e.point(l[0],l[1])}}function afe(e,t){t=Pp(t),t[0]-=e,Uk(t);var n=Pce(-t[1]);return((-t[2]<0?-n:n)+Ra-mt)%Ra}function ofe(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:ji,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Yk(e,t){return hn(e[0]-t[0])<mt&&hn(e[1]-t[1])<mt}function Zk(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function sfe(e,t,n,r,i){var a=[],o=[],s,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(Yk(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),s=0;s<g;++s)i.point((m=p[s])[0],m[1]);i.lineEnd();return}v[0]+=2*mt}a.push(y=new Zk(m,p,null,!0)),o.push(y.o=new Zk(m,null,y,!1)),a.push(y=new Zk(v,p,null,!1)),o.push(y.o=new Zk(v,null,y,!0))}}),!!a.length){for(o.sort(t),ufe(a),ufe(o),s=0,u=o.length;s<u;++s)o[s].e=n=!n;for(var l=a[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function ufe(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function M5(e){return hn(e[0])<=Gt?e[0]:ys(e[0])*((hn(e[0])+Gt)%Ra-Gt)}function crt(e,t){var n=M5(t),r=t[1],i=ct(r),a=[ct(n),-yt(n),0],o=0,s=0,u=new Ia;i===1?r=Dr+mt:i===-1&&(r=-Dr-mt);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=M5(h),g=h[1]/2+Rk,m=ct(g),v=yt(g),y=0;y<d;++y,p=x,m=S,v=A,h=b){var b=f[y],x=M5(b),w=b[1]/2+Rk,S=ct(w),A=yt(w),_=x-p,E=_>=0?1:-1,C=E*_,k=C>Gt,T=m*S;if(u.add(vs(T*E*ct(C),v*A+T*yt(C))),o+=k?_+E*Ra:_,k^p>=n^x>=n){var I=Yv(Pp(h),Pp(b));Uk(I);var N=Yv(a,I);Uk(N);var O=(k^_>=0?-1:1)*fo(N[2]);(r>O||r===O&&(I[0]||I[1]))&&(s+=k^_>=0?1:-1)}}return(o<-mt||o<mt&&u<-Dk)^s&1}function lfe(e,t,n,r){return function(i){var a=t(i),o=ofe(),s=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=uie(c);var x=crt(l,r);c.length?(u||(i.polygonStart(),u=!0),sfe(c,drt,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){a.point(x,w)}function g(){d.point=p,a.lineStart()}function m(){d.point=h,a.lineEnd()}function v(x,w){f.push([x,w]),s.point(x,w)}function y(){s.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=o.result(),S,A=w.length,_,E,C;if(f.pop(),l.push(f),f=null,!!A){if(x&1){if(E=w[0],(_=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((C=E[S])[0],C[1]);i.lineEnd()}return}A>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(frt))}}return d}}function frt(e){return e.length>1}function drt(e,t){return((e=e.x)[0]<0?e[1]-Dr-mt:Dr-e[1])-((t=t.x)[0]<0?t[1]-Dr-mt:Dr-t[1])}var cfe=lfe(function(){return!0},hrt,grt,[-Gt,-Dr]);function hrt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?Gt:-Gt,u=hn(a-t);hn(u-Gt)<mt?(e.point(t,n=(n+o)/2>0?Dr:-Dr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&u>=Gt&&(hn(t-r)<mt&&(t-=r*mt),hn(a-s)<mt&&(a-=s*mt),n=prt(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function prt(e,t,n,r){var i,a,o=ct(e-n);return hn(o)>mt?Xv((ct(t)*(a=yt(r))*ct(n)-ct(r)*(i=yt(t))*ct(e))/(i*a*o)):(t+r)/2}function grt(e,t,n,r){var i;if(e==null)i=n*Dr,r.point(-Gt,i),r.point(0,i),r.point(Gt,i),r.point(Gt,0),r.point(Gt,-i),r.point(0,-i),r.point(-Gt,-i),r.point(-Gt,0),r.point(-Gt,i);else if(hn(e[0]-t[0])>mt){var a=e[0]<t[0]?Gt:-Gt;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function mrt(e){var t=yt(e),n=6*Kt,r=t>0,i=hn(t)>mt;function a(c,f,d,h){lrt(h,e,n,d,c,f)}function o(c,f){return yt(c)*yt(f)>t}function s(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var y=[m,v],b,x=o(m,v),w=r?x?0:l(m,v):x?l(m+(m<0?Gt:-Gt),v):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,y),(!b||Yk(f,b)||Yk(y,b))&&(y[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!Yk(f,y))&&c.point(y[0],y[1]),f=y,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Pp(c),p=Pp(f),g=[1,0,0],m=Yv(h,p),v=zk(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var x=t*v/b,w=-t*y/b,S=Yv(g,m),A=jk(g,x),_=jk(m,w);k5(A,_);var E=S,C=zk(A,E),k=zk(E,E),T=C*C-k*(zk(A,A)-1);if(!(T<0)){var I=Fa(T),N=jk(E,(-C-I)/k);if(k5(N,A),N=Bk(N),!d)return N;var O=c[0],D=f[0],L=c[1],W=f[1],G;D<O&&(G=O,O=D,D=G);var K=D-O,ee=hn(K-Gt)<mt,ce=ee||K<mt;if(!ee&&W<L&&(G=L,L=W,W=G),ce?ee?L+W>0^N[1]<(hn(N[0]-O)<mt?L:W):L<=N[1]&&N[1]<=W:K>Gt^(O<=N[0]&&N[0]<=D)){var he=jk(E,(-C+I)/k);return k5(he,A),[N,Bk(he)]}}}function l(c,f){var d=r?e:Gt-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return lfe(o,s,a,r?[0,-e]:[-Gt,e-Gt])}function vrt(e,t,n,r,i,a){var o=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-s,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=a-s,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=s+c*h),f<1&&(t[0]=o+f*d,t[1]=s+f*h),!0}}}}}var kx=1e9,Jk=-kx;function ffe(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function a(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return hn(l[0]-e)<mt?c>0?0:3:hn(l[0]-n)<mt?c>0?2:1:hn(l[1]-t)<mt?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=ofe(),d,h,p,g,m,v,y,b,x,w,S,A={point:_,lineStart:T,lineEnd:I,polygonStart:C,polygonEnd:k};function _(O,D){i(O,D)&&c.point(O,D)}function E(){for(var O=0,D=0,L=h.length;D<L;++D)for(var W=h[D],G=1,K=W.length,ee=W[0],ce,he,Oe=ee[0],Te=ee[1];G<K;++G)ce=Oe,he=Te,ee=W[G],Oe=ee[0],Te=ee[1],he<=r?Te>r&&(Oe-ce)*(r-he)>(Te-he)*(e-ce)&&++O:Te<=r&&(Oe-ce)*(r-he)<(Te-he)*(e-ce)&&--O;return O}function C(){c=f,d=[],h=[],S=!0}function k(){var O=E(),D=S&&O,L=(d=uie(d)).length;(D||L)&&(l.polygonStart(),D&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),L&&sfe(d,s,O,a,l),l.polygonEnd()),c=l,d=h=p=null}function T(){A.point=N,h&&h.push(p=[]),w=!0,x=!1,y=b=NaN}function I(){d&&(N(g,m),v&&x&&f.rejoin(),d.push(f.result())),A.point=_,x&&c.lineEnd()}function N(O,D){var L=i(O,D);if(h&&p.push([O,D]),w)g=O,m=D,v=L,w=!1,L&&(c.lineStart(),c.point(O,D));else if(L&&x)c.point(O,D);else{var W=[y=Math.max(Jk,Math.min(kx,y)),b=Math.max(Jk,Math.min(kx,b))],G=[O=Math.max(Jk,Math.min(kx,O)),D=Math.max(Jk,Math.min(kx,D))];vrt(W,G,e,t,n,r)?(x||(c.lineStart(),c.point(W[0],W[1])),c.point(G[0],G[1]),L||c.lineEnd(),S=!1):L&&(c.lineStart(),c.point(O,D),S=!1)}y=O,b=D,x=L}return A}}function dfe(e,t,n){var r=jo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[i,a]})}}function hfe(e,t,n){var r=jo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[a,i]})}}function yrt(){var e,t,n,r,i,a,o,s,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return jo(Fk(r/c)*c,n,c).map(p).concat(jo(Fk(s/f)*f,o,f).map(g)).concat(jo(Fk(t/u)*u,e,u).filter(function(b){return hn(b%c)>mt}).map(d)).concat(jo(Fk(a/l)*l,i,l).filter(function(b){return hn(b%f)>mt}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(s).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],o=+b[1][1],r>n&&(b=r,r=n,n=b),s>o&&(b=s,s=o,o=b),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],a=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),a>i&&(b=a,a=i,i=b),v.precision(m)):[[t,a],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=dfe(a,i,90),h=hfe(t,e,m),p=dfe(s,o,90),g=hfe(r,n,m),v):m},v.extentMajor([[-180,-90+mt],[180,90-mt]]).extentMinor([[-180,-80-mt],[180,80+mt]])}var Tx=e=>e,P5=new Ia,$5=new Ia,pfe,gfe,L5,B5,Dd={point:ji,lineStart:ji,lineEnd:ji,polygonStart:function(){Dd.lineStart=brt,Dd.lineEnd=wrt},polygonEnd:function(){Dd.lineStart=Dd.lineEnd=Dd.point=ji,P5.add(hn($5)),$5=new Ia},result:function(){var e=P5/2;return P5=new Ia,e}};function brt(){Dd.point=xrt}function xrt(e,t){Dd.point=mfe,pfe=L5=e,gfe=B5=t}function mfe(e,t){$5.add(B5*e-L5*t),L5=e,B5=t}function wrt(){mfe(pfe,gfe)}var vfe=Dd,Jv=1/0,Qk=Jv,Ox=-Jv,eT=Ox,_rt={point:Srt,lineStart:ji,lineEnd:ji,polygonStart:ji,polygonEnd:ji,result:function(){var e=[[Jv,Qk],[Ox,eT]];return Ox=eT=-(Qk=Jv=1/0),e}};function Srt(e,t){e<Jv&&(Jv=e),e>Ox&&(Ox=e),t<Qk&&(Qk=t),t>eT&&(eT=t)}var tT=_rt,z5=0,j5=0,Ix=0,nT=0,rT=0,Qv=0,U5=0,W5=0,Nx=0,yfe,bfe,vl,yl,hu={point:Lp,lineStart:xfe,lineEnd:wfe,polygonStart:function(){hu.lineStart=Crt,hu.lineEnd=krt},polygonEnd:function(){hu.point=Lp,hu.lineStart=xfe,hu.lineEnd=wfe},result:function(){var e=Nx?[U5/Nx,W5/Nx]:Qv?[nT/Qv,rT/Qv]:Ix?[z5/Ix,j5/Ix]:[NaN,NaN];return z5=j5=Ix=nT=rT=Qv=U5=W5=Nx=0,e}};function Lp(e,t){z5+=e,j5+=t,++Ix}function xfe(){hu.point=Ert}function Ert(e,t){hu.point=Art,Lp(vl=e,yl=t)}function Art(e,t){var n=e-vl,r=t-yl,i=Fa(n*n+r*r);nT+=i*(vl+e)/2,rT+=i*(yl+t)/2,Qv+=i,Lp(vl=e,yl=t)}function wfe(){hu.point=Lp}function Crt(){hu.point=Trt}function krt(){_fe(yfe,bfe)}function Trt(e,t){hu.point=_fe,Lp(yfe=vl=e,bfe=yl=t)}function _fe(e,t){var n=e-vl,r=t-yl,i=Fa(n*n+r*r);nT+=i*(vl+e)/2,rT+=i*(yl+t)/2,Qv+=i,i=yl*e-vl*t,U5+=i*(vl+e),W5+=i*(yl+t),Nx+=i*3,Lp(vl=e,yl=t)}var Sfe=hu;function Efe(e){this._context=e}Efe.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ra);break}}},result:ji};var V5=new Ia,q5,Afe,Cfe,Dx,Rx,iT={point:ji,lineStart:function(){iT.point=Ort},lineEnd:function(){q5&&kfe(Afe,Cfe),iT.point=ji},polygonStart:function(){q5=!0},polygonEnd:function(){q5=null},result:function(){var e=+V5;return V5=new Ia,e}};function Ort(e,t){iT.point=kfe,Afe=Dx=e,Cfe=Rx=t}function kfe(e,t){Dx-=e,Rx-=t,V5.add(Fa(Dx*Dx+Rx*Rx)),Dx=e,Rx=t}var Tfe=iT;function Ofe(){this._string=[]}Ofe.prototype={_radius:4.5,_circle:Ife(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Ife(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Ife(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Nfe(e,t){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Nc(o,r(i))),i.result()}return a.area=function(o){return Nc(o,r(vfe)),vfe.result()},a.measure=function(o){return Nc(o,r(Tfe)),Tfe.result()},a.bounds=function(o){return Nc(o,r(tT)),tT.result()},a.centroid=function(o){return Nc(o,r(Sfe)),Sfe.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,Tx):(e=o).stream,a):e},a.context=function(o){return arguments.length?(i=o==null?(t=null,new Ofe):new Efe(t=o),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(e).context(t)}function aT(e){return function(t){var n=new H5;for(var r in e)n[r]=e[r];return n.stream=t,n}}function H5(){}H5.prototype={constructor:H5,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function G5(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Nc(n,e.stream(tT)),t(tT.result()),r!=null&&e.clipExtent(r),e}function oT(e,t,n){return G5(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,u])},n)}function K5(e,t,n){return oT(e,[[0,0],t],n)}function X5(e,t,n){return G5(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function Y5(e,t,n){return G5(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var Dfe=16,Irt=yt(30*Kt);function Rfe(e,t){return+t?Drt(e,t):Nrt(e)}function Nrt(e){return aT({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Drt(e,t){function n(r,i,a,o,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=o+d,w=s+h,S=u+p,A=Fa(x*x+w*w+S*S),_=fo(S/=A),E=hn(hn(S)-1)<mt||hn(a-f)<mt?(a+f)/2:vs(w,x),C=e(E,_),k=C[0],T=C[1],I=k-r,N=T-i,O=y*I-v*N;(O*O/b>t||hn((v*I+y*N)/b-.5)>.3||o*d+s*h+u*p<Irt)&&(n(r,i,a,o,s,u,k,T,E,x/=A,w/=A,S,g,m),m.point(k,T),n(k,T,E,x,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,a,o,s,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,E){_=e(_,E),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,E){var C=Pp([_,E]),k=e(_,E);n(f,d,c,h,p,g,f=k[0],d=k[1],c=_,h=C[0],p=C[1],g=C[2],Dfe,r),r.point(f,d)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=S,m.lineEnd=A}function S(_,E){b(i=_,E),a=f,o=d,s=h,u=p,l=g,m.point=b}function A(){n(f,d,c,h,p,g,a,o,i,s,u,l,Dfe,r),m.lineEnd=x,x()}return m}}var Rrt=aT({point:function(e,t){this.stream.point(e*Kt,t*Kt)}});function Frt(e){return aT({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Mrt(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function Ffe(e,t,n,r,i,a){if(!a)return Mrt(e,t,n,r,i);var o=yt(a),s=ct(a),u=o*e,l=s*e,c=o/e,f=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function bl(e){return Mfe(function(){return e})()}function Mfe(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=cfe,m=null,v,y,b,x=Tx,w=.5,S,A,_,E,C;function k(O){return _(O[0]*Kt,O[1]*Kt)}function T(O){return O=_.invert(O[0],O[1]),O&&[O[0]*Br,O[1]*Br]}k.stream=function(O){return E&&C===O?E:E=Rrt(Frt(c)(g(S(x(C=O)))))},k.preclip=function(O){return arguments.length?(g=O,p=void 0,N()):g},k.postclip=function(O){return arguments.length?(x=O,m=v=y=b=null,N()):x},k.clipAngle=function(O){return arguments.length?(g=+O?mrt(p=O*Kt):(p=null,cfe),N()):p*Br},k.clipExtent=function(O){return arguments.length?(x=O==null?(m=v=y=b=null,Tx):ffe(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),N()):m==null?null:[[m,v],[y,b]]},k.scale=function(O){return arguments.length?(n=+O,I()):n},k.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],I()):[r,i]},k.center=function(O){return arguments.length?(a=O[0]%360*Kt,o=O[1]%360*Kt,I()):[a*Br,o*Br]},k.rotate=function(O){return arguments.length?(s=O[0]%360*Kt,u=O[1]%360*Kt,l=O.length>2?O[2]%360*Kt:0,I()):[s*Br,u*Br,l*Br]},k.angle=function(O){return arguments.length?(f=O%360*Kt,I()):f*Br},k.reflectX=function(O){return arguments.length?(d=O?-1:1,I()):d<0},k.reflectY=function(O){return arguments.length?(h=O?-1:1,I()):h<0},k.precision=function(O){return arguments.length?(S=Rfe(A,w=O*O),N()):Fa(w)},k.fitExtent=function(O,D){return oT(k,O,D)},k.fitSize=function(O,D){return K5(k,O,D)},k.fitWidth=function(O,D){return X5(k,O,D)},k.fitHeight=function(O,D){return Y5(k,O,D)};function I(){var O=Ffe(n,0,0,d,h,f).apply(null,t(a,o)),D=Ffe(n,r-O[0],i-O[1],d,h,f);return c=tfe(s,u,l),A=R5(t,D),_=R5(c,A),S=Rfe(A,w),N()}function N(){return E=C=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&T,I()}}function Z5(e){var t=0,n=Gt/3,r=Mfe(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*Kt,n=a[1]*Kt):[t*Br,n*Br]},i}function Prt(e){var t=yt(e);function n(r,i){return[r*t,ct(i)/t]}return n.invert=function(r,i){return[r/t,fo(i*t)]},n}function $rt(e,t){var n=ct(e),r=(n+ct(t))/2;if(hn(r)<mt)return Prt(e);var i=1+n*(2*r-n),a=Fa(i)/r;function o(s,u){var l=Fa(i-2*r*ct(u))/r;return[l*ct(s*=r),a-l*yt(s)]}return o.invert=function(s,u){var l=a-u,c=vs(s,hn(l))*ys(l);return l*r<0&&(c-=Gt*ys(s)*ys(l)),[c/r,fo((i-(s*s+l*l)*r*r)/(2*r))]},o}function sT(){return Z5($rt).scale(155.424).center([0,33.6442])}function Pfe(){return sT().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Lrt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Brt(){var e,t,n=Pfe(),r,i=sT().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=sT().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(a.point(h,p),u)||(s.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Lrt([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),a=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+mt,g+.12*h+mt],[p-.214*h-mt,g+.234*h-mt]]).stream(l),s=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+mt,g+.166*h+mt],[p-.115*h-mt,g+.234*h-mt]]).stream(l),f()},c.fitExtent=function(d,h){return oT(c,d,h)},c.fitSize=function(d,h){return K5(c,d,h)},c.fitWidth=function(d,h){return X5(c,d,h)},c.fitHeight=function(d,h){return Y5(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function $fe(e){return function(t,n){var r=yt(t),i=yt(n),a=e(r*i);return a===1/0?[2,0]:[a*i*ct(t),a*ct(n)]}}function Fx(e){return function(t,n){var r=Fa(t*t+n*n),i=e(r),a=ct(i),o=yt(i);return[vs(t*a,r*o),fo(r&&n*a/r)]}}var Lfe=$fe(function(e){return Fa(2/(1+e))});Lfe.invert=Fx(function(e){return 2*fo(e/2)});function zrt(){return bl(Lfe).scale(124.75).clipAngle(180-.001)}var Bfe=$fe(function(e){return(e=Pce(e))&&e/ct(e)});Bfe.invert=Fx(function(e){return e});function jrt(){return bl(Bfe).scale(79.4188).clipAngle(180-.001)}function uT(e,t){return[e,Mk(_5((Dr+t)/2))]}uT.invert=function(e,t){return[e,2*Xv(Mce(t))-Dr]};function Urt(){return zfe(uT).scale(961/Ra)}function zfe(e){var t=bl(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=s=u=l=null:(o=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,s],[u,l]]};function c(){var f=Gt*r(),d=t(urt(t.rotate()).invert([0,0]));return a(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===uT?[[Math.max(d[0]-f,o),s],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function lT(e){return _5((Dr+e)/2)}function Wrt(e,t){var n=yt(e),r=e===t?ct(e):Mk(n/yt(t))/Mk(lT(t)/lT(e)),i=n*w5(lT(e),r)/r;if(!r)return uT;function a(o,s){i>0?s<-Dr+mt&&(s=-Dr+mt):s>Dr-mt&&(s=Dr-mt);var u=i/w5(lT(s),r);return[u*ct(r*o),i-u*yt(r*o)]}return a.invert=function(o,s){var u=i-s,l=ys(r)*Fa(o*o+u*u),c=vs(o,hn(u))*ys(u);return u*r<0&&(c-=Gt*ys(o)*ys(u)),[c/r,2*Xv(w5(i/l,1/r))-Dr]},a}function Vrt(){return Z5(Wrt).scale(109.5).parallels([30,30])}function cT(e,t){return[e,t]}cT.invert=cT;function qrt(){return bl(cT).scale(152.63)}function Hrt(e,t){var n=yt(e),r=e===t?ct(e):(n-yt(t))/(t-e),i=n/r+e;if(hn(r)<mt)return cT;function a(o,s){var u=i-s,l=r*o;return[u*ct(l),i-u*yt(l)]}return a.invert=function(o,s){var u=i-s,l=vs(o,hn(u))*ys(u);return u*r<0&&(l-=Gt*ys(o)*ys(u)),[l/r,i-ys(r)*Fa(o*o+u*u)]},a}function Grt(){return Z5(Hrt).scale(131.154).center([0,13.9389])}var Mx=1.340264,Px=-.081106,$x=893e-6,Lx=.003796,fT=Fa(3)/2,Krt=12;function jfe(e,t){var n=fo(fT*ct(t)),r=n*n,i=r*r*r;return[e*yt(n)/(fT*(Mx+3*Px*r+i*(7*$x+9*Lx*r))),n*(Mx+Px*r+i*($x+Lx*r))]}jfe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,u;a<Krt&&(s=n*(Mx+Px*r+i*($x+Lx*r))-t,u=Mx+3*Px*r+i*(7*$x+9*Lx*r),n-=o=s/u,r=n*n,i=r*r*r,!(hn(o)<Dk));++a);return[fT*e*(Mx+3*Px*r+i*(7*$x+9*Lx*r))/yt(n),fo(ct(n)/fT)]};function Xrt(){return bl(jfe).scale(177.158)}function Ufe(e,t){var n=yt(t),r=yt(e)*n;return[n*ct(e)/r,ct(t)/r]}Ufe.invert=Fx(Xv);function Yrt(){return bl(Ufe).scale(144.049).clipAngle(60)}function Zrt(){var e=1,t=0,n=0,r=1,i=1,a=0,o,s,u=null,l,c,f,d=1,h=1,p=aT({point:function(x,w){var S=b([x,w]);this.stream.point(S[0],S[1])}}),g=Tx,m,v;function y(){return d=e*r,h=e*i,m=v=null,b}function b(x){var w=x[0]*d,S=x[1]*h;if(a){var A=S*o-w*s;w=w*o+S*s,S=A}return[w+t,S+n]}return b.invert=function(x){var w=x[0]-t,S=x[1]-n;if(a){var A=S*o+w*s;w=w*o-S*s,S=A}return[w/d,S/h]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,Tx):ffe(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(a=x%360*Kt,s=ct(a),o=yt(a),y()):a*Br},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return oT(b,x,w)},b.fitSize=function(x,w){return K5(b,x,w)},b.fitWidth=function(x,w){return X5(b,x,w)},b.fitHeight=function(x,w){return Y5(b,x,w)},b}function Wfe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Wfe.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(hn(i)>mt&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Jrt(){return bl(Wfe).scale(175.295)}function Vfe(e,t){return[yt(t)*ct(e),ct(t)]}Vfe.invert=Fx(fo);function Qrt(){return bl(Vfe).scale(249.5).clipAngle(90+mt)}function qfe(e,t){var n=yt(t),r=1+yt(e)*n;return[n*ct(e)/r,ct(t)/r]}qfe.invert=Fx(function(e){return 2*Xv(e)});function eit(){return bl(qfe).scale(250).clipAngle(142)}function Hfe(e,t){return[Mk(_5((Dr+t)/2)),-e]}Hfe.invert=function(e,t){return[-t,2*Xv(Mce(e))-Dr]};function tit(){var e=zfe(Hfe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var nit=Math.abs,J5=Math.cos,dT=Math.sin,rit=1e-6,Gfe=Math.PI,Q5=Gfe/2,Kfe=iit(2);function Xfe(e){return e>1?Q5:e<-1?-Q5:Math.asin(e)}function iit(e){return e>0?Math.sqrt(e):0}function ait(e,t){var n=e*dT(t),r=30,i;do t-=i=(t+dT(t)-n)/(1+J5(t));while(nit(i)>rit&&--r>0);return t/2}function oit(e,t,n){function r(i,a){return[e*i*J5(a=ait(n,a)),t*dT(a)]}return r.invert=function(i,a){return a=Xfe(a/t),[i/(e*J5(a)),Xfe((2*a+dT(2*a))/n)]},r}var sit=oit(Kfe/Q5,Kfe,Gfe);function uit(){return bl(sit).scale(169.529)}const lit=Nfe(),e6=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function cit(e,t){return function n(){const r=t();return r.type=e,r.path=Nfe().projection(r),r.copy=r.copy||function(){const i=n();return e6.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function t6(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(hT[e]=cit(e,t),this):hT[e]||null}function Yfe(e){return e&&e.path||lit}const hT={albers:Pfe,albersusa:Brt,azimuthalequalarea:zrt,azimuthalequidistant:jrt,conicconformal:Vrt,conicequalarea:sT,conicequidistant:Grt,equalEarth:Xrt,equirectangular:qrt,gnomonic:Yrt,identity:Zrt,mercator:Urt,mollweide:uit,naturalEarth1:Jrt,orthographic:Qrt,stereographic:eit,transversemercator:tit};for(const e in hT)t6(e,hT[e]);function fit(){}const Fc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Zfe(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return a(u,l,d=>{n(d,u,l),dit(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(hit((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function a(u,l,c){var f=new Array,d=new Array,h,p,g,m,v,y;for(h=p=-1,m=u[0]>=l,Fc[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,Fc[g|m<<1].forEach(b);for(Fc[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,v=u[p*e]>=l,Fc[m<<1|v<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,y=v,v=u[p*e+h+1]>=l,Fc[g|m<<1|v<<2|y<<3].forEach(b);Fc[m|v<<3].forEach(b)}for(h=-1,v=u[p*e]>=l,Fc[v<<2].forEach(b);++h<e-1;)y=v,v=u[p*e+h+1]>=l,Fc[v<<2|y<<3].forEach(b);Fc[v<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],S=[x[1][0]+h,x[1][1]+p],A=o(w),_=o(S),E,C;(E=d[A])?(C=f[_])?(delete d[E.end],delete f[C.start],E===C?(E.ring.push(S),c(E.ring)):f[E.start]=d[C.end]={start:E.start,end:C.end,ring:E.ring.concat(C.ring)}):(delete d[E.end],E.ring.push(S),d[E.end=_]=E):(E=f[_])?(C=d[A])?(delete f[E.start],delete d[C.end],E===C?(E.ring.push(S),c(E.ring)):f[C.start]=d[E.end]={start:C.start,end:E.end,ring:C.ring.concat(E.ring)}):(delete f[E.start],E.ring.unshift(w),f[E.start=A]=E):f[A]=d[_]={start:A,end:_,ring:[w,S]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,v=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(v-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||Se("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:fit,r):n===s},r}function dit(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function hit(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=pit(e,t[n]))return i;return 0}function pit(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var u=e[a],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(git(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function git(e,t,n){var r;return mit(e,t,n)&&vit(e[r=+(e[0]===t[0])],n[r],t[r])}function mit(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function vit(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Jfe(e,t,n){return function(r){var i=nl(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=t?nd(a,o,e):s/(e+1);return jo(a+u,o,u)}}function n6(e){ve.call(this,null,e)}n6.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},$e(n6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Oa,a=Zfe().smooth(e.smooth!==!1),o=e.thresholds||yit(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=a.size([c.width,c.height])(c.values,ut(o)?o:o(c.values));bit(f,c,l,e),f.forEach(d=>{u.push(dC(l,In(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function yit(e,t,n){const r=Jfe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>gp(t(i).values)))}function bit(e,t,n,r){let i=r.scale||t.scale,a=r.translate||t.translate;if(Lt(i)&&(i=i(n,r)),Lt(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(ed(i)?i:i[0])||1,s=(ed(i)?i:i[1])||1,u=a&&a[0]||0,l=a&&a[1]||0;e.forEach(Qfe(t,o,s,u,l))}function Qfe(e,t,n,r,i){const a=e.x1||0,o=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-a)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function ede(e,t,n){const r=e>=0?e:A4(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function r6(e){return Lt(e)?e:Ji(+e)}function tde(){var e=u=>u[0],t=u=>u[1],n=pv,r=[-1,-1],i=960,a=500,o=2;function s(u,l){const c=ede(r[0],u,e)>>o,f=ede(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),g=2*h+(a>>o),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(x=>{const w=d+(+e(x)>>o),S=h+(+t(x)>>o);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(x))}),c>0&&f>0?(e0(p,g,m,v,c),t0(p,g,v,m,f),e0(p,g,m,v,c),t0(p,g,v,m,f),e0(p,g,m,v,c),t0(p,g,v,m,f)):c>0?(e0(p,g,m,v,c),e0(p,g,v,m,c),e0(p,g,m,v,c),y=v):f>0&&(t0(p,g,m,v,f),t0(p,g,v,m,f),t0(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*o):1/lie(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(i>>o),y2:h+(a>>o)}}return s.x=function(u){return arguments.length?(e=r6(u),s):e},s.y=function(u){return arguments.length?(t=r6(u),s):t},s.weight=function(u){return arguments.length?(n=r6(u),s):n},s.size=function(u){if(!arguments.length)return[i,a];var l=+u[0],c=+u[1];return l>=0&&c>=0||Se("invalid size"),i=l,a=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||Se("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),s):1<<o},s.bandwidth=function(u){return arguments.length?(u=wt(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&Se("invalid bandwidth"),r=u,s):r},s}function e0(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+o*e]),s>=i&&(s>=a&&(u-=n[s-a+o*e]),r[s-i+o*e]=u/Math.min(s+1,e-1+a-s,a))}function t0(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[o+s*e]),s>=i&&(s>=a&&(u-=n[o+(s-a)*e]),r[o+(s-i)*e]=u/Math.min(s+1,t-1+a-s,a))}function i6(e){ve.call(this,null,e)}i6.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const xit=["x","y","weight","size","cellSize","bandwidth"];function nde(e,t){return xit.forEach(n=>t[n]!=null?e[n](t[n]):0),e}$e(i6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=wit(r,e.groupby),a=(e.groupby||[]).map(Nr),o=nde(tde(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<a.length;++d)c[a[d]]=f[d];return c}return u=i.map(c=>In(l({[s]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function wit(e,t){var n=[],r=c=>c(s),i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function a6(e){ve.call(this,null,e)}a6.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},$e(a6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Zfe().smooth(e.smooth!==!1),i=e.values,a=e.thresholds||Jfe(e.count||10,e.nice,!!i),o=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=nde(tde(),e)(i,!0),u=Qfe(s,s.scale||1,s.scale||1,0,0),o=[s.width,s.height],i=s.values),a=ut(a)?a:a(i),i=r.size(o)(i,a),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(In),n}});const o6="Feature",s6="FeatureCollection",_it="MultiPoint";function u6(e){ve.call(this,null,e)}u6.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},$e(u6,ve,{transform(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],s=e.geojson||!i&&Oa,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Yi(s))||a&&t.modified(Yi(a))||o&&t.modified(Yi(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),a&&o&&(t.visit(u,c=>{var f=a(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:o6,geometry:{type:_it,coordinates:r}})),this.value={type:s6,features:n}}});function l6(e){ve.call(this,null,e)}l6.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},$e(l6,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Oa,a=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=Yfe(e.projection),n.materialize().reflow()):o=i===Oa||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=Sit(r,e.pointRadius);return n.visit(o,u=>u[a]=r(i(u))),r.pointRadius(s),n.modifies(a)}});function Sit(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function c6(e){ve.call(this,null,e)}c6.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},$e(c6,ve,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],s=a[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[s]=f[1]):(c[o]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(a)}});function f6(e){ve.call(this,null,e)}f6.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},$e(f6,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;return(!r||e.modified())&&(this.value=r=Eit(Yfe(e.projection),e.field||ao("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function Eit(e,t,n){const r=n==null?i=>e(t(i)):i=>{var a=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(a),o};return r.context=i=>(e.context(i),r),r}function d6(e){ve.call(this,[],e),this.generator=yrt()}d6.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},$e(d6,ve,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const a in e)Lt(r[a])&&r[a](e[a]);return i=r(),n.length?t.mod.push(yae(n[0],i)):t.add.push(In(i)),n[0]=i,t}});function h6(e){ve.call(this,null,e)}h6.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},$e(h6,ve,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||Oa,a=Cit(e.opacity,e),o=Ait(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?gp(n.map(l=>gp(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Rt({},l,u);r||(f.$max=gp(c.values||[])),l[s]=kit(c,f,o.dep?o:Ji(o(f)),a.dep?a:Ji(a(f)))}),t.reflow(!0).modifies(s)}});function Ait(e,t){let n;return Lt(e)?(n=r=>gd(e(r,t)),n.dep=rde(e)):n=Ji(gd(e||"#888")),n}function Cit(e,t){let n;return Lt(e)?(n=r=>e(r,t),n.dep=rde(e)):e?n=Ji(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function rde(e){if(!Lt(e))return!1;const t=iu(Yi(e));return t.$x||t.$y||t.$value||t.$max}function kit(e,t,n,r){const i=e.width,a=e.height,o=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||a,c=e.values,f=c?m=>c[m]:Zf,d=Ov(u-o,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-s),g=p.data;for(let m=s,v=0;m<l;++m){t.$y=m-s;for(let y=o,b=m*i;y<u;++y,v+=4){t.$x=y-o,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function ide(e){ve.call(this,null,e),this.modified(!0)}$e(ide,ve,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Oit(e.type),e6.forEach(r=>{e[r]!=null&&ade(n,r,e[r])})):e6.forEach(r=>{e.modified(r)&&ade(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Tit(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Tit(e,t){const n=Iit(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Oit(e){const t=t6((e||"mercator").toLowerCase());return t||Se("Unrecognized projection type: "+e),t()}function ade(e,t,n){Lt(e[t])&&e[t](n)}function Iit(e){return e=wt(e),e.length===1?e[0]:{type:s6,features:e.reduce((t,n)=>t.concat(Nit(n)),[])}}function Nit(e){return e.type===s6?e.features:wt(e).filter(t=>t!=null).map(t=>t.type===o6?t:{type:o6,geometry:t})}var Dit=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:a6,geojson:u6,geopath:l6,geopoint:c6,geoshape:f6,graticule:d6,heatmap:h6,isocontour:n6,kde2d:i6,projection:ide});function Rit(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,u=0,l=0;for(a=0;a<o;++a)s=n[a],u+=s.x,l+=s.y;for(u=(u/o-e)*r,l=(l/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=u,s.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Fit(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return ode(this.cover(t,n),t,n,e)}function ode(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,v,y;if(!a)return e._root=o,e;for(;a.length;)if((g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,e;if(h=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===h&&n===p)return o.next=a,i?i[v]=o:e._root=o,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=a,i[v]=o,e}function Mit(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>f&&(f=a));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)ode(this,o[n],s[n],e[n]);return this}function Pit(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function $it(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Lit(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function La(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Bit(e,t,n){var r,i=this._x0,a=this._y0,o,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new La(h,i,a,c,f)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(u=p.x1)<i||(l=p.y1)<a))if(h.length){var m=(o+u)/2,v=(s+l)/2;d.push(new La(h[3],m,v,u,l),new La(h[2],o,v,m,l),new La(h[1],m,s,u,v),new La(h[0],o,s,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,a=t-w,c=e+w,f=t+w,r=h.data}}return r}function zit(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function jit(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Uit(){return this._root}function Wit(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Vit(e){var t=[],n,r=this._root,i,a,o,s,u;for(r&&t.push(new La(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(a+s)/2,c=(o+u)/2;(i=r[3])&&t.push(new La(i,l,c,s,u)),(i=r[2])&&t.push(new La(i,a,c,l,u)),(i=r[1])&&t.push(new La(i,l,o,s,c)),(i=r[0])&&t.push(new La(i,a,o,l,c))}return this}function qit(e){var t=[],n=[],r;for(this._root&&t.push(new La(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(s+l)/2;(a=i[0])&&t.push(new La(a,o,s,c,f)),(a=i[1])&&t.push(new La(a,c,s,u,f)),(a=i[2])&&t.push(new La(a,o,f,c,l)),(a=i[3])&&t.push(new La(a,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Hit(e){return e[0]}function Git(e){return arguments.length?(this._x=e,this):this._x}function Kit(e){return e[1]}function Xit(e){return arguments.length?(this._y=e,this):this._y}function p6(e,t,n){var r=new g6(t??Hit,n??Kit,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function g6(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function sde(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ba=p6.prototype=g6.prototype;Ba.copy=function(){var e=new g6(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=sde(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=sde(r));return e},Ba.add=Fit,Ba.addAll=Mit,Ba.cover=Pit,Ba.data=$it,Ba.extent=Lit,Ba.find=Bit,Ba.remove=zit,Ba.removeAll=jit,Ba.root=Uit,Ba.size=Wit,Ba.visit=Vit,Ba.visitAfter=qit,Ba.x=Git,Ba.y=Xit;function za(e){return function(){return e}}function Rd(e){return(e()-.5)*1e-6}function Yit(e){return e.x+e.vx}function Zit(e){return e.y+e.vy}function Jit(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=za(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,v=0;v<a;++v)for(f=p6(t,Yit,Zit).visitAfter(s),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,x,w,S,A){var _=b.data,E=b.r,C=g+E;if(_){if(_.index>d.index){var k=h-_.x-_.vx,T=p-_.y-_.vy,I=k*k+T*T;I<C*C&&(k===0&&(k=Rd(r),I+=k*k),T===0&&(T=Rd(r),I+=T*T),I=(C-(I=Math.sqrt(I)))/I*i,d.vx+=(k*=I)*(C=(E*=E)/(m+E)),d.vy+=(T*=I)*C,_.vx-=k*(C=1-C),_.vy-=T*C)}return}return x>h+C||S<h-C||w>p+C||A<p-C}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:za(+l),u(),o):e},o}function Qit(e){return e.index}function ude(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function eat(e){var t=Qit,n=f,r,i=za(30),a,o,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,S,A,_,E,C;b<y;++b)x=e[b],w=x.source,S=x.target,A=S.x+S.vx-w.x-w.vx||Rd(l),_=S.y+S.vy-w.y-w.vy||Rd(l),E=Math.sqrt(A*A+_*_),E=(E-a[b])/E*m*r[b],A*=E,_*=E,S.vx-=A*(C=u[b]),S.vy-=_*C,w.vx+=A*(C=1-C),w.vy+=_*C}function h(){if(!!o){var m,v=o.length,y=e.length,b=new Map(o.map((w,S)=>[t(w,S,o),w])),x;for(m=0,s=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=ude(b,x.source)),typeof x.target!="object"&&(x.target=ude(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(!!o)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!o)for(var m=0,v=e.length;m<v;++m)a[m]=+i(e[m],m,e)}return d.initialize=function(m,v){o=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:za(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:za(+m),g(),d):i},d}var tat={value:()=>{}};function lde(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new pT(n)}function pT(e){this._=e}function nat(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}pT.prototype=lde.prototype={constructor:pT,on:function(e,t){var n=this._,r=nat(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=rat(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=cde(n[i],e.name,t);else if(t==null)for(i in n)n[i]=cde(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new pT(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function rat(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function cde(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=tat,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var n0=0,Bx=0,zx=0,fde=1e3,gT,jx,mT=0,Bp=0,vT=0,Ux=typeof performance=="object"&&performance.now?performance:Date,dde=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function m6(){return Bp||(dde(iat),Bp=Ux.now()+vT)}function iat(){Bp=0}function yT(){this._call=this._time=this._next=null}yT.prototype=hde.prototype={constructor:yT,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?m6():+n)+(t==null?0:+t),!this._next&&jx!==this&&(jx?jx._next=this:gT=this,jx=this),this._call=e,this._time=n,v6()},stop:function(){this._call&&(this._call=null,this._time=1/0,v6())}};function hde(e,t,n){var r=new yT;return r.restart(e,t,n),r}function aat(){m6(),++n0;for(var e=gT,t;e;)(t=Bp-e._time)>=0&&e._call.call(null,t),e=e._next;--n0}function pde(){Bp=(mT=Ux.now())+vT,n0=Bx=0;try{aat()}finally{n0=0,sat(),Bp=0}}function oat(){var e=Ux.now(),t=e-mT;t>fde&&(vT-=t,mT=e)}function sat(){for(var e,t=gT,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:gT=n);jx=e,v6(r)}function v6(e){if(!n0){Bx&&(Bx=clearTimeout(Bx));var t=e-Bp;t>24?(e<1/0&&(Bx=setTimeout(pde,e-Ux.now()-vT)),zx&&(zx=clearInterval(zx))):(zx||(mT=Ux.now(),zx=setInterval(oat,fde)),n0=1,dde(pde))}}function uat(e,t,n){var r=new yT,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(a,o,s){o=+o,s=s==null?m6():+s,r._restart(function u(l){l+=i,r._restart(u,i+=o,s),a(l)},o,s)},r.restart(e,t,n),r)}const lat=1664525,cat=1013904223,gde=4294967296;function fat(){let e=1;return()=>(e=(lat*e+cat)%gde)/gde}function dat(e){return e.x}function hat(e){return e.y}var pat=10,gat=Math.PI*(3-Math.sqrt(5));function mat(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=hde(f),l=lde("tick","end"),c=fat();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(a-n)*i,s.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=pat*Math.sqrt(.5+g),b=g*gat;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(a=+g,t):a},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,s.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?s.delete(g):s.set(g,p(m)),t):s.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,S,A,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)A=e[y],x=g-A.x,w=m-A.y,S=x*x+w*w,S<v&&(_=A,v=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function vat(){var e,t,n,r,i=za(-30),a,o=1,s=1/0,u=.81;function l(h){var p,g=e.length,m=p6(e,dat,hat).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(a=new Array(p),h=0;h<p;++h)g=e[h],a[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,v=0,y,b,x;if(h.length){for(y=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,x=v*v+y*y;if(b*b/u<x)return x<s&&(v===0&&(v=Rd(n),x+=v*v),y===0&&(y=Rd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)),t.vx+=v*h.value*r/x,t.vy+=y*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(v===0&&(v=Rd(n),x+=v*v),y===0&&(y=Rd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=a[h.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:za(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function yat(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}function bat(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}const mde={center:Rit,collide:Jit,nbody:vat,link:eat,x:yat,y:bat},Wx="forces",y6=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xat=["static","iterations"],vde=["x","y","vx","vy"];function b6(e){ve.call(this,null,e)}b6.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:vde}]},$e(b6,ve,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(y6),a=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&yde(n,e,0,t)):(this.value=n=_at(t.source,e),n.on("tick",wat(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(xat)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==Wx||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(vde)}});function wat(e,t){return()=>e.touch(t).run()}function _at(e,t){const n=mat(e),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),yde(n,t,!0).on("end",()=>a=!0)}function yde(e,t,n,r){var i=wt(t.forces),a,o,s,u;for(a=0,o=y6.length;a<o;++a)s=y6[a],s!==Wx&&t.modified(s)&&e[s](t[s]);for(a=0,o=i.length;a<o;++a)u=Wx+a,s=n||t.modified(Wx,a)?Eat(i[a]):r&&Sat(i[a],r)?e.force(u):null,s&&e.force(u,s);for(o=e.numForces||0;a<o;++a)e.force(Wx+a,null);return e.numForces=i.length,e}function Sat(e,t){var n,r;for(n in e)if(Lt(r=e[n])&&t.modified(Yi(r)))return 1;return 0}function Eat(e){var t,n;_t(mde,e.force)||Se("Unrecognized force: "+e.force),t=mde[e.force]();for(n in e)Lt(t[n])&&Aat(t[n],e[n],e);return t}function Aat(e,t,n){e(Lt(t)?r=>t(r,n):t)}var Cat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:b6});function kat(e,t){return e.parent===t.parent?1:2}function Tat(e){return e.reduce(Oat,0)/e.length}function Oat(e,t){return e+t.x}function Iat(e){return 1+e.reduce(Nat,0)}function Nat(e,t){return Math.max(e,t.y)}function Dat(e){for(var t;t=e.children;)e=t[0];return e}function Rat(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Fat(){var e=kat,t=1,n=1,r=!1;function i(a){var o,s=0;a.eachAfter(function(d){var h=d.children;h?(d.x=Tat(h),d.y=Iat(h)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var u=Dat(a),l=Rat(a),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return a.eachAfter(r?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],i):r?null:[t,n]},i.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],i):r?[t,n]:null},i}function Mat(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Pat(){return this.eachAfter(Mat)}function $at(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Lat(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function Bat(e,t){for(var n=this,r=[n],i=[],a,o,s,u=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function zat(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function jat(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Uat(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Wat(e){for(var t=this,n=Vat(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Vat(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function qat(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Hat(){return Array.from(this)}function Gat(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Kat(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Xat(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function x6(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Jat)):t===void 0&&(t=Zat);for(var n=new r0(e),r,i=[n],a,o,s,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new r0(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(bde)}function Yat(){return x6(this).eachBefore(Qat)}function Zat(e){return e.children}function Jat(e){return Array.isArray(e)?e[1]:null}function Qat(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function bde(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function r0(e){this.data=e,this.depth=this.height=0,this.parent=null}r0.prototype=x6.prototype={constructor:r0,count:Pat,each:$at,eachAfter:Bat,eachBefore:Lat,find:zat,sum:jat,sort:Uat,path:Wat,ancestors:qat,descendants:Hat,leaves:Gat,links:Kat,copy:Yat,[Symbol.iterator]:Xat};function eot(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tot(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function not(e){for(var t=0,n=(e=tot(Array.from(e))).length,r=[],i,a;t<n;)i=e[t],a&&xde(a,i)?++t:(a=iot(r=rot(r,i)),t=0);return a}function rot(e,t){var n,r;if(w6(t,e))return[t];for(n=0;n<e.length;++n)if(bT(t,e[n])&&w6(Vx(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(bT(Vx(e[n],e[r]),t)&&bT(Vx(e[n],t),e[r])&&bT(Vx(e[r],t),e[n])&&w6(wde(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function bT(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function xde(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function w6(e,t){for(var n=0;n<t.length;++n)if(!xde(e,t[n]))return!1;return!0}function iot(e){switch(e.length){case 1:return aot(e[0]);case 2:return Vx(e[0],e[1]);case 3:return wde(e[0],e[1],e[2])}}function aot(e){return{x:e.x,y:e.y,r:e.r}}function Vx(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,u=a-n,l=o-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+a+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+s)/2}}function wde(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-s,g=i-c,m=u-a,v=f-a,y=r*r+i*i-a*a,b=y-o*o-s*s+u*u,x=y-l*l-c*c+f*f,w=h*p-d*g,S=(p*x-g*b)/(w*2)-r,A=(g*m-p*v)/w,_=(h*b-d*x)/(w*2)-i,E=(d*v-h*m)/w,C=A*A+E*E-1,k=2*(a+S*A+_*E),T=S*S+_*_-a*a,I=-(C?(k+Math.sqrt(k*k-4*C*T))/(2*C):T/k);return{x:r+S+A*I,y:i+_+E*I,r:I}}function _de(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,s,u,l=r*r+o*o;l?(a=t.r+n.r,a*=a,u=e.r+n.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*o,n.y=e.y-i*o+s*r):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x+i*r-s*o,n.y=t.y+i*o+s*r)):(n.x=t.x+n.r,n.y=t.y)}function Sde(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Ede(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function xT(e){this._=e,this.next=null,this.previous=null}function oot(e){if(!(i=(e=eot(e)).length))return 0;var t,n,r,i,a,o,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;_de(n,t,r=e[2]),t=new xT(t),n=new xT(n),r=new xT(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){_de(t._,n._,r=e[s]),r=new xT(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(Sde(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(Sde(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,a=Ede(t);(r=r.next)!==n;)(o=Ede(r))<a&&(t=r,a=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=not(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function sot(e){return e==null?null:wT(e)}function wT(e){if(typeof e!="function")throw new Error;return e}function zp(){return 0}function i0(e){return function(){return e}}function uot(e){return Math.sqrt(e.value)}function lot(){var e=null,t=1,n=1,r=zp;function i(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(Ade(e)).eachAfter(_6(r,.5)).eachBefore(Cde(1)):a.eachBefore(Ade(uot)).eachAfter(_6(zp,1)).eachAfter(_6(r,a.r/Math.min(t,n))).eachBefore(Cde(Math.min(t,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=sot(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],n=+a[1],i):[t,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:i0(+a),i):r},i}function Ade(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function _6(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,s;if(o)for(i=0;i<a;++i)r[i].r+=o;if(s=oot(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=s+o}}}function Cde(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function kde(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function qx(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)o=a[s],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function cot(){var e=1,t=1,n=0,r=!1;function i(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),r&&o.eachBefore(kde),o}function a(o,s){return function(u){u.children&&qx(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var fot={depth:-1},Tde={};function dot(e){return e.id}function hot(e){return e.parentId}function Ode(){var e=dot,t=hot;function n(r){var i=Array.from(r),a=i.length,o,s,u,l,c,f,d,h=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new r0(o),(f=e(o,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Tde:c)),(f=t(o,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Tde)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=fot,u.eachBefore(function(p){p.depth=p.parent.depth+1,--a}).eachBefore(bde),u.parent=null,a>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=wT(r),n):e},n.parentId=function(r){return arguments.length?(t=wT(r),n):t},n}function pot(e,t){return e.parent===t.parent?1:2}function S6(e){var t=e.children;return t?t[0]:e.t}function E6(e){var t=e.children;return t?t[t.length-1]:e.t}function got(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function mot(e){for(var t=0,n=0,r=e.children,i=r.length,a;--i>=0;)a=r[i],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function vot(e,t,n){return e.a.parent===t.parent?e.a:n}function _T(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}_T.prototype=Object.create(r0.prototype);function yot(e){for(var t=new _T(e,0),n,r=[t],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new _T(a[o],o)),i.parent=n;return(t.parent=new _T(null,0)).children=[t],t}function bot(){var e=pot,t=1,n=1,r=null;function i(l){var c=yot(l);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function a(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){mot(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m,x;p=E6(p),d=S6(d),p&&d;)g=S6(g),h=E6(h),h.a=l,x=p.z+y-d.z-m+e(p._,d._),x>0&&(got(vot(p,l,f),l,x),m+=x,v+=x),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!E6(h)&&(h.t=p,h.m+=y-v),d&&!S6(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function ST(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)o=a[s],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var Ide=(1+Math.sqrt(5))/2;function Nde(e,t,n,r,i,a){for(var o=[],s=t.children,u,l,c=0,f=0,d=s.length,h,p,g=t.value,m,v,y,b,x,w,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=y=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,x=Math.max(y/S,S/v);f<d;++f){if(m+=l=s[f].value,l<v&&(v=l),l>y&&(y=l),S=m*m*w,b=Math.max(y/S,S/v),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:s.slice(c,f)}),u.dice?qx(u,n,r,i,g?r+=p*m/g:a):ST(u,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}var Dde=function e(t){function n(r,i,a,o,s){Nde(t,r,i,a,o,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Ide);function xot(){var e=Dde,t=!1,n=1,r=1,i=[0],a=zp,o=zp,s=zp,u=zp,l=zp;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(kde),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=l(d)-h,g+=o(d)-h,m-=s(d)-h,v-=u(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=wT(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:i0(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:i0(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:i0(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:i0(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:i0(+d),c):l},c}function wot(e,t,n,r,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,p,g,m,v){if(f>=d-1){var y=a[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=l[f],x=h/2+b,w=f+1,S=d-1;w<S;){var A=w+S>>>1;l[A]<x?w=A+1:S=A}x-l[w-1]<l[w]-x&&f+1<w&&--w;var _=l[w]-b,E=h-_;if(m-p>v-g){var C=h?(p*E+m*_)/h:m;c(f,w,_,p,g,C,v),c(w,d,E,C,g,m,v)}else{var k=h?(g*E+v*_)/h:v;c(f,w,_,p,g,m,k),c(w,d,E,p,k,m,v)}}}function _ot(e,t,n,r,i){(e.depth&1?ST:qx)(e,t,n,r,i)}var Sot=function e(t){function n(r,i,a,o,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?qx(l,i,a,o,g?a+=(s-a)*l.value/g:s):ST(l,i,a,g?i+=(o-i)*l.value/g:o,s),g-=l.value}else r._squarify=u=Nde(t,r,i,a,o,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Ide);function A6(e,t,n){const r={};return e.each(i=>{const a=i.data;n(a)&&(r[t(a)]=i)}),e.lookup=r,e}function C6(e){ve.call(this,null,e)}C6.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Eot=e=>e.values;$e(C6,ve,{transform(e,t){t.source||Se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;return(!a||r||t.changed())&&(a&&a.each(o=>{o.children&&fC(o.data)&&i.rem.push(o.data)}),this.value=a=x6({values:wt(e.keys).reduce((o,s)=>(o.key(s),o),Aot()).entries(i.source)},Eot),n&&a.each(o=>{o.children&&(o=In(o.data),i.add.push(o),i.source.push(o))}),A6(a,lt,lt)),i.source.root=a,i}});function Aot(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,a){if(a>=e.length)return i;const o=i.length,s=e[a++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],a);return l}function r(i,a){if(++a>e.length)return i;const o=[];for(const s in i)o.push({key:s,values:r(i[s],a)});return o}return t}function Mc(e){ve.call(this,null,e)}const Cot=(e,t)=>e.parent===t.parent?1:2;$e(Mc,ve,{transform(e,t){(!t.source||!t.source.root)&&Se(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(xp(e.sort,o=>o.data)),kot(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Cot:pv);try{this.value=n(i)}catch(o){Se(o)}return i.each(o=>Tot(o,r,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function kot(e,t,n){for(let r,i=0,a=t.length;i<a;++i)r=t[i],r in n&&e[r](n[r])}function Tot(e,t,n){const r=e.data,i=t.length-1;for(let a=0;a<i;++a)r[n[a]]=e[t[a]];r[n[i]]=e.children?e.children.length:0}const k6=["x","y","r","depth","children"];function T6(e){Mc.call(this,e)}T6.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:k6.length,default:k6}]},$e(T6,Mc,{layout:lot,params:["radius","size","padding"],fields:k6});const O6=["x0","y0","x1","y1","depth","children"];function I6(e){Mc.call(this,e)}I6.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:O6.length,default:O6}]},$e(I6,Mc,{layout:cot,params:["size","round","padding"],fields:O6});function N6(e){ve.call(this,null,e)}N6.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},$e(N6,ve,{transform(e,t){t.source||Se("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?A6(Ode().id(e.key).parentId(e.parentKey)(i.source),e.key,fs):A6(Ode()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Rde={tidy:bot,cluster:Fat},D6=["x","y","depth","children"];function R6(e){Mc.call(this,e)}R6.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:D6.length,default:D6}]},$e(R6,Mc,{layout(e){const t=e||"tidy";if(_t(Rde,t))return Rde[t]();Se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:D6});function F6(e){ve.call(this,[],e)}F6.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},$e(F6,ve,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return r||Se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>a[lt(o)]=1),r.each(o=>{const s=o.data,u=o.parent&&o.parent.data;u&&a[lt(s)]&&a[lt(u)]&&i.add.push(In({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>a[lt(o)]=1),n.forEach(o=>{(a[lt(o.source)]||a[lt(o.target)])&&i.mod.push(o)})),i}});const Fde={binary:wot,dice:qx,slice:ST,slicedice:_ot,squarify:Dde,resquarify:Sot},M6=["x0","y0","x1","y1","depth","children"];function P6(e){Mc.call(this,e)}P6.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:M6.length,default:M6}]},$e(P6,Mc,{layout(){const e=xot();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{_t(Fde,t)?e.tile(Fde[t]):Se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:M6});var Oot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:C6,pack:T6,partition:I6,stratify:N6,tree:R6,treelinks:F6,treemap:P6});const Iot=4278190080,Not=268435456,Dot=.0625;function Rot(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Fot(e,t,n,r){const i=e.width,a=e.height,o=n||r,s=Ov(i,a).getContext("2d");t.forEach(m=>Mde(s,m,o));const u=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,g;for(d=0;d<a;++d)for(f=0;f<i;++f)g=u[d*i+f]&Iot,g&&(h=e(f),p=e(d),r||l.set(h,p),o&&g^Not&&c.set(h,p));return[l,c]}function Mde(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(a=>Mde(e,a.items,n))}):Vo[r].draw(e,{items:n?t.map(Mot):t})}function Mot(e){const t=dC(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=Dot,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Pc=5,ja=31,Hx=32,Fd=new Uint32Array(Hx+1),pu=new Uint32Array(Hx+1);pu[0]=0,Fd[0]=~pu[0];for(let e=1;e<=Hx;++e)pu[e]=pu[e-1]<<1|1,Fd[e]=~pu[e];function Pot(e,t){const n=new Uint32Array(~~((e*t+Hx)/Hx));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const s=o*e+a;return n[s>>>Pc]&1<<(s&ja)},set:(a,o)=>{const s=o*e+a;r(s>>>Pc,1<<(s&ja))},clear:(a,o)=>{const s=o*e+a;i(s>>>Pc,~(1<<(s&ja)))},getRange:(a,o,s,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+a,f=l*e+s,d=c>>>Pc,h=f>>>Pc,d===h){if(n[d]&Fd[c&ja]&pu[(f&ja)+1])return!0}else{if(n[d]&Fd[c&ja]||n[h]&pu[(f&ja)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Pc,d=c>>>Pc,f===d)r(f,Fd[l&ja]&pu[(c&ja)+1]);else for(r(f,Fd[l&ja]),r(d,pu[(c&ja)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Pc,d=c>>>Pc,f===d)i(f,pu[l&ja]|Fd[(c&ja)+1]);else for(i(f,pu[l&ja]),i(d,Fd[(c&ja)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(a,o,s,u)=>a<0||o<0||u>=t||s>=e}}function $ot(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=s=>~~((s+n)/r);return o.invert=s=>s*r-n,o.bitmap=()=>Pot(i,a),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function Lot(e,t,n,r){const i=e.width,a=e.height;return function(o){const s=o.datum.datum.items[r].items,u=s.length,l=o.datum.fontSize,c=hl.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,v,y;for(let b=0;b<u;++b)d=s[b].x,p=s[b].y,h=s[b].x2===void 0?d:s[b].x2,g=s[b].y2===void 0?p:s[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=v);return m=c/2,v=l/2,d=o.x-m,h=o.x+m,p=o.y-v,g=o.y+v,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&g<=a?o.baseline="top":0<=p&&a<g&&(o.baseline="bottom"),!0}}function ET(e,t,n,r,i,a){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function Md(e,t,n,r,i,a,o,s){const u=i*a/(r*2),l=e(t-u),c=e(t+u),f=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function Bot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,v=a,y;if(!ET(p,g,d,h,i,a)&&!Md(e,p,g,h,d,m,o,s)&&!Md(e,p,g,h,d,h,o,null)){for(;v-m>=1;)y=(m+v)/2,Md(e,p,g,h,d,y,o,s)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=hl.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,v=0,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W;for(let G=0;G<f;++G){for(y=c[G].x,x=c[G].y,b=c[G].x2===void 0?y:c[G].x2,w=c[G].y2===void 0?x:c[G].y2,y>b&&(W=y,y=b,b=W),x>w&&(W=x,x=w,w=W),C=e(y),T=e(b),k=~~((C+T)/2),I=e(x),O=e(w),N=~~((I+O)/2),_=k;_>=C;--_)for(E=N;E>=I;--E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);for(_=k;_<=T;++_)for(E=N;E<=O;++E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);!g&&!n&&(D=Math.abs(b-y+w-x),S=(y+b)/2,A=(x+w)/2,D>=v&&!ET(S,A,h,d,i,a)&&!Md(e,S,A,d,h,d,o,null)&&(v=D,l.x=S,l.y=A,m=!0))}return g||m?(S=h/2,A=d/2,o.setRange(e(l.x-S),e(l.y-A),e(l.x+S),e(l.y+A)),l.align="center",l.baseline="middle",!0):!1}}const zot=[-1,-1,1,1],jot=[-1,1,-1,1];function Uot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=hl.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,v=!1,y=0,b,x,w,S,A,_,E,C,k,T,I,N;for(let O=0;O<f;++O){for(b=c[O].x,w=c[O].y,x=c[O].x2===void 0?b:c[O].x2,S=c[O].y2===void 0?w:c[O].y2,p.push([e((b+x)/2),e((w+S)/2)]);p.length;)if([E,C]=p.pop(),!(o.get(E,C)||s.get(E,C)||u.get(E,C))){u.set(E,C);for(let D=0;D<4;++D)A=E+zot[D],_=C+jot[D],u.outOfBounds(A,_,A,_)||p.push([A,_]);if(A=e.invert(E),_=e.invert(C),k=g,T=a,!ET(A,_,h,d,i,a)&&!Md(e,A,_,d,h,k,o,s)&&!Md(e,A,_,d,h,d,o,null)){for(;T-k>=1;)I=(k+T)/2,Md(e,A,_,d,h,I,o,s)?T=I:k=I;k>g&&(l.x=A,l.y=_,g=k,m=!0)}}!m&&!n&&(N=Math.abs(x-b+S-w),A=(b+x)/2,_=(w+S)/2,N>=y&&!ET(A,_,h,d,i,a)&&!Md(e,A,_,d,h,d,o,null)&&(y=N,l.x=A,l.y=_,v=!0))}return m||v?(A=h/2,_=d/2,o.setRange(e(l.x-A),e(l.y-_),e(l.x+A),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Wot=["right","center","left"],Vot=["bottom","middle","top"];function qot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>a)return!1;let d=0,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k;for(let T=0;T<u;++T){if(h=(n[T]&3)-1,p=(n[T]>>>2&3)-1,g=h===0&&p===0||r[T]<0,m=h&&p?Math.SQRT1_2:1,v=r[T]<0?-1:1,y=c[1+h]+r[T]*h*m,A=c[4+p]+v*f*p/2+r[T]*p*m,x=A-f/2,w=A+f/2,_=e(y),C=e(x),k=e(w),!d)if(Pde(_,_,C,k,o,s,y,y,x,w,c,g))d=hl.width(l.datum,l.datum.text);else continue;if(S=y+v*d*h/2,y=S-d/2,b=S+d/2,_=e(y),E=e(b),Pde(_,E,C,k,o,s,y,b,x,w,c,g))return l.x=h?h*v<0?b:y:S,l.y=p?p*v<0?w:x:A,l.align=Wot[h*v+1],l.baseline=Vot[p*v+1],o.setRange(_,C,E,k),!0}return!1}}function Pde(e,t,n,r,i,a,o,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&a?a.getRange(e,n,t,r)||!Hot(o,u,s,l,c):i.getRange(e,n,t,r)))}function Hot(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const $6=0,L6=4,B6=8,z6=0,j6=1,U6=2,Got={"top-left":$6+z6,top:$6+j6,"top-right":$6+U6,left:L6+z6,middle:L6+j6,right:L6+U6,"bottom-left":B6+z6,bottom:B6+j6,"bottom-right":B6+U6},Kot={naive:Lot,"reduced-search":Bot,floodfill:Uot};function Xot(e,t,n,r,i,a,o,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=Yot(r,f),h=Zot(i,f),p=Jot(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",v=Qot(p,g,s,u),y=$ot(t[0],t[1],l),b=m&&c==="naive",x=e.map(A=>({datum:A,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(A)}));let w;if(!b){n&&x.sort((_,E)=>n(_.datum,E.datum));let A=!1;for(let _=0;_<h.length&&!A;++_)A=h[_]===5||d[_]<0;p&&(o||m)&&(a=[e.map(_=>_.datum)].concat(a)),w=a.length?Fot(y,a,A,m):Rot(y,o&&x)}const S=m?Kot[c](y,w,o,u):qot(y,w,h,d);return x.forEach(A=>A.opacity=+S(A)),x}function Yot(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Zot(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Got[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Jot(e){return e&&e.mark&&e.mark.marktype}function Qot(e,t,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>i(a.datum):t==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const W6=["x","y","opacity","align","baseline"],$de=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function V6(e){ve.call(this,null,e)}V6.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:$de},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:W6.length,default:W6}]},$e(V6,ve,{transform(e,t){function n(a){const o=e[a];return Lt(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Se("Size parameter should be specified as a [width, height] array.");const i=e.as||W6;return Xot(t.materialize(t.SOURCE).source,e.size,e.sort,wt(e.offset||1),wt(e.anchor||$de),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),t.reflow(r).modifies(i)}});var est=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:V6});function Lde(e,t){var n=[],r=function(c){return c(s)},i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function q6(e){ve.call(this,null,e)}q6.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},$e(q6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Lde(r,e.groupby),a=(e.groupby||[]).map(Nr),o=a.length,s=e.as||[Nr(e.x),Nr(e.y)],u=[];i.forEach(l=>{Vae(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[a[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(In(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const H6={linear:$4,log:Lae,exp:Bae,pow:zae,quad:L4,poly:jae},tst=(e,t)=>e==="poly"?t:e==="quad"?2:1;function G6(e){ve.call(this,null,e)}G6.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(H6)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},$e(G6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Lde(r,e.groupby),a=(e.groupby||[]).map(Nr),o=e.method||"linear",s=e.order||3,u=tst(o,s),l=e.as||[Nr(e.x),Nr(e.y)],c=H6[o],f=[];let d=e.extent;_t(H6,o)||Se("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,s);if(e.params){f.push(In({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||nl(h,e.x),v=y=>{const b={};for(let x=0;x<a.length;++x)b[a[x]]=h.dims[x];b[l[0]]=y[0],b[l[1]]=y[1],f.push(In(b))};o==="linear"?m.forEach(y=>v([y,g.predict(y)])):_C(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var nst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:q6,regression:G6});const Bde=Math.pow(2,-52),AT=new Uint32Array(512);class CT{static from(t,n=sst,r=ust){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new CT(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let C=0;C<o;C++){const k=t[2*C],T=t[2*C+1];k<s&&(s=k),T<u&&(u=T),k>l&&(l=k),T>c&&(c=T),this._ids[C]=C}const f=(s+l)/2,d=(u+c)/2;let h=1/0,p,g,m;for(let C=0;C<o;C++){const k=K6(f,d,t[2*C],t[2*C+1]);k<h&&(p=C,h=k)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let C=0;C<o;C++){if(C===p)continue;const k=K6(v,y,t[2*C],t[2*C+1]);k<h&&k>0&&(g=C,h=k)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let C=0;C<o;C++){if(C===p||C===g)continue;const k=ast(v,y,b,x,t[2*C],t[2*C+1]);k<w&&(m=C,w=k)}let S=t[2*m],A=t[2*m+1];if(w===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];a0(this._ids,this._dists,0,o-1);const C=new Uint32Array(o);let k=0;for(let T=0,I=-1/0;T<o;T++){const N=this._ids[T];this._dists[N]>I&&(C[k++]=N,I=this._dists[N])}this.hull=C.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(kT(v,y,b,x,S,A)){const C=g,k=b,T=x;g=m,b=S,x=A,m=C,S=k,A=T}const _=ost(v,y,b,x,S,A);this._cx=_.x,this._cy=_.y;for(let C=0;C<o;C++)this._dists[C]=K6(t[2*C],t[2*C+1],_.x,_.y);a0(this._ids,this._dists,0,o-1),this._hullStart=p;let E=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,a.fill(-1),a[this._hashKey(v,y)]=p,a[this._hashKey(b,x)]=g,a[this._hashKey(S,A)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let C=0,k,T;C<this._ids.length;C++){const I=this._ids[C],N=t[2*I],O=t[2*I+1];if(C>0&&Math.abs(N-k)<=Bde&&Math.abs(O-T)<=Bde||(k=N,T=O,I===p||I===g||I===m))continue;let D=0;for(let ee=0,ce=this._hashKey(N,O);ee<this._hashSize&&(D=a[(ce+ee)%this._hashSize],!(D!==-1&&D!==r[D]));ee++);D=n[D];let L=D,W;for(;W=r[L],!kT(N,O,t[2*L],t[2*L+1],t[2*W],t[2*W+1]);)if(L=W,L===D){L=-1;break}if(L===-1)continue;let G=this._addTriangle(L,I,r[L],-1,-1,i[L]);i[I]=this._legalize(G+2),i[L]=G,E++;let K=r[L];for(;W=r[K],kT(N,O,t[2*K],t[2*K+1],t[2*W],t[2*W+1]);)G=this._addTriangle(K,I,W,i[I],-1,i[K]),i[I]=this._legalize(G+2),r[K]=K,E--,K=W;if(L===D)for(;W=n[L],kT(N,O,t[2*W],t[2*W+1],t[2*L],t[2*L+1]);)G=this._addTriangle(W,I,L,-1,i[L],i[W]),this._legalize(G+2),i[W]=G,r[L]=L,E--,L=W;this._hullStart=n[I]=L,r[L]=n[K]=I,r[I]=K,a[this._hashKey(N,O)]=I,a[this._hashKey(t[2*L],t[2*L+1])]=L}this.hull=new Uint32Array(E);for(let C=0,k=this._hullStart;C<E;C++)this.hull[C]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(rst(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const s=r[t],u=t-t%3;if(o=u+(t+2)%3,s===-1){if(a===0)break;t=AT[--a];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(ist(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[s]=d;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(s,r[o]),this._link(o,f);const y=l+(s+1)%3;a<AT.length&&(AT[a++]=y)}else{if(a===0)break;t=AT[--a]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,a,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,a),this._link(s+2,o),this.trianglesLen+=3,s}}function rst(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function K6(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function X6(e,t,n,r,i,a){const o=(r-t)*(i-e),s=(n-e)*(a-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function kT(e,t,n,r,i,a){return(X6(i,a,e,t,n,r)||X6(e,t,n,r,i,a)||X6(n,r,i,a,e,t))<0}function ist(e,t,n,r,i,a,o,s){const u=e-o,l=t-s,c=n-o,f=r-s,d=i-o,h=a-s,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function ast(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=(l*c-s*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function ost(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=e+(l*c-s*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function a0(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=e[i],o=t[a];let s=i-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{const i=n+r>>1;let a=n+1,o=r;Gx(e,i,a),t[e[n]]>t[e[r]]&&Gx(e,n,r),t[e[a]]>t[e[r]]&&Gx(e,a,r),t[e[n]]>t[e[a]]&&Gx(e,n,a);const s=e[a],u=t[s];for(;;){do a++;while(t[e[a]]<u);do o--;while(t[e[o]]>u);if(o<a)break;Gx(e,a,o)}e[n+1]=e[o],e[o]=s,r-a+1>=o-n?(a0(e,t,a,r),a0(e,t,n,o-1)):(a0(e,t,n,o-1),a0(e,t,a,r))}}function Gx(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function sst(e){return e[0]}function ust(e){return e[1]}const zde=1e-6;class jp{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>zde||Math.abs(this._y1-a)>zde)&&(this._+="L"+i+","+a),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class Y6{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class lst{constructor(t,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,g=r.length,m,v;h<g;h+=3,p+=2){const y=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[y],S=t[y+1],A=t[b],_=t[b+1],E=t[x],C=t[x+1],k=A-w,T=_-S,I=E-w,N=C-S,O=k*k+T*T,D=I*I+N*N,L=(k*N-T*I)*2;if(!L)m=(w+E)/2-1e8*N,v=(S+C)/2+1e8*I;else if(Math.abs(L)<1e-8)m=(w+E)/2,v=(S+C)/2;else{const W=1/L;m=w+(N*O-T*D)*W,v=S+(k*D-I*O)*W}a[p]=m,a[p+1]=v}let o=n[n.length-1],s,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],s=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new jp:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:s}=this;if(a.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],v=o[p],y=o[p+1];this._renderSegment(g,m,v,y,t)}let u,l=a[a.length-1];for(let c=0;c<a.length;++c){u=l,l=a[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,s[p+2],s[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new jp:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new jp:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new Y6;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,a){let o;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(a.moveTo(t,n),a.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,s,u))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let a=0,o=n.length;a<o;a+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[a]==i[s]&&n[a+1]==i[s+1]&&n[(a+2)%o]==i[(s+u-2)%u]&&n[(a+3)%o]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[t];if(o===-1)return null;const s=[];let u=o;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,a[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,a,o,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(a=s,o=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let p,g,m,v,y;if(l===0){if((p=this._clipSegment(a,o,s,u,l,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(s,u,a,o,c,l))===null)continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,a,o){for(;;){if(a===0&&o===0)return[t,n,r,i];if(a&o)return null;let s,u,l=a||o;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),a?(t=s,n=u,a=this._regioncode(t,n)):(r=s,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,a,o){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],a,o))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,a){for(;n!==r;){let o,s;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,s=this.ymin;break}(i[a]!==o||i[a+1]!==s)&&this.contains(t,o,s)&&(i.splice(a,0,o,s),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const s=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[s]&&i[s]===i[u]||i[o+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),o-=2)}return a}_project(t,n,r,i){let a=1/0,o,s,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(u=this.ymin,s=t+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(u=this.ymax,s=t+(a=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<a&&(s=this.xmax,u=n+(a=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<a&&(s=this.xmin,u=n+(a=o)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const cst=2*Math.PI,o0=Math.pow;function fst(e){return e[0]}function dst(e){return e[1]}function hst(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function pst(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class Z6{static from(t,n=fst,r=dst,i){return new Z6("length"in t?gst(t,n,r,i):Float64Array.from(mst(t,n,r,i)))}constructor(t){this._delaunator=new CT(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&hst(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=pst(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new CT(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=a[u%3==2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new lst(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=a[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,t,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(t,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=o0(n-l[t*2],2)+o0(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=o0(n-l[p*2],2)+o0(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=a[(o[t]+1)%a.length],h!==p&&o0(n-l[h*2],2)+o0(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new jp:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,s=i.length;o<s;++o){const u=i[o];if(u<o)continue;const l=a[o]*2,c=a[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new jp:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const s=i[a],u=i[a+1];t.moveTo(s+n,u),t.arc(s,u,n,0,cst)}return r&&r.value()}renderHull(t){const n=t==null?t=new jp:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;t.moveTo(i[a],i[a+1]);for(let s=1;s<o;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Y6;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new jp:void 0,{points:i,triangles:a}=this,o=a[t*=3]*2,s=a[t+1]*2,u=a[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Y6;return this.renderTriangle(t,n),n.value()}}function gst(e,t,n,r){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const s=e[o];a[o*2]=t.call(r,s,o,e),a[o*2+1]=n.call(r,s,o,e)}return a}function*mst(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}function J6(e){ve.call(this,null,e)}J6.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const vst=[-1e5,-1e5,1e5,1e5];$e(J6,ve,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:vst;const a=this.value=Z6.from(r,e.x,e.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const u=a.cellPolygon(o);r[o][n]=u?yst(u):null}return t.reflow(e.modified()).modifies(n)}});function yst(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var bst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:J6}),Q6=Math.PI/180,Kx=1<<11>>5,TT=1<<11;function xst(){var e=[256,256],t,n,r,i,a,o,s,u=jde,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Ov()),g=Cst((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],x=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:a(S),rotate:o(S),size:~~(r(S)+1e-14),padding:s(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,A)=>A.size-S.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,wst(p,w,x,y),w.hasText&&h(g,w,m)&&(b.push(w),m?Sst(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Kx<<5)/g,p.height=TT/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,A,_,E;(A=x(S+=w))&&(_=~~A[0],E=~~A[1],!(Math.min(Math.abs(_),Math.abs(E))>=b));)if(g.x=v+_,g.y=y+E,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!_st(g,p,e[0]))&&(!m||Est(g,m))){for(var C=g.sprite,k=g.width>>5,T=e[0]>>5,I=g.x-(k<<4),N=I&127,O=32-N,D=g.y1-g.y0,L=(g.y+g.y0)*T+(I>>5),W,G=0;G<D;G++){W=0;for(var K=0;K<=k;K++)p[L+K]|=W<<O|(K<k?(W=C[G*k+K])>>>N:0);L+=T}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Up(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Up(p),f):i},f.fontWeight=function(p){return arguments.length?(a=Up(p),f):a},f.rotate=function(p){return arguments.length?(o=Up(p),f):o},f.text=function(p){return arguments.length?(t=Up(p),f):t},f.spiral=function(p){return arguments.length?(u=kst[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Up(p),f):r},f.padding=function(p){return arguments.length?(s=Up(p),f):s},f.random=function(p){return arguments.length?(c=p,f):c},f}function wst(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(Kx<<5)/a,TT/a);var o=0,s=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,c=i.measureText(t.text+"m").width*a,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*Q6),m=Math.cos(t.rotate*Q6),v=c*m,y=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=Kx<<5&&(o=0,s+=u,u=0),s+d>=TT)break;i.translate((o+(c>>1))/a,(s+(d>>1))/a),t.rotate&&i.rotate(t.rotate*Q6),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(Kx<<5)/a,TT/a).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;s=t.yoff;var A=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),C=w[(s+p)*(Kx<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=C,A|=C}A?_=p:(t.y0++,d--,p--,s++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function _st(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Sst(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Est(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function jde(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Ast(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Cst(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Up(e){return typeof e=="function"?e:function(){return e}}var kst={archimedean:jde,rectangular:Ast};const Ude=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Tst=["text","font","rotate","fontSize","fontStyle","fontWeight"];function ej(e){ve.call(this,xst(),e)}ej.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Ude}]},$e(ej,ve,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Se("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Lt(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Tst.some(n)))return;const i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||Ude;let s=e.fontSize||14,u;if(Lt(s)?u=e.fontSizeRange:s=Ji(s),u){const p=s,g=Sn("sqrt")().domain(nl(i,p)).range(u);s=m=>g(p(m))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(ps).layout(),c=a.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(r).modifies(o)}});var Ost=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:ej});const Ist=e=>new Uint8Array(e),Nst=e=>new Uint16Array(e),Xx=e=>new Uint32Array(e);function Dst(){let e=8,t=[],n=Xx(0),r=OT(0,e),i=OT(0,e);return{data:()=>t,seen:()=>n=Rst(n,t.length),add(a){for(let o=0,s=t.length,u=a.length,l;o<u;++o)l=a[o],l._index=s++,t.push(l)},remove(a,o){const s=t.length,u=Array(s-a),l=t;let c,f,d;for(f=0;!o[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const s=r.length;(a>s||o>e)&&(e=Math.max(o,e),r=OT(a,e,r),i=OT(a,e))}}}function Rst(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function OT(e,t,n){const r=(t<257?Ist:t<65537?Nst:Xx)(e);return n&&r.set(n),r}function Wde(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,a){const o=this,s=o.bisect(o.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)a[u[d]]|=r;for(d=c;d<f;++d)a[u[d]]|=r;return o}}}function Vde(){let e=Xx(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Xx(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=Fst(h,d),c)p=t,g=e,t=Array(c+f),e=Xx(c+f),Mst(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function a(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function o(s,u){let l;return u?l=u.length:(u=t,l=n),[SGe(u,s[0],0,l),tC(u,s[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>e,size:()=>n}}function Fst(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],a=e[r];return i<a?-1:i>a?1:0}),CGe(e,t)}function Mst(e,t,n,r,i,a,o,s,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}function tj(e){ve.call(this,Dst(),e),this._indices=null,this._dims=null}tj.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},$e(tj,ve,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;let s=0,u,l;for(;s<o;++s)u=n[s].fname,l=i[u]||(i[u]=Vde()),a.push(Wde(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,x,w,S,A;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,S=y.length;w<S;++w)x[y[w]._index]=1;for(w=0;w<h;++w)A=r[w],(!o[w]||e.modified("fields",w)||t.modified(A.fields))&&(v=A.fname,(g=p[v])||(a[v]=m=Vde(),p[v]=g=m.insert(A,t.source,0)),o[w]=Wde(m,w,i[w]).onAdd(g,u));for(w=0,S=s.data().length;w<S;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,a=this._dims,o=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=a.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=s[h].fname,g=u[p]||(u[p]=o[p].insert(s[h],r,d)),a[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;let s,u,l;for(s=0,u=o.length;s<u;++s)l=o[s]._index,i[l]!==a&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const a=i.remove(t,n);for(const o in r)r[o].reindex(a)})},update(e,t,n){const r=this._dims,i=e.query,a=t.stamp,o=r.length;let s=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<o;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,a=i.curr(),o=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],a[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],a[m]^=h,r.push(m);e.range=t.slice()}});function nj(e){ve.call(this,null,e)}nj.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},$e(nj,ve,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const a=t.fork(t.ALL),o=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:o[c];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?o[c]:null}),a.filter(a.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(a.filter(a.ADD,l),a.filter(a.REM,c=>(s[c]&n)===i?o[c]:null)),a.filter(a.SOURCE,c=>l(c._index))}});var Pst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:tj,resolvefilter:nj});const $st="RawCode",Wp="Literal",Lst="Property",Bst="Identifier",zst="ArrayExpression",jst="BinaryExpression",qde="CallExpression",Ust="ConditionalExpression",Wst="LogicalExpression",Vst="MemberExpression",qst="ObjectExpression",Hst="UnaryExpression";function gu(e){this.type=e}gu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Gst(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Gst(e){switch(e.type){case zst:return e.elements;case jst:case Wst:return[e.left,e.right];case qde:return[e.callee].concat(e.arguments);case Ust:return[e.test,e.consequent,e.alternate];case Vst:return[e.object,e.property];case qst:return e.properties;case Lst:return[e.key,e.value];case Hst:return[e.argument];case Bst:case Wp:case $st:default:return[]}}var xl,at,we,aa,zn,IT=1,Yx=2,Vp=3,Pd=4,NT=5,qp=6,po=7,Zx=8,Kst=9;xl={},xl[IT]="Boolean",xl[Yx]="<end>",xl[Vp]="Identifier",xl[Pd]="Keyword",xl[NT]="Null",xl[qp]="Numeric",xl[po]="Punctuator",xl[Zx]="String",xl[Kst]="RegularExpression";var Xst="ArrayExpression",Yst="BinaryExpression",Zst="CallExpression",Jst="ConditionalExpression",Hde="Identifier",Qst="Literal",eut="LogicalExpression",tut="MemberExpression",nut="ObjectExpression",rut="Property",iut="UnaryExpression",Ei="Unexpected token %0",aut="Unexpected number",out="Unexpected string",sut="Unexpected identifier",uut="Unexpected reserved word",lut="Unexpected end of input",rj="Invalid regular expression",ij="Invalid regular expression: missing /",Gde="Octal literals are not allowed in strict mode.",cut="Duplicate data property in object literal not allowed in strict mode",Ui="ILLEGAL",Jx="Disabled.",fut=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),dut=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function DT(e,t){if(!e)throw new Error("ASSERT: "+t)}function $c(e){return e>=48&&e<=57}function aj(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Qx(e){return"01234567".indexOf(e)>=0}function hut(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function ew(e){return e===10||e===13||e===8232||e===8233}function tw(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&fut.test(String.fromCharCode(e))}function RT(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&dut.test(String.fromCharCode(e))}const put={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Kde(){for(;we<aa;){const e=at.charCodeAt(we);if(hut(e)||ew(e))++we;else break}}function oj(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<aa&&aj(at[we])?(r=at[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):En({},Ei,Ui);return String.fromCharCode(i)}function gut(){var e,t,n,r;for(e=at[we],t=0,e==="}"&&En({},Ei,Ui);we<aa&&(e=at[we++],!!aj(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&En({},Ei,Ui),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Xde(){var e,t;for(e=at.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(at.charCodeAt(we)!==117&&En({},Ei,Ui),++we,e=oj("u"),(!e||e==="\\"||!tw(e.charCodeAt(0)))&&En({},Ei,Ui),t=e);we<aa&&(e=at.charCodeAt(we),!!RT(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),at.charCodeAt(we)!==117&&En({},Ei,Ui),++we,e=oj("u"),(!e||e==="\\"||!RT(e.charCodeAt(0)))&&En({},Ei,Ui),t+=e);return t}function mut(){var e,t;for(e=we++;we<aa;){if(t=at.charCodeAt(we),t===92)return we=e,Xde();if(RT(t))++we;else break}return at.slice(e,we)}function vut(){var e,t,n;return e=we,t=at.charCodeAt(we)===92?Xde():mut(),t.length===1?n=Vp:put.hasOwnProperty(t)?n=Pd:t==="null"?n=NT:t==="true"||t==="false"?n=IT:n=Vp,{type:n,value:t,start:e,end:we}}function sj(){var e=we,t=at.charCodeAt(we),n,r=at[we],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:po,value:String.fromCharCode(t),start:e,end:we};default:if(n=at.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:po,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,at.charCodeAt(we)===61&&++we,{type:po,value:at.slice(e,we),start:e,end:we}}}if(o=at.substr(we,4),o===">>>=")return we+=4,{type:po,value:o,start:e,end:we};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return we+=3,{type:po,value:a,start:e,end:we};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:po,value:i,start:e,end:we};if(i==="//"&&En({},Ei,Ui),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:po,value:r,start:e,end:we};En({},Ei,Ui)}function yut(e){let t="";for(;we<aa&&aj(at[we]);)t+=at[we++];return t.length===0&&En({},Ei,Ui),tw(at.charCodeAt(we))&&En({},Ei,Ui),{type:qp,value:parseInt("0x"+t,16),start:e,end:we}}function but(e){let t="0"+at[we++];for(;we<aa&&Qx(at[we]);)t+=at[we++];return(tw(at.charCodeAt(we))||$c(at.charCodeAt(we)))&&En({},Ei,Ui),{type:qp,value:parseInt(t,8),octal:!0,start:e,end:we}}function Yde(){var e,t,n;if(n=at[we],DT($c(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=at[we++],n=at[we],e==="0"){if(n==="x"||n==="X")return++we,yut(t);if(Qx(n))return but(t);n&&$c(n.charCodeAt(0))&&En({},Ei,Ui)}for(;$c(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="."){for(e+=at[we++];$c(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="e"||n==="E")if(e+=at[we++],n=at[we],(n==="+"||n==="-")&&(e+=at[we++]),$c(at.charCodeAt(we)))for(;$c(at.charCodeAt(we));)e+=at[we++];else En({},Ei,Ui);return tw(at.charCodeAt(we))&&En({},Ei,Ui),{type:qp,value:parseFloat(e),start:t,end:we}}function xut(){var e="",t,n,r,i,a=!1;for(t=at[we],DT(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<aa;)if(r=at[we++],r===t){t="";break}else if(r==="\\")if(r=at[we++],!r||!ew(r.charCodeAt(0)))switch(r){case"u":case"x":at[we]==="{"?(++we,e+=gut()):e+=oj(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Qx(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),we<aa&&Qx(at[we])&&(a=!0,i=i*8+"01234567".indexOf(at[we++]),"0123".indexOf(r)>=0&&we<aa&&Qx(at[we])&&(i=i*8+"01234567".indexOf(at[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&at[we]===`
`&&++we;else{if(ew(r.charCodeAt(0)))break;e+=r}return t!==""&&En({},Ei,Ui),{type:Zx,value:e,octal:a,start:n,end:we}}function wut(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";En({},rj)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){En({},rj)}try{return new RegExp(e,t)}catch(r){return null}}function _ut(){var e,t,n,r,i;for(e=at[we],DT(e==="/","Regular expression literal must start with a slash"),t=at[we++],n=!1,r=!1;we<aa;)if(e=at[we++],t+=e,e==="\\")e=at[we++],ew(e.charCodeAt(0))&&En({},ij),t+=e;else if(ew(e.charCodeAt(0)))En({},ij);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||En({},ij),i=t.substr(1,t.length-2),{value:i,literal:t}}function Sut(){var e,t,n;for(t="",n="";we<aa&&(e=at[we],!!RT(e.charCodeAt(0)));)++we,e==="\\"&&we<aa?En({},Ei,Ui):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&En({},rj,n),{value:n,literal:t}}function Eut(){var e,t,n,r;return zn=null,Kde(),e=we,t=_ut(),n=Sut(),r=wut(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function Aut(e){return e.type===Vp||e.type===Pd||e.type===IT||e.type===NT}function Zde(){if(Kde(),we>=aa)return{type:Yx,start:we,end:we};const e=at.charCodeAt(we);return tw(e)?vut():e===40||e===41||e===59?sj():e===39||e===34?xut():e===46?$c(at.charCodeAt(we+1))?Yde():sj():$c(e)?Yde():sj()}function go(){const e=zn;return we=e.end,zn=Zde(),we=e.end,e}function Jde(){const e=we;zn=Zde(),we=e}function Cut(e){const t=new gu(Xst);return t.elements=e,t}function Qde(e,t,n){const r=new gu(e==="||"||e==="&&"?eut:Yst);return r.operator=e,r.left=t,r.right=n,r}function kut(e,t){const n=new gu(Zst);return n.callee=e,n.arguments=t,n}function Tut(e,t,n){const r=new gu(Jst);return r.test=e,r.consequent=t,r.alternate=n,r}function uj(e){const t=new gu(Hde);return t.name=e,t}function nw(e){const t=new gu(Qst);return t.value=e.value,t.raw=at.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function ehe(e,t,n){const r=new gu(tut);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Out(e){const t=new gu(nut);return t.properties=e,t}function the(e,t,n){const r=new gu(rut);return r.key=t,r.value=n,r.kind=e,r}function Iut(e,t){const n=new gu(iut);return n.operator=e,n.argument=t,n.prefix=!0,n}function En(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(a,o)=>(DT(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=we,n.description=i,n}function FT(e){e.type===Yx&&En(e,lut),e.type===qp&&En(e,aut),e.type===Zx&&En(e,out),e.type===Vp&&En(e,sut),e.type===Pd&&En(e,uut),En(e,Ei,e.value)}function oa(e){const t=go();(t.type!==po||t.value!==e)&&FT(t)}function ar(e){return zn.type===po&&zn.value===e}function lj(e){return zn.type===Pd&&zn.value===e}function Nut(){const e=[];for(we=zn.start,oa("[");!ar("]");)ar(",")?(go(),e.push(null)):(e.push(Hp()),ar("]")||oa(","));return go(),Cut(e)}function nhe(){we=zn.start;const e=go();return e.type===Zx||e.type===qp?(e.octal&&En(e,Gde),nw(e)):uj(e.value)}function Dut(){var e,t,n,r;if(we=zn.start,e=zn,e.type===Vp)return n=nhe(),oa(":"),r=Hp(),the("init",n,r);if(e.type===Yx||e.type===po)FT(e);else return t=nhe(),oa(":"),r=Hp(),the("init",t,r)}function Rut(){var e=[],t,n,r,i={},a=String;for(we=zn.start,oa("{");!ar("}");)t=Dut(),t.key.type===Hde?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?En({},cut):i[r]=!0,e.push(t),ar("}")||oa(",");return oa("}"),Out(e)}function Fut(){oa("(");const e=cj();return oa(")"),e}const Mut={if:1};function Put(){var e,t,n;if(ar("("))return Fut();if(ar("["))return Nut();if(ar("{"))return Rut();if(e=zn.type,we=zn.start,e===Vp||Mut[zn.value])n=uj(go().value);else if(e===Zx||e===qp)zn.octal&&En(zn,Gde),n=nw(go());else{if(e===Pd)throw new Error(Jx);e===IT?(t=go(),t.value=t.value==="true",n=nw(t)):e===NT?(t=go(),t.value=null,n=nw(t)):ar("/")||ar("/=")?(n=nw(Eut()),Jde()):FT(go())}return n}function $ut(){const e=[];if(oa("("),!ar(")"))for(;we<aa&&(e.push(Hp()),!ar(")"));)oa(",");return oa(")"),e}function Lut(){we=zn.start;const e=go();return Aut(e)||FT(e),uj(e.value)}function But(){return oa("."),Lut()}function zut(){oa("[");const e=cj();return oa("]"),e}function jut(){var e,t,n;for(e=Put();;)if(ar("."))n=But(),e=ehe(".",e,n);else if(ar("("))t=$ut(),e=kut(e,t);else if(ar("["))n=zut(),e=ehe("[",e,n);else break;return e}function rhe(){const e=jut();if(zn.type===po&&(ar("++")||ar("--")))throw new Error(Jx);return e}function MT(){var e,t;if(zn.type!==po&&zn.type!==Pd)t=rhe();else{if(ar("++")||ar("--"))throw new Error(Jx);if(ar("+")||ar("-")||ar("~")||ar("!"))e=go(),t=MT(),t=Iut(e.value,t);else{if(lj("delete")||lj("void")||lj("typeof"))throw new Error(Jx);t=rhe()}}return t}function ihe(e){let t=0;if(e.type!==po&&e.type!==Pd)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Uut(){var e,t,n,r,i,a,o,s,u,l;if(e=zn,u=MT(),r=zn,i=ihe(r),i===0)return u;for(r.prec=i,go(),t=[e,zn],o=MT(),a=[u,r,o];(i=ihe(zn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=Qde(s,u,o),a.push(n);r=go(),r.prec=i,a.push(r),t.push(zn),n=MT(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=Qde(a[l-1].value,a[l-2],n),l-=2;return n}function Hp(){var e,t,n;return e=Uut(),ar("?")&&(go(),t=Hp(),oa(":"),n=Hp(),e=Tut(e,t,n)),e}function cj(){const e=Hp();if(ar(","))throw new Error(Jx);return e}function ahe(e){at=e,we=0,aa=at.length,zn=null,Jde();const t=cj();if(zn.type!==Yx)throw new Error("Unexpect token after expression.");return t}var ohe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function she(e){function t(o,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(o,s,u){return l=>t(o,l,s,u)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Se("Missing arguments to clamp function."),o.length>3&&Se("Too many arguments to clamp function.");const s=o.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&Se("Missing arguments to if function."),o.length>3&&Se("Too many arguments to if function.");const s=o.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function Wut(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function uhe(e){e=e||{};const t=e.allowed?iu(e.allowed):{},n=e.forbidden?iu(e.forbidden):{},r=e.constants||ohe,i=(e.functions||she)(f),a=e.globalvar,o=e.fieldvar,s=Lt(a)?a:p=>"".concat(a,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(Bn(p))return p;const g=d[p.type];return g==null&&Se("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:_t(n,g)?Se("Illegal identifier: "+g):_t(r,g)?r[g]:_t(t,g)?g:(u[g]=1,s(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===o&&(l[Wut(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Se("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=_t(i,g)&&i[g];return v||Se("Unrecognized function: "+g),Lt(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function Vut(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qut(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=Hut(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function Hut(e){return(t,n)=>Vut(e(t),n)}const fj="intersect",lhe="union",Gut="vlMulti",Kut="vlPoint",che="or",Xut="and",Yut="_vgsid_",Zut="E",Jut="R",Qut="R-E",elt="R-LE",tlt="R-RE",PT="index:unit";function fhe(e,t){for(var n=t.fields,r=t.values,i=n.length,a=0,o,s;a<i;++a)if(s=n[a],s.getter=ao.getter||ao(s.field),o=s.getter(e),Qf(o)&&(o=Zi(o)),Qf(r[a])&&(r[a]=Zi(r[a])),Qf(r[a][0])&&(r[a]=r[a].map(Zi)),s.type===Zut){if(ut(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(s.type===Jut){if(!mv(o,r[a]))return!1}else if(s.type===tlt){if(!mv(o,r[a],!0,!1))return!1}else if(s.type===Qut){if(!mv(o,r[a],!1,!1))return!1}else if(s.type===elt&&!mv(o,r[a],!1,!0))return!1;return!0}function nlt(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],a=r?r[PT]&&r[PT].value:void 0,o=n===fj,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],a&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=fhe(t,l),c[d]=h?-1:++f,h&&a.size===1)return!0;if(!h&&f===a.get(d).count)return!1}else if(h=fhe(t,l),o^h)return h;return s&&o}const dj=ao(Yut),dhe=qut(dj),rlt=dhe.left,ilt=dhe.right;function alt(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],a=r?r[PT]&&r[PT].value:void 0,o=n===fj,s=dj(t),u=rlt(i,s);if(u===i.length||dj(i[u])!==s)return!1;if(a&&o){if(a.size===1)return!0;if(ilt(i,s)-u<a.size)return!1}return!0}function olt(e,t){return e.map(n=>Rt({values:t.fields.map(r=>(r.getter||(r.getter=ao(r.field)))(n.datum))},t))}function slt(e,t,n,r){for(var i=this.context.data[e],a=i?i.values.value:[],o={},s={},u={},l,c,f,d,h,p,g,m,v,y=a.length,b=0,x,w;b<y;++b){for(l=a[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],p=o[h.field]||(o[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),v=hhe[m+"_union"],p[d]=v(g,wt(f[x]));n&&(g=s[d]||(s[d]=[]),g.push(wt(f).reduce((S,A,_)=>(S[c[_].field]=A,S),{})))}if(t=t||lhe,Object.keys(o).forEach(S=>{o[S]=Object.keys(o[S]).map(A=>o[S][A]).reduce((A,_)=>A===void 0?_:hhe[u[S]+"_"+t](A,_))}),a=Object.keys(s),n&&a.length){const S=r?Kut:Gut;o[S]=t===lhe?{[che]:a.reduce((A,_)=>(A.push(...s[_]),A),[])}:{[Xut]:a.map(A=>({[che]:s[A]}))}}return o}var hhe={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const ult=":",llt="@";function hj(e,t,n,r){t[0].type!==Wp&&Se("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&sn(t).value,o="unit",s=llt+o,u=ult+i;a===fj&&!_t(r,s)&&(r[s]=n.getData(i).indataRef(n,o)),_t(r,u)||(r[u]=n.getData(i).tuplesRef())}function phe(e){const t=this.context.data[e];return t?t.values.value:[]}function clt(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function flt(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(fs).insert(t)),1}function dlt(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const rw=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},hlt=rw("format"),ghe=rw("timeFormat"),plt=rw("utcFormat"),glt=rw("timeParse"),mlt=rw("utcParse"),$T=new Date(2e3,0,1);function LT(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":($T.setYear(2e3),$T.setMonth(e),$T.setDate(t),ghe.call(this,$T,n))}function vlt(e){return LT.call(this,e,1,"%B")}function ylt(e){return LT.call(this,e,1,"%b")}function blt(e){return LT.call(this,0,2+e,"%A")}function xlt(e){return LT.call(this,0,2+e,"%a")}const wlt=":",_lt="@",pj="%",mhe="$";function gj(e,t,n,r){t[0].type!==Wp&&Se("First argument to data functions must be a string literal.");const i=t[0].value,a=wlt+i;if(!_t(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Slt(e,t,n,r){t[0].type!==Wp&&Se("First argument to indata must be a string literal."),t[1].type!==Wp&&Se("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=_lt+a;_t(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function mo(e,t,n,r){if(t[0].type===Wp)vhe(n,r,t[0].value);else for(e in n.scales)vhe(n,r,e)}function vhe(e,t,n){const r=pj+n;if(!_t(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function Lc(e,t){let n;return Lt(e)?e:Bn(e)?(n=t.scales[e])&&n.value:void 0}function Elt(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=mo,n._range=mo,n._scale=mo;const r=i=>"_["+(i.type===Wp?gt(pj+i.value):gt(pj)+"+"+e(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(e(i[1]),")")}}function mj(e,t){return function(n,r,i){if(n){const a=Lc(n,(i||this).context);return a&&a.path[e](r)}else return t(r)}}const Alt=mj("area",Znt),Clt=mj("bounds",trt),klt=mj("centroid",srt);function Tlt(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function vj(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Olt(){return vj(this.context.dataflow,"warn",arguments)}function Ilt(){return vj(this.context.dataflow,"info",arguments)}function Nlt(){return vj(this.context.dataflow,"debug",arguments)}function yj(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function bj(e){const t=gd(e),n=yj(t.r),r=yj(t.g),i=yj(t.b);return .2126*n+.7152*r+.0722*i}function Dlt(e,t){const n=bj(e),r=bj(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function Rlt(){const e=[].slice.call(arguments);return e.unshift({}),Rt(...e)}function yhe(e,t){return e===t||e!==e&&t!==t?!0:ut(e)?ut(t)&&e.length===t.length?Flt(e,t):!1:Nt(e)&&Nt(t)?bhe(e,t):!1}function Flt(e,t){for(let n=0,r=e.length;n<r;++n)if(!yhe(e[n],t[n]))return!1;return!0}function bhe(e,t){for(const n in e)if(!yhe(e[n],t[n]))return!1;return!0}function xhe(e){return t=>bhe(e,t)}function Mlt(e,t,n,r,i,a){const o=this.context.dataflow,s=this.context.data[e],u=s.input,l=o.stamp();let c=s.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{s.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?fs:ut(n)||fC(n)?n:xhe(n),c.remove(f)),t&&c.insert(t),r&&(f=xhe(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in a)c.modify(i,d,a[d]);return 1}function Plt(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function $lt(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const whe={};function Llt(e,t){const n=whe[t]||(whe[t]=ao(t));return ut(e)?e.map(n):n(e)}function xj(e){return ut(e)||ArrayBuffer.isView(e)?e:null}function wj(e){return xj(e)||(Bn(e)?e:null)}function Blt(e,...t){return xj(e).join(...t)}function zlt(e,...t){return wj(e).indexOf(...t)}function jlt(e,...t){return wj(e).lastIndexOf(...t)}function Ult(e,...t){return wj(e).slice(...t)}function Wlt(e,t,n){return Lt(n)&&Se("Function argument passed to replace."),String(e).replace(t,n)}function Vlt(e){return xj(e).slice().reverse()}function qlt(e,t,n){return QB(e||0,t||0,n||0)}function Hlt(e,t){const n=Lc(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Glt(e,t){const n=Lc(e,(t||this).context);return n?n.copy():void 0}function Klt(e,t){const n=Lc(e,(t||this).context);return n?n.domain():[]}function Xlt(e,t,n){const r=Lc(e,(n||this).context);return r?ut(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Ylt(e,t){const n=Lc(e,(t||this).context);return n&&n.range?n.range():[]}function Zlt(e,t,n){const r=Lc(e,(n||this).context);return r?r(t):void 0}function Jlt(e,t,n,r,i){e=Lc(e,(i||this).context);const a=Oue(t,n);let o=e.domain(),s=o[0],u=sn(o),l=Oa;return u-s?l=pue(e,s,u):e=(e.interpolator?Sn("sequential")().interpolator(e.interpolator()):Sn("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(o=e.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==sn(o)&&o.push(u)),o.forEach(c=>a.stop(l(c),e(c))),a}function Qlt(e,t,n){const r=Lc(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function ect(e){let t=null;return function(n){return n?ox(n,t=t||Bv(e)):e}}const _he=e=>e.data;function She(e,t){const n=phe.call(t,e);return n.root&&n.root.lookup||{}}function tct(e,t,n){const r=She(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(_he):void 0}function nct(e,t){const n=She(e,this)[t];return n?n.ancestors().map(_he):void 0}const Ehe=()=>typeof window!="undefined"&&window||null;function rct(){const e=Ehe();return e?e.screen:{}}function ict(){const e=Ehe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function act(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function oct(e,t,n){if(!e)return[];const[r,i]=e,a=new ci().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Wle(o,a,sct(t))}function sct(e){let t=null;if(e){const n=wt(e.marktype),r=wt(e.markname);t=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return t}const iw={random(){return ps()},cumulativeNormal:bC,cumulativeLogNormal:N4,cumulativeUniform:M4,densityNormal:C4,densityLogNormal:I4,densityUniform:F4,quantileNormal:xC,quantileLogNormal:D4,quantileUniform:P4,sampleNormal:yC,sampleLogNormal:O4,sampleUniform:R4,isArray:ut,isBoolean:AL,isDate:Qf,isDefined(e){return e!==void 0},isNumber:ed,isObject:Nt,isRegExp:Lre,isString:Bn,isTuple:fC,isValid(e){return e!=null&&e===e},toBoolean:kL,toDate:TL,toNumber:Zi,toString:OL,indexof:zlt,join:Blt,lastindexof:jlt,replace:Wlt,reverse:Vlt,slice:Ult,flush:Pre,lerp:Bre,merge:Rlt,pad:Ure,peek:sn,pluck:Llt,span:y1,inrange:mv,truncate:Wre,rgb:gd,lab:MC,hcl:PC,hsl:RC,luminance:bj,contrast:Dlt,sequence:jo,format:hlt,utcFormat:plt,utcParse:mlt,utcOffset:Mie,utcSequence:Lie,timeFormat:ghe,timeParse:glt,timeOffset:Fie,timeSequence:$ie,timeUnitSpecifier:Sie,monthFormat:vlt,monthAbbrevFormat:ylt,dayFormat:blt,dayAbbrevFormat:xlt,quarter:Dre,utcquarter:Rre,week:Aie,utcweek:Tie,dayofyear:Eie,utcdayofyear:kie,warn:Olt,info:Ilt,debug:Nlt,extent:nl,inScope:Tlt,intersect:oct,clampRange:Fre,pinchDistance:Plt,pinchAngle:$lt,screen:rct,containerSize:act,windowSize:ict,bandspace:qlt,setdata:flt,pathShape:ect,panLinear:Tre,panLog:Ore,panPow:Ire,panSymlog:Nre,zoomLinear:xL,zoomLog:wL,zoomPow:YA,zoomSymlog:_L,encode:dlt,modify:Mlt},uct=["view","item","group","xy","x","y"],lct="event.vega.",Ahe="this.",_j={},Che={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(gt(mhe+e),"]"),functions:cct,constants:ohe,visitors:_j},Sj=uhe(Che);function cct(e){const t=she(e);uct.forEach(n=>t[n]=lct+n);for(const n in iw)t[n]=Ahe+n;return Rt(t,Elt(e,iw,_j)),t}function Jr(e,t,n){return arguments.length===1?iw[e]:(iw[e]=t,n&&(_j[e]=n),Sj&&(Sj.functions[e]=Ahe+e),this)}Jr("bandwidth",Hlt,mo),Jr("copy",Glt,mo),Jr("domain",Klt,mo),Jr("range",Ylt,mo),Jr("invert",Xlt,mo),Jr("scale",Zlt,mo),Jr("gradient",Jlt,mo),Jr("geoArea",Alt,mo),Jr("geoBounds",Clt,mo),Jr("geoCentroid",klt,mo),Jr("geoShape",Qlt,mo),Jr("indata",clt,Slt),Jr("data",phe,gj),Jr("treePath",tct,gj),Jr("treeAncestors",nct,gj),Jr("vlSelectionTest",nlt,hj),Jr("vlSelectionIdTest",alt,hj),Jr("vlSelectionResolve",slt,hj),Jr("vlSelectionTuples",olt);function wl(e,t){const n={};let r;try{e=Bn(e)?e:gt(e)+"",r=ahe(e)}catch(a){Se("Expression parse error: "+e)}r.visit(a=>{if(a.type!==qde)return;const o=a.callee.name,s=Che.visitors[o];s&&s(o,a.arguments,t,n)});const i=Sj(r);return i.globals.forEach(a=>{const o=mhe+a;!_t(n,o)&&t.getSignal(a)&&(n[o]=t.signalRef(a))}),{$expr:Rt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function fct(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const dct=iu(["rule"]),khe=iu(["group","image","rect"]);function hct(e,t){let n="";return dct[t]||(e.x2&&(e.x?(khe[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(khe[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Ej(e){return(e+"").toLowerCase()}function pct(e){return Ej(e)==="operator"}function gct(e){return Ej(e)==="collect"}function aw(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function mct(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var vct={operator:(e,t)=>aw(e,["_"],t.code),parameter:(e,t)=>aw(e,["datum","_"],t.code),event:(e,t)=>aw(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return aw(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+gt(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=hct(r,n),i+="return m;",aw(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(gt).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(a,o)=>{const s=t[o];let u,l;return a.path?(u="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),mct(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function yct(e){const t=this;pct(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function bct(e){const t=this;if(e.params){const n=t.get(e.id);n||Se("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function xct(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ut(i)?i.map(a=>The(a,n,t)):The(i,n,t)}return t}function The(e,t,n){if(!e||!Nt(e))return e;for(let r=0,i=Ohe.length,a;r<i;++r)if(a=Ohe[r],_t(e,a.key))return a.parse(e,t,n);return e}var Ohe=[{key:"$ref",parse:wct},{key:"$key",parse:Sct},{key:"$expr",parse:_ct},{key:"$field",parse:Ect},{key:"$encode",parse:Cct},{key:"$compare",parse:Act},{key:"$context",parse:kct},{key:"$subflow",parse:Tct},{key:"$tupleid",parse:Oct}];function wct(e,t){return t.get(e.$ref)||Se("Operator not defined: "+e.$ref)}function _ct(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=io(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Sct(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=CL(e.$key,e.$flat,t.expr.codegen))}function Ect(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ao(e.$field,e.$name,t.expr.codegen))}function Act(e,t){const n="c:"+e.$compare+"_"+e.$order,r=wt(e.$compare).map(i=>i&&i.$tupleid?lt:i);return t.fn[n]||(t.fn[n]=SL(r,e.$order,t.expr.codegen))}function Cct(e,t){const n=e.$encode,r={};for(const i in n){const a=n[i];r[i]=io(t.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function kct(e,t){return t}function Tct(e,t){const n=e.$subflow;return function(r,i,a){const o=t.fork().parse(n),s=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(a),s.detachSubflow=()=>t.detach(o),s}}function Oct(){return lt}function Ict(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(a=>t.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(a=>t.get(a)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Se("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Nct(e){var t=this,n=Nt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=void 0;r||Se("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(o=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,r,i,a,o)}const Dct={skip:!0};function Rct(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(a=>{const o=t.signals[a];e.signals(a,o)&&(r[a]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(a=>{const o=t.data[a];e.data(a,o)&&(i[a]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function Fct(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(a=>{n.update(t.signals[a],i[a],Dct)}),Object.keys(r||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(fs).insert(r[a]))}),(e.subcontext||[]).forEach((a,o)=>{const s=t.subcontext[o];s&&s.setState(a)})}function Ihe(e,t,n,r){return new Nhe(e,t,n,r)}function Nhe(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||vct,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Dhe(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Nhe.prototype=Dhe.prototype={fork(){const e=new Dhe(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),gct(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(r.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),r.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const o=n.data[a]||(n.data[a]={});e.data[a].forEach(s=>o[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Ej(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:fct,parseOperator:yct,parseOperatorParameters:bct,parseParameters:xct,parseStream:Ict,parseUpdate:Nct,getState:Rct,setState:Fct};function Mct(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Rhe(t,e.description()))}function Rhe(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Pct(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Aj="default";function $ct(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Aj,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,a=i?Bn(i)?i:i.user:Aj,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Bn(r)||(i=r.item,r=r.user),Cj(e,r&&r!==Aj?r:i||r),i},{cursor:t})}function Cj(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function BT(e,t){var n=e._runtime.data;return _t(n,t)||Se("Unrecognized data set: "+t),n[t]}function Lct(e,t){return arguments.length<2?BT(this,e).values.value:zT.call(this,e,wp().remove(fs).insert(t))}function zT(e,t){bae(t)||Se("Second argument to changes must be a changeset.");const n=BT(this,e);return n.modified=!0,this.pulse(n.input,t)}function Bct(e,t){return zT.call(this,e,wp().insert(t))}function zct(e,t){return zT.call(this,e,wp().remove(t))}function Fhe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Mhe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function jT(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function jct(e){var t=jT(e),n=Fhe(e),r=Mhe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){e.error(a)}})}function Uct(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,s;return i&&(s=jT(e),o=t.changedTouches?t.changedTouches[0]:t,a=vk(o,i),a[0]-=s[0],a[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Wct(e,n,a),t}function Wct(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var s=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function a(o){if(!o)return n;Bn(o)&&(o=i(o));const s=n.slice();for(;o;)s[0]-=o.x||0,s[1]-=o.y||0,o=o.mark&&o.mark.group;return s}return{view:Ji(e),item:Ji(t||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const Phe="view",Vct="timer",qct="window",Hct={trap:!1};function Gct(e){const t=Rt({defaults:{}},e),n=(r,i)=>{i.forEach(a=>{ut(r[a])&&(r[a]=iu(r[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function $he(e,t,n,r){e._eventListeners.push({type:n,sources:wt(t),handler:r})}function Kct(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function UT(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Nt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Xct(e,t,n){var r=this,i=new gC(n),a=function(l,c){r.runAsync(null,()=>{e===Phe&&Kct(r,t)&&l.preventDefault(),i.receive(Uct(r,l,c))})},o;if(e===Vct)UT(r,"timer",t)&&r.timer(a,t);else if(e===Phe)UT(r,"view",t)&&r.addEventListener(t,a,Hct);else if(e===qct?UT(r,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&UT(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=o.length;s<u;++s)o[s].addEventListener(t,a);$he(r,o,t,a)}return i}function Lhe(e){return e.item}function Bhe(e){return e.item.mark.source}function zhe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Yct(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Lhe),Bhe,zhe(e)),this.on(this.events("view","mouseout",Lhe),Bhe,zhe(t)),this}function Zct(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return e&&e.call(this,this._handler,null,null,null),this}function Go(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Jct="vega-bind",Qct="vega-bind-name",eft="vega-bind-radio";function tft(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=EL(r.debounce,i.update))),(r.input==null&&r.element?nft:ift)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function nft(e,t,n,r){const i=n.event||"input",a=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,a),$he(r,t,i,a),e.set=o=>{t.value=o,t.dispatchEvent(rft(i))}}function rft(e){return typeof Event!="undefined"?new Event(e):{type:e}}function ift(e,t,n,r){const i=r.signal(n.signal),a=Go("div",{class:Jct}),o=n.input==="radio"?a:a.appendChild(Go("label"));o.appendChild(Go("span",{class:Qct},n.name||n.signal)),t.appendChild(a);let s=aft;switch(n.input){case"checkbox":s=oft;break;case"select":s=sft;break;case"radio":s=uft;break;case"range":s=lft;break}s(e,o,n,i)}function aft(e,t,n,r){const i=Go("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=a=>i.value=a}function oft(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Go("input",i);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=o=>a.checked=!!o||null}function sft(e,t,n,r){const i=Go("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,s)=>{const u={value:o};WT(o,r)&&(u.selected=!0),i.appendChild(Go("option",u,(a[s]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let s=0,u=n.options.length;s<u;++s)if(WT(n.options[s],o)){i.selectedIndex=s;return}}}function uft(e,t,n,r){const i=Go("span",{class:eft}),a=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,s)=>{const u={type:"radio",name:n.signal,value:o};WT(o,r)&&(u.checked=!0);const l=Go("input",u);l.addEventListener("change",()=>e.update(o));const c=Go("label",{},(a[s]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)WT(s[l].value,o)&&(s[l].checked=!0)}}function lft(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||nd(a,i,100),s=Go("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=Go("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function WT(e,t){return e===t||e+""==t+""}function jhe(e,t,n,r,i,a){return t=t||new r(e.loader()),t.initialize(n,Fhe(e),Mhe(e),jT(e),i,a).background(e.background())}function kj(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function cft(e,t,n,r){const i=new r(e.loader(),kj(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,jT(e),e);return t&&t.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function fft(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,a=Ck(r);e=n._el=e?Tj(n,e,!0):null,Mct(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||xx,s=e?a.renderer:a.headless;return n._renderer=s?jhe(n,n._renderer,e,s):null,n._handler=cft(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=Tj(n,t,!0):e.appendChild(Go("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=Tj(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{tft(n,u.element||t,u)})),n}function Tj(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const ow=e=>+e||0,dft=e=>({top:e,bottom:e,left:e,right:e});function Uhe(e){return Nt(e)?{top:ow(e.top),bottom:ow(e.bottom),left:ow(e.left),right:ow(e.right)}:dft(ow(e))}async function Oj(e,t,n,r){const i=Ck(t),a=i&&i.headless;return a||Se("Unrecognized renderer type: "+t),await e.runAsync(),jhe(e,null,null,a,n,r).renderAsync(e._scenegraph.root)}async function hft(e,t){e!==kd.Canvas&&e!==kd.SVG&&e!==kd.PNG&&Se("Unrecognized image type: "+e);const n=await Oj(this,e,t);return e===kd.SVG?pft(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function pft(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function gft(e,t){return(await Oj(this,kd.Canvas,e,t)).canvas()}async function mft(e){return(await Oj(this,kd.SVG,e)).svg()}function vft(e,t,n){return Ihe(e,Av,iw,n).parse(t)}function yft(e){var t=this._runtime.scales;return _t(t,e)||Se("Unrecognized scale or projection: "+e),t[e].value}var Whe="width",Vhe="height",Ij="padding",qhe={skip:!0};function Hhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Ij?r.left+r.right:0)}function Ghe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Ij?r.top+r.bottom:0)}function bft(e){var t=e._signals,n=t[Whe],r=t[Vhe],i=t[Ij];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=Hhe(e,s.size),a()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=Ghe(e,s.size),a()},{size:r});const o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function xft(e,t,n,r,i,a){this.runAfter(o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Whe,n,qhe),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal(Vhe,r,qhe),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(u=>u.resize())},!1,1)}function wft(e){return this._runtime.getState(e||{data:_ft,signals:Sft,recurse:!0})}function _ft(e,t){return t.modified&&ut(t.input.value)&&e.indexOf("_:vega:_")}function Sft(e,t){return!(e==="parent"||t instanceof Av.proxy)}function Eft(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Aft(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(uat(n,t))}function Cft(e,t,n,r){const i=e.element();i&&i.setAttribute("title",kft(r))}function kft(e){return e==null?"":ut(e)?Khe(e):Nt(e)&&!Qf(e)?Tft(e):e+""}function Tft(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ut(n)?Khe(n):Xhe(n))}).join(`
`)}function Khe(e){return"["+e.map(Xhe).join(", ")+"]"}function Xhe(e){return ut(e)?"[\u2026]":Nt(e)&&!Qf(e)?"{\u2026}":e}function Yhe(e,t){const n=this;if(t=t||{},Ev.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Rt({},e.locale,t.locale);n.locale(pae(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||kd.Canvas,n._scenegraph=new Wz;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Cft,n._redraw=!0,n._handler=new xx().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Gct(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=vft(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Rt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Hhe(n,n._width),n._viewHeight=Ghe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,bft(n),Pct(n),$ct(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function VT(e,t){return _t(e._signals,t)?e._signals[t]:Se("Unrecognized signal name: "+gt(t))}function Zhe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function Jhe(e,t,n,r){let i=Zhe(n,r);return i||(i=kj(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function Qhe(e,t,n){const r=Zhe(t,n);return r&&t._targets.remove(r),e}$e(Yhe,Ev,{async evaluate(e,t,n){if(await Ev.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,jct(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&cC(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Rhe(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=VT(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Uhe(e)):Uhe(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Ck(e)||Se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Ev.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(VT(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:xft,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=kj(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Jhe(this,e,VT(this,e),t)},removeSignalListener(e,t){return Qhe(this,VT(this,e),t)},addDataListener(e,t){return Jhe(this,e,BT(this,e).values,t)},removeDataListener(e,t){return Qhe(this,BT(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Cj(this,null);this._globalCursor=!!e,t&&Cj(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Aft,events:Xct,finalize:Zct,hover:Yct,data:Lct,change:zT,insert:Bct,remove:zct,scale:yft,initialize:fft,toImageURL:hft,toCanvas:gft,toSVG:mft,getState:wft,setState:Eft});const Oft="view",qT="[",HT="]",epe="{",tpe="}",Ift=":",npe=",",Nft="@",Dft=">",Rft=/[[\]{}]/,Fft={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let rpe,ipe;function $d(e,t,n){return rpe=t||Oft,ipe=n||Fft,ape(e.trim()).map(Nj)}function Mft(e){return ipe[e]}function sw(e,t,n,r,i){const a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;i&&i.indexOf(s)>=0?--o:r&&r.indexOf(s)>=0&&++o}return t}function ape(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=sw(e,i,npe,qT+epe,HT+tpe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function Nj(e){return e[0]==="["?Pft(e):$ft(e)}function Pft(e){const t=e.length;let n=1,r;if(n=sw(e,n,HT,qT,HT),n===t)throw"Empty between selector: "+e;if(r=ape(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Dft)throw"Expected '>' after between selector: "+e;r=r.map(Nj);const i=Nj(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function $ft(e){const t={source:rpe},n=[];let r=[0,0],i=0,a=0,o=e.length,s=0,u,l;if(e[o-1]===tpe){if(s=e.lastIndexOf(epe),s>=0){try{r=Lft(e.substring(s+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),o=e.length}else throw"Unmatched right brace: "+e;s=0}if(!o)throw e;if(e[0]===Nft&&(i=++s),u=sw(e,s,Ift),u<o&&(n.push(e.substring(a,u).trim()),a=s=++u),s=sw(e,s,qT),s===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),l=[],a=++s,a===o)throw"Unmatched left bracket: "+e;for(;s<o;){if(s=sw(e,s,HT),s===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==qT)throw"Expected left bracket: "+e;a=++s}if(!(o=n.length)||Rft.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):Mft(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Lft(e){const t=e.split(npe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Bft(e){return Nt(e)?e:{type:e||"pad"}}const uw=e=>+e||0,zft=e=>({top:e,bottom:e,left:e,right:e});function jft(e){return Nt(e)?e.signal?e:{top:uw(e.top),bottom:uw(e.bottom),left:uw(e.left),right:uw(e.right)}:zft(uw(e))}const Ai=e=>Nt(e)&&!ut(e)?Rt({},e):{value:e};function ope(e,t,n,r){return n!=null?(Nt(n)&&!ut(n)||ut(n)&&n.length&&Nt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Wi(e,t,n){for(const r in t)ope(e,r,t[r]);for(const r in n)ope(e,r,n[r],"update")}function s0(e,t,n){for(const r in t)n&&_t(n,r)||(e[r]=Rt(e[r]||{},t[r]));return e}function u0(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const Dj="mark",Rj="frame",Fj="scope",Uft="axis",Wft="axis-domain",Vft="axis-grid",qft="axis-label",Hft="axis-tick",Gft="axis-title",Kft="legend",Xft="legend-band",Yft="legend-entry",Zft="legend-gradient",spe="legend-label",Jft="legend-symbol",Qft="legend-title",edt="title",tdt="title-text",ndt="title-subtitle";function rdt(e,t,n,r,i){const a={},o={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!u0(u,e)&&Mj(a,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===Rj?i.group:n===Dj?Rt({},i.mark,i[t]):null;for(u in c)l=u0(u,e)||(u==="fill"||u==="stroke")&&(u0("fill",e)||u0("stroke",e)),l||Mj(a,u,c[u]);wt(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)u0(h,e)||Mj(a,h,d[h])}),e=Rt({},e);for(u in a)c=a[u],c.signal?(s=s||{})[u]=c:o[u]=c;return e.enter=Rt(o,e.enter),s&&(e.update=Rt(s,e.update)),e}function Mj(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const upe=e=>Bn(e)?gt(e):e.signal?"(".concat(e.signal,")"):lpe(e);function GT(e){if(e.gradient!=null)return adt(e);let t=e.signal?"(".concat(e.signal,")"):e.color?idt(e.color):e.field!=null?lpe(e.field):e.value!==void 0?gt(e.value):void 0;return e.scale!=null&&(t=odt(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat(XT(e.exponent),")")),e.mult!=null&&(t+="*".concat(XT(e.mult))),e.offset!=null&&(t+="+".concat(XT(e.offset))),e.round&&(t="round(".concat(t,")")),t}const KT=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(GT).join(","),")+'')");function idt(e){return e.c?KT("hcl",e.h,e.c,e.l):e.h||e.s?KT("hsl",e.h,e.s,e.l):e.l||e.a?KT("lab",e.l,e.a,e.b):e.r||e.g||e.b?KT("rgb",e.r,e.g,e.b):null}function adt(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:gt(n));for(;t.length&&sn(t)==null;)t.pop();return t.unshift(upe(e.gradient)),"gradient(".concat(t.join(","),")")}function XT(e){return Nt(e)?"("+GT(e)+")":e}function lpe(e){return cpe(Nt(e)?e:{datum:e})}function cpe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Se("Invalid field reference: "+gt(e));return e.signal||(r=Bn(r)?WA(r).map(gt).join("]["):cpe(r)),t+"["+r+"]"}function odt(e,t){const n=upe(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+XT(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function sdt(e){let t="";return e.forEach(n=>{const r=GT(n);t+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),sn(t)===":"&&(t+="null"),t}function fpe(e,t,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},e=rdt(e,t,n,r,i.config);for(const s in e)o[s]=udt(e[s],t,a,i);return a}function udt(e,t,n,r){const i={},a={};for(const o in e)e[o]!=null&&(i[o]=cdt(ldt(e[o]),r,n,a));return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function ldt(e){return ut(e)?sdt(e):GT(e)}function cdt(e,t,n,r){const i=wl(e,t);return i.$fields.forEach(a=>r[a]=1),Rt(n,i.$params),i.$expr}const fdt="outer",ddt=["value","update","init","react","bind"];function dpe(e,t){Se(e+' for "outer" push: '+gt(t))}function hpe(e,t){const n=e.name;if(e.push===fdt)t.signals[n]||dpe("No prior signal definition",n),ddt.forEach(r=>{e[r]!==void 0&&dpe("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Pj(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function YT(e,t,n,r){return new Pj(e,t,n,r)}function ZT(e,t){return YT("operator",e,t)}function ft(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function lw(e,t){return t?{$field:e,$name:t}:{$field:e}}const $j=lw("key");function ppe(e,t){return{$compare:e,$order:t}}function hdt(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const pdt="ascending",gdt="descending";function mdt(e){return Nt(e)?(e.order===gdt?"-":"+")+JT(e.op,e.field):""}function JT(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Lj="scope",Bj="view";function di(e){return e&&e.signal}function vdt(e){return e&&e.expr}function QT(e){if(di(e))return!0;if(Nt(e)){for(const t in e)if(QT(e[t]))return!0}return!1}function mu(e,t){return e??t}function Gp(e){return e&&e.signal||e}const gpe="timer";function cw(e,t){return(e.merge?bdt:e.stream?xdt:e.type?wdt:Se("Invalid stream specification: "+gt(e)))(e,t)}function ydt(e){return e===Lj?Bj:e||Bj}function bdt(e,t){const n=e.merge.map(i=>cw(i,t)),r=zj({merge:n},e,t);return t.addStream(r).id}function xdt(e,t){const n=cw(e.stream,t),r=zj({stream:n},e,t);return t.addStream(r).id}function wdt(e,t){let n;e.type===gpe?(n=t.event(gpe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(ydt(e.source),e.type);const r=zj({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function zj(e,t,n){let r=t.between;return r&&(r.length!==2&&Se('Stream "between" parameter must have 2 entries: '+gt(t)),e.between=[cw(r[0],n),cw(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(_dt(t.marktype,t.markname,t.markrole)),t.source===Lj&&r.push("inScope(event.item)"),r.length&&(e.filter=wl("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function _dt(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Sdt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Edt(e,t,n){const r=e.encode,i={target:n};let a=e.events,o=e.update,s=[];a||Se("Signal update missing events specification."),Bn(a)&&(a=$d(a,t.isSubscope()?Lj:Bj)),a=wt(a).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Cdt(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&Se("Signal encode and update are mutually exclusive."),o="encode(item(),"+gt(r)+")"),i.update=Bn(o)?wl(o,t):o.expr!=null?wl(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:Sdt,$params:{$value:t.signalRef(o.signal)}}:Se("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(Rt(Adt(u,t),i)))}function Adt(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):cw(e,t)}}function Cdt(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function kdt(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=wl(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Edt(i,t,n.id))}const Vn=e=>(t,n,r)=>YT(e,n,t||void 0,r),mpe=Vn("aggregate"),Tdt=Vn("axisticks"),vpe=Vn("bound"),vu=Vn("collect"),ype=Vn("compare"),Odt=Vn("datajoin"),bpe=Vn("encode"),Idt=Vn("expression"),Ndt=Vn("facet"),Ddt=Vn("field"),Rdt=Vn("key"),Fdt=Vn("legendentries"),Mdt=Vn("load"),Pdt=Vn("mark"),$dt=Vn("multiextent"),Ldt=Vn("multivalues"),Bdt=Vn("overlap"),zdt=Vn("params"),xpe=Vn("prefacet"),jdt=Vn("projection"),Udt=Vn("proxy"),Wdt=Vn("relay"),wpe=Vn("render"),Vdt=Vn("scale"),Kp=Vn("sieve"),qdt=Vn("sortitems"),_pe=Vn("viewlayout"),Hdt=Vn("values");let Gdt=0;const Spe={min:"min",max:"max",count:"sum"};function Kdt(e,t){const n=e.type||"linear";uue(n)||Se("Unrecognized scale type: "+gt(n)),t.addScale(e.name,{type:n,domain:void 0})}function Xdt(e,t){const n=t.getScale(e.name).params;let r;n.domain=Epe(e.domain,e,t),e.range!=null&&(n.range=Cpe(e,t,n)),e.interpolate!=null&&aht(e.interpolate,n),e.nice!=null&&(n.nice=iht(e.nice)),e.bins!=null&&(n.bins=rht(e.bins,t));for(r in e)_t(n,r)||r==="name"||(n[r]=bs(e[r],t))}function bs(e,t){return Nt(e)?e.signal?t.signalRef(e.signal):Se("Unsupported object: "+gt(e)):e}function eO(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>bs(n,t))}function tO(e){Se("Can not find data set: "+gt(e))}function Epe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Se("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ut(e)?Ydt:e.fields?Jdt:Zdt)(e,t,n)}function Ydt(e,t,n){return e.map(r=>bs(r,n))}function Zdt(e,t,n){const r=n.getData(e.data);return r||tO(e.data),Lv(t.type)?r.valuesRef(n,e.field,Ape(e.sort,!1)):fue(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Jdt(e,t,n){const r=e.data,i=e.fields.reduce((a,o)=>(o=Bn(o)?{data:r,field:o}:ut(o)||o.signal?Qdt(o,n):o,a.push(o),a),[]);return(Lv(t.type)?eht:fue(t.type)?tht:nht)(e,n,i)}function Qdt(e,t){const n="_:vega:_"+Gdt++,r=vu({});if(ut(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+gt(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Kp({})]),{data:n,field:"data"}}function eht(e,t,n){const r=Ape(e.sort,!0);let i,a;const o=n.map(l=>{const c=t.getData(l.data);return c||tO(l.data),c.countsRef(t,l.field,r)}),s={groupby:$j,pulse:o};r&&(i=r.op||"count",a=r.field?JT(i,r.field):"count",s.ops=[Spe[i]],s.fields=[t.fieldRef(a)],s.as=[a]),i=t.add(mpe(s));const u=t.add(vu({pulse:ft(i)}));return a=t.add(Hdt({field:$j,sort:t.sortRef(r),pulse:ft(u)})),ft(a)}function Ape(e,t){return e&&(!e.field&&!e.op?Nt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Se("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!Spe[e.op]&&Se("Multiple domain scales can not be sorted using "+e.op)),e}function tht(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||tO(i.data),a.domainRef(t,i.field)});return ft(t.add(Ldt({values:r})))}function nht(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||tO(i.data),a.extentRef(t,i.field)});return ft(t.add($dt({extents:r})))}function rht(e,t){return e.signal||ut(e)?eO(e,t):t.objectProperty(e)}function iht(e){return Nt(e)?{interval:bs(e.interval),step:bs(e.step)}:bs(e)}function aht(e,t){t.interpolate=bs(e.type||e),e.gamma!=null&&(t.interpolateGamma=bs(e.gamma))}function Cpe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Bn(i)){if(r&&_t(r,i))return e=Rt({},e,{range:r[i]}),Cpe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Lv(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Se("Unrecognized scale range value: "+gt(i))}else if(i.scheme){n.scheme=ut(i.scheme)?eO(i.scheme,t):bs(i.scheme,t),i.extent&&(n.schemeExtent=eO(i.extent,t)),i.count&&(n.schemeCount=bs(i.count,t));return}else if(i.step){n.rangeStep=bs(i.step,t);return}else{if(Lv(e.type)&&!ut(i))return Epe(i,e,t);ut(i)||Se("Unsupported range type: "+gt(i))}return i.map(a=>(ut(a)?eO:bs)(a,t))}function oht(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=jj(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=jj(n[i],i,t));t.addProjection(e.name,r)}function jj(e,t,n){return ut(e)?e.map(r=>jj(r,t,n)):Nt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Se("Unsupported parameter object: "+gt(e)):e}const yu="top",l0="left",c0="right",Ld="bottom",kpe="center",sht="vertical",uht="start",lht="middle",cht="end",Uj="index",Wj="label",fht="offset",f0="perc",dht="perc2",xs="value",fw="guide-label",Vj="guide-title",hht="group-title",pht="group-subtitle",Tpe="symbol",nO="gradient",qj="discrete",Hj="size",ght="shape",mht="fill",vht="stroke",yht="strokeWidth",bht="strokeDash",xht="opacity",Gj=[Hj,ght,mht,vht,yht,bht,xht],dw={name:1,style:1,interactive:1},pn={value:0},ws={value:1},rO="group",Ope="rect",Kj="rule",wht="symbol",Xp="text";function hw(e){return e.type=rO,e.interactive=e.interactive||!1,e}function vo(e,t){const n=(r,i)=>mu(e[r],mu(t[r],i));return n.isVertical=r=>sht===mu(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>mu(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>mu(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>mu(e.columns,mu(t.columns,+n.isVertical(!0))),n}function Ipe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function _ht(e,t,n){const r=t.config.style[n];return r&&r[e]}function iO(e,t,n){return"item.anchor === '".concat(uht,"' ? ").concat(e," : item.anchor === '").concat(cht,"' ? ").concat(t," : ").concat(n)}const Xj=iO(gt(l0),gt(c0),gt(kpe));function Sht(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(t.signal,") === 'extent'")},Nt(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function Npe(e,t){return t?e?Nt(e)?Object.assign({},e,{offset:Npe(e.offset,t)}):{value:e,offset:t}:t:e}function Ko(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=s0(e.encode,t,dw)):e.interactive=!1,e}function Eht(e,t,n,r){const i=vo(e,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;a?(l=[0,1],c=[0,0],f=o,d=s):(l=[0,0],c=[1,0],f=s,d=o);const h={enter:u={opacity:pn,x:pn,y:pn,width:Ai(f),height:Ai(d)},update:Rt({},u,{opacity:ws,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:pn}};return Wi(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ko({type:Ope,role:Zft,encode:h},r)}function Aht(e,t,n,r,i){const a=vo(e,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:pn,fill:{scale:t,field:xs}};p[l]={signal:h+"datum."+f0,mult:u},p[c]=pn,p[f]={signal:h+"datum."+dht,mult:u},p[d]=Ai(s);const g={enter:p,update:Rt({},p,{opacity:ws}),exit:{opacity:pn}};return Wi(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Ko({type:Ope,role:Xft,key:xs,from:i,encode:g},r)}const Cht="datum.".concat(f0,'<=0?"').concat(l0,'":datum.').concat(f0,'>=1?"').concat(c0,'":"').concat(kpe,'"'),kht="datum.".concat(f0,'<=0?"').concat(Ld,'":datum.').concat(f0,'>=1?"').concat(yu,'":"').concat(lht,'"');function Dpe(e,t,n,r){const i=vo(e,t),a=i.isVertical(),o=Ai(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:pn},update:c={opacity:ws,text:{field:Wj}},exit:{opacity:pn}};return Wi(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:mu(e.labelLimit,t.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=c.baseline={signal:kht},f="y",d="x",h="1-"):(l.align=c.align={signal:Cht},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+f0,mult:s},l[d]=c[d]=o,o.offset=mu(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+Uj}:void 0,Ko({type:Xp,role:spe,style:fw,key:xs,from:r,encode:p,overlap:u},n)}function Tht(e,t,n,r,i){const a=vo(e,t),o=n.entries,s=!!(o&&o.interactive),u=o?o.name:void 0,l=a("clipHeight"),c=a("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(fht," : datum.").concat(Hj),h=l?Ai(l):{field:Hj},p="datum.".concat(Uj),g="max(1, ".concat(i,")");let m,v,y,b,x;h.mult=.5,m={enter:v={opacity:pn,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:ws,x:v.x,y:v.y},exit:{opacity:pn}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Wi(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",S),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),Gj.forEach(C=>{e[C]&&(y[C]=v[C]={scale:e[C],field:xs})});const A=Ko({type:wht,role:Jft,key:xs,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=Ai(c);_.offset=a("labelOffset"),m={enter:v={opacity:pn,x:{signal:d,offset:_},y:h},update:y={opacity:ws,text:{field:Wj},x:v.x,y:v.y},exit:{opacity:pn}},Wi(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const E=Ko({type:Xp,role:spe,style:fw,key:xs,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:pn,height:l?Ai(l):pn,opacity:pn},exit:{opacity:pn},update:y={opacity:ws,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),r={facet:{data:r,name:"value",groupby:Uj}},hw({role:Fj,from:r,encode:s0(m,o,dw),marks:[A,E],name:u,interactive:s,sort:x})}function Oht(e,t){const n=vo(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Yj='item.orient === "left"',Zj='item.orient === "right"',aO="(".concat(Yj," || ").concat(Zj,")"),Iht="datum.vgrad && ".concat(aO),Nht=iO('"top"','"bottom"','"middle"'),Dht=iO('"right"','"left"','"center"'),Rht="datum.vgrad && ".concat(Zj," ? (").concat(Dht,") : (").concat(aO," && !(datum.vgrad && ").concat(Yj,')) ? "left" : ').concat(Xj),Fht="item._anchor || (".concat(aO,' ? "middle" : "start")'),Mht="".concat(Iht," ? (").concat(Yj," ? -90 : 90) : 0"),Pht="".concat(aO," ? (datum.vgrad ? (").concat(Zj,' ? "bottom" : "top") : ').concat(Nht,') : "top"');function $ht(e,t,n,r){const i=vo(e,t),a={enter:{opacity:pn},update:{opacity:ws,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:pn}};return Wi(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Fht},angle:{signal:Mht},align:{signal:Rht},baseline:{signal:Pht},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ko({type:Xp,role:Qft,style:Vj,from:r,encode:a},n)}function Lht(e,t){let n;return Nt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Rpe(e.path)+")":e.sphere&&(n="geoShape("+Rpe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Rpe(e){return Nt(e)&&e.signal?e.signal:gt(e)}function Fpe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===rO?Fj:t||Dj}function Bht(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Fpe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function zht(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Jj(e,t){const n=Tae(e.type);n||Se("Unrecognized transform type: "+gt(e.type));const r=YT(n.type.toLowerCase(),null,Mpe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function Mpe(e,t,n){const r={},i=e.params.length;for(let a=0;a<i;++a){const o=e.params[a];r[o.name]=jht(o,t,n)}return r}function jht(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return Uht(e,t,n);if(i===void 0){e.required&&Se("Missing required "+gt(t.type)+" parameter: "+gt(e.name));return}else{if(r==="param")return Wht(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!di(i)?i.map(a=>Ppe(e,a,n)):Ppe(e,i,n)}function Ppe(e,t,n){const r=e.type;if(di(t))return Lpe(r)?Se("Expression references can not be signals."):Qj(r)?n.fieldRef(t):Bpe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||Qj(r);return i&&Vht(t)?n.exprRef(t.expr,t.as):i&&qht(t)?lw(t.field,t.as):Lpe(r)?wl(t,n):Hht(r)?ft(n.getData(t).values):Qj(r)?lw(t):Bpe(r)?n.compareRef(t):t}}function Uht(e,t,n){return Bn(t.from)||Se('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Wht(e,t,n){const r=t[e.name];return e.array?(ut(r)||Se("Expected an array of sub-parameters. Instead: "+gt(r)),r.map(i=>$pe(e,i,n))):$pe(e,r,n)}function $pe(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||Se("Unsupported parameter: "+gt(t));const a=Rt(Mpe(i,t,n),i.key);return ft(n.add(zdt(a)))}const Vht=e=>e&&e.expr,qht=e=>e&&e.field,Hht=e=>e==="data",Lpe=e=>e==="expr",Qj=e=>e==="field",Bpe=e=>e==="compare";function Ght(e,t,n){let r,i,a,o,s;return e?(r=e.facet)&&(t||Se("Only group marks can be faceted."),r.field!=null?o=s=oO(r,n):(e.data?s=ft(n.getData(e.data).aggregate):(a=Jj(Rt({type:"aggregate",groupby:wt(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=oO(r,n),o=s=ft(n.add(a))),i=n.keyRef(r.groupby,!0))):o=ft(n.add(vu(null,[{}]))),o||(o=oO(e,n)),{key:i,pulse:o,parent:s}}function oO(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ft(t.getData(e.data).output)}function Yp(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Yp.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let a=t[0],o=null,s=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ft(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(o=t[s]);return new Yp(e,a,i,r,o)};function zpe(e){return Bn(e)?e:null}function jpe(e,t,n){const r=JT(n.op,n.field);let i;if(t.ops){for(let a=0,o=t.as.length;a<o;++a)if(t.as[a]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function pw(e,t,n,r,i,a,o){const s=t[n]||(t[n]={}),u=mdt(a);let l=zpe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=a?{field:$j,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:ft(t.output)};u&&(d.sort=e.sortRef(a)),f=e.add(YT(r,void 0,d)),o&&(t.index[i]=f),c=ft(f),l!=null&&(s[l]=c)}return c}Yp.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),a=zpe(t);let o,s,u;return a!=null&&(e=r.scope,o=i[a]),o?n&&n.field&&jpe(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ft(r.output)},n&&n.field&&jpe(e,u,n),s=e.add(mpe(u)),o=e.add(vu({pulse:ft(s)})),o={agg:s,ref:ft(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return ft(this.values)},extentRef(e,t){return pw(e,this,"extent","extent",t,!1)},domainRef(e,t){return pw(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return pw(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return pw(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return pw(e,this,"indata","tupleindex",t,!0,!0)}};function Kht(e,t,n){const r=e.from.facet,i=r.name,a=oO(r,t);let o;r.name||Se("Facet must have a name: "+gt(r)),r.data||Se("Facet must reference a data set: "+gt(r)),r.field?o=t.add(xpe({field:t.fieldRef(r.field),pulse:a})):r.groupby?o=t.add(Ndt({key:t.keyRef(r.groupby),group:ft(t.proxy(n.parent)),pulse:a})):Se("Facet must specify groupby or field: "+gt(r));const s=t.fork(),u=s.add(vu()),l=s.add(Kp({pulse:ft(u)}));s.addData(i,new Yp(s,u,u,l)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(e).toRuntime()}}function Xht(e,t,n){const r=t.add(xpe({pulse:n.pulse})),i=t.fork();i.add(Kp()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Upe(e,t,n){const r=e.remove,i=e.insert,a=e.toggle,o=e.modify,s=e.values,u=t.add(ZT()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(f=>f??"null").join(",")+"),0)",c=wl(l,t);u.update=c.$expr,u.params=c.$params}function sO(e,t){const n=Fpe(e),r=e.type===rO,i=e.from&&e.from.facet,a=e.overlap;let o=e.layout||n===Fj||n===Rj,s,u,l,c,f,d,h;const p=n===Dj||o||i,g=Ght(e.from,r,t);u=t.add(Odt({key:g.key||(e.key?lw(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ft(u);u=l=t.add(vu({pulse:m})),u=t.add(Pdt({markdef:Bht(e),interactive:zht(e.interactive,t),clip:Lht(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ft(u)}));const v=ft(u);u=c=t.add(bpe(fpe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const A=Jj(S,t),_=A.metadata;(_.generates||_.changes)&&Se("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),A.params.pulse=ft(u),t.add(u=A)}),e.sort&&(u=t.add(qdt({sort:t.compareRef(e.sort),pulse:ft(u)})));const y=ft(u);(i||o)&&(o=t.add(_pe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=ft(o));const b=t.add(vpe({mark:v,pulse:d||y}));h=ft(b),r&&(p&&(s=t.operators,s.pop(),o&&s.pop()),t.pushState(y,d||h,m),i?Kht(e,t,g):p?Xht(e,t,g):t.parse(e),t.popState(),p&&(o&&s.push(o),s.push(b))),a&&(h=Yht(a,h,t));const x=t.add(wpe({pulse:h})),w=t.add(Kp({pulse:ft(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Yp(t,l,x,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&Se("Marks only support modify triggers."),Upe(S,t,f)}))}function Yht(e,t,n){const r=e.method,i=e.bound,a=e.separation,o={separation:di(a)?n.signalRef(a.signal):a,method:di(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;o.boundTolerance=di(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return ft(n.add(Bdt(o)))}function Zht(e,t){const n=t.config.legend,r=e.encode||{},i=vo(e,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,l={};let c=0,f,d,h;Gj.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||Se("Missing valid scale for legend.");const p=Jht(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ft(t.add(vu(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=ft(t.add(Fdt(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===nO?(h=[Eht(e,c,n,r.gradient),Dpe(e,n,r.labels,y)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(Gp(i.gradientLength()),")/100))"))):p===qj?h=[Aht(e,c,n,r.gradient,y),Dpe(e,n,r.labels,y)]:(f=Oht(e,n),h=[Tht(e,n,r,y,Gp(f.columns))],d.size=tpt(e,t,h[0].marks)),h=[hw({role:Yft,from:m,encode:v,marks:h,layout:f,interactive:s})],g.title&&h.push($ht(e,n,r.title,m)),sO(hw({role:Kft,from:m,encode:s0(ept(i,e,n),a,dw),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),t)}function Jht(e,t){let n=e.type||Tpe;return!e.type&&Qht(e)===1&&(e.fill||e.stroke)&&(n=az(t)?nO:oz(t)?qj:Tpe),n!==nO?n:oz(t)?qj:nO}function Qht(e){return Gj.reduce((t,n)=>t+(e[n]?1:0),0)}function ept(e,t,n){const r={enter:{},update:{}};return Wi(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function tpt(e,t,n){const r=Gp(Wpe("size",e,n)),i=Gp(Wpe("strokeWidth",e,n)),a=Gp(npt(n[1].encode,t,fw));return wl("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function Wpe(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):Ipe(e,n[0].encode)}function npt(e,t,n){return Ipe("fontSize",e)||_ht("fontSize",t,n)}const rpt='item.orient==="'.concat(l0,'"?-90:item.orient==="').concat(c0,'"?90:0');function ipt(e,t){e=Bn(e)?{text:e}:e;const n=vo(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],l={},c=ft(t.add(vu(null,[l])));return u.push(spt(e,n,apt(e),c)),e.subtitle&&u.push(upt(e,n,r.subtitle,c)),sO(hw({role:edt,from:c,encode:opt(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),t)}function apt(e){const t=e.encode;return t&&t.title||Rt({name:e.name,interactive:e.interactive,style:e.style},t)}function opt(e,t){const n={enter:{},update:{}};return Wi(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Xj},angle:{signal:rpt},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),s0(n,t,dw)}function spt(e,t,n,r){const i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Wi(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ko({type:Xp,role:tdt,style:hht,from:r,encode:o},n)}function upt(e,t,n,r){const i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Wi(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ko({type:Xp,role:ndt,style:pht,from:r,encode:o},n)}function lpt(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(Jj(r,t))}),e.on&&e.on.forEach(r=>{Upe(r,t,e.name)}),t.addDataPipeline(e.name,cpt(e,t,n))}function cpt(e,t,n){const r=[];let i=null,a=!1,o=!1,s,u,l,c,f;for(e.values?di(e.values)||QT(e.format)?(r.push(Vpe(t,e)),r.push(i=Zp())):r.push(i=Zp({$ingest:e.values,$format:e.format})):e.url?QT(e.url)||QT(e.format)?(r.push(Vpe(t,e)),r.push(i=Zp())):r.push(i=Zp({$request:e.url,$format:e.format})):e.source&&(i=s=wt(e.source).map(d=>ft(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Zp()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(a=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=Wdt({derive:a,pulse:l?s:s[0]}),(a||l)&&r.splice(1,0,Zp())),i||r.push(Zp()),r.push(Kp({})),r}function Zp(e){const t=vu({},e);return t.metadata={source:!0},t}function Vpe(e,t){return Mdt({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const qpe=e=>e===Ld||e===yu,uO=(e,t,n)=>di(e)?ppt(e.signal,t,n):e===l0||e===yu?t:n,Ci=(e,t,n)=>di(e)?dpt(e.signal,t,n):qpe(e)?t:n,bu=(e,t,n)=>di(e)?hpt(e.signal,t,n):qpe(e)?n:t,Hpe=(e,t,n)=>di(e)?gpt(e.signal,t,n):e===yu?{value:t}:{value:n},fpt=(e,t,n)=>di(e)?mpt(e.signal,t,n):e===c0?{value:t}:{value:n},dpt=(e,t,n)=>Gpe("".concat(e," === '").concat(yu,"' || ").concat(e," === '").concat(Ld,"'"),t,n),hpt=(e,t,n)=>Gpe("".concat(e," !== '").concat(yu,"' && ").concat(e," !== '").concat(Ld,"'"),t,n),ppt=(e,t,n)=>e8("".concat(e," === '").concat(l0,"' || ").concat(e," === '").concat(yu,"'"),t,n),gpt=(e,t,n)=>e8("".concat(e," === '").concat(yu,"'"),t,n),mpt=(e,t,n)=>e8("".concat(e," === '").concat(c0,"'"),t,n),Gpe=(e,t,n)=>(t=t!=null?Ai(t):t,n=n!=null?Ai(n):n,Kpe(t)&&Kpe(n)?(t=t?t.signal||gt(t.value):null,n=n?n.signal||gt(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Rt({test:e},t)].concat(n||[])),Kpe=e=>e==null||Object.keys(e).length===1,e8=(e,t,n)=>({signal:"".concat(e," ? (").concat(d0(t),") : (").concat(d0(n),")")}),vpt=(e,t,n,r,i)=>({signal:(r!=null?"".concat(e," === '").concat(l0,"' ? (").concat(d0(r),") : "):"")+(n!=null?"".concat(e," === '").concat(Ld,"' ? (").concat(d0(n),") : "):"")+(i!=null?"".concat(e," === '").concat(c0,"' ? (").concat(d0(i),") : "):"")+(t!=null?"".concat(e," === '").concat(yu,"' ? (").concat(d0(t),") : "):"")+"(null)"}),d0=e=>di(e)?e.signal:e==null?null:gt(e),ypt=(e,t)=>t===0?0:di(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},h0=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function p0(e,t,n,r){let i;if(t&&_t(t,e))return t[e];if(_t(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Vj][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[fw][i]}return null}function Xpe(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function bpt(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,s,u,l;if(di(o)){const f=Xpe([n.axisX,n.axisY]),d=Xpe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=Ci(o,p0(l,n.axisX,i,r),p0(l,n.axisY,i,r));u={};for(l of d)u[l]=vpt(o.signal,p0(l,n.axisTop,i,r),p0(l,n.axisBottom,i,r),p0(l,n.axisLeft,i,r),p0(l,n.axisRight,i,r))}else s=o===yu||o===Ld?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return s||u||a?Rt({},i,s,u,a):i}function xpt(e,t,n,r){const i=vo(e,t),a=e.orient;let o,s;const u={enter:o={opacity:pn},update:s={opacity:ws},exit:{opacity:pn}};Wi(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=Ype(e,0),c=Ype(e,1);return o.x=s.x=Ci(a,l,pn),o.x2=s.x2=Ci(a,c),o.y=s.y=bu(a,l,pn),o.y2=s.y2=bu(a,c),Ko({type:Kj,role:Wft,from:r,encode:u},n)}function Ype(e,t){return{scale:e.scale,range:t}}function wpt(e,t,n,r,i){const a=vo(e,t),o=e.orient,s=e.gridScale,u=uO(o,1,-1),l=_pt(e.offset,u);let c,f,d;const h={enter:c={opacity:pn},update:d={opacity:ws},exit:f={opacity:pn}};Wi(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:e.scale,field:xs,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=Ci(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},v=s?{scale:s,range:1,mult:u,offset:l}:Rt(g,{mult:u,offset:l});return c.x=d.x=Ci(o,p,m),c.y=d.y=bu(o,p,m),c.x2=d.x2=bu(o,v),c.y2=d.y2=Ci(o,v),f.x=Ci(o,p),f.y=bu(o,p),Ko({type:Kj,role:Vft,key:xs,from:r,encode:h},n)}function _pt(e,t){if(t!==1)if(!Nt(e))e=di(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=Rt({},e);for(;n.mult!=null;)if(Nt(n.mult))n=n.mult=Rt({},n.mult);else return n.mult=di(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function Spt(e,t,n,r,i,a){const o=vo(e,t),s=e.orient,u=uO(s,-1,1);let l,c,f;const d={enter:l={opacity:pn},update:f={opacity:ws},exit:c={opacity:pn}};Wi(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Ai(i);h.mult=u;const p={scale:e.scale,field:xs,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return f.y=l.y=Ci(s,pn,p),f.y2=l.y2=Ci(s,h),c.x=Ci(s,p),f.x=l.x=bu(s,pn,p),f.x2=l.x2=bu(s,h),c.y=bu(s,p),Ko({type:Kj,role:Hft,key:xs,from:r,encode:d},n)}function t8(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Ept(e,t,n,r,i,a){const o=vo(e,t),s=e.orient,u=e.scale,l=uO(s,-1,1),c=Gp(o("labelFlush")),f=Gp(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=Ai(i);m.mult=l,m.offset=Ai(o("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:xs,band:.5,offset:Npe(a.offset,o("labelOffset"))},y=Ci(s,p?t8(u,c,'"left"','"right"','"center"'):{value:"center"},fpt(s,"left","right")),b=Ci(s,Hpe(s,"bottom","top"),p?t8(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=t8(u,c,"-(".concat(f,")"),f,0);p=p&&f;const w={opacity:pn,x:Ci(s,v,m),y:bu(s,v,m)},S={enter:w,update:g={opacity:ws,text:{field:Wj},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:pn,x:w.x,y:w.y}};Wi(S,{dx:!d&&p?Ci(s,x):null,dy:!h&&p?bu(s,x):null}),Wi(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const A=o("labelBound");let _=o("labelOverlap");return _=_||A?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:A?{scale:u,orient:s,tolerance:A}:null}:void 0,g.align!==y&&(g.align=h0(g.align,y)),g.baseline!==b&&(g.baseline=h0(g.baseline,b)),Ko({type:Xp,role:qft,style:fw,key:xs,from:r,encode:S,overlap:_},n)}function Apt(e,t,n,r){const i=vo(e,t),a=e.orient,o=uO(a,-1,1);let s,u;const l={enter:s={opacity:pn,anchor:Ai(i("titleAnchor",null)),align:{signal:Xj}},update:u=Rt({},s,{opacity:ws,text:Ai(e.title)}),exit:{opacity:pn}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(iO(0,1,.5),")")};return u.x=Ci(a,c),u.y=bu(a,c),s.angle=Ci(a,pn,ypt(o,90)),s.baseline=Ci(a,Hpe(a,Ld,yu),{value:Ld}),u.angle=s.angle,u.baseline=s.baseline,Wi(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Cpt(i,a,l,n),l.update.align=h0(l.update.align,s.align),l.update.angle=h0(l.update.angle,s.angle),l.update.baseline=h0(l.update.baseline,s.baseline),Ko({type:Xp,role:Gft,style:Vj,from:r,encode:l},n)}function Cpt(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=h0(Ai(s),n.update[u]),!1):!u0(u,r),a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?Ai(o):Ci(t,Ai(o),Ai(a))}function kpt(e,t){const n=bpt(e,t),r=e.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=vo(e,n),l=Sht(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ft(t.add(vu({},[c]))),d=ft(t.add(Tdt({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(wpt(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Spt(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(Ept(e,n,r.labels,d,p,l))),c.domain&&h.push(xpt(e,n,r.domain,f)),c.title&&h.push(Apt(e,n,r.title,f)),sO(hw({role:Uft,from:f,encode:s0(Tpt(u,e),i,dw),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),t)}function Tpt(e,t){const n={enter:{},update:{}};return Wi(n,{orient:e("orient"),offset:e("offset")||0,position:mu(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Zpe(e,t,n){const r=wt(e.signals),i=wt(e.scales);return n||r.forEach(a=>hpe(a,t)),wt(e.projections).forEach(a=>oht(a,t)),i.forEach(a=>Kdt(a,t)),wt(e.data).forEach(a=>lpt(a,t)),i.forEach(a=>Xdt(a,t)),(n||r).forEach(a=>kdt(a,t)),wt(e.axes).forEach(a=>kpt(a,t)),wt(e.marks).forEach(a=>sO(a,t)),wt(e.legends).forEach(a=>Zht(a,t)),e.title&&ipt(e.title,t),t.parseLambdas(),t}const Opt=e=>s0({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Ipt(e,t){const n=t.config,r=ft(t.root=t.add(ZT())),i=Npt(e,n);i.forEach(l=>hpe(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(vu()),o=t.add(bpe(fpe(Opt(e.encode),rO,Rj,e.style,t,{pulse:ft(a)}))),s=t.add(_pe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ft(o)}));t.operators.pop(),t.pushState(ft(o),ft(s),null),Zpe(e,t,i),t.operators.push(s);let u=t.add(vpe({mark:r,pulse:ft(s)}));return u=t.add(wpe({pulse:ft(u)})),u=t.add(Kp({pulse:ft(u)})),t.addData("root",new Yp(t,a,a,u)),t}function gw(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Npt(e,t){const n=o=>mu(e[o],t[o]),r=[gw("background",n("background")),gw("autosize",Bft(n("autosize"))),gw("padding",jft(n("padding"))),gw("width",n("width")||0),gw("height",n("height")||0)],i=r.reduce((o,s)=>(o[s.name]=s,o),{}),a={};return wt(e.signals).forEach(o=>{_t(i,o.name)?o=Rt(i[o.name],o):r.push(o),a[o.name]=o}),wt(t.signals).forEach(o=>{!_t(a,o.name)&&!_t(i,o.name)&&r.push(o)}),r}function Jpe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Qpe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Jpe.prototype=Qpe.prototype={parse(e){return Zpe(e,this)},fork(){return new Qpe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Pj?ft(e):e;return this.add(Udt({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,a){let o,s;r&&(o=r.data||(r.data={}),s=o[i]||(o[i]=[]),s.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ft(this.add(Kp({pulse:e})))),this._parent.push(t),this._lookup.push(n?ft(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return sn(this._parent)},encode(){return sn(this._encode)},lookup(){return sn(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Bn(e))return lw(e,t);e.signal||Se("Unsupported field reference: "+gt(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ft(this.add(Ddt(i)))}return r},compareRef(e){let t=!1;const n=a=>di(a)?(t=!0,this.signalRef(a.signal)):vdt(a)?(t=!0,this.exprRef(a.expr)):a,r=wt(e.field).map(n),i=wt(e.order).map(n);return t?ft(this.add(ype({fields:r,orders:i}))):ppe(r,i)},keyRef(e,t){let n=!1;const r=a=>di(a)?(n=!0,ft(i[a.signal])):a,i=this.signals;return e=wt(e).map(r),n?ft(this.add(Rdt({fields:e,flat:t}))):hdt(e,t)},sortRef(e){if(!e)return e;const t=JT(e.op,e.field),n=e.order||pdt;return n.signal?ft(this.add(ype({fields:t,orders:this.signalRef(n.signal)}))):ppe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return _t(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Se("Duplicate signal name: "+gt(e));const n=t instanceof Pj?t:this.add(ZT(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Se("Unrecognized signal name: "+gt(e)),this.signals[e]},signalRef(e){return this.signals[e]?ft(this.signals[e]):(_t(this.lambdas,e)||(this.lambdas[e]=this.add(ZT(null))),ft(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=wl(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Nt(e)?e:this.signalRef(e.signal||n8(e))},exprRef(e,t){const n={expr:wl(e,this)};return t&&(n.expr.$name=t),ft(this.add(Idt(n)))},addBinding(e,t){this.bindings||Se("Nested signals do not support binding: "+gt(e)),this.bindings.push(Rt({signal:e},t))},addScaleProj(e,t){_t(this.scales,e)&&Se("Duplicate scale or projection name: "+gt(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Vdt(t))},addProjection(e,t){this.addScaleProj(e,jdt(t))},getScale(e){return this.scales[e]||Se("Unrecognized scale name: "+gt(e)),this.scales[e]},scaleRef(e){return ft(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.data[e]=t},getData(e){return this.data[e]||Se("Undefined data set name: "+gt(e)),this.data[e]},addDataPipeline(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.addData(e,Yp.fromEntries(this,t))}};function n8(e){return(ut(e)?Dpt:Rpt)(e)}function Dpt(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Nt(i)?i.signal||n8(i):gt(i))}return n+"]"}function Rpt(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+gt(r)+":"+(Nt(i)?i.signal||n8(i):gt(i));return t+"}"}function Fpt(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Mpt(e,t,n){return Nt(e)||Se("Input Vega specification must be an object."),t=qA(Fpt(),t,e.config),Ipt(e,new Jpe(t,n)).toRuntime()}var Ppt="vega",$pt="5.20.0",Lpt="The Vega visualization grammar.",Bpt=["vega","visualization","interaction","dataflow","library","data","d3"],zpt="BSD-3-Clause",jpt="UW Interactive Data Lab (http://idl.cs.washington.edu)",Upt="build/vega-node.js",Wpt="build/vega.module.js",Vpt="build/vega.min.js",qpt="build/vega.min.js",Hpt="index.d.ts",Gpt="vega/vega",Kpt={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Xpt={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Ypt={"vega-schema":"*"},Zpt="f262105e75449760b0f35fda70e6b576a31d68a4",Jpt={name:Ppt,version:$pt,description:Lpt,keywords:Bpt,license:zpt,author:jpt,main:Upt,module:Wpt,unpkg:Vpt,jsdelivr:qpt,types:Hpt,repository:Gpt,scripts:Kpt,dependencies:Xpt,devDependencies:Ypt,gitHead:Zpt};Rt(Av,KYe,gnt,Gnt,Dit,Cat,est,Oot,nst,bst,Ost,Pst);const Qpt=Jpt.version;var egt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Qpt,Dataflow:Ev,EventStream:gC,MultiPulse:w4,Operator:Yn,Parameters:pC,Pulse:cd,Transform:ve,changeset:wp,definition:Tae,ingest:In,isTuple:fC,transform:Oae,transforms:Av,tupleid:lt,interpolate:sz,interpolateColors:ZC,interpolateRange:due,quantizeInterpolator:hue,scale:Sn,scheme:uz,projection:t6,View:Yhe,defaultLocale:y4,formatLocale:sC,locale:pae,resetDefaultLocale:hXe,timeFormatLocale:B1,expressionFunction:Jr,parse:Mpt,runtimeContext:Ihe,codegenExpression:uhe,parseExpression:ahe,parseSelector:$d,Debug:wre,Error:bL,Info:xre,None:yre,Warn:bre,accessor:io,accessorFields:Yi,accessorName:Nr,array:wt,ascending:ZA,clampRange:Fre,compare:SL,constant:Ji,debounce:EL,error:Se,extend:Rt,extent:nl,extentIndex:Mre,falsy:Jf,fastmap:gv,field:ao,flush:Pre,hasOwnProperty:_t,id:m1,identity:Oa,inherits:$e,inrange:mv,isArray:ut,isBoolean:AL,isDate:Qf,isFunction:Lt,isIterable:$re,isNumber:ed,isObject:Nt,isRegExp:Lre,isString:Bn,key:CL,lerp:Bre,logger:_re,lruCache:zre,merge:jre,mergeConfig:qA,one:pv,pad:Ure,panLinear:Tre,panLog:Ore,panPow:Ire,panSymlog:Nre,peek:sn,quarter:Dre,repeat:v1,span:y1,splitAccessPath:WA,stringValue:gt,toBoolean:kL,toDate:TL,toNumber:Zi,toSet:iu,toString:OL,truncate:Wre,truthy:fs,utcquarter:Rre,visitArray:td,writeConfig:HA,zero:Zf,zoomLinear:xL,zoomLog:wL,zoomPow:YA,zoomSymlog:_L,bandwidthNRD:A4,bin:Nae,bootstrapCI:Dae,cumulativeLogNormal:N4,cumulativeNormal:bC,cumulativeUniform:M4,densityLogNormal:I4,densityNormal:C4,densityUniform:F4,dotbin:Rae,quantileLogNormal:D4,quantileNormal:xC,quantileUniform:P4,quantiles:S4,quartiles:E4,get random(){return ps},randomInteger:QXe,randomKDE:T4,randomLCG:JXe,randomLogNormal:Mae,randomMixture:Pae,randomNormal:k4,randomUniform:$ae,regressionExp:Bae,regressionLinear:$4,regressionLoess:Vae,regressionLog:Lae,regressionPoly:jae,regressionPow:zae,regressionQuad:L4,sampleCurve:_C,sampleLogNormal:O4,sampleNormal:yC,sampleUniform:R4,setRandom:YXe,DATE:uo,DAY:ea,DAYOFYEAR:rl,HOURS:Uo,MILLISECONDS:au,MINUTES:Wo,MONTH:Qi,QUARTER:so,SECONDS:hs,TIME_UNITS:n4,WEEK:ui,YEAR:Li,dayofyear:Eie,timeBin:Wie,timeFloor:Nie,timeInterval:xv,timeOffset:Fie,timeSequence:$ie,timeUnitSpecifier:Sie,timeUnits:i4,utcFloor:Die,utcInterval:wv,utcOffset:Mie,utcSequence:Lie,utcdayofyear:kie,utcweek:Tie,week:Aie,read:gae,inferType:Hre,inferTypes:Gre,typeParsers:IL,format:eC,formats:PL,responseType:tie,loader:uC,Bounds:ci,CanvasHandler:xx,CanvasRenderer:Ek,Gradient:Oue,GroupItem:rk,Handler:Ad,Item:nk,Marks:Vo,RenderType:kd,Renderer:gl,ResourceLoader:bz,SVGHandler:Kz,SVGRenderer:t5,SVGStringRenderer:i5,Scenegraph:Wz,boundClip:Gle,boundContext:fx,boundItem:Uz,boundMark:ule,boundStroke:Oc,domChild:co,domClear:lu,domCreate:Ed,domFind:Vz,font:gk,fontFamily:mx,fontSize:pl,intersect:Wle,intersectBoxLine:Uv,intersectPath:Cz,intersectPoint:kz,intersectRule:Gue,lineHeight:_d,markup:e5,multiLineOffset:Bz,pathCurves:hz,pathEqual:Kle,pathParse:Bv,pathRectangle:Pue,pathRender:ox,pathSymbols:Mue,pathTrail:$ue,point:vk,renderModule:Ck,resetSVGClipId:Bue,resetSVGDefIds:Ntt,sceneEqual:o5,sceneFromJSON:cle,scenePickVisit:ck,sceneToJSON:lle,sceneVisit:uu,sceneZOrder:Tz,serializeXML:Dle,textMetrics:hl});const tgt="vega-lite",ngt='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',rgt="4.13.1",igt=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],agt="https://vega.github.io/vega-lite/",ogt="Vega-Lite is a concise high-level language for interactive visualization.",sgt="build/vega-lite.js",ugt="build/vega-lite.min.js",lgt="build/vega-lite.min.js",cgt="build/src/index",fgt="build/src/index.d.ts",dgt={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},hgt={test:"test"},pgt={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},ggt={type:"git",url:"https://github.com/vega/vega-lite.git"},mgt="BSD-3-Clause",vgt={url:"https://github.com/vega/vega-lite/issues"},ygt={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},bgt={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},xgt={vega:"^5.12.1"},wgt={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1};var _gt={name:tgt,author:ngt,version:rgt,collaborators:igt,homepage:agt,description:ogt,main:sgt,unpkg:ugt,jsdelivr:lgt,module:cgt,types:fgt,bin:dgt,directories:hgt,scripts:pgt,repository:ggt,license:mgt,bugs:vgt,devDependencies:ygt,dependencies:bgt,peerDependencies:xgt,jest:wgt};function g0(e,t,n){return e.fields=t||[],e.fname=n,e}function Sgt(e){return e.length===1?Egt(e[0]):Agt(e)}const Egt=e=>function(t){return t[e]},Agt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function r8(e){throw Error(e)}function Jp(e){var t=[],n=null,r=0,i=e.length,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<i;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=s+1,n=u):u==="."&&!r?s>o?l():o=s+1:u==="["?(s>o&&l(),r=o=s+1):u==="]"&&(r||r8("Access path missing open bracket: "+e),r>0&&l(),r=0,o=s+1)}return r&&r8("Access path missing closing bracket: "+e),n&&r8("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function Cgt(e,t,n){const r=Jp(e);return e=r.length===1?r[0]:e,g0((n&&n.get||Sgt)(r),[e],t||e)}var mw=[];Cgt("id");var kgt=g0(function(e){return e},mw,"identity");g0(function(){return 0},mw,"zero"),g0(function(){return 1},mw,"one"),g0(function(){return!0},mw,"true"),g0(function(){return!1},mw,"false");function lO(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Tgt=0,Ogt=1,ege=2,Igt=3,Ngt=4;function Dgt(e,t){var n=e||Tgt;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=Ogt&&lO(t||"error","ERROR",arguments),this},warn:function(){return n>=ege&&lO(t||"warn","WARN",arguments),this},info:function(){return n>=Igt&&lO(t||"log","INFO",arguments),this},debug:function(){return n>=Ngt&&lO(t||"log","DEBUG",arguments),this}}}var vt=Array.isArray;function ki(e){return e===Object(e)}const tge=e=>e!=="__proto__";function nge(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=Rgt(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;i8(t,r,n[r],i)}return t},{})}function i8(e,t,n,r){if(!!tge(t)){var i,a;if(ki(n)&&!vt(n)){a=ki(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?i8(a,i,n[i]):tge(i)&&(a[i]=n[i])}else e[t]=n}}function Rgt(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function zr(e){return e!=null?vt(e)?e:[e]:[]}function Fgt(e){return typeof e=="function"}const Mgt=Object.prototype.hasOwnProperty;function Qp(e,t){return Mgt.call(e,t)}function vw(e){return typeof e=="boolean"}function Qr(e){return typeof e=="number"}function Xt(e){return typeof e=="string"}function gn(e){return vt(e)?"["+e.map(gn)+"]":ki(e)||Xt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function eg(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var rge={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var a;try{a=Promise}catch(d){a=function(){}}function o(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var v=[],y=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var A,_;if(typeof w!="object")return w;if(n(w,r))A=new r;else if(n(w,i))A=new i;else if(n(w,a))A=new a(function(L,W){w.then(function(G){L(x(G,S-1))},function(G){W(x(G,S-1))})});else if(o.__isArray(w))A=[];else if(o.__isRegExp(w))A=new RegExp(w.source,f(w)),w.lastIndex&&(A.lastIndex=w.lastIndex);else if(o.__isDate(w))A=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?A=Buffer.allocUnsafe(w.length):A=new Buffer(w.length),w.copy(A),A;n(w,Error)?A=Object.create(w):typeof g=="undefined"?(_=Object.getPrototypeOf(w),A=Object.create(_)):(A=Object.create(g),_=g)}if(h){var E=v.indexOf(w);if(E!=-1)return y[E];v.push(w),y.push(A)}n(w,r)&&w.forEach(function(L,W){var G=x(W,S-1),K=x(L,S-1);A.set(G,K)}),n(w,i)&&w.forEach(function(L){var W=x(L,S-1);A.add(W)});for(var C in w){var k;_&&(k=Object.getOwnPropertyDescriptor(_,C)),!(k&&k.set==null)&&(A[C]=x(w[C],S-1))}if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(w),C=0;C<T.length;C++){var I=T[C],N=Object.getOwnPropertyDescriptor(w,I);N&&!N.enumerable&&!m||(A[I]=x(w[I],S-1),N.enumerable||Object.defineProperty(A,I,{enumerable:!1}))}if(m)for(var O=Object.getOwnPropertyNames(w),C=0;C<O.length;C++){var D=O[C],N=Object.getOwnPropertyDescriptor(w,D);N&&N.enumerable||(A[D]=x(w[D],S-1),Object.defineProperty(A,D,{enumerable:!1}))}return A}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function s(d){return Object.prototype.toString.call(d)}o.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(rge);var Pgt=rge.exports,$gt=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!=0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},yw=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(a){return function(o){return function(s,u){var l={key:s,value:o[s]},c={key:u,value:o[u]};return a(l,c)}}}(t.cmp),i=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var s,u;if(Array.isArray(o)){for(u="[",s=0;s<o.length;s++)s&&(u+=","),u+=a(o[s])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",s=0;s<c.length;s++){var f=c[s],d=a(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function a8(e){return!!e.or}function o8(e){return!!e.and}function s8(e){return!!e.not}function cO(e,t){if(s8(e))cO(e.not,t);else if(o8(e))for(const n of e.and)cO(n,t);else if(a8(e))for(const n of e.or)cO(n,t);else t(e)}function fO(e,t){return s8(e)?{not:fO(e.not,t)}:o8(e)?{and:e.and.map(n=>fO(n,t))}:a8(e)?{or:e.or.map(n=>fO(n,t))}:t(e)}const bw=$gt,Yt=Pgt;function xw(e,t){const n={};for(const r of t)Qp(e,r)&&(n[r]=e[r]);return n}function Bc(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>yw(e)).join(",")})`};const hr=yw;function yn(e){if(Qr(e))return e;const t=Xt(e)?e:yw(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function ige(e){return e===!1||e===null}function bt(e,t){return e.indexOf(t)>-1}function ww(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function age(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function Lgt(e,...t){for(const n of t)Bgt(e,n??{});return e}function Bgt(e,t){for(const n of Be(t))i8(e,n,t[n],!0)}function Bd(e,t){const n=[],r={};let i;for(const a of e)i=t(a),!(i in r)&&(r[i]=1,n.push(a));return n}function zgt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function oge(e,t){for(const n of e)if(t.has(n))return!0;return!1}function sge(e){const t=new Set;for(const n of e){const i=Jp(n).map((o,s)=>s===0?o:`[${o}]`),a=i.map((o,s)=>i.slice(0,s+1).join(""));for(const o of a)t.add(o)}return t}function uge(e,t){return e===void 0||t===void 0?!0:oge(sge(e),sge(t))}function Zn(e){return Be(e).length===0}const Be=Object.keys,zd=Object.values;function lge(e){const t=[];for(const n in e)Qp(e,n)&&t.push({key:n,value:e[n]});return t}function dO(e){return e===!0||e===!1}function pr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function _w(e,t){return s8(e)?"!("+_w(e.not,t)+")":o8(e)?"("+e.and.map(n=>_w(n,t)).join(") && (")+")":a8(e)?"("+e.or.map(n=>_w(n,t)).join(") || (")+")":t(e)}function u8(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&u8(e[n],t)&&delete e[n],Zn(e)}function hO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function cge(e,t="datum"){const n=Jp(e),r=[];for(let i=1;i<=n.length;i++){const a=`[${n.slice(0,i).map(gn).join("][")}]`;r.push(`${t}${a}`)}return r.join(" && ")}function jgt(e,t="datum"){return`${t}[${gn(Jp(e).join("."))}]`}function Ugt(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function jd(e){return`${Jp(e).map(Ugt).join("\\.")}`}function m0(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function fge(e){return`${Jp(e).join(".")}`}function Sw(e){return e?Jp(e).length:0}function ei(...e){for(const t of e)if(t!==void 0)return t}let Wgt=42;function Vgt(e){const t=++Wgt;return e?String(e)+t:t}function qgt(e){return Hgt(e)?e:`__${e}`}function Hgt(e){return e.indexOf("__")===0}function pO(e){if(e!==void 0)return(e%360+360)%360}function l8(e){return Qr(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const dge={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function c8(e){return e&&e.condition}const hge=["domain","grid","labels","ticks","title"],Ggt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},pge={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Kgt=Object.assign(Object.assign({},pge),{style:1,labelExpr:1,encoding:1});function gge(e){return!!Kgt[e]}const Ua={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},mge=Ua.arc,gO=Ua.area,mO=Ua.bar,Xgt=Ua.image,vO=Ua.line,yO=Ua.point,Ygt=Ua.rect,bO=Ua.rule,vge=Ua.text,f8=Ua.tick,Zgt=Ua.trail,d8=Ua.circle,h8=Ua.square,yge=Ua.geoshape;function tg(e){return bt(["line","area","trail"],e)}function bge(e){return bt(["rect","bar","image","arc"],e)}const xge=Be(Ua);function _l(e){return e.type}eg(xge);const Jgt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Qgt=["fill","fillOpacity"],emt=[...Jgt,...Qgt],tmt={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},wge=Be(tmt),nmt={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},rmt={color:"#4c78a8",invalid:"filter",timeUnitBand:1},imt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},_ge=5,amt={binSpacing:1,continuousBandSize:_ge,timeUnitBandPosition:.5},omt={binSpacing:0,continuousBandSize:_ge,timeUnitBandPosition:.5},smt={thickness:1};function umt(e){return _l(e)?e.type:e}function zc(e){return"mark"in e}class xO{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return zc(t)?umt(t.mark)===this.name:!1}}const lmt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},cmt={count:1,min:1,max:1};function Ud(e){return!!e&&!!e.argmin}function ng(e){return!!e&&!!e.argmax}function p8(e){return Xt(e)&&!!lmt[e]}const fmt=["count","valid","missing","distinct"];function Sge(e){return Xt(e)&&bt(fmt,e)}function dmt(e){return Xt(e)&&bt(["min","max"],e)}const hmt=["count","sum","distinct","valid","missing"],pmt=["mean","average","median","q1","q3","min","max"],gmt=eg(pmt),jc="row",Uc="column",wO="facet",wr="x",hi="y",xu="x2",Sl="y2",El="radius",Wc="radius2",wu="theta",Vc="theta2",Al="latitude",Cl="longitude",_u="latitude2",_s="longitude2",yo="color",kl="fill",Tl="stroke",bo="shape",qc="size",rg="angle",Hc="opacity",Wd="fillOpacity",Vd="strokeOpacity",qd="strokeWidth",Hd="strokeDash",Ew="text",Aw="order",Cw="detail",_O="key",ig="tooltip",SO="href",EO="url",AO="description",mmt={x:1,y:1,x2:1,y2:1},Ege={theta:1,theta2:1,radius:1,radius2:1};function Age(e){return e in Ege}const g8={longitude:1,longitude2:1,latitude:1,latitude2:1};function vmt(e){switch(e){case Al:return"y";case _u:return"y2";case Cl:return"x";case _s:return"x2"}}function ymt(e){return e in g8}const bmt=Be(g8),Cge=Object.assign(Object.assign(Object.assign(Object.assign({},mmt),Ege),g8),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function v0(e){return e===yo||e===kl||e===Tl}const kge={row:1,column:1,facet:1},Ss=Be(kge),m8=Object.assign(Object.assign({},Cge),kge),Tge=Be(m8),xmt=dt(m8,["order","detail","tooltip"]),wmt=dt(xmt,["row","column","facet"]);function _mt(e){return!!wmt[e]}function Oge(e){return!!m8[e]}const Smt=[xu,Sl,_u,_s,Vc,Wc];function Ige(e){return ag(e)!==e}function ag(e){switch(e){case xu:return wr;case Sl:return hi;case _u:return Al;case _s:return Cl;case Vc:return wu;case Wc:return El}return e}function Gd(e){if(Age(e))switch(e){case wu:return"startAngle";case Vc:return"endAngle";case El:return"outerRadius";case Wc:return"innerRadius"}return e}function Ol(e){switch(e){case wr:return xu;case hi:return Sl;case Al:return _u;case Cl:return _s;case wu:return Vc;case El:return Wc}}function Il(e){switch(e){case wr:case xu:return"width";case hi:case Sl:return"height"}}function Emt(e){switch(e){case wr:return"xOffset";case hi:return"yOffset";case xu:return"x2Offset";case Sl:return"y2Offset";case wu:return"thetaOffset";case El:return"radiusOffset";case Vc:return"theta2Offset";case Wc:return"radius2Offset"}}const v8=dt(Cge,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Amt=Be(v8),Kd={x:1,y:1},Es=Be(Kd);function Nl(e){return e in Kd}const y8={theta:1,radius:1},Cmt=Be(y8);function CO(e){return e==="width"?wr:hi}const Nge=dt(v8,["text","tooltip","href","url","description","detail","key","order"]),kmt=Be(Nge);function Tmt(e){return!!v8[e]}function Omt(e){switch(e){case yo:case kl:case Tl:case qc:case bo:case Hc:case qd:case Hd:return!0;case Wd:case Vd:case rg:return!1}}const Dge=Object.assign(Object.assign(Object.assign({},Kd),y8),Nge),kO=Be(Dge);function Xd(e){return!!Dge[e]}function Imt(e,t){return Dmt(e)[t]}const Rge={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Nmt=dt(Rge,["geoshape"]);function Dmt(e){switch(e){case yo:case kl:case Tl:case AO:case Cw:case _O:case ig:case SO:case Aw:case Hc:case Wd:case Vd:case qd:case wO:case jc:case Uc:return Rge;case wr:case hi:case Al:case Cl:return Nmt;case xu:case Sl:case _u:case _s:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case qc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Hd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case bo:return{point:"always",geoshape:"always"};case Ew:return{text:"always"};case rg:return{point:"always",square:"always",text:"always"};case EO:return{image:"always"};case wu:return{text:"always",arc:"always"};case El:return{text:"always",arc:"always"};case Vc:case Wc:return{arc:"always"}}}function TO(e){switch(e){case wr:case hi:case wu:case El:case qc:case rg:case qd:case Hc:case Wd:case Vd:case xu:case Sl:case Vc:case Wc:return;case wO:case jc:case Uc:case bo:case Hd:case Ew:case ig:case SO:case EO:case AO:return"discrete";case yo:case kl:case Tl:return"flexible";case Al:case Cl:case _u:case _s:case Cw:case _O:case Aw:return}}function Fge(e){return vw(e)&&(e=zO(e,void 0)),"bin"+Be(e).map(t=>OO(e[t])?pr(`_${t}_${Object.entries(e[t])}`):pr(`_${t}_${e[t]}`)).join("")}function er(e){return e===!0||kw(e)&&!e.binned}function Wa(e){return e==="binned"||kw(e)&&e.binned===!0}function kw(e){return ki(e)}function OO(e){return e==null?void 0:e.selection}function Mge(e){switch(e){case jc:case Uc:case qc:case yo:case kl:case Tl:case qd:case Hc:case Wd:case Vd:case bo:return 6;case Hd:return 4;default:return 10}}function b8(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Rmt='Autosize "fit" only works for single views and layered views.';function Pge(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function $ge(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Lge(e){return e?`Dropping "fit-${e}" because spec has discrete ${Il(e)}.`:'Dropping "fit" because spec has discrete size.'}function Bge(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Fmt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Mmt(e){return`The "nearest" transform is not supported for ${e} marks.`}function zge(e){return`Selection not supported for ${e} yet.`}function Pmt(e){return`Cannot find a selection named "${e}".`}const $mt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Lmt="Legend bindings are only supported for selections over an individual field or encoding channel.";function Bmt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function zmt(e){return`Unknown repeated value "${e}".`}function jge(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const jmt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Umt(e){return`Unrecognized parse "${e}".`}function Uge(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function Wmt(e){return`Ignoring an invalid transform: ${hr(e)}.`}const Vmt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Wge(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function qmt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function Hmt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${hr(t)} is overridden by a child projection ${hr(n)}.`}const Gmt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Kmt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${hr(n)}}.`}function Vge(e){return`Invalid field type "${e}".`}function Xmt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Ymt(e){return`Invalid aggregation operator "${e}".`}function Zmt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function qge(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function x8(e,t){return`Dropping ${hr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Jmt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function IO(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Qmt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function evt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function tvt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function w8(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function nvt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function rvt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const ivt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function avt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function ovt(e){return`Using unaggregated domain with raw field has no effect (${hr(e)}).`}function svt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function uvt(e){return`Unaggregated domain is currently unsupported for log scale (${hr(e)}).`}function lvt(e){return`Cannot apply size to non-oriented mark "${e}".`}function cvt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function fvt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Hge(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Gge(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function dvt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hr(n)} and ${hr(r)}). Using ${hr(n)}.`}function hvt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hr(n)} and ${hr(r)}). Using the union of the two domains.`}function pvt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function gvt(e){return`Dropping sort property ${hr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const Kge="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",mvt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",vvt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",yvt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function bvt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function xvt(e){return`Cannot stack non-linear scale (${e}).`}function wvt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function NO(e,t){return`Invalid ${e}: ${hr(t)}.`}function _vt(e){return`Dropping day from datetime ${hr(e)} as day cannot be combined with other units.`}function Svt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Evt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Avt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Cvt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function Xge(e){return`1D error band does not support ${e}.`}function Yge(e){return`Channel ${e} is required for "binned" bin.`}function kvt(e){return`Domain for ${e} is required for threshold scale.`}const Zge=Dgt(ege);let y0=Zge;function Tvt(e){return y0=e,y0}function Ovt(){return y0=Zge,y0}function Me(...e){y0.warn(...e)}function Ivt(...e){y0.debug(...e)}function b0(e){if(e&&ki(e)){for(const t of S8)if(t in e)return!0}return!1}const Jge=["january","february","march","april","may","june","july","august","september","october","november","december"],Nvt=Jge.map(e=>e.substr(0,3)),Qge=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Dvt=Qge.map(e=>e.substr(0,3));function Rvt(e){if(l8(e)&&(e=+e),Qr(e))return e>4&&Me(NO("quarter",e)),e-1;throw new Error(NO("quarter",e))}function Fvt(e){if(l8(e)&&(e=+e),Qr(e))return e-1;{const t=e.toLowerCase(),n=Jge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Nvt.indexOf(r);if(i!==-1)return i;throw new Error(NO("month",e))}}function Mvt(e){if(l8(e)&&(e=+e),Qr(e))return e%7;{const t=e.toLowerCase(),n=Qge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Dvt.indexOf(r);if(i!==-1)return i;throw new Error(NO("day",e))}}function _8(e,t){const n=[];if(t&&e.day!==void 0&&Be(e).length>1&&(Me(_vt(e)),e=Yt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?Fvt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?Rvt(e.quarter):e.quarter;n.push(Qr(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?Mvt(e.day):e.day;n.push(Qr(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function Tw(e){const n=_8(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Pvt(e){const n=_8(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function $vt(e){const t=_8(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const eme={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},S8=Be(eme);function Lvt(e){return!!eme[e]}function E8(e){return e.startsWith("utc")}function Bvt(e){return e.substr(3)}const zvt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function A8(e){const t=[];for(const n of S8)tme(e,n)&&t.push(n);return t}function tme(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function jvt(e,t,{end:n}={end:!1}){const r=cge(t),i=E8(e)?"utc":"";function a(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const s={};for(const u of S8)tme(e,u)&&(s[u]=a(u),o=u);return n&&(s[o]+="+1"),Pvt(s)}function nme(e){if(!e)return;const t=A8(e);return`timeUnitSpecifier(${yw(t)}, ${yw(zvt)})`}function Uvt(e,t,n){if(!e)return;const r=nme(e);return`${n||E8(e)?"utc":"time"}Format(${t}, ${r})`}function Va(e){if(!e)return;let t;return Xt(e)?t={unit:e}:ki(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),E8(t.unit)&&(t.utc=!0,t.unit=Bvt(t.unit)),t}function Wvt(e){const t=Va(e),{utc:n}=t,r=dt(t,["utc"]);return r.unit?(n?"utc":"")+Be(r).map(i=>pr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Be(r).map(i=>pr(`_${i}_${r[i]}`)).join("")}function Et(e){return e&&!!e.signal}function Yd(e){return!!e.step}function Vvt(e){return vt(e)?!1:"fields"in e&&!("data"in e)}function qvt(e){return vt(e)?!1:"fields"in e&&"data"in e}function Zd(e){return vt(e)?!1:"field"in e&&"data"in e}const Hvt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},Gvt=Be(Hvt),Kvt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},C8=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Xvt(e){return e==null?void 0:e.selection}function k8(e){return e&&!!e.field&&e.equal!==void 0}function rme(e){return e&&!!e.field&&e.lt!==void 0}function ime(e){return e&&!!e.field&&e.lte!==void 0}function ame(e){return e&&!!e.field&&e.gt!==void 0}function ome(e){return e&&!!e.field&&e.gte!==void 0}function T8(e){if(e&&e.field){if(vt(e.range)&&e.range.length===2)return!0;if(Et(e.range))return!0}return!1}function O8(e){return e&&!!e.field&&(vt(e.oneOf)||vt(e.in))}function Yvt(e){return e&&!!e.field&&e.valid!==void 0}function sme(e){return O8(e)||k8(e)||T8(e)||rme(e)||ame(e)||ime(e)||ome(e)}function Dl(e,t){return G8(e,{timeUnit:t,wrapTime:!0})}function Zvt(e,t){return e.map(n=>Dl(n,t))}function ume(e,t=!0){var n;const{field:r}=e,i=(n=Va(e.timeUnit))===null||n===void 0?void 0:n.unit,a=i?"time("+jvt(i,r)+")":Ue(e,{expr:"datum"});if(k8(e))return a+"==="+Dl(e.equal,i);if(rme(e)){const o=e.lt;return`${a}<${Dl(o,i)}`}else if(ame(e)){const o=e.gt;return`${a}>${Dl(o,i)}`}else if(ime(e)){const o=e.lte;return`${a}<=${Dl(o,i)}`}else if(ome(e)){const o=e.gte;return`${a}>=${Dl(o,i)}`}else{if(O8(e))return`indexof([${Zvt(e.oneOf,i).join(",")}], ${a}) !== -1`;if(Yvt(e))return I8(a,e.valid);if(T8(e)){const{range:o}=e,s=Et(o)?{signal:`${o.signal}[0]`}:o[0],u=Et(o)?{signal:`${o.signal}[1]`}:o[1];if(s!==null&&u!==null&&t)return"inrange("+a+", ["+Dl(s,i)+", "+Dl(u,i)+"])";const l=[];return s!==null&&l.push(`${a} >= ${Dl(s,i)}`),u!==null&&l.push(`${a} <= ${Dl(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function I8(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Jvt(e){var t;return sme(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Va(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const x0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},og=x0.quantitative,N8=x0.ordinal,w0=x0.temporal,D8=x0.nominal,_0=x0.geojson,Qvt=Be(x0);function e0t(e){if(e)switch(e=e.toLowerCase(),e){case"q":case og:return"quantitative";case"t":case w0:return"temporal";case"o":case N8:return"ordinal";case"n":case D8:return"nominal";case _0:return"geojson"}}const ti={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},R8={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},t0t=Be(R8);function n0t(e,t){const n=R8[e],r=R8[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const r0t={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function lme(e){return r0t[e]}const cme=["linear","log","pow","sqrt","symlog","time","utc"],i0t=eg(cme),a0t=["linear","log","pow","sqrt","symlog"],o0t=eg(a0t);function s0t(e){return e in o0t}const u0t=["quantile","quantize","threshold"],l0t=eg(u0t),c0t=cme.concat(["quantile","quantize","threshold","sequential","identity"]),f0t=eg(c0t),d0t=["ordinal","bin-ordinal","point","band"],h0t=eg(d0t);function xo(e){return e in h0t}function As(e){return e in f0t}function Su(e){return e in i0t}function DO(e){return e in l0t}const p0t={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function g0t(e){return!Xt(e)&&!!e.name}function fme(e){return e==null?void 0:e.selection}function m0t(e){return e&&e.unionWith}const v0t={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},y0t=dt(v0t,["type","domain","range","scheme"]),b0t=Be(y0t);x0t();function dme(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!bt(["point","band","identity"],e);case"bins":return!bt(["point","band","identity","ordinal"],e);case"round":return Su(e)||e==="band"||e==="point";case"padding":return Su(e)||bt(["point","band"],e);case"paddingOuter":case"align":return bt(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Su(e);case"nice":return Su(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return As(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function hme(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return v0(e)?void 0:avt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function pme(e,t){return bt([N8,D8],t)?e===void 0||xo(e):t===w0?bt([ti.TIME,ti.UTC,void 0],e):t===og?bt([ti.LOG,ti.POW,ti.SQRT,ti.SYMLOG,ti.QUANTILE,ti.QUANTIZE,ti.THRESHOLD,ti.LINEAR,void 0],e):!0}function gme(e,t){if(!Xd(e))return!1;switch(e){case wr:case hi:case wu:case El:return Su(t)||bt(["band","point"],t);case qc:case qd:case Hc:case Wd:case Vd:case rg:return Su(t)||DO(t)||bt(["band","point","ordinal"],t);case yo:case kl:case Tl:return t!=="band";case Hd:return t==="ordinal"||DO(t);case bo:return t==="ordinal"}}function x0t(){var e;const t={};for(const n of Tge)for(const r of Qvt)for(const i of t0t){const a=w0t(n,r);gme(n,i)&&pme(i,r)&&(t[a]=(e=t[a])!==null&&e!==void 0?e:[],t[a].push(i))}return t}function w0t(e,t){return e+"_"+t}function F8(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:a}=e,o=vme(e);return We(n)&&!Sge(n.aggregate)&&i&&Su(i.get("type"))&&i.get("zero")===!1?mme({fieldDef:n,channel:t,markDef:r,ref:o,config:a}):o}function mme({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return tg(n.type)||Fn("invalid",n,i)===null?r:[_0t(e,t),r]}function _0t(e,t){const n=M8(e,!0),i=ag(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function M8(e,t=!0){return I8(Xt(e)?e:Ue(e,{expr:"datum"}),!t)}function S0t(e){const{datum:t}=e;return b0(t)?Tw(t):`${JSON.stringify(t)}`}function sg(e,t,n,r){const i={};if(t&&(i.scale=t),Qd(e)){const{datum:a}=e;b0(a)?i.signal=Tw(a):Et(a)?i.signal=a.signal:i.value=a}else i.field=Ue(e,n);if(r){const{offset:a,band:o}=r;a&&(i.offset=a),o&&(i.band=o)}return i}function RO({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=Ue(t,{expr:o,suffix:i}),u=n!==void 0?Ue(n,{expr:o}):Ue(t,{suffix:"end",expr:o}),l={};if(a===0||a===1){l.scale=e;const c=a===0?s:u;l.field=c}else{const c=`${a} * ${s} + ${1-a} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function vme({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l,band:c}){var f;if(t){if(It(t)){if(Xo(t)){c=c??Nw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:g}=t;if(er(h)||c&&p&&g===w0)return s&&s.impute?sg(t,a,{binSuffix:"mid"},{offset:u}):c?RO({scaleName:a,fieldOrDatumDef:t,band:c,offset:u}):sg(t,a,Dw(t,e)?{binSuffix:"range"}:{},{offset:u});if(Wa(h)){if(We(n))return RO({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});Me(Yge(e===wr?xu:Sl))}}const d=o==null?void 0:o.get("type");return sg(t,a,xo(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Gc(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},Ow(e,d)),h)}}return Fgt(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Ow(e,t){return bt(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:bt(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:jr(t)}function ug(e){return e&&e!=="number"&&e!=="time"}function yme(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const E0t=" \u2013 ";function P8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(ug(n))return $8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:a});const u=bme(e,r,i);if(jO(e)){const l=C0t(u,We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,a.timeFormat,W8(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ti.UTC);return l?{signal:l}:void 0}if(t=_me(Jd(e),t,a),We(e)&&er(e.bin)){const l=Ue(e,{expr:r,binSuffix:"end"});return{signal:FO(u,l,t,n,a)}}else return t||Jd(e)==="quantitative"?{signal:`${Sme(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function bme(e,t,n){return We(e)?n?`${Ue(e,{expr:t,suffix:"end"})}-${Ue(e,{expr:t,suffix:"start"})}`:Ue(e,{expr:t}):S0t(e)}function $8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=o??bme(e,r,i),We(e)&&er(e.bin)){const s=Ue(e,{expr:r,binSuffix:"end"});return{signal:FO(o,s,t,n,a)}}return{signal:yme(n,o,t)}}function xme(e,t,n,r,i,a){var o;if(!ug(r)){if(jO(e)){const s=We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return A0t(n,s,i,a)}return _me(t,n,i)}}function wme(e,t,n){if(e&&(Et(e)||e==="number"||e==="time"))return e;if(jO(t)&&n!=="time"&&n!=="utc")return"time"}function _me(e,t,n){if(Xt(t))return t;if(e===og)return n.numberFormat}function A0t(e,t,n,r){return e||(t?{signal:nme(t)}:r?void 0:n.timeFormat)}function Sme(e,t){return`format(${e}, "${t||""}")`}function Eme(e,t,n,r){var i;return ug(n)?yme(n,e,t):Sme(e,(i=Xt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function FO(e,t,n,r,i){const a=Eme(e,n,r,i),o=Eme(t,n,r,i);return`${I8(e,!1)} ? "null" : ${a} + "${E0t}" + ${o}`}function C0t(e,t,n,r,i){return!t||n?(n=Xt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):Uvt(t,e,i)}const MO="min",k0t={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Ame(e){return e in k0t}function Cme(e){return!!e&&!!e.encoding}function Rl(e){return!!e&&(e.op==="count"||!!e.field)}function kme(e){return!!e&&vt(e)}function Iw(e){return"row"in e||"column"in e}function L8(e){return!!e&&"header"in e}function PO(e){return"facet"in e}function T0t(e){return e.selection}function O0t(e){return e&&!Xt(e)&&"repeat"in e}function Tme(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Ome(e){return Xo(e)&&"sort"in e}function Nw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(It(t)&&t.band!==void 0)return t.band;if(We(t)){const{timeUnit:s,bin:u}=t;if(s&&!n)return o?fg("timeUnitBandPosition",r,a):bge(r.type)?fg("timeUnitBand",r,a):0;if(er(u))return bge(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function B8(e,t,n,r,i,a){return er(t.bin)||t.timeUnit&&Xo(t)&&t.type==="temporal"?!!Nw({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a}):!1}function z8(e){return!!e&&"condition"in e}function $O(e){const t=e&&e.condition;return!!t&&!vt(t)&&We(t)}function j8(e){const t=e&&e.condition;return!!t&&!vt(t)&&It(t)}function I0t(e){const t=e&&e.condition;return!!t&&(vt(t)||Gc(t))}function We(e){return!!e&&(!!e.field||e.aggregate==="count")}function Jd(e){return e&&e.type}function Qd(e){return!!e&&"datum"in e}function Fl(e){return Xo(e)&&Rme(e)||U8(e)}function U8(e){return Qd(e)&&Qr(e.datum)}function It(e){return We(e)||Qd(e)}function Xo(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Gc(e){return e&&"value"in e&&"value"in e}function W8(e){return!!e&&("scale"in e||"sort"in e)}function V8(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Ime(e){return!!e&&"legend"in e}function Nme(e){return!!e&&("format"in e||"formatType"in e)}function N0t(e){return"op"in e}function Ue(e,t={}){var n,r,i;let a=e.field;const o=t.prefix;let s=t.suffix,u="";if(D0t(e))a=qgt("count");else{let l;if(!t.nofn)if(N0t(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;er(c)?(l=Fge(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?ng(f)?(u=`["${a}"]`,a=`argmax_${f.argmax}`):Ud(f)?(u=`["${a}"]`,a=`argmin_${f.argmin}`):l=String(f):d&&(l=Wvt(d),s=(!bt(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(a=a?`${l}_${a}`:l)}return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),t.forAs?fge(a):t.expr?jgt(a,t.expr)+u:jd(a)+u}function Dme(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return We(e)&&!!e.bin;case"temporal":return!1}throw new Error(Vge(e.type))}function Rme(e){return!Dme(e)}function D0t(e){return e.aggregate==="count"}function R0t(e,t){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=e;if(o==="count")return t.countTitle;if(er(i))return`${r} (binned)`;if(a){const s=(n=Va(a))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${A8(s).join("-")})`}else if(o)return ng(o)?`${r} for max ${o.argmax}`:Ud(o)?`${r} for min ${o.argmin}`:`${hO(o)} of ${r}`;return r}function F0t(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(ng(t))return`${i} for argmax(${t.argmax})`;if(Ud(t))return`${i} for argmin(${t.argmin})`;const a=Va(r),o=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||er(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const Fme=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return F0t(e);default:return R0t(e,t)}};let Mme=Fme;function Pme(e){Mme=e}function M0t(){Pme(Fme)}function lg(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,a;const s=((i=q8(e))!==null&&i!==void 0?i:{}).title;if(!We(e))return s;const u=e,l=r?$me(u,t):void 0;return n?ei(s,u.title,l):(a=s??u.title)!==null&&a!==void 0?a:l}function q8(e){if(V8(e)&&e.axis)return e.axis;if(Ime(e)&&e.legend)return e.legend;if(L8(e)&&e.header)return e.header}function $me(e,t){return Mme(e,t)}function LO(e){var t;if(Nme(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=q8(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function P0t(e,t){if(e.timeUnit)return"temporal";if(er(e.bin))return"quantitative";switch(TO(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Ml(e){if(We(e))return e;if($O(e))return e.condition}function pi(e){if(It(e))return e;if(j8(e))return e.condition}function H8(e,t,n){if(Xt(e)||Qr(e)||vw(e)){const r=Xt(e)?"string":Qr(e)?"number":"boolean";return Me(Kmt(t,r,e)),{value:e}}return It(e)?BO(e,t,n):j8(e)?Object.assign(Object.assign({},e),{condition:BO(e.condition,t,n)}):e}function BO(e,t,n){if(Nme(e)){const{format:r,formatType:i}=e,a=dt(e,["format","formatType"]);if(ug(i)&&!n.customFormatTypes)return Me(Wge(t)),BO(a,t,n)}else{const r=V8(e)?"axis":Ime(e)?"legend":L8(e)?"header":null;if(r&&e[r]){const i=e[r],{format:a,formatType:o}=i,s=dt(i,["format","formatType"]);if(ug(o)&&!n.customFormatTypes)return Me(Wge(t)),BO(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return We(e)?Lme(e,t):$0t(e)}function $0t(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Qr(n)?"quantitative":Xt(n)?"nominal":b0(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function Lme(e,t){const{aggregate:n,timeUnit:r,bin:i,field:a}=e,o=Object.assign({},e);if(n&&!p8(n)&&!ng(n)&&!Ud(n)&&(Me(Ymt(n)),delete o.aggregate),r&&(o.timeUnit=Va(r)),a&&(o.field=`${a}`),er(i)&&(o.bin=zO(i,t)),Wa(i)&&!Nl(t)&&Me(`Channel ${t} should not be used with "binned" bin.`),Xo(o)){const{type:s}=o,u=e0t(s);s!==u&&(o.type=u),s!=="quantitative"&&Sge(n)&&(Me(Xmt(s,n)),o.type="quantitative")}else if(!Ige(t)){const s=P0t(o,t);Me(Zmt(t,s)),o.type=s}if(Xo(o)){const{compatible:s,warning:u}=L0t(o,t);s||Me(u)}if(Ome(o)&&Xt(o.sort)){const{sort:s}=o;if(Ame(s))return Object.assign(Object.assign({},o),{sort:{encoding:s}});const u=s.substr(1);if(s.charAt(0)==="-"&&Ame(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(L8(o)){const{header:s}=o,{orient:u}=s,l=dt(s,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:s.labelOrient||u,titleOrient:s.titleOrient||u})})}return o}function zO(e,t){return vw(e)?{maxbins:Mge(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:Mge(t)}):e}const cg={compatible:!0};function L0t(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case jc:case Uc:case wO:return Rme(e)?{compatible:!1,warning:evt(t)}:cg;case wr:case hi:case yo:case kl:case Tl:case Ew:case Cw:case _O:case ig:case SO:case EO:case rg:case wu:case El:case AO:return cg;case Cl:case _s:case Al:case _u:return n!==og?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:cg;case Hc:case Wd:case Vd:case qd:case qc:case Vc:case Wc:case xu:case Sl:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:cg;case Hd:return bt(["ordinal","nominal"],e.type)?cg:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case bo:return bt(["ordinal","nominal","geojson"],e.type)?cg:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case Aw:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:cg}}function jO(e){const{formatType:t}=LO(e);return t==="time"||!t&&B0t(e)}function B0t(e){return e&&(e.type==="temporal"||We(e)&&!!e.timeUnit)}function G8(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=t&&((a=Va(t))===null||a===void 0?void 0:a.unit);let s=o||n==="temporal",u;return Et(e)?u=e.signal:b0(e)?(s=!0,u=Tw(e)):(Xt(e)||Qr(e))&&s&&(u=`datetime(${JSON.stringify(e)})`,Lvt(o)&&(Qr(e)&&e<1e4||Xt(e)&&isNaN(Date.parse(e)))&&(u=Tw({[o]:e}))),u?r&&s?`time(${u})`:u:i?void 0:JSON.stringify(e)}function Bme(e,t){const{type:n}=e;return t.map(r=>{const i=G8(r,{timeUnit:We(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Dw(e,t){return er(e.bin)?Xd(t)&&bt(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function zme(e){const{anchor:t,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=dt(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),v=xw(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function eh(e){return Xt(e)||vt(e)&&Xt(e[0])}function jr(e){return Et(e)?e:e!==void 0?{value:e}:void 0}function jme(e){return Et(e)?e.signal:gn(e.value)}function Rw(e){return Et(e)?e.signal:e==null?null:gn(e)}function z0t(e,t,n){for(const r of n){const i=fg(r,t.markDef,t.config);i!==void 0&&(e[r]=jr(i))}return e}function Ume(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Fn(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:a&&(!i||i===e)?void 0:fg(e,t,n,r)}function fg(e,t,n,{vgChannel:r}={}){return ei(r?UO(e,t,n.style):void 0,UO(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function UO(e,t,n){return Wme(e,Ume(t),n)}function Wme(e,t,n){t=zr(t);let r;for(const i of t){const a=n[i];a&&a[e]!==void 0&&(r=a[e])}return r}function Vme(e,t){return zr(e).reduce((n,r)=>{var i;return n.field.push(Ue(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function qme(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(bw(i,r))return;n.push(r)}),n}function Hme(e,t){return bw(e,t)||!t?e:e?[...zr(e),...zr(t)].join(", "):t}function Gme(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((eh(n)||Et(n))&&(eh(r)||Et(r)))return{explicit:e.explicit,value:Hme(n,r)};if(eh(n)||Et(n))return{explicit:e.explicit,value:n};if(eh(r)||Et(r))return{explicit:e.explicit,value:r};if(!eh(n)&&!Et(n)&&!eh(r)&&!Et(r))return{explicit:e.explicit,value:qme(n,r)};throw new Error("It should never reach here")}function dg(e,t){const n=e&&e[t];return n?vt(n)?ww(n,r=>!!r.field):We(n)||$O(n):!1}function K8(e){return ww(Tge,t=>{if(dg(e,t)){const n=e[t];if(vt(n))return ww(n,r=>!!r.aggregate);{const r=Ml(n);return r&&!!r.aggregate}}return!1})}function X8(e,t){const n=[],r=[],i=[],a=[],o={};return Y8(e,(s,u)=>{if(We(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=dt(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=q8(s),g=p&&p.title;let m=Ue(s,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:lg(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(ng(c)?(y="argmax",m=Ue({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):Ud(c)?(y="argmin",m=Ue({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),a.push(b)}}else if(n.push(m),Xo(s)&&er(f)){if(r.push({bin:f,field:l,as:m}),n.push(Ue(s,{binSuffix:"end"})),Dw(s,u)&&n.push(Ue(s,{binSuffix:"range"})),Nl(u)){const y={field:m+"_end"};o[u+"2"]=y}v.bin="binned",Ige(u)||(v.type=og)}else if(d){i.push({timeUnit:d,field:l,as:m});const y=Xo(s)&&s.type!==w0&&"time";y&&(u===Ew||u===ig?v.formatType=y:Tmt(u)?v.legend=Object.assign({formatType:y},v.legend):Nl(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}o[u]=v}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function j0t(e,t,n){const r=Imt(t,n);if(r){if(r==="binned"){const i=e[t===xu?wr:hi];return!!(We(i)&&We(e[t])&&Wa(i.bin))}}else return!1;return!0}function U0t(e,t,n){const r=t.type;return Be(e).reduce((i,a)=>{if(!Oge(a))return Me(Qmt(a)),i;const o=e[a];if(a==="angle"&&r==="arc"&&!e.theta&&(Me(Gmt),a=wu),!j0t(e,a,r))return Me(IO(a,r)),i;if(a===qc&&r==="line"){const s=Ml(e[a]);if(s==null?void 0:s.aggregate)return Me(Jmt),i}if(a===yo&&(t.filled?"fill"in e:"stroke"in e))return Me(qge("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(a===Cw||a===Aw&&!vt(o)&&!Gc(o)||a===ig&&vt(o))o&&(i[a]=zr(o).reduce((s,u)=>(We(u)?s.push(Lme(u,a)):Me(x8(u,a)),s),[]));else{if(a===ig&&o===null)i[a]=null;else if(!We(o)&&!Qd(o)&&!Gc(o)&&!z8(o)&&!Et(o))return Me(x8(o,a)),i;i[a]=H8(o,a,n)}return i},{})}function W0t(e){const t=[];for(const n of Be(e))if(dg(e,n)){const r=e[n],i=zr(r);for(const a of i)We(a)?t.push(a):$O(a)&&t.push(a.condition)}return t}function Y8(e,t,n){if(!!e)for(const r of Be(e)){const i=e[r];if(vt(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function Kme(e,t,n,r){return e?Be(e).reduce((i,a)=>{const o=e[a];return vt(o)?o.reduce((s,u)=>t.call(r,s,u,a),i):t.call(r,i,o,a)},n):n}function Xme(e,t){return Be(t).reduce((n,r)=>{switch(r){case wr:case hi:case SO:case AO:case EO:case xu:case Sl:case wu:case Vc:case El:case Wc:case Al:case Cl:case _u:case _s:case Ew:case bo:case rg:case ig:return n;case Aw:if(e==="line"||e==="trail")return n;case Cw:case _O:{const i=t[r];if(vt(i)||We(i))for(const a of zr(i))a.aggregate||n.push(Ue(a,{}));return n}case qc:if(e==="trail")return n;case yo:case kl:case Tl:case Hc:case Wd:case Vd:case Hd:case qd:{const i=Ml(t[r]);return i&&!i.aggregate&&n.push(Ue(i,{})),n}}},[])}function V0t(e){const{tooltip:t}=e,n=dt(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(vt(t)){for(const a of t)a.aggregate?(r||(r=[]),r.push(a)):(i||(i=[]),i.push(a));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return vt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function Z8(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:a,titlePrefix:o})=>{const s=r?` of ${t.field}`:"";return{field:a+t.field,type:t.type,title:Et(o)?{signal:o+`"${escape(s)}"`}:o+s}}),...W0t(n)]}}function Yme(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:ei(n,r)}function J8(e,t,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=Yme(n);return Zme(e,s,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),a!==void 0?{scale:a}:{}),o!==void 0?{axis:o}:{})},Xt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function Zme(e,t,n,r,i){const{clip:a,color:o,opacity:s}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),_l(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),vw(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function Jme(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:WO(a,n),continuousAxisChannelDef2:WO(o,n),continuousAxisChannelDefError:WO(s,n),continuousAxisChannelDefError2:WO(u,n),continuousAxis:i}}function WO(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=dt(e,["aggregate"]);return n!==t&&Me(Avt(n,t)),r}else return e}function Qme(e,t){const{mark:n,encoding:r}=e,{x:i,y:a}=r;if(Fl(i)){if(Fl(a)){const o=We(i)&&i.aggregate,s=We(a)&&a.aggregate;if(!o&&s===t)return"vertical";if(!s&&o===t)return"horizontal";if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");return _l(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Fl(a))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const VO="boxplot",q0t=["box","median","outliers","rule","ticks"],H0t=new xO(VO,tve);function eve(e){return Qr(e)?"tukey":e}function tve(e,{config:t}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=_l(i)?i:{type:i};o&&Me(zge("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Fn("size",l,t),d=eve(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=G0t(e,c,t),{color:S,size:A}=y,_=dt(y,["color","size"]),E=G=>J8(l,g,p,G,t.boxplot),C=E(_),k=E(y),T=E(Object.assign(Object.assign({},_),A?{size:A}:{})),I=Z8([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),N={type:"tick",color:"black",opacity:1,orient:b,invalid:null},O=d==="min-max"?I:Z8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),D=[...C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...C({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...C({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],L=[...d!=="tukey"?D:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:I}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ki(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:I})];let W;if(d!=="min-max"){const G=`datum["lower_box_${p.field}"]`,K=`datum["upper_box_${p.field}"]`,ee=`(${K} - ${G})`,ce=`${G} - ${c} * ${ee}`,he=`${K} + ${c} * ${ee}`,Oe=`datum["${p.field}"]`,Te={joinaggregate:nve(p.field),groupby:m};let Re;d==="tukey"&&(Re={transform:[{filter:`(${ce} <= ${Oe}) && (${Oe} <= ${he})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:D});const me=dt(_,["tooltip"]),{scale:P,axis:F}=p,V=Yme(p),ae=Zme(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Oe} < ${ce}) || (${Oe} > ${he})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},V!==void 0?{title:V}:{}),P!==void 0?{scale:P}:{}),F!==void 0?{axis:F}:{})},me),w?{tooltip:w}:{})})[0];ae&&Re?W={transform:[Te],layer:[ae,Re]}:ae?(W=ae,W.transform.unshift(Te)):Re&&(W=Re,W.transform.unshift(Te))}return W?Object.assign(Object.assign({},u),{layer:[W,{transform:h,layer:L}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:L})}function nve(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function G0t(e,t,n){const r=Qme(e,VO),{continuousAxisChannelDef:i,continuousAxis:a}=Jme(e,r,VO),o=i.field,s=eve(t),u=[...nve(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(s==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(s==="min-max"?"upper_whisker_":"max_")+o}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=a;c[f];const d=dt(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=V0t(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=X8(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...u],groupby:y},...l],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const Q8="errorbar",K0t=["ticks","rule"],X0t=new xO(Q8,rve);function rve(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:l}=ive(e,Q8,t),c=J8(s,i,r,a,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function Y0t(e,t){const{encoding:n}=e;if(Z0t(n))return{orient:Qme(e,t),inputType:"raw"};const r=J0t(n),i=Q0t(n),a=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(It(s)&&It(u))throw new Error(`${t} cannot have both x2 and y2`);if(It(s)){if(Fl(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(It(u)){if(Fl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(It(u)&&!It(s))throw new Error(`${t} cannot have xError2 without xError`);if(It(c)&&!It(l))throw new Error(`${t} cannot have yError2 without yError`);if(It(s)&&It(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(It(s)){if(Fl(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(It(l)){if(Fl(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Z0t(e){return(It(e.x)||It(e.y))&&!It(e.x2)&&!It(e.y2)&&!It(e.xError)&&!It(e.xError2)&&!It(e.yError)&&!It(e.yError2)}function J0t(e){return It(e.x2)||It(e.y2)}function Q0t(e){return It(e.xError)||It(e.xError2)||It(e.yError)||It(e.yError2)}function ive(e,t,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=_l(i)?i:{type:i};o&&Me(zge(t));const{orient:c,inputType:f}=Y0t(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=Jme(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=eyt(l,d,h,p,g,f,t,n),w=a,S=m;w[S];const A=m==="x"?"x2":"y2";w[A];const _=m==="x"?"xError":"yError";w[_];const E=m==="x"?"xError2":"yError2";w[E];const C=dt(w,[typeof S=="symbol"?S:S+"",typeof A=="symbol"?A:A+"",typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+""]),{bins:k,timeUnits:T,aggregate:I,groupby:N,encoding:O}=X8(C,n),D=[...I,...v],L=f!=="raw"?[]:N,W=Z8(b,d,O,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...k,...T,...D.length===0?[]:[{aggregate:D,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:W}}function eyt(e,t,n,r,i,a,o,s){let u=[],l=[];const c=t.field;let f,d=!1;if(a==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Me(Evt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:hO(h)},{fieldPrefix:"upper_",titlePrefix:ave(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:ave(h,p,"-")}],d=!0;else{e.center&&e.extent&&Me(Cvt(e.extent,o));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:lg({field:c,aggregate:v,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:lg({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:lg({field:c,aggregate:g,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Me(Svt(e.center,e.extent)),a==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):a==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:m0(m0(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function ave(e,t,n){return hO(e)+" "+n+" "+t}const e9="errorband",tyt=["band","borders"],nyt=new xO(e9,ove);function ove(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=ive(e,e9,t),l=o,c=J8(l,i,r,a,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?Me(Xge("interpolate")):l.tension&&Me(Xge("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const sve={};function t9(e,t,n){const r=new xO(e,t);sve[e]={normalizer:r,parts:n}}function ryt(){return Be(sve)}t9(VO,tve,q0t),t9(Q8,rve,K0t),t9(e9,ove,tyt);const iyt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],uve=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],ayt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},oyt={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},syt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},S0="_vgsid_",uyt={single:{on:"click",fields:[S0],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[S0],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function n9(e){return!!e&&(e==="legend"||!!e.legend)}function r9(e){return n9(e)&&ki(e)}function lyt(e){return qO(e)||a9(e)||i9(e)}function i9(e){return"concat"in e}function qO(e){return"vconcat"in e}function a9(e){return"hconcat"in e}function Pl(e){return ki(e)&&e.step!==void 0}function lve(e){return e.view||e.width||e.height}const cve=20,cyt={align:1,bounds:1,center:1,columns:1,spacing:1},fyt=Be(cyt);function dyt(e,t,n){var r,i;const a=n[t],o={},{spacing:s,columns:u}=a;s!==void 0&&(o.spacing=s),u!==void 0&&(PO(e)&&!Iw(e.facet)||i9(e))&&(o.columns=u),qO(e)&&(o.columns=1);for(const l of fyt)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Qr(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else o[l]=e[l];return o}function o9(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function HO(e,t){const n=Fw(e,t);return Pl(n)?n.step:s9}function Fw(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return ei(r,{step:e.step})}const s9=20,hyt={continuousWidth:200,continuousHeight:200,step:s9},pyt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:hyt,mark:rmt,arc:{},area:{},bar:amt,circle:{},geoshape:{},image:{},line:{},point:{},rect:omt,rule:{color:"black"},square:{},text:{color:"black"},tick:smt,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:p0t,projection:{},legend:oyt,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:uyt,style:{},title:{},facet:{spacing:cve},concat:{spacing:cve}},Kc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],fve={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},dve={blue:Kc[0],orange:Kc[1],red:Kc[2],teal:Kc[3],green:Kc[4],yellow:Kc[5],purple:Kc[6],pink:Kc[7],brown:Kc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function gyt(e={}){return{signals:[{name:"color",value:ki(e)?Object.assign(Object.assign({},dve),e):dve}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function myt(e){return{signals:[{name:"fontSize",value:ki(e)?Object.assign(Object.assign({},fve),e):fve}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function vyt(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function hve(e={}){const{color:t,font:n,fontSize:r}=e,i=dt(e,["color","font","fontSize"]);return nge({},pyt,n?vyt(n):{},t?gyt(t):{},r?myt(r):{},i||{})}const yyt=["view",...xge],byt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],xyt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},nmt);function wyt(e){e=Yt(e);for(const t of byt)delete e[t];if(e.axis)for(const t in e.axis)c8(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of iyt)delete e.legend[t];if(e.mark){for(const t of wge)delete e.mark[t];e.mark.tooltip&&ki(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of yyt){for(const r of wge)delete e[t][r];const n=xyt[t];if(n)for(const r of n)delete e[t][r];Syt(e,t)}for(const t of ryt())delete e[t];_yt(e);for(const t in e)ki(e[t])&&Zn(e[t])&&delete e[t];return Zn(e)?void 0:e}function _yt(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=zme(e.title);Zn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Zn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Zn(r)?delete e.title:e.title=r}function Syt(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const a=Object.assign(Object.assign({},i),e.style[n??t]);Zn(a)||(e.style[n??t]=a),r||delete e[t]}function GO(e){return"layer"in e}function Eyt(e){return"repeat"in e}function Ayt(e){return!vt(e.repeat)&&e.repeat.layer}class pve{map(t,n){return PO(t)?this.mapFacet(t,n):Eyt(t)?this.mapRepeat(t,n):a9(t)?this.mapHConcat(t,n):qO(t)?this.mapVConcat(t,n):i9(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(GO(t))return this.mapLayer(t,n);if(zc(t))return this.mapUnit(t,n);throw new Error(b8(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=dt(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(a=>this.map(a,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Cyt={zero:1,center:1,normalize:1};function kyt(e){return e in Cyt}const Tyt=new Set([mge,mO,gO,bO,yO,d8,h8,vO,vge,f8]),Oyt=new Set([mO,gO,mge]);function gve(e,t){var n,r;const i=t==="x"?"y":"radius",a=e[t],o=e[i];if(We(a)&&We(o))if(Jd(a)==="quantitative"&&Jd(o)==="quantitative"){if(a.stack)return t;if(o.stack)return i;const s=We(a)&&!!a.aggregate,u=We(o)&&!!o.aggregate;if(s!==u)return s?t:i;{const l=(n=a.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Jd(a)==="quantitative")return t;if(Jd(o)==="quantitative")return i}else{if(Jd(a)==="quantitative")return t;if(Jd(o)==="quantitative")return i}}function Iyt(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function mve(e,t,n={}){const r=_l(e)?e.type:e;if(!Tyt.has(r))return null;const i=gve(t,"x")||gve(t,"theta");if(!i)return null;const a=t[i],o=We(a)?Ue(a,{}):void 0;let s=Iyt(i),u=t[s],l=We(u)?Ue(u,{}):void 0;l===o&&(l=void 0,u=void 0,s=void 0);const c=Amt.reduce((d,h)=>{if(h!=="tooltip"&&dg(t,h)){const p=t[h];for(const g of zr(p)){const m=Ml(g);if(m.aggregate)continue;const v=Ue(m,{});(!v||v!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(a.stack!==void 0?vw(a.stack)?f=a.stack?"zero":null:f=a.stack:c.length>0&&Oyt.has(r)&&(f="zero"),!f||!kyt(f)||K8(t)&&c.length===0)return null;if(a.scale&&a.scale.type&&a.scale.type!==ti.LINEAR){if(n.disallowNonLinearStack)return null;Me(xvt(a.scale.type))}return It(t[Ol(i)])?(a.stack!==void 0&&Me(bvt(i)),null):(We(a)&&a.aggregate&&!bt(hmt,a.aggregate)&&Me(wvt(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:a.impute===null?!1:tg(r),stackBy:c,offset:f})}function Nyt(e){const t=dt(e,["point","line"]);return Be(t).length>1?t:t.type}function Dyt(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Bc(e[t],["point","line"])}));return e}function u9(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ki(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ki(t.point)?t.point:{}:void 0}function vve(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Ryt{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(zc(t)){const{mark:r,encoding:i}=t,a=_l(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!u9(a,n[a.type],i);case"area":return!!u9(a,n[a.type],i)||!!vve(a,n[a.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:a,projection:o,encoding:s,mark:u}=t,l=dt(t,["selection","projection","encoding","mark"]),c=_l(u)?u:{type:u},f=u9(c,i[c.type],s),d=c.type==="area"&&vve(c,i[c.type]),h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:Nyt(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:Bc(s,["shape"])})],p=mve(c,s);let g=s;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},s),{[m]:Object.assign(Object.assign({},s[m]),v?{stack:v}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},xw(c,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},xw(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:Dyt(i)}))}}class Fyt{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(zc(t)&&t.encoding)for(const r of Es){const i=t.encoding[r];if(i&&It(i)&&((n=i==null?void 0:i.scale)===null||n===void 0?void 0:n.rangeStep))return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const a of Es){const o=Il(a),s=i[a];if(s&&It(s)&&((n=s==null?void 0:s.scale)===null||n===void 0?void 0:n.rangeStep)){const{scale:u}=s,l=dt(s,["scale"]),c=u,f=dt(c,["rangeStep"]);r[o]={step:u.rangeStep},Me(ivt),i=Object.assign(Object.assign({},i),{[a]:Object.assign(Object.assign({},l),Zn(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function Myt(e,t){return t?Iw(e)?wve(e,t):yve(e,t):e}function l9(e,t){return t?wve(e,t):e}function c9(e,t,n){const r=t[e];if(O0t(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Me(zmt(r.repeat));return}return t}function yve(e,t){if(e=c9("field",e,t),e!==void 0){if(e===null)return null;if(Ome(e)&&Rl(e.sort)){const n=c9("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function bve(e,t){if(We(e))return yve(e,t);{const n=c9("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function xve(e,t){if(It(e)){const n=bve(e,t);if(n)return n;if(z8(e))return{condition:e.condition}}else{if(j8(e)){const n=bve(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):dt(e,["condition"])}return e}}function wve(e,t){const n={};for(const r in e)if(Qp(e,r)){const i=e[r];if(vt(i))n[r]=i.map(a=>xve(a,t)).filter(a=>a);else{const a=xve(i,t);a!==void 0&&(n[r]=a)}}return n}class Pyt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(zc(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of Smt){const a=ag(i),o=n[a];if(n[i]&&(We(o)&&!Wa(o.bin)||Qd(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Me(nvt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class $yt extends pve{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[H0t,X0t,nyt,new Ryt,new Pyt,new Fyt]}map(t,n){if(zc(t)){const r=dg(t.encoding,jc),i=dg(t.encoding,Uc),a=dg(t.encoding,wO);if(r||i||a)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,a=Object.assign(Object.assign({},t),{encoding:l9(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,n.config))return s.run(a,n,o);return a}mapRepeat(t,n){return Ayt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,a=dt(t,["repeat","spec"]),{row:o,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},a),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${pr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:a,data:o}=t,s=dt(t,["repeat","spec","data"]);!vt(i)&&t.columns&&(t=Bc(t,["columns"]),Me(jge("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!vt(i)&&i.row||[l?l.row:null],d=!vt(i)&&i.column||[l?l.column:null],h=vt(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(a.name||"")+c+"child__"+(vt(i)?`${pr(g)}`:(i.row?`row_${pr(m)}`:"")+(i.column?`column_${pr(v)}`:"")),x=this.map(a,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,u.push(Bc(x,["data"]))}const p=vt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=a.data)!==null&&r!==void 0?r:o,align:"all"},s),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return Iw(r)&&t.columns&&(t=Bc(t,["columns"]),Me(jge("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:a,parentProjection:o,config:s}=n,u=Sve({parentProjection:o,projection:i}),l=_ve({parentEncoding:a,encoding:l9(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:a,facet:o}=r,s=dt(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,g=dt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:a,facet:o},n),y=l9(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:a,facet:o}=t;if(i||a){o&&Me(tvt([...i?[jc]:[],...a?[Uc]:[]]));const s={},u={};for(const l of[jc,Uc]){const c=t[l];if(c){const f=dt(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=o,f=dt(o,["align","center","spacing","columns"]);return{facetMapping:Myt(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,a=dt(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,u=dt(t,["encoding","projection"]),l=Object.assign(Object.assign({},a),{parentEncoding:_ve({parentEncoding:r,encoding:o}),parentProjection:Sve({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function _ve(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Be(t).reduce((a,o)=>(n[o]&&a.push(o),a),[]);i.length>0&&Me(qmt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return Zn(r)?void 0:r}function Sve(e){const{parentProjection:t,projection:n}=e;return t&&n&&Me(Hmt({parentProjection:t,projection:n})),n??t}function Eve(e,t){t===void 0&&(t=hve(e.config));const n=Byt(e,t),{width:r,height:i}=e,a=zyt(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const Lyt=new $yt;function Byt(e,t={}){return Lyt.map(e,{config:t})}function Ave(e){return Xt(e)?{type:e}:e??{}}function zyt(e,t,n){let{width:r,height:i}=t;const a=zc(e)||GO(e),o={};a?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(Me(Pge("width")),r=void 0),i=="container"&&(Me(Pge("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Ave(n.autosize):{}),Ave(e.autosize));if(s.type==="fit"&&!a&&(Me(Rmt),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&Me($ge("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&Me($ge("height")),!bw(s,{type:"pad"}))return s}function jyt(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Uyt(e){return e?`fit-${CO(e)}`:"fit"}const Wyt=["background","padding"];function Cve(e){return Wyt.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class Xc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Xc(Yt(this.explicit),Yt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return ei(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Be(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function hg(e){return{explicit:!0,value:e}}function Yo(e){return{explicit:!1,value:e}}function kve(e){return(t,n,r,i)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:KO(t,n,r,i)}}function KO(e,t,n,r){return e.explicit&&t.explicit&&Me(dvt(n,r,e.value,t.value)),e}function th(e,t,n,r,i=KO){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:bw(e.value,t.value)?e:i(e,t,n,r)}class Vyt extends Xc{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Mw(e){return"url"in e}function XO(e){return"values"in e}function Tve(e){return"name"in e&&!Mw(e)&&!XO(e)&&!pg(e)}function pg(e){return e&&(Ove(e)||Ive(e)||f9(e))}function Ove(e){return"sequence"in e}function Ive(e){return"sphere"in e}function f9(e){return"graticule"in e}const sa="main",YO="raw";function Nve(e){return"filter"in e}function qyt(e){return(e==null?void 0:e.stop)!==void 0}function Hyt(e){return"lookup"in e}function Gyt(e){return"data"in e}function Kyt(e){return"selection"in e}function Xyt(e){return"pivot"in e}function Yyt(e){return"density"in e}function Zyt(e){return"quantile"in e}function Jyt(e){return"regression"in e}function Qyt(e){return"loess"in e}function ebt(e){return"sample"in e}function tbt(e){return"window"in e}function nbt(e){return"joinaggregate"in e}function rbt(e){return"flatten"in e}function ibt(e){return"calculate"in e}function abt(e){return"bin"in e}function obt(e){return"impute"in e}function sbt(e){return"timeUnit"in e}function ubt(e){return"aggregate"in e}function lbt(e){return"stack"in e}function cbt(e){return"fold"in e}function fbt(e){return e.map(t=>Nve(t)?{filter:fO(t.filter,Jvt)}:t)}function Pw(e,t,n,r){const i=z8(t)&&t.condition,a=r(t);if(i){const s=zr(i).map(u=>{const l=r(u),c=T0t(u)?m0e(e,u.selection):uI(e,u.test);return Object.assign({test:c},l)});return{[n]:[...s,...a!==void 0?[a]:[]]}}else return a!==void 0?{[n]:a}:{}}function d9(e,t="text"){const n=e.encoding[t];return Pw(e,n,t,r=>ZO(r,e.config))}function ZO(e,t,n="datum"){if(e){if(Gc(e))return jr(e.value);if(It(e)){const{format:r,formatType:i}=LO(e);return P8({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Dve(e,t={}){const{encoding:n,markDef:r,config:i,stack:a}=e,o=n.tooltip;if(vt(o))return{tooltip:Fve({tooltip:o},a,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Pw(e,o,"tooltip",u=>{const l=ZO(u,i,s);if(l)return l;if(u===null)return;let c=Fn("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),Xt(c))return{value:c};if(ki(c))return c.content==="encoding"?Fve(n,a,i,t):{signal:s}})}}function Rve(e,t,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(l,c){const f=ag(c),d=Xo(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=zr(lg(d,n,{allowDisabling:!1})).join(", ");let p;if(Nl(c)){const g=c==="x"?"x2":"y2",m=Ml(e[g]);if(Wa(d.bin)&&m){const v=Ue(d,{expr:a}),y=Ue(m,{expr:a}),{format:b,formatType:x}=LO(d);p=FO(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=LO(d);p=P8({fieldOrDatumDef:d,format:v,formatType:y,expr:a,config:n,normalizeStack:!0}).signal}}p=p??ZO(d,n,a).signal,o.push({channel:c,key:h,value:p})}Y8(e,(l,c)=>{We(l)?s(l,c):$O(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[gn(c)]=f);return u}function Fve(e,t,n,{reactiveGeom:r}={}){const i=Rve(e,t,n,{reactiveGeom:r}),a=lge(i).map(({key:o,value:s})=>`${o}: ${s}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function dbt(e){const{markDef:t,config:n}=e,r=Fn("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),hbt(e)),pbt(e))}function hbt(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Fn("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Kvt?{}:{ariaRoleDescription:{value:t}}}function pbt(e){const{encoding:t,markDef:n,config:r,stack:i}=e,a=t.description;if(a)return Pw(e,a,"description",u=>ZO(u,e.config));const o=Fn("description",n,r);if(o!=null)return{description:jr(o)};if(r.aria===!1)return{};const s=Rve(t,i,r);if(!Zn(s))return{description:{signal:lge(s).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function Ti(e,t,n={}){const{markDef:r,encoding:i,config:a}=t,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u=u??Fn(e,r,a,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(s=jr(u)));const l=i[e];return Pw(t,l,o??e,c=>vme({channel:e,channelDef:c,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function Mve(e,t={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Fn("filled",o,u),f=bt(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=Fn(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(a=Fn(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&a!==void 0?a:u.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:jr(d)}:{}),h?{stroke:jr(h)}:{});return o.color&&(c?o.fill:o.stroke)&&Me(qge("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Ti("color",e,{vgChannel:p,defaultValue:c?d:h})),Ti("fill",e,{defaultValue:s.fill?d:void 0})),Ti("stroke",e,{defaultValue:s.stroke?h:void 0}))}function $w(e,t){const n=Emt(e),r=t[n];if(r)return r}function ua(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=t,l=a[e],c=a[Ol(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=$w(e,o),p=h9({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!l&&Nl(e)&&(a.latitude||a.longitude)?{field:t.getName(e)}:gbt({channel:e,channelDef:l,channel2Def:c,markDef:o,config:s,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[r||e]:g}:void 0}function gbt(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=e;if(It(n)&&a&&t===a.fieldChannel){if(We(n)){const l=Nw({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(l!==void 0)return RO({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return sg(n,i,{suffix:"end"},{offset:o})}return F8(e)}function h9({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=e;return()=>{const s=ag(n),u=Gd(n),l=Fn(n,a,o,{vgChannel:u});if(l!==void 0)return Ow(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!bt([ti.LOG,ti.TIME,ti.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Il(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const mbt={left:"x",center:"xc",right:"x2"},vbt={top:"y",middle:"yc",bottom:"y2"};function Pve(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Gd(e);const a=Fn(e==="x"?"align":"baseline",t,n);return e==="x"?mbt[a||(r==="top"?"left":"center")]:vbt[a||r]}function JO(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?$ve(e,t,{defaultPos:n,defaultPos2:r}):ua(e,t,{defaultPos:n})}function $ve(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=t,o=Ol(e),s=Il(e),u=ybt(t,r,o),l=u[s]?Pve(e,i,a):Gd(e);return Object.assign(Object.assign({},ua(e,t,{defaultPos:n,vgChannel:l})),u)}function ybt(e,t,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=e,u=ag(n),l=Il(n),c=Gd(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in a?$w(n,e.markDef):$w(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=bbt({channel:n,channelDef:f,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:QO(n,a)||QO(n,{[n]:UO(n,a,s.style),[l]:UO(l,a,s.style)})||QO(n,s[i])||QO(n,s.mark)||{[c]:h9({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function bbt({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l}){return It(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?sg(t,a,{suffix:"start"},{offset:u}):F8({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function QO(e,t){const n=Il(e),r=Gd(e);if(t[r]!==void 0)return{[r]:Ow(e,t[r])};if(t[e]!==void 0)return{[r]:Ow(e,t[e])};if(t[n])return{[n]:Ow(e,t[n])}}function nh(e,t,n){var r,i,a,o;const{config:s,encoding:u,markDef:l,stack:c}=e,f=Ol(t),d=Il(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=l.orient,b=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:Fn("size",l,s,{vgChannel:d}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(We(h)&&(er(h.bin)||Wa(h.bin)||h.timeUnit&&!p)&&!b&&!xo(m)){const w=Nw({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),S=(a=e.component.axes[t])===null||a===void 0?void 0:a[0],A=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return _bt({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:v,band:w,axisTranslate:A,spacing:Nl(t)?Fn("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(It(h)&&xo(m)||x)&&!p?wbt(n,h,t,e):$ve(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function xbt(e,t,n,r,i,a){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===ti.POINT){const l=r.get("range");return Yd(l)&&Qr(l.step)?{value:l.step-2}:{value:s9-2}}else return{scale:n,band:a}}else return{value:i[e].continuousBandSize}}const o=HO(i.view,t),s=ei(i[e].discreteBandSize,o-2);return s!==void 0?{value:s}:void 0}function wbt(e,t,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,l=a.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=Il(n),h=Ol(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",g=Fn(p?"size":d,a,s,{vgChannel:d});let m;(o.size||g!==void 0)&&(p?m=Ti("size",r,{vgChannel:d,defaultValue:g}):Me(lvt(a.type)));const v=(i=It(t)?Nw({channel:n,fieldDef:t,markDef:a,stack:u,config:s}):void 0)!==null&&i!==void 0?i:1;m=m||{[d]:xbt(e,d,c,f,s,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),b=Pve(n,a,s,y?"middle":"top"),x=$w(n,a),w=F8({channel:n,channelDef:t,markDef:a,config:s,scaleName:c,scale:f,stack:u,offset:x,defaultRef:h9({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const S=Gd(h),A=m[d],_=x?Object.assign(Object.assign({},A),{offset:x}):A;return{[b]:w,[S]:vt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function Lw(e,t,n,r,i){if(Age(e))return 0;const a=e==="x"||e==="y2"?-t/2:t/2;if(Et(n)){const o=Rw(i);return{signal:`${n.signal} ? ${r-a}${o?"-"+o:""} : ${r+a}${o?"+"+o:""}`}}else{if(Et(i)){const o=r+(n?-a:a);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}}function _bt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:l}){const c=Ol(n),f=Gd(n),d=Gd(c),h=$w(n,a);if(er(e.bin)||e.timeUnit)return{[d]:Lve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:(1-r)/2,offset:Lw(c,o,u,s,h),config:l}),[f]:Lve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:1-(1-r)/2,offset:Lw(n,o,u,s,h),config:l})};if(Wa(e.bin)){const p=sg(e,i,{},{offset:Lw(c,o,u,s,h)});if(We(t))return{[d]:p,[f]:sg(t,i,{},{offset:Lw(n,o,u,s,h)})};if(kw(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Ue(e,{expr:"datum"})} + ${e.bin.step})`,offset:Lw(n,o,u,s,h)}}}Me(Yge(c))}function Lve({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:a,config:o}){const s=RO({scaleName:n,fieldOrDatumDef:t,band:i,offset:a});return mme({fieldDef:t,channel:e,markDef:r,ref:s,config:o})}const Sbt=new Set(["aria"]);function Cs(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Mve(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ebt(e.markDef,t)),Bve(e,"fill",n)),Bve(e,"stroke",r)),Ti("opacity",e)),Ti("fillOpacity",e)),Ti("strokeOpacity",e)),Ti("strokeWidth",e)),Ti("strokeDash",e)),Dve(e)),d9(e,"href")),dbt(e))}function Bve(e,t,n){const{config:r,mark:i,markDef:a}=e;if(Fn("invalid",a,r)==="hide"&&n&&!tg(i)){const s=Abt(e,{invalid:!0,channels:kO});if(s)return{[t]:[{test:s,value:null},...zr(n)]}}return n?{[t]:n}:{}}function Ebt(e,t){return Gvt.reduce((n,r)=>(!Sbt.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=jr(e[r])),n),{})}function Abt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&As(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>M8(o,t)).join(` ${a} `)}}function p9(e){const{config:t,markDef:n}=e;if(Fn("invalid",n,t)){const i=Cbt(e,{channels:Es});if(i)return{defined:{signal:i}}}return{}}function Cbt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&As(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>M8(o,t)).join(` ${a} `)}}function zve(e,t){if(t!==void 0)return{[e]:jr(t)}}const g9="voronoi",jve={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(g9)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,a=e.mark;if(tg(a))return Me(Mmt(a)),n;const o={name:e.getName(g9),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Dve(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(g9)>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class qn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qa extends qn{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Vgt()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class $l extends qn{constructor(t,n){super(t);this.formula=n}clone(){return new $l(null,Yt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{const{field:s,timeUnit:u}=a,l=Fr(n)?n.encoding[Ol(o)]:void 0,c=Fr(n)&&B8(o,a,l,n.stack,n.markDef,n.config);if(u){const f=Ue(a,{forAs:!0});i[yn({as:f,field:s,timeUnit:u})]=Object.assign({as:f,field:s,timeUnit:u},c?{band:!0}:{})}return i},{});return Zn(r)?null:new $l(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,a=dt(r,["timeUnit"]),o=Va(i),s=Object.assign(Object.assign({},a),{timeUnit:o});return new $l(t,{[yn(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(zd(this.formula).map(t=>t.as))}dependentFields(){return new Set(zd(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${yn(this.formula)}`}assemble(){const t=[];for(const n of zd(this.formula)){const{field:r,as:i,timeUnit:a}=n,o=Va(a),{unit:s,utc:u}=o,l=dt(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:jd(r),type:"timeunit"},s?{units:A8(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const Bw="_tuple_fields";class kbt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Tbt={has:()=>!0,parse:(e,t,n)=>{var r,i,a;const o=t.name,s=(r=t.project)!==null&&r!==void 0?r:t.project=new kbt,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let g=pr(`${o}_${p}`);for(let m=1;c.has(g);m++)g=pr(`${o}_${p}_${m}`);return c.add(g),{[h]:g}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of zr(n.init))for(const p of Be(h))_mt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Me('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),s.items.push(h),s.hasField[d]=h}for(const d of(a=n.encodings)!==null&&a!==void 0?a:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){Me(Fmt(d,h.aggregate));continue}else if(!p){Me(Bge(d));continue}if(h.timeUnit){p=e.vgField(d);const g={timeUnit:h.timeUnit,as:p,field:h.field};l[yn(g)]=g}if(!u[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(d).get("type");As(v)&&(g="R")}else h.bin&&(g="R-RE");const m={field:p,channel:d,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),s.items.push(u[p]=m),s.hasField[p]=s.hasChannel[d]=u[p]}}else Me(Bge(d))}if(n.init){const d=h=>s.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=zr(n.init);t.init=h.map(d)}}Zn(l)||(s.timeUnit=new $l(null,l))},signals:(e,t,n)=>{const r=t.name+Bw;return n.filter(a=>a.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(a=>{const o=dt(a,["signals","hasLegend"]);return o.field=jd(o.field),o})})}},Uve={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!n9(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],s=jve.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=pr(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:E0(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${gn(u.field)}] : null`}]:[],bind:(f=(c=a[u.field])!==null&&c!==void 0?c:a[u.channel])!==null&&f!==void 0?f:a}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.filter(l=>l.name===r+Ll)[0],o=r+Bw,s=i.items.map(l=>pr(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}},eI="_toggle",Wve={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+eI,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ll,r=t.name+eI;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Yc(e)}}, `)+`${r} ? ${n} : null`}},Obt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=Xt(n.clear)?$d(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Uve.has(t))for(const r of t.project.items){const i=n.findIndex(a=>a.name===pr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,a){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const i of t.project.items){const a=n.findIndex(o=>o.name===i.signals.visual);if(r(a,"[0, 0]"),a===-1){const o=n.findIndex(s=>s.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(a=>a.name===t.name+Ll);r(i,"null"),Wve.has(t)&&(i=n.findIndex(a=>a.name===t.name+eI),r(i,"false"))}return n}},rh={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Xd(i))continue;const a=e.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!As(o)){Me($mt);continue}const s={selection:t.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(s=>s.name===o.signals.data).length===0);if(!e.parent||v9(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let a=i.update;if(a.indexOf(e0e)>=0)i.update=`{${r.map(o=>`${gn(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const s=`${gn(o.field)}: ${o.signals.data}`;a.indexOf(s)<0&&(a=`${a.substring(0,a.length-1)}, ${s}}`)}i.update=a}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!v9(e))for(const r of t.scales){const i=n.filter(a=>a.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function m9(e,t){return`domain(${gn(e.scaleName(t))})`}function v9(e){var t;return e.parent&&R0(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:v9(e.parent.parent))}const Vve={has:e=>{const t=e.resolve==="global"&&e.bind&&n9(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==S0;return t&&!n&&Me(Lmt),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=zr((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(s)<0&&u.filter.push(s)}const a=r9(t.bind)?t.bind.legend:"click",o=Xt(a)?$d(a,"view"):zr(a);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=r9(t.bind)&&t.bind.legend,a=o=>s=>{const u=Yt(s);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${pr(o.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(a(`${s}_symbols`)).concat(i.merge.map(a(`${s}_labels`))).concat(i.merge.map(a(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.find(d=>d.name===r+Ll),o=r+Bw,s=i.items.filter(d=>d.hasLegend).map(d=>pr(`${r}_${pr(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?a.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(a.update=l,delete a.value,delete a.on);const c=n.find(d=>d.name===r+eI),f=r9(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function Ibt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;mg(e,a=>{var o,s;const u=(o=a.project.hasField[i])!==null&&o!==void 0?o:a.project.hasChannel[t];if(u&&Vve.has(a)){const l=(s=n.get("selections"))!==null&&s!==void 0?s:[];l.push(a.name),n.set("selections",l,!1),u.hasLegend=!0}})}const qve="_translate_anchor",Hve="_translate_delta",Nbt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=rh.has(t),a=r+qve,{x:o,y:s}=t.project.hasChannel;let u=$d(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+zw,l))),n.push({name:a,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?m9(e,wr):`slice(${o.signals.visual})`):"")+(s!==void 0?", extent_y: "+(i?m9(e,hi):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+Hve,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),o!==void 0&&Gve(e,t,o,"width",n),s!==void 0&&Gve(e,t,s,"height",n),n}};function Gve(e,t,n,r,i){var a;const o=t.name,s=o+qve,u=o+Hve,l=n.channel,c=rh.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),g=c&&l===wr?"-":"",m=`${s}.extent_${l}`,v=`${g}${u}.${l} / `+(c?`${d}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(a=h.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";f.on.push({events:{signal:u},update:c?b:`clampRange(${b}, 0, ${d})`})}const Kve="_zoom_anchor",Xve="_zoom_delta",Dbt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=rh.has(t),a=r+Xve,{x:o,y:s}=t.project.hasChannel,u=gn(e.scaleName(wr)),l=gn(e.scaleName(hi));let c=$d(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+zw,f))),n.push({name:r+Kve,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&Yve(e,t,o,"width",n),s!==void 0&&Yve(e,t,s,"height",n),n}};function Yve(e,t,n,r,i){var a;const o=t.name,s=n.channel,u=rh.has(t),l=i.filter(y=>y.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?m9(e,s):l.name,p=o+Xve,g=`${o}${Kve}.${s}`,v=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${g}, ${p}`+(u&&d==="pow"?`, ${(a=f.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";l.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${c})`})}const Rbt=[Tbt,Wve,rh,Vve,Nbt,Dbt,Uve,jve,Obt];function tI(e,t){for(const n of Rbt)n.has(e)&&t(n)}function E0(e,t=!0,n=kgt){if(vt(e)){const r=e.map(i=>E0(i,t,n));return t?`[${r.join(", ")}]`:r}else if(b0(e))return n(t?Tw(e):$vt(e));return t?n(JSON.stringify(e)):e}function Fbt(e,t){return mg(e,(n,r)=>{const i=n.name;let a=r.modifyExpr(e,n);t.push(...r.signals(e,n)),tI(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(a=o.modifyExpr(e,n,a))}),t.push({name:i+Vbt,on:[{events:{signal:n.name+Ll},update:`modify(${gn(n.name+gg)}, ${a})`}]})}),y9(t)}function Mbt(e,t){if(e.component.selection&&Be(e.component.selection).length){const n=gn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:$d("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return y9(t)}function Pbt(e,t){let n=!1;return mg(e,(r,i)=>{const a=r.name,o=gn(a+gg);if(t.filter(u=>u.name===a).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${e0e}(${o}, ${gn(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),tI(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),y9(t)}function $bt(e,t){const n=[...t];return mg(e,r=>{const i={name:r.name+gg};if(r.init){const o=r.project.items.map(u=>dt(u,["signals"])),s=r.init.map(u=>E0(u,!1));i.values=r.type==="interval"?[{unit:Yc(e,{escape:!1}),fields:o,values:s}]:s.map(u=>({unit:Yc(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+gg).length||n.push(i)}),n}function Zve(e,t){return mg(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,tI(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function Lbt(e,t){for(const n of e.children)Fr(n)&&(t=Zve(n,t));return t}function Bbt(e,t){const n=t.selection,r=e.getSelectionComponent(n,pr(n));return{signal:v0e(r,t)}}function y9(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const zw="_brush",b9="_scale_trigger",zbt={signals:(e,t)=>{const n=t.name,r=n+Bw,i=rh.has(t),a=[],o=[],s=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${gn(n+zw)}`;Jve(t,(f,d)=>{var h;const p=zr((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==wr&&d!==hi){Me("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=jbt(e,t,c,h),g=c.signals.data,m=c.signals.visual,v=gn(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),b=As(y)?"+":"";a.push(...p),o.push(g),s.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||a.push({name:n+b9,value:{},on:[{events:s.map(c=>({scale:c.scaleName})),update:s.map(c=>c.expr).join(" && ")+` ? ${n+b9} : {}`}]});const u=t.init,l=`unit: ${Yc(e)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+Ll},u?{init:`{${l}: ${E0(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"true":`{unit: ${Yc(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:a}=t.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${gn(t.name+gg)})`;if(rh.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:a!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Be(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Yc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=dt(c,["fill","fillOpacity","cursor"]),g=Be(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,a!==void 0&&`${s}[0] !== ${s}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+zw+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+zw,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function jbt(e,t,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=rh.has(t),u=gn(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===wr?"width":"height").signal,h=`${i}(unit)`,p=Jve(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${a}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+b9},update:As(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:E0(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:E0(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}function Jve(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Me(`${r} is not an ordered event stream for interval selections.`),n),[])}function Qve(e,t){const n=t.name,r=n+Bw,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${a}[${gn(e.vgField(l.channel,{}))}], ${a}[${gn(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${a}[${gn(l.field)}]`}).join(", "),s=`unit: ${Yc(e)}, fields: ${r}, values`,u=t.events;return[{name:n+Ll,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const Ubt={signals:Qve,modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"null":`{unit: ${Yc(e)}}`)},Wbt={signals:Qve,modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"true":`{unit: ${Yc(e)}}`)},gg="_store",Ll="_tuple",Vbt="_modify",e0e="vlSelectionResolve",qbt={single:Wbt,multi:Ubt,interval:zbt};function mg(e,t){const n=e.component.selection;if(n){for(const r of zd(n))if(t(r,qbt[r.type])===!0)break}}function Hbt(e){let t=e.parent;for(;t&&!ku(t);)t=t.parent;return t}function Yc(e,{escape:t}={escape:!0}){let n=t?gn(e.name):e.name;const r=Hbt(e);if(r){const{facet:i}=r;for(const a of Ss)i[a]&&(n+=` + '__facet_${a}_' + (facet[${gn(r.vgField(a))}])`)}return n}function x9(e){let t=!1;return mg(e,n=>{t=t||n.project.items.some(r=>r.field===S0)}),t}const Gbt="RawCode",Kbt="Literal",Xbt="Property",Ybt="Identifier",Zbt="ArrayExpression",Jbt="BinaryExpression",Qbt="CallExpression",e1t="ConditionalExpression",t1t="LogicalExpression",n1t="MemberExpression",r1t="ObjectExpression",i1t="UnaryExpression";function Eu(e){this.type=e}Eu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=a1t(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function a1t(e){switch(e.type){case Zbt:return e.elements;case Jbt:case t1t:return[e.left,e.right];case Qbt:return[e.callee].concat(e.arguments);case e1t:return[e.test,e.consequent,e.alternate];case n1t:return[e.object,e.property];case r1t:return e.properties;case Xbt:return[e.key,e.value];case i1t:return[e.argument];case Ybt:case Kbt:case Gbt:default:return[]}}var Bl,ot,_e,la,jn,nI=1,jw=2,vg=3,ih=4,rI=5,yg=6,wo=7,Uw=8,o1t=9;Bl={},Bl[nI]="Boolean",Bl[jw]="<end>",Bl[vg]="Identifier",Bl[ih]="Keyword",Bl[rI]="Null",Bl[yg]="Numeric",Bl[wo]="Punctuator",Bl[Uw]="String",Bl[o1t]="RegularExpression";var s1t="ArrayExpression",u1t="BinaryExpression",l1t="CallExpression",c1t="ConditionalExpression",t0e="Identifier",f1t="Literal",d1t="LogicalExpression",h1t="MemberExpression",p1t="ObjectExpression",g1t="Property",m1t="UnaryExpression",Vi="Unexpected token %0",v1t="Unexpected number",y1t="Unexpected string",b1t="Unexpected identifier",x1t="Unexpected reserved word",w1t="Unexpected end of input",w9="Invalid regular expression",_9="Invalid regular expression: missing /",n0e="Octal literals are not allowed in strict mode.",_1t="Duplicate data property in object literal not allowed in strict mode",ca="ILLEGAL",Ww="Disabled.",S1t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),E1t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function iI(e,t){if(!e)throw new Error("ASSERT: "+t)}function Zc(e){return e>=48&&e<=57}function S9(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Vw(e){return"01234567".indexOf(e)>=0}function A1t(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function qw(e){return e===10||e===13||e===8232||e===8233}function Hw(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&S1t.test(String.fromCharCode(e))}function aI(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&E1t.test(String.fromCharCode(e))}var C1t={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function r0e(){for(var e;_e<la&&(e=ot.charCodeAt(_e),A1t(e)||qw(e));)++_e}function E9(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)_e<la&&S9(ot[_e])?(r=ot[_e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Nn({},Vi,ca);return String.fromCharCode(i)}function k1t(){var e,t,n,r;for(e=ot[_e],t=0,e==="}"&&Nn({},Vi,ca);_e<la&&(e=ot[_e++],!!S9(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Nn({},Vi,ca),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function i0e(){var e,t;for(e=ot.charCodeAt(_e++),t=String.fromCharCode(e),e===92&&(ot.charCodeAt(_e)!==117&&Nn({},Vi,ca),++_e,e=E9("u"),(!e||e==="\\"||!Hw(e.charCodeAt(0)))&&Nn({},Vi,ca),t=e);_e<la&&(e=ot.charCodeAt(_e),!!aI(e));)++_e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ot.charCodeAt(_e)!==117&&Nn({},Vi,ca),++_e,e=E9("u"),(!e||e==="\\"||!aI(e.charCodeAt(0)))&&Nn({},Vi,ca),t+=e);return t}function T1t(){var e,t;for(e=_e++;_e<la;){if(t=ot.charCodeAt(_e),t===92)return _e=e,i0e();if(aI(t))++_e;else break}return ot.slice(e,_e)}function O1t(){var e,t,n;return e=_e,t=ot.charCodeAt(_e)===92?i0e():T1t(),t.length===1?n=vg:C1t.hasOwnProperty(t)?n=ih:t==="null"?n=rI:t==="true"||t==="false"?n=nI:n=vg,{type:n,value:t,start:e,end:_e}}function A9(){var e=_e,t=ot.charCodeAt(_e),n,r=ot[_e],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,{type:wo,value:String.fromCharCode(t),start:e,end:_e};default:if(n=ot.charCodeAt(_e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:wo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:_e};case 33:case 61:return _e+=2,ot.charCodeAt(_e)===61&&++_e,{type:wo,value:ot.slice(e,_e),start:e,end:_e}}}if(o=ot.substr(_e,4),o===">>>=")return _e+=4,{type:wo,value:o,start:e,end:_e};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return _e+=3,{type:wo,value:a,start:e,end:_e};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return _e+=2,{type:wo,value:i,start:e,end:_e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++_e,{type:wo,value:r,start:e,end:_e};Nn({},Vi,ca)}function I1t(e){for(var t="";_e<la&&S9(ot[_e]);)t+=ot[_e++];return t.length===0&&Nn({},Vi,ca),Hw(ot.charCodeAt(_e))&&Nn({},Vi,ca),{type:yg,value:parseInt("0x"+t,16),start:e,end:_e}}function N1t(e){for(var t="0"+ot[_e++];_e<la&&Vw(ot[_e]);)t+=ot[_e++];return(Hw(ot.charCodeAt(_e))||Zc(ot.charCodeAt(_e)))&&Nn({},Vi,ca),{type:yg,value:parseInt(t,8),octal:!0,start:e,end:_e}}function a0e(){var e,t,n;if(n=ot[_e],iI(Zc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="",n!=="."){if(e=ot[_e++],n=ot[_e],e==="0"){if(n==="x"||n==="X")return++_e,I1t(t);if(Vw(n))return N1t(t);n&&Zc(n.charCodeAt(0))&&Nn({},Vi,ca)}for(;Zc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="."){for(e+=ot[_e++];Zc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="e"||n==="E")if(e+=ot[_e++],n=ot[_e],(n==="+"||n==="-")&&(e+=ot[_e++]),Zc(ot.charCodeAt(_e)))for(;Zc(ot.charCodeAt(_e));)e+=ot[_e++];else Nn({},Vi,ca);return Hw(ot.charCodeAt(_e))&&Nn({},Vi,ca),{type:yg,value:parseFloat(e),start:t,end:_e}}function D1t(){var e="",t,n,r,i,a=!1;for(t=ot[_e],iI(t==="'"||t==='"',"String literal must starts with a quote"),n=_e,++_e;_e<la;)if(r=ot[_e++],r===t){t="";break}else if(r==="\\")if(r=ot[_e++],!r||!qw(r.charCodeAt(0)))switch(r){case"u":case"x":ot[_e]==="{"?(++_e,e+=k1t()):e+=E9(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Vw(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),_e<la&&Vw(ot[_e])&&(a=!0,i=i*8+"01234567".indexOf(ot[_e++]),"0123".indexOf(r)>=0&&_e<la&&Vw(ot[_e])&&(i=i*8+"01234567".indexOf(ot[_e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ot[_e]===`
`&&++_e;else{if(qw(r.charCodeAt(0)))break;e+=r}return t!==""&&Nn({},Vi,ca),{type:Uw,value:e,octal:a,start:n,end:_e}}function R1t(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";Nn({},w9)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Nn({},w9)}try{return new RegExp(e,t)}catch(r){return null}}function F1t(){var e,t,n,r,i;for(e=ot[_e],iI(e==="/","Regular expression literal must start with a slash"),t=ot[_e++],n=!1,r=!1;_e<la;)if(e=ot[_e++],t+=e,e==="\\")e=ot[_e++],qw(e.charCodeAt(0))&&Nn({},_9),t+=e;else if(qw(e.charCodeAt(0)))Nn({},_9);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Nn({},_9),i=t.substr(1,t.length-2),{value:i,literal:t}}function M1t(){var e,t,n;for(t="",n="";_e<la&&(e=ot[_e],!!aI(e.charCodeAt(0)));)++_e,e==="\\"&&_e<la?Nn({},Vi,ca):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Nn({},w9,n),{value:n,literal:t}}function P1t(){var e,t,n,r;return jn=null,r0e(),e=_e,t=F1t(),n=M1t(),r=R1t(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_e}}function $1t(e){return e.type===vg||e.type===ih||e.type===nI||e.type===rI}function o0e(){var e;return r0e(),_e>=la?{type:jw,start:_e,end:_e}:(e=ot.charCodeAt(_e),Hw(e)?O1t():e===40||e===41||e===59?A9():e===39||e===34?D1t():e===46?Zc(ot.charCodeAt(_e+1))?a0e():A9():Zc(e)?a0e():A9())}function _o(){var e;return e=jn,_e=e.end,jn=o0e(),_e=e.end,e}function s0e(){var e;e=_e,jn=o0e(),_e=e}function L1t(e){var t=new Eu(s1t);return t.elements=e,t}function u0e(e,t,n){var r=new Eu(e==="||"||e==="&&"?d1t:u1t);return r.operator=e,r.left=t,r.right=n,r}function B1t(e,t){var n=new Eu(l1t);return n.callee=e,n.arguments=t,n}function z1t(e,t,n){var r=new Eu(c1t);return r.test=e,r.consequent=t,r.alternate=n,r}function C9(e){var t=new Eu(t0e);return t.name=e,t}function Gw(e){var t=new Eu(f1t);return t.value=e.value,t.raw=ot.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function l0e(e,t,n){var r=new Eu(h1t);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function j1t(e){var t=new Eu(p1t);return t.properties=e,t}function c0e(e,t,n){var r=new Eu(g1t);return r.key=t,r.value=n,r.kind=e,r}function U1t(e,t){var n=new Eu(m1t);return n.operator=e,n.argument=t,n.prefix=!0,n}function Nn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(a,o){return iI(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=_e,n.description=i,n}function oI(e){e.type===jw&&Nn(e,w1t),e.type===yg&&Nn(e,v1t),e.type===Uw&&Nn(e,y1t),e.type===vg&&Nn(e,b1t),e.type===ih&&Nn(e,x1t),Nn(e,Vi,e.value)}function fa(e){var t=_o();(t.type!==wo||t.value!==e)&&oI(t)}function or(e){return jn.type===wo&&jn.value===e}function k9(e){return jn.type===ih&&jn.value===e}function W1t(){var e=[];for(_e=jn.start,fa("[");!or("]");)or(",")?(_o(),e.push(null)):(e.push(bg()),or("]")||fa(","));return _o(),L1t(e)}function f0e(){var e;return _e=jn.start,e=_o(),e.type===Uw||e.type===yg?(e.octal&&Nn(e,n0e),Gw(e)):C9(e.value)}function V1t(){var e,t,n,r;if(_e=jn.start,e=jn,e.type===vg)return n=f0e(),fa(":"),r=bg(),c0e("init",n,r);if(e.type===jw||e.type===wo)oI(e);else return t=f0e(),fa(":"),r=bg(),c0e("init",t,r)}function q1t(){var e=[],t,n,r,i={},a=String;for(_e=jn.start,fa("{");!or("}");)t=V1t(),t.key.type===t0e?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Nn({},_1t):i[r]=!0,e.push(t),or("}")||fa(",");return fa("}"),j1t(e)}function H1t(){var e;return fa("("),e=T9(),fa(")"),e}var G1t={if:1};function K1t(){var e,t,n;if(or("("))return H1t();if(or("["))return W1t();if(or("{"))return q1t();if(e=jn.type,_e=jn.start,e===vg||G1t[jn.value])n=C9(_o().value);else if(e===Uw||e===yg)jn.octal&&Nn(jn,n0e),n=Gw(_o());else{if(e===ih)throw new Error(Ww);e===nI?(t=_o(),t.value=t.value==="true",n=Gw(t)):e===rI?(t=_o(),t.value=null,n=Gw(t)):or("/")||or("/=")?(n=Gw(P1t()),s0e()):oI(_o())}return n}function X1t(){var e=[];if(fa("("),!or(")"))for(;_e<la&&(e.push(bg()),!or(")"));)fa(",");return fa(")"),e}function Y1t(){var e;return _e=jn.start,e=_o(),$1t(e)||oI(e),C9(e.value)}function Z1t(){return fa("."),Y1t()}function J1t(){var e;return fa("["),e=T9(),fa("]"),e}function Q1t(){var e,t,n;for(e=K1t();;)if(or("."))n=Z1t(),e=l0e(".",e,n);else if(or("("))t=X1t(),e=B1t(e,t);else if(or("["))n=J1t(),e=l0e("[",e,n);else break;return e}function d0e(){var e=Q1t();if(jn.type===wo&&(or("++")||or("--")))throw new Error(Ww);return e}function sI(){var e,t;if(jn.type!==wo&&jn.type!==ih)t=d0e();else{if(or("++")||or("--"))throw new Error(Ww);if(or("+")||or("-")||or("~")||or("!"))e=_o(),t=sI(),t=U1t(e.value,t);else{if(k9("delete")||k9("void")||k9("typeof"))throw new Error(Ww);t=d0e()}}return t}function h0e(e){var t=0;if(e.type!==wo&&e.type!==ih)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function ext(){var e,t,n,r,i,a,o,s,u,l;if(e=jn,u=sI(),r=jn,i=h0e(r),i===0)return u;for(r.prec=i,_o(),t=[e,jn],o=sI(),a=[u,r,o];(i=h0e(jn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=u0e(s,u,o),a.push(n);r=_o(),r.prec=i,a.push(r),t.push(jn),n=sI(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=u0e(a[l-1].value,a[l-2],n),l-=2;return n}function bg(){var e,t,n;return e=ext(),or("?")&&(_o(),t=bg(),fa(":"),n=bg(),e=z1t(e,t,n)),e}function T9(){var e=bg();if(or(","))throw new Error(Ww);return e}function txt(e){ot=e,_e=0,la=ot.length,jn=null,s0e();var t=T9();if(jn.type!==jw)throw new Error("Unexpect token after expression.");return t}function A0(e,t,n){return e.fields=t||[],e.fname=n,e}function nxt(e){return e.length===1?rxt(e[0]):ixt(e)}const rxt=e=>function(t){return t[e]},ixt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function O9(e){throw Error(e)}function axt(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||O9("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&O9("Access path missing closing bracket: "+e),r&&O9("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function oxt(e,t,n){const r=axt(e);return e=r.length===1?r[0]:e,A0((n&&n.get||nxt)(r),[e],t||e)}oxt("id"),A0(e=>e,[],"identity"),A0(()=>0,[],"zero"),A0(()=>1,[],"one"),A0(()=>!0,[],"true"),A0(()=>!1,[],"false");function I9(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...I9(e.object)),t.push(...I9(e.property))),t)}function p0e(e){return e.object.type==="MemberExpression"?p0e(e.object):e.object.name==="datum"}function g0e(e){const t=txt(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&p0e(r)&&n.add(I9(r).slice(1).join("."))}),n}class C0 extends qn{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=uI(this.model,this.filter,this),this._dependentFields=g0e(this.expr)}clone(){return new C0(null,this.model,Yt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function sxt(e,t){var n;const r={},i=e.config.selection;for(const a of Be(t??{})){const o=Yt(t[a]),s=i[o.type],u=dt(s,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=pr(a),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:Xt(o.on)?$d(o.on,"scope"):Yt(o.on)});tI(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[a])})}return r}function m0e(e,t,n,r="datum"){const i=[];function a(s){const u=pr(s),l=e.getSelectionComponent(u,s),c=gn(u+gg);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${gn(l.resolve)})`)}const o=_w(t,a);return(i.length?"!("+i.map(s=>`length(data(${s}))`).join(" || ")+") || ":"")+`(${o})`}function v0e(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Me(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${gn(r)}.`);else if(n&&!r){const i=e.project.items.filter(a=>a.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Me((i.length?"Multiple ":"No ")+`matching ${gn(n)} encoding found for selection ${gn(t.selection)}. Using "field": ${gn(r)}.`)):r=i[0].field}return`${e.name}[${gn(r)}]`}function uxt(e,t){mg(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new qa(new C0(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function uI(e,t,n){return _w(t,r=>Xt(r)?r:Xvt(r)?m0e(e,r.selection,n):ume(r))}function lxt(e,t){if(!!e)return vt(e)&&!eh(e)?e.map(n=>$me(n,t)).join(", "):e}function N9(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function Kw(e,t,n,r={header:!1}){var i,a;const o=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=dt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const p in h){const g=Ggt[p],m=h[p];if(g&&g!==t&&g!=="both")delete h[p];else if(c8(m)){const{condition:v}=m,y=dt(m,["condition"]),b=zr(v),x=dge[p];if(x){const{vgProp:w,part:S}=x,A=[...b.map(_=>{const{test:E}=_,C=dt(_,["test"]);return Object.assign({test:uI(null,E)},C)}),y];N9(h,S,w,A),delete h[p]}else if(x===null){const w={signal:b.map(S=>{const{test:A}=S,_=dt(S,["test"]);return`${uI(null,A)} ? ${jme(_)} : `}).join("")+jme(y)};h[p]=w}}else if(Et(m)){const v=dge[p];if(v){const{vgProp:y,part:b}=v;N9(h,b,y,m),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Zn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ei(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&Et(h.encode.labels.update.text)&&(g=m0(c,"datum.label",h.encode.labels.update.text.signal)),N9(h,"labels","text",{signal:g})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const g of hge)e.hasAxisPart(g)||delete h.encode[g];Zn(h.encode)&&delete h.encode}const p=lxt(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:ei(d,0)})}}}function y0e(e){const{axes:t}=e.component,n=[];for(const r of Es)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const a=r==="x"?"height":"width",o=e.getSizeSignalRef(a).signal;a!==o&&n.push({name:a,update:o})}}return n}function cxt(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>Kw(i,"grid",t)),...r.map(i=>Kw(i,"grid",t)),...n.map(i=>Kw(i,"main",t)),...r.map(i=>Kw(i,"main",t))].filter(i=>i)}const b0e={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},x0e={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},fxt=Be(b0e),dxt=Be(x0e);function w0e(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const a=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Be(o),...Be(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${a}" ? ${Rw(o[c])} : ${Rw(s[c])}`};return l}return t[i]})])}function hxt(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:s0t(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",o=Et(n)?"axisOrient":"axis"+hO(n),s=[...i,...i.map(l=>a+l.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:w0e(s,r,e,n),vgAxisConfig:w0e(u,r,e,n),axisConfigStyle:pxt([...u,...s],r)}}function pxt(e,t){var n;const r=[{}];for(const i of e){let a=(n=t[i])===null||n===void 0?void 0:n.style;if(a){a=zr(a);for(const o of a)r.push(t.style[o])}}return Object.assign.apply(null,r)}function D9(e,t,n,r={}){var i;const a=Wme(e,n,t.style);if(a!==void 0)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const _0e={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return xme(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return wme(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return We(e)&&Wa(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:gxt(n,e)},gridScale:({model:e,channel:t})=>mxt(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||E0e(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||S0e(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:yxt(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:bxt(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!==null&&a!==void 0?a:wxt({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=A0e(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),a=n==="x"?"x2":"y2",o=t.fieldDef(a);return qme(i?[Tme(i)]:[],We(o)?[Tme(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>_xt(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:Sxt(n,t)}};function gxt(e,t){return!xo(e)&&We(t)&&!er(t==null?void 0:t.bin)}function mxt(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function vxt(e,t,n,r,i){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Et(a)?a:pO(a);{const{configValue:o}=D9("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?pO(o):n===wr&&bt([D8,N8],r.type)?270:void 0}}function R9(e){return`(((${e.signal} % 360) + 360) % 360)`}function S0e(e,t,n,r){if(e!==void 0)if(n==="x"){if(Et(e)){const i=R9(e),a=Et(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Et(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Et(e)){const i=R9(e),a=Et(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Et(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function E0e(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,a=r?"bottom":"left";if(Et(e)){const o=R9(e),s=Et(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(Et(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${a}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===a)?"left":"right"}function yxt(e,t){if(t==="x"&&bt(["quantitative","temporal"],e))return!0}function bxt(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function xxt(e){return e==="x"?"bottom":"left"}function wxt({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!xo(t)&&t!=="log"){if(We(e)){if(er(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],(i=Va(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function A0e(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;if(a&&o)return Hme(a,o);if(a)return a;if(o)return o;if(a!==void 0)return a;if(o!==void 0)return o}function _xt(e,t){const n=e.values;if(vt(n))return Bme(t,n);if(Et(n))return n}function Sxt(e,t){return e==="rect"&&Dme(t)?1:0}class k0 extends qn{constructor(t,n){super(t);this.transform=n,this._dependentFields=g0e(this.transform.calculate)}clone(){return new k0(null,Yt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!W8(r)&&kme(r.sort)){const{field:a,timeUnit:o}=r,s=r.sort,u=s.map((l,c)=>`${ume({field:a,timeUnit:o,equal:l})} ? ${c} : `).join("")+s.length;t=new k0(t,{calculate:u,as:T0(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${yn(this.transform)}`}}function T0(e,t,n){return Ue(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function lI(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||e==="row"?"row":"column"}function O0(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return ei(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function cI(e,t,n,r){const i={};for(const a of e){const o=O0(a,t,n,r);o!==void 0&&(i[a]=o)}return i}const F9=["row","column"],M9=["header","footer"];function Ext(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=cI(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=lI(t,s),l=pO(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),k0e(l,u)),C0e(u,l,a)),T0e(r,i,t,fxt,b0e))}}function C0e(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=E0e(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function k0e(e,t){const n=S0e(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Axt(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of M9)if(n[i])for(const a of n[i]){const o=kxt(e,t,i,n,a);o!=null&&r.push(o)}return r}function Cxt(e,t){var n;const{sort:r}=e;return Rl(r)?{field:Ue(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:vt(r)?{field:T0(e,t,{expr:"datum"}),order:"ascending"}:{field:Ue(e,{expr:"datum"}),order:r??"ascending"}}function P9(e,t,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=cI(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=P8({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=lI(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?m0(m0(u,"datum.label",l),"datum.value",Ue(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),k0e(a,c)),C0e(c,a,o)),T0e(n,e,t,dxt,x0e))}function kxt(e,t,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=cI(["labelOrient"],o,s,t);(t==="row"&&!bt(["top","bottom"],f)||t==="column"&&!bt(["left","right"],f))&&(a=P9(o,t,s))}const u=ku(e)&&!Iw(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(a||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:Cxt(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const Txt={column:{start:0,end:1},row:{start:1,end:0}};function Oxt(e,t){return Txt[t][e]}function Ixt(e,t){const n={};for(const r of Ss){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:a,titleOrient:o}=cI(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),s=lI(r,o),u=Oxt(a,s);u!==void 0&&(n[s]=u)}}return Zn(n)?void 0:n}function T0e(e,t,n,r,i){const a={};for(const o of r){if(!i[o])continue;const s=O0(o,t,e,n);s!==void 0&&(a[i[o]]=s)}return a}function $9(e){return[...fI(e,"width"),...fI(e,"height"),...fI(e,"childWidth"),...fI(e,"childHeight")]}function fI(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const a=e.getScaleComponent(n);if(a){const o=a.get("type"),s=a.get("range");if(xo(o)&&Yd(s)){const u=e.scaleName(n);return ku(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[O0e(u,s)]:[O0e(u,s),{name:i,update:I0e(u,a,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const a=i.endsWith("width"),o=a?"containerSize()[0]":"containerSize()[1]",s=o9(e.config.view,a?"width":"height"),u=`isFinite(${o}) ? ${o} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function O0e(e,t){return{name:e+"_step",value:t.step}}function I0e(e,t,n){const r=t.get("type"),i=t.get("padding"),a=ei(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${e}_step`}function N0e(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function D0e(e,t){return Be(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Pw(t,i,r,a=>Et(a)?a:{value:a.value}))},{})}function Nxt(e,t){if(R0(t)||ku(t))return"shared";if(Y9(t))return Nl(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function L9(e,t){const n=e.scale[t],r=Nl(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Me(pvt(t)),"independent"):e[r][t]||"shared"}const Dxt=Object.assign(Object.assign({},syt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),R0e=Be(Dxt);class Rxt extends Xc{}const F0e={symbols:Fxt,gradient:Mxt,labels:Pxt,entries:$xt};function Fxt(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,l,c;if(a!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},z0t({},n,emt)),Mve(n,{filled:g}));const v=(o=M0e(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(r==="fill"||g&&r===yo)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=jr((s=h.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black"),m.fillOpacity=jr(v??1));else if(vt(m.fill)){const y=(c=(l=B9((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=jr(y))}}if(m.stroke){if(r==="stroke"||!g&&r===yo)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(vt(m.stroke)){const y=ei(B9(d.stroke||d.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==Hc){const y=We(t)&&$0e(n,i,t);y?m.opacity=[Object.assign({test:y},jr(v??1)),jr(h.legend.unselectedOpacity)]:v&&(m.opacity=jr(v))}return m=Object.assign(Object.assign({},m),e),Zn(m)?void 0:m}function Mxt(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=M0e(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=jr(i)),r=Object.assign(Object.assign({},r),e),Zn(r)?void 0:r}function Pxt(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=We(t)?$0e(n,i,t):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=a,f=ug(c)?$8({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Zn(d)?void 0:d}function $xt(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function M0e(e){return P0e(e,(t,n)=>Math.max(t,n.value))}function B9(e){return P0e(e,(t,n)=>ei(t,n.value))}function P0e(e,t){if(I0t(e))return zr(e.condition).reduce(t,e.value);if(Gc(e))return e.value}function $0e(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=gn(n.field);return r.map(a=>`(!length(data(${gn(pr(a)+gg)})) || (${a}[${i}] && indexof(${a}[${i}], datum.value) >= 0))`).join(" || ")}const L0e={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return xme(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return wme(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:Vxt(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:qxt(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:Bxt(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>lg(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(v0(n)&&Su(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Lxt(t,e)};function Lxt(e,t){const n=e.values;if(vt(n))return Bme(t,n);if(Et(n))return n}function Bxt(e,t,n,r){var i;if(t!=="shape"){const a=(i=B9(n))!==null&&i!==void 0?i:r;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function zxt(e){const{legend:t}=e;return ei(t.type,jxt(e))}function jxt({channel:e,timeUnit:t,scaleType:n}){if(v0(e)){if(bt(["quarter","month","day"],t))return"symbol";if(Su(n))return"gradient"}return"symbol"}function Uxt({legendConfig:e,legendType:t,orient:n,legend:r}){var i,a;return(a=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&a!==void 0?a:Wxt(n,t)}function Wxt(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Vxt({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(Su(i))return n==="horizontal"?r==="top"||r==="bottom"?B0e(t,"width",o,a):o:B0e(t,"height",u,s)}function B0e(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function qxt(e){if(bt(["quantile","threshold","log"],e))return"greedy"}function z0e(e){const t=Fr(e)?Hxt(e):Yxt(e);return e.component.legends=t,t}function Hxt(e){const{encoding:t}=e,n={};for(const r of[yo,...uve]){const i=pi(t[r]);!i||!e.getScaleComponent(r)||r===bo&&We(i)&&i.type===_0||(n[r]=Xxt(e,r))}return n}function Gxt(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Kxt(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function Xxt(e,t){var n,r,i;let a=e.legend(t);const{markDef:o,encoding:s,config:u}=e,l=u.legend,c=new Rxt({},Gxt(e,t));Ibt(e,t,c);const f=a!==void 0?!a:l.disable;if(c.set("disable",f,a!==void 0),f)return c;a=a||{};const d=e.getScaleComponent(t).get("type"),h=pi(s[t]),p=We(h)?(n=Va(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",m=zxt({legend:a,channel:t,timeUnit:p,scaleType:d}),v=Uxt({legend:a,legendType:m,orient:g,legendConfig:l}),y={legend:a,channel:t,model:e,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const A of R0e){const _=A in L0e?L0e[A](y):a[A];if(_!==void 0){const E=Kxt(_,A,a,e.fieldDef(t));(E||u.legend[A]===void 0)&&c.set(A,_,E)}}const b=(r=a==null?void 0:a.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},S={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const A of["labels","legend","title","symbols","gradient","entries"]){const _=D0e((i=b[A])!==null&&i!==void 0?i:{},e),E=A in F0e?F0e[A](_,S):_;E!==void 0&&!Zn(E)&&(w[A]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&We(h)?{name:`${pr(h.field)}_legend_${A}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:E}))}return Zn(w)||c.set("encode",w,!!(a==null?void 0:a.encoding)),c}function Yxt(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){z0e(r);for(const i of Be(r.component.legends))n.legend[i]=L9(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=j0e(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Be(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function j0e(e,t){var n,r,i,a;if(!e)return t.clone();const o=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const l of R0e){const c=th(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return Zxt(f,d);case"title":return Gme(f,d);case"type":return u=!0,Yo("symbol")}return KO(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&u8(e.implicit,["encode","gradient"]),((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient)&&u8(e.explicit,["encode","gradient"])),e}function Zxt(e,t){return t.value==="circle"?t:e}function U0e(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function W0e(e){const t=e.component.legends,n={};for(const i of Be(t)){const a=e.getScaleComponent(i),o=hr(a.get("domains"));if(n[o])for(const s of n[o])j0e(s,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return zd(n).flat().map(i=>Jxt(i,e.config)).filter(i=>i!==void 0)}function Jxt(e,t){var n,r,i;const a=e.combine(),{disable:o,labelExpr:s,selections:u}=a,l=dt(a,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of uve)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&Et(l.encode.labels.update.text)&&(c=m0(s,"datum.label",l.encode.labels.update.text.signal)),U0e(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(Et(f)){const d=ayt[c];if(d){const{vgProp:h,part:p}=d;U0e(l,p,h,f),delete l[c]}}}return l}}function Qxt(e){return R0(e)||Y9(e)?ewt(e):V0e(e)}function ewt(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),V0e(e))}function V0e(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},a=t.data.reduce((o,s)=>{const u=Et(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return bt(o,u)||o.push(u),o},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const twt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class q0e extends Xc{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function H0e(e){e.component.projection=Fr(e)?nwt(e):awt(e)}function nwt(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,a=r?rwt(e):void 0;return new q0e(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,a)}}function rwt(e){const t=[],{encoding:n}=e;for(const r of[[Cl,Al],[_s,_u]])(pi(n[r[0]])||pi(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(bo)&&e.typedFieldDef(bo).type===_0&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(sa)),t}function iwt(e,t){const n=age(twt,i=>!!(!Qp(e.explicit,i)&&!Qp(t.explicit,i)||Qp(e.explicit,i)&&Qp(t.explicit,i)&&hr(e.get(i))===hr(t.get(i))));if(hr(e.size)===hr(t.size)){if(n)return e;if(hr(e.explicit)===hr({}))return t;if(hr(t.explicit)===hr({}))return e}return null}function awt(e){if(e.children.length===0)return;let t;for(const r of e.children)H0e(r);const n=age(e.children,r=>{const i=r.component.projection;if(i)if(t){const a=iwt(t,i);return a&&(t=a),!!a}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new q0e(r,t.specifiedProjection,t.size,Yt(t.data));for(const a of e.children){const o=a.component.projection;o&&(o.isFit&&i.data.push(...a.component.projection.data),a.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function owt(e,t,n,r){var i,a;if(Dw(t,n)){const o=Fr(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{},s=Ue(t,{expr:"datum"}),u=Ue(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ue(t,{binSuffix:"range",forAs:!0}),formula:FO(s,u,o.format,o.formatType,r)}}return{}}function G0e(e,t){return`${Fge(e)}_${t}`}function swt(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function z9(e,t,n){var r;const i=(r=zO(n,void 0))!==null&&r!==void 0?r:{},a=G0e(i,t);return e.getName(`${a}_bins`)}function uwt(e){return"as"in e}function K0e(e,t,n){let r,i;uwt(e)?r=Xt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ue(e,{forAs:!0}),Ue(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},zO(t,void 0)),o=G0e(a,e.field),{signal:s,extentSignal:u}=swt(n,o);if(OO(a.extent)){const c=a.extent,f=c.selection;i=v0e(n.getSelectionComponent(pr(f),f),c),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class zl extends qn{constructor(t,n){super(t);this.bins=n}clone(){return new zl(null,Yt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{if(Xo(a)&&er(a.bin)){const{key:s,binComponent:u}=K0e(a,a.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),owt(n,a,o,n.config))}return i},{});return Zn(r)?null:new zl(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:a}=K0e(n,n.bin,r);return new zl(t,{[i]:a})}merge(t,n){for(const r of Be(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Bd([...this.bins[r].as,...t.bins[r].as],yn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(zd(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(zd(this.bins).map(t=>t.field))}hash(){return`Bin ${yn(this.bins)}`}assemble(){return zd(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,a=t.bin,{extent:o}=a,s=dt(a,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:jd(t.field),as:r,signal:t.signal},OO(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:jd(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ue({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class I0 extends qn{constructor(t){super(null);t=t??{name:"source"};let n;if(pg(t)||(n=t.format?Object.assign({},Bc(t.format,["parse"])):{}),XO(t))this._data={values:t.values};else if(Mw(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Ive(t)?this._data={values:[{type:"Sphere"}]}:(Tve(t)||pg(t))&&(this._data={});this._generator=pg(t),t.name&&(this._name=t.name),n&&!Zn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function j9(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!j9(t.children))return!1}return!0}class Xw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new Xw(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${yn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Yw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new Yw(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${yn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function dI(e){return e instanceof I0||e instanceof Xw||e instanceof Yw}class X0e{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Jc extends X0e{constructor(){super();this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(dI(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class U9 extends X0e{}function lwt(e,t,n,r){const i=Fr(r)?r.encoding[Ol(t)]:void 0;if(Xo(n)&&Fr(r)&&B8(t,n,i,r.stack,r.markDef,r.config))e.add(Ue(n,{})),e.add(Ue(n,{suffix:"end"})),n.bin&&Dw(n,t)&&e.add(Ue(n,{binSuffix:"range"}));else if(ymt(t)){const a=vmt(t);e.add(r.getName(a))}else e.add(Ue(n));return e}function cwt(e,t){var n;for(const r of Be(t)){const i=t[r];for(const a of Be(i))r in e?e[r][a]=new Set([...(n=e[r][a])!==null&&n!==void 0?n:[],...i[a]]):e[r]={[a]:i[a]}}}class Au extends qn{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new Au(null,new Set(this.dimensions),Yt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},a=new Set;return!r||(n.forEachFieldDef((o,s)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Ue(o,{forAs:!0})]);else{if(Ud(d)||ng(d)){const p=Ud(d)?"argmin":"argmax",g=d[p];i[g]=(l=i[g])!==null&&l!==void 0?l:{},i[g][p]=new Set([Ue({op:p,field:g},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Ue(o,{forAs:!0})]);Xd(s)&&n.scaleDomain(s)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Ue({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Ue({field:h,aggregate:"max"},{forAs:!0})]))}else lwt(a,s,o,n)}),a.size+Be(i).length===0)?null:new Au(t,a,i)}static makeFromTransform(t,n){var r,i,a;const o=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(s["*"]=(r=s["*"])!==null&&r!==void 0?r:{},s["*"].count=new Set([f||Ue(u,{forAs:!0})])):(s[c]=(i=s[c])!==null&&i!==void 0?i:{},s[c][l]=new Set([f||Ue(u,{forAs:!0})])))}for(const u of(a=n.groupby)!==null&&a!==void 0?a:[])o.add(u);return o.size+Be(s).length===0?null:new Au(t,o,s)}merge(t){return zgt(this.dimensions,t.dimensions)?(cwt(this.measures,t.measures),!0):(Ivt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Be(this.measures)])}producedFields(){const t=new Set;for(const n of Be(this.measures))for(const r of Be(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${yn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const a of Be(this.measures))for(const o of Be(this.measures[a]))for(const s of this.measures[a][o])r.push(s),t.push(o),n.push(a==="*"?null:jd(a));return{type:"aggregate",groupby:[...this.dimensions].map(jd),ops:t,fields:n,as:r}}}class N0 extends qn{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const a of Ss){const o=n.facet[a];if(o){const{bin:s,sort:u}=o;this[a]=Object.assign({name:n.getName(`${a}_domain`),fields:[Ue(o),...er(s)?[Ue(o,{binSuffix:"end"})]:[]]},Rl(u)?{sortField:u}:vt(u)?{sortIndexField:T0(o,a)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ss)this[n]&&(t+=` ${n.charAt(0)}:${yn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Ss)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ss)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Es){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),a=r.get("range");if(xo(i)&&Yd(a)){const o=pI(this.childModel,n),s=K9(o);s?t[n]=s:Me(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],a=[],o=[],s=[];r&&r[i]&&(n?(a.push(`distinct_${r[i]}`),o.push("max")):(a.push(r[i]),o.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=MO,field:f}=u;a.push(f),o.push(c),s.push(Ue(u,{forAs:!0}))}else l&&(a.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},a.length?{fields:a,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:a}=this.model.component,o=[],s={};for(const c of F9){for(const f of M9){const d=(n=a[c]&&a[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const a=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:u}=this;if(o&&s&&(a.x||a.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=a.x)!==null&&t!==void 0?t:[],(n=a.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Uc,jc])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,a));if(u){const l=this.assembleFacetHeaderData(a);l&&r.push(...l)}return r}}function Y0e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function fwt(e,t){const n=cge(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=Y0e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=Y0e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Me(Umt(t)),null}function dwt(e){const t={};return cO(e.filter,n=>{var r;if(sme(n)){let i=null;k8(n)?i=n.equal:T8(n)?i=n.range[0]:O8(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(b0(i)?t[n.field]="date":Qr(i)?t[n.field]="number":Xt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function hwt(e){const t={};function n(r){jO(r)?t[r.field]="date":r.type==="quantitative"&&dmt(r.aggregate)?t[r.field]="number":Sw(r.field)>1?r.field in t||(t[r.field]="flatten"):W8(r)&&Rl(r.sort)&&Sw(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Fr(e)||ku(e))&&e.forEachFieldDef((r,i)=>{if(Xo(r))n(r);else{const a=ag(i),o=e.fieldDef(a);n(Object.assign(Object.assign({},r),{type:o.type}))}}),Fr(e)){const{mark:r,markDef:i,encoding:a}=e;if(tg(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",s=a[o];We(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function pwt(e){const t={};if(Fr(e)&&e.component.selection)for(const n of Be(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&Sw(i.field)>1&&(t[i.field]="flatten")}return t}class da extends qn{constructor(t,n){super(t);this._parse=n}clone(){return new da(null,Yt(this._parse))}hash(){return`Parse ${yn(this._parse)}`}static makeExplicit(t,n,r){let i={};const a=n.data;return!pg(a)&&a&&a.format&&a.format.parse&&(i=a.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const s of Be(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:Me(Uge(s,r[s],u.value)))}for(const s of Be(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:Me(Uge(s,n[s],u)))}const a=new Xc(n,r);i.copyAll(a);const o={};for(const s of Be(a.combine())){const u=a.get(s);u!==null&&(o[s]=u)}return Be(o).length===0||i.parseNothing?null:new da(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Be(this._parse)){const r=this._parse[n];Sw(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Be(this._parse))}dependentFields(){return new Set(Be(this._parse))}assembleTransforms(t=!1){return Be(this._parse).filter(n=>t?Sw(n)>1:!0).map(n=>{const r=fwt(n,this._parse[n]);return r?{type:"formula",expr:r,as:fge(n)}:null}).filter(n=>n!==null)}}class ah extends qn{clone(){return new ah(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([S0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:S0}}}class xg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new xg(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Bd(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`JoinAggregateTransform ${yn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const a of this.transform.joinaggregate)n.push(a.op),r.push(this.getDefaultName(a)),t.push(a.field===void 0?null:a.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function gwt(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Ue(r);return i&&t.push(i),t},[])}function mwt(e){return vt(e)&&e.every(t=>Xt(t))&&e.length>1}class Qc extends qn{constructor(t,n){super(t);this._stack=n}clone(){return new Qc(null,Yt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:a,offset:o="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(ei(f.order,"ascending"));const l={field:s,order:u};let c;return mwt(a)?c=a:Xt(a)?c=[a,a+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Qc(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:a,fieldChannel:o,offset:s,impute:u}=r;let l;if(a){const h=i[a];l=Ml(h)}const c=gwt(n),f=n.encoding.order;let d;return vt(f)||We(f)?d=Vme(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Qc(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${yn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ue(t,{binSuffix:"mid"})]:[Ue(t,{}),Ue(t,{binSuffix:"end"})]:[Ue(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:a,sort:o,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ue(r,{expr:"datum"})+`+${1-c}*`+Ue(r,{expr:"datum",binSuffix:"end"}),as:Ue(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...a,...n],key:Ue(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:s}),t}}class D0 extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new D0(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Bd(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`WindowTransform ${yn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],a=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),a.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>p8(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}class vwt extends Jc{run(t){const n=t.parent;if(t instanceof da){if(dI(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof da)this.setMutated(),n.merge(t);else{if(uge(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class ywt extends U9{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Be(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class bwt extends Jc{run(t){return t instanceof qa||t.numChildren()>0||t instanceof N0?this.flags:(this.setMutated(),t.remove(),this.flags)}}class xwt extends Jc{constructor(){super(...arguments);this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof $l){const n=t.producedFields();oge(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class wwt extends Jc{run(t){this.setContinue();const r=t.parent.children.filter(a=>a instanceof $l),i=r.pop();for(const a of r)this.setMutated(),i.merge(a);return this.flags}}function _wt(e){function t(n){if(!(n instanceof N0)){const r=n.clone();if(r instanceof qa){const i=V9+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Au||r instanceof Qc||r instanceof D0||r instanceof xg)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function W9(e){if(e instanceof N0)if(e.numChildren()===1&&!(e.children[0]instanceof qa)){const t=e.children[0];(t instanceof Au||t instanceof Qc||t instanceof D0||t instanceof xg)&&t.addDimensions(e.fields),t.swapWithParent(),W9(e)}else{const t=e.model.component.data.main;Z0e(t);const n=_wt(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(W9)}function Z0e(e){if(e instanceof qa&&e.type===sa&&e.numChildren()===1){const t=e.children[0];t instanceof N0||(t.swapWithParent(),Z0e(e))}}class Swt extends U9{constructor(){super()}run(t){t instanceof qa&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class Ewt extends U9{constructor(t){super();this.requiresSelectionId=t&&x9(t)}run(t){t instanceof ah&&(this.requiresSelectionId&&(dI(t.parent)||t.parent instanceof Au||t.parent instanceof da)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class Awt extends Jc{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(a=>a instanceof da);if(n.numChildren()>1&&i.length>=1){const a={},o=new Set;for(const s of i){const u=s.parse;for(const l of Be(u))l in a?a[l]!==u[l]&&o.add(l):a[l]=u[l]}for(const s of o)delete a[s];if(!Zn(a)){this.setMutated();const s=new da(n,a);for(const u of r){if(u instanceof da)for(const l of Be(a))delete u.parse[l];n.removeChild(u),u.parent=s,u instanceof da&&Be(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class Cwt extends Jc{run(t){const n=t.parent,r=n.children.filter(a=>a instanceof Au),i={};for(const a of r){const o=yn(a.groupBy);o in i||(i[o]=[]),i[o].push(a)}for(const a of Be(i)){const o=i[a];if(o.length>1){const s=o.pop();for(const u of o)s.merge(u)&&(n.removeChild(u),u.parent=s,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class kwt extends Jc{constructor(t){super();this.model=t}run(t){const n=t.parent,r=!(dI(n)||n instanceof C0||n instanceof da||n instanceof ah),i=[],a=[];for(const o of n.children)o instanceof zl&&(r&&!uge(n.producedFields(),o.dependentFields())?i.push(o):a.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof zl?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(a.length>1){const o=a.pop();for(const s of a)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class Twt extends Jc{run(t){const n=t.parent,r=[...n.children];if(!ww(r,s=>s instanceof qa)||n.numChildren()<=1)return this.setContinue(),this.flags;const a=[];let o;for(const s of r)if(s instanceof qa){let u=s;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof qa)u=l;else break}a.push(...u.children),o?(n.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else a.push(s);if(a.length){this.setMutated();for(const s of a)s.parent.removeChild(s),s.parent=o}return this.setContinue(),this.flags}}const V9="scale_",hI=5;function oh(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function Owt(e){return e}function Cu(e,t){return t.map(r=>{if(e instanceof Jc){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(Owt)}function J0e(e,t){let n=e.sources;const r=new Set;return r.add(Cu(new Swt,n)),r.add(Cu(new Ewt(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(Cu(new bwt,oh(n))),n=n.filter(i=>i.numChildren()>0),r.add(Cu(new vwt,oh(n))),r.add(Cu(new kwt(t),oh(n))),r.add(Cu(new xwt,oh(n))),r.add(Cu(new Awt,oh(n))),r.add(Cu(new Cwt,oh(n))),r.add(Cu(new wwt,oh(n))),r.add(Cu(new ywt,n)),r.add(Cu(new Twt,oh(n))),e.sources=n,r.has(!0)}function Iwt(e,t){j9(e.sources);let n=0,r=0;for(let i=0;i<hI&&J0e(e,t);i++)n++;e.sources.map(W9);for(let i=0;i<hI&&J0e(e,t);i++)r++;j9(e.sources),Math.max(n,r)===hI&&Me(`Maximum optimization runs(${hI}) reached.`)}class Zo{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Zo(()=>t(n))}}function Q0e(e){Fr(e)?Nwt(e):Dwt(e)}function Nwt(e){const t=e.component.scales;for(const n of Be(t)){const r=Fwt(e,n);if(t[n].setWithExplicit("domains",r),Pwt(e,n),e.component.data.isFaceted){let a=e;for(;!ku(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const s of r.value)Zd(s)&&(s.data=V9+s.data.replace(V9,""))}}}function Dwt(e){for(const n of e.children)Q0e(n);const t=e.component.scales;for(const n of Be(t)){let r,i=null;for(const a of e.children){const o=a.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=th(r,o.getWithExplicit("domains"),"domains","scale",G9);const s=o.get("selectionExtent");i&&s&&i.selection!==s.selection&&Me("The same selection must be used to override scale domains in a layered view."),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function Rwt(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:a}=eye(t,n);if(!i){Me(a);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=eye(t,n);if(i)return"unaggregated"}return e}function Fwt(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=Rwt(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&pi(r.x2)?pi(r.x)?th(sh(n,i,e,"x"),sh(n,i,e,"x2"),"domain","scale",G9):sh(n,i,e,"x2"):t==="y"&&pi(r.y2)?pi(r.y)?th(sh(n,i,e,"y"),sh(n,i,e,"y2"),"domain","scale",G9):sh(n,i,e,"y2"):sh(n,i,e,t)}function Mwt(e,t,n){return e.map(r=>({signal:`{data: ${G8(r,{timeUnit:n,type:t})}}`}))}function q9(e,t,n){var r;const i=(r=Va(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?Mwt(e,t,i):[e]}function sh(e,t,n,r){const{encoding:i}=n,a=pi(i[r]),{type:o}=a,s=a.timeUnit;if(m0t(t)){const f=sh(e,void 0,n,r),d=q9(t.unionWith,o,s);return hg([...f.value,...d])}else{if(Et(t))return hg([t]);if(t&&t!=="unaggregated"&&!fme(t))return hg(q9(t,o,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Yo([[0,1]]);const f=n.requestDataName(sa);return Yo([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Xd(r)&&We(a)?$wt(n,r,e):void 0;if(Qd(a)){const f=q9([a.datum],o,s);return Yo(f)}const c=a;if(t==="unaggregated"){const f=n.requestDataName(sa),{field:d}=a;return Yo([{data:f,field:Ue({field:d,aggregate:"min"})},{data:f,field:Ue({field:d,aggregate:"max"})}])}else if(er(c.bin)){if(xo(e))return Yo(e==="bin-ordinal"?[]:[{data:dO(l)?n.requestDataName(sa):n.requestDataName(YO),field:n.vgField(r,Dw(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!ki(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(er(f)){const d=z9(n,c.field,f);return Yo([new Zo(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Yo([{data:n.requestDataName(sa),field:n.vgField(r,{})}])}}else if(c.timeUnit&&bt(["time","utc"],e)&&B8(r,c,Fr(n)?n.encoding[Ol(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(sa);return Yo([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Yo(l?[{data:dO(l)?n.requestDataName(sa):n.requestDataName(YO),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(sa),field:n.vgField(r)}])}function H9(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":MO)},r?{field:jd(r)}:{}),i?{order:i}:{})}function Pwt(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=fme(i)&&i,s=kw(a)&&OO(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",o??s,!0)}function $wt(e,t,n){if(!xo(n))return;const r=e.fieldDef(t),i=r.sort;if(kme(i))return{op:"min",field:T0(r,t),order:"ascending"};const{stack:a}=e,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Rl(i)){const s=a&&!bt(o,i.field);return H9(i,s)}else if(Cme(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=a&&!bt(o,f);if(Ud(c)||ng(c))return H9({field:Ue(l),order:u},d);if(p8(c)||!c)return H9({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],i))return!0}}function eye(e,t){const{aggregate:n,type:r}=e;return n?Xt(n)&&!gmt[n]?{valid:!1,reason:svt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:uvt(e)}:{valid:!0}:{valid:!1,reason:ovt(e)}}function G9(e,t,n,r){return e.explicit&&t.explicit&&Me(hvt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Lwt(e){const t=Bd(e.map(o=>Zd(o)?dt(o,["sort"]):o),yn),n=Bd(e.map(o=>{if(Zd(o)){const s=o.sort;return s!==void 0&&!dO(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(o=>o!==void 0),yn);if(t.length===0)return;if(t.length===1){const o=e[0];if(Zd(o)&&n.length>0){let s=n[0];if(n.length>1)Me(Kge),s=!0;else if(ki(s)&&"field"in s){const u=s.field;o.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},o),{sort:s})}return o}const r=Bd(n.map(o=>dO(o)||!("op"in o)||o.op in cmt?o:(Me(gvt(o)),!0)),yn);let i;r.length===1?i=r[0]:r.length>1&&(Me(Kge),i=!0);const a=Bd(e.map(o=>Zd(o)?o.data:null),o=>o);return a.length===1&&a[0]!==null?Object.assign({data:a[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function K9(e){if(Zd(e)&&Xt(e.field))return e.field;if(Vvt(e)){let t;for(const n of e.fields)if(Zd(n)&&Xt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Me(mvt),t}return Me(vvt),t}else if(qvt(e)){Me(yvt);const t=e.fields[0];return Xt(t)?t:void 0}}function pI(e,t){const r=e.component.scales[t].get("domains").map(i=>(Zd(i)&&(i.data=e.lookupDataSource(i.data)),i));return Lwt(r)}function tye(e){return R0(e)||Y9(e)?e.children.reduce((t,n)=>t.concat(tye(n)),nye(e)):nye(e)}function nye(e){return Be(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=dt(i,["name","type","selectionExtent","domains","range","reverse"]),d=Bwt(i.range,a,n);let h;s&&(h=Bbt(e,s));const p=pI(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Bwt(e,t,n){return Nl(n)&&Yd(e)?{step:{signal:t+"_step"}}:e}class rye extends Xc{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:ww(this.get("domains"),t=>vt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const zwt=["range","scheme"];function iye(e){return e==="x"?"width":e==="y"?"height":void 0}function jwt(e){const t=e.component.scales;for(const n of kO){const r=t[n];if(!r)continue;const i=Uwt(n,e);r.setWithExplicit("range",i)}}function aye(e,t){const n=e.fieldDef(t);if(n&&n.bin&&er(n.bin)){const r=z9(e,n.field,n.bin),i=iye(t),a=e.getName(i);return new Zo(()=>{const o=e.getSignalName(r),s=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(a)} / (${s})`})}}function Uwt(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e).get("type");for(const o of zwt)if(n[o]!==void 0){const s=dme(a,o),u=hme(e,o);if(!s)Me(Hge(a,o,e));else if(u)Me(u);else switch(o){case"range":return vt(n.range)&&Nl(e)?hg(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return Zo.fromName(f,c)}return l})):hg(n.range);case"scheme":return hg(Wwt(n[o]))}}if(e===wr||e===hi){const o=e===wr?"width":"height",s=r[o];if(Pl(s)){if(xo(a))return hg({step:s.step});Me(Gge(o))}}return Yo(Vwt(e,t))}function Wwt(e){return g0t(e)?Object.assign({scheme:e.name},Bc(e,["name"])):{scheme:e}}function Vwt(e,t){const{size:n,config:r,mark:i,encoding:a}=t,o=t.getSignalName.bind(t),{type:s}=pi(a[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case wr:case hi:{if(bt(["point","band"],l)){if(e===wr&&!n.width){const p=Fw(r.view,"width");if(Pl(p))return p}else if(e===hi&&!n.height){const p=Fw(r.view,"height");if(Pl(p))return p}}const d=iye(e),h=t.getName(d);return e===hi&&As(l)?[Zo.fromName(o,h),0]:[0,Zo.fromName(o,h)]}case qc:{const d=t.component.scales[e].get("zero"),h=oye(i,d,r),p=Gwt(i,n,t,r);return DO(l)?Hwt(h,p,qwt(l,r,c,e)):[h,p]}case wu:return[0,Math.PI*2];case rg:return[0,360];case El:return[0,new Zo(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case qd:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Hd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case bo:return"symbol";case yo:case kl:case Tl:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Hc:case Wd:case Vd:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function qwt(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&vt(n)?n.length+1:(Me(kvt(r)),3)}}function Hwt(e,t,n){const r=()=>{const i=Rw(t),a=Rw(e),o=`(${i} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${i} + ${o}, ${o})`};return Et(t)?new Zo(r):{signal:r()}}function oye(e,t,n){if(t)return Et(t)?{signal:`${t.signal} ? 0 : ${oye(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(IO("size",e))}const sye=.95;function Gwt(e,t,n,r){const i={x:aye(n,"x"),y:aye(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const a=uye(t,i,r.view);return Qr(a)?a-1:new Zo(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const a=uye(t,i,r.view);return Qr(a)?Math.pow(sye*a,2):new Zo(()=>`pow(${sye} * ${a.signal}, 2)`)}}throw new Error(IO("size",e))}function uye(e,t,n){const r=Pl(e.width)?e.width.step:HO(n,"width"),i=Pl(e.height)?e.height.step:HO(n,"height");return t.x||t.y?new Zo(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function lye(e,t){Fr(e)?Kwt(e,t):dye(e,t)}function Kwt(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=e;for(const s of Be(n)){const u=o[s],l=n[s],c=e.getScaleComponent(s),f=pi(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=dme(h,t),v=hme(s,t);if(d!==void 0&&(m?v&&Me(v):Me(Hge(h,t,s))),m&&v===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const y=t in cye?cye[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:a,config:r}):r.scale[t];y!==void 0&&l.set(t,y,!1)}}}const cye={bins:({model:e,fieldOrDatumDef:t})=>We(t)?Xwt(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Ywt(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>Zwt(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>Jwt(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>Qwt(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>e2t(e,t,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=We(e)?e.sort:void 0;return t2t(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>n2t(e,t,n,r,i)};function fye(e){Fr(e)?jwt(e):dye(e,"range")}function dye(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?fye(r):lye(r,t);for(const r of Be(n)){let i;for(const a of e.children){const o=a.component.scales[r];if(o){const s=o.getWithExplicit(t);i=th(i,s,t,"scale",kve((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function Xwt(e,t){const n=t.bin;if(er(n)){const r=z9(e,t.field,n);return new Zo(()=>e.getSignalName(r))}else if(Wa(n)&&kw(n)&&n.step!==void 0)return{step:n.step}}function Ywt(e,t){if(bt([yo,kl,Tl],e)&&t!=="nominal")return"hcl"}function Zwt(e,t,n){var r;if(!(((r=Ml(n))===null||r===void 0?void 0:r.bin)||bt([ti.TIME,ti.UTC],e)))return t in Kd?!0:void 0}function Jwt(e,t,n,r,i,a){if(e in Kd){if(Su(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:s}=i;if(o==="bar"&&!(We(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===ti.POINT)return n.pointPadding}}function Qwt(e,t,n,r){if(e===void 0&&t in Kd){const{bandPaddingInner:i,barBandPaddingInner:a,rectBandPaddingInner:o}=r;return ei(i,n==="bar"?a:o)}}function e2t(e,t,n,r,i,a){if(e===void 0&&t in Kd&&n===ti.BAND){const{bandPaddingOuter:o}=a;return ei(o,Et(i)?{signal:`${i.signal}/2`}:i/2)}}function t2t(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return As(e)&&t==="descending"?Et(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(As(e)&&t==="descending")return!0}function n2t(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&As(i)){if(vt(n)){const o=n[0],s=n[n.length-1];if(o<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!DO(i))return!0;if(!(We(t)&&t.bin)&&bt([...Es,...Cmt],e)){const{orient:o,type:s}=r;return!(bt(["bar","area","line","trail"],s)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function r2t(e,t,n,r){const i=i2t(t,n,r),{type:a}=e;return Xd(t)?a!==void 0?gme(t,a)?We(n)&&!pme(a,n.type)?(Me(fvt(a,i)),i):a:(Me(cvt(t,a,i)),i):i:null}function i2t(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(v0(e)||TO(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Me(w8(e,"ordinal")),"ordinal";if(e in Kd){if(bt(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in y8)return"band";return t.band!==void 0||V8(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return v0(e)?"time":TO(e)==="discrete"?(Me(w8(e,"temporal")),"ordinal"):We(t)&&t.timeUnit&&Va(t.timeUnit).utc?"utc":"time";case"quantitative":return v0(e)?We(t)&&er(t.bin)?"bin-ordinal":"linear":TO(e)==="discrete"?(Me(w8(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Vge(t.type))}function a2t(e,{ignoreRange:t}={}){hye(e),Q0e(e);for(const n of b0t)lye(e,n);t||fye(e)}function hye(e){Fr(e)?e.component.scales=o2t(e):e.component.scales=u2t(e)}function o2t(e){const{encoding:t,mark:n}=e;return kO.reduce((r,i)=>{const a=pi(t[i]);if(a&&n===yge&&i===bo&&a.type===_0)return r;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o=o??{};const s=r2t(o,i,a,n);r[i]=new rye(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}const s2t=kve((e,t)=>lme(e)-lme(t));function u2t(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const a of e.children){hye(a);for(const o of Be(a.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:Nxt(o,e),i.scale[o]==="shared"){const s=r[o],u=a.component.scales[o].getWithExplicit("type");s?n0t(s.value,u.value)?r[o]=th(s,u,"type","scale",s2t):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const a of Be(r)){const o=e.scaleName(a,!0),s=r[a];n[a]=new rye(o,s);for(const u of e.children){const l=u.component.scales[a];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class X9{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Fr(e){return(e==null?void 0:e.type)==="unit"}function ku(e){return(e==null?void 0:e.type)==="facet"}function Y9(e){return(e==null?void 0:e.type)==="concat"}function R0(e){return(e==null?void 0:e.type)==="layer"}class Z9{constructor(t,n,r,i,a,o,s){var u,l;this.type=n,this.parent=r,this.config=a,this.view=s,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=a,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=eh(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new X9,this.projectionNameMap=r?r.projectionNameMap:new X9,this.signalNameMap=r?r.signalNameMap:new X9,this.data=t.data,this.description=t.description,this.transforms=fbt((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:dyt(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:PO(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Xc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Yt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){a2t(this)}parseProjection(){H0e(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){z0e(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=dt(t,["style"]),r={};for(const i of Be(n)){const a=n[i];a!==void 0&&(r[i]=jr(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=jr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Zn(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=dt(t,["spacing"]),{component:i,config:a}=this,o=Ixt(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Ss)t[r].title&&n.push(Ext(this,r));for(const r of F9)n=n.concat(Axt(this,r));return n}assembleAxes(){return cxt(this.component.axes,this.config)}assembleLegends(){return W0e(this)}assembleProjections(){return Qxt(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:a}=i,o=dt(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},zme(this.config.title).nonMark),o),a?{encode:{update:a}}:{});if(s.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],s.anchor)&&(s.frame=(n=s.frame)!==null&&n!==void 0?n:"group"):s.anchor=(r=s.anchor)!==null&&r!==void 0?r:"start",Zn(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||ku(this.parent)?tye(this):[];i.length>0&&(n.scales=i);const a=this.assembleAxes();a.length>0&&(n.axes=a);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return pr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(ku(this.parent)){const n=N0e(t),r=CO(n),i=this.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(xo(a)&&Yd(o)){const s=i.get("name"),u=pI(this,r),l=K9(u);if(l){const c=Ue({aggregate:"distinct",field:l},{expr:"datum"});return{signal:I0e(s,i,c)}}else return Me(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Oge(t)&&Xd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Pmt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class pye extends Z9{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Ue(r,n)}reduceFieldDef(t,n){return Kme(this.getMapping(),(r,i,a)=>{const o=Ml(i);return o?t(r,o,a):r},n)}forEachFieldDef(t,n){Y8(this.getMapping(),(r,i)=>{const a=Ml(r);a&&t(a,i)},n)}}class gI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(a=o[1])!==null&&a!==void 0?a:"density"]}clone(){return new gI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=dt(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class Zw extends qn{constructor(t,n){super(t);this.filter=n}clone(){return new Zw(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:a}=n;if(Fn("invalid",a,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Xd(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");As(d)&&l.aggregate!=="count"&&!tg(i)&&(u[l.field]=l)}return u},{});return Be(s).length?new Zw(t,s):null}dependentFields(){return new Set(Be(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${yn(this.filter)}`}assemble(){const t=Be(this.filter).reduce((n,r)=>{const i=this.filter[r],a=Ue(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${a}) || (isValid(${a}) && isFinite(+${a})))`):i.type==="quantitative"&&(n.push(`isValid(${a})`),n.push(`isFinite(+${a})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class mI extends qn{constructor(t,n){super(t);this.transform=n,this.transform=Yt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((a,o)=>{var s;return(s=i[o])!==null&&s!==void 0?s:a})}clone(){return new mI(this.parent,Yt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${yn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class vI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new vI(null,Yt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${yn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class F0 extends qn{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new F0(null,Yt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Cl,Al],[_s,_u]]){const a=i.map(o=>{const s=pi(n.encoding[o]);return We(s)?s.field:Qd(s)?{expr:`${s.datum}`}:Gc(s)?{expr:`${s.value}`}:void 0});(a[0]||a[1])&&(t=new F0(t,a,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(bo)){const i=n.typedFieldDef(bo);i.type===_0&&(t=new F0(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(Xt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${yn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class Jw extends qn{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new Jw(null,this.projection,Yt(this.fields),Yt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Cl,Al],[_s,_u]]){const i=r.map(o=>{const s=pi(n.encoding[o]);return We(s)?s.field:Qd(s)?{expr:`${s.datum}`}:Gc(s)?{expr:`${s.value}`}:void 0}),a=r[0]===_s?"2":"";(i[0]||i[1])&&(t=new Jw(t,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}return t}dependentFields(){return new Set(this.fields.filter(Xt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${yn(this.fields)} ${yn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class wg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new wg(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new wg(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,a=r.y;if(We(i)&&We(a)){const o=i.impute?i:a.impute?a:void 0;if(o===void 0)return;const s=i.impute?a:a.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=Xme(n.mark,r);return new wg(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${yn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:a,value:o,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:qyt(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},a?{groupby:a}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class yI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.loess]}clone(){return new yI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=dt(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class Qw extends qn{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new Qw(null,Yt(this.transform),this.secondary)}static make(t,n,r,i){const a=n.component.data.sources,{from:o}=r;let s=null;if(Gyt(o)){let u=yye(o.data,a);u||(u=new I0(o.data),a.push(u));const l=n.getName(`lookup_${i}`);s=new qa(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(Kyt(o)){const u=o.selection;if(r=Object.assign({as:u},r),s=n.getSelectionComponent(pr(u),u).materialized,!s)throw new Error(Bmt(u))}return new Qw(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?zr(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${yn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:zr(this.transform.as)}:{});else{let n=this.transform.as;Xt(n)||(Me(Vmt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class bI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new bI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=dt(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class xI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.regression]}clone(){return new xI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=dt(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class wI extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new wI(null,Yt(this.transform))}addDimensions(t){var n;this.transform.groupby=Bd(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${yn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:a}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),a!==void 0?{op:a}:{}),r!==void 0?{groupby:r}:{})}}class _I extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new _I(null,Yt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${yn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function gye(e){let t=0;function n(r,i){var a;if(r instanceof I0&&!r.isGenerator&&!Mw(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof da&&(r.parent instanceof I0&&!i.source?(i.format=Object.assign(Object.assign({},(a=i.format)!==null&&a!==void 0?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof N0){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof Xw||r instanceof Yw||r instanceof Zw||r instanceof C0||r instanceof k0||r instanceof Jw||r instanceof F0||r instanceof Au||r instanceof Qw||r instanceof D0||r instanceof xg||r instanceof vI||r instanceof mI||r instanceof gI||r instanceof yI||r instanceof bI||r instanceof xI||r instanceof ah||r instanceof _I||r instanceof wI)&&i.transform.push(r.assemble()),(r instanceof zl||r instanceof $l||r instanceof wg||r instanceof Qc)&&i.transform.push(...r.assemble()),r instanceof qa&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof qa?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof qa&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function l2t(e){const t=[],n=gye(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function c2t(e,t){var n,r;const i=[],a=gye(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();a(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function f2t(e){return e==="top"||e==="left"||Et(e)?"header":"footer"}function d2t(e){for(const t of Ss)h2t(e,t);vye(e,"x"),vye(e,"y")}function h2t(e,t){var n;const{facet:r,config:i,child:a,component:o}=e;if(e.channelHasField(t)){const s=r[t],u=O0("title",null,i,t);let l=lg(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});a.component.layoutHeaders[t].title&&(l=vt(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const c=O0("labelOrient",s,i,t),f=(n=s.header)!==null&&n!==void 0?n:{},d=ei(f.labels,i.header.labels,!0),h=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:s,[h]:t==="facet"?[]:[mye(e,t,d)]}}}function mye(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function vye(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:a}=e.component;if(a.axis[t]=L9(a,t),a.axis[t]==="shared"){const o=t==="x"?"column":"row",s=i[o];for(const u of r.component.axes[t]){const l=f2t(u.get("orient"));s[l]=(n=s[l])!==null&&n!==void 0?n:[mye(e,o,!1)];const c=Kw(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function p2t(e){J9(e),SI(e,"width"),SI(e,"height")}function g2t(e){J9(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";SI(e,t),SI(e,n)}function J9(e){for(const t of e.children)t.parseLayoutSize()}function SI(e,t){const n=N0e(t),r=CO(n),i=e.component.resolve,a=e.component.layoutSize;let o;for(const s of e.children){const u=s.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=th(o,u,n,"")}else o=u}if(o){for(const s of e.children)e.renameSignal(s.getName(n),e.getName(t)),s.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function m2t(e){const{size:t,component:n}=e;for(const r of Es){const i=Il(r);if(t[i]){const a=t[i];n.layoutSize.set(i,Pl(a)?"step":a,!0)}else{const a=v2t(e,i);n.layoutSize.set(i,a,!1)}}}function v2t(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const a=i.get("type"),o=i.get("range");if(xo(a)){const s=Fw(r.view,t);return Yd(o)||Pl(s)?"step":s}else return o9(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return o9(r.view,t);{const a=Fw(r.view,t);return Pl(a)?a.step:a}}}function Q9(e,t,n){return Ue(t,Object.assign({suffix:`by_${Ue(e)}`},n??{}))}class e2 extends pye{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=r7(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return Iw(t)?Kme(t,(r,i,a)=>bt([jc,Uc],a)?i.field===void 0?(Me(x8(i,a)),r):(r[a]=H8(i,a,n),r):(Me(IO(a,"facet")),r),{}):{facet:H8(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=EI(this),this.child.parseData()}parseLayoutSize(){J9(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),d2t(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const a of Ss)for(const o of M9){const s=this.component.layoutHeaders[a],u=s[o],{facetFieldDef:l}=s;if(l){const c=O0("titleOrient",l,this.config,a);if(bt(["right","bottom"],c)){const f=lI(a,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=a==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";a!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][a]=.5),s.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[a==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof e2))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof e2?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ue(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof e2){if(this.child.channelHasField("column")){const i=Ue(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Es){const a=this.child.component.scales[i];if(a&&!a.merged){const o=a.get("type"),s=a.get("range");if(xo(o)&&Yd(s)){const u=pI(this.child,i),l=K9(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):Me(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:a,ops:o,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ss){const f=this.facet[c];if(f){u.push(Ue(f));const{bin:d,sort:h}=f;if(er(d)&&u.push(Ue(f,{binSuffix:"end"})),Rl(h)){const{field:p,op:g=MO}=h,m=Q9(f,h);r&&i?(a.push(m),o.push("max"),s.push(m)):(a.push(p),o.push(g),s.push(m))}else if(vt(h)){const p=T0(f,c);a.push(p),o.push("max"),s.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||a.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),a.length?{fields:a,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Rl(r.sort)?[Q9(r,r.sort,{expr:"datum"})]:vt(r.sort)?[T0(r,t,{expr:"datum"})]:[Ue(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Rl(i)?i.order:!vt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return P9(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of F9)if(t[i]){const a=O0("labelOrient",t[i],n,i);if(bt(r[i],a))return P9(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=l2t(n),i=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ss.map(u=>this.facetSortFields(u)).flat(),order:Ss.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Mbt(this,[])))]}getMapping(){return this.facet}}function y2t(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const a of[n,r])if(Rl(a.sort)){const{field:o,op:s=MO}=a.sort;e=i=new xg(e,{joinaggregate:[{op:s,field:o,as:Q9(a,a.sort,{forAs:!0})}],groupby:[Ue(a)]})}return i}return null}function yye(e,t){var n,r,i,a,o,s,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=h.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((a=h.format)===null||a===void 0?void 0:a.feature))&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((s=h.format)===null||s===void 0?void 0:s.feature))&&!((((u=e.format)===null||u===void 0?void 0:u.mesh)||((l=h.format)===null||l===void 0?void 0:l.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(XO(e)&&XO(h)){if(bw(e.values,h.values))return d}else if(Mw(e)&&Mw(h)){if(e.url===h.url)return d}else if(Tve(e)&&e.name===d.dataName)return d}}return null}function b2t(e,t){if(e.data||!e.parent){if(e.data===null){const r=new I0({values:[]});return t.push(r),r}const n=yye(e.data,t);if(n)return pg(e.data)||(n.data.format=Lgt({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new I0(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function x2t(e,t,n){var r,i;let a=0;for(const o of t.transforms){let s,u;if(ibt(o))u=e=new k0(e,o),s="derived";else if(Nve(o)){const l=dwt(o);u=e=(r=da.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new C0(e,t,o.filter)}else if(abt(o))u=e=zl.makeFromTransform(e,o,t),s="number";else if(sbt(o))s="date",n.getWithExplicit(o.field).value===void 0&&(e=new da(e,{[o.field]:s}),n.set(o.field,s,!1)),u=e=$l.makeFromTransform(e,o);else if(ubt(o))u=e=Au.makeFromTransform(e,o),s="number",x9(t)&&(e=new ah(e));else if(Hyt(o))u=e=Qw.make(e,t,o,a++),s="derived";else if(tbt(o))u=e=new D0(e,o),s="number";else if(nbt(o))u=e=new xg(e,o),s="number";else if(lbt(o))u=e=Qc.makeFromTransform(e,o),s="derived";else if(cbt(o))u=e=new vI(e,o),s="derived";else if(rbt(o))u=e=new mI(e,o),s="derived";else if(Xyt(o))u=e=new wI(e,o),s="derived";else if(ebt(o))e=new _I(e,o);else if(obt(o))u=e=wg.makeFromTransform(e,o),s="derived";else if(Yyt(o))u=e=new gI(e,o),s="derived";else if(Zyt(o))u=e=new bI(e,o),s="derived";else if(Jyt(o))u=e=new xI(e,o),s="derived";else if(Qyt(o))u=e=new yI(e,o),s="derived";else{Me(Wmt(o));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function EI(e){var t,n,r,i,a,o,s,u,l,c;let f=b2t(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new Vyt,g=e.data;pg(g)?(Ove(g)?f=new Yw(f,g.sequence):f9(g)&&(f=new Xw(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=da.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new ah(f);const m=e.parent&&R0(e.parent);(Fr(e)||ku(e))&&m&&(f=(r=zl.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=x2t(f,e,p));const v=pwt(e),y=hwt(e);f=(i=da.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,Fr(e)&&(f=F0.parseAll(f,e),f=Jw.parseAll(f,e)),(Fr(e)||ku(e))&&(m||(f=(a=zl.makeFromEncoding(f,e))!==null&&a!==void 0?a:f),f=(o=$l.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=k0.parseAllForSortIndex(f,e));const b=e.getName(YO),x=new qa(f,b,YO,h);if(d[b]=x,f=x,Fr(e)){const _=Au.makeFromEncoding(f,e);_&&(f=_,x9(e)&&(f=new ah(f))),f=(s=wg.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=Qc.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}Fr(e)&&(f=(l=Zw.make(f,e))!==null&&l!==void 0?l:f);const w=e.getName(sa),S=new qa(f,w,sa,h);d[w]=S,f=S,Fr(e)&&uxt(e,S);let A=null;if(ku(e)){const _=e.getName("facet");f=(c=y2t(f,e.facet))!==null&&c!==void 0?c:f,A=new N0(f,e,_,S.getSource()),d[_]=A}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:S,facetRoot:A,ancestorParse:p})}class w2t extends Z9{constructor(t,n,r,i){var a,o,s,u;super(t,"concat",n,r,i,t.resolve);(((o=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&Me(jmt),this.children=this.getChildren(t).map((l,c)=>r7(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=EI(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return qO(t)?t.vconcat:a9(t)?t.hconcat:t.concat}parseLayoutSize(){g2t(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=$9(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function _2t(e){return e===!1||e===null}const S2t=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},pge),{labelExpr:1,encode:1}),bye=Be(S2t);class e7 extends Xc{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new e7(Yt(this.explicit),Yt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!_2t(this.get(t))}hasOrientSignalRef(){return Et(this.explicit.orient)}}function E2t(e,t,n){var r;const{encoding:i,config:a}=e,o=(r=pi(i[t]))!==null&&r!==void 0?r:pi(i[Ol(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return ug(l)?Object.assign({text:$8({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:a})},n):n}function A2t(e){return Es.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[D2t(n,e)]),t),{})}const C2t={bottom:"top",top:"bottom",left:"right",right:"left"};function k2t(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const o of Be(a.component.axes))r.axis[o]=L9(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=T2t(n[o],a.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const a of Es){for(const o of e.children)if(!!o.component.axes[a]){if(r.axis[a]==="independent"){n[a]=((t=n[a])!==null&&t!==void 0?t:[]).concat(o.component.axes[a]);for(const s of o.component.axes[a]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!Et(u)){if(i[u]>0&&!l){const c=C2t[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete o.component.axes[a]}if(r.axis[a]==="independent"&&n[a]&&n[a].length>1)for(const o of n[a])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function T2t(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){const o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=O2t(i,a)}}}else return t.map(n=>n.clone());return e}function O2t(e,t){for(const n of bye){const r=th(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,a)=>{switch(n){case"title":return Gme(i,a);case"gridScale":return{explicit:i.explicit,value:ei(i.value,a.value)}}return KO(i,a,n,"axis")});e.setWithExplicit(n,r)}return e}function I2t(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Et(n.labelAngle)?n.labelAngle:pO(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===A0e(r,i))return!0}return e===n[t]}const N2t=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function D2t(e,t){var n,r,i;let a=t.axis(e);const o=new e7,s=pi(t.encoding[e]),{mark:u,config:l}=t,c=(a==null?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||xxt(e),f=t.getScaleComponent(e).get("type"),d=hxt(e,f,c,t.config),h=a!==void 0?!a:D9("disable",l,a==null?void 0:a.style,d).configValue;if(o.set("disable",h,a!==void 0),h)return o;a=a||{};const p=vxt(t,a,e,s,d),g={fieldOrDatumDef:s,axis:a,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of bye){const b=y in _0e?_0e[y](g):gge(y)?a[y]:void 0,x=b!==void 0,w=I2t(b,y,a,t,e);if(x&&w)o.set(y,b,w);else{const{configValue:S=void 0,configFrom:A=void 0}=gge(y)&&y!=="values"?D9(y,t.config,a.style,d):{},_=S!==void 0;x&&!_?o.set(y,b,w):(A!=="vgAxisConfig"||N2t.has(y)&&_||c8(S)||Et(S))&&o.set(y,S,!1)}}const m=(i=a.encoding)!==null&&i!==void 0?i:{},v=hge.reduce((y,b)=>{var x;if(!o.hasAxisPart(b))return y;const w=D0e((x=m[b])!==null&&x!==void 0?x:{},t),S=b==="labels"?E2t(t,e,w):w;return S!==void 0&&!Zn(S)&&(y[b]={update:S}),y},{});return Zn(v)||o.set("encode",v,!!a.encoding||a.labelAngle!==void 0),o}function R2t({encoding:e,size:t}){for(const n of Es){const r=Il(n);Pl(t[r])&&Fl(e[n])&&(delete t[r],Me(Gge(r)))}return t}function F2t(e,t,n,{graticule:r}){const i=_l(e)?Object.assign({},e):{type:e},a=Fn("orient",i,n);if(i.orient=L2t(i.type,t,a),a!==void 0&&a!==i.orient&&Me(rvt(i.orient,a)),i.type==="bar"&&i.orient){const l=Fn("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:imt[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Fn("opacity",i,n)===void 0&&(i.opacity=P2t(i.type,t)),i.filled===void 0&&(i.filled=r?!1:$2t(i,n)),Fn("cursor",i,n)===void 0&&(i.cursor=M2t(i,t,n)),i}function M2t(e,t,n){return t.href||e.href||Fn("href",e,n)?"pointer":e.cursor}function P2t(e,t){if(bt([yO,f8,d8,h8],e)&&!K8(t))return .7}function $2t(e,t){const n=fg("filled",e,t),r=e.type;return ei(n,r!==yO&&r!==vO&&r!==bO)}function L2t(e,t,n){switch(e){case yO:case d8:case h8:case vge:case Ygt:case Xgt:return}const{x:r,y:i,x2:a,y2:o}=t;switch(e){case mO:if(We(r)&&(Wa(r.bin)||We(i)&&i.aggregate&&!r.aggregate))return"vertical";if(We(i)&&(Wa(i.bin)||We(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(We(r)&&r.type===og&&!er(r.bin)||U8(r)))return"horizontal";if(!o&&(We(i)&&i.type===og&&!er(i.bin)||U8(i)))return"vertical"}case bO:if(a&&!(We(r)&&Wa(r.bin))&&o&&!(We(i)&&Wa(i.bin)))return;case gO:if(o)return We(i)&&Wa(i.bin)?"horizontal":"vertical";if(a)return We(r)&&Wa(r.bin)?"vertical":"horizontal";if(e===bO){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case vO:case f8:{const s=Fl(r),u=Fl(i);if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===w0,d=c.type===w0;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const B2t={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),nh(e,"radius","arc")),nh(e,"theta","arc"))},z2t={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),JO("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),JO("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),p9(e))},j2t={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","bar")),nh(e,"y","bar"))},U2t={vgMark:"shape",encodeEntry:e=>Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&We(n)&&n.type===_0?{field:Ue(n,{expr:"datum"})}:{})]}},W2t={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","image")),nh(e,"y","image")),d9(e,"url"))},V2t={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),Ti("size",e,{vgChannel:"strokeWidth"})),p9(e))},q2t={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),Ti("size",e)),p9(e))};function t7(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),Ti("size",e)),Ti("angle",e)),H2t(e,n,t))}function H2t(e,t,n){return n?{shape:{value:n}}:Ti("shape",e)}const G2t={vgMark:"symbol",encodeEntry:e=>t7(e)},K2t={vgMark:"symbol",encodeEntry:e=>t7(e,"circle")},X2t={vgMark:"symbol",encodeEntry:e=>t7(e,"square")},Y2t={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","rect")),nh(e,"y","rect"))},Z2t={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),JO("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),JO("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Ti("size",e,{vgChannel:"strokeWidth"}))}},J2t={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),d9(e)),Ti("size",e,{vgChannel:"fontSize"})),Ti("angle",e)),zve("align",Q2t(e.markDef,n,t))),zve("baseline",e_t(e.markDef,n,t))),ua("radius",e,{defaultPos:null,isMidPoint:!0})),ua("theta",e,{defaultPos:null,isMidPoint:!0}))}};function Q2t(e,t,n){if(Fn("align",e,n)===void 0)return"center"}function e_t(e,t,n){if(Fn("baseline",e,n)===void 0)return"middle"}const t_t={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",a=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid",vgChannel:"xc"})),ua("y",e,{defaultPos:"mid",vgChannel:"yc"})),Ti("size",e,{defaultValue:n_t(e),vgChannel:i})),{[a]:jr(Fn("thickness",n,t))})}};function n_t(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,a=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=Fn("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&Yd(u)&&Qr(u.step)?u.step*3/4:HO(n.view,a)*3/4}}const AI={arc:B2t,area:z2t,bar:j2t,circle:K2t,geoshape:U2t,image:W2t,line:V2t,point:G2t,rect:Y2t,rule:Z2t,square:X2t,text:J2t,tick:t_t,trail:q2t};function r_t(e){return bt([vO,gO,Zgt],e.mark)?i_t(e):bt([mO],e.mark)?a_t(e):CI(e)}const xye="faceted_path_";function i_t(e){const t=Xme(e.mark,e.encoding),n=CI(e,{fromPrefix:t.length>0?xye:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:xye+e.requestDataName(sa),data:e.requestDataName(sa),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const wye="stack_group_";function a_t(e){const t=C8.some(n=>Fn(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=CI(e,{fromPrefix:wye}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),a=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},xw(n.encode.update,["y","yc","y2","height",...C8])),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Bc(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},xw(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Bc(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of C8){const d=fg(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=jr(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Ue(u)?[Ue(u)]:[];return((u==null?void 0:u.bin)||(u==null?void 0:u.timeUnit))&&l.push(Ue(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=fg(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:jr(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(sa),name:wye+e.requestDataName(sa),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}else return CI(e)}function o_t(e){const{encoding:t,stack:n,mark:r,markDef:i,config:a}=e,o=t.order;if(!(!vt(o)&&Gc(o)&&ige(o.value)||!o&&ige(Fn("order",i,a)))){if((vt(o)||We(o))&&!n)return Vme(o,{expr:"datum"});if(tg(r)){const s=i.orient==="horizontal"?"y":"x",u=t[s];if(We(u)){const l=u.sort;if(vt(l))return{field:Ue(u,{prefix:s,suffix:"sort_index",expr:"datum"})};if(Rl(l))return{field:Ue({aggregate:K8(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(Cme(l)){const c=e.fieldDef(l.encoding);return{field:Ue(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Ue(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function CI(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,a=ei(r.clip,s_t(e),u_t(e)),o=Ume(r),s=e.encoding.key,u=o_t(e),l=l_t(e),c=Fn("aria",r,i),f=AI[n].postEncodingTransform?AI[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:AI[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(sa)},encode:{update:AI[n].encodeEntry(e)}}),f?{transform:f}:{})]}function s_t(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function u_t(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function l_t(e){if(!e.component.selection)return null;const t=Be(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Be(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class _ye extends pye{constructor(t,n,r,i={},a){var o,s;super(t,"unit",n,r,a,void 0,lve(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=_l(t.mark)?t.mark.type:t.mark;this.markDef=F2t(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},a,{graticule:t.data&&f9(t.data)});const l=this.encoding=U0t((s=t.encoding)!==null&&s!==void 0?s:{},this.markDef,a);this.size=R2t({encoding:l,size:lve(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=mve(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===yge,r=t&&bmt.some(i=>It(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return kO.reduce((r,i)=>{var a;const o=pi(n[i]);return o&&(r[i]=(a=o.scale)!==null&&a!==void 0?a:{}),r},{})}initAxes(t){return Es.reduce((n,r)=>{const i=t[r];if(It(i)||r===wr&&It(t.x2)||r===hi&&It(t.y2)){const a=It(i)?i.axis:void 0;n[r]=a&&Object.assign({},a)}return n},{})}initLegend(t){return kmt.reduce((n,r)=>{const i=pi(t[r]);if(i&&Omt(r)){const a=i.legend;n[r]=a&&Object.assign({},a)}return n},{})}parseData(){this.component.data=EI(this)}parseLayoutSize(){m2t(this)}parseSelections(){this.component.selection=sxt(this,this.selection)}parseMarkGroup(){this.component.mark=r_t(this)}parseAxesAndHeaders(){this.component.axes=A2t(this)}assembleSelectionTopLevelSignals(t){return Pbt(this,t)}assembleSignals(){return[...y0e(this),...Fbt(this,[])]}assembleSelectionData(t){return $bt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return $9(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!R0(this.parent))&&(n=Zve(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return dg(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Ml(n)}typedFieldDef(t){const n=this.fieldDef(t);return Xo(n)?n:null}}class n7 extends Z9{constructor(t,n,r,i,a){super(t,"layer",n,r,a,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(GO(s))return new n7(s,this,this.getName("layer_"+u),o,a);if(zc(s))return new _ye(s,this,this.getName("layer_"+u),o,a);throw new Error(b8(s))})}parseData(){this.component.data=EI(this);for(const t of this.children)t.parseData()}parseLayoutSize(){p2t(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){k2t(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),y0e(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),$9(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Lbt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),W0e(this))}}function r7(e,t,n,r,i){if(PO(e))return new e2(e,t,n,i);if(GO(e))return new n7(e,t,n,r,i);if(zc(e))return new _ye(e,t,n,r,i);if(lyt(e))return new w2t(e,t,n,i);throw new Error(b8(e))}function c_t(e,t={}){t.logger&&Tvt(t.logger),t.fieldTitle&&Pme(t.fieldTitle);try{const n=hve(nge(t.config,e.config)),r=Eve(e,n),i=r7(r,null,"",void 0,n);return i.parse(),Iwt(i.component.data,i),{spec:d_t(i,f_t(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Ovt(),t.fieldTitle&&M0t()}}function f_t(e,t,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Xt(t)&&(t={type:t}),i&&a&&jyt(t.type)){if(i==="step"&&a==="step")Me(Lge()),t.type="pad";else if(i==="step"||a==="step"){const o=i==="step"?"width":"height";Me(Lge(CO(o)));const s=o==="width"?"height":"width";t.type=Uyt(s)}}return Object.assign(Object.assign(Object.assign({},Be(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Cve(n)),Cve(e))}function d_t(e,t,n={},r){const i=e.config?wyt(e.config):void 0,a=[].concat(e.assembleSelectionData([]),c2t(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class h_t extends pve{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:a,timeUnits:o,aggregate:s,groupby:u,encoding:l}=X8(r,n),c=[...i||[],...a,...o,...s.length===0?[]:[{aggregate:s,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const p_t=new h_t;function g_t(e,t){return p_t.map(e,{config:t})}const m_t=_gt.version;var v_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",normalize:Eve,version:m_t,compile:c_t,extractTransforms:g_t});function Sye(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var y_t="vega-themes",b_t="2.10.0",x_t="Themes for stylized Vega and Vega-Lite visualizations.",w_t=["vega","vega-lite","themes","style"],__t="BSD-3-Clause",S_t={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},E_t=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],A_t="build/vega-themes.js",C_t="build/vega-themes.module.js",k_t="build/vega-themes.min.js",T_t="build/vega-themes.min.js",O_t="build/vega-themes.module.d.ts",I_t={type:"git",url:"https://github.com/vega/vega-themes.git"},N_t=["src","build"],D_t={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},R_t={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},F_t={vega:"*","vega-lite":"*"},M_t={name:y_t,version:b_t,description:x_t,keywords:w_t,license:__t,author:S_t,contributors:E_t,main:A_t,module:C_t,unpkg:k_t,jsdelivr:T_t,types:O_t,repository:I_t,files:N_t,scripts:D_t,devDependencies:R_t,peerDependencies:F_t};const M0="#fff",P_t="#888",$_t={background:"#333",title:{color:M0,subtitleColor:M0},style:{"guide-label":{fill:M0},"guide-title":{fill:M0}},axis:{domainColor:M0,gridColor:P_t,tickColor:M0}},_g="#4572a7",L_t={background:"#fff",arc:{fill:_g},area:{fill:_g},line:{stroke:_g,strokeWidth:2},path:{stroke:_g},rect:{fill:_g},shape:{stroke:_g},symbol:{fill:_g,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Sg="#30a2da",i7="#cbcbcb",B_t="#999",z_t="#333",Eye="#f0f0f0",Aye="#333",j_t={arc:{fill:Sg},area:{fill:Sg},axis:{domainColor:i7,grid:!0,gridColor:i7,gridWidth:1,labelColor:B_t,labelFontSize:10,titleColor:z_t,tickColor:i7,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Eye,group:{fill:Eye},legend:{labelColor:Aye,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Aye,titleFontSize:14,titlePadding:10},line:{stroke:Sg,strokeWidth:2},path:{stroke:Sg,strokeWidth:.5},rect:{fill:Sg},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Sg},bar:{binSpacing:2,fill:Sg,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Eg="#000",U_t={group:{fill:"#e5e5e5"},arc:{fill:Eg},area:{fill:Eg},line:{stroke:Eg},path:{stroke:Eg},rect:{fill:Eg},shape:{stroke:Eg},symbol:{fill:Eg,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},W_t=22,V_t="normal",Cye="Benton Gothic, sans-serif",kye=11.5,q_t="normal",Ag="#82c6df",a7="Benton Gothic Bold, sans-serif",Tye="normal",Oye=13,t2={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},H_t={background:"#ffffff",title:{anchor:"start",color:"#000000",font:a7,fontSize:W_t,fontWeight:V_t},arc:{fill:Ag},area:{fill:Ag},line:{stroke:Ag,strokeWidth:2},path:{stroke:Ag},rect:{fill:Ag},shape:{stroke:Ag},symbol:{fill:Ag,size:30},axis:{labelFont:Cye,labelFontSize:kye,labelFontWeight:q_t,titleFont:a7,titleFontSize:Oye,titleFontWeight:Tye},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Cye,labelFontSize:kye,symbolType:"square",titleFont:a7,titleFontSize:Oye,titleFontWeight:Tye},range:{category:t2["category-6"],diverging:t2["fireandice-6"],heatmap:t2["fire-7"],ordinal:t2["fire-7"],ramp:t2["fire-7"]}},Cg="#ab5787",kI="#979797",G_t={background:"#f9f9f9",arc:{fill:Cg},area:{fill:Cg},line:{stroke:Cg},path:{stroke:Cg},rect:{fill:Cg},shape:{stroke:Cg},symbol:{fill:Cg,size:30},axis:{domainColor:kI,domainWidth:.5,gridWidth:.2,labelColor:kI,tickColor:kI,tickWidth:.2,titleColor:kI},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},kg="#3e5c69",K_t={background:"#fff",arc:{fill:kg},area:{fill:kg},line:{stroke:kg},path:{stroke:kg},rect:{fill:kg},shape:{stroke:kg},symbol:{fill:kg},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ks="#1696d2",Iye="#000000",X_t="#FFFFFF",TI="Lato",o7="Lato",Y_t="Lato",Z_t="#DEDDDD",J_t=18,n2={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Q_t={background:X_t,title:{anchor:"start",fontSize:J_t,font:TI},axisX:{domain:!0,domainColor:Iye,domainWidth:1,grid:!1,labelFontSize:12,labelFont:o7,labelAngle:0,tickColor:Iye,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:TI},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:Z_t,gridWidth:1,labelFontSize:12,labelFont:o7,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:TI,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:o7,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:TI,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:n2["six-groups-cat-1"],diverging:n2["diverging-colors"],heatmap:n2["diverging-colors"],ordinal:n2["six-groups-seq"],ramp:n2["shades-blue"]},area:{fill:ks},rect:{fill:ks},line:{color:ks,stroke:ks,strokeWidth:5},trail:{color:ks,stroke:ks,strokeWidth:0,size:1},path:{stroke:ks,strokeWidth:.5},point:{filled:!0},text:{font:Y_t,color:ks,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ks,stroke:null}},arc:{fill:ks},shape:{stroke:ks},symbol:{fill:ks,size:30}},Tg="#3366CC",Nye="#ccc",OI="Arial, sans-serif",eSt={arc:{fill:Tg},area:{fill:Tg},path:{stroke:Tg},rect:{fill:Tg},shape:{stroke:Tg},symbol:{stroke:Tg},circle:{fill:Tg},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:OI,fontSize:12},"guide-title":{font:OI,fontSize:12},"group-title":{font:OI,fontSize:12}},title:{font:OI,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Nye,tickColor:Nye,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},tSt=M_t.version;var nSt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:$_t,excel:L_t,fivethirtyeight:j_t,ggplot2:U_t,googlecharts:eSt,latimes:H_t,quartz:G_t,urbaninstitute:Q_t,version:tSt,vox:K_t}),rSt=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const Dye="vg-tooltip-element",iSt={offsetX:10,offsetY:10,id:Dye,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:aSt,maxDepth:2};function aSt(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function oSt(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return rSt.toString().replace(Dye,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function sSt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function uSt(e,t,n){if(ut(e))return`[${e.map(r=>t(Bn(r)?r:Rye(r,n))).join(", ")}]`;if(Nt(e)){let r="";const i=e,{title:a,image:o}=i,s=sSt(i,["title","image"]);a&&(r+=`<h2>${t(a)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Nt(c)&&(c=Rye(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function lSt(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Rye(e,t){return JSON.stringify(e,lSt(t))}function cSt(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}class fSt{constructor(t){this.options=Object.assign(Object.assign({},iSt),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=oSt(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=uSt(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=cSt(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function II(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function dSt(e,t,n){const r=e.open(t),i=1e4,a=250,{origin:o}=new URL(t);let s=~~(i/a);function u(c){c.source===r&&(s=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){s<=0||(r.postMessage(n,o),setTimeout(l,a),s-=1)}setTimeout(l,a)}var hSt=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function Fye(e,...t){for(const n of t)pSt(e,n);return e}function pSt(e,t){for(const n of Object.keys(t))HA(e,n,t[n],!0)}var s7;const ef=egt;let P0=v_t;const NI=typeof window!="undefined"?window:void 0;P0===void 0&&((s7=NI==null?void 0:NI.vl)===null||s7===void 0?void 0:s7.compile)&&(P0=NI.vl);const Mye={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},gSt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},r2={vega:"Vega","vega-lite":"Vega-Lite"},DI={vega:ef.version,"vega-lite":P0?P0.version:"not available"},mSt={vega:e=>e,"vega-lite":(e,t)=>P0.compile(e,{config:t}).spec},vSt=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,ySt="chart-wrapper";function bSt(e){return typeof e=="function"}function Pye(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+a),o.document.title=`${r2[r]} JSON Source`}function $ye(e,t){var n;if(e.$schema){const r=Sye(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${r2[r.library]}, but mode argument sets ${(n=r2[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return mre.satisfies(DI[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${r2[i]} ${r.version}, but the current version of ${r2[i]} is v${DI[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function xSt(e){return!!(e&&"load"in e)}function Lye(e){return xSt(e)?e:ef.loader(e)}function Bye(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function wSt(e,t,n={}){var r,i,a;return II(this,void 0,void 0,function*(){let o,s;Bn(t)?(s=Lye(n.loader),o=JSON.parse(yield s.load(t))):o=t;const u=Bye(o).loader;(!s||u)&&(s=Lye((r=n.loader)!==null&&r!==void 0?r:u));const l=yield zye(Bye(o),s),c=yield zye(n,s),f=Object.assign(Object.assign({},Fye(c,l)),{config:qA((i=c.config)!==null&&i!==void 0?i:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield SSt(e,o,f,s)})}function zye(e,t){var n;return II(this,void 0,void 0,function*(){const r=Bn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=Bn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function _St(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function SSt(e,t,n={},r){var i,a,o,s,u,l;return II(this,void 0,void 0,function*(){const c=n.theme?qA(nSt[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=AL(n.actions)?n.actions:Fye({},Mye,(a=n.actions)!==null&&a!==void 0?a:{}),d=Object.assign(Object.assign({},gSt),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(s=n.logLevel)!==null&&s!==void 0?s:ef.Warn,g=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:T,rootContainer:I}=_St(m);if(!T.getElementById(k)){const N=document.createElement("style");N.id=k,N.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?hSt.toString():n.defaultStyle,I.appendChild(N)}}const v=$ye(t,n.mode);let y=mSt[v](t,c);if(v==="vega-lite"&&y.$schema){const k=Sye(y.$schema);mre.satisfies(DI.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${DI.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const k=document.createElement("div");k.classList.add(ySt),m.appendChild(k),b=k}const x=n.patch;x&&(x instanceof Function?y=x(y):y=TA(y,x,!0,!1).newDocument),n.formatLocale&&ef.formatLocale(n.formatLocale),n.timeFormatLocale&&ef.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,S=ef.parse(y,v==="vega-lite"?{}:c,{ast:w}),A=new(n.viewClass||ef.View)(S,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:ef.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;bSt(n.tooltip)?k=n.tooltip:k=new fSt(n.tooltip===!0?{}:n.tooltip).call,A.tooltip(k)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:k,updateSet:T}=typeof _=="boolean"?{}:_;A.hover(k,T)}n&&(n.width!=null&&A.width(n.width),n.height!=null&&A.height(n.height),n.padding!=null&&A.padding(n.padding)),yield A.initialize(b,n.bind).runAsync();let E;if(f!==!1){let k=m;if(n.defaultStyle!==!1){const I=document.createElement("details");I.title=d.CLICK_TO_VIEW_ACTIONS,m.append(I),k=I;const N=document.createElement("summary");N.innerHTML=vSt,I.append(N),E=O=>{I.contains(O.target)||I.removeAttribute("open")},document.addEventListener("click",E)}const T=document.createElement("div");if(k.append(T),T.classList.add("vega-actions"),f===!0||f.export!==!1){for(const I of["svg","png"])if(f===!0||f.export===!0||f.export[I]){const N=d[`${I.toUpperCase()}_ACTION`],O=document.createElement("a");O.text=N,O.href="#",O.target="_blank",O.download=`${g}.${I}`,O.addEventListener("mousedown",function(D){return II(this,void 0,void 0,function*(){D.preventDefault();const L=yield A.toImageURL(I,n.scaleFactor);this.href=L})}),T.append(O)}}if(f===!0||f.source!==!1){const I=document.createElement("a");I.text=d.SOURCE_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;Pye(nL(t),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"",v),N.preventDefault()}),T.append(I)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const I=document.createElement("a");I.text=d.COMPILED_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;Pye(nL(y),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"","vega"),N.preventDefault()}),T.append(I)}if(f===!0||f.editor!==!1){const I=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",N=document.createElement("a");N.text=d.EDITOR_ACTION,N.href="#",N.addEventListener("click",function(O){dSt(window,I,{config:c,mode:v,renderer:h,spec:nL(t)}),O.preventDefault()}),T.append(N)}}function C(){E&&document.removeEventListener("click",E),A.finalize()}return{view:A,spec:t,vgSpec:y,finalize:C}})}var ESt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:wSt,DEFAULT_ACTIONS:Mye,guessMode:$ye,vega:ef,get vegaLite(){return P0}}),$0=vh(ESt),Ts={},Le={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var jye=Object.getOwnPropertySymbols,ASt=Object.prototype.hasOwnProperty,CSt=Object.prototype.propertyIsEnumerable;function kSt(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function TSt(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(a){return!1}}var u7=TSt()?Object.assign:function(e,t){for(var n,r=kSt(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)ASt.call(n,o)&&(r[o]=n[o]);if(jye){i=jye(n);for(var s=0;s<i.length;s++)CSt.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},l7={};Object.defineProperty(l7,"__esModule",{value:!0}),l7.StyleSheet=Vye;var OSt=u7,ISt=NSt(OSt);function NSt(e){return e&&e.__esModule?e:{default:e}}function DSt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function c7(e){return e[e.length-1]}function Uye(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var Og=typeof window!="undefined",RSt=!1,FSt=function(){if(Og){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function Wye(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function Vye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!RSt:t,r=e.maxLength,i=r===void 0?Og&&FSt?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,ISt.default)(Vye.prototype,{getSheet:function(){return Uye(c7(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");Og?this.tags[0]=Wye():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch(r){}},insert:function(t){if(Og)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=c7(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else c7(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,Og&&this.ctr%this.maxLength==0&&this.tags.push(Wye()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){Og?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!Og)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(DSt(Array.from(Uye(n).cssRules))))}),t}});var L0={},MSt=/-(.)/g;function PSt(e){return e.replace(MSt,function(t,n){return n.toUpperCase()})}var $St=PSt,LSt=$St,BSt=/^-ms-/;function zSt(e){return LSt(e.replace(BSt,"ms-"))}var jSt=zSt,f7={},d7={};Object.defineProperty(d7,"__esModule",{value:!0});var RI={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function USt(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var WSt=["Webkit","ms","Moz","O"];Object.keys(RI).forEach(function(e){WSt.forEach(function(t){RI[USt(t,e)]=RI[e]})});var VSt={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},qSt={isUnitlessNumber:RI,shorthandPropertyExpansions:VSt};d7.default=qSt;function FI(e){return function(){return e}}var Ig=function(){};Ig.thatReturns=FI,Ig.thatReturnsFalse=FI(!1),Ig.thatReturnsTrue=FI(!0),Ig.thatReturnsNull=FI(null),Ig.thatReturnsThis=function(){return this},Ig.thatReturnsArgument=function(e){return e};var HSt=Ig,GSt=HSt,KSt=GSt,qye=KSt;Object.defineProperty(f7,"__esModule",{value:!0});var XSt=d7,YSt=Hye(XSt),ZSt=qye;Hye(ZSt);function Hye(e){return e&&e.__esModule?e:{default:e}}var Gye=YSt.default.isUnitlessNumber;function JSt(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||Gye.hasOwnProperty(e)&&Gye[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}f7.default=JSt;var QSt=/([A-Z])/g;function eEt(e){return e.replace(QSt,"-$1").toLowerCase()}var tEt=eEt,nEt=tEt,rEt=/^ms-/;function iEt(e){return nEt(e).replace(rEt,"-ms-")}var aEt=iEt;function oEt(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var sEt=oEt;Object.defineProperty(L0,"__esModule",{value:!0}),L0.processStyleName=void 0,L0.createMarkupForStyles=vEt;var uEt=jSt;i2(uEt);var lEt=f7,cEt=i2(lEt),fEt=aEt,dEt=i2(fEt),hEt=sEt,pEt=i2(hEt),gEt=qye;i2(gEt);function i2(e){return e&&e.__esModule?e:{default:e}}var mEt=L0.processStyleName=(0,pEt.default)(dEt.default);function vEt(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var a=e[r];a!=null&&(i?n+=r+":"+a+";":(n+=mEt(r)+":",n+=(0,cEt.default)(r,a,t)+";"))}}return n||null}var h7={};Object.defineProperty(h7,"__esModule",{value:!0});var Kye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};h7.default=p7;function yEt(e){return e==null||e===!1||(typeof e=="undefined"?"undefined":Kye(e))==="object"&&Object.keys(e).length===0}function bEt(e){if(yEt(e))return null;if((typeof e=="undefined"?"undefined":Kye(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var a=e[n[i]],o=p7(a);(o===null||o!==a)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function xEt(e){var t=!1,n=[];return e.forEach(function(r){var i=p7(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function p7(e){return Array.isArray(e)?xEt(e):bEt(e)}var B0={},g7={},m7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(m7,m7.exports);var v7={exports:{}},MI={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(MI,MI.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=MI.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u){if(o.hasOwnProperty(s))for(var l=o[s],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(s)]=u[s]}e.exports=t.default}(v7,v7.exports);var y7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,a,o,s){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,a,o,s);if(c)return c}}e.exports=t.default})(y7,y7.exports);var b7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(a,o){if(a==="cursor"&&r.hasOwnProperty(o))return n.map(function(s){return s+o})}e.exports=t.default})(b7,b7.exports);var x7={exports:{}},Ng={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(Ng,Ng.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ng.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return a.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(x7,x7.exports);var w7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ng.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return a.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(w7,w7.exports);var _7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,a){if(i==="display"&&n.hasOwnProperty(a))return n[a]}e.exports=t.default})(_7,_7.exports);var S7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(a,o,s){a==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?s.WebkitBoxOrient="vertical":s.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?s.WebkitBoxDirection="reverse":s.WebkitBoxDirection="normal"),r.hasOwnProperty(a)&&(s[r[a]]=n[o]||o)}e.exports=t.default})(S7,S7.exports);var E7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=Ng.exports,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var a=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function s(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return a.map(function(c){return c+l})}e.exports=t.default})(E7,E7.exports);var A7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ng.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return a.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(A7,A7.exports);var C7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(C7,C7.exports);var k7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function a(o,s){if(r.hasOwnProperty(o)&&i.hasOwnProperty(s))return n.map(function(u){return u+s})}e.exports=t.default})(k7,k7.exports);var T7={exports:{}},O7={exports:{}},wEt=/[A-Z]/g,_Et=/^ms-/,I7={};function SEt(e){return"-"+e.toLowerCase()}function EEt(e){if(I7.hasOwnProperty(e))return I7[e];var t=e.replace(wEt,SEt);return I7[e]=_Et.test(t)?"-"+t:t}var AEt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:EEt}),CEt=vh(AEt);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=CEt,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return(0,r.default)(o)}e.exports=t.default})(O7,O7.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=O7.exports,r=u(n),i=Ng.exports,a=u(i),o=MI.exports,s=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,a.default)(h))return h;for(var g=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var S=p[x],A=0,_=S.length;A<_;++A)b.unshift(y.replace(w,c[S[A]]+w))}g[m]=b.join(",")}return g.join(",")}function d(h,p,g,m){if(typeof p=="string"&&l.hasOwnProperty(h)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?b:(g["Webkit"+(0,s.default)(h)]=y,g["Moz"+(0,s.default)(h)]=b,v)}}e.exports=t.default}(T7,T7.exports),Object.defineProperty(g7,"__esModule",{value:!0}),g7.default=eAt;var kEt=m7.exports,TEt=Jo(kEt),OEt=v7.exports,IEt=Jo(OEt),NEt=y7.exports,DEt=Jo(NEt),REt=b7.exports,FEt=Jo(REt),MEt=x7.exports,PEt=Jo(MEt),$Et=w7.exports,LEt=Jo($Et),BEt=_7.exports,zEt=Jo(BEt),jEt=S7.exports,UEt=Jo(jEt),WEt=E7.exports,VEt=Jo(WEt),qEt=A7.exports,HEt=Jo(qEt),GEt=C7.exports,KEt=Jo(GEt),XEt=k7.exports,YEt=Jo(XEt),ZEt=T7.exports,JEt=Jo(ZEt);function Jo(e){return e&&e.__esModule?e:{default:e}}var QEt=[PEt.default,FEt.default,LEt.default,UEt.default,VEt.default,HEt.default,KEt.default,YEt.default,JEt.default,zEt.default],Xye=TEt.default.prefixMap;function eAt(e){for(var t in e){var n=e[t],r=(0,DEt.default)(QEt,t,n,e,Xye);r&&(e[t]=r),(0,IEt.default)(Xye,t,e)}return e}Object.defineProperty(B0,"__esModule",{value:!0});var N7=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};B0.PluginSet=Zye,B0.fallbacks=oAt,B0.contentWrap=uAt,B0.prefixes=lAt;var tAt=u7,D7=Yye(tAt),nAt=L0,rAt=g7,iAt=Yye(rAt);function Yye(e){return e&&e.__esModule?e:{default:e}}var aAt=function(e){return e==="development"||!e}("production");function Zye(e){this.fns=e||[]}(0,D7.default)(Zye.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(a){t.fns.indexOf(a)>=0?aAt&&console.warn("adding the same plugin again, ignoring"):t.fns=[a].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function oAt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,a){return i[a]=Array.isArray(n[a])?n[a].join("; "+(0,nAt.processStyleName)(a)+": "):n[a],i},{});return(0,D7.default)({},e,{style:r})}return e}var sAt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function uAt(e){if(e.style.content){var t=e.style.content;return sAt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:N7({},e,{style:N7({},e.style,{content:'"'+t+'"'})})}return e}function lAt(e){return(0,D7.default)({},e,{style:(0,iAt.default)(N7({},e.style))})}var R7={};Object.defineProperty(R7,"__esModule",{value:!0}),R7.default=cAt;function cAt(e,t){for(var n=1540483477,r=24,i=t^e.length,a=e.length,o=0;a>=4;){var s=fAt(e,o);s=Dg(s,n),s^=s>>>r,s=Dg(s,n),i=Dg(i,n),i^=s,o+=4,a-=4}switch(a){case 3:i^=Jye(e,o),i^=e.charCodeAt(o+2)<<16,i=Dg(i,n);break;case 2:i^=Jye(e,o),i=Dg(i,n);break;case 1:i^=e.charCodeAt(o),i=Dg(i,n);break}return i^=i>>>13,i=Dg(i,n),i^=i>>>15,i>>>0}function fAt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function Jye(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function Dg(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(Le,"__esModule",{value:!0}),Le.compose=Le.merge=Le.$=Le.style=Le.presets=Le.keyframes=Le.fontFace=Le.insertGlobal=Le.insertRule=Le.plugins=Le.styleSheet=void 0,Le.speedy=yAt,Le.simulations=bAt,Le.simulate=xAt,Le.cssLabels=wAt,Le.isLikeRule=L7,Le.idFor=B7,Le.css=Oi,Le.rehydrate=MAt,Le.flush=PAt,Le.select=U7,Le.parent=LAt,Le.media=BAt,Le.pseudo=kt,Le.active=zAt,Le.any=jAt,Le.checked=UAt,Le.disabled=WAt,Le.empty=VAt,Le.enabled=qAt,Le._default=HAt,Le.first=GAt,Le.firstChild=KAt,Le.firstOfType=XAt,Le.fullscreen=YAt,Le.focus=ZAt,Le.hover=JAt,Le.indeterminate=QAt,Le.inRange=eCt,Le.invalid=tCt,Le.lastChild=nCt,Le.lastOfType=rCt,Le.left=iCt,Le.link=aCt,Le.onlyChild=oCt,Le.onlyOfType=sCt,Le.optional=uCt,Le.outOfRange=lCt,Le.readOnly=cCt,Le.readWrite=fCt,Le.required=dCt,Le.right=hCt,Le.root=pCt,Le.scope=gCt,Le.target=mCt,Le.valid=vCt,Le.visited=yCt,Le.dir=bCt,Le.lang=xCt,Le.not=wCt,Le.nthChild=_Ct,Le.nthLastChild=SCt,Le.nthLastOfType=ECt,Le.nthOfType=ACt,Le.after=CCt,Le.before=kCt,Le.firstLetter=TCt,Le.firstLine=OCt,Le.selection=ICt,Le.backdrop=NCt,Le.placeholder=DCt,Le.cssFor=RCt,Le.attribsFor=FCt;var dAt=u7,hAt=M7(dAt),pAt=l7,F7=L0,gAt=h7,uh=M7(gAt),tf=B0,mAt=R7,vAt=M7(mAt);function M7(e){return e&&e.__esModule?e:{default:e}}function a2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qo=Le.styleSheet=new pAt.StyleSheet;Qo.inject();function yAt(e){return Qo.speedy(e)}var o2=Le.plugins=Qo.plugins=new tf.PluginSet([tf.prefixes,tf.contentWrap,tf.fallbacks]);o2.media=new tf.PluginSet,o2.fontFace=new tf.PluginSet,o2.keyframes=new tf.PluginSet([tf.prefixes,tf.fallbacks]);var P7=!1,PI=typeof window!="undefined",$7=P7,Qye=!1,ebe=!1;function bAt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;$7=!!e}function xAt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,uh.default)(t),t?$7?t.reduce(function(r,i){return r["data-simulate-"+$I(i)]="",r},{}):(Qye||(console.warn("can't simulate without once calling simulations(true)"),Qye=!0),ebe||(console.warn("don't use simulation outside dev"),ebe=!0),{}):{}}var s2=P7;function wAt(e){s2=!!e}function $I(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function u2(e){var t=JSON.stringify(e),n=(0,vAt.default)(t).toString(36);return e.label&&e.label.length>0&&P7?$I(e.label.join("."),"-")+"-"+n:n}function L7(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function B7(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var _At=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function z7(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=_At.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function tbe(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=z7(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return $7&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+$I(t)+"],[data-css-"+e+"][data-simulate-"+$I(t)+"]"),n}function j7(e){var t=e.selector,n=e.style,r=o2.transform({selector:t,style:n});return r.selector+"{"+(0,F7.createMarkupForStyles)(r.style)+"}"}function LI(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(a){a.indexOf("&")>=0?(n=n||{},n[a]=e[a]):a.indexOf("@media")===0?(r=r||{},r[a]=LI(e[a])):a.indexOf("@supports")===0?(i=i||{},i[a]=LI(e[a])):a==="label"?e.label.length>0&&(t=t||{},t.label=s2?e.label.join("."):""):(t=t||{},t[a]=e[a])}),{plain:t,selects:n,medias:r,supports:i}}function BI(e,t){var n=[],r=t.plain,i=t.selects,a=t.medias,o=t.supports;return r&&n.push(j7({style:r,selector:tbe(e)})),i&&Object.keys(i).forEach(function(s){return n.push(j7({style:i[s],selector:tbe(e,s)}))}),a&&Object.keys(a).forEach(function(s){return n.push(s+"{"+BI(e,a[s]).join("")+"}")}),o&&Object.keys(o).forEach(function(s){return n.push(s+"{"+BI(e,o[s]).join("")+"}")}),n}var Tu=Qo.inserted={};function SAt(e){if(!Tu[e.id]){Tu[e.id]=!0;var t=LI(e.style),n=BI(e.id,t);Tu[e.id]=PI?!0:n,n.forEach(function(r){return Qo.insert(r)})}}var l2=Qo.registered={};function zI(e){l2[e.id]||(l2[e.id]=e)}function EAt(e){if(L7(e)){var t=l2[B7(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var jI={};function AAt(e){if(zI(e),SAt(e),jI[e.id])return jI[e.id];var t=a2({},"data-css-"+e.id,s2&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),jI[e.id]=t,t}function CAt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function nbe(e,t){var n=z7(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=z7(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,a){return i.concat(n.map(function(o){return a.replace(/\&/g,o)}))},[]).join(",")}function kAt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function TAt(e){return e.indexOf("@media")===0}function OAt(e){return e.indexOf("@supports")===0}function IAt(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function rbe(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(rbe(e[n])):t=t.concat(e[n]);return t}var ibe={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function Rg(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,a=i===void 0?"":i,o=t.supp,s=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=rbe(l),l.forEach(function(c){if(L7(c)){var f=EAt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,uh.default)(c),c&&c.composes&&Rg(e,{selector:r,mq:a,supp:s,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(CAt(d))ibe[d]&&ibe[d].forEach(function(p){return Rg(e,{selector:nbe(r,p),mq:a,supp:s,src:c[d]})}),Rg(e,{selector:nbe(r,d),mq:a,supp:s,src:c[d]});else if(TAt(d))Rg(e,{selector:r,mq:kAt(a,d),supp:s,src:c[d]});else if(OAt(d))Rg(e,{selector:r,mq:a,supp:IAt(s,d),src:c[d]});else if(d!=="composes"){var h=e;s&&(h[s]=h[s]||{},h=h[s]),a&&(h[a]=h[a]||{},h=h[a]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?s2&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function abe(e){var t={label:[]};Rg(t,{src:e});var n={id:u2(t),style:t,label:s2?t.label.join("."):"",type:"css"};return AAt(n)}var UI={};Object.defineProperty(UI,"toString",{enumerable:!1,value:function(){return"css-nil"}});var WI=typeof WeakMap!="undefined"?[UI,new WeakMap,new WeakMap,new WeakMap]:[UI];function NAt(e){return function(t){if(WI[t.length]){for(var n=WI[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(l2[i.toString().substring(4)])return i}}var a=e(t);if(WI[t.length]){for(var o=0,s=WI[t.length];o<t.length-1;)s=s.get(t[o]),o++;try{s.set(t[o],a)}catch(u){}}return a}}var DAt=typeof WeakMap!="undefined"?NAt(abe):abe;function Oi(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,uh.default)(t),t?DAt(t):UI}Oi.insert=function(e){var t={id:u2(e),css:e,type:"raw"};zI(t),Tu[t.id]||(Qo.insert(t.css),Tu[t.id]=PI?!0:[t.css])},Le.insertRule=Oi.insert,Oi.global=function(e,t){if(t=(0,uh.default)(t),t)return Oi.insert(j7({selector:e,style:t}))},Le.insertGlobal=Oi.global;function RAt(e){if(!Tu[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=o2.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,F7.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Qo.insert(r)}),Tu[e.id]=PI?!0:n}}Oi.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,uh.default)(t)||{};var n={id:u2({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return zI(n),RAt(n),e+"_"+n.id},Oi.fontFace=function(e){e=(0,uh.default)(e);var t={id:u2(e),type:"font-face",font:e};return zI(t),FAt(t),e.fontFamily},Le.fontFace=Oi.fontFace,Le.keyframes=Oi.keyframes;function FAt(e){if(!Tu[e.id]){var t="@font-face{"+(0,F7.createMarkupForStyles)(e.font)+"}";Qo.insert(t),Tu[e.id]=PI?!0:[t]}}function MAt(e){(0,hAt.default)(Tu,e.reduce(function(t,n){return t[n]=!0,t},{}))}function PAt(){Tu=Qo.inserted={},l2=Qo.registered={},jI={},Qo.flush(),Qo.inject()}Le.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var $At=Le.style=Oi;function U7(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Oi(a2({},e,n)):$At(n)}Le.$=U7;function LAt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Oi(a2({},e+" &",n))}Le.merge=Oi,Le.compose=Oi;function BAt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Oi(a2({},"@media "+e,n))}function kt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Oi(a2({},e,n))}function zAt(e){return kt(":active",e)}function jAt(e){return kt(":any",e)}function UAt(e){return kt(":checked",e)}function WAt(e){return kt(":disabled",e)}function VAt(e){return kt(":empty",e)}function qAt(e){return kt(":enabled",e)}function HAt(e){return kt(":default",e)}function GAt(e){return kt(":first",e)}function KAt(e){return kt(":first-child",e)}function XAt(e){return kt(":first-of-type",e)}function YAt(e){return kt(":fullscreen",e)}function ZAt(e){return kt(":focus",e)}function JAt(e){return kt(":hover",e)}function QAt(e){return kt(":indeterminate",e)}function eCt(e){return kt(":in-range",e)}function tCt(e){return kt(":invalid",e)}function nCt(e){return kt(":last-child",e)}function rCt(e){return kt(":last-of-type",e)}function iCt(e){return kt(":left",e)}function aCt(e){return kt(":link",e)}function oCt(e){return kt(":only-child",e)}function sCt(e){return kt(":only-of-type",e)}function uCt(e){return kt(":optional",e)}function lCt(e){return kt(":out-of-range",e)}function cCt(e){return kt(":read-only",e)}function fCt(e){return kt(":read-write",e)}function dCt(e){return kt(":required",e)}function hCt(e){return kt(":right",e)}function pCt(e){return kt(":root",e)}function gCt(e){return kt(":scope",e)}function mCt(e){return kt(":target",e)}function vCt(e){return kt(":valid",e)}function yCt(e){return kt(":visited",e)}function bCt(e,t){return kt(":dir("+e+")",t)}function xCt(e,t){return kt(":lang("+e+")",t)}function wCt(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?kt(":not("+e+")",t):U7(n.join(""),t)}function _Ct(e,t){return kt(":nth-child("+e+")",t)}function SCt(e,t){return kt(":nth-last-child("+e+")",t)}function ECt(e,t){return kt(":nth-last-of-type("+e+")",t)}function ACt(e,t){return kt(":nth-of-type("+e+")",t)}function CCt(e){return kt("::after",e)}function kCt(e){return kt("::before",e)}function TCt(e){return kt("::first-letter",e)}function OCt(e){return kt("::first-line",e)}function ICt(e){return kt("::selection",e)}function NCt(e){return kt("::backdrop",e)}function DCt(e){return Oi({"::placeholder":e})}function RCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,uh.default)(t),t?t.map(function(r){var i={label:[]};return Rg(i,{src:r}),BI(u2(i),LI(i)).join("")}).join(""):""}function FCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,uh.default)(t);var r=t?t.map(function(i){B7(i);var a=Object.keys(i)[0],o=i[a];return a+'="'+(o||"")+'"'}).join(" "):"";return r}var Ha={},c2={};Object.defineProperty(c2,"__esModule",{value:!0});function MCt(e){return e.name!=null}c2.isSurfaceInfo=MCt;function PCt(e){return e.drawArea instanceof HTMLElement}c2.isSurface=PCt;var f2={},W7={};function $Ct(){}var So={},z0=[],obe=[];function d2(e,t){var n=obe,r,i,a,o;for(o=arguments.length;o-- >2;)z0.push(arguments[o]);for(t&&t.children!=null&&(z0.length||z0.push(t.children),delete t.children);z0.length;)if((i=z0.pop())&&i.pop!==void 0)for(o=i.length;o--;)z0.push(i[o]);else typeof i=="boolean"&&(i=null),(a=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(a=!1)),a&&r?n[n.length-1]+=i:n===obe?n=[i]:n.push(i),r=a;var s=new $Ct;return s.nodeName=e,s.children=n,s.attributes=t??void 0,s.key=t==null?void 0:t.key,So.vnode!==void 0&&So.vnode(s),s}function lh(e,t){for(var n in t)e[n]=t[n];return e}var LCt=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function sbe(e,t){return d2(e.nodeName,lh(lh({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var BCt=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,V7=[];function ube(e){!e._dirty&&(e._dirty=!0)&&V7.push(e)==1&&(So.debounceRendering||LCt)(q7)}function q7(){var e,t=V7;for(V7=[];e=t.pop();)e._dirty&&HI(e)}function zCt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&lbe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function lbe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function cbe(e){var t=lh({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function jCt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function H7(e){var t=e.parentNode;t&&t.removeChild(e)}function fbe(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]=typeof r[a]=="number"&&BCt.test(a)===!1?r[a]+"px":r[a]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,dbe,o):e.removeEventListener(t,dbe,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)UCt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function UCt(e,t,n){try{e[t]=n}catch(r){}}function dbe(e){return this._listeners[e.type](So.event&&So.event(e)||e)}var hbe=[],G7=0,ch=!1,VI=!1;function pbe(){for(var e;e=hbe.pop();)So.afterMount&&So.afterMount(e),e.componentDidMount&&e.componentDidMount()}function gbe(e,t,n,r,i,a){G7++||(ch=i!=null&&i.ownerSVGElement!==void 0,VI=e!=null&&!("__preactattr_"in e));var o=mbe(e,t,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--G7||(VI=!1,a||pbe()),o}function mbe(e,t,n,r,i){var a=e,o=ch;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),Fg(e,!0))),a.__preactattr_=!0,a;var s=t.nodeName;if(typeof s=="function")return GCt(e,t,n,r);if(ch=s==="svg"?!0:s==="foreignObject"?!1:ch,s=String(s),(!e||!lbe(e,s))&&(a=jCt(s,ch),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),Fg(e,!0)}var u=a.firstChild,l=a.__preactattr_,c=t.children;if(l==null){l=a.__preactattr_={};for(var f=a.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!VI&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&WCt(a,c,n,r,VI||l.dangerouslySetInnerHTML!=null),VCt(a,t.attributes,l),ch=o,a}function WCt(e,t,n,r,i){var a=e.childNodes,o=[],s={},u=0,l=0,c=a.length,f=0,d=t?t.length:0,h,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=a[y],x=b.__preactattr_,w=d&&x?b._component?b._component.__key:x.key:null;w!=null?(u++,s[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(o[f++]=b)}if(d!==0)for(var y=0;y<d;y++){m=t[y],v=null;var w=m.key;if(w!=null)u&&s[w]!==void 0&&(v=s[w],s[w]=void 0,u--);else if(!v&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&zCt(p=o[h],m,i)){v=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}v=mbe(v,m,n,r),g=a[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?H7(g):e.insertBefore(v,g))}if(u)for(var y in s)s[y]!==void 0&&Fg(s[y],!1);for(;l<=f;)(v=o[f--])!==void 0&&Fg(v,!1)}function Fg(e,t){var n=e._component;n?GI(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&H7(e),vbe(e))}function vbe(e){for(e=e.lastChild;e;){var t=e.previousSibling;Fg(e,!0),e=t}}function VCt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&fbe(e,r,n[r],n[r]=void 0,ch);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&fbe(e,r,n[r],n[r]=t[r],ch)}var K7={};function qCt(e){var t=e.constructor.name;(K7[t]||(K7[t]=[])).push(e)}function ybe(e,t,n){var r=K7[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),h2.call(i,t,n)):(i=new h2(t,n),i.constructor=e,i.render=HCt),r){for(var a=r.length;a--;)if(r[a].constructor===e){i.nextBase=r[a].nextBase,r.splice(a,1);break}}return i}function HCt(e,t,n){return this.constructor(e,n)}function qI(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||So.syncComponentUpdates!==!1||!e.base?HI(e,1,i):ube(e)),e.__ref&&e.__ref(e))}function HI(e,t,n,r){if(!e._disable){var i=e.props,a=e.state,o=e.context,s=e.prevProps||i,u=e.prevState||a,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,g,m,v;if(c&&(e.props=s,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,a,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,a,o),e.props=i,e.state=a,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,a,o),e.getChildContext&&(o=lh(lh({},o),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=cbe(g);m=h,m&&m.constructor===y&&w.key==m.__key?qI(m,w,1,o,!1):(b=m,e._component=m=ybe(y,w,o),m.nextBase=m.nextBase||f,m._parentComponent=e,qI(m,w,0,o,!1),HI(m,1,n,!0)),x=m.base}else v=d,b=h,b&&(v=e._component=null),(d||t===1)&&(v&&(v._component=null),x=gbe(v,g,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&m!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),b||(d._component=null,Fg(d,!1)))}if(b&&GI(b),e.base=x,x&&!r){for(var A=e,_=e;_=_._parentComponent;)(A=_).base=x;x._component=A,x._componentConstructor=A.constructor}}if(!c||n?hbe.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(s,u,l),So.afterUpdate&&So.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!G7&&!r&&pbe()}}function GCt(e,t,n,r){for(var i=e&&e._component,a=i,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=cbe(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(qI(i,l,3,n,r),e=i.base):(a&&!s&&(GI(a),e=o=null),i=ybe(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),qI(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Fg(o,!1))),e}function GI(e){So.beforeUnmount&&So.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?GI(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,H7(t),qCt(e),vbe(t)),e.__ref&&e.__ref(null)}function h2(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}lh(h2.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=lh({},r)),lh(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),ube(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),HI(this,2)},render:function(){}});function bbe(e,t,n){return gbe(n,e,{},!1,t,!1)}var KCt={h:d2,createElement:d2,cloneElement:sbe,Component:h2,render:bbe,rerender:q7,options:So},XCt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:KCt,h:d2,createElement:d2,cloneElement:sbe,Component:h2,render:bbe,rerender:q7,options:So}),X7=vh(XCt),Y7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Y7,"__esModule",{value:!0});const KI=X7,Z7=Le;class j0 extends KI.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},j0.defaultStyles,r),{width:a,height:o}=i;let{maxHeight:s,maxWidth:u}=i;s=o===j0.defaultStyles.height?s:o,u=a===j0.defaultStyles.width?u:a;const l=Z7.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:a,maxHeight:s,maxWidth:u,overflow:"auto"}),c=Z7.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=Z7.css({boxSizing:"border-box"});return KI.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},KI.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),KI.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}j0.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},Y7.SurfaceComponent=j0;var J7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(J7,"__esModule",{value:!0});const p2=X7,xbe=Le;class YCt extends p2.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>p2.h(ZCt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,a=xbe.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return p2.h("div",{className:`${a} visor-tabs`},i)}}J7.Tabs=YCt;class ZCt extends p2.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,a=xbe.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return p2.h("a",{className:`${a} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(W7,"__esModule",{value:!0});const Ou=X7,Mg=Le,JCt=Y7,QCt=J7;class Q7 extends Ou.Component{static render(t,n,r){return Ou.render(Ou.h(Q7,Object.assign({},r)),t,n)}constructor(t){super(t);this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(a=>a.tab),r=this.state.tabs;let i;for(const a of n)r.has(a)||(r.add(a),i=a);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){const n=192;t.keyCode===n&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,a=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=Mg.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=Mg.css({right:"0"}),f=Mg.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=Mg.css({});return Ou.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},Ou.h(ekt,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),Ou.h(QCt.Tabs,{tabNames:a,activeTab:r,handleClick:this.setActiveTab.bind(this)}),Ou.h("div",{className:`${h} visor-surfaces`},i.map(p=>Ou.h(JCt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}W7.VisorComponent=Q7;function ekt(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=Mg.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),a=Mg.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=Mg.css({marginLeft:"auto"});return Ou.h("div",{className:`${i} visor-controls`},Ou.h("button",{className:`${a}`,onClick:n},t?"Minimize":"Maximize"),Ou.h("button",{className:`${a} ${o}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(f2,"__esModule",{value:!0});const tkt=W7;let XI;const nkt="Visor",eU="tfjs-visor-container";function rkt(){if(typeof document=="undefined")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(eU)&&XI!=null)return XI;let e=document.getElementById(eU);e==null&&(e=document.createElement("div"),e.id=eU,document.body.appendChild(e));let t;function n(a,o){let s=null;return t=tkt.VisorComponent.render(a,t,{ref:u=>s=u,surfaceList:Array.from(o.values())}),s}const r=new Map,i=n(e,r);return XI=new wbe(i,e,r,n),XI}f2.visor=rkt;class wbe{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?nkt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),a=`${n}-${r}`;return this.surfaceList.has(a)||this.surfaceList.set(a,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}f2.Visor=wbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ikt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ha,"__esModule",{value:!0});const _be=c2,akt=f2;function okt(e){if(e instanceof HTMLElement)return e;if(_be.isSurface(e))return e.drawArea;if(_be.isSurfaceInfo(e))return akt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Ha.getDrawArea=okt;function skt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a])return!1}return!0}Ha.shallowEquals=skt;function ukt(){return ikt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Ha.nextFrame=ukt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Ts,"__esModule",{value:!0});const Sbe=Le,lkt=Ha,ckt={prepend:!1};function fkt(e,t,n={}){const r=lkt.getDrawArea(e),i=Sbe.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),a=Sbe.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},ckt,n);let s=r.querySelector(`div[data-name=${t}]`);if(!s){if(s=document.createElement("div"),s.setAttribute("class",`${i}`),s.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${a}`),u.innerText=o.title,s.appendChild(u)}o.prepend?r.insertBefore(s,r.firstChild):r.appendChild(s)}return s}Ts.subSurface=fkt;function dkt(e){const t=50;let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=t;return r.clientWidth-n}Ts.getDefaultWidth=dkt;function hkt(e){return e.clientHeight===0?200:e.clientHeight}Ts.getDefaultHeight=hkt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pkt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},gkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(K$,"__esModule",{value:!0});const mkt=gkt($0),Ebe=Ts,YI=Ha;function vkt(e,t,n={}){return pkt(this,void 0,void 0,function*(){const r=YI.getDrawArea(e),i=t,a=Object.assign({},ykt,n);if(tU.has(r)){const m=tU.get(r);if(YI.shallowEquals(a,m.lastOptions)){yield YI.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:o,yLabel:s,xType:u,yType:l}=a;let c=null;o!=null&&(c={title:o});let f=null;s!=null&&(f={title:s});const d={actions:!1,mode:"vega-lite",defaultStyle:!1};let h;a.color!=null?Array.isArray(a.color)?h={field:"index",type:"nominal",scale:{range:a.color}}:h={value:a.color}:h={value:"#4C78A0"};const p={width:a.width||Ebe.getDefaultWidth(r),height:a.height||Ebe.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f},color:h}};yield YI.nextFrame();const g=yield mkt.default(r,p,d);tU.set(r,{view:g.view,lastOptions:a})})}K$.barchart=vkt;const ykt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},tU=new Map;var nU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bkt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},xkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nU,"__esModule",{value:!0});const wkt=xkt($0),Abe=Ts,_kt=Ha;function Skt(e,t,n={}){return bkt(this,void 0,void 0,function*(){const r=Object.assign({},Ekt,n),i=_kt.getDrawArea(e),a=[],o=t.values,s=t.tickLabels||[],u=s.length===0;let l=!0;for(let h=0;h<o.length;h++){const p=u?`Class ${h}`:s[h];u&&s.push(p);for(let g=0;g<o[h].length;g++){const m=u?`Class ${g}`:s[g],v=o[h][g];h===g&&!r.shadeDiagonal?a.push({label:p,prediction:m,count:v,noFill:!0}):(a.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const h of a)h.noFill===!0&&(h.noFill=!1,h.scaleCount=h.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Abe.getDefaultWidth(i),height:r.height||Abe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:a},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:s}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:s}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield wkt.default(i,f,c)})}nU.confusionMatrix=Skt;const Ekt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var rU={},nf={};Object.defineProperty(nf,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}nf.assert=Cbe;function Akt(e,t,n=""){Cbe(kbe(e,t),n+` Shapes ${e} and ${t} must match`)}nf.assertShapesMatch=Akt;function kbe(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}nf.arraysEqual=kbe,nf.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Tbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},Ckt=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},kkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rU,"__esModule",{value:!0});const g2=Ckt(Hte),Tkt=kkt($0),Obe=Ts,m2=nf,Okt=Ha;function Ikt(e,t,n={}){return Tbe(this,void 0,void 0,function*(){const r=Object.assign({},Dkt,n),i=Okt.getDrawArea(e);let a=t.values;r.rowMajor&&(a=yield Nkt(t.values));const{xTickLabels:o,yTickLabels:s}=t;o!=null&&Ibe(a,o,0),s!=null&&Ibe(a,s,1);const u="@tfidx@",l=[];if(a instanceof g2.Tensor){m2.assert(a.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield a.data(),[m,v]=a.shape;for(let y=0;y<m;y++){const b=o?`${o[y]}${u}${y}`:y;for(let x=0;x<v;x++){const w=s?`${s[x]}${u}${x}`:x,S=y*v+x,A=g[S];l.push({x:b,y:w,value:A})}}}else{const g=a;for(let m=0;m<g.length;m++){const v=o?`${o[m]}${u}${m}`:m;for(let y=0;y<g[m].length;y++){const b=s?`${s[y]}${u}${y}`:y,x=g[m][y];l.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Obe.getDefaultWidth(i),height:r.height||Obe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:l},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${u}\\d+$`,h=new RegExp(d);o&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),s&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(o||s)&&(c.tooltip={sanitize:g=>String(g).replace(h,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield Tkt.default(i,f,c)})}rU.heatmap=Ikt;function Nkt(e){return Tbe(this,void 0,void 0,function*(){let t,n;e instanceof g2.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=g2.tidy(()=>g2.tensor2d(e).transpose())),m2.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return m2.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function Ibe(e,t,n){const r=e instanceof g2.Tensor?e.shape:[e.length,e[0].length];n===0?m2.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&m2.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const Dkt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var v2={},Nbe=vh(vJe),jl={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ZI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(jl,"__esModule",{value:!0});const Pg=Hte,fh=nf;function Rkt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?a+=1:isFinite(l)||(o+=1)}const s={numVals:t,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s}jl.arrayStats=Rkt;function Fkt(e){return ZI(this,void 0,void 0,function*(){const[t,n,r]=Pg.tidy(()=>{const i=Pg.scalar(0,e.dtype),a=e.min(),o=e.max(),s=e.equal(i).sum();return[a,o,s]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,a,o,s])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const g=i[p];isNaN(g)?l+=1:isFinite(g)||(c+=1)}let f=a[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:s[0],numNans:l,min:f,max:d,numInfs:c}})})}jl.tensorStats=Fkt;function Mkt(e,t,n,r){return ZI(this,void 0,void 0,function*(){fh.assert(e.rank===1,"labels must be a 1D tensor"),fh.assert(t.rank===1,"predictions must be a 1D tensor"),fh.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&fh.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),a=t.cast("int32");n==null&&(n=Pg.tidy(()=>Pg.maximum(i.max(),a.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),a.data(),o]).then(([s,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<s.length;f++){const d=s[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}jl.confusionMatrix=Mkt;function Pkt(e,t){return ZI(this,void 0,void 0,function*(){fh.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Pg.dispose([n,r]),i})}jl.accuracy=Pkt;function $kt(e,t,n){return ZI(this,void 0,void 0,function*(){return fh.assert(e.rank===1,"labels must be a 1D tensor"),fh.assert(t.rank===1,"predictions must be a 1D tensor"),fh.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Pg.tidy(()=>Pg.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const a=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];a[l]+=1,l===c&&(o[l]+=1)}const s=[];for(let u=0;u<a.length;u++)s.push({count:a[u],accuracy:a[u]===0?0:o[u]/a[u]});return s})})}jl.perClassAccuracy=$kt;var U0={},iU="http://www.w3.org/1999/xhtml",aU={svg:"http://www.w3.org/2000/svg",xhtml:iU,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function oU(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),aU.hasOwnProperty(t)?{space:aU[t],local:e}:e}function Lkt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===iU&&t.documentElement.namespaceURI===iU?t.createElement(e):t.createElementNS(n,e)}}function Bkt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function JI(e){var t=oU(e);return(t.local?Bkt:Lkt)(t)}function zkt(){}function sU(e){return e==null?zkt:function(){return this.querySelector(e)}}function jkt(e){typeof e!="function"&&(e=sU(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=e.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new Ga(r,this._parents)}function Ukt(){return[]}function Dbe(e){return e==null?Ukt:function(){return this.querySelectorAll(e)}}function Wkt(e){typeof e!="function"&&(e=Dbe(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Ga(r,i)}var Rbe=function(e){return function(){return this.matches(e)}};if(typeof document!="undefined"){var y2=document.documentElement;if(!y2.matches){var Vkt=y2.webkitMatchesSelector||y2.msMatchesSelector||y2.mozMatchesSelector||y2.oMatchesSelector;Rbe=function(e){return function(){return Vkt.call(this,e)}}}}var Fbe=Rbe;function qkt(e){typeof e!="function"&&(e=Fbe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&e.call(u,u.__data__,l,a)&&s.push(u);return new Ga(r,this._parents)}function Mbe(e){return new Array(e.length)}function Hkt(){return new Ga(this._enter||this._groups.map(Mbe),this._parents)}function QI(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}QI.prototype={constructor:QI,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Gkt(e){return function(){return e}}var Pbe="$";function Kkt(e,t,n,r,i,a){for(var o=0,s,u=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new QI(e,a[o]);for(;o<u;++o)(s=t[o])&&(i[o]=s)}function Xkt(e,t,n,r,i,a,o){var s,u,l={},c=t.length,f=a.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=Pbe+o.call(u,u.__data__,s,t),h in l?i[s]=u:l[h]=u);for(s=0;s<f;++s)h=Pbe+o.call(e,a[s],s,a),(u=l[h])?(r[s]=u,u.__data__=a[s],l[h]=null):n[s]=new QI(e,a[s]);for(s=0;s<c;++s)(u=t[s])&&l[d[s]]===u&&(i[s]=u)}function Ykt(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?Xkt:Kkt,r=this._parents,i=this._groups;typeof e!="function"&&(e=Gkt(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=o[l]=new Array(p),v=u[l]=new Array(d);n(c,f,g,m,v,h,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return o=new Ga(o,r),o._enter=s,o._exit=u,o}function Zkt(){return new Ga(this._exit||this._groups.map(Mbe),this._parents)}function Jkt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=t[s],l=n[s],c=u.length,f=o[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)o[s]=t[s];return new Ga(o,this._parents)}function Qkt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&a!==o.nextSibling&&a.parentNode.insertBefore(o,a),a=o);return this}function eTt(e){e||(e=tTt);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Ga(i,this._parents).order()}function tTt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function nTt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function rTt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function iTt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function aTt(){var e=0;return this.each(function(){++e}),e}function oTt(){return!this.node()}function sTt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function uTt(e){return function(){this.removeAttribute(e)}}function lTt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cTt(e,t){return function(){this.setAttribute(e,t)}}function fTt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function dTt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function hTt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function pTt(e,t){var n=oU(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?lTt:uTt:typeof t=="function"?n.local?hTt:dTt:n.local?fTt:cTt)(n,t))}function uU(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function gTt(e){return function(){this.style.removeProperty(e)}}function mTt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function vTt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function yTt(e,t,n){return arguments.length>1?this.each((t==null?gTt:typeof t=="function"?vTt:mTt)(e,t,n??"")):$be(this.node(),e)}function $be(e,t){return e.style.getPropertyValue(t)||uU(e).getComputedStyle(e,null).getPropertyValue(t)}function bTt(e){return function(){delete this[e]}}function xTt(e,t){return function(){this[e]=t}}function wTt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function _Tt(e,t){return arguments.length>1?this.each((t==null?bTt:typeof t=="function"?wTt:xTt)(e,t)):this.node()[e]}function Lbe(e){return e.trim().split(/^|\s+/)}function lU(e){return e.classList||new Bbe(e)}function Bbe(e){this._node=e,this._names=Lbe(e.getAttribute("class")||"")}Bbe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function zbe(e,t){for(var n=lU(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function jbe(e,t){for(var n=lU(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function STt(e){return function(){zbe(this,e)}}function ETt(e){return function(){jbe(this,e)}}function ATt(e,t){return function(){(t.apply(this,arguments)?zbe:jbe)(this,e)}}function CTt(e,t){var n=Lbe(e+"");if(arguments.length<2){for(var r=lU(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?ATt:t?STt:ETt)(n,t))}function kTt(){this.textContent=""}function TTt(e){return function(){this.textContent=e}}function OTt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ITt(e){return arguments.length?this.each(e==null?kTt:(typeof e=="function"?OTt:TTt)(e)):this.node().textContent}function NTt(){this.innerHTML=""}function DTt(e){return function(){this.innerHTML=e}}function RTt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function FTt(e){return arguments.length?this.each(e==null?NTt:(typeof e=="function"?RTt:DTt)(e)):this.node().innerHTML}function MTt(){this.nextSibling&&this.parentNode.appendChild(this)}function PTt(){return this.each(MTt)}function $Tt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function LTt(){return this.each($Tt)}function BTt(e){var t=typeof e=="function"?e:JI(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function zTt(){return null}function jTt(e,t){var n=typeof e=="function"?e:JI(e),r=t==null?zTt:typeof t=="function"?t:sU(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function UTt(){var e=this.parentNode;e&&e.removeChild(this)}function WTt(){return this.each(UTt)}function VTt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function qTt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function HTt(e){return this.select(e?qTt:VTt)}function GTt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var Ube={},rf=null;if(typeof document!="undefined"){var KTt=document.documentElement;"onmouseenter"in KTt||(Ube={mouseenter:"mouseover",mouseleave:"mouseout"})}function XTt(e,t,n){return e=Wbe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function Wbe(e,t,n){return function(r){var i=rf;rf=r;try{e.call(this,this.__data__,t,n)}finally{rf=i}}}function YTt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function ZTt(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function JTt(e,t,n){var r=Ube.hasOwnProperty(e.type)?XTt:Wbe;return function(i,a,o){var s=this.__on,u,l=r(t,a,o);if(s){for(var c=0,f=s.length;c<f;++c)if((u=s[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},s?s.push(u):this.__on=[u]}}function QTt(e,t,n){var r=YTt(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?JTt:ZTt,n==null&&(n=!1),i=0;i<a;++i)this.each(s(r[i],t,n));return this}function eOt(e,t,n,r){var i=rf;e.sourceEvent=rf,rf=e;try{return t.apply(n,r)}finally{rf=i}}function Vbe(e,t,n){var r=uU(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function tOt(e,t){return function(){return Vbe(this,e,t)}}function nOt(e,t){return function(){return Vbe(this,e,t.apply(this,arguments))}}function rOt(e,t){return this.each((typeof t=="function"?nOt:tOt)(e,t))}var cU=[null];function Ga(e,t){this._groups=e,this._parents=t}function qbe(){return new Ga([[document.documentElement]],cU)}Ga.prototype=qbe.prototype={constructor:Ga,select:jkt,selectAll:Wkt,filter:qkt,data:Ykt,enter:Hkt,exit:Zkt,merge:Jkt,order:Qkt,sort:eTt,call:nTt,nodes:rTt,node:iTt,size:aTt,empty:oTt,each:sTt,attr:pTt,style:yTt,property:_Tt,classed:CTt,text:ITt,html:FTt,raise:PTt,lower:LTt,append:BTt,insert:jTt,remove:WTt,clone:HTt,datum:GTt,on:QTt,dispatch:rOt};function Hbe(e){return typeof e=="string"?new Ga([[document.querySelector(e)]],[document.documentElement]):new Ga([[e]],cU)}function iOt(e){return Hbe(JI(e).call(document.documentElement))}var aOt=0;function Gbe(){return new fU}function fU(){this._="@"+(++aOt).toString(36)}fU.prototype=Gbe.prototype={constructor:fU,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function dU(){for(var e=rf,t;t=e.sourceEvent;)e=t;return e}function eN(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function oOt(e){var t=dU();return t.changedTouches&&(t=t.changedTouches[0]),eN(e,t)}function sOt(e){return typeof e=="string"?new Ga([document.querySelectorAll(e)],[document.documentElement]):new Ga([e??[]],cU)}function uOt(e,t,n){arguments.length<3&&(n=t,t=dU().changedTouches);for(var r=0,i=t?t.length:0,a;r<i;++r)if((a=t[r]).identifier===n)return eN(e,a);return null}function lOt(e,t){t==null&&(t=dU().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=eN(e,t[n]);return i}var cOt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:iOt,creator:JI,local:Gbe,matcher:Fbe,mouse:oOt,namespace:oU,namespaces:aU,clientPoint:eN,select:Hbe,selectAll:sOt,selection:qbe,selector:sU,selectorAll:Dbe,style:$be,touch:uOt,touches:lOt,window:uU,get event(){return rf},customEvent:eOt}),fOt=vh(cOt);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(U0,"__esModule",{value:!0});const dOt=Nbe,Kbe=fOt,hU=Le,hOt=Ha;function pOt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=hOt.getDrawArea(e),i=Object.assign({},gOt,n);let a=Kbe.select(r).select("table.tf-table");const o=hU.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(a.size()===0&&(a=Kbe.select(r).append("table"),a.attr("class",` ${o} tf-table`),a.append("thead").append("tr"),a.append("tbody")),a.size()!==1)throw new Error("Error inserting table");const s=hU.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),u=a.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${s}`);u.merge(l).html(m=>m),u.exit().remove();const c=dOt.format(",.4~f"),f=a.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=hU.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(d).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${h}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}U0.table=pOt;const gOt={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},vOt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(v2,"__esModule",{value:!0});const Xbe=Nbe,yOt=vOt($0),tN=Ts,bOt=jl,xOt=U0,wOt={maxBins:12,fontSize:11};function _Ot(e,t,n={}){return mOt(this,void 0,void 0,function*(){const r=EOt(t),i=Object.assign({},wOt,n),a={actions:!1,mode:"vega-lite",defaultStyle:!1},o=tN.subSurface(e,"histogram");if(n.stats!==!1){const l=tN.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=bOt.arrayStats(r.map(f=>f.value)),SOt(c,l,{fontSize:i.fontSize})}if(r.length===0)return;const s=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&s.push(r[l])}const u={width:i.width||tN.getDefaultWidth(o),height:i.height||tN.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:s},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return yOt.default(o,u,a)})}v2.histogram=_Ot;function SOt(e,t,n){const r=Xbe.format(",.4~f"),i=Xbe.format(".4~p"),a=[],o=[];if(e.numVals!=null&&(a.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(a.push("Min"),o.push(r(e.min))),e.max!=null&&(a.push("Max"),o.push(r(e.max))),e.numZeros!=null){a.push("# Zeros");let s="";e.numVals&&(s=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${s}`)}if(e.numNans!=null){a.push("# NaNs");let s="";e.numVals&&(s=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${s}`)}if(e.numInfs!=null){a.push("# Infinity");let s="";e.numVals&&(s=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${s}`)}xOt.table(t,{headers:a,values:[o]},n)}function EOt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var nN={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},COt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nN,"__esModule",{value:!0});const kOt=COt($0),Ybe=Ts,Zbe=nf,TOt=Ha;function OOt(e,t,n={}){return AOt(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,a=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);Zbe.assert(a.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&Zbe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=[];for(let g=0;g<i;g++){const m={x:g};a.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),o.push(m)}const s=Object.assign({},IOt,n),u=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},l={x:{field:"x",type:s.xType,title:s.xLabel},tooltip:[{field:"x",type:"quantitative"},...a.map(g=>({field:g,type:"quantitative"}))]},c=a.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:s.yType,title:s.yLabel,scale:u()},color:{field:`${g}-name`,type:"nominal",legend:{values:a,title:null},scale:{range:s.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=TOt.getDrawArea(e),h={width:s.width||Ybe.getDefaultWidth(d),height:s.height||Ybe.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:o},encoding:l,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield kOt.default(d,h,p),Promise.resolve()})}nN.linechart=OOt;const IOt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var pU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var NOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},DOt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pU,"__esModule",{value:!0});const ROt=DOt($0),Jbe=Ts,FOt=nf,MOt=Ha;function POt(e,t,n={}){return NOt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const a=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,g=d.map(m=>Object.assign({},m,{series:p}));a.push(...g)}),n.seriesColors!=null&&FOt.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=MOt.getDrawArea(e),s=Object.assign({},$Ot,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(s.zoomToFit)return{zero:!1};if(s.xAxisDomain!=null)return{domain:s.xAxisDomain}},c=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},f={width:s.width||Jbe.getDefaultWidth(o),height:s.height||Jbe.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:a},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:s.xType,title:s.xLabel,scale:l()},y:{field:"y",type:s.yType,title:s.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:s.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield ROt.default(o,f,u),Promise.resolve()})}pU.scatterplot=POt;const $Ot={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var rN={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(rN,"__esModule",{value:!0});const LOt=nN,gU=Ha,e1e=Ts;function t1e(e,t,n,r={}){return Qbe(this,void 0,void 0,function*(){const i=gU.getDrawArea(e),a={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");n1e(a,c);const f=r1e(t,l,n.indexOf(l));a[c].series.push(l),a[c].values.push(f)}else{const c=r1e(t,l,n.indexOf(l));n1e(a,l),a[l].series.push(l),a[l].values.push(c)}const o=Object.keys(a),s=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=e1e.subSurface(i,l),f=a[l].series,d=a[l].values;f.every(p=>Boolean(p.match("acc")))&&(s.zoomToFitAccuracy?s.zoomToFit=!0:(s.yAxisDomain=[0,1],delete s.zoomToFit));const h=LOt.linechart(c,{values:d,series:f},s);u.push(h)}yield Promise.all(u)})}rN.history=t1e;function n1e(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function r1e(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let a=0;a<r.length;a++){const o=r[a];i.push({x:a,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function BOt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],a=gU.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function s(l){return(c,f)=>Qbe(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const g of t)if(f[g]!=null){h.push(g);const m=zOt(r,l,g);m.push({[g]:f[g]}),d.push(m)}const p=e1e.subSurface(a,l,{title:l});t1e(p,d,h,o),yield gU.nextFrame()})}const u={};return i.forEach(l=>{u[l]=s(l)}),u}rN.fitCallbacks=BOt;function zOt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var iN={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aN=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(iN,"__esModule",{value:!0});const jOt=v2,i1e=Ha,a1e=U0,mU=Ts,UOt=jl;function WOt(e,t){return aN(this,void 0,void 0,function*(){const n=i1e.getDrawArea(e),r=qOt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],a=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);a1e.table(n,{headers:i,values:a})})}iN.modelSummary=WOt;function VOt(e,t){return aN(this,void 0,void 0,function*(){const n=i1e.getDrawArea(e),r=yield GOt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],a=mU.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);a1e.table(a,{headers:i,values:o});const s=mU.subSurface(n,"select-layer"),u=mU.subSurface(n,"param-distribution"),l=c=>aN(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();jOt.histogram(u,d,{height:150,width:460,stats:!1})});KOt(r.map(c=>c.name),s,l)})}iN.layer=VOt;function qOt(e){return{layers:e.layers.map(HOt)}}function HOt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>vU(r)).join(", ")}]`:t=vU(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function GOt(e){return aN(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(UOt.tensorStats),i=yield Promise.all(r),a=t.map(o=>o.shape);return t.map((o,s)=>({name:n[s].name,stats:i[s],shape:vU(a[s]),weight:o}))})}function vU(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function KOt(e,t,n){const a=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=a;const o=t.querySelector("button"),s=t.querySelector("select");o.addEventListener("click",()=>{n(s.selectedOptions[0].label)})}var yU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var XOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(yU,"__esModule",{value:!0});const YOt=Ha,ZOt=U0;function JOt(e,t,n){return XOt(this,void 0,void 0,function*(){const r=YOt.getDrawArea(e),i=["Class","Accuracy","# Samples"],a=[];for(let o=0;o<t.length;o++){const s=n?n[o]:o.toString(),u=t[o];a.push([s,u.accuracy,u.count])}return ZOt.table(r,{headers:i,values:a})})}yU.perClassAccuracy=JOt;var bU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var QOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(bU,"__esModule",{value:!0});const eIt=v2,tIt=Ha,nIt=jl;function rIt(e,t){return QOt(this,void 0,void 0,function*(){const n=tIt.getDrawArea(e),r=yield nIt.tensorStats(t),i=yield t.data();eIt.histogram(n,i,{height:150,stats:r})})}bU.valuesDistribution=rIt;var xU={};/** @license See the LICENSE file. */Object.defineProperty(xU,"__esModule",{value:!0});const iIt="1.5.1";xU.version=iIt,function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=K$,r=nU,i=rU,a=v2,o=nN,s=pU,u=U0,l=rN,c=iN,f=yU,d=bU,h=jl,p=xU;e.version_vis=p.version;const g={barchart:n.barchart,table:u.table,histogram:a.histogram,linechart:o.linechart,scatterplot:s.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=f2;e.visor=y.visor,t(c2)}(qte);for(var W0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b2=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),oN=0;oN<W0.length;oN++)b2[W0.charCodeAt(oN)]=oN;var aIt=function(e){var t=new Uint8Array(e),n,r=t.length,i="";for(n=0;n<r;n+=3)i+=W0[t[n]>>2],i+=W0[(t[n]&3)<<4|t[n+1]>>4],i+=W0[(t[n+1]&15)<<2|t[n+2]>>6],i+=W0[t[n+2]&63];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},oIt=function(e){var t=e.length*.75,n=e.length,r,i=0,a,o,s,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),c=new Uint8Array(l);for(r=0;r<n;r+=4)a=b2[e.charCodeAt(r)],o=b2[e.charCodeAt(r+1)],s=b2[e.charCodeAt(r+2)],u=b2[e.charCodeAt(r+3)],c[i++]=a<<2|o>>4,c[i++]=(o&15)<<4|s>>2,c[i++]=(s&3)<<6|u&63;return l},o1e={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof ff=="function"&&ff;if(!c&&f)return f(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var g=r[l][1][p];return o(g||p)},h,h.exports,n,r,i,a)}return i[l].exports}for(var s=typeof ff=="function"&&ff,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,s;if(o){var u=0,l=new o(p),c=a.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var f=new a.MessageChannel;f.port1.onmessage=p,s=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?s=function(){var m=a.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:s=function(){setTimeout(p,0)};var d,h=[];function p(){d=!0;for(var m,v,y=h.length;y;){for(v=h,h=[],m=-1;++m<y;)v[m]();y=h.length}d=!1}r.exports=g;function g(m){h.push(m)===1&&!d&&s()}}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=f;function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,S){if(typeof w!="function"&&this.state===l||typeof S!="function"&&this.state===u)return this;var A=new this.constructor(o);if(this.state!==c){var _=this.state===l?w:S;h(A,_,this.outcome)}else this.queue.push(new d(A,w,S));return A};function d(w,S,A){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){s.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){s.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)};function h(w,S,A){a(function(){var _;try{_=S(A)}catch(E){return s.reject(w,E)}_===w?s.reject(w,new TypeError("Cannot resolve promise with itself")):s.resolve(w,_)})}s.resolve=function(w,S){var A=m(p,S);if(A.status==="error")return s.reject(w,A.value);var _=A.value;if(_)g(w,_);else{w.state=l,w.outcome=S;for(var E=-1,C=w.queue.length;++E<C;)w.queue[E].callFulfilled(S)}return w},s.reject=function(w,S){w.state=u,w.outcome=S;for(var A=-1,_=w.queue.length;++A<_;)w.queue[A].callRejected(S);return w};function p(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var A=!1;function _(T){A||(A=!0,s.reject(w,T))}function E(T){A||(A=!0,s.resolve(w,T))}function C(){S(E,_)}var k=m(C);k.status==="error"&&_(k.value)}function m(w,S){var A={};try{A.value=w(S),A.status="success"}catch(_){A.status="error",A.value=_}return A}f.resolve=v;function v(w){return w instanceof this?w:s.resolve(new this(o),w)}f.reject=y;function y(w){var S=new this(o);return s.reject(S,w)}f.all=b;function b(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,_=!1;if(!A)return this.resolve([]);for(var E=new Array(A),C=0,k=-1,T=new this(o);++k<A;)I(w[k],k);return T;function I(N,O){S.resolve(N).then(D,function(L){_||(_=!0,s.reject(T,L))});function D(L){E[O]=L,++C===A&&!_&&(_=!0,s.resolve(T,E))}}}f.race=x;function x(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,_=!1;if(!A)return this.resolve([]);for(var E=-1,C=new this(o);++E<A;)k(w[E]);return C;function k(T){S.resolve(T).then(function(I){_||(_=!0,s.resolve(C,I))},function(I){_||(_=!0,s.reject(C,I))})}}},{"1":1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z};function o(z,Z){if(!(z instanceof Z))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(z){return}}var u=s();function l(){try{if(!u||!u.open)return!1;var z=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Z=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!z||Z)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(q){return!1}}function c(z,Z){z=z||[],Z=Z||{};try{return new Blob(z,Z)}catch(te){if(te.name!=="TypeError")throw te;for(var q=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,re=new q,oe=0;oe<z.length;oe+=1)re.append(z[oe]);return re.getBlob(Z.type)}}typeof Promise=="undefined"&&n(3);var f=Promise;function d(z,Z){Z&&z.then(function(q){Z(null,q)},function(q){Z(q)})}function h(z,Z,q){typeof Z=="function"&&z.then(Z),typeof q=="function"&&z.catch(q)}function p(z){return typeof z!="string"&&(console.warn(z+" used as a key, but it is not a string."),z=String(z)),z}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",v=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function S(z){for(var Z=z.length,q=new ArrayBuffer(Z),re=new Uint8Array(q),oe=0;oe<Z;oe++)re[oe]=z.charCodeAt(oe);return q}function A(z){return new f(function(Z){var q=z.transaction(m,w),re=c([""]);q.objectStore(m).put(re,"key"),q.onabort=function(oe){oe.preventDefault(),oe.stopPropagation(),Z(!1)},q.oncomplete=function(){var oe=navigator.userAgent.match(/Chrome\/(\d+)/),te=navigator.userAgent.match(/Edge\//);Z(te||!oe||parseInt(oe[1],10)>=43)}}).catch(function(){return!1})}function _(z){return typeof v=="boolean"?f.resolve(v):A(z).then(function(Z){return v=Z,v})}function E(z){var Z=y[z.name],q={};q.promise=new f(function(re,oe){q.resolve=re,q.reject=oe}),Z.deferredOperations.push(q),Z.dbReady?Z.dbReady=Z.dbReady.then(function(){return q.promise}):Z.dbReady=q.promise}function C(z){var Z=y[z.name],q=Z.deferredOperations.pop();if(q)return q.resolve(),q.promise}function k(z,Z){var q=y[z.name],re=q.deferredOperations.pop();if(re)return re.reject(Z),re.promise}function T(z,Z){return new f(function(q,re){if(y[z.name]=y[z.name]||ce(),z.db)if(Z)E(z),z.db.close();else return q(z.db);var oe=[z.name];Z&&oe.push(z.version);var te=u.open.apply(u,oe);Z&&(te.onupgradeneeded=function(Ae){var De=te.result;try{De.createObjectStore(z.storeName),Ae.oldVersion<=1&&De.createObjectStore(m)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+z.name+'" has been upgraded from version '+Ae.oldVersion+" to version "+Ae.newVersion+', but the storage "'+z.storeName+'" already exists.');else throw Fe}}),te.onerror=function(Ae){Ae.preventDefault(),re(te.error)},te.onsuccess=function(){var Ae=te.result;Ae.onversionchange=function(De){De.target.close()},q(Ae),C(z)}})}function I(z){return T(z,!1)}function N(z){return T(z,!0)}function O(z,Z){if(!z.db)return!0;var q=!z.db.objectStoreNames.contains(z.storeName),re=z.version<z.db.version,oe=z.version>z.db.version;if(re&&(z.version!==Z&&console.warn('The database "'+z.name+`" can't be downgraded from version `+z.db.version+" to version "+z.version+"."),z.version=z.db.version),oe||q){if(q){var te=z.db.version+1;te>z.version&&(z.version=te)}return!0}return!1}function D(z){return new f(function(Z,q){var re=new FileReader;re.onerror=q,re.onloadend=function(oe){var te=btoa(oe.target.result||"");Z({__local_forage_encoded_blob:!0,data:te,type:z.type})},re.readAsBinaryString(z)})}function L(z){var Z=S(atob(z.data));return c([Z],{type:z.type})}function W(z){return z&&z.__local_forage_encoded_blob}function G(z){var Z=this,q=Z._initReady().then(function(){var re=y[Z._dbInfo.name];if(re&&re.dbReady)return re.dbReady});return h(q,z,z),q}function K(z){E(z);for(var Z=y[z.name],q=Z.forages,re=0;re<q.length;re++){var oe=q[re];oe._dbInfo.db&&(oe._dbInfo.db.close(),oe._dbInfo.db=null)}return z.db=null,I(z).then(function(te){return z.db=te,O(z)?N(z):te}).then(function(te){z.db=Z.db=te;for(var Ae=0;Ae<q.length;Ae++)q[Ae]._dbInfo.db=te}).catch(function(te){throw k(z,te),te})}function ee(z,Z,q,re){re===void 0&&(re=1);try{var oe=z.db.transaction(z.storeName,Z);q(null,oe)}catch(te){if(re>0&&(!z.db||te.name==="InvalidStateError"||te.name==="NotFoundError"))return f.resolve().then(function(){if(!z.db||te.name==="NotFoundError"&&!z.db.objectStoreNames.contains(z.storeName)&&z.version<=z.db.version)return z.db&&(z.version=z.db.version+1),N(z)}).then(function(){return K(z).then(function(){ee(z,Z,q,re-1)})}).catch(q);q(te)}}function ce(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function he(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=z[re];var oe=y[q.name];oe||(oe=ce(),y[q.name]=oe),oe.forages.push(Z),Z._initReady||(Z._initReady=Z.ready,Z.ready=G);var te=[];function Ae(){return f.resolve()}for(var De=0;De<oe.forages.length;De++){var Fe=oe.forages[De];Fe!==Z&&te.push(Fe._initReady().catch(Ae))}var Pe=oe.forages.slice(0);return f.all(te).then(function(){return q.db=oe.db,I(q)}).then(function(je){return q.db=je,O(q,Z._defaultConfig.version)?N(q):je}).then(function(je){q.db=oe.db=je,Z._dbInfo=q;for(var it=0;it<Pe.length;it++){var Ft=Pe[it];Ft!==Z&&(Ft._dbInfo.db=q.db,Ft._dbInfo.version=q.version)}})}function Oe(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.get(z);Pe.onsuccess=function(){var je=Pe.result;je===void 0&&(je=null),W(je)&&(je=L(je)),oe(je)},Pe.onerror=function(){te(Pe.error)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function Te(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.openCursor(),je=1;Pe.onsuccess=function(){var it=Pe.result;if(it){var Ft=it.value;W(Ft)&&(Ft=L(Ft));var bn=z(Ft,it.key,je++);bn!==void 0?oe(bn):it.continue()}else oe()},Pe.onerror=function(){te(Pe.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function Re(z,Z,q){var re=this;z=p(z);var oe=new f(function(te,Ae){var De;re.ready().then(function(){return De=re._dbInfo,b.call(Z)==="[object Blob]"?_(De.db).then(function(Fe){return Fe?Z:D(Z)}):Z}).then(function(Fe){ee(re._dbInfo,w,function(Pe,je){if(Pe)return Ae(Pe);try{var it=je.objectStore(re._dbInfo.storeName);Fe===null&&(Fe=void 0);var Ft=it.put(Fe,z);je.oncomplete=function(){Fe===void 0&&(Fe=null),te(Fe)},je.onabort=je.onerror=function(){var bn=Ft.error?Ft.error:Ft.transaction.error;Ae(bn)}}catch(bn){Ae(bn)}})}).catch(Ae)});return d(oe,q),oe}function me(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,w,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.delete(z);De.oncomplete=function(){oe()},De.onerror=function(){te(Pe.error)},De.onabort=function(){var je=Pe.error?Pe.error:Pe.transaction.error;te(je)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function P(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,w,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.clear();Ae.oncomplete=function(){re()},Ae.onabort=Ae.onerror=function(){var Pe=Fe.error?Fe.error:Fe.transaction.error;oe(Pe)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function F(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.count();Fe.onsuccess=function(){re(Fe.result)},Fe.onerror=function(){oe(Fe.error)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function V(z,Z){var q=this,re=new f(function(oe,te){if(z<0){oe(null);return}q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=!1,je=Fe.openKeyCursor();je.onsuccess=function(){var it=je.result;if(!it){oe(null);return}z===0||Pe?oe(it.key):(Pe=!0,it.advance(z))},je.onerror=function(){te(je.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function ae(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.openKeyCursor(),Pe=[];Fe.onsuccess=function(){var je=Fe.result;if(!je){re(Pe);return}Pe.push(je.key),je.continue()},Fe.onerror=function(){oe(Fe.error)}}catch(je){oe(je)}})}).catch(oe)});return d(q,z),q}function Y(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;if(!z.name)oe=f.reject("Invalid arguments");else{var te=z.name===q.name&&re._dbInfo.db,Ae=te?f.resolve(re._dbInfo.db):I(z).then(function(De){var Fe=y[z.name],Pe=Fe.forages;Fe.db=De;for(var je=0;je<Pe.length;je++)Pe[je]._dbInfo.db=De;return De});z.storeName?oe=Ae.then(function(De){if(!!De.objectStoreNames.contains(z.storeName)){var Fe=De.version+1;E(z);var Pe=y[z.name],je=Pe.forages;De.close();for(var it=0;it<je.length;it++){var Ft=je[it];Ft._dbInfo.db=null,Ft._dbInfo.version=Fe}var bn=new f(function(An,_r){var sr=u.open(z.name,Fe);sr.onerror=function(Xa){var ph=sr.result;ph.close(),_r(Xa)},sr.onupgradeneeded=function(){var Xa=sr.result;Xa.deleteObjectStore(z.storeName)},sr.onsuccess=function(){var Xa=sr.result;Xa.close(),An(Xa)}});return bn.then(function(An){Pe.db=An;for(var _r=0;_r<je.length;_r++){var sr=je[_r];sr._dbInfo.db=An,C(sr._dbInfo)}}).catch(function(An){throw(k(z,An)||f.resolve()).catch(function(){}),An})}}):oe=Ae.then(function(De){E(z);var Fe=y[z.name],Pe=Fe.forages;De.close();for(var je=0;je<Pe.length;je++){var it=Pe[je];it._dbInfo.db=null}var Ft=new f(function(bn,An){var _r=u.deleteDatabase(z.name);_r.onerror=function(){var sr=_r.result;sr&&sr.close(),An(_r.error)},_r.onblocked=function(){console.warn('dropInstance blocked for database "'+z.name+'" until all open connections are closed')},_r.onsuccess=function(){var sr=_r.result;sr&&sr.close(),bn(sr)}});return Ft.then(function(bn){Fe.db=bn;for(var An=0;An<Pe.length;An++){var _r=Pe[An];C(_r._dbInfo)}}).catch(function(bn){throw(k(z,bn)||f.resolve()).catch(function(){}),bn})})}return d(oe,Z),oe}var M={_driver:"asyncStorage",_initStorage:he,_support:l(),iterate:Te,getItem:Oe,setItem:Re,removeItem:me,clear:P,length:F,key:V,keys:ae,dropInstance:Y};function B(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",ge=/^~~local_forage_type~([^~]+)~/,xe="__lfsc__:",ze=xe.length,Ke="arbf",Ze="blob",Bt="si08",Je="ui08",Zt="uic8",mn="si16",Hn="si32",ni="ur16",tr="ui32",Dn="fl32",es="fl64",Ka=ze+Ke.length,Ul=Object.prototype.toString;function Os(z){var Z=z.length*.75,q=z.length,re,oe=0,te,Ae,De,Fe;z[z.length-1]==="="&&(Z--,z[z.length-2]==="="&&Z--);var Pe=new ArrayBuffer(Z),je=new Uint8Array(Pe);for(re=0;re<q;re+=4)te=R.indexOf(z[re]),Ae=R.indexOf(z[re+1]),De=R.indexOf(z[re+2]),Fe=R.indexOf(z[re+3]),je[oe++]=te<<2|Ae>>4,je[oe++]=(Ae&15)<<4|De>>2,je[oe++]=(De&3)<<6|Fe&63;return Pe}function Is(z){var Z=new Uint8Array(z),q="",re;for(re=0;re<Z.length;re+=3)q+=R[Z[re]>>2],q+=R[(Z[re]&3)<<4|Z[re+1]>>4],q+=R[(Z[re+1]&15)<<2|Z[re+2]>>6],q+=R[Z[re+2]&63];return Z.length%3==2?q=q.substring(0,q.length-1)+"=":Z.length%3==1&&(q=q.substring(0,q.length-2)+"=="),q}function Wl(z,Z){var q="";if(z&&(q=Ul.call(z)),z&&(q==="[object ArrayBuffer]"||z.buffer&&Ul.call(z.buffer)==="[object ArrayBuffer]")){var re,oe=xe;z instanceof ArrayBuffer?(re=z,oe+=Ke):(re=z.buffer,q==="[object Int8Array]"?oe+=Bt:q==="[object Uint8Array]"?oe+=Je:q==="[object Uint8ClampedArray]"?oe+=Zt:q==="[object Int16Array]"?oe+=mn:q==="[object Uint16Array]"?oe+=ni:q==="[object Int32Array]"?oe+=Hn:q==="[object Uint32Array]"?oe+=tr:q==="[object Float32Array]"?oe+=Dn:q==="[object Float64Array]"?oe+=es:Z(new Error("Failed to get type for BinaryArray"))),Z(oe+Is(re))}else if(q==="[object Blob]"){var te=new FileReader;te.onload=function(){var Ae=X+z.type+"~"+Is(this.result);Z(xe+Ze+Ae)},te.readAsArrayBuffer(z)}else try{Z(JSON.stringify(z))}catch(Ae){console.error("Couldn't convert value into a JSON string: ",z),Z(null,Ae)}}function Vl(z){if(z.substring(0,ze)!==xe)return JSON.parse(z);var Z=z.substring(Ka),q=z.substring(ze,Ka),re;if(q===Ze&&ge.test(Z)){var oe=Z.match(ge);re=oe[1],Z=Z.substring(oe[0].length)}var te=Os(Z);switch(q){case Ke:return te;case Ze:return c([te],{type:re});case Bt:return new Int8Array(te);case Je:return new Uint8Array(te);case Zt:return new Uint8ClampedArray(te);case mn:return new Int16Array(te);case ni:return new Uint16Array(te);case Hn:return new Int32Array(te);case tr:return new Uint32Array(te);case Dn:return new Float32Array(te);case es:return new Float64Array(te);default:throw new Error("Unkown type: "+q)}}var af={serialize:Wl,deserialize:Vl,stringToBuffer:Os,bufferToString:Is};function x2(z,Z,q,re){z.executeSql("CREATE TABLE IF NOT EXISTS "+Z.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,re)}function w2(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=typeof z[re]!="string"?z[re].toString():z[re];var oe=new f(function(te,Ae){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(De){return Ae(De)}q.db.transaction(function(De){x2(De,q,function(){Z._dbInfo=q,te()},function(Fe,Pe){Ae(Pe)})},Ae)});return q.serializer=af,oe}function Iu(z,Z,q,re,oe,te){z.executeSql(q,re,oe,function(Ae,De){De.code===De.SYNTAX_ERR?Ae.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Z.storeName],function(Fe,Pe){Pe.rows.length?te(Fe,De):x2(Fe,Z,function(){Fe.executeSql(q,re,oe,te)},te)},te):te(Ae,De)},te)}function _2(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT * FROM "+Ae.storeName+" WHERE key = ? LIMIT 1",[z],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).value:null;je&&(je=Ae.serializer.deserialize(je)),oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function dh(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT * FROM "+Ae.storeName,[],function(Fe,Pe){for(var je=Pe.rows,it=je.length,Ft=0;Ft<it;Ft++){var bn=je.item(Ft),An=bn.value;if(An&&(An=Ae.serializer.deserialize(An)),An=z(An,bn.key,Ft+1),An!==void 0){oe(An);return}}oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function S2(z,Z,q,re){var oe=this;z=p(z);var te=new f(function(Ae,De){oe.ready().then(function(){Z===void 0&&(Z=null);var Fe=Z,Pe=oe._dbInfo;Pe.serializer.serialize(Z,function(je,it){it?De(it):Pe.db.transaction(function(Ft){Iu(Ft,Pe,"INSERT OR REPLACE INTO "+Pe.storeName+" (key, value) VALUES (?, ?)",[z,je],function(){Ae(Fe)},function(bn,An){De(An)})},function(Ft){if(Ft.code===Ft.QUOTA_ERR){if(re>0){Ae(S2.apply(oe,[z,Fe,q,re-1]));return}De(Ft)}})})}).catch(De)});return d(te,q),te}function ql(z,Z,q){return S2.apply(this,[z,Z,q,1])}function sN(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"DELETE FROM "+Ae.storeName+" WHERE key = ?",[z],function(){oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function uN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"DELETE FROM "+te.storeName,[],function(){re()},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function lN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"SELECT COUNT(key) as c FROM "+te.storeName,[],function(De,Fe){var Pe=Fe.rows.item(0).c;re(Pe)},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function cN(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT key FROM "+Ae.storeName+" WHERE id = ? LIMIT 1",[z+1],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).key:null;oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function fN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"SELECT key FROM "+te.storeName,[],function(De,Fe){for(var Pe=[],je=0;je<Fe.rows.length;je++)Pe.push(Fe.rows.item(je).key);re(Pe)},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function Ns(z){return new f(function(Z,q){z.transaction(function(re){re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(oe,te){for(var Ae=[],De=0;De<te.rows.length;De++)Ae.push(te.rows.item(De).name);Z({db:z,storeNames:Ae})},function(oe,te){q(te)})},function(re){q(re)})})}function dN(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;return z.name?oe=new f(function(te){var Ae;z.name===q.name?Ae=re._dbInfo.db:Ae=openDatabase(z.name,"","",0),z.storeName?te({db:Ae,storeNames:[z.storeName]}):te(Ns(Ae))}).then(function(te){return new f(function(Ae,De){te.db.transaction(function(Fe){function Pe(bn){return new f(function(An,_r){Fe.executeSql("DROP TABLE IF EXISTS "+bn,[],function(){An()},function(sr,Xa){_r(Xa)})})}for(var je=[],it=0,Ft=te.storeNames.length;it<Ft;it++)je.push(Pe(te.storeNames[it]));f.all(je).then(function(){Ae()}).catch(function(bn){De(bn)})},function(Fe){De(Fe)})})}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var hN={_driver:"webSQLStorage",_initStorage:w2,_support:B(),iterate:dh,getItem:_2,setItem:ql,removeItem:sN,clear:uN,length:lN,key:cN,keys:fN,dropInstance:dN};function pN(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(z){return!1}}function E2(z,Z){var q=z.name+"/";return z.storeName!==Z.storeName&&(q+=z.storeName+"/"),q}function gN(){var z="_localforage_support_test";try{return localStorage.setItem(z,!0),localStorage.removeItem(z),!1}catch(Z){return!0}}function of(){return!gN()||localStorage.length>0}function mN(z){var Z=this,q={};if(z)for(var re in z)q[re]=z[re];return q.keyPrefix=E2(z,Z._defaultConfig),of()?(Z._dbInfo=q,q.serializer=af,f.resolve()):f.reject()}function vN(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo.keyPrefix,oe=localStorage.length-1;oe>=0;oe--){var te=localStorage.key(oe);te.indexOf(re)===0&&localStorage.removeItem(te)}});return d(q,z),q}function yN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo,te=localStorage.getItem(oe.keyPrefix+z);return te&&(te=oe.serializer.deserialize(te)),te});return d(re,Z),re}function bN(z,Z){var q=this,re=q.ready().then(function(){for(var oe=q._dbInfo,te=oe.keyPrefix,Ae=te.length,De=localStorage.length,Fe=1,Pe=0;Pe<De;Pe++){var je=localStorage.key(Pe);if(je.indexOf(te)===0){var it=localStorage.getItem(je);if(it&&(it=oe.serializer.deserialize(it)),it=z(it,je.substring(Ae),Fe++),it!==void 0)return it}}});return d(re,Z),re}function xN(z,Z){var q=this,re=q.ready().then(function(){var oe=q._dbInfo,te;try{te=localStorage.key(z)}catch(Ae){te=null}return te&&(te=te.substring(oe.keyPrefix.length)),te});return d(re,Z),re}function sf(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo,oe=localStorage.length,te=[],Ae=0;Ae<oe;Ae++){var De=localStorage.key(Ae);De.indexOf(re.keyPrefix)===0&&te.push(De.substring(re.keyPrefix.length))}return te});return d(q,z),q}function wN(z){var Z=this,q=Z.keys().then(function(re){return re.length});return d(q,z),q}function _N(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo;localStorage.removeItem(oe.keyPrefix+z)});return d(re,Z),re}function SN(z,Z,q){var re=this;z=p(z);var oe=re.ready().then(function(){Z===void 0&&(Z=null);var te=Z;return new f(function(Ae,De){var Fe=re._dbInfo;Fe.serializer.serialize(Z,function(Pe,je){if(je)De(je);else try{localStorage.setItem(Fe.keyPrefix+z,Pe),Ae(te)}catch(it){(it.name==="QuotaExceededError"||it.name==="NS_ERROR_DOM_QUOTA_REACHED")&&De(it),De(it)}})})});return d(oe,q),oe}function EN(z,Z){if(Z=g.apply(this,arguments),z=typeof z!="function"&&z||{},!z.name){var q=this.config();z.name=z.name||q.name,z.storeName=z.storeName||q.storeName}var re=this,oe;return z.name?oe=new f(function(te){z.storeName?te(E2(z,re._defaultConfig)):te(z.name+"/")}).then(function(te){for(var Ae=localStorage.length-1;Ae>=0;Ae--){var De=localStorage.key(Ae);De.indexOf(te)===0&&localStorage.removeItem(De)}}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var AN={_driver:"localStorageWrapper",_initStorage:mN,_support:pN(),iterate:bN,getItem:yN,setItem:SN,removeItem:_N,clear:vN,length:wN,key:xN,keys:sf,dropInstance:EN},CN=function(Z,q){return Z===q||typeof Z=="number"&&typeof q=="number"&&isNaN(Z)&&isNaN(q)},V0=function(Z,q){for(var re=Z.length,oe=0;oe<re;){if(CN(Z[oe],q))return!0;oe++}return!1},A2=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"},Nu={},$g={},uf={INDEXEDDB:M,WEBSQL:hN,LOCALSTORAGE:AN},Lg=[uf.INDEXEDDB._driver,uf.WEBSQL._driver,uf.LOCALSTORAGE._driver],hh=["dropInstance"],q0=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(hh),kN={description:"",driver:Lg.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function TN(z,Z){z[Z]=function(){var q=arguments;return z.ready().then(function(){return z[Z].apply(z,q)})}}function Bg(){for(var z=1;z<arguments.length;z++){var Z=arguments[z];if(Z)for(var q in Z)Z.hasOwnProperty(q)&&(A2(Z[q])?arguments[0][q]=Z[q].slice():arguments[0][q]=Z[q])}return arguments[0]}var ON=function(){function z(Z){o(this,z);for(var q in uf)if(uf.hasOwnProperty(q)){var re=uf[q],oe=re._driver;this[q]=oe,Nu[oe]||this.defineDriver(re)}this._defaultConfig=Bg({},kN),this._config=Bg({},this._defaultConfig,Z),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return z.prototype.config=function(q){if((typeof q=="undefined"?"undefined":a(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var re in q){if(re==="storeName"&&(q[re]=q[re].replace(/\W/g,"_")),re==="version"&&typeof q[re]!="number")return new Error("Database version must be a number.");this._config[re]=q[re]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},z.prototype.defineDriver=function(q,re,oe){var te=new f(function(Ae,De){try{var Fe=q._driver,Pe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){De(Pe);return}for(var je=q0.concat("_initStorage"),it=0,Ft=je.length;it<Ft;it++){var bn=je[it],An=!V0(hh,bn);if((An||q[bn])&&typeof q[bn]!="function"){De(Pe);return}}var _r=function(){for(var ph=function(NN){return function(){var zg=new Error("Method "+NN+" is not implemented by the current driver"),jg=f.reject(zg);return d(jg,arguments[arguments.length-1]),jg}},H0=0,G0=hh.length;H0<G0;H0++){var K0=hh[H0];q[K0]||(q[K0]=ph(K0))}};_r();var sr=function(ph){Nu[Fe]&&console.info("Redefining LocalForage driver: "+Fe),Nu[Fe]=q,$g[Fe]=ph,Ae()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(sr,De):sr(!!q._support):sr(!0)}catch(Xa){De(Xa)}});return h(te,re,oe),te},z.prototype.driver=function(){return this._driver||null},z.prototype.getDriver=function(q,re,oe){var te=Nu[q]?f.resolve(Nu[q]):f.reject(new Error("Driver not found."));return h(te,re,oe),te},z.prototype.getSerializer=function(q){var re=f.resolve(af);return h(re,q),re},z.prototype.ready=function(q){var re=this,oe=re._driverSet.then(function(){return re._ready===null&&(re._ready=re._initDriver()),re._ready});return h(oe,q,q),oe},z.prototype.setDriver=function(q,re,oe){var te=this;A2(q)||(q=[q]);var Ae=this._getSupportedDrivers(q);function De(){te._config.driver=te.driver()}function Fe(it){return te._extend(it),De(),te._ready=te._initStorage(te._config),te._ready}function Pe(it){return function(){var Ft=0;function bn(){for(;Ft<it.length;){var An=it[Ft];return Ft++,te._dbInfo=null,te._ready=null,te.getDriver(An).then(Fe).catch(bn)}De();var _r=new Error("No available storage method found.");return te._driverSet=f.reject(_r),te._driverSet}return bn()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=je.then(function(){var it=Ae[0];return te._dbInfo=null,te._ready=null,te.getDriver(it).then(function(Ft){te._driver=Ft._driver,De(),te._wrapLibraryMethodsWithReady(),te._initDriver=Pe(Ae)})}).catch(function(){De();var it=new Error("No available storage method found.");return te._driverSet=f.reject(it),te._driverSet}),h(this._driverSet,re,oe),this._driverSet},z.prototype.supports=function(q){return!!$g[q]},z.prototype._extend=function(q){Bg(this,q)},z.prototype._getSupportedDrivers=function(q){for(var re=[],oe=0,te=q.length;oe<te;oe++){var Ae=q[oe];this.supports(Ae)&&re.push(Ae)}return re},z.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,re=q0.length;q<re;q++)TN(this,q0[q])},z.prototype.createInstance=function(q){return new z(q)},z}(),IN=new ON;r.exports=IN},{"3":3}]},{},[4])(4)})})(o1e);var sIt=o1e.exports;export{qRe as $,st as A,wa as B,pFe as C,aX as D,vFe as E,SRe as F,CRe as G,ERe as H,iS as I,ARe as J,IMe as K,JRe as L,tX as M,OMe as N,MMe as O,LS as P,FMe as Q,TMe as R,mK as S,dFe as T,ZRe as U,kMe as V,CMe as W,GRe as X,T2e as Y,le as Z,j1e as _,aMe as a,XRe as a0,DMe as a1,iFe as a2,eFe as a3,oS as a4,sIt as a5,Wg as a6,Mxe as a7,wq as a8,nX as b,iX as c,Ii as d,d8e as e,oK as f,Wu as g,vze as h,Pxe as i,Z5e as j,qte as k,an as l,yze as m,aIt as n,LMe as o,oIt as p,Fxe as q,Uf as r,pt as s,z1e as t,dW as u,ue as v,hFe as w,mFe as x,qt as y,gFe as z};
//# sourceMappingURL=vendor.4d0964e2.js.map
