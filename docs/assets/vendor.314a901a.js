var q0,ht,uU,H0,lU,cU,fU,g2={},dU=[],Nbe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ql(e,t){for(var n in t)e[n]=t[n];return e}function hU(e){var t=e.parentNode;t&&t.removeChild(e)}function ue(e,t,n){var r,i,a,o={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?q0.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return G0(e,o,r,i,null)}function G0(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++uU};return ht.vnode!=null&&ht.vnode(a),a}function Dbe(){return{current:null}}function Vi(e){return e.children}function Is(e,t){this.props=e,this.context=t}function $g(e,t){if(t==null)return e.__?$g(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?$g(e):null}function pU(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return pU(e)}}function SN(e){(!e.__d&&(e.__d=!0)&&H0.push(e)&&!m2.__r++||cU!==ht.debounceRendering)&&((cU=ht.debounceRendering)||lU)(m2)}function m2(){for(var e;m2.__r=H0.length;)e=H0.sort(function(t,n){return t.__v.__b-n.__v.__b}),H0=[],e.some(function(t){var n,r,i,a,o,s;t.__d&&(o=(a=(n=t).__v).__e,(s=n.__P)&&(r=[],(i=ql({},a)).__v=a.__v+1,EN(s,a,i,n.__n,s.ownerSVGElement!==void 0,a.__h!=null?[o]:null,r,o??$g(a),a.__h),wU(r,a),a.__e!=o&&pU(a)))})}function gU(e,t,n,r,i,a,o,s,u,l){var c,f,d,h,p,g,m,v=r&&r.__k||dU,y=v.length;for(n.__k=[],c=0;c<t.length;c++)if((h=n.__k[c]=(h=t[c])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?G0(null,h,null,null,h):Array.isArray(h)?G0(Vi,{children:h},null,null,null):h.__b>0?G0(h.type,h.props,h.key,null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(d=v[c])===null||d&&h.key==d.key&&h.type===d.type)v[c]=void 0;else for(f=0;f<y;f++){if((d=v[f])&&h.key==d.key&&h.type===d.type){v[f]=void 0;break}d=null}EN(e,h,d=d||g2,i,a,o,s,u,l),p=h.__e,(f=h.ref)&&d.ref!=f&&(m||(m=[]),d.ref&&m.push(d.ref,null,h),m.push(f,h.__c||p,h)),p!=null?(g==null&&(g=p),typeof h.type=="function"&&h.__k!=null&&h.__k===d.__k?h.__d=u=mU(h,u,e):u=vU(e,h,d,v,p,u),l||n.type!=="option"?typeof n.type=="function"&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=$g(d))}for(n.__e=g,c=y;c--;)v[c]!=null&&(typeof n.type=="function"&&v[c].__e!=null&&v[c].__e==n.__d&&(n.__d=$g(r,c+1)),SU(v[c],v[c]));if(m)for(c=0;c<m.length;c++)_U(m[c],m[++c],m[++c])}function mU(e,t,n){var r,i;for(r=0;r<e.__k.length;r++)(i=e.__k[r])&&(i.__=e,t=typeof i.type=="function"?mU(i,t,n):vU(n,i,i,e.__k,i.__e,t));return t}function Hl(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){Hl(n,t)}):t.push(e)),t}function vU(e,t,n,r,i,a){var o,s,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break e;e.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function Rbe(e,t,n,r,i){var a;for(a in n)a==="children"||a==="key"||a in t||v2(e,a,null,n[a],r);for(a in t)i&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||v2(e,a,t[a],n[a],r)}function yU(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||Nbe.test(t)?n:n+"px"}function v2(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||yU(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||yU(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?xU:bU,a):e.removeEventListener(t,a?xU:bU,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch(o){}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function bU(e){this.l[e.type+!1](ht.event?ht.event(e):e)}function xU(e){this.l[e.type+!0](ht.event?ht.event(e):e)}function EN(e,t,n,r,i,a,o,s,u){var l,c,f,d,h,p,g,m,v,y,b,x=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,s=t.__e=n.__e,t.__h=null,a=[s]),(l=ht.__b)&&l(t);try{e:if(typeof x=="function"){if(m=t.props,v=(l=x.contextType)&&r[l.__c],y=l?v?v.props.value:l.__:r,n.__c?g=(c=t.__c=n.__c).__=c.__E:("prototype"in x&&x.prototype.render?t.__c=c=new x(m,y):(t.__c=c=new Is(m,y),c.constructor=x,c.render=Mbe),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,f=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=ql({},c.__s)),ql(c.__s,x.getDerivedStateFromProps(m,c.__s))),d=c.props,h=c.state,f)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&m!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(m,y),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(m,c.__s,y)===!1||t.__v===n.__v){c.props=m,c.state=c.__s,t.__v!==n.__v&&(c.__d=!1),c.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(w){w&&(w.__=t)}),c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(m,c.__s,y),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,h,p)})}c.context=y,c.props=m,c.state=c.__s,(l=ht.__r)&&l(t),c.__d=!1,c.__v=t,c.__P=e,l=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(r=ql(ql({},r),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(p=c.getSnapshotBeforeUpdate(d,h)),b=l!=null&&l.type===Vi&&l.key==null?l.props.children:l,gU(e,Array.isArray(b)?b:[b],t,n,r,i,a,o,s,u),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Fbe(n.__e,t,n,r,i,a,o,u);(l=ht.diffed)&&l(t)}catch(w){t.__v=null,(u||a!=null)&&(t.__e=s,t.__h=!!u,a[a.indexOf(s)]=null),ht.__e(w,t,n)}}function wU(e,t){ht.__c&&ht.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){ht.__e(r,n.__v)}})}function Fbe(e,t,n,r,i,a,o,s){var u,l,c,f=n.props,d=t.props,h=t.type,p=0;if(h==="svg"&&(i=!0),a!=null){for(;p<a.length;p++)if((u=a[p])&&(u===e||(h?u.localName==h:u.nodeType==3))){e=u,a[p]=null;break}}if(e==null){if(h===null)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,d.is&&d),a=null,s=!1}if(h===null)f===d||s&&e.data===d||(e.data=d);else{if(a=a&&q0.call(e.childNodes),l=(f=n.props||g2).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(a!=null)for(f={},p=0;p<e.attributes.length;p++)f[e.attributes[p].name]=e.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(Rbe(e,d,f,i,s),c)t.__k=[];else if(p=t.props.children,gU(e,Array.isArray(p)?p:[p],t,n,r,i&&h!=="foreignObject",a,o,a?a[0]:n.__k&&$g(n,0),s),a!=null)for(p=a.length;p--;)a[p]!=null&&hU(a[p]);s||("value"in d&&(p=d.value)!==void 0&&(p!==e.value||h==="progress"&&!p)&&v2(e,"value",p,f.value,!1),"checked"in d&&(p=d.checked)!==void 0&&p!==e.checked&&v2(e,"checked",p,f.checked,!1))}return e}function _U(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){ht.__e(r,n)}}function SU(e,t,n){var r,i;if(ht.unmount&&ht.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||_U(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ht.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&SU(r[i],t,typeof e.type!="function");n||e.__e==null||hU(e.__e),e.__e=e.__d=void 0}function Mbe(e,t,n){return this.constructor(e,n)}function Lg(e,t,n){var r,i,a;ht.__&&ht.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],EN(t,e=(!r&&n||t).__k=ue(Vi,null,[e]),i||g2,g2,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?q0.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r),wU(a,e)}function EU(e,t){Lg(e,t,EU)}function Pbe(e,t,n){var r,i,a,o=ql({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?q0.call(arguments,2):n),G0(e.type,o,r||e.key,i||e.ref,null)}function ha(e,t){var n={__c:t="__cC"+fU++,__:e,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,a;return this.getChildContext||(i=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(SN)},this.sub=function(o){i.push(o);var s=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),s&&s.call(o)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}q0=dU.slice,ht={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(a){e=a}throw e}},uU=0,Is.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ql({},this.state),typeof e=="function"&&(e=e(ql({},n),this.props)),e&&ql(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),SN(this))},Is.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),SN(this))},Is.prototype.render=Vi,H0=[],lU=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,m2.__r=0,fU=0;var Bg,pa,CU,zg=0,CN=[],AU=ht.__b,kU=ht.__r,TU=ht.diffed,OU=ht.__c,IU=ht.unmount;function K0(e,t){ht.__h&&ht.__h(pa,e,zg||t),zg=0;var n=pa.__H||(pa.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function an(e){return zg=1,AN(DU,e)}function AN(e,t,n){var r=K0(Bg++,2);return r.t=e,r.__c||(r.__=[n?n(t):DU(void 0,t),function(i){var a=r.t(r.__[0],i);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=pa),r.__}function qt(e,t){var n=K0(Bg++,3);!ht.__s&&TN(n.__H,t)&&(n.__=e,n.__H=t,pa.__H.__h.push(n))}function of(e,t){var n=K0(Bg++,4);!ht.__s&&TN(n.__H,t)&&(n.__=e,n.__H=t,pa.__h.push(n))}function Jt(e){return zg=5,xr(function(){return{current:e}},[])}function $be(e,t,n){zg=6,of(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function xr(e,t){var n=K0(Bg++,7);return TN(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function st(e,t){return zg=8,xr(function(){return e},t)}function Un(e){var t=pa.context[e.__c],n=K0(Bg++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(pa)),t.props.value):e.__}function Lbe(e,t){ht.useDebugValue&&ht.useDebugValue(t?t(e):e)}function Bbe(){CN.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(y2),e.__H.__h.forEach(kN),e.__H.__h=[]}catch(t){e.__H.__h=[],ht.__e(t,e.__v)}}),CN=[]}ht.__b=function(e){pa=null,AU&&AU(e)},ht.__r=function(e){kU&&kU(e),Bg=0;var t=(pa=e.__c).__H;t&&(t.__h.forEach(y2),t.__h.forEach(kN),t.__h=[])},ht.diffed=function(e){TU&&TU(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(CN.push(t)!==1&&CU===ht.requestAnimationFrame||((CU=ht.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),NU&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);NU&&(r=requestAnimationFrame(i))})(Bbe)),pa=void 0},ht.__c=function(e,t){t.some(function(n){try{n.__h.forEach(y2),n.__h=n.__h.filter(function(r){return!r.__||kN(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],ht.__e(r,n.__v)}}),OU&&OU(e,t)},ht.unmount=function(e){IU&&IU(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(y2)}catch(n){ht.__e(n,t.__v)}};var NU=typeof requestAnimationFrame=="function";function y2(e){var t=pa;typeof e.__c=="function"&&e.__c(),pa=t}function kN(e){var t=pa;e.__c=e.__(),pa=t}function TN(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function DU(e,t){return typeof t=="function"?t(e):t}function RU(e,t){for(var n in t)e[n]=t[n];return e}function ON(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function b2(e){this.props=e}function FU(e,t){function n(i){var a=this.props.ref,o=a==i.ref;return!o&&a&&(a.call?a(null):a.current=null),t?!t(this.props,i)||!o:ON(this.props,i)}function r(i){return this.shouldComponentUpdate=n,ue(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(b2.prototype=new Is).isPureReactComponent=!0,b2.prototype.shouldComponentUpdate=function(e,t){return ON(this.props,e)||ON(this.state,t)};var MU=ht.__b;ht.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),MU&&MU(e)};var zbe=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Gl(e){function t(n,r){var i=RU({},n);return delete i.ref,e(i,(r=n.ref||r)&&(typeof r!="object"||"current"in r)?r:null)}return t.$$typeof=zbe,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var PU=function(e,t){return e==null?null:Hl(Hl(e).map(t))},x2={map:PU,forEach:PU,count:function(e){return e?Hl(e).length:0},only:function(e){var t=Hl(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Hl},jbe=ht.__e;ht.__e=function(e,t,n){if(e.then){for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}jbe(e,t,n)};var $U=ht.unmount;function w2(){this.__u=0,this.t=null,this.__b=null}function LU(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Ube(e){var t,n,r;function i(a){if(t||(t=e()).then(function(o){n=o.default||o},function(o){r=o}),r)throw r;if(!n)throw t;return ue(n,a)}return i.displayName="Lazy",i.__f=!0,i}function X0(){this.u=null,this.o=null}ht.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),$U&&$U(e)},(w2.prototype=new Is).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var i=LU(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__e){var l=r.state.__e;r.__v.__k[0]=function f(d,h,p){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(g){return f(g,h,p)}),d.__c&&d.__c.__P===h&&(d.__e&&p.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=p)),d}(l,l.__c.__P,l.__c.__O)}var c;for(r.setState({__e:r.__b=null});c=r.t.pop();)c.forceUpdate()}},u=t.__h===!0;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},w2.prototype.componentWillUnmount=function(){this.t=[]},w2.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(o,s,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),o.__c.__H=null),(o=RU({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=s),o.__c=null),o.__k=o.__k&&o.__k.map(function(l){return a(l,s,u)})),o}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&ue(Vi,null,e.fallback);return i&&(i.__h=null),[ue(Vi,null,t.__e?null:e.children),i]};var BU=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function Wbe(e){return this.getChildContext=function(){return e.context},e.children}function Vbe(e){var t=this,n=e.i;t.componentWillUnmount=function(){Lg(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Lg(ue(Wbe,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function IN(e,t){return ue(Vbe,{__v:e,i:t})}(X0.prototype=new Is).__e=function(e){var t=this,n=LU(t.__v),r=t.o.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),BU(t,e,r)):i()};n?n(a):a()}},X0.prototype.render=function(e){this.u=null,this.o=new Map;var t=Hl(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},X0.prototype.componentDidUpdate=X0.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){BU(e,n,t)})};var zU=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,qbe=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Hbe=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function Gbe(e,t,n){return t.__k==null&&(t.textContent=""),Lg(e,t),typeof n=="function"&&n(),e?e.__c:null}function Kbe(e,t,n){return EU(e,t),typeof n=="function"&&n(),e?e.__c:null}Is.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Is.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var jU=ht.event;function Xbe(){}function Ybe(){return this.cancelBubble}function Zbe(){return this.defaultPrevented}ht.event=function(e){return jU&&(e=jU(e)),e.persist=Xbe,e.isPropagationStopped=Ybe,e.isDefaultPrevented=Zbe,e.nativeEvent=e};var UU,WU={configurable:!0,get:function(){return this.class}},VU=ht.vnode;ht.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){for(var i in r={},n){var a=n[i];i==="value"&&"defaultValue"in n&&a==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&a===!0?a="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!Hbe(n.type)?i="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(i)?i=i.toLowerCase():qbe.test(i)?i=i.replace(/[A-Z0-9]/,"-$&").toLowerCase():a===null&&(a=void 0),r[i]=a)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Hl(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=Hl(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),e.props=r}t&&n.class!=n.className&&(WU.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",WU)),e.$$typeof=zU,VU&&VU(e)};var qU=ht.__r;ht.__r=function(e){qU&&qU(e),UU=e.__c};var Jbe={ReactCurrentDispatcher:{current:{readContext:function(e){return UU.__n[e.__c].props.value}}}};function Qbe(e){return ue.bind(null,e)}function ph(e){return!!e&&e.$$typeof===zU}function sf(e){return ph(e)?Pbe.apply(null,arguments):e}function e1e(e){return!!e.__k&&(Lg(null,e),!0)}function t1e(e){return e&&(e.base||e.nodeType===1&&e)||null}var n1e=function(e,t){return e(t)},r1e=function(e,t){return e(t)},zt={useState:an,useReducer:AN,useEffect:qt,useLayoutEffect:of,useRef:Jt,useImperativeHandle:$be,useMemo:xr,useCallback:st,useContext:Un,useDebugValue:Lbe,version:"17.0.2",Children:x2,render:Gbe,hydrate:Kbe,unmountComponentAtNode:e1e,createPortal:IN,createElement:ue,createContext:ha,createFactory:Qbe,cloneElement:sf,createRef:Dbe,Fragment:Vi,isValidElement:ph,findDOMNode:t1e,Component:Is,PureComponent:b2,memo:FU,forwardRef:Gl,flushSync:r1e,unstable_batchedUpdates:n1e,StrictMode:Vi,Suspense:w2,SuspenseList:X0,lazy:Ube,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Jbe};const NN=(e,t)=>{const[n,r]=an(DN()[1][e]||t);qt(()=>{const a=o=>{const s=DN()[1];r(s[e])};return window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const i=st((a,o)=>{const s=DN()[1];let u=!1;if(s.hasOwnProperty(e)&&a===null||a===void 0?(delete s[e],u=!0):s[e]!==a&&(s[e]=a,u=!0),!u)return[];const l=Object.keys(s);l.sort();const c=l.map((g,m)=>`${g}=${s[g]}`).join("&");let f=window.location.hash.substr(1);const d=f.indexOf("?");let h="";d>-1&&(h=f.substr(0,d));const p=new URL(window.location.href);p.hash=`${h}?${c}`,(o==null?void 0:o.modifyHistory)?window.location.hash=`${h}?${c}`:(window.history.replaceState(null,document.title,`${p.pathname}${p.search}${p.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},[]);return[n,i]},DN=()=>{let e=window.location.hash.substr(1);const t=e.indexOf("?");if(t===-1)return[e,{}];const n=e.substr(0,t);e=e.substr(t+1);const r=Object.fromEntries(e.split("&").filter(i=>i.length>0).map(i=>i.split("=")));return[n,r]},i1e=(e,t)=>{const[n,r]=NN(e,t?`${t}`:void 0),[i,a]=an(n==="true");qt(()=>{a(n==="true")},[e,n,a]);const o=st((s,u)=>{s==null||s===!1?r(void 0,u):r("true",u)},[r]);return[i,o]},a1e=(e,t)=>{const[n,r]=NN(e,t?t.toString():void 0),[i,a]=an(n?parseInt(n):void 0);qt(()=>{a(n?parseInt(n):void 0)},[e,n,a]);const o=st((s,u)=>{r(s?s.toString():void 0,u)},[r]);return[i,o]},HU=(e,t)=>{const[n,r]=NN(e,t?GU(t):void 0),[i,a]=an(KU(n));qt(()=>{a(KU(n))},[e,n,a]);const o=st((s,u)=>{if(s==null)r(void 0,u);else{const l=GU(s);r(l,u)}},[r]);return[i,o]},GU=e=>btoa(JSON.stringify(e)),KU=e=>{if(e&&e.length>0)try{return JSON.parse(atob(e))}catch(t){console.error(t)}};var Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function gh(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}function uf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var o1e={},s1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:o1e}),u1e=gh(s1e),l1e=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r],r);c1e(i)?n.push.apply(n,i):n.push(i)}return n},c1e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},f1e=XU;function XU(e,t,n){e instanceof RegExp&&(e=YU(e,n)),t instanceof RegExp&&(t=YU(t,n));var r=ZU(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function YU(e,t){var n=t.match(e);return n?n[0]:null}XU.range=ZU;function ZU(e,t,n){var r,i,a,o,s,u=n.indexOf(e),l=n.indexOf(t,u+1),c=u;if(u>=0&&l>0){if(e===t)return[u,l];for(r=[],a=n.length;c>=0&&!s;)c==u?(r.push(c),u=n.indexOf(e,c+1)):r.length==1?s=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,o=l),l=n.indexOf(t,c+1)),c=u<l&&u>=0?u:l;r.length&&(s=[a,o])}return s}var d1e=l1e,JU=f1e,h1e=m1e,QU="\0SLASH"+Math.random()+"\0",eW="\0OPEN"+Math.random()+"\0",RN="\0CLOSE"+Math.random()+"\0",tW="\0COMMA"+Math.random()+"\0",nW="\0PERIOD"+Math.random()+"\0";function FN(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function p1e(e){return e.split("\\\\").join(QU).split("\\{").join(eW).split("\\}").join(RN).split("\\,").join(tW).split("\\.").join(nW)}function g1e(e){return e.split(QU).join("\\").split(eW).join("{").split(RN).join("}").split(tW).join(",").split(nW).join(".")}function rW(e){if(!e)return[""];var t=[],n=JU("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=rW(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function m1e(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),jg(p1e(e),!0).map(g1e)):[]}function v1e(e){return"{"+e+"}"}function y1e(e){return/^-?0\d/.test(e)}function b1e(e,t){return e<=t}function x1e(e,t){return e>=t}function jg(e,t){var n=[],r=JU("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||a,s=r.body.indexOf(",")>=0;if(!o&&!s)return r.post.match(/,.*\}/)?(e=r.pre+"{"+r.body+RN+r.post,jg(e)):[e];var u;if(o)u=r.body.split(/\.\./);else if(u=rW(r.body),u.length===1&&(u=jg(u[0],!1).map(v1e),u.length===1)){var c=r.post.length?jg(r.post,!1):[""];return c.map(function(k){return r.pre+u[0]+k})}var l=r.pre,c=r.post.length?jg(r.post,!1):[""],f;if(o){var d=FN(u[0]),h=FN(u[1]),p=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(FN(u[2])):1,m=b1e,v=h<d;v&&(g*=-1,m=x1e);var y=u.some(y1e);f=[];for(var b=d;m(b,h);b+=g){var x;if(a)x=String.fromCharCode(b),x==="\\"&&(x="");else if(x=String(b),y){var w=p-x.length;if(w>0){var S=new Array(w+1).join("0");b<0?x="-"+S+x.slice(1):x=S+x}}f.push(x)}}else f=d1e(u,function(A){return jg(A,!1)});for(var C=0;C<f.length;C++)for(var _=0;_<c.length;_++){var E=l+f[C]+c[_];(!t||o||E)&&n.push(E)}return n}var w1e=es;es.Minimatch=pi;var Y0={sep:"/"};try{Y0=u1e}catch(e){}var MN=es.GLOBSTAR=pi.GLOBSTAR={},_1e=h1e,iW={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},PN="[^/]",$N=PN+"*?",S1e="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",E1e="(?:(?!(?:\\/|^)\\.).)*?",aW=C1e("().*{}+?[]^$\\!");function C1e(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var oW=/\/+/;es.filter=A1e;function A1e(e,t){return t=t||{},function(n,r,i){return es(n,e,t)}}function sW(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(r){n[r]=t[r]}),Object.keys(e).forEach(function(r){n[r]=e[r]}),n}es.defaults=function(e){if(!e||!Object.keys(e).length)return es;var t=es,n=function(i,a,o){return t.minimatch(i,a,sW(e,o))};return n.Minimatch=function(i,a){return new t.Minimatch(i,sW(e,a))},n},pi.defaults=function(e){return!e||!Object.keys(e).length?pi:es.defaults(e).Minimatch};function es(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new pi(t,n).match(e)}function pi(e,t){if(!(this instanceof pi))return new pi(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),Y0.sep!=="/"&&(e=e.split(Y0.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}pi.prototype.debug=function(){},pi.prototype.make=k1e;function k1e(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(r){return r.split(oW)}),this.debug(this.pattern,n),n=n.map(function(r,i,a){return r.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}pi.prototype.parseNegate=T1e;function T1e(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,a=e.length;i<a&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}es.braceExpand=function(e,t){return uW(e,t)},pi.prototype.braceExpand=uW;function uW(e,t){if(t||(this instanceof pi?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:_1e(e)}pi.prototype.parse=O1e;var _2={};function O1e(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return MN;if(e==="")return"";var r="",i=!!n.nocase,a=!1,o=[],s=[],u,l=!1,c=-1,f=-1,d=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function p(){if(u){switch(u){case"*":r+=$N,i=!0;break;case"?":r+=PN,i=!0;break;default:r+="\\"+u;break}h.debug("clearStateChar %j %j",u,r),u=!1}}for(var g=0,m=e.length,v;g<m&&(v=e.charAt(g));g++){if(this.debug("%s	%s %s %j",e,g,r,v),a&&aW[v]){r+="\\"+v,a=!1;continue}switch(v){case"/":return!1;case"\\":p(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,g,r,v),l){this.debug("  in class"),v==="!"&&g===f+1&&(v="^"),r+=v;continue}h.debug("call clearStateChar %j",u),p(),u=v,n.noext&&p();continue;case"(":if(l){r+="(";continue}if(!u){r+="\\(";continue}o.push({type:u,start:g-1,reStart:r.length,open:iW[u].open,close:iW[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(l||!o.length){r+="\\)";continue}p(),i=!0;var y=o.pop();r+=y.close,y.type==="!"&&s.push(y),y.reEnd=r.length;continue;case"|":if(l||!o.length||a){r+="\\|",a=!1;continue}p(),r+="|";continue;case"[":if(p(),l){r+="\\"+v;continue}l=!0,f=g,c=r.length,r+=v;continue;case"]":if(g===f+1||!l){r+="\\"+v,a=!1;continue}if(l){var b=e.substring(f+1,g);try{RegExp("["+b+"]")}catch(K){var x=this.parse(b,_2);r=r.substr(0,c)+"\\["+x[0]+"\\]",i=i||x[1],l=!1;continue}}i=!0,l=!1,r+=v;continue;default:p(),a?a=!1:aW[v]&&!(v==="^"&&l)&&(r+="\\"),r+=v}}for(l&&(b=e.substr(f+1),x=this.parse(b,_2),r=r.substr(0,c)+"\\["+x[0],i=i||x[1]),y=o.pop();y;y=o.pop()){var w=r.slice(y.reStart+y.open.length);this.debug("setting tail",r,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(K,ee,ce){return ce||(ce="\\"),ee+ee+ce+"|"}),this.debug(`tail=%j
   %s`,w,w,y,r);var S=y.type==="*"?$N:y.type==="?"?PN:"\\"+y.type;i=!0,r=r.slice(0,y.reStart)+S+"\\("+w}p(),a&&(r+="\\\\");var C=!1;switch(r.charAt(0)){case".":case"[":case"(":C=!0}for(var _=s.length-1;_>-1;_--){var E=s[_],A=r.slice(0,E.reStart),k=r.slice(E.reStart,E.reEnd-8),T=r.slice(E.reEnd-8,E.reEnd),I=r.slice(E.reEnd);T+=I;var N=A.split("(").length-1,O=I;for(g=0;g<N;g++)O=O.replace(/\)[+*?]?/,"");I=O;var D="";I===""&&t!==_2&&(D="$");var L=A+k+I+D+T;r=L}if(r!==""&&i&&(r="(?=.)"+r),C&&(r=d+r),t===_2)return[r,i];if(!i)return D1e(e);var W=n.nocase?"i":"";try{var G=new RegExp("^"+r+"$",W)}catch(K){return new RegExp("$.")}return G._glob=e,G._src=r,G}es.makeRe=function(e,t){return new pi(e,t||{}).makeRe()},pi.prototype.makeRe=I1e;function I1e(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?$N:t.dot?S1e:E1e,r=t.nocase?"i":"",i=e.map(function(a){return a.map(function(o){return o===MN?n:typeof o=="string"?R1e(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(a){this.regexp=!1}return this.regexp}es.match=function(e,t,n){n=n||{};var r=new pi(t,n);return e=e.filter(function(i){return r.match(i)}),r.options.nonull&&!e.length&&e.push(t),e},pi.prototype.match=N1e;function N1e(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;Y0.sep!=="/"&&(e=e.split(Y0.sep).join("/")),e=e.split(oW),this.debug(this.pattern,"split",e);var r=this.set;this.debug(this.pattern,"set",r);var i,a;for(a=e.length-1;a>=0&&(i=e[a],!i);a--);for(a=0;a<r.length;a++){var o=r[a],s=e;n.matchBase&&o.length===1&&(s=[i]);var u=this.matchOne(s,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}pi.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,a=0,o=e.length,s=t.length;i<o&&a<s;i++,a++){this.debug("matchOne loop");var u=t[a],l=e[i];if(this.debug(t,u,l),u===!1)return!1;if(u===MN){this.debug("GLOBSTAR",[t,u,l]);var c=i,f=a+1;if(f===s){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}for(;c<o;){var d=e[c];if(this.debug(`
globstar while`,e,c,t,f,d),this.matchOne(e.slice(c),t.slice(f),n))return this.debug("globstar found match!",c,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,c,t,f);break}this.debug("globstar swallow a segment, and continue"),c++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,c,t,f),c===o))}var h;if(typeof u=="string"?(r.nocase?h=l.toLowerCase()===u.toLowerCase():h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===o&&a===s)return!0;if(i===o)return n;if(a===s){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function D1e(e){return e.replace(/\\(.)/g,"$1")}function R1e(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var S2;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(S2||(S2={}));var Ns;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(Ns||(Ns={}));const lW=Object.keys(S2);S2.V0_4;const cW=Object.keys(Ns),E2=Ns.V0_3;var jt;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(jt||(jt={}));var ga;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(ga||(ga={}));var Kl;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(Kl||(Kl={}));var LN;(function(e){e.State="metapage/state"})(LN||(LN={}));const Ou="metapage/definition",lf="metapage/state",fW=cW[cW.length-1],F1e=lW[lW.length-1];var Z0={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ye,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function r(f,d){return f.indexOf(d)===-1?f.length:f.indexOf(d)}function i(f){var d=f.replace(/^v/,"").replace(/\+.*$/,""),h=r(d,"-"),p=d.substring(0,h).split(".");return p.push(d.substring(h+1)),p}function a(f){return isNaN(Number(f))?f:Number(f)}function o(f){if(typeof f!="string")throw new TypeError("Invalid argument expected string");if(!n.test(f))throw new Error("Invalid argument not valid semver ('"+f+"' received)")}function s(f,d){[f,d].forEach(o);for(var h=i(f),p=i(d),g=0;g<Math.max(h.length-1,p.length-1);g++){var m=parseInt(h[g]||0,10),v=parseInt(p[g]||0,10);if(m>v)return 1;if(v>m)return-1}var y=h[h.length-1],b=p[p.length-1];if(y&&b){var x=y.split(".").map(a),w=b.split(".").map(a);for(g=0;g<Math.max(x.length,w.length);g++){if(x[g]===void 0||typeof w[g]=="string"&&typeof x[g]=="number")return-1;if(w[g]===void 0||typeof x[g]=="string"&&typeof w[g]=="number"||x[g]>w[g])return 1;if(w[g]>x[g])return-1}}else if(y||b)return y?-1:1;return 0}var u=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function c(f){if(typeof f!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof f);if(u.indexOf(f)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return s.validate=function(f){return typeof f=="string"&&n.test(f)},s.compare=function(f,d,h){c(h);var p=s(f,d);return l[h].indexOf(p)>-1},s})})(Z0);var C2={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,f||u,d),p=n?n+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount==0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},s.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,d,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,d),!0;case 5:return m.fn.call(m.context,c,f,d,h),!0;case 6:return m.fn.call(m.context,c,f,d,h,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var x=m.length,w;for(b=0;b<x;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,f);break;case 4:m[b].fn.call(m[b].context,c,f,d);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];m[b].fn.apply(m[b].context,y)}}return!0},s.prototype.on=function(l,c,f){return a(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return a(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,d){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!d||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||f&&p[g].context!==f)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(C2);var A2;(function(e){e.mp_debug="mp_debug"})(A2||(A2={}));const M1e=()=>{try{return window!==window.top}catch(e){return!1}};class P1e extends C2.exports.EventEmitter{constructor(){super();this._definition={version:Ns.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var $1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};const dW=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch(n){throw`Cannot parse into JSON:
${e}`}let t;switch(B1e(e.version)){case Ns.V0_2:{t=dW(L1e(e));break}case Ns.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${E2}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},L1e=e=>(e.version=Ns.V0_3,e),k2=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(r=>{n=!0,t[r]===void 0?delete e[r]:e[r]=t[r]}),n},B1e=e=>{if(e=="latest")return E2;if(Z0.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return Z0.exports.compare(e,"0.2",">=")&&Z0.exports.compare(e,Ns.V0_3,"<")?Ns.V0_2:Z0.exports.compare(e,"0.3",">=")?Ns.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${E2}`),E2)},BN=()=>{const e=new URLSearchParams(window.location.search).get(A2.mp_debug);return e==="true"||e==="1"},z1e=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,j1e=(e=8)=>U1e(e),hW="abcdefghijklmnopqrstuvwxyz0123456789",U1e=(e=8)=>{for(var t="",n=hW.length,r=0;r<e;r++)t+=hW.charAt(Math.floor(Math.random()*n));return t},zN=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let r;if(typeof e=="string"?r=e:typeof e=="number"?r=e+"":r=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var i=`color: #${t}`;n&&(i=`${i}; background: #${n}`),r=`%c${r}`,window.console.log(r,i)}else window.console.log(r)},pW=e=>V1e(W1e(e)),W1e=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},V1e=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},jN=()=>document.readyState=="complete"||document.readyState=="interactive",UN=()=>$1e(void 0,void 0,void 0,function*(){return jN()?Promise.resolve():new Promise(e=>{if(jN()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&jN()&&(t=!0,e())},200)})});var gW=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};class mW extends C2.exports.EventEmitter{constructor(t,n,r,i,a,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var s=new URL(this.url);o&&s.searchParams.set(A2.mp_debug,"true"),this.url=s.href,this.id=r,this._debug=o,this._parentId=i,this._color=pW(this.id),this._consoleBackgroundColor=a,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(l=>{UN().then(()=>gW(this,void 0,void 0,function*(){if(u._iframe){const c=yield u.getDefinition();if(!u._iframe)return;(c==null?void 0:c.allow)&&(u._iframe.allow=c.allow),u._iframe.src=this.url,l(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[lf]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Ou]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return gW(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const r=yield n.json();return this._definition=r,this._definition}else this.emit(jt.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(jt.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var r={};r[t]=n,this.setInputs(r)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!k2(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(jt.Inputs,this.inputs),this._metapage.listenerCount(jt.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(jt.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){if(!!k2(this.outputs,t)&&(this.emit(jt.Outputs,t),this._metapage.listenerCount(jt.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(jt.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(jt.Inputs,t)}onInput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Inputs,r)}onOutputs(t){return this.addListenerReturnDisposer(jt.Outputs,t)}onOutput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Outputs,r)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:fW};this.sendRpcInternal(Kl.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(Kl.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const r=this;this._onLoaded.push(()=>{r.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(Kl.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),zN(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const r={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(r):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(r).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(r=>n._iframe.contentWindow.postMessage(r,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var q1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},vW;(function(e){e.all="all",e.delta="delta"})(vW||(vW={}));const yW=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),H1e="bcbcbc";class Ds extends P1e{constructor(t){super();this._state=yW(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=BN(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:j1e(),this._consoleBackgroundColor=t&&t.color?t.color:H1e,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),UN().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch(i){throw"Cannot parse into JSON:\n${metaPageDef}"}var r=new Ds;return r.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=z1e(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(jt.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const r=dW(t);return r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(r.plugins&&r.plugins.includes(i))throw this.emitErrorMessage(`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var a=r.metaframes[i];if(typeof a!="object")throw this.emitErrorMessage(`Metaframe "${i}" is not an object`),`Metaframe "${i}" is not an object`;if(!a.url)throw this.emitErrorMessage(`Metaframe "${i}" missing field: url`),`Metaframe "${i}" missing field: url`}),this._definition=r,Object.keys(this._metaframes).forEach(i=>{(!r.metaframes||!r.metaframes[i])&&this.removeMetaframe(i)}),Object.keys(this._plugins).forEach(i=>{r.plugins&&!r.plugins.includes(i)&&this.removePlugin(i)}),this._pluginOrder=r.plugins?r.plugins:[],n&&(this._state=n),r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(!this._metaframes.hasOwnProperty(i)){const a=r.metaframes[i];this.addMetaframe(i,a)}}),r.plugins&&r.plugins.forEach(i=>{this._plugins.hasOwnProperty(i)||this.addPlugin(i)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(jt.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(jt.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var r;const i=this._inputMap[n];let a=0;for(;a<=i.length;)((r=i[a])===null||r===void 0?void 0:r.metaframe)===t?i.splice(a,1):a++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=yW(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var r=new mW(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=r,r.addListener(jt.Error,i=>{this.emit(jt.Error,{metaframeId:r.id,metaframeUrl:r.url,error:i})}),n.inputs&&n.inputs.forEach(i=>this.addPipe(t,i)),r.setInputs(this._state.metaframes.inputs[t]),r}addPlugin(t){if(!t)throw"Plugin missing url";const n=new mW(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return G1e(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,r){!this.debug||this.logInternal(t,n,r)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(jt.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var r=[];this._cachedInputLookupMap[t][n]=r,Object.keys(this._inputMap).forEach(i=>{i!==t&&this._inputMap[i].forEach(a=>{if(a.metaframe==t&&w1e(n,a.source)){var o=a.target;(!a.target||a.target.startsWith("*")||a.target==="")&&(o=n),r.push({metaframe:i,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case ga.SetupIframeClientRequest:return!0;default:var r=t.iframeId;return!(r&&!(t.parentId===this._id&&(this._metaframes[r]||this._plugins[r])))}}setInput(t,n,r){this.setInputStateOnly(t,n,r),this.setMetaframeClientInputAndSentClientEvent(t,n,r),this.emit(jt.State,this._state),this.emit(jt.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,r){if(typeof t=="object"){if(n||r)throw"bad arguments, see API docs";const i=t;Object.keys(i).forEach(a=>{var o=a,s=i[o];if(typeof s!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(s):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const i=this._metaframes[t];if(i==null&&this.error(`No iframe id=${t}`),typeof n=="string")i.setInput(n,r);else if(typeof n=="object")i.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,r){this.setInput(t,n,r)}setOutputStateOnly(t,n,r){this._setStateOnly(!1,t,n,r)}setInputStateOnly(t,n,r){this._setStateOnly(!0,t,n,r)}_setStateOnly(t,n,r,i){if(typeof n=="object"){if(r||i)throw"If first argument is an object, subsequent args should be undefined";const a=n;Object.keys(a).forEach(o=>{var s=a[o];if(typeof s!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const l=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;l[o]=l[o]?l[o]:{},Object.keys(s).forEach(c=>{s[c]===void 0?delete l[o][c]:l[o][c]=s[c]})})}else if(typeof n=="string"){const a=n,o=this._metaframes.hasOwnProperty(a);if(!o&&!this._plugins.hasOwnProperty(a))throw`No metaframe or plugin: ${a}`;const s=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof r=="string"){s[a]=s[a]?s[a]:{};const u=r;i===void 0?delete s[a][u]:s[a][u]=i}else if(typeof r=="object"){s[a]=s[a]?s[a]:{};const u=r;Object.keys(u).forEach(l=>{u[l]===void 0?delete s[a][l]:s[a][l]=u[l]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const s=o.iframeId;if(!s)return;const u=this.getMetaframeOrPlugin(s),l=this._plugins[s];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case ga.SetupIframeClientRequest:u&&u.register();break;case ga.SetupIframeServerResponseAck:if(u){const f=o.params;u.registered(f.version)}break;case ga.OutputsUpdate:const c=o.params;if(this._metaframes[s]){var r=this._metaframes[s];this.setOutputStateOnly(s,c),r.setOutputs(c),this.emit(jt.State,this._state);var i=!1;const f=Object.keys(c),d={};f.forEach((h,p)=>{const g=this.getInputsFromOutput(s,h);g.length>0&&g.forEach(m=>{d[m.metaframe]||(d[m.metaframe]={}),d[m.metaframe][m.pipe]=c[h],this.setInputStateOnly(m.metaframe,m.pipe,c[h]),i=!0})}),Object.keys(d).forEach(h=>{this._metaframes[h].setInputs(d[h])}),i&&this.emit(jt.State,this._state),this.debug&&r.ack({jsonrpc:o,state:this._state})}else if(this._plugins[s]){const f=!c[lf]&&!c[Ou];f&&this.setOutputStateOnly(s,c),this._plugins[s].setOutputs(c),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case ga.InputsUpdate:var a=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(a)} from ${s}`),this._metaframes[s])this.setInputStateOnly(s,a),this._metaframes[s].setInputs(a),this.emit(jt.State,this._state),this.debug&&this._metaframes[s].ack({jsonrpc:o,state:this._state});else if(this._plugins[s]){const f=!a[lf]&&!a[Ou];f&&this.setInputStateOnly(s,a),this._plugins[s].setInputs(a),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`);break;case ga.PluginRequest:l&&u&&u.hasPermissionsState()&&(u.setInput(lf,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case ga.HashParamsUpdate:if(!l&&u){const f=o.params,d=new URL(u.url);d.hash=f.hash,u.url=d.href,this._definition.metaframes[f.metaframe].url=d.href,this.emit(jt.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(jt.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&K1e(t)})}logInternal(t,n,r){r=r||this._consoleBackgroundColor;let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),i=this._id?`Metapage[${this._id}] ${i}`:i,zN(i,n,r)}}Ds.version=fW,Ds.DEFINITION=jt.Definition,Ds.DEFINITION_UPDATE_REQUEST=jt.DefinitionUpdateRequest,Ds.ERROR=jt.Error,Ds.INPUTS=jt.Inputs,Ds.MESSAGE=jt.Message,Ds.OUTPUTS=jt.Outputs,Ds.STATE=jt.State,Ds.URL_HASH_UPDATE=jt.UrlHashUpdate;const G1e=(e,t)=>q1e(void 0,void 0,void 0,function*(){try{const i=yield t.getDefinition();if(!i)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(jt.Definition,a=>{t.setInput(Ou,a.definition)});t._disposables.push(n);var r=e.getDefinition();if(r&&(t.setInput(Ou,r),i.outputs)){var n=t.onOutput(Ou,o=>{e.emit(jt.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&i.outputs){var n=t.onOutput(lf,o=>{e.setState(o)});t._disposables.push(n)}}catch(i){console.error(i),e.emit(jt.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${i}`)}}),K1e=e=>{const t=e._metapage.getDefinition();e.setInput(Ou,t)};var X1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},cf;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(cf||(cf={}));var gi;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(gi||(gi={}));class Rs extends C2.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=cf.WaitingForPageLoad,this._messageSendCount=0,this.debug=BN(),this.id=window.name,this.debug=BN(),this._isIframe=M1e(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;UN().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(ga.SetupIframeClientRequest,{version:Rs.version}),n._state=cf.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===cf.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=pW(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=cf.Ready,this.sendRpc(ga.SetupIframeServerResponseAck,{version:Rs.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(gi.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(gi.Input,n,this._inputPipeValues[n]))),this.emit(gi.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new Y1e(this)),this.emit(gi.Connected))}connected(){return X1e(this,void 0,void 0,function*(){if(this._state!==cf.Ready)return new Promise((t,n)=>{let r;r=this.addListenerReturnDisposer(gi.Connected,()=>{t(),r()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,r){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,r){let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),n=n&&n+"",i=(this.id?`Metaframe[${this.id}] `:"")+`${i}`,zN(i,n,r)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===gi.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(gi.Input,(r,i)=>{t===r&&n(i)})}onInputs(t){return this.addListenerReturnDisposer(gi.Inputs,t)}setInput(t,n){var r={};r[t]=n,this.setInputs(r)}setInputs(t){this.sendRpc(ga.InputsUpdate,t)}setInternalInputsAndNotify(t){!k2(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(gi.Input,n,t[n])),this.emit(gi.Inputs,t))}getInput(t){return console.assert(t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(t),this._outputPipeValues[t]}setOutput(t,n){console.assert(t),console.assert(n);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){!k2(this._outputPipeValues,t)||this.sendRpc(ga.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(ga.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const r={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(r,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let r=t.data;if(r.jsonrpc==="2.0"){var n=r.method;if(!(n==Kl.SetupIframeServerResponse||r.parentId==this._parentId&&r.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${r.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${r.iframeId} id=${this.id}`);return}switch(n){case Kl.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(r.params);break;case Kl.InputsUpdate:if(this._state!==cf.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(r.params.inputs);break;case Kl.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(r)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(r)}`);break}this.emit(gi.Message,r)}}}}Rs.version=F1e,Rs.ERROR=gi.Error,Rs.CONNECTED=gi.Connected,Rs.INPUT=gi.Input,Rs.INPUTS=gi.Inputs,Rs.MESSAGE=gi.Message;class Y1e{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:LN.State};this._metaframe.sendRpc(ga.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(lf,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(lf)}setState(t){this._metaframe.setOutput(lf,t)}onDefinition(t){var n=this._metaframe.onInput(Ou,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(Ou,t)}getDefinition(){return this._metaframe.getInput(Ou)}}const Z1e={inputs:{}},bW=ha(Z1e),J1e=()=>Un(bW),Q1e=e=>{const[t,n]=an({inputs:{}}),[r,i]=an(void 0),[a,o]=an(t.inputs);return qt(()=>{const s=new Rs,u=l=>{o(l)};return s.onInputs(u),i(s),()=>{s.removeListener(Rs.INPUTS,u),s.dispose()}},[i,o]),qt(()=>{a&&r&&n({metaframe:r,inputs:a,setOutputs:r.setOutputs})},[a,r]),zt.createElement(bW.Provider,{value:t},e.children)},exe=()=>{try{return window!==window.top}catch(e){return!1}};function txe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function nxe(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var xW=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?a=r.prepend?r.container.firstChild:r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(nxe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=txe(i);try{a.insertRule(r,a.cssRules.length)}catch(o){}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),qi="-ms-",T2="-moz-",An="-webkit-",wW="comm",WN="rule",VN="decl",rxe="@import",ixe="@keyframes",axe=Math.abs,O2=String.fromCharCode;function oxe(e,t){return(((t<<2^Xa(e,0))<<2^Xa(e,1))<<2^Xa(e,2))<<2^Xa(e,3)}function _W(e){return e.trim()}function sxe(e,t){return(e=t.exec(e))?e[0]:e}function Mn(e,t,n){return e.replace(t,n)}function SW(e,t){return e.indexOf(t)}function Xa(e,t){return e.charCodeAt(t)|0}function J0(e,t,n){return e.slice(t,n)}function Iu(e){return e.length}function qN(e){return e.length}function I2(e,t){return t.push(e),e}function uxe(e,t){return e.map(t).join("")}var N2=1,Ug=1,EW=0,Eo=0,jr=0,Wg="";function D2(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:N2,column:Ug,length:o,return:""}}function Q0(e,t,n){return D2(e,t.root,t.parent,n,t.props,t.children,0)}function lxe(){return jr}function cxe(){return jr=Eo>0?Xa(Wg,--Eo):0,Ug--,jr===10&&(Ug=1,N2--),jr}function ts(){return jr=Eo<EW?Xa(Wg,Eo++):0,Ug++,jr===10&&(Ug=1,N2++),jr}function Xl(){return Xa(Wg,Eo)}function R2(){return Eo}function F2(e,t){return J0(Wg,e,t)}function M2(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function CW(e){return N2=Ug=1,EW=Iu(Wg=e),Eo=0,[]}function AW(e){return Wg="",e}function HN(e){return _W(F2(Eo-1,GN(e===91?e+2:e===40?e+1:e)))}function fxe(e){for(;(jr=Xl())&&jr<33;)ts();return M2(e)>2||M2(jr)>3?"":" "}function dxe(e,t){for(;--t&&ts()&&!(jr<48||jr>102||jr>57&&jr<65||jr>70&&jr<97););return F2(e,R2()+(t<6&&Xl()==32&&ts()==32))}function GN(e){for(;ts();)switch(jr){case e:return Eo;case 34:case 39:return GN(e===34||e===39?e:jr);case 40:e===41&&GN(e);break;case 92:ts();break}return Eo}function hxe(e,t){for(;ts()&&e+jr!==47+10;)if(e+jr===42+42&&Xl()===47)break;return"/*"+F2(t,Eo-1)+"*"+O2(e===47?e:ts())}function kW(e){for(;!M2(Xl());)ts();return F2(e,Eo)}function pxe(e){return AW(P2("",null,null,null,[""],e=CW(e),0,[0],e))}function P2(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,f=o,d=0,h=0,p=0,g=1,m=1,v=1,y=0,b="",x=i,w=a,S=r,C=b;m;)switch(p=y,y=ts()){case 34:case 39:case 91:case 40:C+=HN(y);break;case 9:case 10:case 13:case 32:C+=fxe(p);break;case 92:C+=dxe(R2()-1,7);continue;case 47:switch(Xl()){case 42:case 47:I2(gxe(hxe(ts(),R2()),t,n),u);break;default:C+="/"}break;case 123*g:s[l++]=Iu(C)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:h>0&&Iu(C)-f&&I2(h>32?OW(C+";",r,n,f-1):OW(Mn(C," ","")+";",r,n,f-2),u);break;case 59:C+=";";default:if(I2(S=TW(C,t,n,l,c,i,s,b,x=[],w=[],f),a),y===123)if(c===0)P2(C,t,S,S,x,a,f,s,w);else switch(d){case 100:case 109:case 115:P2(e,S,S,r&&I2(TW(e,S,S,0,0,i,s,b,i,x=[],f),w),i,w,f,s,r?x:w);break;default:P2(C,S,S,S,[""],w,f,s,w)}}l=c=h=0,g=v=1,b=C="",f=o;break;case 58:f=1+Iu(C),h=p;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&cxe()==125)continue}switch(C+=O2(y),y*g){case 38:v=c>0?1:(C+="\f",-1);break;case 44:s[l++]=(Iu(C)-1)*v,v=1;break;case 64:Xl()===45&&(C+=HN(ts())),d=Xl(),c=Iu(b=C+=kW(R2())),y++;break;case 45:p===45&&Iu(C)==2&&(g=0)}}return a}function TW(e,t,n,r,i,a,o,s,u,l,c){for(var f=i-1,d=i===0?a:[""],h=qN(d),p=0,g=0,m=0;p<r;++p)for(var v=0,y=J0(e,f+1,f=axe(g=o[p])),b=e;v<h;++v)(b=_W(g>0?d[v]+" "+y:Mn(y,/&\f/g,d[v])))&&(u[m++]=b);return D2(e,t,n,i===0?WN:s,u,l,c)}function gxe(e,t,n){return D2(e,t,n,wW,O2(lxe()),J0(e,2,-2),0)}function OW(e,t,n,r){return D2(e,t,n,VN,J0(e,0,r),J0(e,r+1,-1),r)}function IW(e,t){switch(oxe(e,t)){case 5103:return An+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return An+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return An+e+T2+e+qi+e+e;case 6828:case 4268:return An+e+qi+e+e;case 6165:return An+e+qi+"flex-"+e+e;case 5187:return An+e+Mn(e,/(\w+).+(:[^]+)/,An+"box-$1$2"+qi+"flex-$1$2")+e;case 5443:return An+e+qi+"flex-item-"+Mn(e,/flex-|-self/,"")+e;case 4675:return An+e+qi+"flex-line-pack"+Mn(e,/align-content|flex-|-self/,"")+e;case 5548:return An+e+qi+Mn(e,"shrink","negative")+e;case 5292:return An+e+qi+Mn(e,"basis","preferred-size")+e;case 6060:return An+"box-"+Mn(e,"-grow","")+An+e+qi+Mn(e,"grow","positive")+e;case 4554:return An+Mn(e,/([^-])(transform)/g,"$1"+An+"$2")+e;case 6187:return Mn(Mn(Mn(e,/(zoom-|grab)/,An+"$1"),/(image-set)/,An+"$1"),e,"")+e;case 5495:case 3959:return Mn(e,/(image-set\([^]*)/,An+"$1$`$1");case 4968:return Mn(Mn(e,/(.+:)(flex-)?(.*)/,An+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+An+e+e;case 4095:case 3583:case 4068:case 2532:return Mn(e,/(.+)-inline(.+)/,An+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Iu(e)-1-t>6)switch(Xa(e,t+1)){case 109:if(Xa(e,t+4)!==45)break;case 102:return Mn(e,/(.+:)(.+)-([^]+)/,"$1"+An+"$2-$3$1"+T2+(Xa(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~SW(e,"stretch")?IW(Mn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Xa(e,t+1)!==115)break;case 6444:switch(Xa(e,Iu(e)-3-(~SW(e,"!important")&&10))){case 107:return Mn(e,":",":"+An)+e;case 101:return Mn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+An+(Xa(e,14)===45?"inline-":"")+"box$3$1"+An+"$2$3$1"+qi+"$2box$3")+e}break;case 5936:switch(Xa(e,t+11)){case 114:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return An+e+qi+e+e}return e}function ey(e,t){for(var n="",r=qN(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function mxe(e,t,n,r){switch(e.type){case rxe:case VN:return e.return=e.return||e.value;case wW:return"";case WN:e.value=e.props.join(",")}return Iu(n=ey(e.children,r))?e.return=e.value+"{"+n+"}":""}function vxe(e){var t=qN(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}function yxe(e){return function(t){t.root||(t=t.return)&&e(t)}}function bxe(e,t,n,r){if(!e.return)switch(e.type){case VN:e.return=IW(e.value,e.length);break;case ixe:return ey([Q0(Mn(e.value,"@","@"+An),e,"")],r);case WN:if(e.length)return uxe(e.props,function(i){switch(sxe(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ey([Q0(Mn(i,/:(read-\w+)/,":"+T2+"$1"),e,"")],r);case"::placeholder":return ey([Q0(Mn(i,/:(plac\w+)/,":"+An+"input-$1"),e,""),Q0(Mn(i,/:(plac\w+)/,":"+T2+"$1"),e,""),Q0(Mn(i,/:(plac\w+)/,qi+"input-$1"),e,"")],r)}return""})}}var NW=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function DW(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var xxe=function(t,n){var r=-1,i=44;do switch(M2(i)){case 0:i===38&&Xl()===12&&(n[r]=1),t[r]+=kW(Eo-1);break;case 2:t[r]+=HN(i);break;case 4:if(i===44){t[++r]=Xl()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=O2(i)}while(i=ts());return t},wxe=function(t,n){return AW(xxe(CW(t),n))},RW=new WeakMap,_xe=function(t){if(!(t.type!=="rule"||!t.parent||!t.length)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!RW.get(r))&&!i){RW.set(t,!0);for(var a=[],o=wxe(n,a),s=r.props,u=0,l=0;u<o.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=a[u]?o[u].replace(/&\f/g,s[c]):s[c]+" "+o[u]}}},Sxe=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}},Exe=[bxe],Cxe=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||Exe,a={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),v=1;v<m.length;v++)a[m[v]]=!0;s.push(g)});var u,l=[_xe,Sxe];{var c,f=[mxe,yxe(function(g){c.insert(g)})],d=vxe(l.concat(i,f)),h=function(m){return ey(pxe(m),d)};u=function(m,v,y,b){c=y,h(m?m+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new xW({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:a,registered:{},insert:u};return p.sheet.hydrate(s),p};function mh(){return mh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mh.apply(this,arguments)}var FW={exports:{}},Pn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mi=typeof Symbol=="function"&&Symbol.for,KN=mi?Symbol.for("react.element"):60103,XN=mi?Symbol.for("react.portal"):60106,$2=mi?Symbol.for("react.fragment"):60107,L2=mi?Symbol.for("react.strict_mode"):60108,B2=mi?Symbol.for("react.profiler"):60114,z2=mi?Symbol.for("react.provider"):60109,j2=mi?Symbol.for("react.context"):60110,YN=mi?Symbol.for("react.async_mode"):60111,U2=mi?Symbol.for("react.concurrent_mode"):60111,W2=mi?Symbol.for("react.forward_ref"):60112,V2=mi?Symbol.for("react.suspense"):60113,Axe=mi?Symbol.for("react.suspense_list"):60120,q2=mi?Symbol.for("react.memo"):60115,H2=mi?Symbol.for("react.lazy"):60116,kxe=mi?Symbol.for("react.block"):60121,Txe=mi?Symbol.for("react.fundamental"):60117,Oxe=mi?Symbol.for("react.responder"):60118,Ixe=mi?Symbol.for("react.scope"):60119;function Co(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case KN:switch(e=e.type,e){case YN:case U2:case $2:case B2:case L2:case V2:return e;default:switch(e=e&&e.$$typeof,e){case j2:case W2:case H2:case q2:case z2:return e;default:return t}}case XN:return t}}}function MW(e){return Co(e)===U2}Pn.AsyncMode=YN,Pn.ConcurrentMode=U2,Pn.ContextConsumer=j2,Pn.ContextProvider=z2,Pn.Element=KN,Pn.ForwardRef=W2,Pn.Fragment=$2,Pn.Lazy=H2,Pn.Memo=q2,Pn.Portal=XN,Pn.Profiler=B2,Pn.StrictMode=L2,Pn.Suspense=V2,Pn.isAsyncMode=function(e){return MW(e)||Co(e)===YN},Pn.isConcurrentMode=MW,Pn.isContextConsumer=function(e){return Co(e)===j2},Pn.isContextProvider=function(e){return Co(e)===z2},Pn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===KN},Pn.isForwardRef=function(e){return Co(e)===W2},Pn.isFragment=function(e){return Co(e)===$2},Pn.isLazy=function(e){return Co(e)===H2},Pn.isMemo=function(e){return Co(e)===q2},Pn.isPortal=function(e){return Co(e)===XN},Pn.isProfiler=function(e){return Co(e)===B2},Pn.isStrictMode=function(e){return Co(e)===L2},Pn.isSuspense=function(e){return Co(e)===V2},Pn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$2||e===U2||e===B2||e===L2||e===V2||e===Axe||typeof e=="object"&&e!==null&&(e.$$typeof===H2||e.$$typeof===q2||e.$$typeof===z2||e.$$typeof===j2||e.$$typeof===W2||e.$$typeof===Txe||e.$$typeof===Oxe||e.$$typeof===Ixe||e.$$typeof===kxe)},Pn.typeOf=Co,FW.exports=Pn;var PW=FW.exports,Nxe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Dxe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},$W={};$W[PW.ForwardRef]=Nxe,$W[PW.Memo]=Dxe;var Rxe=!0;function Fxe(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var LW=function(t,n,r){var i=t.key+"-"+n.name;if((r===!1||Rxe===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles),t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function Mxe(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Pxe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$xe=/[A-Z]|^ms/g,Lxe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,BW=function(t){return t.charCodeAt(1)===45},zW=function(t){return t!=null&&typeof t!="boolean"},ZN=DW(function(e){return BW(e)?e:e.replace($xe,"-$&").toLowerCase()}),jW=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(Lxe,function(r,i,a){return Nu={name:i,styles:a,next:Nu},i})}return Pxe[t]!==1&&!BW(t)&&typeof n=="number"&&n!==0?n+"px":n};function ty(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Nu={name:n.name,styles:n.styles,next:Nu},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Nu={name:r.name,styles:r.styles,next:Nu},r=r.next;var i=n.styles+";";return i}return Bxe(e,t,n)}case"function":{if(e!==void 0){var a=Nu,o=n(e);return Nu=a,ty(e,t,o)}break}}if(t==null)return n;var s=t[n];return s!==void 0?s:n}function Bxe(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=ty(e,t,n[i])+";";else for(var a in n){var o=n[a];if(typeof o!="object")t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":zW(o)&&(r+=ZN(a)+":"+jW(a,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var s=0;s<o.length;s++)zW(o[s])&&(r+=ZN(a)+":"+jW(a,o[s])+";");else{var u=ty(e,t,o);switch(a){case"animation":case"animationName":{r+=ZN(a)+":"+u+";";break}default:r+=a+"{"+u+"}"}}}return r}var UW=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Nu,JN=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";Nu=void 0;var o=t[0];o==null||o.raw===void 0?(i=!1,a+=ty(r,n,o)):a+=o[0];for(var s=1;s<t.length;s++)a+=ty(r,n,t[s]),i&&(a+=o[s]);UW.lastIndex=0;for(var u="",l;(l=UW.exec(a))!==null;)u+="-"+l[1];var c=Mxe(a)+u;return{name:c,styles:a,next:Nu}},WW=ha(typeof HTMLElement!="undefined"?Cxe({key:"css"}):null);WW.Provider;var VW=function(t){return Gl(function(n,r){var i=Un(WW);return t(n,i,r)})},ny=ha({}),zxe=function(t,n){if(typeof n=="function"){var r=n(t);return r}return mh({},t,n)},jxe=NW(function(e){return NW(function(t){return zxe(e,t)})}),Uxe=function(t){var n=Un(ny);return t.theme!==n&&(n=jxe(n)(t.theme)),ue(ny.Provider,{value:n},t.children)},QN=VW(function(e,t){var n=e.styles,r=JN([n],void 0,typeof n=="function"||Array.isArray(n)?Un(ny):void 0),i=Jt();return of(function(){var a=t.key+"-global",o=new xW({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",a),o.hydrate([u])),i.current=[o,s],function(){o.flush()}},[t]),of(function(){var a=i.current,o=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&LW(t,r.next,!0),o.tags.length){var u=o.tags[o.tags.length-1].nextElementSibling;o.before=u,o.flush()}t.insert("",r,o,!1)},[t,r.name]),null});function Wxe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JN(t)}var qW=function(){var t=Wxe.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Vxe=()=>ue(QN,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;      
        -moz-osx-font-smoothing: grayscale; 
        touch-action: manipulation; 
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
        vertical-align: middle;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }
    `}),qxe=Vxe;function Hxe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function ff(e){return typeof e=="number"}function eD(e){return Array.isArray(e)}function HW(e){return typeof e=="function"}function Du(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")&&!eD(e)}function Gxe(e){return Du(e)&&Object.keys(e).length===0}function GW(e){return e==null}function tD(e){return Object.prototype.toString.call(e)==="[object String]"}function KW(e){return/^var\(--.+\)$/.test(e)}var G2=!1,nD={exports:{}};(function(e,t){var n=200,r="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",y="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",C="[object Undefined]",_="[object WeakMap]",E="[object ArrayBuffer]",A="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",I="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",D="[object Uint8Array]",L="[object Uint8ClampedArray]",W="[object Uint16Array]",G="[object Uint32Array]",K=/[\\^$.*+?()[\]{}|]/g,ee=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,he={};he[k]=he[T]=he[I]=he[N]=he[O]=he[D]=he[L]=he[W]=he[G]=!0,he[s]=he[u]=he[E]=he[c]=he[A]=he[f]=he[d]=he[h]=he[g]=he[m]=he[y]=he[x]=he[w]=he[S]=he[_]=!1;var Oe=typeof Ye=="object"&&Ye&&Ye.Object===Object&&Ye,Te=typeof self=="object"&&self&&self.Object===Object&&self,De=Oe||Te||Function("return this")(),me=t&&!t.nodeType&&t,P=me&&!0&&e&&!e.nodeType&&e,F=P&&P.exports===me,V=F&&Oe.process,ae=function(){try{var H=P&&P.require&&P.require("util").types;return H||V&&V.binding&&V.binding("util")}catch(ne){}}(),Y=ae&&ae.isTypedArray;function M(H,ne,de){switch(de.length){case 0:return H.call(ne);case 1:return H.call(ne,de[0]);case 2:return H.call(ne,de[0],de[1]);case 3:return H.call(ne,de[0],de[1],de[2])}return H.apply(ne,de)}function B(H,ne){for(var de=-1,Xe=Array(H);++de<H;)Xe[de]=ne(de);return Xe}function R(H){return function(ne){return H(ne)}}function X(H,ne){return H==null?void 0:H[ne]}function ge(H,ne){return function(de){return H(ne(de))}}var xe=Array.prototype,ze=Function.prototype,Ke=Object.prototype,Ze=De["__core-js_shared__"],Bt=ze.toString,Je=Ke.hasOwnProperty,Zt=function(){var H=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return H?"Symbol(src)_1."+H:""}(),mn=Ke.toString,Hn=Bt.call(Object),ti=RegExp("^"+Bt.call(Je).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=F?De.Buffer:void 0,Dn=De.Symbol,Jo=De.Uint8Array,Ka=er?er.allocUnsafe:void 0,jl=ge(Object.getPrototypeOf,Object),ks=Object.create,Ts=Ke.propertyIsEnumerable,Ul=xe.splice,Wl=Dn?Dn.toStringTag:void 0,tf=function(){try{var H=Pe(Object,"defineProperty");return H({},"",{}),H}catch(ne){}}(),l2=er?er.isBuffer:void 0,c2=Math.max,ku=Date.now,f2=Pe(De,"Map"),ch=Pe(Object,"create"),d2=function(){function H(){}return function(ne){if(!hh(ne))return{};if(ks)return ks(ne);H.prototype=ne;var de=new H;return H.prototype=void 0,de}}();function Vl(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function GI(){this.__data__=ch?ch(null):{},this.size=0}function KI(H){var ne=this.has(H)&&delete this.__data__[H];return this.size-=ne?1:0,ne}function XI(H){var ne=this.__data__;if(ch){var de=ne[H];return de===r?void 0:de}return Je.call(ne,H)?ne[H]:void 0}function YI(H){var ne=this.__data__;return ch?ne[H]!==void 0:Je.call(ne,H)}function ZI(H,ne){var de=this.__data__;return this.size+=this.has(H)?0:1,de[H]=ch&&ne===void 0?r:ne,this}Vl.prototype.clear=GI,Vl.prototype.delete=KI,Vl.prototype.get=XI,Vl.prototype.has=YI,Vl.prototype.set=ZI;function Os(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function JI(){this.__data__=[],this.size=0}function QI(H){var ne=this.__data__,de=Tu(ne,H);if(de<0)return!1;var Xe=ne.length-1;return de==Xe?ne.pop():Ul.call(ne,de,1),--this.size,!0}function eN(H){var ne=this.__data__,de=Tu(ne,H);return de<0?void 0:ne[de][1]}function h2(H){return Tu(this.__data__,H)>-1}function tN(H,ne){var de=this.__data__,Xe=Tu(de,H);return Xe<0?(++this.size,de.push([H,ne])):de[Xe][1]=ne,this}Os.prototype.clear=JI,Os.prototype.delete=QI,Os.prototype.get=eN,Os.prototype.has=h2,Os.prototype.set=tN;function nf(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function nN(){this.size=0,this.__data__={hash:new Vl,map:new(f2||Os),string:new Vl}}function rN(H){var ne=Fe(this,H).delete(H);return this.size-=ne?1:0,ne}function iN(H){return Fe(this,H).get(H)}function aN(H){return Fe(this,H).has(H)}function oN(H,ne){var de=Fe(this,H),Xe=de.size;return de.set(H,ne),this.size+=de.size==Xe?0:1,this}nf.prototype.clear=nN,nf.prototype.delete=rN,nf.prototype.get=iN,nf.prototype.has=aN,nf.prototype.set=oN;function rf(H){var ne=this.__data__=new Os(H);this.size=ne.size}function sN(){this.__data__=new Os,this.size=0}function uN(H){var ne=this.__data__,de=ne.delete(H);return this.size=ne.size,de}function lN(H){return this.__data__.get(H)}function cN(H){return this.__data__.has(H)}function fN(H,ne){var de=this.__data__;if(de instanceof Os){var Xe=de.__data__;if(!f2||Xe.length<n-1)return Xe.push([H,ne]),this.size=++de.size,this;de=this.__data__=new nf(Xe)}return de.set(H,ne),this.size=de.size,this}rf.prototype.clear=sN,rf.prototype.delete=uN,rf.prototype.get=lN,rf.prototype.has=cN,rf.prototype.set=fN;function dN(H,ne){var de=yN(H),Xe=!de&&Pg(H),un=!de&&!Xe&&nU(H),Gn=!de&&!Xe&&!un&&iU(H),or=de||Xe||un||Gn,rn=or?B(H.length,String):[],sr=rn.length;for(var Qo in H)(ne||Je.call(H,Qo))&&!(or&&(Qo=="length"||un&&(Qo=="offset"||Qo=="parent")||Gn&&(Qo=="buffer"||Qo=="byteLength"||Qo=="byteOffset")||Ft(Qo,sr)))&&rn.push(Qo);return rn}function L0(H,ne,de){(de!==void 0&&!Mg(H[ne],de)||de===void 0&&!(ne in H))&&Dg(H,ne,de)}function p2(H,ne,de){var Xe=H[ne];(!(Je.call(H,ne)&&Mg(Xe,de))||de===void 0&&!(ne in H))&&Dg(H,ne,de)}function Tu(H,ne){for(var de=H.length;de--;)if(Mg(H[de][0],ne))return de;return-1}function Dg(H,ne,de){ne=="__proto__"&&tf?tf(H,ne,{configurable:!0,enumerable:!0,value:de,writable:!0}):H[ne]=de}var af=Re();function Rg(H){return H==null?H===void 0?C:v:Wl&&Wl in Object(H)?je(H):dh(H)}function fh(H){return W0(H)&&Rg(H)==s}function B0(H){if(!hh(H)||Dr(H))return!1;var ne=xN(H)?ti:ee;return ne.test(vN(H))}function hN(H){return W0(H)&&rU(H.length)&&!!he[Rg(H)]}function pN(H){if(!hh(H))return Oi(H);var ne=dr(H),de=[];for(var Xe in H)Xe=="constructor"&&(ne||!Je.call(H,Xe))||de.push(Xe);return de}function Fg(H,ne,de,Xe,un){H!==ne&&af(ne,function(Gn,or){if(un||(un=new rf),hh(Gn))gN(H,ne,or,de,Fg,Xe,un);else{var rn=Xe?Xe(j0(H,or),Gn,or+"",H,ne,un):void 0;rn===void 0&&(rn=Gn),L0(H,or,rn)}},aU)}function gN(H,ne,de,Xe,un,Gn,or){var rn=j0(H,de),sr=j0(ne,de),Qo=or.get(sr);if(Qo){L0(H,de,Qo);return}var So=Gn?Gn(rn,sr,de+"",H,ne,or):void 0,V0=So===void 0;if(V0){var wN=yN(sr),_N=!wN&&nU(sr),sU=!wN&&!_N&&iU(sr);So=sr,wN||_N||sU?yN(rn)?So=rn:Cbe(rn)?So=oe(rn):_N?(V0=!1,So=Z(sr,!0)):sU?(V0=!1,So=re(sr,!0)):So=[]:Abe(sr)||Pg(sr)?(So=rn,Pg(rn)?So=kbe(rn):(!hh(rn)||xN(rn))&&(So=it(sr))):V0=!1}V0&&(or.set(sr,So),un(So,sr,Xe,Gn,or),or.delete(sr)),L0(H,de,So)}function mN(H,ne){return U0(z0(H,ne,oU),H+"")}var z=tf?function(H,ne){return tf(H,"toString",{configurable:!0,enumerable:!1,value:Obe(ne),writable:!0})}:oU;function Z(H,ne){if(ne)return H.slice();var de=H.length,Xe=Ka?Ka(de):new H.constructor(de);return H.copy(Xe),Xe}function q(H){var ne=new H.constructor(H.byteLength);return new Jo(ne).set(new Jo(H)),ne}function re(H,ne){var de=ne?q(H.buffer):H.buffer;return new H.constructor(de,H.byteOffset,H.length)}function oe(H,ne){var de=-1,Xe=H.length;for(ne||(ne=Array(Xe));++de<Xe;)ne[de]=H[de];return ne}function te(H,ne,de,Xe){var un=!de;de||(de={});for(var Gn=-1,or=ne.length;++Gn<or;){var rn=ne[Gn],sr=Xe?Xe(de[rn],H[rn],rn,de,H):void 0;sr===void 0&&(sr=H[rn]),un?Dg(de,rn,sr):p2(de,rn,sr)}return de}function Ce(H){return mN(function(ne,de){var Xe=-1,un=de.length,Gn=un>1?de[un-1]:void 0,or=un>2?de[2]:void 0;for(Gn=H.length>3&&typeof Gn=="function"?(un--,Gn):void 0,or&&bn(de[0],de[1],or)&&(Gn=un<3?void 0:Gn,un=1),ne=Object(ne);++Xe<un;){var rn=de[Xe];rn&&H(ne,rn,Xe,Gn)}return ne})}function Re(H){return function(ne,de,Xe){for(var un=-1,Gn=Object(ne),or=Xe(ne),rn=or.length;rn--;){var sr=or[H?rn:++un];if(de(Gn[sr],sr,Gn)===!1)break}return ne}}function Fe(H,ne){var de=H.__data__;return Cn(ne)?de[typeof ne=="string"?"string":"hash"]:de.map}function Pe(H,ne){var de=X(H,ne);return B0(de)?de:void 0}function je(H){var ne=Je.call(H,Wl),de=H[Wl];try{H[Wl]=void 0;var Xe=!0}catch(Gn){}var un=mn.call(H);return Xe&&(ne?H[Wl]=de:delete H[Wl]),un}function it(H){return typeof H.constructor=="function"&&!dr(H)?d2(jl(H)):{}}function Ft(H,ne){var de=typeof H;return ne=ne??o,!!ne&&(de=="number"||de!="symbol"&&ce.test(H))&&H>-1&&H%1==0&&H<ne}function bn(H,ne,de){if(!hh(de))return!1;var Xe=typeof ne;return(Xe=="number"?bN(de)&&Ft(ne,de.length):Xe=="string"&&ne in de)?Mg(de[ne],H):!1}function Cn(H){var ne=typeof H;return ne=="string"||ne=="number"||ne=="symbol"||ne=="boolean"?H!=="__proto__":H===null}function Dr(H){return!!Zt&&Zt in H}function dr(H){var ne=H&&H.constructor,de=typeof ne=="function"&&ne.prototype||Ke;return H===de}function Oi(H){var ne=[];if(H!=null)for(var de in Object(H))ne.push(de);return ne}function dh(H){return mn.call(H)}function z0(H,ne,de){return ne=c2(ne===void 0?H.length-1:ne,0),function(){for(var Xe=arguments,un=-1,Gn=c2(Xe.length-ne,0),or=Array(Gn);++un<Gn;)or[un]=Xe[ne+un];un=-1;for(var rn=Array(ne+1);++un<ne;)rn[un]=Xe[un];return rn[ne]=de(or),M(H,this,rn)}}function j0(H,ne){if(!(ne==="constructor"&&typeof H[ne]=="function")&&ne!="__proto__")return H[ne]}var U0=tU(z);function tU(H){var ne=0,de=0;return function(){var Xe=ku(),un=a-(Xe-de);if(de=Xe,un>0){if(++ne>=i)return arguments[0]}else ne=0;return H.apply(void 0,arguments)}}function vN(H){if(H!=null){try{return Bt.call(H)}catch(ne){}try{return H+""}catch(ne){}}return""}function Mg(H,ne){return H===ne||H!==H&&ne!==ne}var Pg=fh(function(){return arguments}())?fh:function(H){return W0(H)&&Je.call(H,"callee")&&!Ts.call(H,"callee")},yN=Array.isArray;function bN(H){return H!=null&&rU(H.length)&&!xN(H)}function Cbe(H){return W0(H)&&bN(H)}var nU=l2||Ibe;function xN(H){if(!hh(H))return!1;var ne=Rg(H);return ne==h||ne==p||ne==l||ne==b}function rU(H){return typeof H=="number"&&H>-1&&H%1==0&&H<=o}function hh(H){var ne=typeof H;return H!=null&&(ne=="object"||ne=="function")}function W0(H){return H!=null&&typeof H=="object"}function Abe(H){if(!W0(H)||Rg(H)!=y)return!1;var ne=jl(H);if(ne===null)return!0;var de=Je.call(ne,"constructor")&&ne.constructor;return typeof de=="function"&&de instanceof de&&Bt.call(de)==Hn}var iU=Y?R(Y):hN;function kbe(H){return te(H,aU(H))}function aU(H){return bN(H)?dN(H,!0):pN(H)}var Tbe=Ce(function(H,ne,de,Xe){Fg(H,ne,de,Xe)});function Obe(H){return function(){return H}}function oU(H){return H}function Ibe(){return!1}e.exports=Tbe})(nD,nD.exports);var Ru=nD.exports;function rD(e,t){var n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n}function Kxe(e,t){var n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n}function Xxe(e,t){var n={},r={};return Object.keys(e).forEach(i=>{t.includes(i)?n[i]=e[i]:r[i]=e[i]}),[n,r]}function Yxe(e,t,n,r){var i=typeof t=="string"?t.split("."):[t];for(r=0;r<i.length&&e;r+=1)e=e[i[r]];return e===void 0?n:e}var Zxe=e=>{var t=new WeakMap,n=(r,i,a,o)=>{if(typeof r=="undefined")return e(r,i,a);t.has(r)||t.set(r,new Map);var s=t.get(r);if(s.has(i))return s.get(i);var u=e(r,i,a,o);return s.set(i,u),u};return n},K2=Zxe(Yxe);function XW(e,t){var n={};return Object.keys(e).forEach(r=>{var i=e[r],a=t(i,r,e);a&&(n[r]=i)}),n}var X2=e=>XW(e,t=>t!=null),Y2=e=>Object.keys(e),Jxe=e=>e.reduce((t,n)=>{var[r,i]=n;return t[r]=i,t},{});function Qxe(e){var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}}function iD(e){if(e==null)return e;var{unitless:t}=Qxe(e);return t||ff(e)?e+"px":e}var YW=(e,t)=>parseInt(e[1],10)>parseInt(t[1],10)?1:-1,aD=e=>Jxe(Object.entries(e).sort(YW));function ZW(e){var t=aD(e);return Object.assign(Object.values(t),t)}function ewe(e){var t=Object.keys(aD(e));return new Set(t)}function twe(e){var t;if(!e)return e;e=(t=iD(e))!=null?t:e;var n=e.endsWith("px")?-1:-.0635;return ff(e)?""+(e+n):e.replace(/([0-9]+\.?[0-9]*)/,r=>""+(parseFloat(r)+n))}function Z2(e,t){var n=[];return e&&n.push("@media screen and (min-width: "+iD(e)+")"),n.length>0&&t&&n.push("and"),t&&n.push("@media screen and (max-width: "+iD(t)+")"),n.join(" ")}function nwe(e){var t;if(!e)return null;e.base=(t=e.base)!=null?t:"0px";var n=ZW(e),r=Object.entries(e).sort(YW).map((o,s,u)=>{var l,[c,f]=o,[,d]=(l=u[s+1])!=null?l:[];return d=parseFloat(d)>0?twe(d):void 0,{breakpoint:c,minW:f,maxW:d,maxWQuery:Z2(null,d),minWQuery:Z2(f),minMaxQuery:Z2(f,d)}}),i=ewe(e),a=Array.from(i.values());return{keys:i,normalized:n,isResponsive(o){var s=Object.keys(o);return s.length>0&&s.every(u=>i.has(u))},asObject:aD(e),asArray:ZW(e),details:r,media:[null,...n.map(o=>Z2(o)).slice(1)],toArrayValue(o){if(!Du(o))throw new Error("toArrayValue: value must be an object");for(var s=a.map(u=>{var l;return(l=o[u])!=null?l:null});Hxe(s)===null;)s.pop();return s},toObjectValue(o){if(!Array.isArray(o))throw new Error("toObjectValue: value must be an array");return o.reduce((s,u,l)=>{var c=a[l];return c!=null&&u!=null&&(s[c]=u),s},{})}}}function JW(e){var t;return e instanceof Element&&(t=e.ownerDocument)!=null?t:document}function rwe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Vg=rwe(),Ii=e=>e?"":void 0,oD=e=>e?!0:void 0,Wn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter(Boolean).join(" ")};function iwe(e){var{key:t,keyCode:n}=e,r=n>=37&&n<=40&&t.indexOf("Arrow")!==0,i=r?"Arrow"+t:t;return i}function QW(e){return e.button!==0}var awe=e=>e.hasAttribute("tabindex");function owe(e){return Boolean(e.getAttribute("disabled"))===!0||Boolean(e.getAttribute("aria-disabled"))===!0}function swe(e){return eV(e)&&e.tagName.toLowerCase()==="input"&&"select"in e}function uwe(e){var t=e instanceof HTMLElement?JW(e):document;return t.activeElement===e}function eV(e){return e instanceof HTMLElement}function tV(e){return e.parentElement&&tV(e.parentElement)?!0:e.hidden}function lwe(e){var t=e.getAttribute("contenteditable");return t!=="false"&&t!=null}function cwe(e){if(!eV(e)||tV(e)||owe(e))return!1;var{localName:t}=e,n=["input","select","textarea","button"];if(n.indexOf(t)>=0)return!0;var r={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in r?r[t]():lwe(e)?!0:awe(e)}var fwe=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","embed","iframe","object","a[href]","area[href]","button:not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],dwe=fwe.join();function hwe(e){var t=Array.from(e.querySelectorAll(dwe));return t.unshift(e),t.filter(cwe).filter(n=>window.getComputedStyle(n).display!=="none")}function Fs(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return HW(e)?e(...n):e}function wr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){t.some(a=>(a==null||a(i),i==null?void 0:i.defaultPrevented))}}function pwe(e){var t;return function(){if(e){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=e.apply(this,i),e=null}return t}}var ry=()=>{},sD=pwe(e=>()=>{var{condition:t,message:n}=e;t&&G2&&console.warn(n)}),gwe=e=>{Promise.resolve().then(e)},mwe=typeof queueMicrotask=="function"?queueMicrotask:gwe;function qg(e,t){t===void 0&&(t={});var{isActive:n=uwe,nextTick:r,preventScroll:i=!0,selectTextIfInput:a=!0}=t;if(!e||n(e))return-1;function o(){if(!e){sD({condition:!0,message:"[chakra-ui]: can't call focus() on `null` or `undefined` element"});return}if(vwe())e.focus({preventScroll:i});else if(e.focus(),i){var s=ywe(e);bwe(s)}swe(e)&&a&&e.select()}return r?requestAnimationFrame(o):(o(),-1)}var J2=null;function vwe(){if(J2==null){J2=!1;try{var e=document.createElement("div");e.focus({get preventScroll(){return J2=!0,!0}})}catch(t){}}return J2}function ywe(e){for(var t=JW(e),n=e.parentNode,r=[],i=t.scrollingElement||t.documentElement;n instanceof HTMLElement&&n!==i;)(n.offsetHeight<n.scrollHeight||n.offsetWidth<n.scrollWidth)&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),n=n.parentNode;return i instanceof HTMLElement&&r.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),r}function bwe(e){for(var{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function xwe(e){var{hasBeenSelected:t,isLazy:n,isSelected:r,lazyBehavior:i="unmount"}=e;return!!(!n||r||i==="keepMounted"&&t)}var nV=1/60*1e3,wwe=typeof performance!="undefined"?function(){return performance.now()}:function(){return Date.now()},rV=typeof window!="undefined"?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(wwe())},nV)};function _we(e){var t=[],n=[],r=0,i=!1,a=new WeakSet,o={schedule:function(s,u,l){u===void 0&&(u=!1),l===void 0&&(l=!1);var c=l&&i,f=c?t:n;return u&&a.add(s),f.indexOf(s)===-1&&(f.push(s),c&&i&&(r=t.length)),s},cancel:function(s){var u=n.indexOf(s);u!==-1&&n.splice(u,1),a.delete(s)},process:function(s){var u;if(i=!0,u=[n,t],t=u[0],n=u[1],n.length=0,r=t.length,r)for(var l=0;l<r;l++){var c=t[l];c(s),a.has(c)&&(o.schedule(c),e())}i=!1}};return o}var Swe=40,uD=!0,iy=!1,lD=!1,Hg={delta:0,timestamp:0},ay=["read","update","preRender","render","postRender"],Q2=ay.reduce(function(e,t){return e[t]=_we(function(){return iy=!0}),e},{}),Fu=ay.reduce(function(e,t){var n=Q2[t];return e[t]=function(r,i,a){return i===void 0&&(i=!1),a===void 0&&(a=!1),iy||Cwe(),n.schedule(r,i,a)},e},{}),oy=ay.reduce(function(e,t){return e[t]=Q2[t].cancel,e},{}),Gg=ay.reduce(function(e,t){return e[t]=function(){return Q2[t].process(Hg)},e},{}),Ewe=function(e){return Q2[e].process(Hg)},iV=function(e){iy=!1,Hg.delta=uD?nV:Math.max(Math.min(e-Hg.timestamp,Swe),1),Hg.timestamp=e,lD=!0,ay.forEach(Ewe),lD=!1,iy&&(uD=!1,rV(iV))},Cwe=function(){iy=!0,uD=!0,lD||rV(iV)},e_=function(){return Hg};Object.freeze(["base","sm","md","lg","xl","2xl"]);function sy(e,t){return eD(e)?e.map(n=>n===null?null:t(n)):Du(e)?Y2(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):e!=null?t(e):null}function Awe(e,t){function n(r,i){return i===void 0&&(i=[]),eD(r)?r.map((a,o)=>n(a,[...i,String(o)])):Du(r)?Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,n(s,[...i,o])]})):t(r,i)}return n(e)}function kwe(e,t){if(e!=null){if(HW(e)){e(t);return}try{e.current=t}catch(n){throw new Error("Cannot assign value '"+t+"' to ref '"+e+"'")}}}function df(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=>{t.forEach(i=>kwe(i,r))}}function Mu(e){e===void 0&&(e={});var{strict:t=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=e,i=ha(void 0);i.displayName=r;function a(){var o=Un(i);if(!o&&t){var s=new Error(n);throw s.name="ContextError",Error.captureStackTrace==null||Error.captureStackTrace(s,a),s}return o}return[i.Provider,a,i]}function cD(e){return x2.toArray(e).filter(t=>ph(t))}var[Twe,Owe]=Mu({strict:!1,name:"PortalManagerContext"});function aV(e){var{children:t,zIndex:n}=e;return ue(Twe,{value:{zIndex:n}},t)}G2&&(aV.displayName="PortalManager");function fD(e){e===void 0&&(e=!1);var[t,n]=an(e),r=st(()=>{n(!0)},[]),i=st(()=>{n(!1)},[]),a=st(()=>{n(o=>!o)},[]);return[t,{on:r,off:i,toggle:a}]}var Kg=Vg?of:qt;function uy(e,t){t===void 0&&(t=[]);var n=Jt(e);return Kg(()=>{n.current=e}),st(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.current==null?void 0:n.current(...i)},t)}function Iwe(e,t){var n=e!==void 0,r=n&&typeof e!="undefined"?e:t;return[n,r]}function Nwe(e){var{value:t,defaultValue:n,onChange:r,shouldUpdate:i=(d,h)=>d!==h}=e,a=uy(r),o=uy(i),[s,u]=an(n),l=t!==void 0,c=l?t:s,f=st(d=>{var h=Fs(d,c);!o(c,h)||(l||u(h),a(h))},[l,a,c,o]);return[c,f]}var oV={prefix:Math.round(Math.random()*1e10),current:0},dD=ha(oV),Dwe=FU(e=>{var{children:t}=e,n=Un(dD),r=n===oV,i=xr(()=>({prefix:r?0:++n.prefix,current:0}),[r,n]);return ue(dD.Provider,{value:i},t)});function sV(e,t){var n=Un(dD);return xr(()=>e||[t,n.prefix,++n.current].filter(Boolean).join("-"),[e,t])}function Rwe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=sV(e);return xr(()=>n.map(a=>a+"-"+i),[i,n])}function Fwe(e,t){return t===void 0&&(t=[]),qt(()=>()=>e(),t)}function uV(){var e=Jt(!1),[t,n]=an(0);return Fwe(()=>{e.current=!0}),st(()=>{e.current||n(t+1)},[t])}function hD(){return hD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hD.apply(this,arguments)}function Mwe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[lV,Pwe]=Mu({strict:!1,name:"PortalContext"}),pD="chakra-portal",$we=".chakra-portal",Lwe=e=>ue("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0}},e.children),Bwe=e=>{var{appendToParentPortal:t,children:n}=e,r=Jt(null),i=Jt(null),a=uV(),o=Pwe(),s=Owe();Kg(()=>{if(!!r.current){var l=r.current.ownerDocument,c=t?o??l.body:l.body;if(!!c){i.current=l.createElement("div"),i.current.className=pD,c.appendChild(i.current),a();var f=i.current;return()=>{c.contains(f)&&c.removeChild(f)}}}},[]);var u=s!=null&&s.zIndex?ue(Lwe,{zIndex:s==null?void 0:s.zIndex},n):n;return i.current?IN(ue(lV,{value:i.current},u),i.current):ue("span",{ref:r})},zwe=e=>{var{children:t,containerRef:n,appendToParentPortal:r}=e,i=n.current,a=i??(Vg?document.body:void 0),o=xr(()=>{var u=i==null?void 0:i.ownerDocument.createElement("div");return u&&(u.className=pD),u},[i]),s=uV();return Kg(()=>{s()},[]),Kg(()=>{if(!(!o||!a))return a.appendChild(o),()=>{a.removeChild(o)}},[o,a]),a&&o?IN(ue(lV,{value:r?o:null},t),o):null};function t_(e){var{containerRef:t}=e,n=Mwe(e,["containerRef"]);return t?ue(zwe,hD({containerRef:t},n)):ue(Bwe,n)}t_.defaultProps={appendToParentPortal:!0},t_.className=pD,t_.selector=$we;var n_={light:"chakra-ui-light",dark:"chakra-ui-dark"},jwe={classList:{add:ry,remove:ry}},Uwe=()=>Vg?document.body:jwe;function Wwe(e){var t=Uwe();t.classList.add(e?n_.dark:n_.light),t.classList.remove(e?n_.light:n_.dark)}function Vwe(e){var t=window.matchMedia==null?void 0:window.matchMedia(e);if(!!t)return!!t.media===t.matches}var cV={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"};function qwe(e){var t,n=(t=Vwe(cV.dark))!=null?t:e==="dark";return n?"dark":"light"}function Hwe(e){if(!("matchMedia"in window))return ry;var t=window.matchMedia(cV.dark),n=()=>{e(t.matches?"dark":"light")};return n(),t.addListener(n),()=>{t.removeListener(n)}}var fV={get:()=>document.documentElement.style.getPropertyValue("--chakra-ui-color-mode"),set:e=>{Vg&&document.documentElement.style.setProperty("--chakra-ui-color-mode",e)}},dV=()=>typeof Storage!="undefined",hV="chakra-ui-color-mode",Gwe={get(e){if(!dV())return e;try{var t=localStorage.getItem(hV);return t??e}catch(n){return e}},set(e){if(!!dV())try{localStorage.setItem(hV,e)}catch(t){}},type:"localStorage"},gD=ha({});G2&&(gD.displayName="ColorModeContext");var mD=()=>{var e=Un(gD);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e};function pV(e){var{value:t,children:n,options:{useSystemColorMode:r,initialColorMode:i},colorModeManager:a=Gwe}=e,[o,s]=an(a.type==="cookie"?a.get(i):i);qt(()=>{if(Vg&&a.type==="localStorage"){var f=r?qwe(i):fV.get()||a.get();f&&s(f)}},[a,r,i]),qt(()=>{var f=o==="dark";Wwe(f),fV.set(f?"dark":"light")},[o]);var u=st(f=>{a.set(f),s(f)},[a]),l=st(()=>{u(o==="light"?"dark":"light")},[o,u]);qt(()=>{var f;return r&&(f=Hwe(u)),()=>{f&&r&&f()}},[u,r]);var c=xr(()=>({colorMode:t??o,toggleColorMode:t?ry:l,setColorMode:t?ry:u}),[o,u,l,t]);return ue(gD.Provider,{value:c},n)}G2&&(pV.displayName="ColorModeProvider");function Kwe(e,t){var{colorMode:n}=mD();return n==="dark"?t:e}var Xwe=(e,t)=>n=>{var r=String(t),i=e?e+"."+r:r;return Du(n.__cssMap)&&i in n.__cssMap?n.__cssMap[i].varRef:t};function ly(e){var{scale:t,transform:n,compose:r}=e,i=(a,o)=>{var s,u=Xwe(t,a)(o),l=(s=n==null?void 0:n(u,o))!=null?s:u;return r&&(l=r(l,o)),l};return i}function Ms(e,t){return n=>{var r={property:n,scale:e};return r.transform=ly({scale:e,transform:t}),r}}var Ywe=e=>{var{rtl:t,ltr:n}=e;return r=>r.direction==="rtl"?t:n};function Zwe(e){var{property:t,scale:n,transform:r}=e;return{scale:n,property:Ywe(t),transform:n?ly({scale:n,compose:r}):r}}var gV=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function Jwe(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...gV].join(" ")}function Qwe(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...gV].join(" ")}var e2e={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},t2e={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function n2e(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var r2e={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},mV="& > :not(style) ~ :not(style)",i2e={[mV]:{marginInlineStart:"calc(var(--chakra-space-x) * calc(1 - var(--chakra-space-x-reverse)))",marginInlineEnd:"calc(var(--chakra-space-x) * var(--chakra-space-x-reverse))"}},a2e={[mV]:{marginTop:"calc(var(--chakra-space-y) * calc(1 - var(--chakra-space-y-reverse)))",marginBottom:"calc(var(--chakra-space-y) * var(--chakra-space-y-reverse))"}};function vD(e,t){vD=function(u,l){return new a(u,void 0,l)};var n=yD(RegExp),r=RegExp.prototype,i=new WeakMap;function a(s,u,l){var c=n.call(this,s,u);return i.set(c,l||i.get(s)),c}o2e(a,n),a.prototype.exec=function(s){var u=r.exec.call(this,s);return u&&(u.groups=o(u,this)),u},a.prototype[Symbol.replace]=function(s,u){if(typeof u=="string"){var l=i.get(this);return r[Symbol.replace].call(this,s,u.replace(/\$<([^>]+)>/g,function(f,d){return"$"+l[d]}))}else if(typeof u=="function"){var c=this;return r[Symbol.replace].call(this,s,function(){var f=[];return f.push.apply(f,arguments),typeof f[f.length-1]!="object"&&f.push(o(f,c)),u.apply(this,f)})}else return r[Symbol.replace].call(this,s,u)};function o(s,u){var l=i.get(u);return Object.keys(l).reduce(function(c,f){return c[f]=s[l[f]],c},Object.create(null))}return vD.apply(this,arguments)}function o2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cy(e,t)}function yD(e){var t=typeof Map=="function"?new Map:void 0;return yD=function(r){if(r===null||!u2e(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return r_(r,arguments,bD(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),cy(i,r)},yD(e)}function r_(e,t,n){return s2e()?r_=Reflect.construct:r_=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&cy(l,o.prototype),l},r_.apply(null,arguments)}function s2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function u2e(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function cy(e,t){return cy=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},cy(e,t)}function bD(e){return bD=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},bD(e)}var xD={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},l2e=new Set(Object.values(xD)),vV=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),c2e=e=>e.trim();function f2e(e,t){var n,r;if(e==null||vV.has(e))return e;var i=vD(/(^[\x2DA-Za-z]+)\(((.*))\)/g,{type:1,values:2}),{type:a,values:o}=(n=(r=i.exec(e))==null?void 0:r.groups)!=null?n:{};if(!a||!o)return e;var s=a.includes("-gradient")?a:a+"-gradient",[u,...l]=o.split(",").map(c2e).filter(Boolean);if((l==null?void 0:l.length)===0)return e;var c=u in xD?xD[u]:u;l.unshift(c);var f=l.map(d=>{if(l2e.has(d))return d;var[h,p]=d.split(" "),g="colors."+h,m=g in t.__cssMap?t.__cssMap[g].varRef:h;return p?[m,p].join(" "):m});return s+"("+f.join(", ")+")"}var d2e=(e,t)=>f2e(e,t??{}),h2e=e=>{var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}},Pu=e=>t=>e+"("+t+")",$n={filter(e){return e!=="auto"?e:e2e},backdropFilter(e){return e!=="auto"?e:t2e},ring(e){return n2e($n.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?Jwe():e==="auto-gpu"?Qwe():e},px(e){if(e==null)return e;var{unitless:t}=h2e(e);return t||ff(e)?e+"px":e},fraction(e){return!ff(e)||e>1?e:e*100+"%"},float(e,t){var n={left:"right",right:"left"};return t.direction==="rtl"?n[e]:e},degree(e){if(KW(e)||e==null)return e;var t=tD(e)&&!e.endsWith("deg");return ff(e)||t?e+"deg":e},gradient:d2e,blur:Pu("blur"),opacity:Pu("opacity"),brightness:Pu("brightness"),contrast:Pu("contrast"),dropShadow:Pu("drop-shadow"),grayscale:Pu("grayscale"),hueRotate:Pu("hue-rotate"),invert:Pu("invert"),saturate:Pu("saturate"),sepia:Pu("sepia"),bgImage(e){if(e==null)return e;var t=p2e(e)||vV.has(e);return t?e:"url("+e+")"},outline(e){var t=String(e)==="0"||String(e)==="none";return e!==null&&t?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var t,{space:n,divide:r}=(t=r2e[e])!=null?t:{},i={flexDirection:e};return n&&(i[n]=1),r&&(i[r]=1),i}},p2e=e=>tD(e)&&e.includes("(")&&e.includes(")");function wD(){return wD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wD.apply(this,arguments)}var se={borderWidths:Ms("borderWidths"),borderStyles:Ms("borderStyles"),colors:Ms("colors"),borders:Ms("borders"),radii:Ms("radii",$n.px),space:Ms("space",$n.px),spaceT:Ms("space",$n.px),degreeT(e){return{property:e,transform:$n.degree}},prop(e,t,n){return wD({property:e,scale:t},t&&{transform:ly({scale:t,transform:n})})},propT(e,t){return{property:e,transform:t}},sizes:Ms("sizes",$n.px),sizesT:Ms("sizes",$n.fraction),shadows:Ms("shadows"),logical:Zwe,blur:Ms("blur",$n.blur)},i_={background:se.colors("background"),backgroundColor:se.colors("backgroundColor"),backgroundImage:se.propT("backgroundImage",$n.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:$n.bgClip},bgSize:se.prop("backgroundSize"),bgPosition:se.prop("backgroundPosition"),bg:se.colors("background"),bgColor:se.colors("backgroundColor"),bgPos:se.prop("backgroundPosition"),bgRepeat:se.prop("backgroundRepeat"),bgAttachment:se.prop("backgroundAttachment"),bgGradient:se.propT("backgroundImage",$n.gradient),bgClip:{transform:$n.bgClip}};Object.assign(i_,{bgImage:i_.backgroundImage,bgImg:i_.backgroundImage});var kn={border:se.borders("border"),borderWidth:se.borderWidths("borderWidth"),borderStyle:se.borderStyles("borderStyle"),borderColor:se.colors("borderColor"),borderRadius:se.radii("borderRadius"),borderTop:se.borders("borderTop"),borderBlockStart:se.borders("borderBlockStart"),borderTopLeftRadius:se.radii("borderTopLeftRadius"),borderStartStartRadius:se.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:se.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:se.radii("borderTopRightRadius"),borderStartEndRadius:se.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:se.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:se.borders("borderRight"),borderInlineEnd:se.borders("borderInlineEnd"),borderBottom:se.borders("borderBottom"),borderBlockEnd:se.borders("borderBlockEnd"),borderBottomLeftRadius:se.radii("borderBottomLeftRadius"),borderBottomRightRadius:se.radii("borderBottomRightRadius"),borderLeft:se.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:se.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:se.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:se.borders(["borderLeft","borderRight"]),borderInline:se.borders("borderInline"),borderY:se.borders(["borderTop","borderBottom"]),borderBlock:se.borders("borderBlock"),borderTopWidth:se.borderWidths("borderTopWidth"),borderBlockStartWidth:se.borderWidths("borderBlockStartWidth"),borderTopColor:se.colors("borderTopColor"),borderBlockStartColor:se.colors("borderBlockStartColor"),borderTopStyle:se.borderStyles("borderTopStyle"),borderBlockStartStyle:se.borderStyles("borderBlockStartStyle"),borderBottomWidth:se.borderWidths("borderBottomWidth"),borderBlockEndWidth:se.borderWidths("borderBlockEndWidth"),borderBottomColor:se.colors("borderBottomColor"),borderBlockEndColor:se.colors("borderBlockEndColor"),borderBottomStyle:se.borderStyles("borderBottomStyle"),borderBlockEndStyle:se.borderStyles("borderBlockEndStyle"),borderLeftWidth:se.borderWidths("borderLeftWidth"),borderInlineStartWidth:se.borderWidths("borderInlineStartWidth"),borderLeftColor:se.colors("borderLeftColor"),borderInlineStartColor:se.colors("borderInlineStartColor"),borderLeftStyle:se.borderStyles("borderLeftStyle"),borderInlineStartStyle:se.borderStyles("borderInlineStartStyle"),borderRightWidth:se.borderWidths("borderRightWidth"),borderInlineEndWidth:se.borderWidths("borderInlineEndWidth"),borderRightColor:se.colors("borderRightColor"),borderInlineEndColor:se.colors("borderInlineEndColor"),borderRightStyle:se.borderStyles("borderRightStyle"),borderInlineEndStyle:se.borderStyles("borderInlineEndStyle"),borderTopRadius:se.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:se.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:se.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:se.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(kn,{rounded:kn.borderRadius,roundedTop:kn.borderTopRadius,roundedTopLeft:kn.borderTopLeftRadius,roundedTopRight:kn.borderTopRightRadius,roundedTopStart:kn.borderStartStartRadius,roundedTopEnd:kn.borderStartEndRadius,roundedBottom:kn.borderBottomRadius,roundedBottomLeft:kn.borderBottomLeftRadius,roundedBottomRight:kn.borderBottomRightRadius,roundedBottomStart:kn.borderEndStartRadius,roundedBottomEnd:kn.borderEndEndRadius,roundedLeft:kn.borderLeftRadius,roundedRight:kn.borderRightRadius,roundedStart:kn.borderInlineStartRadius,roundedEnd:kn.borderInlineEndRadius,borderStart:kn.borderInlineStart,borderEnd:kn.borderInlineEnd,borderTopStartRadius:kn.borderStartStartRadius,borderTopEndRadius:kn.borderStartEndRadius,borderBottomStartRadius:kn.borderEndStartRadius,borderBottomEndRadius:kn.borderEndEndRadius,borderStartRadius:kn.borderInlineStartRadius,borderEndRadius:kn.borderInlineEndRadius,borderStartWidth:kn.borderInlineStartWidth,borderEndWidth:kn.borderInlineEndWidth,borderStartColor:kn.borderInlineStartColor,borderEndColor:kn.borderInlineEndColor,borderStartStyle:kn.borderInlineStartStyle,borderEndStyle:kn.borderInlineEndStyle});var g2e={color:se.colors("color"),textColor:se.colors("color"),fill:se.colors("fill"),stroke:se.colors("stroke")},_D={boxShadow:se.shadows("boxShadow"),mixBlendMode:!0,blendMode:se.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:se.prop("backgroundBlendMode"),opacity:!0};Object.assign(_D,{shadow:_D.boxShadow});var m2e={filter:{transform:$n.filter},blur:se.blur("--chakra-blur"),brightness:se.propT("--chakra-brightness",$n.brightness),contrast:se.propT("--chakra-contrast",$n.contrast),hueRotate:se.degreeT("--chakra-hue-rotate"),invert:se.propT("--chakra-invert",$n.invert),saturate:se.propT("--chakra-saturate",$n.saturate),dropShadow:se.propT("--chakra-drop-shadow",$n.dropShadow),backdropFilter:{transform:$n.backdropFilter},backdropBlur:se.blur("--chakra-backdrop-blur"),backdropBrightness:se.propT("--chakra-backdrop-brightness",$n.brightness),backdropContrast:se.propT("--chakra-backdrop-contrast",$n.contrast),backdropHueRotate:se.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:se.propT("--chakra-backdrop-invert",$n.invert),backdropSaturate:se.propT("--chakra-backdrop-saturate",$n.saturate)},a_={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:$n.flexDirection},experimental_spaceX:{static:i2e,transform:ly({scale:"space",transform:e=>e!==null?{"--chakra-space-x":e}:null})},experimental_spaceY:{static:a2e,transform:ly({scale:"space",transform:e=>e!=null?{"--chakra-space-y":e}:null})},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:se.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0};Object.assign(a_,{flexDir:a_.flexDirection});var yV={gridGap:se.space("gridGap"),gridColumnGap:se.space("gridColumnGap"),gridRowGap:se.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},v2e={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:$n.outline},outlineOffset:!0,outlineColor:se.colors("outlineColor")},ns={width:se.sizesT("width"),inlineSize:se.sizesT("inlineSize"),height:se.sizes("height"),blockSize:se.sizes("blockSize"),boxSize:se.sizes(["width","height"]),minWidth:se.sizes("minWidth"),minInlineSize:se.sizes("minInlineSize"),minHeight:se.sizes("minHeight"),minBlockSize:se.sizes("minBlockSize"),maxWidth:se.sizes("maxWidth"),maxInlineSize:se.sizes("maxInlineSize"),maxHeight:se.sizes("maxHeight"),maxBlockSize:se.sizes("maxBlockSize"),d:se.prop("display"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:se.propT("float",$n.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(ns,{w:ns.width,h:ns.height,minW:ns.minWidth,maxW:ns.maxWidth,minH:ns.minHeight,maxH:ns.maxHeight,overscroll:ns.overscrollBehavior,overscrollX:ns.overscrollBehaviorX,overscrollY:ns.overscrollBehaviorY});var y2e={listStyleType:!0,listStylePosition:!0,listStylePos:se.prop("listStylePosition"),listStyleImage:!0,listStyleImg:se.prop("listStyleImage")},b2e={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},x2e={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},SD=(e,t,n)=>{var r={},i=K2(e,t,{});for(var a in i){var o=a in n&&n[a]!=null;o||(r[a]=i[a])}return r},w2e={srOnly:{transform(e){return e===!0?b2e:e==="focusable"?x2e:{}}},layerStyle:{processResult:!0,transform:(e,t,n)=>SD(t,"layerStyles."+e,n)},textStyle:{processResult:!0,transform:(e,t,n)=>SD(t,"textStyles."+e,n)},apply:{processResult:!0,transform:(e,t,n)=>SD(t,e,n)}},fy={position:!0,pos:se.prop("position"),zIndex:se.prop("zIndex","zIndices"),inset:se.spaceT(["top","right","bottom","left"]),insetX:se.spaceT(["left","right"]),insetInline:se.spaceT("insetInline"),insetY:se.spaceT(["top","bottom"]),insetBlock:se.spaceT("insetBlock"),top:se.spaceT("top"),insetBlockStart:se.spaceT("insetBlockStart"),bottom:se.spaceT("bottom"),insetBlockEnd:se.spaceT("insetBlockEnd"),left:se.spaceT("left"),insetInlineStart:se.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:se.spaceT("right"),insetInlineEnd:se.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(fy,{insetStart:fy.insetInlineStart,insetEnd:fy.insetInlineEnd});var _2e={ring:{transform:$n.ring},ringColor:se.colors("--chakra-ring-color"),ringOffset:se.prop("--chakra-ring-offset-width"),ringOffsetColor:se.colors("--chakra-ring-offset-color"),ringInset:se.prop("--chakra-ring-inset")},tr={margin:se.spaceT("margin"),marginTop:se.spaceT("marginTop"),marginBlockStart:se.spaceT("marginBlockStart"),marginRight:se.spaceT("marginRight"),marginInlineEnd:se.spaceT("marginInlineEnd"),marginBottom:se.spaceT("marginBottom"),marginBlockEnd:se.spaceT("marginBlockEnd"),marginLeft:se.spaceT("marginLeft"),marginInlineStart:se.spaceT("marginInlineStart"),marginX:se.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:se.spaceT("marginInline"),marginY:se.spaceT(["marginTop","marginBottom"]),marginBlock:se.spaceT("marginBlock"),padding:se.space("padding"),paddingTop:se.space("paddingTop"),paddingBlockStart:se.space("paddingBlockStart"),paddingRight:se.space("paddingRight"),paddingBottom:se.space("paddingBottom"),paddingBlockEnd:se.space("paddingBlockEnd"),paddingLeft:se.space("paddingLeft"),paddingInlineStart:se.space("paddingInlineStart"),paddingInlineEnd:se.space("paddingInlineEnd"),paddingX:se.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:se.space("paddingInline"),paddingY:se.space(["paddingTop","paddingBottom"]),paddingBlock:se.space("paddingBlock")};Object.assign(tr,{m:tr.margin,mt:tr.marginTop,mr:tr.marginRight,me:tr.marginInlineEnd,marginEnd:tr.marginInlineEnd,mb:tr.marginBottom,ml:tr.marginLeft,ms:tr.marginInlineStart,marginStart:tr.marginInlineStart,mx:tr.marginX,my:tr.marginY,p:tr.padding,pt:tr.paddingTop,py:tr.paddingY,px:tr.paddingX,pb:tr.paddingBottom,pl:tr.paddingLeft,ps:tr.paddingInlineStart,paddingStart:tr.paddingInlineStart,pr:tr.paddingRight,pe:tr.paddingInlineEnd,paddingEnd:tr.paddingInlineEnd});var S2e={textDecorationColor:se.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:se.shadows("textShadow")},E2e={clipPath:!0,transform:se.propT("transform",$n.transform),transformOrigin:!0,translateX:se.spaceT("--chakra-translate-x"),translateY:se.spaceT("--chakra-translate-y"),skewX:se.degreeT("--chakra-skew-x"),skewY:se.degreeT("--chakra-skew-y"),scaleX:se.prop("--chakra-scale-x"),scaleY:se.prop("--chakra-scale-y"),scale:se.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:se.degreeT("--chakra-rotate")},C2e={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:se.prop("transitionDuration","transition.duration"),transitionProperty:se.prop("transitionProperty","transition.property"),transitionTimingFunction:se.prop("transitionTimingFunction","transition.easing")},A2e={fontFamily:se.prop("fontFamily","fonts"),fontSize:se.prop("fontSize","fontSizes",$n.px),fontWeight:se.prop("fontWeight","fontWeights"),lineHeight:se.prop("lineHeight","lineHeights"),letterSpacing:se.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"},isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}},Xg={hover:e=>e+":hover &, "+e+"[data-hover] &",focus:e=>e+":focus &, "+e+"[data-focus] &",active:e=>e+":active &, "+e+"[data-active] &",disabled:e=>e+":disabled &, "+e+"[data-disabled] &",invalid:e=>e+":invalid &, "+e+"[data-invalid] &",checked:e=>e+":checked &, "+e+"[data-checked] &",indeterminate:e=>e+":indeterminate &, "+e+"[aria-checked=mixed] &, "+e+"[data-indeterminate] &",readOnly:e=>e+":read-only &, "+e+"[readonly] &, "+e+"[data-read-only] &",expanded:e=>e+":read-only &, "+e+"[aria-expanded=true] &, "+e+"[data-expanded] &"},Yg=e=>k2e(e,"[role=group]","[data-group]",".group"),k2e=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(t).join(", ")},ED={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible",_disabled:"&[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:Yg(Xg.hover),_groupFocus:Yg(Xg.focus),_groupActive:Yg(Xg.active),_groupDisabled:Yg(Xg.disabled),_groupInvalid:Yg(Xg.invalid),_groupChecked:Yg(Xg.checked),_placeholder:"&::placeholder",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &",_mediaDark:"@media (prefers-color-scheme: dark)",_dark:".chakra-ui-dark &, [data-theme=dark] &, &[data-theme=dark]",_light:".chakra-ui-light &, [data-theme=light] &, &[data-theme=light]"},T2e=Y2(ED);function CD(){return CD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CD.apply(this,arguments)}var AD=Ru({},i_,kn,g2e,a_,ns,m2e,_2e,v2e,yV,w2e,fy,_D,tr,A2e,S2e,E2e,y2e,C2e),O2e=Object.assign({},tr,ns,a_,yV,fy),I2e=Y2(O2e),N2e=[...Y2(AD),...T2e],D2e=CD({},AD,ED),R2e=e=>e in D2e,F2e=e=>t=>{if(!t.__breakpoints)return e;var{isResponsive:n,toArrayValue:r,media:i}=t.__breakpoints,a={};for(var o in e){var s=Fs(e[o],t);if(s!=null){if(s=Du(s)&&n(s)?r(s):s,!Array.isArray(s)){a[o]=s;continue}for(var u=s.slice(0,i.length).length,l=0;l<u;l+=1){var c=i==null?void 0:i[l];if(!c){a[o]=s[l];continue}a[c]=a[c]||{},s[l]!=null&&(a[c][o]=s[l])}}}return a},M2e=(e,t)=>e.startsWith("--")&&tD(t)&&!KW(t),P2e=(e,t)=>{var n,r;if(t==null)return t;var i=l=>{var c,f;return(c=e.__cssMap)==null||(f=c[l])==null?void 0:f.varRef},a=l=>{var c;return(c=i(l))!=null?c:l},o=t.split(",").map(l=>l.trim()),[s,u]=o;return t=(n=(r=i(s))!=null?r:a(u))!=null?n:a(t),t};function $2e(e){var{configs:t={},pseudos:n={},theme:r}=e,i=function a(o,s){s===void 0&&(s=!1);var u=Fs(o,r),l=F2e(u)(r),c={};for(var f in l){var d,h,p,g,m,v=l[f],y=Fs(v,r);f in n&&(f=n[f]),M2e(f,y)&&(y=P2e(r,y));var b=t[f];if(b===!0&&(b={property:f}),Du(y)){var x;c[f]=(x=c[f])!=null?x:{},c[f]=Ru({},c[f],a(y,!0));continue}var w=(d=(h=b)==null||h.transform==null?void 0:h.transform(y,r,u))!=null?d:y;w=(p=b)!=null&&p.processResult?a(w,!0):w;var S=Fs((g=b)==null?void 0:g.property,r);if(!s&&(m=b)!=null&&m.static){var C=Fs(b.static,r);c=Ru({},c,C)}if(S&&Array.isArray(S)){for(var _ of S)c[_]=w;continue}if(S){S==="&"&&Du(w)?c=Ru({},c,w):c[S]=w;continue}if(Du(w)){c=Ru({},c,w);continue}c[f]=w}return c};return i}var bV=e=>t=>{var n=$2e({theme:t,pseudos:ED,configs:AD});return n(e)};function xV(e){return Du(e)&&e.reference?e.reference:String(e)}var o_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(xV).join(" "+t+" ").replace(/calc/g,"")},wV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+o_("+",...n)+")"},_V=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+o_("-",...n)+")"},kD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+o_("*",...n)+")"},SV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+o_("/",...n)+")"},EV=e=>{var t=xV(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:kD(t,-1)},vh=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vh(wV(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vh(_V(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vh(kD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vh(SV(e,...r))},negate:()=>vh(EV(e)),toString:()=>e.toString()}),{add:wV,subtract:_V,multiply:kD,divide:SV,negate:EV});function L2e(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function CV(e){var t=L2e(e.toString());if(t.includes("\\."))return e;var n=!Number.isInteger(parseFloat(e.toString()));return n?t.replace(".","\\."):e}function B2e(e,t){return t===void 0&&(t=""),[t,CV(e)].filter(Boolean).join("-")}function z2e(e,t){return"var("+CV(e)+(t?", "+t:"")+")"}function j2e(e,t){return t===void 0&&(t=""),"--"+B2e(e,t)}function AV(e,t,n){var r=j2e(e,n);return{variable:r,reference:z2e(r,t)}}function TD(){return TD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},TD.apply(this,arguments)}function U2e(e,t){var n={cssMap:{},cssVars:{}};return Awe(e,(r,i)=>{var a,[o]=i,s=(a=OD[o])!=null?a:OD.defaultHandler,{cssVars:u,cssMap:l}=s(i,r,t);Object.assign(n.cssVars,u),Object.assign(n.cssMap,l)}),n}var OD={space:(e,t,n)=>{var r=OD.defaultHandler(e,t,n),[i,...a]=e,o=i+".-"+a.join("."),s=e.join("-"),{variable:u,reference:l}=AV(s,void 0,n.cssVarPrefix),c=vh.negate(t),f=vh.negate(l);return{cssVars:r.cssVars,cssMap:TD({},r.cssMap,{[o]:{value:""+c,var:""+u,varRef:f}})}},defaultHandler:(e,t,n)=>{var r=e.join("."),i=e.join("-"),{variable:a,reference:o}=AV(i,void 0,n.cssVarPrefix);return{cssVars:{[a]:t},cssMap:{[r]:{value:t,var:a,varRef:o}}}}};function W2e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var V2e=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur"];function q2e(e){var t=V2e;return Kxe(e,t)}function H2e(e){var t=W2e(e,["__cssMap","__cssVars","__breakpoints"]);return t}function ID(){return ID=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ID.apply(this,arguments)}function G2e(e){var t,n=H2e(e),r=q2e(n),i=(t=n.config)==null?void 0:t.cssVarPrefix,{cssMap:a,cssVars:o}=U2e(r,{cssVarPrefix:i}),s={"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"};return Object.assign(n,{__cssVars:ID({},s,o),__cssMap:a,__breakpoints:nwe(n.breakpoints)}),n}var K2e=typeof Element!="undefined",X2e=typeof Map=="function",Y2e=typeof Set=="function",Z2e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(!s_(e[r],t[r]))return!1;return!0}var a;if(X2e&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;for(a=e.entries();!(r=a.next()).done;)if(!s_(r.value[1],t.get(r.value[0])))return!1;return!0}if(Y2e&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(Z2e&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(K2e&&e instanceof Element)return!1;for(r=n;r--!=0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!s_(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var J2e=function(t,n){try{return s_(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},Q2e=J2e,e_e=e=>{var{cssVarsRoot:t=":host, :root",theme:n,children:r}=e,i=xr(()=>G2e(n),[n]);return ue(Uxe,{theme:i},ue(QN,{styles:a=>({[t]:a.__cssVars})}),r)};function kV(){var e=Un(ny);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var[dy,vi]=Mu({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "}),t_e=()=>{var{colorMode:e}=mD();return ue(QN,{styles:t=>{var n=K2(t,"styles.global"),r=Fs(n,{theme:t,colorMode:e});if(!!r){var i=bV(r)(t);return i}}})},n_e=["a","b","article","aside","blockquote","button","caption","cite","circle","code","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","img","input","kbd","label","li","main","mark","nav","ol","p","path","pre","q","rect","s","svg","section","select","strong","small","span","sub","sup","table","tbody","td","textarea","tfoot","th","thead","tr","ul"];function Ao(e){return rD(e,["styleConfig","size","variant","colorScheme"])}function ND(){return ND=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ND.apply(this,arguments)}function r_e(){var e=mD(),t=kV();return ND({},e,{theme:t})}var i_e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,a_e=DW(function(e){return i_e.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),o_e=a_e,s_e=function(t){return t!=="theme"},TV=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?o_e:s_e},OV=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},u_e=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,o;n!==void 0&&(a=n.label,o=n.target);var s=OV(t,n,r),u=s||TV(i),l=!u("as");return function(){var c=arguments,f=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),c[0]==null||c[0].raw===void 0)f.push.apply(f,c);else{f.push(c[0][0]);for(var d=c.length,h=1;h<d;h++)f.push(c[h],c[0][h])}var p=VW(function(g,m,v){var y=l&&g.as||i,b="",x=[],w=g;if(g.theme==null){w={};for(var S in g)w[S]=g[S];w.theme=Un(ny)}typeof g.className=="string"?b=Fxe(m.registered,x,g.className):g.className!=null&&(b=g.className+" ");var C=JN(f.concat(x),m.registered,w);LW(m,C,typeof y=="string"),b+=m.key+"-"+C.name,o!==void 0&&(b+=" "+o);var _=l&&s===void 0?TV(y):u,E={};for(var A in g)l&&A==="as"||_(A)&&(E[A]=g[A]);E.className=b,E.ref=v;var k=ue(y,E);return k});return p.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=i,p.__emotion_styles=f,p.__emotion_forwardProp=s,Object.defineProperty(p,"toString",{value:function(){return"."+o}}),p.withComponent=function(g,m){return e(g,mh({},n,m,{shouldForwardProp:OV(p,m,!0)})).apply(void 0,f)},p}},l_e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],DD=u_e.bind();l_e.forEach(function(e){DD[e]=DD(e)});var c_e=new Set([...N2e,"textStyle","layerStyle","apply","isTruncated","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),f_e=new Set(["htmlWidth","htmlHeight","htmlSize"]),d_e=e=>f_e.has(e)||!c_e.has(e);function IV(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var h_e=e=>{var{baseStyle:t}=e;return n=>{var{css:r,__css:i,sx:a}=n,o=IV(n,["theme","css","__css","sx"]),s=XW(o,(f,d)=>R2e(d)),u=Fs(t,n),l=Object.assign({},i,u,X2(s),a),c=bV(l)(n.theme);return r?[c,r]:c}};function p_e(e,t){var n=t??{},{baseStyle:r}=n,i=IV(n,["baseStyle"]);i.shouldForwardProp||(i.shouldForwardProp=d_e);var a=h_e({baseStyle:r});return DD(e,i)(a)}var xt=p_e;n_e.forEach(e=>{xt[e]=xt(e)});function Mt(e){return Gl(e)}function g_e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function yh(e,t,n){var r,i;t===void 0&&(t={}),n===void 0&&(n={});var{styleConfig:a}=t,o=g_e(t,["styleConfig"]),{theme:s,colorMode:u}=r_e(),l=K2(s,"components."+e),c=a||l,f=Ru({theme:s,colorMode:u},(r=c==null?void 0:c.defaultProps)!=null?r:{},X2(rD(o,["children"]))),d=Jt({});return xr(()=>{if(c){var h,p,g,m,v,y,b=Fs((h=c.baseStyle)!=null?h:{},f),x=Fs((p=(g=c.variants)==null?void 0:g[f.variant])!=null?p:{},f),w=Fs((m=(v=c.sizes)==null?void 0:v[f.size])!=null?m:{},f),S=Ru({},b,w,x);(y=n)!=null&&y.isMultiPart&&c.parts&&c.parts.forEach(_=>{var E;S[_]=(E=S[_])!=null?E:{}});var C=Q2e(d.current,S);C||(d.current=S)}return d.current},[c,f,(i=n)==null?void 0:i.isMultiPart])}function hf(e,t){return yh(e,t,{isMultiPart:!0})}var m_e=["container","button","panel","icon"],v_e={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},y_e={transitionProperty:"common",transitionDuration:"normal",fontSize:"1rem",_focus:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:4,py:2},b_e={pt:2,px:4,pb:5},x_e={fontSize:"1.25em"},w_e={container:v_e,button:y_e,panel:b_e,icon:x_e},__e={parts:m_e,baseStyle:w_e},NV={exports:{}};(function(e){(function(t){var n=/^\s+/,r=/\s+$/,i=0,a=t.round,o=t.min,s=t.max,u=t.random;function l(M,B){if(M=M||"",B=B||{},M instanceof l)return M;if(!(this instanceof l))return new l(M,B);var R=c(M);this._originalInput=M,this._r=R.r,this._g=R.g,this._b=R.b,this._a=R.a,this._roundA=a(100*this._a)/100,this._format=B.format||R.format,this._gradientType=B.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=R.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var M=this.toRgb();return(M.r*299+M.g*587+M.b*114)/1e3},getLuminance:function(){var M=this.toRgb(),B,R,X,ge,xe,ze;return B=M.r/255,R=M.g/255,X=M.b/255,B<=.03928?ge=B/12.92:ge=t.pow((B+.055)/1.055,2.4),R<=.03928?xe=R/12.92:xe=t.pow((R+.055)/1.055,2.4),X<=.03928?ze=X/12.92:ze=t.pow((X+.055)/1.055,2.4),.2126*ge+.7152*xe+.0722*ze},setAlpha:function(M){return this._a=G(M),this._roundA=a(100*this._a)/100,this},toHsv:function(){var M=p(this._r,this._g,this._b);return{h:M.h*360,s:M.s,v:M.v,a:this._a}},toHsvString:function(){var M=p(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.v*100);return this._a==1?"hsv("+B+", "+R+"%, "+X+"%)":"hsva("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHsl:function(){var M=d(this._r,this._g,this._b);return{h:M.h*360,s:M.s,l:M.l,a:this._a}},toHslString:function(){var M=d(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.l*100);return this._a==1?"hsl("+B+", "+R+"%, "+X+"%)":"hsla("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHex:function(M){return m(this._r,this._g,this._b,M)},toHexString:function(M){return"#"+this.toHex(M)},toHex8:function(M){return v(this._r,this._g,this._b,this._a,M)},toHex8String:function(M){return"#"+this.toHex8(M)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(K(this._r,255)*100)+"%",g:a(K(this._g,255)*100)+"%",b:a(K(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%)":"rgba("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:L[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(M){var B="#"+y(this._r,this._g,this._b,this._a),R=B,X=this._gradientType?"GradientType = 1, ":"";if(M){var ge=l(M);R="#"+y(ge._r,ge._g,ge._b,ge._a)}return"progid:DXImageTransform.Microsoft.gradient("+X+"startColorstr="+B+",endColorstr="+R+")"},toString:function(M){var B=!!M;M=M||this._format;var R=!1,X=this._a<1&&this._a>=0,ge=!B&&X&&(M==="hex"||M==="hex6"||M==="hex3"||M==="hex4"||M==="hex8"||M==="name");return ge?M==="name"&&this._a===0?this.toName():this.toRgbString():(M==="rgb"&&(R=this.toRgbString()),M==="prgb"&&(R=this.toPercentageRgbString()),(M==="hex"||M==="hex6")&&(R=this.toHexString()),M==="hex3"&&(R=this.toHexString(!0)),M==="hex4"&&(R=this.toHex8String(!0)),M==="hex8"&&(R=this.toHex8String()),M==="name"&&(R=this.toName()),M==="hsl"&&(R=this.toHslString()),M==="hsv"&&(R=this.toHsvString()),R||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(M,B){var R=M.apply(null,[this].concat([].slice.call(B)));return this._r=R._r,this._g=R._g,this._b=R._b,this.setAlpha(R._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(C,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(M,B){return M.apply(null,[this].concat([].slice.call(B)))},analogous:function(){return this._applyCombination(N,arguments)},complement:function(){return this._applyCombination(A,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},l.fromRatio=function(M,B){if(typeof M=="object"){var R={};for(var X in M)M.hasOwnProperty(X)&&(X==="a"?R[X]=M[X]:R[X]=De(M[X]));M=R}return l(M,B)};function c(M){var B={r:0,g:0,b:0},R=1,X=null,ge=null,xe=null,ze=!1,Ke=!1;return typeof M=="string"&&(M=ae(M)),typeof M=="object"&&(V(M.r)&&V(M.g)&&V(M.b)?(B=f(M.r,M.g,M.b),ze=!0,Ke=String(M.r).substr(-1)==="%"?"prgb":"rgb"):V(M.h)&&V(M.s)&&V(M.v)?(X=De(M.s),ge=De(M.v),B=g(M.h,X,ge),ze=!0,Ke="hsv"):V(M.h)&&V(M.s)&&V(M.l)&&(X=De(M.s),xe=De(M.l),B=h(M.h,X,xe),ze=!0,Ke="hsl"),M.hasOwnProperty("a")&&(R=M.a)),R=G(R),{ok:ze,format:M.format||Ke,r:o(255,s(B.r,0)),g:o(255,s(B.g,0)),b:o(255,s(B.b,0)),a:R}}function f(M,B,R){return{r:K(M,255)*255,g:K(B,255)*255,b:K(R,255)*255}}function d(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=(X+ge)/2;if(X==ge)xe=ze=0;else{var Ze=X-ge;switch(ze=Ke>.5?Ze/(2-X-ge):Ze/(X+ge),X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,l:Ke}}function h(M,B,R){var X,ge,xe;M=K(M,360),B=K(B,100),R=K(R,100);function ze(Bt,Je,Zt){return Zt<0&&(Zt+=1),Zt>1&&(Zt-=1),Zt<1/6?Bt+(Je-Bt)*6*Zt:Zt<1/2?Je:Zt<2/3?Bt+(Je-Bt)*(2/3-Zt)*6:Bt}if(B===0)X=ge=xe=R;else{var Ke=R<.5?R*(1+B):R+B-R*B,Ze=2*R-Ke;X=ze(Ze,Ke,M+1/3),ge=ze(Ze,Ke,M),xe=ze(Ze,Ke,M-1/3)}return{r:X*255,g:ge*255,b:xe*255}}function p(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=X,Ze=X-ge;if(ze=X===0?0:Ze/X,X==ge)xe=0;else{switch(X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,v:Ke}}function g(M,B,R){M=K(M,360)*6,B=K(B,100),R=K(R,100);var X=t.floor(M),ge=M-X,xe=R*(1-B),ze=R*(1-ge*B),Ke=R*(1-(1-ge)*B),Ze=X%6,Bt=[R,ze,xe,xe,Ke,R][Ze],Je=[Ke,R,R,ze,xe,xe][Ze],Zt=[xe,xe,Ke,R,R,ze][Ze];return{r:Bt*255,g:Je*255,b:Zt*255}}function m(M,B,R,X){var ge=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return X&&ge[0].charAt(0)==ge[0].charAt(1)&&ge[1].charAt(0)==ge[1].charAt(1)&&ge[2].charAt(0)==ge[2].charAt(1)?ge[0].charAt(0)+ge[1].charAt(0)+ge[2].charAt(0):ge.join("")}function v(M,B,R,X,ge){var xe=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16)),Te(me(X))];return ge&&xe[0].charAt(0)==xe[0].charAt(1)&&xe[1].charAt(0)==xe[1].charAt(1)&&xe[2].charAt(0)==xe[2].charAt(1)&&xe[3].charAt(0)==xe[3].charAt(1)?xe[0].charAt(0)+xe[1].charAt(0)+xe[2].charAt(0)+xe[3].charAt(0):xe.join("")}function y(M,B,R,X){var ge=[Te(me(X)),Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return ge.join("")}l.equals=function(M,B){return!M||!B?!1:l(M).toRgbString()==l(B).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s-=B/100,R.s=ee(R.s),l(R)}function x(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s+=B/100,R.s=ee(R.s),l(R)}function w(M){return l(M).desaturate(100)}function S(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l+=B/100,R.l=ee(R.l),l(R)}function C(M,B){B=B===0?0:B||10;var R=l(M).toRgb();return R.r=s(0,o(255,R.r-a(255*-(B/100)))),R.g=s(0,o(255,R.g-a(255*-(B/100)))),R.b=s(0,o(255,R.b-a(255*-(B/100)))),l(R)}function _(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l-=B/100,R.l=ee(R.l),l(R)}function E(M,B){var R=l(M).toHsl(),X=(R.h+B)%360;return R.h=X<0?360+X:X,l(R)}function A(M){var B=l(M).toHsl();return B.h=(B.h+180)%360,l(B)}function k(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+120)%360,s:B.s,l:B.l}),l({h:(R+240)%360,s:B.s,l:B.l})]}function T(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+90)%360,s:B.s,l:B.l}),l({h:(R+180)%360,s:B.s,l:B.l}),l({h:(R+270)%360,s:B.s,l:B.l})]}function I(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+72)%360,s:B.s,l:B.l}),l({h:(R+216)%360,s:B.s,l:B.l})]}function N(M,B,R){B=B||6,R=R||30;var X=l(M).toHsl(),ge=360/R,xe=[l(M)];for(X.h=(X.h-(ge*B>>1)+720)%360;--B;)X.h=(X.h+ge)%360,xe.push(l(X));return xe}function O(M,B){B=B||6;for(var R=l(M).toHsv(),X=R.h,ge=R.s,xe=R.v,ze=[],Ke=1/B;B--;)ze.push(l({h:X,s:ge,v:xe})),xe=(xe+Ke)%1;return ze}l.mix=function(M,B,R){R=R===0?0:R||50;var X=l(M).toRgb(),ge=l(B).toRgb(),xe=R/100,ze={r:(ge.r-X.r)*xe+X.r,g:(ge.g-X.g)*xe+X.g,b:(ge.b-X.b)*xe+X.b,a:(ge.a-X.a)*xe+X.a};return l(ze)},l.readability=function(M,B){var R=l(M),X=l(B);return(t.max(R.getLuminance(),X.getLuminance())+.05)/(t.min(R.getLuminance(),X.getLuminance())+.05)},l.isReadable=function(M,B,R){var X=l.readability(M,B),ge,xe;switch(xe=!1,ge=Y(R),ge.level+ge.size){case"AAsmall":case"AAAlarge":xe=X>=4.5;break;case"AAlarge":xe=X>=3;break;case"AAAsmall":xe=X>=7;break}return xe},l.mostReadable=function(M,B,R){var X=null,ge=0,xe,ze,Ke,Ze;R=R||{},ze=R.includeFallbackColors,Ke=R.level,Ze=R.size;for(var Bt=0;Bt<B.length;Bt++)xe=l.readability(M,B[Bt]),xe>ge&&(ge=xe,X=l(B[Bt]));return l.isReadable(M,X,{level:Ke,size:Ze})||!ze?X:(R.includeFallbackColors=!1,l.mostReadable(M,["#fff","#000"],R))};var D=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=l.hexNames=W(D);function W(M){var B={};for(var R in M)M.hasOwnProperty(R)&&(B[M[R]]=R);return B}function G(M){return M=parseFloat(M),(isNaN(M)||M<0||M>1)&&(M=1),M}function K(M,B){he(M)&&(M="100%");var R=Oe(M);return M=o(B,s(0,parseFloat(M))),R&&(M=parseInt(M*B,10)/100),t.abs(M-B)<1e-6?1:M%B/parseFloat(B)}function ee(M){return o(1,s(0,M))}function ce(M){return parseInt(M,16)}function he(M){return typeof M=="string"&&M.indexOf(".")!=-1&&parseFloat(M)===1}function Oe(M){return typeof M=="string"&&M.indexOf("%")!=-1}function Te(M){return M.length==1?"0"+M:""+M}function De(M){return M<=1&&(M=M*100+"%"),M}function me(M){return t.round(parseFloat(M)*255).toString(16)}function P(M){return ce(M)/255}var F=function(){var M="[-\\+]?\\d+%?",B="[-\\+]?\\d*\\.\\d+%?",R="(?:"+B+")|(?:"+M+")",X="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",ge="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";return{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+X),rgba:new RegExp("rgba"+ge),hsl:new RegExp("hsl"+X),hsla:new RegExp("hsla"+ge),hsv:new RegExp("hsv"+X),hsva:new RegExp("hsva"+ge),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function V(M){return!!F.CSS_UNIT.exec(M)}function ae(M){M=M.replace(n,"").replace(r,"").toLowerCase();var B=!1;if(D[M])M=D[M],B=!0;else if(M=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var R;return(R=F.rgb.exec(M))?{r:R[1],g:R[2],b:R[3]}:(R=F.rgba.exec(M))?{r:R[1],g:R[2],b:R[3],a:R[4]}:(R=F.hsl.exec(M))?{h:R[1],s:R[2],l:R[3]}:(R=F.hsla.exec(M))?{h:R[1],s:R[2],l:R[3],a:R[4]}:(R=F.hsv.exec(M))?{h:R[1],s:R[2],v:R[3]}:(R=F.hsva.exec(M))?{h:R[1],s:R[2],v:R[3],a:R[4]}:(R=F.hex8.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),a:P(R[4]),format:B?"name":"hex8"}:(R=F.hex6.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),format:B?"name":"hex"}:(R=F.hex4.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),a:P(R[4]+""+R[4]),format:B?"name":"hex8"}:(R=F.hex3.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),format:B?"name":"hex"}:!1}function Y(M){var B,R;return M=M||{level:"AA",size:"small"},B=(M.level||"AA").toUpperCase(),R=(M.size||"small").toLowerCase(),B!=="AA"&&B!=="AAA"&&(B="AA"),R!=="small"&&R!=="large"&&(R="small"),{level:B,size:R}}e.exports?e.exports=l:window.tinycolor=l})(Math)})(NV);var u_=NV.exports,ni=(e,t,n)=>{var r=K2(e,"colors."+t,t),i=u_(r).isValid();return i?r:n},S_e=e=>t=>{var n=ni(t,e),r=u_(n).isDark();return r?"dark":"light"},E_e=e=>t=>S_e(e)(t)==="dark",Zg=(e,t)=>n=>{var r=ni(n,e);return u_(r).setAlpha(t).toRgbString()};function DV(e,t){return e===void 0&&(e="1rem"),t===void 0&&(t="rgba(255, 255, 255, 0.15)"),{backgroundImage:`linear-gradient(
    45deg,
    `+t+` 25%,
    transparent 25%,
    transparent 50%,
    `+t+` 50%,
    `+t+` 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:e+" "+e}}function C_e(e){var t=u_.random().toHexString();return!e||Gxe(e)?t:e.string&&e.colors?k_e(e.string,e.colors):e.string&&!e.colors?A_e(e.string):e.colors&&!e.string?T_e(e.colors):t}function A_e(e){var t=0;if(e.length===0)return t.toString();for(var n=0;n<e.length;n+=1)t=e.charCodeAt(n)+((t<<5)-t),t=t&t;for(var r="#",i=0;i<3;i+=1){var a=t>>i*8&255;r+=("00"+a.toString(16)).substr(-2)}return r}function k_e(e,t){var n=0;if(e.length===0)return t[0];for(var r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]}function T_e(e){return e[Math.floor(Math.random()*e.length)]}function Ae(e,t){return n=>n.colorMode==="dark"?t:e}function hy(e){var{orientation:t,vertical:n,horizontal:r}=e;return t?t==="vertical"?n:r:{}}function RD(){return RD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RD.apply(this,arguments)}var O_e=e=>(sD({condition:!0,message:["[chakra-ui]: createBreakpoints(...) will be deprecated pretty soon","simply pass the breakpoints as an object. Remove the createBreakpoint(..) call"].join("")}),RD({base:"0em"},e)),I_e=["container","title","description","icon"],N_e={container:{px:4,py:3},title:{fontWeight:"bold",lineHeight:6,marginEnd:2},description:{lineHeight:6},icon:{flexShrink:0,marginEnd:3,w:5,h:6}};function FD(e){var{theme:t,colorScheme:n}=e,r=ni(t,n+".100",n),i=Zg(n+".200",.16)(t);return Ae(r,i)(e)}function D_e(e){var{colorScheme:t}=e;return{container:{bg:FD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function R_e(e){var{colorScheme:t}=e;return{container:{paddingStart:3,borderStartWidth:"4px",borderStartColor:Ae(t+".500",t+".200")(e),bg:FD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function F_e(e){var{colorScheme:t}=e;return{container:{pt:2,borderTopWidth:"4px",borderTopColor:Ae(t+".500",t+".200")(e),bg:FD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function M_e(e){var{colorScheme:t}=e;return{container:{bg:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e)}}}var P_e={subtle:D_e,"left-accent":R_e,"top-accent":F_e,solid:M_e},$_e={variant:"subtle",colorScheme:"blue"},L_e={parts:I_e,baseStyle:N_e,variants:P_e,defaultProps:$_e},RV={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"};function MD(){return MD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MD.apply(this,arguments)}var B_e={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem"},z_e={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},j_e=MD({},RV,B_e,{container:z_e}),FV=j_e,U_e=["container","excessLabel","badge","label"];function W_e(e){return{transform:"translate(25%, 25%)",borderRadius:"full",border:"0.2em solid",borderColor:Ae("white","gray.800")(e)}}function V_e(e){return{bg:Ae("gray.200","whiteAlpha.400")(e)}}function q_e(e){var{name:t,theme:n}=e,r=t?C_e({string:t}):"gray.400",i=E_e(r)(n),a="white";i||(a="gray.800");var o=Ae("white","gray.800")(e);return{bg:r,color:a,borderColor:o,verticalAlign:"top"}}var H_e=e=>({badge:W_e(e),excessLabel:V_e(e),container:q_e(e)});function pf(e){var t=FV[e];return{container:{width:e,height:e,fontSize:"calc("+(t??e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(t??e)+" / 2.5)",lineHeight:e!=="100%"?t??e:void 0}}}var G_e={"2xs":pf("4"),xs:pf("6"),sm:pf("8"),md:pf("12"),lg:pf("16"),xl:pf("24"),"2xl":pf("32"),full:pf("100%")},K_e={size:"md"},X_e={parts:U_e,baseStyle:H_e,sizes:G_e,defaultProps:K_e},Y_e={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"};function Z_e(e){var{colorScheme:t,theme:n}=e,r=Zg(t+".500",.6)(n);return{bg:Ae(t+".500",r)(e),color:Ae("white","whiteAlpha.800")(e)}}function J_e(e){var{colorScheme:t,theme:n}=e,r=Zg(t+".200",.16)(n);return{bg:Ae(t+".100",r)(e),color:Ae(t+".800",t+".200")(e)}}function Q_e(e){var{colorScheme:t,theme:n}=e,r=Zg(t+".200",.8)(n),i=ni(n,t+".500"),a=Ae(i,r)(e);return{color:a,boxShadow:"inset 0 0 0px 1px "+a}}var eSe={solid:Z_e,subtle:J_e,outline:Q_e},tSe={variant:"subtle",colorScheme:"gray"},py={baseStyle:Y_e,variants:eSe,defaultProps:tSe},nSe=["container","item","link","separator"],rSe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},iSe={link:rSe},aSe={parts:nSe,baseStyle:iSe};function PD(){return PD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PD.apply(this,arguments)}var oSe={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}};function MV(e){var{colorScheme:t,theme:n}=e;if(t==="gray")return{color:Ae("inherit","whiteAlpha.900")(e),_hover:{bg:Ae("gray.100","whiteAlpha.200")(e)},_active:{bg:Ae("gray.200","whiteAlpha.300")(e)}};var r=Zg(t+".200",.12)(n),i=Zg(t+".200",.24)(n);return{color:Ae(t+".600",t+".200")(e),bg:"transparent",_hover:{bg:Ae(t+".50",r)(e)},_active:{bg:Ae(t+".100",i)(e)}}}function sSe(e){var{colorScheme:t}=e,n=Ae("gray.200","whiteAlpha.300")(e);return PD({border:"1px solid",borderColor:t==="gray"?n:"currentColor"},MV(e))}var uSe={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}};function lSe(e){var{colorScheme:t}=e;if(t==="gray"){var n=Ae("gray.100","whiteAlpha.200")(e);return{bg:n,_hover:{bg:Ae("gray.200","whiteAlpha.300")(e),_disabled:{bg:n}},_active:{bg:Ae("gray.300","whiteAlpha.400")(e)}}}var{bg:r=t+".500",color:i="white",hoverBg:a=t+".600",activeBg:o=t+".700"}=uSe[t]||{},s=Ae(r,t+".200")(e);return{bg:s,color:Ae(i,"gray.800")(e),_hover:{bg:Ae(a,t+".300")(e),_disabled:{bg:s}},_active:{bg:Ae(o,t+".400")(e)}}}function cSe(e){var{colorScheme:t}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Ae(t+".500",t+".200")(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Ae(t+".700",t+".500")(e)}}}var fSe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0},dSe={ghost:MV,outline:sSe,solid:lSe,link:cSe,unstyled:fSe},hSe={lg:{h:12,minW:12,fontSize:"lg",px:6},md:{h:10,minW:10,fontSize:"md",px:4},sm:{h:8,minW:8,fontSize:"sm",px:3},xs:{h:6,minW:6,fontSize:"xs",px:2}},pSe={variant:"solid",size:"md",colorScheme:"gray"},gSe={baseStyle:oSe,variants:dSe,sizes:hSe,defaultProps:pSe},mSe=["container","control","label","icon"];function vSe(e){var{colorScheme:t}=e;return{w:"100%",transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Ae(t+".500",t+".200")(e),borderColor:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e),_hover:{bg:Ae(t+".600",t+".300")(e),borderColor:Ae(t+".600",t+".300")(e)},_disabled:{borderColor:Ae("gray.200","transparent")(e),bg:Ae("gray.200","whiteAlpha.300")(e),color:Ae("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Ae(t+".500",t+".200")(e),borderColor:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e)},_disabled:{bg:Ae("gray.100","whiteAlpha.100")(e),borderColor:Ae("gray.100","transparent")(e)},_focus:{boxShadow:"outline"},_invalid:{borderColor:Ae("red.500","red.300")(e)}}}var ySe={userSelect:"none",_disabled:{opacity:.4}},bSe={transitionProperty:"transform",transitionDuration:"normal"},xSe=e=>({icon:bSe,control:vSe(e),label:ySe}),wSe={sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45rem"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625rem"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625rem"}}},_Se={size:"md",colorScheme:"blue"},$D={parts:mSe,baseStyle:xSe,sizes:wSe,defaultProps:_Se};function SSe(e){var t=Ae("blackAlpha.100","whiteAlpha.100")(e),n=Ae("blackAlpha.200","whiteAlpha.200")(e);return{borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{bg:t},_active:{bg:n},_focus:{boxShadow:"outline"}}}var ESe={lg:{w:"40px",h:"40px",fontSize:"16px"},md:{w:"32px",h:"32px",fontSize:"12px"},sm:{w:"24px",h:"24px",fontSize:"10px"}},CSe={size:"md"},ASe={baseStyle:SSe,sizes:ESe,defaultProps:CSe},{variants:kSe,defaultProps:TSe}=py,OSe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},ISe={baseStyle:OSe,variants:kSe,defaultProps:TSe},NSe={w:"100%",mx:"auto",maxW:"60ch",px:"1rem"},DSe={baseStyle:NSe},RSe={opacity:.6,borderColor:"inherit"},FSe={borderStyle:"solid"},MSe={borderStyle:"dashed"},PSe={solid:FSe,dashed:MSe},$Se={variant:"solid"},LSe={baseStyle:RSe,variants:PSe,defaultProps:$Se},BSe=["overlay","dialogContainer","dialog","header","closeButton","body","footer"],zSe={bg:"blackAlpha.600",zIndex:"modal"};function jSe(e){var{isCentered:t,scrollBehavior:n}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:t?"center":"flex-start",overflow:n==="inside"?"hidden":"auto"}}function USe(e){var{scrollBehavior:t}=e;return{borderRadius:"md",bg:Ae("white","gray.700")(e),color:"inherit",my:"3.75rem",zIndex:"modal",maxH:t==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:Ae("lg","dark-lg")(e)}}var WSe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},VSe={position:"absolute",top:2,insetEnd:3};function qSe(e){var{scrollBehavior:t}=e;return{px:6,py:2,flex:1,overflow:t==="inside"?"auto":void 0}}var HSe={px:6,py:4},GSe=e=>({overlay:zSe,dialogContainer:jSe(e),dialog:USe(e),header:WSe,closeButton:VSe,body:qSe(e),footer:HSe});function Ps(e){return e==="full"?{dialog:{maxW:"100vw",minH:"100vh"}}:{dialog:{maxW:e}}}var KSe={xs:Ps("xs"),sm:Ps("sm"),md:Ps("md"),lg:Ps("lg"),xl:Ps("xl"),"2xl":Ps("2xl"),"3xl":Ps("3xl"),"4xl":Ps("4xl"),"5xl":Ps("5xl"),"6xl":Ps("6xl"),full:Ps("full")},XSe={size:"md"},PV={parts:BSe,baseStyle:GSe,sizes:KSe,defaultProps:XSe};function LD(){return LD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LD.apply(this,arguments)}var YSe=PV.parts;function Jg(e){return e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}}}var ZSe={bg:"blackAlpha.600",zIndex:"overlay"},JSe={display:"flex",zIndex:"modal",justifyContent:"center"};function QSe(e){var{isFullHeight:t}=e;return LD({},t&&{height:"100vh"},{zIndex:"modal",maxH:"100vh",bg:Ae("white","gray.700")(e),color:"inherit",boxShadow:Ae("lg","dark-lg")(e)})}var eEe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},tEe={position:"absolute",top:2,insetEnd:3},nEe={px:6,py:2,flex:1,overflow:"auto"},rEe={px:6,py:4},iEe=e=>({overlay:ZSe,dialogContainer:JSe,dialog:QSe(e),header:eEe,closeButton:tEe,body:nEe,footer:rEe}),aEe={xs:Jg("xs"),sm:Jg("md"),md:Jg("lg"),lg:Jg("2xl"),xl:Jg("4xl"),full:Jg("full")},oEe={size:"xs"},sEe={parts:YSe,baseStyle:iEe,sizes:aEe,defaultProps:oEe},uEe=["preview","input"],lEe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal"},cEe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal",width:"full",_focus:{boxShadow:"outline"},_placeholder:{opacity:.6}},fEe={preview:lEe,input:cEe},dEe={parts:uEe,baseStyle:fEe},hEe=["requiredIndicator","helperText"];function pEe(e){return{marginStart:1,color:Ae("red.500","red.300")(e)}}function gEe(e){return{mt:2,color:Ae("gray.500","whiteAlpha.600")(e),lineHeight:"normal",fontSize:"sm"}}var mEe=e=>({requiredIndicator:pEe(e),helperText:gEe(e)}),vEe={parts:hEe,baseStyle:mEe},yEe={fontSize:"md",marginEnd:3,mb:2,fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},bEe={baseStyle:yEe},xEe={fontFamily:"heading",fontWeight:"bold"},wEe={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},_Ee={size:"xl"},SEe={baseStyle:xEe,sizes:wEe,defaultProps:_Ee},EEe=["field","addon"],CEe={field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal"}},gf={lg:{fontSize:"lg",px:4,h:12,borderRadius:"md"},md:{fontSize:"md",px:4,h:10,borderRadius:"md"},sm:{fontSize:"sm",px:3,h:8,borderRadius:"sm"},xs:{fontSize:"xs",px:2,h:6,borderRadius:"sm"}},AEe={lg:{field:gf.lg,addon:gf.lg},md:{field:gf.md,addon:gf.md},sm:{field:gf.sm,addon:gf.sm},xs:{field:gf.xs,addon:gf.xs}};function BD(e){var{focusBorderColor:t,errorBorderColor:n}=e;return{focusBorderColor:t||Ae("blue.500","blue.300")(e),errorBorderColor:n||Ae("red.500","red.300")(e)}}function kEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=BD(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Ae("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ni(t,r),boxShadow:"0 0 0 1px "+ni(t,r)},_focus:{zIndex:1,borderColor:ni(t,n),boxShadow:"0 0 0 1px "+ni(t,n)}},addon:{border:"1px solid",borderColor:Ae("inherit","whiteAlpha.50")(e),bg:Ae("gray.100","whiteAlpha.300")(e)}}}function TEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=BD(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Ae("gray.100","whiteAlpha.50")(e),_hover:{bg:Ae("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ni(t,r)},_focus:{bg:"transparent",borderColor:ni(t,n)}},addon:{border:"2px solid",borderColor:"transparent",bg:Ae("gray.100","whiteAlpha.50")(e)}}}function OEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=BD(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:ni(t,r),boxShadow:"0px 1px 0px 0px "+ni(t,r)},_focus:{borderColor:ni(t,n),boxShadow:"0px 1px 0px 0px "+ni(t,n)}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent"}}}var IEe={field:{bg:"transparent",px:0,height:"auto"},addon:{bg:"transparent",px:0,height:"auto"}},NEe={outline:kEe,filled:TEe,flushed:OEe,unstyled:IEe},DEe={size:"md",variant:"outline"},hr={parts:EEe,baseStyle:CEe,sizes:AEe,variants:NEe,defaultProps:DEe};function REe(e){return{bg:Ae("gray.100","whiteAlpha")(e),borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"}}var FEe={baseStyle:REe},MEe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},PEe={baseStyle:MEe},$Ee=["container","item","icon"],LEe={},BEe={},zEe={marginEnd:"0.5rem",display:"inline",verticalAlign:"text-bottom"},jEe={container:LEe,item:BEe,icon:zEe},UEe={parts:$Ee,baseStyle:jEe},WEe=["item","command","list","button","groupTitle","divider"];function VEe(e){return{bg:Ae("#fff","gray.700")(e),boxShadow:Ae("sm","dark-lg")(e),color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px"}}function qEe(e){return{py:"0.4rem",px:"0.8rem",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:Ae("gray.100","whiteAlpha.100")(e)},_active:{bg:Ae("gray.200","whiteAlpha.200")(e)},_expanded:{bg:Ae("gray.100","whiteAlpha.100")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var HEe={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},GEe={opacity:.6},KEe={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"0.5rem",opacity:.6},XEe={transitionProperty:"common",transitionDuration:"normal"},YEe=e=>({button:XEe,list:VEe(e),item:qEe(e),groupTitle:HEe,command:GEe,divider:KEe}),ZEe={parts:WEe,baseStyle:YEe},JEe={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2","3":".75rem","4":"1rem","5":"1.25rem","6":"1.5rem","7":"1.75rem","8":"2rem","9":"2.25rem","10":"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},$V=JEe,LV;function zD(){return zD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zD.apply(this,arguments)}var QEe=["root","field","stepper","stepperGroup"],{variants:eCe,defaultProps:tCe}=hr,nCe={"--number-input-stepper-width":"24px","--number-input-field-padding":"calc(var(--number-input-stepper-width) + 0.5rem)"},rCe=(LV=hr.baseStyle)==null?void 0:LV.field,iCe={width:"var(--number-input-stepper-width)"};function aCe(e){return{borderStart:"1px solid",borderStartColor:Ae("inherit","whiteAlpha.300")(e),color:Ae("inherit","whiteAlpha.800")(e),_active:{bg:Ae("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var oCe=e=>({root:nCe,field:rCe,stepperGroup:iCe,stepper:aCe(e)});function l_(e){var t=hr.sizes[e],n={lg:"md",md:"md",sm:"sm",xs:"sm"},r=$V.fontSizes[t.field.fontSize];return{field:zD({},t.field,{paddingInlineEnd:"var(--number-input-field-padding)",verticalAlign:"top"}),stepper:{fontSize:"calc("+r+" * 0.75)",_first:{borderTopEndRadius:n[e]},_last:{borderBottomEndRadius:n[e],mt:"-1px",borderTopWidth:1}}}}var sCe={xs:l_("xs"),sm:l_("sm"),md:l_("md"),lg:l_("lg")},uCe={parts:QEe,baseStyle:oCe,sizes:sCe,variants:eCe,defaultProps:tCe};function jD(){return jD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jD.apply(this,arguments)}var lCe=jD({},hr.baseStyle.field,{textAlign:"center"}),cCe={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},fCe={outline:e=>hr.variants.outline(e).field,flushed:e=>hr.variants.flushed(e).field,filled:e=>hr.variants.filled(e).field,unstyled:hr.variants.unstyled.field},dCe=hr.defaultProps,hCe={baseStyle:lCe,sizes:cCe,variants:fCe,defaultProps:dCe},pCe=["popper","content","header","body","footer","arrow"],gCe={zIndex:10};function mCe(e){var t=Ae("white","gray.700")(e),n=Ae("gray.200","whiteAlpha.300")(e);return{"--popover-bg":"colors."+t,bg:"var(--popover-bg)","--popper-arrow-bg":"var(--popover-bg)","--popper-arrow-shadow-color":"colors."+n,width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focus:{outline:0,boxShadow:"outline"}}}var vCe={px:3,py:2,borderBottomWidth:"1px"},yCe={px:3,py:2},bCe={px:3,py:2,borderTopWidth:"1px"},xCe=e=>({popper:gCe,content:mCe(e),header:vCe,body:yCe,footer:bCe,arrow:{}}),wCe={parts:pCe,baseStyle:xCe};function c_(){return c_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c_.apply(this,arguments)}var _Ce=["track","filledTrack","label"];function SCe(e){var{colorScheme:t,theme:n,isIndeterminate:r,hasStripe:i}=e,a=Ae(DV(),DV("1rem","rgba(0,0,0,0.1)"))(e),o=Ae(t+".500",t+".200")(e),s=`linear-gradient(
    to right,
    transparent 0%,
    `+ni(n,o)+` 50%,
    transparent 100%
  )`,u=!r&&i;return c_({},u&&a,r?{bgImage:s}:{bgColor:o})}var ECe={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"};function CCe(e){return{bg:Ae("gray.100","whiteAlpha.300")(e)}}function ACe(e){return c_({transitionProperty:"common",transitionDuration:"slow"},SCe(e))}var kCe=e=>({label:ECe,filledTrack:ACe(e),track:CCe(e)}),TCe={xs:{track:{h:"0.25rem"}},sm:{track:{h:"0.5rem"}},md:{track:{h:"0.75rem"}},lg:{track:{h:"1rem"}}},OCe={size:"md",colorScheme:"blue"},ICe={parts:_Ce,sizes:TCe,baseStyle:kCe,defaultProps:OCe};function f_(){return f_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f_.apply(this,arguments)}var NCe=["container","control","label"];function DCe(e){var{control:t}=$D.baseStyle(e);return f_({},t,{borderRadius:"full",_checked:f_({},t._checked,{_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}})})}var RCe=e=>({label:$D.baseStyle(e).label,control:DCe(e)}),FCe={md:{control:{w:4,h:4},label:{fontSize:"md"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"}},sm:{control:{width:3,height:3},label:{fontSize:"sm"}}},MCe={size:"md",colorScheme:"blue"},PCe={parts:NCe,baseStyle:RCe,sizes:FCe,defaultProps:MCe};function UD(){return UD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UD.apply(this,arguments)}var $Ce=["field","icon"];function LCe(e){return UD({},hr.baseStyle.field,{appearance:"none",paddingBottom:"1px",lineHeight:"normal","> option, > optgroup":{bg:Ae("white","gray.700")(e)}})}var BCe={width:"1.5rem",height:"100%",insetEnd:"0.5rem",position:"relative",color:"currentColor",fontSize:"1.25rem",_disabled:{opacity:.5}},zCe=e=>({field:LCe(e),icon:BCe}),jCe=Ru({},hr.sizes,{xs:{icon:{insetEnd:"0.25rem"}}}),UCe={parts:$Ce,baseStyle:zCe,sizes:jCe,variants:hr.variants,defaultProps:hr.defaultProps},WCe=(e,t)=>qW({from:{borderColor:e,background:e},to:{borderColor:t,background:t}}),VCe=e=>{var t=Ae("gray.100","gray.800")(e),n=Ae("gray.400","gray.600")(e),{startColor:r=t,endColor:i=n,speed:a,theme:o}=e,s=ni(o,r),u=ni(o,i);return{opacity:.7,borderRadius:"2px",borderColor:s,background:u,animation:a+"s linear infinite alternate "+WCe(s,u)}},qCe={baseStyle:VCe},HCe=e=>({borderRadius:"md",fontWeight:"semibold",_focus:{boxShadow:"outline",padding:"1rem",position:"fixed",top:"1.5rem",insetStart:"1.5rem",bg:Ae("white","gray.700")(e)}}),GCe={baseStyle:HCe};function d_(){return d_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d_.apply(this,arguments)}var KCe=["container","thumb","track","filledTrack"];function XCe(e){return hy({orientation:e.orientation,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})}var YCe=e=>{var{orientation:t}=e;return d_({_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"}},hy({orientation:t,vertical:{h:"100%"},horizontal:{w:"100%"}}))};function ZCe(e){return{borderRadius:"sm",bg:Ae("gray.200","whiteAlpha.200")(e),_disabled:{bg:Ae("gray.300","whiteAlpha.300")(e)}}}function JCe(e){return d_({zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{bg:"gray.300"}},XCe(e))}function QCe(e){var{colorScheme:t}=e;return{bg:Ae(t+".500",t+".200")(e)}}var eAe=e=>({container:YCe(e),track:ZCe(e),thumb:JCe(e),filledTrack:QCe(e)});function tAe(e){return{thumb:{w:"16px",h:"16px"},track:hy({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function nAe(e){return{thumb:{w:"14px",h:"14px"},track:hy({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function rAe(e){return{thumb:{w:"10px",h:"10px"},track:hy({orientation:e.orientation,horizontal:{h:"2px"},vertical:{w:"2px"}})}}var iAe={lg:tAe,md:nAe,sm:rAe},aAe={size:"md",colorScheme:"blue"},oAe={parts:KCe,sizes:iAe,baseStyle:eAe,defaultProps:aAe},sAe={width:"var(--spinner-size)",height:"var(--spinner-size)"},uAe={xs:{"--spinner-size":"0.75rem"},sm:{"--spinner-size":"1rem"},md:{"--spinner-size":"1.5rem"},lg:{"--spinner-size":"2rem"},xl:{"--spinner-size":"3rem"}},lAe={size:"md"},cAe={baseStyle:sAe,sizes:uAe,defaultProps:lAe},fAe=["label","number","icon","helpText"],dAe={fontWeight:"medium"},hAe={opacity:.8,marginBottom:2},pAe={verticalAlign:"baseline",fontWeight:"semibold"},gAe={marginEnd:1,w:"14px",h:"14px",verticalAlign:"middle"},mAe={label:dAe,helpText:hAe,number:pAe,icon:gAe},vAe={md:{label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}}},yAe={size:"md"},bAe={parts:fAe,baseStyle:mAe,sizes:vAe,defaultProps:yAe},xAe=["container","track","thumb"];function wAe(e){var{colorScheme:t}=e;return{borderRadius:"full",p:"2px",width:"var(--slider-track-width)",height:"var(--slider-track-height)",transitionProperty:"common",transitionDuration:"fast",bg:Ae("gray.300","whiteAlpha.400")(e),_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{bg:Ae(t+".500",t+".200")(e)}}}var _Ae={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:"var(--slider-track-height)",height:"var(--slider-track-height)",_checked:{transform:"translateX(var(--slider-thumb-x))"}},SAe=e=>({container:{"--slider-track-diff":"calc(var(--slider-track-width) - var(--slider-track-height))","--slider-thumb-x":"var(--slider-track-diff)",_rtl:{"--slider-thumb-x":"calc(-1 * var(--slider-track-diff))"}},track:wAe(e),thumb:_Ae}),EAe={sm:{container:{"--slider-track-width":"1.375rem","--slider-track-height":"0.75rem"}},md:{container:{"--slider-track-width":"1.875rem","--slider-track-height":"1rem"}},lg:{container:{"--slider-track-width":"2.875rem","--slider-track-height":"1.5rem"}}},CAe={size:"md",colorScheme:"blue"},AAe={parts:xAe,baseStyle:SAe,sizes:EAe,defaultProps:CAe};function Qg(){return Qg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qg.apply(this,arguments)}var kAe=["table","thead","tbody","tr","th","td","caption"],TAe={table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}},h_={"&[data-is-numeric=true]":{textAlign:"end"}},OAe=e=>{var{colorScheme:t}=e;return{th:Qg({color:Ae("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},h_),td:Qg({borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},h_),caption:{color:Ae("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},IAe=e=>{var{colorScheme:t}=e;return{th:Qg({color:Ae("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},h_),td:Qg({borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},h_),caption:{color:Ae("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Ae(t+".100",t+".700")(e)},td:{background:Ae(t+".100",t+".700")(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},NAe={simple:OAe,striped:IAe,unstyled:{}},DAe={sm:{th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}},md:{th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}},lg:{th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}}},RAe={variant:"simple",size:"md",colorScheme:"gray"},FAe={parts:kAe,baseStyle:TAe,variants:NAe,sizes:DAe,defaultProps:RAe},MAe=["root","tablist","tab","tabpanels","tabpanel","indicator"];function PAe(e){var{orientation:t}=e;return{display:t==="vertical"?"flex":"block"}}function $Ae(e){var{isFitted:t}=e;return{flex:t?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focus:{zIndex:1,boxShadow:"outline"}}}function LAe(e){var{align:t="start",orientation:n}=e,r={end:"flex-end",center:"center",start:"flex-start"};return{justifyContent:r[t],flexDirection:n==="vertical"?"column":"row"}}var BAe={p:4},zAe=e=>({root:PAe(e),tab:$Ae(e),tablist:LAe(e),tabpanel:BAe}),jAe={sm:{tab:{py:1,px:4,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:4}}};function UAe(e){var{colorScheme:t,orientation:n}=e,r=n==="vertical",i=n==="vertical"?"borderStart":"borderBottom",a=r?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[a]:"-2px",_selected:{color:Ae(t+".600",t+".300")(e),borderColor:"currentColor"},_active:{bg:Ae("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}}function WAe(e){var{colorScheme:t}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",_selected:{color:Ae(t+".600",t+".300")(e),borderColor:"inherit",borderBottomColor:Ae("white","gray.800")(e)}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function VAe(e){var{colorScheme:t}=e;return{tab:{border:"1px solid",borderColor:"inherit",bg:Ae("gray.50","whiteAlpha.50")(e),mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{bg:Ae("#fff","gray.800")(e),color:Ae(t+".600",t+".300")(e),borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function qAe(e){var{colorScheme:t,theme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:ni(n,t+".700"),bg:ni(n,t+".100")}}}}function HAe(e){var{colorScheme:t}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:Ae("gray.600","inherit")(e),_selected:{color:Ae("#fff","gray.800")(e),bg:Ae(t+".600",t+".300")(e)}}}}var GAe={},KAe={line:UAe,enclosed:WAe,"enclosed-colored":VAe,"soft-rounded":qAe,"solid-rounded":HAe,unstyled:GAe},XAe={size:"md",variant:"line",colorScheme:"blue"},YAe={parts:MAe,baseStyle:zAe,sizes:jAe,variants:KAe,defaultProps:XAe},ZAe=["container","label","closeButton"],JAe={fontWeight:"medium",lineHeight:1.2,outline:0,_focus:{boxShadow:"outline"}},QAe={lineHeight:1.2},eke={fontSize:"18px",w:"1.25rem",h:"1.25rem",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"0.375rem",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focus:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},tke={container:JAe,label:QAe,closeButton:eke},nke={sm:{container:{minH:"1.25rem",minW:"1.25rem",fontSize:"xs",px:2,borderRadius:"md"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}},md:{container:{minH:"1.5rem",minW:"1.5rem",fontSize:"sm",borderRadius:"md",px:2}},lg:{container:{minH:8,minW:8,fontSize:"md",borderRadius:"md",px:3}}},rke={subtle:e=>({container:py.variants.subtle(e)}),solid:e=>({container:py.variants.solid(e)}),outline:e=>({container:py.variants.outline(e)})},ike={size:"md",variant:"subtle",colorScheme:"gray"},ake={parts:ZAe,variants:rke,baseStyle:tke,sizes:nke,defaultProps:ike};function WD(){return WD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WD.apply(this,arguments)}var oke=WD({},hr.baseStyle.field,{paddingY:"8px",minHeight:"80px",lineHeight:"short",verticalAlign:"top"}),ske={outline:e=>hr.variants.outline(e).field,flushed:e=>hr.variants.flushed(e).field,filled:e=>hr.variants.filled(e).field,unstyled:hr.variants.unstyled.field},uke={xs:hr.sizes.xs.field,sm:hr.sizes.sm.field,md:hr.sizes.md.field,lg:hr.sizes.lg.field},lke={size:"md",variant:"outline"},cke={baseStyle:oke,sizes:uke,variants:ske,defaultProps:lke};function fke(e){var t=Ae("gray.700","gray.300")(e);return{"--tooltip-bg":"colors."+t,px:"8px",py:"2px",bg:"var(--tooltip-bg)","--popper-arrow-bg":"var(--tooltip-bg)",color:Ae("whiteAlpha.900","gray.900")(e),borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"320px",zIndex:"tooltip"}}var dke={baseStyle:fke},hke=["text","icon"];function pke(e){return{color:Ae("red.500","red.300")(e),mt:2,fontSize:"sm"}}function gke(e){return{marginEnd:"0.5em",color:Ae("red.500","red.300")(e)}}var mke=e=>({text:pke(e),icon:gke(e)}),vke={parts:hke,baseStyle:mke},yke={Accordion:__e,Alert:L_e,Avatar:X_e,Badge:py,Breadcrumb:aSe,Button:gSe,Checkbox:$D,CloseButton:ASe,Code:ISe,Container:DSe,Divider:LSe,Drawer:sEe,Editable:dEe,Form:vEe,FormLabel:bEe,Heading:SEe,Input:hr,Kbd:FEe,Link:PEe,List:UEe,Menu:ZEe,Modal:PV,NumberInput:uCe,PinInput:hCe,Popover:wCe,Progress:ICe,Radio:PCe,Select:UCe,Skeleton:qCe,SkipLink:GCe,Slider:oAe,Spinner:cAe,Stat:bAe,Switch:AAe,Table:FAe,Tabs:YAe,Tag:ake,Textarea:cke,Tooltip:dke,FormError:vke},bke={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},xke=bke,wke=O_e({sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"}),_ke=wke,Ske={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},Eke=Ske,Cke={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},Ake=Cke,kke={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},Tke=kke,Oke={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},Ike={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},Nke={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},Dke={property:Oke,easing:Ike,duration:Nke},Rke=Dke,Fke={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},Mke=Fke,Pke={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},$ke=Pke;function VD(){return VD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VD.apply(this,arguments)}var Lke=VD({breakpoints:_ke,zIndices:Mke,radii:Ake,blur:$ke,colors:Eke},$V,{sizes:FV,shadows:Tke,space:RV,borders:xke,transition:Rke}),Bke=Lke,zke={global:e=>({body:{fontFamily:"body",color:Ae("gray.800","whiteAlpha.900")(e),bg:Ae("white","gray.800")(e),transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:Ae("gray.400","whiteAlpha.400")(e)},"*, *::before, &::after":{borderColor:Ae("gray.200","whiteAlpha.300")(e),wordWrap:"break-word"}})},jke=zke;function qD(){return qD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qD.apply(this,arguments)}var Uke="ltr",Wke={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},Vke=qD({direction:Uke},Bke,{components:yke,styles:jke,config:Wke}),qke=Vke,Hke={body:{classList:{add(){},remove(){}}},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}}},BV=Hke,em=()=>{},Gke={document:BV,navigator:{userAgent:""},CustomEvent:function(){return this},addEventListener:em,removeEventListener:em,getComputedStyle(){return{getPropertyValue(){return""}}},matchMedia(){return{matches:!1,addListener:em,removeListener:em}},requestAnimationFrame(e){return typeof setTimeout=="undefined"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout!="undefined"&&clearTimeout(e)},setTimeout:()=>0,clearTimeout:em,setInterval:()=>0,clearInterval:em},Kke=Gke,Xke={window:Kke,document:BV},zV=Vg?{window,document}:Xke,Yke=ha(zV);function Zke(e){var{children:t,environment:n}=e,[r,i]=an(null),a=xr(()=>{var s,u=r==null?void 0:r.ownerDocument,l=r==null?void 0:r.ownerDocument.defaultView,c=u?{document:u,window:l}:void 0,f=(s=n??c)!=null?s:zV;return f},[r,n]),o=!r&&!n;return zt.createElement(Yke.Provider,{value:a},t,o&&zt.createElement("span",{ref:s=>{s&&i(s)}}))}var Jke=e=>{var{children:t,colorModeManager:n,portalZIndex:r,resetCSS:i=!0,theme:a=qke,environment:o,cssVarsRoot:s}=e,u=ue(Zke,{environment:o},t);return ue(Dwe,null,ue(e_e,{theme:a,cssVarsRoot:s},ue(pV,{colorModeManager:n,options:a.config},i&&ue(qxe,null),ue(t_e,null),r?ue(aV,{zIndex:r},u):u)))};function gy(){return gy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gy.apply(this,arguments)}function Qke(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var jV={path:ue("g",{stroke:"currentColor",strokeWidth:"1.5"},ue("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),ue("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),ue("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})),viewBox:"0 0 24 24"},my=Mt((e,t)=>{var{as:n,viewBox:r,color:i="currentColor",focusable:a=!1,children:o,className:s,__css:u}=e,l=Qke(e,["as","viewBox","color","focusable","children","className","__css"]),c=Wn("chakra-icon",s),f=gy({w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i},u),d={ref:t,focusable:a,className:c,__css:f},h=r??jV.viewBox;if(n&&typeof n!="string")return ue(xt.svg,gy({as:n},d,l));var p=o??jV.path;return ue(xt.svg,gy({verticalAlign:"middle",viewBox:h},d,l),p)});function HD(){return HD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HD.apply(this,arguments)}function vy(e){var{viewBox:t="0 0 24 24",d:n,path:r,displayName:i,defaultProps:a={}}=e,o=Mt((s,u)=>ue(my,HD({ref:u,viewBox:t},a,s),r??ue("path",{fill:"currentColor",d:n})));return o}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var GD=function(e,t){return GD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},GD(e,t)};function UV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");GD(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ie=function(){return Ie=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ie.apply(this,arguments)};function ko(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function pr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function ma(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||t)}var Yl=function(e){return{isEnabled:function(t){return e.some(function(n){return!!t[n]})}}},KD={measureLayout:Yl(["layout","layoutId","drag","_layoutResetTransform"]),animation:Yl(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag"]),exit:Yl(["exit"]),drag:Yl(["drag","dragControls"]),focus:Yl(["whileFocus"]),hover:Yl(["whileHover","onHoverStart","onHoverEnd"]),tap:Yl(["whileTap","onTap","onTapStart","onTapCancel"]),pan:Yl(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),layoutAnimation:Yl(["layout","layoutId"])};function eTe(e){for(var t in e){var n=e[t];n!==null&&(KD[t].Component=n)}}var yy=function(){},WV=ha({strict:!1}),VV=Object.keys(KD),tTe=VV.length;function nTe(e,t,n){var r=[];if(Un(WV),!t)return null;for(var i=0;i<tTe;i++){var a=VV[i],o=KD[a],s=o.isEnabled,u=o.Component;s(e)&&u&&r.push(ue(u,Ie({key:a},e,{visualElement:t})))}return r}var p_=ha({transformPagePoint:function(e){return e},isStatic:!1}),g_=ha({});function rTe(){return Un(g_).visualElement}var by=ha(null);function xy(e){var t=Jt(null);return t.current===null&&(t.current=e()),t.current}function XD(){var e=Un(by);if(e===null)return[!0,null];var t=e.isPresent,n=e.onExitComplete,r=e.register,i=sTe();qt(function(){return r(i)},[]);var a=function(){return n==null?void 0:n(i)};return!t&&n?[!1,a]:[!0]}function iTe(e){return e===null?!0:e.isPresent}var aTe=0,oTe=function(){return aTe++},sTe=function(){return xy(oTe)},uTe=ha(null),wy=typeof window!="undefined",qV=wy?of:qt;function lTe(e){var t=e.layoutId,n=Un(uTe);return n&&t!==void 0?n+"-"+t:t}function cTe(e,t,n,r){var i=Un(p_),a=Un(WV),o=rTe(),s=Un(by),u=lTe(n),l=Jt(void 0);r||(r=a.renderer),!l.current&&r&&(l.current=r(e,{visualState:t,parent:o,props:Ie(Ie({},n),{layoutId:u}),presenceId:s==null?void 0:s.id,blockInitialAnimation:(s==null?void 0:s.initial)===!1}));var c=l.current;return qV(function(){!c||(c.setProps(Ie(Ie(Ie({},i),n),{layoutId:u})),c.isPresent=iTe(s),c.isPresenceRoot=!o||o.presenceId!==(s==null?void 0:s.id),c.syncRender())}),qt(function(){var f;!c||(f=c.animationState)===null||f===void 0||f.animateChanges()}),qV(function(){return function(){return c==null?void 0:c.notifyUnmount()}},[]),c}function YD(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function fTe(e,t,n){return st(function(r){var i;r&&((i=e.mount)===null||i===void 0||i.call(e,r)),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):YD(n)&&(n.current=r))},[t])}function HV(e){return Array.isArray(e)}function $s(e){return typeof e=="string"||HV(e)}function dTe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.get()}),t}function hTe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.getVelocity()}),t}function GV(e,t,n,r,i){var a;return r===void 0&&(r={}),i===void 0&&(i={}),typeof t=="string"&&(t=(a=e.variants)===null||a===void 0?void 0:a[t]),typeof t=="function"?t(n??e.custom,r,i):t}function m_(e,t,n){var r=e.getProps();return GV(r,t,n??r.custom,dTe(e),hTe(e))}function v_(e){var t;return typeof((t=e.animate)===null||t===void 0?void 0:t.start)=="function"||$s(e.initial)||$s(e.animate)||$s(e.whileHover)||$s(e.whileDrag)||$s(e.whileTap)||$s(e.whileFocus)||$s(e.exit)}function KV(e){return Boolean(v_(e)||e.variants)}function pTe(e,t){if(v_(e)){var n=e.initial,r=e.animate;return{initial:n===!1||$s(n)?n:void 0,animate:$s(r)?r:void 0}}return e.inherit!==!1?t:{}}function gTe(e,t){var n=pTe(e,Un(g_)),r=n.initial,i=n.animate;return xr(function(){return{initial:r,animate:i}},t?[XV(r),XV(i)]:[])}function XV(e){return Array.isArray(e)?e.join(" "):e}function mTe(e){var t=e.preloadedFeatures,n=e.createVisualElement,r=e.useRender,i=e.useVisualState,a=e.Component;t&&eTe(t);function o(s,u){var l=Un(p_).isStatic,c=null,f=gTe(s,l),d=i(s,l);return!l&&wy&&(f.visualElement=cTe(a,d,s,n),c=nTe(s,f.visualElement)),ue(Vi,null,ue(g_.Provider,{value:f},r(a,s,fTe(d,f.visualElement,u),d,l)),c)}return Gl(o)}function vTe(e){function t(r,i){return i===void 0&&(i={}),mTe(e(r,i))}var n=new Map;return new Proxy(t,{get:function(r,i){return n.has(i)||n.set(i,t(i)),n.get(i)}})}var yTe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function ZD(e){return typeof e!="string"||e.includes("-")?!1:!!(yTe.indexOf(e)>-1||/[A-Z]/.test(e))}var _y={};function bTe(e){for(var t in e)_y[t]=e[t]}var xTe=["","X","Y","Z"],wTe=["translate","scale","rotate","skew"],Sy=["transformPerspective","x","y","z"];wTe.forEach(function(e){return xTe.forEach(function(t){return Sy.push(e+t)})});function _Te(e,t){return Sy.indexOf(e)-Sy.indexOf(t)}var STe=new Set(Sy);function y_(e){return STe.has(e)}var ETe=new Set(["originX","originY","originZ"]);function YV(e){return ETe.has(e)}function ZV(e,t){var n=t.layout,r=t.layoutId;return y_(e)||YV(e)||(n||r!==void 0)&&(!!_y[e]||e==="opacity")}var mf=function(e){return e!==null&&typeof e=="object"&&e.getVelocity},CTe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function ATe(e,t,n,r){var i=e.transform,a=e.transformKeys,o=t.enableHardwareAcceleration,s=o===void 0?!0:o,u=t.allowTransformNone,l=u===void 0?!0:u,c="";a.sort(_Te);for(var f=!1,d=a.length,h=0;h<d;h++){var p=a[h];c+=(CTe[p]||p)+"("+i[p]+") ",p==="z"&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(i,n?"":c):l&&n&&(c="none"),c}function kTe(e){var t=e.originX,n=t===void 0?"50%":t,r=e.originY,i=r===void 0?"50%":r,a=e.originZ,o=a===void 0?0:a;return n+" "+i+" "+o}function JV(e){return e.startsWith("--")}var TTe=function(e,t){return t&&typeof e=="number"?t.transform(e):e},QV=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},Ey=function(e){return e%1?Number(e.toFixed(5)):e},Cy=/(-)?([\d]*\.?[\d])+/g,JD=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,OTe=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function Ay(e){return typeof e=="string"}var bh={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},ky=Ie(Ie({},bh),{transform:QV(0,1)}),b_=Ie(Ie({},bh),{default:1}),Ty=function(e){return{test:function(t){return Ay(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},vf=Ty("deg"),tm=Ty("%"),Tt=Ty("px"),ITe=Ty("vh"),NTe=Ty("vw"),eq=Ie(Ie({},tm),{parse:function(e){return tm.parse(e)/100},transform:function(e){return tm.transform(e*100)}}),QD=function(e,t){return function(n){return Boolean(Ay(n)&&OTe.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},tq=function(e,t,n){return function(r){var i;if(!Ay(r))return r;var a=r.match(Cy),o=a[0],s=a[1],u=a[2],l=a[3];return i={},i[e]=parseFloat(o),i[t]=parseFloat(s),i[n]=parseFloat(u),i.alpha=l!==void 0?parseFloat(l):1,i}},nm={test:QD("hsl","hue"),parse:tq("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,i=e.alpha,a=i===void 0?1:i;return"hsla("+Math.round(t)+", "+tm.transform(Ey(n))+", "+tm.transform(Ey(r))+", "+Ey(ky.transform(a))+")"}},DTe=QV(0,255),eR=Ie(Ie({},bh),{transform:function(e){return Math.round(DTe(e))}}),rm={test:QD("rgb","red"),parse:tq("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,i=e.alpha,a=i===void 0?1:i;return"rgba("+eR.transform(t)+", "+eR.transform(n)+", "+eR.transform(r)+", "+Ey(ky.transform(a))+")"}};function RTe(e){var t="",n="",r="",i="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),i=e.substr(4,1),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var tR={test:QD("#"),parse:RTe,transform:rm.transform},va={test:function(e){return rm.test(e)||tR.test(e)||nm.test(e)},parse:function(e){return rm.test(e)?rm.parse(e):nm.test(e)?nm.parse(e):tR.parse(e)},transform:function(e){return Ay(e)?e:e.hasOwnProperty("red")?rm.transform(e):nm.transform(e)}},nq="${c}",rq="${n}";function FTe(e){var t,n,r,i;return isNaN(e)&&Ay(e)&&((n=(t=e.match(Cy))===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+((i=(r=e.match(JD))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0}function iq(e){var t=[],n=0,r=e.match(JD);r&&(n=r.length,e=e.replace(JD,nq),t.push.apply(t,r.map(va.parse)));var i=e.match(Cy);return i&&(e=e.replace(Cy,rq),t.push.apply(t,i.map(bh.parse))),{values:t,numColors:n,tokenised:e}}function aq(e){return iq(e).values}function oq(e){var t=iq(e),n=t.values,r=t.numColors,i=t.tokenised,a=n.length;return function(o){for(var s=i,u=0;u<a;u++)s=s.replace(u<r?nq:rq,u<r?va.transform(o[u]):Ey(o[u]));return s}}var MTe=function(e){return typeof e=="number"?0:e};function PTe(e){var t=aq(e),n=oq(e);return n(t.map(MTe))}var Zl={test:FTe,parse:aq,createTransformer:oq,getAnimatableNone:PTe},$Te=new Set(["brightness","contrast","saturate","opacity"]);function LTe(e){var t=e.slice(0,-1).split("("),n=t[0],r=t[1];if(n==="drop-shadow")return e;var i=(r.match(Cy)||[])[0];if(!i)return e;var a=r.replace(i,""),o=$Te.has(n)?1:0;return i!==r&&(o*=100),n+"("+o+a+")"}var BTe=/([a-z-]*)\(.*?\)/g,nR=Ie(Ie({},Zl),{getAnimatableNone:function(e){var t=e.match(BTe);return t?t.map(LTe).join(" "):e}}),sq=Ie(Ie({},bh),{transform:Math.round}),uq={borderWidth:Tt,borderTopWidth:Tt,borderRightWidth:Tt,borderBottomWidth:Tt,borderLeftWidth:Tt,borderRadius:Tt,radius:Tt,borderTopLeftRadius:Tt,borderTopRightRadius:Tt,borderBottomRightRadius:Tt,borderBottomLeftRadius:Tt,width:Tt,maxWidth:Tt,height:Tt,maxHeight:Tt,size:Tt,top:Tt,right:Tt,bottom:Tt,left:Tt,padding:Tt,paddingTop:Tt,paddingRight:Tt,paddingBottom:Tt,paddingLeft:Tt,margin:Tt,marginTop:Tt,marginRight:Tt,marginBottom:Tt,marginLeft:Tt,rotate:vf,rotateX:vf,rotateY:vf,rotateZ:vf,scale:b_,scaleX:b_,scaleY:b_,scaleZ:b_,skew:vf,skewX:vf,skewY:vf,distance:Tt,translateX:Tt,translateY:Tt,translateZ:Tt,x:Tt,y:Tt,z:Tt,perspective:Tt,transformPerspective:Tt,opacity:ky,originX:eq,originY:eq,originZ:Tt,zIndex:sq,fillOpacity:ky,strokeOpacity:ky,numOctaves:sq};function rR(e,t,n,r,i,a,o,s){var u,l=e.style,c=e.vars,f=e.transform,d=e.transformKeys,h=e.transformOrigin;d.length=0;var p=!1,g=!1,m=!0;for(var v in t){var y=t[v];if(JV(v)){c[v]=y;continue}var b=uq[v],x=TTe(y,b);if(y_(v)){if(p=!0,f[v]=x,d.push(v),!m)continue;y!==((u=b.default)!==null&&u!==void 0?u:0)&&(m=!1)}else if(YV(v))h[v]=x,g=!0;else if((n==null?void 0:n.isHydrated)&&(r==null?void 0:r.isHydrated)&&_y[v]){var w=_y[v].process(y,r,n),S=_y[v].applyTo;if(S)for(var C=S.length,_=0;_<C;_++)l[S[_]]=w;else l[v]=w}else l[v]=x}r&&n&&o&&s?(l.transform=o(r.deltaFinal,r.treeScale,p?f:void 0),a&&(l.transform=a(f,l.transform)),l.transformOrigin=s(r)):(p&&(l.transform=ATe(e,i,m,a)),g&&(l.transformOrigin=kTe(h)))}var iR=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function lq(e,t,n){for(var r in t)!mf(t[r])&&!ZV(r,n)&&(e[r]=t[r])}function zTe(e,t,n){var r=e.transformTemplate;return xr(function(){var i=iR();rR(i,t,void 0,void 0,{enableHardwareAcceleration:!n},r);var a=i.vars,o=i.style;return Ie(Ie({},a),o)},[t])}function jTe(e,t,n){var r=e.style||{},i={};return lq(i,r,e),Object.assign(i,zTe(e,t,n)),e.transformValues&&(i=e.transformValues(i)),i}function UTe(e,t,n){var r={},i=jTe(e,t,n);return Boolean(e.drag)&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":"pan-"+(e.drag==="x"?"y":"x")),r.style=i,r}var WTe=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","_layoutResetTransform","onLayoutAnimationComplete","onViewportBoxUpdate","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover"]);function x_(e){return WTe.has(e)}var cq=function(e){return!x_(e)};try{var VTe=require("@emotion/is-prop-valid").default;cq=function(e){return e.startsWith("on")?!x_(e):VTe(e)}}catch(e){}function qTe(e,t,n){var r={};for(var i in e)(cq(i)||n===!0&&x_(i)||!t&&!x_(i))&&(r[i]=e[i]);return r}function fq(e,t,n){return typeof e=="string"?e:Tt.transform(t+n*e)}function HTe(e,t,n){var r=fq(t,e.x,e.width),i=fq(n,e.y,e.height);return r+" "+i}var aR=function(e,t){return Tt.transform(e*t)},GTe={offset:"stroke-dashoffset",array:"stroke-dasharray"},KTe={offset:"strokeDashoffset",array:"strokeDasharray"};function XTe(e,t,n,r,i,a){r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=!0);var o=a?GTe:KTe;e[o.offset]=aR(-i,t);var s=aR(n,t),u=aR(r,t);e[o.array]=s+" "+u}function oR(e,t,n,r,i,a,o,s){var u=t.attrX,l=t.attrY,c=t.originX,f=t.originY,d=t.pathLength,h=t.pathSpacing,p=h===void 0?1:h,g=t.pathOffset,m=g===void 0?0:g,v=ko(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);rR(e,v,n,r,i,a,o,s),e.attrs=e.style,e.style={};var y=e.attrs,b=e.style,x=e.dimensions,w=e.totalPathLength;y.transform&&(x&&(b.transform=y.transform),delete y.transform),x&&(c!==void 0||f!==void 0||b.transform)&&(b.transformOrigin=HTe(x,c!==void 0?c:.5,f!==void 0?f:.5)),u!==void 0&&(y.x=u),l!==void 0&&(y.y=l),w!==void 0&&d!==void 0&&XTe(y,w,d,p,m,!1)}var dq=function(){return Ie(Ie({},iR()),{attrs:{}})};function YTe(e,t){var n=xr(function(){var i=dq();return oR(i,t,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Ie(Ie({},i.attrs),{style:Ie({},i.style)})},[t]);if(e.style){var r={};lq(r,e.style,e),n.style=Ie(Ie({},r),n.style)}return n}function ZTe(e){e===void 0&&(e=!1);var t=function(n,r,i,a,o){var s=a.latestValues,u=ZD(n)?YTe:UTe,l=u(r,s,o),c=qTe(r,typeof n=="string",e),f=Ie(Ie(Ie({},c),l),{ref:i});return ue(n,f)};return t}var JTe=/([a-z])([A-Z])/g,QTe="$1-$2",hq=function(e){return e.replace(JTe,QTe).toLowerCase()};function pq(e,t){var n=t.style,r=t.vars;Object.assign(e.style,n);for(var i in r)e.style.setProperty(i,r[i])}var gq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform"]);function mq(e,t){pq(e,t);for(var n in t.attrs)e.setAttribute(gq.has(n)?n:hq(n),t.attrs[n])}function sR(e){var t=e.style,n={};for(var r in t)(mf(t[r])||ZV(r,e))&&(n[r]=t[r]);return n}function vq(e){var t=sR(e);for(var n in e)if(mf(e[n])){var r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;t[r]=e[n]}return t}function uR(e){return typeof e=="object"&&typeof e.start=="function"}var Oy=function(e){return Array.isArray(e)},eOe=function(e){return Boolean(e&&typeof e=="object"&&e.mix&&e.toValue)},tOe=function(e){return Oy(e)?e[e.length-1]||0:e};function nOe(e){var t=mf(e)?e.get():e;return eOe(t)?t.toValue():t}function yq(e,t,n,r){var i=e.scrapeMotionValuesFromProps,a=e.createRenderState,o=e.onMount,s={latestValues:rOe(t,n,r,i),renderState:a()};return o&&(s.mount=function(u){return o(t,u,s)}),s}var bq=function(e){return function(t,n){var r=Un(g_),i=Un(by);return n?yq(e,t,r,i):xy(function(){return yq(e,t,r,i)})}};function rOe(e,t,n,r){var i={},a=(n==null?void 0:n.initial)===!1,o=r(e);for(var s in o)i[s]=nOe(o[s]);var u=e.initial,l=e.animate,c=v_(e),f=KV(e);t&&f&&!c&&e.inherit!==!1&&(u??(u=t.initial),l??(l=t.animate));var d=a||u===!1?l:u;if(d&&typeof d!="boolean"&&!uR(d)){var h=Array.isArray(d)?d:[d];h.forEach(function(p){var g=GV(e,p);if(!!g){var m=g.transitionEnd;g.transition;var v=ko(g,["transitionEnd","transition"]);for(var y in v)i[y]=v[y];for(var y in m)i[y]=m[y]}})}return i}var iOe={useVisualState:bq({scrapeMotionValuesFromProps:vq,createRenderState:dq,onMount:function(e,t,n){var r=n.renderState,i=n.latestValues;try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch(a){r.dimensions={x:0,y:0,width:0,height:0}}aOe(t)&&(r.totalPathLength=t.getTotalLength()),oR(r,i,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),mq(t,r)}})};function aOe(e){return e.tagName==="path"}var oOe={useVisualState:bq({scrapeMotionValuesFromProps:sR,createRenderState:iR})};function sOe(e,t,n,r){var i=t.forwardMotionProps,a=i===void 0?!1:i,o=ZD(e)?iOe:oOe;return Ie(Ie({},o),{preloadedFeatures:n,useRender:ZTe(a),createVisualElement:r,Component:e})}var _r;(function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.Exit="exit"})(_r||(_r={}));function lR(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function cR(e,t,n,r){qt(function(){var i=e.current;if(n&&i)return lR(i,t,n,r)},[e,t,n,r])}function uOe(e){var t=e.whileFocus,n=e.visualElement,r=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(_r.Focus,!0)},i=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(_r.Focus,!1)};cR(n,"focus",t?r:void 0),cR(n,"blur",t?i:void 0)}function xq(e){return typeof PointerEvent!="undefined"&&e instanceof PointerEvent?e.pointerType==="mouse":e instanceof MouseEvent}function wq(e){var t=!!e.touches;return t}function lOe(e){return function(t){var n=t instanceof MouseEvent,r=!n||n&&t.button===0;r&&e(t)}}var cOe={pageX:0,pageY:0};function fOe(e,t){t===void 0&&(t="page");var n=e.touches[0]||e.changedTouches[0],r=n||cOe;return{x:r[t+"X"],y:r[t+"Y"]}}function dOe(e,t){return t===void 0&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function fR(e,t){return t===void 0&&(t="page"),{point:wq(e)?fOe(e,t):dOe(e,t)}}function hOe(e){return fR(e,"client")}var _q=function(e,t){t===void 0&&(t=!1);var n=function(r){return e(r,fR(r))};return t?lOe(n):n},pOe=function(){return wy&&window.onpointerdown===null},gOe=function(){return wy&&window.ontouchstart===null},mOe=function(){return wy&&window.onmousedown===null},vOe={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},yOe={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function Sq(e){return pOe()?e:gOe()?yOe[e]:mOe()?vOe[e]:e}function im(e,t,n,r){return lR(e,Sq(t),_q(n,t==="pointerdown"),r)}function w_(e,t,n,r){return cR(e,Sq(t),n&&_q(n,t==="pointerdown"),r)}function Eq(e){var t=null;return function(){var n=function(){t=null};return t===null?(t=e,n):!1}}var Cq=Eq("dragHorizontal"),Aq=Eq("dragVertical");function kq(e){var t=!1;if(e==="y")t=Aq();else if(e==="x")t=Cq();else{var n=Cq(),r=Aq();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function Tq(){var e=kq(!0);return e?(e(),!1):!0}function Oq(e,t,n){return function(r,i){var a;!xq(r)||Tq()||(n==null||n(r,i),(a=e.animationState)===null||a===void 0||a.setActive(_r.Hover,t))}}function bOe(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,i=e.visualElement;w_(i,"pointerenter",t||r?Oq(i,!0,t):void 0),w_(i,"pointerleave",n||r?Oq(i,!1,n):void 0)}var Iq=function(e,t){return t?e===t?!0:Iq(e,t.parentElement):!1};function dR(e){return qt(function(){return function(){return e()}},[])}var __=function(e,t,n){return Math.min(Math.max(n,e),t)},hR=.001,xOe=.01,wOe=10,_Oe=.05,SOe=1;function EOe(e){var t=e.duration,n=t===void 0?800:t,r=e.bounce,i=r===void 0?.25:r,a=e.velocity,o=a===void 0?0:a,s=e.mass,u=s===void 0?1:s,l,c,f=1-i;f=__(_Oe,SOe,f),n=__(xOe,wOe,n/1e3),f<1?(l=function(g){var m=g*f,v=m*n,y=m-o,b=pR(g,f),x=Math.exp(-v);return hR-y/b*x},c=function(g){var m=g*f,v=m*n,y=v*o+o,b=Math.pow(f,2)*Math.pow(g,2)*n,x=Math.exp(-v),w=pR(Math.pow(g,2),f),S=-l(g)+hR>0?-1:1;return S*((y-b)*x)/w}):(l=function(g){var m=Math.exp(-g*n),v=(g-o)*n+1;return-hR+m*v},c=function(g){var m=Math.exp(-g*n),v=(o-g)*(n*n);return m*v});var d=5/n,h=AOe(l,c,d);if(n=n*1e3,isNaN(h))return{stiffness:100,damping:10,duration:n};var p=Math.pow(h,2)*u;return{stiffness:p,damping:f*2*Math.sqrt(u*p),duration:n}}var COe=12;function AOe(e,t,n){for(var r=n,i=1;i<COe;i++)r=r-e(r)/t(r);return r}function pR(e,t){return e*Math.sqrt(1-t*t)}var kOe=["duration","bounce"],TOe=["stiffness","damping","mass"];function Nq(e,t){return t.some(function(n){return e[n]!==void 0})}function OOe(e){var t=Ie({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!Nq(e,TOe)&&Nq(e,kOe)){var n=EOe(e);t=Ie(Ie(Ie({},t),n),{velocity:0,mass:1}),t.isResolvedFromDuration=!0}return t}function gR(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.restSpeed,o=a===void 0?2:a,s=e.restDelta,u=ko(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=OOe(u),f=c.stiffness,d=c.damping,h=c.mass,p=c.velocity,g=c.duration,m=c.isResolvedFromDuration,v=Dq,y=Dq;function b(){var x=p?-(p/1e3):0,w=i-n,S=d/(2*Math.sqrt(f*h)),C=Math.sqrt(f/h)/1e3;if(s??(s=Math.abs(i-n)<=1?.01:.4),S<1){var _=pR(C,S);v=function(A){var k=Math.exp(-S*C*A);return i-k*((x+S*C*w)/_*Math.sin(_*A)+w*Math.cos(_*A))},y=function(A){var k=Math.exp(-S*C*A);return S*C*k*(Math.sin(_*A)*(x+S*C*w)/_+w*Math.cos(_*A))-k*(Math.cos(_*A)*(x+S*C*w)-_*w*Math.sin(_*A))}}else if(S===1)v=function(A){return i-Math.exp(-C*A)*(w+(x+C*w)*A)};else{var E=C*Math.sqrt(S*S-1);v=function(A){var k=Math.exp(-S*C*A),T=Math.min(E*A,300);return i-k*((x+S*C*w)*Math.sinh(T)+E*w*Math.cosh(T))/E}}}return b(),{next:function(x){var w=v(x);if(m)l.done=x>=g;else{var S=y(x)*1e3,C=Math.abs(S)<=o,_=Math.abs(i-w)<=s;l.done=C&&_}return l.value=l.done?i:w,l},flipTarget:function(){var x;p=-p,x=[i,n],n=x[0],i=x[1],b()}}}gR.needsInterpolation=function(e,t){return typeof e=="string"||typeof t=="string"};var Dq=function(e){return 0},Iy=function(e,t,n){var r=t-e;return r===0?1:(n-e)/r},Ya=function(e,t,n){return-n*e+n*t+e},IOe=function(e,t,n){var r=e*e,i=t*t;return Math.sqrt(Math.max(0,n*(i-r)+r))},NOe=[tR,rm,nm],Rq=function(e){return NOe.find(function(t){return t.test(e)})},Fq=function(e,t){var n=Rq(e),r=Rq(t);yy(n.transform===r.transform);var i=n.parse(e),a=r.parse(t),o=Ie({},i),s=n===nm?Ya:IOe;return function(u){for(var l in o)l!=="alpha"&&(o[l]=s(i[l],a[l],u));return o.alpha=Ya(i.alpha,a.alpha,u),n.transform(o)}},mR=function(e){return typeof e=="number"},DOe=function(e,t){return function(n){return t(e(n))}},Ny=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(DOe)};function Mq(e,t){return mR(e)?function(n){return Ya(e,t,n)}:va.test(e)?Fq(e,t):Lq(e,t)}var Pq=function(e,t){var n=ma([],e),r=n.length,i=e.map(function(a,o){return Mq(a,t[o])});return function(a){for(var o=0;o<r;o++)n[o]=i[o](a);return n}},ROe=function(e,t){var n=Ie(Ie({},e),t),r={};for(var i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=Mq(e[i],t[i]));return function(a){for(var o in r)n[o]=r[o](a);return n}};function $q(e){for(var t=Zl.parse(e),n=t.length,r=0,i=0,a=0,o=0;o<n;o++)r||typeof t[o]=="number"?r++:t[o].hue!==void 0?a++:i++;return{parsed:t,numNumbers:r,numRGB:i,numHSL:a}}var Lq=function(e,t){var n=Zl.createTransformer(t),r=$q(e),i=$q(t);return Ny(Pq(r.parsed,i.parsed),n)},FOe=function(e,t){return function(n){return Ya(e,t,n)}};function MOe(e){if(typeof e=="number")return FOe;if(typeof e=="string")return va.test(e)?Fq:Lq;if(Array.isArray(e))return Pq;if(typeof e=="object")return ROe}function POe(e,t,n){for(var r=[],i=n||MOe(e[0]),a=e.length-1,o=0;o<a;o++){var s=i(e[o],e[o+1]);if(t){var u=Array.isArray(t)?t[o]:t;s=Ny(u,s)}r.push(s)}return r}function $Oe(e,t){var n=e[0],r=e[1],i=t[0];return function(a){return i(Iy(n,r,a))}}function LOe(e,t){var n=e.length,r=n-1;return function(i){var a=0,o=!1;if(i<=e[0]?o=!0:i>=e[r]&&(a=r-1,o=!0),!o){for(var s=1;s<n&&!(e[s]>i||s===r);s++);a=s-1}var u=Iy(e[a],e[a+1],i);return t[a](u)}}function Bq(e,t,n){var r=n===void 0?{}:n,i=r.clamp,a=i===void 0?!0:i,o=r.ease,s=r.mixer,u=e.length;yy(u===t.length),yy(!o||!Array.isArray(o)||o.length===u-1),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var l=POe(t,o,s),c=u===2?$Oe(e,l):LOe(e,l);return a?function(f){return c(__(e[0],e[u-1],f))}:c}var S_=function(e){return function(t){return 1-e(1-t)}},vR=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},BOe=function(e){return function(t){return Math.pow(t,e)}},zq=function(e){return function(t){return t*t*((e+1)*t-e)}},zOe=function(e){var t=zq(e);return function(n){return(n*=2)<1?.5*t(n):.5*(2-Math.pow(2,-10*(n-1)))}},jq=1.525,jOe=4/11,UOe=8/11,WOe=9/10,Uq=function(e){return e},yR=BOe(2),VOe=S_(yR),Wq=vR(yR),Vq=function(e){return 1-Math.sin(Math.acos(e))},qq=S_(Vq),qOe=vR(qq),bR=zq(jq),HOe=S_(bR),GOe=vR(bR),KOe=zOe(jq),XOe=4356/361,YOe=35442/1805,ZOe=16061/1805,E_=function(e){if(e===1||e===0)return e;var t=e*e;return e<jOe?7.5625*t:e<UOe?9.075*t-9.9*e+3.4:e<WOe?XOe*t-YOe*e+ZOe:10.8*e*e-20.52*e+10.72},JOe=S_(E_),QOe=function(e){return e<.5?.5*(1-E_(1-e*2)):.5*E_(e*2-1)+.5};function eIe(e,t){return e.map(function(){return t||Wq}).splice(0,e.length-1)}function tIe(e){var t=e.length;return e.map(function(n,r){return r!==0?r/(t-1):0})}function nIe(e,t){return e.map(function(n){return n*t})}function C_(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.ease,o=e.offset,s=e.duration,u=s===void 0?300:s,l={done:!1,value:n},c=Array.isArray(i)?i:[n,i],f=nIe(o&&o.length===c.length?o:tIe(c),u);function d(){return Bq(f,c,{ease:Array.isArray(a)?a:eIe(c,a)})}var h=d();return{next:function(p){return l.value=h(p),l.done=p>=u,l},flipTarget:function(){c.reverse(),h=d()}}}function rIe(e){var t=e.velocity,n=t===void 0?0:t,r=e.from,i=r===void 0?0:r,a=e.power,o=a===void 0?.8:a,s=e.timeConstant,u=s===void 0?350:s,l=e.restDelta,c=l===void 0?.5:l,f=e.modifyTarget,d={done:!1,value:i},h=o*n,p=i+h,g=f===void 0?p:f(p);return g!==p&&(h=g-i),{next:function(m){var v=-h*Math.exp(-m/u);return d.done=!(v>c||v<-c),d.value=d.done?g:g+v,d},flipTarget:function(){}}}var Hq={keyframes:C_,spring:gR,decay:rIe};function iIe(e){if(Array.isArray(e.to))return C_;if(Hq[e.type])return Hq[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?C_:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?gR:C_}function Gq(e,t,n){return n===void 0&&(n=0),e-t-n}function aIe(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=!0),r?Gq(t+-e,t,n):t-(e-t)+n}function oIe(e,t,n,r){return r?e>=t+n:e<=-n}var sIe=function(e){var t=function(n){var r=n.delta;return e(r)};return{start:function(){return Fu.update(t,!0)},stop:function(){return oy.update(t)}}};function Kq(e){var t,n,r=e.from,i=e.autoplay,a=i===void 0?!0:i,o=e.driver,s=o===void 0?sIe:o,u=e.elapsed,l=u===void 0?0:u,c=e.repeat,f=c===void 0?0:c,d=e.repeatType,h=d===void 0?"loop":d,p=e.repeatDelay,g=p===void 0?0:p,m=e.onPlay,v=e.onStop,y=e.onComplete,b=e.onRepeat,x=e.onUpdate,w=ko(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),S=w.to,C,_=0,E=w.duration,A,k=!1,T=!0,I,N=iIe(w);((n=(t=N).needsInterpolation)===null||n===void 0?void 0:n.call(t,r,S))&&(I=Bq([0,100],[r,S],{clamp:!1}),r=0,S=100);var O=N(Ie(Ie({},w),{from:r,to:S}));function D(){_++,h==="reverse"?(T=_%2==0,l=aIe(l,E,g,T)):(l=Gq(l,E,g),h==="mirror"&&O.flipTarget()),k=!1,b&&b()}function L(){C.stop(),y&&y()}function W(K){if(T||(K=-K),l+=K,!k){var ee=O.next(Math.max(0,l));A=ee.value,I&&(A=I(A)),k=T?ee.done:l<=0}x==null||x(A),k&&(_===0&&(E??(E=l)),_<f?oIe(l,E,g,T)&&D():L())}function G(){m==null||m(),C=s(W),C.start()}return a&&G(),{stop:function(){v==null||v(),C.stop()}}}function Xq(e,t){return t?e*(1e3/t):0}function uIe(e){var t=e.from,n=t===void 0?0:t,r=e.velocity,i=r===void 0?0:r,a=e.min,o=e.max,s=e.power,u=s===void 0?.8:s,l=e.timeConstant,c=l===void 0?750:l,f=e.bounceStiffness,d=f===void 0?500:f,h=e.bounceDamping,p=h===void 0?10:h,g=e.restDelta,m=g===void 0?1:g,v=e.modifyTarget,y=e.driver,b=e.onUpdate,x=e.onComplete,w;function S(D){return a!==void 0&&D<a||o!==void 0&&D>o}function C(D){return a===void 0?o:o===void 0||Math.abs(a-D)<Math.abs(o-D)?a:o}function _(D){w==null||w.stop(),w=Kq(Ie(Ie({},D),{driver:y,onUpdate:function(L){var W;b==null||b(L),(W=D.onUpdate)===null||W===void 0||W.call(D,L)},onComplete:x}))}function E(D){_(Ie({type:"spring",stiffness:d,damping:p,restDelta:m},D))}if(S(n))E({from:n,velocity:i,to:C(n)});else{var A=u*i+n;typeof v!="undefined"&&(A=v(A));var k=C(A),T=k===a?-1:1,I,N,O=function(D){I=N,N=D,i=Xq(D-I,e_().delta),(T===1&&D>k||T===-1&&D<k)&&E({from:D,to:k,velocity:i})};_({type:"decay",from:n,velocity:i,timeConstant:c,power:u,restDelta:m,modifyTarget:v,onUpdate:S(A)?O:void 0})}return{stop:function(){return w==null?void 0:w.stop()}}}var xR=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},Yq=function(e){return xR(e)&&e.hasOwnProperty("z")},A_=function(e,t){return Math.abs(e-t)};function Zq(e,t){if(mR(e)&&mR(t))return A_(e,t);if(xR(e)&&xR(t)){var n=A_(e.x,t.x),r=A_(e.y,t.y),i=Yq(e)&&Yq(t)?A_(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}}var Jq=function(e,t){return 1-3*t+3*e},Qq=function(e,t){return 3*t-6*e},eH=function(e){return 3*e},k_=function(e,t,n){return((Jq(t,n)*e+Qq(t,n))*e+eH(t))*e},tH=function(e,t,n){return 3*Jq(t,n)*e*e+2*Qq(t,n)*e+eH(t)},lIe=1e-7,cIe=10;function fIe(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=k_(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>lIe&&++s<cIe);return o}var dIe=8,hIe=.001;function pIe(e,t,n,r){for(var i=0;i<dIe;++i){var a=tH(t,n,r);if(a===0)return t;var o=k_(t,n,r)-e;t-=o/a}return t}var T_=11,O_=1/(T_-1);function gIe(e,t,n,r){if(e===t&&n===r)return Uq;for(var i=new Float32Array(T_),a=0;a<T_;++a)i[a]=k_(a*O_,e,n);function o(s){for(var u=0,l=1,c=T_-1;l!==c&&i[l]<=s;++l)u+=O_;--l;var f=(s-i[l])/(i[l+1]-i[l]),d=u+f*O_,h=tH(d,e,n);return h>=hIe?pIe(s,d,e,n):h===0?d:fIe(s,u,u+O_,e,n)}return function(s){return s===0||s===1?s:k_(o(s),t,r)}}function mIe(e){var t=e.onTap,n=e.onTapStart,r=e.onTapCancel,i=e.whileTap,a=e.visualElement,o=t||n||r||i,s=Jt(!1),u=Jt(null);function l(){var p;(p=u.current)===null||p===void 0||p.call(u),u.current=null}function c(){var p;return l(),s.current=!1,(p=a.animationState)===null||p===void 0||p.setActive(_r.Tap,!1),!Tq()}function f(p,g){!c()||(Iq(a.getInstance(),p.target)?t==null||t(p,g):r==null||r(p,g))}function d(p,g){!c()||r==null||r(p,g)}function h(p,g){var m;l(),!s.current&&(s.current=!0,u.current=Ny(im(window,"pointerup",f),im(window,"pointercancel",d)),n==null||n(p,g),(m=a.animationState)===null||m===void 0||m.setActive(_r.Tap,!0))}w_(a,"pointerdown",o?h:void 0),dR(l)}var xh=function(e){return function(t){return e(t),null}},vIe={tap:xh(mIe),focus:xh(uOe),hover:xh(bOe)};function nH(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var I_=function(e){return e*1e3},yIe={linear:Uq,easeIn:yR,easeInOut:Wq,easeOut:VOe,circIn:Vq,circInOut:qOe,circOut:qq,backIn:bR,backInOut:GOe,backOut:HOe,anticipate:KOe,bounceIn:JOe,bounceInOut:QOe,bounceOut:E_},rH=function(e){if(Array.isArray(e)){yy(e.length===4);var t=pr(e,4),n=t[0],r=t[1],i=t[2],a=t[3];return gIe(n,r,i,a)}else if(typeof e=="string")return yIe[e];return e},bIe=function(e){return Array.isArray(e)&&typeof e[0]!="number"},iH=function(e,t){return e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&Zl.test(t)&&!t.startsWith("url("))},wh=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},N_=function(e){return{type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restDelta:.01,restSpeed:10}},wR=function(){return{type:"keyframes",ease:"linear",duration:.3}},xIe=function(e){return{type:"keyframes",duration:.8,values:e}},aH={x:wh,y:wh,z:wh,rotate:wh,rotateX:wh,rotateY:wh,rotateZ:wh,scaleX:N_,scaleY:N_,scale:N_,opacity:wR,backgroundColor:wR,color:wR,default:N_},wIe=function(e,t){var n;return Oy(t)?n=xIe:n=aH[e]||aH.default,Ie({to:t},n(t))},_Ie=Ie(Ie({},uq),{color:va,backgroundColor:va,outlineColor:va,fill:va,stroke:va,borderColor:va,borderTopColor:va,borderRightColor:va,borderBottomColor:va,borderLeftColor:va,filter:nR,WebkitFilter:nR}),_R=function(e){return _Ie[e]};function SR(e,t){var n,r=_R(e);return r!==nR&&(r=Zl),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,t)}function SIe(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=ko(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}function EIe(e){var t=e.ease,n=e.times,r=e.yoyo,i=e.flip,a=e.loop,o=ko(e,["ease","times","yoyo","flip","loop"]),s=Ie({},o);return n&&(s.offset=n),o.duration&&(s.duration=I_(o.duration)),o.repeatDelay&&(s.repeatDelay=I_(o.repeatDelay)),t&&(s.ease=bIe(t)?t.map(rH):rH(t)),o.type==="tween"&&(s.type="keyframes"),(r||a||i)&&(r?s.repeatType="reverse":a?s.repeatType="loop":i&&(s.repeatType="mirror"),s.repeat=a||r||i||o.repeat),o.type!=="spring"&&(s.type="keyframes"),s}function CIe(e,t){var n,r=ER(e,t)||{};return(n=r.delay)!==null&&n!==void 0?n:0}function AIe(e){return Array.isArray(e.to)&&e.to[0]===null&&(e.to=ma([],pr(e.to)),e.to[0]=e.from),e}function kIe(e,t,n){var r;return Array.isArray(t.to)&&((r=e.duration)!==null&&r!==void 0||(e.duration=.8)),AIe(t),SIe(e)||(e=Ie(Ie({},e),wIe(n,t.to))),Ie(Ie({},t),EIe(e))}function TIe(e,t,n,r,i){var a,o=ER(r,e),s=(a=o.from)!==null&&a!==void 0?a:t.get(),u=iH(e,n);s==="none"&&u&&typeof n=="string"?s=SR(e,n):oH(s)&&typeof n=="string"?s=sH(n):!Array.isArray(n)&&oH(n)&&typeof s=="string"&&(n=sH(s));var l=iH(e,s);function c(){var d={from:s,to:n,velocity:t.getVelocity(),onComplete:i,onUpdate:function(h){return t.set(h)}};return o.type==="inertia"||o.type==="decay"?uIe(Ie(Ie({},d),o)):Kq(Ie(Ie({},kIe(o,d,e)),{onUpdate:function(h){var p;d.onUpdate(h),(p=o.onUpdate)===null||p===void 0||p.call(o,h)},onComplete:function(){var h;d.onComplete(),(h=o.onComplete)===null||h===void 0||h.call(o)}}))}function f(){var d;return t.set(n),i(),(d=o==null?void 0:o.onComplete)===null||d===void 0||d.call(o),{stop:function(){}}}return!l||!u||o.type===!1?f:c}function oH(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function sH(e){return typeof e=="number"?0:SR("",e)}function ER(e,t){return e[t]||e.default||e}function D_(e,t,n,r){return r===void 0&&(r={}),t.start(function(i){var a,o,s=TIe(e,t,n,r,i),u=CIe(r,e),l=function(){return o=s()};return u?a=setTimeout(l,I_(u)):l(),function(){clearTimeout(a),o==null||o.stop()}})}var OIe=function(e){return/^\-?\d*\.?\d+$/.test(e)};function uH(e,t){e.indexOf(t)===-1&&e.push(t)}function lH(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var R_=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(t){var n=this;return uH(this.subscriptions,t),function(){return lH(n.subscriptions,t)}},e.prototype.notify=function(t,n,r){var i=this.subscriptions.length;if(!!i)if(i===1)this.subscriptions[0](t,n,r);else for(var a=0;a<i;a++){var o=this.subscriptions[a];o&&o(t,n,r)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),IIe=function(e){return!isNaN(parseFloat(e))},NIe=function(){function e(t){var n=this;this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new R_,this.velocityUpdateSubscribers=new R_,this.renderSubscribers=new R_,this.canTrackVelocity=!1,this.updateAndNotify=function(r,i){i===void 0&&(i=!0),n.prev=n.current,n.current=r;var a=e_(),o=a.delta,s=a.timestamp;n.lastUpdated!==s&&(n.timeDelta=o,n.lastUpdated=s,Fu.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),i&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Fu.postRender(n.velocityCheck)},this.velocityCheck=function(r){var i=r.timestamp;i!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=IIe(this.current)}return e.prototype.onChange=function(t){return this.updateSubscribers.add(t)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(t){return t(this.get()),this.renderSubscribers.add(t)},e.prototype.attach=function(t){this.passiveEffect=t},e.prototype.set=function(t,n){n===void 0&&(n=!0),!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?Xq(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(t){var n=this;return this.stop(),new Promise(function(r){n.hasAnimated=!0,n.stopAnimation=t(r)}).then(function(){return n.clearAnimation()})},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function _h(e){return new NIe(e)}var cH=function(e){return function(t){return t.test(e)}},DIe={test:function(e){return e==="auto"},parse:function(e){return e}},fH=[bh,Tt,tm,vf,NTe,ITe,DIe],F_=function(e){return fH.find(cH(e))},RIe=ma(ma([],pr(fH)),[va,Zl]),FIe=function(e){return RIe.find(cH(e))};function MIe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,_h(n))}function PIe(e,t){var n=m_(e,t),r=n?e.makeTargetAnimatable(n,!1):{},i=r.transitionEnd,a=i===void 0?{}:i;r.transition;var o=ko(r,["transitionEnd","transition"]);o=Ie(Ie({},o),a);for(var s in o){var u=tOe(o[s]);MIe(e,s,u)}}function $Ie(e,t,n){var r,i,a,o,s=Object.keys(t).filter(function(h){return!e.hasValue(h)}),u=s.length;if(!!u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),d===null&&(d=(i=(r=n[c])!==null&&r!==void 0?r:e.readValue(c))!==null&&i!==void 0?i:t[c]),d!=null&&(typeof d=="string"&&OIe(d)?d=parseFloat(d):!FIe(d)&&Zl.test(f)&&(d=SR(c,f)),e.addValue(c,_h(d)),(a=(o=n)[c])!==null&&a!==void 0||(o[c]=d),e.setBaseTarget(c,d))}}function LIe(e,t){if(!!t){var n=t[e]||t.default||t;return n.from}}function BIe(e,t,n){var r,i,a={};for(var o in e)a[o]=(r=LIe(o,t))!==null&&r!==void 0?r:(i=n.getValue(o))===null||i===void 0?void 0:i.get();return a}function zIe(e,t,n){n===void 0&&(n={}),e.notifyAnimationStart();var r;if(Array.isArray(t)){var i=t.map(function(o){return CR(e,o,n)});r=Promise.all(i)}else if(typeof t=="string")r=CR(e,t,n);else{var a=typeof t=="function"?m_(e,t,n.custom):t;r=dH(e,a,n)}return r.then(function(){return e.notifyAnimationComplete(t)})}function CR(e,t,n){var r;n===void 0&&(n={});var i=m_(e,t,n.custom),a=(i||{}).transition,o=a===void 0?e.getDefaultTransition()||{}:a;n.transitionOverride&&(o=n.transitionOverride);var s=i?function(){return dH(e,i,n)}:function(){return Promise.resolve()},u=((r=e.variantChildren)===null||r===void 0?void 0:r.size)?function(h){h===void 0&&(h=0);var p=o.delayChildren,g=p===void 0?0:p,m=o.staggerChildren,v=o.staggerDirection;return jIe(e,t,g+h,m,v,n)}:function(){return Promise.resolve()},l=o.when;if(l){var c=pr(l==="beforeChildren"?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}else return Promise.all([s(),u(n.delay)])}function dH(e,t,n){var r,i=n===void 0?{}:n,a=i.delay,o=a===void 0?0:a,s=i.transitionOverride,u=i.type,l=e.makeTargetAnimatable(t),c=l.transition,f=c===void 0?e.getDefaultTransition():c,d=l.transitionEnd,h=ko(l,["transition","transitionEnd"]);s&&(f=s);var p=[],g=u&&((r=e.animationState)===null||r===void 0?void 0:r.getState()[u]);for(var m in h){var v=e.getValue(m),y=h[m];if(!(!v||y===void 0||g&&WIe(g,m))){var b=D_(m,v,y,Ie({delay:o},f));p.push(b)}}return Promise.all(p).then(function(){d&&PIe(e,d)})}function jIe(e,t,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1);var o=[],s=(e.variantChildren.size-1)*r,u=i===1?function(l){return l===void 0&&(l=0),l*r}:function(l){return l===void 0&&(l=0),s-l*r};return Array.from(e.variantChildren).sort(UIe).forEach(function(l,c){o.push(CR(l,t,Ie(Ie({},a),{delay:n+u(c)})).then(function(){return l.notifyAnimationComplete(t)}))}),Promise.all(o)}function UIe(e,t){return e.sortNodePosition(t)}function WIe(e,t){var n=e.protectedKeys,r=e.needsAnimating,i=n.hasOwnProperty(t)&&r[t]!==!0;return r[t]=!1,i}var AR=[_r.Animate,_r.Hover,_r.Tap,_r.Drag,_r.Focus,_r.Exit],VIe=ma([],pr(AR)).reverse(),qIe=AR.length;function HIe(e){return function(t){return Promise.all(t.map(function(n){var r=n.animation,i=n.options;return zIe(e,r,i)}))}}function GIe(e){var t=HIe(e),n=XIe(),r={},i=!0,a=function(c,f){var d=m_(e,f);if(d){d.transition;var h=d.transitionEnd,p=ko(d,["transition","transitionEnd"]);c=Ie(Ie(Ie({},c),p),h)}return c};function o(c){return r[c]!==void 0}function s(c){t=c(e)}function u(c,f){for(var d,h=e.getProps(),p=e.getVariantContext(!0)||{},g=[],m=new Set,v={},y=1/0,b=function(C){var _=VIe[C],E=n[_],A=(d=h[_])!==null&&d!==void 0?d:p[_],k=$s(A),T=_===f?E.isActive:null;T===!1&&(y=C);var I=A===p[_]&&A!==h[_]&&k;if(I&&i&&e.manuallyAnimateOnMount&&(I=!1),E.protectedKeys=Ie({},v),!E.isActive&&T===null||!A&&!E.prevProp||uR(A)||typeof A=="boolean")return"continue";var N=KIe(E.prevProp,A)||_===f&&E.isActive&&!I&&k||C>y&&k,O=Array.isArray(A)?A:[A],D=O.reduce(a,{});T===!1&&(D={});var L=E.prevResolvedValues,W=L===void 0?{}:L,G=Ie(Ie({},W),D),K=function(Oe){N=!0,m.delete(Oe),E.needsAnimating[Oe]=!0};for(var ee in G){var ce=D[ee],he=W[ee];v.hasOwnProperty(ee)||(ce!==he?Oy(ce)&&Oy(he)?nH(ce,he)?E.protectedKeys[ee]=!0:K(ee):ce!==void 0?K(ee):m.add(ee):ce!==void 0&&m.has(ee)?K(ee):E.protectedKeys[ee]=!0)}E.prevProp=A,E.prevResolvedValues=D,E.isActive&&(v=Ie(Ie({},v),D)),i&&e.blockInitialAnimation&&(N=!1),N&&!I&&g.push.apply(g,ma([],pr(O.map(function(Oe){return{animation:Oe,options:Ie({type:_},c)}}))))},x=0;x<qIe;x++)b(x);if(r=Ie({},v),m.size){var w={};m.forEach(function(C){var _=e.getBaseTarget(C);_!==void 0&&(w[C]=_)}),g.push({animation:w})}var S=Boolean(g.length);return i&&h.initial===!1&&!e.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function l(c,f,d){var h;return n[c].isActive===f?Promise.resolve():((h=e.variantChildren)===null||h===void 0||h.forEach(function(p){var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(c,f)}),n[c].isActive=f,u(d,c))}return{isAnimated:o,animateChanges:u,setActive:l,setAnimateFunction:s,getState:function(){return n}}}function KIe(e,t){return typeof t=="string"?t!==e:HV(t)?!nH(t,e):!1}function am(e){return e===void 0&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function XIe(){var e;return e={},e[_r.Animate]=am(!0),e[_r.Hover]=am(),e[_r.Tap]=am(),e[_r.Drag]=am(),e[_r.Focus]=am(),e[_r.Exit]=am(),e}var YIe={animation:xh(function(e){var t=e.visualElement,n=e.animate;t.animationState||(t.animationState=GIe(t)),uR(n)&&qt(function(){return n.subscribe(t)},[n])}),exit:xh(function(e){var t=e.custom,n=e.visualElement,r=pr(XD(),2),i=r[0],a=r[1],o=Un(by);qt(function(){var s,u,l=(s=n.animationState)===null||s===void 0?void 0:s.setActive(_r.Exit,!i,{custom:(u=o==null?void 0:o.custom)!==null&&u!==void 0?u:t});!i&&(l==null||l.then(a))},[i])})},hH=function(){function e(t,n,r){var i=this,a=r===void 0?{}:r,o=a.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(!!(i.lastMoveEvent&&i.lastMoveEventInfo)){var d=TR(i.lastMoveEventInfo,i.history),h=i.startEvent!==null,p=Zq(d.offset,{x:0,y:0})>=3;if(!(!h&&!p)){var g=d.point,m=e_().timestamp;i.history.push(Ie(Ie({},g),{timestamp:m}));var v=i.handlers,y=v.onStart,b=v.onMove;h||(y&&y(i.lastMoveEvent,d),i.startEvent=i.lastMoveEvent),b&&b(i.lastMoveEvent,d)}}},this.handlePointerMove=function(d,h){if(i.lastMoveEvent=d,i.lastMoveEventInfo=kR(h,i.transformPagePoint),xq(d)&&d.buttons===0){i.handlePointerUp(d,h);return}Fu.update(i.updatePoint,!0)},this.handlePointerUp=function(d,h){i.end();var p=i.handlers,g=p.onEnd,m=p.onSessionEnd,v=TR(kR(h,i.transformPagePoint),i.history);i.startEvent&&g&&g(d,v),m&&m(d,v)},!(wq(t)&&t.touches.length>1)){this.handlers=n,this.transformPagePoint=o;var s=fR(t),u=kR(s,this.transformPagePoint),l=u.point,c=e_().timestamp;this.history=[Ie(Ie({},l),{timestamp:c})];var f=n.onSessionStart;f&&f(t,TR(u,this.history)),this.removeListeners=Ny(im(window,"pointermove",this.handlePointerMove),im(window,"pointerup",this.handlePointerUp),im(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(t){this.handlers=t},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),oy.update(this.updatePoint)},e}();function kR(e,t){return t?{point:t(e.point)}:e}function pH(e,t){return{x:e.x-t.x,y:e.y-t.y}}function TR(e,t){var n=e.point;return{point:n,delta:pH(n,gH(t)),offset:pH(n,ZIe(t)),velocity:JIe(t,.1)}}function ZIe(e){return e[0]}function gH(e){return e[e.length-1]}function JIe(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,i=gH(e);n>=0&&(r=e[n],!(i.timestamp-r.timestamp>I_(t)));)n--;if(!r)return{x:0,y:0};var a=(i.timestamp-r.timestamp)/1e3;if(a===0)return{x:0,y:0};var o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function QIe(e){return e}function mH(e){var t=e.top,n=e.left,r=e.right,i=e.bottom;return{x:{min:n,max:r},y:{min:t,max:i}}}function eNe(e){var t=e.x,n=e.y;return{top:n.min,bottom:n.max,left:t.min,right:t.max}}function tNe(e,t){var n=e.top,r=e.left,i=e.bottom,a=e.right;t===void 0&&(t=QIe);var o=t({x:r,y:n}),s=t({x:a,y:i});return{top:o.y,left:o.x,bottom:s.y,right:s.x}}function yf(){return{x:{min:0,max:1},y:{min:0,max:1}}}function nNe(e){return{x:Ie({},e.x),y:Ie({},e.y)}}var vH={translate:0,scale:1,origin:0,originPoint:0};function yH(){return{x:Ie({},vH),y:Ie({},vH)}}function Za(e){return[e("x"),e("y")]}function bH(e,t,n){var r=t.min,i=t.max;return r!==void 0&&e<r?e=n?Ya(r,e,n.min):Math.max(e,r):i!==void 0&&e>i&&(e=n?Ya(i,e,n.max):Math.min(e,i)),e}function rNe(e,t,n,r,i){var a=e-t*n;return r?bH(a,r,i):a}function xH(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function iNe(e,t){var n=t.top,r=t.left,i=t.bottom,a=t.right;return{x:xH(e.x,r,a),y:xH(e.y,n,i)}}function wH(e,t){var n,r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&(n=pr([i,r],2),r=n[0],i=n[1]),{min:e.min+r,max:e.min+i}}function aNe(e,t){return{x:wH(e.x,t.x),y:wH(e.y,t.y)}}function oNe(e,t,n){var r=e.max-e.min,i=Ya(t.min,t.max-r,n);return{min:i,max:i+r}}function sNe(e,t){var n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var _H=.35;function uNe(e){return e===!1?e=0:e===!0&&(e=_H),{x:SH(e,"left","right"),y:SH(e,"top","bottom")}}function SH(e,t,n){return{min:EH(e,t),max:EH(e,n)}}function EH(e,t){var n;return typeof e=="number"?e:(n=e[t])!==null&&n!==void 0?n:0}function CH(e,t){var n=e.getBoundingClientRect();return mH(tNe(n,t))}var lNe=function(e){return __(0,1,e)};function AH(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=.01),Zq(e,t)<n}function Dy(e){return e.max-e.min}function cNe(e,t){var n=.5,r=Dy(e),i=Dy(t);return i>r?n=Iy(t.min,t.max-r,e.min):r>i&&(n=Iy(e.min,e.max-i,t.min)),lNe(n)}function kH(e,t,n,r){r===void 0&&(r=.5),e.origin=r,e.originPoint=Ya(t.min,t.max,e.origin),e.scale=Dy(n)/Dy(t),AH(e.scale,1,1e-4)&&(e.scale=1),e.translate=Ya(n.min,n.max,e.origin)-e.originPoint,AH(e.translate)&&(e.translate=0)}function TH(e,t,n,r){kH(e.x,t.x,n.x,OH(r.originX)),kH(e.y,t.y,n.y,OH(r.originY))}function OH(e){return typeof e=="number"?e:.5}function IH(e,t,n){e.min=n.min+t.min,e.max=e.min+Dy(t)}function fNe(e,t){IH(e.target.x,e.relativeTarget.x,t.target.x),IH(e.target.y,e.relativeTarget.y,t.target.y)}var OR=function(e,t){return e.depth-t.depth};function NH(e){var t=e.projection.isEnabled;return t||e.shouldResetTransform()}function M_(e,t){t===void 0&&(t=[]);var n=e.parent;return n&&M_(n,t),NH(e)&&t.push(e),t}function dNe(e){var t=[],n=function(r){NH(r)&&t.push(r),r.children.forEach(n)};return e.children.forEach(n),t.sort(OR)}function P_(e){if(!e.shouldResetTransform()){var t=e.getLayoutState();e.notifyBeforeLayoutMeasure(t.layout),t.isHydrated=!0,t.layout=e.measureViewportBox(),t.layoutCorrected=nNe(t.layout),e.notifyLayoutMeasure(t.layout,e.prevViewportBox||t.layout),Fu.update(function(){return e.rebaseProjectionTarget()})}}function hNe(e){e.shouldResetTransform()||(e.prevViewportBox=e.measureViewportBox(!1),e.rebaseProjectionTarget(!1,e.prevViewportBox))}function pNe(e,t,n,r){e.min=Ya(t.min,n.min,r),e.max=Ya(t.max,n.max,r)}function DH(e,t){return{min:t.min-e.min,max:t.max-e.min}}function om(e,t){return{x:DH(e.x,t.x),y:DH(e.y,t.y)}}function gNe(e,t){var n=e.getLayoutId(),r=t.getLayoutId();return n!==r||r===void 0&&e!==t}function RH(e){var t=e.getProps(),n=t.drag,r=t._dragX;return n&&!r}function FH(e,t){e.min=t.min,e.max=t.max}function mNe(e,t){FH(e.x,t.x),FH(e.y,t.y)}function $_(e,t,n){var r=e-n,i=t*r;return n+i}function MH(e,t,n,r,i){return i!==void 0&&(e=$_(e,i,r)),$_(e,n,r)+t}function IR(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),e.min=MH(e.min,t,n,r,i),e.max=MH(e.max,t,n,r,i)}function vNe(e,t){var n=t.x,r=t.y;IR(e.x,n.translate,n.scale,n.originPoint),IR(e.y,r.translate,r.scale,r.originPoint)}function PH(e,t,n,r){var i=pr(r,3),a=i[0],o=i[1],s=i[2];e.min=t.min,e.max=t.max;var u=n[s]!==void 0?n[s]:.5,l=Ya(t.min,t.max,u);IR(e,n[a],n[o],l,n.scale)}var $H=["x","scaleX","originX"],LH=["y","scaleY","originY"];function NR(e,t,n){PH(e.x,t.x,n,$H),PH(e.y,t.y,n,LH)}function BH(e,t,n,r,i){return e-=t,e=$_(e,1/n,r),i!==void 0&&(e=$_(e,1/i,r)),e}function yNe(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=.5);var a=Ya(e.min,e.max,r)-t;e.min=BH(e.min,t,n,a,i),e.max=BH(e.max,t,n,a,i)}function zH(e,t,n){var r=pr(n,3),i=r[0],a=r[1],o=r[2];yNe(e,t[i],t[a],t[o],t.scale)}function jH(e,t){zH(e.x,t,$H),zH(e.y,t,LH)}function bNe(e,t,n){var r=n.length;if(!!r){t.x=t.y=1;for(var i,a,o=0;o<r;o++)i=n[o],a=i.getLayoutState().delta,t.x*=a.x.scale,t.y*=a.y.scale,vNe(e,a),RH(i)&&NR(e,e,i.getLatestValues())}}function xNe(e,t){t===void 0&&(t=!0);var n=e.getProjectionParent();if(!n)return!1;var r;return t?(r=om(n.projection.target,e.projection.target),jH(r,n.getLatestValues())):r=om(n.getLayoutState().layout,e.getLayoutState().layout),Za(function(i){return e.setProjectionTargetAxis(i,r[i].min,r[i].max,!0)}),!0}var Ry=new Set;function UH(e,t,n){e[n]||(e[n]=[]),e[n].push(t)}function DR(e){return Ry.add(e),function(){return Ry.delete(e)}}function RR(){if(!!Ry.size){var e=0,t=[[]],n=[],r=function(s){return UH(t,s,e)},i=function(s){UH(n,s,e),e++};Ry.forEach(function(s){s(r,i),e=0}),Ry.clear();for(var a=n.length,o=0;o<=a;o++)t[o]&&t[o].forEach(WH),n[o]&&n[o].forEach(WH)}}var WH=function(e){return e()},wNe=new WeakMap,VH,_Ne=function(){function e(t){var n=t.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=yf(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=n,this.visualElement.enableLayoutProjection(),wNe.set(n,this)}return e.prototype.start=function(t,n){var r=this,i=n===void 0?{}:n,a=i.snapToCursor,o=a===void 0?!1:a,s=i.cursorProgress,u=function(h){var p;r.stopMotion();var g=hOe(h).point;(p=r.cancelLayout)===null||p===void 0||p.call(r),r.cancelLayout=DR(function(m,v){var y=M_(r.visualElement),b=dNe(r.visualElement),x=ma(ma([],pr(y)),pr(b)),w=!1;r.isLayoutDrag()&&r.visualElement.lockProjectionTarget(),v(function(){x.forEach(function(S){return S.resetTransform()})}),m(function(){P_(r.visualElement),b.forEach(P_)}),v(function(){x.forEach(function(S){return S.restoreTransform()}),o&&(w=r.snapToCursor(g))}),m(function(){var S=Boolean(r.getAxisMotionValue("x")&&!r.isExternalDrag());S||r.visualElement.rebaseProjectionTarget(!0,r.visualElement.measureViewportBox(!1)),r.visualElement.scheduleUpdateLayoutProjection();var C=r.visualElement.projection;Za(function(_){if(!w){var E=C.target[_],A=E.min,k=E.max;r.cursorProgress[_]=s?s[_]:Iy(A,k,g[_])}var T=r.getAxisMotionValue(_);T&&(r.originPoint[_]=T.get())})}),v(function(){Gg.update(),Gg.preRender(),Gg.render(),Gg.postRender()}),m(function(){return r.resolveDragConstraints()})})},l=function(h,p){var g,m,v,y=r.props,b=y.drag,x=y.dragPropagation;b&&!x&&(r.openGlobalLock&&r.openGlobalLock(),r.openGlobalLock=kq(b),!r.openGlobalLock)||(RR(),r.isDragging=!0,r.currentDirection=null,(m=(g=r.props).onDragStart)===null||m===void 0||m.call(g,h,p),(v=r.visualElement.animationState)===null||v===void 0||v.setActive(_r.Drag,!0))},c=function(h,p){var g,m,v,y,b=r.props,x=b.dragPropagation,w=b.dragDirectionLock;if(!(!x&&!r.openGlobalLock)){var S=p.offset;if(w&&r.currentDirection===null){r.currentDirection=SNe(S),r.currentDirection!==null&&((m=(g=r.props).onDirectionLock)===null||m===void 0||m.call(g,r.currentDirection));return}r.updateAxis("x",p.point,S),r.updateAxis("y",p.point,S),(y=(v=r.props).onDrag)===null||y===void 0||y.call(v,h,p),VH=h}},f=function(h,p){return r.stop(h,p)},d=this.props.transformPagePoint;this.panSession=new hH(t,{onSessionStart:u,onStart:l,onMove:c,onSessionEnd:f},{transformPagePoint:d})},e.prototype.resolveDragConstraints=function(){var t=this,n=this.props,r=n.dragConstraints,i=n.dragElastic,a=this.visualElement.getLayoutState().layoutCorrected;r?this.constraints=YD(r)?this.resolveRefConstraints(a,r):iNe(a,r):this.constraints=!1,this.elastic=uNe(i),this.constraints&&!this.hasMutatedConstraints&&Za(function(o){t.getAxisMotionValue(o)&&(t.constraints[o]=sNe(a[o],t.constraints[o]))})},e.prototype.resolveRefConstraints=function(t,n){var r=this.props,i=r.onMeasureDragConstraints,a=r.transformPagePoint,o=n.current;this.constraintsBox=CH(o,a);var s=aNe(t,this.constraintsBox);if(i){var u=i(eNe(s));this.hasMutatedConstraints=!!u,u&&(s=mH(u))}return s},e.prototype.cancelDrag=function(){var t,n;this.visualElement.unlockProjectionTarget(),(t=this.cancelLayout)===null||t===void 0||t.call(this),this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(_r.Drag,!1)},e.prototype.stop=function(t,n){var r,i,a;(r=this.panSession)===null||r===void 0||r.end(),this.panSession=null;var o=this.isDragging;if(this.cancelDrag(),!!o){var s=n.velocity;this.animateDragEnd(s),(a=(i=this.props).onDragEnd)===null||a===void 0||a.call(i,t,n)}},e.prototype.snapToCursor=function(t){var n=this;return Za(function(r){var i=n.props.drag;if(!!L_(r,i,n.currentDirection)){var a=n.getAxisMotionValue(r);if(a){var o=n.visualElement.getLayoutState().layout,s=o[r].max-o[r].min,u=o[r].min+s/2,l=t[r]-u;n.originPoint[r]=t[r],a.set(l)}else return n.cursorProgress[r]=.5,!0}}).includes(!0)},e.prototype.updateAxis=function(t,n,r){var i=this.props.drag;if(!!L_(t,i,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,r):this.updateVisualElementAxis(t,n)},e.prototype.updateAxisMotionValue=function(t,n){var r=this.getAxisMotionValue(t);if(!(!n||!r)){var i=this.originPoint[t]+n[t],a=this.constraints?bH(i,this.constraints[t],this.elastic[t]):i;r.set(a)}},e.prototype.updateVisualElementAxis=function(t,n){var r,i=this.visualElement.getLayoutState().layout[t],a=i.max-i.min,o=this.cursorProgress[t],s=rNe(n[t],a,o,(r=this.constraints)===null||r===void 0?void 0:r[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,s,s+a)},e.prototype.setProps=function(t){var n=t.drag,r=n===void 0?!1:n,i=t.dragDirectionLock,a=i===void 0?!1:i,o=t.dragPropagation,s=o===void 0?!1:o,u=t.dragConstraints,l=u===void 0?!1:u,c=t.dragElastic,f=c===void 0?_H:c,d=t.dragMomentum,h=d===void 0?!0:d,p=ko(t,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=Ie({drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:l,dragElastic:f,dragMomentum:h},p)},e.prototype.getAxisMotionValue=function(t){var n=this.props,r=n.layout,i=n.layoutId,a="_drag"+t.toUpperCase();if(this.props[a])return this.props[a];if(!r&&i===void 0)return this.visualElement.getValue(t,0)},e.prototype.isLayoutDrag=function(){return!this.getAxisMotionValue("x")},e.prototype.isExternalDrag=function(){var t=this.props,n=t._dragX,r=t._dragY;return n||r},e.prototype.animateDragEnd=function(t){var n=this,r=this.props,i=r.drag,a=r.dragMomentum,o=r.dragElastic,s=r.dragTransition,u=xNe(this.visualElement,this.isLayoutDrag()&&!this.isExternalDrag()),l=this.constraints||{};if(u&&Object.keys(l).length&&this.isLayoutDrag()){var c=this.visualElement.getProjectionParent();if(c){var f=om(c.projection.targetFinal,l);Za(function(h){var p=f[h],g=p.min,m=p.max;l[h]={min:isNaN(g)?void 0:g,max:isNaN(m)?void 0:m}})}}var d=Za(function(h){var p;if(!!L_(h,i,n.currentDirection)){var g=(p=l==null?void 0:l[h])!==null&&p!==void 0?p:{},m=o?200:1e6,v=o?40:1e7,y=Ie(Ie({type:"inertia",velocity:a?t[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10},s),g);return n.getAxisMotionValue(h)?n.startAxisValueAnimation(h,y):n.visualElement.startLayoutAnimation(h,y,u)}});return Promise.all(d).then(function(){var h,p;(p=(h=n.props).onDragTransitionEnd)===null||p===void 0||p.call(h)})},e.prototype.stopMotion=function(){var t=this;Za(function(n){var r=t.getAxisMotionValue(n);r?r.stop():t.visualElement.stopLayoutAnimation()})},e.prototype.startAxisValueAnimation=function(t,n){var r=this.getAxisMotionValue(t);if(!!r){var i=r.get();return r.set(i),r.set(i),D_(t,r,0,n)}},e.prototype.scalePoint=function(){var t=this,n=this.props,r=n.drag,i=n.dragConstraints;if(!(!YD(i)||!this.constraintsBox)){this.stopMotion();var a={x:0,y:0};Za(function(o){a[o]=cNe(t.visualElement.projection.target[o],t.constraintsBox[o])}),this.updateConstraints(function(){Za(function(o){if(!!L_(o,r,null)){var s=oNe(t.visualElement.projection.target[o],t.constraintsBox[o],a[o]),u=s.min,l=s.max;t.visualElement.setProjectionTargetAxis(o,u,l)}})}),setTimeout(RR,1)}},e.prototype.updateConstraints=function(t){var n=this;this.cancelLayout=DR(function(r,i){var a=M_(n.visualElement);i(function(){return a.forEach(function(o){return o.resetTransform()})}),r(function(){return P_(n.visualElement)}),i(function(){return a.forEach(function(o){return o.restoreTransform()})}),r(function(){n.resolveDragConstraints()}),t&&i(t)})},e.prototype.mount=function(t){var n=this,r=t.getInstance(),i=im(r,"pointerdown",function(u){var l=n.props,c=l.drag,f=l.dragListener,d=f===void 0?!0:f;c&&d&&n.start(u)}),a=lR(window,"resize",function(){n.scalePoint()}),o=t.onLayoutUpdate(function(){n.isDragging&&n.resolveDragConstraints()}),s=t.prevDragCursor;return s&&this.start(VH,{cursorProgress:s}),function(){i==null||i(),a==null||a(),o==null||o(),n.cancelDrag()}},e}();function L_(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function SNe(e,t){t===void 0&&(t=10);var n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}function ENe(e){var t=e.dragControls,n=e.visualElement,r=Un(p_).transformPagePoint,i=xy(function(){return new _Ne({visualElement:n})});i.setProps(Ie(Ie({},e),{transformPagePoint:r})),qt(function(){return t&&t.subscribe(i)},[i]),qt(function(){return i.mount(n)},[])}function CNe(e){var t=e.onPan,n=e.onPanStart,r=e.onPanEnd,i=e.onPanSessionStart,a=e.visualElement,o=t||n||r||i,s=Jt(null),u=Un(p_).transformPagePoint,l={onSessionStart:i,onStart:n,onMove:t,onEnd:function(f,d){s.current=null,r&&r(f,d)}};qt(function(){s.current!==null&&s.current.updateHandlers(l)});function c(f){s.current=new hH(f,l,{transformPagePoint:u})}w_(a,"pointerdown",o&&c),dR(function(){return s.current&&s.current.end()})}var ANe={pan:xh(CNe),drag:xh(ENe)},Fy;(function(e){e[e.Entering=0]="Entering",e[e.Present=1]="Present",e[e.Exiting=2]="Exiting"})(Fy||(Fy={}));var FR;(function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"})(FR||(FR={}));function MR(e){return typeof e=="string"&&e.startsWith("var(--")}var qH=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function kNe(e){var t=qH.exec(e);if(!t)return[,];var n=pr(t,3),r=n[1],i=n[2];return[r,i]}function PR(e,t,n){var r=pr(kNe(e),2),i=r[0],a=r[1];if(!!i){var o=window.getComputedStyle(t).getPropertyValue(i);return o?o.trim():MR(a)?PR(a,t):a}}function TNe(e,t,n){var r,i=ko(t,[]),a=e.getInstance();if(!(a instanceof HTMLElement))return{target:i,transitionEnd:n};n&&(n=Ie({},n)),e.forEachValue(function(l){var c=l.get();if(!!MR(c)){var f=PR(c,a);f&&l.set(f)}});for(var o in i){var s=i[o];if(!!MR(s)){var u=PR(s,a);!u||(i[o]=u,n&&((r=n[o])!==null&&r!==void 0||(n[o]=s)))}}return{target:i,transitionEnd:n}}function HH(e,t){return e/(t.max-t.min)*100}function ONe(e,t,n){var r=n.target;if(typeof e=="string")if(Tt.test(e))e=parseFloat(e);else return e;var i=HH(e,r.x),a=HH(e,r.y);return i+"% "+a+"%"}var GH="_$css";function INe(e,t){var n=t.delta,r=t.treeScale,i=e,a=e.includes("var("),o=[];a&&(e=e.replace(qH,function(g){return o.push(g),GH}));var s=Zl.parse(e);if(s.length>5)return i;var u=Zl.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*r.x,f=n.y.scale*r.y;s[0+l]/=c,s[1+l]/=f;var d=Ya(c,f,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);var h=u(s);if(a){var p=0;h=h.replace(GH,function(){var g=o[p];return p++,g})}return h}var My={process:ONe},NNe={borderRadius:Ie(Ie({},My),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:My,borderTopRightRadius:My,borderBottomLeftRadius:My,borderBottomRightRadius:My,boxShadow:{process:INe}},KH=1e3,DNe=function(e){UV(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.frameTarget=yf(),n.currentAnimationTarget=yf(),n.isAnimating={x:!1,y:!1},n.stopAxisAnimation={x:void 0,y:void 0},n.isAnimatingTree=!1,n.animate=function(r,i,a){a===void 0&&(a={});var o=a.originBox,s=a.targetBox,u=a.visibilityAction,l=a.shouldStackAnimate,c=a.onComplete,f=a.prevParent,d=ko(a,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete","prevParent"]),h=n.props,p=h.visualElement,g=h.layout;if(l===!1)return n.isAnimatingTree=!1,n.safeToRemove();if(!(n.isAnimatingTree&&l!==!0)){l&&(n.isAnimatingTree=!0),i=o||i,r=s||r;var m=!1,v=p.getProjectionParent();if(v){var y=v.prevViewportBox,b=v.getLayoutState().layout;f&&(s&&(b=f.getLayoutState().layout),o&&!gNe(f,v)&&f.prevViewportBox&&(y=f.prevViewportBox)),y&&PNe(f,o,s)&&(m=!0,i=om(y,i),r=om(b,r))}var x=FNe(i,r),w=Za(function(S){var C,_;if(g==="position"){var E=r[S].max-r[S].min;i[S].max=i[S].min+E}if(!p.projection.isTargetLocked)if(u!==void 0)p.setVisibility(u===FR.Show);else return x?n.animateAxis(S,r[S],i[S],Ie(Ie({},d),{isRelative:m})):((_=(C=n.stopAxisAnimation)[S])===null||_===void 0||_.call(C),p.setProjectionTargetAxis(S,r[S].min,r[S].max,m))});return p.syncRender(),Promise.all(w).then(function(){n.isAnimatingTree=!1,c&&c(),p.notifyLayoutAnimationComplete()})}},n}return t.prototype.componentDidMount=function(){var n=this,r=this.props.visualElement;r.animateMotionValue=D_,r.enableLayoutProjection(),this.unsubLayoutReady=r.onLayoutUpdate(this.animate),r.layoutSafeToRemove=function(){return n.safeToRemove()},bTe(NNe)},t.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),Za(function(r){var i,a;return(a=(i=n.stopAxisAnimation)[r])===null||a===void 0?void 0:a.call(i)})},t.prototype.animateAxis=function(n,r,i,a){var o=this,s,u,l=a===void 0?{}:a,c=l.transition,f=l.isRelative;if(!(this.isAnimating[n]&&Py(r,this.currentAnimationTarget[n]))){(u=(s=this.stopAxisAnimation)[n])===null||u===void 0||u.call(s),this.isAnimating[n]=!0;var d=this.props.visualElement,h=this.frameTarget[n],p=d.getProjectionAnimationProgress()[n];p.clearListeners(),p.set(0),p.set(0);var g=function(){var b=p.get()/KH;pNe(h,i,r,b),d.setProjectionTargetAxis(n,h.min,h.max,f)};g();var m=p.onChange(g);this.stopAxisAnimation[n]=function(){o.isAnimating[n]=!1,p.stop(),m()},this.currentAnimationTarget[n]=r;var v=c||d.getDefaultTransition()||MNe,y=D_(n==="x"?"layoutX":"layoutY",p,KH,v&&ER(v,"layout")).then(this.stopAxisAnimation[n]);return y}},t.prototype.safeToRemove=function(){var n,r;(r=(n=this.props).safeToRemove)===null||r===void 0||r.call(n)},t.prototype.render=function(){return null},t}(Is);function RNe(e){var t=pr(XD(),2),n=t[1];return ue(DNe,Ie({},e,{safeToRemove:n}))}function FNe(e,t){return!YH(e)&&!YH(t)&&(!Py(e.x,t.x)||!Py(e.y,t.y))}var XH={min:0,max:0};function YH(e){return Py(e.x,XH)&&Py(e.y,XH)}function Py(e,t){return e.min===t.min&&e.max===t.max}var MNe={duration:.45,ease:[.4,0,.1,1]};function PNe(e,t,n){return e||!e&&!(t||n)}var $Ne={layoutReady:function(e){return e.notifyLayoutReady()}};function ZH(){var e=new Set;return{add:function(t){return e.add(t)},flush:function(t){var n=t===void 0?$Ne:t,r=n.layoutReady,i=n.parent;DR(function(a,o){var s=Array.from(e).sort(OR),u=i?M_(i):[];o(function(){var l=ma(ma([],pr(u)),pr(s));l.forEach(function(c){return c.resetTransform()})}),a(function(){s.forEach(P_)}),o(function(){u.forEach(function(l){return l.restoreTransform()}),s.forEach(r)}),a(function(){s.forEach(function(l){l.isPresent&&(l.presence=Fy.Present)})}),o(function(){Gg.preRender(),Gg.render()}),a(function(){Fu.postRender(function(){return s.forEach(LNe)}),e.clear()})}),RR()}}}function LNe(e){e.prevViewportBox=e.projection.target}var JH=ha(ZH()),BNe=ha(ZH());function Sh(e){return!!e.forceUpdate}var zNe=function(e){UV(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){var n=this.props,r=n.syncLayout,i=n.framerSyncLayout,a=n.visualElement;Sh(r)&&r.register(a),Sh(i)&&i.register(a),a.onUnmount(function(){Sh(r)&&r.remove(a),Sh(i)&&i.remove(a)})},t.prototype.getSnapshotBeforeUpdate=function(){var n=this.props,r=n.syncLayout,i=n.visualElement;return Sh(r)?r.syncUpdate():(hNe(i),r.add(i)),null},t.prototype.componentDidUpdate=function(){var n=this.props.syncLayout;Sh(n)||n.flush()},t.prototype.render=function(){return null},t}(zt.Component);function jNe(e){var t=Un(JH),n=Un(BNe);return zt.createElement(zNe,Ie({},e,{syncLayout:t,framerSyncLayout:n}))}var UNe={measureLayout:jNe,layoutAnimation:RNe},WNe=function(){return{isEnabled:!1,isHydrated:!1,isTargetLocked:!1,target:yf(),targetFinal:yf()}};function QH(){return{isHydrated:!1,layout:yf(),layoutCorrected:yf(),treeScale:{x:1,y:1},delta:yH(),deltaFinal:yH(),deltaTransform:""}}var eG=QH();function B_(e,t,n){var r=e.x,i=e.y,a=r.translate/t.x,o=i.translate/t.y,s="translate3d("+a+"px, "+o+"px, 0) ";if(n){var u=n.rotate,l=n.rotateX,c=n.rotateY;u&&(s+="rotate("+u+") "),l&&(s+="rotateX("+l+") "),c&&(s+="rotateY("+c+") ")}return s+="scale("+r.scale+", "+i.scale+")",!n&&s===VNe?"":s}function tG(e){var t=e.deltaFinal;return t.x.origin*100+"% "+t.y.origin*100+"% 0"}var VNe=B_(eG.delta,eG.treeScale,{x:1,y:1}),z_=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","SetAxisTarget","Unmount"];function qNe(){var e=z_.map(function(){return new R_}),t={},n={clearAllListeners:function(){return e.forEach(function(r){return r.clear()})},updatePropListeners:function(r){return z_.forEach(function(i){var a;(a=t[i])===null||a===void 0||a.call(t);var o="on"+i,s=r[o];s&&(t[i]=n[o](s))})}};return e.forEach(function(r,i){n["on"+z_[i]]=function(a){return r.add(a)},n["notify"+z_[i]]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.notify.apply(r,ma([],pr(a)))}}),n}function HNe(e,t,n){var r;for(var i in t){var a=t[i],o=n[i];if(mf(a))e.addValue(i,a);else if(mf(o))e.addValue(i,_h(a));else if(o!==a)if(e.hasValue(i)){var s=e.getValue(i);!s.hasAnimated&&s.set(a)}else e.addValue(i,_h((r=e.getStaticValue(i))!==null&&r!==void 0?r:a))}for(var i in n)t[i]===void 0&&e.removeValue(i);return t}function GNe(e,t,n,r){var i=e.delta,a=e.layout,o=e.layoutCorrected,s=e.treeScale,u=t.target;mNe(o,a),bNe(o,s,n),TH(i,o,u,r)}var KNe=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(t){uH(this.children,t),this.isDirty=!0},e.prototype.remove=function(t){lH(this.children,t),this.isDirty=!0},e.prototype.forEach=function(t){this.isDirty&&this.children.sort(OR),this.isDirty=!1,this.children.forEach(t)},e}();function XNe(e){var t=e.getProjectionParent();if(!t){e.rebaseProjectionTarget();return}var n=om(t.getLayoutState().layout,e.getLayoutState().layout);Za(function(r){e.setProjectionTargetAxis(r,n[r].min,n[r].max,!0)})}var nG=function(e){var t=e.treeType,n=t===void 0?"":t,r=e.build,i=e.getBaseTarget,a=e.makeTargetAnimatable,o=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.resetTransform,c=e.restoreTransform,f=e.removeValueFromRenderState,d=e.sortNodePosition,h=e.scrapeMotionValuesFromProps;return function(p,g){var m=p.parent,v=p.props,y=p.presenceId,b=p.blockInitialAnimation,x=p.visualState;g===void 0&&(g={});var w=x.latestValues,S=x.renderState,C,_=qNe(),E=WNe(),A,k=E,T=w,I,N=QH(),O,D=!1,L=new Map,W=new Map,G={},K,ee=Ie({},w),ce;function he(){!C||(B.isProjectionReady()&&(NR(k.targetFinal,k.target,T),TH(N.deltaFinal,N.layoutCorrected,k.targetFinal,w)),Oe(),s(C,S))}function Oe(){var R=w;if(O&&O.isActive()){var X=O.getCrossfadeState(B);X&&(R=X)}r(B,S,R,k,N,g,v)}function Te(){_.notifyUpdate(w)}function De(){if(!!B.isProjectionReady()){var R=N.delta,X=N.treeScale,ge=X.x,xe=X.y,ze=N.deltaTransform;GNe(N,k,B.path,w),D&&B.notifyViewportBoxUpdate(k.target,R),D=!1;var Ke=B_(R,X);(Ke!==ze||ge!==X.x||xe!==X.y)&&B.scheduleRender(),N.deltaTransform=Ke}}function me(){B.layoutTree.forEach(ZNe)}function P(R,X){var ge=X.onChange(function(ze){w[R]=ze,v.onUpdate&&Fu.update(Te,!1,!0)}),xe=X.onRenderRequest(B.scheduleRender);W.set(R,function(){ge(),xe()})}var F=h(v);for(var V in F){var ae=F[V];w[V]!==void 0&&mf(ae)&&ae.set(w[V],!1)}var Y=v_(v),M=KV(v),B=Ie(Ie({treeType:n,current:null,depth:m?m.depth+1:0,parent:m,children:new Set,path:m?ma(ma([],pr(m.path)),[m]):[],layoutTree:m?m.layoutTree:new KNe,presenceId:y,projection:E,variantChildren:M?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(m==null?void 0:m.isMounted()),blockInitialAnimation:b,isMounted:function(){return Boolean(C)},mount:function(R){C=B.current=R,B.pointTo(B),M&&m&&!Y&&(ce=m==null?void 0:m.addVariantChild(B)),m==null||m.children.add(B)},unmount:function(){oy.update(Te),oy.render(he),oy.preRender(B.updateLayoutProjection),W.forEach(function(R){return R()}),B.stopLayoutAnimation(),B.layoutTree.remove(B),ce==null||ce(),m==null||m.children.delete(B),I==null||I(),_.clearAllListeners()},addVariantChild:function(R){var X,ge=B.getClosestVariantNode();if(ge)return(X=ge.variantChildren)===null||X===void 0||X.add(R),function(){return ge.variantChildren.delete(R)}},sortNodePosition:function(R){return!d||n!==R.treeType?0:d(B.getInstance(),R.getInstance())},getClosestVariantNode:function(){return M?B:m==null?void 0:m.getClosestVariantNode()},scheduleUpdateLayoutProjection:m?m.scheduleUpdateLayoutProjection:function(){return Fu.preRender(B.updateTreeLayoutProjection,!1,!0)},getLayoutId:function(){return v.layoutId},getInstance:function(){return C},getStaticValue:function(R){return w[R]},setStaticValue:function(R,X){return w[R]=X},getLatestValues:function(){return w},setVisibility:function(R){B.isVisible!==R&&(B.isVisible=R,B.scheduleRender())},makeTargetAnimatable:function(R,X){return X===void 0&&(X=!0),a(B,R,v,X)},addValue:function(R,X){B.hasValue(R)&&B.removeValue(R),L.set(R,X),w[R]=X.get(),P(R,X)},removeValue:function(R){var X;L.delete(R),(X=W.get(R))===null||X===void 0||X(),W.delete(R),delete w[R],f(R,S)},hasValue:function(R){return L.has(R)},getValue:function(R,X){var ge=L.get(R);return ge===void 0&&X!==void 0&&(ge=_h(X),B.addValue(R,ge)),ge},forEachValue:function(R){return L.forEach(R)},readValue:function(R){var X;return(X=w[R])!==null&&X!==void 0?X:u(C,R,g)},setBaseTarget:function(R,X){ee[R]=X},getBaseTarget:function(R){if(i){var X=i(v,R);if(X!==void 0&&!mf(X))return X}return ee[R]}},_),{build:function(){return Oe(),S},scheduleRender:function(){Fu.render(he,!1,!0)},syncRender:he,setProps:function(R){v=R,_.updatePropListeners(R),G=HNe(B,h(v),G)},getProps:function(){return v},getVariant:function(R){var X;return(X=v.variants)===null||X===void 0?void 0:X[R]},getDefaultTransition:function(){return v.transition},getVariantContext:function(R){if(R===void 0&&(R=!1),R)return m==null?void 0:m.getVariantContext();if(!Y){var X=(m==null?void 0:m.getVariantContext())||{};return v.initial!==void 0&&(X.initial=v.initial),X}for(var ge={},xe=0;xe<JNe;xe++){var ze=rG[xe],Ke=v[ze];($s(Ke)||Ke===!1)&&(ge[ze]=Ke)}return ge},enableLayoutProjection:function(){E.isEnabled=!0,B.layoutTree.add(B)},lockProjectionTarget:function(){E.isTargetLocked=!0},unlockProjectionTarget:function(){B.stopLayoutAnimation(),E.isTargetLocked=!1},getLayoutState:function(){return N},setCrossfader:function(R){O=R},isProjectionReady:function(){return E.isEnabled&&E.isHydrated&&N.isHydrated},startLayoutAnimation:function(R,X,ge){ge===void 0&&(ge=!1);var xe=B.getProjectionAnimationProgress()[R],ze=ge?E.relativeTarget[R]:E.target[R],Ke=ze.min,Ze=ze.max,Bt=Ze-Ke;return xe.clearListeners(),xe.set(Ke),xe.set(Ke),xe.onChange(function(Je){B.setProjectionTargetAxis(R,Je,Je+Bt,ge)}),B.animateMotionValue(R,xe,0,X)},stopLayoutAnimation:function(){Za(function(R){return B.getProjectionAnimationProgress()[R].stop()})},measureViewportBox:function(R){R===void 0&&(R=!0);var X=o(C,g);return R||jH(X,w),X},getProjectionAnimationProgress:function(){return K||(K={x:_h(0),y:_h(0)}),K},setProjectionTargetAxis:function(R,X,ge,xe){xe===void 0&&(xe=!1);var ze;xe?(E.relativeTarget||(E.relativeTarget=yf()),ze=E.relativeTarget[R]):(E.relativeTarget=void 0,ze=E.target[R]),E.isHydrated=!0,ze.min=X,ze.max=ge,D=!0,_.notifySetAxisTarget()},rebaseProjectionTarget:function(R,X){X===void 0&&(X=N.layout);var ge=B.getProjectionAnimationProgress(),xe=ge.x,ze=ge.y,Ke=!E.relativeTarget&&!E.isTargetLocked&&!xe.isAnimating()&&!ze.isAnimating();(R||Ke)&&Za(function(Ze){var Bt=X[Ze],Je=Bt.min,Zt=Bt.max;B.setProjectionTargetAxis(Ze,Je,Zt)})},notifyLayoutReady:function(R){XNe(B),B.notifyLayoutUpdate(N.layout,B.prevViewportBox||N.layout,R)},resetTransform:function(){return l(B,C,v)},restoreTransform:function(){return c(C,S)},updateLayoutProjection:De,updateTreeLayoutProjection:function(){B.layoutTree.forEach(YNe),Fu.preRender(me,!1,!0)},getProjectionParent:function(){if(A===void 0){for(var R=!1,X=B.path.length-1;X>=0;X--){var ge=B.path[X];if(ge.projection.isEnabled){R=ge;break}}A=R}return A},resolveRelativeTargetBox:function(){var R=B.getProjectionParent();if(!(!E.relativeTarget||!R)&&(fNe(E,R.projection),RH(R))){var X=E.target;NR(X,X,R.getLatestValues())}},shouldResetTransform:function(){return Boolean(v._layoutResetTransform)},pointTo:function(R){k=R.projection,T=R.getLatestValues(),I==null||I(),I=Ny(R.onSetAxisTarget(B.scheduleUpdateLayoutProjection),R.onLayoutAnimationComplete(function(){var X;B.isPresent?B.presence=Fy.Present:(X=B.layoutSafeToRemove)===null||X===void 0||X.call(B)}))},isPresent:!0,presence:Fy.Entering});return B}};function YNe(e){e.resolveRelativeTargetBox()}function ZNe(e){e.updateLayoutProjection()}var rG=ma(["initial"],pr(AR)),JNe=rG.length,QNe=new Set(["width","height","top","left","right","bottom","x","y"]),iG=function(e){return QNe.has(e)},eDe=function(e){return Object.keys(e).some(iG)},aG=function(e,t){e.set(t,!1),e.set(t)},oG=function(e){return e===bh||e===Tt},sG;(function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"})(sG||(sG={}));var uG=function(e,t){return parseFloat(e.split(", ")[t])},lG=function(e,t){return function(n,r){var i=r.transform;if(i==="none"||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return uG(a[1],t);var o=i.match(/^matrix\((.+)\)$/);return o?uG(o[1],e):0}},tDe=new Set(["x","y","z"]),nDe=Sy.filter(function(e){return!tDe.has(e)});function rDe(e){var t=[];return nDe.forEach(function(n){var r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.syncRender(),t}var cG={width:function(e){var t=e.x;return t.max-t.min},height:function(e){var t=e.y;return t.max-t.min},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:lG(4,13),y:lG(5,14)},iDe=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),o=a.display,s=a.top,u=a.left,l=a.bottom,c=a.right,f=a.transform,d={top:s,left:u,bottom:l,right:c,transform:f};o==="none"&&t.setStaticValue("display",e.display||"block"),t.syncRender();var h=t.measureViewportBox();return n.forEach(function(p){var g=t.getValue(p);aG(g,cG[p](r,d)),e[p]=cG[p](h,a)}),e},aDe=function(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),t=Ie({},t),r=Ie({},r);var i=Object.keys(t).filter(iG),a=[],o=!1,s=[];if(i.forEach(function(l){var c=e.getValue(l);if(!!e.hasValue(l)){var f=n[l],d=t[l],h=F_(f),p;if(Oy(d))for(var g=d.length,m=d[0]===null?1:0;m<g;m++)p?yy(F_(d[m])===p):p=F_(d[m]);else p=F_(d);if(h!==p)if(oG(h)&&oG(p)){var v=c.get();typeof v=="string"&&c.set(parseFloat(v)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===Tt&&(t[l]=d.map(parseFloat))}else(h==null?void 0:h.transform)&&(p==null?void 0:p.transform)&&(f===0||d===0)?f===0?c.set(p.transform(f)):t[l]=h.transform(d):(o||(a=rDe(e),o=!0),s.push(l),r[l]=r[l]!==void 0?r[l]:t[l],aG(c,d))}}),s.length){var u=iDe(t,e,s);return a.length&&a.forEach(function(l){var c=pr(l,2),f=c[0],d=c[1];e.getValue(f).set(d)}),e.syncRender(),{target:u,transitionEnd:r}}else return{target:t,transitionEnd:r}};function oDe(e,t,n,r){return eDe(t)?aDe(e,t,n,r):{target:t,transitionEnd:r}}var sDe=function(e,t,n,r){var i=TNe(e,t,r);return t=i.target,r=i.transitionEnd,oDe(e,t,n,r)};function uDe(e){return window.getComputedStyle(e)}var fG={treeType:"dom",readValueFromInstance:function(e,t){if(y_(t)){var n=_R(t);return n&&n.default||0}else{var r=uDe(e);return(JV(t)?r.getPropertyValue(t):r[t])||0}},sortNodePosition:function(e,t){return e.compareDocumentPosition(t)&2?1:-1},getBaseTarget:function(e,t){var n;return(n=e.style)===null||n===void 0?void 0:n[t]},measureViewportBox:function(e,t){var n=t.transformPagePoint;return CH(e,n)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var i=n.transformValues;r===void 0&&(r=!0);var a=t.transition,o=t.transitionEnd,s=ko(t,["transition","transitionEnd"]),u=BIe(s,a||{},e);if(i&&(o&&(o=i(o)),s&&(s=i(s)),u&&(u=i(u))),r){$Ie(e,s,u);var l=sDe(e,s,u,o);o=l.transitionEnd,s=l.target}return Ie({transition:a,transitionEnd:o},s)},scrapeMotionValuesFromProps:sR,build:function(e,t,n,r,i,a,o){e.isVisible!==void 0&&(t.style.visibility=e.isVisible?"visible":"hidden");var s=r.isEnabled&&i.isHydrated;rR(t,n,r,i,a,o.transformTemplate,s?B_:void 0,s?tG:void 0)},render:pq},lDe=nG(fG),cDe=nG(Ie(Ie({},fG),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return y_(t)?((n=_R(t))===null||n===void 0?void 0:n.default)||0:(t=gq.has(t)?t:hq(t),e.getAttribute(t))},scrapeMotionValuesFromProps:vq,build:function(e,t,n,r,i,a,o){var s=r.isEnabled&&i.isHydrated;oR(t,n,r,i,a,o.transformTemplate,s?B_:void 0,s?tG:void 0)},render:mq})),fDe=function(e,t){return ZD(e)?cDe(t,{enableHardwareAcceleration:!1}):lDe(t,{enableHardwareAcceleration:!0})},dDe=Ie(Ie(Ie(Ie({},YIe),vIe),ANe),UNe),dG=vTe(function(e,t){return sOe(e,t,dDe,fDe)});function hDe(){var e=Jt(!1),t=pr(an(0),2),n=t[0],r=t[1];return dR(function(){return e.current=!0}),st(function(){!e.current&&r(n+1)},[n])}var hG=0;function pDe(){var e=hG;return hG++,e}var $R=function(e){var t=e.children,n=e.initial,r=e.isPresent,i=e.onExitComplete,a=e.custom,o=e.presenceAffectsLayout,s=xy(gDe),u=xy(pDe),l=xr(function(){return{id:u,initial:n,isPresent:r,custom:a,onExitComplete:function(c){s.set(c,!0);var f=!0;s.forEach(function(d){d||(f=!1)}),f&&(i==null||i())},register:function(c){return s.set(c,!1),function(){return s.delete(c)}}}},o?void 0:[r]);return xr(function(){s.forEach(function(c,f){return s.set(f,!1)})},[r]),qt(function(){!r&&!s.size&&(i==null||i())},[r]),ue(by.Provider,{value:l},t)};function gDe(){return new Map}function sm(e){return e.key||""}function mDe(e,t){e.forEach(function(n){var r=sm(n);t.set(r,n)})}function vDe(e){var t=[];return x2.forEach(e,function(n){ph(n)&&t.push(n)}),t}var pG=function(e){var t=e.children,n=e.custom,r=e.initial,i=r===void 0?!0:r,a=e.onExitComplete,o=e.exitBeforeEnter,s=e.presenceAffectsLayout,u=s===void 0?!0:s,l=hDe(),c=Un(JH);Sh(c)&&(l=c.forceUpdate);var f=Jt(!0),d=vDe(t),h=Jt(d),p=Jt(new Map).current,g=Jt(new Set).current;if(mDe(d,p),f.current)return f.current=!1,ue(Vi,null,d.map(function(S){return ue($R,{key:sm(S),isPresent:!0,initial:i?void 0:!1,presenceAffectsLayout:u},S)}));for(var m=ma([],pr(d)),v=h.current.map(sm),y=d.map(sm),b=v.length,x=0;x<b;x++){var w=v[x];y.indexOf(w)===-1?g.add(w):g.delete(w)}return o&&g.size&&(m=[]),g.forEach(function(S){if(y.indexOf(S)===-1){var C=p.get(S);if(!!C){var _=v.indexOf(S),E=function(){p.delete(S),g.delete(S);var A=h.current.findIndex(function(k){return k.key===S});h.current.splice(A,1),g.size||(h.current=d,l(),a&&a())};m.splice(_,0,ue($R,{key:sm(C),isPresent:!1,onExitComplete:E,custom:n,presenceAffectsLayout:u},C))}}}),m=m.map(function(S){var C=S.key;return g.has(C)?S:ue($R,{key:sm(S),isPresent:!0,presenceAffectsLayout:u},S)}),h.current=m,ue(Vi,null,g.size?m:m.map(function(S){return sf(S)}))};function j_(){return j_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j_.apply(this,arguments)}var LR={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},$y={scale:{enter:{scale:1},exit:{scale:.95}},fade:{enter:{opacity:1},exit:{opacity:0}},pushLeft:{enter:{x:"100%"},exit:{x:"-30%"}},pushRight:{enter:{x:"-100%"},exit:{x:"30%"}},pushUp:{enter:{y:"100%"},exit:{y:"-30%"}},pushDown:{enter:{y:"-100%"},exit:{y:"30%"}},slideLeft:{position:{left:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"-100%"}},slideRight:{position:{right:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"100%"}},slideUp:{position:{top:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"-100%"}},slideDown:{position:{bottom:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"100%"}}};function BR(e){var t,n=(t=e==null?void 0:e.direction)!=null?t:"right";switch(n){case"right":return $y.slideRight;case"left":return $y.slideLeft;case"bottom":return $y.slideDown;case"top":return $y.slideUp;default:return $y.slideRight}}var gG={enter:{duration:.2,ease:LR.easeOut},exit:{duration:.1,ease:LR.easeIn}},U_={enter:(e,t)=>j_({},e,{delay:ff(t)?t:t==null?void 0:t.enter}),exit:(e,t)=>j_({},e,{delay:ff(t)?t:t==null?void 0:t.exit})},yDe={enter:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:1,transition:(n=r==null?void 0:r.enter)!=null?n:U_.enter(gG.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:0,transition:(n=r==null?void 0:r.exit)!=null?n:U_.exit(gG.exit,a),transitionEnd:i==null?void 0:i.exit}}},bDe={initial:"exit",animate:"enter",exit:"exit",variants:yDe};function xDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ly(){return Ly=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ly.apply(this,arguments)}var mG={exit:{duration:.15,ease:LR.easeInOut},enter:{type:"spring",damping:25,stiffness:180}},wDe={exit:e=>{var t,{direction:n,transition:r,transitionEnd:i,delay:a}=e,{exit:o}=BR({direction:n});return Ly({},o,{transition:(t=r==null?void 0:r.exit)!=null?t:U_.exit(mG.exit,a),transitionEnd:i==null?void 0:i.exit})},enter:e=>{var t,{direction:n,transitionEnd:r,transition:i,delay:a}=e,{enter:o}=BR({direction:n});return Ly({},o,{transition:(t=i==null?void 0:i.enter)!=null?t:U_.enter(mG.enter,a),transitionEnd:r==null?void 0:r.enter})}},_De=Gl((e,t)=>{var{direction:n="right",style:r,unmountOnExit:i,in:a,className:o,transition:s,transitionEnd:u,delay:l}=e,c=xDe(e,["direction","style","unmountOnExit","in","className","transition","transitionEnd","delay"]),f=BR({direction:n}),d=Object.assign({position:"fixed"},f.position,r),h=i?a&&i:!0,p=a||i?"enter":"exit",g={transitionEnd:u,transition:s,direction:n,delay:l};return ue(pG,{custom:g},h&&ue(dG.div,Ly({ref:t,initial:"exit",className:Wn("chakra-slide",o),animate:p,exit:"exit",custom:g,variants:wDe,style:d},c)))});function vG(e){return e.sort((t,n)=>{var r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var SDe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function yG(e,t,n){var r=e+1;return n&&r>=t&&(r=0),r}function bG(e,t,n){var r=e-1;return n&&r<0&&(r=t),r}var zR=typeof window!="undefined"?of:qt,W_=e=>e;function jR(){return jR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jR.apply(this,arguments)}function Sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class EDe{constructor(){var t=this;Sr(this,"descendants",new Map),Sr(this,"register",n=>{if(n!=null)return SDe(n)?this.registerNode(n):r=>{this.registerNode(r,n)}}),Sr(this,"unregister",n=>{this.descendants.delete(n);var r=vG(Array.from(this.descendants.keys()));this.assignIndex(r)}),Sr(this,"destroy",()=>{this.descendants.clear()}),Sr(this,"assignIndex",n=>{this.descendants.forEach(r=>{var i=n.indexOf(r.node);r.index=i,r.node.dataset.index=r.index.toString()})}),Sr(this,"count",()=>this.descendants.size),Sr(this,"enabledCount",()=>this.enabledValues().length),Sr(this,"values",()=>{var n=Array.from(this.descendants.values());return n.sort((r,i)=>r.index-i.index)}),Sr(this,"enabledValues",()=>this.values().filter(n=>!n.disabled)),Sr(this,"item",n=>{if(this.count()!==0)return this.values()[n]}),Sr(this,"enabledItem",n=>{if(this.enabledCount()!==0)return this.enabledValues()[n]}),Sr(this,"first",()=>this.item(0)),Sr(this,"firstEnabled",()=>this.enabledItem(0)),Sr(this,"last",()=>this.item(this.descendants.size-1)),Sr(this,"lastEnabled",()=>{var n=this.enabledValues().length-1;return this.enabledItem(n)}),Sr(this,"indexOf",n=>{var r,i;return n&&(r=(i=this.descendants.get(n))==null?void 0:i.index)!=null?r:-1}),Sr(this,"enabledIndexOf",n=>n==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(n))),Sr(this,"next",function(n,r){r===void 0&&(r=!0);var i=yG(n,t.count(),r);return t.item(i)}),Sr(this,"nextEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=yG(a,t.enabledCount(),r);return t.enabledItem(o)}}),Sr(this,"prev",function(n,r){r===void 0&&(r=!0);var i=bG(n,t.count()-1,r);return t.item(i)}),Sr(this,"prevEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=bG(a,t.enabledCount()-1,r);return t.enabledItem(o)}}),Sr(this,"registerNode",(n,r)=>{if(!(!n||this.descendants.has(n))){var i=Array.from(this.descendants.keys()).concat(n),a=vG(i);r!=null&&r.disabled&&(r.disabled=!!r.disabled);var o=jR({node:n,index:-1},r);this.descendants.set(n,o),this.assignIndex(a)}})}}function CDe(){var[e]=an(()=>new EDe);return zR(()=>()=>e.destroy()),e}var[ADe,xG]=Mu({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function kDe(e){var t=xG(),[n,r]=an(-1),i=Jt(null);zR(()=>()=>{!i.current||t.unregister(i.current)},[]),zR(()=>{if(!!i.current){var o=Number(i.current.dataset.index);n!=o&&!Number.isNaN(o)&&r(o)}});var a=W_(e?t.register(e):t.register);return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(i.current),register:df(a,i)}}function TDe(){var e=W_(ADe),t=()=>W_(xG()),n=i=>kDe(i),r=()=>CDe();return[e,t,r,n]}function By(){return By=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},By.apply(this,arguments)}var ODe=e=>ue(my,By({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})),IDe=e=>ue(my,By({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})),wG=e=>ue(my,By({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"}));function Jl(){return Jl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jl.apply(this,arguments)}function NDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var _G={info:{icon:IDe,colorScheme:"blue"},warning:{icon:wG,colorScheme:"orange"},success:{icon:ODe,colorScheme:"green"},error:{icon:wG,colorScheme:"red"}},[DDe,RDe]=Mu({name:"AlertContext",errorMessage:"useAlertContext: `context` is undefined. Seems you forgot to wrap alert components in `<Alert />`"}),FDe=Mt((e,t)=>{var n,r=Ao(e),{status:i="info"}=r,a=NDe(r,["status"]),o=(n=e.colorScheme)!=null?n:_G[i].colorScheme,s=hf("Alert",Jl({},e,{colorScheme:o})),u=Jl({width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden"},s.container);return ue(DDe,{value:{status:i}},ue(dy,{value:s},ue(xt.div,Jl({role:"alert",ref:t},a,{className:Wn("chakra-alert",e.className),__css:u}))))}),MDe=Mt((e,t)=>{var n=vi();return ue(xt.div,Jl({ref:t},e,{className:Wn("chakra-alert__title",e.className),__css:n.title}))}),PDe=Mt((e,t)=>{var n=vi(),r=Jl({display:"inline"},n.description);return ue(xt.div,Jl({ref:t},e,{className:Wn("chakra-alert__desc",e.className),__css:r}))}),$De=e=>{var{status:t}=RDe(),{icon:n}=_G[t],r=vi();return ue(xt.span,Jl({display:"inherit"},e,{className:Wn("chakra-alert__icon",e.className),__css:r.icon}),ue(n,{w:"100%",h:"100%"}))},UR={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},LDe=xt("span",{baseStyle:UR});xt("input",{baseStyle:UR});function V_(){return V_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V_.apply(this,arguments)}function BDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var zDe=qW({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),jDe=Mt((e,t)=>{var n=yh("Spinner",e),r=Ao(e),{label:i="Loading...",thickness:a="2px",speed:o="0.45s",emptyColor:s="transparent",className:u}=r,l=BDe(r,["label","thickness","speed","emptyColor","className"]),c=Wn("chakra-spinner",u),f=V_({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:a,borderBottomColor:s,borderLeftColor:s,animation:zDe+" "+o+" linear infinite"},n);return ue(xt.div,V_({ref:t,__css:f,className:c},l),i&&ue(LDe,null,i))}),[pOt,UDe]=Mu({strict:!1,name:"ButtonGroupContext"});function WR(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function bf(){return bf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bf.apply(this,arguments)}var SG=Mt((e,t)=>{var n,r=UDe(),i=yh("Button",bf({},r,e)),a=Ao(e),{isDisabled:o=r==null?void 0:r.isDisabled,isLoading:s,isActive:u,isFullWidth:l,children:c,leftIcon:f,rightIcon:d,loadingText:h,iconSpacing:p="0.5rem",type:g,spinner:m,spinnerPlacement:v="start",className:y,as:b}=a,x=WR(a,["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"]),w=Ru({},(n=i==null?void 0:i._focus)!=null?n:{},{zIndex:1}),S=bf({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:l?"100%":"auto"},i,!!r&&{_focus:w}),{ref:C,type:_}=WDe(b);return ue(xt.button,bf({disabled:o||s,ref:df(t,C),as:b,type:g??_,"data-active":Ii(u),"data-loading":Ii(s),__css:S,className:Wn("chakra-button",y)},x),f&&!s&&ue(EG,{marginEnd:p},f),s&&v==="start"&&ue(CG,{className:"chakra-button__spinner--start",label:h,placement:"start"},m),s?h||ue(xt.span,{opacity:0},c):c,s&&v==="end"&&ue(CG,{className:"chakra-button__spinner--end",label:h,placement:"end"},m),d&&!s&&ue(EG,{marginStart:p},d))});function WDe(e){var[t,n]=an(!e),r=st(a=>{!a||n(a.tagName==="BUTTON")},[]),i=t?"button":void 0;return{ref:r,type:i}}var EG=e=>{var{children:t,className:n}=e,r=WR(e,["children","className"]),i=ph(t)?sf(t,{"aria-hidden":!0,focusable:!1}):t,a=Wn("chakra-button__icon",n);return ue(xt.span,bf({display:"inline-flex",alignSelf:"center",flexShrink:0},r,{className:a}),i)},CG=e=>{var{label:t,placement:n,children:r=ue(jDe,{color:"currentColor",width:"1em",height:"1em"}),className:i,__css:a}=e,o=WR(e,["label","placement","spacing","children","className","__css"]),s=Wn("chakra-button__spinner",i),u=n==="start"?"marginEnd":"marginStart",l=bf({display:"flex",alignItems:"center",position:t?"relative":"absolute",[u]:t?"0.5rem":0,fontSize:"1em",lineHeight:"normal"},a);return ue(xt.div,bf({className:s},o,{__css:l}),r)};function VR(){return VR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VR.apply(this,arguments)}function VDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var q_=Mt((e,t)=>{var{icon:n,children:r,isRound:i,"aria-label":a}=e,o=VDe(e,["icon","children","isRound","aria-label"]),s=n||r,u=ph(s)?sf(s,{"aria-hidden":!0,focusable:!1}):null;return ue(SG,VR({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":a},o),u)});function um(){return um=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},um.apply(this,arguments)}function qDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function HDe(e){e===void 0&&(e={});var{defaultIsChecked:t,defaultChecked:n=t,isChecked:r,isFocusable:i,isDisabled:a,isReadOnly:o,isRequired:s,onChange:u,isIndeterminate:l,isInvalid:c,name:f,value:d,id:h,onBlur:p,onFocus:g,"aria-label":m,"aria-labelledby":v,"aria-invalid":y,"aria-describedby":b}=e,x=qDe(e,["defaultIsChecked","defaultChecked","isChecked","isFocusable","isDisabled","isReadOnly","isRequired","onChange","isIndeterminate","isInvalid","name","value","id","onBlur","onFocus","aria-label","aria-labelledby","aria-invalid","aria-describedby"]),w=uy(u),S=uy(p),C=uy(g),[_,E]=fD(),[A,k]=fD(),[T,I]=fD(),N=Jt(null),[O,D]=an(!0),[L,W]=an(!!n),[G,K]=Iwe(r,L);sD({condition:!!t,message:'The "defaultIsChecked" prop has been deprecated and will be removed in a future version. Please use the "defaultChecked" prop instead, which mirrors default React checkbox behavior.'});var ee=st(F=>{if(o||a){F.preventDefault();return}G||W(K?F.target.checked:l?!0:F.target.checked),w==null||w(F)},[o,a,K,G,l,w]);Kg(()=>{N.current&&(N.current.indeterminate=Boolean(l))},[l]);var ce=a&&!i,he=st(F=>{F.key===" "&&I.on()},[I]),Oe=st(F=>{F.key===" "&&I.off()},[I]);Kg(()=>{if(!!N.current){var F=N.current.checked!==K;F&&W(N.current.checked)}},[N.current]);var Te=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=Y=>{Y.preventDefault(),I.on()};return um({},F,{ref:V,"data-active":Ii(T),"data-hover":Ii(A),"data-checked":Ii(K),"data-focus":Ii(_),"data-indeterminate":Ii(l),"data-disabled":Ii(a),"data-invalid":Ii(c),"data-readonly":Ii(o),"aria-hidden":!0,onMouseDown:wr(F.onMouseDown,ae),onMouseUp:wr(F.onMouseUp,I.off),onMouseEnter:wr(F.onMouseEnter,k.on),onMouseLeave:wr(F.onMouseLeave,k.off)})},[T,K,a,_,A,l,c,o,I,k.off,k.on]),De=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),um({},x,F,{ref:df(V,ae=>{!ae||D(ae.tagName==="LABEL")}),onClick:wr(F.onClick,()=>{if(!O){var ae;(ae=N.current)==null||ae.click(),qg(N.current,{nextTick:!0})}}),"data-disabled":Ii(a)})},[x,a,O]),me=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=()=>{mwe(E.on)};return um({},F,{ref:df(N,V),type:"checkbox",name:f,value:d,id:h,onChange:wr(F.onChange,ee),onBlur:wr(F.onBlur,S,E.off),onFocus:wr(F.onFocus,C,ae),onKeyDown:wr(F.onKeyDown,he),onKeyUp:wr(F.onKeyUp,Oe),required:s,checked:K,disabled:ce,readOnly:o,"aria-label":m,"aria-labelledby":v,"aria-invalid":y?Boolean(y):c,"aria-describedby":b,"aria-disabled":a,style:UR})},[f,d,h,ee,E.off,E.on,S,C,he,Oe,s,K,ce,o,m,v,y,c,b,a]),P=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),um({},F,{ref:V,onMouseDown:wr(F.onMouseDown,AG),onTouchStart:wr(F.onTouchStart,AG),"data-disabled":Ii(a),"data-checked":Ii(K),"data-invalid":Ii(c)})},[K,a,c]);return{state:{isInvalid:c,isFocused:_,isChecked:K,isActive:T,isHovered:A,isIndeterminate:l,isDisabled:a,isReadOnly:o,isRequired:s},getRootProps:De,getCheckboxProps:Te,getInputProps:me,getLabelProps:P,htmlProps:x}}function AG(e){e.preventDefault(),e.stopPropagation()}function GDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function zy(){return zy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zy.apply(this,arguments)}var KDe=e=>ue(my,zy({focusable:"false","aria-hidden":!0},e),ue("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})),XDe=Mt((e,t)=>{var n=yh("CloseButton",e),r=Ao(e),{children:i,isDisabled:a,__css:o}=r,s=GDe(r,["children","isDisabled","__css"]),u={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return ue(xt.button,zy({type:"button","aria-label":"Close",ref:t,disabled:a,__css:zy({},u,n,o)},s),i||ue(KDe,{width:"1em",height:"1em"}))}),[gOt,YDe]=Mu({strict:!1,name:"FormControlContext"});function H_(){return H_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H_.apply(this,arguments)}function kG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function TG(e){var t=ZDe(e),{isDisabled:n,isInvalid:r,isReadOnly:i,isRequired:a}=t,o=kG(t,["isDisabled","isInvalid","isReadOnly","isRequired"]);return H_({},o,{disabled:n,readOnly:i,required:a,"aria-invalid":oD(r),"aria-required":oD(a),"aria-readonly":oD(i)})}function ZDe(e){var t,n,r,i=YDe(),{id:a,disabled:o,readOnly:s,required:u,isRequired:l,isInvalid:c,isReadOnly:f,isDisabled:d,onFocus:h,onBlur:p}=e,g=kG(e,["id","disabled","readOnly","required","isRequired","isInvalid","isReadOnly","isDisabled","onFocus","onBlur"]),m=[];return i!=null&&i.hasFeedbackText&&i!=null&&i.isInvalid&&m.push(i.feedbackId),i!=null&&i.hasHelpText&&m.push(i.helpTextId),H_({},g,{"aria-describedby":m.join(" ")||void 0,id:a??(i==null?void 0:i.id),isDisabled:(t=o??d)!=null?t:i==null?void 0:i.isDisabled,isReadOnly:(n=s??f)!=null?n:i==null?void 0:i.isReadOnly,isRequired:(r=u??l)!=null?r:i==null?void 0:i.isRequired,isInvalid:c??(i==null?void 0:i.isInvalid),onFocus:wr(i==null?void 0:i.onFocus,h),onBlur:wr(i==null?void 0:i.onBlur,p)})}function qR(){return qR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qR.apply(this,arguments)}var OG=Mt((e,t)=>{var n=hf("Input",e),r=Ao(e),i=TG(r),a=Wn("chakra-input",e.className);return ue(xt.input,qR({},i,{__css:n.field,ref:t,className:a}))});OG.id="Input";var G_=xt("div");function HR(){return HR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HR.apply(this,arguments)}function JDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var QDe=Mt((e,t)=>{var{direction:n,align:r,justify:i,wrap:a,basis:o,grow:s,shrink:u}=e,l=JDe(e,["direction","align","justify","wrap","basis","grow","shrink"]),c={display:"flex",flexDirection:n,alignItems:r,justifyContent:i,flexWrap:a,flexBasis:o,flexGrow:s,flexShrink:u};return ue(xt.div,HR({ref:t,__css:c},l))});function K_(){return K_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K_.apply(this,arguments)}function IG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var NG=Mt((e,t)=>{var{area:n,templateAreas:r,gap:i,rowGap:a,columnGap:o,column:s,row:u,autoFlow:l,autoRows:c,templateRows:f,autoColumns:d,templateColumns:h}=e,p=IG(e,["area","templateAreas","gap","rowGap","columnGap","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns"]),g={display:"grid",gridArea:n,gridTemplateAreas:r,gridGap:i,gridRowGap:a,gridColumnGap:o,gridAutoColumns:d,gridColumn:s,gridRow:u,gridAutoFlow:l,gridAutoRows:c,gridTemplateRows:f,gridTemplateColumns:h};return ue(xt.div,K_({ref:t,__css:g},p))});function DG(e){return sy(e,t=>t==="auto"?"auto":"span "+t+"/span "+t)}var Eh=Mt((e,t)=>{var{colSpan:n,colStart:r,colEnd:i,rowEnd:a,rowSpan:o,rowStart:s}=e,u=IG(e,["colSpan","colStart","colEnd","rowEnd","rowSpan","rowStart"]),l=X2({gridColumn:DG(n),gridRow:DG(o),gridColumnStart:r,gridColumnEnd:i,gridRowStart:s,gridRowEnd:a});return ue(xt.div,K_({ref:t,__css:l},u))});function GR(){return GR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GR.apply(this,arguments)}function eRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var tRe=Mt((e,t)=>{var n=yh("Heading",e),r=Ao(e),i=eRe(r,["className"]);return ue(xt.h2,GR({ref:t,className:Wn("chakra-heading",e.className)},i,{__css:n}))});function KR(){return KR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KR.apply(this,arguments)}function nRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var rRe=Mt((e,t)=>{var n=yh("Link",e),r=Ao(e),{className:i,isExternal:a}=r,o=nRe(r,["className","isExternal"]);return ue(xt.a,KR({target:a?"_blank":void 0,rel:a?"noopener noreferrer":void 0,ref:t,className:Wn("chakra-link",i)},o,{__css:n}))});function lm(){return lm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lm.apply(this,arguments)}function RG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iRe=Mt((e,t)=>{var n=hf("List",e),r=Ao(e),{children:i,styleType:a="none",stylePosition:o,spacing:s}=r,u=RG(r,["children","styleType","stylePosition","spacing"]),l=cD(i),c="& > *:not(style) ~ *:not(style)",f=s?{[c]:{mt:s}}:{};return ue(dy,{value:n},ue(xt.ul,lm({ref:t,listStyleType:a,listStylePosition:o,role:"list",__css:lm({},n.container,f)},u),l))}),aRe=Mt((e,t)=>{var n=RG(e,["as"]);return ue(iRe,lm({ref:t,as:"ul",styleType:"initial",marginStart:"1em"},n))}),oRe=Mt((e,t)=>{var n=vi();return ue(xt.li,lm({ref:t},e,{__css:n.item}))});function XR(){return XR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XR.apply(this,arguments)}function sRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var uRe=Mt((e,t)=>{var{columns:n,spacingX:r,spacingY:i,spacing:a,minChildWidth:o}=e,s=sRe(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),u=o?cRe(o):fRe(n);return ue(NG,XR({ref:t,gap:a,columnGap:r,rowGap:i,templateColumns:u},s))});function lRe(e){return ff(e)?e+"px":e}function cRe(e){return sy(e,t=>GW(t)?null:"repeat(auto-fit, minmax("+lRe(t)+", 1fr))")}function fRe(e){return sy(e,t=>GW(t)?null:"repeat("+t+", minmax(0, 1fr))")}var dRe=xt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}}),YR="& > *:not(style) ~ *:not(style)";function hRe(e){var{spacing:t,direction:n}=e,r={column:{marginTop:t,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:t},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:t,marginStart:0},"row-reverse":{marginTop:0,marginEnd:t,marginBottom:0,marginStart:0}};return{flexDirection:n,[YR]:sy(n,i=>r[i])}}function pRe(e){var{spacing:t,direction:n}=e,r={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":sy(n,i=>r[i])}}function gRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function cm(){return cm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cm.apply(this,arguments)}var mRe=e=>ue(xt.div,cm({className:"chakra-stack__item"},e,{__css:cm({display:"inline-block",flex:"0 0 auto",minWidth:0},e.__css)})),FG=Mt((e,t)=>{var{isInline:n,direction:r,align:i,justify:a,spacing:o="0.5rem",wrap:s,children:u,divider:l,className:c,shouldWrapChildren:f}=e,d=gRe(e,["isInline","direction","align","justify","spacing","wrap","children","divider","className","shouldWrapChildren"]),h=n?"row":r??"column",p=xr(()=>hRe({direction:h,spacing:o}),[h,o]),g=xr(()=>pRe({spacing:o,direction:h}),[o,h]),m=!!l,v=!f&&!m,y=cD(u),b=v?y:y.map((w,S)=>{var C=S+1===y.length,_=ue(mRe,{key:S},w),E=f?_:w;if(!m)return E;var A=sf(l,{__css:g}),k=C?null:A;return ue(Vi,{key:S},E,k)}),x=Wn("chakra-stack",c);return ue(xt.div,cm({ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:p.flexDirection,flexWrap:s,className:x,__css:m?{}:{[YR]:p[YR]}},d),b)}),vRe=Mt((e,t)=>ue(FG,cm({align:"center"},e,{direction:"row",ref:t})));function ZR(){return ZR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZR.apply(this,arguments)}function yRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var bRe=Mt((e,t)=>{var n=yh("Text",e),r=Ao(e),i=yRe(r,["className","align","decoration","casing"]),a=X2({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return ue(xt.p,ZR({ref:t,className:Wn("chakra-text",e.className)},a,i,{__css:n}))});function xf(){return xf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xf.apply(this,arguments)}function JR(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var xRe=Mt((e,t)=>{var n=hf("Table",e),r=Ao(e),{className:i}=r,a=JR(r,["className"]);return ue(dy,{value:n},ue(xt.table,xf({role:"table",ref:t,__css:n.table,className:Wn("chakra-table",i)},a)))}),wRe=Mt((e,t)=>{var n=vi();return ue(xt.thead,xf({},e,{ref:t,__css:n.thead}))}),_Re=Mt((e,t)=>{var n=vi();return ue(xt.tbody,xf({},e,{ref:t,__css:n.tbody}))}),SRe=Mt((e,t)=>{var{isNumeric:n}=e,r=JR(e,["isNumeric"]),i=vi();return ue(xt.th,xf({},r,{ref:t,__css:i.th,"data-is-numeric":n}))}),ERe=Mt((e,t)=>{var n=vi();return ue(xt.tr,xf({role:"row"},e,{ref:t,__css:n.tr}))}),CRe=Mt((e,t)=>{var{isNumeric:n}=e,r=JR(e,["isNumeric"]),i=vi();return ue(xt.td,xf({role:"gridcell"},r,{ref:t,__css:i.td,"data-is-numeric":n}))});function ARe(){var e=Jt(new Map),t=e.current,n=st((i,a,o,s)=>{e.current.set(o,{type:a,el:i,options:s}),i.addEventListener(a,o,s)},[]),r=st((i,a,o,s)=>{i.removeEventListener(a,o,s),e.current.delete(o)},[]);return qt(()=>()=>{t.forEach((i,a)=>{r(i.el,i.type,a,i.options)})},[r,t]),{add:n,remove:r}}function X_(){return X_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X_.apply(this,arguments)}function kRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function QR(e){var t=e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function TRe(e){e===void 0&&(e={});var{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:i=!0,clickOnSpace:a=!0,onMouseDown:o,onMouseUp:s,onClick:u,onKeyDown:l,onKeyUp:c,tabIndex:f,onMouseOver:d,onMouseLeave:h}=e,p=kRe(e,["ref","isDisabled","isFocusable","clickOnEnter","clickOnSpace","onMouseDown","onMouseUp","onClick","onKeyDown","onKeyUp","tabIndex","onMouseOver","onMouseLeave"]),[g,m]=an(!0),[v,y]=an(!1),b=ARe(),x=L=>{!L||L.tagName!=="BUTTON"&&m(!1)},w=g?f:f||0,S=n&&!r,C=st(L=>{if(n){L.stopPropagation(),L.preventDefault();return}var W=L.currentTarget;W.focus(),u==null||u(L)},[n,u]),_=st(L=>{v&&QR(L)&&(L.preventDefault(),L.stopPropagation(),y(!1),b.remove(document,"keyup",_,!1))},[v,b]),E=st(L=>{if(l==null||l(L),!(n||L.defaultPrevented||L.metaKey)&&!(!QR(L.nativeEvent)||g)){var W=i&&L.key==="Enter",G=a&&L.key===" ";if(G&&(L.preventDefault(),y(!0)),W){L.preventDefault();var K=L.currentTarget;K.click()}b.add(document,"keyup",_,!1)}},[n,g,l,i,a,b,_]),A=st(L=>{if(c==null||c(L),!(n||L.defaultPrevented||L.metaKey)&&!(!QR(L.nativeEvent)||g)){var W=a&&L.key===" ";if(W){L.preventDefault(),y(!1);var G=L.currentTarget;G.click()}}},[a,g,n,c]),k=st(L=>{L.button===0&&(y(!1),b.remove(document,"mouseup",k,!1))},[b]),T=st(L=>{if(!QW(L)){if(n){L.stopPropagation(),L.preventDefault();return}g||y(!0);var W=L.currentTarget;W.focus({preventScroll:!0}),b.add(document,"mouseup",k,!1),o==null||o(L)}},[n,g,o,b,k]),I=st(L=>{QW(L)||(g||y(!1),s==null||s(L))},[s,g]),N=st(L=>{if(n){L.preventDefault();return}d==null||d(L)},[n,d]),O=st(L=>{v&&(L.preventDefault(),y(!1)),h==null||h(L)},[v,h]),D=df(t,x);return g?X_({},p,{ref:D,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:C,onMouseDown:o,onMouseUp:s,onKeyUp:c,onKeyDown:l,onMouseOver:d,onMouseLeave:h}):X_({},p,{ref:D,role:"button","data-active":Ii(v),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:w,onClick:C,onMouseDown:T,onMouseUp:I,onKeyUp:A,onKeyDown:E,onMouseOver:N,onMouseLeave:O})}function ORe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var IRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NRe=IRe,DRe=NRe;function MG(){}function PG(){}PG.resetWarningCache=MG;var RRe=function(){function e(r,i,a,o,s,u){if(u!==DRe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:PG,resetWarningCache:MG};return n.PropTypes=n,n};RRe();var eF="data-focus-lock",$G="data-focus-lock-disabled",FRe="data-no-focus-lock",MRe="data-autofocus-inside";function PRe(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function $Re(e,t){var n=an(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function LG(e,t){return $Re(t,function(n){return e.forEach(function(r){return PRe(r,n)})})}var tF={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Y_=function(){return Y_=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Y_.apply(this,arguments)};function LRe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function BG(e){return e}function zG(e,t){t===void 0&&(t=BG);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=t(a,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(r=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(a),o=n}var u=function(){var c=o;o=[],c.forEach(a)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){o.push(c),l()},filter:function(c){return o=o.filter(c),n}}}};return i}function nF(e,t){return t===void 0&&(t=BG),zG(e,t)}function jG(e){e===void 0&&(e={});var t=zG(null);return t.options=Y_({async:!0,ssr:!1},e),t}var UG=function(e){var t=e.sideCar,n=LRe(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return ue(r,Y_({},n))};UG.isSideCarExport=!0;function BRe(e,t){return e.useMedium(t),UG}var WG=nF({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),VG=nF(),zRe=nF(),jRe=jG({async:!0}),URe=[],rF=Gl(function(t,n){var r,i=an(),a=i[0],o=i[1],s=Jt(),u=Jt(!1),l=Jt(null),c=t.children,f=t.disabled,d=t.noFocusGuards,h=t.persistentFocus,p=t.crossFrame,g=t.autoFocus;t.allowTextSelection;var m=t.group,v=t.className,y=t.whiteList,b=t.shards,x=b===void 0?URe:b,w=t.as,S=w===void 0?"div":w,C=t.lockProps,_=C===void 0?{}:C,E=t.sideCar,A=t.returnFocus,k=t.onActivation,T=t.onDeactivation,I=an({}),N=I[0],O=st(function(){l.current=l.current||document&&document.activeElement,s.current&&k&&k(s.current),u.current=!0},[k]),D=st(function(){u.current=!1,T&&T(s.current)},[T]),L=st(function(Te){var De=l.current;if(Boolean(A)&&De&&De.focus){var me=typeof A=="object"?A:void 0;l.current=null,Te?Promise.resolve().then(function(){return De.focus(me)}):De.focus(me)}},[A]),W=st(function(Te){u.current&&WG.useMedium(Te)},[]),G=VG.useMedium,K=st(function(Te){s.current!==Te&&(s.current=Te,o(Te))},[]),ee=mh((r={},r[$G]=f&&"disabled",r[eF]=m,r),_),ce=d!==!0,he=ce&&d!=="tail",Oe=LG([n,K]);return ue(Vi,null,ce&&[ue("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:tF}),ue("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:tF})],!f&&ue(E,{id:N,sideCar:jRe,observed:a,disabled:f,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:y,shards:x,onActivation:O,onDeactivation:D,returnFocus:L}),ue(S,mh({ref:Oe},ee,{className:v,onBlur:G,onFocus:W}),c),he&&ue("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:tF}))});rF.propTypes={},rF.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var qG=rF;function iF(e,t){return iF=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},iF(e,t)}function WRe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,iF(e,t)}function VRe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qRe(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var a=[],o;function s(){o=e(a.map(function(l){return l.props})),t(o)}var u=function(l){WRe(c,l);function c(){return l.apply(this,arguments)||this}c.peek=function(){return o};var f=c.prototype;return f.componentDidMount=function(){a.push(this),s()},f.componentDidUpdate=function(){s()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),s()},f.render=function(){return zt.createElement(i,this.props)},c}(b2);return VRe(u,"displayName","SideEffect("+n(i)+")"),u}}var wf=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},aF=function(e){return Array.isArray(e)?e:[e]},HRe=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var a=e[r].compareDocumentPosition(e[i]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,s){return!t.has(s)})},HG=function(e){return e.parentNode?HG(e.parentNode):e},oF=function(e){var t=aF(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(eF);return n.push.apply(n,i?HRe(wf(HG(r).querySelectorAll("["+eF+'="'+i+'"]:not(['+$G+'="disabled"])'))):[r]),n},[])},GRe=function(e){return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},GG=function(e){return!e||e===document||e&&e.nodeType===Node.DOCUMENT_NODE||!GRe(window.getComputedStyle(e,null))&&GG(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode)},KRe=function(e){return!((e.tagName==="INPUT"||e.tagName==="BUTTON")&&(e.type==="hidden"||e.disabled))},sF=function(e){return Boolean(e&&e.dataset&&e.dataset.focusGuard)},Z_=function(e){return!sF(e)},XRe=function(e){return Boolean(e)},YRe=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},KG=function(e,t,n){return wf(e).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!t||r.tabIndex>=0}).sort(YRe)},ZRe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],uF=ZRe.join(","),JRe=uF+", [data-focus-guard]",lF=function(e,t){return e.reduce(function(n,r){return n.concat(wf(r.querySelectorAll(t?JRe:uF)),r.parentNode?wf(r.parentNode.querySelectorAll(uF)).filter(function(i){return i===r}):[])},[])},QRe=function(e){var t=e.querySelectorAll("["+MRe+"]");return wf(t).map(function(n){return lF([n])}).reduce(function(n,r){return n.concat(r)},[])},cF=function(e){return wf(e).filter(function(t){return GG(t)}).filter(function(t){return KRe(t)})},fF=function(e,t){return KG(cF(lF(e,t)),!0,t)},XG=function(e){return KG(cF(lF(e)),!1)},eFe=function(e){return cF(QRe(e))},dF=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&dF(e.parentNode,t),t},hF=function(e,t){for(var n=dF(e),r=dF(t),i=0;i<n.length;i+=1){var a=n[i];if(r.indexOf(a)>=0)return a}return!1},YG=function(e,t,n){var r=aF(e),i=aF(t),a=r[0],o=!1;return i.filter(Boolean).forEach(function(s){o=hF(o||s,s)||o,n.filter(Boolean).forEach(function(u){var l=hF(a,u);l&&(!o||l.contains(o)?o=l:o=hF(l,o))})}),o},tFe=function(e){return e.reduce(function(t,n){return t.concat(eFe(n))},[])},nFe=function(e){var t=oF(e).filter(Z_),n=YG(e,e,t),r=fF([n],!0),i=fF(t).filter(function(a){var o=a.node;return Z_(o)}).map(function(a){var o=a.node;return o});return r.map(function(a){var o=a.node,s=a.index;return{node:o,index:s,lockItem:i.indexOf(o)>=0,guard:sF(o)}})},rFe=function(e){return e===document.activeElement},iFe=function(e){return Boolean(wf(e.querySelectorAll("iframe")).some(function(t){return rFe(t)}))},ZG=function(e){var t=document&&document.activeElement;return!t||t.dataset&&t.dataset.focusGuard?!1:oF(e).reduce(function(n,r){return n||r.contains(t)||iFe(r)},!1)},aFe=function(){return document&&wf(document.querySelectorAll("["+FRe+"]")).some(function(e){return e.contains(document.activeElement)})},JG=function(e){return e.tagName==="INPUT"&&e.type==="radio"},oFe=function(e,t){return t.filter(JG).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},pF=function(e,t){return JG(e)&&e.name?oFe(e,t):e},sFe=function(e){var t=new Set;return e.forEach(function(n){return t.add(pF(n,e))}),e.filter(function(n){return t.has(n)})},QG=function(e){return e[0]&&e.length>1?pF(e[0],e):e[0]},eK=function(e,t){return e.length>1?e.indexOf(pF(e[t],e)):t},tK="NEW_FOCUS",uFe=function(e,t,n,r){var i=e.length,a=e[0],o=e[i-1],s=sF(n);if(!(e.indexOf(n)>=0)){var u=t.indexOf(n),l=r?t.indexOf(r):u,c=r?e.indexOf(r):-1,f=u-l,d=t.indexOf(a),h=t.indexOf(o),p=sFe(t),g=p.indexOf(n)-(r?p.indexOf(r):u),m=eK(e,0),v=eK(e,i-1);if(u===-1||c===-1)return tK;if(!f&&c>=0)return c;if(u<=d&&s&&Math.abs(f)>1)return v;if(u>=h&&s&&Math.abs(f)>1)return m;if(f&&Math.abs(g)>1)return c;if(u<=d)return v;if(u>h)return m;if(f)return Math.abs(f)>1?c:(i+c+f)%i}},lFe=function(e){return function(t){return t.autofocus||t.dataset&&!!t.dataset.autofocus||e.indexOf(t)>=0}},cFe=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(XRe)},fFe=function(e,t){var n=document&&document.activeElement,r=oF(e).filter(Z_),i=YG(n||e,e,r),a=XG(r),o=fF(r).filter(function(d){var h=d.node;return Z_(h)});if(!(!o[0]&&(o=a,!o[0]))){var s=XG([i]).map(function(d){var h=d.node;return h}),u=cFe(s,o),l=u.map(function(d){var h=d.node;return h}),c=uFe(l,s,n,t);if(c===tK){var f=a.map(function(d){var h=d.node;return h}).filter(lFe(tFe(r)));return{node:f&&f.length?QG(f):QG(l)}}return c===void 0?c:u[c]}},dFe=function(e){e.focus(),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},gF=0,mF=!1,hFe=function(e,t){var n=fFe(e,t);if(!mF&&n){if(gF>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),mF=!0,setTimeout(function(){mF=!1},1);return}gF++,dFe(n.node),gF--}},nK=hFe;function rK(e){var t=window,n=t.setImmediate;typeof n!="undefined"?n(e):setTimeout(e,1)}var pFe=function(){return document&&document.activeElement===document.body},gFe=function(){return pFe()||aFe()},fm=null,dm=null,hm=null,jy=!1,mFe=function(){return!0},vFe=function(t){return(fm.whiteList||mFe)(t)},yFe=function(t,n){hm={observerNode:t,portaledElement:n}},bFe=function(t){return hm&&hm.portaledElement===t};function iK(e,t,n,r){var i=null,a=e;do{var o=r[a];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(a!==e)return;i=null}else break}while((a+=n)!==t);i&&(i.node.tabIndex=0)}var xFe=function(t){return t&&"current"in t?t.current:t},wFe=function(t){return t?Boolean(jy):jy==="meanwhile"},J_=function(){var t=!1;if(fm){var n=fm,r=n.observed,i=n.persistentFocus,a=n.autoFocus,o=n.shards,s=n.crossFrame,u=r||hm&&hm.portaledElement,l=document&&document.activeElement;if(u){var c=[u].concat(o.map(xFe).filter(Boolean));if((!l||vFe(l))&&(i||wFe(s)||!gFe()||!dm&&a)&&(u&&!(ZG(c)||bFe(l))&&(document&&!dm&&l&&!a?(l.blur&&l.blur(),document.body.focus()):(t=nK(c,dm),hm={})),jy=!1,dm=document&&document.activeElement),document){var f=document&&document.activeElement,d=nFe(c),h=d.map(function(p){var g=p.node;return g}).indexOf(f);h>-1&&(d.filter(function(p){var g=p.guard,m=p.node;return g&&m.dataset.focusAutoGuard}).forEach(function(p){var g=p.node;return g.removeAttribute("tabIndex")}),iK(h,d.length,1,d),iK(h,-1,-1,d))}}}return t},aK=function(t){J_()&&t&&(t.stopPropagation(),t.preventDefault())},vF=function(){return rK(J_)},_Fe=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||yFe(r,n)},SFe=function(){return null},oK=function(){jy="just",setTimeout(function(){jy="meanwhile"},0)},EFe=function(){document.addEventListener("focusin",aK,!0),document.addEventListener("focusout",vF),window.addEventListener("blur",oK)},CFe=function(){document.removeEventListener("focusin",aK,!0),document.removeEventListener("focusout",vF),window.removeEventListener("blur",oK)};function AFe(e){return e.filter(function(t){var n=t.disabled;return!n})}function kFe(e){var t=e.slice(-1)[0];t&&!fm&&EFe();var n=fm,r=n&&t&&t.id===n.id;fm=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var a=i.id;return a===n.id}).length||n.returnFocus(!t)),t?(dm=null,(!r||n.observed!==t.observed)&&t.onActivation(),J_(),rK(J_)):(CFe(),dm=null)}WG.assignSyncMedium(_Fe),VG.assignMedium(vF),zRe.assignMedium(function(e){return e({moveFocusInside:nK,focusInside:ZG})});var TFe=qRe(AFe,kFe)(SFe),sK=Gl(function(t,n){return ue(qG,mh({sideCar:TFe,ref:n},t))}),uK=qG.propTypes||{};uK.sideCar,ORe(uK,["sideCar"]),sK.propTypes={};var OFe=sK,IFe=e=>{var{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:i,children:a,isDisabled:o,autoFocus:s,persistentFocus:u,lockFocusAcrossFrames:l}=e,c=st(()=>{if(t!=null&&t.current)t.current.focus();else if(r!=null&&r.current){var h=hwe(r.current);h.length===0&&qg(r.current,{nextTick:!0})}},[t,r]),f=st(()=>{var h;n==null||(h=n.current)==null||h.focus()},[n]),d=i&&!n;return ue(OFe,{crossFrame:l,persistentFocus:u,autoFocus:s,disabled:o,onActivation:c,onDeactivation:f,returnFocus:d},a)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var pm=function(){return pm=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},pm.apply(this,arguments)};function NFe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var Q_="right-scroll-bar-position",eS="width-before-scroll-bar",DFe="with-scroll-bars-hidden",RFe="--removed-body-scroll-bar-size",lK=jG(),yF=function(){},tS=Gl(function(e,t){var n=Jt(null),r=an({onScrollCapture:yF,onWheelCapture:yF,onTouchMoveCapture:yF}),i=r[0],a=r[1],o=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,f=e.shards,d=e.sideCar,h=e.noIsolation,p=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,y=NFe(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=d,x=LG([n,t]),w=pm({},y,i);return ue(Vi,null,c&&ue(b,{sideCar:lK,removeScrollBar:l,shards:f,noIsolation:h,inert:p,setCallbacks:a,allowPinchZoom:!!g,lockRef:n}),o?sf(x2.only(s),pm({},w,{ref:x})):ue(v,pm({},w,{className:u,ref:x}),s))});tS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},tS.classNames={fullWidth:eS,zeroRight:Q_};var FFe=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function MFe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=FFe();return t&&e.setAttribute("nonce",t),e}function PFe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function $Fe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var LFe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=MFe())&&(PFe(t,n),$Fe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},BFe=function(){var e=LFe();return function(t){qt(function(){return e.add(t),function(){e.remove()}},[])}},cK=function(){var e=BFe(),t=function(n){var r=n.styles;return e(r),null};return t},zFe={left:0,top:0,right:0,gap:0},bF=function(e){return parseInt(e||"",10)||0},jFe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[bF(n),bF(r),bF(i)]},fK=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return zFe;var t=jFe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},UFe=cK(),WFe=function(e,t,n,r){var i=e.left,a=e.top,o=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`+DFe+` {
   overflow: hidden `+r+`;
   padding-right: `+s+"px "+r+`;
  }
  body {
    overflow: hidden `+r+`;
    `+[t&&"position: relative "+r+";",n==="margin"&&`
    padding-left: `+i+`px;
    padding-top: `+a+`px;
    padding-right: `+o+`px;
    margin-left:0;
    margin-top:0;
    margin-right: `+s+"px "+r+`;
    `,n==="padding"&&"padding-right: "+s+"px "+r+";"].filter(Boolean).join("")+`
  }
  
  .`+Q_+` {
    right: `+s+"px "+r+`;
  }
  
  .`+eS+` {
    margin-right: `+s+"px "+r+`;
  }
  
  .`+Q_+" ."+Q_+` {
    right: 0 `+r+`;
  }
  
  .`+eS+" ."+eS+` {
    margin-right: 0 `+r+`;
  }
  
  body {
    `+RFe+": "+s+`px;
  }
`},VFe=function(e){var t=an(fK(e.gapMode)),n=t[0],r=t[1];qt(function(){r(fK(e.gapMode))},[e.gapMode]);var i=e.noRelative,a=e.noImportant,o=e.gapMode,s=o===void 0?"margin":o;return ue(UFe,{styles:WFe(n,!i,s,a?"":"!important")})},qFe=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},HFe=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},dK=function(e,t){var n=t;do{var r=hK(e,n);if(r){var i=pK(e,n),a=i[1],o=i[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},GFe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},KFe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},hK=function(e,t){return e==="v"?qFe(t):HFe(t)},pK=function(e,t){return e==="v"?GFe(t):KFe(t)},XFe=function(e,t,n,r,i){var a=r,o=n.target,s=t.contains(o),u=!1,l=a>0,c=0,f=0;do{var d=pK(e,o),h=d[0],p=d[1],g=d[2],m=p-g-h;(h||m)&&hK(e,o)&&(c+=m,f+=h),o=o.parentNode}while(!s&&o!==document.body||s&&(t.contains(o)||t===o));return(l&&(i&&c===0||!i&&a>c)||!l&&(i&&f===0||!i&&-a>f))&&(u=!0),u},xF=!1;if(typeof window!="undefined")try{var nS=Object.defineProperty({},"passive",{get:function(){return xF=!0,!0}});window.addEventListener("test",nS,nS),window.removeEventListener("test",nS,nS)}catch(e){xF=!1}var gm=xF?{passive:!1}:!1,rS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},gK=function(e){return[e.deltaX,e.deltaY]},mK=function(e){return e&&"current"in e?e.current:e},YFe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ZFe=function(e){return`
  .block-interactivity-`+e+` {pointer-events: none;}
  .allow-interactivity-`+e+` {pointer-events: all;}
`},JFe=0,mm=[];function QFe(e){var t=Jt([]),n=Jt([0,0]),r=Jt(),i=an(JFe++)[0],a=an(function(){return cK()})[0],o=Jt(e);qt(function(){o.current=e},[e]),qt(function(){if(e.inert){document.body.classList.add("block-interactivity-"+i);var g=[e.lockRef.current].concat((e.shards||[]).map(mK)).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-"+i)}),function(){document.body.classList.remove("block-interactivity-"+i),g.forEach(function(m){return m.classList.remove("allow-interactivity-"+i)})}}},[e.inert,e.lockRef.current,e.shards]);var s=st(function(g,m){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var v=rS(g),y=n.current,b="deltaX"in g?g.deltaX:y[0]-v[0],x="deltaY"in g?g.deltaY:y[1]-v[1],w,S=g.target,C=Math.abs(b)>Math.abs(x)?"h":"v",_=dK(C,S);if(!_)return!0;if(_?w=C:(w=C==="v"?"h":"v",_=dK(C,S)),!_)return!1;if(!r.current&&"changedTouches"in g&&(b||x)&&(r.current=w),!w)return!0;var E=r.current||w;return XFe(E,m,g,E==="h"?b:x,!0)},[]),u=st(function(g){var m=g;if(!(!mm.length||mm[mm.length-1]!==a)){var v="deltaY"in m?gK(m):rS(m),y=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&YFe(w.delta,v)})[0];if(y&&y.should){m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(mK).filter(Boolean).filter(function(w){return w.contains(m.target)}),x=b.length>0?s(m,b[0]):!o.current.noIsolation;x&&m.preventDefault()}}},[]),l=st(function(g,m,v,y){var b={name:g,delta:m,target:v,should:y};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(x){return x!==b})},1)},[]),c=st(function(g){n.current=rS(g),r.current=void 0},[]),f=st(function(g){l(g.type,gK(g),g.target,s(g,e.lockRef.current))},[]),d=st(function(g){l(g.type,rS(g),g.target,s(g,e.lockRef.current))},[]);qt(function(){return mm.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",u,gm),document.addEventListener("touchmove",u,gm),document.addEventListener("touchstart",c,gm),function(){mm=mm.filter(function(g){return g!==a}),document.removeEventListener("wheel",u,gm),document.removeEventListener("touchmove",u,gm),document.removeEventListener("touchstart",c,gm)}},[]);var h=e.removeScrollBar,p=e.inert;return ue(Vi,null,p?ue(a,{styles:ZFe(i)}):null,h?ue(VFe,{gapMode:"margin"}):null)}var e3e=BRe(lK,QFe),vK=Gl(function(e,t){return ue(tS,pm({},e,{ref:t,sideCar:e3e}))});vK.classNames=tS.classNames;var t3e=vK,n3e=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},vm=new WeakMap,iS=new WeakMap,aS={},wF=0,r3e=function(e,t,n){t===void 0&&(t=n3e(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];aS[n]||(aS[n]=new WeakMap);var i=aS[n],a=[],o=new Set,s=function(l){!l||o.has(l)||(o.add(l),s(l.parentNode))};r.forEach(s);var u=function(l){!l||r.indexOf(l)>=0||Array.prototype.forEach.call(l.children,function(c){if(o.has(c))u(c);else{var f=c.getAttribute("aria-hidden"),d=f!==null&&f!=="false",h=(vm.get(c)||0)+1,p=(i.get(c)||0)+1;vm.set(c,h),i.set(c,p),a.push(c),h===1&&d&&iS.set(c,!0),p===1&&c.setAttribute(n,"true"),d||c.setAttribute("aria-hidden","true")}})};return u(t),o.clear(),wF++,function(){a.forEach(function(l){var c=vm.get(l)-1,f=i.get(l)-1;vm.set(l,c),i.set(l,f),c||(iS.has(l)||l.removeAttribute("aria-hidden"),iS.delete(l)),f||l.removeAttribute(n)}),wF--,wF||(vm=new WeakMap,vm=new WeakMap,iS=new WeakMap,aS={})}};function i3e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a3e{constructor(){i3e(this,"modals",void 0),this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(n=>n!==t)}isTopModal(t){var n=this.modals[this.modals.length-1];return n===t}}var _F=new a3e;function o3e(e,t){qt(()=>(t&&_F.add(e),()=>{_F.remove(e)}),[t,e])}function oS(){return oS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oS.apply(this,arguments)}function s3e(e){var{isOpen:t,onClose:n,id:r,closeOnOverlayClick:i=!0,closeOnEsc:a=!0,useInert:o=!0,onOverlayClick:s,onEsc:u}=e,l=Jt(null),c=Jt(null),[f,d,h]=Rwe(r,"chakra-modal","chakra-modal--header","chakra-modal--body");u3e(l,t&&o),o3e(l,t);var p=Jt(null),g=st(_=>{p.current=_.target},[]),m=st(_=>{_.key==="Escape"&&(_.stopPropagation(),a&&(n==null||n()),u==null||u())},[a,n,u]),[v,y]=an(!1),[b,x]=an(!1),w=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),oS({role:"dialog"},_,{ref:df(E,l),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":v?d:void 0,"aria-describedby":b?h:void 0,onClick:wr(_.onClick,A=>A.stopPropagation())})},[h,b,f,d,v]),S=st(_=>{_.stopPropagation(),p.current===_.target&&(!_F.isTopModal(l)||(i&&(n==null||n()),s==null||s()))},[n,i,s]),C=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),oS({},_,{ref:df(E,c),onClick:wr(_.onClick,S),onKeyDown:wr(_.onKeyDown,m),onMouseDown:wr(_.onMouseDown,g)})},[m,g,S]);return{isOpen:t,onClose:n,headerId:d,bodyId:h,setBodyMounted:x,setHeaderMounted:y,dialogRef:l,overlayRef:c,getDialogProps:w,getDialogContainerProps:C}}function u3e(e,t){qt(()=>{if(!!e.current){var n=null;return t&&e.current&&(n=r3e(e.current)),()=>{t&&(n==null||n())}}},[t,e])}function sS(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ql(){return Ql=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ql.apply(this,arguments)}var[l3e,ym]=Mu({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),yK=e=>{var{portalProps:t,children:n,autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d}=e,h=hf("Modal",e),p=s3e(e),g=Ql({},p,{autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d});return ue(l3e,{value:g},ue(dy,{value:h},ue(pG,null,g.isOpen&&ue(t_,t,n))))};yK.defaultProps={lockFocusAcrossFrames:!0,returnFocusOnClose:!0,scrollBehavior:"outside",trapFocus:!0,autoFocus:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale"};var c3e=xt(dG.div);function f3e(e){var{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:i,blockScrollOnMount:a,allowPinchZoom:o,finalFocusRef:s,returnFocusOnClose:u,preserveScrollBarGap:l,lockFocusAcrossFrames:c}=ym(),[f,d]=XD();return qt(()=>{!f&&d&&setTimeout(d)},[f,d]),ue(IFe,{autoFocus:t,isDisabled:!n,initialFocusRef:i,finalFocusRef:s,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:c},ue(t3e,{removeScrollBar:!l,allowPinchZoom:o,enabled:a,forwardProps:!0},e.children))}var bK=Mt((e,t)=>{var{className:n}=e,r=sS(e,["className","transition"]),i=Wn("chakra-modal__overlay",n),a=vi(),o=Ql({pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh"},a.overlay),{motionPreset:s}=ym(),u=s==="none"?{}:bDe;return ue(c3e,Ql({},u,{__css:o,ref:t,className:i},r))}),d3e=Mt((e,t)=>{var{className:n}=e,r=sS(e,["className"]),{headerId:i,setHeaderMounted:a}=ym();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__header",n),s=vi(),u=Ql({flex:0},s.header);return ue(xt.header,Ql({ref:t,className:o,id:i},r,{__css:u}))}),xK=Mt((e,t)=>{var{className:n}=e,r=sS(e,["className"]),{bodyId:i,setBodyMounted:a}=ym();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__body",n),s=vi();return ue(xt.div,Ql({ref:t,className:o,id:i},r,{__css:s.body}))}),h3e=Mt((e,t)=>{var{onClick:n,className:r}=e,i=sS(e,["onClick","className"]),{onClose:a}=ym(),o=Wn("chakra-modal__close-btn",r),s=vi();return ue(XDe,Ql({ref:t,__css:s.closeButton,className:o,onClick:wr(n,u=>{u.stopPropagation(),a()})},i))});function Ch(){return Ch=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ch.apply(this,arguments)}function wK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[p3e,g3e]=Mu();function _K(e){var t,{isOpen:n,onClose:r,placement:i="right",children:a}=e,o=wK(e,["isOpen","onClose","placement","children"]),s=kV(),u=(t=s.components)==null?void 0:t.Drawer;return ue(p3e,{value:{placement:i}},ue(yK,Ch({isOpen:n,onClose:r,styleConfig:u},o),a))}var m3e=xt(_De),SK=Mt((e,t)=>{var{className:n,children:r}=e,i=wK(e,["className","children"]),{getDialogProps:a,getDialogContainerProps:o,isOpen:s}=ym(),u=a(i,t),l=o(),c=Wn("chakra-modal__content",n),f=vi(),d=Ch({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0},f.dialog),h=Ch({display:"flex",width:"100vw",height:"100vh",position:"fixed",left:0,top:0},f.dialogContainer),{placement:p}=g3e();return ue(xt.div,Ch({},l,{className:"chakra-modal__content-container",__css:h}),ue(f3e,null,ue(m3e,Ch({direction:p,in:s,className:c},u,{__css:d}),r)))});function _f(){return _f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_f.apply(this,arguments)}function SF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var v3e=Mt((e,t)=>{var{children:n,placeholder:r,className:i}=e,a=SF(e,["children","placeholder","className"]),o=TG(a);return ue(xt.select,_f({},o,{ref:t,className:Wn("chakra-select",i)}),r&&ue("option",{value:""},r),n)}),y3e=Mt((e,t)=>{var n=hf("Select",e),r=Ao(e),{rootProps:i,placeholder:a,icon:o,color:s,height:u,h:l,minH:c,minHeight:f,iconColor:d,iconSize:h}=r,p=SF(r,["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"]),[g,m]=Xxe(p,I2e),v={width:"100%",height:"fit-content",position:"relative",color:s},y=Ru({},n.field,{paddingEnd:"2rem",_focus:{zIndex:"unset"}});return ue(xt.div,_f({className:"chakra-select__wrapper",__css:v},g,i),ue(v3e,_f({ref:t,height:l??u,minH:c??f,placeholder:a},m,{__css:y}),e.children),ue(w3e,_f({"data-disabled":e.isDisabled},(d||s)&&{color:d||s},{__css:n.icon},h&&{fontSize:h}),o))}),b3e=e=>ue("svg",_f({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})),x3e=xt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),w3e=e=>{var{children:t=ue(b3e,null)}=e,n=SF(e,["children"]),r=sf(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return ue(x3e,_f({},n,{className:"chakra-select__icon-wrapper"}),ph(t)?r:null)};function ec(){return ec=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ec.apply(this,arguments)}function _3e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var S3e=Mt((e,t)=>{var n=hf("Switch",e),r=Ao(e),{spacing:i="0.5rem",children:a}=r,o=_3e(r,["spacing","children"]),{state:s,getInputProps:u,getCheckboxProps:l,getRootProps:c,getLabelProps:f}=HDe(o),d=xr(()=>ec({display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},n.container),[n.container]),h=xr(()=>ec({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer"},n.track),[n.track]),p=xr(()=>ec({userSelect:"none",marginStart:i},n.label),[i,n.label]);return ue(xt.label,ec({},c(),{className:Wn("chakra-switch",e.className),__css:d}),ue("input",ec({className:"chakra-switch__input"},u({},t))),ue(xt.span,ec({},l(),{className:"chakra-switch__track",__css:h}),ue(xt.span,{__css:n.thumb,className:"chakra-switch__thumb","data-checked":Ii(s.isChecked),"data-hover":Ii(s.isHovered)})),a&&ue(xt.span,ec({className:"chakra-switch__label"},f(),{__css:p}),a))});function Ah(){return Ah=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ah.apply(this,arguments)}function EF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[E3e,C3e,A3e,k3e]=TDe();function T3e(e){var{defaultIndex:t,onChange:n,index:r,isManual:i,isLazy:a,lazyBehavior:o="unmount",orientation:s="horizontal",direction:u="ltr"}=e,l=EF(e,["defaultIndex","onChange","index","isManual","isLazy","lazyBehavior","orientation","direction"]),[c,f]=an(t??0),[d,h]=Nwe({defaultValue:t??0,value:r,onChange:n});qt(()=>{r!=null&&f(r)},[r]);var p=A3e(),g=sV(e.id,"tabs");return{id:g,selectedIndex:d,focusedIndex:c,setSelectedIndex:h,setFocusedIndex:f,isManual:i,isLazy:a,lazyBehavior:o,orientation:s,descendants:p,direction:u,htmlProps:l}}var[O3e,uS]=Mu({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function I3e(e){var{focusedIndex:t,orientation:n,direction:r}=uS(),i=C3e(),a=st(o=>{var s=()=>{var y=i.nextEnabled(t);y&&qg(y.node)},u=()=>{var y=i.prevEnabled(t);y&&qg(y.node)},l=()=>{var y=i.firstEnabled();y&&qg(y.node)},c=()=>{var y=i.lastEnabled();y&&qg(y.node)},f=n==="horizontal",d=n==="vertical",h=iwe(o),p=r==="ltr"?"ArrowLeft":"ArrowRight",g=r==="ltr"?"ArrowRight":"ArrowLeft",m={[p]:()=>f&&u(),[g]:()=>f&&s(),ArrowDown:()=>d&&s(),ArrowUp:()=>d&&u(),Home:l,End:c},v=m[h];v&&(o.preventDefault(),v(o))},[i,t,n,r]);return Ah({},e,{role:"tablist","aria-orientation":n,onKeyDown:wr(e.onKeyDown,a)})}function N3e(e){var{isDisabled:t,isFocusable:n}=e,r=EF(e,["isDisabled","isFocusable"]),{setSelectedIndex:i,isManual:a,id:o,setFocusedIndex:s,selectedIndex:u}=uS(),{index:l,register:c}=k3e({disabled:t&&!n}),f=l===u,d=()=>{i(l)},h=()=>{s(l);var m=t&&n,v=!a&&!m;v&&i(l)},p=TRe(Ah({},r,{ref:df(c,e.ref),isDisabled:t,isFocusable:n,onClick:wr(e.onClick,d)})),g="button";return Ah({},p,{id:EK(o,l),role:"tab",tabIndex:f?0:-1,type:g,"aria-selected":f,"aria-controls":CK(o,l),onFocus:t?void 0:wr(e.onFocus,h)})}function D3e(e){var t=uS(),{id:n,selectedIndex:r}=t,i=cD(e.children),a=i.map((o,s)=>sf(o,{isSelected:s===r,id:CK(n,s),"aria-labelledby":EK(n,s)}));return Ah({},e,{children:a})}function R3e(e){var{isSelected:t,id:n,children:r}=e,i=EF(e,["isSelected","id","children"]),{isLazy:a,lazyBehavior:o}=uS(),s=Jt(!1);t&&(s.current=!0);var u=xwe({hasBeenSelected:s.current,isSelected:t,isLazy:a,lazyBehavior:o});return Ah({tabIndex:0},i,{children:u?r:null,role:"tabpanel",hidden:!t,id:n})}function EK(e,t){return e+"--tab-"+t}function CK(e,t){return e+"--tabpanel-"+t}function rs(){return rs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rs.apply(this,arguments)}function AK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var F3e=Mt((e,t)=>{var n=hf("Tabs",e),r=Ao(e),{children:i,className:a}=r,o=AK(r,["children","className"]),s=T3e(o),{htmlProps:u,descendants:l}=s,c=AK(s,["htmlProps","descendants"]),f=xr(()=>c,[c]),d=rD(u,["isFitted"]);return ue(E3e,{value:l},ue(O3e,{value:f},ue(dy,{value:n},ue(xt.div,rs({className:Wn("chakra-tabs",a),ref:t},d,{__css:n.root}),i))))}),M3e=Mt((e,t)=>{var n=vi(),r=N3e(rs({},e,{ref:t})),i=rs({outline:"0",display:"flex",alignItems:"center",justifyContent:"center"},n.tab);return ue(xt.button,rs({},r,{className:Wn("chakra-tabs__tab",e.className),__css:i}))}),P3e=Mt((e,t)=>{var n=I3e(rs({},e,{ref:t})),r=vi(),i=rs({display:"flex"},r.tablist);return ue(xt.div,rs({},n,{className:Wn("chakra-tabs__tablist",e.className),__css:i}))}),$3e=Mt((e,t)=>{var n=R3e(rs({},e,{ref:t})),r=vi();return ue(xt.div,rs({outline:"0"},n,{className:Wn("chakra-tabs__tab-panel",e.className),__css:r.tabpanel}))}),L3e=Mt((e,t)=>{var n=D3e(e),r=vi();return ue(xt.div,rs({},n,{width:"100%",ref:t,className:Wn("chakra-tabs__tab-panels",e.className),__css:r.tabpanels}))}),B3e=vy({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),z3e=vy({displayName:"ExternalLinkIcon",path:ue("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},ue("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),ue("path",{d:"M15 3h6v6"}),ue("path",{d:"M10 14L21 3"}))}),j3e=vy({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),U3e=vy({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,19a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,12,19Zm1.6-6.08a1,1,0,0,0-.6.917,1,1,0,1,1-2,0,3,3,0,0,1,1.8-2.75A2,2,0,1,0,10,9.255a1,1,0,1,1-2,0,4,4,0,1,1,5.6,3.666Z",displayName:"QuestionIcon"}),kK=vy({viewBox:"0 0 14 14",path:ue("g",{fill:"currentColor"},ue("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"}))});const W3e=({options:e})=>{const[t,n]=an(!1),r=st(()=>{n(!t)},[t]);return zt.createElement(zt.Fragment,null,zt.createElement(q_,{verticalAlign:"top","aria-label":"Metaframe settings",icon:zt.createElement(B3e,null),size:"lg",onClick:r}),zt.createElement(V3e,{isOpen:t,setOpen:n,options:e}))},V3e=({isOpen:e,setOpen:t,options:n})=>{const[r,i]=HU("options",Object.fromEntries(n.filter(d=>d.default).map(d=>[d.name,d.default]))),[a,o]=an(r||{}),[s,u]=an(void 0),l=st(d=>{const{name:h,value:p}=d.target,g=n.find(m=>m.name===h);if(!g){console.error(`No option found for name=${h}`);return}g.type==="boolean"?o(Object.assign(Object.assign({},a),{[h]:p==="1"})):o(Object.assign(Object.assign({},a),{[h]:p}))},[a,o,n]),c=st(()=>{t(!e)},[t,e]),f=st(()=>{const d={};if(Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);if(g&&g.validator&&g.type!=="boolean"){const m=g.validator(a[p]);m&&(d[p]=m)}}),Object.keys(d).length>0){u(d);return}u(void 0);const h={};Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);g?g.map?h[p]=g.map(a[p]):g.type==="boolean"?h[p]=a[p]===!0||a[p]==="1"||a[p]==="true":h[p]=a[p]:h[p]=a[p]}),t(!e),i(h)},[t,e,n,a,i,u]);return qt(()=>{const d=h=>{h.key==="Enter"&&e&&f()};return window.addEventListener("keyup",d),()=>{window.removeEventListener("keyup",d)}},[f,e]),zt.createElement(_K,{placement:"top",onClose:f,isOpen:e},zt.createElement(bK,null,zt.createElement(SK,null,zt.createElement(d3e,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),zt.createElement(xK,null,zt.createElement(G_,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},zt.createElement(NG,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(d=>zt.createElement(zt.Fragment,null,zt.createElement(Eh,{rowSpan:1,colSpan:4},zt.createElement(G_,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},zt.createElement(bRe,{textAlign:"right",verticalAlign:"bottom"},d.displayName||d.name,":"))),zt.createElement(Eh,{rowSpan:1,colSpan:8}," ",q3e(d,a[d.name],l)))),zt.createElement(Eh,{rowSpan:1,colSpan:12}),zt.createElement(Eh,{rowSpan:1,colSpan:12}),zt.createElement(Eh,{rowSpan:1,colSpan:12}),zt.createElement(Eh,{rowSpan:1,colSpan:10}),zt.createElement(Eh,{rowSpan:0,colSpan:2},zt.createElement(vRe,{spacing:2,justify:"flex-end",direction:"row"},zt.createElement(q_,{size:"lg",color:"red",icon:zt.createElement(j3e,null),onClick:c}),zt.createElement(q_,{size:"lg",color:"green",icon:zt.createElement(kK,null),onClick:f})))))))))},q3e=(e,t,n)=>{switch(e.type){case"option":return zt.createElement(y3e,{name:e.name,value:t,onChange:n,placeholder:"Select option"},e.options.map(r=>zt.createElement("option",{value:r},r)));case"boolean":return zt.createElement(S3e,{name:e.name,rightIcon:zt.createElement(kK,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return zt.createElement(G_,{w:"100%",h:"10"},zt.createElement(OG,{name:e.name,type:"text",placeholder:"",value:t,onInput:n}))}};var TK={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof uf=="function"&&uf;if(!c&&f)return f(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+l+"'")}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(h){var p=r[l][1][h];return o(p||h)},d,d.exports,n,r,i,a)}return i[l].exports}for(var s=typeof uf=="function"&&uf,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("crypto");function g(S,C){return function(_,E){var A;if(A=E.algorithm!=="passthrough"?p.createHash(E.algorithm):new w,A.write===void 0&&(A.write=A.update,A.end=A.update),x(E,A).dispatch(_),A.update||A.end(""),A.digest)return A.digest(E.encoding==="buffer"?void 0:E.encoding);var k=A.read();return E.encoding!=="buffer"?k.toString(E.encoding):k}(S,C=y(S,C))}(i=r.exports=g).sha1=function(S){return g(S)},i.keys=function(S){return g(S,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(S){return g(S,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(S){return g(S,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"];m.push("passthrough");var v=["buffer","hex","binary","base64"];function y(S,C){C=C||{};var _={};if(_.algorithm=C.algorithm||"sha1",_.encoding=C.encoding||"hex",_.excludeValues=!!C.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=C.ignoreUnknown===!0,_.respectType=C.respectType!==!1,_.respectFunctionNames=C.respectFunctionNames!==!1,_.respectFunctionProperties=C.respectFunctionProperties!==!1,_.unorderedArrays=C.unorderedArrays===!0,_.unorderedSets=C.unorderedSets!==!1,_.unorderedObjects=C.unorderedObjects!==!1,_.replacer=C.replacer||void 0,_.excludeKeys=C.excludeKeys||void 0,S===void 0)throw new Error("Object argument required.");for(var E=0;E<m.length;++E)m[E].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=m[E]);if(m.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+m.join(", "));if(v.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+v.join(", "));return _}function b(S){if(typeof S=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(S))!=null}function x(S,C,_){_=_||[];function E(A){return C.update?C.update(A,"utf8"):C.write(A,"utf8")}return{dispatch:function(A){return S.replacer&&(A=S.replacer(A)),this["_"+(A===null?"null":typeof A)](A)},_object:function(A){var k=Object.prototype.toString.call(A),T=/\[object (.*)\]/i.exec(k);T=(T=T?T[1]:"unknown:["+k+"]").toLowerCase();var I;if(0<=(I=_.indexOf(A)))return this.dispatch("[CIRCULAR:"+I+"]");if(_.push(A),s!==void 0&&s.isBuffer&&s.isBuffer(A))return E("buffer:"),E(A);if(T==="object"||T==="function"||T==="asyncfunction"){var N=Object.keys(A);S.unorderedObjects&&(N=N.sort()),S.respectType===!1||b(A)||N.splice(0,0,"prototype","__proto__","constructor"),S.excludeKeys&&(N=N.filter(function(D){return!S.excludeKeys(D)})),E("object:"+N.length+":");var O=this;return N.forEach(function(D){O.dispatch(D),E(":"),S.excludeValues||O.dispatch(A[D]),E(",")})}if(!this["_"+T]){if(S.ignoreUnknown)return E("["+T+"]");throw new Error('Unknown object type "'+T+'"')}this["_"+T](A)},_array:function(A,k){k=k!==void 0?k:S.unorderedArrays!==!1;var T=this;if(E("array:"+A.length+":"),!k||A.length<=1)return A.forEach(function(O){return T.dispatch(O)});var I=[],N=A.map(function(O){var D=new w,L=_.slice();return x(S,D,L).dispatch(O),I=I.concat(L.slice(_.length)),D.read().toString()});return _=_.concat(I),N.sort(),this._array(N,!1)},_date:function(A){return E("date:"+A.toJSON())},_symbol:function(A){return E("symbol:"+A.toString())},_error:function(A){return E("error:"+A.toString())},_boolean:function(A){return E("bool:"+A.toString())},_string:function(A){E("string:"+A.length+":"),E(A.toString())},_function:function(A){E("fn:"),b(A)?this.dispatch("[native]"):this.dispatch(A.toString()),S.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(A.name)),S.respectFunctionProperties&&this._object(A)},_number:function(A){return E("number:"+A.toString())},_xml:function(A){return E("xml:"+A.toString())},_null:function(){return E("Null")},_undefined:function(){return E("Undefined")},_regexp:function(A){return E("regex:"+A.toString())},_uint8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint8clampedarray:function(A){return E("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(A))},_int8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_int16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_uint32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_int32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_float32array:function(A){return E("float32array:"),this.dispatch(Array.prototype.slice.call(A))},_float64array:function(A){return E("float64array:"),this.dispatch(Array.prototype.slice.call(A))},_arraybuffer:function(A){return E("arraybuffer:"),this.dispatch(new Uint8Array(A))},_url:function(A){return E("url:"+A.toString())},_map:function(A){E("map:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_set:function(A){E("set:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_file:function(A){return E("file:"),this.dispatch([A.name,A.size,A.type,A.lastModfied])},_blob:function(){if(S.ignoreUnknown)return E("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return E("domwindow")},_bigint:function(A){return E("bigint:"+A.toString())},_process:function(){return E("process")},_timer:function(){return E("timer")},_pipe:function(){return E("pipe")},_tcp:function(){return E("tcp")},_udp:function(){return E("udp")},_tty:function(){return E("tty")},_statwatcher:function(){return E("statwatcher")},_securecontext:function(){return E("securecontext")},_connection:function(){return E("connection")},_zlib:function(){return E("zlib")},_context:function(){return E("context")},_nodescript:function(){return E("nodescript")},_httpparser:function(){return E("httpparser")},_dataview:function(){return E("dataview")},_signal:function(){return E("signal")},_fsevent:function(){return E("fsevent")},_tlswrap:function(){return E("tlswrap")}}}function w(){return{buf:"",write:function(S){this.buf+=S},end:function(S){this.buf+=S},read:function(){return this.buf}}}i.writeToStream=function(S,C,_){return _===void 0&&(_=C,C={}),x(C=y(S,C),_).dispatch(S)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){(function(p){var g=typeof Uint8Array!="undefined"?Uint8Array:Array,m="+".charCodeAt(0),v="/".charCodeAt(0),y="0".charCodeAt(0),b="a".charCodeAt(0),x="A".charCodeAt(0),w="-".charCodeAt(0),S="_".charCodeAt(0);function C(_){var E=_.charCodeAt(0);return E===m||E===w?62:E===v||E===S?63:E<y?-1:E<y+10?E-y+26+26:E<x+26?E-x:E<b+26?E-b+26:void 0}p.toByteArray=function(_){var E,A;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var k=_.length,T=_.charAt(k-2)==="="?2:_.charAt(k-1)==="="?1:0,I=new g(3*_.length/4-T),N=0<T?_.length-4:_.length,O=0;function D(L){I[O++]=L}for(E=0;E<N;E+=4,0)D((16711680&(A=C(_.charAt(E))<<18|C(_.charAt(E+1))<<12|C(_.charAt(E+2))<<6|C(_.charAt(E+3))))>>16),D((65280&A)>>8),D(255&A);return T==2?D(255&(A=C(_.charAt(E))<<2|C(_.charAt(E+1))>>4)):T==1&&(D((A=C(_.charAt(E))<<10|C(_.charAt(E+1))<<4|C(_.charAt(E+2))>>2)>>8&255),D(255&A)),I},p.fromByteArray=function(_){var E,A,k,T,I=_.length%3,N="";function O(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(E=0,k=_.length-I;E<k;E+=3)A=(_[E]<<16)+(_[E+1]<<8)+_[E+2],N+=O((T=A)>>18&63)+O(T>>12&63)+O(T>>6&63)+O(63&T);switch(I){case 1:N+=O((A=_[_.length-1])>>2),N+=O(A<<4&63),N+="==";break;case 2:N+=O((A=(_[_.length-2]<<8)+_[_.length-1])>>10),N+=O(A>>4&63),N+=O(A<<2&63),N+="="}return N}})(i===void 0?this.base64js={}:i)}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("base64-js"),g=n("ieee754");function s(P,F,V){if(!(this instanceof s))return new s(P,F,V);var ae,Y,M,B,R,X=typeof P;if(F==="base64"&&X=="string")for(P=(ae=P).trim?ae.trim():ae.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(X=="number")Y=L(P);else if(X=="string")Y=s.byteLength(P,F);else{if(X!="object")throw new Error("First argument needs to be a number, array or string.");Y=L(P.length)}if(s._useTypedArrays?M=s._augment(new Uint8Array(Y)):((M=this).length=Y,M._isBuffer=!0),s._useTypedArrays&&typeof P.byteLength=="number")M._set(P);else if(W(R=P)||s.isBuffer(R)||R&&typeof R=="object"&&typeof R.length=="number")for(B=0;B<Y;B++)s.isBuffer(P)?M[B]=P.readUInt8(B):M[B]=P[B];else if(X=="string")M.write(P,0,F);else if(X=="number"&&!s._useTypedArrays&&!V)for(B=0;B<Y;B++)M[B]=0;return M}function m(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M=[],B=0;B<Y.length;B++)M.push(255&Y.charCodeAt(B));return M}(F),P,V,ae)}function v(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M,B,R,X=[],ge=0;ge<Y.length;ge++)M=Y.charCodeAt(ge),B=M>>8,R=M%256,X.push(R),X.push(B);return X}(F),P,V,ae)}function y(P,F,V){var ae="";V=Math.min(P.length,V);for(var Y=F;Y<V;Y++)ae+=String.fromCharCode(P[Y]);return ae}function b(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(Y=P[F],F+1<M&&(Y|=P[F+1]<<8)):(Y=P[F]<<8,F+1<M&&(Y|=P[F+1])),Y}function x(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(F+2<M&&(Y=P[F+2]<<16),F+1<M&&(Y|=P[F+1]<<8),Y|=P[F],F+3<M&&(Y+=P[F+3]<<24>>>0)):(F+1<M&&(Y=P[F+1]<<16),F+2<M&&(Y|=P[F+2]<<8),F+3<M&&(Y|=P[F+3]),Y+=P[F]<<24>>>0),Y}function w(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=b(P,F,V,!0);return 32768&Y?-1*(65535-Y+1):Y}}function S(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=x(P,F,V,!0);return 2147483648&Y?-1*(4294967295-Y+1):Y}}function C(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+3<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,23,4)}function _(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+7<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,52,8)}function E(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"trying to write beyond buffer length"),Oe(F,65535));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,2);B<R;B++)P[V+B]=(F&255<<8*(ae?B:1-B))>>>8*(ae?B:1-B)}function A(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"trying to write beyond buffer length"),Oe(F,4294967295));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,4);B<R;B++)P[V+B]=F>>>8*(ae?B:3-B)&255}function k(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"Trying to write beyond buffer length"),Te(F,32767,-32768)),P.length<=V||E(P,0<=F?F:65535+F+1,V,ae,Y)}function T(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Te(F,2147483647,-2147483648)),P.length<=V||A(P,0<=F?F:4294967295+F+1,V,ae,Y)}function I(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),De(F,34028234663852886e22,-34028234663852886e22)),P.length<=V||g.write(P,F,V,ae,23,4)}function N(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+7<P.length,"Trying to write beyond buffer length"),De(F,17976931348623157e292,-17976931348623157e292)),P.length<=V||g.write(P,F,V,ae,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var P=new ArrayBuffer(0),F=new Uint8Array(P);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(V){return!1}}(),s.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(P){return!(P==null||!P._isBuffer)},s.byteLength=function(P,F){var V;switch(P+="",F||"utf8"){case"hex":V=P.length/2;break;case"utf8":case"utf-8":V=K(P).length;break;case"ascii":case"binary":case"raw":V=P.length;break;case"base64":V=ee(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=2*P.length;break;default:throw new Error("Unknown encoding")}return V},s.concat=function(P,F){if(me(W(P),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),P.length===0)return new s(0);if(P.length===1)return P[0];if(typeof F!="number")for(Y=F=0;Y<P.length;Y++)F+=P[Y].length;for(var V=new s(F),ae=0,Y=0;Y<P.length;Y++){var M=P[Y];M.copy(V,ae),ae+=M.length}return V},s.prototype.write=function(P,F,V,ae){var Y;isFinite(F)?isFinite(V)||(ae=V,V=void 0):(Y=ae,ae=F,F=V,V=Y),F=Number(F)||0;var M,B,R,X,ge,xe,ze,Ke,Ze,Bt=this.length-F;switch((!V||Bt<(V=Number(V)))&&(V=Bt),ae=String(ae||"utf8").toLowerCase()){case"hex":M=function(Je,Zt,mn,Hn){mn=Number(mn)||0;var ti=Je.length-mn;(!Hn||ti<(Hn=Number(Hn)))&&(Hn=ti);var er=Zt.length;me(er%2==0,"Invalid hex string"),er/2<Hn&&(Hn=er/2);for(var Dn=0;Dn<Hn;Dn++){var Jo=parseInt(Zt.substr(2*Dn,2),16);me(!isNaN(Jo),"Invalid hex string"),Je[mn+Dn]=Jo}return s._charsWritten=2*Dn,Dn}(this,P,F,V);break;case"utf8":case"utf-8":xe=this,ze=P,Ke=F,Ze=V,M=s._charsWritten=ce(K(ze),xe,Ke,Ze);break;case"ascii":case"binary":M=m(this,P,F,V);break;case"base64":B=this,R=P,X=F,ge=V,M=s._charsWritten=ce(ee(R),B,X,ge);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":M=v(this,P,F,V);break;default:throw new Error("Unknown encoding")}return M},s.prototype.toString=function(P,F,V){var ae,Y,M,B,R=this;if(P=String(P||"utf8").toLowerCase(),F=Number(F)||0,(V=V!==void 0?Number(V):V=R.length)===F)return"";switch(P){case"hex":ae=function(X,ge,xe){var ze=X.length;(!ge||ge<0)&&(ge=0),(!xe||xe<0||ze<xe)&&(xe=ze);for(var Ke="",Ze=ge;Ze<xe;Ze++)Ke+=G(X[Ze]);return Ke}(R,F,V);break;case"utf8":case"utf-8":ae=function(X,ge,xe){var ze="",Ke="";xe=Math.min(X.length,xe);for(var Ze=ge;Ze<xe;Ze++)X[Ze]<=127?(ze+=he(Ke)+String.fromCharCode(X[Ze]),Ke=""):Ke+="%"+X[Ze].toString(16);return ze+he(Ke)}(R,F,V);break;case"ascii":case"binary":ae=y(R,F,V);break;case"base64":Y=R,B=V,ae=(M=F)===0&&B===Y.length?p.fromByteArray(Y):p.fromByteArray(Y.slice(M,B));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ae=function(X,ge,xe){for(var ze=X.slice(ge,xe),Ke="",Ze=0;Ze<ze.length;Ze+=2)Ke+=String.fromCharCode(ze[Ze]+256*ze[Ze+1]);return Ke}(R,F,V);break;default:throw new Error("Unknown encoding")}return ae},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(P,F,V,ae){if(V=V||0,ae||ae===0||(ae=this.length),F=F||0,ae!==V&&P.length!==0&&this.length!==0){me(V<=ae,"sourceEnd < sourceStart"),me(0<=F&&F<P.length,"targetStart out of bounds"),me(0<=V&&V<this.length,"sourceStart out of bounds"),me(0<=ae&&ae<=this.length,"sourceEnd out of bounds"),ae>this.length&&(ae=this.length),P.length-F<ae-V&&(ae=P.length-F+V);var Y=ae-V;if(Y<100||!s._useTypedArrays)for(var M=0;M<Y;M++)P[M+F]=this[M+V];else P._set(this.subarray(V,V+Y),F)}},s.prototype.slice=function(P,F){var V=this.length;if(P=D(P,V,0),F=D(F,V,V),s._useTypedArrays)return s._augment(this.subarray(P,F));for(var ae=F-P,Y=new s(ae,void 0,!0),M=0;M<ae;M++)Y[M]=this[M+P];return Y},s.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},s.prototype.set=function(P,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,F)},s.prototype.readUInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},s.prototype.readUInt16LE=function(P,F){return b(this,P,!0,F)},s.prototype.readUInt16BE=function(P,F){return b(this,P,!1,F)},s.prototype.readUInt32LE=function(P,F){return x(this,P,!0,F)},s.prototype.readUInt32BE=function(P,F){return x(this,P,!1,F)},s.prototype.readInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},s.prototype.readInt16LE=function(P,F){return w(this,P,!0,F)},s.prototype.readInt16BE=function(P,F){return w(this,P,!1,F)},s.prototype.readInt32LE=function(P,F){return S(this,P,!0,F)},s.prototype.readInt32BE=function(P,F){return S(this,P,!1,F)},s.prototype.readFloatLE=function(P,F){return C(this,P,!0,F)},s.prototype.readFloatBE=function(P,F){return C(this,P,!1,F)},s.prototype.readDoubleLE=function(P,F){return _(this,P,!0,F)},s.prototype.readDoubleBE=function(P,F){return _(this,P,!1,F)},s.prototype.writeUInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"trying to write beyond buffer length"),Oe(P,255)),F>=this.length||(this[F]=P)},s.prototype.writeUInt16LE=function(P,F,V){E(this,P,F,!0,V)},s.prototype.writeUInt16BE=function(P,F,V){E(this,P,F,!1,V)},s.prototype.writeUInt32LE=function(P,F,V){A(this,P,F,!0,V)},s.prototype.writeUInt32BE=function(P,F,V){A(this,P,F,!1,V)},s.prototype.writeInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"Trying to write beyond buffer length"),Te(P,127,-128)),F>=this.length||(0<=P?this.writeUInt8(P,F,V):this.writeUInt8(255+P+1,F,V))},s.prototype.writeInt16LE=function(P,F,V){k(this,P,F,!0,V)},s.prototype.writeInt16BE=function(P,F,V){k(this,P,F,!1,V)},s.prototype.writeInt32LE=function(P,F,V){T(this,P,F,!0,V)},s.prototype.writeInt32BE=function(P,F,V){T(this,P,F,!1,V)},s.prototype.writeFloatLE=function(P,F,V){I(this,P,F,!0,V)},s.prototype.writeFloatBE=function(P,F,V){I(this,P,F,!1,V)},s.prototype.writeDoubleLE=function(P,F,V){N(this,P,F,!0,V)},s.prototype.writeDoubleBE=function(P,F,V){N(this,P,F,!1,V)},s.prototype.fill=function(P,F,V){if(P=P||0,F=F||0,V=V||this.length,typeof P=="string"&&(P=P.charCodeAt(0)),me(typeof P=="number"&&!isNaN(P),"value is not a number"),me(F<=V,"end < start"),V!==F&&this.length!==0){me(0<=F&&F<this.length,"start out of bounds"),me(0<=V&&V<=this.length,"end out of bounds");for(var ae=F;ae<V;ae++)this[ae]=P}},s.prototype.inspect=function(){for(var P=[],F=this.length,V=0;V<F;V++)if(P[V]=G(this[V]),V===i.INSPECT_MAX_BYTES){P[V+1]="...";break}return"<Buffer "+P.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var P=new Uint8Array(this.length),F=0,V=P.length;F<V;F+=1)P[F]=this[F];return P.buffer};var O=s.prototype;function D(P,F,V){return typeof P!="number"?V:F<=(P=~~P)?F:0<=P||0<=(P+=F)?P:0}function L(P){return(P=~~Math.ceil(+P))<0?0:P}function W(P){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(P)}function G(P){return P<16?"0"+P.toString(16):P.toString(16)}function K(P){for(var F=[],V=0;V<P.length;V++){var ae=P.charCodeAt(V);if(ae<=127)F.push(P.charCodeAt(V));else{var Y=V;55296<=ae&&ae<=57343&&V++;for(var M=encodeURIComponent(P.slice(Y,V+1)).substr(1).split("%"),B=0;B<M.length;B++)F.push(parseInt(M[B],16))}}return F}function ee(P){return p.toByteArray(P)}function ce(P,F,V,ae){for(var Y=0;Y<ae&&!(Y+V>=F.length||Y>=P.length);Y++)F[Y+V]=P[Y];return Y}function he(P){try{return decodeURIComponent(P)}catch(F){return String.fromCharCode(65533)}}function Oe(P,F){me(typeof P=="number","cannot write a non-number as a number"),me(0<=P,"specified a negative value for writing an unsigned value"),me(P<=F,"value is larger than maximum value for type"),me(Math.floor(P)===P,"value has a fractional component")}function Te(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value"),me(Math.floor(P)===P,"value has a fractional component")}function De(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value")}function me(P,F){if(!P)throw new Error(F||"Failed assertion")}s._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=O.get,P.set=O.set,P.write=O.write,P.toString=O.toString,P.toLocaleString=O.toString,P.toJSON=O.toJSON,P.copy=O.copy,P.slice=O.slice,P.readUInt8=O.readUInt8,P.readUInt16LE=O.readUInt16LE,P.readUInt16BE=O.readUInt16BE,P.readUInt32LE=O.readUInt32LE,P.readUInt32BE=O.readUInt32BE,P.readInt8=O.readInt8,P.readInt16LE=O.readInt16LE,P.readInt16BE=O.readInt16BE,P.readInt32LE=O.readInt32LE,P.readInt32BE=O.readInt32BE,P.readFloatLE=O.readFloatLE,P.readFloatBE=O.readFloatBE,P.readDoubleLE=O.readDoubleLE,P.readDoubleBE=O.readDoubleBE,P.writeUInt8=O.writeUInt8,P.writeUInt16LE=O.writeUInt16LE,P.writeUInt16BE=O.writeUInt16BE,P.writeUInt32LE=O.writeUInt32LE,P.writeUInt32BE=O.writeUInt32BE,P.writeInt8=O.writeInt8,P.writeInt16LE=O.writeInt16LE,P.writeInt16BE=O.writeInt16BE,P.writeInt32LE=O.writeInt32LE,P.writeInt32BE=O.writeInt32BE,P.writeFloatLE=O.writeFloatLE,P.writeFloatBE=O.writeFloatBE,P.writeDoubleLE=O.writeDoubleLE,P.writeDoubleBE=O.writeDoubleBE,P.fill=O.fill,P.inspect=O.inspect,P.toArrayBuffer=O.toArrayBuffer,P}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=4,g=new s(p);g.fill(0),r.exports={hash:function(m,v,y,b){return s.isBuffer(m)||(m=new s(m)),function(x,w,S){for(var C=new s(w),_=S?C.writeInt32BE:C.writeInt32LE,E=0;E<x.length;E++)_.call(C,x[E],4*E,!0);return C}(v(function(x,w){var S;x.length%p!=0&&(S=x.length+(p-x.length%p),x=s.concat([x,g],S));for(var C=[],_=w?x.readInt32BE:x.readInt32LE,E=0;E<x.length;E+=p)C.push(_.call(x,E));return C}(m,b),8*m.length),y,b)}}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=n("./sha"),g=n("./sha256"),m=n("./rng"),v={sha1:p,sha256:g,md5:n("./md5")},y=64,b=new s(y);function x(S,C){var _=v[S=S||"sha1"],E=[];return _||w("algorithm:",S,"is not yet supported"),{update:function(A){return s.isBuffer(A)||(A=new s(A)),E.push(A),A.length,this},digest:function(A){var k=s.concat(E),T=C?function(I,N,O){s.isBuffer(N)||(N=new s(N)),s.isBuffer(O)||(O=new s(O)),N.length>y?N=I(N):N.length<y&&(N=s.concat([N,b],y));for(var D=new s(y),L=new s(y),W=0;W<y;W++)D[W]=54^N[W],L[W]=92^N[W];var G=I(s.concat([D,O]));return I(s.concat([L,G]))}(_,C,k):_(k);return E=null,A?T.toString(A):T}}}function w(){var S=[].slice.call(arguments).join(" ");throw new Error([S,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}b.fill(0),i.createHash=function(S){return x(S)},i.createHmac=x,i.randomBytes=function(S,C){if(!C||!C.call)return new s(m(S));try{C.call(this,void 0,new s(m(S)))}catch(_){C(_)}},function(S,C){for(var _ in S)C(S[_],_)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(S){i[S]=function(){w("sorry,",S,"is not implemented yet")}})}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(S,C){S[C>>5]|=128<<C%32,S[14+(C+64>>>9<<4)]=C;for(var _=1732584193,E=-271733879,A=-1732584194,k=271733878,T=0;T<S.length;T+=16){var I=_,N=E,O=A,D=k,_=v(_,E,A,k,S[T+0],7,-680876936),k=v(k,_,E,A,S[T+1],12,-389564586),A=v(A,k,_,E,S[T+2],17,606105819),E=v(E,A,k,_,S[T+3],22,-1044525330);_=v(_,E,A,k,S[T+4],7,-176418897),k=v(k,_,E,A,S[T+5],12,1200080426),A=v(A,k,_,E,S[T+6],17,-1473231341),E=v(E,A,k,_,S[T+7],22,-45705983),_=v(_,E,A,k,S[T+8],7,1770035416),k=v(k,_,E,A,S[T+9],12,-1958414417),A=v(A,k,_,E,S[T+10],17,-42063),E=v(E,A,k,_,S[T+11],22,-1990404162),_=v(_,E,A,k,S[T+12],7,1804603682),k=v(k,_,E,A,S[T+13],12,-40341101),A=v(A,k,_,E,S[T+14],17,-1502002290),_=y(_,E=v(E,A,k,_,S[T+15],22,1236535329),A,k,S[T+1],5,-165796510),k=y(k,_,E,A,S[T+6],9,-1069501632),A=y(A,k,_,E,S[T+11],14,643717713),E=y(E,A,k,_,S[T+0],20,-373897302),_=y(_,E,A,k,S[T+5],5,-701558691),k=y(k,_,E,A,S[T+10],9,38016083),A=y(A,k,_,E,S[T+15],14,-660478335),E=y(E,A,k,_,S[T+4],20,-405537848),_=y(_,E,A,k,S[T+9],5,568446438),k=y(k,_,E,A,S[T+14],9,-1019803690),A=y(A,k,_,E,S[T+3],14,-187363961),E=y(E,A,k,_,S[T+8],20,1163531501),_=y(_,E,A,k,S[T+13],5,-1444681467),k=y(k,_,E,A,S[T+2],9,-51403784),A=y(A,k,_,E,S[T+7],14,1735328473),_=b(_,E=y(E,A,k,_,S[T+12],20,-1926607734),A,k,S[T+5],4,-378558),k=b(k,_,E,A,S[T+8],11,-2022574463),A=b(A,k,_,E,S[T+11],16,1839030562),E=b(E,A,k,_,S[T+14],23,-35309556),_=b(_,E,A,k,S[T+1],4,-1530992060),k=b(k,_,E,A,S[T+4],11,1272893353),A=b(A,k,_,E,S[T+7],16,-155497632),E=b(E,A,k,_,S[T+10],23,-1094730640),_=b(_,E,A,k,S[T+13],4,681279174),k=b(k,_,E,A,S[T+0],11,-358537222),A=b(A,k,_,E,S[T+3],16,-722521979),E=b(E,A,k,_,S[T+6],23,76029189),_=b(_,E,A,k,S[T+9],4,-640364487),k=b(k,_,E,A,S[T+12],11,-421815835),A=b(A,k,_,E,S[T+15],16,530742520),_=x(_,E=b(E,A,k,_,S[T+2],23,-995338651),A,k,S[T+0],6,-198630844),k=x(k,_,E,A,S[T+7],10,1126891415),A=x(A,k,_,E,S[T+14],15,-1416354905),E=x(E,A,k,_,S[T+5],21,-57434055),_=x(_,E,A,k,S[T+12],6,1700485571),k=x(k,_,E,A,S[T+3],10,-1894986606),A=x(A,k,_,E,S[T+10],15,-1051523),E=x(E,A,k,_,S[T+1],21,-2054922799),_=x(_,E,A,k,S[T+8],6,1873313359),k=x(k,_,E,A,S[T+15],10,-30611744),A=x(A,k,_,E,S[T+6],15,-1560198380),E=x(E,A,k,_,S[T+13],21,1309151649),_=x(_,E,A,k,S[T+4],6,-145523070),k=x(k,_,E,A,S[T+11],10,-1120210379),A=x(A,k,_,E,S[T+2],15,718787259),E=x(E,A,k,_,S[T+9],21,-343485551),_=w(_,I),E=w(E,N),A=w(A,O),k=w(k,D)}return Array(_,E,A,k)}function m(S,C,_,E,A,k){return w((T=w(w(C,S),w(E,k)))<<(I=A)|T>>>32-I,_);var T,I}function v(S,C,_,E,A,k,T){return m(C&_|~C&E,S,C,A,k,T)}function y(S,C,_,E,A,k,T){return m(C&E|_&~E,S,C,A,k,T)}function b(S,C,_,E,A,k,T){return m(C^_^E,S,C,A,k,T)}function x(S,C,_,E,A,k,T){return m(_^(C|~E),S,C,A,k,T)}function w(S,C){var _=(65535&S)+(65535&C);return(S>>16)+(C>>16)+(_>>16)<<16|65535&_}r.exports=function(S){return p.hash(S,g,16)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p;p=function(g){for(var m,v=new Array(g),y=0;y<g;y++)(3&y)==0&&(m=4294967296*Math.random()),v[y]=m>>>((3&y)<<3)&255;return v},r.exports=p}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(y,b){y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var x,w,S,C,_,E=Array(80),A=1732584193,k=-271733879,T=-1732584194,I=271733878,N=-1009589776,O=0;O<y.length;O+=16){for(var D=A,L=k,W=T,G=I,K=N,ee=0;ee<80;ee++){E[ee]=ee<16?y[O+ee]:v(E[ee-3]^E[ee-8]^E[ee-14]^E[ee-16],1);var ce=m(m(v(A,5),(S=k,C=T,_=I,(w=ee)<20?S&C|~S&_:!(w<40)&&w<60?S&C|S&_|C&_:S^C^_)),m(m(N,E[ee]),(x=ee)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),N=I,I=T,T=v(k,30),k=A,A=ce}A=m(A,D),k=m(k,L),T=m(T,W),I=m(I,G),N=m(N,K)}return Array(A,k,T,I,N)}function m(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function v(y,b){return y<<b|y>>>32-b}r.exports=function(y){return p.hash(y,g,20,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function g(y,b){return y>>>b|y<<32-b}function m(y,b){var x,w,S,C,_,E,A,k,T,I,N=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64);y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var L,W,G,K,ee,ce,he,Oe,Te=0;Te<y.length;Te+=16){x=O[0],w=O[1],S=O[2],C=O[3],_=O[4],E=O[5],A=O[6],k=O[7];for(var De=0;De<64;De++)D[De]=De<16?y[De+Te]:p(p(p((Oe=D[De-2],g(Oe,17)^g(Oe,19)^Oe>>>10),D[De-7]),(he=D[De-15],g(he,7)^g(he,18)^he>>>3)),D[De-16]),T=p(p(p(p(k,g(ce=_,6)^g(ce,11)^g(ce,25)),(ee=_)&E^~ee&A),N[De]),D[De]),I=p(g(K=x,2)^g(K,13)^g(K,22),(L=x)&(W=w)^L&(G=S)^W&G),k=A,A=E,E=_,_=p(C,T),C=S,S=w,w=x,x=p(T,I);O[0]=p(x,O[0]),O[1]=p(w,O[1]),O[2]=p(S,O[2]),O[3]=p(C,O[3]),O[4]=p(_,O[4]),O[5]=p(E,O[5]),O[6]=p(A,O[6]),O[7]=p(k,O[7])}return O}var v=n("./helpers");r.exports=function(y){return v.hash(y,m,32,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(){}(a=r.exports={}).nextTick=function(){var g=typeof window!="undefined"&&window.setImmediate,m=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(g)return function(y){return window.setImmediate(y)};if(m){var v=[];return window.addEventListener("message",function(y){var b=y.source;b!==window&&b!==null||y.data!=="process-tick"||(y.stopPropagation(),0<v.length&&v.shift()())},!0),function(y){v.push(y),window.postMessage("process-tick","*")}}return function(y){setTimeout(y,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){i.read=function(p,g,m,v,y){var b,x,w=8*y-v-1,S=(1<<w)-1,C=S>>1,_=-7,E=m?y-1:0,A=m?-1:1,k=p[g+E];for(E+=A,b=k&(1<<-_)-1,k>>=-_,_+=w;0<_;b=256*b+p[g+E],E+=A,_-=8);for(x=b&(1<<-_)-1,b>>=-_,_+=v;0<_;x=256*x+p[g+E],E+=A,_-=8);if(b===0)b=1-C;else{if(b===S)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,v),b-=C}return(k?-1:1)*x*Math.pow(2,b-v)},i.write=function(p,g,m,v,y,b){var x,w,S,C=8*b-y-1,_=(1<<C)-1,E=_>>1,A=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=v?0:b-1,T=v?1:-1,I=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,x=_):(x=Math.floor(Math.log(g)/Math.LN2),g*(S=Math.pow(2,-x))<1&&(x--,S*=2),2<=(g+=1<=x+E?A/S:A*Math.pow(2,1-E))*S&&(x++,S/=2),_<=x+E?(w=0,x=_):1<=x+E?(w=(g*S-1)*Math.pow(2,y),x+=E):(w=g*Math.pow(2,E-1)*Math.pow(2,y),x=0));8<=y;p[m+k]=255&w,k+=T,w/=256,y-=8);for(x=x<<y|w,C+=y;0<C;p[m+k]=255&x,k+=T,x/=256,C-=8);p[m+k-T]|=128*I}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)})})(TK);var H3e=TK.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var OK=function(e,t){return(OK=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ls(e,t){function n(){this.constructor=e}OK(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function tt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function nt(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var IK=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return G3e(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(a){var o=a.split(":"),s=o[0],u=o[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function G3e(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function pe(){return CF}var CF=null,bm=new Map,Uy=new Map;function AF(e,t){var n=IF(e,t);return bm.get(n)}function kF(e){return Uy.get(e)}function TF(e){for(var t=bm.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===e&&n.push(s)}return n}function OF(e){var t=e.kernelName,n=e.backendName,r=IF(t,n);if(bm.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");bm.set(r,e)}function NK(e){var t=e.kernelName;Uy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Uy.set(t,e)}function K3e(e,t){var n=IF(e,t);if(!bm.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");bm.delete(n)}function X3e(e){if(!Uy.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Uy.delete(e)}function IF(e,t){return t+"_"+e}function DK(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function lS(e,t,n){return Math.max(e,Math.min(t,n))}function NF(e){return e%2==0?e:e+1}function RK(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function U(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function ln(e,t,n){n===void 0&&(n=""),U(Ur(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function kh(e){U(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function tc(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Ni(e)&&!n)for(var r=0;r<e.length;++r)tc(e[r],t,n);else t.push(e);return t}function et(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ur(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function gr(e){return e%1==0}function FK(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function cS(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Th(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function DF(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?i():setTimeout(o,s)}};o()})}function MK(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function Wr(e,t){var n=t.length;return U((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),U(e.every(function(r){return gr(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Sf(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Wr(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Oh(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Wy(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function PK(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function $K(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function LK(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Ni(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function RF(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function BK(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Ef(e){return typeof e=="string"||e instanceof String}function zK(e){return typeof e=="boolean"}function jK(e){return typeof e=="number"}function xm(e){return Array.isArray(e)?xm(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":jK(e)?"float32":Ef(e)?"string":zK(e)?"bool":"float32"}function Cf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function fS(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Ja(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function FF(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=tc(e)),n&&PK(e,t),function(a,o){return a instanceof Float32Array&&o==="float32"||a instanceof Int32Array&&o==="int32"||a instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function MF(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,a,o){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=o[i+l];else{u=a[0];var c=a.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(i+l*f,c,o)}return s}(0,e,t)}function PF(e,t){for(var n=wm(e,t),r=0;r<n.length;r++)n[r]=1;return n}function wm(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Bs(){return pe().platform.now()}function $F(e){e.forEach(function(t){U(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function UK(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.encode(e,t)}function Vy(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.decode(e,t)}function dS(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function LF(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var pt=Object.freeze({shuffle:DK,clamp:lS,nearestLargerEven:NF,sum:RK,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:U,assertShapesMatch:ln,assertNonNull:kh,flatten:tc,sizeFromShape:et,isScalarShape:function(e){return e.length===0},arraysEqual:Ur,isInt:gr,tanh:FK,sizeToSquarishShape:cS,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return DK(t),t},rightPad:Th,repeatedTry:DF,inferFromImplicitShape:MK,parseAxisParam:Wr,squeezeShape:Sf,getTypedArrayFromDType:Oh,getArrayFromDType:Wy,checkConversionForErrors:PK,isValidDtype:$K,hasEncodingLoss:LK,isTypedArray:Ni,bytesPerElement:RF,bytesFromStringArray:BK,isString:Ef,isBoolean:zK,isNumber:jK,inferDtype:xm,isFunction:Cf,nearestDivisor:fS,computeStrides:Ja,toTypedArray:FF,toNestedArray:MF,makeOnesTypedArray:PF,makeZerosTypedArray:wm,now:Bs,assertNonNegativeIntegerDimensions:$F,fetch:function(e,t){return pe().platform.fetch(e,t)},encodeString:UK,decodeString:Vy,locToIndex:dS,indexToLoc:LF}),Y3e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Z3e)}return e.prototype.profileKernel=function(t,n,r){var i,a=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),o.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),i},e}(),Z3e=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?Th(i+"ms",9):i.error,u=Th(t,25),l=n.rank,c=n.size,f=Th(n.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||n.shape,g=p.length;d+=h+": "+g+"D "+(g>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),WK=20,qy=3,BF=7;function J3e(e,t,n,r){var i=Ja(t),a=function(l,c,f,d){var h=et(c),p=d[d.length-1],g=new Array(p).fill(0),m=c.length,v=f==="complex64"?Gy(l):l;if(m>1)for(var y=0;y<h/p;y++)for(var b=y*p,x=0;x<p;x++)g[x]=Math.max(g[x],Hy(v[b+x],0,f).length);return g}(e,t,n,i),o=t.length,s=function l(c,f,d,h,p,g){g===void 0&&(g=!0);var m=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[Hy(Gy(c)[0],0,d)]:d==="bool"?[VK(c[0])]:[c[0].toString()];if(y===1){if(v>WK){var b=qy*m,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-qy)*m,v*m));return d==="complex64"&&(x=Gy(x),w=Gy(w)),["["+x.map(function(O,D){return Hy(O,p[D],d)}).join(", ")+", ..., "+w.map(function(O,D){return Hy(O,p[v-qy+D],d)}).join(", ")+"]"]}return["["+(d==="complex64"?Gy(c):Array.from(c)).map(function(O,D){return Hy(O,p[D],d)}).join(", ")+"]"]}var S=f.slice(1),C=h.slice(1),_=h[0]*m,E=[];if(v>WK){for(var A=0;A<qy;A++){var k=(T=A*_)+_;E.push.apply(E,l(c.slice(T,k),S,d,C,p,!1))}for(E.push("..."),A=v-qy;A<v;A++)k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}else for(A=0;A<v;A++){var T;k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}var I=y===2?",":"";for(E[0]="["+E[0]+I,A=1;A<E.length-1;A++)E[A]=" "+E[A]+I;var N=`,
`;for(A=2;A<y;A++)N+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(g?"":N),E}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Hy(e,t,n){return Th(Array.isArray(e)?parseFloat(e[0].toFixed(BF))+" + "+parseFloat(e[1].toFixed(BF))+"j":Ef(e)?"'"+e+"'":n==="bool"?VK(e):parseFloat(e.toFixed(BF)).toString(),t)}function VK(e){return e===0?"false":"true"}function Gy(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var _m=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=et(t),r!=null){var a=r.length;U(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Wy(n,this.size),this.strides=Ja(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),U(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return $u().makeTensor(this.values,this.shape,this.dtype)},e}(),$u=null,ye=null,qK=null,Ht=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=et(t),this.strides=Ja(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),ye.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,ye.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ye.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,MF(this.shape,t)]}})})},e.prototype.arraySync=function(){return MF(this.shape,this.dataSync())},e.prototype.data=function(){return tt(this,void 0,void 0,function(){var t,n;return nt(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=$u().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return Vy(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=$u().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Vy(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,$u().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||($u().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ye.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ye.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ye.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),ye.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ye.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ye.clone(this)},e.prototype.toString=function(t){return t===void 0&&(t=!1),J3e(this.dataSync(),this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ye.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),ye.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),ye.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),ye.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ye.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ye.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),ye.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ye.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),qK("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ye.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ye.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ye.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ye.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ye.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ye.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ye.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ye.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ye.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ye.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ye.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ye.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ye.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ye.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ye.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ye.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ye.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ye.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ye.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ye.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ye.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ye.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ye.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ye.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ye.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ye.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ye.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ye.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ye.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ye.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ye.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ye.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ye.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ye.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),ye.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),ye.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ye.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ye.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ye.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ye.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ye.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ye.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ye.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ye.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ye.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ye.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ye.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ye.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ye.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ye.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ye.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ye.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),ye.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ye.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ye.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ye.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ye.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ye.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ye.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ye.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ye.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ye.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ye.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ye.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ye.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ye.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ye.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ye.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ye.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ye.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ye.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ye.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ye.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ye.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ye.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ye.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ye.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ye.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),ye.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),ye.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),ye.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),ye.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),ye.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),ye.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),ye.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),$u().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ye.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),ye.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),ye.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),ye.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ye.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),ye.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),ye.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ye.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ye.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ye.spectral.irfft(this)},e}();Object.defineProperty(Ht,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var zF,jF,UF,WF,VF,Ky=function(e){function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return Ls(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Ur(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");$u().disposeTensor(this),this.dataId=n.dataId,$u().incRef(this,null)},t.prototype.dispose=function(){$u().disposeVariable(this),this.isDisposedInternal=!0},t}(Ht);Object.defineProperty(Ky,Symbol.hasInstance,{value:function(e){return e instanceof Ht&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(zF||(zF={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(jF||(jF={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(UF||(UF={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(WF||(WF={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(VF||(VF={}));var Q3e={float32:WF,int32:jF,bool:UF,complex64:VF};function yi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return Q3e[e][t]}function hS(e){return yi(e,"int32")}function ur(e,t){if(e.dtype===t.dtype)return[e,t];var n=yi(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function HK(e,t){U(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function qF(e){var t=[];return function n(r,i,a){if(r!=null){if(r instanceof Ht)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,i,a))}}}}(e,t,new Set),t}var HF,Lu=Object.freeze({makeTypesMatch:ur,assertTypesMatch:HK,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:qF}),GK=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),eMe=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new GK}return e.prototype.ready=function(){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=a.sent(),[3,3];case 2:i=r,a.label=3;case 3:if(!i)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Y3e(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;TF(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;TF(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var a=++this.pendingBackendInitId,o=i.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),a=i.success,o=i.asyncInit;if(o||a)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return i.startScope(a)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[],{}),n},e.prototype.runKernel=function(t,n,r,i,a){return this.runKernelFunc(null,n,null,t,r,i,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-a-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,a,o,s){var u,l=this,c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=AF(i,this.backendName);if(m!=null)d=function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:a,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b);var x=b.map(function(C){var _=C.dataId,E=C.shape,A=C.dtype;return l.makeTensorFromDataId(_,E,A)});if(f){var w=l.getTensorsForGradient(i,n,x);if(w==null){s==null&&(s=[]);var S=x.filter(function(C,_){return s[_]});w=(o||[]).slice().concat(S)}c=l.saveTensorsForBackwardMode(w)}return x};else{var v=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))};d=function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,v)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b),b}}return this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,n,function(){return d()}):d()}),f&&this.addTapeNode(i,n,u,r,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.saveTensorsForBackwardMode=function(t){var n=this;return t.map(function(r){return n.keep(n.clone(r))})},e.prototype.getTensorsForGradient=function(t,n,r){var i=kF(t);if(i!=null){var a=i.inputsToSave||[],o=i.outputsToSave||[],s=void 0;i.saveAllInputs?(U(Array.isArray(n),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(n).map(function(l){return n[l]})):s=a.map(function(l){return n[l]});var u=r.filter(function(l,c){return o[c]});return s.concat(u)}return null},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var a=t;r==="string"&&Ef(t[0])&&(a=t.map(function(c){return UK(c)}));var o=i.write(a,n,r),s=new Ht(n,r,o,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(o),l=BK(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var a=new Ht(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,i),a},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var a=new Ky(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*RF(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ky||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,a,o){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=kF(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=function(c){return c=c.map(function(f,d){if(f==null){var h=r[d],p=wm(h.size,h.dtype);return s.makeTensor(p,h.shape,h.dtype)}return f}),i(c.length>1?c:c[0],a,o)}),this.state.activeTape.push(u)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=qF(t),i=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||i.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var a=this;if(i===void 0&&(i=!1),U(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});U(o instanceof Ht,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var g in p){for(var m=p[g],v=!1,y=0;y<l.length;y++)if(f[m.id]){S.outputs.forEach(function(A){return f[A.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var g in p)b[p[g].id]=!0,x[S.id]=!0;break}var w=[];for(h=0;h<u.length;h++){var S;if(d[(S=u[h]).id]&&x[S.id]){var C={};for(var g in S.inputs){var _=S.inputs[g];f[_.id]&&(C[g]=_)}var E=Object.assign({},S);E.inputs=C,E.outputs=S.outputs,w.push(E)}}return w}(this.state.activeTape,n,o);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[o.id]=r??(u=o.shape,l=PF(et(u),"float32"),J.makeTensor(l,u,"float32")),function(d,h,p){for(var g=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(C){var _=d[C.id];_!=null?b.push(_):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(C){if(!(C in x))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(x)+".");var _=p(function(){return x[C]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+_.dtype+"'");var E=y.inputs[C];if(!Ur(_.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+C+"' has shape '"+_.shape+"', which does not match the shape of the input '"+E.shape+"'");if(d[E.id]==null)d[E.id]=_;else{var A=d[E.id];d[E.id]=A.add(_),A.dispose()}};for(var S in y.inputs)w(S)},m=h.length-1;m>=0;m--)g(m)}(c,s,function(d){return a.tidy(d)});var f=n.map(function(d){return c[d.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:o,grads:f}})},e.prototype.customGrad=function(t){var n=this;return U(Cf(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];U(i.every(function(s){return s instanceof Ht}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(s,u){o[u]=s}),n.runKernelFunc(function(s,u){return U((r=t.apply(void 0,i.concat([u]))).value instanceof Ht,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),U(Cf(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];U(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),U(c.every(function(d){return d instanceof Ht}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){switch(i.label){case 0:return n=Bs(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=Bs()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new GK,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),J=function(){var e=function(){if(HF==null){var n=void 0;if(typeof window!="undefined")n=window;else if(typeof global!="undefined")n=global;else if(typeof process!="undefined")n=process;else{if(typeof self=="undefined")throw new Error("Could not find a global object");n=self}HF=n}return HF}();if(e._tfengine==null){var t=new IK(e);e._tfengine=new eMe(t)}return function(n){CF=n}(e._tfengine.ENV),$u=function(){return e._tfengine},e._tfengine}();function KK(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var nc=pe();nc.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),nc.registerFlag("IS_BROWSER",function(){return KK()}),nc.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&process.versions!==void 0&&process.versions.node!==void 0}),nc.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),nc.registerFlag("PROD",function(){return!1}),nc.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return nc.getBool("DEBUG")}),nc.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),nc.registerFlag("IS_TEST",function(){return!1});var Xy,To,Oo,Ih={},GF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function XK(e,t){Ih[e]=t}function Bu(e){e in Ih||(Ih[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Ih[n]},!1),n===1?r.getContext("webgl",GF)||r.getContext("experimental-webgl",GF):r.getContext("webgl2",GF)}(e));var t=Ih[e];return t.isContextLost()?(delete Ih[e],Bu(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ih[e])}function pS(e,t){return[t,e]}function Yy(e){var t=et(e);return cS(Math.ceil(t/4))}function Zy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function KF(e,t){var n,r,i,a,o,s,u,l,c,f=e;return pe().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,i=f.RGBA16F,a=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=f.RGBA,o=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function Qe(e,t,n){var r=n();return t&&function(i){var a=i.getError();if(a!==i.NO_ERROR)throw new Error("WebGL Error: "+ZK(i,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Xy||(Xy={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(To||(To={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Oo||(Oo={}));var tMe=596e-10,nMe=65504;function YK(e){return!!(pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||tMe<Math.abs(e)&&Math.abs(e)<nMe)}function ZK(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Jy(e,t,n){return rc(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function JK(e,t,n){var r=rc(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function QK(e,t,n){var r=rc(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,a){var o=rMe.exec(a);if(o==null)return console.log("Couldn't parse line number in error: "+a),void console.log(i);for(var s=+o[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,v){return Th((v+1).toString(),l)+m}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+Th(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var gS,mS,rMe=/ERROR: [0-9]+:([0-9]+):/g;function eX(e,t){return rc(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function tX(e,t,n){if(Qe(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function vS(e,t,n){if(Qe(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function nX(e,t,n){var r=rc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function rX(e,t,n){var r=rc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function iX(e,t){return rc(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function aX(e,t){var n=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function oX(e,t){return rc(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function XF(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return u!==-1&&(Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),Qe(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)}),Qe(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function sX(e,t,n,r){dX(e,r),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function uX(e,t,n,r){return rc(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function lX(e,t,n){return e.getUniformLocation(t,n)}function cX(e,t,n,r,i,a){Qe(e,t,function(){return sX(e,t,r,a)}),Qe(e,t,function(){return e.uniform1i(i,a)})}function yS(e,t,n,r){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function YF(e,t,n){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Qy(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+fX(e,t))}function fX(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function rc(e,t,n,r){var i=Qe(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function dX(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function eb(e,t){return t===void 0&&(t=2),et(e.slice(0,e.length-t))}function tb(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function bS(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[eb(e)].concat(tb(e))),t}function hX(e,t){var n;t===void 0&&(t=!1);var r=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?NF(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=Sf(e);e=i.newShape}var a=et(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=eb(e),s=2,u=2;return e.length&&(s=(n=tb(e))[0],u=n[1]),cS(a=o*(s/2)*(u/2)).map(function(l){return 2*l})}return cS(a)}function xS(e){return e%2==0}function nb(e,t){if(Ur(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||xS(n)&&xS(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&xS(e[0])&&xS(t[0])}function pX(e){if(gS==null){var t=Bu(e);gS=t.getParameter(t.MAX_TEXTURE_SIZE)}return gS}function gX(e){if(mS==null){var t=Bu(e);mS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,mS)}function mX(e){if(e===0)return 0;var t=Bu(e);return Io(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Io(t,"EXT_disjoint_timer_query")?1:0}function Io(e,t){return e.getExtension(t)!=null}function ZF(e){try{if(Bu(e)!=null)return!0}catch(t){return!1}return!1}function vX(e){if(e===0)return!1;var t=Bu(e);if(e===1){if(!Io(t,"OES_texture_float"))return!1}else if(!Io(t,"EXT_color_buffer_float"))return!1;return JF(t)}function yX(e){if(e===0)return!1;var t=Bu(e);if(e!==1){if(Io(t,"EXT_color_buffer_float"))return JF(t);if(Io(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var a=KF(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Io(t,"OES_texture_float")&&!!Io(t,"WEBGL_color_buffer_float")&&JF(t)}function JF(e){var t=KF(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function bX(e){return e===2&&Bu(e).fenceSync!=null}var iMe=Object.freeze({callAndCheck:Qe,canBeRepresented:YK,getWebGLErrorMessage:ZK,getExtensionOrThrow:Jy,createVertexShader:JK,createFragmentShader:QK,createProgram:eX,linkProgram:tX,validateProgram:vS,createStaticVertexBuffer:nX,createStaticIndexBuffer:rX,getNumChannels:function(){return pe().getNumber("WEBGL_VERSION")===2?1:4},createTexture:iX,validateTextureSize:aX,createFramebuffer:oX,bindVertexBufferToProgramAttribute:XF,bindTextureUnit:sX,unbindTextureUnit:function(e,t,n){dX(e,n),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:uX,getProgramUniformLocation:lX,bindTextureToProgramUniformSampler:cX,bindCanvasToFramebuffer:function(e,t){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Qe(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),Qe(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:yS,unbindColorTextureFromFramebuffer:YF,validateFramebuffer:Qy,getFramebufferErrorMessage:fX,getBatchDim:eb,getRowsCols:tb,getShapeAs3D:bS,getTextureShapeFromLogicalShape:hX,isReshapeFree:nb,getWebGLMaxTextureSize:pX,resetMaxTextureSize:function(){gS=null},resetMaxTexturesInShader:function(){mS=null},getMaxTexturesInShader:gX,getWebGLDisjointQueryTimerVersion:mX,hasExtension:Io,isWebGLVersionEnabled:ZF,isCapableOfRenderingToFloatTexture:vX,isDownloadFloatTextureEnabled:yX,isWebGLFenceEnabled:bX}),Ct=pe();function aMe(){pe().set("PROD",!0)}function oMe(){pe().set("DEBUG",!0)}function sMe(){pe().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function wS(e){pe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function uMe(){J.disposeVariables()}function lMe(){return J}function _S(){return J.memory()}function cMe(e){return J.profile(e)}function le(e,t){return J.tidy(e,t)}function Ut(e){qF(e).forEach(function(t){return t.dispose()})}function zu(e){return J.keep(e)}function fMe(e){return J.time(e)}function dMe(e){return J.setBackend(e)}function hMe(){return J.ready()}function pMe(){return J.backendName}function gMe(e){J.removeBackend(e)}function mMe(e){return J.findBackend(e)}function vMe(e){return J.findBackendFactory(e)}function yMe(e,t,n){return n===void 0&&(n=1),J.registerBackend(e,t,n)}function xX(){return J.backend}function bMe(e,t){pe().setPlatform(e,t)}function SS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pe().getBool("IS_TEST")||console.warn.apply(console,e)}function ju(e,t){var n=e;if(Ni(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Ni(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&pe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(a,o,s){if(s=s||[],!Array.isArray(a)&&!Ni(a))return void U(o.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});U(o.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),U(a.length===o[0],function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+a.length+" elements"});for(var u=o.slice(1),l=0;l<a.length;++l)i(a[l],u,s.concat(l))}(e,r,[]),r}function wX(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function j(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Ht)return wX(r,e.dtype,t,n),e;var i=xm(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),wX(r,i,t,n),e==null||!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=ju(e,i);Ni(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?FF(e,i,pe().getBool("DEBUG")):tc(e,[],!0);return J.makeTensor(s,o,i)}function rb(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,a){return j(i,t+"["+a+"]",n)},r)}function QF(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function _X(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function Di(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(a){return e[a]})]}function ya(e,t){return _X(e,t.map(function(n){return 1}),t)}function Qa(e,t,n){U(QF(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function zs(e,t){if(QF(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function ES(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function js(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function SX(e,t){var n=e[0].length;e.forEach(function(i,a){U(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),U(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)U(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function Nh(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Q(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];J.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),J.endScope(s),s}catch(u){throw J.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Ct.registerFlag("HAS_WEBGL",function(){return Ct.getNumber("WEBGL_VERSION")>0}),Ct.registerFlag("WEBGL_VERSION",function(){return ZF(2)?2:ZF(1)?1:0}),Ct.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ct.get("WEBGL_VERSION")===2}),Ct.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ct.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ct.registerFlag("WEBGL_PACK",function(){return Ct.getBool("HAS_WEBGL")}),Ct.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_CLIP",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ct.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_REDUCE",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_CONV_IM2COL",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return pX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return gX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Ct.getNumber("WEBGL_VERSION");return e===0?0:mX(e)}),Ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ct.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Ct.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return vX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ct.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ct.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ct.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return yX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return bX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ct.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),qK=wS;var ri=Q({complex_:function(e,t){var n=j(e,"real","complex"),r=j(t,"imag","complex");return ln(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),J.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),eo=Q({real_:function(e){var t=j(e,"input","real");return J.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),is=Q({imag_:function(e){var t=j(e,"input","imag");return J.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Rr(e,t,n){return Af(e,t,ju(e,n),n)}function Af(e,t,n,r){if(r==null&&(r=xm(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){$F(t);var i=et(t),a=et(n);U(i===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a});for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==et(t.slice(o));U(n[o]===t[o]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Ni(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?FF(e,r,pe().getBool("DEBUG")):tc(e,[],!0),J.makeTensor(e,t,r)}function Ve(e,t){if((Ni(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ni(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Af(e,[],[],t)}function ba(e,t){kh(e);var n=ju(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Af(e,null,n,t)}function Uu(e,t,n){if(kh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ju(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Af(e,t,r,n)}function CS(e,t,n){if(kh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ju(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Af(e,t,r,n)}function kf(e,t,n){if(kh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ju(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Af(e,t,r,n)}function EX(e,t,n){if(kh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ju(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Af(e,t,r,n)}function CX(e,t,n){if(kh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ju(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Af(e,t=t||r,r,n)}function e3(e,t,n,r){return t===void 0&&(t=!0),J.makeVariable(e,t,n,r)}function Wu(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Wu(e,"float32"),r=Tn(e,"float32");return ri(n,r)}var i=PF(et(e),t);return J.makeTensor(i,e,t)}function Tn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Tn(e,"float32"),r=Tn(e,"float32");return ri(n,r)}var i=wm(et(e),t);return J.makeTensor(i,e,t)}function Sm(e,t,n){return J.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function t3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return J.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Em(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Tn([0],r);var i=wm(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return ba(i,r)}var No=Q({onesLike_:function(e){var t=j(e,"x","onesLike");if(t.dtype==="complex64"){var n=No(eo(t)),r=en(is(t));return ri(n,r)}return J.runKernelFunc(function(i){return i.onesLike(t)},{x:t},function(i,a){return{x:function(){return en(i)}}},"OnesLike")}}),en=Q({zerosLike_:function(e){var t=j(e,"x","zerosLike");return J.runKernelFunc(function(n){return n.zerosLike(t)},{x:t},function(n,r){return{x:function(){return en(n)}}},"ZerosLike")}}),Hi=Q({concat_:function(e,t){t===void 0&&(t=0),U(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=rb(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Wr(t,n[0].shape)[0];var r=Nh(n.map(function(s){return s.shape}),t);if(et(r)===0)return Rr([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});SX(i,t);var a=n,o={axis:t};return J.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=i.map(function(l){return l[t]});return ic(s,u,t).map(function(l){return function(){return l}})},"Concat",o)}}),n3=Q({concat1d_:function(e){return Hi(e,0)}}),r3=Q({concat2d_:function(e,t){return Hi(e,t)}}),i3=Q({concat3d_:function(e,t){return Hi(e,t)}}),a3=Q({concat4d_:function(e,t){return Hi(e,t)}}),ic=Q({split_:function(e,t,n){n===void 0&&(n=0);var r,i=j(e,"x","split");return n=Wr(n,i.shape)[0],typeof t=="number"?(U(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(U(i.shape[n]===t.reduce(function(a,o){return a+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),J.runKernelFunc(function(a){return a.split(i,r,n)},{$x:i},function(a){return{$x:function(){return Hi(a,n)}}})}});function Ot(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",$F(e),new _m(e,t,n)}function AX(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var AS=Q({batchToSpaceND_:function(e,t,n){var r=j(e,"x","batchToSpaceND"),i=t.reduce(function(a,o){return a*o});return U(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),U(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),U(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),J.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),kS=Q({cast_:function(e,t){var n=j(e,"x","cast");if(!$K(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return J.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),kX=Q({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=j(e,"x","cumsum"),a=zs([t|=0],i.rank),o=i;a!=null&&(o=i.transpose(a));var s=js(1,i.rank)[0],u=J.runKernelFunc(function(l){return l.cumsum(o,s,n,r)},{permutedX:o},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),o3=Q({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=j(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return U(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),U(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),U(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),J.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Do=Q({expandDims_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","expandDims",null);U(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(U(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Us(n,r)}}),Us=Q({reshape_:function(e,t){var n=j(e,"x","reshape",null);t=MK(t,n.size),U(n.size===et(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return J.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),TS=Q({spaceToBatchND_:function(e,t,n){var r=j(e,"x","spaceToBatchND");return U(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),U(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),U(r.shape.reduce(function(i,a,o){return o>0&&o<=t.length?i&&(a+n[o-1][0]+n[o-1][1])%t[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),J.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),ib=Q({squeeze_:function(e,t){var n=j(e,"x","squeeze");return Us(n,Sf(n.shape,t).newShape)}}),as=Q({stack_:function(e,t){t===void 0&&(t=0);var n=rb(e,"tensors","stack");if(U(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;U(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){ln(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){U(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(s){return s.expandDims(t)});return Hi(o,t)}}),Tf=Q({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=j(e,"x","unstack");U(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return J.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return as(i,t)}}},"Unpack",r)}}),s3=function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return n=j(e,"x","setdiff1d"),r=j(t,"y","setdiff1d"),U(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),U(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),U(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(a=d.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(u=new _m([s],n.dtype),l=new _m([s],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function OS(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function IS(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function NS(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function TX(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function OX(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var u3="Add",xMe="AddN",ab="Div",wMe="FusedBatchNorm",ob="SquaredDifference",_Me="Square",SMe="Transpose",EMe="NonMaxSuppressionV5",l3="BroadcastTo",c3="OneHot",f3="Identity",d3="Tile",h3="PadV2",CMe="FromPixels",AMe="MaxPoolWithArgmax",Wt=Q({add_:function(e,t){var n,r=j(e,"a","add"),i=j(t,"b","add");n=ur(r,i),r=n[0],i=n[1];var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.add(r,i);return s([r,i]),u},a,null,u3)}});function ac(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function Vr(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function Qt(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}var Of=Q({abs_:function(e){var t=j(e,"x","abs");return t.dtype==="complex64"?J.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):J.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),p3=Q({acos_:function(e){var t=j(e,"x","acos");return J.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),g3=Q({acosh_:function(e){var t=j(e,"x","acosh");return J.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),m3=Q({asin_:function(e){var t=j(e,"x","asin");return J.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt())}}})}}),v3=Q({asinh_:function(e){var t=j(e,"x","asinh");return J.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).add(i.toFloat().square()).sqrt())}}})}}),y3=Q({atan_:function(e){var t=j(e,"x","atan");return J.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),b3=Q({atanh_:function(e){var t=j(e,"x","atanh");return J.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(Ve(1).sub(i.toFloat().square()))}}})}}),x3=Q({ceil_:function(e){var t=j(e,"x","ceil");return J.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),xa=Q({clipByValue_:function(e,t,n){var r=j(e,"x","clipByValue");U(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],a={min:t,max:n};return J.runKernelFunc(function(o,s){var u=o.clip(r,t,n);return s([r]),u},{x:r},function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),en(o))}}},"ClipByValue",a,i)}}),w3=Q({cos_:function(e){var t=j(e,"x","cos"),n=[t];return J.runKernelFunc(function(r,i){var a=r.cos(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),_3=Q({cosh_:function(e){var t=j(e,"x","cosh");return J.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),S3=Q({erf_:function(e){var t=j(e,"x","erf");return U(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),J.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),E3=Q({exp_:function(e){var t=j(e,"x","exp");return J.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),C3=Q({expm1_:function(e){var t=j(e,"x","expm1");return J.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),DS=Q({floor_:function(e){var t=j(e,"x","floor");return J.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),oc=Q({log_:function(e){var t=j(e,"x","log"),n=[t];return J.runKernelFunc(function(r,i){var a=r.log(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),A3=Q({log1p_:function(e){var t=j(e,"x","log1p");return J.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),IX=Q({logSigmoid_:function(e){var t=j(e,"x","logSigmoid");return J.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),If=Q({neg_:function(e){var t=j(e,"x","neg"),n=[t];return J.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),k3=Q({reciprocal_:function(e){var t=j(e,"x","reciprocal");return J.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),T3=Q({round_:function(e){var t=j(e,"x","round");return J.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),RS=Q({rsqrt_:function(e){var t=j(e,"x","rsqrt"),n=[t];return J.runKernelFunc(function(r,i){var a=r.rsqrt(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),FS=Q({sigmoid_:function(e){var t=j(e,"x","sigmoid");return J.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(Ve(1).sub(i)))}}},"Sigmoid")}}),O3=Q({sign_:function(e){var t=j(e,"x","sign");return J.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),NX=Q({isNaN_:function(e){var t=j(e,"x","isNaN");return J.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),DX=Q({isInf_:function(e){var t=j(e,"x","isInf");return J.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),RX=Q({isFinite_:function(e){var t=j(e,"x","isFinite");return J.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),I3=Q({sin_:function(e){var t=j(e,"x","sin"),n=[t];return J.runKernelFunc(function(r,i){var a=r.sin(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),N3=Q({sinh_:function(e){var t=j(e,"x","sinh");return J.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),sb=Q({softplus_:function(e){var t=j(e,"x","softplus");return J.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),ub=Q({sqrt_:function(e){var t=j(e,"x","sqrt");return J.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),FX=Q({step_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","step");return J.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return en(r)}}})}}),D3=Q({tan_:function(e){var t=j(e,"x","tan");return J.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),MS=Q({tanh_:function(e){var t=j(e,"x","tanh");return J.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return Ve(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}}),MX=Q({addStrict_:function(e,t){var n=j(e,"a","addStrict"),r=j(t,"b","addStrict");return ln(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),R3=Q({atan2_:function(e,t){var n,r=j(e,"a","atan2"),i=j(t,"b","atan2");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Wt(u.square(),l.square()),f=o.mul(l.div(c)),d=Vr(u.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Wt(u.square(),l.square()),f=If(o.mul(u.div(c))),d=Vr(l.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),PX=Q({divStrict_:function(e,t){var n=j(e,"a","div"),r=j(t,"b","div");return ln(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),PS=Q({floorDiv_:function(e,t){var n,r=j(e,"a","floorDiv"),i=j(t,"b","floorDiv");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.div(l.toFloat()),f=Vr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Vr(l.shape,a);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),Vu=Q({maximum_:function(e,t){var n,r=j(e,"a","maximum"),i=j(t,"b","maximum");return n=ur(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.maximum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),$X=Q({maximumStrict_:function(e,t){var n=j(e,"a","maximumStrict"),r=j(t,"b","maximumStrict");return ln(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Cm=Q({minimum_:function(e,t){var n,r=j(e,"a","minimum"),i=j(t,"b","minimum");return n=ur(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.minimum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),LX=Q({minimumStrict_:function(e,t){var n=j(e,"a","minimumStrict"),r=j(t,"b","minimumStrict");return ln(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),F3=Q({mod_:function(e,t){var n,r=j(e,"a","mod"),i=j(t,"b","mod");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Vr(u.shape,a);return c.length>0?o.sum(c).reshape(u.shape):o},$b:function(){var c=o.mul(u.div(l).floor().neg()),f=Vr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),BX=Q({modStrict_:function(e,t){var n=j(e,"a","modStrict"),r=j(t,"b","modStrict");return ln(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),rt=Q({mul_:function(e,t){var n,r=j(e,"a","mul"),i=j(t,"b","mul");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.mul(l.toFloat()),f=Vr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Vr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),$S=Q({mulStrict_:function(e,t){var n=j(e,"a","mul"),r=j(t,"b","mul");return ln(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Am=Q({pow_:function(e,t){var n,r=j(e,"base","pow"),i=j(t,"exp","pow");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape),o=[r,i];return J.runKernelFunc(function(s,u){var l=s.pow(r,i);return u([r,i,l]),l},{a:r,b:i},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(Ve(1))))),p=Vr(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,en(l)),p=s.mul(f.mul(h)),g=Vr(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),zX=Q({powStrict_:function(e,t){return ln(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),jX=Q({squaredDifferenceStrict_:function(e,t){var n=j(e,"a","squaredDifferenceStrict"),r=j(t,"b","squaredDifferenceStrict");return ln(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Er=Q({sub_:function(e,t){var n,r=j(e,"a","sub"),i=j(t,"b","sub");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var s=o,u=Vr(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=o,u=Vr(i.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),UX=Q({subStrict_:function(e,t){var n=j(e,"a","subStrict"),r=j(t,"b","subStrict");return ln(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Cr=Q({div_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");if(n=ur(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return PS(r,i);var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.realDivide(r,i);return s([r,i]),u},a,null,ab,{})}});function M3(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var l=Ja(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var kMe=Object.freeze({prepareAndValidate:M3}),P3=30;function LS(e){return e<=P3?e:fS(e,Math.floor(Math.sqrt(e)))}function WX(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}function VX(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}WX(n,t,e)}function lb(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:et(t.shape)/u,sliceSize:o,strides:Ja(n.slice(0,i)).concat([1]),outputSize:et(n)}}var TMe=Object.freeze({validateUpdateShape:WX,validateInput:VX,calculateShapes:lb});function qX(e,t,n){U(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),U(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){U(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},i=0;i<e.rank;++i)r(i)}function $3(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function BS(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function HX(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=lS(0,a,s-1)}function GX(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?lS(0,a,s):lS(-1,a,s-1)}function L3(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function B3(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}var OMe=Object.freeze({assertParamsValid:qX,maskToAxes:$3,computeOutShape:BS,startForAxis:HX,stopForAxis:GX,isSliceContinous:L3,computeFlatOffset:B3});function IMe(e){return U(Cf(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var r=j(t,"x","tf.grad",null),i=n!=null?j(n,"dy","tf.grad"):null;return J.tidy(function(){var a=J.gradients(function(){return e(r)},[r],i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),zS(s),s[0]})}}function NMe(e){return U(Cf(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){U(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=rb(t,"args","tf.grads",null),i=n!=null?j(n,"dy","tf.grads"):null;return J.tidy(function(){var a=J.gradients(function(){return e.apply(void 0,r)},r,i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),zS(s),s})}}function DMe(e){return U(Cf(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){U(t instanceof Ht,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=J.gradients(function(){return e(t)},[t],n),i=r.grads,a=r.value;return zS(i),{grad:i[0],value:a}}}function RMe(e){return U(Cf(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){U(Array.isArray(t)&&t.every(function(i){return i instanceof Ht}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=J.gradients(function(){return e.apply(void 0,t)},t,n);return n!=null&&ln(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),zS(r.grads),r}}function KX(e,t){U(Cf(e),function(){return"The f passed in variableGrads(f) must be a function"}),U(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Ky}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],J.registeredVariables)t.push(J.registeredVariables[r]);var i=n?t.filter(function(c){return!c.trainable}):null,a=t.length;U((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var o=J.gradients(e,t,null,!0),s=o.value,u=o.grads;U(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),U(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function cb(e){return J.customGrad(e)}function zS(e){if(e.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Dh=Q({softmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return J.runKernelFunc(function(r,i){var a=r.softmax(n,t);return i([a]),a},{logits:n},function(r,i){var a=i[0],o=r.mul(a);return{logits:function(){return o.sub(o.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),jS=Q({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return cb(function(r,i){var a=r.max(t,!0),o=r.sub(a),s=o.toFloat().sub(o.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),cn=Q({transpose_:function(e,t){var n=j(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){U(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return J.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}}),z3=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),j3=function(){function e(){}return e.prototype.time=function(t){return fe("time")},e.prototype.read=function(t){return fe("read")},e.prototype.readSync=function(t){return fe("readSync")},e.prototype.numDataIds=function(){return fe("numDataIds")},e.prototype.disposeData=function(t){return fe("disposeData")},e.prototype.write=function(t,n,r){return fe("write")},e.prototype.move=function(t,n,r,i){return fe("move")},e.prototype.memory=function(){return fe("memory")},e.prototype.floatPrecision=function(){return fe("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return fe("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,fe("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return fe("slice")},e.prototype.stridedSlice=function(t,n,r,i){return fe("stridedSlice")},e.prototype.unstack=function(t,n){return fe("unstack")},e.prototype.reverse=function(t,n){return fe("reverse")},e.prototype.concat=function(t,n){return fe("concat")},e.prototype.neg=function(t){return fe("neg")},e.prototype.add=function(t,n){return fe("add")},e.prototype.addN=function(t){return fe("addN")},e.prototype.subtract=function(t,n){return fe("subtract")},e.prototype.multiply=function(t,n){return fe("multiply")},e.prototype.realDivide=function(t,n){return fe("realDivide")},e.prototype.floorDiv=function(t,n){return fe("floorDiv")},e.prototype.sum=function(t,n){return fe("sum")},e.prototype.prod=function(t,n){return fe("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return fe("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return fe("argMin")},e.prototype.argMax=function(t,n){return fe("argMax")},e.prototype.equal=function(t,n){return fe("equal")},e.prototype.notEqual=function(t,n){return fe("notEqual")},e.prototype.less=function(t,n){return fe("less")},e.prototype.lessEqual=function(t,n){return fe("lessEqual")},e.prototype.greater=function(t,n){return fe("greater")},e.prototype.greaterEqual=function(t,n){return fe("greaterEqual")},e.prototype.logicalNot=function(t){return fe("logicalNot")},e.prototype.logicalAnd=function(t,n){return fe("logicalAnd")},e.prototype.logicalOr=function(t,n){return fe("logicalOr")},e.prototype.where=function(t){return fe("where")},e.prototype.select=function(t,n,r){return fe("select")},e.prototype.topk=function(t,n,r){return fe("topk")},e.prototype.min=function(t,n){return fe("min")},e.prototype.minimum=function(t,n){return fe("minimum")},e.prototype.mod=function(t,n){return fe("mod")},e.prototype.max=function(t,n){return fe("max")},e.prototype.maximum=function(t,n){return fe("maximum")},e.prototype.all=function(t,n){return fe("all")},e.prototype.any=function(t,n){return fe("any")},e.prototype.squaredDifference=function(t,n){return fe("squaredDifference")},e.prototype.ceil=function(t){return fe("ceil")},e.prototype.floor=function(t){return fe("floor")},e.prototype.round=function(t){return fe("round")},e.prototype.sign=function(t){return fe("sign")},e.prototype.isNaN=function(t){return fe("isNaN")},e.prototype.isInf=function(t){return fe("isInf")},e.prototype.isFinite=function(t){return fe("isFinite")},e.prototype.pow=function(t,n){return fe("pow")},e.prototype.exp=function(t){return fe("exp")},e.prototype.expm1=function(t){return fe("expm1")},e.prototype.softmax=function(t,n){return fe("softmax")},e.prototype.log=function(t){return fe("log")},e.prototype.log1p=function(t){return fe("log1p")},e.prototype.sqrt=function(t){return fe("sqrt")},e.prototype.rsqrt=function(t){return fe("rsqrt")},e.prototype.square=function(t){return fe("square")},e.prototype.reciprocal=function(t){return fe("reciprocal")},e.prototype.relu=function(t){return fe("relu")},e.prototype.relu6=function(t){return fe("relu6")},e.prototype.prelu=function(t,n){return fe("prelu")},e.prototype.elu=function(t){return fe("elu")},e.prototype.eluDer=function(t,n){return fe("eluDer")},e.prototype.selu=function(t){return fe("selu")},e.prototype.int=function(t){return fe("int")},e.prototype.clip=function(t,n,r){return fe("clip")},e.prototype.abs=function(t){return fe("abs")},e.prototype.complexAbs=function(t){return fe("complexAbs")},e.prototype.sigmoid=function(t){return fe("sigmoid")},e.prototype.softplus=function(t){return fe("softplus")},e.prototype.sin=function(t){return fe("sin")},e.prototype.cos=function(t){return fe("cos")},e.prototype.tan=function(t){return fe("tan")},e.prototype.asin=function(t){return fe("asin")},e.prototype.acos=function(t){return fe("acos")},e.prototype.atan=function(t){return fe("atan")},e.prototype.atan2=function(t,n){return fe("atan2")},e.prototype.sinh=function(t){return fe("sinh")},e.prototype.cosh=function(t){return fe("cosh")},e.prototype.tanh=function(t){return fe("tanh")},e.prototype.asinh=function(t){return fe("asinh")},e.prototype.acosh=function(t){return fe("acosh")},e.prototype.atanh=function(t){return fe("atanh")},e.prototype.erf=function(t){return fe("erf")},e.prototype.step=function(t,n){return fe("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return fe("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return fe("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return fe("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return fe("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return fe("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return fe("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return fe("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return fe("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return fe("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return fe("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return fe("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return fe("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return fe("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return fe("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return fe("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return fe("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return fe("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return fe("reshape")},e.prototype.cast=function(t,n){return fe("cast")},e.prototype.tile=function(t,n){return fe("tile")},e.prototype.pad=function(t,n,r){return fe("pad")},e.prototype.transpose=function(t,n){return fe("transpose")},e.prototype.gather=function(t,n,r){return fe("gather")},e.prototype.gatherND=function(t,n){return fe("gatherND")},e.prototype.scatterND=function(t,n,r){return fe("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return fe("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return fe("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return fe("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return fe("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return fe("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return fe("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,a,o){return fe("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,a){return fe("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,a,o,s){return fe("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return fe("multinomial")},e.prototype.oneHot=function(t,n,r,i){return fe("oneHot")},e.prototype.cumsum=function(t,n,r,i){return fe("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,a){return fe("nonMaxSuppression")},e.prototype.fft=function(t){return fe("fft")},e.prototype.ifft=function(t){return fe("ifft")},e.prototype.complex=function(t,n){return fe("complex")},e.prototype.real=function(t){return fe("real")},e.prototype.imag=function(t){return fe("imag")},e.prototype.cropAndResize=function(t,n,r,i,a,o){return fe("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return fe("depthToSpace")},e.prototype.split=function(t,n,r){return fe("split")},e.prototype.sparseToDense=function(t,n,r,i){return fe("sparseToDense")},e.prototype.diag=function(t){return fe("diag")},e.prototype.fill=function(t,n,r){return fe("fill")},e.prototype.onesLike=function(t){return fe("onesLike")},e.prototype.zerosLike=function(t){return fe("zerosLike")},e.prototype.linspace=function(t,n,r){return fe("linspace")},e.prototype.dispose=function(){return fe("dispose")},e}();function fe(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Nf(e,t,n,r,i,a,o){o===void 0&&(o="channelsLast");var s,u=US(t),l=u[0],c=u[1];if(o==="channelsLast")s=[l,c,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,c,e[1],e[1]]}return Df(e,s,n,r,i,a,!1,o)}function fb(e,t,n,r,i,a,o){o===void 0&&(o="NDHWC");var s,u,l=W3(t),c=l[0],f=l[1],d=l[2];if(o==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return db(e,s,n,r,i,!1,u,a)}function Df(e,t,n,r,i,a,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],g=t[1],m=t[3],v=US(n),y=v[0],b=v[1],x=US(r),w=x[0],S=x[1],C=km(p,w),_=km(g,S),E=function(N,O,D,L,W,G,K,ee){var ce,he,Oe;if(typeof N=="number"){ce={top:N,bottom:N,left:N,right:N,type:N===0?"VALID":"NUMBER"};var Te=function(ae,Y,M,B,R){B==null&&(B=U3(ae,Y,M));var X=ae[0],ge=ae[1],xe=hb((X-Y+2*B)/M+1,R);U(gr(xe),function(){return"The output # of rows ("+xe+") must be an integer. Change the stride and/or zero pad parameters"});var ze=hb((ge-Y+2*B)/M+1,R);return U(gr(ze),function(){return"The output # of columns ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}),[xe,ze]}([O,D],G,L,N,ee);he=Te[0],Oe=Te[1]}else if(N==="same"){he=Math.ceil(O/L),Oe=Math.ceil(D/W);var De=Math.max(0,(he-1)*L+G-O),me=Math.max(0,(Oe-1)*W+K-D),P=Math.floor(De/2),F=De-P,V=Math.floor(me/2);ce={top:P,bottom:F,left:V,right:me-V,type:"SAME"}}else{if(N!=="valid")throw Error("Unknown padding parameter: "+N);ce={top:0,bottom:0,left:0,right:0,type:"VALID"},he=Math.ceil((O-G+1)/L),Oe=Math.ceil((D-K+1)/W)}return{padInfo:ce,outHeight:he,outWidth:Oe}}(i,c,f,y,b,C,_,a),A=E.padInfo,k=E.outHeight,T=E.outWidth,I=o?m*d:m;return s==="channelsFirst"?h=[l,I,k,T]:s==="channelsLast"&&(h=[l,k,T,I]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:k,outWidth:T,outChannels:I,padInfo:A,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function db(e,t,n,r,i,a,o,s){a===void 0&&(a=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(o==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],y=t[4],b=W3(n),x=b[0],w=b[1],S=b[2],C=W3(r),_=C[0],E=C[1],A=C[2],k=km(g,_),T=km(m,E),I=km(v,A),N=function(K,ee,ce,he,Oe,Te,De,me,P,F,V){var ae,Y,M,B;if(typeof K=="number"){ae={top:K,bottom:K,left:K,right:K,front:K,back:K,type:K===0?"VALID":"NUMBER"};var R=function(Zt,mn,Hn,ti,er,Dn){er==null&&(er=U3(Zt,mn,ti));var Jo=Zt[0],Ka=Zt[1],jl=Zt[2],ks=hb((Jo-mn+2*er)/ti+1,Dn);U(gr(ks),function(){return"The output # of depths ("+ks+") must be an integer. Change the stride and/or zero pad parameters"});var Ts=hb((Ka-mn+2*er)/ti+1,Dn);U(gr(Ts),function(){return"The output # of rows ("+Ts+") must be an integer. Change the stride and/or zero pad parameters"});var Ul=hb((jl-mn+2*er)/ti+1,Dn);return U(gr(Ul),function(){return"The output # of columns ("+Ul+") must be an integer. Change the stride and/or zero pad parameters"}),[ks,Ts,Ul,Hn]}([ee,ce,he,1],me,1,Oe,K,V);Y=R[0],M=R[1],B=R[2]}else if(K==="same"){Y=Math.ceil(ee/Oe),M=Math.ceil(ce/Te),B=Math.ceil(he/De);var X=(Y-1)*Oe+me-ee,ge=(M-1)*Te+P-ce,xe=(B-1)*De+F-he,ze=Math.floor(X/2),Ke=X-ze,Ze=Math.floor(ge/2),Bt=ge-Ze,Je=Math.floor(xe/2);ae={top:Ze,bottom:Bt,left:Je,right:xe-Je,front:ze,back:Ke,type:"SAME"}}else{if(K!=="valid")throw Error("Unknown padding parameter: "+K);ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Y=Math.ceil((ee-me+1)/Oe),M=Math.ceil((ce-P+1)/Te),B=Math.ceil((he-F+1)/De)}return{padInfo:ae,outDepth:Y,outHeight:M,outWidth:B}}(i,c,f,d,x,w,S,k,T,I,s),O=N.padInfo,D=N.outDepth,L=N.outHeight,W=N.outWidth,G=a?y*h:y;return o==="channelsFirst"?p=[l,G,D,L,W]:o==="channelsLast"&&(p=[l,D,L,W,G]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:D,outHeight:L,outWidth:W,outChannels:G,padInfo:O,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:_,dilationHeight:E,dilationWidth:A,inShape:e,outShape:p,filterShape:t}}function U3(e,t,n,r){r===void 0&&(r=1);var i=km(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function US(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function W3(e){return typeof e=="number"?[e,e,e]:e}function km(e,t){return t<=1?e:e+(e-1)*(t-1)}function hb(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Rh(e){var t=US(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Gi(e,t){return Rh(e)||Rh(t)}function WS(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function V3(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Tn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!LK(e.dtype,t))return J.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=Ve(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function VS(e,t){return J.makeTensorFromDataId(e.dataId,t,e.dtype)}function q3(e,t,n){var r=(t-e)/(n-1),i=wm(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return ba(i,"float32")}var FMe=Object.freeze({castTensor:V3,reshapeTensor:VS,linspaceImpl:q3,upcastType:yi,axesAreInnerMostDims:QF,combineLocations:_X,computeOutAndReduceShapes:Di,expandShapeToKeepDim:ya,assertAxesAreInnerMostDims:Qa,getAxesPermutation:zs,getUndoAxesPermutation:ES,getInnerMostAxes:js,getBroadcastDims:ac,getReductionAxes:Vr,assertAndGetBroadcastShape:Qt,assertParamsConsistent:SX,computeOutShape:Nh,computePool2DInfo:Nf,computePool3DInfo:fb,computeConv2DInfo:Df,computeConv3DInfo:db,computeDefaultPad:U3,tupleValuesAreOne:Rh,eitherStridesOrDilationsAreOne:Gi,convertConv2DDataFormat:WS,PARALLELIZE_THRESHOLD:P3,computeOptimalWindowSize:LS});function H3(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function XX(e,t){return{real:e[2*t],imag:e[2*t+1]}}function MMe(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function PMe(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function $Me(e,t,n){var r=function(a,o,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var g=c(l,u[h=f+(d-f>>>1)]);g>0?f=h+1:(d=h,p=!g)}return p?f:-f-1}(a,o,s||LMe)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function LMe(e,t){return e>t?1:e<t?-1:0}function G3(e,t,n,r,i){return YX(e,t,n,r,i,0).selectedIndices}function K3(e,t,n,r,i,a){var o=YX(e,t,n,r,i,a);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function YX(e,t,n,r,i,a,o,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>i}).sort(ZX),l=a>0?-.5/a:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(h<i)break;for(var m=!1,v=c.length-1;v>=g;--v){var y=BMe(e,p,c[v]);if(y>=r){m=!0;break}if(d.score=d.score*zMe(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,m||(d.score===h?(c.push(p),f.push(d.score)):d.score>i&&$Me(u,d,ZX))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:ba(c,"int32"),selectedScores:ba(f,"float32"),numValidOutputs:Ve(b,"int32")}}function BMe(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var g=Math.max(a,l),m=Math.max(o,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(h+p-b)}function zMe(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function ZX(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function JX(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(a){i[n]=a;var o=e.slice(r,i);return r[n]+=a,o})}function QX(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=Ot(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function eY(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],l=Oh(n,s*r),c=Oh("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort(function(x,w){return w.value-x.value});var m=f*r,v=l.subarray(m,m+r),y=c.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,y[g]=p[g].index}var b=t.slice();return b[b.length-1]=r,[Rr(l,b,n),Rr(c,b,"int32")]}function X3(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=Ot(e,"int32"),a=Ot([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var jMe=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},UMe=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},WMe=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function tY(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function to(e,t){return t===1?[e]:tY(e,t)}function Ki(){var e,t,n,r,i,a,o,s,u,l;return pe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Fh(e,t,n){n===void 0&&(n="index");var r=Ja(t);return r.map(function(i,a){return"int "+e[a]+" = "+n+" / "+i+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+i:"index -= "+e[a]+" * "+i)+";"}).join("")}function Y3(e){var t=Ja(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var nY=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function VMe(e,t,n,r){var i=[];e.forEach(function(h){var p=et(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var a,o,s=i.join(`
`),u=e.map(function(h){return function(p,g,m){m===void 0&&(m=!1);var v="";v+=m?rY(p):Tm(p);var y=p.shapeInfo.logicalShape,b=g.logicalShape;return y.length<=b.length&&(v+=m?function(x,w){var S,C=x.name,_=C.charAt(0).toUpperCase()+C.slice(1),E="get"+_+"AtOutCoords",A=x.shapeInfo.logicalShape.length,k=w.logicalShape.length,T=ac(x.shapeInfo.logicalShape,w.logicalShape),I=Zn(k),N=k-A,O=["x","y","z","w","u","v"];S=A===0?"":k<2&&T.length>=1?"coords = 0;":T.map(function(ce){return"coords."+O[ce+N]+" = 0;"}).join(`
`);var D="";D=k<2&&A>0?"coords":x.shapeInfo.logicalShape.map(function(ce,he){return"coords."+O[he+N]}).join(", ");var L="return outputValue;",W=et(x.shapeInfo.logicalShape)===1,G=et(w.logicalShape)===1;if(A!==1||W||G){if(W&&!G)L=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var K=A-2,ee=A-1;T.indexOf(K)>-1&&T.indexOf(ee)>-1?L="return vec4(outputValue.x);":T.indexOf(K)>-1?L="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(ee)>-1&&(L="return vec4(outputValue.xx, outputValue.zz);")}}else L=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+I+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+_+"("+D+`);
      `+L+`
    }
  `}(p,g):function(x,w){var S=x.name,C=S.charAt(0).toUpperCase()+S.slice(1),_="get"+C+"AtOutCoords",E=w.texShape,A=x.shapeInfo.texShape,k=x.shapeInfo.logicalShape.length,T=w.logicalShape.length;if(!x.shapeInfo.isUniform&&k===T&&x.shapeInfo.flatOffset==null&&Ur(A,E))return`
      float `+_+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var I,N=Zn(T),O=ac(x.shapeInfo.logicalShape,w.logicalShape),D=T-k,L=["x","y","z","w","u","v"];I=k===0?"":T<2&&O.length>=1?"coords = 0;":O.map(function(G){return"coords."+L[G+D]+" = 0;"}).join(`
`);var W="";return W=T<2&&k>0?"coords":x.shapeInfo.logicalShape.map(function(G,K){return"coords."+L[K+D]}).join(", "),`
    float `+_+`() {
      `+N+` coords = getOutputCoords();
      `+I+`
      return get`+C+"("+W+`);
    }
  `}(p,g)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Ki(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+qMe+`
    `+HMe+`
    `+GMe+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(Ur(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var C=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=h,m=p,v=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(g[2]/2),b=y*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],C=Math.ceil(x[x.length-1]/2),_=C*Math.ceil(x[x.length-2]/2),E=_,A="",k="b, r, c",T=2;T<x.length-1;T++)E*=x[x.length-T-1],A=`
      int b`+T+" = index / "+E+`;
      index -= b`+T+" * "+E+`;
    `+A,k="b"+T+", "+k;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+A+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+x.length+"("+k+`);
    }
  `}(h,p)}var g,m,v,y,b}(t.logicalShape,l),o=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return Ur(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=p,m=Fh(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=Fh(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=Fh(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=Fh(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,m}(t.logicalShape,l),o=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=KMe),[d,f,o,s,a,u,n].join(`
`)}function Tm(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(o===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=Mh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Om(n)+`
      }
    `;var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(s===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Mh(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Ur(r,o)){var s=o[0],u=o[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Sf(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=Im(n,d);return`
      `+Tm(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+Nm(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Om(n)+`
      }
    `;var p=o[0],g=o[1],m=Mh(i);return g===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+p+", "+g+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],s=r[2],u=Sf(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=Im(n,f);return`
        `+Tm(d)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+Nm(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+Om(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],g=h[1],m=n.shapeInfo.flatOffset;if(g===o&&m==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(g===s&&m==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=Mh(i);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+g+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],s=r[2]*o,u=r[1]*s,l=Sf(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=Im(n,c);return`
      `+Tm(d)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+Nm(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+Om(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=Mh(i);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+m+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],s=r[3]*o,u=r[2]*s,l=r[1]*u,c=Sf(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=Im(n,f);return`
      `+Tm(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+Nm(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+Om(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],v=g[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===o&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=Mh(i);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Sf(r),s=o.newShape,u=o.keptDims;if(s.length<r.length){var l=Im(n,s);return`
      `+Tm(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+Nm(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Om(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],y=m[1];if(y===p&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=Mh(i);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function rY(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ki(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var a=i.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Ki();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],f=Ki();if(u!=null&&Ur(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),f=Im(i,c);return`
        `+rY(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Nm(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(a[2]/2),g=p*Math.ceil(a[1]/2),m=Ki();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+g+", "+p+`, b, row, col);
      return `+m.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(i){for(var a=i.shapeInfo.logicalShape,o=a.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),g="int b, int row, int col",m="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<o-1;v++)g="int b"+v+", "+g,p*=a[o-v-1],m="b"+v+" * "+p+" + "+m;var y=Ki();return`
    vec4 `+u+"("+g+`) {
      int index = `+m+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var qMe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,HMe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,GMe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,KMe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Mh(e){return"offset"+e}function Om(e){var t=e.name,n=et(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Zn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Im(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Nm(e,t){return t.map(function(n){return e[n]}).join(", ")}var XMe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,c=Zn(l),f=to("coords",l);if(a===1){var d=Zn(s=l+1);o=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,o=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],g=h.map(function(_){return"int "+_}),m=to("sourceLocR",s-1).concat("inIdx.r"),v=to("sourceLocG",s-1).concat("inIdx.g"),y=to("sourceLocB",s-1).concat("inIdx.b"),b=to("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",C=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},YMe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},ZMe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+g+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},JMe=function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="0.0";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},QMe=function(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="vec4(0.0)";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},ePe="return areal * breal - aimag * bimag;",tPe="return areal * bimag + aimag * breal;",iY=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Z3="return a + b;",J3="return a - b;",aY="return a * b;",nPe=`
if (a == b) {
  return 1.0;
};
return a / b;`,oY="return (a < 0.) ? b * a : a;",Ar=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},rPe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,sY=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,qu=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qt(t,n);var i=this.outputShape.length,a="";if(r)if(i===0||et(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+Zn(i)+` coords = getOutputCoords();
        `,i===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=to("coords",i);a+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},iPe=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),aPe=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),oPe=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},sPe=function(e){this.outputShape=[],this.outputShape=Nh(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},uPe=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Nh(e,t);var n=this.outputShape,r=n.length,i=Zn(r),a=to("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(m,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=o[t],c=o.slice(-2),f=o.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+qS(o,l,h)+`),
            vec2(`+qS(c,l,h)+`));
        }`}var p=s.length,g=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+qS(o,l,g)+`),
          vec2(`+qS(c,l,g)+"));",this.userCode=`
      float getValue(`+o.map(function(m){return"int "+m})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function qS(e,t,n){var r=e.indexOf(t);return e.map(function(i,a){return a===r?i+" - "+n:i}).join()}var lPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},cPe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},fPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},dPe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},hPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},pPe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},uY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,m=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},gPe=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+a+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},lY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+m+`
        setOutput(result);
      }
    `},cY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<h;v++)g+=`
          vec4 xTexelR`+m+"C"+2*v+` = vec4(0.);
          vec4 wR`+m+"C"+v+` = vec4(0.);
          vec4 xR`+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<p;y++){if(g+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+m+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+`.xy);
                } else {
                  xR`+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xR`+m+"C"+v+" = xTexelR"+m+"C"+v+`;
              `,v+1<h)){var b=s%2==0?NF(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+`;
                `}}else v<h&&(g+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
              `,v+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+`.xy);
              `,v+1<h&&(g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
                `)),g+="}");v<h&&(g+=`
            vec4 wTexelR`+m+"C"+v+" = getW("+m+", "+v+`, d1, q);
            wR`+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+`.xz);
          `,v+1<h&&(g+=`
              vec4 wTexelR`+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+`, d1, q);
              wR`+m+"C"+(v+1)+` =
                vec4(wTexelR`+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<h;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},mPe=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[o-1+".0",s-1+".0"],p=h[0],g=h[1],m=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=x[0],S=x[1],C=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},vPe=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Zn(r)+` coords = getOutputCoords();
        int end = `+fY(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+fY(r,"coords")+` = idx;
          val += getX(`+function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function fY(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var yPe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Xy.DENSE;var t=Yy(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Fh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},bPe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Xy.DENSE;var t=Yy(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Fh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},xPe=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),wPe=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},_Pe=function(e){this.variableNames=["A"],this.outTexUsage=To.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+nY+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},SPe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=To.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+nY+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},EPe=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+Y3(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},CPe=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Y3(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+s+`;
      }
    `},APe="return real * expR - imag * expI;",kPe="return real * expI + imag * expR;",dY=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},TPe=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),OPe=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Zn(this.rank),a=function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},IPe=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Zn(t.length),i=Zn(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function hY(e,t){var n=Ki();return JK(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function pY(e,t){return nX(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function gY(e,t){return rX(e,t,new Uint16Array([0,1,2,2,1,3]))}function pb(e,t,n,r,i,a,o){aX(n,r);var s=iX(e,t),u=e.TEXTURE_2D;return Qe(e,t,function(){return e.bindTexture(u,s)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function mY(e,t,n,r,i){var a=pS(n,r);return pb(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function vY(e,t,n,r,i){var a=pS(n,r);return pb(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function yY(e,t,n,r,i){var a=pS(n,r);return pb(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function bY(e,t,n,r,i){var a=Zy(n,r);return pb(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function xY(e,t,n,r,i){var a=Zy(n,r);return pb(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function wY(e,t,n,r){return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),XF(e,t,n,"clipSpacePos",r,3,20,0)&&XF(e,t,n,"uv",r,2,20,12)}function _Y(e,t,n,r,i,a,o){var s,u,l;Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=o.internalFormatPackedFloat),s.set(a),Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function SY(e,t,n,r){Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function EY(e,t,n,r,i){var a=e.createBuffer();Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var o=16*n*r;return Qe(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function CY(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function AY(e,t,n,r,i){var a=pS(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function kY(e,t,n,r,i,a,o,s){var u=e,l=new Float32Array(function(c,f){var d=Zy(c,f);return d[0]*d[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function TY(e,t,n,r){var i=new Float32Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var NPe=Object.freeze({createVertexShader:hY,createVertexBuffer:pY,createIndexBuffer:gY,createFloat32MatrixTexture:mY,createFloat16MatrixTexture:vY,createUnsignedBytesMatrixTexture:yY,createPackedMatrixTexture:bY,createFloat16PackedMatrixTexture:xY,bindVertexProgramAttributeStreams:wY,uploadDenseMatrixToTexture:_Y,uploadPixelDataToTexture:SY,createBufferFromOutputTexture:EY,downloadFloat32MatrixFromBuffer:CY,downloadByteEncodedFloatMatrixFromOutputTexture:AY,downloadPackedMatrixFromBuffer:kY,downloadMatrixFromPackedOutputTexture:TY}),OY=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=pe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,XK(n,t)):this.gl=Bu(n);var r="WEBGL_color_buffer_float";if(pe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Jy(this.gl,this.debug,"OES_texture_float"),Io(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Jy(this.gl,this.debug,"OES_texture_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Io(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Jy(this.gl,this.debug,"EXT_color_buffer_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Io(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Io(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=pY(this.gl,this.debug),this.indexBuffer=gY(this.gl,this.debug),this.framebuffer=oX(this.gl,this.debug),this.textureConfig=KF(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return pe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;Qe(n,this.debug,function(){return n.finish()}),Qe(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),Qe(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),mY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),vY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),yY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),SY(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),_Y(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),xY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),bY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(YF(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Qe(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return AY(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,a,o){return kY(this.gl,t,0,0,0,a,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return CY(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=EY(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(pe().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(o,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=o}else pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return TY(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=QK(n,this.debug,t),i=hY(n,this.debug),a=eX(n,this.debug);return Qe(n,this.debug,function(){return n.attachShader(a,i)}),Qe(n,this.debug,function(){return n.attachShader(a,r)}),tX(n,this.debug,a),this.debug&&vS(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=wY(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Qe(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&vS(this.gl,this.debug,this.program),Qe(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?uX(this.gl,this.debug,t,n):lX(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),cX(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=Zy(n,r),a=i[0],o=i[1];this.setOutputMatrixTextureDriver(t,a,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&vS(this.gl,this.debug,this.program),Qy(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Qe(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Jy(this.gl,this.debug,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){switch(r.label){case 0:return[4,DF(function(){return n.disposed||n.isQueryAvailable(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||DF(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),yS(this.gl,this.debug,t,this.framebuffer),this.debug&&Qy(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(yS(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Qy(this.gl)):YF(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;yS(i,this.debug,t,this.framebuffer),this.debug&&Qy(i),this.outputTexture=t,Qe(i,this.debug,function(){return i.viewport(0,0,n,r)}),Qe(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var a=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function IY(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,a=t[r],o=a.shape;if(!Ur(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!Ur(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var DPe=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=i*r,g=Ki(),m=f==="channelsLast",v=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},RPe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},FPe=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},MPe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},PPe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},$Pe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Q3=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),a===void 0&&(a=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+p+`

        setOutput(result);
      }
    `},LPe=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),BPe=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},zPe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=to("rc",t),r=Zn(t),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var g=0;g<=1;g++){for(var m=(p===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<f;v++)m=d[d.length-1-v]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},jPe=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,i=Zn(r),a=t.map(function(u){return u[0]}).join(","),o=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+a+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},UPe=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(m,v){return m[0]+e[v]+m[1]});for(var r=e.length,i=Zn(r),a=t.map(function(m){return m[0]}).join(","),o=t.map(function(m,v){return m[0]+e[v]}).join(","),s=to("rc",r),u=to("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,g=r===1?2:4;p<g;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+a+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},gb=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",g="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",v="0.0";if(p||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+s+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(r?i?g:m:"wR * "+f+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(a/4),x=a%4,w=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+w+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+w+`
          }
        }
        setOutput(`+y+`);
      }
    `}},eM=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+s+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = `+(r?i?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+h+" * "+p+` +
                      wR * `+p+" + wC")+`;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var w=4*Math.floor(a/4),S=a%4,C=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+s+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+C+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+C+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},WPe=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",s="min"):t==="max"&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},VPe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Fh(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Y3(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},qPe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},HPe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},GPe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},KPe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},XPe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},YPe=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,o){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(o)}).join(","),i=Zn(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},ZPe=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=to("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Zn(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},NY=function(e,t,n,r,i,a,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Zn(i.length),u=Zn(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},JPe=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},QPe=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var l=Zn(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},e$e=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Zn(this.rank),i="uniform int start["+this.rank+"];",a=function(o){if(o===1)return"sourceLoc";if(o<=6)return tM.slice(0,o).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,s){return"sourceLoc."+tM[s]+" = start["+s+"] + coords."+tM[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),tM=["x","y","z","w","u","v"],t$e=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Zn(this.rank),r=to("coords",this.rank),i=to("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+a+")",s=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),n$e=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Zn(n.length),a=Zn(n.length),o="";if(r===1)o="coords * strides + begin";else{var s=0;o=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},r$e=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,a=DY(n,r),o=RY(t,a,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),a===Oo.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===Oo.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===Oo.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===Oo.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===Oo.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var a=RY(n,DY(r,i),i);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[a],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function DY(e,t){if(e===To.UPLOAD)return Oo.PACKED_2X2_FLOAT32;if(e===To.RENDER||e==null)return function(n){return pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Oo.PACKED_2X2_FLOAT32:Oo.UNPACKED_FLOAT32:n?Oo.PACKED_2X2_FLOAT16:Oo.UNPACKED_FLOAT16}(t);if(e===To.DOWNLOAD||e===To.PIXELS)return Oo.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function RY(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var i$e=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Zn(this.rank),a=function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<o.length;c++)l.push("imod("+u[c]+", "+o[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},nM=1.7580993408473768,rM=1.0507009873554805,Pt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Ws="if (isnan(x)) return x;",a$e="return x;",FY="return abs(x);",MY=Ws+`
  return (x < 0.0) ? 0.0 : x;
`,PY=Ws+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,$Y="return (x >= 0.0) ? x : (exp(x) - 1.0);",o$e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+nM+`;
  float scale = `+rM+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,LY="return -x;",BY="return ceil(x);",zY="return floor(x);",jY="return exp(x);",UY="return exp(x) - 1.0;",s$e=Ws+`
  return sin(x);
`,u$e=Ws+`
  return cos(x);
`,l$e=Ws+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,c$e=Ws+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,f$e=Ws+`
  return atan(x);
`,d$e=Ws+"return log(x + sqrt(x * x + 1.0));",h$e=Ws+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,p$e=Ws+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,HS="return x;",g$e="return x;",WY=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,VY=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qY=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,mb=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},m$e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=to("rc",t),r=Zn(t),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},GS={};function KS(e,t){if(t===void 0&&(t=!1),e==="linear")return t?g$e:a$e;if(e==="relu")return t?WY:MY;if(e==="elu")return t?qY:$Y;if(e==="relu6")return t?VY:PY;if(e==="prelu")return t?sY:oY;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var v$e=600,HY=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!pe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=Bu(pe().getNumber("WEBGL_VERSION"));i.binaryCache=((r=pe().getNumber("WEBGL_VERSION"))in GS||(GS[r]={}),GS[r]),i.gpgpu=new OY(a),i.canvas=a.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new r$e(i.gpgpu),i.numMBBeforeWarning=pe().global.screen==null?1024:pe().global.screen.height*pe().global.screen.width*window.devicePixelRatio*v$e/1024/1024,i.texData=new z3(i,J),i}return Ls(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:i,values:n,usage:To.UPLOAD}),a},t.prototype.move=function(n,r,i,a){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:a,values:r,usage:To.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,a=r.dtype,o=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new mb(u,HS):new Pt(u,HS);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return i;var h,p,g=this.activeTimers!=null;return g&&(h=Bs()),a==="complex64"?p=H3(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=Bs()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return nt(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(A){return r.push(A)})];if(i=this.texData.get(n),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return f=void 0,f=c?new mb(o,HS):new Pt(o,HS),d=this.runWebGLProgram(f,[{dataId:n,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&pe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&pe().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),m=this.texData.get(g.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(Yy(o)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=E.sent(),b=y[0],x=y[1],v=H3(b,x),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(w=et(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),E.label=5;case 5:return g!=null&&this.disposeData(g.dataId),S=this.convertAndCacheOnCPU(n,v),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(A){return A(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!YK(i))throw pe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.isPacked,u=et(a);if(pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Yy(a))).subarray(0,u);return this.disposeData(l.dataId),f}var d=pe().getBool("WEBGL_PACK")&&s===!0,h=d?bS(a):a,p=d?new SPe(h):new _Pe(h),g=this.runWebGLProgram(p,[{shape:h,dtype:o,dataId:n}],"float32"),m=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l;return nt(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],a=!1,this.programTimersStack==null?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,n(),o=tc(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=tc(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=c.sent(),u.kernelMs=RK(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Bs(),endMs:null}},t.prototype.endTimer=function(n){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Bs(),n)},t.prototype.getQueryTime=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,a=r.dtype,o=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,a),this.textureManager.releaseTexture(i,o,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return pe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=J.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return i.texData.get(a.dataId).texture==null&&et(a.shape)<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(et(i)===0)return Rr([],i,n.dtype);var a=this.texData.get(n.dataId).isPacked,o=L3(n.shape,r,i);if(a||!o){var s=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new t$e(i):new e$e(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var a=this.texData.get(n.dataId),o=this.makeOutput(i,n.dtype),s=this.texData.get(o.dataId);Object.assign(s,a),s.shape=i,s.dtype=n.dtype;var u=B3(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},t.prototype.stridedSlice=function(n,r,i,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,a);var o=BS(r,i,a);if(o.some(function(u){return u===0}))return Rr([],o);var s=new n$e(r,a,o);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZPe(n.shape,r):new YPe(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return eo(h)}),a=n.map(function(h){return is(h)});return ri(this.concat(i,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>pe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),s=this.concat(n.slice(0,o),r),u=this.concat(n.slice(o),r);return this.concat([s,u],r)}if(pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new uPe(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Nh(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,et(h.shape.slice(r)))}),d=new sPe(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,LY,n.dtype);var r=new Pt(n.shape,LY);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,a){var o=i?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],l=n.shape[0];if((o===1||s===1)&&u>1e3){i&&(n=cn(n,[0,2,1])),a&&(r=cn(r,[0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=yi(n.dtype,r.dtype),p=new Q3(n.shape,[l,o,s],i,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],d=r.shape[0],h=yi(r.dtype,i.dtype),p=s!=null,g=l!=null,m=u?KS(u,!0):null,v=new Q3(r.shape,[d,c,f],a,o,p,m,g),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),a=this.texData.get(r.dataId),o=new iY(ePe,n.shape,r.shape),s=new iY(tPe,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(o,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,aY,n.dtype);var d=new Ar(aY,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){var u=[n,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(o!=null&&(c=o.shape,u.push(o)),pe().getBool("WEBGL_PACK_NORMALIZATION")){var f=new QMe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(f,u)}var d=new JMe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){var s=pe().getBool("WEBGL_PACK_NORMALIZATION")?new MPe(n.shape,r,i,a,o):new RPe(n.shape,r,i,a,o);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){var l=new FPe(r.shape,a,o,s,u);return this.compileAndRun(l,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(o){return Vy(o)});return QX(Ot(n.shape,n.dtype,i),r)}var a=new i$e(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,i){var a=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UPe(n.shape,r,i):new jPe(n.shape,r,i);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var a=new OPe(n.shape,r.size,i);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){U(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,d){return f*d}),o=OS(n.shape,r,a),s=IS(o.length,r.length),u=NS(n.shape,r,a),l=TX(i,r.length),c=OX(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){U(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=OS(u.shape,r,a,!1),c=IS(l.length,r.length,!1),f=NS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.reduce=function(n,r,i){var a=n.shape[0],o=n.shape[1],s=LS(o),u=new WPe({windowSize:s,inSize:o,batchSize:a},r),l=this.compileAndRun(u,[n],i);return l.shape[1]===1?l:this.reduce(l,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var a=n.shape[0],o=n.shape[1];i!=null&&(a=i.shape[0],o=i.shape[1]);var s=LS(o),u=new WMe({windowSize:s,inSize:o,batchSize:a},r,i==null),l=[n];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var a=i!=null?i.shape:n.shape,o=LS(a[a.length-1]),s=new XMe(a,o,r,i==null),u=i==null?[n]:[n,i],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){Qa("sum",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=hS(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=hS(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,i){var a=0,o=zs([a],n.rank),s=n;o!=null&&(s=cn(n,o),a=js(1,n.rank)[0]);var u=function(h,p,g){for(var m=[],v=h.length,y=0;y<v;y++)y!==p?m.push(h[y]):m.push(g);return m}(s.shape,a,i),l=et([s.shape[a]]),c=s.as2D(-1,l),f=hS(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(u);return o!=null&&(d=cn(d,ES(o))),d},t.prototype.segOpCompute=function(n,r,i,a,o){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,g=!1;for(d<=P3?(p=d,g=!0):p=fS(d,Math.floor(Math.sqrt(d)));!g;)p>h||p===d?g=!0:p=fS(d,p+1);return p}(u,o),c=new JPe({windowSize:l,inSize:u,batchSize:s,numSegments:o},r),f=this.compileAndRun(c,[n,i],a);return f.shape[1]===o?f:(i=Em(0,o).tile([u/l]),this.segOpCompute(f,r,i,a,o))},t.prototype.argMinMaxReduce=function(n,r,i){var a=[r];if(Qa("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,n.rank),!pe().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=Di(n.shape,a),s=o[0],u=et(o[1]),l=n.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new vPe(n.shape,i,a);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Ar("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Ar("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Ar("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Ar("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Ar("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Ar("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Pt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Ar("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Ar("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var a=new QPe(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,i],yi(r.dtype,i.dtype))},t.prototype.where=function(n){SS("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return X3(n.shape,r)},t.prototype.topk=function(n,r,i){return eY(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Qa("min",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Qa("max",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){Qa("all",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){Qa("any",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.floorDiv=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Ar(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Z3);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Z3,i);var a=new Ar(Z3,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var a=new mb(n.shape,r);return this.compileAndRun(a,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,a,o){o===void 0&&(o=!1);var s=new qu(i,n.shape,r.shape,o);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var a=this,o=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],g=a.makeComplexComponentTensorInfo(n,h),m=a.makeComplexComponentTensorInfo(r,p),v=new Ar(i,n.shape,r.shape);return a.compileAndRun(v,[g,m],yi(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>pe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([i,a])}var o=n.map(function(l){return l.dtype}).reduce(function(l,c){return yi(l,c)}),s=n.map(function(l){return l.shape}),u=pe().getBool("WEBGL_PACK")?new UMe(n[0].shape,s):new jMe(n[0].shape,s);return this.compileAndRun(u,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,J3);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,J3,n.dtype);var a=new Ar(J3,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.pow=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=yi(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,BY,n.dtype);var r=new Pt(n.shape,BY);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,zY,n.dtype);var r=new Pt(n.shape,zY);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Pt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Pt(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Pt(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Pt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Pt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,jY,n.dtype);var r=new Pt(n.shape,jY);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,UY,n.dtype);var r=new Pt(n.shape,UY);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=Wr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Pt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Pt(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Pt(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Pt(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Pt(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new mb(n.shape,WY):new Pt(n.shape,MY),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new mb(n.shape,VY):new Pt(n.shape,PY),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(sY,n.shape,r.shape):new Ar(oY,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,qY,n.dtype);var r=new Pt(n.shape,$Y);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Ar("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new Pt(n.shape,o$e);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Pt(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var a,o=(a=pe().getBool("WEBGL_PACK_CLIP")?new aPe(n.shape):new iPe(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(a,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,FY,n.dtype);var r=new Pt(n.shape,FY);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new oPe(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,a)},t.prototype.sigmoid=function(n){var r=new Pt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Pt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Pt(n.shape,s$e);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Pt(n.shape,u$e);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Pt(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Pt(n.shape,l$e);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Pt(n.shape,c$e);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Pt(n.shape,f$e);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Pt(n.shape,d$e);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Pt(n.shape,h$e);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Pt(n.shape,p$e);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Pt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new Pt(n.shape,function(a){return a===void 0&&(a=0),Ws+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,a,o,s){var u=n.shape,l=this.texData.get(n.dataId),c=i.inChannels,f=u[0]*u[1]*u[2],d=i.outChannels,h=i.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(p||!pe().getBool("WEBGL_LAZILY_UNPACK")||!pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,m,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(nb(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,i.inChannels,i.outChannels]),C=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),_=this.texData.get(C.dataId);return U(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,_.shape=i.outShape,J.makeTensorFromDataId(C.dataId,i.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,a,o,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,f=i.outWidth,d=i.outHeight,h=i.dataFormat==="channelsLast",p=u*l*c,g=d*f,m=[p,g],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new DPe(m,v.shape,i),x=this.compileAndRun(b,[v]).reshape([1,m[0],m[1]]),w=a!=null,S=s!=null,C=o?KS(o,!0):null,_=new Q3(x.shape,[1,g,i.outChannels],!0,!1,w,C,S),E=[x,y];a&&E.push(a),S&&E.push(s);var A=this.compileAndRun(_,E);return h?A.reshape([1,d,f,i.outChannels]):A.reshape([1,i.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,a,o,s,u);if(pe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,a,o,s,u);var l=o!=null,c=u!=null,f=s?KS(s,!1):null,d=new uY(a,l,f,c),h=[r,i];return o&&h.push(o),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(pe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var a=new uY(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var a=new cPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var a=new lPe(i);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,a=n.filter,o=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=u?KS(u,c):null,d=[i,a],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new cY(o,h,f,p),this.compileAndRun(r,d)):(r=new lY(o,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,i){var a;return pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(a=new cY(i),this.compileAndRun(a,[n,r])):(a=new lY(i),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var a=new pPe(i);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var a=new hPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,i){var a=new gPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var a=new dPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var a=new fPe(i);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var i=new gb(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new gb(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,a){var o=new gb(a,"max",!0),s=this.compileAndRun(o,[r]),u=new PPe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,i){var a=new YMe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return V3(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var i=new eM(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var a=new ZMe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new eM(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,a){var o=new eM(a,"max",!0),s=this.compileAndRun(o,[r]),u=new $Pe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!nb(n.shape,r)&&(i.texture===null||!nb(i.shape,r))){var a=this.packedReshape(n,r);return J.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return VS(n,r)},t.prototype.resizeBilinear=function(n,r,i,a){var o=pe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new GPe(n.shape,r,i,a):new HPe(n.shape,r,i,a);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var a=new qPe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,a){var o=new XPe(n.shape,r,i,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var a=new KPe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,i,a){var o=r?n:Dh(n),s=o.shape[0],u=o.shape[1],l=new LPe(s,u,i),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[o],"int32",c)},t.prototype.oneHot=function(n,r,i,a){var o=new BPe(n.size,r,i,a);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new wPe(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return SS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),G3(n.dataSync(),r.dataSync(),i,a,o)},t.prototype.cropAndResize=function(n,r,i,a,o,s){var u=new mPe(n.shape,r.shape,a,o,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],o=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],l=o*r,c=s*r,f=u/(r*r),d=new xPe(i==="NHWC"?[a,l,c,f]:[a,f,l,c],r,i);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,i){return JX(n,r,i)},t.prototype.scatterND=function(n,r,i){var a=lb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=[c/u,u],d=n.reshape([s,o]),h=r.reshape([s,u]);if(c===0)return VS(Rr([]),i);var p=Ve(0),g=new NY(s,o,d.rank,h.rank,l,f);return this.compileAndRun(g,[h,d,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,a){var o=lb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.strides,c=o.outputSize,f=new NY(u,s,n.rank,r.rank,l,[c,1],!1);return this.compileAndRun(f,[r,n,a]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),a=new dY(APe,n.shape,r),o=new dY(kPe,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(o,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=M3(n,r),s=o[0],u=o[1],l=o[2],c=o[3],f=r.reshape([u,a]),d=n.reshape([n.size/l,l]),h=new IPe(a,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||xm(r))==="string"){var a=Wy(i,et(n));return a.fill(r),J.makeTensor(a,n,i,this)}var o=new TPe(n,r),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return q3(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return J.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new m$e(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new zPe(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[eb(n.shape)].concat(tb(n.shape)),a={dtype:n.dtype,shape:i,dataId:n.dataId},o=[eb(r)].concat(tb(r)),s=new VPe(o,i),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),a=i.isPacked,o=i.shape,s=i.dtype,u=bS(o);return r=a?new bPe(u):new yPe(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,a,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(n.outputShape,i),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Xy.DENSE){var c=Yy(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),et(u.shape)===0)return l.values=Oh(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&et(b.shape)<=pe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!nb(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},g=function(b,x,w){var S="";x.concat(w).forEach(function(E){var A=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,k=E.isUniform?"uniform":E.texData.texShape;S+=E.shape+"_"+k+"_"+A});var C=b.userCode,_=b.constructor.name;return _+="_"+S+"_"+C}(n,d,p),m=this.getAndSaveBinary(g,function(){return function(b,x,w,S){var C=x.userCode,_=w.map(function(W,G){var K={logicalShape:W.shape,texShape:W.isUniform?null:W.texData.texShape,isUniform:W.isUniform,isPacked:!W.isUniform&&W.texData.isPacked,flatOffset:null};return W.texData!=null&&W.texData.slice!=null&&W.texData.slice.flatOffset>0&&(K.flatOffset=W.texData.slice.flatOffset),{name:x.variableNames[G],shapeInfo:K}}),E=_.map(function(W){return W.shapeInfo}),A={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},k=VMe(_,A,C,x.packedInputs),T=b.createProgram(k),I=null,N=b.getUniformLocation(T,"NAN",!1);pe().getNumber("WEBGL_VERSION")===1&&(I=b.getUniformLocation(T,"INFINITY",!1));for(var O={},D=0;D<x.variableNames.length;D++){var L=x.variableNames[D];O[L]=b.getUniformLocation(T,L,!1),O["offset"+L]=b.getUniformLocation(T,"offset"+L,!1)}return{program:x,source:k,webGLProgram:T,uniformLocations:O,inShapeInfos:E,outShapeInfo:A,infLoc:I,nanLoc:N}}(s.gpgpu,n,d,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,x,w,S,C){IY(x.inShapeInfos,w),IY([x.outShapeInfo],[S]);var _=S.texData.texture,E=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(_,E[0],E[1]):b.setOutputMatrixTexture(_,E[0],E[1]),b.setProgram(x.webGLProgram),pe().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(A,k){var T=x.program.variableNames[k],I=x.uniformLocations[T],N=x.uniformLocations["offset"+T];if(I!=null)if(A.isUniform)if(et(A.shape)<2)b.gl.uniform1f(I,A.uniformValues[0]);else{var O=A.uniformValues;O instanceof Float32Array||(O=new Float32Array(O)),b.gl.uniform1fv(I,O)}else A.texData.slice!=null&&N!=null&&b.gl.uniform1i(N,A.texData.slice.flatOffset),b.setInputMatrixTexture(A.texData.texture,I,k)}),C!=null&&C(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,m,d,p,a),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!pe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,a,o){o===void 0&&(o=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,a,o);return J.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(pe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=le(function(){if(!pe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=pe().getBool("DEBUG");pe().set("DEBUG",!1);var i=n.abs(Ve(1e-8)).dataSync()[0];if(pe().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=Bs());var h=i.texShape;if(h==null&&(h=hX(a,c),i.texShape=h),s!=null){var p=bS(a),g=void 0,m=h[1],v=h[0],y=s instanceof Uint8Array;c?(m=(r=Zy(h[0],h[1]))[0],v=r[1],g=new CPe(p,[v,m],y)):g=new EPe(p,[v,m],y);var b=this.makeTensorInfo([v,m],o);this.texData.get(b.dataId).usage=y?To.PIXELS:To.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,v,s);var x=this.runWebGLProgram(g,[b],o,null,!0),w=this.texData.get(x.dataId);i.texture=w.texture,i.texShape=w.texShape,i.isPacked=w.isPacked,i.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),i.values=null,d&&(this.uploadWaitMs+=Bs()-f)}else{var S=this.acquireTexture(h,l,o,c);i.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),a=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),i.values},t.prototype.acquireTexture=function(n,r,i,a){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*RF(r)},t}(j3);KK()&&J.registerBackend("webgl",function(){return new HY},2);function Ph(e,t){return e(t={exports:{}},t.exports),t.exports}var y$e=Ph(function(e){(function(t,n,r){function i(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new i(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,e,!1)}),b$e=Ph(function(e){(function(t,n,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,e,!1)}),x$e=Ph(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,e,!1)}),w$e=Ph(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,e,!1)}),_$e=Ph(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,g,m=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(g=g+1640531527|0,h=(f=m[127&p]^=d+g)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=m[h+34&127],f=m[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,m[h]=d^f;l.w=g,l.X=m,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,e,!1)}),S$e=Ph(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,e,!1)}),$h=Ph(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(v,y,b){var x=[],w=g(function _(E,A){var k,T=[],I=typeof E;if(A&&I=="object")for(k in E)try{T.push(_(E[k],A-1))}catch(N){}return T.length?T:I=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,m(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(_)),m(_)}catch(k){var E=i.navigator,A=E&&E.plugins;return[+new Date,i,A,i.screen,m(t)]}}(),3),x),S=new h(x),C=function(){for(var _=S.g(o),E=u,A=0;_<l;)_=(_+A)*a,E*=a,A=S.g(1);for(;_>=c;)_/=2,E/=2,A>>>=1;return(_+A)/E};return C.int32=function(){return 0|S.g(4)},C.quick=function(){return S.g(4)/4294967296},C.double=C,g(m(S.S),t),(y.pass||b||function(_,E,A,k){return k&&(k.S&&p(k,S),_.state=function(){return p(S,{})}),A?(n[s]=_,E):_})(C,w,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,C=x.S=[];for(b||(v=[b++]);w<a;)C[w]=w++;for(w=0;w<a;w++)C[w]=C[S=f&S+v[w%b]+(y=C[w])],C[S]=y;(x.g=function(_){for(var E,A=0,k=x.i,T=x.j,I=x.S;_--;)E=I[k=f&k+1],A=A*a+I[f&(I[k]=I[T=f&T+E])+(I[T]=E)];return x.i=k,x.j=T,A})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function g(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return m(y)}function m(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,g(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(v){}}})([],Math)});$h.alea=y$e,$h.xor128=b$e,$h.xorwow=x$e,$h.xorshift7=w$e,$h.xor4096=_$e,$h.tychei=S$e;var XS=$h.alea,iM=Q({addN_:function(e){U(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),U(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,a){return j(i,"tensors"+a,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!Ur(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return J.runKernelFunc(function(i,a){return i.addN(t)},r,null,"AddN")}});function YS(){wS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function GY(e){return e.rank===0||e.rank===1?e.as4D(1,1,1,e.size):e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function KY(e,t,n,r,i,a){a==null&&(a=.001);var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(l.rank===c.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),U(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),U(o==null||l.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f={x:u,scale:o,offset:s,mean:l,variance:c},d={varianceEpsilon:a};return J.runKernelFunc(function(h,p){var g=GY(u),m=h.batchNormalization(g,ZS(l),ZS(c),a,ZS(o),ZS(s));return p([u,l,c,o]),m},f,null,"FusedBatchNorm",d).reshape(u.shape)}function ZS(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var XY=Q({batchNormalization_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),YS(),KY(e,t,n,a,i,r)}}),Lh=Q({batchNorm_:KY});function YY(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),U(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Lh(u,l,c,s,o,a)}var ZY=Q({batchNormalization2d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),YS(),YY(e,t,n,a,i,r)}}),aM=Q({batchNorm2d_:YY});function JY(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),U(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Lh(u,l,c,s,o,a)}var QY=Q({batchNormalization3d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),YS(),JY(e,t,n,a,i,r)}}),oM=Q({batchNorm3d_:JY});function eZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),U(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),U(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Lh(u,l,c,s,o,a)}var tZ=Q({batchNormalization4d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),YS(),eZ(e,t,n,a,i,r)}}),sM=Q({batchNorm4d_:eZ}),uM=Q({broadcastTo_:function(e,t){var n=j(e,"broadcastTo","x"),r=n.shape;if(t.some(function(f){return!(f>0)||f%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(f,d){return f>1?d:-1}).filter(function(f){return f>=0});if(u.length===0)return n.clone();var l={x:n},c={shape:t,inputShape:a};return J.runKernelFunc(function(f){return f.tile(n,o)},l,function(f){return{x:function(){return f.sum(u,!0)}}},l3,c)}}),nZ=Q({clone_:function(e){var t=j(e,"x","clone",null);return J.runKernelFunc(function(){return J.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{x:t},null,f3)}}),Hu=Q({logicalAnd_:function(e,t){var n=j(e,"a","logicalAnd","bool"),r=j(t,"b","logicalAnd","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),lM=Q({logicalNot_:function(e){var t=j(e,"x","logicalNot","bool");return J.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),JS=Q({logicalOr_:function(e,t){var n=j(e,"a","logicalOr","bool"),r=j(t,"b","logicalOr","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),rZ=Q({logicalXor_:function(e,t){var n=j(e,"a","logicalXor","bool"),r=j(t,"b","logicalXor","bool");return Qt(n.shape,r.shape),JS(e,t).logicalAnd(Hu(e,t).logicalNot())}}),Vs=Q({where_:function(e,t,n){var r=j(t,"a","where"),i=j(n,"b","where"),a=j(e,"condition","where","bool");return ln(r.shape,i.shape,"Error in where: "),a.rank===1?U(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ln(a.shape,i.shape,"Error in where: "),J.runKernelFunc(function(o,s){var u=o.select(a,r,i);return s([a]),u},{$condition:a,$a:r,$b:i},function(o,s){var u=s[0];return{$condition:function(){return en(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}})}}),QS=function(e){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:return[4,(t=j(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=X3(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},eE=Q({divNoNan_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");r=(n=ur(r,i))[0],i=n[1];var a=Cr(r,i),o=en(a),s=i.equal(o);return Vs(s,o,a)}}),sc=Q({tile_:function(e,t){var n=j(e,"x","tile",null);U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={x:n},a={reps:t};return J.runKernelFunc(function(o,s){var u=o.tile(n,t);return s([n]),u},i,null,d3,a,r)}}),tE=Q({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=Ot([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return sc(Do(s,0),[n[0],1,1]);if(n.length===2)return sc(Do(Do(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return sc(Do(Do(Do(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),cM=Q({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=j(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=o===1?i.as2D(1,-1):i,u=J.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return o===1?u.as1D():u}}),Bh=Q({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=j(e,"indices","oneHot","int32"),a=i.shape.concat([t]),o={indices:i=i.flatten()},s={depth:t,onValue:n,offValue:r};return J.runKernelFunc(function(u,l){return l([i]),u.oneHot(i,t,n,r)},o,null,c3,s).reshape(a)}}),Gu=Q({pad_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n},a={x:r};return J.runKernelFunc(function(o,s){return s([r]),o.pad(r,t,n)},a,null,h3,i)}}),iZ=Q({pad1d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Gu(e,[t],n)}}),aZ=Q({pad2d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),oZ=Q({pad3d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),sZ=Q({pad4d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),uZ=Q({rand_:function(e,t,n){var r=et(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return J.makeTensor(i,e,n)}}),E$e=.001,lZ=.1;function fM(){return J.backend.floatPrecision()===32?E$e:lZ}function dM(e,t,n){var r=!0;if((Ni(e)||Ni(t))&&(r=!1),Ni(e)&&Ni(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=ju(e),s=ju(t);if(!Ur(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=Ni(e)?e:tc(e),l=Ni(t)?t:tc(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function hM(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var C$e=Object.freeze({TEST_EPSILON_FLOAT16:lZ,expectArraysClose:function(e,t,n){return n==null&&(n=fM()),dM(e,t,function(r,i){return hM(r,i,n)})},testEpsilon:fM,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Ef(e)||Ef(e[0])||Ef(t)||Ef(t[0])?dM(e,n,function(r,i){return r==i}):dM(e,t,function(r,i){return hM(r,i,0)})},expectNumbersClose:function(e,t,n){if(n==null&&(n=fM()),!hM(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),pM=function(){function e(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=XS(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var a=void 0,o=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),A$e=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=XS(a.toString()),this.randn=new pM(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,a,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),k$e=function(){function e(t,n,r,i){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=XS(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),cZ=Q({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new A$e(t,n,r,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),gM=Q({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new pM(t,n,r,!1,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),zh=Q({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Ot(e,r),o=new k$e(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),nE=Q({square_:function(e){var t=j(e,"x","square"),n=[t];return J.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),rE=Q({squaredDifference_:function(e,t){var n,r=j(e,"a","squaredDifference"),i=j(t,"b","squaredDifference");n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return J.runKernelFunc(function(s,u){var l=s.squaredDifference(r,i);return u([r,i]),l},a,function(s,u){var l=u[0],c=u[1],f=Ve(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},ob,{},o,[])}}),vb=Q({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new pM(t,n,r,!0,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),jh=Q({equal_:function(e,t){var n,r=j(e,"a","equal"),i=j(t,"b","equal");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.equal(r,i)},{$a:r,$b:i})}}),fZ=Q({equalStrict_:function(e,t){var n=j(e,"a","equalStrict"),r=j(t,"b","equalStrict");return ln(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Dm=Q({greater_:function(e,t){var n,r=j(e,"a","greater"),i=j(t,"b","greater");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.greater(r,i)},{a:r,b:i},null,"Greater")}}),yb=Q({greaterEqual_:function(e,t){var n,r=j(e,"a","greaterEqual"),i=j(t,"b","greaterEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.greaterEqual(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return en(s)},b:function(){return en(u)}}},"GreaterEqual")}}),dZ=Q({greaterEqualStrict_:function(e,t){var n=j(e,"a","greaterEqualStrict"),r=j(t,"b","greaterEqualStrict");return ln(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),hZ=Q({greaterStrict_:function(e,t){var n=j(e,"a","greaterStrict"),r=j(t,"b","greaterStrict");return ln(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),mM=Q({less_:function(e,t){var n,r=j(e,"a","less"),i=j(t,"b","less");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.less(r,i)},{a:r,b:i},null,"Less")}}),vM=Q({lessEqual_:function(e,t){var n,r=j(e,"a","lessEqual"),i=j(t,"b","lessEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.lessEqual(r,i);return o([r,i]),s},{a:r,b:i},null,"LessEqual")}}),pZ=Q({lessEqualStrict_:function(e,t){var n=j(e,"a","lessEqualStrict"),r=j(t,"b","lessEqualStrict");return ln(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),gZ=Q({lessStrict_:function(e,t){var n=j(e,"a","lessStrict"),r=j(t,"b","lessStrict");return ln(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Rm=Q({notEqual_:function(e,t){var n,r=j(e,"a","notEqual"),i=j(t,"b","notEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),mZ=Q({notEqualStrict_:function(e,t){var n=j(e,"a","notEqualStrict"),r=j(t,"b","notEqualStrict");return ln(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function vZ(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function yZ(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Fm=Q({gather_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","gather"),i=j(t,"indices","gather","int32");n=Wr(n,r.shape)[0];var a=function(o,s,u){for(var l=o.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(o.shape[h]),f*=o.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<o.rank;h++)c.push(o.shape[h]),d*=o.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,i,n);return J.runKernelFunc(function(o,s){var u=o.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(o,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,g=vZ(0,d),m=vZ(d+1,d+1+p),v=yZ([f,[c],h]),y=o.reshape(v),b=u.reshape([c]),x=yZ([[d],g,m]),w=y.transpose(x),S=yM(w,b,r.shape[n]),C=ES(x);return S=S.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),yM=Q({unsortedSegmentSum_:function(e,t,n){var r=j(e,"x","unsortedSegmentSum"),i=j(t,"segmentIds","unsortedSegmentSum","int32");return U(gr(n),function(){return"numSegments must be of dtype int"}),J.runKernelFunc(function(a,o){var s=a.unsortedSegmentSum(r,i,n);return o([i]),s},{$x:r},function(a,o){var s=o[0];return{$x:function(){return function(u,l){for(var c=Vu(l,en(l)),f=Fm(u,c),d=yb(l,Ve(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Do(d,p+1);d=Hu(d,Wu(f.shape,"bool"));var g=en(f);return Vs(d,f,g)}(a,s)}}})}}),bZ=function(e,t,n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g;return nt(this,function(m){switch(m.label){case 0:for(r=j(e,"tensor","boolMask"),i=j(t,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,U(o>0,function(){return"mask cannot be scalar"}),ln(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+o)),f=r.reshape(c),d=i.reshape([-1]),[4,QS(d)];case 1:return h=m.sent(),p=h.squeeze([1]),g=Fm(f,p,a),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,g]}})})};function xZ(e,t,n,r,i,a,o){a===void 0&&(a="NHWC"),U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),U(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),U(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),U(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],f=a==="NHWC"?u.shape[3]:u.shape[1];U(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),U(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&U(gr(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=WS(a),h=Df(s,n.shape,r,1,i,o,!1,d),p=J.runKernelFunc(function(g,m){var v=g.conv2dDerInput(u,n,h);return m([n,u]),v},{dy4D:u,filter:n},function(g,m){var v=m[0],y=m[1];return{dy4D:function(){return Uh(g,v,r,i,a,1,o)},filter:function(){return xM(g,y,v.shape,r,i,a,o)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function bM(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function wZ(e,t,n,r,i){U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,o=t,s=!1;t.rank===4&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=o.shape[4];U(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),U(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),U(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),U(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),U(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=db(a,n.shape,r,1,i),f=J.runKernelFunc(function(d){return d.conv3dDerInput(o,n,c)},{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var iE=Q({conv1d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NWC"),a===void 0&&(a=1);var s=j(e,"x","conv1d"),u=j(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),U(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),o!=null&&U(gr(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),U(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),U(Gi(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),U(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Uh(d,f,[1,n],r,"NHWC",[1,a],o);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Uh=Q({conv2d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]);var s=j(e,"x","conv2d"),u=j(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),o!=null&&U(gr(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),U(Gi(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var d=WS(i),h=Df(l.shape,u.shape,n,a,r,o,!1,d),p=[u,l],g=J.runKernelFunc(function(m,v){var y=m.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(m,v){var y=v,b=y[0],x=y[1];return U(Rh(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return _Z(x.shape,m,b,n,r,i)},filter:function(){return xM(x,m,b.shape,n,r,i)}}},"Conv2D",h,p);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),aE=Q({conv3d_:function(e,t,n,r,i,a){i===void 0&&(i="NDHWC"),a===void 0&&(a=[1,1,1]);var o=j(e,"x","conv3d"),s=j(t,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),U(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),U(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),U(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),U(function(d,h){return bM(d)||bM(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),U(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=db(u.shape,s.shape,n,a,r),f=J.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){U(bM(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],g=h[1];return{x:function(){return wZ(p.shape,d,g,n,r)},$filter:function(){return function(m,v,y,b,x){var w=m;m.rank===4&&(w=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),U(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),U(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),U(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),U(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),U(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var C=db(w.shape,y,b,1,x);return J.runKernelFunc(function(_){return _.conv3dDerFilter(w,S,C)},{x5D:w,dy5D:S})}(p,d,g.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),xM=Q({conv2dDerFilter_:function(e,t,n,r,i,a,o){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),U(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),U(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),U(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];U(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),U(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),o!=null&&U(gr(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=WS(a),d=Df(s.shape,n,r,1,i,o,!1,f);return J.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),_Z=Q({conv2dDerInput_:xZ}),Mm=Q({depthwiseConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]);var s=j(e,"x","depthwiseConv2d"),u=j(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),U(Gi(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&U(gr(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=Df(l.shape,u.shape,n,a,r,o,!0),d=[l,u],h=J.runKernelFunc(function(p,g){var m=p.depthwiseConv2D(l,u,f);return g([l,u]),m},{x:l,filter:u},function(p,g){U(Rh(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var m=g[0],v=g[1];return{x:function(){return SZ(m.shape,p,v,f)},filter:function(){return EZ(m,p,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),SZ=Q({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;t.rank===3&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=J.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),EZ=Q({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,a,r)},{x4D:i,dy4D:a})}}),wM=Q({separableConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC");var s=j(e,"x","separableConv2d"),u=j(t,"depthwiseFilter","separableConv2d"),l=j(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),U(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),U(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];U(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=Mm(c,u,r,i,o,a),g=Uh(p,l,1,"valid",o);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),oE=Q({conv2dTranspose_:function(e,t,n,r,i,a){return xZ(n,j(e,"x","conv2dTranspose"),j(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),CZ=Q({conv3dTranspose_:function(e,t,n,r,i){return wZ(n,j(e,"x","conv3dTranspose"),j(t,"filter","conv3dTranspose"),r,i)}}),sE=Q({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=j(e,"a","matMul"),o=j(t,"b","matMul");i=ur(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=et(f),p=et(d);U(a.rank>=2&&o.rank>=2&&a.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."}),U(Ur(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."}),U(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=a.shape.slice(0,-2).concat([l,c]),m=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?o.as3D(p,c,u):o.as3D(p,u,c),y={transposeA:n,transposeB:r};return J.runKernelFunc(function(b,x){var w=b.batchMatMul(m,v,n,r);return x([m,v]),w},{a:m,b:v},function(b,x){var w=x,S=w[0],C=w[1];return n||r?!n&&r?{a:function(){return b.matMul(C,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return C.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return C.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(C,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(g)}}),AZ=Q({dot_:function(e,t){var n=j(e,"t1","dot"),r=j(t,"t2","dot");U(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return U(i===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),kZ=Q({outerProduct_:function(e,t){var n=j(e,"v1","outerProduct"),r=j(t,"v2","outerProduct");return U(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Ku=Q({reverse_:function(e,t){var n=j(e,"x","reverse");if(n.rank===0)return n.clone();var r=Wr(t,n.shape);return J.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),TZ=Q({reverse1d_:function(e){var t=j(e,"x","reverse");return U(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Ku(t,0)}}),OZ=Q({reverse2d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Ku(n,t)}}),IZ=Q({reverse3d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Ku(n,t)}}),NZ=Q({reverse4d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Ku(n,t)}});function DZ(e,t,n,r,i,a){var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),r==null&&(r=[1,1]),U(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),U(Gi(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&U(gr(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Nf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Ur(l.inShape,l.outShape))return o.clone();var c=[s],f=J.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=j(m,"dy","maxPoolBackprop"),E=j(v,"input","maxPoolBackprop"),A=j(y,"output","maxPoolBackprop");U(E.rank===_.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+_.rank+")"}),w==null&&(w=[1,1]),U(Gi(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),U(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),U(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."}),C!=null&&U(gr(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var k=Nf(E.shape,b,x,w,S,C);return J.runKernelFunc(function(T){return T.maxPoolBackprop(_,E,A,k)},{$dy:_,$input:E})}(d,p,g,t,n,r,i)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function RZ(e,t,n,r,i,a){var o=j(e,"x","avgPool","float32");r==null&&(r=[1,1]),U(Gi(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&U(gr(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Nf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Ur(l.inShape,l.outShape))return o.clone();var c=J.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,g,m,v){var y=j(d,"dy","avgPoolBackprop"),b=j(h,"input","avgPoolBackprop");U(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),m==null&&(m=[1,1]),U(Gi(g,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),U(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),U(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var C=Nf(x.shape,p,g,m,v),_=J.runKernelFunc(function(E){return E.avgPoolBackprop(w,x,C)},{dy4D:w,input4D:x});return S?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var uE=Q({maxPool_:function(e,t,n,r,i){return DZ(e,t,n,1,r,i)}}),lE=Q({avgPool_:function(e,t,n,r,i){return RZ(e,t,n,1,r,i)}}),FZ=Q({pool_:function(e,t,n,r,i,a){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(Gi(a,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"});var l,c=Nf(s.shape,t,a,i,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(E,A){return E+(E-1)*(w[A]-1)}).map(function(E){return E-1}),C=S.map(function(E){return Math.floor(E/2)}),_=S.map(function(E,A){return E-C[A]});return S.map(function(E,A){return[C[A],_[A]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(x,w,S){var C=S.map(function(N){return N[0]}),_=S.map(function(N){return N[1]}),E=x.concat(C,_),A=w.map(function(N,O){return(N-E[O]%N)%N}),k=_.map(function(N,O){return N+A[O]}),T=w.map(function(N,O){return[C[O],k[O]]}),I=w.map(function(N,O){return[0,A[O]]});return[T,I]}([c.inHeight,c.inWidth],f,l),p=h[0],g=h[1],m=d?r:"valid",v=d?s:TS(s,f,p),y=(n==="avg"?function(){return RZ(v,t,a,1,m)}:function(){return DZ(v,t,a,1,m)})(),b=d?y:AS(y,f,g);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),cE=Q({maxPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(gr(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=fb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=j(m,"dy","maxPool3dBackprop"),E=j(v,"input","maxPool3dBackprop"),A=j(y,"output","maxPool3dBackprop"),k=_,T=E,I=A,N=!1;E.rank===4&&(N=!0,k=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),I=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),U(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),U(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),U(I.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+I.rank+"."}),w==null&&(w=[1,1,1]),U(Gi(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),C!=null&&U(gr(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var O=fb(T.shape,b,x,w,S,C),D=J.runKernelFunc(function(L){return L.maxPool3dBackprop(k,T,I,O)},{dy5D:k,input5D:T});return N?D.as4D(D.shape[1],D.shape[2],D.shape[3],D.shape[4]):D}(d,p,g,t,n,o,r,i)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),fE=Q({avgPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(gr(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=fb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,g,m,v,y,b){var x=j(h,"dy","avgPool3dBackprop"),w=j(p,"input","avgPool3dBackprop"),S=x,C=w,_=!1;w.rank===4&&(_=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),U(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),U(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),v==null&&(v=[1,1,1]),U(Gi(m,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"}),b!=null&&U(gr(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=fb(C.shape,g,m,v,y,b),A=J.runKernelFunc(function(k){return k.avgPool3dBackprop(S,C,E)},{dy5D:S,input5D:C});return _?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}(d,u,t,n,o,r,i)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),_M=Q({maxPoolWithArgmax_:function(e,t,n,r,i){i===void 0&&(i=!1);var a=j(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=J.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Ro=Q({slice_:function(e,t,n){var r,i,a=j(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){U(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(U(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),qX(a,r,i);var o=a.shape,s={begin:r,size:i};return J.runKernelFunc(function(u){return u.slice(a,r,i)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return Gu(u,l)}}},"Slice",s)}}),bb=Q({slice1d_:function(e,t,n){var r=j(e,"x","slice1d");return U(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,[t],[n])}}),dE=Q({slice2d_:function(e,t,n){var r=j(e,"x","slice2d");return U(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}}),xb=Q({slice3d_:function(e,t,n){var r=j(e,"x","slice3d");return U(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}}),Pm=Q({slice4d_:function(e,t,n){var r=j(e,"x","slice4d");return U(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}});function MZ(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(ya(t.shape,r))),e.rank<n.rank&&(e=e.reshape(ya(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return i==null?a:a.transpose(i)}}}var hE=Q({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","all","bool"),i=Wr(t,r.shape),a=i,o=zs(a,r.rank);o!=null&&(r=r.transpose(o),a=js(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),wb=Q({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","any","bool"),i=Wr(t,r.shape),a=i,o=zs(a,r.rank);o!=null&&(r=r.transpose(o),a=js(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),_b=Q({argMax_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMax");t==null&&(t=0);var r=Wr(t,n.shape),i=zs(r,n.rank);i!=null&&(n=n.transpose(i),r=js(r.length,n.rank));var a={axis:r[0]},o=[n];return J.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return en(l)}}},"ArgMax",a,o)}}),SM=Q({argMin_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMin");t==null&&(t=0);var r=Wr(t,n.shape),i=zs(r,n.rank);return i!=null&&(n=n.transpose(i),r=js(r.length,n.rank)),J.runKernelFunc(function(a,o){var s=a.argMin(n,r[0]);return o([n]),s},{$x:n},function(a,o){var s=o[0];return{$x:function(){return en(s)}}})}}),PZ=Q({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","logSumExp"),i=Wr(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Rf=Q({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","max"),i=r,a=Wr(t,r.shape),o=a,s=zs(o,r.rank);s!=null&&(r=r.transpose(s),o=js(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.max(r,o);return d([i,h]),h},{x:r},function(f,d){return MZ(f,d[1],d[0],a,s)},"Max",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Fr=Q({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","mean"),i=Wr(t,r.shape),a=et(Di(r.shape,i)[1]);return cb(function(o){var s=Ve(a);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=o.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(Wu(o.shape,"float32")).div(a)}}})(r)}}),pE=Q({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","min"),i=r,a=Wr(t,r.shape),o=a,s=zs(o,r.rank);s!=null&&(r=r.transpose(s),o=js(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.min(r,o);return d([i,h]),h},{x:r},function(f,d){return MZ(f,d[1],d[0],a,s)},"Min",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Sb=Q({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Wr(t,(e=j(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=ya(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),qr=Q({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Wr(t,r.shape);return cb(function(a){var o=zs(i,a.rank),s=i,u=a;o!=null&&(u=a.transpose(o),s=js(s.length,a.rank));var l=function(h){var p=a.shape.slice();return i.forEach(function(g){p[g]=1}),h.reshape(p).mul(Wu(a.shape,"float32"))},c={axes:s},f=J.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=ya(f.shape,i);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),gE=Q({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Wr(t,r.shape),a=zs(i,r.rank),o=i,s=r;a!=null&&(s=r.transpose(a),o=js(o.length,r.rank));var u=J.runKernelFunc(function(c){return c.prod(s,o)},{permutedX:s});if(n){var l=ya(u.shape,i);u=u.reshape(l)}return u}}),$m=Q({elu_:function(e){var t=j(e,"x","elu");return J.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return J.runKernelFunc(function(a){return a.eluDer(n,i)},{dy:n,y:i})}}})}}),mE=Q({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=j(e,"x","leakyRelu");return Vu(Ve(t).mul(n),n)}}),Eb=Q({prelu_:function(e,t){var n=j(e,"x","prelu"),r=j(t,"alpha","prelu");return J.runKernelFunc(function(i,a){var o=i.prelu(n,r);return a([n,r]),o},{x:n,alpha:r},function(i,a){var o=a[0],s=a[1],u=o.greater(0);return{x:function(){return Vs(u,i,i.mul(s))},alpha:function(){var l=Vs(u,en(i),i.mul(o)),c=Vr(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Ff=Q({relu_:function(e){var t=j(e,"x","relu");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),EM=Q({relu6_:function(e){var t=j(e,"x","relu6");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],a=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),vE=Q({selu_:function(e){var t=j(e,"x","selu");return J.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var a=i.greater(Ve(0)),o=Ve(nM),s=Ve(rM),u=n.mul(s),l=n.mul(o).mul(i.toFloat().exp());return Vs(a,u,l)}}})}}),CM=Q({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var a=j(e,"x","localResponseNormalization");U(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),U(gr(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=a,s=!1;a.rank===3&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=J.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(o,t,n,r,i);return c([o,f]),f},{x4D:o},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return J.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),AM=Q({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ve(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=j(e,"x","norm"),t,n),a=i.shape;if(r){var o=Wr(n,e.shape);a=ya(i.shape,o)}return i.reshape(a)}}),$Z=Q({basicLSTMCell_:function(e,t,n,r,i,a){var o=j(e,"forgetBias","basicLSTMCell"),s=j(t,"lstmKernel","basicLSTMCell"),u=j(n,"lstmBias","basicLSTMCell"),l=j(r,"data","basicLSTMCell"),c=j(i,"c","basicLSTMCell"),f=j(a,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,g=[h,p],m=d.slice([0,0],g),v=d.slice([0,p],g),y=d.slice([0,2*p],g),b=d.slice([0,3*p],g),x=m.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),LZ=Q({multiRNNCell_:function(e,t,n,r){for(var i=j(t,"data","multiRNNCell"),a=rb(n,"c","multiRNNCell"),o=rb(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),BZ=Q({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var a=j(e,"v","movingAverage"),o=j(t,"x","movingAverage"),s=j(n,"decay","movingAverage");HK(a,o),U(Ur(a.shape,o.shape),function(){return"Shape mismatch in v and x"});var u=Ve(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){U(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=j(r,"step","movingAverage");c=c.div(u.sub(Am(s,f)))}return a.add(c)}}),kM=Q({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=j(e,"x","stridedSlice"),c=$3(s),f=l.shape.slice();c.forEach(function(m){t[m]=0,n[m]=1,f.splice(m,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=HX(i,t,r,l.shape,d),n[d]=GX(a,n,r,l.shape,d),r[d]=r[d]||1;var h=$3(u);h.forEach(function(m){n[m]=t[m]+1,r[m]=1});var p=BS(t,n,r),g=p.filter(function(m,v){return h.indexOf(v)===-1});return r.every(function(m){return m===1})?Ro(l,t,p).reshape(g):J.runKernelFunc(function(m){return m.stridedSlice(l,t,n,r)},{$x:l}).reshape(g)}}),TM=Q({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=j(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=J.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),OM=Q({scatterND_:function(e,t,n){var r=j(e,"indices","scatterND","int32"),i=j(t,"updates","scatterND");return VX(i,r,n),J.runKernelFunc(function(a){return a.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Cb=Q({fft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),Lm=Q({ifft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),Ab=Q({rfft_:function(e,t){U(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),o=e.shape.map(function(v){return v});o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Tn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=ri(n,u).as2D(i,r),c=Cb(l),f=Math.floor(r/2)+1,d=eo(c),h=is(c),p=d.split([f,r-f],d.shape.length-1),g=h.split([f,r-f],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,ri(p[0],g[0]).reshape(m)}}),yE=Q({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=Lm(r);return eo(i)}var a=[n,2*(t-1)],o=eo(e).as2D(n,t),s=is(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(Ve(-1)),c=o.concat(u,1),f=s.concat(l,1);return r=ri(c,f).as2D(a[0],a[1]),i=Lm(r),eo(i)}}),zZ=Object.freeze({fft:Cb,ifft:Lm,rfft:Ab,irfft:yE}),bE=Q({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=j(e,"sparseIndices","sparseToDense","int32"),a=j(t,"sparseValues","sparseToDense"),o=j(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),J.runKernelFunc(function(s){return s.sparseToDense(i,a,n,o)},{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),IM=Q({gatherND_:function(e,t){var n=j(t,"indices","gatherND","int32"),r=j(e,"x","gatherND");return J.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),jZ=Q({diag_:function(e){var t=j(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return J.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),NM=Q({dropout_:function(e,t,n,r){var i=j(e,"x","dropout");if(U(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),U(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Ht?i.clone():i;var a=function(u,l){if(l==null)return u.shape.slice();if(Ur(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(i,n),o=1-t,s=zh(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function UZ(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return ba(i,"float32")}var xE=Q({hannWindow_:function(e){return UZ(e,.5,.5)}}),DM=Q({hammingWindow_:function(e){return UZ(e,.54,.46)}}),wE=Q({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Ro(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Hi([Ro(e,a,t-s),Sm([s],i)]);o.push(u),a+=n}return o.length===0?Uu([],[0,t]):Hi(o).as2D(o.length,t)}}),RM=Q({stft_:function(e,t,n,r,i){var a;i===void 0&&(i=xE),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=wE(e,t,n),s=rt(o,i(t)),u=[],l=0;l<o.shape[0];l++)u.push(Ab(s.slice([l,0],[1,t]),r));return Hi(u)}}),WZ=Object.freeze({hannWindow:xE,hammingWindow:DM,frame:wE,stft:RM}),Ri,VZ=function(e,t,n){return n===void 0&&(n=1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m;return nt(this,function(v){switch(v.label){case 0:return r=j(e,"predictions","inTopK"),i=j(t,"targets","inTopK"),U(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),U(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),ln(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],U(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[o.length/a,a],c=u[1],f=Oh("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=o.subarray(h,h+c),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(y,b){return b.value-y.value}),f[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Rr(f,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ri||(Ri={}));var T$e=Q({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","absoluteDifference"),a=j(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=j(n,"weights","absoluteDifference")),ln(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return uc(s,o,r)}}),uc=Q({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Ri.SUM_BY_NONZERO_WEIGHTS);var r=j(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=j(t,"weights","computeWeightedLoss"));var a=i==null?r:r.mul(i);if(n===Ri.NONE)return a;if(n===Ri.SUM)return a.sum();if(n===Ri.MEAN){if(i==null)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(Ve(o)):s}if(n===Ri.SUM_BY_NONZERO_WEIGHTS){if(i==null)return a.sum().div(Ve(r.size));var u=i.mul(Wu(r.shape)).notEqual(Ve(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),O$e=Q({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","cosineDistance"),o=j(t,"predictions","cosineDistance"),s=null;r!=null&&(s=j(r,"weights","cosineDistance")),ln(a.shape,o.shape,"Error in cosineDistance: ");var u=Ve(1).sub(a.mul(o).sum(n,!0));return uc(u,s,i)}}),I$e=Q({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","hingeLoss"),a=j(t,"predictions","hingeLoss"),o=null;n!=null&&(o=j(n,"weights","hingeLoss")),ln(i.shape,a.shape,"Error in hingeLoss: ");var s=Ve(1);i=Ve(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return uc(u,o,r)}}),N$e=Q({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","huberLoss"),o=j(t,"predictions","huberLoss"),s=null;n!=null&&(s=j(n,"weights","huberLoss")),ln(a.shape,o.shape,"Error in huberLoss: ");var u=Ve(r),l=o.sub(a).abs(),c=Cm(l,u),f=l.sub(c),d=Ve(.5).mul(c.square()).add(u.mul(f));return uc(d,s,i)}}),D$e=Q({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","logLoss"),o=j(t,"predictions","logLoss"),s=null;n!=null&&(s=j(n,"weights","logLoss")),ln(a.shape,o.shape,"Error in logLoss: ");var u=Ve(1),l=Ve(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return uc(c,s,i)}}),R$e=Q({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","meanSquaredError"),a=j(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=j(n,"weights","meanSquaredError")),ln(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return uc(s,o,r)}}),F$e=Q({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"multiClassLabels","sigmoidCrossEntropy"),o=j(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","sigmoidCrossEntropy")),ln(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=j(d,"labels","sigmoidCrossEntropyWithLogits"),g=j(h,"logits","sigmoidCrossEntropyWithLogits");ln(p.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=g.relu(),v=g.mul(p),y=g.abs().neg().exp().log1p();return m.sub(v).add(y)}(a,o);return uc(f,s,i)}}),M$e=Q({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"onehotLabels","softmaxCrossEntropy"),o=j(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","softmaxCrossEntropy")),ln(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return cb(function(g,m,v){var y=m.logSumExp([p],!0),b=m.toFloat().sub(y);return v([g,b]),{value:b.mul(g).neg().sum([p]),gradFunc:function(x,w){var S=w[0],C=w[1],_=ya(x.shape,[p]);return[x.reshape(_).mul(S.toFloat().sub(C.exp())),x.reshape(_).mul(C.exp().sub(S.toFloat()))]}}})(d,h)}(a,o);return uc(f,s,i)}}),qZ=Object.freeze({get Reduction(){return Ri},absoluteDifference:T$e,computeWeightedLoss:uc,cosineDistance:O$e,hingeLoss:I$e,huberLoss:N$e,logLoss:D$e,meanSquaredError:R$e,sigmoidCrossEntropy:F$e,softmaxCrossEntropy:M$e});function HZ(e,t){return t===void 0&&(t=!1),J.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=tE(n),a=e.clone(),o=Uu([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(f){var d,h=a,p=s,g=i;d=J.tidy(function(){var m=a.slice([f,f],[n-f,1]),v=m.norm(),y=a.slice([f,f],[1,1]),b=Uu([[-1]]).where(y.greater(0),Uu([[1]])),x=y.sub(b.mul(v)),w=m.div(x);s=w.shape[0]===1?o.clone():o.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),C=a.slice([f,0],[n-f,r]),_=S.mul(s),E=s.transpose();if(f===0)a=C.sub(_.matMul(E.matMul(C)));else{var A=C.sub(_.matMul(E.matMul(C)));a=a.slice([0,0],[f,r]).concat(A,0)}var k=_.transpose(),T=i.slice([0,f],[n,i.shape[1]-f]);if(f===0)i=T.sub(T.matMul(s).matMul(k));else{var I=T.sub(T.matMul(s).matMul(k));i=i.slice([0,0],[n,f]).concat(I,1)}return[s,a,i]}),s=d[0],a=d[1],i=d[2],Ut([h,p,g])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}var P$e=Q({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=j(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=Em(0,o,1,"int32").reshape([-1,1]),l=Em(0,s,1,"int32"),c=Er(u,l),f=Hu(c.lessEqual(Ve(+t,"int32")),c.greaterEqual(Ve(-n,"int32"))),d=Tn([o,s],r.dtype);return as(Tf(r.reshape([-1,o,s])).map(function(h){return Vs(f,h,d)})).reshape(i)}}),$$e=Q({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,U(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){U(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=ic(e,e.shape[0],0).map(function(u){return ib(u,[0])});U(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],o=e,s=function(u){a.push(J.tidy(function(){var l=o[u];if(u>0)for(var c=0;c<u;++c){var f=qr(a[c].mulStrict(l)).mul(a[c]);l=l.sub(f)}return l.div(AM(l,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?as(a,0):a}}),L$e=Q({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return HZ(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,s){return o*s}),r=Tf(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(function(o){var s=HZ(o,t),u=s[0],l=s[1];i.push(u),a.push(l)}),[as(i,0).reshape(e.shape),as(a,0).reshape(e.shape)]}}),FM=Object.freeze({bandPart:P$e,gramSchmidt:$$e,qr:L$e});function _E(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);var o=e.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),U(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),U(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),U(t.rank===1,function(){return"scores must be a 1D tensor"}),U(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),U(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var B$e=Q({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeBilinear");U(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,o,s,n)},{x:i},function(l,c){return{x:function(){return J.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),z$e=Q({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeNearestNeighbor");U(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),U(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,o,s,n)},{batchImages:i},function(l,c){return{batchImages:function(){return J.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),j$e=Q({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var a=j(e,"boxes","nonMaxSuppression"),o=j(t,"scores","nonMaxSuppression"),s=_E(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return J.runKernelFunc(function(l){return l.nonMaxSuppression(a,o,n,r,i)},{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),U$e=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),tt(this,void 0,void 0,function(){var a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return a=j(e,"boxes","nonMaxSuppressionAsync"),o=j(t,"scores","nonMaxSuppressionAsync"),s=_E(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=G3(l,c,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,f]}})})},W$e=Q({nonMaxSuppressionWithScore_:function(e,t,n,r,i,a){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var o=j(e,"boxes","nonMaxSuppression"),s=j(t,"scores","nonMaxSuppression"),u=_E(o,s,n,r,i,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=J.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),V$e=function(e,t,n,r,i,a){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),tt(this,void 0,void 0,function(){var o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return o=j(e,"boxes","nonMaxSuppressionAsync"),s=j(t,"scores","nonMaxSuppressionAsync"),u=_E(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=K3(c,f,n,r,i,a),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},q$e=Q({cropAndResize_:function(e,t,n,r,i,a){var o=j(e,"image","cropAndResize"),s=j(t,"boxes","cropAndResize","float32"),u=j(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return U(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),U(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),U(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),U(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),U(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),U(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),J.runKernelFunc(function(c,f){return c.cropAndResize(o,s,u,r,i,a)},{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),Mf=Object.freeze({resizeBilinear:B$e,resizeNearestNeighbor:z$e,nonMaxSuppression:j$e,nonMaxSuppressionAsync:U$e,nonMaxSuppressionWithScore:W$e,nonMaxSuppressionWithScoreAsync:V$e,cropAndResize:q$e}),MM=function(e,t){return!(e>0)||t==="linear"},PM=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},$M=function(e,t){var n=t,r=Vr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},LM=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Ff(e);if(t==="elu")return $m(e);if(t==="relu6")return EM(e);if(t==="prelu")return Eb(e,n);throw new Error("Unknown fused activation "+t+".")},H$e=Q({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=i!==void 0&&i,o=e.transposeB,s=o!==void 0&&o,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(MM(J.state.gradientDepth,c)===!1){var d=sE(n,r,a,s);return u!=null&&(d=Wt(d,u)),LM(d,c,f)}var h=j(n,"a","fused matMul"),p=j(r,"b","fused matMul");t=ur(h,p),h=t[0],p=t[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),w=et(b),S=et(x);U(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),U(Ur(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),U(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var C,_,E=h.shape.slice(0,-2).concat([v,y]),A=a?h.as3D(w,g,v):h.as3D(w,v,g),k=s?p.as3D(S,y,m):p.as3D(S,m,y);u!=null&&Qt(E,(C=ur(C=j(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=j(f,"prelu weights","fused matMul"));var T={a:A,b:k};u!=null&&(T.bias=C),f!=null&&(T.preluActivationWeights=_);var I=[A,k];return J.runKernelFunc(function(N,O){var D=N.fusedBatchMatMul({a:A,b:k,transposeA:a,transposeB:s,bias:C,activation:c,preluActivationWeights:_});return O([A,k,D]),D},T,function(N,O){var D=O[0],L=O[1],W=O[2],G=PM(N,W,c),K={};return u!=null&&(K={bias:function(){return $M(C,G)}}),Object.assign(a||s?!a&&s?{a:function(){return G.matMul(L,!1,!1)},b:function(){return G.matMul(D,!0,!1)}}:a&&!s?{a:function(){return L.matMul(G,!1,!0)},b:function(){return D.matMul(G,!1,!1)}}:{a:function(){return L.matMul(G,!0,!0)},b:function(){return G.matMul(D,!0,!0)}}:{a:function(){return G.matMul(L,!1,!0)},b:function(){return D.matMul(G,!0,!1)}},K)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},I,[!0]).reshape(E)}}),G$e=Q({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",MM(J.state.gradientDepth,d)===!1){var p=Uh(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),LM(p,d,h)}var g=j(t,"x","conv2d"),m=j(n,"filter","conv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&U(gr(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),U(Gi(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),U(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,w=Df(v.shape,m.shape,r,u,i,l);c!=null&&(b=ur(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused conv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=J.runKernelFunc(function(E,A){var k=E.fusedConv2d({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){var k=A,T=k[0],I=k[1],N=k[2],O=PM(E,N,d);U(Rh(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var D={};return c!=null&&(D={bias:function(){return $M(b,O)}}),Object.assign({x:function(){return _Z(I.shape,O,T,r,i)},filter:function(){return xM(I,O,T.shape,r,i)}},D)},"FusedConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),K$e=Q({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(MM(J.state.gradientDepth,d)===!1){var p=Mm(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),LM(p,d,h)}var g=j(t,"x","depthwiseConv2d"),m=j(n,"filter","depthwiseConv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),U(Gi(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&U(gr(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=Df(v.shape,m.shape,r,u,i,l,!0);c!=null&&(b=ur(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=J.runKernelFunc(function(E,A){var k=E.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){U(Rh(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=A[0],T=A[1],I=A[2],N=PM(E,I,d),O={};return c!=null&&(O={bias:function(){return $M(b,N)}}),Object.assign({x:function(){return SZ(T.shape,N,k,w)},filter:function(){return EZ(T,N,k.shape,w)}},O)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Pf=Object.freeze({matMul:H$e,conv2d:G$e,depthwiseConv2d:K$e}),X$e=Object.freeze({image:Mf,linalg:FM,losses:qZ,spectral:zZ,fused:Pf,signal:WZ,add:Wt,addN:iM,batchNorm:Lh,batchNormalization:XY,batchNorm2d:aM,batchNormalization2d:ZY,batchNorm3d:oM,batchNormalization3d:QY,batchNorm4d:sM,batchNormalization4d:tZ,broadcastTo:uM,clone:nZ,div:Cr,divNoNan:eE,eye:tE,multinomial:cM,oneHot:Bh,pad:Gu,pad1d:iZ,pad2d:aZ,pad3d:oZ,pad4d:sZ,rand:uZ,randomGamma:cZ,randomNormal:gM,randomUniform:zh,square:nE,squaredDifference:rE,tile:sc,truncatedNormal:vb,conv1d:iE,conv2d:Uh,conv3d:aE,depthwiseConv2d:Mm,separableConv2d:wM,conv2dTranspose:oE,conv3dTranspose:CZ,op:Q,booleanMaskAsync:bZ,complex:ri,real:eo,imag:is,concat:Hi,concat1d:n3,concat2d:r3,concat3d:i3,concat4d:a3,split:ic,matMul:sE,dot:AZ,outerProduct:kZ,reverse:Ku,reverse1d:TZ,reverse2d:OZ,reverse3d:IZ,reverse4d:NZ,maxPool:uE,avgPool:lE,pool:FZ,maxPool3d:cE,avgPool3d:fE,maxPoolWithArgmax:_M,slice:Ro,slice1d:bb,slice2d:dE,slice3d:xb,slice4d:Pm,abs:Of,acos:p3,acosh:g3,asin:m3,asinh:v3,atan:y3,atanh:b3,ceil:x3,clipByValue:xa,cos:w3,cosh:_3,erf:S3,exp:E3,expm1:C3,floor:DS,log:oc,log1p:A3,logSigmoid:IX,neg:If,reciprocal:k3,round:T3,rsqrt:RS,sigmoid:FS,sign:O3,isNaN:NX,isInf:DX,isFinite:RX,sin:I3,sinh:N3,softplus:sb,sqrt:ub,step:FX,tan:D3,tanh:MS,all:hE,any:wb,argMax:_b,argMin:SM,logSumExp:PZ,max:Rf,mean:Fr,min:pE,moments:Sb,sum:qr,prod:gE,equal:jh,equalStrict:fZ,greater:Dm,greaterEqual:yb,greaterEqualStrict:dZ,greaterStrict:hZ,less:mM,lessEqual:vM,lessEqualStrict:pZ,lessStrict:gZ,notEqual:Rm,notEqualStrict:mZ,addStrict:MX,atan2:R3,divStrict:PX,floorDiv:PS,maximum:Vu,maximumStrict:$X,minimum:Cm,minimumStrict:LX,mod:F3,modStrict:BX,mul:rt,mulStrict:$S,pow:Am,powStrict:zX,squaredDifferenceStrict:jX,sub:Er,subStrict:UX,elu:$m,leakyRelu:mE,prelu:Eb,relu:Ff,relu6:EM,selu:vE,logicalAnd:Hu,logicalNot:lM,logicalOr:JS,logicalXor:rZ,where:Vs,whereAsync:QS,buffer:Ot,print:AX,batchToSpaceND:AS,cast:kS,cumsum:kX,depthToSpace:o3,expandDims:Do,reshape:Us,spaceToBatchND:TS,squeeze:ib,stack:as,unstack:Tf,setdiff1dAsync:s3,fill:Sm,linspace:t3,ones:Wu,range:Em,scalar:Ve,tensor:Rr,tensor1d:ba,tensor2d:Uu,tensor3d:CS,tensor4d:kf,tensor5d:EX,tensor6d:CX,variable:e3,zeros:Tn,onesLike:No,zerosLike:en,transpose:cn,softmax:Dh,logSoftmax:jS,localResponseNormalization:CM,norm:AM,gather:Fm,unsortedSegmentSum:yM,basicLSTMCell:$Z,multiRNNCell:LZ,movingAverage:BZ,stridedSlice:kM,topk:TM,scatterND:OM,fft:Cb,ifft:Lm,rfft:Ab,irfft:yE,sparseToDense:bE,gatherND:IM,diag:jZ,dropout:NM,hannWindow:xE,hammingWindow:DM,frame:wE,stft:RM,inTopKAsync:VZ});function ke(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&U(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function BM(e,t,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ot(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],x=0;x<i.batchSize;++x)for(var w=x*v,S=x*r[0],C=0;C<i.inChannels;++C)for(var _=0;_<i.outHeight;++_)for(var E=_*o-d,A=Math.max(0,E),k=Math.min(i.inHeight,c+E),T=w+_*y,I=0;I<i.outWidth;++I){for(var N=I*s-h,O=Math.max(0,N),D=Math.min(i.inWidth,f+N),L=p,W=0,G=0,K=A;K<k;K+=u){for(var ee=S+K*r[1],ce=O;ce<D;ce+=l){var he=e[ee+ce*r[2]+C];a==="max"&&he>L?L=he:a==="avg"&&(W+=he,G++)}if(isNaN(L))break}m[T+I*b+C]=a==="avg"?W/G:L}return g}function GZ(e,t,n,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);for(var o=Ot(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Ot(t,n,e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=l;for(var w=Math.min(r.inHeight,f+b),S=0;S<r.outWidth;++S){for(var C=S*u-p,_=C;_<0;)_+=c;for(var E=Math.min(r.inWidth,d+C),A=Number.NEGATIVE_INFINITY,k=-1,T=x;T<w;T+=l)for(var I=T-b,N=_;N<E;N+=c){var O=N-C,D=g.get(m,T,N,v);D>A&&(A=D,k=i?a?((m*r.inHeight+T)*r.inWidth+N)*r.inChannels+v:(T*r.inWidth+N)*r.inChannels+v:I*d+O)}o.set(k,m,y,S,v)}}return o}function zM(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Y$e=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new z3(n,J),n}return Ls(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,pe().get("IS_NODE")&&SS(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:i}),a},t.prototype.move=function(n,r,i,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,a=r.complexTensors;return i==="complex64"?H3(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(a){return Vy(a)})}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ot(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var a=this.write(n,r,i);return J.makeTensorFromDataId(a,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return r=Bs(),n(),[2,{kernelMs:Bs()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(ke(n,"slice"),L3(n.shape,r,i)){var a=B3(r,n.strides),o=et(i);return Rr(this.readSync(n.dataId).subarray(a,a+o),i,n.dtype)}for(var s=Ot(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,a){ke(n,"stridedSlice");var o=BS(r,i,a);if(o.some(function(h){return h===0}))return Rr([],o);for(var s=Ot(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*a[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=Ot([n.size,n.size],n.dtype),a=i.values,o=0;o<r.length;o++)a[o*n.size+o]=r[o];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){ke(n,"reverse");for(var i=Ot(n.shape,n.dtype),a=this.bufferSync(n),o=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),i.set.apply(i,[a.get.apply(a,c)].concat(l))},s=0;s<i.size;s++)o(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return eo(h)}),o=n.map(function(h){return is(h)});return ri(this.concat(a,r),this.concat(o,r))}var s=n.map(function(h){var p=et(h.shape.slice(r));return h.as2D(-1,p)}),u=Nh(s.map(function(h){return h.shape}),1),l=Ot(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(i.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),g=0,m=0;m<h.shape[0];++m)for(var v=m*u[1]+f,y=0;y<h.shape[1];++y)l[v+y]=p[g++];f+=h.shape[1]})}var d=Nh(n.map(function(h){return h.shape}),r);return Rr(l,d,n[0].dtype)},t.prototype.neg=function(n){return ke(n,"neg"),this.multiply(Ve(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i+o,imag:a+s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i+a})},t.prototype.addN=function(n){var r=this;ke(n,"addN");for(var i=n.map(function(c){return r.readSync(c.dataId)}),a=Ot(n[0].shape,n[0].dtype),o=a.values,s=0;s<n.length;s++)for(var u=i[s],l=0;l<o.length;l++)o[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var i=Wr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i-o,imag:a-s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i-a})},t.prototype.pow=function(n,r){return ke([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.pow(i,a)})},t.prototype.batchMatMul=function(n,r,i,a){ke([n,r],"matMul");for(var o=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],g=d[2],m=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=m[0],y=m[1],b=m[2],x=s*u,w=Ot([l,s,u],n.dtype),S=w.values,C=this.blockSize,_=0;_<l;_++)for(var E=0;E<s;E+=C)for(var A=0;A<u;A+=C)for(var k=0;k<o;k+=C)for(var T=Math.min(E+C,s),I=Math.min(A+C,u),N=Math.min(k+C,o),O=E;O<T;O++)for(var D=A;D<I;D++){for(var L=0,W=k;W<N;W++)L+=c[_*h+O*p+W*g]*f[W*v+D*y+_*b];S[_*x+(O*u+D)]+=L}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,i,a,o);return s&&(c=this.add(c,s)),u&&(c=zM(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i*o-a*s,imag:i*s+a*o}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i*a})},t.prototype.floorDiv=function(n,r){return ke([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,a){return Math.floor(i/a)})},t.prototype.sum=function(n,r){ke(n,"sum"),Qa("sum",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){ke(n,"sum");for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){ke(n,"unsortedSegmentSum");for(var a=[],o=n.rank-r.rank,s=0;s<o;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ve(s,"int32"),l=jh(u,r).asType("float32").mul(n).sum(0);a.push(l)}return as(a)},t.prototype.argMin=function(n,r){ke(n,"argMin");var i=[r];Qa("argMin",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v<p&&(p=v,g=m)}c[d]=g}return u},t.prototype.argMax=function(n,r){ke(n,"argMax");var i=[r];Qa("argMax",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v>p&&(p=v,g=m)}c[d]=g}return u},t.prototype.cumsum=function(n,r,i,a){if(ke(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=yi(n.dtype,"int32"),s=Tn(n.shape,o),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=a?function(m,v){return m+c-v-1}:function(m,v){return m+v},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=i?0:l[p];else{var g=f(d,h-1);u[p]=i?l[g]+u[g]:l[p]+u[g]}}return s},t.prototype.equal=function(n,r){return ke([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i===a?1:0})},t.prototype.notEqual=function(n,r){return ke([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i!==a?1:0})},t.prototype.less=function(n,r){return ke([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<a?1:0})},t.prototype.lessEqual=function(n,r){return ke([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<=a?1:0})},t.prototype.greater=function(n,r){return ke([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>a?1:0})},t.prototype.greaterEqual=function(n,r){return ke([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>=a?1:0})},t.prototype.logicalNot=function(n){ke(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)i[a]=r[a]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return ke([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i&&a})},t.prototype.logicalOr=function(n,r){return ke([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i||a})},t.prototype.select=function(n,r,i){ke([n,r,i],"select");for(var a=this.readSync(n.dataId),o=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Tn(r.shape,yi(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:et(r.shape.slice(1)),d=0;d<a.length;d++)for(var h=0;h<f;h++)a[d]===1?l[c++]=o[d]:l[c++]=s[d];return u},t.prototype.where=function(n){ke([n],"where");var r=this.readSync(n.dataId);return X3(n.shape,r)},t.prototype.topk=function(n,r,i){return ke(n,"topk"),eY(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){ke(n,"min"),Qa("min",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g<h&&(h=g)}l[f]=h}return s},t.prototype.minimum=function(n,r){return ke([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.min(i,a)})},t.prototype.mod=function(n,r){return ke([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i%a;return i<0&&a<0||i>=0&&a>=0?o:(o+a)%a})},t.prototype.max=function(n,r){ke(n,"max"),Qa("max",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g>h&&(h=g)}l[f]=h}return s},t.prototype.maximum=function(n,r){return ke([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.max(i,a)})},t.prototype.all=function(n,r){ke(n,"all"),Qa("all",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h&&g}l[f]=h}return s},t.prototype.any=function(n,r){ke(n,"any"),Qa("any",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h||g}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return ke([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i-a;return o*o})},t.prototype.ceil=function(n){ke(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.ceil(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){ke(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.floor(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?i[a]=-1:r[a]>0?i[a]=1:i[a]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){ke(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=Math.floor(r[a]);r[a]-o<.5?i[a]=Math.floor(r[a]):r[a]-o>.5?i[a]=Math.ceil(r[a]):i[a]=o%2==0?o:o+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){ke(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.exp(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){ke(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.expm1(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){ke(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){ke(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log1p(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){ke(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){ke(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=1/Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){ke(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=1/r[a];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.max(0,a[o]);return r},t.prototype.relu6=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.min(Math.max(0,a[o]),6);return r},t.prototype.prelu=function(n,r){return ke([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return i<0?a*i:i})},t.prototype.elu=function(n){ke(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){ke([n,r],"eluDer");for(var i=new Float32Array(r.size),a=this.readSync(r.dataId),o=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){ke(n,"selu");for(var r=nM,i=rM,a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,i){ke(n,"clip");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>i?i:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.abs(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<n.size;++a){var o=i[2*a],s=i[2*a+1];r[a]=Math.hypot(o,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){ke(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=i[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){ke(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=1/(1+Math.exp(-i[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){ke(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o]>-r,u=a[o]<r,l=Math.exp(a[o]),c=void 0;c=u?l:s?a[o]:Math.log(1+l),i[o]=c}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){ke(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){ke(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){ke(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.tan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){ke(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){ke(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){ke(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return ke([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.atan2(i,a)})},t.prototype.sinh=function(n){ke(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){ke(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){ke(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=FK(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){ke(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){ke(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){ke(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atanh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){ke(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=Math.sign(i[a]),s=Math.abs(i[a]),u=1/(1+.3275911*s);r[a]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),ke(n,"step");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o];isNaN(s)?i[o]=NaN:i[o]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,i,a);return o&&(l=this.add(l,o)),s&&(l=zM(this,l,s,u)),l},t.prototype.conv2d=function(n,r,i){ke([n,r],"conv2d");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",d=Ot(i.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],g=f?n.strides[2]:1,m=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),C=d.values,_=0;_<i.batchSize;++_)for(var E=_*h,A=_*v,k=0;k<i.outHeight;++k)for(var T=A+k*y,I=k*i.strideHeight-c,N=0;N<a;N++){var O=I+N*s;if(!(O<0||O>=i.inHeight))for(var D=N*r.strides[0],L=E+O*p,W=0;W<i.outWidth;++W)for(var G=T+W*b,K=W*i.strideWidth-l,ee=0;ee<o;ee++){var ce=K+ee*u;if(!(ce<0||ce>=i.inWidth))for(var he=L+ce*g,Oe=D+ee*r.strides[1],Te=0;Te<i.inChannels;++Te){for(var De=w[he+Te*m],me=0;me<i.outChannels;++me)C[G+me*x]+=De*S[Oe+me];Oe+=i.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,i){for(var a=i.filterDepth,o=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,d=i.padInfo.left,h=i.padInfo.top,p=Ot(i.outShape,n.dtype),g=this.readSync(n.dataId),m=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],x=y*p.strides[0],w=0;w<i.outDepth;++w)for(var S=x+w*p.strides[1],C=w*i.strideDepth-f,_=0;_<a;_++){var E=C+_*u;if(!(E<0||E>=i.inDepth))for(var A=_*r.strides[0],k=b+E*n.strides[1],T=0;T<i.outHeight;++T)for(var I=S+T*p.strides[2],N=T*i.strideHeight-h,O=0;O<o;O++){var D=N+O*l;if(!(D<0||D>=i.inHeight))for(var L=A+O*r.strides[1],W=k+D*n.strides[2],G=0;G<i.outWidth;++G)for(var K=I+G*i.outChannels,ee=G*i.strideWidth-d,ce=0;ce<s;ce++){var he=ee+ce*c;if(!(he<0||he>=i.inWidth))for(var Oe=L+ce*r.strides[2],Te=W+he*i.inChannels,De=Oe,me=0;me<i.inChannels;++me){for(var P=g[Te+me],F=0;F<i.outChannels;++F)v[K+F]+=P*m[De+F];De+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){ke([n,r],"conv2dDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=i.batchSize,p=i.filterHeight,g=i.filterWidth,m=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,x=i.outHeight,w=i.outWidth,S=i.strideHeight,C=i.strideWidth,_=i.dataFormat,E=p-1-i.padInfo.top,A=g-1-i.padInfo.left,k=_==="channelsLast",T=a.strides[0],I=k?a.strides[1]:a.strides[2],N=k?a.strides[2]:1,O=k?1:a.strides[1],D=n.strides[0],L=k?n.strides[1]:n.strides[2],W=k?n.strides[2]:1,G=k?1:n.strides[1],K=0;K<h;++K)for(var ee=0;ee<m;++ee)for(var ce=0;ce<v;++ce)for(var he=ce-E,Oe=Math.max(0,Math.ceil(he/S)),Te=Math.min(x,(p+he)/S),De=0;De<y;++De){for(var me=De-A,P=Math.max(0,Math.ceil(me/C)),F=Math.min(w,(g+me)/C),V=0,ae=Oe;ae<Te;++ae)for(var Y=ae*S-he,M=P;M<F;++M)for(var B=D*K+L*ae+W*M,R=c*(p-1-Y)+f*(g-1-(M*C-me))+d*ee,X=0;X<b;++X)V+=s[B+G*X]*u[R+X];o[T*K+I*ce+N*De+O*ee]=V}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=i.batchSize,E=i.filterDepth,A=i.filterHeight,k=i.filterWidth,T=i.inChannels,I=i.inDepth,N=i.inHeight,O=i.inWidth,D=i.outChannels,L=i.outDepth,W=i.outHeight,G=i.outWidth,K=i.strideDepth,ee=i.strideHeight,ce=i.strideWidth,he=E-1-i.padInfo.front,Oe=A-1-i.padInfo.top,Te=k-1-i.padInfo.left,De=0;De<_;++De)for(var me=0;me<T;++me)for(var P=0;P<I;++P)for(var F=P-he,V=Math.max(0,Math.ceil(F/K)),ae=Math.min(L,(E+F)/K),Y=0;Y<N;++Y)for(var M=Y-Oe,B=Math.max(0,Math.ceil(M/ee)),R=Math.min(W,(A+M)/ee),X=0;X<O;++X){for(var ge=X-Te,xe=Math.max(0,Math.ceil(ge/ce)),ze=Math.min(G,(k+ge)/ce),Ke=0,Ze=V;Ze<ae;++Ze)for(var Bt=Ze*K-F,Je=B;Je<R;++Je)for(var Zt=Je*ee-M,mn=xe;mn<ze;++mn)for(var Hn=p*De+g*Ze+m*Je+v*mn,ti=x*(E-1-Bt)+w*(A-1-Zt)+S*(k-1-(mn*ce-ge))+C*me,er=0;er<D;++er)Ke+=d[Hn+er]*y[ti+er];o[u*De+l*P+c*Y+f*X+me]=Ke}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){ke([n,r],"conv2dDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=Ot(i.filterShape,"float32"),f=i.padInfo.left,d=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((d-g)/a)),v=Math.min(i.outHeight,(i.inHeight+d-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/o)),x=Math.min(i.outWidth,(i.inWidth+f-y)/o),w=0;w<i.inChannels;++w)for(var S=0;S<i.outChannels;++S){for(var C=0,_=0;_<i.batchSize;++_)for(var E=m;E<v;++E)for(var A=g+E*a-d,k=b;k<x;++k){var T=y+k*o-f;C+=l?h.get(_,A,T,w)*p.get(_,E,k,S):h.get(_,w,A,T)*p.get(_,S,E,k)}c.set(C,g,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=Ot(i.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=this.readSync(n.dataId),E=n.strides,A=E[0],k=E[1],T=E[2],I=E[3],N=i.padInfo.front,O=i.padInfo.left,D=i.padInfo.top,L=0;L<u;++L)for(var W=Math.max(0,Math.ceil((N-L)/a)),G=Math.min(i.outDepth,(i.inDepth+N-L)/a),K=L*p,ee=0;ee<l;++ee)for(var ce=Math.max(0,Math.ceil((D-ee)/o)),he=Math.min(i.outHeight,(i.inHeight+D-ee)/o),Oe=ee*g+K,Te=0;Te<c;++Te)for(var De=Math.max(0,Math.ceil((O-Te)/s)),me=Math.min(i.outWidth,(i.inWidth+O-Te)/s),P=Te*m+Oe,F=0;F<i.inChannels;++F)for(var V=F*v+P,ae=0;ae<i.outChannels;++ae){for(var Y=0,M=0;M<i.batchSize;++M)for(var B=M*A,R=M*x,X=W;X<G;++X)for(var ge=(L+X*a-N)*k+B,xe=X*w+R,ze=ce;ze<he;++ze)for(var Ke=(ee+ze*o-D)*T+ge,Ze=ze*S+xe,Bt=De;Bt<me;++Bt){var Je=Bt*C+Ze;Y+=_[(Te+Bt*s-O)*I+Ke+F]*y[Je+ae]}d[V+ae]=Y}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,i,a);return o&&(l=this.add(l,o)),s&&(l=zM(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,i){ke([n,r],"depthwiseConv2D");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,d=Ot(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),g=d.values,m=0;m<i.batchSize;++m)for(var v=m*n.strides[0],y=m*d.strides[0],b=0;b<i.outHeight;++b)for(var x=y+b*d.strides[1],w=b*i.strideHeight-l,S=0;S<a;++S){var C=w+S*s;if(!(C<0||C>=i.inHeight))for(var _=S*r.strides[0],E=v+C*n.strides[1],A=0;A<i.outWidth;++A)for(var k=x+A*d.strides[2],T=A*i.strideWidth-c,I=0;I<o;++I){var N=T+I*u;if(!(N<0||N>=i.inWidth))for(var O=_+I*r.strides[1],D=E+N*i.inChannels,L=k,W=O,G=0;G<i.inChannels;++G){for(var K=h[D+G],ee=0;ee<f;++ee)g[L+ee]+=K*p[W+ee];L+=f,W+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){ke([n,r],"depthwiseConv2DDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],g=d[2],m=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=i.batchSize,S=i.filterHeight,C=i.filterWidth,_=i.inChannels,E=i.inHeight,A=i.inWidth,k=i.outChannels,T=i.outHeight,I=i.outWidth,N=i.strideHeight,O=i.strideWidth,D=S-1-i.padInfo.top,L=C-1-i.padInfo.left,W=k/_,G=0;G<w;++G)for(var K=0;K<_;++K)for(var ee=0;ee<E;++ee)for(var ce=ee-D,he=Math.max(0,Math.ceil(ce/N)),Oe=Math.min(T,(S+ce)/N),Te=0;Te<A;++Te){for(var De=Te-L,me=Math.max(0,Math.ceil(De/O)),P=Math.min(I,(C+De)/O),F=0,V=he;V<Oe;++V)for(var ae=V*N-ce,Y=me;Y<P;++Y)for(var M=h*G+p*V+g*Y,B=y*(S-1-ae)+b*(C-1-(Y*O-De))+x*K,R=0;R<W;++R)F+=f[M+(K*W+R)]*m[B+R];o[u*G+l*ee+c*Te+K]=F}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){ke([n,r],"depthwiseConv2DDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=Ot(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,d=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((f-g)/a)),v=Math.min(i.outHeight,(i.inHeight+f-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/o)),x=Math.min(i.outWidth,(i.inWidth+c-y)/o),w=0;w<i.outChannels;++w){for(var S=Math.trunc(w/d),C=w%d,_=0,E=0;E<i.batchSize;++E)for(var A=m;A<v;++A)for(var k=g+A*a-f,T=b;T<x;++T){var I=y+T*o-c;_+=h.get(E,k,I,S)*p.get(E,A,T,w)}l.set(_,g,y,S,C)}return l.toTensor()},t.prototype.tile=function(n,r){return ke(n,"tile"),QX(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){ke(n,"pad");var a=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),o=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ot(a,n.dtype);i!==0&&u.values.fill(i);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+o[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.gather=function(n,r,i){ke([n,r],"gather");var a=n.shape.slice(),o=this.readSync(r.dataId);a[i]=o.length;for(var s=Ot(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[i]=o[c[i]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){ke([n],"batchToSpaceND");var a=r.reduce(function(f,d){return f*d}),o=OS(n.shape,r,a),s=IS(o.length,r.length),u=NS(n.shape,r,a),l=TX(i,r.length),c=OX(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){ke([n],"spaceToBatchND");var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=OS(u.shape,r,a,!1),c=IS(l.length,r.length,!1),f=NS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.maxPool=function(n,r){return ke(n,"maxPool"),BM(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"max").toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,a){ke([r,i],"maxPoolBackprop");for(var o=this.readSync(r.dataId),s=Ot(a.outShape,r.dtype,GZ(o,r.shape,r.dtype,a).values),u=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=h-1-a.padInfo.left,g=d-1-a.padInfo.top,m=Ot(r.shape,"float32"),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var x=0;x<a.inHeight;++x)for(var w=0;w<a.inWidth;++w){for(var S=x-g,C=w-p,_=0,E=0;E<d;E+=c){var A=(S+E)/u;if(!(A<0||A>=a.outHeight||Math.floor(A)!==A))for(var k=0;k<h;k+=f){var T=(C+k)/l;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var I=d*h-1-s.get(y,A,T,b)===E*h+k?1:0;I!==0&&(_+=v.get(y,A,T,b)*I)}}}m.set(_,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){ke([n,r],"avgPoolBackprop");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,g=Ot(r.shape,"float32"),m=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-p,C=w-h,_=0,E=0;E<f;E+=l){var A=(S+E)/a;if(!(A<0||A>=i.outHeight||Math.floor(A)!==A))for(var k=0;k<d;k+=c){var T=(C+k)/o;T<0||T>=i.outWidth||Math.floor(T)!==T||(_+=v.get(y,A,T,b))}}g.set(_*m,y,x,w,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,i){ke(n,"pool3d");for(var a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Ot(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],_=r.outShape[4],E=0;E<r.batchSize;++E)for(var A=E*w,k=E*n.strides[0],T=0;T<r.inChannels;++T)for(var I=0;I<r.outDepth;++I){for(var N=I*a-p,O=N;O<0;)O+=u;for(var D=Math.min(r.inDepth,f+N),L=A+I*S,W=0;W<r.outHeight;++W){for(var G=W*o-g,K=G;K<0;)K+=l;for(var ee=Math.min(r.inHeight,d+G),ce=L+W*C,he=0;he<r.outWidth;++he){for(var Oe=he*s-m,Te=Oe;Te<0;)Te+=c;for(var De=Math.min(r.inWidth,h+Oe),me=ce+he*_,P=v,F=0,V=0,ae=O;ae<D;ae+=u){for(var Y=k+ae*n.strides[1],M=K;M<ee;M+=l){for(var B=Y+M*n.strides[2],R=Te;R<De;R+=c){var X=y[B+R*n.strides[3]+T];if(i==="max"&&X>P?P=X:i==="avg"&&(F+=X,V++),isNaN(P))break}if(isNaN(P))break}if(isNaN(P))break}x[me+T]=i==="avg"?F/V:P}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return ke(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){ke([n,r],"avgPool3dBackprop");for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=m-1-i.padInfo.left,b=g-1-i.padInfo.top,x=Ot(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var _=0;_<i.inChannels;++_)for(var E=0;E<i.inDepth;++E)for(var A=0;A<i.inHeight;++A)for(var k=0;k<i.inWidth;++k){for(var T=E-v,I=A-b,N=k-y,O=0,D=0;D<p;D+=f){var L=(T+D)/a;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var W=0;W<g;W+=d){var G=(I+W)/o;if(!(G<0||G>=i.outHeight||Math.floor(G)!==G))for(var K=0;K<m;K+=h){var ee=(N+K)/s;ee<0||ee>=i.outWidth||Math.floor(ee)!==ee||(O+=S.get(C,L,G,ee,_))}}}x.set(O*w,C,E,A,k,_)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return ke(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=Ot(r.outShape,"int32"),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*a-p,S=w;S<0;)S+=u;for(var C=Math.min(r.inDepth,f+w),_=0;_<r.outHeight;++_){for(var E=_*o-g,A=E;A<0;)A+=l;for(var k=Math.min(r.inHeight,d+E),T=0;T<r.outWidth;++T){for(var I=T*s-m,N=I;N<0;)N+=c;for(var O=Math.min(r.inWidth,h+I),D=Number.NEGATIVE_INFINITY,L=-1,W=S;W<C;W+=u)for(var G=W-w,K=A;K<k;K+=l)for(var ee=K-E,ce=N;ce<O;ce+=c){var he=ce-I,Oe=v.get(y,W,K,ce,b);Oe>=D&&(D=Oe,L=G*d*h+ee*d+he)}i.set(L,y,x,_,T,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,a){ke([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=h-1-a.padInfo.front,v=g-1-a.padInfo.left,y=p-1-a.padInfo.top,b=Ot(r.shape,"float32"),x=this.bufferSync(o),w=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var C=0;C<a.inChannels;++C)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var A=0;A<a.inWidth;++A){for(var k=_-m,T=E-y,I=A-v,N=0,O=0;O<h;O+=c){var D=(k+O)/s;if(!(D<0||D>=a.outDepth||Math.floor(D)!==D))for(var L=0;L<p;L+=f){var W=(T+L)/u;if(!(W<0||W>=a.outHeight||Math.floor(W)!==W))for(var G=0;G<g;G+=d){var K=(I+G)/l;if(!(K<0||K>=a.outWidth||Math.floor(K)!==K)){var ee=h*p*g-1-x.get(S,D,W,K,C)===O*p*g+L*g+G?1:0;ee!==0&&(N+=w.get(S,D,W,K,C)*ee)}}}}b.set(N,S,_,E,A,C)}return b.toTensor()},t.prototype.cast=function(n,r){return V3(n,r,this)},t.prototype.reshape=function(n,r){return VS(n,r)},t.prototype.avgPool=function(n,r){return ke(n,"avgPool"),ke(n,"maxPool"),BM(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(n,r,i,a){ke(n,"resizeBilinear");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(et([s,r,i,c])),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=0,m=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=m*b,w=Math.floor(x),S=x-w,C=Math.min(u-1,Math.ceil(x)),_=y*n.strides[0]+w*n.strides[1],E=y*n.strides[0]+C*n.strides[1],A=0;A<i;A++)for(var k=v*A,T=Math.floor(k),I=k-T,N=Math.min(l-1,Math.ceil(k)),O=_+T*n.strides[2],D=E+T*n.strides[2],L=_+N*n.strides[2],W=E+N*n.strides[2],G=0;G<c;G++){var K=f[O+G],ee=f[D+G],ce=K+(f[L+G]-K)*I,he=ce+(ee+(f[W+G]-ee)*I-ce)*S;d[g++]=he}return Rr(d,[s,r,i,c])},t.prototype.resizeBilinearBackprop=function(n,r,i){ke([n,r],"resizeBilinearBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=[i&&f>1?s-1:s,i&&d>1?u-1:u],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],m=p[0]/g[0],v=p[1]/g[1],y=this.readSync(n.dataId),b=0,x=0;x<o;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var C=S*m,_=Math.floor(C),E=Math.min(Math.ceil(C),s-1),A=w+_*r.strides[1],k=w+E*r.strides[1],T=C-_,I=1-T,N=0;N<d;N++)for(var O=N*v,D=Math.floor(O),L=Math.min(Math.ceil(O),u-1),W=O-D,G=1-W,K=A+D*r.strides[2],ee=A+L*r.strides[2],ce=k+D*r.strides[2],he=k+L*r.strides[2],Oe=I*G,Te=I*W,De=T*G,me=T*W,P=0;P<l;P++){var F=y[b++];h[K+P]+=F*Oe,h[ee+P]+=F*Te,h[ce+P]+=F*De,h[he+P]+=F*me}return kf(h,[o,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,a){ke(n,"resizeNearestNeighbor");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*i*c),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=h[0]/p[0],m=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=g*x,S=b+Math.min(u-1,a?Math.round(w):Math.floor(w))*n.strides[1],C=0;C<i;C++)for(var _=m*C,E=S+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],A=0;A<c;A++){var k=f[E+A];d[v++]=k}return Rr(d,[s,r,i,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){ke([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=this.readSync(n.dataId),g=[i&&f>1?s-1:s,i&&d>1?u-1:u],m=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,C=0;C<o;C++)for(var _=C*r.strides[0],E=0;E<s;E++)for(var A=_+E*r.strides[1],k=Math.floor(E*b),T=Math.floor(k-w/2),I=0;I<u;I++)for(var N=A+I*r.strides[2],O=Math.floor(I*x),D=Math.floor(O-S/2),L=0;L<l;L++){for(var W=0,G=0;G<w;G++){var K=G+T;if(!(K<0||K>=f)){var ee=_+K*n.strides[1],ce=K*v;if(E===Math.min(s-1,i?Math.round(ce):Math.floor(ce)))for(var he=0;he<S;he++){var Oe=he+D;if(!(Oe<0||Oe>=d)){var Te=ee+Oe*n.strides[2],De=Oe*y;I===Math.min(u-1,i?Math.round(De):Math.floor(De))&&(W+=p[Te+L])}}}}h[N+L]=W}return kf(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){ke([n,r,i,o,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,g=f.length,m=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)h[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+a),y>=p&&(y=0),b>=v&&(b=0),x>=g&&(x=0),w>=m&&(w=0);return kf(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){ke(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(m){for(var v=m%s,y=m-v+Math.max(0,v-r),b=m-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var h=0;h<c;h++){var p=d(h),g=l[h]*Math.pow(i+a*p,-o);f[h]=g}return kf(f,n.shape)},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){ke(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,g=0;g<p;g++){for(var m=g%l,v=g-m+Math.max(0,m-a),y=g-m+Math.min(l,m+a+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+o,x=v;x<y;x++){var w=-2*s*u*f[x]*d[g]/b;g===x&&(w+=Math.pow(b,-u)),w*=c[g],h[x]+=w}}return kf(h,n.shape)},t.prototype.multinomial=function(n,r,i,a){ke(n,"multinomial");for(var o=r?n:Dh(n),s=o.shape[0],u=o.shape[1],l=Tn([s,i],"int32"),c=this.readSync(l.dataId),f=this.readSync(o.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var g=1;g<p.length;++g)p[g]=p[g-1]+f[h+g];for(var m=XS(a.toString()),v=d*i,y=0;y<i;++y){var b=m();c[v+y]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,i,a){ke(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(o[u*r+s[u]]=i);return Uu(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return ke(n,"nonMaxSuppression"),G3(this.readSync(n.dataId),this.readSync(r.dataId),i,a,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],a=n.shape[1],o=Ot(n.shape,"float32"),s=Ot(n.shape,"float32"),u=eo(n).as2D(i,a),l=is(n).as2D(i,a),c=0;c<i;c++)for(var f=u.slice([c,0],[1,a]),d=l.slice([c,0],[1,a]),h=ri(f,d),p=this.readSync(this.fftImpl(h,r).dataId),g=0;g<a;g++){var m=XX(p,g);o.values[c*a+g]=m.real,s.values[c*a+g]=m.imag}return ri(o.toTensor(),s.toTensor()).as2D(i,a)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),a=i.size;if(this.isExponentOf2(a)){var o=this.fftRadix2(i,a,r).as2D(n.shape[0],n.shape[1]);return r&&(o=ri(eo(o).div(Ve(a)),is(o).div(Ve(a)))),o}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,a,r));return ri(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var a=this.readSync(n.dataId),o=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),u=ri(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),c=ri(l.real,l.imag).as1D();u=this.fftRadix2(u,o,i),c=this.fftRadix2(c,o,i);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,i),d=ri(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),g=eo(h).concat(eo(p)),m=is(h).concat(is(p));return ri(g,m).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var a=new Float32Array(2*r),o=0;o<r;o++){for(var s=0,u=0,l=0;l<r;l++){var c=PMe(o*l,r,i),f=XX(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}i&&(s/=r,u/=r),MMe(a,s,u,o)}return a},t.prototype.depthToSpace=function(n,r,i){U(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],o=n.shape[1],s=n.shape[2],u=n.shape[3],l=o*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(a*l*c*f),p=0,g=0;g<a;++g)for(var m=0;m<l;++m)for(var v=Math.floor(m/r),y=m%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var C=S+w+u*(x+s*(v+o*g));h[p++]=d[C]}return kf(h,[a,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,i,a){var o=Qt(n.shape,r.shape),s=Ot(o,i),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ac(n.shape,o),f=ac(r.shape,o),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),g=this.bufferSync(r),m=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(C){return b[C]=0});var x=p.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(C){return w[C]=0});var S=g.locToIndex(w);d[v]=a(u[x],l[S])};for(h=0;h<d.length;++h)m(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var a=Qt(n.shape,r.shape),o=Ot(a,"float32"),s=Ot(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ac(n.shape,a),f=ac(r.shape,a),d=o.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var g=p%u.length,m=p%l.length,v=i(u[2*g],u[2*g+1],l[2*m],l[2*m+1]);d[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=o.indexToLoc(w),C=S.slice(-n.rank);c.forEach(function(T){return C[T]=0});var _=y.locToIndex(C),E=S.slice(-r.rank);f.forEach(function(T){return E[T]=0});var A=b.locToIndex(E),k=i(u[2*_],u[2*_+1],l[2*A],l[2*A+1]);d[w]=k.real,h[w]=k.imag};for(p=0;p<d.length;p++)x(p)}return this.complex(o.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return JX(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,a,o,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=a[0],g=a[1],m=Ot([h,p,g,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),x=n.strides,w=m.strides,S=0;S<h;S++){var C=4*S,_=v[C],E=v[C+1],A=v[C+2],k=v[C+3],T=y[S];if(!(T>=l))for(var I=p>1?(A-_)*(c-1)/(p-1):0,N=g>1?(k-E)*(f-1)/(g-1):0,O=0;O<p;O++){var D=p>1?_*(c-1)+O*I:.5*(_+A)*(c-1);if(D<0||D>c-1)for(var L=0;L<g;L++)for(var W=0;W<d;W++){var G=W+L*w[2]+O*w[1]+S*w[0];m.values[G]=s}else if(o==="bilinear"){var K=Math.floor(D),ee=Math.ceil(D),ce=D-K;for(L=0;L<g;L++)if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var he=Math.floor(ae),Oe=Math.ceil(ae),Te=ae-he;for(W=0;W<d;W++){var De=b[G=W+he*x[2]+K*x[1]+T*x[0]],me=b[G=W+Oe*x[2]+K*x[1]+T*x[0]],P=b[G=W+he*x[2]+ee*x[1]+T*x[0]],F=De+(me-De)*Te,V=P+(b[G=W+Oe*x[2]+ee*x[1]+T*x[0]]-P)*Te;G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=F+(V-F)*ce}}}else for(L=0;L<g;++L){var ae;if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var Y=Math.round(ae),M=Math.round(D);for(W=0;W<d;W++){var B=W+Y*x[2]+M*x[1]+T*x[0],R=W+L*w[2]+O*w[1]+S*w[0];m.values[R]=b[B]}}}}}return m.toTensor()},t.prototype.sparseToDense=function(n,r,i,a){var o=lb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(n,r,i,f,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=M3(n,r),s=o[0],u=o[1],l=o[2],c=o[3];if(u===0)return Rr([],s,n.dtype);for(var f=new _m([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var g=[],m=0,v=0;v<a;v++){var y=d[p*a+v];m+=y*c[v],g.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[p*l+b]=h[m*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var a=lb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=Ve(0);return this.scatter(n,r,i,c,u,s,o,l,f,!0)},t.prototype.fill=function(n,r,i){var a=Wy(i=i||xm(r),et(n));return a.fill(r),J.makeTensor(a,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Wy(n.dtype,et(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return q3(n,r,i)},t.prototype.scatter=function(n,r,i,a,o,s,u,l,c,f){var d=[a/o,o],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return Rr([],i,r.dtype);var g=new _m(d,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var v=[],y=0,b=0;b<u;b++){var x=h[m*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=a/o)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var w=0;w<o;w++)f?g.values[y*o+w]+=p[m*o+w]:g.values[y*o+w]=r.rank===0?p[0]:p[m*o+w]}return g.toTensor().reshape(i)},t}(j3);function KZ(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;ke([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,f=t(o.shape,s.shape,l,c,o.dtype),d=f[0],h=f[1];return{dataId:u.write(d,h,o.dtype),shape:h,dtype:o.dtype}}}}function XZ(e){return function(t,n,r,i,a){var o=Qt(t,n),s=o.length,u=Ja(o),l=Oh(a,et(o)),c=t.length,f=n.length,d=Ja(t),h=Ja(n),p=ac(t,o),g=ac(n,o);if(p.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],i[m%i.length]);else{var v=function(y){var b=LF(y,s,u),x=b.slice(-c);p.forEach(function(_){return x[_]=0});var w=dS(x,c,d),S=b.slice(-f);g.forEach(function(_){return S[_]=0});var C=dS(S,f,h);l[y]=e(r[w],i[C])};for(m=0;m<l.length;++m)v(m)}return[l,o]}}J.registerBackend("cpu",function(){return new Y$e},1);var Z$e=XZ(function(e,t){return e/t}),J$e=KZ(ab,Z$e),Q$e={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;ke(i,"MaxPoolWithArgmax");var f=c.data.get(i.dataId).values,d=Nf(i.shape,o,s,[1,1],u),h=function(y,b,x,w,S){var C=BM(y,0,x,Ja(b),S,"max"),_=GZ(y,b,x,S,!0,w);return[C.values,_.values]}(f,i.shape,i.dtype,l,d),p=h[0],g=h[1],m=c.write(p,d.outShape,i.dtype),v=c.write(g,d.outShape,i.dtype);return[{dataId:m,shape:d.outShape,dtype:i.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}},e4e={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;ke(a,"NonMaxSuppressionWithScore");var h=K3(d.data.get(a.dataId).values,d.data.get(o.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},t4e={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;ke(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},n4e=XZ(function(e,t){var n=e-t;return n*n});function YZ(e,t,n,r,i){for(var a=et(t),o=t.length,s=Ja(t),u=Ja(i),l=Oh(n,et(i)),c=0;c<a;++c){for(var f=LF(c,o,s),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];l[dS(d,o,u)]=e[c]}return l}for(var jM=0,ZZ=[e4e,t4e,KZ(ob,n4e),J$e,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n.perm,o=r;ke(i,"transpose");for(var s=i.shape.length,u=new Array(s),l=0;l<u.length;l++)u[l]=i.shape[a[l]];var c=YZ(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(c,u,i.dtype),shape:u,dtype:i.dtype}}},Q$e];jM<ZZ.length;jM++)OF(ZZ[jM]);for(var Bm,r4e=function(e){this.variableNames=["A"];var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},i4e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `},a4e=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Zn(this.rank),a=function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<o.length;c++)l[o[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},o4e=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Zn(this.rank),a=tY("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},UM=0,JZ=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,a=r.numChannels,o=typeof HTMLVideoElement!="undefined"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],f=[c,l],d=[c,l,a];(s||o)&&(Bm==null&&(Bm=document.createElement("canvas").getContext("2d")),Bm.canvas.width=l,Bm.canvas.height=c,Bm.drawImage(i,0,0,l,c),i=Bm.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=To.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=pe().getBool("WEBGL_PACK")?new i4e(d):new r4e(d),g=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:ab,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(i,a,o){var s=new Ar(nPe,i.shape,a.shape);return pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(s=new qu(rPe,i.shape,a.shape,!0)),o.runWebGLProgram(s,[i,a],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;SS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=K3(d.readSync(a.dataId),d.readSync(o.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,a=new Pt(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:ob,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,a=r.b,o=n,s=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu("return (a - b) * (a - b);",i.shape,a.shape):new Ar("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,i=e.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=a.shape[o[c]];if(s.shouldExecuteOnCPU([a])){var f=YZ(s.texData.get(a.dataId).values,a.shape,a.dtype,o,l);t=s.makeTensorInfo(l,a.dtype),s.texData.get(t.dataId).values=f}else t=function(d,h,p){var g=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new o4e(d.shape,h):new a4e(d.shape,h);return p.runWebGLProgram(g,[d],d.dtype)}(a,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;U(i.shape.length===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."});var f=[1,1];U(Gi(s,f),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"});var d=Nf(i.shape,o,s,f,u),h=function(p,g,m,v){var y=new gb(m,"max",!1),b=v.runWebGLProgram(y,[p],"float32");return y=new gb(m,"max",!0,!0,g),[b,v.runWebGLProgram(y,[p],"float32")]}(i,l,d,c);return[h[0],h[1]]}}];UM<JZ.length;UM++)OF(JZ[UM]);for(var WM=0,QZ=[{kernelName:u3,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=e,o=Vr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var a=e,o=Vr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach(function(r,i){n[i]=function(){return e.clone()}}),n}},{kernelName:l3,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(i[s]!==1)throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:ab,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=Cr(e,r.toFloat()),o=Vr(n.shape,i);return o.length>0?qr(a,o).reshape(n.shape):a},b:function(){var a=e.mul(n.toFloat()),o=Vr(r.shape,i);o.length>0&&(a=qr(a,o).reshape(r.shape));var s=nE(r);return If(Cr(a,s.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,i=t[0],a=t[1],o=t[2],s=t[3],u=GY(i),l=s??Ve(1),c=Vr(a.shape,u.shape),f=[];if(a.rank===1){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var h=Er(i,a),p=rt(e,l),g=RS(Wt(o,Ve(r))),m=rt(rt(rt(g,g),g),Ve(-.5));return{x:function(){return a.rank===1?Us(rt(rt(e,sc(g.as4D(1,1,1,a.shape[0]),f)),l),i.shape):Us(rt(rt(e,g),l),i.shape)},mean:function(){var v=rt(rt(g,Ve(-1)),p);return a.rank===1&&(v=qr(v,c)),Us(v,a.shape)},variance:function(){var v=rt(rt(m,h),p);return a.rank===1&&(v=qr(v,c)),Us(v,a.shape)},scale:function(){var v=rt(h,g),y=rt(e,v);return a.rank===1&&(y=qr(y,c)),Us(y,a.shape)},offset:function(){var v=e;return a.rank===1&&(v=qr(v,c)),Us(v,a.shape)}}}},{kernelName:f3,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:c3,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Tn(n.shape,"float32")}}}},{kernelName:h3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map(function(a){return a[0]});return{x:function(){return e.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:ob,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Ve(2);return{a:function(){return rt(e,rt(i,Er(n,r)))},b:function(){return rt(e,rt(i,Er(r,n)))}}}},{kernelName:d3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.reps;return{x:function(){var a=en(r);if(r.rank===1)for(var o=0;o<i[0];++o)a=a.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(o=0;o<i[0];++o)for(var s=0;s<i[1];++s)a=a.add(e.slice([o*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(var u=0;u<i[2];++u)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(r.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(u=0;u<i[2];++u)for(var l=0;l<i[3];++l)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2],l*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return a}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=ES(n.perm);return{x:function(){return cn(e,r)}}}}];WM<QZ.length;WM++)NK(QZ[WM]);var s4e=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();pe().get("IS_BROWSER")&&pe().setPlatform("browser",new s4e);var VM,u4e=function(){return require("node-fetch")},l4e=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return pe().global.fetch!=null?pe().global.fetch(t,n):(VM==null&&(VM=u4e()),VM(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();pe().get("IS_NODE")&&pe().setPlatform("node",new l4e);var qM={float32:4,int32:4,uint16:2,uint8:1,bool:1},SE=4;function eJ(e,t){for(var n={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,f=et(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=qM[h.dtype],g=e.slice(r,r+f*p),m=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")d=Float32Array.from(m,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(m,function(S){return Math.round(S*h.scale+h.min)})}r+=f*p}else if(l==="string"){var v=et(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+SE))[0];r+=SE;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=qM[l];if(g=e.slice(r,r+f*w),l==="float32")d=new Float32Array(g);else if(l==="int32")d=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(g)}r+=f*w}n[u]=Rr(d,c,l)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function c4e(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var HM=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function tJ(e){return HM?Buffer.byteLength(e):new Blob([e]).size}function GM(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function nJ(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function kb(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:tJ(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:tJ(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Fo=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var o=a(t,r);o!==null&&i.push(o)}),i},e}(),zm="://",$f=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){U(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(zm)&&(t=t.slice(0,t.indexOf(zm))),U(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();U(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function EE(e){if(e.indexOf(zm)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+$f.getSchemes().join(","));return{scheme:e.split(zm)[0],path:e.split(zm)[1]}}function rJ(e,t,n){return n===void 0&&(n=!1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return U(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),U((r=Fo.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),U(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],U((a=Fo.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),U(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=a[0],s=EE(e).scheme,u=EE(e).path,l=s===EE(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,$f.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,$f.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Wh="models_store",Lf="model_info_store";function iJ(){if(!pe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function KM(e){var t=e.result;t.createObjectStore(Wh,{keyPath:"modelPath"}),t.createObjectStore(Lf,{keyPath:"modelPath"})}var jm=function(){function e(t){if(this.indexedDB=iJ(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,a){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return KM(o)},o.onsuccess=function(){var s=o.result;if(n==null){var u=s.transaction(Wh,"readonly"),l=u.objectStore(Wh).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=kb(n),d=s.transaction(Lf,"readwrite"),h=d.objectStore(Lf),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var g=(c=s.transaction(Wh,"readwrite")).objectStore(Wh).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});g.onsuccess=function(){return i({modelArtifactsInfo:f})},g.onerror=function(m){var v=(h=d.objectStore(Lf)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(g.error)},v.onerror=function(y){return s.close(),a(g.error)}}},p.onerror=function(g){return s.close(),a(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return a(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),aJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(jm.URL_SCHEME)?(t=e.slice(jm.URL_SCHEME.length),new jm(t)):null;var t};Fo.registerSaveRouter(aJ),Fo.registerLoadRouter(aJ);var f4e=function(){function e(){this.indexedDB=iJ()}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t=this;return nt(this,function(n){return[2,new Promise(function(r,i){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return KM(a)},a.onsuccess=function(){var o=a.result,s=o.transaction(Lf,"readonly"),u=s.objectStore(Lf).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return o.close(),i(u.error)},s.oncomplete=function(){return o.close()}},a.onerror=function(o){return i(a.error)}})]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){var i;return t=(i=t).startsWith(jm.URL_SCHEME)?i.slice(jm.URL_SCHEME.length):i,[2,new Promise(function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return KM(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Lf,"readwrite"),f=c.objectStore(Lf),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var g=(u=l.transaction(Wh,"readwrite")).objectStore(Wh).delete(t);g.onsuccess=function(){return a(d.result.modelArtifactsInfo)},g.onerror=function(m){return o(d.error)}};h.onsuccess=p,h.onerror=function(g){return p(),l.close(),o(d.error)}},d.onerror=function(h){return l.close(),o(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}})]})})},e}();if(pe().getBool("IS_BROWSER"))try{$f.registerManager(jm.URL_SCHEME,new f4e)}catch(e){}var lc="/",Um="tensorflowjs_models",oJ="info",d4e="model_topology",h4e="weight_specs",p4e="weight_data",g4e="model_metadata";function sJ(e){return{info:[Um,e,oJ].join(lc),topology:[Um,e,d4e].join(lc),weightSpecs:[Um,e,h4e].join(lc),weightData:[Um,e,p4e].join(lc),modelMetadata:[Um,e,g4e].join(lc)}}function m4e(e){var t=e.split(lc);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(lc)}var Wm=function(){function e(t){if(!pe().getBool("IS_BROWSER")||typeof window=="undefined"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=sJ(this.modelPath)}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=kb(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(HM)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return nt(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(HM){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),uJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Wm.URL_SCHEME)?(t=e.slice(Wm.URL_SCHEME.length),new Wm(t)):null;var t};Fo.registerSaveRouter(uJ),Fo.registerLoadRouter(uJ);var v4e=function(){function e(){U(pe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),U(typeof window=="undefined"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o;return nt(this,function(s){for(t={},n=Um+lc,r=lc+oJ,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(o=m4e(a),t[o]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){var a;if(t=(a=t).startsWith(Wm.URL_SCHEME)?a.slice(Wm.URL_SCHEME.length):a,n=sJ(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(pe().getBool("IS_BROWSER"))try{$f.registerManager(Wm.URL_SCHEME,new v4e)}catch(e){}var y4e="model",b4e=".json",x4e=".weights.bin";function lJ(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var XM=function(){function e(t){if(!pe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=y4e),this.modelTopologyFileName=t+b4e,this.weightDataFileName=t+x4e}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s;return nt(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=a,[4,lJ(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,lJ(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:kb(t)}]}})})},e.URL_SCHEME="downloads://",e}(),w4e=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r=this;return nt(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(m){return void o(m)}var h=[],p=[],g=[];f.forEach(function(m){m.paths.forEach(function(v){p.push(v),g.push(null)}),h.push.apply(h,m.weights)}),f.forEach(function(m){m.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=p.indexOf(v);g[w]=x,g.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:GM(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return nJ(u.name)}),a={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(u){var l=nJ(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[i.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function cJ(e,t,n,r){(function(a){U(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,o){U(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),U(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),U(o>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+o})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(a){return a.then(function(o){var s=n+ ++i/e.length*(r-n);return t(s),o}),a}))}function fJ(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return nt(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?pe().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),i=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,cJ(r,t.onProgress,i,a)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,cJ(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function dJ(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),tt(t,void 0,void 0,function(){var a,o,s,u,l,c,f,d,h,p;return nt(this,function(g){switch(g.label){case 0:if(a=n.map(function(){return!1}),o={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(m,v){var y=0;m.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=qM[x]*et(b.shape),S=function(){a[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};i!=null?i.forEach(function(C,_){C===b.name&&(S(),s[_]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(m){return m}))throw l=i.filter(function(m,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(m,v,y){return v&&m.push(y),m},[]),f=[],c.forEach(function(m){n[m].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=g.sent(),h={},p=0,c.forEach(function(m){for(var v=n[m].paths.length,y=0,b=0;b<v;b++)y+=d[p+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,C=0;C<v;C++){var _=new Uint8Array(d[p+C]);w.set(_,S),S+=_.byteLength}o[m].forEach(function(E){var A=eJ(x.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var k in A)h[k]=A[k]}),p+=v}),[2,h]}})})}}Fo.registerSaveRouter(function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(XM.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new XM(t)}(e.slice(XM.URL_SCHEME.length)):null});var hJ=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=pe().platform.fetch,U(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&U(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a;return nt(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:kb(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,i==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var g=p.lastIndexOf("/"),m=p.lastIndexOf("?"),v=p.substring(0,g),y=m>g?p.substring(m):"";return[v+"/",y]}(n),i=r[0],a=r[1],o=this.weightPathPrefix||i,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(g){f.push(o+g+a)})}),[4,fJ(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,GM(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function YM(e){return e.match(hJ.URL_SCHEME_REGEX)!=null}var pJ=function(e,t){return typeof fetch=="undefined"?null:(Array.isArray(e)?e.every(function(n){return YM(n)}):YM(e))?ZM(e,{onProgress:t}):null};function ZM(e,t){return new hJ(e,t)}Fo.registerSaveRouter(pJ),Fo.registerLoadRouter(pJ);var JM=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.modelArtifacts]})})},e}(),_4e=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,this.saveHandler(t)]})})},e}(),wa=Object.freeze({browserFiles:function(e){return new w4e(e)},browserHTTPRequest:function(e,t){return ZM(e,t)},concatenateArrayBuffers:GM,decodeWeights:eJ,encodeWeights:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s=this;return nt(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=i[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return tt(s,void 0,void 0,function(){var g,m,v,y,b,x,w;return nt(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(g=S.sent(),m=g.reduce(function(C,_){return C+_.length},0)+SE*g.length,v=new Uint8Array(m),y=0,b=0;b<g.length;b++)x=g[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=SE,v.set(x,y),y+=x.length;return p(v),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:c4e(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new JM(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new JM({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new JM({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Fo.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:kb,getSaveHandlers:function(e){return Fo.getSaveHandlers(e)},http:ZM,isHTTPScheme:YM,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),tt(this,void 0,void 0,function(){return nt(this,function(i){return[2,dJ(function(a){return fJ(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Fo.registerLoadRouter(e)},registerSaveRouter:function(e){return Fo.registerSaveRouter(e)},weightsLoaderFactory:dJ,withSaveHandler:function(e){return new _4e(e)},copyModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,rJ(e,t,!1)]})})},listModels:function(){return tt(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return nt(this,function(s){switch(s.label){case 0:e=$f.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,$f.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+zm+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,rJ(e,t,!0)]})})},removeModel:function(e){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){return t=EE(e),[2,$f.getManager(t.scheme).removeModel(t.path)]})})}}),Vm,S4e=Q({confusionMatrix_:function(e,t,n){var r=j(e,"labels","confusionMatrix"),i=j(t,"predictions","confusionMatrix");U(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),U(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),U(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),U(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),U(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=Bh(r.asType("int32"),n),o=Bh(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),E4e=Object.freeze({confusionMatrix:S4e}),C4e=Q({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement!="undefined"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(AF("FromPixels",J.backendName)!=null)return J.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(o?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(a||i)&&(Vm==null&&(Vm=document.createElement("canvas").getContext("2d")),Vm.canvas.width=c,Vm.canvas.height=f,Vm.drawImage(e,0,0,c,f),s=Vm.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return CS(u,[f,c,t],"int32")}}),gJ=Object.freeze({toPixels:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return nt(this,function(E){switch(E.label){case 0:if(n=j(e,"img","toPixels"),e instanceof Ht||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=E.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=E.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(g=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(a*i*4),v=0;v<i*a;++v)y=void 0,b=void 0,x=void 0,w=void 0,o===1?(y=s[v]*g,b=s[v]*g,x=s[v]*g,w=255):o===3?(y=s[3*v]*g,b=s[3*v+1]*g,x=s[3*v+2]*g,w=255):o===4&&(y=s[4*v]*g,b=s[4*v+1]*g,x=s[4*v+2]*g,w=s[4*v+3]*g),m[(S=4*v)+0]=Math.round(y),m[S+1]=Math.round(b),m[S+2]=Math.round(x),m[S+3]=Math.round(w);return t!=null&&(t.width=a,t.height=i,C=t.getContext("2d"),_=new ImageData(m,a,i),C.putImageData(_,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:C4e}),mJ=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),vJ=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Bf(e){U(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),U(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),U(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),vJ.register(e)}var Ne=Object.freeze({Serializable:mJ,SerializationMap:vJ,registerClass:Bf}),A4e="1.7.4",k4e=Object.freeze({gpgpu_util:NPe,webgl_util:iMe,forceHalfFloat:function(){pe().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:HY,setWebGLContext:XK,GPGPUContext:OY}),cc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ls(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var a=this.computeGradients(n,i),o=a.value,s=a.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ut(s),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return KX(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Ut(this.iterations_)},t.prototype.saveIterations=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ve(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(mJ);Object.defineProperty(cc,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var QM=function(e){function t(n,r,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],i==null&&(a.epsilon=J.backend.epsilon()),a}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accum_grad",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:i+"/accum_var",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;le(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(o);o.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ut(this.accumulatedGrads.map(function(n){return n.variable})),Ut(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(cc);Bf(QM);var eP=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accumulator",variable:le(function(){return Sm(o.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable;le(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(J.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Ut(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(cc);Bf(eP);var tP=function(e){function t(n,r,i,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=i,o.epsilon=a,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],le(function(){o.accBeta1=Ve(r).variable(),o.accBeta2=Ve(i).variable()}),a==null&&(o.epsilon=J.backend.epsilon()),o}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Er(1,r.accBeta1),o=Er(1,r.accBeta2);i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:le(function(){return en(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:le(function(){return en(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(a),m=p.div(o);f.assign(h),d.assign(p);var v=g.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Ut(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r,i=this;return nt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),le(function(){i.accBeta1.assign(Am(i.beta1,i.iterations_+1)),i.accBeta2.assign(Am(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(cc);Bf(tP);var nP=function(e){function t(n,r,i,a,o){a===void 0&&(a=null),o===void 0&&(o=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=a,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],le(function(){s.iteration=Ve(0).variable(),s.accBeta1=Ve(r).variable()}),a==null&&(s.epsilon=J.backend.epsilon()),s}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Er(1,r.accBeta1),o=Cr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:en(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:en(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),g=c.abs(),m=p.maximum(g);f.assign(h),d.assign(m);var v=o.div(a).mul(h.div(m.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Ut(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(cc);Bf(nP);var CE=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=Array.isArray(n)?n[a].tensor:n[i];if(o!=null){var s=J.registeredVariables[i];le(function(){var u=r.c.mul(o).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=zu(Ve(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(cc);Bf(CE);var rP=function(e){function t(n,r,i){i===void 0&&(i=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Ve(a.momentum),a}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulations[a]==null&&(r.accumulations[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[i];u!=null&&le(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),s.assign(c),o.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ut(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(CE);Bf(rP);var iP=function(e){function t(n,r,i,a,o){r===void 0&&(r=.9),i===void 0&&(i=0),a===void 0&&(a=null),o===void 0&&(o=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,a==null&&(s.epsilon=J.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Ls(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:i+"/rms",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:i+"/mg",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;le(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[a].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=o.sub(h);o.assign(p)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(h),p=o.sub(h),o.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ut(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ut(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Ut(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(cc);Bf(iP);var Vh=function(){function e(){}return e.sgd=function(t){return new CE(t)},e.momentum=function(t,n,r){return r===void 0&&(r=!1),new rP(t,n,r)},e.rmsprop=function(t,n,r,i,a){return n===void 0&&(n=.9),r===void 0&&(r=0),i===void 0&&(i=null),a===void 0&&(a=!1),new iP(t,n,r,i,a)},e.adam=function(t,n,r,i){return t===void 0&&(t=.001),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new tP(t,n,r,i)},e.adadelta=function(t,n,r){return t===void 0&&(t=.001),n===void 0&&(n=.95),r===void 0&&(r=null),new QM(t,n,r)},e.adamax=function(t,n,r,i,a){return t===void 0&&(t=.002),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),a===void 0&&(a=0),new nP(t,n,r,i,a)},e.adagrad=function(t,n){return n===void 0&&(n=.1),new eP(t,n)},e}(),zf={sgd:Vh.sgd,momentum:Vh.momentum,adadelta:Vh.adadelta,adagrad:Vh.adagrad,rmsprop:Vh.rmsprop,adamax:Vh.adamax,adam:Vh.adam},T4e=typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(e){return e()};function AE(){return new Promise(function(e){return T4e(function(){return e()})})}Ht.prototype.add=function(e){return Wt(this,e)},Ht.prototype.broadcastTo=function(e){return uM(this,e)},Ht.prototype.div=function(e){return Cr(this,e)},Ht.prototype.divNoNan=function(e){return eE(this,e)},Ht.prototype.squaredDifference=function(e){return rE(this,e)},Ht.prototype.tile=function(e){return sc(this,e)},Ht.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),Bh(this,e,t,n)},Ht.prototype.transpose=function(e){return cn(this,e)},Ht.prototype.pad=function(e,t){return Gu(this,e,t)},Ht.prototype.batchNorm=function(e,t,n,r,i){return Lh(this,e,t,n,r,i)},ye=X$e;var O4e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:QM,AdagradOptimizer:eP,AdamOptimizer:tP,AdamaxOptimizer:nP,Add:u3,AddN:xMe,BroadcastTo:l3,DataStorage:z3,Div:ab,get ENV(){return CF},Environment:IK,FromPixels:CMe,FusedBatchNorm:wMe,Identity:f3,KernelBackend:j3,MaxPoolWithArgmax:AMe,MomentumOptimizer:rP,NonMaxSuppressionV5:EMe,OneHot:c3,Optimizer:cc,PadV2:h3,RMSPropOptimizer:iP,get Rank(){return zF},get Reduction(){return Ri},SGDOptimizer:CE,Square:_Me,SquaredDifference:ob,Tensor:Ht,TensorBuffer:_m,Tile:d3,Transpose:SMe,Variable:Ky,abs:Of,acos:p3,acosh:g3,add:Wt,addN:iM,addStrict:MX,all:hE,any:wb,argMax:_b,argMin:SM,asin:m3,asinh:v3,atan:y3,atan2:R3,atanh:b3,avgPool:lE,avgPool3d:fE,backend:xX,backend_util:FMe,basicLSTMCell:$Z,batchNorm:Lh,batchNorm2d:aM,batchNorm3d:oM,batchNorm4d:sM,batchNormalization:XY,batchNormalization2d:ZY,batchNormalization3d:QY,batchNormalization4d:tZ,batchToSpaceND:AS,booleanMaskAsync:bZ,broadcastTo:uM,browser:gJ,buffer:Ot,cast:kS,ceil:x3,clipByValue:xa,clone:nZ,complex:ri,concat:Hi,concat1d:n3,concat2d:r3,concat3d:i3,concat4d:a3,conv1d:iE,conv2d:Uh,conv2dTranspose:oE,conv3d:aE,conv3dTranspose:CZ,cos:w3,cosh:_3,cumsum:kX,customGrad:cb,deprecationWarn:wS,depthToSpace:o3,depthwiseConv2d:Mm,diag:jZ,disableDeprecationWarnings:sMe,dispose:Ut,disposeVariables:uMe,div:Cr,divNoNan:eE,divStrict:PX,dot:AZ,dropout:NM,elu:$m,enableDebugMode:oMe,enableProdMode:aMe,engine:lMe,env:pe,equal:jh,equalStrict:fZ,erf:S3,exp:E3,expandDims:Do,expm1:C3,eye:tE,fft:Cb,fill:Sm,findBackend:mMe,findBackendFactory:vMe,floor:DS,floorDiv:PS,frame:wE,fused:Pf,gather:Fm,gatherND:IM,gather_util:kMe,getBackend:pMe,getGradient:kF,getKernel:AF,getKernelsForBackend:TF,grad:IMe,grads:NMe,greater:Dm,greaterEqual:yb,greaterEqualStrict:dZ,greaterStrict:hZ,hammingWindow:DM,hannWindow:xE,ifft:Lm,imag:is,image:Mf,inTopKAsync:VZ,io:wa,irfft:yE,isFinite:RX,isInf:DX,isNaN:NX,keep:zu,leakyRelu:mE,less:mM,lessEqual:vM,lessEqualStrict:pZ,lessStrict:gZ,linalg:FM,linspace:t3,localResponseNormalization:CM,log:oc,log1p:A3,logSigmoid:IX,logSoftmax:jS,logSumExp:PZ,logicalAnd:Hu,logicalNot:lM,logicalOr:JS,logicalXor:rZ,losses:qZ,matMul:sE,math:E4e,max:Rf,maxPool:uE,maxPool3d:cE,maxPoolWithArgmax:_M,maximum:Vu,maximumStrict:$X,mean:Fr,memory:_S,min:pE,minimum:Cm,minimumStrict:LX,mod:F3,modStrict:BX,moments:Sb,movingAverage:BZ,mul:rt,mulStrict:$S,multiRNNCell:LZ,multinomial:cM,neg:If,nextFrame:AE,norm:AM,notEqual:Rm,notEqualStrict:mZ,oneHot:Bh,ones:Wu,onesLike:No,op:Q,outerProduct:kZ,pad:Gu,pad1d:iZ,pad2d:aZ,pad3d:oZ,pad4d:sZ,pool:FZ,pow:Am,powStrict:zX,prelu:Eb,print:AX,prod:gE,profile:cMe,rand:uZ,randomGamma:cZ,randomNormal:gM,randomUniform:zh,range:Em,ready:hMe,real:eo,reciprocal:k3,registerBackend:yMe,registerGradient:NK,registerKernel:OF,relu:Ff,relu6:EM,removeBackend:gMe,reshape:Us,reverse:Ku,reverse1d:TZ,reverse2d:OZ,reverse3d:IZ,reverse4d:NZ,rfft:Ab,round:T3,rsqrt:RS,scalar:Ve,scatterND:OM,scatter_util:TMe,selu:vE,separableConv2d:wM,serialization:Ne,setBackend:dMe,setPlatform:bMe,setdiff1dAsync:s3,sigmoid:FS,sign:O3,signal:WZ,sin:I3,sinh:N3,slice:Ro,slice1d:bb,slice2d:dE,slice3d:xb,slice4d:Pm,slice_util:OMe,softmax:Dh,softplus:sb,spaceToBatchND:TS,sparseToDense:bE,spectral:zZ,split:ic,sqrt:ub,square:nE,squaredDifference:rE,squaredDifferenceStrict:jX,squeeze:ib,stack:as,step:FX,stft:RM,stridedSlice:kM,sub:Er,subStrict:UX,sum:qr,sumOutType:hS,tan:D3,tanh:MS,tensor:Rr,tensor1d:ba,tensor2d:Uu,tensor3d:CS,tensor4d:kf,tensor5d:EX,tensor6d:CX,tensor_util:Lu,test_util:C$e,tidy:le,tile:sc,time:fMe,topk:TM,train:zf,transpose:cn,truncatedNormal:vb,unregisterGradient:X3e,unregisterKernel:K3e,unsortedSegmentSum:yM,unstack:Tf,util:pt,valueAndGrad:DMe,valueAndGrads:RMe,variable:e3,variableGrads:KX,version_core:A4e,webgl:k4e,where:Vs,whereAsync:QS,zeros:Tn,zerosLike:en});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var yJ=function(e,t){return(yJ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ee(e,t){function n(){this.constructor=e}yJ(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var aP,Tb=function(){return(Tb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function At(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function St(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Hr(){return aP==null&&(aP=xX().epsilon()),aP}function qs(){return"channelsLast"}var qh=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),Xu=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),ie=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),$t=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),I4e=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error);(function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t})(Error);function Hh(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function Yu(e,t){if(!e)throw new I4e(t)}function bJ(e,t){for(var n=0,r=0,i=e;r<i.length;r++)i[r]===t&&n++;return n}function _a(e){return e.length===1?e[0]:e}function Jn(e){return Array.isArray(e)?e:[e]}function fc(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Gh(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,function(t,n){return n.toUpperCase()})}var os={};function oP(e){if(e==null)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function sP(e){if(e!=null&&typeof e=="object")if(Array.isArray(e))e.forEach(function(a){return sP(a)});else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?sP(i):e[r]=i.value)}}function Ob(e,t,n,r,i){var a,o,s;if(t===void 0&&(t={}),n===void 0&&(n={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof e=="string"){var u=e,l=void 0;if(u in n)l=n[u];else if(u in os)l=os[u];else if((l=t[u])==null)throw new ie("Unknown "+r+": "+e+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=e;if(c.className==null||c.config==null)throw new ie(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var f=c.className,d=void 0,h=void 0;if(f in n?(d=(a=n[f])[0],h=a[1]):f in os?(d=(o=os.className)[0],h=o[1]):f in t&&(d=(s=t[f])[0],h=s[1]),d==null)throw new ie("Unknown "+r+": "+f+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(h!=null){for(var p={},g=0,m=Object.keys(os);g<m.length;g++)p[S=m[g]]=os[S];for(var v=0,y=Object.keys(n);v<y.length;v++)p[S=y[v]]=n[S];c.config.customObjects=p;for(var b=Tb({},os),x=0,w=Object.keys(n);x<w.length;x++){var S=w[x];os[S]=n[S]}sP(c.config);var C=h(d,c.config,n,i);return os=Tb({},b),C}b=Tb({},os);for(var _=0,E=Object.keys(n);_<E.length;_++)S=E[_],os[S]=n[S];return C=new d(c.config),os=Tb({},b),C}function N4e(e,t){return e<t?-1:e>t?1:0}function kE(e,t){return-1*N4e(e,t)}function jf(e){if(e==null)return e;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)===-1&&t.push(i)}return t}function D4e(e){if(e==null)throw new ie("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function qm(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new ie(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function uP(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=1/0),Yu(n>=0),Yu(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(function(i){return typeof i===t})}function Sa(e,t){Array.isArray(e)?(pt.assert(e.length>0,function(){return t+" is unexpectedly an empty array."}),e.forEach(function(n,r){return Sa(n,"element "+(r+1)+" of "+t)})):pt.assert(Number.isInteger(e)&&e>0,function(){return"Expected "+t+" to be a positive integer, but got "+xJ(e)+"."})}function xJ(e){return e===null?"null":Array.isArray(e)?"["+e.map(function(t){return xJ(t)}).join(",")+"]":typeof e=="string"?'"'+e+'"':""+e}function R4e(e,t){var n,r=pt.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=pt.now();return o-r<t?n:(r=o,n=e.apply(void 0,i))}}function wJ(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}function lP(e,t){return le(function(){return ub(qr($S(e,e),t,!0))})}var Ib=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),_J=function(e){function t(n){var r=e.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=lP(n,r.axis),a=xa(i,0,r.maxValue);return rt(n,Cr(a,Wt(Hr(),i)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(Ib);Ne.registerClass(_J);var SJ=function(e){function t(n){var r=e.call(this)||this;return r.defaultAxis=0,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){return Cr(n,Wt(Hr(),lP(n,r.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(Ib);Ne.registerClass(SJ);var EJ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Ff(n)},t.className="NonNeg",t}(Ib);Ne.registerClass(EJ);var CJ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=n.minValue!=null?n.minValue:r.defaultMinValue,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.rate=n.rate!=null?n.rate:r.defaultRate,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=lP(n,r.axis),a=Wt(rt(r.rate,xa(i,r.minValue,r.maxValue)),rt(1-r.rate,i));return rt(n,Cr(a,Wt(Hr(),i)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(Ib);Ne.registerClass(CJ);var AJ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ln(e){return oP(e)}function kJ(e,t){return t===void 0&&(t={}),Ob(e,Ne.SerializationMap.getMap().classNameMap,t,"constraint")}function Gr(e){return e==null?null:typeof e=="string"?kJ({className:e in AJ?AJ[e]:e,config:{}}):e instanceof Ib?e:kJ(e)}function F4e(e){return new _J(e)}function M4e(e){return new SJ(e)}function P4e(){return new EJ}function $4e(e){return new CJ(e)}Object.freeze({maxNorm:F4e,unitNorm:M4e,nonNeg:P4e,minMaxNorm:$4e});var L4e=["channelsFirst","channelsLast"],B4e=["valid","same","causal"],z4e=["max","avg"],j4e=["sum","mul","concat","ave"],Hm=new Map;function Kr(e){qm(L4e,"DataFormat",e)}function ss(e){qm(B4e,"PaddingMode",e)}function TJ(e){qm(z4e,"PoolMode",e)}var Nb=[],OJ="/";function Kh(e,t){Nb.push(e);try{var n=t();return Nb.pop(),n}catch(r){throw Nb.pop(),r}}function U4e(){return Nb.length===0?"":Nb.join(OJ)+OJ}function IJ(e){if(!DJ(e))throw new Error("Not a valid tensor name: '"+e+"'");return U4e()+e}function NJ(e){if(!DJ(e))throw new Error("Not a valid tensor name: '"+e+"'");Hm.has(e)||Hm.set(e,0);var t=Hm.get(e);if(Hm.set(e,Hm.get(e)+1),t>0){var n=e+"_"+t;return Hm.set(n,1),n}return e}var W4e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function DJ(e){return!!e.match(W4e)}function V4e(e){return e===parseInt(e.toString(),10)}function Uf(e,t,n){t==null&&(t=0),n==null&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r}function RJ(e){return e=Array.isArray(e)?new Float32Array(e):e,ba(e)}function Gm(e){return pE(RJ(e)).dataSync()[0]}function Wf(e){return Rf(RJ(e)).dataSync()[0]}function Hs(e,t){if(t<e)throw new ie("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function Db(e,t){return e.asType(t)}function Rb(e,t){t===void 0&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function q4e(e,t){return le(function(){if(e.shape.length!==2)throw new ie("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return fP(Rb(e,1),[1,t,1])})}function H4e(e){var t=[Uf(e.shape)];return e.reshape(t)}function G4e(e){if(e.rank<=1)throw new ie("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],Uf(e.shape,1)];return e.reshape(t)}function Xh(e,t,n){return le(function(){switch(e.rank){case 1:return bb(e,t,n);case 2:return dE(e,[t,0],[n,e.shape[1]]);case 3:return xb(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Pm(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Ro(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Ro(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ie("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}})}function cP(e,t,n){return le(function(){switch(e.rank){case 1:return bb(e,t,n);case 2:return dE(e,[0,t],[e.shape[0],n]);case 3:return xb(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Pm(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function TE(e,t,n,r){return le(function(){switch(e.rank){case 1:return bb(e,t,n);case 2:switch(r){case 1:return Xh(e,t,n);case 2:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return Xh(e,t,n);case 2:return xb(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return Xh(e,t,n);case 2:return Pm(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Pm(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function FJ(e,t){var n;return t===void 0&&(t=-1),t<0&&(t=(n=e[0].rank)!==0?n:0),t===e[0].rank&&(t=-1),Hi(e,t)}function MJ(e,t){switch(e.rank){case 1:return n3([e,t]);case 2:return r3([e,t],0);case 3:return i3([e,t],0);case 4:return a3([e,t],0);default:throw new ie("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function fP(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ie("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return sc(e,t)}function OE(e,t,n,r,i){return t===void 0&&(t=0),n===void 0&&(n=1),gM(e,t,n,r,i)}function dc(e,t,n,r){if(e.rank<2||t.rank<2)throw new $t("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&e.shape.slice(-1)[0]!==(c=t.shape.slice(-2)[0]))throw new $t("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(e.rank===2&&t.rank===2){var i=!1,a=!1;return Pf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?dP(e.rank,r,qs()):null,activation:n})}var o=e.shape.slice(),s=o.pop();e=e.reshape([-1,s]);var u=t.shape.slice(),l=u.pop(),c=u.pop(),f=u.concat([l]),d=Array.from({length:t.rank},function(p,g){return g===0?t.rank-2:g<=t.rank-2?g-1:g});t=t.transpose(d).reshape([c,-1]);var h=o.concat(f);return i=!1,a=!1,Pf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?dP(e.rank,r,qs()):null,activation:n}).reshape(h)}function PJ(e,t,n){return le(function(){return t=Array.isArray(t)?ba(t,"int32"):t.toInt(),Fm(e,t,n)})}function Fb(e){return $S(e,e)}function dP(e,t,n){var r=t.shape;if(t.rank!==1&&t.rank!==e)throw new ie("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(e===5){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new ie("Unsupported input rank by biasAdd: "+t.rank)}function hc(e,t,n){return le(function(){return n==null&&(n=qs()),Kr(n),e.add(dP(e.rank,t,n))})}function K4e(e,t){if(t===void 0&&(t=1),t!==1)throw new $t("Support for alpha values other than 1 ("+t+") is not implemented yet.");return $m(e)}function X4e(e){return le(function(){return Cr(e,Of(e).add(1))})}function $J(e,t,n,r){return le(function(){return NM(e,t,n,r)})}function Y4e(e){return le(function(){var t=Wt(.5,rt(.2,e));return xa(t,0,1)})}function Km(e,t,n){return n===void 0&&(n=!1),n?e():t()}var Z4e=["fanIn","fanOut","fanAvg"],J4e=["normal","uniform","truncatedNormal"];function Q4e(e){qm(Z4e,"FanMode",e)}function eLe(e){qm(J4e,"Distribution",e)}var Gs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),LJ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Tn(n,r)},t.className="Zeros",t}(Gs);Ne.registerClass(LJ);var hP=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Wu(n,r)},t.className="Ones",t}(Gs);Ne.registerClass(hP);var BJ=function(e){function t(n){var r=e.call(this)||this;if(typeof n!="object")throw new ie("Expected argument of type ConstantConfig but got "+n);if(n.value===void 0)throw new ie("config must have value set but got "+n);return r.value=n.value,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){return rt(Ve(i.value),Wu(n,r))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(Gs);Ne.registerClass(BJ);var zJ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=n.minval||r.DEFAULT_MINVAL,r.maxval=n.maxval||r.DEFAULT_MAXVAL,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){return zh(n,this.minval,this.maxval,r)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(Gs);Ne.registerClass(zJ);var jJ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("randomNormal does not support dType "+r+".");return OE(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(Gs);Ne.registerClass(jJ);var UJ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("truncatedNormal does not support dType "+r+".");return vb(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(Gs);Ne.registerClass(UJ);var WJ=function(e){function t(n){var r=e.call(this)||this;return r.gain=n.gain!=null?n.gain:1,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2||n[0]!==n[1])throw new ie("Identity matrix initializer can only be used for 2D square matrices.");return rt(i.gain,tE(n[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(Gs);function tLe(e,t){var n,r;if(t===void 0&&(t="channelsLast"),Kr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1)if(t==="channelsFirst"){var i=Uf(e,2);n=e[1]*i,r=e[0]*i}else t==="channelsLast"&&(i=Uf(e,0,e.length-2),n=e[e.length-2]*i,r=e[e.length-1]*i);else{var a=Uf(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}Ne.registerClass(WJ);var no=function(e){function t(n){var r=e.call(this)||this;if(n.scale<0)throw new ie("scale must be a positive float. Got: "+n.scale);return r.scale=n.scale==null?1:n.scale,r.mode=n.mode==null?"fanIn":n.mode,Q4e(r.mode),r.distribution=n.distribution==null?"normal":n.distribution,eLe(r.distribution),r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=tLe(n),a=i[0],o=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,a):this.mode==="fanOut"?s/=Math.max(1,o):s/=Math.max(1,(a+o)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t(this.getClassName()+" does not support dType "+r+".");return vb(n,0,u,r,this.seed)}var l=Math.sqrt(3*s);return zh(n,-l,l,r)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(Gs);Ne.registerClass(no);var pP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="GlorotUniform",t}(no);Ne.registerClass(pP);var gP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="GlorotNormal",t}(no);Ne.registerClass(gP);var mP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="HeNormal",t}(no);Ne.registerClass(mP);var vP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="HeUniform",t}(no);Ne.registerClass(vP);var yP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="LeCunNormal",t}(no);Ne.registerClass(yP);var bP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="LeCunNormal",t}(no);Ne.registerClass(bP);var VJ=function(e){function t(n){var r=e.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=n.gain==null?r.DEFAULT_GAIN:n.gain,r.seed=n.seed,r.seed!=null)throw new $t("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2)throw new $t("The Orthogonal Initializer does not support non-2D shapes yet.");n[0]*n[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+n[0]*n[1]+") elements: Slowness may result.");var a=OE(n[0]>n[1]?[n[1],n[0]]:n,0,1,"float32"),o=FM.gramSchmidt(a);return n[0]>n[1]&&(o=o.transpose()),rt(i.gain,o)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(Gs);Ne.registerClass(VJ);var qJ={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function HJ(e,t){return t===void 0&&(t={}),Ob(e,Ne.SerializationMap.getMap().classNameMap,t,"initializer")}function vn(e){return oP(e)}function nr(e){if(typeof e=="string"){var t=e in qJ?qJ[e]:e;if(t==="GlorotNormal")return new gP;if(t==="GlorotUniform")return new pP;if(t==="HeNormal")return new mP;if(t==="HeUniform")return new vP;if(t==="LeCunNormal")return new yP;if(t==="LeCunUniform")return new bP;var n={};return n.className=t,n.config={},HJ(n)}return e instanceof Gs?e:HJ(e)}function nLe(){return new LJ}function rLe(){return new hP}function iLe(e){return new BJ(e)}function aLe(e){return new zJ(e)}function oLe(e){return new jJ(e)}function sLe(e){return new UJ(e)}function uLe(e){return new WJ(e)}function lLe(e){return new no(e)}function cLe(e){return new pP(e)}function fLe(e){return new gP(e)}function dLe(e){return new mP(e)}function hLe(e){return new vP(e)}function pLe(e){return new yP(e)}function gLe(e){return new bP(e)}function mLe(e){return new VJ(e)}Object.freeze({zeros:nLe,ones:rLe,constant:iLe,randomUniform:aLe,randomNormal:oLe,truncatedNormal:sLe,identity:uLe,varianceScaling:lLe,glorotUniform:cLe,glorotNormal:fLe,heNormal:dLe,heUniform:hLe,leCunNormal:pLe,leCunUniform:gLe,orthogonal:mLe});var vLe=0;function GJ(){return vLe++}var IE={};function NE(e){return e===void 0&&(e=""),e in IE||(IE[e]=0),IE[e]+=1,e+IE[e].toString()}function xP(e){return Array.isArray(e)&&Array.isArray(e[0])}function DE(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Dt(e){var t;if(Array.isArray(e)){if(e.length!==1)throw new ie("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function Kn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return(e=e)[0];throw new ie("Expected exactly 1 Shape; got "+e.length)}return e}function RE(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];i.shape.length===0?t+=1:t+=i.shape.reduce(function(a,o){return a*o})}return t}var KJ="Variable",yLe=function(){function e(t,n,r,i,a){n===void 0&&(n="float32"),r===void 0&&(r=KJ),i===void 0&&(i=!0),a===void 0&&(a=null),this.dtype=n??"float32",this.shape=t.shape,this.id=GJ(),r=r??KJ,this.originalName=IJ(r),this.name=NJ(this.originalName),this.trainable_=i,this.constraint=a,this.val=e3(t,this.trainable_,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(t){return this.assertNotDisposed(),bLe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),e}();function bLe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function wP(e){return e.map(function(t){return t.read()})}function _P(e){e.forEach(function(t){t[0].write(t[1])})}var Fi=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}(),Zu=function(){return function(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=GJ(),a!=null&&(this.originalName=IJ(a),this.name=NJ(this.originalName)),this.rank=t.length}}(),xLe=0,FE=function(){function e(t,n){this.callArgs=n,this.id=xLe++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var r=0,i=t.inboundLayers;r<i.length;r++){var a=i[r];a!=null&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var t=[],n=0,r=this.inboundLayers;n<r.length;n++){var i=r[n];i!=null?t.push(i.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),wLe=0,tn=function(e){function t(n){var r=e.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=wLe++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=n.name;if(!i){var a=r.getClassName();i=fc(a)+"_"+NE(a)}if(r.name=i,r.trainable_=n.trainable==null||n.trainable,n.inputShape!=null||n.batchInputShape!=null){var o=void 0;if(n.batchInputShape!=null)o=n.batchInputShape;else if(n.inputShape!=null){var s=null;n.batchSize!=null&&(s=n.batchSize),o=[s].concat(n.inputShape)}r.batchInputShape=o;var u=n.dtype;u==null&&(u=n.inputDType),u==null&&(u="float32"),r.dtype=u}return n.weights!=null?r.initialWeights=n.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return Ee(t,e),t.nodeKey=function(n,r){return n.name+"_ib-"+r.toString()},t.prototype.getNodeAtIndex=function(n,r){if(this.inboundNodes.length===0)throw new Xu("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=n)throw new ie("Asked to get "+r+" at node "+n+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[n]},t.prototype.getInputAt=function(n){return _a(this.getNodeAtIndex(n,"input").inputTensors)},t.prototype.getOutputAt=function(n){return _a(this.getNodeAtIndex(n,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new qh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new qh("Layer "+this.name+" is not connected, no input to return.");return _a(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new qh("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new qh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return _a(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(n){return n()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(n){this._built=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this._trainableWeights.forEach(function(r){return r.trainable=n}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(n){return n.trainable}):[]},set:function(n){this._trainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(n){return!n.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(n){this._nonTrainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(n){if(n=Jn(n),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Jn(this.inputSpec);if(n.length!==r.length)throw new ie("Layer "+this.name+" expects "+r.length+" inputs, but it received "+n.length+" input tensors. Input received: "+n);for(var i=0;i<n.length;i++){var a=n[i],o=r[i];if(o!=null){var s=a.rank;if(o.ndim!=null&&s!==o.ndim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+s);if(o.maxNDim!=null&&s>o.maxNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+s);if(o.minNDim!=null&&s<o.minNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+s+".");if(o.dtype!=null&&a.dtype!==o.dtype)throw new ie("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+a.dtype+".");if(o.axes){var u=a.shape;for(var l in o.axes){var c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+f+" but got shape "+u+".")}}if(o.shape!=null)for(var h=0;h<o.shape.length;++h){var p=o.shape[h],g=a.shape[h];if(p!=null&&g!=null&&p!==g)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape="+a.shape+".")}}}}},t.prototype.call=function(n,r){return n},t.prototype.invokeCallHook=function(n,r){this._callHook!=null&&this._callHook(n,r)},t.prototype.setCallHook=function(n){this._callHook=n},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(n,r){var i=this;r=r||{},this.assertNotDisposed();for(var a=Jn(n),o=!0,s=0,u=a;s<u.length;s++)if(!(u[s]instanceof Zu)){o=!1;break}for(var l=!0,c=0,f=a;c<f.length;c++)if(f[c]instanceof Zu){l=!1;break}if(o===l)throw new ie("Arguments to apply() must be all SymbolicTensors or all Tensors");return Kh(this.name,function(){if(!i.built){i.assertInputCompatibility(n);for(var d=[],h=0,p=Jn(n);h<p.length;h++){var g=p[h];d.push(g.shape)}i.build(_a(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(n),l){for(var m=[],v=0,y=Jn(S=i.call(n,r));v<y.length;v++){var b=y[v];a.indexOf(b)!==-1&&(b=b.clone()),m.push(b)}if(S=_a(m),i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S}var x=_Le(n),w=i.computeOutputShape(x),S=void 0,C=SLe(n);if(i.warnOnIncompatibleInputShape(Array.isArray(n)?x[0]:x),S=w!=null&&w.length>0&&Array.isArray(w[0])?w.map(function(_,E){return new Zu(C,_,i,Jn(n),r,i.name,E)}):new Zu(C,w,i,Jn(n),r,i.name),i.addInboundNode(n,S,null,null,x,w,r),i._refCount++,i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S})},t.prototype.warnOnIncompatibleInputShape=function(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(n)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,a){i!=null&&n[a]!=null&&n[a]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(n)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new qh("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var n=[],r=0,i=this.inboundNodes;r<i.length;r++){var a=i[r],o=JSON.stringify(a.outputShapes);n.indexOf(o)===-1&&n.push(o)}if(n.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new qh("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new Xu("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return RE(this.weights)},t.prototype.build=function(n){this.built=!0},t.prototype.getWeights=function(n){return n===void 0&&(n=!1),wP(n?this.trainableWeights:this.weights)},t.prototype.setWeights=function(n){var r=this;le(function(){var i=r.weights;if(i.length!==n.length)throw new ie('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+n.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+n+"...");if(i.length!==0){for(var a=[],o=wP(i),s=0;s<o.length;++s){var u=o[s],l=i[s],c=n[s];if(!pt.arraysEqual(u.shape,c.shape))throw new ie("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);a.push([l,c])}_P(a)}})},t.prototype.addWeight=function(n,r,i,a,o,s,u){if(this._addedWeightNames.indexOf(n)!==-1)throw new ie("Duplicate weight name "+n+" for layer "+this.name);this._addedWeightNames.push(n),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(a=nr("zeros"));var l=a.apply(r,i),c=new yLe(l,i,n,s,u);return l.dispose(),o!=null&&this.addLoss(function(){return o.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},t.prototype.setFastWeightInitDuringBuild=function(n){this.fastWeightInitDuringBuild=n},t.prototype.addLoss=function(n){var r;n==null||Array.isArray(n)&&n.length===0||(n=Jn(n),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,n))},t.prototype.computeOutputShape=function(n){return n},t.prototype.computeMask=function(n,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(a){if(a!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},t.prototype.addInboundNode=function(n,r,i,a,o,s,u){u===void 0&&(u=null);var l=Jn(n);r=Jn(r),i=Jn(i),a=Jn(a),o=DE(o),s=DE(s);for(var c=[],f=[],d=[],h=0,p=l;h<p.length;h++){var g=p[h];c.push(g.sourceLayer),f.push(g.nodeIndex),d.push(g.tensorIndex)}new FE({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:a,inputShapes:o,outputShapes:s},u);for(var m=0;m<r.length;m++)r[m].sourceLayer=this,r[m].nodeIndex=this.inboundNodes.length-1,r[m].tensorIndex=m},t.prototype.getConfig=function(){var n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n},t.prototype.disposeWeights=function(){return this.weights.forEach(function(n){return n.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var n=0;return--this._refCount==0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}},t}(Ne.Serializable);function _Le(e){for(var t=[],n=0,r=e=Jn(e);n<r.length;n++){var i=r[n];t.push(i.shape)}return _a(t)}function SLe(e){return"float32"}function XJ(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];var r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],a=0;a<r.inboundLayers.length;a++)for(var o=0,s=XJ(r.inputTensors[a],r.inboundLayers[a],r.nodeIndices[a]);o<s.length;o++){var u=s[o];i.indexOf(u)===-1&&i.push(u)}return i}var YJ,Mb=function(e){function t(n){var r=e.call(this,{dtype:n.dtype,name:n.name!=null?n.name:NE("input").toString()})||this;if(n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new ie("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=n.batchInputShape;if(i==null){if(n.inputShape==null)throw new ie("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new ie("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=n.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new Zu(r.dtype,r.batchInputShape,r,[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new FE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return Ee(t,e),t.prototype.apply=function(n,r){throw new ie("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(tn);function ZJ(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new ie("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));var n=e.dtype;return n==null&&(n="float32"),new Mb({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function Vf(e){return At(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(e==null)return[2];for(i in t=[],n=[],r=[],e)typeof(a=e[i])!="number"&&(o=a,t.push(o.data()),n.push(i),r.push(o));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];Ut(r),l.label=2;case 2:return[2]}})})}function JJ(e){if(e!=null)for(var t in e){var n=e[t];typeof n!="number"&&n.dispose()}}Ne.registerClass(Mb),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(YJ||(YJ={}));var ELe=125,Xm=function(){function e(){this.validationData=null}return e.prototype.setParams=function(t){this.params=t},e.prototype.onEpochBegin=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onEpochEnd=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchBegin=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchEnd=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onTrainBegin=function(t){return At(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.onTrainEnd=function(t){return At(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.setModel=function(t){},e}(),CLe=function(){function e(t,n){n===void 0&&(n=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=n}return e.prototype.append=function(t){this.callbacks.push(t)},e.prototype.setParams=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setParams(t)},e.prototype.setModel=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setModel(t)},e.prototype.onEpochBegin=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(t){return At(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainBegin(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(t){return At(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainEnd(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e}(),ALe=function(e){function t(){return e.call(this)||this}return Ee(t,e),t.prototype.onEpochBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u=this;return St(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,a=function(c){var f=r[c];if(typeof f=="number")o.totals.hasOwnProperty(c)||(o.totals[c]=0),o.totals[c]=o.totals[c]+f*i;else{var d=void 0;c in o.totals?d=o.totals[c]:o.totals[c]=0;var h=le(function(){return Wt(u.totals[c],rt(f,i))});o.totals[c]=h,d!=null&&d.dispose()}},o=this,r)a(s);return[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l=this;return St(this,function(c){if(r!=null)for(i=function(f){if(a.totals[f]==null)return"continue";typeof a.totals[f]=="number"?r[f]=a.totals[f]/a.seen:le(function(){var d=rt(Cr(1,l.seen),l.totals[f]);r[f]=d,l.totals[f].dispose(),zu(r[f])})},a=this,o=0,s=this.params.metrics;o<s.length;o++)u=s[o],i(u);return[2]})})},t}(Xm),kLe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){for(i in r==null&&(r={}),this.epoch.push(n),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},t.prototype.syncData=function(){return At(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return St(this,function(f){switch(f.label){case 0:for(a in n=[],r=[],i=[],this.history)for(o=this.history[a],s=0;s<o.length;++s)typeof o[s]!="number"&&(u=o[s],n.push(u.data()),r.push(a),i.push(s));return[4,Promise.all(n)];case 1:for(l=f.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},t}(Xm),TLe=function(e){function t(n,r){var i=e.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=ELe),i.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return pt.isNumber(i.yieldEvery)&&(i.maybeWait=R4e(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=n.onTrainBegin,i.trainEnd=n.onTrainEnd,i.epochBegin=n.onEpochBegin,i.epochEnd=n.onEpochEnd,i.batchBegin=n.onBatchBegin,i.batchEnd=n.onBatchEnd,i.yield=n.onYield,i}return Ee(t,e),t.prototype.maybeWait=function(n,r,i){return At(this,void 0,void 0,function(){var a;return St(this,function(o){switch(o.label){case 0:return a=[],this.yield==null?[3,2]:[4,Vf(i)];case 1:o.sent(),a.push(this.yield(n,r,i)),o.label=2;case 2:return a.push(AE()),[4,Promise.all(a)];case 3:return o.sent(),[2]}})})},t.prototype.onEpochBegin=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.currentEpoch=n,this.epochBegin==null?[3,3]:[4,Vf(r)];case 1:return i.sent(),[4,this.epochBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Vf(r)];case 1:a.sent(),i.push(this.epochEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(AE()),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onBatchBegin=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Vf(r)];case 1:return i.sent(),[4,this.batchBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Vf(r)];case 1:a.sent(),i.push(this.batchEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="batch"?i.push(AE()):pt.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,n,r)),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Vf(n)];case 1:return r.sent(),[4,this.trainBegin(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Vf(n)];case 1:return r.sent(),[4,this.trainEnd(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}(Xm);function QJ(e,t){return e==null&&(e={}),e instanceof Xm?[e]:Array.isArray(e)&&e[0]instanceof Xm?e:Jn(e).map(function(n){return new TLe(n,t)})}var OLe=function(){function e(){}return e.registerCallbackConstructor=function(t,n){pt.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),e.checkForDuplicate(n),e.constructors[t]==null&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach(function(r){if(r===t)throw new ie("Duplicate callback constructor.")})},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var i=+r;t>=i&&n.push.apply(n,e.constructors[i])}return n.map(function(a){return new a})},e.constructors={},e}();function eQ(e,t,n,r,i,a,o,s,u){var l=new kLe,c=[new ALe].concat(OLe.createCallbacks(t));e!=null&&c.push.apply(c,e),c.push(l);var f=new CLe(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:l}}function Ks(e,t,n){return t===void 0&&(t={}),n===void 0&&(n=!1),Ob(e,Ne.SerializationMap.getMap().classNameMap,t,"layer",n)}function ME(e,t){return le(function(){e.dtype!=="float32"&&(e=e.asType("float32"));var n=qr(Fb(e),t,!0),r=Sm(n.shape,Hr()),i=ub(Vu(n,r));return Cr(e,i)})}function Yh(e,t){return le(function(){return Fr(Fb(Er(t,e)),-1)})}function PE(e,t){return le(function(){return Fr(Of(Er(t,e)),-1)})}function Ym(e,t){return le(function(){var n=Er(e,t),r=xa(Of(e),Hr(),Number.MAX_VALUE),i=Of(Cr(n,r));return rt(100,Fr(i,-1))})}function ILe(e,t){return le(function(){var n=xa(t,Hr(),Number.MAX_VALUE),r=oc(Wt(1,n)),i=xa(e,Hr(),Number.MAX_VALUE),a=oc(Wt(1,i));return Fr(Fb(Er(r,a)),-1)})}function NLe(e,t){return le(function(){var n=Vu(0,Er(1,rt(e,t)));return Fr(Fb(n),-1)})}function DLe(e,t){return le(function(){var n=Vu(0,Er(1,rt(e,t)));return Fr(n,-1)})}function RLe(e,t){return le(function(){var n=qr(rt(e,t),-1),r=Rf(rt(Er(1,e),t),-1);return Vu(0,Wt(1,Er(r,n)))})}function FLe(e,t){return le(function(){var n=Math.log(2),r=Er(t,e),i=Er(Wt(r,sb(rt(-2,r))),n);return Fr(i,-1)})}function Pb(e,t,n){return n===void 0&&(n=!1),le(function(){if(n)t=Dh(t);else{var r=qr(t,t.shape.length-1,!0);t=Cr(t,r)}return t=xa(t,Hr(),1-Hr()),If(qr(rt(e.toFloat(),oc(t)),t.shape.length-1))})}function $E(e,t){return le(function(){var n=DS(H4e(e)).toInt(),r=(t=xa(t,Hr(),1-Hr())).shape;return Pb(Bh(n,r[r.length-1]).reshape(r),t,!1)})}function MLe(e,t){if(!pt.arraysEqual(e.shape,t.shape))throw new ie("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return le(function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())})}function LE(e,t){return le(function(){var n;return n=xa(t,Hr(),1-Hr()),n=oc(Cr(n,Er(1,n))),Fr(MLe(e,n),-1)})}function PLe(e,t){return le(function(){var n=xa(e,Hr(),1),r=xa(t,Hr(),1);return qr(rt(e,oc(Cr(n,r))),-1)})}function $Le(e,t){return le(function(){var n=oc(Wt(Hr(),t));return Fr(Er(t,rt(e,n)),-1)})}function SP(e,t){return le(function(){var n=ME(e,-1),r=ME(t,-1),i=rt(n,r);return If(qr(i,-1))})}var BE={meanSquaredError:Yh,meanAbsoluteError:PE,meanAbsolutePercentageError:Ym,meanSquaredLogarithmicError:ILe,squaredHinge:NLe,hinge:DLe,categoricalHinge:RLe,logcosh:FLe,categoricalCrossentropy:Pb,sparseCategoricalCrossentropy:$E,binaryCrossentropy:LE,kullbackLeiblerDivergence:PLe,poisson:$Le,cosineProximity:SP};function EP(e){if(typeof e=="string"){if(e in BE)return BE[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ie(t)}return e}function CP(e,t){return le(function(){var n=rt(.5,No(t)),r=Db(Dm(t,n),e.dtype);return Fr(jh(e,r),-1)})}function AP(e,t){return le(function(){return Db(jh(_b(e,-1),_b(t,-1)),"float32")})}function tQ(e,t){return le(function(){return Hu(e.equal(1),t.equal(1)).sum().cast("float32")})}function LLe(e,t){return le(function(){return Hu(e.equal(1),t.equal(0)).sum().cast("float32")})}function BLe(e,t){return le(function(){return Hu(e.equal(0),t.equal(1)).sum().cast("float32")})}function nQ(e,t){return le(function(){var n=tQ(e,t),r=BLe(e,t),i=n.add(r);return Vs(Dm(i,0),n.div(i),0).cast("float32")})}function zLe(e,t){return le(function(){var n=tQ(e,t),r=LLe(e,t),i=n.add(r);return Vs(Dm(i,0),n.div(i),0).cast("float32")})}function rQ(e,t){return LE(e,t)}function iQ(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),jh(e,t).asType("float32")}var jLe=Yh,ULe=Yh,WLe=PE,VLe=PE,qLe=Ym,HLe=Ym,kP=Pb,GLe=SP,aQ=$E,zE={binaryAccuracy:CP,categoricalAccuracy:AP,precision:nQ,categoricalCrossentropy:kP,sparseCategoricalCrossentropy:aQ,mse:jLe,MSE:ULe,mae:WLe,MAE:VLe,mape:qLe,MAPE:HLe,cosine:GLe};function KLe(e){if(typeof e=="string"&&e in zE)return zE[e];if(typeof e!="string"&&e!=null)return e;throw new ie("Unknown metric "+e)}function jE(e){if(Yu(e!==null,"Unknown LossOrMetricFn "+e),typeof e=="string")return e;for(var t=void 0,n=0,r=Object.keys(BE);n<r.length;n++){var i=r[n];if(BE[i]===e){t=i;break}}if(t!==void 0)return t;for(var a=0,o=Object.keys(zE);a<o.length;a++)if(i=o[a],zE[i]===e){t=i;break}return t!==void 0?t:e.name}function XLe(e){var t={Adagrad:function(){return zf.adagrad(.01)},Adadelta:function(){return zf.adadelta(1,.95,Hr())},Adam:function(){return zf.adam(.001,.9,.999,Hr())},Adamax:function(){return zf.adamax(.002,.9,.999,Hr(),0)},RMSProp:function(){return zf.rmsprop(.001,.9,0,Hr())},SGD:function(){return zf.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ie("Unknown Optimizer "+e)}var oQ=1048576;function sQ(e,t,n){if(n===void 0&&(n=!1),e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!TP(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>oQ&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+oQ+".")}}function TP(e){if(e===null)return!0;if(typeof e=="object"){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(typeof r!="string"||!TP(e[r]))return!1}return!0}if(Array.isArray(e)){for(var i=0,a=e;i<a.length;i++)if(!TP(a[i]))return!1;return!0}return!1}var o=typeof e;return o==="string"||o==="number"||o==="boolean"}function YLe(e,t,n,r){r===void 0&&(r=console.log);var i,a=JLe(e),o=["Layer (type)","Output shape","Param #"];if(a?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(d){return Math.floor(t*d)})),!a)for(var s in o.push("Receives inputs"),i=[],e.nodesByDepth)i.push.apply(i,e.nodesByDepth[s]);r("_".repeat(t)),UE(o,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)a?QLe(u[l],n,r):eBe(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=ZLe(e),f=RE(e.nonTrainableWeights);r("Total params: "+(c+f)),r("Trainable params: "+c),r("Non-trainable params: "+f),r("_".repeat(t))}function ZLe(e){return e.collectedTrainableWeights!=null?RE(e.collectedTrainableWeights):RE(e.trainableWeights)}function JLe(e){var t=!0,n=[],r=[];for(var i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,f=0,d=l[u].inboundNodes;f<d.length;f++){var h=d[f];if(r.indexOf(h)!==-1){if(c){t=!1;break}c=!0}}if(!t)break}return t}function UE(e,t,n){n===void 0&&(n=console.log);for(var r="",i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[i]).slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function QLe(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(i){r="multiple"}UE([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function eBe(e,t,n,r){var i;try{i=JSON.stringify(e.outputShape)}catch(m){i="multiple"}for(var a=[],o=0,s=e.inboundNodes;o<s.length;o++){var u=s[o];if(!(n!=null&&n.length>0&&n.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,f=u.nodeIndices[l],d=u.tensorIndices[l];a.push(c+"["+f+"]["+d+"]")}}var h=e.name,p=e.getClassName(),g=a.length===0?"":a[0];for(UE([h+" ("+p+")",i,e.countParams().toString(),g],t,r),l=1;l<a.length;++l)UE(["","","",a[l]],t,r)}function uQ(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function $b(e,t){if(e===null)return null;if(typeof e=="string")return Gh(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];uQ(t,i,a)?n.push(a):n.push($b(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if(l==="name"&&typeof c=="string")o[l]=c;else{var f=Gh(l);o[f]=$b(c,f)}}return o}function OP(e,t){if(e==null)return null;if(typeof e=="string")return fc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];uQ(t,i,a)?n.push(a):n.push(OP(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],f=fc(l);o[f]=l!=="name"&&l!=="className"||typeof c!="string"?OP(c,l):c}return o}var lQ="1.7.4";function tBe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return kS(t,e.dtype)}catch(n){throw new ie("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}var Zm=function(){function e(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(var r=0,i=t;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return e.prototype.add=function(t,n,r){if(this.id2Value[t.id]!=null)throw new ie("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=tBe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r),this},e.prototype.addFeed=function(t){this.add(t.key,t.value)},e.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(t){if(t instanceof Zu){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Value[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[n]},e.prototype.getMask=function(t){if(t instanceof Zu){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[n]},e.prototype.disposeMasks=function(){this.id2Mask!=null&&Ut(this.id2Mask)},e}(),IP={},cQ={};function Lb(e,t,n,r){for(var i=n!=null&&n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(function(ee){return ee.name}),u=[],l=t.names(),c=0,f=s;c<f.length;c++){var d=f[c];l.indexOf(d)!==-1?u.push(t.getValue(d)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p,g=s.join(",")+"|"+t.names().join(",");if(IP[g]==null){var m=nBe(o,t);h=m.sorted,p=m.recipientCounts,IP[g]=h,cQ[g]=p}h=IP[g],p={},i||Object.assign(p,cQ[g]);for(var v=new Zm(t),y=0;y<h.length;++y){if(r!=null){var b=_S().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=h[y],w=x.sourceLayer;if(!(w instanceof Mb)){for(var S=[],C=[],_=[],E=!1,A=0,k=x.inputs;A<k.length;A++){var T=k[A],I=v.getValue(T),N=v.getMask(T);S.push(I),C.push(N),N!=null&&(E=!0),i||(p[T.name]--,p[T.name]!==0||t.hasKey(T)||s.indexOf(T.name)!==-1||I.isDisposed||T.sourceLayer.stateful===!0||_.push(I))}E&&((n=n||{}).mask=C[0]);var O=Jn(w.apply(S,n)),D=null;w.supportsMasking&&(D=w.computeMask(S,C));for(var L=iBe(x),W=Array.isArray(L)?L:[L],G=0;G<W.length;++G){v.hasKey(W[G])||v.add(W[G],O[G],Array.isArray(D)?D[0]:D);var K=s.indexOf(W[G].name);K!==-1&&(u[K]=O[G])}i||Ut(_)}}return v.disposeMasks(),a?u:u[0]}function nBe(e,t){pt.assert(e!=null&&e.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(e.length===1){var i=fQ(e[0],t);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=e;o<s.length;o++){for(var u=fQ(s[o],t),l=u.sorted,c=u.recipientMap,f=0,d=l;f<d.length;f++){var h=d[f];a.has(h.name)||(n.push(h),a.add(h.name))}var p=function(m){r[m]==null&&(r[m]=new Set),c[m].forEach(function(v){return r[m].add(v)})};for(var g in c)p(g)}return{sorted:n,recipientCounts:rBe(r)}}function rBe(e){var t={};for(var n in e)t[n]=e[n].size;return t}function fQ(e,t){for(var n=new Set,r=[],i={},a=0,o=t.names();a<o.length;a++){var s=o[a];n.add(s)}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(n.has(c.name))u.pop();else{var f=l[l.length-1]===u.length-1;if(c.inputs.length===0||f)u.pop(),r.push(c),n.add(c.name),f&&l.pop();else{l.push(u.length-1);for(var d=0,h=c.inputs;d<h.length;d++){var p=h[d];i[p.name]==null&&(i[p.name]=new Set),i[p.name].add(c.name),n.has(p.name)||u.push(p)}}}}return{sorted:r,recipientMap:i}}function iBe(e){var t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var i=0,a=e.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var aBe=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=NE(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],jf(r.inputs).length!==r.inputs.length)throw new ie("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(Je){return Je.name}));jf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(Je){return Je.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(A=o[a]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,f=r.inputs;c<f.length;c++)s=(A=f[c]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex,Yu(u===0,"input layer has >1 nodes"),Yu(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof Mb))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,p=r.outputLayers;h<p.length;h++)s=p[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(Je){return Je.shape}),r.internalOutputShapes=r.outputs.map(function(Je){return Je.shape});for(var g={},m={},v={},y={},b={},x=[],w=function(Je,Zt,mn,Hn,ti,er){Hn!=null&&ti!=null&&er!=null||(Hn=Je.sourceLayer,ti=Je.nodeIndex,er=Je.tensorIndex);var Dn=Hn.inboundNodes[ti];if(mn.indexOf(Dn)!==-1)throw new Xu("The tensor "+Je.name+' at layer "'+Hn.name+'" is part of a cycle.');if(Zt.indexOf(Dn)===-1){r.containerNodes.add(t.nodeKey(Hn,ti)),Hn.id in b||(b[Hn.id]=Object.keys(b).length),mn.indexOf(Dn)===-1&&mn.push(Dn);for(var Jo=Dn.inboundLayers.length,Ka=0;Ka<Jo;Ka++){var jl=Dn.inputTensors[Ka],ks=Dn.inboundLayers[Ka],Ts=Dn.nodeIndices[Ka],Ul=Dn.tensorIndices[Ka];w(jl,Zt,mn,ks,Ts,Ul)}for(Zt.push(Dn);mn.indexOf(Dn)>=0;)mn.splice(mn.indexOf(Dn),1);x.push(Dn)}},S=[],C=[],_=0,E=r.outputs;_<E.length;_++){var A=E[_];w(A,S,C)}for(var k=0,T=x.slice().reverse();k<T.length;k++){m[(B=T[k]).id]=B,B.id in g||(g[B.id]=0);var I=g[B.id],N=v[B.outboundLayer.id]==null?0:v[B.outboundLayer.id];for(I=Math.max(I,N),v[B.outboundLayer.id]=I,y[B.outboundLayer.id]=B.outboundLayer,g[B.id]=I,d=0;d<B.inboundLayers.length;d++){var O=B.inboundLayers[d],D=(u=B.nodeIndices[d],O.inboundNodes[u]),L=g[D.id]==null?0:g[D.id];g[D.id]=Math.max(I+1,L),m[D.id]=D}}var W={};for(var G in g)(I=g[G])in W||(W[I]=[]),W[I].push(m[G]);var K={};for(var ee in v)(I=v[ee])in K||(K[I]=[]),K[I].push(y[ee]);var ce=Object.keys(K).map(function(Je){return parseInt(Je,10)}).sort(kE);r.layers=[];for(var he=0,Oe=ce;he<Oe.length;he++){var Te=K[I=Oe[he]];Te.sort(function(Je,Zt){var mn=b[Je.id],Hn=b[Zt.id];return mn<Hn?-1:mn>Hn?1:0});for(var De=0,me=Te;De<me.length;De++)(s=me[De])instanceof t&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=K,ce=Object.keys(W).map(function(Je){return parseInt(Je,10)}).sort(kE);for(var P=r.inputs.slice(),F=[],V=0,ae=ce;V<ae.length;V++)for(var Y=0,M=W[I=ae[V]];Y<M.length;Y++){var B;if((s=(B=M[Y]).outboundLayer)!=null){for(var R=0,X=B.inputTensors;R<X.length;R++)if(A=X[R],P.indexOf(A)===-1)throw new Xu("Graph disconnected: cannot obtain value for tensor "+A+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+F);for(var ge=0,xe=B.outputTensors;ge<xe.length;ge++)A=xe[ge],P.push(A);F.push(s.name)}}r.nodesByDepth=W;for(var ze=r.layers.map(function(Je){return Je.name}),Ke=function(Je){var Zt=ze.filter(function(mn){return mn===Je}).length;if(Zt!==1)throw new Xu('The name "'+Je+'" is used '+Zt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(ze))},Ze=0,Bt=ze;Ze<Bt.length;Ze++)Ke(Bt[Ze]);return r.outboundNodes=[],r.inboundNodes=[],new FE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(Je){return null}),outputMasks:r.outputs.map(function(Je){return null}),inputShapes:r.inputs.map(function(Je){return Je.shape}),outputShapes:r.outputs.map(function(Je){return Je.shape})}),r.built=!0,r._refCount=1,r}return Ee(t,e),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var a=i[r];n.numDisposedVariables+=a.dispose().numDisposedVariables}for(var o=0,s=this.internalContainerRefs;o<s.length;o++){var u=s[o];n.numDisposedVariables+=u.dispose().numDisposedVariables}}return n.refCountAfterDispose=this._refCount,n},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=n})}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ie("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n=n.concat(a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.layers;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(n,r){r===void 0&&(r=!0);for(var i={},a=0,o=0,s=this.layers;o<s.length;o++)for(var u=0,l=s[o].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new ie("Duplicate weight name: "+c.originalName);i[c.originalName]=c,a++}var f=[];for(var d in n){if(i[d]!=null)f.push([i[d],n[d]]);else if(r)throw new ie("Provided weight data has no target variable: "+d);delete i[d]}if(r){var h=[];for(var p in i)h.push(p);if(h.length>0)throw new ie(h.length+" of "+a+" weights are not set: "+h)}_P(f)},t.prototype.updatedConfig=function(){var n=this.getConfig(),r={};return r.className=this.getClassName(),r.config=n,r.kerasVersion="tfjs-layers "+lQ,r.backend="TensorFlow.js",r},t.prototype.toJSON=function(n,r){r===void 0&&(r=!0);var i=OP(this.updatedConfig());return r?JSON.stringify(i):i},t.prototype.call=function(n,r){var i=this;return le(function(){n=Jn(n);for(var a=new Zm,o=0;o<i.inputs.length;++o)a.add(i.inputs[o],n[o]);return Lb(i.outputs,a,r)})},t.prototype.computeMask=function(n,r){var i=this;return le(function(){var a;return n=Jn(n),a=r==null?Hh(null,n.length):Jn(r),i.runInternalGraph(n,a)[1]})},t.prototype.computeOutputShape=function(n){var r=DE(n);if(r.length!==this.inputLayers.length)throw new ie("Invalid inputShape argument "+n+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},a=0;a<r.length;a++){var o=this.inputLayers[a],s=r[a];i[E=o.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(k){return parseInt(k,10)}).sort(kE);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){var p=h[d];if(o=p.outboundLayer,this.inputLayers.map(function(k){return k.id}).indexOf(o.id)===-1){for(var g=[],m=0;m<p.inboundLayers.length;m++){var v=p.inboundLayers[m],y=p.nodeIndices[m],b=p.tensorIndices[m],x=i[E=v.name+"_"+y+"_"+b];g.push(x)}var w=DE(o.computeOutputShape(_a(g))),S=o.inboundNodes.indexOf(p);for(m=0;m<w.length;m++)i[E=o.name+"_"+S+"_"+m]=w[m]}}var C=[],_=[];for(a=0;a<this.outputLayers.length;a++){o=this.outputLayers[a],S=this.outputLayersNodeIndices[a],b=this.outputLayersTensorIndices[a];var E=o.name+"_"+S+"_"+b;_.push(E)}for(a=0;a<_.length;a++){var A=_[a];Yu(A in i),C.push(i[A])}return _a(C)},t.prototype.runInternalGraph=function(n,r){r==null&&(r=Hh(null,n.length));for(var i={},a=0;a<this.inputs.length;++a){var o=this.inputs[a],s=n[a],u=r[a];i[o.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(K){return parseInt(K,10)}).sort(kE);l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){for(var p=h[d],g=p.outboundLayer,m=p.inputTensors,v=p.outputTensors,y=new Array,b=0,x=m;b<x.length;b++)(o=x[b]).id in i&&y.push(i[o.id]);if(y.length===m.length){var w={},S=void 0,C=void 0,_=void 0,E=void 0;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){var A=y[0],k=A[0],T=A[1];w.mask==null&&(w.mask=T),_=Jn(g.call(k,w)),E=Jn(g.computeMask(k,T)),S=[k],C=[T]}else S=y.map(function(K){return K[0]}),C=y.map(function(K){return K[1]}),w.mask==null&&(w.mask=C),_=Jn(g.call(S,w)),E=Jn(g.computeMask(S,C));if(g.activityRegularizer)throw new $t("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<v.length;++a)o=v[a],s=_[a],u=E[a],i[o.id]=[s,u]}}for(var I=[],N=[],O=[],D=0,L=this.outputs;D<L.length;D++){Yu((o=L[D]).id in i,"Could not compute output "+o.name+" : "+o.id);var W=i[o.id],G=W[0];u=W[1],O.push(G.shape),I.push(G),N.push(u)}return[I,N,O]},t.prototype.buildNodeConversionMap=function(n){for(var r,i={},a=0,o=this.layers;a<o.length;a++){var s=o[a];r=s instanceof t?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=t.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},t.prototype.getLayer=function(n,r){if(r!=null){if(this.layers.length<=r)throw new ie("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(n==null)throw new ie("Provide either a layer name or layer index");for(var i=0,a=this.layers;i<a.length;i++){var o=a[i];if(o.name===n)return o}throw new ie("No such layer: "+n)},t.prototype.calculateLosses=function(){var n=this;return le(function(){for(var r=[],i=0,a=n.layers;i<a.length;i++)for(var o=a[i],s=0;s<o.inboundNodes.length;++s){var u=t.nodeKey(o,s);n.containerNodes.has(u)&&r.push.apply(r,o.calculateLosses())}return r})},t.prototype.getConfig=function(){for(var n={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=0,o=this.layers;a<o.length;a++){for(var s=(w=o[a]).getClassName(),u=w.getConfig(),l=[],c=0;c<w.inboundNodes.length;c++){var f=w.inboundNodes[c],d=t.nodeKey(w,c),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(_){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+f.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],v=f.nodeIndices[g],y=f.tensorIndices[g];(C=r[t.nodeKey(m,v)])==null&&(C=0),p.push([m.name,C,y,h])}l.push(p)}}}var b={};b.name=w.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}n.layers=i;var x=[];for(g=0;g<this.inputLayers.length;g++){var w=this.inputLayers[g];v=this.inputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)&&((C=r[d])!==null&&C!==void 0||(C=0),y=this.inputLayersTensorIndices[g],x.push([w.name,C,y]))}n.inputLayers=x;var S=[];for(g=0;g<this.outputLayers.length;g++)if(w=this.outputLayers[g],v=this.outputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)){var C;(C=r[d])!==null&&C!==void 0||(C=0),y=this.outputLayersTensorIndices[g],S.push([w.name,C,y])}return n.outputLayers=S,n},t.fromConfig=function(n,r,i,a){a===void 0&&(a=!1);var o={},s={};function u(D,L){D.name in s?s[D.name].push(L):s[D.name]=[L]}function l(D,L){for(var W,G=[],K=0,ee=L;K<ee.length;K++){var ce=ee[K],he=ce[0],Oe=ce[1],Te=ce[2];if(W=ce[3]==null?{}:ce[3],!(he in o))return void u(D,L);var De=o[he];if(De.inboundNodes.length<=Oe)return void u(D,L);var me=De.inboundNodes[Oe];G.push(me.outputTensors[Te])}G.length>0&&D.apply(_a(G),W)}function c(D){var L=D.name,W=Ks(D,r.customObjects!=null?r.customObjects:{});W.setFastWeightInitDuringBuild(a),o[L]=W,D.inboundNodes.forEach(function(G){if(!(G instanceof Array))throw new ie("Corrupted configuration, expected array for nodeData: "+G);u(W,G)})}for(var f=r.name,d=r.layers,h=0,p=d;h<p.length;h++)c(v=p[h]);for(;!D4e(s);)for(var g=0,m=d;g<m.length;g++){var v=m[g];if((O=o[v.name]).name in s){var y=s[O.name];delete s[O.name];for(var b=0,x=y;b<x.length;b++)l(O,x[b])}}for(var w=[],S=[],C=0,_=r.inputLayers;C<_.length;C++){var E=(v=_[C])[0],A=v[1],k=v[2];Yu(E in o);var T=(O=o[E]).inboundNodes[A].outputTensors;w.push(T[k])}for(var I=0,N=r.outputLayers;I<N.length;I++){E=(v=N[I])[0],A=v[1],k=v[2],Yu(E in o);var O;T=(O=o[E]).inboundNodes[A].outputTensors,S.push(T[k])}return new n({inputs:w,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new ie("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var n=0,r=this.layers;n<r.length;n++)if(r[n].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var n=this;le(function(){n.layers.forEach(function(r){r.stateful&&r.resetStates()})})},t}(tn);function oBe(e,t,n){var r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(a){return null});if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided "+n+" is an array of "+e.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return e}if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){var i=[];return t.forEach(function(a){a in e?i.push(e[a]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+t+" keys. Provided "+n+" not understood: "+JSON.stringify(e))}function dQ(e,t){return oBe(e,t,"classWeight")}function hQ(e,t,n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return n==null?[3,2]:(i=le(function(){if(e.shape.length===1)return e.clone();if(e.shape.length===2){if(e.shape[1]>1)return e.argMax(1);if(e.shape[1]===1)return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+e.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+e.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[l.sent()]),Ut(i),u=[],a.forEach(function(c){if(n[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(n[c])}),[2,ba(u,"float32")];case 2:return[2,null]}})})}function sBe(e,t){return rt(e,t)}var uBe=32;function pQ(e,t){var n,r,i=t;n=i.xs,r=i.ys,pt.assert(n!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var a=gQ("input",e.inputNames,n),o=gQ("output",e.outputNames,r),s=a[0].shape[0];pt.assert(a.length===e.inputs.length,function(){return"LayersModel has "+e.inputs.length+" inputs, but the dataset provides "+a.length+" inputs.  (Expected input keys: "+JSON.stringify(e.inputNames)+")"}),pt.assert(o.length===e.outputs.length,function(){return"LayersModel has "+e.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(e.outputNames)+")"});for(var u=function(d){pt.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: input "+e.inputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},l=0;l<a.length;l++)u(l);for(var c=function(d){pt.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: output "+e.outputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},f=0;f<o.length;f++)c(f);return{xs:a,ys:o}}function gQ(e,t,n){if(n instanceof Ht)return[n];if(Array.isArray(n))return pt.assert(n.length===t.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+t.length+" to match the "+e+" keys "+t+"."}),n;for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i];if(n[o]==null)throw new ie("The feature data generated by the dataset lacks the required "+e+" key '"+o+"'.");r.push(n[o])}return r}function lBe(e){if(e.length===3)throw new $t("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function cBe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W,G,K;return St(this,function(ee){switch(ee.label){case 0:if(r=n.batchesPerEpoch!=null,pt.assert(e.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),pt.assert(n!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),pt.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),pt.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),pt.assert(n.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,ee.label=1;case 1:return ee.trys.push([1,,26,27]),i=n.validationData!=null,a=void 0,o=void 0,i&&(mQ(n.validationData)?pt.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(s=lBe(n.validationData),a=s.xs,o=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(ce){return"val_"+ce})):l.slice(),f=QJ(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,h=eQ(f,d,n.epochs,null,null,fBe(t,n),null,i,c),p=h.callbackList,g=h.history,p.setModel(e),e.history=g,[4,p.onTrainBegin()];case 2:return ee.sent(),e.stopTraining_=!1,m=n.initialEpoch==null?0:n.initialEpoch,[4,t.iterator()];case 3:v=ee.sent(),ee.label=4;case 4:return m<n.epochs?(y={},[4,p.onEpochBegin(m)]):[3,23];case 5:return ee.sent(),b=0,x=0,r?[3,7]:[4,t.iterator()];case 6:v=ee.sent(),ee.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,v.next()]:[3,21];case 8:return w=ee.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):w.value==null?[3,15]:(S=pQ(e,w.value),C=S.xs,_=S.ys,(E={}).batch=x,E.size=C[0].shape[0],[4,p.onBatchBegin(x,E)]);case 9:if(ee.sent(),A=[],n.classWeight==null)return[3,13];k=dQ(n.classWeight,e.outputNames),K=0,ee.label=10;case 10:return K<k.length?(I=(T=A).push,[4,hQ(_[K],null,k[K])]):[3,13];case 11:I.apply(T,[ee.sent()]),ee.label=12;case 12:return++K,[3,10];case 13:for(N=C.concat(_).concat(A),O=u(N),Ut(N),K=0;K<l.length;++K)D=l[K],L=O[K],E[D]=L,zu(L);return[4,p.onBatchEnd(x,E)];case 14:ee.sent(),JJ(E),x++,b++,ee.label=15;case 15:return(r?b>=n.batchesPerEpoch:w.done)?i?(W=void 0,mQ(n.validationData)?(G=Jn,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return W=G.apply(void 0,[ee.sent()]),[3,18];case 17:W=Jn(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?uBe:n.validationBatchSize,verbose:0})),ee.label=18;case 18:for(K=0;K<e.metricsNames.length;++K)y["val_"+e.metricsNames[K]]=W[K];ee.label=19;case 19:return[3,21];case 20:return e.stopTraining_?[3,21]:[3,7];case 21:return[4,p.onEpochEnd(m,y)];case 22:return ee.sent(),m++,e.stopTraining_?[3,23]:[3,4];case 23:return[4,p.onTrainEnd()];case 24:return ee.sent(),[4,e.history.syncData()];case 25:return ee.sent(),[2,e.history];case 26:return e.isTraining=!1,[7];case 27:return[2]}})})}function fBe(e,t){var n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function mQ(e){return typeof e.iterator=="function"}function dBe(e){return typeof e.next=="function"}function hBe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:if(r=(n=n||{}).batches!=null,i=e.testFunction,a=[],n.verbose>0)throw new $t("Verbose mode is not implemented yet.");return pt.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),dBe(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,l=0,c=function(){var p;return St(this,function(g){switch(g.label){case 0:return[4,o.next()];case 1:return p=g.sent(),a=le(function(){if(p.value){var m=pQ(e,p.value),v=m.xs,y=m.ys,b=v.concat(y),x=le(function(){return i(b)});if(Ut(b),l===0)for(var w=0;w<x.length;++w)a.push(Ve(0));var S=b[0].shape[0],C=function(_){var E=x[_],A=a[_];a[_]=le(function(){return Wt(a[_],rt(S,E))}),l>0&&Ut(A)};for(w=0;w<x.length;++w)C(w);Ut(x),u+=S,++l}return a}),p.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},h.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return h.sent()==="break"?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)d=a[f],a[f]=Cr(a[f],u),Ut(d);return[2,_a(a)]}})})}function NP(e){pt.assert(e>0&&Number.isInteger(e),function(){return"batchSize is required to be a positive integer, but got "+e})}function Bb(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(function(r){return Xh(r,t,n-t)}):Xh(e,t,n-t)}function DP(e,t){return le(function(){return e==null?null:Array.isArray(e)?e.map(function(n){return DP(n,t)}):PJ(e,t.dtype==="int32"?t:t.toInt())})}function RP(e,t){for(var n=[],r=0,i=null;r<e;)(i=r+t)>=e&&(i=e),n.push([r,i]),r=i;return n}function pBe(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p){return At(this,void 0,void 0,function(){var g,m,v,y,b,x,w,S;return St(this,function(C){switch(C.label){case 0:if(i==null&&(i=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0),g=!1,u!=null&&l!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new ie("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(m=e.checkNumSamples(n,i,h,"steps_per_epoch"))!=null&&(v=Hs(0,m)),o==null&&(o=1),y=eQ(s,o,a,d,m,h,i,g,f),b=y.callbackList,x=y.history,b.setModel(e),e.history=x,[4,b.onTrainBegin()];case 1:C.sent(),e.stopTraining_=!1,w=function(_){var E,A,k,T,I;return St(this,function(N){switch(N.label){case 0:return[4,b.onEpochBegin(_)];case 1:if(N.sent(),E={},h==null)return[3,2];throw new $t("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new $t("batch shuffling is not implemneted yet");c&&pt.shuffle(v),A=ba(v),k=RP(m,i),T=function(O){var D;return St(this,function(L){switch(L.label){case 0:return D={},[4,b.onBatchBegin(O,D)];case 1:return L.sent(),le(function(){var W=k[O][0],G=k[O][1],K=Xh(A,W,G-W);D.batch=O,D.size=G-W;for(var ee=DP(n,K),ce=t(ee),he=0;he<r.length;++he){var Oe=r[he],Te=ce[he];D[Oe]=Te,zu(Te)}if(O===k.length-1&&g){var De=e.testLoop(u,l,i);for(he=0;he<r.length;++he)Oe=r[he],Te=De[he],zu(Te),E["val_"+Oe]=Te}}),[4,b.onBatchEnd(O,D)];case 2:return L.sent(),JJ(D),e.stopTraining_?[2,"break"]:[2]}})},I=0,N.label=3;case 3:return I<k.length?[5,T(I)]:[3,6];case 4:if(N.sent()==="break")return[3,6];N.label=5;case 5:return++I,[3,3];case 6:A.dispose(),N.label=7;case 7:return[4,b.onEpochEnd(_,E)];case 8:return N.sent(),e.stopTraining_?[2,"break"]:[2]}})},S=d,C.label=2;case 2:return S<a?[5,w(S)]:[3,5];case 3:if(C.sent()==="break")return[3,5];C.label=4;case 4:return++S,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return C.sent(),[4,e.history.syncData()];case 7:return C.sent(),[2,e.history]}})})}function gBe(e,t,n,r){return r===void 0&&(r={}),At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E;return St(this,function(A){switch(A.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,A.label=1;case 1:return A.trys.push([1,,7,8]),NP(f=r.batchSize==null?32:r.batchSize),d=!1,[4,e.standardizeUserData(t,n,r.sampleWeight,r.classWeight,d,f)];case 2:if(h=A.sent(),i=h[0],a=h[1],c=h[2],p=!1,g=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(p=!0,r.validationData.length!==2)throw r.validationData.length===3?new $t("validationData including sample weights is not supported yet."):new ie("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],m=!0,[4,e.standardizeUserData(o,s,null,null,m,f)];case 3:return v=A.sent(),u=v[0],l=v[1],g=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(p=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=Bb(i,y,b),i=Bb(i,0,y),l=Bb(a,y,b),a=Bb(a,0,y),g=u.concat(l)):r.validationSteps!=null&&(p=!0),A.label=5;case 5:return x=i.concat(a).concat(c),e.checkTrainableWeightsConsistency(),w=e.makeTrainFunction(),S=e.getDedupedMetricsNames(),C=void 0,_=void 0,p?(e.makeTestFunction(),C=e.testFunction,_=S.slice().concat(S.map(function(k){return"val_"+k}))):(C=null,g=[],_=S.slice()),E=QJ(r.callbacks,r.yieldEvery),[4,pBe(e,w,x,S,f,r.epochs,r.verbose,E,C,g,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,A.sent()];case 7:return e.isTraining=!1,Zh(i,t),Zh(a,n),Zh(u,o),Zh(l,s),c!=null&&Ut(c),[7];case 8:return[2]}})})}function vQ(e){var t=[];e instanceof Ht&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(r.rank===1)t.push(Rb(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Zh(e,t){if(e!=null){var n=[];if(t instanceof Ht)n.push(t.id);else if(Array.isArray(t))t.forEach(function(u){return n.push(u.id)});else if(t!=null)for(var r in t){var i=t[r];n.push(i.id)}var a=[];if(e instanceof Ht)n.indexOf(e.id)===-1&&a.push(e);else if(Array.isArray(e))e.forEach(function(u){n.indexOf(u.id)===-1&&a.push(u)});else if(e!=null)for(var o in e){var s=e[o];n.indexOf(s.id)===-1&&a.push(s)}a.forEach(function(u){u.isDisposed||u.dispose()})}}function mBe(e){return e instanceof Ht}function FP(e){return Array.isArray(e)}function yQ(e){return!mBe(e)&&!FP(e)}function bQ(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),t==null||t.length===0){if(e!=null){var a=!1;if(FP(e)&&e.length>0)a=!0;else if(yQ(e)){for(var o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new ie("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(e==null)return t.map(function(m){return null});var s;if(yQ(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(e[c]==null)throw new ie('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(FP(e)){if((e=e).length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new ie("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=vQ(s),n!=null){for(var f=0;f<t.length;++f)if(n[f]!=null){var d=s[f];if(d.shape.length!==n[f].length)throw new ie("Error when checking "+i+": expected "+t[f]+" to have "+n[f].length+" dimension(s). but got array with shape "+d.shape);for(var h=0;h<n[f].length;++h)if(h!==0||r){var p=d.shape[h],g=n[f][h];if(g!=null&&g>=0&&p!==g)throw new ie("Error when checking "+i+": expected "+t[f]+" to have shape ["+n[f]+"], but got array with shape ["+d.shape+"].")}}}return s}function vBe(e,t,n){var r=jf(e.map(function(a){return a.shape[0]}));r.sort();var i=jf(t.map(function(a){return a.shape[0]}));if(i.sort(),r.length>1)throw new ie("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(a){return a.shape})));if(i.length>1)throw new ie("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(a){return a.shape})));if(r.length>0&&i.length>0&&!pt.arraysEqual(r,i))throw new ie("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function yBe(e,t,n){for(var r=[Yh,LE,Pb],i=0;i<e.length;++i){var a=e[i],o=t[i],s=n[i];if(o!=null){if(o===Pb&&a.shape[a.shape.length-1]===1)throw new ie("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(o)!==-1)for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var f=u[c],d=l[c];if(d!=null&&f!==d)throw new ie("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function xQ(e,t,n,r,i){var a;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(e)){if(e.length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(t.length>1)throw new ie("The model expects "+t.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(n!=null){for(var o=0;o<t.length;++o)if(n[o]!=null){var s=a[o];if(s.shape.length!==n[o].length)throw new ie("Error when checking "+i+": expected "+t[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(u!==0||r){var l=s.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new ie("Error when checking "+i+": expected "+t[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function bBe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(u){return[]});var n;if(typeof e=="string"||typeof e=="function")n=[e];else{if(!Array.isArray(e)&&typeof e!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map(function(u){return n});for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var xBe="layers-model",zb=function(e){function t(n){var r=e.call(this,n)||this;return r.isTraining=!1,r}return Ee(t,e),t.prototype.summary=function(n,r,i){if(i===void 0&&(i=console.log),!this.built)throw new ie("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");YLe(this,n,r,i)},t.prototype.compile=function(n){var r=this;if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=XLe(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof cc))throw new ie("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(n.loss)||typeof n.loss=="string"||typeof n.loss=="function")if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new ie("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+n.loss+".");var a=n.loss;i=a.map(function(m){return EP(m)})}else{var o=EP(n.loss);this.outputs.forEach(function(m){i.push(o)})}else{for(var s in n.loss=n.loss,n.loss)if(this.outputNames.indexOf(s)===-1)throw new ie('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];n.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(EP(n.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],h=this.outputNames[f];this.feedOutputNames.push(h),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var p=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Kh("loss",function(){for(var m=0;m<r.outputs.length;++m)if(p.indexOf(m)===-1){var v=r.lossFunctions[m];r.outputs.length>1&&(r.metricsTensors.push([v,m]),r.metricsNames.push(r.outputNames[m]+"_loss"))}});var g=bBe(n.metrics,this.outputNames);Kh("metric",function(){for(var m=function(y){if(p.indexOf(y)!==-1)return"continue";(function(b){for(var x,w,S,C=function(A){if(typeof A=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(A)!==-1){var k=r.internalOutputShapes[y];k[k.length-1]===1||r.lossFunctions[y]===LE?["accuracy","acc"].indexOf(A)!==-1?w=CP:["crossentropy","ce"].indexOf(A)!==-1&&(w=rQ):r.lossFunctions[y]===$E?["accuracy","acc"].indexOf(A)!==-1?w=iQ:["crossentropy","ce"].indexOf(A)!==-1&&(w=aQ):["accuracy","acc"].indexOf(A)!==-1?w=AP:["crossentropy","ce"].indexOf(A)!==-1&&(w=kP);var T=void 0;["accuracy","acc"].indexOf(A)!==-1?T="acc":["crossentropy","ce"].indexOf(A)!==-1&&(T="ce"),S=w,x=""+T}else{var I=KLe(A);S=I,x=""+jE(A)}var N;Kh(x,function(){N=S}),function(O,D,L){r.outputNames.length>1&&(D=r.outputNames[O]+"_"+D),r.metricsNames.push(D),r.metricsTensors.push([L,O])}(y,x,N)},_=0,E=b;_<E.length;_++)C(E[_])})(g[y])},v=0;v<r.outputs.length;++v)m(v)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(n,r,i){i===void 0&&(i={});var a=i.batchSize==null?32:i.batchSize;NP(a);var o=this.standardizeUserDataXY(n,r,!0,a);try{var s=o[0].concat(o[1]);this.makeTestFunction();var u=this.testFunction;return _a(this.testLoop(u,s,a,i.verbose,i.steps))}finally{Zh(o[0],n),Zh(o[1],r)}},t.prototype.evaluateDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return this.makeTestFunction(),[2,hBe(this,n,r)]})})},t.prototype.checkNumSamples=function(n,r,i,a){var o;if(a===void 0&&(a="steps"),i!=null){if(o=null,r!=null)throw new ie("If "+a+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(n==null)throw new ie("Either the input data should have a defined shape, or "+a+" shoud be specified.");o=Array.isArray(n)?n[0].shape[0]:n.shape[0]}return o},t.prototype.execute=function(n,r){if(Array.isArray(r)&&r.length===0)throw new ie("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),a=i?r:[r],o=this.retrieveSymbolicTensors(a),s=new Zm;if(n instanceof Ht&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new ie("The number of inputs provided ("+n.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],n[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var f=c[l],d=n[f.name];if(d==null)throw new ie("No value is provided for the model's input "+f.name);s.add(f,d)}var h=Lb(o,s);return i?h:h[0]},t.prototype.retrieveSymbolicTensors=function(n){for(var r=Hh(null,n.length),i=n.length,a=0,o=this.layers;a<o.length;a++){for(var s=o[a],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(h){return h.name}),c=0;c<n.length;++c){var f=l.indexOf(n[c]);if(f!==-1&&(r[c]=u[f],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(h,p){h==null&&d.push(n[p])}),new ie("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},t.prototype.predictLoop=function(n,r,i){var a=this;return r===void 0&&(r=32),i===void 0&&(i=!1),le(function(){var o=a.checkNumSamples(n);if(i)throw new $t("Verbose predictLoop() is not implemented yet.");for(var s=RP(o,r),u=a.outputs.map(function(f){return[]}),l=function(f){le(function(){var d=s[f][0],h=s[f][1],p=Bb(n,d,h),g=[];if(Array.isArray(p))for(var m=0;m<p.length;++m)g.push({key:a.inputs[m],value:p[m]});else g.push({key:a.inputs[0],value:p});var v=new Zm(g);return Lb(a.outputs,v)}).forEach(function(d,h){return u[h].push(d)})},c=0;c<s.length;++c)l(c);return _a(u.map(function(f){return Hi(f,0)}))})},t.prototype.predict=function(n,r){r===void 0&&(r={});var i=vQ(n);xQ(i,this.inputNames,this.feedInputShapes,!1);try{var a=r.batchSize==null?32:r.batchSize;return NP(a),this.predictLoop(i,a)}finally{Zh(i,n)}},t.prototype.predictOnBatch=function(n){xQ(n,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)},t.prototype.standardizeUserDataXY=function(n,r,i,a){if(this.optimizer_==null)throw new Xu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===$E?o.push(u.slice(0,u.length-1).concat([1])):o.push(u)}if(vBe(n=bQ(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=bQ(r,this.feedOutputNames,o,!1,"target")),yBe(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&n[0].shape[0]%a!=0)throw new ie("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+a+". Found: "+n[0].shape[0]+" sample(s).");return[n,r]},t.prototype.standardizeUserData=function(n,r,i,a,o,s){return o===void 0&&(o=!0),At(this,void 0,void 0,function(){var u,l,c,f,d,h,p,g;return St(this,function(m){switch(m.label){case 0:if(u=this.standardizeUserDataXY(n,r,o,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(f=null,a==null)return[3,4];d=dQ(a,this.outputNames),f=[],h=0,m.label=1;case 1:return h<d.length?(g=(p=f).push,[4,hQ(c[h],null,d[h])]):[3,4];case 2:g.apply(p,[m.sent()]),m.label=3;case 3:return++h,[3,1];case 4:return[2,[l,c,f]]}})})},t.prototype.testLoop=function(n,r,i,a,o){var s=this;return a===void 0&&(a=0),le(function(){var u=s.checkNumSamples(r,i,o,"steps"),l=[];if(a>0)throw new $t("Verbose mode is not implemented yet.");if(o!=null)throw new $t("steps mode in testLoop() is not implemented yet");for(var c=RP(u,i),f=ba(Hs(0,u)),d=0;d<c.length;++d){var h=c[d][0],p=c[d][1],g=Xh(f,h,p-h),m=DP(r,g),v=n(m);if(d===0)for(var y=0;y<v.length;++y)l.push(Ve(0));for(y=0;y<v.length;++y){var b=v[y];l[y]=Wt(l[y],rt(p-h,b))}}for(y=0;y<l.length;++y)l[y]=Cr(l[y],u);return l})},t.prototype.getDedupedMetricsNames=function(){for(var n=this.metricsNames,r=[],i=0;i<n.length;++i){var a=n[i],o=a;bJ(n,a)>1&&(o+="_"+bJ(n.slice(0,i),a)),r.push(o)}return r},t.prototype.makeTrainFunction=function(){var n=this;return function(r){var i=[],a=r.slice(0,n.inputs.length),o=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),s=r.slice(n.inputs.length+n.outputs.length,n.inputs.length+2*n.outputs.length),u=[],l=n.collectedTrainableWeights.map(function(c){return c.read()});return[n.optimizer_.minimize(function(){for(var c=[],f=0;f<n.inputs.length;++f)c.push({key:n.inputs[f],value:a[f]});var d,h=new Zm(c),p=Lb(n.outputs,h,{training:!0});for(f=0;f<n.lossFunctions.length;++f){var g=(0,n.lossFunctions[f])(o[f],p[f]);s[f]!=null&&(g=sBe(g,s[f]));var m=Fr(g);i.push(m),d=f===0?g:Wt(d,g)}for(f=0;f<n.metricsTensors.length;++f){var v=void 0;if(n.outputs.length>1&&f<n.outputs.length)v=i[f];else{var y=n.metricsTensors[f][0],b=n.metricsTensors[f][1];v=Fr(y(o[b],p[b]))}zu(v),u.push(v)}return d=Fr(d),n.calculateLosses().forEach(function(x){d=Wt(d,x)}),d},!0,l)].concat(u)}},t.prototype.makeTestFunction=function(){var n=this;this.testFunction=function(r){return le(function(){for(var i,a=[],o=r.slice(0,n.inputs.length),s=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),u=[],l=0;l<n.inputs.length;++l)u.push({key:n.inputs[l],value:o[l]});var c=new Zm(u),f=Lb(n.outputs,c);for(l=0;l<n.lossFunctions.length;++l){var d=n.lossFunctions[l],h=Fr(d(s[l],f[l]));i=l===0?h:Wt(i,h),a.push(i)}for(l=0;l<n.metricsTensors.length;++l){var p=n.metricsTensors[l][0],g=n.metricsTensors[l][1],m=Fr(p(s[g],f[g]));a.push(m)}return a})}},t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),At(this,void 0,void 0,function(){return St(this,function(a){return[2,gBe(this,n,r,i)]})})},t.prototype.fitDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return[2,cBe(this,n,r)]})})},t.prototype.trainOnBatch=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(n,r)];case 1:i=h.sent(),a=i[0],o=i[1],s=this.makeTrainFunction(),u=s(a.concat(o)),l=[],c=0,f=u,h.label=2;case 2:return c<f.length?[4,f[c].data()]:[3,5];case 3:d=h.sent(),l.push(d[0]),h.label=4;case 4:return c++,[3,2];case 5:return Ut(u),[2,_a(l)]}})})},t.prototype.getNamedWeights=function(n){for(var r=[],i=n!=null&&n.trainableOnly,a=i?this.trainableWeights:this.weights,o=this.getWeights(i),s=0;s<a.length;++s)i&&!a[s].trainable||r.push({name:a[s].originalName,tensor:o[s]});return r},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(n){this.stopTraining_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=e.prototype.dispose.call(this);if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=_S().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-_S().numTensors}return n},t.prototype.getLossIdentifiers=function(){var n;if(typeof this.loss=="string")n=fc(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(function(c){return fc(c)})}else{var a=Object.keys(this.loss);n={};for(var o=this.loss,s=0,u=a;s<u.length;s++){var l=u[s];if(typeof o[l]!="string")throw new Error("Serialization of non-string loss is not supported.");n[l]=fc(o[l])}}return n},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[fc(jE(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return fc(jE(i))});var n={};for(var r in this.metrics)n[r]=fc(jE(this.metrics[r]));return n},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,a=Ks($b(n.optimizer_config));if(typeof n.loss=="string")r=Gh(n.loss);else if(Array.isArray(n.loss))r=n.loss.map(function(s){return Gh(s)});else if(n.loss!=null)for(var o in r={},n.loss)r[o]=Gh(n.loss[o]);if(Array.isArray(n.metrics))i=n.metrics.map(function(s){return Gh(s)});else if(n.metrics!=null)for(var o in i={},n.metrics)i[o]=Gh(n.metrics[o]);this.compile({loss:r,metrics:i,optimizer:a})},t.prototype.save=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v;return St(this,function(y){switch(y.label){case 0:if(typeof n=="string"){if((i=wa.getSaveHandlers(n)).length===0)throw new ie("Cannot find any save handlers for URL '"+n+"'");if(i.length>1)throw new ie("Found more than one ("+i.length+") save handlers for URL '"+n+"'");n=i[0]}if(n.save==null)throw new ie("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,wa.encodeWeights(this.getNamedWeights(r))];case 1:return a=y.sent(),o=!1,s=null,u=this.toJSON(s,o),l={modelTopology:u,format:xBe,generatedBy:"TensorFlow.js tfjs-layers v"+lQ,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",g=(p=wa).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,g.apply(p,[y.sent(),c])];case 3:f=y.sent(),d=f.data,h=f.specs,(v=a.specs).push.apply(v,h),a.data=wa.concatenateArrayBuffers([a.data,d]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(m=!0,sQ(this.userDefinedMetadata,this.name,m),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=a.data,l.weightSpecs=a.specs,[2,n.save(l)]}})})},t.prototype.setUserDefinedMetadata=function(n){sQ(n,this.name),this.userDefinedMetadata=n},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(aBe);function wBe(e,t){return At(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l;return St(this,function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),(n=(e=e).modelTopology).model_config!=null&&(n=n.model_config),r=$b(n),i=Ks(r,t),e.weightsManifest==null?[3,2]:[4,wa.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(function(f){return f.originalName}))];case 1:for(a=c.sent(),o={},s=0,u=i.weights;s<u.length;s++)l=u[s],o[l.originalName]=a[l.originalName];i.loadWeights(o),Ut(a),c.label=2;case 2:return[2,i]}})})}function _Be(e,t){return At(this,void 0,void 0,function(){var n;return St(this,function(r){if(t==null&&(t={}),typeof e=="string"){if((n=wa.getLoadHandlers(e,t.onProgress)).length===0)n.push(wa.browserHTTPRequest(e,t));else if(n.length>1)throw new ie("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,SBe(e,void 0,t)]})})}function SBe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return St(this,function(d){switch(d.label){case 0:if(n==null&&(n={}),e.load==null)throw new ie("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),a=n.strict==null||n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=Ks($b(i),t,o),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new ie("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=EBe(r.weightData,r.weightSpecs),c=l.modelWeights,f=l.optimizerWeights,s.loadWeights(c,a),s.optimizer!=null&&f.length>0?[4,s.optimizer.setWeights(f)]:[3,3];case 2:d.sent(),d.label=3;case 3:Ut(c),Ut(f.map(function(h){return h.tensor})),d.label=4;case 4:return[2,s]}})})}function EBe(e,t){var n=wa.decodeWeights(e,t),r={},i=[];return t.forEach(function(a){a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}Ne.registerClass(zb);var wQ=function(e){function t(n){var r=e.call(this,{inputs:[],outputs:[]})||this;if(n=n||{},r.trainable=!0,r.built=!1,r.name=n.name!=null?n.name:NE("sequential_"),n.layers!=null)for(var i=0,a=n.layers;i<a.length;i++){var o=a[i];r.add(o)}return r}return Ee(t,e),t.prototype.checkShape=function(n){if(n.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new ie("Negative dimension size caused by adding layer "+n.name+" with input shape ["+n.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(n){var r,i=n instanceof t||n instanceof zb;if(i){if((r=n).outputs.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ie("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new ie("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=ZJ({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(a)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(n.inboundNodes.length!==1)throw new ie("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+n.name+" which has "+n.inboundNodes.length+" pre-existing inbound connections.");if(n.inboundNodes[0].outputTensors.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=XJ(this.outputs[0])}this.inboundNodes=[],new FE({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Hh(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(n,r){return this.model==null&&this.build(),this.model.call(n,r)},t.prototype.build=function(n){if(Kn(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new zb({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(n,r,i){i===void 0&&(i=console.log),this.built||this.build(),e.prototype.summary.call(this,n,r,i)},t.prototype.setWeights=function(n){this.model==null&&this.build(),this.model.setWeights(n)},t.prototype.evaluate=function(n,r,i){if(i===void 0&&(i={}),!this.built)throw new Xu("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)},t.prototype.evaluateDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(n,r)]})})},t.prototype.predict=function(n,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(n,r)},t.prototype.predictOnBatch=function(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)},t.prototype.compile=function(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(n){this.model.optimizer=n},enumerable:!0,configurable:!0}),t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),At(this,void 0,void 0,function(){return St(this,function(a){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.fit(n,r,i)]})})},t.prototype.fitDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.fitDataset(n,r)]})})},t.prototype.trainOnBatch=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return[2,this.model.trainOnBatch(n,r)]})})},t.fromConfig=function(n,r,i,a){var o;a===void 0&&(a=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new ie("Legacy serialization format not supported yet.");o=r}else pt.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=r.layers,delete r.layers,s=r;var u=new n(s);if(!(u instanceof t))throw new $t("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=o;l<c.length;l++){var f=Ks(c[l],void 0,a);a&&f.setFastWeightInitDuringBuild(!0),u.add(f)}return u},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ie("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(n){if(this.model==null)throw new ie("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r],o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}return{name:this.name,layers:n}},t.className="Sequential",t}(zb);function CBe(e){return new wQ(e)}function ABe(e,t){return t==null&&(t={}),_Be(e,t)}function kBe(e){return ZJ(e)}Ne.registerClass(wQ);var Mo=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),TBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=1),K4e(n,r)},t.className="elu",t}(Mo);Ne.registerClass(TBe);var OBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return vE(n)},t.className="selu",t}(Mo);Ne.registerClass(OBe);var IBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Ff(n)},t.className="relu",t}(Mo);Ne.registerClass(IBe);var NBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return le(function(){return Cm(6,Ff(n))})},t.className="relu6",t}(Mo);Ne.registerClass(NBe);var DBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return n},t.className="linear",t}(Mo);Ne.registerClass(DBe);var RBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return FS(n)},t.className="sigmoid",t}(Mo);Ne.registerClass(RBe);var FBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Y4e(n)},t.className="hardSigmoid",t}(Mo);Ne.registerClass(FBe);var MBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return sb(n)},t.className="softplus",t}(Mo);Ne.registerClass(MBe);var PBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return X4e(n)},t.className="softsign",t}(Mo);Ne.registerClass(PBe);var $Be=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return MS(n)},t.className="tanh",t}(Mo);Ne.registerClass($Be);var _Q=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),Dh(n,r)},t.className="softmax",t}(Mo);Ne.registerClass(_Q);var LBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),jS(n,r)},t.className="logSoftmax",t}(Mo);function Po(e){return e.getClassName()}function MP(e,t){return t===void 0&&(t={}),Ob(e,Ne.SerializationMap.getMap().classNameMap,t,"activation")}function qf(e){var t;return e==null?MP(t={className:"linear",config:{}}):typeof e=="string"?((t={}).className=e,t.config={},MP(t)):e instanceof Mo?e:MP(e)}function PP(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}Ne.registerClass(LBe);var SQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(Ne.Serializable),WE=function(e){function t(n){var r=e.call(this)||this;return PP(n),r.l1=n==null||n.l1==null?.01:n.l1,r.l2=n==null||n.l2==null?.01:n.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=Tn([1]);return r.hasL1&&(i=Wt(i,qr(rt(r.l1,Of(n))))),r.hasL2&&(i=Wt(i,qr(rt(r.l2,Fb(n))))),i.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(n,r){return new n({l1:r.l1,l2:r.l2})},t.className="L1L2",t}(SQ);function BBe(e){return PP(e),new WE({l1:e!=null?e.l1:null,l2:0})}function zBe(e){return PP(e),new WE({l2:e!=null?e.l2:null,l1:0})}Ne.registerClass(WE);var EQ={l1l2:"L1L2"};function Vt(e){return oP(e)}function CQ(e,t){return t===void 0&&(t={}),Ob(e,Ne.SerializationMap.getMap().classNameMap,t,"regularizer")}function rr(e){return e==null?null:typeof e=="string"?CQ({className:e in EQ?EQ[e]:e,config:{}}):e instanceof SQ?e:CQ(e)}var AQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,n!=null&&(r.maxValue=n.maxValue),r}return Ee(t,e),t.prototype.call=function(n,r){n=Dt(n);var i=Ff(n);return this.maxValue!=null&&(i=xa(i,0,this.maxValue)),i},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={maxValue:this.maxValue},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ReLU",t}(tn);Ne.registerClass(AQ);var kQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_ALPHA=.3,n==null&&(n={}),r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return mE(i,this.alpha)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LeakyReLU",t}(tn);Ne.registerClass(kQ);var TQ=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),r.supportsMasking=!0,r.alphaInitializer=nr(n.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=rr(n.alphaRegularizer),r.alphaConstraint=Gr(n.alphaConstraint),n.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(n.sharedAxes))r.sharedAxes=n.sharedAxes;else{if(typeof n.sharedAxes!="number")throw new ie("Expected sharedAxes to be a number or an array of numbers, but got "+n.sharedAxes);r.sharedAxes=[n.sharedAxes]}return r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n)).slice(1);if(this.sharedAxes!=null)for(var i=0,a=this.sharedAxes;i<a.length;i++)r[(s=a[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(this.sharedAxes!=null)for(var s=1;s<n.length;++s)o[s]=n[s];this.inputSpec=[new Fi({ndim:n.length,axes:o})],this.built=!0},t.prototype.call=function(n,r){return n=Dt(n),Eb(n,this.alpha.read())},t.prototype.getConfig=function(){var n={alphaInitializer:vn(this.alphaInitializer),alphaRegularizer:Vt(this.alphaRegularizer),alphaConstraint:Ln(this.alphaConstraint),sharedAxes:this.sharedAxes},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="PReLU",t}(tn);Ne.registerClass(TQ);var OQ=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==r.DEFAULT_ALPHA)throw new $t("Non-default alpha value ("+n.alpha+") is not supported by the ELU layer yet.");return r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return $m(i)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ELU",t}(tn);Ne.registerClass(OQ);var IQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_THETA=1,n==null&&(n={}),r.theta=n.theta==null?r.DEFAULT_THETA:n.theta,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return i.mul(Db(i.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={theta:this.theta},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ThresholdedReLU",t}(tn);Ne.registerClass(IQ);var NQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_AXIS=1,n==null&&(n={}),r.softmax=new _Q().apply,r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return this.softmax(i,this.axis)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Softmax",t}(tn);function $P(e,t,n){if(typeof e=="number")return Hh(e,t);if(e.length!==t)throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var i=e[r];if(!V4e(i))throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+i)}return e}function pc(e,t,n,r,i){return i===void 0&&(i=1),e==null?e:(a=n==="same"?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function VE(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Wf([n-t,0]);else{if(r!=="same")throw new ie("Unsupport padding mode: "+r+".");e*=t}return e}function LP(e,t){return le(function(){return Kr(t),t==="channelsFirst"?cn(e,[0,2,3,1]):e})}function DQ(e,t){return le(function(){return Kr(t),t==="channelsFirst"?cn(e,[0,2,3,4,1]):e})}function jBe(e,t,n,r,i,a,o){return r===void 0&&(r=1),i===void 0&&(i="valid"),o===void 0&&(o=1),le(function(){if(a==null&&(a=qs()),Kr(a),e.shape.length!==3)throw new ie("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(t.shape.length!==3)throw new ie("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(n!=null&&n.shape.length!==1)throw new ie("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(a==="channelsFirst"&&(e=cn(e,[0,2,1])),i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=iE(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(s=hc(s,n)),s})}function RQ(e,t,n,r,i,a,o,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),le(function(){if(a==null&&(a=qs()),Kr(a),e.rank!==3&&e.rank!==4)throw new ie("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+e.rank+".");if(t.rank!==3&&t.rank!==4)throw new ie("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+e.rank+".");var u=LP(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Pf.conv2d({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),a==="channelsFirst"&&(u=cn(u,[0,3,1,2])),u})}function UBe(e,t,n,r,i,a,o){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),le(function(){if(a==null&&(a=qs()),Kr(a),e.rank!==4&&e.rank!==5)throw new ie("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(t.rank!==4&&t.rank!==5)throw new ie("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=DQ(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=aE(s,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(s=hc(s,n)),a==="channelsFirst"&&(s=cn(s,[0,4,1,2,3])),s})}Ne.registerClass(NQ);var FQ=function(e){function t(n,r){var i=e.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(r),i.rank=n,Sa(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new $t("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=$P(r.kernelSize,n,"kernelSize"),i.strides=$P(r.strides==null?1:r.strides,n,"strides"),i.padding=r.padding==null?"valid":r.padding,ss(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Kr(i.dataFormat),i.activation=qf(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=nr(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Gr(r.biasConstraint),i.biasRegularizer=rr(r.biasRegularizer),i.activityRegularizer=rr(r.activityRegularizer),i.dilationRate=$P(r.dilationRate==null?1:r.dilationRate,n,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new ie("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new ie("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new ie("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return Ee(t,e),t.verifyArgs=function(n){if(Yu("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,3))throw new ie("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(n.kernelSize)+".")},t.prototype.getConfig=function(){var n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Po(this.activation),useBias:this.useBias,biasInitializer:vn(this.biasInitializer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),qE=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.kernel=null,t.verifyArgs(r),i.filters=r.filters,Sa(i.filters,"filters"),i.kernelInitializer=nr(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Gr(r.kernelConstraint),i.kernelRegularizer=rr(r.kernelRegularizer),i}return Ee(t,e),t.prototype.build=function(n){var r;n=Kn(n);var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the input should be defined. Found "+n[i]);var a=n[i],o=this.kernelSize.concat([a,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=a,r)}],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;n=Dt(n);var o=i.bias==null?null:i.bias.read(),s=wJ(i.activation.getClassName());if(s!=null&&i.rank===2)a=RQ(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)a=jBe(n,i.kernel.read(),o,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)a=RQ(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new $t("convolutions greater than 3D are not implemented yet.");a=UBe(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(a=i.activation.apply(a))}return a})},t.prototype.computeOutputShape=function(n){n=Kn(n);for(var r=[],i=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2),a=0;a<i.length;++a){var o=pc(i[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);r.push(o)}var s=[n[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},t.prototype.getConfig=function(){var n={filters:this.filters,kernelInitializer:vn(this.kernelInitializer),kernelRegularizer:Vt(this.kernelRegularizer),kernelConstraint:Ln(this.kernelConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.verifyArgs=function(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new ie("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(n.filters))},t}(FQ),BP=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,2))throw new ie("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv2D",t}(qE);Ne.registerClass(BP);var MQ=function(e){function t(n){var r=e.call(this,3,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&(!Array.isArray(n.kernelSize)||n.kernelSize.length!==1&&n.kernelSize.length!==3))throw new ie("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv3D",t}(qE);Ne.registerClass(MQ);var PQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.inputSpec=[new Fi({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new ie("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Kn(n)).length!==4)throw new ie("Input should have rank 4; Received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the inputs should be defined. Found `None`.");var a=n[i],o=this.kernelSize.concat([this.filters,a]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fi({ndim:4,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);if(a.shape.length!==4)throw new ie("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+a.shape.length);var o,s,u=a.shape,l=u[0];i.dataFormat==="channelsFirst"?(o=2,s=3):(o=1,s=2);var c=u[o],f=u[s],d=i.kernelSize[0],h=i.kernelSize[1],p=i.strides[0],g=i.strides[1],m=[l,VE(c,p,d,i.padding),VE(f,g,h,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(a=cn(a,[0,2,3,1]));var v=oE(a,i.kernel.read(),m,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(v=cn(v,[0,3,1,2])),i.bias!=null&&(v=hc(v,i.bias.read(),i.dataFormat)),i.activation!=null&&(v=i.activation.apply(v)),v})},t.prototype.computeOutputShape=function(n){var r,i,a,o=(n=Kn(n)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[r]=this.filters,o[i]=VE(o[i],l,s,this.padding),o[a]=VE(o[a],c,u,this.padding),o},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.dilationRate,n},t.className="Conv2DTranspose",t}(BP);Ne.registerClass(PQ);var WBe=function(e){function t(n,r){var i=e.call(this,n,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new ie("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new ie("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new ie("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=nr(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=rr(r.depthwiseRegularizer),i.depthwiseConstraint=Gr(r.depthwiseConstraint),i.pointwiseInitializer=nr(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=rr(r.pointwiseRegularizer),i.pointwiseConstraint=Gr(r.pointwiseConstraint),i}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Kn(n)).length<this.rank+2)throw new ie("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null||n[i]<0)throw new ie("The channel dimension of the inputs should be defined, but found "+JSON.stringify(n[i]));for(var a=n[i],o=this.kernelSize.concat([a,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(a*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fi({ndim:this.rank+2,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;if(n=Dt(n),i.rank===1)throw new $t("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(n=cn(n,[0,2,3,1])),a=wM(n,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(a=hc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),i.dataFormat==="channelsFirst"&&(a=cn(a,[0,3,1,2])),a})},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.pointwiseInitializer=vn(this.pointwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.pointwiseRegularizer=Vt(this.pointwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseConstraint),n.pointwiseConstraint=Ln(this.pointwiseConstraint),n},t.className="SeparableConv",t}(qE),$Q=function(e){function t(n){return e.call(this,2,n)||this}return Ee(t,e),t.className="SeparableConv2D",t}(WBe);Ne.registerClass($Q);var LQ=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.dataFormat,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,1))throw new ie("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv1D",t}(qE);Ne.registerClass(LQ);var BQ=function(e){function t(n){var r=e.call(this,n)||this;return typeof n.cropping=="number"?r.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?r.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:r.cropping=n.cropping,r.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,r.inputSpec=[{ndim:4}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return n=Dt(n),i.dataFormat==="channelsLast"?TE(TE(n,i.cropping[0][0],n.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],n.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):TE(TE(n,i.cropping[0][0],n.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],n.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},t.prototype.getConfig=function(){var n={cropping:this.cropping,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Cropping2D",t}(tn);Ne.registerClass(BQ);var zQ=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=n.size==null?r.DEFAULT_SIZE:n.size,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){if(this.dataFormat==="channelsFirst"){var r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}return r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2],[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n),o=a.shape;if(i.dataFormat==="channelsFirst"){a=cn(a,[0,2,3,1]);var s=i.size[0]*o[2],u=i.size[1]*o[3],l=a.resizeNearestNeighbor([s,u]);return cn(l,[0,3,1,2])}return s=i.size[0]*o[1],u=i.size[1]*o[2],a.resizeNearestNeighbor([s,u])})},t.prototype.getConfig=function(){var n={size:this.size,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="UpSampling2D",t}(tn);function VBe(e,t,n,r,i,a){return n===void 0&&(n=[1,1]),r===void 0&&(r="valid"),le(function(){i==null&&(i=qs()),Kr(i);var o=LP(e,i);if(e.rank!==4)throw new ie("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(t.rank!==4)throw new ie("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=Mm(o,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}Ne.registerClass(zQ);var jQ=function(e){function t(n){var r=e.call(this,2,n)||this;return r.depthwiseKernel=null,r.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,r.depthwiseInitializer=nr(n.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Gr(n.depthwiseConstraint),r.depthwiseRegularizer=rr(n.depthwiseRegularizer),r}return Ee(t,e),t.prototype.build=function(n){if((n=Kn(n)).length<4)throw new ie("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(n)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new ie("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+n[r]+").");var i=n[r],a=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=VBe(n=Dt(n),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(a=hc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),a})},t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,o=pc(r,this.kernelSize[0],this.padding,this.strides[0]),s=pc(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],a,o,s]:[n[0],o,s,a]},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseRegularizer),n},t.className="DepthwiseConv2D",t}(FQ);Ne.registerClass(jQ);var zP=function(e){function t(n){var r=e.call(this,n)||this;return r.rate=Math.max(Math.min(n.rate,1),0),r.noiseShape=n.noiseShape,r.seed=n.seed,r.supportsMasking=!0,r}return Ee(t,e),t.prototype.getNoiseShape=function(n){if(this.noiseShape==null)return this.noiseShape;for(var r=n.shape,i=[],a=0;a<this.noiseShape.length;++a)i.push(this.noiseShape[a]==null?r[a]:this.noiseShape[a]);return i},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(0<i.rate&&i.rate<1){var o=r.training!=null&&r.training,s=i.getNoiseShape(a);return Km(function(){return $J(a,i.rate,s,i.seed)},function(){return a},o)}return n})},t.prototype.getConfig=function(){var n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.dispose=function(){return e.prototype.dispose.call(this)},t.className="Dropout",t}(tn);Ne.registerClass(zP);var UQ=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getNoiseShape=function(n){var r=n.shape;return[r[0],1,r[2]]},t.className="SpatialDropout1D",t}(zP);Ne.registerClass(UQ);var WQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){var i=null;n.batchSize!=null&&(i=n.batchSize),r.batchInputShape=[i,n.inputDim]}return r.units=n.units,Sa(r.units,"units"),r.activation=qf(n.activation),n.useBias!=null&&(r.useBias=n.useBias),r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Gr(n.kernelConstraint),r.biasConstraint=Gr(n.biasConstraint),r.kernelRegularizer=rr(n.kernelRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.activityRegularizer=rr(n.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Ee(t,e),t.prototype.build=function(n){var r,i=(n=Kn(n))[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},t.prototype.computeOutputShape=function(n){var r=(n=Kn(n)).slice();return r[r.length-1]=this.units,r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a,o=Dt(n),s=wJ(i.activation.getClassName());return s!=null?a=dc(o,i.kernel.read(),s,i.bias?i.bias.read():null):(a=dc(o,i.kernel.read()),i.bias!=null&&(a=hc(a,i.bias.read())),i.activation!=null&&(a=i.activation.apply(a))),a})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dense",t}(tn);Ne.registerClass(WQ);var VQ=function(e){function t(n){var r=this;return n=n||{},(r=e.call(this,n)||this).inputSpec=[{minNDim:3}],r.dataFormat=n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){for(var r=0,i=(n=Kn(n)).slice(1);r<i.length;r++)if(i[r]==null)throw new ie('The shape of the input to "Flatten" is not fully defined (got '+n.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[n[0],Uf(n,1)]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(i.dataFormat==="channelsFirst"&&a.rank>1){for(var o=[0],s=2;s<a.rank;++s)o.push(s);o.push(1),a=a.transpose(o)}return G4e(a)})},t.prototype.getConfig=function(){var n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);var r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Flatten",t}(tn);Ne.registerClass(VQ);var qQ=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.activation=qf(n.activation),r}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.activation.apply(a)})},t.prototype.getConfig=function(){var n={activation:Po(this.activation)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Activation",t}(tn);Ne.registerClass(qQ);var HQ=function(e){function t(n){var r=e.call(this,n)||this;return r.n=n.n,r.inputSpec=[{ndim:2}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],this.n,n[1]]},t.prototype.call=function(n,r){var i=this;return le(function(){return q4e(n=Dt(n),i.n)})},t.prototype.getConfig=function(){var n={n:this.n},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="RepeatVector",t}(tn);Ne.registerClass(HQ);var GQ=function(e){function t(n){var r=e.call(this,n)||this;r.targetShape=n.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return Ee(t,e),t.prototype.isUnknown=function(n){return n<0||n==null},t.prototype.fixUnknownDimension=function(n,r){for(var i="Total size of new array must be unchanged.",a=r.slice(),o=1,s=null,u=0;u<a.length;++u){var l=a[u];if(this.isUnknown(l)){if(s!==null)throw new ie("Can only specifiy one unknown dimension.");s=u}else o*=l}var c=Uf(n);if(s!==null){if(o===0||c%o!=0)throw new ie(i);a[s]=c/o}else if(c!==o)throw new ie(i);return a},t.prototype.computeOutputShape=function(n){for(var r=!1,i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=a.shape,s=o.slice(0,1).concat(i.fixUnknownDimension(o.slice(1),i.targetShape));return a.reshape(s)})},t.prototype.getConfig=function(){var n={targetShape:this.targetShape},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Reshape",t}(tn);Ne.registerClass(GQ);var KQ=function(e){function t(n){var r=e.call(this,n)||this;if(n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+n.dims+" instead.");var i=Hs(1,n.dims.length+1);if(!pt.arraysEqual(n.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=n.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Fi({ndim:r.dims.length+1})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=(n=Kn(n)).slice();return this.dims.forEach(function(i,a){r[a+1]=n[i]}),r},t.prototype.call=function(n,r){return cn(Dt(n),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var n={dims:this.dims},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Permute",t}(tn);Ne.registerClass(KQ);var XQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,r.maskValue=n!=null?n.maskValue==null?0:n.maskValue:0,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,n),r},t.prototype.computeMask=function(n,r){var i=Dt(n);return wb(Rm(i,this.maskValue),-1)},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=wb(Rm(a,i.maskValue),-1,!0);return a.mul(o.asType(a.dtype))})},t.className="Masking",t}(tn);Ne.registerClass(XQ);var YQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){var i=null;n.batchSize!=null&&(i=n.batchSize),n.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Jn(n.inputLength))}return r.inputDim=n.inputDim,Sa(r.inputDim,"inputDim"),r.outputDim=n.outputDim,Sa(r.outputDim,"outputDim"),r.embeddingsInitializer=nr(n.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=rr(n.embeddingsRegularizer),r.activityRegularizer=rr(n.activityRegularizer),r.embeddingsConstraint=Gr(n.embeddingsConstraint),r.maskZero=n.maskZero,r.supportsMasking=n.maskZero,r.inputLength=n.inputLength,r}return Ee(t,e),t.prototype.build=function(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(n){},t.prototype.computeMask=function(n,r){var i=this;return le(function(){return i.maskZero?(n=Dt(n),Rm(n,en(n))):null})},t.prototype.computeOutputShape=function(n){if(n=Kn(n),this.inputLength==null)return n.concat([this.outputDim]);var r=Jn(this.inputLength);if(r.length!==n.length-1)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);for(var i=0,a=0;a<r.length;++a){var o=r[a],s=n[a+1];if(o!=null&&s!=null&&o!==s)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);o==null&&(r[i]=s),i++}return[n[0]].concat(r,[this.outputDim])},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return a.dtype!=="int32"&&(a=Db(a,"int32")),PJ(i.embeddings.read(),a.as1D()).reshape(Kn(i.computeOutputShape(a.shape)))})},t.prototype.getConfig=function(){var n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vn(this.embeddingsInitializer),embeddingsRegularizer:Vt(this.embeddingsRegularizer),activityRegularizer:Vt(this.activityRegularizer),embeddingsConstraint:Ln(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Embedding",t}(tn);Ne.registerClass(YQ);var Jh=function(e){function t(n){var r=e.call(this,n||{})||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.mergeFunction=function(n){throw new $t},t.prototype.computeElementwiseOpOutputShape=function(n,r){if(n==null||r==null)return null;if(n.length<r.length)return this.computeElementwiseOpOutputShape(r,n);if(r.length===0)return n;for(var i=n.slice(0,n.length-r.length),a=0;a<r.length;++a){var o=n[n.length-r.length+a],s=r[a];if(o==null||s==null||o<0||s<0)i.push(null);else if(o===1)i.push(s);else if(s===1)i.push(o);else{if(o!==s)throw new ie("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(r));i.push(o)}}return i},t.prototype.build=function(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Kn(n)]),(n=n).length<2)throw new ie("A merge layer should be called on an Array of at least 2 inputs. Got "+n.length+" input(s).");for(var r=[],i=0,a=n;i<a.length;i++)(u=a[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=jf(r)).length>1)throw new ie("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(n)+".");for(var o=n[0]==null?null:n[0].slice(1),s=1;s<n.length;++s){var u=n[s]==null?null:n[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var l=n.map(function(c){return c.length});n.indexOf(null)===-1&&jf(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if(n=n,i.reshapeRequired){var a=[],o=n.map(function(_){return _.rank});if(o.indexOf(null)===-1){for(var s=Wf(o),u=0,l=n;u<l.length;u++){for(var c=(g=l[u]).rank,f=0;f<s-c;++f)g=Rb(g,1);a.push(g)}return i.mergeFunction(a)}for(var d=!1,h=0,p=n;h<p.length;h++){var g;if((c=(g=p[h]).rank)==null){var m=g.shape,v=m[0],y=m.slice(1).concat([v]),b=g.reshape([v].concat(Uf(m.slice(1))));b=(b=cn(b,[1,0])).reshape(y),a.push(b),d=!0}else if(c>1){var x=Hs(1,c).concat([0]);a.push(cn(g,x)),d=!0}else a.push(g)}var w=i.mergeFunction(a),S=w.rank;if(d)if(S==null){var C=w.shape;y=[v=C[C.length-1]].concat(C.slice(0,C.length-1)),w=cn(w.reshape([-1,v]),[1,0]).reshape(y)}else S>1&&(x=[S-1].concat(Hs(0,S-1)),w=cn(w,x));return w}return i.mergeFunction(n)})},t.prototype.computeOutputShape=function(n){var r;r=(n=n)[0]==null?null:n[0].slice(1);for(var i=1;i<n.length;++i){var a=n[i]==null?null:n[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}for(var o=[],s=0,u=n;s<u.length;s++)(a=u[s])!=null&&a[0]!==null&&o.push(a[0]);return r=(o=jf(o)).length===1?o.concat(r):[null].concat(r)},t.prototype.computeMask=function(n,r){return le(function(){if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an Array");if(!Array.isArray(n))throw new ie("`inputs` should be an Array");if(r.length!==n.length)throw new ie("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+n.length+" vs "+r.length+")");if(r.every(function(o){return o==null}))return null;for(var i=(r=r.map(function(o){return o==null?o:Do(o,0)}))[0],a=1;a<r.length-1;++a)i=Hu(i,r[a]);return i})},t}(tn),ZQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return r})},t.className="Add",t}(Jh);Ne.registerClass(ZQ);var JQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=rt(r,n[i]);return r})},t.className="Multiply",t}(Jh);Ne.registerClass(JQ);var QQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return rt(1/n.length,r)})},t.className="Average",t}(Jh);Ne.registerClass(QQ);var eee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=Vu(r,n[i]);return r})},t.className="Maximum",t}(Jh);Ne.registerClass(eee);var tee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=Cm(r,n[i]);return r})},t.className="Minimum",t}(Jh);Ne.registerClass(tee);var nee=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_AXIS=-1,n==null&&(n={}),r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){if(!Array.isArray(n)||!Array.isArray(n[0])||n.length===1)throw new ie("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,a=n=n;i<a.length;i++)if((d=a[i])!=null){r=!1;break}if(!r){for(var o=[],s=0;s<n.length;++s){var u=n[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,f=o;c<f.length;c++){var d=f[c];if(pt.arraysEqual(d,u)){l=!0;break}}l||o.push(u)}if(o.length>1)throw new ie("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}},t.prototype.mergeFunction=function(n){var r=this;return le(function(){return FJ(n,r.axis)})},t.prototype.computeOutputShape=function(n){if(!Array.isArray(n)||!Array.isArray(n[0]))throw new ie("A `Concatenate` layer should be called on a list of inputs.");for(var r=n,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis,o=0,s=r.slice(1);o<s.length;o++){var u=s[o];if(i[a]==null||u[a]==null){i[a]=null;break}i[a]+=u[a]}return i},t.prototype.computeMask=function(n,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new ie("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new ie("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+n.length+")");return le(function(){var a=!0;if(r.forEach(function(l){l==null||(a=!1)}),a)return null;for(var o=[],s=0;s<n.length;++s)r[s]==null?o.push(No(n[s]).asType("bool")):r[s].rank<n[s].rank?o.push(Do(r[s],-1)):o.push(r[s]);var u=Hi(o,i.axis);return hE(u,-1,!1)})},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Concatenate",t}(Jh);function jb(e,t){for(;e<0;)e+=t;return e}function qBe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new $t("batchDot is not implemented for tensors of 4D or higher rank yet");if(pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length}),pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new $t("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);var a=n;return le(function(){var o,s;if(r>i){o=r-i;for(var u=[],l=0;l<o;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){for(o=i-r,u=[],l=0;l<o;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else o=0;if(e.shape.length===2&&t.shape.length===2)s=a[0]===a[1]?e.mulStrict(t).sum(a[0]):e.transpose([1,0]).mulStrict(t).sum(a[1]);else{var c=a[0]!==e.shape.length-1,f=a[1]===t.shape.length-1;s=e.matMul(t,c,f)}if(o>0){var d=void 0,h=[];for(l=d=r>i?r+i-3:r-1;l<d+o;++l)h.push(l);s=s.squeeze(h)}return s.shape.length===1&&(s=s.expandDims(1)),s})}Ne.registerClass(nee);var ree=function(e){function t(n){var r=e.call(this,n)||this;return r.axes=n.axes,r.normalize=n.normalize!=null&&n.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0],i=n[1];if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);if(r[a[0]]!==i[a[1]])throw new ie("Dimension incompatibility: "+r[a[0]]+" !== "+i[a[1]])},t.prototype.mergeFunction=function(n){if(n.length!==2)throw new ie("A `Dot` layer must be called on exactly 2 inputs, but received "+n.length+" input(s).");var r,i=n[0],a=n[1];return r=Array.isArray(this.axes)?this.axes.map(function(o,s){return jb(o,n[s].shape.length)}):[jb(this.axes,i.shape.length),jb(this.axes,a.shape.length)],this.normalize&&(i=ME(i,r[0]),a=ME(a,r[1])),qBe(i,a,r)},t.prototype.interpretAxes=function(n,r){return Array.isArray(this.axes)?this.axes:[jb(this.axes,n.length),jb(this.axes,r.length)]},t.prototype.computeOutputShape=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);r.splice(a[0],1),i.splice(a[1],1),i.splice(0,1);var o=r.concat(i);return o.length===1&&o.push(1),o},t.prototype.computeMask=function(n,r){return null},t.prototype.getConfig=function(){var n={axes:this.axes,normalize:this.normalize},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dot",t}(Jh);Ne.registerClass(ree);var iee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.stddev=n.stddev,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return Km(function(){return OE(a.shape,0,i.stddev).add(a)},function(){return a},r.training||!1)})},t.className="GaussianNoise",t}(tn);Ne.registerClass(iee);var aee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.rate>0&&i.rate<1?Km(function(){var o=Math.sqrt(i.rate/(1-i.rate));return a.mul(OE(a.shape,1,o))},function(){return a},r.training||!1):a})},t.className="GaussianDropout",t}(tn);Ne.registerClass(aee);var oee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r.noiseShape=n.noiseShape,r}return Ee(t,e),t.prototype._getNoiseShape=function(n){return this.noiseShape||Dt(n).shape},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){if(i.rate<1&&i.rate>0){var a=i._getNoiseShape(n);return Km(function(){var o=Dt(n),s=-1.7580993408473766,u=yb(zh(a),i.rate);u=Db(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return o.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Dt(n)},r.training||!1)}return n})},t.className="AlphaDropout",t}(tn);function Ub(e,t,n,r,i,a){var o;if(a===void 0&&(a=.001),e.rank===2)o=aM(e,t,n,r,i,a);else if(e.rank===3)o=oM(e,t,n,r,i,a);else{if(e.rank!==4)throw new $t("batchNormalization is not implemented for array of rank "+e.rank+" yet");o=sM(e,t,n,r,i,a)}return o}function HBe(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){var a=Sb(e,r),o=a.mean,s=a.variance;return[Ub(e,o,s,n,t,i),o,s]})}function GBe(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){for(var a=Sb(e,r),o=a.mean,s=a.variance,u=[],l=0,c=Hs(0,e.rank);l<c.length;l++){var f=c[l];r.indexOf(f)!==-1?u.push(1):u.push(e.shape[f])}var d=o.reshape(u),h=s.reshape(u),p=t==null?null:t.reshape(u),g=n==null?null:n.reshape(u);return[Ub(e,d,h,g,p,i),o,s]})}function KBe(e,t,n,r,i){return i===void 0&&(i=.001),pt.arraysEqual(r.slice().sort(),Hs(0,e.rank-1))?HBe(e,t,n,r,i):GBe(e,t,n,r,i)}Ne.registerClass(oee);var see=function(e){function t(n){var r=this;return n==null&&(n={}),(r=e.call(this,n)||this).supportsMasking=!0,r.axis=n.axis==null?-1:n.axis,r.momentum=n.momentum==null?.99:n.momentum,r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=nr(n.betaInitializer||"zeros"),r.gammaInitializer=nr(n.gammaInitializer||"ones"),r.movingMeanInitializer=nr(n.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=nr(n.movingVarianceInitializer||"ones"),r.betaConstraint=Gr(n.betaConstraint),r.gammaConstraint=Gr(n.gammaConstraint),r.betaRegularizer=rr(n.betaRegularizer),r.gammaRegularizer=rr(n.gammaRegularizer),r}return Ee(t,e),t.prototype.build=function(n){var r;n=Kn(n);var i=this.axis>=0?this.axis:this.axis+n.length,a=n[i];if(a==null)throw new ie("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(n)+".");this.inputSpec=[new Fi({ndim:n.length,axes:(r={},r[i]=a,r)})];var o=[a];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training,o=Dt(n),s=o.shape,u=s.length,l=Hs(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var f=Hh(1,u);f[c]=s[c];var d=l.slice();d.sort();var h=!pt.arraysEqual(d,Hs(0,u).slice(0,u-1));if(!a)return function(){if(h){var b=i.movingMean.read().reshape(f),x=i.movingVariance.read().reshape(f),w=i.center?i.beta.read().reshape(f):null,S=i.scale?i.gamma.read().reshape(f):null;return Ub(o,b,x,w,S,i.epsilon)}return Ub(o,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var p=KBe(o,i.gamma.read(),i.beta.read(),l,i.epsilon),g=p[0],m=p[1],v=p[2],y=function(b,x,w){le(function(){var S=1-w,C=b.read(),_=C.sub(x).mul(S);b.write(C.sub(_))})};return y(i.movingMean,m,i.momentum),y(i.movingVariance,v,i.momentum),g})},t.prototype.getConfig=function(){var n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),movingMeanInitializer:vn(this.movingMeanInitializer),movingVarianceInitializer:vn(this.movingVarianceInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer),betaConstraint:Ln(this.betaConstraint),gammaConstraint:Ln(this.gammaConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="BatchNormalization",t}(tn);Ne.registerClass(see);var uee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).axis=n.axis==null?-1:n.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,a=r.axis;i<a.length;i++){var o=a[i];if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=nr(n.betaInitializer||"zeros"),r.gammaInitializer=nr(n.gammaInitializer||"ones"),r.betaRegularizer=rr(n.betaRegularizer),r.gammaRegularizer=rr(n.gammaRegularizer),r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var a=0,o=this.axis;a<o.length;a++){var s=o[a];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==jf(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return n[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(n,r){var i=this,a=Dt(n),o=a.shape,s=o.length;return le(function(){for(var u=Sb(a,i.axis,!0),l=u.mean,c=u.variance,f=Hh(1,s),d=0,h=i.axis;d<h.length;d++){var p=h[d];f[p]=o[p]}for(var g=function(w){return w!=null&&w.shape.length!==s&&i.axis!==[s-1]?w.reshape(f):w},m=g(i.gamma.read()),v=g(i.beta.read()),y=[],b=[],x=0;x<s;++x)i.axis.indexOf(x)!==-1?(y.push(o[x]),b.push(1)):(y.push(1),b.push(o[x]));return l=l.tile(y),c=c.tile(y),m=m.tile(b),v=v.tile(b),Ub(a,l,c,v,m,i.epsilon)})},t.prototype.getConfig=function(){var n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LayerNormalization",t}(tn);function XBe(e,t,n){return le(function(){if(e.rank!==4)throw new ie("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ie("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=qs()),n!=="channelsLast"&&n!=="channelsFirst")throw new ie("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=n==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Gu(e,r)})}Ne.registerClass(uee);var lee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).dataFormat=n.dataFormat==null?qs():n.dataFormat,n.padding==null)r.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")r.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new ie("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+n.padding.length+" array.");var i=void 0,a=void 0;if(typeof n.padding[0]=="number")i=[n.padding[0],n.padding[0]],a=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new ie("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+n.padding[0].length+" array.");if(i=n.padding[0],n.padding[1].length!==2)throw new ie("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+n.padding[1].length+" array.");a=n.padding[1]}r.padding=[i,a]}return r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r,i;return n=Kn(n),this.dataFormat==="channelsFirst"?(r=n[2]!=null&&n[2]>=0?n[2]+this.padding[0][0]+this.padding[0][1]:null,i=n[3]!=null&&n[3]>=0?n[3]+this.padding[1][0]+this.padding[1][1]:null,[n[0],n[1],r,i]):(r=n[1]!=null&&n[1]>=0?n[1]+this.padding[0][0]+this.padding[0][1]:null,i=n[2]!=null&&n[2]>=0?n[2]+this.padding[1][0]+this.padding[1][1]:null,[n[0],r,i,n[3]])},t.prototype.call=function(n,r){var i=this;return le(function(){return XBe(Dt(n),i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={padding:this.padding,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ZeroPadding2D",t}(tn);function HE(e,t,n,r,i,a){return le(function(){var o;Kr(i),TJ(a),ss(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=qs()),a==null&&(a="max"),e=LP(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?uE(e,t,n,s):lE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}function cee(e,t,n,r,i,a){return le(function(){var o;Kr(i),TJ(a),ss(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=qs()),a==null&&(a="max"),e=DQ(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?cE(e,t,n,s):fE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,4,1,2,3])),o})}Ne.registerClass(lee);var fee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=2),r=e.call(this,n)||this,typeof n.poolSize=="number")r.poolSize=[n.poolSize];else{if(!Array.isArray(n.poolSize)||n.poolSize.length!==1||typeof n.poolSize[0]!="number")throw new ie("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.poolSize));r.poolSize=n.poolSize}if(Sa(r.poolSize,"poolSize"),n.strides==null)r.strides=r.poolSize;else if(typeof n.strides=="number")r.strides=[n.strides];else{if(!Array.isArray(n.strides)||n.strides.length!==1||typeof n.strides[0]!="number")throw new ie("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.strides));r.strides=n.strides}return Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,ss(r.padding),r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=pc((n=Kn(n))[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],r,n[2]]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r),n=Rb(Dt(n),2);var a=i.poolingFunction(Dt(n),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return ib(a,[2])})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),dee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),HE(n,r,i,a,o,"max")},t.className="MaxPooling1D",t}(fee);Ne.registerClass(dee);var hee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),HE(n,r,i,a,o,"avg")},t.className="AveragePooling1D",t}(fee);Ne.registerClass(hee);var pee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new ie("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),ss(r.padding),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2];return r=pc(r,this.poolSize[0],this.padding,this.strides[0]),i=pc(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i]:[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),gee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),HE(n,r,i,a,o,"max")},t.className="MaxPooling2D",t}(pee);Ne.registerClass(gee);var mee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),HE(n,r,i,a,o,"avg")},t.className="AveragePooling2D",t}(pee);Ne.registerClass(mee);var vee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new ie("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),ss(r.padding),r.inputSpec=[new Fi({ndim:5})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[4]:n[3];return r=pc(r,this.poolSize[0],this.padding,this.strides[0]),i=pc(i,this.poolSize[1],this.padding,this.strides[1]),a=pc(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i,a]:[n[0],r,i,a,n[4]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),yee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),cee(n,r,i,a,o,"max")},t.className="MaxPooling3D",t}(vee);Ne.registerClass(yee);var bee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),cee(n,r,i,a,o,"avg")},t.className="AveragePooling3D",t}(vee);Ne.registerClass(bee);var xee=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],n[2]]},t.prototype.call=function(n,r){throw new $t},t}(tn),wee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Fr(i,1)})},t.className="GlobalAveragePooling1D",t}(xee);Ne.registerClass(wee);var _ee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Rf(i,1)})},t.className="GlobalMaxPooling1D",t}(xee);Ne.registerClass(_ee);var See=function(e){function t(n){var r=e.call(this,n)||this;return r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]},t.prototype.call=function(n,r){throw new $t},t.prototype.getConfig=function(){var n={dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Eee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Fr(a,[1,2]):Fr(a,[2,3])})},t.className="GlobalAveragePooling2D",t}(See);Ne.registerClass(Eee);var Cee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Rf(a,[1,2]):Rf(a,[2,3])})},t.className="GlobalMaxPooling2D",t}(See);function Aee(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new ie("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function kee(e,t,n,r,i,a,o,s){return r===void 0&&(r=!1),o===void 0&&(o=!1),s===void 0&&(s=!1),le(function(){var u=t.shape.length;if(u<3)throw new ie("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Hs(2,u));if(t=cn(t,l),a!=null)throw new $t("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Do(i,-1)),i=cn(i,l)),r&&(t=Ku(t,0),i!=null&&(i=Ku(i,0)));var c,f,d=[],h=n,p=t.shape[0],g=Tf(t);i!=null&&(f=Tf(i));for(var m,v=function(b){var x=g[b],w=le(function(){return e(x,h)});if(i==null)c=w[0],h=w[1];else{var S=le(function(){var C=f[b],_=No(C).sub(C);return{output:w[0].mul(C).addStrict(h[0].mul(_)),newStates:h.map(function(E,A){return w[1][A].mul(C).addStrict(E.mul(_))})}});c=S.output,h=S.newStates}s&&d.push(c)},y=0;y<p;++y)v(y);return s&&(m=as(d,1)),[c,m,h]})}Ne.registerClass(Cee);var Jm=function(e){function t(n){var r,i=e.call(this,n)||this;if(n.cell==null)throw new ie("cell property is missing for the constructor of RNN.");if((r=Array.isArray(n.cell)?new VP({cells:n.cell}):n.cell).stateSize==null)throw new ie("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=n.returnSequences!=null&&n.returnSequences,i.returnState=n.returnState!=null&&n.returnState,i.goBackwards=n.goBackwards!=null&&n.goBackwards,i._stateful=n.stateful!=null&&n.stateful,i.unroll=n.unroll!=null&&n.unroll,i.supportsMasking=!0,i.inputSpec=[new Fi({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return Ee(t,e),t.prototype.getStates=function(){return this.states_==null?Hs(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(n){return null}):this.states_},t.prototype.setStates=function(n){this.states_=n},t.prototype.computeOutputShape=function(n){xP(n)&&(n=n[0]),n=n;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[n[0],n[1],a]:[n[0],a],this.returnState){for(var o=[],s=0,u=r;s<u.length;s++){var l=u[s];o.push([n[0],l])}return[i].concat(o)}return i},t.prototype.computeMask=function(n,r){var i=this;return le(function(){Array.isArray(r)&&(r=r[0]);var a=i.returnSequences?r:null;if(i.returnState){var o=i.states.map(function(s){return null});return[a].concat(o)}return a})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<n;++i)r.push(null);return r}return this.states_},set:function(n){this.states_=n},enumerable:!0,configurable:!0}),t.prototype.build=function(n){if(this.numConstants!=null)throw new $t("Constants support is not implemented in RNN yet.");xP(n)&&(n=n[0]),n=n;var r=this.stateful?n[0]:null,i=n[n.length-1];this.inputSpec[0]=new Fi({shape:[r,null,i]});var a,o=[n[0]].concat(n.slice(2));if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!pt.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),a))throw new ie("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map(function(s){return new Fi({shape:[null,s]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(n,r){var i=this;r===void 0&&(r=!1),le(function(){if(!i.stateful)throw new qh("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=i.inputSpec[0].shape[0];if(a==null)throw new ie("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_=[Tn([a,i.cell.stateSize])];else if(n==null)Ut(i.states_),i.keptStates!=null&&(Ut(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_[0]=Tn([a,i.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==i.states_.length)throw new ie("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+n.length+" state value(s). Input received: "+n);r===!0?i.keptStates.push(i.states_.slice()):Ut(i.states_);for(var o=0;o<i.states_.length;++o){var s=n[o],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[o]:i.cell.stateSize,l=[a,u];if(!pt.arraysEqual(s.shape,l))throw new ie("State "+o+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[o]=s}}i.states_=i.states_.map(function(c){return zu(c.clone())})})},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=Aee(n,i,a,this.numConstants);n=o.inputs,i=o.initialState,a=o.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var f=c[l];this.stateSpec.push(new Fi({shape:f.shape}))}u=u.concat(this.stateSpec)}if(a!=null&&(r.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof Zu){var d=[n].concat(s),h=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=h;var g=e.prototype.apply.call(this,d,r);return this.inputSpec=p,g}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=Dt(n),s==null&&(s=i.stateful?i.states_:i.getInitialState(n));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new ie("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:o},c=kee(function(g,m){var v=i.cell.call([g].concat(m),l);return[v[0],v.slice(1)]},n,s,i.goBackwards,a,null,i.unroll,i.returnSequences),f=c[0],d=c[1],h=c[2];i.stateful&&i.resetStates(h,o);var p=i.returnSequences?d:f;return i.returnState?[p].concat(h):p})},t.prototype.getInitialState=function(n){var r=this;return le(function(){var i=Tn(n.shape);return i=Rb(i=qr(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(a){return a>1?fP(i,[1,a]):i}):r.cell.stateSize>1?[fP(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);var r=this.cell.getConfig();n.cell={className:this.cell.getClassName(),config:r};var i=e.prototype.getConfig.call(this);return Object.assign(n,i),n},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Ks(r.cell,i);return new n(Object.assign(r,{cell:a}))},t.className="RNN",t}(tn);Ne.registerClass(Jm);var Wb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(tn),jP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=qf(n.activation==null?r.DEFAULT_ACTIVATION:n.activation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Gm([1,Wf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Gm([1,Wf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){n=Kn(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("SimpleRNNCell expects 2 input Tensors, got "+n.length+".");var a=n[1];n=n[0];var o,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=Qm(function(){return No(n)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=Qm(function(){return No(a)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;o=dc(u!=null?rt(n,u):n,i.kernel.read()),i.bias!=null&&(o=hc(o,i.bias.read())),l!=null&&(a=rt(a,l));var c=Wt(o,dc(a,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="SimpleRNNCell",t}(Wb);Ne.registerClass(jP);var Tee=function(e){function t(n){return n.cell=new jP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return new n(r)},t.className="SimpleRNN",t}(Jm);Ne.registerClass(Tee);var UP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=qf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=qf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Gm([1,Wf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Gm([1,Wf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n))[n.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("GRUCell expects 2 input Tensors (inputs, h, c), got "+n.length+".");var a=r.training!=null&&r.training,o=n[1];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=Qm(function(){return No(n)},i.dropout,a,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=Qm(function(){return No(o)},i.recurrentDropout,a,3));var s,u,l,c=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,c[0]));var d=dc(n,i.kernel.read());i.useBias&&(d=hc(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,f[0]));var h=i.recurrentKernel.read(),p=ic(h,[2*i.units,i.units],h.rank-1),g=p[0],m=p[1],v=dc(o,g),y=ic(d,3,d.rank-1),b=y[0],x=y[1],w=y[2],S=ic(v,2,v.rank-1),C=S[0],_=S[1];s=i.recurrentActivation.apply(Wt(b,C)),u=i.recurrentActivation.apply(Wt(x,_));var E=dc(rt(u,o),m);l=i.activation.apply(Wt(w,E));var A=Wt(rt(s,o),rt(Wt(1,If(s)),l));return[A,A]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="GRUCell",t}(Wb);Ne.registerClass(UP);var Oee=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new UP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="GRU",t}(Jm);Ne.registerClass(Oee);var WP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=qf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=qf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=n.unitForgetBias,r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Gm([1,Wf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Gm([1,Wf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r,i,a=(n=Kn(n))[n.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return Ee(l,u),l.prototype.apply=function(c,f){var d=o.apply([s]),h=new hP().apply([s]),p=o.apply([2*s]);return MJ(MJ(d,h),p)},l}(Gs)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training;if((n=n).length!==3)throw new ie("LSTMCell expects 3 input Tensors (inputs, h, c), got "+n.length+".");var o=n[1],s=n[2];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=Qm(function(){return No(n)},i.dropout,a,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=Qm(function(){return No(o)},i.recurrentDropout,a,4));var u,l,c,f,d=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,d[0]));var p=dc(n,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,h[0])),p=Wt(p,dc(o,i.recurrentKernel.read())),i.useBias&&(p=hc(p,i.bias.read()));var g=ic(p,4,p.rank-1),m=g[0],v=g[1],y=g[2],b=g[3];u=i.recurrentActivation.apply(m),l=i.recurrentActivation.apply(v),c=Wt(rt(l,s),rt(u,i.activation.apply(y))),f=i.recurrentActivation.apply(b);var x=rt(f,i.activation.apply(c));return[x,x,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LSTMCell",t}(Wb);Ne.registerClass(WP);var Iee=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new WP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="LSTM",t}(Jm);Ne.registerClass(Iee);var VP=function(e){function t(n){var r=e.call(this,n)||this;return r.cells=n.cells,r}return Ee(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var n=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var a=i[r];Array.isArray(a.stateSize)?n.push.apply(n,a.stateSize):n.push(a.stateSize)}return n},enumerable:!0,configurable:!0}),t.prototype.call=function(n,r){var i=this;return le(function(){for(var a=(n=n).slice(1),o=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?o.push(a.splice(0,l.stateSize.length)):o.push(a.splice(0,1))}o.reverse();for(var c,f=[],d=0;d<i.cells.length;++d)l=i.cells[d],a=o[d],c=d===0?[n[0]].concat(a):[c[0]].concat(a),c=l.call(c,r),f.push(c.slice(1));a=[];for(var h=0,p=f.slice().reverse();h<p.length;h++){var g=p[h];a.push.apply(a,g)}return[c[0]].concat(a)})},t.prototype.build=function(n){var r;xP(n)&&(n=n[0]),n=n,this.cells.forEach(function(i,a){Kh("RNNCell_"+a,function(){i.build(n),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,n=[n[0],r]})}),this.built=!0},t.prototype.getConfig=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push({className:a.getClassName(),config:a.getConfig()})}var o={cells:n},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(n,r,i){i===void 0&&(i={});for(var a=[],o=0,s=r.cells;o<s.length;o++){var u=s[o];a.push(Ks(u,i))}return new n({cells:a})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.cells;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.weights)}return wP(n)},t.prototype.setWeights=function(n){for(var r=[],i=0,a=this.cells;i<a.length;i++)for(var o=a[i],s=o.weights.length,u=n.splice(s),l=0;l<o.weights.length;++l)r.push([o.weights[l],u[l]]);_P(r)},t.className="StackedRNNCells",t}(Wb);function Qm(e,t,n,r){function i(){return $J(e(),t)}if(n===void 0&&(n=null),r===void 0&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(Km(i,e,n));return a.map(function(s){return zu(s.clone())})}return zu(Km(i,e,n).clone())}Ne.registerClass(VP);var Nee=function(e){function t(n){var r=e.call(this,n)||this;return r.layer=n.layer,r}return Ee(t,e),t.prototype.build=function(n){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(n){this.layer!=null&&(this.layer.trainable=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(n){this.layer.setWeights(n)},t.prototype.getConfig=function(){var n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Ks(r.layer,i);delete r.layer;var o={layer:a};return Object.assign(o,r),new n(o)},t}(tn),Dee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){if((n=Kn(n)).length<3)throw new ie("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(n));this.inputSpec=[{shape:n}];var r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),e.prototype.build.call(this,n)},t.prototype.computeOutputShape=function(n){var r=[(n=Kn(n))[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),a=n[1];return[i[0],a].concat(i.slice(1))},t.prototype.call=function(n,r){var i=this;return le(function(){return kee(function(a,o){return[Dt(i.layer.call(a,r)),[]]},n=Dt(n),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(Nee);function YBe(e){qm(j4e,"BidirectionalMergeMode",e)}Ne.registerClass(Dee);var ZBe="concat",Ree=function(e){function t(n){var r=e.call(this,n)||this,i=n.layer.getConfig(),a={};a.className=n.layer.getClassName(),a.config=i,r.forwardLayer=Ks(a),i.goBackwards=i.goBackwards!==!0;var o={};if(o.className=n.layer.getClassName(),o.config=i,r.backwardLayer=Ks(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=n.mergeMode===void 0?ZBe:n.mergeMode,YBe(r.mergeMode),n.weights)throw new $t("weights support is not implemented for Bidirectional layer yet.");return r._stateful=n.layer.stateful,r.returnSequences=n.layer.returnSequences,r.returnState=n.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=n.layer.inputSpec,r.numConstants=null,r}return Ee(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(n){var r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))},t.prototype.computeOutputShape=function(n){var r,i,a,o=this.forwardLayer.computeOutputShape(n);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState&&(a=o.slice(1)),r=o[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):_a(i)},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=Aee(n,i,a,this.numConstants);if(n=o.inputs,i=o.initialState,a=o.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&a==null)return e.prototype.apply.call(this,n,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new ie("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new Fi({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(a!=null)throw new $t("Support for constants in Bidirectional layers is not implemented yet.");for(var f=s[0]instanceof Zu,d=0,h=s;d<h.length;d++)if(h[d]instanceof Zu!==f)throw new ie("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(f){var p=[n].concat(s),g=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,r);return this.inputSpec=m,v}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a,o,s,u,l=r.initialState;if(l==null)a=i.forwardLayer.call(n,r),o=i.backwardLayer.call(n,r);else{var c=l.slice(0,l.length/2),f=l.slice(l.length/2);a=i.forwardLayer.call(n,Object.assign(r,{initialState:c})),o=i.backwardLayer.call(n,Object.assign(r,{initialState:f}))}return i.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),i.returnSequences&&(o=Ku(o,1)),i.mergeMode==="concat"?u=FJ([a,o]):i.mergeMode==="sum"?u=Wt(a,o):i.mergeMode==="ave"?u=rt(.5,Wt(a,o)):i.mergeMode==="mul"?u=rt(a,o):i.mergeMode==null&&(u=[a,o]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},t.prototype.resetStates=function(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(n){var r=this;Kh(this.forwardLayer.name,function(){r.forwardLayer.build(n)}),Kh(this.backwardLayer.name,function(){r.backwardLayer.build(n)}),this.built=!0},t.prototype.computeMask=function(n,r){var i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?this.mergeMode==null?[r,r]:r:this.mergeMode==null?[null,null]:null,this.returnState){var a=this.forwardLayer.states.map(function(o){return null});return Array.isArray(i)?i.concat(a).concat(a):[i].concat(a).concat(a)}return i},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={mergeMode:this.mergeMode},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.fromConfig=function(n,r){var i=Ks(r.layer);if(delete r.layer,r.numConstants!=null)throw new $t("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=r;return a.layer=i,new n(a)},t.className="Bidirectional",t}(Nee);function JBe(e){return new Mb(e)}function QBe(e){return new OQ(e)}function eze(e){return new AQ(e)}function tze(e){return new kQ(e)}function nze(e){return new TQ(e)}function rze(e){return new NQ(e)}function ize(e){return new IQ(e)}function aze(e){return new LQ(e)}function oze(e){return new BP(e)}function sze(e){return new PQ(e)}function uze(e){return new MQ(e)}function lze(e){return new $Q(e)}function cze(e){return new BQ(e)}function fze(e){return new zQ(e)}function dze(e){return new jQ(e)}function hze(e){return new qQ(e)}function pze(e){return new WQ(e)}function gze(e){return new zP(e)}function mze(e){return new UQ(e)}function vze(e){return new VQ(e)}function yze(e){return new HQ(e)}function bze(e){return new GQ(e)}function xze(e){return new KQ(e)}function wze(e){return new YQ(e)}function _ze(e){return new ZQ(e)}function Sze(e){return new QQ(e)}function Eze(e){return new nee(e)}function Cze(e){return new eee(e)}function Aze(e){return new tee(e)}function kze(e){return new JQ(e)}function Tze(e){return new ree(e)}function Oze(e){return new see(e)}function Ize(e){return new uee(e)}function Nze(e){return new lee(e)}function qP(e){return new hee(e)}function Dze(e){return qP(e)}function Rze(e){return qP(e)}function HP(e){return new mee(e)}function Fze(e){return HP(e)}function Mze(e){return HP(e)}function GP(e){return new bee(e)}function Pze(e){return GP(e)}function $ze(e){return GP(e)}function Lze(e){return new wee(e)}function Bze(e){return new Eee(e)}function Fee(e){return new _ee(e)}function Mee(e){return new Cee(e)}function Pee(e){return new dee(e)}function $ee(e){return new gee(e)}function zze(e){return new yee(e)}function jze(e){return new Oee(e)}function Uze(e){return new UP(e)}function Wze(e){return new Iee(e)}function Vze(e){return new WP(e)}function qze(e){return new Tee(e)}function Hze(e){return new jP(e)}function Gze(e){return new Jm(e)}function Kze(e){return new VP(e)}function Xze(e){return new Ree(e)}function Yze(e){return new Dee(e)}Ne.registerClass(Ree);var Zze=Fee,Jze=Mee,Qze=Pee,e5e=$ee;function t5e(e){return new iee(e)}function n5e(e){return new aee(e)}function r5e(e){return new oee(e)}function i5e(e){return new XQ(e)}var a5e=Object.freeze({inputLayer:JBe,elu:QBe,reLU:eze,leakyReLU:tze,prelu:nze,softmax:rze,thresholdedReLU:ize,conv1d:aze,conv2d:oze,conv2dTranspose:sze,conv3d:uze,separableConv2d:lze,cropping2D:cze,upSampling2d:fze,depthwiseConv2d:dze,activation:hze,dense:pze,dropout:gze,spatialDropout1d:mze,flatten:vze,repeatVector:yze,reshape:bze,permute:xze,embedding:wze,add:_ze,average:Sze,concatenate:Eze,maximum:Cze,minimum:Aze,multiply:kze,dot:Tze,batchNormalization:Oze,layerNormalization:Ize,zeroPadding2d:Nze,averagePooling1d:qP,avgPool1d:Dze,avgPooling1d:Rze,averagePooling2d:HP,avgPool2d:Fze,avgPooling2d:Mze,averagePooling3d:GP,avgPool3d:Pze,avgPooling3d:$ze,globalAveragePooling1d:Lze,globalAveragePooling2d:Bze,globalMaxPooling1d:Fee,globalMaxPooling2d:Mee,maxPooling1d:Pee,maxPooling2d:$ee,maxPooling3d:zze,gru:jze,gruCell:Uze,lstm:Wze,lstmCell:Vze,simpleRNN:qze,simpleRNNCell:Hze,rnn:Gze,stackedRNNCells:Kze,bidirectional:Xze,timeDistributed:Yze,globalMaxPool1d:Zze,globalMaxPool2d:Jze,maxPool1d:Qze,maxPool2d:e5e,Layer:tn,RNN:Jm,RNNCell:Wb,input:kBe,gaussianNoise:t5e,gaussianDropout:n5e,alphaDropout:r5e,masking:i5e});function o5e(e,t){return CP(e,t)}function s5e(e,t){return rQ(e,t)}function u5e(e,t){return iQ(e,t)}function l5e(e,t){return AP(e,t)}function c5e(e,t){return kP(e,t)}function f5e(e,t){return nQ(e,t)}function d5e(e,t){return zLe(e,t)}function h5e(e,t){return SP(e,t)}function p5e(e,t){return PE(e,t)}function g5e(e,t){return Ym(e,t)}function m5e(e,t){return Ym(e,t)}function v5e(e,t){return Ym(e,t)}function y5e(e,t){return Yh(e,t)}function b5e(e,t){return Yh(e,t)}function x5e(e,t){return Yh(e,t)}Object.freeze({binaryAccuracy:o5e,binaryCrossentropy:s5e,sparseCategoricalAccuracy:u5e,categoricalAccuracy:l5e,categoricalCrossentropy:c5e,precision:f5e,recall:d5e,cosineProximity:h5e,meanAbsoluteError:p5e,meanAbsolutePercentageError:g5e,MAPE:m5e,mape:v5e,meanSquaredError:y5e,MSE:b5e,mse:x5e}),Object.freeze({modelFromJSON:wBe});function w5e(e){return new WE(e)}function _5e(e){return BBe(e)}function S5e(e){return zBe(e)}Object.freeze({l1l2:w5e,l1:_5e,l2:S5e});var E5e=function(e){function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.model=null,n}return Ee(t,e),t.prototype.setModel=function(n){if(!(n instanceof zb))throw new Error("model must be a LayersModel, not some other Container");this.model=n},t}(Xm);function GE(e,t){return e<t}function Lee(e,t){return e>t}(function(e){function t(n){var r=e.call(this)||this;if(n==null&&(n={}),n.restoreBestWeights)throw new $t("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=n.monitor||"val_loss",r.minDelta=Math.abs(n.minDelta||0),r.patience=n.patience||0,r.verbose=n.verbose||0,r.mode=n.mode||"auto",r.baseline=n.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=GE:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=Lee:r.monitorFunc=GE,r.monitorFunc===GE&&(r.minDelta*=-1),r}return Ee(t,e),t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===GE?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return[4,Vf(r)];case 1:return a.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=n,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(n){n==null&&(n={});var r=n[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(n)),r},t})(E5e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Xs,Bee,KP=function(){return(KP=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Qh(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function ep(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Xs||(Xs={})),function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(Bee||(Bee={}));var C5e={};function zee(e){return C5e[e]}function $(e,t,n,r){var i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){var a=i.inputIndexStart,o=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return Ea(t.inputNames[i.inputIndexStart],n,r);if(i.type==="tensors")return t.inputNames.slice(a,o).map(function(l){return Ea(l,n,r)});var s=Array.prototype.slice.call(Ea(t.inputNames.slice(a)[0],n,r).dataSync());return i.type==="number"?s[0]:s}var u=t.attrParams[e];return u&&u.value}function Ea(e,t,n){var r=$o(e),i=r[0],a=r[1],o=n.currentContextIds.find(function(s){return!!t[KE(i,s)]});return o!==void 0?t[KE(i,o)][a]:void 0}function A5e(e,t,n){return t[KE(e,n.currentContextId)]}function ev(e,t){var n=$o(e),r=n[0],i=n[1];return[KE(r,t&&t.currentContextId),i]}function KE(e,t){return t?e+"-"+t:e}function $o(e){var t=e.lastIndexOf(":");return t===-1?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function XP(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var k5e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],T5e=Object.freeze({json:k5e}),O5e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],I5e=Object.freeze({json:O5e}),N5e=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],D5e=Object.freeze({json:N5e}),R5e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],F5e=Object.freeze({json:R5e}),M5e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],P5e=Object.freeze({json:M5e}),$5e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],L5e=Object.freeze({json:$5e}),B5e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],z5e=Object.freeze({json:B5e}),j5e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],U5e=Object.freeze({json:j5e}),W5e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],V5e=Object.freeze({json:W5e}),q5e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],H5e=Object.freeze({json:q5e}),G5e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],K5e=Object.freeze({json:G5e}),X5e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Y5e=Object.freeze({json:X5e}),Z5e=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],J5e=Object.freeze({json:Z5e}),Q5e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],e6e=Object.freeze({json:Q5e}),t6e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],n6e=Object.freeze({json:t6e}),r6e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],i6e=Object.freeze({json:r6e}),a6e=function(){function e(){var t=[T5e,I5e,D5e,F5e,P5e,L5e,z5e,H5e,V5e,U5e,K5e,Y5e,J5e,e6e,n6e,i6e],n=[].concat.apply([],t.map(function(r){return r.json}));this.opMappers=n.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(t,n){var r=this;n===void 0&&(n={});var i=[],a=[],o=t.node.reduce(function(d,h){return d[h.name]=r.mapNode(h),h.op.startsWith("Placeholder")&&i.push(d[h.name]),h.op==="Const"&&a.push(d[h.name]),d},{}),s=[],u=[],l={},c={};n!=null&&(l=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var f=Object.keys(o);return f.forEach(function(d){var h=o[d];h.inputNames.forEach(function(p){var g=ev(p)[0];h.inputs.push(o[g]),o[g].children.push(h)})}),Object.keys(c).length===0?f.forEach(function(d){var h=o[d];h.children.length===0&&u.push(h)}):Object.keys(c).forEach(function(d){var h=ev(d)[0],p=o[h];p!=null&&(p.signatureKey=c[d],u.push(p))}),Object.keys(l).length>0?Object.keys(l).forEach(function(d){var h=ev(d)[0],p=o[h];p&&(p.signatureKey=l[d],s.push(p))}):s=i,{nodes:o,inputs:s,outputs:u,weights:a,placeholders:i,signature:n}},e.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce(function(n,r){return n[t[r].name]=r,n},{})},e.prototype.mapNode=function(t){var n=zee(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(r.inputParams=n.inputs.reduce(function(i,a){return i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i},{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce(function(i,a){var o=a.type,s=void 0;switch(a.type){case"string":(s=YP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=YP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":(s=r$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=r$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":(s=JP(t.attr,a.tfName,a.defaultValue||0))===void 0&&a.tfDeprecatedName&&(s=JP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":(s=n$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=n$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":(s=ZP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=ZP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":(s=a$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=a$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":(s=t$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=t$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":(s=i$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=i$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":(s=QP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=QP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":(s=e$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=e$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+t.op)}return i[a.name]={value:s,type:o},i},{})),r},e}();function o6e(e){var t=pe().global;if(t.atob!==void 0)return t.atob(e);if(typeof Buffer!="undefined")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function jee(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):o6e(e);return t?n:n.toLowerCase()}function YP(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i!=null?jee(i.s,r):n}function ZP(e,t,n){var r=e[t];return r?r.b:n}function JP(e,t,n){var r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function Uee(e){switch(typeof e=="string"&&(e=Xs[e]),e){case Xs.DT_FLOAT:return"float32";case Xs.DT_INT32:case Xs.DT_INT64:case Xs.DT_INT8:case Xs.DT_UINT8:return"int32";case Xs.DT_BOOL:return"bool";case Xs.DT_DOUBLE:return"float32";case Xs.DT_STRING:return"string";default:return null}}function QP(e,t,n){var r=e[t];return r&&r.type?Uee(r.type):n}function e$(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map(function(i){return Uee(i)}):n}function Wee(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function t$(e,t,n){var r=e[t];return r&&r.shape?Wee(r.shape):n}function n$(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):n}function r$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i&&i.list&&i.list.s?i.list.s.map(function(a){return jee(a,r)}):n}function i$(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return Wee(i)}):n}function a$(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var s6e=function(){function e(t,n,r){var i=this;this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(a){return i.getInput(a)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(a,o){return a[o]=i.getAttr(o),a},{}))}return e.prototype.getInput=function(t){return Ea(t,this.tensorMap,this.context)},e.prototype.getAttr=function(t,n){var r=this.node.rawAttrs[t];if(r.tensor!=null)return Ea(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return JP(this.node.rawAttrs,t,n);if(r.s!=null)return YP(this.node.rawAttrs,t,n);if(r.b!=null)return ZP(this.node.rawAttrs,t,n);if(r.shape!=null)return t$(this.node.rawAttrs,t,n);if(r.type!=null)return QP(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return n$(this.node.rawAttrs,t,n);if(r.list.s!=null)return r$(this.node.rawAttrs,t,n);if(r.list.shape!=null)return i$(this.node.rawAttrs,t,n);if(r.list.b!=null)return a$(this.node.rawAttrs,t,n);if(r.list.type!=null)return e$(this.node.rawAttrs,t,n)}return n},e}(),u6e=function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Wt($("a",e,t,n),$("b",e,t,n))];case"AddN":return[iM($("tensors",e,t,n))];case"FloorMod":case"Mod":return[F3($("a",e,t,n),$("b",e,t,n))];case"Mul":return[rt($("a",e,t,n),$("b",e,t,n))];case"RealDiv":case"Div":return[Cr($("a",e,t,n),$("b",e,t,n))];case"DivNoNan":return[eE($("a",e,t,n),$("b",e,t,n))];case"FloorDiv":return[PS($("a",e,t,n),$("b",e,t,n))];case"Sub":return[Er($("a",e,t,n),$("b",e,t,n))];case"Minimum":return[Cm($("a",e,t,n),$("b",e,t,n))];case"Maximum":return[Vu($("a",e,t,n),$("b",e,t,n))];case"Pow":return[Am($("a",e,t,n),$("b",e,t,n))];case"SquaredDifference":return[rE($("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},l6e=function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Of($("x",e,t,n))];case"Acos":return[p3($("x",e,t,n))];case"Acosh":return[g3($("x",e,t,n))];case"Asin":return[m3($("x",e,t,n))];case"Asinh":return[v3($("x",e,t,n))];case"Atan":return[y3($("x",e,t,n))];case"Atan2":return[R3($("x",e,t,n),$("y",e,t,n))];case"Atanh":return[b3($("x",e,t,n))];case"Ceil":return[x3($("x",e,t,n))];case"Complex":return[ri($("real",e,t,n),$("imag",e,t,n))];case"Cos":return[w3($("x",e,t,n))];case"Cosh":return[_3($("x",e,t,n))];case"Elu":return[$m($("x",e,t,n))];case"Erf":return[S3($("x",e,t,n))];case"Exp":return[E3($("x",e,t,n))];case"Expm1":return[C3($("x",e,t,n))];case"Floor":return[DS($("x",e,t,n))];case"Log":return[oc($("x",e,t,n))];case"Log1p":return[A3($("x",e,t,n))];case"Imag":return[is($("x",e,t,n))];case"Neg":return[If($("x",e,t,n))];case"Reciprocal":return[k3($("x",e,t,n))];case"Real":return[eo($("x",e,t,n))];case"Relu":return[Ff($("x",e,t,n))];case"Round":return[T3($("x",e,t,n))];case"Selu":return[vE($("x",e,t,n))];case"Sigmoid":return[FS($("x",e,t,n))];case"Sin":return[I3($("x",e,t,n))];case"Sign":return[O3($("x",e,t,n))];case"Sinh":return[N3($("x",e,t,n))];case"Softplus":return[sb($("x",e,t,n))];case"Sqrt":return[ub($("x",e,t,n))];case"Square":return[nE($("x",e,t,n))];case"Tanh":return[MS($("x",e,t,n))];case"Tan":return[D3($("x",e,t,n))];case"Relu6":case"ClipByValue":return[xa($("x",e,t,n),$("clipValueMin",e,t,n),$("clipValueMax",e,t,n))];case"Rsqrt":return[RS(Ea(e.inputNames[0],t,n))];case"Prod":return[gE($("x",e,t,n),$("axes",e,t,n))];case"LeakyRelu":return[mE($("x",e,t,n),$("alpha",e,t,n))];case"Prelu":return[Eb($("x",e,t,n),$("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},c6e=function(){function e(t,n,r,i,a,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var n=this.tensors[t];if(n.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor},e.prototype.readMany=function(t){var n=this;return t.map(function(r){return n.read(r)})},e.prototype.write=function(t,n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+n.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=n.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,n.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");r.tensor=n,r.written=!0,this.tensors[t]=r},e.prototype.writeMany=function(t,n){var r=this;if(t.length!==n.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+n.length+".");t.forEach(function(i,a){return r.write(i,n[a])})},e.prototype.gather=function(t,n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+n);if(!t){t=[];for(var r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Rr([],[0].concat(this.elementShape));var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),as(i,0)},e.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return Rr([],[0].concat(this.elementShape));for(var n=[],r=0;r<this.size();r++)n.push(r);var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),Hi(i,0)},e.prototype.scatter=function(t,n){if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);if(t.length!==n.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+n.shape[0]);var r=Math.max.apply(Math,t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(t,Tf(n,0))},e.prototype.split=function(t,n){var r=this;if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);var i=0,a=t.map(function(c){return i+=c});if(i!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+n.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=i===0?0:n.size/i,s=[];le(function(){n=n.reshape([1,i,o]);for(var c=0;c<t.length;++c){var f=[0,c===0?0:a[c-1],0],d=[1,t[c],o];s[c]=Ro(n,f,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},e.prototype.assertShapesMatchAllowUndefinedSize=function(t,n,r){r===void 0&&(r=""),pt.assert(this.shapesEqualAllowUndefinedSize(t,n),function(){return r+" Shapes "+t+" and "+n+" must match"})},e.prototype.shapesEqualAllowUndefinedSize=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==-1&&n[r]!==-1&&t[r]!==n[r])return!1;return!0},e.nextId=0,e}(),f6e=void 0,d6e=function(e,t,n){return Qh(f6e,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W,G,K,ee;return ep(this,function(ce){switch(ce.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[$("pred",e,t,n).clone()]];case 2:return r=$("pred",e,t,n),i=$("data",e,t,n),[4,r.data()];case 3:return[2,ce.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=e.inputNames.find(function(he){return Ea(he,t,n)!==void 0}))?[Ea(a,t,n).clone()]:void 0];case 5:return o=$("frameName",e,t,n),s=$("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=$("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=$("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=$("size",e,t,n),f=$("dtype",e,t,n),d=$("elementShape",e,t,n),h=$("dynamicSize",e,t,n),p=$("clearAfterRead",e,t,n),g=$("identicalElementShapes",e,t,n),m=$("name",e,t,n),v=new c6e(m,f,c,d,g,h,p),n.addTensorArray(v),[2,[Ve(v.id),Ve(1)]];case 9:return y=$("tensorArrayId",e,t,n),b=$("index",e,t,n),x=$("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[Ve(1)]];case 10:return w=$("tensorArrayId",e,t,n),S=$("index",e,t,n),[2,[n.getTensorArray(w).read(S)]];case 11:return C=$("tensorArrayId",e,t,n),_=$("indices",e,t,n),E=$("dtype",e,t,n),[2,[n.getTensorArray(C).gather(_,E)]];case 12:return A=$("tensorArrayId",e,t,n),k=$("indices",e,t,n),T=$("tensor",e,t,n),n.getTensorArray(A).scatter(k,T),[2,[Ve(1)]];case 13:return I=$("tensorArrayId",e,t,n),N=n.getTensorArray(I),O=$("dtype",e,t,n),[2,[N.concat(O)]];case 14:return D=$("tensorArrayId",e,t,n),L=$("tensor",e,t,n),W=$("lengths",e,t,n),n.getTensorArray(D).split(W,L),[2,[Ve(1)]];case 15:return G=$("tensorArrayId",e,t,n),K=n.getTensorArray(G),[2,[Ve(K.size(),"int32")]];case 16:return ee=$("tensorArrayId",e,t,n),n.getTensorArray(ee).clearAndClose(),[2,[Ve(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}})})},h6e=function(e,t,n){switch(e.op){case"Conv1D":var r=$("stride",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),o=$("dilation",e,t,n);return[iE($("x",e,t,n),$("filter",e,t,n),r,i,a,o)];case"Conv2D":r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase();var s=$("dilations",e,t,n);return[Uh($("x",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=$("fusedOps",e,t,n),l=u[0],c=u[1],f=l==="biasadd",d=c==="prelu",h=l==="fusedbatchnorm",p=$("numArgs",e,t,n);if(f){if(d&&p!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&p!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n);var g=$("args",e,t,n),m=g[0],v=g[1];return[(e.op==="_FusedConv2D"?Pf.conv2d:Pf.depthwiseConv2d)({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:m,activation:c,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=$("outputShape",e,t,n);return r=$("strides",e,t,n),i=$("pad",e,t,n),[oE($("x",e,t,n),$("filter",e,t,n),y,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=$("strides",e,t,n),i=$("pad",e,t,n),s=$("dilations",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),[Mm($("input",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n),[aE($("x",e,t,n),$("filter",e,t,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=$("strides",e,t,n),i=$("pad",e,t,n);var b=$("kernelSize",e,t,n);return[lE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[uE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n);var x=$("includeBatchInIndex",e,t,n),w=_M($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i,x);return[w.result,w.indexes];case"AvgPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[fE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[cE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},p6e=function(e,t,n){switch(e.op){case"Fill":var r=$("shape",e,t,n),i=$("dtype",e,t,n),a=$("value",e,t,n);return[Sm(r,a,i)];case"LinSpace":var o=$("start",e,t,n),s=$("stop",e,t,n),u=$("num",e,t,n);return[t3(o,s,u)];case"Multinomial":var l=$("logits",e,t,n),c=$("numSamples",e,t,n),f=$("seed",e,t,n);return[cM(l,c,f)];case"OneHot":var d=$("indices",e,t,n),h=$("depth",e,t,n),p=$("onValue",e,t,n),g=$("offValue",e,t,n);return[Bh(d,h,p,g)];case"Ones":return[Wu($("shape",e,t,n),$("dtype",e,t,n))];case"OnesLike":return[No($("x",e,t,n))];case"RandomUniform":return[zh($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("dtype",e,t,n))];case"Range":o=$("start",e,t,n);var m=$("stop",e,t,n),v=$("step",e,t,n);return[Em(o,m,v,$("dtype",e,t,n))];case"TruncatedNormal":r=$("shape",e,t,n);var y=$("mean",e,t,n),b=$("stdDev",e,t,n);return f=$("seed",e,t,n),[vb(r,y,b,$("dtype",e,t,n),f)];case"Zeros":return[Tn($("shape",e,t,n),$("dtype",e,t,n))];case"ZerosLike":return[en($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},g6e=void 0,m6e=function(e,t,n){return Qh(g6e,void 0,void 0,function(){var r,i,a,o,s,u,l,c;return ep(this,function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=$("boxes",e,t,n),i=$("scores",e,t,n),a=$("maxOutputSize",e,t,n),o=$("iouThreshold",e,t,n),s=$("scoreThreshold",e,t,n),e.op!=="NonMaxSuppressionV5"?[3,3]:(u=$("softNmsSigma",e,t,n),[4,Mf.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u)]);case 2:return[2,[(c=f.sent()).selectedIndices,c.selectedScores]];case 3:return[4,Mf.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[f.sent()]];case 5:return l=$("condition",e,t,n).asType("bool"),[4,QS(l)];case 6:return c=[f.sent()],l.dispose(),[2,c];case 7:return[2,s3($("x",e,t,n),$("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}})})},v6e=function(e,t,n){switch(e.op){case"TopKV2":var r=$("x",e,t,n),i=$("k",e,t,n),a=$("sorted",e,t,n),o=TM(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},y6e=function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=$("default",e,t,n);return[Ea(e.name,t,n)||r];case"Placeholder":return[Ea(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[$("x",e,t,n).clone()];case"IdentityN":return $("x",e,t,n).map(function(l){return l.clone()});case"Snapshot":return[$("x",e,t,n).clone()];case"Shape":return[ba($("x",e,t,n).shape,"int32")];case"ShapeN":return $("x",e,t,n).map(function(l){return ba(l.shape)});case"Size":return[Ve($("x",e,t,n).size,"int32")];case"Rank":return[Ve($("x",e,t,n).rank,"int32")];case"NoOp":return[Ve(1)];case"Print":var i=$("x",e,t,n),a=$("data",e,t,n),o=$("message",e,t,n),s=$("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+e.op+" is not implemented")}},b6e=function(e,t,n){switch(e.op){case"ResizeBilinear":var r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n);return[Mf.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n),[Mf.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=$("image",e,t,n),s=$("boxes",e,t,n),u=$("boxInd",e,t,n),l=$("cropSize",e,t,n),c=$("method",e,t,n),f=$("extrapolationValue",e,t,n);return[Mf.cropAndResize(o,s,u,l,c,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},x6e=function(e,t,n){switch(e.op){case"Equal":return[jh($("a",e,t,n),$("b",e,t,n))];case"NotEqual":return[Rm($("a",e,t,n),$("b",e,t,n))];case"Greater":return[Dm($("a",e,t,n),$("b",e,t,n))];case"GreaterEqual":return[yb($("a",e,t,n),$("b",e,t,n))];case"Less":return[mM($("a",e,t,n),$("b",e,t,n))];case"LessEqual":return[vM($("a",e,t,n),$("b",e,t,n))];case"LogicalAnd":return[Hu($("a",e,t,n),$("b",e,t,n))];case"LogicalNot":return[lM($("a",e,t,n))];case"LogicalOr":return[JS($("a",e,t,n),$("b",e,t,n))];case"Select":case"SelectV2":return[Vs($("condition",e,t,n),$("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},w6e=function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[sE($("a",e,t,n),$("b",e,t,n),$("transposeA",e,t,n),$("transposeB",e,t,n))];case"Transpose":return[cn($("x",e,t,n),$("perm",e,t,n))];case"_FusedMatMul":var r=$("fusedOps",e,t,n),i=r[0],a=r[1],o=i==="biasadd",s=a==="prelu",u=$("numArgs",e,t,n);if(o){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=$("args",e,t,n),c=l[0],f=l[1];return[Pf.matMul({a:$("a",e,t,n),b:$("b",e,t,n),transposeA:$("transposeA",e,t,n),transposeB:$("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}},_6e=function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Lh($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"LRN":return[CM($("x",e,t,n),$("radius",e,t,n),$("bias",e,t,n),$("alpha",e,t,n),$("beta",e,t,n))];case"Softmax":return[Dh($("x",e,t,n))];case"LogSoftmax":return[jS($("x",e,t,n))];case"SparseToDense":return[bE($("sparseIndices",e,t,n),$("outputShape",e,t,n),$("sparseValues",e,t,n),$("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},S6e=function(e,t,n){switch(e.op){case"Max":var r=$("axis",e,t,n),i=$("keepDims",e,t,n);return[Rf($("x",e,t,n),r,i)];case"Mean":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Fr($("x",e,t,n),r,i)];case"Min":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[pE($("x",e,t,n),r,i)];case"Sum":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[qr($("x",e,t,n),r,i)];case"All":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[hE($("x",e,t,n),r,i)];case"Any":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[wb($("x",e,t,n),r,i)];case"ArgMax":return r=$("axis",e,t,n),[_b($("x",e,t,n),r)];case"ArgMin":return r=$("axis",e,t,n),[SM($("x",e,t,n),r)];case"Prod":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[gE($("x",e,t,n),r,i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},E6e=function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=$("n",e,t,n),i=$("axis",e,t,n),a=$("tensors",e,t,n);return a=a.slice(0,r),[Hi(a,i)];case"GatherV2":case"Gather":i=$("axis",e,t,n);var o=$("x",e,t,n),s=$("indices",e,t,n);return[Fm(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=$("axis",e,t,n),o=$("x",e,t,n),[Ku(o,i)];case"Slice":var u=$("begin",e,t,n),l=$("size",e,t,n);return[Ro($("x",e,t,n),u,l)];case"StridedSlice":u=$("begin",e,t,n);var c=$("end",e,t,n),f=$("strides",e,t,n),d=$("beginMask",e,t,n),h=$("endMask",e,t,n),p=$("ellipsisMask",e,t,n),g=$("newAxisMask",e,t,n),m=$("shrinkAxisMask",e,t,n),v=$("x",e,t,n);if(u.length===1&&v.shape.length>1)for(var y=1;y<v.shape.length;y++)u.push(0),c.push(v.shape[y]),f.push(f[0]);return[kM(v,u,c,f,d,h,p,g,m)];case"Pack":return le(function(){var A=$("axis",e,t,n),k=$("tensors",e,t,n),T=k[0].shape,I=k[0].squeeze().shape,N=k.map(function(O){var D=pt.arraysEqual(O.shape,T);if(!D&&!pt.arraysEqual(O.squeeze().shape,I))throw new Error("the input tensors shape does not match");return D?O:O.reshape(T)});return[as(N,A)]});case"Unpack":return le(function(){var A=$("axis",e,t,n),k=$("tensor",e,t,n);return Tf(k,A)});case"Tile":var b=$("reps",e,t,n);return[sc($("x",e,t,n),b)];case"Split":case"SplitV":i=$("axis",e,t,n);var x=$("numOrSizeSplits",e,t,n);return ic($("x",e,t,n),x,i);case"ScatterNd":s=$("indices",e,t,n);var w=$("values",e,t,n),S=$("shape",e,t,n);return[OM(s,w,S)];case"GatherNd":var C=$("x",e,t,n);return s=$("indices",e,t,n),[IM(C,s)];case"SparseToDense":s=$("sparseIndices",e,t,n),S=$("outputShape",e,t,n);var _=$("sparseValues",e,t,n),E=$("defaultValue",e,t,n);return[bE(s,_,S,_.dtype===E.dtype?E:E.asType(_.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}},C6e=function(e,t,n){switch(e.op){case"FFT":return[Cb($("x",e,t,n))];case"IFFT":return[Lm($("x",e,t,n))];case"RFFT":return[Ab($("x",e,t,n))];case"IRFFT":return[yE($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},A6e=function(e,t,n){switch(e.op){case"Cast":return[kS($("x",e,t,n),$("dtype",e,t,n))];case"ExpandDims":var r=$("axis",e,t,n);return[Do($("x",e,t,n),r)];case"Squeeze":return r=$("axis",e,t,n),[ib($("x",e,t,n),r)];case"Reshape":return[Us($("x",e,t,n),$("shape",e,t,n))];case"PadV2":case"Pad":return[Gu($("x",e,t,n),XP($("padding",e,t,n),2),$("constantValue",e,t,n))];case"SpaceToBatchND":var i=$("blockShape",e,t,n),a=XP($("paddings",e,t,n),2);return[TS($("x",e,t,n),i,a)];case"BatchToSpaceND":i=$("blockShape",e,t,n);var o=XP($("crops",e,t,n),2);return[AS($("x",e,t,n),i,o)];case"DepthToSpace":var s=$("blockSize",e,t,n),u=$("dataFormat",e,t,n).toUpperCase();return[o3($("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function Vee(e,t,n){var r=function(i,a,o){switch(i.category){case"arithmetic":return le(function(){return u6e(i,a,o)});case"basic_math":return le(function(){return l6e(i,a,o)});case"control":return d6e(i,a,o);case"convolution":return le(function(){return h6e(i,a,o)});case"creation":return le(function(){return p6e(i,a,o)});case"dynamic":return m6e(i,a,o);case"evaluation":return le(function(){return v6e(i,a,o)});case"image":return le(function(){return b6e(i,a,o)});case"graph":return le(function(){return y6e(i,a,o)});case"logical":return le(function(){return x6e(i,a,o)});case"matrices":return le(function(){return w6e(i,a,o)});case"normalization":return le(function(){return _6e(i,a,o)});case"reduction":return le(function(){return S6e(i,a,o)});case"slice_join":return le(function(){return E6e(i,a,o)});case"spectral":return le(function(){return C6e(i,a,o)});case"transformation":return le(function(){return A6e(i,a,o)});case"custom":var s=zee(i.op);if(s&&s.customExecutor)return s.customExecutor(new s6e(i,a,o));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var qee=function(){function e(t,n){this.weightMap=t,this.tensorArrayMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(t,n){return{id:t,frameName:n,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var t=[],n=0;n<this.contexts.length-1;n++){var r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t},e.prototype.contextIdforContexts=function(t){return t?t.map(function(n){return n.id===0&&n.iterationId===0?"":n.frameName+"-"+n.iterationId}).join("/"):""},e.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(t){return this.weightMap[t]},e.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},e.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},e}();function Hee(e,t,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(e).map(function(f){return $o(f)[0]}),l=t.slice();l.length>0;){var c=l.pop();(Gee(c)||I6e(c))&&a==null&&(o=(a=c).children.map(function(f){return f.name}).filter(function(f){return r.has(f)})),r.add(c.name),n[c.name]==null&&u.indexOf(c.name)===-1&&(c.inputs.length!==0?c.inputs.forEach(function(f){s.has(f.name)||(s.add(f.name),l.push(f))}):i.push(c.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function k6e(e,t,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map(function(l){return $o(l)[0]}).map(function(l){return e.nodes[l]}).forEach(function(l){r.has(l.name)&&a.push(l)}),e.weights.forEach(function(l){r.has(l.name)&&a.push(l)});for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach(function(l){!o.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return o.has(c.name)})&&a.push(l)})}return s}var T6e=["Switch","Merge","Enter","Exit","NextIteration"],O6e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Gee(e){return T6e.indexOf(e.op)>=0}function I6e(e){return O6e.indexOf(e.op)>=0}var N6e=function(){function e(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var n=Object.keys(t).map(function(r){return t[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],n),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(t,n){var r=t.map(function(a){return a.name}).sort(),i=n.map(function(a){return a.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},e.prototype.compile=function(t,n){var r=Hee(t,n,this.weightMap),i=r.missingInputs,a=r.dynamicNode,o=r.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+o+"]");if(i.length>0){var s=n.map(function(l){return l.name}),u=Object.keys(t);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return k6e(this.graph,this.weightMap,r)},e.prototype.execute=function(t,n){var r=this;t=this.mapInputs(t);var i=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);var a=i.map(function(c){return r.graph.nodes[$o(c)[0]]}),o=n.map(function(c){return r.graph.nodes[$o(c)[0]]}),s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);u==null&&(u=this.compile(t,o),this.compiledMap.set(s,u));var l={};return le(function(){var c=new qee(r._weightMap,l),f=KP({},r.weightMap);Object.keys(t).forEach(function(v){var y=$o(v),b=y[0],x=[];x[y[1]]=t[v],f[b]=x});for(var d=r.getFrozenTensorIds(f),h={},p=0;p<u.length;p++){var g=u[p];if(!f[g.name]){var m=Vee(g,f,c);if(m instanceof Promise)throw new Error("The execution of the op '"+g.op+"' returned a promise. Please use model.executeAsync() instead.");f[g.name]=m,r.checkTensorForDisposal(g.name,g,f,c,d,n,h)}}return n.map(function(v){return Ea(v,f,c)})})},e.prototype.getFrozenTensorIds=function(t){var n=[].concat.apply([],Object.keys(t).map(function(r){return t[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(n)},e.prototype.checkTensorForDisposal=function(t,n,r,i,a,o,s){n.category!=="control"&&o.indexOf(t)===-1&&(r[t].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+n.children.length)}),n.inputs.forEach(function(u){if(u.category!=="control"){var l=A5e(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!a.has(c.id)){var f=s[c.id];f===1?(c.dispose(),delete s[c.id]):f!=null&&s[c.id]--}})}}))},e.prototype.executeAsync=function(t,n){return Qh(this,void 0,void 0,function(){var r,i,a,o,s,u,l=this;return ep(this,function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),r={},i=new qee(this._weightMap,r),[4,this.executeWithControlFlow(t,i,n)];case 1:return a=c.sent(),o=n.map(function(f){return Ea(f,a,i)}),s=new Set(o.map(function(f){return f.id})),u=new Set(Object.keys(t).map(function(f){return t[f].id})),Object.keys(a).forEach(function(f){a[f].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,o]}})})},e.prototype.executeWithControlFlow=function(t,n,r){return Qh(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x=this;return ep(this,function(w){switch(w.label){case 0:i=Object.keys(t),a=i.map(function(S){return x.graph.nodes[$o(S)[0]]}),o=r.map(function(S){return x.graph.nodes[$o(S)[0]]}),s=Hee(t,o,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,f=s.syncInputs,d=a.concat(this.graph.weights).map(function(S){return{node:S,contexts:n.currentContext}}),h=KP({},this.weightMap),Object.keys(t).forEach(function(S){var C=$o(S),_=C[0],E=[];E[C[1]]=t[S],h[_]=E}),p={},g=this.getFrozenTensorIds(h),m={},w.label=1;case 1:return d.length>0?(v=this.processStack(a,d,n,h,m,g,r,p,u),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(S){return!Gee(S)&&!Ea(S.name,h,n)}).map(function(S){return S.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+f+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,h]}})})},e.prototype.processStack=function(t,n,r,i,a,o,s,u,l){for(var c=this,f=[],d=function(){var p=n.pop();r.currentContext=p.contexts;var g="";if(p.node.op==="Enter"&&$("isConstant",p.node,i,r)&&(g=ev(p.node.name,r)[0]),t.indexOf(p.node)===-1){var m=Vee(p.node,i,r);g||(g=ev(p.node.name,r)[0]);var v=r.currentContext;m instanceof Promise?f.push(m.then(function(y){return i[g]=y,r.currentContext=v,c.checkTensorForDisposal(g,p.node,i,r,o,s,u),c.processChildNodes(p.node,n,r,i,a,l),y})):(i[g]=m,h.checkTensorForDisposal(g,p.node,i,r,o,s,u),h.processChildNodes(p.node,n,r,i,a,l))}else h.processChildNodes(p.node,n,r,i,a,l)},h=this;n.length>0;)d();return f},e.prototype.processChildNodes=function(t,n,r,i,a,o){t.children.forEach(function(s){var u=ev(s.name,r)[0];!a[u]&&o.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})))})},e.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(n){return t.weightMap[n].forEach(function(r){return r.dispose()})})},e.prototype.checkInputShapeAndType=function(t){var n=this;Object.keys(t).forEach(function(r){var i=t[r],a=$o(r)[0],o=n.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===i.shape.length&&i.shape.every(function(l,c){return s[c]===-1||s[c]===l});pt.assert(u,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&pt.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},e.prototype.mapInputs=function(t){var n={};for(var r in t)this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null?n[this._signature.inputs[r].name]=t[r]:n[r]=t[r];return n},e.prototype.checkInputs=function(t){var n=this,r=Object.keys(t).filter(function(i){var a=$o(i)[0];return n.graph.nodes[a]==null});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},e.prototype.mapOutputs=function(t){var n=this;return t.map(function(r){return n._signature!=null&&n._signature.outputs!=null&&n._signature.outputs[r]!=null?n._signature.outputs[r].name:r},{})},e.prototype.checkOutputs=function(t){var n=this;t.forEach(function(r){var i=$o(r)[0];if(!n.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},e}();(function(){function e(t,n){n===void 0&&(n={}),this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=wa.browserHTTPRequest(t,this.loadOptions);else{var n=wa.getLoadHandlers(t,this.loadOptions.onProgress);if(n.length===0)n.push(wa.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error("Found more than one ("+n.length+") load handlers for URL '"+[t]+"'");this.handler=n[0]}},e.prototype.load=function(){return Qh(this,void 0,void 0,function(){var t,n,r,i;return ep(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),n=this.artifacts.modelTopology,r={},this.artifacts.userDefinedMetadata!=null&&(r=this.artifacts.userDefinedMetadata.signature),this.version=n.versions.producer+"."+n.versions.minConsumer,i=wa.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new N6e(a6e.Instance.transformGraph(n,r)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),[2,!0]}})})},e.prototype.save=function(t,n){return Qh(this,void 0,void 0,function(){var r;return ep(this,function(i){if(typeof t=="string"){if((r=wa.getSaveHandlers(t)).length===0)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new Error("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]})})},e.prototype.predict=function(t,n){return this.execute(t,this.outputNodes)},e.prototype.normalizeInputs=function(t){if(!(t instanceof Ht||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(n,r,i){return n[r]=t[i],n},{})},e.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},e.prototype.execute=function(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);var r=this.executor.execute(t,n);return r.length>1?r:r[0]},e.prototype.executeAsync=function(t,n){return Qh(this,void 0,void 0,function(){var r;return ep(this,function(i){switch(i.label){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),[4,this.executor.executeAsync(t,n)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},e.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=[t[r]],n},{})},e.prototype.dispose=function(){this.executor.dispose()},e})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kee=function(e,t){return(Kee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function On(e,t){function n(){this.constructor=e}Kee(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function He(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Ge(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function tp(e,t){return e(t={exports:{}},t.exports),t.exports}var D6e=tp(function(e){(function(t,n,r){function i(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}function a(o,s){var u=new function(f){var d,h=this,p=(d=4022871197,function(g){g=g.toString();for(var m=0;m<g.length;m++){var v=.02519603282416938*(d+=g.charCodeAt(m));v-=d=v>>>0,d=(v*=d)>>>0,d+=4294967296*(v-=d)}return 23283064365386963e-26*(d>>>0)});h.next=function(){var g=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=g-(h.c=0|g)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(f),h.s0<0&&(h.s0+=1),h.s1-=p(f),h.s1<0&&(h.s1+=1),h.s2-=p(f),h.s2<0&&(h.s2+=1),p=null}(o),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),R6e=tp(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s}function a(o,s){var u=new function(f){var d=this,h="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var g=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^g^g>>>8},f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),F6e=tp(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s.v=o.v,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^g^g<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),p==h.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),M6e=tp(function(e){(function(t,n,r){function i(o,s){return s.x=o.x.slice(),s.i=o.i,s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.x,m=d.i;return h=g[m],p=(h^=h>>>7)^h<<24,p^=(h=g[m+1&7])^h>>>10,p^=(h=g[m+3&7])^h>>>3,p^=(h=g[m+4&7])^h<<7,h=g[m+7&7],p^=(h^=h<<13)^h<<9,g[m]=p,d.i=m+1&7,p},function(h,p){var g,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,g=0;g<p.length;++g)m[7&g]=m[7&g]<<15^p.charCodeAt(g)+m[g+1&7]<<13;for(;m.length<8;)m.push(0);for(g=0;g<8&&m[g]===0;++g);for(g==8?m[7]=-1:m[g],h.x=m,h.i=0,g=256;g>0;--g)h.next()}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),P6e=tp(function(e){(function(t,n,r){function i(o,s){return s.i=o.i,s.w=o.w,s.X=o.X.slice(),s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.w,m=d.X,v=d.i;return d.w=g=g+1640531527|0,p=m[v+34&127],h=m[v=v+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[v]=p^h,d.i=v,p+(g^g>>>16)|0},function(h,p){var g,m,v,y,b,x=[],w=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,w=Math.max(w,p.length)),v=0,y=-32;y<w;++y)p&&(m^=p.charCodeAt((y+32)%p.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,v=(g=x[127&y]^=m+b)==0?v+1:0);for(v>=128&&(x[127&(p&&p.length||0)]=-1),v=127,y=512;y>0;--y)m=x[v+34&127],g=x[v=v+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,x[v]=m^g;h.w=b,h.X=x,h.i=v}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),$6e=tp(function(e){(function(t,n,r){function i(o,s){return s.a=o.a,s.b=o.b,s.c=o.c,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.b,m=d.c,v=d.d,y=d.a;return g=g<<25^g>>>7^m,m=m-v|0,v=v<<24^v>>>8^y,y=y-g|0,d.b=g=g<<20^g>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^y,d.a=y-g|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,f===Math.floor(f)?(d.a=f/4294967296|0,d.b=0|f):h+=f;for(var p=0;p<h.length+20;p++)d.b^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),np=tp(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(m,v,y){var b=[],x=p(function C(_,E){var A,k=[],T=typeof _;if(E&&T=="object")for(A in _)try{k.push(C(_[A],E-1))}catch(I){}return k.length?k:T=="string"?_:_+"\0"}((v=v==1?{entropy:!0}:v||{}).entropy?[m,g(t)]:m??function(){try{var C;return r&&(C=r.randomBytes)?C=C(a):(C=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(C)),g(C)}catch(A){var _=i.navigator,E=_&&_.plugins;return[+new Date,i,E,i.screen,g(t)]}}(),3),b),w=new function(C){var _,E=C.length,A=this,k=0,T=A.i=A.j=0,I=A.S=[];for(E||(C=[E++]);k<a;)I[k]=k++;for(k=0;k<a;k++)I[k]=I[T=f&T+C[k%E]+(_=I[k])],I[T]=_;(A.g=function(N){for(var O,D=0,L=A.i,W=A.j,G=A.S;N--;)O=G[L=f&L+1],D=D*a+G[f&(G[L]=G[W=f&W+O])+(G[W]=O)];return A.i=L,A.j=W,D})(a)}(b),S=function(){for(var C=w.g(o),_=u,E=0;C<l;)C=(C+E)*a,_*=a,E=w.g(1);for(;C>=c;)C/=2,_/=2,E>>>=1;return(C+E)/_};return S.int32=function(){return 0|w.g(4)},S.quick=function(){return w.g(4)/4294967296},S.double=S,p(g(w.S),t),(v.pass||y||function(C,_,E,A){return A&&(A.S&&h(A,w),C.state=function(){return h(w,{})}),E?(n[s]=C,_):C})(S,x,"global"in v?v.global:this==n,v.state)}function h(m,v){return v.i=m.i,v.j=m.j,v.S=m.S.slice(),v}function p(m,v){for(var y,b=m+"",x=0;x<b.length;)v[f&x]=f&(y^=19*v[f&x])+b.charCodeAt(x++);return g(v)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,p(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(m){}}})([],Math)});np.alea=D6e,np.xor128=R6e,np.xorwow=F6e,np.xorshift7=M6e,np.xor4096=P6e,np.tychei=$6e;var L6e=np,Xee=L6e.alea;function B6e(e,t){return XE(e,t)}function XE(e,t,n,r){if(n===void 0&&(n=new Map),r===void 0&&(r=new Set),e==null)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(YE(e)){var a=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=XE(e[o],t,n,r);a[o]=s}return r.delete(e),a}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,i.value),i.value}function z6e(e,t){return t===void 0&&(t=Zee),Yee(e,t)}function Yee(e,t,n){n===void 0&&(n=new Set);var r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(YE(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(u){var l=Yee(e.map(function(c){return c[u]}),t,n);a[u]=l};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function Zee(e){return e===null?null:YE(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function j6e(e,t){return He(this,void 0,void 0,function(){var n,r,i,a,o,s;return Ge(this,function(u){switch(u.label){case 0:n=new Map,XE(e,t,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=i[r],(o=n.get(a))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(a,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,XE(e,t,n)]}})})}function YE(e){return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ht))}function U6e(e){return e==null||W6e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ht||pt.isTypedArray(e)}function W6e(e){return e===null||typeof e!="object"&&typeof e!="function"}function V6e(e){return B6e(e,q6e)}function q6e(e){return e instanceof Ht?{value:e.clone(),recurse:!1}:YE(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Jee=function(){function e(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return e.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},e.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},e.prototype.set=function(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n},e.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return this.length()===0},e.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.push(i)}},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},e.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},e.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r},e}(),H6e=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return On(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,n)},t.prototype.unshift=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,n)},t.prototype.expand=function(){for(var n=2*this.capacity,r=new Array(n),i=this.length(),a=0;a<i;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=n,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},t.INITIAL_CAPACITY=32,t}(Jee);function G6e(e){return new Y6e(e)}function K6e(e){return new Z6e(e)}function X6e(e,t){return new ete(e,t)}var tv,ii=function(){function e(){}return e.prototype.toArray=function(){return He(this,void 0,void 0,function(){var t,n;return Ge(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,this.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,t]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){var t,n,r;return Ge(this,function(i){switch(i.label){case 0:return t=this.prefetch(100),n=[],[4,t.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(n.push(r.value),[4,t.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,n]}})})},e.prototype.resolveFully=function(){return He(this,void 0,void 0,function(){var t;return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=n.sent(),[3,2];case 4:return[2]}})})},e.prototype.resolveWhile=function(t){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:n=i.sent(),r=t(n.value),i.label=2;case 2:return n.done||!r?[3,4]:[4,this.next()];case 3:return n=i.sent(),r=t(n.value),[3,2];case 4:return[2]}})})},e.prototype.handleErrors=function(t){return new ije(this,t)},e.prototype.filter=function(t){return new nje(this,t)},e.prototype.map=function(t){return new rje(this,t)},e.prototype.mapAsync=function(t){return new Qee(this,t)},e.prototype.serialMapAsync=function(t){return new Qee(this,t).serial()},e.prototype.flatmap=function(t){return new aje(this,t)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.map(t).resolveFully()]})})},e.prototype.serialForEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.serialMapAsync(t).resolveWhile(function(r){return r===!0})]})})},e.prototype.rowMajorBatch=function(t,n){return n===void 0&&(n=!0),new tje(this,t,n)},e.prototype.columnMajorBatch=function(t,n,r){return n===void 0&&(n=!0),r===void 0&&(r=Zee),this.rowMajorBatch(t,n).map(function(i){return z6e(i,r)})},e.prototype.concatenate=function(t,n){return new ete(G6e([this,t]),n)},e.prototype.take=function(t){return t<0||t==null?this:new eje(this,t)},e.prototype.skip=function(t){return t<0||t==null?this:new Q6e(this,t)},e.prototype.prefetch=function(t){return new tte(this,t)},e.prototype.shuffle=function(t,n){return new oje(this,t,n)},e.prototype.serial=function(){return new J6e(this)},e}(),Y6e=function(e){function t(n){var r=e.call(this)||this;return r.items=n,r.trav=0,r}return On(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(n=this.items[this.trav],this.trav++,[2,{value:V6e(n),done:!1}])})})},t}(ii),Z6e=function(e){function t(n){var r=e.call(this)||this;return r.nextFn=n,r}return On(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},t}(ii),J6e=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.upstream.next()]})})},t}(ii),Q6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(n=r.sent()).done?[2,n]:(Ut(n.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(ii),eje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(ii),tje=function(e){function t(n,r,i){i===void 0&&(i=!0);var a=e.call(this)||this;return a.upstream=n,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:n=[],i.label=1;case 1:return n.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&n.length>0?[2,{value:n,done:!1}]:[2,{value:null,done:!0}]:(n.push(r.value),[3,1]);case 3:return[2,{value:n,done:!1}]}})})},t}(ii),nje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(n=r.sent()).done||this.predicate(n.value)?[2,n]:(Ut(n.value),[3,0]);case 2:return[2]}})})},t}(ii),rje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,{value:null,done:!0}];for(r=Lu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Lu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ii),ije=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handler(n)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(ii),Qee=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(n=l.sent()).done?[2,{value:null,done:!0}]:(r=Lu.getTensorsInContainer(n.value),[4,this.transform(n.value)]);case 2:for(i=l.sent(),a=Lu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ii),o$=function(e){function t(){var n=e.call(this)||this;return n.outputQueue=new H6e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return n.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(ii),aje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,!1];for(r=Lu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Lu.getTensorsInContainer(i),this.outputQueue.pushAll(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,!0]}})})},t}(o$),ete=function(e){function t(n,r){var i=e.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=n,i}return On(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(n){return He(this,void 0,void 0,function(){var r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,n];case 1:return a.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=a.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),a.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=a.sent()).done?(this.iterator=null,[2,this.readFromChain(n)]):[2,i]}})})},t}(ii);(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(tv||(tv={})),function(e){function t(n,r){r===void 0&&(r=tv.FAIL);var i=e.call(this)||this;return i.iterators=n,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return On(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(n){return He(this,void 0,void 0,function(){function r(s){return s instanceof ii?{value:s.next().then(function(u){return i++,u.done&&a++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,n];case 1:return s.sent(),i=0,a=0,[4,j6e(this.iterators,r)];case 2:if(o=s.sent(),i===a)return[2,{value:null,done:!0}];if(a>0)switch(this.mismatchMode){case tv.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case tv.SHORTEST:return[2,{value:null,done:!0}];case tv.LONGEST:}return this.count++,[2,{value:o,done:!1}]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(ii);var tte=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.bufferSize=r,i.buffer=new Jee(r),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var n=this.upstream.next();this.buffer.push(n)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(ii),oje=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.upstream=n,a.windowSize=r,a.upstreamExhausted=!1,a.random=Xee(i||pt.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(n){return Math.floor(this.random()*n)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(n=this.chooseIndex(),[4,this.buffer.shuffleExcise(n)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},t}(tte),s$=function(){function e(){this.size=null}return e.prototype.batch=function(t,n){var r=this;n===void 0&&(n=!0);var i=this;return pt.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),Ju(function(){return He(r,void 0,void 0,function(){return Ge(this,function(a){switch(a.label){case 0:return[4,i.iterator()];case 1:return[2,a.sent().columnMajorBatch(t,n,sje)]}})})},this.size===1/0||this.size==null?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t))},e.prototype.concatenate=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){var i,a;return Ge(this,function(o){switch(o.label){case 0:return[4,r.iterator()];case 1:return a=(i=o.sent()).concatenate,[4,t.iterator()];case 2:return[2,a.apply(i,[o.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},e.prototype.filter=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(a){return le(function(){return t(a)})})]}})})},this.size===1/0?1/0:null)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.iterator()];case 1:return[2,n.sent().forEachAsync(t)]}})})},e.prototype.forEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return wS("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},e.prototype.map=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(a){return le(function(){return t(a)})})]}})})},this.size)},e.prototype.mapAsync=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(t)]}})})},this.size)},e.prototype.prefetch=function(t){var n=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(t)]}})})},this.size)},e.prototype.repeat=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){var i=this;return Ge(this,function(a){return[2,X6e(K6e(function(){return He(i,void 0,void 0,function(){var o;return Ge(this,function(s){switch(s.label){case 0:return o={},[4,r.iterator()];case 1:return[2,(o.value=s.sent(),o.done=!1,o)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},e.prototype.skip=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},e.prototype.shuffle=function(t,n,r){var i=this;if(r===void 0&&(r=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,o=Xee(n||pt.now().toString());return Ju(function(){return He(i,void 0,void 0,function(){var s;return Ge(this,function(u){switch(u.label){case 0:return s=o.int32(),r&&(s+=o.int32()),[4,a.iterator()];case 1:return[2,u.sent().shuffle(t,s.toString())]}})})},this.size)},e.prototype.take=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},e.prototype.toArray=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},e.MAX_BUFFER_SIZE=1e4,e}();function Ju(e,t){return t===void 0&&(t=null),new(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.size=t,i}return On(r,n),r.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(i){return[2,e()]})})},r}(s$))}function sje(e){return e===null?null:U6e(e[0])?{value:uje(e),recurse:!1}:{value:null,recurse:!0}}function uje(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ht?as(e):Rr(e)}var lje=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return n=i.sent(),r=n.decodeUTF8(),[2,r.split(`
`).map(function(a){return a.endsWith("\r")&&(a=a.slice(0,-1)),a})]}})})},t}(s$),ZE='"',Vb=Symbol("out"),nte=Symbol("field"),JE=Symbol("quote"),u$=Symbol("quoteafterquote"),rte=Symbol("quoteinquote");(function(e){function t(n,r){var i=e.call(this)||this;return i.input=n,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new lje(n),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(pt.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return On(t,e),t.prototype.columnNames=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u=this;return Ge(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(n=l.sent(),!this.fullColumnNames&&!n)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&n&&pt.assert(n.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+n.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=n),r=this.fullColumnNames.reduce(function(c,f){return c[f]=c[f]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),pt.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(a=0,o=Object.keys(this.columnConfigs);a<o.length;a++)if(s=o[a],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((n=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=n.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r=this;return Ge(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return n=i.sent(),this.hasHeader&&(n=n.skip(1)),[2,n.map(function(a){return r.makeDataElement(a)})]}})})},t.prototype.makeDataElement=function(n){for(var r=this.parseRow(n),i={},a={},o=0;o<this.fullColumnNames.length;o++){var s=this.fullColumnNames[o],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[o],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+n);c=void 0}else{var f=Number(l);if(isNaN(f))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}else c=f}u&&u.isLabel?a[s]=c:i[s]=c}}return Object.keys(a).length===0?i:{xs:i,ys:a}},t.prototype.getBoolean=function(n){return n==="1"||n.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(n,r){r===void 0&&(r=!0);for(var i=[],a=0,o=n.length,s=Vb,u=0;u<o;u++)switch(s){case Vb:switch(n.charAt(u)){case ZE:a=u+1,s=JE;break;case this.delimiter:if(a=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=Vb;break;default:s=nte,a=u}break;case nte:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u)),s=Vb,a=u+1}break;case JE:switch(n.charAt(u)){case ZE:s=u$}break;case u$:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u-1)),s=Vb,a=u+1;break;case ZE:s=JE;break;default:s=rte}break;case rte:switch(n.charAt(u)){case ZE:s=JE}}if(s===u$?i.push(n.substring(a,o-1)):i.push(n.substring(a)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},t})(s$),function(e){function t(n){var r=e.call(this)||this;r.microphoneConfig=n,r.isClosed=!1,r.fftSize=n.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=n.numFramesPerSpectrogram||43,r.sampleRateHz=n.sampleRateHz,r.columnTruncateLength=n.columnTruncateLength||r.fftSize,r.audioTrackConstraints=n.audioTrackConstraints,r.smoothingTimeConstant=n.smoothingTimeConstant||0,r.includeSpectrogram=n.includeSpectrogram!==!1,r.includeWaveform=n.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return On(t,e),t.prototype.summary=function(){return"microphone"},t.create=function(n){return n===void 0&&(n={}),He(this,void 0,void 0,function(){var r;return Ge(this,function(i){switch(i.label){case 0:if(pe().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new t(n)).start()];case 1:return i.sent(),[2,r]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i,a;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return n.stream=o.sent(),[3,3];case 2:throw r=o.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return a=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,a.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(a=this.flattenQueue(i.freqDataQueue),n=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(o=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:n,waveform:r},done:!1}]}})})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.getAudioData=function(){return He(this,void 0,void 0,function(){var n,r,i,a=this;return Ge(this,function(o){return n=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){a.includeSpectrogram&&(a.analyser.getFloatFrequencyData(a.freqData),a.freqData[0]===-1/0&&s({freqDataQueue:n,timeDataQueue:r}),n.push(a.freqData.slice(0,a.columnTruncateLength))),a.includeWaveform&&(a.analyser.getFloatTimeDomainData(a.timeData),r.push(a.timeData.slice())),++i===a.numFrames&&(clearInterval(u),s({freqDataQueue:n,timeDataQueue:r}))},a.fftSize/a.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(n){var r=n[0].length,i=new Float32Array(n.length*r);return n.forEach(function(a,o){return i.set(a,o*r)}),i},t.prototype.getTensorFromAudioDataArray=function(n,r){var i=new Float32Array(pt.sizeFromShape(r));return i.set(n,i.length-n.length),Rr(i,r)},t}(ii),function(e){function t(n,r){var i=e.call(this)||this;if(i.webcamVideoElement=n,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=ba([0],"int32"),i.webcamConfig.centerCrop){var a=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,o=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,l=s+a,c=o+u;i.cropBox=Uu([u,s,c,l],[1,4])}else i.cropBox=Uu([0,0,1,1],[1,4]);return i}return On(t,e),t.prototype.summary=function(){return"webcam"},t.create=function(n,r){return r===void 0&&(r={}),He(this,void 0,void 0,function(){var i;return Ge(this,function(a){switch(a.label){case 0:if(pe().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!n){if(n=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");n.width=r.resizeWidth,n.height=r.resizeHeight}return[4,(i=new t(n,r)).start()];case 1:return a.sent(),[2,i]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:this.webcamConfig.facingMode&&pt.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),a.label=1;case 1:return a.trys.push([1,3,,4]),n=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return n.stream=a.sent(),[3,4];case 3:throw(r=a.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(o){console.log(o),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(o){i.webcamVideoElement.onloadedmetadata=function(){o()}})]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{n=gJ.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:n,done:!1}];try{return[2,{value:this.cropAndResizeFrame(n),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{n.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(n){var r=this;return le(function(){var i,a=n.toFloat().expandDims(0),o=(i=Mf.cropAndResize(a,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(o.slice(1))})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(n){return n.stop()});try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(ii);var ite=function(){return function(){}}(),ate=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.split=function(n){return new cje(this,n)},t}(ii),cje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.impl=new fje(n,r),i}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(ate),fje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.separator=r,i.carryover="",i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((n=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=n.value.split(this.separator))[0]=this.carryover+r[0],i=0,a=r.slice(0,-1);i<a.length;i++)o=a[i],this.outputQueue.push(o);return this.carryover=r[r.length-1],[2,!0]}})})},t}(o$),dje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.decodeUTF8=function(){return new hje(this)},t}(ii),hje=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.impl=new pje(n),r}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(ate),pje=function(e){function t(n){var r=e.call(this)||this;if(r.upstream=n,pe().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(n=a.sent()).done?[2,!1]:(r=n.value,i=pe().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},t}(o$),ote=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.file=n,i.options=r,pt.assert(n instanceof Uint8Array||!!pe().get("IS_BROWSER")&&(n instanceof File||n instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return On(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(n=new Promise(function(o,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)o(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(f){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));o(d)},l.onabort=function(f){return s(new Error("Aborted"))},l.onerror=function(f){return s(new Error(f.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,n]);case 1:return[2,(r.value=a.sent(),r.done=!1,r)]}})})},t}(dje);function gje(e,t){return t===void 0&&(t={}),He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return typeof e=="string"?n=e:(n=e.url,r=mje(e)),[4,pt.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new ote(a,t)];case 3:throw new Error(i.statusText)}})})}var mje=function(e){return{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity}};function ste(e){return typeof e=="string"&&e.substr(0,7)==="file://"}var vje=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.input=n,i.options=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return ste(this.input)&&pe().get("IS_NODE")&&(n=require("fs"),this.input=n.readFileSync(this.input.substr(7))),[2,new ote(this.input,this.options)]})})},t}(ite);(function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.url=n,i.fileOptions=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return ste(this.url)?[2,new vje(this.url,this.fileOptions).iterator()]:[2,gje(this.url,this.fileOptions)]})})},t})(ite);function yje(e){let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(f!==t){const d=t;t=c?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a=(l,c=i,f=Object.is)=>{let d=c(t);function h(){const p=c(t);if(!f(d,p)){const g=d;l(d=p,g)}}return n.add(h),()=>n.delete(h)},u={setState:r,getState:i,subscribe:(l,c,f)=>c||f?a(l,c,f):(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,i,u),u}const bje=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ute=bje?qt:of;function xje(e){const t=typeof e=="function"?yje(e):e,n=(r=t.getState,i=Object.is)=>{const[,a]=AN(g=>g+1,0),o=t.getState(),s=Jt(o),u=Jt(r),l=Jt(i),c=Jt(!1),f=Jt();f.current===void 0&&(f.current=r(o));let d,h=!1;(s.current!==o||u.current!==r||l.current!==i||c.current)&&(d=r(o),h=!i(f.current,d)),ute(()=>{h&&(f.current=d),s.current=o,u.current=r,l.current=i,c.current=!1});const p=Jt(o);return ute(()=>{const g=()=>{try{const v=t.getState(),y=u.current(v);l.current(f.current,y)||(s.current=v,f.current=y,a())}catch(v){c.current=!0,a()}},m=t.subscribe(g);return t.getState()!==p.current&&g(),m},[]),h?d:f.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var lte={},cte=gh(O4e),wje={},_je={},QE={},Xr={},nv={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t="tfjsflags",n=function(){function u(l){this.global=l,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return u.prototype.setPlatform=function(l,c){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+c+".")),this.platformName=l,this.platform=c},u.prototype.registerFlag=function(l,c,f){if(this.flagRegistry[l]={evaluationFn:c,setHook:f},this.urlFlags[l]!=null){var d=this.urlFlags[l];console.warn("Setting feature override from URL "+l+": "+d+"."),this.set(l,d)}},u.prototype.get=function(l){return l in this.flags?this.flags[l]:(this.flags[l]=this.evaluateFlag(l),this.flags[l])},u.prototype.getNumber=function(l){return this.get(l)},u.prototype.getBool=function(l){return this.get(l)},u.prototype.getFlags=function(){return this.flags},Object.defineProperty(u.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),u.prototype.set=function(l,c){if(this.flagRegistry[l]==null)throw new Error("Cannot set flag "+l+" as it has not been registered.");this.flags[l]=c,this.flagRegistry[l].setHook!=null&&this.flagRegistry[l].setHook(c)},u.prototype.evaluateFlag=function(l){if(this.flagRegistry[l]==null)throw new Error("Cannot evaluate flag '"+l+"': no evaluation function found.");return this.flagRegistry[l].evaluationFn()},u.prototype.setFlags=function(l){this.flags=Object.assign({},l)},u.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},u.prototype.populateURLFlags=function(){var l=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var c=r(this.global.location.search);if(t in c){var f=c[t].split(",");f.forEach(function(d){var h=d.split(":"),p=h[0],g=h[1];l.urlFlags[p]=a(p,g)})}}},u}();e.Environment=n;function r(u){var l={};return u.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(c){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];return i(l,f[0],f[1]),f.join("=")}),l}e.getQueryParams=r;function i(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}function a(u,l){if(l=l.toLowerCase(),l==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+u+".")}function o(){return e.ENV}e.env=o,e.ENV=null;function s(u){e.ENV=u}e.setEnvironmentGlobal=s})(nv);var gc={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(gc,"__esModule",{value:!0});var rv=new Map,qb=new Map;function Sje(e,t){var n=l$(e,t);return rv.get(n)}gc.getKernel=Sje;function Eje(e){return qb.get(e)}gc.getGradient=Eje;function Cje(e){for(var t=rv.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1],u=o.split("_")[0];u===e&&n.push(s)}return n}gc.getKernelsForBackend=Cje;function Aje(e){var t=e.kernelName,n=e.backendName,r=l$(t,n);if(rv.has(r))throw new Error("The kernel '"+t+"' for backend "+("'"+n+"' is already registered"));rv.set(r,e)}gc.registerKernel=Aje;function kje(e){var t=e.kernelName;qb.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),qb.set(t,e)}gc.registerGradient=kje;function Tje(e,t){var n=l$(e,t);if(!rv.has(n))throw new Error("The kernel '"+e+"' for backend "+("'"+t+"' is not registered"));rv.delete(n)}gc.unregisterKernel=Tje;function Oje(e){if(!qb.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");qb.delete(e)}gc.unregisterGradient=Oje;function l$(e,t){return t+"_"+e}var Hb={},qe={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(qe,"__esModule",{value:!0});var eC=nv;function fte(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,t--,n=e[t],e[t]=e[r],e[r]=n}qe.shuffle=fte;function Ije(e,t,n){return Math.max(e,Math.min(t,n))}qe.clamp=Ije;function Nje(e){return e%2==0?e:e+1}qe.nearestLargerEven=Nje;function Dje(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}qe.sum=Dje;function Rje(e,t){var n=Math.random();return t*n+(1-n)*e}qe.randUniform=Rje;function Fje(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n}qe.distSquared=Fje;function iv(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}qe.assert=iv;function Mje(e,t,n){n===void 0&&(n=""),iv(dte(e,t),function(){return n+(" Shapes "+e+" and "+t+" must match")})}qe.assertShapesMatch=Mje;function Pje(e){iv(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}qe.assertNonNull=Pje;function c$(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||mte(e)&&!n)for(var r=0;r<e.length;++r)c$(e[r],t,n);else t.push(e);return t}qe.flatten=c$;function $je(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}qe.sizeFromShape=$je;function Lje(e){return e.length===0}qe.isScalarShape=Lje;function dte(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}qe.arraysEqual=dte;function hte(e){return e%1==0}qe.isInt=hte;function Bje(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}qe.tanh=Bje;function zje(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}qe.sizeToSquarishShape=zje;function jje(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return fte(t),t}qe.createShuffledIndices=jje;function Uje(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}qe.rightPad=Uje;function Wje(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e()){r();return}a++;var s=t(a);if(n!=null&&a>=n){i();return}setTimeout(o,s)};o()})}qe.repeatedTry=Wje;function Vje(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+r+" and dim "+i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+t+" / "+n));var a=e.slice();return a[r]=t/n,a}qe.inferFromImplicitShape=Vje;function pte(e,t){var n=t.length;return e=e==null?t.map(function(r,i){return i}):[].concat(e),iv(e.every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but "+("got axis "+e)}),iv(e.every(function(r){return hte(r)}),function(){return"All values in axis param must be integers but "+("got axis "+e)}),e.map(function(r){return r<0?n+r:r})}qe.parseAxisParam=pte;function qje(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:pte(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}qe.squeezeShape=qje;function Hje(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else throw new Error("Unknown data type "+e);return n}qe.getTypedArrayFromDType=Hje;function Gje(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type "+e);return n}qe.getArrayFromDType=Gje;function gte(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}qe.checkConversionForErrors=gte;function Kje(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}qe.isValidDtype=Kje;function Xje(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}qe.hasEncodingLoss=Xje;function mte(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}qe.isTypedArray=mte;function Yje(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}qe.bytesPerElement=Yje;function Zje(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}qe.bytesFromStringArray=Zje;function vte(e){return typeof e=="string"||e instanceof String}qe.isString=vte;function yte(e){return typeof e=="boolean"}qe.isBoolean=yte;function bte(e){return typeof e=="number"}qe.isNumber=bte;function xte(e){return Array.isArray(e)?xte(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":bte(e)?"float32":vte(e)?"string":yte(e)?"bool":"float32"}qe.inferDtype=xte;function Jje(e){return!!(e&&e.constructor&&e.call&&e.apply)}qe.isFunction=Jje;function Qje(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}qe.nearestDivisor=Qje;function e8e(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}qe.computeStrides=e8e;function t8e(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=c$(e)),n&&gte(e,t),r8e(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}else throw new Error("Unknown data type "+t)}qe.toTypedArray=t8e;function wte(e,t,n){var r=new Array;if(t.length===1)for(var i=t[0],a=0;a<i;a++)r[a]=n[e+a];else for(var i=t[0],o=t.slice(1),s=o.reduce(function(l,c){return l*c}),a=0;a<i;a++)r[a]=wte(e+a*s,o,n);return r}function n8e(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return wte(0,e,t)}qe.toNestedArray=n8e;function r8e(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function i8e(e,t){for(var n=_te(e,t),r=0;r<n.length;r++)n[r]=1;return n}qe.makeOnesTypedArray=i8e;function _te(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}qe.makeZerosTypedArray=_te;function a8e(){return eC.env().platform.now()}qe.now=a8e;function o8e(e){e.forEach(function(t){iv(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+e+"].")})})}qe.assertNonNegativeIntegerDimensions=o8e;function s8e(e,t){return eC.env().platform.fetch(e,t)}qe.fetch=s8e;function u8e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",eC.env().platform.encode(e,t)}qe.encodeString=u8e;function l8e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",eC.env().platform.decode(e,t)}qe.decodeString=l8e;function c8e(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}qe.locToIndex=c8e;function f8e(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}qe.indexToLoc=f8e;/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Hb,"__esModule",{value:!0});var f$=qe,d8e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Ete)}return e.prototype.profileKernel=function(t,n,r){var i=this,a,o=function(){a=r()},s=this.backendTimer.time(o);return a.forEach(function(u){u.data().then(function(l){Ste(l,u.dtype,t),s.then(function(c){var f="";c.getExtraProfileInfo!=null&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,u,l,c.kernelMs,n,f)})})}),a},e}();Hb.Profiler=d8e;function Ste(e,t,n){if(t!=="float32")return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}return!1}Hb.checkComputationForErrors=Ste;var Ete=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?f$.rightPad(i+"ms",9):i.error,u=f$.rightPad(t,25),l=n.rank,c=n.size,f=f$.rightPad(n.shape.toString(),14),d="";for(var h in a){var p=a[h],g=p.shape||n.shape,m=g.length;d+=h+": "+m+"D "+(m>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();Hb.Logger=Ete;var tC={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(tC,"__esModule",{value:!0});var h8e=qe;function p8e(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(var a=0;a<e.length;a++){var o=e[a],s=o.inputs;for(var u in s){for(var l=s[u],c=!1,f=0;f<t.length;f++)if(r[l.id]){o.outputs.forEach(function(b){return r[b.id]=!0}),c=!0,i[o.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;for(var h={},a=e.length-1;a>=0;a--)for(var o=e[a],s=o.inputs,f=0;f<o.outputs.length;f++)if(d[o.outputs[f].id]){for(var u in s)d[s[u].id]=!0,h[o.id]=!0;break}for(var p=[],a=0;a<e.length;a++){var o=e[a];if(i[o.id]&&h[o.id]){var g={};for(var u in o.inputs){var m=o.inputs[u];r[m.id]&&(g[u]=m)}var v=Object.assign({},o);v.inputs=g,v.outputs=o.outputs,p.push(v)}}return p}tC.getFilteredNodesXToY=p8e;function g8e(e,t,n){for(var r=function(a){var o=t[a],s=[];if(o.outputs.forEach(function(f){var d=e[f.id];d!=null?s.push(d):s.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+o.kernelName+"."));var u=o.gradient(s),l=function(f){if(!(f in u))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(u)+"."));var d=n(function(){return u[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var h=o.inputs[f];if(!h8e.arraysEqual(d.shape,h.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+h.shape+"'"));if(e[h.id]==null)e[h.id]=d;else{var p=e[h.id];e[h.id]=p.add(d),p.dispose()}};for(var c in o.inputs)l(c)},i=t.length-1;i>=0;i--)r(i)}tC.backpropagateGradients=g8e;var kr={},d$={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(d$,"__esModule",{value:!0});var nC=qe,Cte=20,Gb=3,h$=7;function m8e(e,t,n,r){var i=nC.computeStrides(t),a=v8e(e,t,n,i),o=t.length,s=rC(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}d$.tensorToString=m8e;function v8e(e,t,n,r){var i=nC.sizeFromShape(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u=n==="complex64"?Xb(e):e;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,f=0;f<a;f++)o[f]=Math.max(o[f],Kb(u[c+f],0,n).length);return o}function Kb(e,t,n){var r;return Array.isArray(e)?r=parseFloat(e[0].toFixed(h$))+" + "+(parseFloat(e[1].toFixed(h$))+"j"):nC.isString(e)?r="'"+e+"'":n==="bool"?r=Ate(e):r=parseFloat(e.toFixed(h$)).toString(),nC.rightPad(r,t)}function Ate(e){return e===0?"false":"true"}function rC(e,t,n,r,i,a){a===void 0&&(a=!0);var o=n==="complex64"?2:1,s=t[0],u=t.length;if(u===0){if(n==="complex64"){var l=Xb(e);return[Kb(l[0],0,n)]}return n==="bool"?[Ate(e[0])]:[e[0].toString()]}if(u===1){if(s>Cte){var c=Gb*o,f=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-Gb)*o,s*o));return n==="complex64"&&(f=Xb(f),d=Xb(d)),["["+f.map(function(C,_){return Kb(C,i[_],n)}).join(", ")+", ..., "+d.map(function(C,_){return Kb(C,i[s-Gb+_],n)}).join(", ")+"]"]}var h=n==="complex64"?Xb(e):Array.from(e);return["["+h.map(function(C,_){return Kb(C,i[_],n)}).join(", ")+"]"]}var p=t.slice(1),g=r.slice(1),m=r[0]*o,v=[];if(s>Cte){for(var y=0;y<Gb;y++){var b=y*m,x=b+m;v.push.apply(v,rC(e.slice(b,x),p,n,g,i,!1))}v.push("...");for(var y=s-Gb;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,rC(e.slice(b,x),p,n,g,i,y===s-1))}}else for(var y=0;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,rC(e.slice(b,x),p,n,g,i,y===s-1))}var w=u===2?",":"";v[0]="["+v[0]+w;for(var y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;for(var S=`,
`,y=2;y<u;y++)S+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":S),v}function Xb(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var y8e=Ye&&Ye.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),iC=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},aC=Ye&&Ye.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(kr,"__esModule",{value:!0});var b8e=d$,mc=qe,oC=qe,x8e=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=mc.sizeFromShape(t),r!=null){var a=r.length;mc.assert(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+i.size+"'.")})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||mc.getArrayFromDType(n,this.size),this.strides=oC.computeStrides(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),mc.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must "+("match the rank ("+n.rank+")")});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+". "+("  Buffer shape="+this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Qu().makeTensor(this.values,this.shape,this.dtype)},e}();kr.TensorBuffer=x8e;var Qu=null,be=null,kte=null;function w8e(e){Qu=e}kr.setTensorTracker=w8e;function _8e(e){be=e}kr.setOpHandler=_8e;function S8e(e){kte=e}kr.setDeprecationWarningFn=S8e;var sC=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=mc.sizeFromShape(t),this.strides=oC.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),mc.assert(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),be.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return iC(this,void 0,void 0,function(){var t;return aC(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,be.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return be.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return iC(this,void 0,void 0,function(){var t;return aC(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,oC.toNestedArray(this.shape,t)]}})})},e.prototype.arraySync=function(){return oC.toNestedArray(this.shape,this.dataSync())},e.prototype.data=function(){return iC(this,void 0,void 0,function(){var t,n;return aC(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Qu().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return mc.decodeString(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Qu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return mc.decodeString(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return iC(this,void 0,void 0,function(){var t;return aC(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Qu().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Qu().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),be.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),be.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),be.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),be.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),be.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),be.clone(this)},e.prototype.toString=function(t){t===void 0&&(t=!1);var n=this.dataSync();return b8e.tensorToString(n,this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),be.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),be.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),be.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),be.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),be.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),be.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),be.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),be.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),kte("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),be.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),be.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),be.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),be.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),be.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),be.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),be.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),be.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),be.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),be.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),be.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),be.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),be.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),be.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),be.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),be.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),be.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),be.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),be.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),be.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),be.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),be.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),be.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),be.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),be.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),be.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),be.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),be.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),be.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),be.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),be.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),be.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),be.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),be.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),be.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),be.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),be.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),be.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),be.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),be.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),be.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),be.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),be.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),be.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),be.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),be.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),be.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),be.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),be.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),be.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),be.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),be.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),be.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),be.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),be.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),be.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),be.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),be.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),be.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),be.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),be.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),be.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),be.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),be.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),be.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),be.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),be.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),be.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),be.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),be.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),be.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),be.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),be.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),be.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),be.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),be.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),be.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),be.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),be.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),be.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),be.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),be.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),be.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),be.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),be.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Qu().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),be.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),be.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),be.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),be.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),be.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),be.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),be.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),be.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),be.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),be.spectral.irfft(this)},e}();kr.Tensor=sC,Object.defineProperty(sC,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var Tte=function(e){y8e(t,e);function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!mc.arraysEqual(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and "+("previous value ("+this.shape+") must match"));Qu().disposeTensor(this),this.dataId=n.dataId,Qu().incRef(this,null)},t.prototype.dispose=function(){Qu().disposeVariable(this),this.isDisposedInternal=!0},t}(sC);kr.Variable=Tte,Object.defineProperty(Tte,Symbol.hasInstance,{value:function(e){return e instanceof sC&&e.assign!=null&&e.assign instanceof Function}});var us={},Ote={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),function(u){u.R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6"}(e.Rank||(e.Rank={}));var t;(function(u){u.float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64"})(t||(t={}));var n;(function(u){u.float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64"})(n||(n={}));var r;(function(u){u.float32="float32",u.int32="float32",u.bool="float32",u.complex64="complex64"})(r||(r={}));var i;(function(u){u.float32="complex64",u.int32="complex64",u.bool="complex64",u.complex64="complex64"})(i||(i={}));var a={float32:r,int32:t,bool:n,complex64:i};function o(u,l){if(u==="string"||l==="string"){if(u==="string"&&l==="string")return"string";throw new Error("Can not upcast "+u+" with "+l)}return a[u][l]}e.upcastType=o;function s(u){return o(u,"int32")}e.sumOutType=s})(Ote);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(us,"__esModule",{value:!0});var E8e=kr,C8e=Ote,A8e=qe;function k8e(e,t){if(e.dtype===t.dtype)return[e,t];var n=C8e.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}us.makeTypesMatch=k8e;function T8e(e,t){A8e.assert(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and"+(" second("+t.dtype+") input must match")})}us.assertTypesMatch=T8e;function O8e(e,t){return t.some(function(n){return n.id===e.id})}us.isTensorInList=O8e;function I8e(e){var t=[],n=new Set;return Ite(e,t,n),t}us.getTensorsInContainer=I8e;function Ite(e,t,n){if(e!=null){if(e instanceof E8e.Tensor){t.push(e);return}if(!!N8e(e)){var r=e;for(var i in r){var a=r[i];n.has(a)||(n.add(a),Ite(a,t,n))}}}}function N8e(e){return Array.isArray(e)||typeof e=="object"}(function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(v,y,b,x){return new(b||(b=Promise))(function(w,S){function C(A){try{E(x.next(A))}catch(k){S(k)}}function _(A){try{E(x.throw(A))}catch(k){S(k)}}function E(A){A.done?w(A.value):new b(function(k){k(A.value)}).then(C,_)}E((x=x.apply(v,y||[])).next())})},n=Ye&&Ye.__generator||function(v,y){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},x,w,S,C;return C={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function _(A){return function(k){return E([A,k])}}function E(A){if(x)throw new TypeError("Generator is already executing.");for(;b;)try{if(x=1,w&&(S=A[0]&2?w.return:A[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,A[1])).done)return S;switch(w=0,S&&(A=[A[0]&2,S.value]),A[0]){case 0:case 1:S=A;break;case 4:return b.label++,{value:A[1],done:!1};case 5:b.label++,w=A[1],A=[0];continue;case 7:A=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(A[0]===6||A[0]===2)){b=0;continue}if(A[0]===3&&(!S||A[1]>S[0]&&A[1]<S[3])){b.label=A[1];break}if(A[0]===6&&b.label<S[1]){b.label=S[1],S=A;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(A);break}S[2]&&b.ops.pop(),b.trys.pop();continue}A=y.call(v,b)}catch(k){A=[6,k],w=0}finally{x=S=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=nv,i=gc,a=Hb,o=tC,s=kr,u=us,l=qe,c=qe,f=function(){function v(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return v.prototype.dispose=function(){for(var y in this.registeredVariables)this.registeredVariables[y].dispose()},v}(),d=function(){function v(y){this.ENV=y,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new f}return v.prototype.ready=function(){return t(this,void 0,void 0,function(){var y,b,x,w;return n(this,function(S){switch(S.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];y=this.getSortedBackends(),b=0,S.label=1;case 1:return b<y.length?(x=y[b],[4,this.initializeBackend(x).success]):[3,5];case 2:return w=S.sent(),w?[4,this.setBackend(x)]:[3,4];case 3:return S.sent(),[2];case 4:return b++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(v.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var y=this.initializeBackendsAndReturnBest(),b=y.name,x=y.asyncInit;if(x)throw new Error("The highest priority backend '"+b+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(b)}return this.backendInstance},enumerable:!0,configurable:!0}),v.prototype.backendNames=function(){return Object.keys(this.registryFactory)},v.prototype.findBackend=function(y){if(!(y in this.registry))if(y in this.registryFactory){var b=this.initializeBackend(y).asyncInit;if(b)return null}else return null;return this.registry[y]},v.prototype.findBackendFactory=function(y){return y in this.registryFactory?this.registryFactory[y].factory:null},v.prototype.registerBackend=function(y,b,x){return x===void 0&&(x=1),y in this.registryFactory?(console.warn(y+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[y]={factory:b,priority:x},!0)},v.prototype.setBackend=function(y){return t(this,void 0,void 0,function(){var b,x,w,S,C;return n(this,function(_){switch(_.label){case 0:if(this.registryFactory[y]==null)throw new Error("Backend name '"+y+"' not found in registry");return this.backendName=y,this.registry[y]!=null?[3,4]:(this.backendInstance=null,b=this.initializeBackend(y),x=b.success,w=b.asyncInit,w?[4,x]:[3,2]);case 1:return C=_.sent(),[3,3];case 2:C=x,_.label=3;case 3:if(S=C,!S)return[2,!1];_.label=4;case 4:return this.backendInstance=this.registry[y],this.setupRegisteredKernels(),this.profiler=new a.Profiler(this.backendInstance),[2,!0]}})})},v.prototype.setupRegisteredKernels=function(){var y=this,b=i.getKernelsForBackend(this.backendName);b.forEach(function(x){x.setupFunc!=null&&x.setupFunc(y.backendInstance)})},v.prototype.disposeRegisteredKernels=function(y){var b=this,x=i.getKernelsForBackend(y);x.forEach(function(w){w.disposeFunc!=null&&w.disposeFunc(b.registry[y])})},v.prototype.initializeBackend=function(y){var b=this,x=this.registryFactory[y];if(x==null)throw new Error("Cannot initialize backend "+y+", no registration found.");try{var w=x.factory();if(Promise.resolve(w)===w){var S=++this.pendingBackendInitId,C=w.then(function(_){return S<b.pendingBackendInitId?!1:(b.registry[y]=_,b.pendingBackendInit=null,!0)}).catch(function(_){return S<b.pendingBackendInitId||(b.pendingBackendInit=null,console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message)),!1});return this.pendingBackendInit=C,{success:C,asyncInit:!0}}else return this.registry[y]=w,{success:!0,asyncInit:!1}}catch(_){return console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message),{success:!1,asyncInit:!1}}},v.prototype.removeBackend=function(y){if(!(y in this.registryFactory))throw new Error(y+" backend not found in registry");this.backendName===y&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,y in this.registry&&(this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y]),delete this.registryFactory[y],this.backendName===y&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},v.prototype.getSortedBackends=function(){var y=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(b,x){return y.registryFactory[x].priority-y.registryFactory[b].priority})},v.prototype.initializeBackendsAndReturnBest=function(){for(var y=this.getSortedBackends(),b=0;b<y.length;b++){var x=y[b],w=this.initializeBackend(x),S=w.success,C=w.asyncInit;if(C||S)return{name:x,asyncInit:C}}throw new Error("Could not initialize any backends, all backend initializations failed.")},v.prototype.moveData=function(y,b){var x=this.state.tensorInfo.get(b),w=x.backend,S=this.readSync(b);w.disposeData(b),x.backend=y,y.move(b,S,x.shape,x.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},v.prototype.tidy=function(y,b){var x=this,w=null;if(b==null){if(typeof y!="function")throw new Error("Please provide a function to tidy()");b=y}else{if(typeof y!="string"&&!(y instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");w=y}var S;return this.scopedRun(function(){return x.startScope(w)},function(){return x.endScope(S)},function(){return S=b(),S instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),S})},v.prototype.scopedRun=function(y,b,x){y();try{var w=x();return b(),w}catch(S){throw b(),S}},v.prototype.nextTensorId=function(){return v.nextTensorId++},v.prototype.nextVariableId=function(){return v.nextVariableId++},v.prototype.clone=function(y){var b=this.makeTensorFromDataId(y.dataId,y.shape,y.dtype),x={x:y},w=function(C){return{x:function(){return C.toFloat()}}},S=[];return this.addTapeNode(this.state.activeScope.name,x,[b],w,S,{}),b},v.prototype.runKernel=function(y,b,x,w,S){var C=null,_=null;return this.runKernelFunc(C,b,_,y,x,w,S)},v.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},v.prototype.checkKernelForMemLeak=function(y,b,x){var w=this.backend.numDataIds(),S=0;x.forEach(function(E){S+=E.dtype==="complex64"?3:1});var C=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],_=w-b-S-C;if(_>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+_+" data ids) after running '"+y+"'"))},v.prototype.runKernelFunc=function(y,b,x,w,S,C,_){var E=this,A,k=[],T=this.isTapeOn();w==null&&(w=this.state.activeScope!=null?this.state.activeScope.name:"");var I=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var O,D=i.getKernel(w,this.backendName),L;if(D!=null)O=function(){var G=E.backend.numDataIds();L=D.kernelFunc({inputs:b,attrs:S,backend:E.backend});var K=Array.isArray(L)?L:[L];E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K);var ee=K.map(function(Oe){var Te=Oe.dataId,De=Oe.shape,me=Oe.dtype;return E.makeTensorFromDataId(Te,De,me)});if(T){var ce=E.getTensorsForGradient(w,b,ee);if(ce==null){_==null&&(_=[]);var he=ee.filter(function(Oe,Te){return _[Te]});ce=(C||[]).slice().concat(he)}k=E.saveTensorsForBackwardMode(ce)}return ee};else{var W=function(G){!T||(k=G.map(function(K){return E.keep(E.clone(K))}))};O=function(){var G=E.backend.numDataIds();L=E.tidy(function(){return y(E.backend,W)});var K=Array.isArray(L)?L:[L];return E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K),K}}return this.scopedRun(function(){return E.state.kernelDepth++},function(){return E.state.kernelDepth--},function(){E.ENV.getBool("DEBUG")?A=E.profiler.profileKernel(w,b,function(){return O()}):A=O()}),T&&this.addTapeNode(w,b,A,x,k,S),this.state.profiling&&this.state.activeProfile.kernels.push({name:w,bytesAdded:this.state.numBytes-I,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map(function(G){return b[G].shape}),outputShapes:A.map(function(G){return G.shape})}),Array.isArray(L)?A:A[0]},v.prototype.saveTensorsForBackwardMode=function(y){var b=this,x=y.map(function(w){return b.keep(b.clone(w))});return x},v.prototype.getTensorsForGradient=function(y,b,x){var w=i.getGradient(y);if(w!=null){var S=w.inputsToSave||[],C=w.outputsToSave||[],_=void 0;w.saveAllInputs?(l.assert(Array.isArray(b),function(){return"saveAllInputs is true, expected inputs to be an array."}),_=Object.keys(b).map(function(A){return b[A]})):_=S.map(function(A){return b[A]});var E=x.filter(function(A,k){return C[k]});return _.concat(E)}return null},v.prototype.makeTensor=function(y,b,x,w){if(y==null)throw new Error("Values passed to engine.makeTensor() are null");x=x||"float32",w=w||this.backend;var S=y;x==="string"&&l.isString(y[0])&&(S=y.map(function(k){return l.encodeString(k)}));var C=w.write(S,b,x),_=new s.Tensor(b,x,C,this.nextTensorId());if(this.incRef(_,w),x==="string"){var E=this.state.tensorInfo.get(C),A=c.bytesFromStringArray(S);this.state.numBytes+=A-E.bytes,E.bytes=A}return _},v.prototype.makeTensorFromDataId=function(y,b,x,w){x=x||"float32";var S=new s.Tensor(b,x,y,this.nextTensorId());return this.incRef(S,w),S},v.prototype.makeVariable=function(y,b,x,w){b===void 0&&(b=!0),x=x||this.nextVariableId().toString(),w!=null&&w!==y.dtype&&(y=y.asType(w));var S=new s.Variable(y,b,x,this.nextTensorId());if(this.state.registeredVariables[S.name]!=null)throw new Error("Variable with name "+S.name+" was already registered");return this.state.registeredVariables[S.name]=S,this.incRef(S,this.backend),S},v.prototype.incRef=function(y,b){var x=this.state.tensorInfo.has(y.dataId)?this.state.tensorInfo.get(y.dataId).refCount:0;if(this.state.numTensors++,y.dtype==="string"&&this.state.numStringTensors++,x===0){this.state.numDataBuffers++;var w=0;y.dtype!=="complex64"&&y.dtype!=="string"&&(w=y.size*l.bytesPerElement(y.dtype)),this.state.tensorInfo.set(y.dataId,{backend:b||this.backend,dtype:y.dtype,shape:y.shape,bytes:w,refCount:0}),this.state.numBytes+=w}this.state.tensorInfo.get(y.dataId).refCount++,y instanceof s.Variable||this.track(y)},v.prototype.disposeTensor=function(y){if(!!this.state.tensorInfo.has(y.dataId)){this.state.numTensors--,y.dtype==="string"&&this.state.numStringTensors--;var b=this.state.tensorInfo.get(y.dataId),x=b.refCount;x<=1?(y.dtype!=="complex64"&&(this.state.numBytes-=b.bytes),this.state.numDataBuffers--,b.backend.disposeData(y.dataId),this.state.tensorInfo.delete(y.dataId)):this.state.tensorInfo.get(y.dataId).refCount--}},v.prototype.disposeVariables=function(){for(var y in this.state.registeredVariables){var b=this.state.registeredVariables[y];this.disposeVariable(b)}},v.prototype.disposeVariable=function(y){this.disposeTensor(y),this.state.registeredVariables[y.name]!=null&&delete this.state.registeredVariables[y.name]},v.prototype.memory=function(){var y=this.backend.memory();return y.numTensors=this.state.numTensors,y.numDataBuffers=this.state.numDataBuffers,y.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(y.unreliable=!0,y.reasons==null&&(y.reasons=[]),y.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),y},v.prototype.profile=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){return this.state.profiling=!0,b=this.state.numBytes,x=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=y(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(S){return S.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-x,[2,this.state.activeProfile]})})},v.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},v.prototype.addTapeNode=function(y,b,x,w,S,C){var _=this,E={id:this.state.nextTapeNodeId++,kernelName:y,inputs:b,outputs:x,saved:S},A=i.getGradient(y);A!=null&&(w=A.gradFunc),w!=null&&(E.gradient=function(k){return k=k.map(function(T,I){if(T==null){var N=x[I],O=l.makeZerosTypedArray(N.size,N.dtype);return _.makeTensor(O,N.shape,N.dtype)}return T}),w(k.length>1?k:k[0],S,C)}),this.state.activeTape.push(E)},v.prototype.keep=function(y){return y.kept=!0,y},v.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},v.prototype.endTape=function(){this.state.gradientDepth--},v.prototype.startScope=function(y){var b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};y&&(b.name=y),this.state.scopeStack.push(b),this.state.activeScope=b},v.prototype.endScope=function(y){for(var b=this,x=u.getTensorsInContainer(y),w=new Set(x.map(function(E){return E.id})),S=0;S<this.state.activeScope.track.length;S++){var C=this.state.activeScope.track[S];!C.kept&&!w.has(C.id)&&C.dispose()}var _=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],x.forEach(function(E){!E.kept&&E.scopeId===_.id&&b.track(E)})},v.prototype.gradients=function(y,b,x,w){var S=this;if(w===void 0&&(w=!1),l.assert(b.length>0,function(){return"gradients() received an empty list of xs."}),x!=null&&x.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+x.dtype+"'");var C=this.scopedRun(function(){return S.startTape()},function(){return S.endTape()},function(){return S.tidy("forward",y)});l.assert(C instanceof s.Tensor,function(){return"The result y returned by f() must be a tensor."});var _=o.getFilteredNodesXToY(this.state.activeTape,b,C);if(!w&&_.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var E={};E[C.id]=x??h(C.shape),o.backpropagateGradients(E,_,function(k){return S.tidy(k)});var A=b.map(function(k){return E[k.id]});return S.state.gradientDepth===0&&(S.state.activeTape.forEach(function(k){for(var T=0,I=k.saved;T<I.length;T++){var N=I[T];N.dispose()}}),S.state.activeTape=null),{value:C,grads:A}})},v.prototype.customGrad=function(y){var b=this;return l.assert(l.isFunction(y),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];l.assert(x.every(function(_){return _ instanceof s.Tensor}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var S,C={};return x.forEach(function(_,E){C[E]=_}),b.runKernelFunc(function(_,E){return S=y.apply(void 0,x.concat([E])),l.assert(S.value instanceof s.Tensor,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),l.assert(l.isFunction(S.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),S.value},C,function(_,E){var A=S.gradFunc(_,E),k=Array.isArray(A)?A:[A];l.assert(k.length===x.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),l.assert(k.every(function(I){return I instanceof s.Tensor}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var T={};return k.forEach(function(I,N){T[N]=function(){return I}}),T})}},v.prototype.readSync=function(y){var b=this.state.tensorInfo.get(y);return b.backend.readSync(y)},v.prototype.read=function(y){var b=this.state.tensorInfo.get(y);return b.backend.read(y)},v.prototype.time=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){switch(w.label){case 0:return b=c.now(),[4,this.backend.time(y)];case 1:return x=w.sent(),x.wallMs=c.now()-b,[2,x]}})})},v.prototype.track=function(y){return this.state.activeScope!=null&&(y.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(y)),y},Object.defineProperty(v.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),v.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new f;for(var y in this.registry)this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},v.nextTensorId=0,v.nextVariableId=0,v}();e.Engine=d;function h(v){var y=c.makeOnesTypedArray(c.sizeFromShape(v),"float32");return e.ENGINE.makeTensor(y,v,"float32")}var p;function g(){if(p==null){var v=void 0;if(typeof window!="undefined")v=window;else if(typeof Ye!="undefined")v=Ye;else if(typeof process!="undefined")v=process;else if(typeof self!="undefined")v=self;else throw new Error("Could not find a global object");p=v}return p}function m(){var v=g();if(v._tfengine==null){var y=new r.Environment(v);v._tfengine=new d(y)}return r.setEnvironmentGlobal(v._tfengine.ENV),s.setTensorTracker(function(){return v._tfengine}),v._tfengine}e.ENGINE=m()})(Xr);var mr={};Object.defineProperty(mr,"__esModule",{value:!0}),mr.Add="Add",mr.AddN="AddN",mr.Div="Div",mr.FusedBatchNorm="FusedBatchNorm",mr.SquaredDifference="SquaredDifference",mr.Square="Square",mr.Transpose="Transpose",mr.NonMaxSuppressionV5="NonMaxSuppressionV5",mr.BroadcastTo="BroadcastTo",mr.OneHot="OneHot",mr.Identity="Identity",mr.Tile="Tile",mr.PadV2="PadV2",mr.FromPixels="FromPixels",mr.MaxPoolWithArgmax="MaxPoolWithArgmax";var Mr={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Mr,"__esModule",{value:!0});var D8e=Xr,Nte=nv,R8e=kr,Ys=qe;function Dte(e,t){var n=e;if(Ys.isTypedArray(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Ys.isTypedArray(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Nte.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Rte(e,r,[]),r}Mr.inferShape=Dte;function Rte(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ys.isTypedArray(e)){Ys.assert(t.length===0,function(){return"Element arr["+n.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+t[0]+" elements")});return}Ys.assert(t.length>0,function(){return"Element arr["+n.join("][")+"] should be a primitive, "+("but is an array of "+e.length+" elements")}),Ys.assert(e.length===t[0],function(){return"Element arr["+n.join("][")+"] should have "+t[0]+" "+("elements, but has "+e.length+" elements")});for(var r=t.slice(1),i=0;i<e.length;++i)Rte(e[i],r,n.concat(i))}function Fte(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must "+("be "+e+" tensor, but got "+t+" tensor"))}function Mte(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof R8e.Tensor)return Fte(r,e.dtype,t,n),e;var i=Ys.inferDtype(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Fte(r,i,t,n),e==null||!Ys.isTypedArray(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var o=Dte(e,i);!Ys.isTypedArray(e)&&!Array.isArray(e)&&(e=[e]);var s=!0,u=i!=="string"?Ys.toTypedArray(e,i,Nte.env().getBool("DEBUG")):Ys.flatten(e,[],s);return D8e.ENGINE.makeTensor(u,o,i)}Mr.convertToTensor=Mte;function F8e(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");var i=e;return i.map(function(a,o){return Mte(a,t+"["+o+"]",n)},r)}Mr.convertToTensorArray=F8e;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var p$=Xr;function M8e(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(t.length+" keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];p$.ENGINE.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),p$.ENGINE.endScope(s),s}catch(u){throw p$.ENGINE.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}ai.op=M8e,Object.defineProperty(QE,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var P8e=Xr,$8e=mr,L8e=us,Pte=Mr,B8e=ai;function z8e(e,t){var n,r=Pte.convertToTensor(e,"a","add"),i=Pte.convertToTensor(t,"b","add");n=L8e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=function(s,u){var l=s.add(r,i);return u([r,i]),l},o={a:r,b:i};return P8e.ENGINE.runKernelFunc(a,o,null,$8e.Add)}QE.add=B8e.op({add_:z8e}),Object.defineProperty(_je,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var j8e=QE,U8e=kr;U8e.Tensor.prototype.add=function(e){return j8e.add(this,e)};var W8e={},g$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(g$,"__esModule",{value:!0});var V8e=Xr,q8e=mr,H8e=Mr,G8e=ai;function K8e(e,t){var n=H8e.convertToTensor(e,"broadcastTo","x"),r=n.shape;if(t.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(p,g){return p>1?g:-1}).filter(function(p){return p>=0});if(u.length===0)return n.clone();var l=function(p){return p.tile(n,o)},c=!0,f=function(p){return{x:function(){return p.sum(u,c)}}},d={x:n},h={shape:t,inputShape:a};return V8e.ENGINE.runKernelFunc(l,d,f,q8e.BroadcastTo,h)}g$.broadcastTo=G8e.op({broadcastTo_:K8e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(W8e,"__esModule",{value:!0});var X8e=g$,Y8e=kr;Y8e.Tensor.prototype.broadcastTo=function(e){return X8e.broadcastTo(this,e)};var Z8e={},uC={},oi={},rp={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(rp,"__esModule",{value:!0});function J8e(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1,s=t[t.length-1-i]||1;s>1&&o===1&&r.unshift(a)}return r}rp.getBroadcastDims=J8e;function Q8e(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}rp.getReductionAxes=Q8e;function e9e(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){var s="Operands could not be broadcast together with shapes "+(e+" and "+t+".");throw Error(s)}else n.unshift(a)}return n}rp.assertAndGetBroadcastShape=e9e;var ip={},Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var m$=Xr,lC=Mr,t9e=qe,v$=ai;function n9e(e,t){var n=lC.convertToTensor(e,"real","complex"),r=lC.convertToTensor(t,"imag","complex");return t9e.assertShapesMatch(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),m$.ENGINE.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}function r9e(e){var t=lC.convertToTensor(e,"input","real");return m$.ENGINE.runKernelFunc(function(n){return n.real(t)},{$input:t})}function i9e(e){var t=lC.convertToTensor(e,"input","imag");return m$.ENGINE.runKernelFunc(function(n){return n.imag(t)},{$input:t})}Yb.complex=v$.op({complex_:n9e}),Yb.real=v$.op({real_:r9e}),Yb.imag=v$.op({imag_:i9e}),function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Xr,n=nv,r=Mr,i=qe,a=Yb,o=ai;function s(_,E,A){var k=r.inferShape(_,A);return u(_,E,k,A)}e.tensor=s;function u(_,E,A,k){if(k==null&&(k=i.inferDtype(_)),k==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!i.isTypedArray(_)&&!Array.isArray(_)&&typeof _!="number"&&typeof _!="boolean"&&typeof _!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(E!=null){i.assertNonNegativeIntegerDimensions(E);var T=i.sizeFromShape(E),I=i.sizeFromShape(A);i.assert(T===I,function(){return"Based on the provided shape, ["+E+"], the tensor should have "+(T+" values but has "+I)});for(var N=0;N<A.length;++N){var O=A[N],D=N===A.length-1?O!==i.sizeFromShape(E.slice(N)):!0;i.assert(A[N]===E[N]||!D,function(){return"Error creating a new Tensor. Inferred shape "+("("+A+") does not match the provided ")+("shape ("+E+"). ")})}}return!i.isTypedArray(_)&&!Array.isArray(_)&&(_=[_]),E=E||A,_=k!=="string"?i.toTypedArray(_,k,n.env().getBool("DEBUG")):i.flatten(_,[],!0),t.ENGINE.makeTensor(_,E,k)}function l(_,E){if((i.isTypedArray(_)&&E!=="string"||Array.isArray(_))&&E!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(E==="string"&&i.isTypedArray(_)&&!(_ instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var A=[],k=[];return u(_,A,k,E)}e.scalar=l;function c(_,E){i.assertNonNull(_);var A=r.inferShape(_,E);if(A.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var k=null;return u(_,k,A,E)}e.tensor1d=c;function f(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var k=r.inferShape(_,A);if(k.length!==2&&k.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u(_,E,k,A)}e.tensor2d=f;function d(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var k=r.inferShape(_,A);if(k.length!==3&&k.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor3d=d;function h(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var k=r.inferShape(_,A);if(k.length!==4&&k.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor4d=h;function p(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var k=r.inferShape(_,A);if(k.length!==5&&k.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor5d=p;function g(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var k=r.inferShape(_,A);if(k.length!==6&&k.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return E=E||k,u(_,E,k,A)}e.tensor6d=g;function m(_,E,A,k){return E===void 0&&(E=!0),t.ENGINE.makeVariable(_,E,A,k)}e.variable=m;function v(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=v(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeOnesTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.ones=v;function y(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=y(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeZerosTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.zeros=y;function b(_,E,A){return t.ENGINE.runKernelFunc(function(k){return k.fill(_,E,A)},{})}e.fill=b;function x(_){var E=r.convertToTensor(_,"x","onesLike");if(E.dtype==="complex64"){var A=e.onesLike(a.real(E)),k=e.zerosLike(a.imag(E));return a.complex(A,k)}var T=function(I,N){return{x:function(){return e.zerosLike(I)}}};return t.ENGINE.runKernelFunc(function(I){return I.onesLike(E)},{x:E},T,"OnesLike")}function w(_){var E=r.convertToTensor(_,"x","zerosLike"),A=function(k,T){return{x:function(){return e.zerosLike(k)}}};return t.ENGINE.runKernelFunc(function(k){return k.zerosLike(E)},{x:E},A,"ZerosLike")}function S(_,E,A){if(A<=0)throw new Error("The number of values should be positive.");return t.ENGINE.runKernelFunc(function(k){return k.linspace(_,E,A)},{})}e.linspace=S;function C(_,E,A,k){if(A===void 0&&(A=1),k===void 0&&(k="float32"),A===0)throw new Error("Cannot have a step of zero");var T=_===E,I=_<E&&A<0,N=E<_&&A>1;if(T||I||N)return y([0],k);var O=Math.abs(Math.ceil((E-_)/A)),D=i.makeZerosTypedArray(O,k);E<_&&A===1&&(A=-1),D[0]=_;for(var L=1;L<D.length;L++)D[L]=D[L-1]+A;return c(D,k)}e.range=C,e.onesLike=o.op({onesLike_:x}),e.zerosLike=o.op({zerosLike_:w})}(ip);var nn={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(nn,"__esModule",{value:!0});var on=Xr,fn=Mr,$te=qe,dn=ai,Ca=ip;function a9e(e){var t=fn.convertToTensor(e,"x","neg"),n=function(a){return{x:function(){return a.neg()}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a){return a.neg(t)},{x:t},n,"Neg",r,i)}function o9e(e){var t=fn.convertToTensor(e,"x","ceil"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.ceil(t)},{$x:t},n)}function s9e(e){var t=fn.convertToTensor(e,"x","floor"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.floor(t)},{$x:t},n)}function u9e(e){var t=fn.convertToTensor(e,"x","sign"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.sign(t)},{$x:t},n)}function l9e(e){var t=fn.convertToTensor(e,"x","isNaN"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},n)}function c9e(e){var t=fn.convertToTensor(e,"x","isInf"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isInf(t)},{$x:t},n)}function f9e(e){var t=fn.convertToTensor(e,"x","isFinite"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},n)}function d9e(e){var t=fn.convertToTensor(e,"x","round"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.round(t)},{$x:t},n)}function h9e(e){var t=fn.convertToTensor(e,"x","exp"),n=function(o,s){return{x:function(){return o.mulStrict(s[0])}}},r={},i=[],a=[!0];return on.ENGINE.runKernelFunc(function(o,s){var u=o.exp(t);return s([u]),u},{x:t},n,"Exp",r,i,a)}function p9e(e){var t=fn.convertToTensor(e,"x","expm1"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.exp())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.expm1(t);return i([t]),a},{$x:t},n)}function g9e(e){var t=fn.convertToTensor(e,"x","log"),n=function(a,o){var s=o[0];return{x:function(){return a.div(s.toFloat())}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a,o){var s=a.log(t);return o([t]),s},{x:t},n,"Log",r,i)}function m9e(e){var t=fn.convertToTensor(e,"x","log1p"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.log1p(t);return i([t]),a},{$x:t},n)}function v9e(e){var t=fn.convertToTensor(e,"x","sqrt"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sqrt(t);return i([t]),a},{$x:t},n)}function y9e(e){var t=fn.convertToTensor(e,"x","rsqrt"),n=function(i,a){var o=a[0];return{x:function(){return i.div(o.pow(1.5).mul(2)).neg()}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.rsqrt(t);return a([t]),o},{x:t},n,"Rsqrt",{},r)}function b9e(e){var t=fn.convertToTensor(e,"x","reciprocal"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.square().neg())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.reciprocal(t);return i([t]),a},{$x:t},n)}function x9e(e){var t=fn.convertToTensor(e,"x","abs");if(t.dtype==="complex64")return on.ENGINE.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t});var n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.abs(t);return i([t]),a},{x:t},n,"Abs")}function w9e(e,t,n){var r=fn.convertToTensor(e,"x","clipByValue");$te.assert(t<=n,function(){return"Error in clip: min ("+t+") must be "+("less than or equal to max ("+n+").")});var i=function(s,u){var l=u[0];return{x:function(){return s.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Ca.zerosLike(s))}}},a=[r],o={min:t,max:n};return on.ENGINE.runKernelFunc(function(s,u){var l=s.clip(r,t,n);return u([r]),l},{x:r},i,"ClipByValue",o,a)}function _9e(e){var t=fn.convertToTensor(e,"x","sigmoid"),n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.mul(Ca.scalar(1).sub(a)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sigmoid(t);return i([a]),a},{x:t},n,"Sigmoid")}function S9e(e){var t=fn.convertToTensor(e,"x","logSigmoid"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t.neg()).neg();return i([t]),a},{$x:t},n)}function E9e(e){var t=fn.convertToTensor(e,"x","softplus"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t);return i([t]),a},{$x:t},n)}function C9e(e){var t=fn.convertToTensor(e,"x","sin"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.sin(t);return a([t]),o},{x:t},n,"Sin",{},r)}function A9e(e){var t=fn.convertToTensor(e,"x","cos"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.cos(t);return a([t]),o},{x:t},n,"Cos",{},r)}function k9e(e){var t=fn.convertToTensor(e,"x","tan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.cos().square())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.tan(t);return i([t]),a},{$x:t},n)}function T9e(e){var t=fn.convertToTensor(e,"x","asin"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).sub(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asin(t);return i([t]),a},{$x:t},n)}function O9e(e){var t=fn.convertToTensor(e,"x","acos"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).sub(a.toFloat().square()).sqrt()).neg()}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acos(t);return i([t]),a},{$x:t},n)}function I9e(e){var t=fn.convertToTensor(e,"x","atan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atan(t);return i([t]),a},{$x:t},n)}function N9e(e){var t=fn.convertToTensor(e,"x","sinh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sinh(t);return i([t]),a},{$x:t},n)}function D9e(e){var t=fn.convertToTensor(e,"x","cosh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.cosh(t);return i([t]),a},{$x:t},n)}function R9e(e){var t=fn.convertToTensor(e,"x","tanh"),n=function(i,a){var o=a[0];return{x:function(){return Ca.scalar(1).sub(o.square()).mulStrict(i)}}},r=[!0];return on.ENGINE.runKernelFunc(function(i,a){var o=i.tanh(t);return a([o]),o},{x:t},n,"Tanh",{},null,r)}function F9e(e){var t=fn.convertToTensor(e,"x","asinh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).add(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asinh(t);return i([t]),a},{$x:t},n)}function M9e(e){var t=fn.convertToTensor(e,"x","acosh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acosh(t);return i([t]),a},{$x:t},n)}function P9e(e){var t=fn.convertToTensor(e,"x","atanh"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(Ca.scalar(1).sub(a.toFloat().square()))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atanh(t);return i([t]),a},{$x:t},n)}function $9e(e){var t=fn.convertToTensor(e,"x","erf");$te.assert(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat());var n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.erf(t);return i([t]),a},{$x:t},n)}function L9e(e,t){t===void 0&&(t=0);var n=fn.convertToTensor(e,"x","step"),r=function(i){return{$x:function(){return Ca.zerosLike(i)}}};return on.ENGINE.runKernelFunc(function(i){return i.step(n,t)},{$x:n},r)}nn.abs=dn.op({abs_:x9e}),nn.acos=dn.op({acos_:O9e}),nn.acosh=dn.op({acosh_:M9e}),nn.asin=dn.op({asin_:T9e}),nn.asinh=dn.op({asinh_:F9e}),nn.atan=dn.op({atan_:I9e}),nn.atanh=dn.op({atanh_:P9e}),nn.ceil=dn.op({ceil_:o9e}),nn.clipByValue=dn.op({clipByValue_:w9e}),nn.cos=dn.op({cos_:A9e}),nn.cosh=dn.op({cosh_:D9e}),nn.erf=dn.op({erf_:$9e}),nn.exp=dn.op({exp_:h9e}),nn.expm1=dn.op({expm1_:p9e}),nn.floor=dn.op({floor_:s9e}),nn.log=dn.op({log_:g9e}),nn.log1p=dn.op({log1p_:m9e}),nn.logSigmoid=dn.op({logSigmoid_:S9e}),nn.neg=dn.op({neg_:a9e}),nn.reciprocal=dn.op({reciprocal_:b9e}),nn.round=dn.op({round_:d9e}),nn.rsqrt=dn.op({rsqrt_:y9e}),nn.sigmoid=dn.op({sigmoid_:_9e}),nn.sign=dn.op({sign_:u9e}),nn.isNaN=dn.op({isNaN_:l9e}),nn.isInf=dn.op({isInf_:c9e}),nn.isFinite=dn.op({isFinite_:f9e}),nn.sin=dn.op({sin_:C9e}),nn.sinh=dn.op({sinh_:N9e}),nn.softplus=dn.op({softplus_:E9e}),nn.sqrt=dn.op({sqrt_:v9e}),nn.step=dn.op({step_:L9e}),nn.tan=dn.op({tan_:k9e}),nn.tanh=dn.op({tanh_:R9e});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(oi,"__esModule",{value:!0});var Hf=Xr,Gf=us,xn=Mr,vc=qe,Lte=QE,Yr=rp,Mi=ai,Bte=ip,B9e=nn;function z9e(e,t){var n=xn.convertToTensor(e,"a","addStrict"),r=xn.convertToTensor(t,"b","addStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in addStrict: "),n.add(r)}function j9e(e,t){var n,r=xn.convertToTensor(e,"a","sub"),i=xn.convertToTensor(t,"b","sub");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s){var u=function(){var c=s,f=Yr.getReductionAxes(r.shape,a);return f.length>0&&(c=c.sum(f)),c.reshape(r.shape)},l=function(){var c=s,f=Yr.getReductionAxes(i.shape,a);return f.length>0&&(c=c.sum(f)),c.neg().reshape(i.shape)};return{a:u,b:l}};return Hf.ENGINE.runKernelFunc(function(s){return s.subtract(r,i)},{a:r,b:i},o,"Sub")}function U9e(e,t){var n=xn.convertToTensor(e,"a","subStrict"),r=xn.convertToTensor(t,"b","subStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}function W9e(e,t){var n,r=xn.convertToTensor(e,"base","pow"),i=xn.convertToTensor(t,"exp","pow");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(c,f){var d=f[0],h=f[1],p=f[2],g=function(){var v=h.toFloat(),y=c.mul(v.mul(d.pow(v.sub(Bte.scalar(1))))),b=Yr.getReductionAxes(d.shape,a);return b.length>0&&(y=y.sum(b)),y.reshape(d.shape)},m=function(){var v=d.greater(0),y=d.log().where(v,Bte.zerosLike(d)),b=c.mul(p.mul(y)),x=Yr.getReductionAxes(h.shape,a);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)};return{a:g,b:m}},s={},u=[r,i],l=[!0];return Hf.ENGINE.runKernelFunc(function(c,f){var d=c.pow(r,i);return f([r,i,d]),d},{a:r,b:i},o,"Pow",s,u,l)}function V9e(e,t){return vc.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}function q9e(e,t){var n,r=xn.convertToTensor(e,"a","mul"),i=xn.convertToTensor(t,"b","mul");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.mul(c.toFloat()),p=Yr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Yr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{a:f,b:d}};return Hf.ENGINE.runKernelFunc(function(s,u){var l=s.multiply(r,i);return u([r,i]),l},{a:r,b:i},o,"Mul")}function H9e(e,t){var n=xn.convertToTensor(e,"a","mul"),r=xn.convertToTensor(t,"b","mul");return vc.assertShapesMatch(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}function G9e(e,t){var n,r=xn.convertToTensor(e,"a","floorDiv"),i=xn.convertToTensor(t,"b","floorDiv");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.div(c.toFloat()),p=Yr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Yr.getReductionAxes(c.shape,a);p.length>0&&(h=h.sum(p).reshape(c.shape));var g=c.square();return h.div(g.toFloat()).neg()};return{a:f,b:d}};return Hf.ENGINE.runKernelFunc(function(s,u){var l=s.floorDiv(r,i);return u([r,i]),l},{a:r,b:i},o,"FloorDiv")}function K9e(e,t){var n=xn.convertToTensor(e,"a","div"),r=xn.convertToTensor(t,"b","div");return vc.assertShapesMatch(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}function X9e(e,t){var n,r=xn.convertToTensor(e,"a","mod"),i=xn.convertToTensor(t,"b","mod");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Yr.getReductionAxes(l.shape,a);return h.length>0?s.sum(h).reshape(l.shape):s},d=function(){var h=s.mul(l.div(c).floor().neg()),p=Yr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{$a:f,$b:d}};return Hf.ENGINE.runKernelFunc(function(s,u){var l=s.mod(r,i);return u([r,i]),l},{$a:r,$b:i},o)}function Y9e(e,t){var n=xn.convertToTensor(e,"a","modStrict"),r=xn.convertToTensor(t,"b","modStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}function Z9e(e,t){var n,r=xn.convertToTensor(e,"a","minimum"),i=xn.convertToTensor(t,"b","minimum");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Yr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.lessEqual(l).toFloat())},f=function(){return o.mul(u.greater(l).toFloat())};return{a:c,b:f}};return Hf.ENGINE.runKernelFunc(function(o,s){var u=o.minimum(r,i);return s([r,i]),u},{a:r,b:i},a,"Minimum")}function J9e(e,t){var n=xn.convertToTensor(e,"a","minimumStrict"),r=xn.convertToTensor(t,"b","minimumStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}function Q9e(e,t){var n,r=xn.convertToTensor(e,"a","maximum"),i=xn.convertToTensor(t,"b","maximum");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Yr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.greaterEqual(l).toFloat())},f=function(){return o.mul(u.less(l).toFloat())};return{a:c,b:f}};return Hf.ENGINE.runKernelFunc(function(o,s){var u=o.maximum(r,i);return s([r,i]),u},{a:r,b:i},a,"Maximum")}function e7e(e,t){var n=xn.convertToTensor(e,"a","maximumStrict"),r=xn.convertToTensor(t,"b","maximumStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}function t7e(e,t){var n=xn.convertToTensor(e,"a","squaredDifferenceStrict"),r=xn.convertToTensor(t,"b","squaredDifferenceStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}function n7e(e,t){var n,r=xn.convertToTensor(e,"a","atan2"),i=xn.convertToTensor(t,"b","atan2");n=Gf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Lte.add(l.square(),c.square()),p=s.mul(c.div(h)),g=Yr.getReductionAxes(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},d=function(){var h=Lte.add(l.square(),c.square()),p=B9e.neg(s.mul(l.div(h))),g=Yr.getReductionAxes(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)};return{$a:f,$b:d}};return Hf.ENGINE.runKernelFunc(function(s,u){var l=s.atan2(r,i);return u([r,i]),l},{$a:r,$b:i},o)}oi.addStrict=Mi.op({addStrict_:z9e}),oi.atan2=Mi.op({atan2_:n7e}),oi.divStrict=Mi.op({divStrict_:K9e}),oi.floorDiv=Mi.op({floorDiv_:G9e}),oi.maximum=Mi.op({maximum_:Q9e}),oi.maximumStrict=Mi.op({maximumStrict_:e7e}),oi.minimum=Mi.op({minimum_:Z9e}),oi.minimumStrict=Mi.op({minimumStrict_:J9e}),oi.mod=Mi.op({mod_:X9e}),oi.modStrict=Mi.op({modStrict_:Y9e}),oi.mul=Mi.op({mul_:q9e}),oi.mulStrict=Mi.op({mulStrict_:H9e}),oi.pow=Mi.op({pow_:W9e}),oi.powStrict=Mi.op({powStrict_:V9e}),oi.squaredDifferenceStrict=Mi.op({squaredDifferenceStrict_:t7e}),oi.sub=Mi.op({sub_:j9e}),oi.subStrict=Mi.op({subStrict_:U9e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(uC,"__esModule",{value:!0});var r7e=Xr,i7e=mr,a7e=us,zte=Mr,o7e=oi,s7e=ai;function u7e(e,t){var n,r=zte.convertToTensor(e,"a","div"),i=zte.convertToTensor(t,"b","div");if(n=a7e.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return o7e.floorDiv(r,i);var a=function(u,l){var c=u.realDivide(r,i);return l([r,i]),c},o={a:r,b:i},s={};return r7e.ENGINE.runKernelFunc(a,o,null,i7e.Div,s)}uC.div=s7e.op({div_:u7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Z8e,"__esModule",{value:!0});var l7e=uC,c7e=kr;c7e.Tensor.prototype.div=function(e){return l7e.div(this,e)};var f7e={},y$={},jte={},b$={},Ute={},el={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(el,"__esModule",{value:!0});var d7e=qe;function x$(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}el.axesAreInnerMostDims=x$;function Wte(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}el.combineLocations=Wte;function h7e(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);var a=t.map(function(o){return e[o]});return[n,a]}el.computeOutAndReduceShapes=h7e;function p7e(e,t){var n=t.map(function(r){return 1});return Wte(e,n,t)}el.expandShapeToKeepDim=p7e;function g7e(e,t,n){d7e.assert(x$(t,n),function(){return e+" supports only inner-most axes for now. "+("Got axes "+t+" and rank-"+n+" input.")})}el.assertAxesAreInnerMostDims=g7e;function m7e(e,t){if(x$(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}el.getAxesPermutation=m7e;function v7e(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}el.getUndoAxesPermutation=v7e;function y7e(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}el.getInnerMostAxes=y7e;var Vte={},cC={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(cC,"__esModule",{value:!0});var w$=qe;function b7e(e,t){var n=e[0].length;e.forEach(function(i,a){w$.assert(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+n+")")})}),w$.assert(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)w$.assert(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") "+("does not match the shape of the rest ("+r+") ")+("along the non-concatenated axis "+a+".")})})}cC.assertParamsConsistent=b7e;function x7e(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}cC.computeOutShape=x7e,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Xr,n=Mr,r=qe,i=qe,a=cC,o=ai,s=ip;function u(p){return e.concat(p,0)}function l(p,g){return e.concat(p,g)}function c(p,g){return e.concat(p,g)}function f(p,g){return e.concat(p,g)}function d(p,g){g===void 0&&(g=0),r.assert(p.length>=1,function(){return"Pass at least one tensor to concat"});var m=n.convertToTensorArray(p,"tensors","concat");m[0].dtype==="complex64"&&m.forEach(function(S){if(S.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+S.dtype+". ")}),g=i.parseAxisParam(g,m[0].shape)[0];var v=a.computeOutShape(m.map(function(S){return S.shape}),g);if(r.sizeFromShape(v)===0)return s.tensor([],v);if(m=m.filter(function(S){return S.size>0}),m.length===1)return m[0];var y=m.map(function(S){return S.shape});a.assertParamsConsistent(y,g);var b=function(S){var C=y.map(function(E){return E[g]}),_=e.split(S,C,g);return _.map(function(E){return function(){return E}})},x=m,w={axis:g};return t.ENGINE.runKernelFunc(function(S){return S.concat(m,g)},x,b,"Concat",w)}function h(p,g,m){m===void 0&&(m=0);var v=n.convertToTensor(p,"x","split");m=i.parseAxisParam(m,v.shape)[0];var y;typeof g=="number"?(r.assert(v.shape[m]%g==0,function(){return"Number of splits must evenly divide the axis."}),y=new Array(g).fill(v.shape[m]/g)):(r.assert(v.shape[m]===g.reduce(function(x,w){return x+w}),function(){return"The sum of sizes must match the size of the axis dimension."}),y=g);var b=function(x){return{$x:function(){return e.concat(x,m)}}};return t.ENGINE.runKernelFunc(function(x){return x.split(v,y,m)},{$x:v},b)}e.concat=o.op({concat_:d}),e.concat1d=o.op({concat1d_:u}),e.concat2d=o.op({concat2d_:l}),e.concat3d=o.op({concat3d_:c}),e.concat4d=o.op({concat4d_:f}),e.split=o.op({split_:h})}(Vte),function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(C,_,E,A){return new(E||(E=Promise))(function(k,T){function I(D){try{O(A.next(D))}catch(L){T(L)}}function N(D){try{O(A.throw(D))}catch(L){T(L)}}function O(D){D.done?k(D.value):new E(function(L){L(D.value)}).then(I,N)}O((A=A.apply(C,_||[])).next())})},n=Ye&&Ye.__generator||function(C,_){var E={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},A,k,T,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(D){return function(L){return O([D,L])}}function O(D){if(A)throw new TypeError("Generator is already executing.");for(;E;)try{if(A=1,k&&(T=D[0]&2?k.return:D[0]?k.throw||((T=k.return)&&T.call(k),0):k.next)&&!(T=T.call(k,D[1])).done)return T;switch(k=0,T&&(D=[D[0]&2,T.value]),D[0]){case 0:case 1:T=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,k=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(T=E.trys,!(T=T.length>0&&T[T.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!T||D[1]>T[0]&&D[1]<T[3])){E.label=D[1];break}if(D[0]===6&&E.label<T[1]){E.label=T[1],T=D;break}if(T&&E.label<T[2]){E.label=T[2],E.ops.push(D);break}T[2]&&E.ops.pop(),E.trys.pop();continue}D=_.call(C,E)}catch(L){D=[6,L],k=0}finally{A=T=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=Xr,i=kr,a=Mr,o=qe,s=el,u=Vte,l=ai;function c(C,_){var E=a.convertToTensor(C,"x","reshape",null);_=o.inferFromImplicitShape(_,E.size),o.assert(E.size===o.sizeFromShape(_),function(){return"new shape and old shape must have the same number of elements."});var A=function(T){return{x:function(){return T.reshape(E.shape)}}},k={shape:_};return r.ENGINE.runKernelFunc(function(T){return T.reshape(E,_)},{x:E},A,"Reshape",k)}function f(C,_){var E=a.convertToTensor(C,"x","squeeze");return e.reshape(E,o.squeezeShape(E.shape,_).newShape)}function d(C,_){var E=a.convertToTensor(C,"x","cast");if(!o.isValidDtype(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&E.dtype!=="string"||_!=="string"&&E.dtype==="string")throw new Error("Only strings can be casted to strings");var A=function(T){return{x:function(){return T.clone()}}},k={dtype:_};return r.ENGINE.runKernelFunc(function(T){return T.cast(E,_)},{x:E},A,"Cast",k)}function h(C,_){_===void 0&&(_=0);var E=a.convertToTensorArray(C,"tensors","stack");if(o.assert(E.length>=1,function(){return"Pass at least one tensor to tf.stack"}),E.length===1)return E[0].expandDims(_);var A=E[0].rank,k=E[0].shape,T=E[0].dtype;o.assert(_<=A,function(){return"Axis must be <= rank of the tensor"}),E.forEach(function(N){o.assertShapesMatch(k,N.shape,"All tensors passed to stack must have matching shapes")}),E.forEach(function(N){o.assert(T===N.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var I=E.map(function(N){return N.expandDims(_)});return u.concat(I,_)}function p(C,_,E){var A=a.convertToTensor(C,"x","batchToSpaceND"),k=_.reduce(function(I,N){return I*N});o.assert(A.rank>=1+_.length,function(){return"input rank is "+A.rank+" but should be > than blockShape.length "+_.length}),o.assert(E.length===_.length,function(){return"crops.length is "+E.length+" but should be equal to blockShape.length  "+_.length}),o.assert(A.shape[0]%k==0,function(){return"input tensor batch is "+A.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+_.join(" * ")+" === "+k)});var T=function(I){return{$x:function(){return I.spaceToBatchND(_,E)}}};return r.ENGINE.runKernelFunc(function(I){return I.batchToSpaceND(A,_,E)},{$x:A},T)}function g(C,_,E){var A=a.convertToTensor(C,"x","spaceToBatchND");o.assert(A.rank>=1+_.length,function(){return"input rank "+A.rank+" should be > than [blockShape] "+_.length}),o.assert(E.length===_.length,function(){return"paddings.shape[0] "+E.length+" must be equal to [blockShape] "+_.length}),o.assert(A.shape.reduce(function(T,I,N){return N>0&&N<=_.length?T&&(I+E[N-1][0]+E[N-1][1])%_[N-1]==0:T},!0),function(){return"input spatial dimensions "+A.shape.slice(1)+" with paddings "+E.toString()+" must be divisible by blockShapes "+_.toString()});var k=function(T){return{$x:function(){return T.batchToSpaceND(_,E)}}};return r.ENGINE.runKernelFunc(function(T){return T.spaceToBatchND(A,_,E)},{$x:A},k)}function m(C,_){_===void 0&&(_=0),_=_||0;var E=a.convertToTensor(C,"x","unstack");o.assert(_>=-E.shape.length&&_<E.shape.length,function(){return"Axis = "+_+" is not in [-"+E.shape.length+", "+E.shape.length+")"}),_<0&&(_+=E.shape.length);var A=function(T){return{x:function(){return e.stack(T,_)}}},k={axis:_};return r.ENGINE.runKernelFunc(function(T){return T.unstack(E,_)},{x:E},A,"Unpack",k)}function v(C,_,E,A){_===void 0&&(_=0),E===void 0&&(E=!1),A===void 0&&(A=!1);var k=a.convertToTensor(C,"x","cumsum");_=_|0;var T=s.getAxesPermutation([_],k.rank),I=k;T!=null&&(I=k.transpose(T));var N=s.getInnerMostAxes(1,k.rank)[0],O=function(L){return{permutedX:function(){return L.cumsum(_,E,!A)}}},D=r.ENGINE.runKernelFunc(function(L){return L.cumsum(I,N,E,A)},{permutedX:I},O);return T!=null&&(D=D.transpose(T)),D}function y(C,_){_===void 0&&(_=0);var E=null,A=a.convertToTensor(C,"x","expandDims",E);o.assert(_<=A.rank,function(){return"Axis must be <= rank of the tensor"});var k=A.shape.slice();return _<0&&(o.assert(-(A.rank+1)<=_,function(){return"Axis must be in the interval ["+-(A.rank+1)+", "+A.rank+"]"}),_=A.rank+_+1),k.splice(_,0,1),e.reshape(A,k)}function b(C,_,E){E===void 0&&(E="NHWC");var A=a.convertToTensor(C,"x","depthToSpace"),k=E==="NHWC"?A.shape[1]:A.shape[2],T=E==="NHWC"?A.shape[2]:A.shape[3],I=E==="NHWC"?A.shape[3]:A.shape[1];return o.assert(k*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+k+" and "+_+`  for depthToSpace with input shape
      `+A.shape}),o.assert(T*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+T+" and "+_+` for depthToSpace with input shape
          `+A.shape}),o.assert(I%(_*_)==0,function(){return"Dimension size must be evenly divisible by "+_*_+" but is "+I+" for depthToSpace with input shape "+A.shape}),r.ENGINE.runKernelFunc(function(N){return N.depthToSpace(A,_,E)},{$x:A})}function x(C,_){return t(this,void 0,void 0,function(){var E,A,k,T,I,N,O,D,L,O,W;return n(this,function(G){switch(G.label){case 0:return E=a.convertToTensor(C,"x","setdiff1d"),A=a.convertToTensor(_,"y","setdiff1d"),o.assert(E.dtype===A.dtype,function(){return"x and y should have the same dtype, but got x ("+E.dtype+") and y ("+A.dtype+")."}),o.assert(E.rank===1,function(){return"x should be 1D tensor, but got x ("+E.shape+")."}),o.assert(A.rank===1,function(){return"y should be 1D tensor, but got y ("+A.shape+")."}),[4,E.data()];case 1:return k=G.sent(),[4,A.data()];case 2:for(T=G.sent(),I=new Set(T),N=0,O=0;O<k.length;O++)I.has(k[O])||N++;for(D=new i.TensorBuffer([N],E.dtype),L=new i.TensorBuffer([N],"int32"),O=0,W=0;O<k.length;O++)I.has(k[O])||(D.values[W]=k[O],L.values[W]=O,W++);return[2,[D.toTensor(),L.toTensor()]]}})})}function w(C,_,E){return _===void 0&&(_="float32"),_=_||"float32",o.assertNonNegativeIntegerDimensions(C),new i.TensorBuffer(C,_,E)}e.buffer=w;function S(C,_){_===void 0&&(_=!1),console.log(C.toString(_))}e.print=S,e.batchToSpaceND=l.op({batchToSpaceND_:p}),e.cast=l.op({cast_:d}),e.cumsum=l.op({cumsum_:v}),e.depthToSpace=l.op({depthToSpace_:b}),e.expandDims=l.op({expandDims_:y}),e.reshape=l.op({reshape_:c}),e.spaceToBatchND=l.op({spaceToBatchND_:g}),e.squeeze=l.op({squeeze_:f}),e.stack=l.op({stack_:h}),e.unstack=l.op({unstack_:m}),e.setdiff1dAsync=x}(Ute);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(b$,"__esModule",{value:!0});var qte=Ute;function w7e(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var i=qte.buffer(e,"int32"),a=qte.buffer([n.length,e.length],"int32"),r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}b$.whereImpl=w7e,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(m,v,y,b){return new(y||(y=Promise))(function(x,w){function S(E){try{_(b.next(E))}catch(A){w(A)}}function C(E){try{_(b.throw(E))}catch(A){w(A)}}function _(E){E.done?x(E.value):new y(function(A){A(E.value)}).then(S,C)}_((b=b.apply(m,v||[])).next())})},n=Ye&&Ye.__generator||function(m,v){var y={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},b,x,w,S;return S={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function C(E){return function(A){return _([E,A])}}function _(E){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,x&&(w=E[0]&2?x.return:E[0]?x.throw||((w=x.return)&&w.call(x),0):x.next)&&!(w=w.call(x,E[1])).done)return w;switch(x=0,w&&(E=[E[0]&2,w.value]),E[0]){case 0:case 1:w=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,x=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(w=y.trys,!(w=w.length>0&&w[w.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!w||E[1]>w[0]&&E[1]<w[3])){y.label=E[1];break}if(E[0]===6&&y.label<w[1]){y.label=w[1],w=E;break}if(w&&y.label<w[2]){y.label=w[2],y.ops.push(E);break}w[2]&&y.ops.pop(),y.trys.pop();continue}E=v.call(m,y)}catch(A){E=[6,A],x=0}finally{b=w=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=b$,i=Xr,a=Mr,o=qe,s=rp,u=ai,l=ip;function c(m){var v=a.convertToTensor(m,"x","logicalNot","bool");return i.ENGINE.runKernelFunc(function(y){return y.logicalNot(v)},{$x:v})}function f(m,v){var y=a.convertToTensor(m,"a","logicalAnd","bool"),b=a.convertToTensor(v,"b","logicalAnd","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalAnd(y,b)},{a:y,b},null,"LogicalAnd")}function d(m,v){var y=a.convertToTensor(m,"a","logicalOr","bool"),b=a.convertToTensor(v,"b","logicalOr","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalOr(y,b)},{$a:y,$b:b})}function h(m,v){var y=a.convertToTensor(m,"a","logicalXor","bool"),b=a.convertToTensor(v,"b","logicalXor","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),e.logicalOr(m,v).logicalAnd(e.logicalAnd(m,v).logicalNot())}function p(m,v,y){var b=a.convertToTensor(v,"a","where"),x=a.convertToTensor(y,"b","where"),w=a.convertToTensor(m,"condition","where","bool");o.assertShapesMatch(b.shape,x.shape,"Error in where: "),w.rank===1?o.assert(w.shape[0]===b.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):o.assertShapesMatch(w.shape,x.shape,"Error in where: ");var S=function(C,_){var E=_[0];return{$condition:function(){return l.zerosLike(E).toFloat()},$a:function(){return C.mul(E.cast(C.dtype))},$b:function(){return C.mul(E.logicalNot().cast(C.dtype))}}};return i.ENGINE.runKernelFunc(function(C,_){var E=C.select(w,b,x);return _([w]),E},{$condition:w,$a:b,$b:x},S)}function g(m){return t(this,void 0,void 0,function(){var v,y,b;return n(this,function(x){switch(x.label){case 0:return v=a.convertToTensor(m,"condition","whereAsync","bool"),[4,v.data()];case 1:return y=x.sent(),b=r.whereImpl(v.shape,y),m!==v&&v.dispose(),[2,b]}})})}e.logicalAnd=u.op({logicalAnd_:f}),e.logicalNot=u.op({logicalNot_:c}),e.logicalOr=u.op({logicalOr_:d}),e.logicalXor=u.op({logicalXor_:h}),e.where=u.op({where_:p}),e.whereAsync=g}(jte);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(y$,"__esModule",{value:!0});var _7e=us,Hte=Mr,S7e=uC,E7e=jte,C7e=ai,A7e=ip;function k7e(e,t){var n,r=Hte.convertToTensor(e,"a","div"),i=Hte.convertToTensor(t,"b","div");n=_7e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=S7e.div(r,i),o=A7e.zerosLike(a),s=i.equal(o);return E7e.where(s,o,a)}y$.divNoNan=C7e.op({divNoNan_:k7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(f7e,"__esModule",{value:!0});var T7e=y$,O7e=kr;O7e.Tensor.prototype.divNoNan=function(e){return T7e.divNoNan(this,e)};var I7e={},_$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(_$,"__esModule",{value:!0});var N7e=Xr,D7e=mr,R7e=us,Gte=Mr,F7e=rp,M7e=ai,P7e=ip;function $7e(e,t){var n,r=Gte.convertToTensor(e,"a","squaredDifference"),i=Gte.convertToTensor(t,"b","squaredDifference");n=R7e.makeTypesMatch(r,i),r=n[0],i=n[1],F7e.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(f,d){var h=d[0],p=d[1],g=P7e.scalar(2),m=function(){return f.mul(h.sub(p).mul(g))},v=function(){return f.mul(p.sub(h).mul(g))};return{a:m,b:v}},o=function(f,d){var h=f.squaredDifference(r,i);return d([r,i]),h},s={a:r,b:i},u={},l=[r,i],c=[];return N7e.ENGINE.runKernelFunc(o,s,a,D7e.SquaredDifference,u,l,c)}_$.squaredDifference=M7e.op({squaredDifference_:$7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(I7e,"__esModule",{value:!0});var L7e=_$,B7e=kr;B7e.Tensor.prototype.squaredDifference=function(e){return L7e.squaredDifference(this,e)};var z7e={},S$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(S$,"__esModule",{value:!0});var j7e=Xr,U7e=mr,W7e=Mr,V7e=qe,q7e=ai;function H7e(e,t){var n=null,r=W7e.convertToTensor(e,"x","tile",n);V7e.assert(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" "+("must match length of reps "+t+".")});var i=function(u,l){var c=u.tile(r,t);return l([r]),c},a=[r],o={x:r},s={reps:t};return j7e.ENGINE.runKernelFunc(i,o,null,U7e.Tile,s,a)}S$.tile=q7e.op({tile_:H7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(z7e,"__esModule",{value:!0});var G7e=S$,K7e=kr;K7e.Tensor.prototype.tile=function(e){return G7e.tile(this,e)};var X7e={},E$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(E$,"__esModule",{value:!0});var Y7e=Xr,Z7e=mr,J7e=Mr,Q7e=ai;function eUe(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=J7e.convertToTensor(e,"indices","oneHot","int32"),a=i.shape.concat([t]);i=i.flatten();var o=function(c,f){return f([i]),c.oneHot(i,t,n,r)},s={indices:i},u={depth:t,onValue:n,offValue:r},l=Y7e.ENGINE.runKernelFunc(o,s,null,Z7e.OneHot,u);return l.reshape(a)}E$.oneHot=Q7e.op({oneHot_:eUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(X7e,"__esModule",{value:!0});var tUe=E$,nUe=kr;nUe.Tensor.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),tUe.oneHot(this,e,t,n)};var rUe={},C$={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(C$,"__esModule",{value:!0});var iUe=Xr,aUe=Mr,Kte=qe,oUe=ai;function sUe(e,t){var n=aUe.convertToTensor(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),Kte.assert(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" "+("must match length of perm "+t+".")}),t.forEach(function(i){Kte.assert(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+(" but got "+t)})}),n.rank<=1)return n.clone();var r={perm:t};return iUe.ENGINE.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}C$.transpose=oUe.op({transpose_:sUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(rUe,"__esModule",{value:!0});var uUe=C$,lUe=kr;lUe.Tensor.prototype.transpose=function(e){return uUe.transpose(this,e)};var cUe={},A$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(A$,"__esModule",{value:!0});var fUe=Xr,dUe=mr,hUe=Mr,pUe=ai;function gUe(e,t,n){n===void 0&&(n=0);var r=hUe.convertToTensor(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=function(s,u){return u([r]),s.pad(r,t,n)},a={paddings:t,constantValue:n},o={x:r};return fUe.ENGINE.runKernelFunc(i,o,null,dUe.PadV2,a)}A$.pad=pUe.op({pad_:gUe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(cUe,"__esModule",{value:!0});var mUe=A$,vUe=kr;vUe.Tensor.prototype.pad=function(e,t){return mUe.pad(this,e,t)};var yUe={},fC={},dC={},vr={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(vr,"__esModule",{value:!0});var Aa=Xr,Zb=nv,bUe=kr,xUe=us;function wUe(){Zb.env().set("PROD",!0)}vr.enableProdMode=wUe;function _Ue(){Zb.env().set("DEBUG",!0)}vr.enableDebugMode=_Ue;function SUe(){Zb.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}vr.disableDeprecationWarnings=SUe;function Xte(e){Zb.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}vr.deprecationWarn=Xte,bUe.setDeprecationWarningFn(Xte);function EUe(){Aa.ENGINE.disposeVariables()}vr.disposeVariables=EUe;function CUe(){return Aa.ENGINE}vr.engine=CUe;function AUe(){return Aa.ENGINE.memory()}vr.memory=AUe;function kUe(e){return Aa.ENGINE.profile(e)}vr.profile=kUe;function TUe(e,t){return Aa.ENGINE.tidy(e,t)}vr.tidy=TUe;function OUe(e){var t=xUe.getTensorsInContainer(e);t.forEach(function(n){return n.dispose()})}vr.dispose=OUe;function IUe(e){return Aa.ENGINE.keep(e)}vr.keep=IUe;function NUe(e){return Aa.ENGINE.time(e)}vr.time=NUe;function DUe(e){return Aa.ENGINE.setBackend(e)}vr.setBackend=DUe;function RUe(){return Aa.ENGINE.ready()}vr.ready=RUe;function FUe(){return Aa.ENGINE.backendName}vr.getBackend=FUe;function MUe(e){Aa.ENGINE.removeBackend(e)}vr.removeBackend=MUe;function PUe(e){return Aa.ENGINE.findBackend(e)}vr.findBackend=PUe;function $Ue(e){return Aa.ENGINE.findBackendFactory(e)}vr.findBackendFactory=$Ue;function LUe(e,t,n){return n===void 0&&(n=1),Aa.ENGINE.registerBackend(e,t,n)}vr.registerBackend=LUe;function BUe(){return Aa.ENGINE.backend}vr.backend=BUe;function zUe(e,t){Zb.env().setPlatform(e,t)}vr.setPlatform=zUe,Object.defineProperty(dC,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jUe=vr;function UUe(){jUe.deprecationWarn("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}dC.warnDeprecation=UUe;function WUe(e){var t;return e.rank===0||e.rank===1?t=e.as4D(1,1,1,e.size):e.rank===2?t=e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?t=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):t=e,t}dC.xAs4D=WUe;/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(fC,"__esModule",{value:!0});var VUe=Xr,Jb=Mr,k$=qe,Yte=dC,Zte=ai;function qUe(e,t,n,r,i,a){return r===void 0&&(r=.001),Yte.warnDeprecation(),Jte(e,t,n,a,i,r)}function Jte(e,t,n,r,i,a){a==null&&(a=.001);var o=Jb.convertToTensor(e,"x","batchNorm"),s=Jb.convertToTensor(t,"mean","batchNorm"),u=Jb.convertToTensor(n,"variance","batchNorm"),l;i!=null&&(l=Jb.convertToTensor(i,"scale","batchNorm"));var c;r!=null&&(c=Jb.convertToTensor(r,"offset","batchNorm")),k$.assert(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),k$.assert(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),k$.assert(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f=function(g,m){var v=Yte.xAs4D(o),y=g.batchNormalization(v,hC(s),hC(u),a,hC(l),hC(c));return m([o,s,u,l]),y},d={x:o,scale:l,offset:c,mean:s,variance:u},h={varianceEpsilon:a},p=VUe.ENGINE.runKernelFunc(f,d,null,"FusedBatchNorm",h);return p.reshape(o.shape)}function hC(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}fC.batchNormalization=Zte.op({batchNormalization_:qUe}),fC.batchNorm=Zte.op({batchNorm_:Jte}),Object.defineProperty(yUe,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var HUe=fC,GUe=kr;GUe.Tensor.prototype.batchNorm=function(e,t,n,r,i){return HUe.batchNorm(this,e,t,n,r,i)},Object.defineProperty(wje,"__esModule",{value:!0});var T$={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var KUe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),XUe=Object.prototype.hasOwnProperty;function O$(e,t){return XUe.call(e,t)}function I$(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)O$(e,r)&&n.push(r);return n}function Lo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function N$(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function ap(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Qte(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function D$(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(D$(e[t]))return!0}else if(typeof e=="object"){for(var r=I$(e),i=r.length,t=0;t<i;t++)if(D$(e[r[t]]))return!0}}return!1}function ene(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var tne=function(e){KUe(t,e);function t(n,r,i,a,o){var s=this.constructor,u=e.call(this,ene(n,{name:r,index:i,operation:a,tree:o}))||this;return u.name=r,u.index=i,u.operation=a,u.tree=o,Object.setPrototypeOf(u,s.prototype),u.message=ene(n,{name:r,index:i,operation:a,tree:o}),u}return t}(Error),Pr=tne,YUe=Lo,av={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=pC(n,this.path);r&&(r=Lo(r));var i=op(n,{op:"remove",path:this.from}).removed;return op(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=pC(n,this.from);return op(n,{op:"add",path:this.path,value:Lo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Qb(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},ZUe={add:function(e,t,n){return N$(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:av.move,copy:av.copy,test:av.test,_get:av._get};function pC(e,t){if(t=="")return e;var n={op:"_get",path:t};return op(e,n),n.value}function op(e,t,n,r,i,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):mC(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=pC(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=Qb(e,t.value),o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Pr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}}else{r||(e=Lo(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=mC;;){if(h=u[c],i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!N$(h))throw new Pr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);N$(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new Pr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var o=ZUe[t.op].call(t,l,h,e);if(o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(h&&h.indexOf("~")!=-1&&(h=Qte(h)),c>=f){var o=av[t.op].call(t,l,h,e);if(o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}l=l[h]}}}function gC(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Pr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Lo(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=op(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function JUe(e,t,n){var r=op(e,t);if(r.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function mC(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Pr("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(av[e.op]){if(typeof e.path!="string")throw new Pr("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Pr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Pr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Pr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&D$(e.value))throw new Pr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new Pr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Pr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},s=nne([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Pr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Pr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function nne(e,t,n){try{if(!Array.isArray(e))throw new Pr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)gC(Lo(t),Lo(e),n||!0);else{n=n||mC;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Pr)return i;throw i}}function Qb(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){if(a=e.length,a!=t.length)return!1;for(i=a;i--!=0;)if(!Qb(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(a=s.length,a!==Object.keys(t).length)return!1;for(i=a;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=a;i--!=0;)if(o=s[i],!Qb(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var QUe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:Pr,deepClone:YUe,getValueByPointer:pC,applyOperation:op,applyPatch:gC,applyReducer:JUe,validator:mC,validate:nne,_areEquals:Qb});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var R$=new WeakMap,eWe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),tWe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function nWe(e){return R$.get(e)}function rWe(e,t){return e.observers.get(t)}function iWe(e,t){e.observers.delete(t.callback)}function aWe(e,t){t.unobserve()}function oWe(e,t){var n=[],r,i=nWe(e);if(!i)i=new eWe(e),R$.set(e,i);else{var a=rWe(i,t);r=a&&a.observer}if(r)return r;if(r={},i.value=Lo(e),t){r.callback=t,r.next=null;var o=function(){F$(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){F$(r),clearTimeout(r.next),iWe(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new tWe(t,r)),r}function F$(e,t){t===void 0&&(t=!1);var n=R$.get(e.object);M$(n.value,e.object,e.patches,"",t),e.patches.length&&gC(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function M$(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=I$(t),o=I$(e),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(O$(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null?M$(c,f,n,r+"/"+ap(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+ap(l),value:Lo(c)}),n.push({op:"replace",path:r+"/"+ap(l),value:Lo(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+ap(l),value:Lo(c)}),n.push({op:"remove",path:r+"/"+ap(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&a.length==o.length))for(var u=0;u<a.length;u++){var l=a[u];!O$(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+ap(l),value:Lo(t[l])})}}}function sWe(e,t,n){n===void 0&&(n=!1);var r=[];return M$(e,t,r,"",n),r}var uWe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:aWe,observe:oWe,generate:F$,compare:sWe});Object.assign({},QUe,uWe,{JsonPatchError:tne,deepClone:Lo,escapePathComponent:ap,unescapePathComponent:Qte});var lWe=/("(?:[^\\"]|\\.)*")|[:,]/g,P$=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,a=n.replacer,function o(s,u,l){var c,f,d,h,p,g,m,v,y,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,a),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(y=x.replace(lWe,function(S,C){return C||S+" "}),y.length<=m))return y;if(a!=null&&(s=JSON.parse(x),a=void 0),typeof s=="object"&&s!==null){if(v=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(o(s[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(s),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=o(s[h],v,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[b,r+d.join(`,
`+v),c].join(`
`+u)}return x}(t,"",0)},Kf={exports:{}};const cWe="2.0.0",fWe=256,dWe=Number.MAX_SAFE_INTEGER||9007199254740991,hWe=16;var vC={SEMVER_SPEC_VERSION:cWe,MAX_LENGTH:fWe,MAX_SAFE_INTEGER:dWe,MAX_SAFE_COMPONENT_LENGTH:hWe};const pWe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var yC=pWe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=vC,r=yC;t=e.exports={};const i=t.re=[],a=t.src=[],o=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),o[l]=d,a[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${a[o.NUMERICIDENTIFIER]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${a[o.NUMERICIDENTIFIERLOOSE]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${a[o.PRERELEASEIDENTIFIER]}(?:\\.${a[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${a[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${a[o.BUILDIDENTIFIER]}(?:\\.${a[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${a[o.MAINVERSION]}${a[o.PRERELEASE]}?${a[o.BUILD]}?`),u("FULL",`^${a[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${a[o.MAINVERSIONLOOSE]}${a[o.PRERELEASELOOSE]}?${a[o.BUILD]}?`),u("LOOSE",`^${a[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${a[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${a[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:${a[o.PRERELEASE]})?${a[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:${a[o.PRERELEASELOOSE]})?${a[o.BUILD]}?)?)?`),u("XRANGE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",a[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${a[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${a[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${a[o.LONECARET]}${a[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${a[o.LONECARET]}${a[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${a[o.GTLT]}\\s*(${a[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]}|${a[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${a[o.XRANGEPLAIN]})\\s+-\\s+(${a[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${a[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Kf,Kf.exports);const gWe=["includePrerelease","loose","rtl"],mWe=e=>e?typeof e!="object"?{loose:!0}:gWe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var bC=mWe;const rne=/^[0-9]+$/,ine=(e,t)=>{const n=rne.test(e),r=rne.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},vWe=(e,t)=>ine(t,e);var $$={compareIdentifiers:ine,rcompareIdentifiers:vWe};const xC=yC,{MAX_LENGTH:ane,MAX_SAFE_INTEGER:wC}=vC,{re:one,t:sne}=Kf.exports,yWe=bC,{compareIdentifiers:e1}=$$;class Zs{constructor(t,n){if(n=yWe(n),t instanceof Zs){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>ane)throw new TypeError(`version is longer than ${ane} characters`);xC("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?one[sne.LOOSE]:one[sne.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>wC||this.major<0)throw new TypeError("Invalid major version");if(this.minor>wC||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>wC||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<wC)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(xC("SemVer.compare",this.version,this.options,t),!(t instanceof Zs)){if(typeof t=="string"&&t===this.version)return 0;t=new Zs(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Zs||(t=new Zs(t,this.options)),e1(this.major,t.major)||e1(this.minor,t.minor)||e1(this.patch,t.patch)}comparePre(t){if(t instanceof Zs||(t=new Zs(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(xC("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return e1(r,i)}while(++n)}compareBuild(t){t instanceof Zs||(t=new Zs(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(xC("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return e1(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var ka=Zs;const{MAX_LENGTH:bWe}=vC,{re:une,t:lne}=Kf.exports,cne=ka,xWe=bC,wWe=(e,t)=>{if(t=xWe(t),e instanceof cne)return e;if(typeof e!="string"||e.length>bWe||!(t.loose?une[lne.LOOSE]:une[lne.FULL]).test(e))return null;try{return new cne(e,t)}catch(r){return null}};var ov=wWe;const _We=ov,SWe=(e,t)=>{const n=_We(e,t);return n?n.version:null};var EWe=SWe;const CWe=ov,AWe=(e,t)=>{const n=CWe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var kWe=AWe;const TWe=ka,OWe=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new TWe(e,n).inc(t,r).version}catch(i){return null}};var IWe=OWe;const fne=ka,NWe=(e,t,n)=>new fne(e,n).compare(new fne(t,n));var Js=NWe;const DWe=Js,RWe=(e,t,n)=>DWe(e,t,n)===0;var L$=RWe;const dne=ov,FWe=L$,MWe=(e,t)=>{if(FWe(e,t))return null;{const n=dne(e),r=dne(t),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return a+s;return o}};var PWe=MWe;const $We=ka,LWe=(e,t)=>new $We(e,t).major;var BWe=LWe;const zWe=ka,jWe=(e,t)=>new zWe(e,t).minor;var UWe=jWe;const WWe=ka,VWe=(e,t)=>new WWe(e,t).patch;var qWe=VWe;const HWe=ov,GWe=(e,t)=>{const n=HWe(e,t);return n&&n.prerelease.length?n.prerelease:null};var KWe=GWe;const XWe=Js,YWe=(e,t,n)=>XWe(t,e,n);var ZWe=YWe;const JWe=Js,QWe=(e,t)=>JWe(e,t,!0);var eVe=QWe;const hne=ka,tVe=(e,t,n)=>{const r=new hne(e,n),i=new hne(t,n);return r.compare(i)||r.compareBuild(i)};var B$=tVe;const nVe=B$,rVe=(e,t)=>e.sort((n,r)=>nVe(n,r,t));var iVe=rVe;const aVe=B$,oVe=(e,t)=>e.sort((n,r)=>aVe(r,n,t));var sVe=oVe;const uVe=Js,lVe=(e,t,n)=>uVe(e,t,n)>0;var _C=lVe;const cVe=Js,fVe=(e,t,n)=>cVe(e,t,n)<0;var z$=fVe;const dVe=Js,hVe=(e,t,n)=>dVe(e,t,n)!==0;var pne=hVe;const pVe=Js,gVe=(e,t,n)=>pVe(e,t,n)>=0;var j$=gVe;const mVe=Js,vVe=(e,t,n)=>mVe(e,t,n)<=0;var U$=vVe;const yVe=L$,bVe=pne,xVe=_C,wVe=j$,_Ve=z$,SVe=U$,EVe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return yVe(e,n,r);case"!=":return bVe(e,n,r);case">":return xVe(e,n,r);case">=":return wVe(e,n,r);case"<":return _Ve(e,n,r);case"<=":return SVe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var gne=EVe;const CVe=ka,AVe=ov,{re:SC,t:EC}=Kf.exports,kVe=(e,t)=>{if(e instanceof CVe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(SC[EC.COERCE]);else{let r;for(;(r=SC[EC.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),SC[EC.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;SC[EC.COERCERTL].lastIndex=-1}return n===null?null:AVe(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var TVe=kVe,OVe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},IVe=wn;wn.Node=sp,wn.create=wn;function wn(e){var t=this;if(t instanceof wn||(t=new wn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}wn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},wn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},wn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},wn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)DVe(this,arguments[e]);return this.length},wn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)RVe(this,arguments[e]);return this.length},wn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},wn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},wn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next},wn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev},wn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},wn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},wn.prototype.map=function(e,t){t=t||this;for(var n=new wn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n},wn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new wn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n},wn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n},wn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n},wn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},wn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},wn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n},wn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n},wn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var a=[],r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=NVe(this,i,n[r]);return a},wn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function NVe(e,t,n){var r=t===e.head?new sp(n,null,t,e):new sp(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function DVe(e,t){e.tail=new sp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function RVe(e,t){e.head=new sp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function sp(e,t,n,r){if(!(this instanceof sp))return new sp(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{OVe(wn)}catch(e){}const FVe=IVe,up=Symbol("max"),yc=Symbol("length"),sv=Symbol("lengthCalculator"),t1=Symbol("allowStale"),lp=Symbol("maxAge"),bc=Symbol("dispose"),mne=Symbol("noDisposeOnSet"),bi=Symbol("lruList"),Qs=Symbol("cache"),vne=Symbol("updateAgeOnGet"),W$=()=>1;class MVe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[up]=t.max||1/0;const n=t.length||W$;if(this[sv]=typeof n!="function"?W$:n,this[t1]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[lp]=t.maxAge||0,this[bc]=t.dispose,this[mne]=t.noDisposeOnSet||!1,this[vne]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[up]=t||1/0,n1(this)}get max(){return this[up]}set allowStale(t){this[t1]=!!t}get allowStale(){return this[t1]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[lp]=t,n1(this)}get maxAge(){return this[lp]}set lengthCalculator(t){typeof t!="function"&&(t=W$),t!==this[sv]&&(this[sv]=t,this[yc]=0,this[bi].forEach(n=>{n.length=this[sv](n.value,n.key),this[yc]+=n.length})),n1(this)}get lengthCalculator(){return this[sv]}get length(){return this[yc]}get itemCount(){return this[bi].length}rforEach(t,n){n=n||this;for(let r=this[bi].tail;r!==null;){const i=r.prev;yne(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[bi].head;r!==null;){const i=r.next;yne(this,t,r,n),r=i}}keys(){return this[bi].toArray().map(t=>t.key)}values(){return this[bi].toArray().map(t=>t.value)}reset(){this[bc]&&this[bi]&&this[bi].length&&this[bi].forEach(t=>this[bc](t.key,t.value)),this[Qs]=new Map,this[bi]=new FVe,this[yc]=0}dump(){return this[bi].map(t=>CC(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[bi]}set(t,n,r){if(r=r||this[lp],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,a=this[sv](n,t);if(this[Qs].has(t)){if(a>this[up])return uv(this,this[Qs].get(t)),!1;const u=this[Qs].get(t).value;return this[bc]&&(this[mne]||this[bc](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[yc]+=a-u.length,u.length=a,this.get(t),n1(this),!0}const o=new PVe(t,n,a,i,r);return o.length>this[up]?(this[bc]&&this[bc](t,n),!1):(this[yc]+=o.length,this[bi].unshift(o),this[Qs].set(t,this[bi].head),n1(this),!0)}has(t){if(!this[Qs].has(t))return!1;const n=this[Qs].get(t).value;return!CC(this,n)}get(t){return V$(this,t,!0)}peek(t){return V$(this,t,!1)}pop(){const t=this[bi].tail;return t?(uv(this,t),t.value):null}del(t){uv(this,this[Qs].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-n;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Qs].forEach((t,n)=>V$(this,n,!1))}}const V$=(e,t,n)=>{const r=e[Qs].get(t);if(r){const i=r.value;if(CC(e,i)){if(uv(e,r),!e[t1])return}else n&&(e[vne]&&(r.value.now=Date.now()),e[bi].unshiftNode(r));return i.value}},CC=(e,t)=>{if(!t||!t.maxAge&&!e[lp])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[lp]&&n>e[lp]},n1=e=>{if(e[yc]>e[up])for(let t=e[bi].tail;e[yc]>e[up]&&t!==null;){const n=t.prev;uv(e,t),t=n}},uv=(e,t)=>{if(t){const n=t.value;e[bc]&&e[bc](n.key,n.value),e[yc]-=n.length,e[Qs].delete(n.key),e[bi].removeNode(t)}};class PVe{constructor(t,n,r,i,a){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=a||0}}const yne=(e,t,n,r)=>{let i=n.value;CC(e,i)&&(uv(e,n),e[t1]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var $Ve=MVe;class r1{constructor(t,n){if(n=BVe(n),t instanceof r1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new r1(t.raw,n);if(t instanceof q$)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!xne(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&VVe(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=bne.get(r);if(i)return i;const a=this.options.loose,o=a?Xi[Pi.HYPHENRANGELOOSE]:Xi[Pi.HYPHENRANGE];t=t.replace(o,eqe(this.options.includePrerelease)),$r("hyphen replace",t),t=t.replace(Xi[Pi.COMPARATORTRIM],jVe),$r("comparator trim",t,Xi[Pi.COMPARATORTRIM]),t=t.replace(Xi[Pi.TILDETRIM],UVe),t=t.replace(Xi[Pi.CARETTRIM],WVe),t=t.split(/\s+/).join(" ");const s=a?Xi[Pi.COMPARATORLOOSE]:Xi[Pi.COMPARATOR],u=t.split(" ").map(f=>qVe(f,this.options)).join(" ").split(/\s+/).map(f=>QVe(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new q$(f,this.options));u.length;const l=new Map;for(const f of u){if(xne(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return bne.set(r,c),c}intersects(t,n){if(!(t instanceof r1))throw new TypeError("a Range is required");return this.set.some(r=>wne(r,n)&&t.set.some(i=>wne(i,n)&&r.every(a=>i.every(o=>a.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new zVe(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(tqe(this.set[n],t,this.options))return!0;return!1}}var eu=r1;const LVe=$Ve,bne=new LVe({max:1e3}),BVe=bC,q$=kC,$r=yC,zVe=ka,{re:Xi,t:Pi,comparatorTrimReplace:jVe,tildeTrimReplace:UVe,caretTrimReplace:WVe}=Kf.exports,xne=e=>e.value==="<0.0.0-0",VVe=e=>e.value==="",wne=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(a=>i.intersects(a,t)),i=r.pop();return n},qVe=(e,t)=>($r("comp",e,t),e=KVe(e,t),$r("caret",e),e=HVe(e,t),$r("tildes",e),e=YVe(e,t),$r("xrange",e),e=JVe(e,t),$r("stars",e),e),Ta=e=>!e||e.toLowerCase()==="x"||e==="*",HVe=(e,t)=>e.trim().split(/\s+/).map(n=>GVe(n,t)).join(" "),GVe=(e,t)=>{const n=t.loose?Xi[Pi.TILDELOOSE]:Xi[Pi.TILDE];return e.replace(n,(r,i,a,o,s)=>{$r("tilde",e,r,i,a,o,s);let u;return Ta(i)?u="":Ta(a)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:Ta(o)?u=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:s?($r("replaceTilde pr",s),u=`>=${i}.${a}.${o}-${s} <${i}.${+a+1}.0-0`):u=`>=${i}.${a}.${o} <${i}.${+a+1}.0-0`,$r("tilde return",u),u})},KVe=(e,t)=>e.trim().split(/\s+/).map(n=>XVe(n,t)).join(" "),XVe=(e,t)=>{$r("caret",e,t);const n=t.loose?Xi[Pi.CARETLOOSE]:Xi[Pi.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,a,o,s,u)=>{$r("caret",e,i,a,o,s,u);let l;return Ta(a)?l="":Ta(o)?l=`>=${a}.0.0${r} <${+a+1}.0.0-0`:Ta(s)?a==="0"?l=`>=${a}.${o}.0${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.0${r} <${+a+1}.0.0-0`:u?($r("replaceCaret pr",u),a==="0"?o==="0"?l=`>=${a}.${o}.${s}-${u} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}-${u} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s}-${u} <${+a+1}.0.0-0`):($r("no pr"),a==="0"?o==="0"?l=`>=${a}.${o}.${s}${r} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s} <${+a+1}.0.0-0`),$r("caret return",l),l})},YVe=(e,t)=>($r("replaceXRanges",e,t),e.split(/\s+/).map(n=>ZVe(n,t)).join(" ")),ZVe=(e,t)=>{e=e.trim();const n=t.loose?Xi[Pi.XRANGELOOSE]:Xi[Pi.XRANGE];return e.replace(n,(r,i,a,o,s,u)=>{$r("xRange",e,r,i,a,o,s,u);const l=Ta(a),c=l||Ta(o),f=c||Ta(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(o=0),s=0,i===">"?(i=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):i==="<="&&(i="<",c?a=+a+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:f&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),$r("xRange return",r),r})},JVe=(e,t)=>($r("replaceStars",e,t),e.trim().replace(Xi[Pi.STAR],"")),QVe=(e,t)=>($r("replaceGTE0",e,t),e.trim().replace(Xi[t.includePrerelease?Pi.GTE0PRE:Pi.GTE0],"")),eqe=e=>(t,n,r,i,a,o,s,u,l,c,f,d,h)=>(Ta(r)?n="":Ta(i)?n=`>=${r}.0.0${e?"-0":""}`:Ta(a)?n=`>=${r}.${i}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Ta(l)?u="":Ta(c)?u=`<${+l+1}.0.0-0`:Ta(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),tqe=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if($r(e[r].semver),e[r].semver!==q$.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},i1=Symbol("SemVer ANY");class AC{static get ANY(){return i1}constructor(t,n){if(n=nqe(n),t instanceof AC){if(t.loose===!!n.loose)return t;t=t.value}G$("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===i1?this.value="":this.value=this.operator+this.semver.version,G$("comp",this)}parse(t){const n=this.options.loose?_ne[Sne.COMPARATORLOOSE]:_ne[Sne.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Ene(r[2],this.options.loose):this.semver=i1}toString(){return this.value}test(t){if(G$("Comparator.test",t,this.options.loose),this.semver===i1||t===i1)return!0;if(typeof t=="string")try{t=new Ene(t,this.options)}catch(n){return!1}return H$(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof AC))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new Cne(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new Cne(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),a=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=H$(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=H$(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||s||u}}var kC=AC;const nqe=bC,{re:_ne,t:Sne}=Kf.exports,H$=gne,G$=yC,Ene=ka,Cne=eu,rqe=eu,iqe=(e,t,n)=>{try{t=new rqe(t,n)}catch(r){return!1}return t.test(e)};var TC=iqe;const aqe=eu,oqe=(e,t)=>new aqe(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var sqe=oqe;const uqe=ka,lqe=eu,cqe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new lqe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new uqe(r,n))}),r};var fqe=cqe;const dqe=ka,hqe=eu,pqe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new hqe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new dqe(r,n))}),r};var gqe=pqe;const K$=ka,mqe=eu,Ane=_C,vqe=(e,t)=>{e=new mqe(e,t);let n=new K$("0.0.0");if(e.test(n)||(n=new K$("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let a=null;i.forEach(o=>{const s=new K$(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||Ane(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!n||Ane(n,a))&&(n=a)}return n&&e.test(n)?n:null};var yqe=vqe;const bqe=eu,xqe=(e,t)=>{try{return new bqe(e,t).range||"*"}catch(n){return null}};var wqe=xqe;const _qe=ka,kne=kC,{ANY:Sqe}=kne,Eqe=eu,Cqe=TC,Tne=_C,One=z$,Aqe=U$,kqe=j$,Tqe=(e,t,n,r)=>{e=new _qe(e,r),t=new Eqe(t,r);let i,a,o,s,u;switch(n){case">":i=Tne,a=Aqe,o=One,s=">",u=">=";break;case"<":i=One,a=kqe,o=Tne,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Cqe(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===Sqe&&(h=new kne(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:o(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var X$=Tqe;const Oqe=X$,Iqe=(e,t,n)=>Oqe(e,t,">",n);var Nqe=Iqe;const Dqe=X$,Rqe=(e,t,n)=>Dqe(e,t,"<",n);var Fqe=Rqe;const Ine=eu,Mqe=(e,t,n)=>(e=new Ine(e,n),t=new Ine(t,n),e.intersects(t));var Pqe=Mqe;const $qe=TC,Lqe=Js;var Bqe=(e,t,n)=>{const r=[];let i=null,a=null;const o=e.sort((c,f)=>Lqe(c,f,n));for(const c of o)$qe(c,t,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const Nne=eu,OC=kC,{ANY:Y$}=OC,a1=TC,Z$=Js,zqe=(e,t,n={})=>{if(e===t)return!0;e=new Nne(e,n),t=new Nne(t,n);let r=!1;e:for(const i of e.set){for(const a of t.set){const o=jqe(i,a,n);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},jqe=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Y$){if(t.length===1&&t[0].semver===Y$)return!0;n.includePrerelease?e=[new OC(">=0.0.0-0")]:e=[new OC(">=0.0.0")]}if(t.length===1&&t[0].semver===Y$){if(n.includePrerelease)return!0;t=[new OC(">=0.0.0")]}const r=new Set;let i,a;for(const h of e)h.operator===">"||h.operator===">="?i=Dne(i,h,n):h.operator==="<"||h.operator==="<="?a=Rne(a,h,n):r.add(h.semver);if(r.size>1)return null;let o;if(i&&a){if(o=Z$(i.semver,a.semver,n),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!a1(h,String(i),n)||a&&!a1(h,String(a),n))return null;for(const p of t)if(!a1(h,String(p),n))return!1;return!0}let s,u,l,c,f=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=Dne(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!a1(i.semver,String(h),n))return!1}if(a){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=Rne(a,h,n),u===h&&u!==a)return!1}else if(a.operator==="<="&&!a1(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&o!==0)return!1}return!(i&&l&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},Dne=(e,t,n)=>{if(!e)return t;const r=Z$(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},Rne=(e,t,n)=>{if(!e)return t;const r=Z$(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var Uqe=zqe;const J$=Kf.exports;var Fne={re:J$.re,src:J$.src,tokens:J$.t,SEMVER_SPEC_VERSION:vC.SEMVER_SPEC_VERSION,SemVer:ka,compareIdentifiers:$$.compareIdentifiers,rcompareIdentifiers:$$.rcompareIdentifiers,parse:ov,valid:EWe,clean:kWe,inc:IWe,diff:PWe,major:BWe,minor:UWe,patch:qWe,prerelease:KWe,compare:Js,rcompare:ZWe,compareLoose:eVe,compareBuild:B$,sort:iVe,rsort:sVe,gt:_C,lt:z$,eq:L$,neq:pne,gte:j$,lte:U$,cmp:gne,coerce:TVe,Comparator:kC,Range:eu,satisfies:TC,toComparators:sqe,maxSatisfying:fqe,minSatisfying:gqe,minVersion:yqe,validRange:wqe,outside:X$,gtr:Nqe,ltr:Fqe,intersects:Pqe,simplifyRange:Bqe,subset:Uqe};function ro(e,t,n){return e.fields=t||[],e.fname=n,e}function Tr(e){return e==null?null:e.fname}function Yi(e){return e==null?null:e.fields}function Mne(e){return e.length===1?Wqe(e[0]):Vqe(e)}const Wqe=e=>function(t){return t[e]},Vqe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Se(e){throw Error(e)}function IC(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||Se("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&Se("Access path missing closing bracket: "+e),r&&Se("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function io(e,t,n){const r=IC(e);return e=r.length===1?r[0]:e,ro((n&&n.get||Mne)(r),[e],t||e)}const o1=io("id"),Oa=ro(e=>e,[],"identity"),Xf=ro(()=>0,[],"zero"),lv=ro(()=>1,[],"one"),ls=ro(()=>!0,[],"true"),Yf=ro(()=>!1,[],"false");function NC(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const Pne=0,Q$=1,$ne=2,Lne=3,Bne=4;function zne(e,t){let n=e||Pne;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=Q$&&NC(t||"error","ERROR",arguments),this},warn(){return n>=$ne&&NC(t||"warn","WARN",arguments),this},info(){return n>=Lne&&NC(t||"log","INFO",arguments),this},debug(){return n>=Bne&&NC(t||"log","DEBUG",arguments),this}}}var ut=Array.isArray;function Nt(e){return e===Object(e)}const jne=e=>e!=="__proto__";function DC(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=qqe(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;RC(t,r,n[r],i)}return t},{})}function RC(e,t,n,r){if(!jne(t))return;let i,a;if(Nt(n)&&!ut(n)){a=Nt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?RC(a,i,n[i]):jne(i)&&(a[i]=n[i])}else e[t]=n}function qqe(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function sn(e){return e[e.length-1]}function Zi(e){return e==null||e===""?null:+e}const Une=e=>t=>e*Math.exp(t),Wne=e=>t=>Math.log(e*t),Vne=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),qne=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,FC=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function MC(e,t,n,r){const i=n(e[0]),a=n(sn(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Hne(e,t){return MC(e,t,Zi,Oa)}function Gne(e,t){var n=Math.sign(e[0]);return MC(e,t,Wne(n),Une(n))}function Kne(e,t,n){return MC(e,t,FC(n),FC(1/n))}function Xne(e,t,n){return MC(e,t,Vne(n),qne(n))}function PC(e,t,n,r,i){const a=r(e[0]),o=r(sn(e)),s=t!=null?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function e4(e,t,n){return PC(e,t,n,Zi,Oa)}function t4(e,t,n){const r=Math.sign(e[0]);return PC(e,t,n,Wne(r),Une(r))}function $C(e,t,n,r){return PC(e,t,n,FC(r),FC(1/r))}function n4(e,t,n,r){return PC(e,t,n,Vne(r),qne(r))}function Yne(e){return 1+~~(new Date(e).getMonth()/3)}function Zne(e){return 1+~~(new Date(e).getUTCMonth()/3)}function wt(e){return e!=null?ut(e)?e:[e]:[]}function Jne(e,t,n){let r=e[0],i=e[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Lt(e){return typeof e=="function"}const Hqe="descending";function r4(e,t,n){n=n||{},t=wt(t)||[];const r=[],i=[],a={},o=n.comparator||Gqe;return wt(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===Hqe?-1:1),i.push(s=Lt(s)?s:io(s,null,n)),(Yi(s)||[]).forEach(l=>a[l]=1))}),i.length===0?null:ro(o(i,r),Object.keys(a))}const LC=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),Gqe=(e,t)=>e.length===1?Kqe(e[0],t[0]):Xqe(e,t,e.length),Kqe=(e,t)=>function(n,r){return LC(e(n),e(r))*t},Xqe=(e,t,n)=>(t.push(0),function(r,i){let a,o=0,s=-1;for(;o===0&&++s<n;)a=e[s],o=LC(a(r),a(i));return o*t[s]});function Ji(e){return Lt(e)?e:()=>e}function i4(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Rt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function tl(e,t){let n=0,r,i,a,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(a=o=i;n<r;++n)i=e[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(a=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Qne(e,t){const n=e.length;let r=-1,i,a,o,s,u;if(t==null){for(;++r<n;)if(a=e[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=e[r],a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}else{for(;++r<n;)if(a=t(e[r],r,e),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=t(e[r],r,e),a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}return[s,u]}const Yqe=Object.prototype.hasOwnProperty;function _t(e,t){return Yqe.call(e,t)}const BC={};function cv(e){let t={},n;function r(a){return _t(t,a)&&t[a]!==BC}const i={size:0,empty:0,object:t,has:r,get(a){return r(a)?t[a]:void 0},set(a,o){return r(a)||(++i.size,t[a]===BC&&--i.empty),t[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,t[a]=BC),this},clear(){i.size=i.empty=0,i.object=t={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const s in t){const u=t[s];u!==BC&&(!n||!n(u))&&(a[s]=u,++o)}i.size=o,i.empty=0,i.object=t=a}};return e&&Object.keys(e).forEach(a=>{i.set(a,e[a])}),i}function ere(e,t,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let s=e[0],u=sn(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:a}function $e(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Rt(r,n)}function fv(e,t,n,r){let i=t[0],a=t[t.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=a:e<a)}function a4(e){return typeof e=="boolean"}function Zf(e){return Object.prototype.toString.call(e)==="[object Date]"}function tre(e){return e&&Lt(e[Symbol.iterator])}function Jf(e){return typeof e=="number"}function nre(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Bn(e){return typeof e=="string"}function o4(e,t,n){e&&(e=t?wt(e).map(s=>s.replace(/\\(.)/g,"$1")):wt(e));const r=e&&e.length,i=n&&n.get||Mne,a=s=>i(t?[s]:IC(s));let o;if(!r)o=function(){return""};else if(r===1){const s=a(e[0]);o=function(u){return""+s(u)}}else{const s=e.map(a);o=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return ro(o,e,"key")}function rre(e,t){const n=e[0],r=sn(e),i=+t;return i?i===1?r:n+i*(r-n):n}const Zqe=1e4;function ire(e){e=+e||Zqe;let t,n,r;const i=()=>{t={},n={},r=0},a=(o,s)=>(++r>e&&(n=t,t={},r=1),t[o]=s);return i(),{clear:i,has:o=>_t(t,o)||_t(n,o),get:o=>_t(t,o)?t[o]:_t(n,o)?a(o,n[o]):void 0,set:(o,s)=>_t(t,o)?t[o]=s:a(o,s)}}function are(e,t,n,r){const i=t.length,a=n.length;if(!a)return t;if(!i)return n;const o=r||new t.constructor(i+a);let s=0,u=0,l=0;for(;s<i&&u<a;++l)o[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)o[l]=t[s];for(;u<a;++u,++l)o[l]=n[u];return o}function s1(e,t){let n="";for(;--t>=0;)n+=e;return n}function ore(e,t,n,r){const i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?s1(i,o)+a:r==="center"?s1(i,~~(o/2))+a+s1(i,Math.ceil(o/2)):a+s1(i,o)}function u1(e){return e&&sn(e)-e[0]||0}function gt(e){return ut(e)?"["+e.map(gt)+"]":Nt(e)||Bn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function s4(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Jqe=e=>Jf(e)||Zf(e)?e:Date.parse(e);function u4(e,t){return t=t||Jqe,e==null||e===""?null:t(e)}function l4(e){return e==null||e===""?null:e+""}function tu(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function sre(e,t,n,r){const i=r??"\u2026",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-s):n==="center"?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function Qf(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const a=t(e[i]);a&&n(a,i,e)}}else e.forEach(n)}const Qqe=/^([A-Za-z]+:)?\/\//,eHe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,tHe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ure="file://";function nHe(e,t){return n=>({options:n||{},sanitize:iHe,load:rHe,fileAccess:!!t,file:aHe(t),http:sHe(e)})}async function rHe(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function iHe(e,t){t=Rt({},this.options,t);const n=this.fileAccess,r={href:null};let i,a,o;const s=eHe.test(e.replace(tHe,""));(e==null||typeof e!="string"||!s)&&Se("Sanitize failure, invalid URI: "+gt(e));const u=Qqe.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&o[o.length-1]!=="/"&&(e="/"+e),e=o+e),a=(i=e.startsWith(ure))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(ure.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!a}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function aHe(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,a)=>{i?r(i):n(a)})}):oHe}async function oHe(){Se("No file system access.")}function sHe(e){return e?async function(t,n){const r=Rt({},this.options.http,n),i=n&&n.response,a=await e(t,r);return a.ok?Lt(a[i])?a[i]():a.text():Se(a.status+""+a.statusText)}:uHe}async function uHe(){Se("No HTTP fetch method available.")}const lHe=e=>e!=null&&e===e,cHe=e=>e==="true"||e==="false"||e===!0||e===!1,fHe=e=>!Number.isNaN(Date.parse(e)),lre=e=>!Number.isNaN(+e)&&!(e instanceof Date),dHe=e=>lre(e)&&Number.isInteger(+e),c4={boolean:s4,integer:Zi,number:Zi,date:u4,string:l4,unknown:Oa},zC=[cHe,dHe,lre,fHe],hHe=["boolean","integer","number","date"];function cre(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=zC.length,i=zC.map((a,o)=>o+1);for(let a=0,o=0,s,u;a<n;++a)for(u=t?e[a][t]:e[a],s=0;s<r;++s)if(i[s]&&lHe(u)&&!zC[s](u)&&(i[s]=0,++o,o===zC.length))return"string";return hHe[i.reduce((a,o)=>a===0?o:a,0)-1]}function fre(e,t){return t.reduce((n,r)=>(n[r]=cre(e,r),n),{})}var dre={},f4={},d4=34,l1=10,h4=13;function hre(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function pHe(e,t){var n=hre(e);return function(r,i){return t(n(r),i,e)}}function pre(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function ao(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function gHe(e){return e<0?"-"+ao(-e,6):e>9999?"+"+ao(e,6):ao(e,4)}function mHe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":gHe(e.getUTCFullYear())+"-"+ao(e.getUTCMonth()+1,2)+"-"+ao(e.getUTCDate(),2)+(i?"T"+ao(t,2)+":"+ao(n,2)+":"+ao(r,2)+"."+ao(i,3)+"Z":r?"T"+ao(t,2)+":"+ao(n,2)+":"+ao(r,2)+"Z":n||t?"T"+ao(t,2)+":"+ao(n,2)+"Z":"")}function vHe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?pHe(m,d):hre(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===l1&&--p,f.charCodeAt(p-1)===h4&&--p;function x(){if(y)return f4;if(b)return b=!1,dre;var S,C=g,_;if(f.charCodeAt(C)===d4){for(;g++<p&&f.charCodeAt(g)!==d4||f.charCodeAt(++g)===d4;);return(S=g)>=p?y=!0:(_=f.charCodeAt(g++))===l1?b=!0:_===h4&&(b=!0,f.charCodeAt(g)===l1&&++g),f.slice(C+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===l1)b=!0;else if(_===h4)b=!0,f.charCodeAt(g)===l1&&++g;else if(_!==n)continue;return f.slice(C,S)}return y=!0,f.slice(C,p)}for(;(v=x())!==f4;){for(var w=[];v!==dre&&v!==f4;)w.push(v),v=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function a(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=pre(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=pre(f)),a(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?mHe(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function gre(e){const t=function(n,r){const i={delimiter:e};return p4(n,r?Rt(r,i):i)};return t.responseType="text",t}function p4(e,t){return t.header&&(e=t.header.map(gt).join(t.delimiter)+`
`+e),vHe(t.delimiter).parse(e+"")}p4.responseType="text";function yHe(e){return typeof Buffer=="function"&&Lt(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function g4(e,t){const n=t&&t.property?io(t.property):Oa;return Nt(e)&&!yHe(e)?bHe(n(e),t):n(JSON.parse(e))}g4.responseType="json";function bHe(e,t){return!ut(e)&&tre(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function xHe(e){return e}function wHe(e){if(e==null)return xHe;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+a,f[1]=(n+=s[1])*i+o;l<c;)f[l]=s[l],++l;return f}}function _He(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function SHe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return mre(e,n)})}:mre(e,t)}function mre(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=vre(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function vre(e,t){var n=wHe(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&_He(f,p)}function a(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function EHe(e,t){var n={},r={},i={},a=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),a.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function CHe(e){return vre(e,AHe.apply(this,arguments))}function AHe(e,t,n){var r,i,a;if(arguments.length>1)r=kHe(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:EHe(e,r)}}function kHe(e,t,n){var r=[],i=[],a;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:a})}function s(f){f.forEach(o)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(a=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}const THe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function yre(e,t){let n,r,i,a;return e=g4(e,t),t&&t.feature?(n=SHe,i=t.feature):t&&t.mesh?(n=CHe,i=t.mesh,a=THe[t.filter]):Se("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,a):Se("Invalid TopoJSON object: "+i),r&&r.features||[r]}yre.responseType="json";const jC={dsv:p4,csv:gre(","),tsv:gre("	"),json:g4,topojson:yre};function m4(e,t){return arguments.length>1?(jC[e]=t,this):_t(jC,e)?jC[e]:null}function bre(e){const t=m4(e);return t&&t.responseType||"text"}function dv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function c1(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=OHe(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function OHe(e){return(t,n)=>dv(e(t),n)}function xre(e){return e===null?NaN:+e}function*IHe(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const wre=c1(dv),UC=wre.right,NHe=wre.left;c1(xre).center;var f1=UC;function DHe(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function RHe(e,t){const n=DHe(e,t);return n&&Math.sqrt(n)}class Ia{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function FHe(e,t){return Array.from(t,n=>e[n])}var v4=Math.sqrt(50),y4=Math.sqrt(10),b4=Math.sqrt(2);function x4(e,t,n){var r,i=-1,a,o,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(s=_re(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)/s}return r&&o.reverse(),o}function _re(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=v4?10:a>=y4?5:a>=b4?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=v4?10:a>=y4?5:a>=b4?2:1)}function ed(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=v4?i*=10:a>=y4?i*=5:a>=b4&&(i*=2),t<e?-i:i}function cp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function w4(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Sre(e,t,n=0,r=e.length-1,i=dv){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));Sre(e,t,h,p,i)}const a=e[t];let o=n,s=r;for(d1(e,n,t),i(e[r],a)>0&&d1(e,n,r);o<s;){for(d1(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?d1(e,n,s):(++s,d1(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function d1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function _4(e,t,n){if(e=Float64Array.from(IHe(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return w4(e);if(t>=1)return cp(e);var r,i=(r-1)*t,a=Math.floor(i),o=cp(Sre(e,a).subarray(0,a+1)),s=w4(e.subarray(a+1));return o+(s-o)*(i-a)}}function Ere(e,t,n=xre){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function MHe(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function Cre(e,t){return _4(e,.5,t)}function*PHe(e){for(const t of e)yield*t}function Are(e){return Array.from(PHe(e))}function Bo(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function kre(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function $He(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function WC(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function hv(e){return e=WC(Math.abs(e)),e?e[1]:NaN}function LHe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function BHe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var zHe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function h1(e){if(!(t=zHe.exec(e)))throw new Error("invalid format: "+e);var t;return new S4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}h1.prototype=S4.prototype;function S4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}S4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jHe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Tre;function UHe(e,t){var n=WC(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Tre=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+WC(e,Math.max(0,t+a-1))[0]}function Ore(e,t){var n=WC(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Ire={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:$He,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ore(e*100,t),r:Ore,s:UHe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Nre(e){return e}var Dre=Array.prototype.map,Rre=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Fre(e){var t=e.grouping===void 0||e.thousands===void 0?Nre:LHe(Dre.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?Nre:BHe(Dre.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=h1(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):Ire[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=g==="$"?r:/[%p]/.test(w)?o:"",_=Ire[w],E=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function A(k){var T=S,I=C,N,O,D;if(w==="c")I=_(k)+I,k="";else{k=+k;var L=k<0||1/k<0;if(k=isNaN(k)?u:_(Math.abs(k),b),x&&(k=jHe(k)),L&&+k==0&&p!=="+"&&(L=!1),T=(L?p==="("?p:s:p==="-"||p==="("?"":p)+T,I=(w==="s"?Rre[8+Tre/3]:"")+I+(L&&p==="("?")":""),E){for(N=-1,O=k.length;++N<O;)if(D=k.charCodeAt(N),48>D||D>57){I=(D===46?i+k.slice(N+1):k.slice(N))+I,k=k.slice(0,N);break}}}y&&!m&&(k=t(k,1/0));var W=T.length+k.length+I.length,G=W<v?new Array(v-W+1).join(d):"";switch(y&&m&&(k=t(G+k,G.length?v-I.length:1/0),G=""),h){case"<":k=T+k+I+G;break;case"=":k=T+G+k+I;break;case"^":k=G.slice(0,W=G.length>>1)+T+k+I+G.slice(W);break;default:k=G+T+k+I;break}return a(k)}return A.toString=function(){return f+""},A}function c(f,d){var h=l((f=h1(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(hv(d)/3)))*3,g=Math.pow(10,-p),m=Rre[8+p/3];return function(v){return h(g*v)+m}}return{format:l,formatPrefix:c}}var VC,Mre,Pre;WHe({thousands:",",grouping:[3],currency:["$",""]});function WHe(e){return VC=Fre(e),Mre=VC.format,Pre=VC.formatPrefix,VC}function VHe(e){return Math.max(0,-hv(Math.abs(e)))}function qHe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(hv(t)/3)))*3-hv(Math.abs(e)))}function HHe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hv(t)-hv(e))+1}var E4=new Date,C4=new Date;function xi(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return xi(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},n&&(i.count=function(a,o){return E4.setTime(+a),C4.setTime(+o),e(E4),e(C4),Math.floor(n(E4,C4))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a==0}:function(o){return i.count(0,o)%a==0}):i}),i}var A4=xi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});A4.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?xi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):A4};var k4=A4;const xc=1e3,cs=xc*60,wc=cs*60,fp=wc*24,T4=fp*7,$re=fp*30,O4=fp*365;var GHe=xi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*xc)},function(e,t){return(t-e)/xc},function(e){return e.getUTCSeconds()}),td=GHe,KHe=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xc)},function(e,t){e.setTime(+e+t*cs)},function(e,t){return(t-e)/cs},function(e){return e.getMinutes()}),I4=KHe,XHe=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xc-e.getMinutes()*cs)},function(e,t){e.setTime(+e+t*wc)},function(e,t){return(t-e)/wc},function(e){return e.getHours()}),N4=XHe,YHe=xi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*cs)/fp,e=>e.getDate()-1),nd=YHe;function dp(e){return xi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*cs)/T4})}var p1=dp(0),D4=dp(1);dp(2),dp(3);var g1=dp(4);dp(5),dp(6);var ZHe=xi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),qC=ZHe,Lre=xi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Lre.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var rd=Lre,JHe=xi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*cs)},function(e,t){return(t-e)/cs},function(e){return e.getUTCMinutes()}),R4=JHe,QHe=xi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*wc)},function(e,t){return(t-e)/wc},function(e){return e.getUTCHours()}),F4=QHe,eGe=xi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/fp},function(e){return e.getUTCDate()-1}),id=eGe;function hp(e){return xi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/T4})}var m1=hp(0),M4=hp(1);hp(2),hp(3);var v1=hp(4);hp(5),hp(6);var tGe=xi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),HC=tGe,Bre=xi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Bre.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var ad=Bre;function zre(e,t,n,r,i,a){const o=[[td,1,xc],[td,5,5*xc],[td,15,15*xc],[td,30,30*xc],[a,1,cs],[a,5,5*cs],[a,15,15*cs],[a,30,30*cs],[i,1,wc],[i,3,3*wc],[i,6,6*wc],[i,12,12*wc],[r,1,fp],[r,2,2*fp],[n,1,T4],[t,1,$re],[t,3,3*$re],[e,1,O4]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=c1(([,,m])=>m).right(o,d);if(h===o.length)return e.every(ed(l/O4,c/O4,f));if(h===0)return k4.every(Math.max(ed(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[s,u]}const[nGe,rGe]=zre(ad,HC,m1,id,F4,R4),[iGe,aGe]=zre(rd,qC,p1,nd,N4,I4),$i="year",oo="quarter",Qi="month",si="week",so="date",ea="day",nl="dayofyear",zo="hours",jo="minutes",fs="seconds",nu="milliseconds",P4=[$i,oo,Qi,si,so,ea,nl,zo,jo,fs,nu],$4=P4.reduce((e,t,n)=>(e[t]=1+n,e),{});function L4(e){const t=wt(e).slice(),n={};return t.length||Se("Missing time unit."),t.forEach(i=>{_t($4,i)?n[i]=1:Se("Invalid time unit: ".concat(i,"."))}),(n[si]||n[ea]?1:0)+(n[oo]||n[Qi]||n[so]?1:0)+(n[nl]?1:0)>1&&Se("Incompatible time units: ".concat(e)),t.sort((i,a)=>$4[i]-$4[a]),t}const oGe={[$i]:"%Y ",[oo]:"Q%q ",[Qi]:"%b ",[so]:"%d ",[si]:"W%U ",[ea]:"%a ",[nl]:"%j ",[zo]:"%H:00",[jo]:"00:%M",[fs]:":%S",[nu]:".%L",["".concat($i,"-").concat(Qi)]:"%Y-%m ",["".concat($i,"-").concat(Qi,"-").concat(so)]:"%Y-%m-%d ",["".concat(zo,"-").concat(jo)]:"%H:%M"};function jre(e,t){const n=Rt({},oGe,t),r=L4(e),i=r.length;let a="",o=0,s,u;for(o=0;o<i;)for(s=r.length;s>o;--s)if(u=r.slice(o,s).join("-"),n[u]!=null){a+=n[u],o=s;break}return a.trim()}const pp=new Date;function B4(e){return pp.setFullYear(e),pp.setMonth(0),pp.setDate(1),pp.setHours(0,0,0,0),pp}function Ure(e){return Vre(new Date(e))}function Wre(e){return z4(new Date(e))}function Vre(e){return nd.count(B4(e.getFullYear())-1,e)}function z4(e){return p1.count(B4(e.getFullYear())-1,e)}function j4(e){return B4(e).getDay()}function sGe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,a,o);return s.setFullYear(e),s}return new Date(e,t,n,r,i,a,o)}function qre(e){return Gre(new Date(e))}function Hre(e){return U4(new Date(e))}function Gre(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return id.count(t-1,e)}function U4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return m1.count(t-1,e)}function W4(e){return pp.setTime(Date.UTC(e,0,1)),pp.getUTCDay()}function uGe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,a,o));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Kre(e,t,n,r,i){const a=t||1,o=sn(e),s=(v,y,b)=>(b=b||v,lGe(n[b],r[b],v===o&&a,y)),u=new Date,l=tu(e),c=l[$i]?s($i):Ji(2012),f=l[Qi]?s(Qi):l[oo]?s(oo):Xf,d=l[si]&&l[ea]?s(ea,1,si+ea):l[si]?s(si,1):l[ea]?s(ea,1):l[so]?s(so,1):l[nl]?s(nl,1):lv,h=l[zo]?s(zo):Xf,p=l[jo]?s(jo):Xf,g=l[fs]?s(fs):Xf,m=l[nu]?s(nu):Xf;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function lGe(e,t,n,r){const i=n<=1?e:r?(a,o)=>r+n*Math.floor((e(a,o)-r)/n):(a,o)=>n*Math.floor(e(a,o)/n);return t?(a,o)=>t(i(a,o),o):i}function pv(e,t,n){return t+e*7-(n+6)%7}const cGe={[$i]:e=>e.getFullYear(),[oo]:e=>Math.floor(e.getMonth()/3),[Qi]:e=>e.getMonth(),[so]:e=>e.getDate(),[zo]:e=>e.getHours(),[jo]:e=>e.getMinutes(),[fs]:e=>e.getSeconds(),[nu]:e=>e.getMilliseconds(),[nl]:e=>Vre(e),[si]:e=>z4(e),[si+ea]:(e,t)=>pv(z4(e),e.getDay(),j4(t)),[ea]:(e,t)=>pv(1,e.getDay(),j4(t))},fGe={[oo]:e=>3*e,[si]:(e,t)=>pv(e,0,j4(t))};function Xre(e,t){return Kre(e,t||1,cGe,fGe,sGe)}const dGe={[$i]:e=>e.getUTCFullYear(),[oo]:e=>Math.floor(e.getUTCMonth()/3),[Qi]:e=>e.getUTCMonth(),[so]:e=>e.getUTCDate(),[zo]:e=>e.getUTCHours(),[jo]:e=>e.getUTCMinutes(),[fs]:e=>e.getUTCSeconds(),[nu]:e=>e.getUTCMilliseconds(),[nl]:e=>Gre(e),[si]:e=>U4(e),[ea]:(e,t)=>pv(1,e.getUTCDay(),W4(t)),[si+ea]:(e,t)=>pv(U4(e),e.getUTCDay(),W4(t))},hGe={[oo]:e=>3*e,[si]:(e,t)=>pv(e,0,W4(t))};function Yre(e,t){return Kre(e,t||1,dGe,hGe,uGe)}const pGe={[$i]:rd,[oo]:qC.every(3),[Qi]:qC,[si]:p1,[so]:nd,[ea]:nd,[nl]:nd,[zo]:N4,[jo]:I4,[fs]:td,[nu]:k4},gGe={[$i]:ad,[oo]:HC.every(3),[Qi]:HC,[si]:m1,[so]:id,[ea]:id,[nl]:id,[zo]:F4,[jo]:R4,[fs]:td,[nu]:k4};function gv(e){return pGe[e]}function mv(e){return gGe[e]}function Zre(e,t,n){return e?e.offset(t,n):void 0}function Jre(e,t,n){return Zre(gv(e),t,n)}function Qre(e,t,n){return Zre(mv(e),t,n)}function eie(e,t,n,r){return e?e.range(t,n,r):void 0}function tie(e,t,n,r){return eie(gv(e),t,n,r)}function nie(e,t,n,r){return eie(mv(e),t,n,r)}const y1=1e3,b1=y1*60,x1=b1*60,GC=x1*24,mGe=GC*7,rie=GC*30,V4=GC*365,iie=[$i,Qi,so,zo,jo,fs,nu],w1=iie.slice(0,-1),_1=w1.slice(0,-1),S1=_1.slice(0,-1),vGe=S1.slice(0,-1),yGe=[$i,si],aie=[$i,Qi],oie=[$i],E1=[[w1,1,y1],[w1,5,5*y1],[w1,15,15*y1],[w1,30,30*y1],[_1,1,b1],[_1,5,5*b1],[_1,15,15*b1],[_1,30,30*b1],[S1,1,x1],[S1,3,3*x1],[S1,6,6*x1],[S1,12,12*x1],[vGe,1,GC],[yGe,1,mGe],[aie,1,rie],[aie,3,3*rie],[oie,1,V4]];function sie(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(u1(t))/n;let i=c1(s=>s[2]).right(E1,r),a,o;return i===E1.length?(a=oie,o=ed(t[0]/V4,t[1]/V4,n)):i?(i=E1[r/E1[i-1][2]<E1[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=iie,o=Math.max(ed(t[0],t[1],n),1)),{units:a,step:o}}function q4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function H4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function C1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function uie(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=A1(i),c=k1(i),f=A1(a),d=k1(a),h=A1(o),p=k1(o),g=A1(s),m=k1(s),v=A1(u),y=k1(u),b={a:L,A:W,b:G,B:K,c:null,d:pie,e:pie,f:jGe,g:ZGe,G:QGe,H:LGe,I:BGe,j:zGe,L:gie,m:UGe,M:WGe,p:ee,q:ce,Q:wie,s:_ie,S:VGe,u:qGe,U:HGe,V:GGe,w:KGe,W:XGe,x:null,X:null,y:YGe,Y:JGe,Z:eKe,"%":xie},x={a:he,A:Oe,b:Te,B:De,c:null,d:vie,e:vie,f:iKe,g:pKe,G:mKe,H:tKe,I:nKe,j:rKe,L:yie,m:aKe,M:oKe,p:me,q:P,Q:wie,s:_ie,S:sKe,u:uKe,U:lKe,V:cKe,w:fKe,W:dKe,x:null,X:null,y:hKe,Y:gKe,Z:vKe,"%":xie},w={a:A,A:k,b:T,B:I,c:N,d:die,e:die,f:FGe,g:fie,G:cie,H:hie,I:hie,j:IGe,L:RGe,m:OGe,M:NGe,p:E,q:TGe,Q:PGe,s:$Ge,S:DGe,u:SGe,U:EGe,V:CGe,w:_Ge,W:AGe,x:O,X:D,y:fie,Y:cie,Z:kGe,"%":MGe};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(F,V){return function(ae){var Y=[],M=-1,B=0,R=F.length,X,ge,xe;for(ae instanceof Date||(ae=new Date(+ae));++M<R;)F.charCodeAt(M)===37&&(Y.push(F.slice(B,M)),(ge=lie[X=F.charAt(++M)])!=null?X=F.charAt(++M):ge=X==="e"?" ":"0",(xe=V[X])&&(X=xe(ae,ge)),Y.push(X),B=M+1);return Y.push(F.slice(B,M)),Y.join("")}}function C(F,V){return function(ae){var Y=C1(1900,void 0,1),M=_(Y,F,ae+="",0),B,R;if(M!=ae.length)return null;if("Q"in Y)return new Date(Y.Q);if("s"in Y)return new Date(Y.s*1e3+("L"in Y?Y.L:0));if(V&&!("Z"in Y)&&(Y.Z=0),"p"in Y&&(Y.H=Y.H%12+Y.p*12),Y.m===void 0&&(Y.m="q"in Y?Y.q:0),"V"in Y){if(Y.V<1||Y.V>53)return null;"w"in Y||(Y.w=1),"Z"in Y?(B=H4(C1(Y.y,0,1)),R=B.getUTCDay(),B=R>4||R===0?M4.ceil(B):M4(B),B=id.offset(B,(Y.V-1)*7),Y.y=B.getUTCFullYear(),Y.m=B.getUTCMonth(),Y.d=B.getUTCDate()+(Y.w+6)%7):(B=q4(C1(Y.y,0,1)),R=B.getDay(),B=R>4||R===0?D4.ceil(B):D4(B),B=nd.offset(B,(Y.V-1)*7),Y.y=B.getFullYear(),Y.m=B.getMonth(),Y.d=B.getDate()+(Y.w+6)%7)}else("W"in Y||"U"in Y)&&("w"in Y||(Y.w="u"in Y?Y.u%7:"W"in Y?1:0),R="Z"in Y?H4(C1(Y.y,0,1)).getUTCDay():q4(C1(Y.y,0,1)).getDay(),Y.m=0,Y.d="W"in Y?(Y.w+6)%7+Y.W*7-(R+5)%7:Y.w+Y.U*7-(R+6)%7);return"Z"in Y?(Y.H+=Y.Z/100|0,Y.M+=Y.Z%100,H4(Y)):q4(Y)}}function _(F,V,ae,Y){for(var M=0,B=V.length,R=ae.length,X,ge;M<B;){if(Y>=R)return-1;if(X=V.charCodeAt(M++),X===37){if(X=V.charAt(M++),ge=w[X in lie?V.charAt(M++):X],!ge||(Y=ge(F,ae,Y))<0)return-1}else if(X!=ae.charCodeAt(Y++))return-1}return Y}function E(F,V,ae){var Y=l.exec(V.slice(ae));return Y?(F.p=c.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function A(F,V,ae){var Y=h.exec(V.slice(ae));return Y?(F.w=p.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function k(F,V,ae){var Y=f.exec(V.slice(ae));return Y?(F.w=d.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function T(F,V,ae){var Y=v.exec(V.slice(ae));return Y?(F.m=y.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function I(F,V,ae){var Y=g.exec(V.slice(ae));return Y?(F.m=m.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function N(F,V,ae){return _(F,t,V,ae)}function O(F,V,ae){return _(F,n,V,ae)}function D(F,V,ae){return _(F,r,V,ae)}function L(F){return o[F.getDay()]}function W(F){return a[F.getDay()]}function G(F){return u[F.getMonth()]}function K(F){return s[F.getMonth()]}function ee(F){return i[+(F.getHours()>=12)]}function ce(F){return 1+~~(F.getMonth()/3)}function he(F){return o[F.getUTCDay()]}function Oe(F){return a[F.getUTCDay()]}function Te(F){return u[F.getUTCMonth()]}function De(F){return s[F.getUTCMonth()]}function me(F){return i[+(F.getUTCHours()>=12)]}function P(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var V=S(F+="",b);return V.toString=function(){return F},V},parse:function(F){var V=C(F+="",!1);return V.toString=function(){return F},V},utcFormat:function(F){var V=S(F+="",x);return V.toString=function(){return F},V},utcParse:function(F){var V=C(F+="",!0);return V.toString=function(){return F},V}}}var lie={"-":"",_:" ","0":"0"},wi=/^\s*\d+/,bGe=/^%/,xGe=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function wGe(e){return e.replace(xGe,"\\$&")}function A1(e){return new RegExp("^(?:"+e.map(wGe).join("|")+")","i")}function k1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function _Ge(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function SGe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function EGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function CGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function AGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function cie(e,t,n){var r=wi.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function fie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function kGe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function TGe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function OGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function die(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function IGe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function hie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function NGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function DGe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function RGe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function FGe(e,t,n){var r=wi.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function MGe(e,t,n){var r=bGe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function PGe(e,t,n){var r=wi.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function $Ge(e,t,n){var r=wi.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function pie(e,t){return _n(e.getDate(),t,2)}function LGe(e,t){return _n(e.getHours(),t,2)}function BGe(e,t){return _n(e.getHours()%12||12,t,2)}function zGe(e,t){return _n(1+nd.count(rd(e),e),t,3)}function gie(e,t){return _n(e.getMilliseconds(),t,3)}function jGe(e,t){return gie(e,t)+"000"}function UGe(e,t){return _n(e.getMonth()+1,t,2)}function WGe(e,t){return _n(e.getMinutes(),t,2)}function VGe(e,t){return _n(e.getSeconds(),t,2)}function qGe(e){var t=e.getDay();return t===0?7:t}function HGe(e,t){return _n(p1.count(rd(e)-1,e),t,2)}function mie(e){var t=e.getDay();return t>=4||t===0?g1(e):g1.ceil(e)}function GGe(e,t){return e=mie(e),_n(g1.count(rd(e),e)+(rd(e).getDay()===4),t,2)}function KGe(e){return e.getDay()}function XGe(e,t){return _n(D4.count(rd(e)-1,e),t,2)}function YGe(e,t){return _n(e.getFullYear()%100,t,2)}function ZGe(e,t){return e=mie(e),_n(e.getFullYear()%100,t,2)}function JGe(e,t){return _n(e.getFullYear()%1e4,t,4)}function QGe(e,t){var n=e.getDay();return e=n>=4||n===0?g1(e):g1.ceil(e),_n(e.getFullYear()%1e4,t,4)}function eKe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function vie(e,t){return _n(e.getUTCDate(),t,2)}function tKe(e,t){return _n(e.getUTCHours(),t,2)}function nKe(e,t){return _n(e.getUTCHours()%12||12,t,2)}function rKe(e,t){return _n(1+id.count(ad(e),e),t,3)}function yie(e,t){return _n(e.getUTCMilliseconds(),t,3)}function iKe(e,t){return yie(e,t)+"000"}function aKe(e,t){return _n(e.getUTCMonth()+1,t,2)}function oKe(e,t){return _n(e.getUTCMinutes(),t,2)}function sKe(e,t){return _n(e.getUTCSeconds(),t,2)}function uKe(e){var t=e.getUTCDay();return t===0?7:t}function lKe(e,t){return _n(m1.count(ad(e)-1,e),t,2)}function bie(e){var t=e.getUTCDay();return t>=4||t===0?v1(e):v1.ceil(e)}function cKe(e,t){return e=bie(e),_n(v1.count(ad(e),e)+(ad(e).getUTCDay()===4),t,2)}function fKe(e){return e.getUTCDay()}function dKe(e,t){return _n(M4.count(ad(e)-1,e),t,2)}function hKe(e,t){return _n(e.getUTCFullYear()%100,t,2)}function pKe(e,t){return e=bie(e),_n(e.getUTCFullYear()%100,t,2)}function gKe(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function mKe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?v1(e):v1.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function vKe(){return"+0000"}function xie(){return"%"}function wie(e){return+e}function _ie(e){return Math.floor(+e/1e3)}var vv,G4,Sie,K4,Eie;yKe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function yKe(e){return vv=uie(e),G4=vv.format,Sie=vv.parse,K4=vv.utcFormat,Eie=vv.utcParse,vv}function T1(e){const t={};return n=>t[n]||(t[n]=e(n))}function bKe(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let a=xKe(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function xKe(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function Cie(e){const t=T1(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=h1(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return bKe(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,a,o){o=h1(o??",f");const s=ed(r,i,a),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=qHe(s,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=HHe(s,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=VHe(s))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let X4;Aie();function Aie(){return X4=Cie({format:Mre,formatPrefix:Pre})}function kie(e){return Cie(Fre(e))}function KC(e){return arguments.length?X4=kie(e):X4}function Tie(e,t,n){n=n||{},Nt(n)||Se("Invalid time multi-format specifier: ".concat(n));const r=t(fs),i=t(jo),a=t(zo),o=t(so),s=t(si),u=t(Qi),l=t(oo),c=t($i),f=e(n[nu]||".%L"),d=e(n[fs]||":%S"),h=e(n[jo]||"%I:%M"),p=e(n[zo]||"%I %p"),g=e(n[so]||n[ea]||"%a %d"),m=e(n[si]||"%b %d"),v=e(n[Qi]||"%B"),y=e(n[oo]||"%B"),b=e(n[$i]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:a(x)<x?h:o(x)<x?p:u(x)<x?s(x)<x?g:m:c(x)<x?l(x)<x?v:y:b)(x)}function Oie(e){const t=T1(e.format),n=T1(e.utcFormat);return{timeFormat:r=>Bn(r)?t(r):Tie(t,gv,r),utcFormat:r=>Bn(r)?n(r):Tie(n,mv,r),timeParse:T1(e.parse),utcParse:T1(e.utcParse)}}let Y4;Iie();function Iie(){return Y4=Oie({format:G4,parse:Sie,utcFormat:K4,utcParse:Eie})}function Nie(e){return Oie(uie(e))}function O1(e){return arguments.length?Y4=Nie(e):Y4}const Z4=(e,t)=>Rt({},e,t);function Die(e,t){const n=e?kie(e):KC(),r=t?Nie(t):O1();return Z4(n,r)}function J4(e,t){const n=arguments.length;return n&&n!==2&&Se("defaultLocale expects either zero or two arguments."),n?Z4(KC(e),O1(t)):Z4(KC(),O1())}function wKe(){return Aie(),Iie(),J4()}function Rie(e,t,n,r){t=t||{};const i=m4(t.type||"json");return i||Se("Unknown data format type: "+t.type),e=i(e,t),t.parse&&_Ke(e,t.parse,n,r),_t(e,"columns")&&delete e.columns,e}function _Ke(e,t,n,r){if(!e.length)return;const i=O1();n=n||i.timeParse,r=r||i.utcParse;let a=e.columns||Object.keys(e[0]),o,s,u,l,c,f;t==="auto"&&(t=fre(e,a)),a=Object.keys(t);const d=a.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!c4[p])throw Error("Illegal format pattern: "+h+":"+p);return c4[p]});for(u=0,c=e.length,f=a.length;u<c;++u)for(o=e[u],l=0;l<f;++l)s=a[l],o[s]=d[l](o[s])}const XC=nHe(typeof fetch!="undefined"&&fetch,null);function YC(e){const t=e||Oa,n=[],r={};return n.add=i=>{const a=t(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=t(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function ZC(e,t){try{await t(e)}catch(n){e.error(n)}}const Fie=Symbol("vega_id");let SKe=1;function JC(e){return!!(e&&lt(e))}function lt(e){return e[Fie]}function Mie(e,t){return e[Fie]=t,e}function In(e){const t=e===Object(e)?e:{data:e};return lt(t)?t:Mie(t,SKe++)}function Q4(e){return QC(e,In({}))}function QC(e,t){for(const n in e)t[n]=e[n];return t}function Pie(e,t){return Mie(t,lt(e))}function gp(e,t){return e?t?(n,r)=>e(n,r)||lt(t(n))-lt(t(r)):(n,r)=>e(n,r)||lt(n)-lt(r):null}function $ie(e){return e&&e.constructor===mp}function mp(){const e=[],t=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:mp,insert(s){const u=wt(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=Lt(s)?r:t,l=wt(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Ji(l)};return Lt(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return Lt(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return a=s,this},reflow(){return o=!0,this},pulse(s,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[lt(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[lt(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[lt(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=lt(g),l[m]?l[m]=1:s.add.push(In(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[lt(g)]<0&&s.rem.push(g);function v(y,b,x){x?y[b]=x(y):s.encode=b,o||(c[lt(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[lt(g)],m>0&&(v(g,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[lt(y)]>0&&v(y,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=t.length||r.length?u.filter(y=>l[lt(y)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(a||a==null&&(t.length||r.length))&&s.clean(!0),s}}}const eA="_:mod:_";function tA(){Object.defineProperty(this,eA,{writable:!0,value:{}})}tA.prototype={set(e,t,n,r){const i=this,a=i[e],o=i[eA];return t!=null&&t>=0?(a[t]!==n||r)&&(a[t]=n,o[t+":"+e]=-1,o[e]=-1):(a!==n||r)&&(i[e]=n,o[e]=ut(n)?1+n.length:-1),i},modified(e,t){const n=this[eA];if(arguments.length){if(ut(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[eA]={},this}};let EKe=0;const CKe="pulse",AKe=new tA,kKe=1,TKe=2;function Xn(e,t,n,r){this.id=++EKe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Lie(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Xn.prototype={targets(){return this._targets||(this._targets=YC(o1))},set(e){return this.value!==e?(this.value=e,1):0},skip:Lie(kKe),modified:Lie(TKe),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new tA,i=this._argops=this._argops||[],a=[];let o,s,u,l;const c=(f,d,h)=>{h instanceof Xn?(h!==this&&(t&&h.targets().add(this),a.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(s=e[o],o===CKe)wt(s).forEach(f=>{f instanceof Xn?f!==this&&(f.targets().add(this),a.push(f)):Se("Pulse parameters must be operator instances.")}),this.source=s;else if(ut(s))for(r.set(o,-1,Array(u=s.length)),l=0;l<u;++l)c(o,l,s[l]);else c(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(e){const t=this._argval||AKe,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===e,t.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function OKe(e,t,n,r){let i=1,a;return e instanceof Xn?a=e:e&&e.prototype instanceof Xn?a=new e:Lt(e)?a=new Xn(null,e):(i=0,a=new Xn(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function IKe(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let NKe=0;function nA(e,t,n){this.id=++NKe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function od(e,t,n){return new nA(e,t,n)}nA.prototype={_filter:ls,_apply:Oa,targets(){return this._targets||(this._targets=YC(o1))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=od(e);return this.targets().add(t),t},apply(e){const t=od(null,e);return this.targets().add(t),t},merge(){const e=od();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=od();return this.targets().add(od(null,null,i4(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(od(null,null,()=>n=!0)),t.targets().add(od(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ls,this._targets=null}};function DKe(e,t,n,r){const i=this,a=od(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=wt(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,o);return a}function RKe(e,t){const n=this.locale();return Rie(e,t,n.timeParse,n.utcParse)}function FKe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function MKe(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:bre(t&&t.type)});try{i=n.parse(i,t)}catch(a){r=-2,n.warn("Data ingestion failed",e,a)}}catch(a){r=-1,n.warn("Loading failed",e,a)}return{data:i,status:r}}async function PKe(e,t,n){const r=this,i=r._pending||$Ke(r);i.requests+=1;const a=await r.request(t,n);return r.pulse(e,r.changeset().remove(ls).insert(a.data||[])),i.done(),a}function $Ke(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const LKe={skip:!0};function BKe(e,t,n,r,i){return(e instanceof Xn?jKe:zKe)(this,e,t,n,r,i),this}function zKe(e,t,n,r,i,a){const o=Rt({},a,LKe);let s,u;Lt(n)||(n=Ji(n)),r===void 0?s=l=>e.touch(n(l)):Lt(r)?(u=new Xn(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;$ie(f)?e.pulse(c,f,a):e.update(c,f,o)}):s=l=>e.update(n(l),r,o),t.apply(s)}function jKe(e,t,n,r,i,a){if(r===void 0)t.targets().add(n);else{const o=a||{},s=new Xn(null,UKe(n,r),i,!1);s.modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function UKe(e,t){return t=Lt(t)?t:Ji(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function WKe(e){e.rank=++this._rank}function VKe(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Se("Cycle detected in dataflow graph.")}const rA={},rl=1<<0,sd=1<<1,_c=1<<2,qKe=rl|sd,Bie=rl|_c,yv=rl|sd|_c,zie=1<<3,I1=1<<4,jie=1<<5,Uie=1<<6;function ud(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function eL(e,t){const n=[];return Qf(e,t,r=>n.push(r)),n}function Wie(e,t){const n={};return e.visit(t,r=>{n[lt(r)]=1}),r=>n[lt(r)]?null:r}function iA(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}ud.prototype={StopPropagation:rA,ADD:rl,REM:sd,MOD:_c,ADD_REM:qKe,ADD_MOD:Bie,ALL:yv,REFLOW:zie,SOURCE:I1,NO_SOURCE:jie,NO_FIELDS:Uie,fork(e){return new ud(this.dataflow).init(this,e)},clone(){const e=this.fork(yv);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(yv|I1)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ud(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&Uie)&&(n.fields=e.fields),t&rl?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&sd?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&_c?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&jie?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||yv;return t&rl&&this.add.length||t&sd&&this.rem.length||t&_c&&this.mod.length},reflow(e){if(e)return this.fork(yv).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(_c,Wie(this,rl))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ut(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ut(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&rl&&(n.addF=iA(n.addF,t)),e&sd&&(n.remF=iA(n.remF,t)),e&_c&&(n.modF=iA(n.modF,t)),e&I1&&(n.srcF=iA(n.srcF,t)),n},materialize(e){e=e||yv;const t=this;return e&rl&&t.addF&&(t.add=eL(t.add,t.addF),t.addF=null),e&sd&&t.remF&&(t.rem=eL(t.rem,t.remF),t.remF=null),e&_c&&t.modF&&(t.mod=eL(t.mod,t.modF),t.modF=null),e&I1&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&I1)return Qf(n.source,n.srcF,r),n;e&rl&&Qf(n.add,n.addF,r),e&sd&&Qf(n.rem,n.remF,r),e&_c&&Qf(n.mod,n.modF,r);const i=n.source;if(e&zie&&i){const a=n.add.length+n.mod.length;a===i.length||(a?Qf(i,Wie(n,Bie),r):Qf(i,n.srcF,r))}return n}};function tL(e,t,n,r){const i=this,a=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<a;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(o|=i.ADD),u.changed(i.REM)&&(o|=i.REM),u.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}$e(tL,ud,{fork(e){const t=new ud(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ut(e)?e.some(r=>n[r]):n[e]:0},filter(){Se("MultiPulse does not support filtering.")},materialize(){Se("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n}});async function HKe(e,t,n){const r=this,i=[];if(r._pulse)return Vie(r);if(r._pending&&await r._pending,t&&await ZC(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new ud(r,a,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=YC(o1);let o=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=rA),u!==rA&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await ZC(r,c[f].callback)}return n&&await ZC(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function GKe(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function KKe(e,t,n){return this._pulse?Vie(this):(this.evaluate(e,t,n),this)}function XKe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function Vie(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function YKe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function ZKe(e,t){const n=e.source,r=this._clock;return n&&ut(n)?new tL(this,r,n.map(i=>i.pulse),t):this._input[e.id]||JKe(this._pulse,n&&n.pulse)}function JKe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==rA&&(e.source=t.source),e)}const nL={skip:!1,force:!1};function QKe(e,t){const n=t||nL;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function eXe(e,t,n){const r=n||nL;return(e.set(t)||r.force)&&this.touch(e,r),this}function tXe(e,t,n){this.touch(e,n||nL);const r=new ud(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function nXe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),qie(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,rXe(t,0,e)):r=n,r}}}function qie(e,t,n,r){let i,a;const o=e[n];for(;n>t;){if(a=n-1>>1,i=e[a],r(o,i)<0){e[n]=i,n=a;continue}break}return e[n]=o}function rXe(e,t,n){const r=t,i=e.length,a=e[t];let o=(t<<1)+1,s;for(;o<i;)s=o+1,s<i&&n(e[o],e[s])>=0&&(o=s),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=a,qie(e,r,t,n)}function bv(){this.logger(zne()),this.logLevel(Q$),this._clock=0,this._rank=0,this._locale=J4();try{this._loader=XC()}catch(e){}this._touched=YC(o1),this._input={},this._pulse=null,this._heap=nXe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function N1(e){return function(){return this._log[e].apply(this,arguments)}}bv.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:N1("error"),warn:N1("warn"),info:N1("info"),debug:N1("debug"),logLevel:N1("level"),cleanThreshold:1e4,add:OKe,connect:IKe,rank:WKe,rerank:VKe,pulse:tXe,touch:QKe,update:eXe,changeset:mp,ingest:FKe,parse:RKe,preload:PKe,request:MKe,events:DKe,on:BKe,evaluate:HKe,run:KKe,runAsync:GKe,runAfter:XKe,_enqueue:YKe,_getPulse:ZKe};function ve(e,t){Xn.call(this,e,null,t)}$e(ve,Xn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const xv={};function Hie(e){const t=Gie(e);return t&&t.Definition||null}function Gie(e){return e=e&&e.toLowerCase(),_t(xv,e)?xv[e]:null}function*Kie(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function rL(e,t,n){const r=Float64Array.from(Kie(e,n));return r.sort(dv),t.map(i=>Ere(r,i))}function iL(e,t){return rL(e,[.25,.5,.75],t)}function aL(e,t){const n=e.length,r=RHe(e,t),i=iL(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function Xie(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,u,l,c,f,d;const h=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(a/s+g)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}var ds=Math.random;function iXe(e){ds=e}function Yie(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Kie(e,r)),a=i.length,o=t;let s,u,l,c;for(l=0,c=Array(o);l<o;++l){for(s=0,u=0;u<a;++u)s+=i[~~(ds()*a)];c[l]=s/a}return c.sort(dv),[_4(c,n/2),_4(c,1-n/2)]}function Zie(e,t,n,r){r=r||(d=>d);const i=e.length,a=new Float64Array(i);let o=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;o<s;++o)a[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<s;++o)a[o]=l;return n?aXe(a,t+t/4):a}function aXe(e,t){const n=e.length;let r=0,i=1,a,o;for(;e[r]===e[i];)++i;for(;i<n;){for(a=i+1;e[i]===e[a];)++a;if(e[i]-e[i-1]<t){for(o=i+(r+a-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=a}return e}function oXe(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function sXe(e,t){t==null&&(t=e,e=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*ds())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const s=Math.floor(o);return s<n?0:s>=r?1:(s-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(e).max(t)}const Jie=Math.sqrt(2*Math.PI),uXe=Math.SQRT2;let D1=NaN;function aA(e,t){e=e||0,t=t??1;let n=0,r=0,i,a;if(D1===D1)n=D1,D1=NaN;else{do n=ds()*2-1,r=ds()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,D1=r*a}return e+n*t}function oL(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Jie)}function oA(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,a=o*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,a=a/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,a=o/s/2.506628274631)}return r>0?1-a:a}function sA(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*uXe*lXe(2*e-1)}function lXe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function sL(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>aA(n,r),pdf:a=>oL(a,n,r),cdf:a=>oA(a,n,r),icdf:a=>sA(a,n,r)};return i.mean(e).stdev(t)}function uL(e,t){const n=sL();let r=0;const i={data(a){return arguments.length?(e=a,r=a?a.length:0,i.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=aL(e)),i):t},sample(){return e[~~(ds()*r)]+t*n.sample()},pdf(a){let o=0,s=0;for(;s<r;++s)o+=n.pdf((a-e[s])/t);return o/t/r},cdf(a){let o=0,s=0;for(;s<r;++s)o+=n.cdf((a-e[s])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function lL(e,t){return e=e||0,t=t??1,Math.exp(e+aA()*t)}function cL(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Jie*e)}function fL(e,t,n){return oA(Math.log(e),t,n)}function dL(e,t,n){return Math.exp(sA(e,t,n))}function Qie(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>lL(n,r),pdf:a=>cL(a,n,r),cdf:a=>fL(a,n,r),icdf:a=>dL(a,n,r)};return i.mean(e).stdev(t)}function eae(e,t){let n=0,r;function i(o){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)s[l]/=u;return s}const a={weights(o){return arguments.length?(r=i(t=o||[]),a):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),a.weights(t)):e},sample(){const o=ds();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){s=e[l];break}return s.sample()},pdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(o);return s},cdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(o);return s},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function hL(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ds()}function pL(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function gL(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function mL(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function tae(e,t){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a??1,i):r},sample:()=>hL(n,r),pdf:a=>pL(a,n,r),cdf:a=>gL(a,n,r),icdf:a=>mL(a,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function R1(e,t,n,r){const i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function uA(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,a=new Float64Array(i),o=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)a[s]=c=+t(d),o[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)a[s]-=u,o[s]-=l;return[a,o,u,l]}function F1(e,t,n,r){let i=-1,a,o;for(const s of e)a=t(s),o=n(s),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function wv(e,t,n,r,i){let a=0,o=0;return F1(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;a+=l*l,o+=c*c}),1-a/o}function vL(e,t,n){let r=0,i=0,a=0,o=0,s=0;F1(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=R1(r,i,a,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:wv(e,t,n,i,l)}}function nae(e,t,n){let r=0,i=0,a=0,o=0,s=0;F1(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=R1(r,i,a,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:wv(e,t,n,i,l)}}function rae(e,t,n){const[r,i,a,o]=uA(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,p;F1(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,s+=(b*h-s)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=R1(u/o,s/o,l/o,c/o),v=y=>Math.exp(g+m*(y-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:wv(e,t,n,o,v)}}function iae(e,t,n){let r=0,i=0,a=0,o=0,s=0,u=0;F1(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,a+=(h*p-a)/u,o+=(h*h-o)/u,s+=(d-s)/u});const l=R1(r,i,a,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:wv(e,t,n,s,c)}}function yL(e,t,n){const[r,i,a,o]=uA(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<s;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,x=(f*v-d*l)/y,w=-b*u,S=C=>(C=C-a,b*C*C+x*C+w+o);return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:S,rSquared:wv(e,t,n,o,S)}}function aae(e,t,n,r){if(r===1)return vL(e,t,n);if(r===2)return yL(e,t,n);const[i,a,o,s]=uA(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*a[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=fXe(c),y=b=>{b-=o;let x=s+v[0]+v[1]*b+v[2]*b*b;for(d=3;d<f;++d)x+=v[d]*Math.pow(b,d);return x};return{coef:cXe(f,v,-o,s),predict:y,rSquared:wv(e,t,n,s,y)}}function cXe(e,t,n,r){const i=Array(e);let a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function fXe(e){const t=e.length-1,n=[];let r,i,a,o,s;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(a=r;a<t+1;++a)s=e[a][r],e[a][r]=e[a][o],e[a][o]=s;for(i=r+1;i<t;++i)for(a=t;a>=r;a--)e[a][i]-=e[a][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*n[a];n[i]=(e[t][i]-s)/e[i][i]}return n}const oae=2,sae=1e-12;function uae(e,t,n,r){const[i,a,o,s]=uA(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=oae;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,S=0,C=0,_=0,E=0;const A=1/Math.abs(i[x]-v||1);for(let I=y;I<=b;++I){const N=i[I],O=a[I],D=dXe(Math.abs(v-N)*A)*d[I],L=N*D;w+=D,S+=L,C+=O*D,_+=O*L,E+=N*L}const[k,T]=R1(S/w,C/w,_/w,E/w);c[m]=k+T*v,f[m]=Math.abs(a[m]-c[m]),hXe(i,m+1,p)}if(h===oae)break;const g=Cre(f);if(Math.abs(g)<sae)break;for(let m=0,v,y;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?sae:(y=1-v*v)*y}return pXe(i,c,o,s)}function dXe(e){return(e=1-e*e*e)*e*e}function hXe(e,t,n){const r=e[t];let i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}function pXe(e,t,n,r){const i=e.length,a=[];let o=0,s=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[o]],a.push(u));return u[1]+=r,a}const gXe=.1*Math.PI/180;function lA(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=h=>[h,e(h)],a=t[0],o=t[1],s=o-a,u=s/r,l=[i(a)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(a+h/n*s));return l.push(i(o)),l}else{c.push(i(o));for(let h=n;--h>0;)c.push(i(a+h/n*s))}let f=l[0],d=c[c.length-1];for(;d;){const h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&mXe(f,h,d)>gXe?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function mXe(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function vXe(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function bL(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:vXe(e)}function lae(e,t,n){return n||e+(t?"_"+t:"")}const xL=()=>{},yXe={init:xL,add:xL,rem:xL,idx:0},M1={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},P1=Object.keys(M1);function bXe(e,t){return n=>Rt({name:e,out:n||e},yXe,t)}P1.forEach(e=>{M1[e]=bXe(e,M1[e])});function cae(e,t){return M1[e](t)}function fae(e,t){return e.idx-t.idx}function xXe(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=M1[i]())})};return e.forEach(n),Object.values(t).sort(fae)}function wXe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function _Xe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function SXe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function EXe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function dae(e,t){const n=t||Oa,r=xXe(e),i=e.slice().sort(fae);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=wXe,a.prototype.add=_Xe,a.prototype.rem=SXe,a.prototype.set=EXe,a.prototype.get=n,a.fields=e.map(o=>o.out),a}function wL(e){this._key=e?io(e):lt,this.reset()}const Li=wL.prototype;Li.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Li.add=function(e){this._add.push(e)},Li.rem=function(e){this._rem.push(e)},Li.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};let s,u,l;for(s=0;s<i;++s)o[n(t[s])]=1;for(s=0,u=0;s<r;++s)o[n(l=e[s])]?o[n(l)]=0:a[u++]=l;return this._rem=[],this._add=a},Li.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,a;for(;--r>=0;)a=e(t[r])+"",_t(n,a)||(n[a]=1,++i);return i},Li.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Qne(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Li.argmin=function(e){return this.extent(e)[0]||{}},Li.argmax=function(e){return this.extent(e)[1]||{}},Li.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Li.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Li.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=iL(this.values(),e),this._get=e),this._q},Li.q1=function(e){return this.quartile(e)[0]},Li.q2=function(e){return this.quartile(e)[1]},Li.q3=function(e){return this.quartile(e)[2]},Li.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=Yie(this.values(),1e3,.05,e),this._get=e),this._ci},Li.ci0=function(e){return this.ci(e)[0]},Li.ci1=function(e){return this.ci(e)[1]};function ld(e){ve.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ld.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:P1},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},$e(ld,ve,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function a(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}a(e._prev),a(t);function o(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=wt(Yi(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=wt(e.groupby),this._dnames=this._dims.map(m=>{const v=Tr(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:bL(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],o=e.ops||["count"],s=e.as||[],u=a.length,l={};let c,f,d,h,p,g;for(u!==o.length&&Se("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=a[g],f=o[g],c==null&&f!=="count"&&Se("Null aggregate field specified."),h=Tr(c),p=lae(f,h,s[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(cae(f,p))}return this._measures=this._measures.map(m=>dae(m,m.field)),{}},cellkey:bL(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new wL),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](e);return t?Pie(t.tuple,a):In(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const CXe=1e-14;function _L(e){ve.call(this,null,e)}_L.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},$e(_L,ve,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Yi(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+a*(1+(f-i)/a)}:c=>c[s]=r(c)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Xie(e),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,s;(o=e.anchor)!=null&&(s=o-(i+r*Math.floor((o-i)/r)),i+=s,a+=s);const u=function(l){let c=Zi(t(l));return c==null?null:c<i?-1/0:c>a?1/0:(c=Math.max(i,Math.min(c,a-r)),i+r*Math.floor(CXe+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=ro(u,Yi(t),e.name||"bin_"+Tr(t))}});function hae(e,t,n){const r=e;let i=t||[],a=n||[],o={},s=0;return{add:u=>a.push(u),remove:u=>o[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!o[r(c)]),o={},s=0),l&&u&&i.sort(u),a.length&&(i=u?are(u,i,a.sort(u)):i.concat(a),a=[]),i)}}function SL(e){ve.call(this,[],e)}SL.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},$e(SL,ve,{transform(e,t){const n=t.fork(t.ALL),r=hae(lt,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(gp(i),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function pae(e){Xn.call(this,null,AXe,e)}$e(pae,Xn);function AXe(e){return this.value&&!e.modified()?this.value:r4(e.fields,e.orders)}function EL(e){ve.call(this,null,e)}EL.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function kXe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}$e(EL,ve,{transform(e,t){const n=f=>d=>{for(var h=kXe(s(d),e.case,a)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=In({}),u[i]=s,u[a]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==l&&(u[a]=l,o.mod.push(u));return o.modifies(t)}});function CL(e){ve.call(this,null,e)}CL.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},$e(CL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=TXe(s,i,a,e.filter||ls)):n.mod=s,n.source=this.value,n.modifies(r)}});function TXe(e,t,n,r){for(var i=[],a={},o=e.length,s=0,u,l;s<o;++s)for(a[t]=l=e[s],u=0;u<o;++u)a[n]=e[u],r(a)&&(i.push(In(a)),a={},a[t]=l);return i}const gae={kde:uL,mixture:eae,normal:sL,lognormal:Qie,uniform:tae},OXe="distributions",mae="function",IXe="field";function vae(e,t){const n=e[mae];_t(gae,n)||Se("Unknown distribution function: "+n);const r=gae[n]();for(const i in e)i===IXe?r.data((e.from||t()).map(e[i])):i===OXe?r[i](e[i].map(a=>vae(a,t))):typeof r[i]===mae&&r[i](e[i]);return r}function AL(e){ve.call(this,null,e)}const yae=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],NXe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:yae},{name:"weights",type:"number",array:!0}]};AL.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:yae.concat(NXe)},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(AL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=vae(e.distribution,DXe(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Se("Invalid density method: "+o),!e.extent&&!r.data&&Se("Missing density extent parameter."),o=r[o];const s=e.as||["value","density"],u=e.extent||tl(r.data()),l=lA(o,u,i,a).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],In(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function DXe(e){return()=>e.materialize(e.SOURCE).source}function bae(e,t){return e?e.map((n,r)=>t[r]||Tr(n)):null}function kL(e,t,n){const r=[],i=f=>f(u);let a,o,s,u,l,c;if(t==null)r.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)u=e[o],l=t.map(i),c=a[l],c||(a[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const xae="bin";function TL(e){ve.call(this,null,e)}TL.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:xae}]};const RXe=(e,t)=>u1(tl(e,t))/30;$e(TL,ve,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=kL(t.source,e.groupby,Oa),i=e.smooth||!1,a=e.field,o=e.step||RXe(n,a),s=gp((p,g)=>a(p)-a(g)),u=e.as||xae,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(s);h=-1;for(const g of Zie(p,o,i,a))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function wae(e){Xn.call(this,null,FXe,e),this.modified(!0)}$e(wae,Xn);function FXe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ro(n=>t(n,e),Yi(t),Tr(t))}function OL(e){ve.call(this,[void 0,void 0],e)}OL.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},$e(OL,ve,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=Zi(r(s));u!=null&&(u<a&&(a=u),u>o&&(o=u))}),!Number.isFinite(a)||!Number.isFinite(o)){let s=Tr(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function IL(e,t){Xn.call(this,e),this.parent=t,this.count=0}$e(IL,Xn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function cA(e){ve.call(this,{},e),this._keys=cv();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}$e(cA,ve,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let a=_t(i,e)&&i[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new IL(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),i[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=lt(u),c=a.get(l);c!==void 0&&(a.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);a.set(lt(u),l),s(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=lt(u),c=a.get(l),f=r(u);c===f?s(f).mod(u):(a.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(a.get(lt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=lt(u),c=a.get(l),f=r(u);c!==f&&(a.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function _ae(e){Xn.call(this,null,MXe,e)}$e(_ae,Xn);function MXe(e){return this.value&&!e.modified()?this.value:ut(e.name)?wt(e.name).map(t=>io(t)):io(e.name,e.as)}function NL(e){ve.call(this,cv(),e)}NL.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},$e(NL,ve,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=lt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?a.push(f):r.set(lt(f),1)});function c(f){const d=lt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),a.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function DL(e){ve.call(this,[],e)}DL.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},$e(DL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=bae(r,e.as||[]),a=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(p=>p(s)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Q4(s),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;a&&(d[a]=c),n.add.push(d)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function RL(e){ve.call(this,[],e)}RL.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},$e(RL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Tr),a=e.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Q4(l),f[o]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(a)}});function FL(e){ve.call(this,null,e)}FL.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},$e(FL,ve,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,o=>o[r]=n(o,e))}});function Sae(e){ve.call(this,[],e)}$e(Sae,ve,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,a=e.size-i.length,o,s,u;if(a>0){for(o=[];--a>=0;)o.push(u=In(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-a);return n.source=this.value=i,n}});const fA={value:"value",median:Cre,mean:MHe,min:w4,max:cp},PXe=[];function ML(e){ve.call(this,[],e)}ML.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function $Xe(e){var t=e.method||fA.value,n;if(fA[t]==null)Se("Unrecognized imputation method: "+t);else return t===fA.value?(n=e.value!==void 0?e.value:0,()=>n):fA[t]}function LXe(e){const t=e.field;return n=>n?t(n):NaN}$e(ML,ve,{transform(e,t){var n=t.fork(t.ALL),r=$Xe(e),i=LXe(e),a=Tr(e.field),o=Tr(e.key),s=(e.groupby||[]).map(Tr),u=BXe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,v,y,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,y=0;y<f;++y)if(d[y]==null){for(g=u.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[s[v]]=p[v];w[o]=g,w[a]=Number.isNaN(h)?h=r(d,i):h,l.push(In(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function BXe(e,t,n,r){var i=v=>v(m),a=[],o=r?r.slice():[],s={},u={},l,c,f,d,h,p,g,m;for(o.forEach((v,y)=>s[v]=y+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=s[p]||(s[p]=o.push(p)),c=(l=t?t.map(i):PXe)+"",(f=u[c])||(f=u[c]=[],a.push(f),f.values=l),f[h-1]=m;return a.domain=o,a}function PL(e){ld.call(this,e)}PL.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:P1},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},$e(PL,ld,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Rt(a,i[n.cellkey(a)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function $L(e){ve.call(this,null,e)}$L.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e($L,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=kL(r,e.groupby,e.field),a=(e.groupby||[]).map(Tr),o=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&Se("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=tl(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=uL(h,o)[s],g=e.counts?h.length:1,m=c||tl(h);lA(p,m,f,d).forEach(v=>{const y={};for(let b=0;b<a.length;++b)y[a[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(In(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function Eae(e){Xn.call(this,null,zXe,e)}$e(Eae,Xn);function zXe(e){return this.value&&!e.modified()?this.value:o4(e.fields,e.flat)}function Cae(e){ve.call(this,[],e),this._pending=null}$e(Cae,ve,{transform(e,t){const n=t.dataflow;return this._pending?LL(this,t,this._pending):jXe(e)?t.StopPropagation:e.values?LL(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=wt(i.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(r=>LL(this,t,wt(r.data)))}});function jXe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function LL(e,t,n){n.forEach(In);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function BL(e){ve.call(this,{},e)}BL.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},$e(BL,ve,{transform(e,t){const n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),s=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&Se('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&Se('The "as" parameter has too few output field names.'),c=c||i.map(Tr),f=function(p){for(var g=0,m=0,v,y;g<s;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<d;++v,++m)p[c[m]]=a;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||Se("Missing output field names."),f=function(p){for(var g=0,m;g<s;++g)m=r.get(n[g](p)),p[c[g]]=m??a}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function Aae(e){Xn.call(this,null,UXe,e)}$e(Aae,Xn);function UXe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=t[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function kae(e){Xn.call(this,null,WXe,e)}$e(kae,Xn);function WXe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function Tae(e){ve.call(this,null,e)}$e(Tae,ve,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function zL(e){ld.call(this,e)}zL.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:P1,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},$e(zL,ld,{_transform:ld.prototype.transform,transform(e,t){return this._transform(VXe(e,t),t)}});function VXe(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Yi(n).concat(Yi(r)),o=HXe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(s=>qXe(s,n,r,a)),as:o.map(s=>s+""),modified:e.modified.bind(e)}}function qXe(e,t,n,r){return ro(i=>t(i)===e?n(i):NaN,r,e+"")}function HXe(e,t,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=e(a);r[o]||(r[o]=1,i.push(o))}),i.sort(LC),t?i.slice(0,t):i}function Oae(e){cA.call(this,e)}$e(Oae,cA,{transform(e,t){const n=e.subflow,r=e.field,i=a=>this.subflow(lt(a),n,t,a);return(e.modified("field")||r&&t.modified(Yi(r)))&&Se("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,a=>{const o=i(a);r(a).forEach(s=>o.mod(s))}),t.visit(t.ADD,a=>{const o=i(a);r(a).forEach(s=>o.add(In(s)))}),t.visit(t.REM,a=>{const o=i(a);r(a).forEach(s=>o.rem(s))})):(t.visit(t.MOD,a=>i(a).mod(a)),t.visit(t.ADD,a=>i(a).add(a)),t.visit(t.REM,a=>i(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function jL(e){ve.call(this,null,e)}jL.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},$e(jL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=bae(e.fields,e.as||[]),a=r?(s,u)=>GXe(s,u,r,i):QC;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,s=>{const u=lt(s);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,s=>{const u=a(s,In({}));o[lt(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(a(s,o[lt(s)]))}),n}});function GXe(e,t,n,r){for(let i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}function Iae(e){ve.call(this,null,e)}$e(Iae,ve,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function UL(e){ve.call(this,null,e)}UL.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const KXe=1e-14;$e(UL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,a=kL(i,e.groupby,e.field),o=(e.groupby||[]).map(Tr),s=[],u=e.step||.01,l=e.probs||Bo(u/2,1-KXe,u),c=l.length;return a.forEach(f=>{const d=rL(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],s.push(In(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function Nae(e){ve.call(this,null,e)}$e(Nae,ve,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const a=lt(i);n.rem.push(r[a]),r[a]=null}),t.visit(t.ADD,i=>{const a=Q4(i);r[lt(i)]=a,n.add.push(a)}),t.visit(t.MOD,i=>{const a=r[lt(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function WL(e){ve.call(this,[],e),this.count=0}WL.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},$e(WL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((c,f)=>(c[lt(f)]=1,c),{});let o=this.value,s=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((s+1)*ds()),d<o.length&&d>=u&&(f=o[d],a[lt(f)]&&n.rem.push(f),o[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=lt(c);a[f]&&(a[f]=-1,n.rem.push(c)),--s}),o=o.filter(c=>a[lt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=s=o.length,t.visit(t.SOURCE,c=>{a[lt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)a[lt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{a[lt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!a[lt(c)])),this.count=s,this.value=n.source=o,n}});function VL(e){ve.call(this,null,e)}VL.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},$e(VL,ve,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Bo(e.start,e.stop,e.step||1).map(i=>{const a={};return a[r]=i,In(a)}),n.add=t.add.concat(this.value),n}});function Dae(e){ve.call(this,null,e),this.modified(!0)}$e(Dae,ve,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function qL(e){ve.call(this,null,e)}const Rae=["unit0","unit1"];qL.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:P4,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Rae}]},$e(qL,ve,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",a=this._floor(e,t),o=(i?mv:gv)(a.unit).offset,s=e.as||Rae,u=s[0],l=s[1],c=a.step;let f=a.start||1/0,d=a.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Yi(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=a(g),r&&(p[l]=v=o(m,c)),m<f&&(f=m),v>d&&(d=v))}),a.start=f,a.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:sie({extent:e.extent||tl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=L4(r),o=this.value||{},s=(n?Yre:Xre)(a,i);return s.unit=sn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}});function Fae(e){ve.call(this,cv(),e)}$e(Fae,ve,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,a=s=>i.set(r(s),s);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function Mae(e){ve.call(this,null,e)}$e(Mae,ve,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(gp(e.sort)):t.source).map(e.field))}});function XXe(e,t,n,r){const i=$1[e](t,n);return{init:i.init||Xf,update:function(a,o){o[r]=i.next(a)}}}const $1={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=$1.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Se("ntile num must be greater than zero.");const n=$1.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Se("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=YXe(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function YXe(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const ZXe=Object.keys($1);function Pae(e){const t=wt(e.ops),n=wt(e.fields),r=wt(e.params),i=wt(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){wt(Yi(h)).forEach(p=>s[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Tr(g),v=lae(h,m,i[p]);if(d(g),a.push(v),_t($1,h))o.push(XXe(h,n[p],r[p],v));else{if(g==null&&h!=="count"&&Se("Null aggregate field specified."),h==="count"){l.push(v);return}f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(cae(h,v))}}),(l.length||c.length)&&(this.cell=JXe(c,l,f)),this.inputs=Object.keys(s)}const $ae=Pae.prototype;$ae.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},$ae.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,a=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function JXe(e,t,n){e=e.map(u=>dae(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var s=r.data=new wL;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)a[l].add(a[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)a[l].rem(a[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=a.length;l<c;++l)a[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)a[u].init()},r}function HL(e){ve.call(this,{},e),this._mlen=0,this._mods=[]}HL.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ZXe.concat(P1)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},$e(HL,ve,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=gp(e.sort),i=bL(e.groupby),a=s=>this.group(i(s));let o=this.state;(!o||n)&&(o=this.state=new Pae(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,s=>a(s).add(s))):(t.visit(t.REM,s=>a(s).remove(s)),t.visit(t.ADD,s=>a(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)QXe(this._mods[s],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=hae(lt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function QXe(e,t,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=e.data(n),u=s.length,l=a?c1(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ji(-1)};t.init();for(let f=0;f<u;++f)eYe(c,o,f,u),a&&tYe(c,l),t.update(c,s[f])}function eYe(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function tYe(e,t){const n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}var nYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:ld,bin:_L,collect:SL,compare:pae,countpattern:EL,cross:CL,density:AL,dotbin:TL,expression:wae,extent:OL,facet:cA,field:_ae,filter:NL,flatten:DL,fold:RL,formula:FL,generate:Sae,impute:ML,joinaggregate:PL,kde:$L,key:Eae,load:Cae,lookup:BL,multiextent:Aae,multivalues:kae,params:Tae,pivot:zL,prefacet:Oae,project:jL,proxy:Iae,quantile:UL,relay:Nae,sample:WL,sequence:VL,sieve:Dae,subflow:IL,timeunit:qL,tupleindex:Fae,values:Mae,window:HL});const GL=Math.PI,KL=2*GL,vp=1e-6,rYe=KL-vp;function XL(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function yp(){return new XL}XL.prototype=yp.prototype={constructor:XL,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>vp)if(!(Math.abs(c*s-u*l)>vp)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-a,h=r-o,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((GL-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>vp&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>vp||Math.abs(this._y1-l)>vp)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%KL+KL),f>rYe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>vp&&(this._+="A"+n+","+n+",0,"+ +(f>=GL)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Rn(e){return function(){return e}}var Lae=Math.abs,ta=Math.atan2,bp=Math.cos,iYe=Math.max,YL=Math.min,il=Math.sin,_v=Math.sqrt,na=1e-12,Sv=Math.PI,dA=Sv/2,Bae=2*Sv;function aYe(e){return e>1?0:e<-1?Sv:Math.acos(e)}function zae(e){return e>=1?dA:e<=-1?-dA:Math.asin(e)}function oYe(e){return e.innerRadius}function sYe(e){return e.outerRadius}function uYe(e){return e.startAngle}function lYe(e){return e.endAngle}function cYe(e){return e&&e.padAngle}function fYe(e,t,n,r,i,a,o,s){var u=n-e,l=r-t,c=o-i,f=s-a,d=f*u-c*l;if(!(d*d<na))return d=(c*(t-a)-f*(e-i))/d,[e+d*u,t+d*l]}function hA(e,t,n,r,i,a,o){var s=e-n,u=t-r,l=(o?a:-a)/_v(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,x=y*y+b*b,w=i-a,S=d*g-p*h,C=(b<0?-1:1)*_v(iYe(0,w*w*x-S*S)),_=(S*b-y*C)/x,E=(-S*y-b*C)/x,A=(S*b+y*C)/x,k=(-S*y+b*C)/x,T=_-m,I=E-v,N=A-m,O=k-v;return T*T+I*I>N*N+O*O&&(_=A,E=k),{cx:_,cy:E,x01:-c,y01:-f,x11:_*(i/w-1),y11:E*(i/w-1)}}function dYe(){var e=oYe,t=sYe,n=Rn(0),r=null,i=uYe,a=lYe,o=cYe,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-dA,p=a.apply(this,arguments)-dA,g=Lae(p-h),m=p>h;if(s||(s=l=yp()),d<f&&(c=d,d=f,f=c),!(d>na))s.moveTo(0,0);else if(g>Bae-na)s.moveTo(d*bp(h),d*il(h)),s.arc(0,0,d,h,p,!m),f>na&&(s.moveTo(f*bp(p),f*il(p)),s.arc(0,0,f,p,h,m));else{var v=h,y=p,b=h,x=p,w=g,S=g,C=o.apply(this,arguments)/2,_=C>na&&(r?+r.apply(this,arguments):_v(f*f+d*d)),E=YL(Lae(d-f)/2,+n.apply(this,arguments)),A=E,k=E,T,I;if(_>na){var N=zae(_/f*il(C)),O=zae(_/d*il(C));(w-=N*2)>na?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+p)/2),(S-=O*2)>na?(O*=m?1:-1,v+=O,y-=O):(S=0,v=y=(h+p)/2)}var D=d*bp(v),L=d*il(v),W=f*bp(x),G=f*il(x);if(E>na){var K=d*bp(y),ee=d*il(y),ce=f*bp(b),he=f*il(b),Oe;if(g<Sv&&(Oe=fYe(D,L,ce,he,K,ee,W,G))){var Te=D-Oe[0],De=L-Oe[1],me=K-Oe[0],P=ee-Oe[1],F=1/il(aYe((Te*me+De*P)/(_v(Te*Te+De*De)*_v(me*me+P*P)))/2),V=_v(Oe[0]*Oe[0]+Oe[1]*Oe[1]);A=YL(E,(f-V)/(F-1)),k=YL(E,(d-V)/(F+1))}}S>na?k>na?(T=hA(ce,he,D,L,d,k,m),I=hA(K,ee,W,G,d,k,m),s.moveTo(T.cx+T.x01,T.cy+T.y01),k<E?s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,d,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),!m),s.arc(I.cx,I.cy,k,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):(s.moveTo(D,L),s.arc(0,0,d,v,y,!m)):s.moveTo(D,L),!(f>na)||!(w>na)?s.lineTo(W,G):A>na?(T=hA(W,G,K,ee,f,-A,m),I=hA(D,L,ce,he,f,-A,m),s.lineTo(T.cx+T.x01,T.cy+T.y01),A<E?s.arc(T.cx,T.cy,A,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,A,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,f,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),m),s.arc(I.cx,I.cy,A,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Sv/2;return[bp(c)*l,il(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Rn(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Rn(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Rn(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Rn(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Rn(+l),u):i},u.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Rn(+l),u):a},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Rn(+l),u):o},u.context=function(l){return arguments.length?(s=l??null,u):s},u}function jae(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Uae(e){this._context=e}Uae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ZL(e){return new Uae(e)}function Wae(e){return e[0]}function Vae(e){return e[1]}function qae(e,t){var n=Rn(!0),r=null,i=ZL,a=null;e=typeof e=="function"?e:e===void 0?Wae:Rn(e),t=typeof t=="function"?t:t===void 0?Vae:Rn(t);function o(s){var u,l=(s=jae(s)).length,c,f=!1,d;for(r==null&&(a=i(d=yp())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,u,s),+t(c,u,s));if(d)return a=null,d+""||null}return o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Rn(+s),o):e},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:Rn(+s),o):t},o.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Rn(!!s),o):n},o.curve=function(s){return arguments.length?(i=s,r!=null&&(a=i(r)),o):i},o.context=function(s){return arguments.length?(s==null?r=a=null:a=i(r=s),o):r},o}function Hae(e,t,n){var r=null,i=Rn(!0),a=null,o=ZL,s=null;e=typeof e=="function"?e:e===void 0?Wae:Rn(+e),t=typeof t=="function"?t:Rn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Vae:Rn(+n);function u(c){var f,d,h,p=(c=jae(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(a==null&&(s=o(v=yp())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(y[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),s.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return s=null,v+""||null}function l(){return qae().defined(i).curve(o).context(a)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Rn(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Rn(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Rn(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,a!=null&&(s=o(a)),u):o},u.context=function(c){return arguments.length?(c==null?a=s=null:s=o(a=c),u):a},u}var hYe={draw:function(e,t){var n=Math.sqrt(t/Sv);e.moveTo(n,0),e.arc(0,0,n,0,Bae)}};function pYe(e,t){var n=null;e=typeof e=="function"?e:Rn(e||hYe),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function r(){var i;if(n||(n=i=yp()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Rn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function cd(){}function pA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function gA(e){this._context=e}gA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gYe(e){return new gA(e)}function Gae(e){this._context=e}Gae.prototype={areaStart:cd,areaEnd:cd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:pA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mYe(e){return new Gae(e)}function Kae(e){this._context=e}Kae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:pA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vYe(e){return new Kae(e)}function Xae(e,t){this._basis=new gA(e),this._beta=t}Xae.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*a),this._beta*t[s]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var yYe=function e(t){function n(r){return t===1?new gA(r):new Xae(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function mA(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function JL(e,t){this._context=e,this._k=(1-t)/6}JL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:mA(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:mA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bYe=function e(t){function n(r){return new JL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function QL(e,t){this._context=e,this._k=(1-t)/6}QL.prototype={areaStart:cd,areaEnd:cd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:mA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var xYe=function e(t){function n(r){return new QL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function eB(e,t){this._context=e,this._k=(1-t)/6}eB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var wYe=function e(t){function n(r){return new eB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function tB(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>na){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>na){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function Yae(e,t){this._context=e,this._alpha=t}Yae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:tB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _Ye=function e(t){function n(r){return t?new Yae(r,t):new JL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Zae(e,t){this._context=e,this._alpha=t}Zae.prototype={areaStart:cd,areaEnd:cd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:tB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var SYe=function e(t){function n(r){return t?new Zae(r,t):new QL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Jae(e,t){this._context=e,this._alpha=t}Jae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:tB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var EYe=function e(t){function n(r){return t?new Jae(r,t):new eB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Qae(e){this._context=e}Qae.prototype={areaStart:cd,areaEnd:cd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function CYe(e){return new Qae(e)}function eoe(e){return e<0?-1:1}function toe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(eoe(a)+eoe(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function noe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function nB(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function vA(e){this._context=e}vA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nB(this,this._t0,noe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nB(this,noe(this,n=toe(this,e,t)),n);break;default:nB(this,this._t0,n=toe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function roe(e){this._context=new ioe(e)}(roe.prototype=Object.create(vA.prototype)).point=function(e,t){vA.prototype.point.call(this,t,e)};function ioe(e){this._context=e}ioe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function AYe(e){return new vA(e)}function kYe(e){return new roe(e)}function aoe(e){this._context=e}aoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=ooe(e),i=ooe(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ooe(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function TYe(e){return new aoe(e)}function yA(e,t){this._context=e,this._t=t}yA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function OYe(e){return new yA(e,.5)}function IYe(e){return new yA(e,0)}function NYe(e){return new yA(e,1)}function Ev(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const DYe=()=>typeof Image!="undefined"?Image:null;function al(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function fd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rB=Symbol("implicit");function iB(){var e=new Map,t=[],n=[],r=rB;function i(a){var o=a+"",s=e.get(o);if(!s){if(r!==rB)return r;e.set(o,s=t.push(a))}return n[(s-1)%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of a){const s=o+"";e.has(s)||e.set(s,t.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return iB(t,n).unknown(r)},al.apply(i,arguments),i}function Cv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function L1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function dd(){}var xp=.7,Av=1/xp,kv="\\s*([+-]?\\d+)\\s*",B1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ol="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",RYe=/^#([0-9a-f]{3,8})$/,FYe=new RegExp("^rgb\\("+[kv,kv,kv]+"\\)$"),MYe=new RegExp("^rgb\\("+[ol,ol,ol]+"\\)$"),PYe=new RegExp("^rgba\\("+[kv,kv,kv,B1]+"\\)$"),$Ye=new RegExp("^rgba\\("+[ol,ol,ol,B1]+"\\)$"),LYe=new RegExp("^hsl\\("+[B1,ol,ol]+"\\)$"),BYe=new RegExp("^hsla\\("+[B1,ol,ol,B1]+"\\)$"),soe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cv(dd,z1,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:uoe,formatHex:uoe,formatHsl:zYe,formatRgb:loe,toString:loe});function uoe(){return this.rgb().formatHex()}function zYe(){return poe(this).formatHsl()}function loe(){return this.rgb().formatRgb()}function z1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=RYe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?coe(t):n===3?new Bi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=FYe.exec(e))?new Bi(t[1],t[2],t[3],1):(t=MYe.exec(e))?new Bi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=PYe.exec(e))?bA(t[1],t[2],t[3],t[4]):(t=$Ye.exec(e))?bA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=LYe.exec(e))?hoe(t[1],t[2]/100,t[3]/100,1):(t=BYe.exec(e))?hoe(t[1],t[2]/100,t[3]/100,t[4]):soe.hasOwnProperty(e)?coe(soe[e]):e==="transparent"?new Bi(NaN,NaN,NaN,0):null}function coe(e){return new Bi(e>>16&255,e>>8&255,e&255,1)}function bA(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bi(e,t,n,r)}function aB(e){return e instanceof dd||(e=z1(e)),e?(e=e.rgb(),new Bi(e.r,e.g,e.b,e.opacity)):new Bi}function hd(e,t,n,r){return arguments.length===1?aB(e):new Bi(e,t,n,r??1)}function Bi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Cv(Bi,hd,L1(dd,{brighter:function(e){return e=e==null?Av:Math.pow(Av,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?xp:Math.pow(xp,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:foe,formatHex:foe,formatRgb:doe,toString:doe}));function foe(){return"#"+oB(this.r)+oB(this.g)+oB(this.b)}function doe(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function oB(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function hoe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new sl(e,t,n,r)}function poe(e){if(e instanceof sl)return new sl(e.h,e.s,e.l,e.opacity);if(e instanceof dd||(e=z1(e)),!e)return new sl;if(e instanceof sl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new sl(o,s,u,e.opacity)}function xA(e,t,n,r){return arguments.length===1?poe(e):new sl(e,t,n,r??1)}function sl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Cv(sl,xA,L1(dd,{brighter:function(e){return e=e==null?Av:Math.pow(Av,e),new sl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?xp:Math.pow(xp,e),new sl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bi(sB(e>=240?e-240:e+120,i,r),sB(e,i,r),sB(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function sB(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const goe=Math.PI/180,moe=180/Math.PI,wA=18,voe=.96422,yoe=1,boe=.82521,xoe=4/29,Tv=6/29,woe=3*Tv*Tv,jYe=Tv*Tv*Tv;function _oe(e){if(e instanceof ul)return new ul(e.l,e.a,e.b,e.opacity);if(e instanceof Sc)return Soe(e);e instanceof Bi||(e=aB(e));var t=fB(e.r),n=fB(e.g),r=fB(e.b),i=uB((.2225045*t+.7168786*n+.0606169*r)/yoe),a,o;return t===n&&n===r?a=o=i:(a=uB((.4360747*t+.3850649*n+.1430804*r)/voe),o=uB((.0139322*t+.0971045*n+.7141733*r)/boe)),new ul(116*i-16,500*(a-i),200*(i-o),e.opacity)}function _A(e,t,n,r){return arguments.length===1?_oe(e):new ul(e,t,n,r??1)}function ul(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Cv(ul,_A,L1(dd,{brighter:function(e){return new ul(this.l+wA*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ul(this.l-wA*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=voe*lB(t),e=yoe*lB(e),n=boe*lB(n),new Bi(cB(3.1338561*t-1.6168667*e-.4906146*n),cB(-.9787684*t+1.9161415*e+.033454*n),cB(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function uB(e){return e>jYe?Math.pow(e,1/3):e/woe+xoe}function lB(e){return e>Tv?e*e*e:woe*(e-xoe)}function cB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function fB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function UYe(e){if(e instanceof Sc)return new Sc(e.h,e.c,e.l,e.opacity);if(e instanceof ul||(e=_oe(e)),e.a===0&&e.b===0)return new Sc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*moe;return new Sc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function SA(e,t,n,r){return arguments.length===1?UYe(e):new Sc(e,t,n,r??1)}function Sc(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Soe(e){if(isNaN(e.h))return new ul(e.l,0,0,e.opacity);var t=e.h*goe;return new ul(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Cv(Sc,SA,L1(dd,{brighter:function(e){return new Sc(this.h,this.c,this.l+wA*(e??1),this.opacity)},darker:function(e){return new Sc(this.h,this.c,this.l-wA*(e??1),this.opacity)},rgb:function(){return Soe(this).rgb()}}));var Eoe=-.14861,dB=1.78277,hB=-.29227,EA=-.90649,j1=1.97294,Coe=j1*EA,Aoe=j1*dB,koe=dB*hB-EA*Eoe;function WYe(e){if(e instanceof wp)return new wp(e.h,e.s,e.l,e.opacity);e instanceof Bi||(e=aB(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(koe*r+Coe*t-Aoe*n)/(koe+Coe-Aoe),a=r-i,o=(j1*(n-i)-hB*a)/EA,s=Math.sqrt(o*o+a*a)/(j1*i*(1-i)),u=s?Math.atan2(o,a)*moe-120:NaN;return new wp(u<0?u+360:u,s,i,e.opacity)}function pB(e,t,n,r){return arguments.length===1?WYe(e):new wp(e,t,n,r??1)}function wp(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Cv(wp,pB,L1(dd,{brighter:function(e){return e=e==null?Av:Math.pow(Av,e),new wp(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?xp:Math.pow(xp,e),new wp(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*goe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Bi(255*(t+n*(Eoe*r+dB*i)),255*(t+n*(hB*r+EA*i)),255*(t+n*(j1*r)),this.opacity)}}));function Toe(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function Ooe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Toe((n-r/t)*t,o,i,a,s)}}function Ioe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Toe((n-r/t)*t,i,a,o,s)}}var CA=e=>()=>e;function Noe(e,t){return function(n){return e+n*t}}function VYe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function AA(e,t){var n=t-e;return n?Noe(e,n>180||n<-180?n-360*Math.round(n/360):n):CA(isNaN(e)?t:e)}function qYe(e){return(e=+e)==1?_i:function(t,n){return n-t?VYe(t,n,e):CA(isNaN(t)?n:t)}}function _i(e,t){var n=t-e;return n?Noe(e,n):CA(isNaN(e)?t:e)}var gB=function e(t){var n=qYe(t);function r(i,a){var o=n((i=hd(i)).r,(a=hd(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=_i(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Doe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=hd(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=a(u),s+""}}}var HYe=Doe(Ooe),GYe=Doe(Ioe);function mB(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function Roe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function KYe(e,t){return(Roe(t)?mB:Foe)(e,t)}function Foe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=pd(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function Moe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ru(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Poe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=pd(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var vB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yB=new RegExp(vB.source,"g");function XYe(e){return function(){return e}}function YYe(e){return function(t){return e(t)+""}}function $oe(e,t){var n=vB.lastIndex=yB.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(e=e+"",t=t+"";(r=vB.exec(e))&&(i=yB.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:ru(r,i)})),n=yB.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?YYe(u[0].x):XYe(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function pd(e,t){var n=typeof t,r;return t==null||n==="boolean"?CA(t):(n==="number"?ru:n==="string"?(r=z1(t))?(t=r,gB):$oe:t instanceof z1?gB:t instanceof Date?Moe:Roe(t)?mB:Array.isArray(t)?Foe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Poe:ru)(e,t)}function ZYe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function JYe(e,t){var n=AA(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function U1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Loe=180/Math.PI,bB={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Boe(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Loe,skewX:Math.atan(u)*Loe,scaleX:o,scaleY:s}}var kA;function QYe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?bB:Boe(t.a,t.b,t.c,t.d,t.e,t.f)}function eZe(e){return e==null||(kA||(kA=document.createElementNS("http://www.w3.org/2000/svg","g")),kA.setAttribute("transform",e),!(e=kA.transform.baseVal.consolidate()))?bB:(e=e.matrix,Boe(e.a,e.b,e.c,e.d,e.e,e.f))}function zoe(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:ru(l,f)},{i:g-2,x:ru(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ru(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ru(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:ru(l,f)},{i:g-2,x:ru(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var tZe=zoe(QYe,"px, ","px)","deg)"),nZe=zoe(eZe,", ",")",")"),rZe=1e-12;function joe(e){return((e=Math.exp(e))+1/e)/2}function iZe(e){return((e=Math.exp(e))-1/e)/2}function aZe(e){return((e=Math.exp(2*e))-1)/(e+1)}var oZe=function e(t,n,r){function i(a,o){var s=a[0],u=a[1],l=a[2],c=o[0],f=o[1],d=o[2],h=c-s,p=f-u,g=h*h+p*p,m,v;if(g<rZe)v=Math.log(d/l)/t,m=function(C){return[s+C*h,u+C*p,l*Math.exp(t*C*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),x=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(x*x+1)-x);v=(S-w)/t,m=function(C){var _=C*v,E=joe(w),A=l/(n*y)*(E*aZe(t*_+w)-iZe(w));return[s+A*h,u+A*p,l*E/joe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,u=s*s;return e(o,s,u)},i}(Math.SQRT2,2,4);function Uoe(e){return function(t,n){var r=e((t=xA(t)).h,(n=xA(n)).h),i=_i(t.s,n.s),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var sZe=Uoe(AA),uZe=Uoe(_i);function lZe(e,t){var n=_i((e=_A(e)).l,(t=_A(t)).l),r=_i(e.a,t.a),i=_i(e.b,t.b),a=_i(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function Woe(e){return function(t,n){var r=e((t=SA(t)).h,(n=SA(n)).h),i=_i(t.c,n.c),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var cZe=Woe(AA),fZe=Woe(_i);function Voe(e){return function t(n){n=+n;function r(i,a){var o=e((i=pB(i)).h,(a=pB(a)).h),s=_i(i.s,a.s),u=_i(i.l,a.l),l=_i(i.opacity,a.opacity);return function(c){return i.h=o(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var dZe=Voe(AA),hZe=Voe(_i);function xB(e,t){t===void 0&&(t=e,e=pd);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function pZe(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var gZe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:pd,interpolateArray:KYe,interpolateBasis:Ooe,interpolateBasisClosed:Ioe,interpolateDate:Moe,interpolateDiscrete:ZYe,interpolateHue:JYe,interpolateNumber:ru,interpolateNumberArray:mB,interpolateObject:Poe,interpolateRound:U1,interpolateString:$oe,interpolateTransformCss:tZe,interpolateTransformSvg:nZe,interpolateZoom:oZe,interpolateRgb:gB,interpolateRgbBasis:HYe,interpolateRgbBasisClosed:GYe,interpolateHsl:sZe,interpolateHslLong:uZe,interpolateLab:lZe,interpolateHcl:cZe,interpolateHclLong:fZe,interpolateCubehelix:dZe,interpolateCubehelixLong:hZe,piecewise:xB,quantize:pZe});function mZe(e){return function(){return e}}function wB(e){return+e}var qoe=[0,1];function uo(e){return e}function _B(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:mZe(isNaN(t)?NaN:.5)}function vZe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function yZe(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=_B(i,r),a=n(o,a)):(r=_B(r,i),a=n(a,o)),function(s){return a(r(s))}}function bZe(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=_B(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var u=f1(e,s,1,r)-1;return a[u](i[u](s))}}function W1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function TA(){var e=qoe,t=qoe,n=pd,r,i,a,o=uo,s,u,l;function c(){var d=Math.min(e.length,t.length);return o!==uo&&(o=vZe(e[0],e[d-1])),s=d>2?bZe:yZe,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?a:(u||(u=s(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=s(t,e.map(r),ru)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,wB),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=U1,c()},f.clamp=function(d){return arguments.length?(o=d?!0:uo,c()):o!==uo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function Hoe(){return TA()(uo,uo)}function OA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ov(e){return e=OA(Math.abs(e)),e?e[1]:NaN}function xZe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function wZe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var _Ze=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function V1(e){return new SB(e)}V1.prototype=SB.prototype;function SB(e){if(!(t=_Ze.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}SB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function SZe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Goe;function EZe(e,t){var n=OA(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Goe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+OA(e,Math.max(0,t+a-1))[0]}function Koe(e,t){var n=OA(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Xoe={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Koe(e*100,t)},r:Koe,s:EZe,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Yoe(e){return e}var Zoe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Joe(e){var t=e.grouping&&e.thousands?xZe(e.grouping,e.thousands):Yoe,n=e.currency,r=e.decimal,i=e.numerals?wZe(e.numerals):Yoe,a=e.percent||"%";function o(u){u=V1(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,g=u.comma,m=u.precision,v=u.trim,y=u.type;y==="n"?(g=!0,y="g"):Xoe[y]||(m==null&&(m=12),v=!0,y="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var b=d==="$"?n[0]:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(y)?a:"",w=Xoe[y],S=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function C(_){var E=b,A=x,k,T,I;if(y==="c")A=w(_)+A,_="";else{_=+_;var N=_<0;if(_=w(Math.abs(_),m),v&&(_=SZe(_)),N&&+_==0&&(N=!1),E=(N?f==="("?f:"-":f==="-"||f==="("?"":f)+E,A=(y==="s"?Zoe[8+Goe/3]:"")+A+(N&&f==="("?")":""),S){for(k=-1,T=_.length;++k<T;)if(I=_.charCodeAt(k),48>I||I>57){A=(I===46?r+_.slice(k+1):_.slice(k))+A,_=_.slice(0,k);break}}}g&&!h&&(_=t(_,1/0));var O=E.length+_.length+A.length,D=O<p?new Array(p-O+1).join(l):"";switch(g&&h&&(_=t(D+_,D.length?p-A.length:1/0),D=""),c){case"<":_=E+_+A+D;break;case"=":_=E+D+_+A;break;case"^":_=D.slice(0,O=D.length>>1)+E+_+A+D.slice(O);break;default:_=D+E+_+A;break}return i(_)}return C.toString=function(){return u+""},C}function s(u,l){var c=o((u=V1(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Ov(l)/3)))*3,d=Math.pow(10,-f),h=Zoe[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:s}}var IA,NA,EB;Qoe({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function Qoe(e){return IA=Joe(e),NA=IA.format,EB=IA.formatPrefix,IA}function ese(e){return Math.max(0,-Ov(Math.abs(e)))}function tse(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ov(t)/3)))*3-Ov(Math.abs(e)))}function nse(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ov(t)-Ov(e))+1}var CZe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",formatDefaultLocale:Qoe,get format(){return NA},get formatPrefix(){return EB},formatLocale:Joe,formatSpecifier:V1,precisionFixed:ese,precisionPrefix:tse,precisionRound:nse});function rse(e,t,n,r){var i=ed(e,t,n),a;switch(r=V1(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=tse(i,o))&&(r.precision=a),EB(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=nse(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=ese(i))&&(r.precision=a-(r.type==="%")*2);break}}return NA(r)}function _p(e){var t=e.domain;return e.ticks=function(n){var r=t();return x4(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return rse(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=_re(o,s,n),l===u)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function ise(){var e=Hoe();return e.copy=function(){return W1(e,ise())},al.apply(e,arguments),_p(e)}function ase(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,wB),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return ase(e).unknown(t)},e=arguments.length?Array.from(e,wB):[0,1],_p(n)}function ose(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function sse(e){return Math.log(e)}function use(e){return Math.exp(e)}function AZe(e){return-Math.log(-e)}function kZe(e){return-Math.exp(-e)}function TZe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function OZe(e){return e===10?TZe:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function IZe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function lse(e){return function(t){return-e(-t)}}function CB(e){var t=e(sse,use),n=t.domain,r=10,i,a;function o(){return i=IZe(r),a=OZe(r),n()[0]<0?(i=lse(i),a=lse(a),e(AZe,kZe)):e(sse,use),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,g,m,v=s==null?10:+s,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=a(d);g<r;++g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=a(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}y.length*2<v&&(y=x4(l,c,v))}else y=x4(d,h,Math.min(h-d,v)).map(a);return f?y.reverse():y},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=NA(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(ose(n(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function cse(){var e=CB(TA()).domain([1,10]);return e.copy=function(){return W1(e,cse()).base(e.base())},al.apply(e,arguments),e}function fse(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function dse(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function AB(e){var t=1,n=e(fse(t),dse(t));return n.constant=function(r){return arguments.length?e(fse(t=+r),dse(t)):t},_p(n)}function hse(){var e=AB(TA());return e.copy=function(){return W1(e,hse()).constant(e.constant())},al.apply(e,arguments)}function pse(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function NZe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function DZe(e){return e<0?-e*e:e*e}function kB(e){var t=e(uo,uo),n=1;function r(){return n===1?e(uo,uo):n===.5?e(NZe,DZe):e(pse(n),pse(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},_p(t)}function TB(){var e=kB(TA());return e.copy=function(){return W1(e,TB()).exponent(e.exponent())},al.apply(e,arguments),e}function RZe(){return TB.apply(null,arguments).exponent(.5)}function gse(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=Ere(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[f1(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(dv),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return gse().domain(e).range(t).unknown(r)},al.apply(a,arguments)}function mse(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(u){return u!=null&&u<=u?i[f1(r,u,0,n)]:a}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return mse().domain([e,t]).range(i).unknown(a)},al.apply(_p(o),arguments)}function vse(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[f1(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return vse().domain(e).range(t).unknown(n)},al.apply(i,arguments)}function FZe(e){return new Date(e)}function MZe(e){return e instanceof Date?+e:+new Date(+e)}function OB(e,t,n,r,i,a,o,s,u,l){var c=Hoe(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:s(S)<S?p:o(S)<S?g:a(S)<S?m:r(S)<S?i(S)<S?v:y:n(S)<S?b:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,MZe)):d().map(FZe)},c.ticks=function(S){var C=d();return e(C[0],C[C.length-1],S??10)},c.tickFormat=function(S,C){return C==null?w:l(C)},c.nice=function(S){var C=d();return(!S||typeof S.range!="function")&&(S=t(C[0],C[C.length-1],S??10)),S?d(ose(C,S)):c},c.copy=function(){return W1(c,OB(e,t,n,r,i,a,o,s,u,l))},c}function PZe(){return al.apply(OB(iGe,aGe,rd,qC,p1,nd,N4,I4,td,G4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function $Ze(){return al.apply(OB(nGe,rGe,ad,HC,m1,id,F4,R4,td,K4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function DA(){var e=0,t=1,n,r,i,a,o=uo,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(pd),l.rangeRound=c(U1),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function gd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function IB(){var e=_p(DA()(uo));return e.copy=function(){return gd(e,IB())},fd.apply(e,arguments)}function yse(){var e=CB(DA()).domain([1,10]);return e.copy=function(){return gd(e,yse()).base(e.base())},fd.apply(e,arguments)}function bse(){var e=AB(DA());return e.copy=function(){return gd(e,bse()).constant(e.constant())},fd.apply(e,arguments)}function NB(){var e=kB(DA());return e.copy=function(){return gd(e,NB()).exponent(e.exponent())},fd.apply(e,arguments)}function LZe(){return NB.apply(null,arguments).exponent(.5)}function RA(){var e=0,t=.5,n=1,r=1,i,a,o,s,u,l=uo,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-a)*(r*g<r*a?s:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),a=c(t=+t),o=c(n=+n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=xB(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(pd),h.rangeRound=p(U1),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),a=g(t),o=g(n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function xse(){var e=_p(RA()(uo));return e.copy=function(){return gd(e,xse())},fd.apply(e,arguments)}function wse(){var e=CB(RA()).domain([.1,1,10]);return e.copy=function(){return gd(e,wse()).base(e.base())},fd.apply(e,arguments)}function _se(){var e=AB(RA());return e.copy=function(){return gd(e,_se()).constant(e.constant())},fd.apply(e,arguments)}function DB(){var e=kB(RA());return e.copy=function(){return gd(e,DB()).exponent(e.exponent())},fd.apply(e,arguments)}function BZe(){return DB.apply(null,arguments).exponent(.5)}function RB(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const zZe="identity",Iv="linear",Ec="log",q1="pow",H1="sqrt",FA="symlog",Sp="time",Ep="utc",ll="sequential",Nv="diverging",Dv="quantile",MA="quantize",PA="threshold",FB="ordinal",MB="point",Sse="band",PB="bin-ordinal",ui="continuous",G1="discrete",K1="discretizing",hs="interpolating",$B="temporal";function jZe(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function UZe(e){return function(t){const n=e.range();let r=t[0],i=t[1],a=-1,o,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(a<0&&(a=u),o=u);if(!(a<0))return r=e.invertExtent(n[a]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function LB(){const e=iB().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,a,o=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=RB(f,s,u);let g=r[d-0];i=(h-g)/(p||1),o&&(i=Math.floor(i)),g+=(h-g-i*(f-s))*l,a=i*(1-s),o&&(g=Math.round(g),a=Math.round(a));const m=Bo(f).map(v=>g+i*v);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>r[1-d])))return v=Math.max(0,UC(h,g)-1),y=g===m?v:UC(h,m)-1,g-h[v]>a+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return LB().domain(t()).range(r).round(o).paddingInner(s).paddingOuter(u).align(l)},c()}function Ese(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Ese(t())},e}function WZe(){return Ese(LB().paddingInner(1))}var VZe=Array.prototype.map;function qZe(e){return VZe.call(e,Zi)}const HZe=Array.prototype.slice;function Cse(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(f1(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=qZe(r),n):e.slice()},n.range=function(r){return arguments.length?(t=HZe.call(r),n):t.slice()},n.tickFormat=function(r,i){return rse(e[0],sn(e),r??10,i)},n.copy=function(){return Cse().domain(n.domain()).range(n.range())},n}const $A={};function GZe(e,t,n){const r=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?jZe(a):a.invertExtent?UZe(a):void 0),a.type=e,a};return r.metadata=tu(wt(n)),r}function Sn(e,t,n){return arguments.length>1?($A[e]=GZe(e,t,n),this):Ase(e)?$A[e]:void 0}Sn(zZe,ase),Sn(Iv,ise,ui),Sn(Ec,cse,[ui,Ec]),Sn(q1,TB,ui),Sn(H1,RZe,ui),Sn(FA,hse,ui),Sn(Sp,PZe,[ui,$B]),Sn(Ep,$Ze,[ui,$B]),Sn(ll,IB,[ui,hs]),Sn("".concat(ll,"-").concat(Iv),IB,[ui,hs]),Sn("".concat(ll,"-").concat(Ec),yse,[ui,hs,Ec]),Sn("".concat(ll,"-").concat(q1),NB,[ui,hs]),Sn("".concat(ll,"-").concat(H1),LZe,[ui,hs]),Sn("".concat(ll,"-").concat(FA),bse,[ui,hs]),Sn("".concat(Nv,"-").concat(Iv),xse,[ui,hs]),Sn("".concat(Nv,"-").concat(Ec),wse,[ui,hs,Ec]),Sn("".concat(Nv,"-").concat(q1),DB,[ui,hs]),Sn("".concat(Nv,"-").concat(H1),BZe,[ui,hs]),Sn("".concat(Nv,"-").concat(FA),_se,[ui,hs]),Sn(Dv,gse,[K1,Dv]),Sn(MA,mse,K1),Sn(PA,vse,K1),Sn(PB,Cse,[G1,K1]),Sn(FB,iB,G1),Sn(Sse,LB,G1),Sn(MB,WZe,G1);function Ase(e){return _t($A,e)}function Cp(e,t){const n=$A[e];return n&&n.metadata[t]}function BB(e){return Cp(e,ui)}function Rv(e){return Cp(e,G1)}function zB(e){return Cp(e,K1)}function kse(e){return Cp(e,Ec)}function KZe(e){return Cp(e,$B)}function Tse(e){return Cp(e,hs)}function Ose(e){return Cp(e,Dv)}const XZe=["clamp","base","constant","exponent"];function Ise(e,t){const n=t[0],r=sn(t)-n;return function(i){return e(n+i*r)}}function LA(e,t,n){return xB(jB(t||"rgb",n),e)}function Nse(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function Dse(e,t,n){const r=n-t;let i,a,o;return!r||!Number.isFinite(r)?Ji(.5):(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Sn(a)().domain([t,n]).range([0,1]),XZe.forEach(s=>e[s]?o[s](e[s]()):0),o)}function jB(e,t){const n=gZe[YZe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function YZe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const ZZe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},JZe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Rse(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Fse(e,t){for(const n in e)UB(n,t(e[n]))}const Mse={};Fse(JZe,Rse),Fse(ZZe,e=>LA(Rse(e)));function UB(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Mse[e]=t,this):Mse[e]}const BA="symbol",QZe="discrete",eJe="gradient",tJe=e=>ut(e)?e.map(t=>String(t)):String(e),nJe=(e,t)=>e[1]-t[1],rJe=(e,t)=>t[1]-e[1];function WB(e,t,n){let r;return Jf(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(u1(e.domain())/n||1)))),Nt(t)&&(r=t.step,t=t.interval),Bn(t)&&(t=e.type===Sp?gv(t):e.type==Ep?mv(t):Se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Pse(e,t,n){let r=e.range(),i=r[0],a=sn(r),o=nJe;if(i>a&&(r=a,a=i,i=r,o=rJe),i=Math.floor(i),a=Math.ceil(a),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=a).sort(o).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],sn(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function VB(e,t){return e.bins?Pse(e,e.bins):e.ticks?e.ticks(t):e.domain()}function $se(e,t,n,r,i,a){const o=t.type;let s=tJe;if(o===Sp||i===Sp)s=e.timeFormat(r);else if(o===Ep||i===Ep)s=e.utcFormat(r);else if(kse(o)){const u=e.formatFloat(r);if(a||t.bins)s=u;else{const l=Lse(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function Lse(e,t,n){const r=VB(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(s):s}const qB={[Dv]:"quantiles",[MA]:"thresholds",[PA]:"domain"},Bse={[Dv]:"quantiles",[MA]:"domain"};function zse(e,t){return e.bins?oJe(e.bins):e.type===Ec?Lse(e,t,!0):qB[e.type]?aJe(e[qB[e.type]]()):VB(e,t)}function iJe(e,t,n){const r=t[Bse[t.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,3*10,n)}function aJe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function oJe(e){const t=e.slice(0,-1);return t.max=sn(e),t}const sJe=e=>qB[e.type]||e.bins;function jse(e,t,n,r,i,a,o){const s=Bse[t.type]&&a!==Sp&&a!==Ep?iJe(e,t,i):$se(e,t,n,i,a,o);return r===BA&&sJe(t)?uJe(s):r===QZe?lJe(s):cJe(s)}const uJe=e=>(t,n,r)=>{const i=Use(r[n+1],Use(r.max,1/0)),a=Wse(t,e),o=Wse(i,e);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},Use=(e,t)=>e??t,lJe=e=>(t,n)=>n?e(t):null,cJe=e=>t=>e(t),Wse=(e,t)=>Number.isFinite(e)?t(e):null;function fJe(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+sn(t),a=i-r;if(e.type===PA){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function dJe(e,t,n,r){const i=r||t.type;return Bn(n)&&KZe(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Sp?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Ep?e.utcFormat("%A, %d %B %Y, %X UTC"):jse(e,t,5,null,n,r,!0)}function Vse(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=dJe(e,t,n.format,n.formatType);if(zB(t.type)){const a=zse(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(Rv(t.type)){const a=t.domain(),o=a.length,s=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(s)}else{const a=t.domain();return"values from ".concat(i(a[0])," to ").concat(i(sn(a)))}}let qse=0;function hJe(){qse=0}const zA="p_";function HB(e){return e&&e.gradient}function Hse(e,t,n){const r=e.gradient;let i=e.id,a=r==="radial"?zA:"";return i||(i=e.id="gradient_"+qse++,r==="radial"?(e.x1=cl(e.x1,.5),e.y1=cl(e.y1,.5),e.r1=cl(e.r1,0),e.x2=cl(e.x2,.5),e.y2=cl(e.y2,.5),e.r2=cl(e.r2,.5),a=zA):(e.x1=cl(e.x1,0),e.y1=cl(e.y1,0),e.x2=cl(e.x2,1),e.y2=cl(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+a+i+")"}function cl(e,t){return e??t}function Gse(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const Kse={basis:{curve:gYe},"basis-closed":{curve:mYe},"basis-open":{curve:vYe},bundle:{curve:yYe,tension:"beta",value:.85},cardinal:{curve:bYe,tension:"tension",value:0},"cardinal-open":{curve:wYe,tension:"tension",value:0},"cardinal-closed":{curve:xYe,tension:"tension",value:0},"catmull-rom":{curve:_Ye,tension:"alpha",value:.5},"catmull-rom-closed":{curve:SYe,tension:"alpha",value:.5},"catmull-rom-open":{curve:EYe,tension:"alpha",value:.5},linear:{curve:ZL},"linear-closed":{curve:CYe},monotone:{horizontal:kYe,vertical:AYe},natural:{curve:TYe},step:{curve:OYe},"step-after":{curve:NYe},"step-before":{curve:IYe}};function GB(e,t,n){var r=_t(Kse,e)&&Kse[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const pJe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},X1=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Fv(e){const t=[];let n,r,i,a,o,s,u,l,c,f;const d=e.slice().replace(X1[0],"###$1").split(X1[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(X1[2],"$1###$2").replace(X1[3],"$1###$2").split(X1[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(s=pJe[o.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=s))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=s)t.push([o].concat(i.slice(l,l+s)))}else t.push(i)}return t}const md=Math.PI/180,gJe=1e-14,Ap=Math.PI/2,fl=Math.PI*2,Mv=Math.sqrt(3)/2;var KB={},XB={},Xse=[].join;function mJe(e,t,n,r,i,a,o,s,u){const l=Xse.call(arguments);if(KB[l])return KB[l];const c=o*md,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,x=m*s+v*u,w=y*s+b*u,S=m*e+v*t,C=y*e+b*t,_=(S-x)*(S-x)+(C-w)*(C-w);let E=1/_-.25;E<0&&(E=0);let A=Math.sqrt(E);a==i&&(A=-A);const k=.5*(x+S)-A*(C-w),T=.5*(w+C)+A*(S-x),I=Math.atan2(w-T,x-k);let O=Math.atan2(C-T,S-k)-I;O<0&&a===1?O+=fl:O>0&&a===0&&(O-=fl);const D=Math.ceil(Math.abs(O/(Ap+.001))),L=[];for(let W=0;W<D;++W){const G=I+W*O/D,K=I+(W+1)*O/D;L[W]=[k,T,G,K,n,r,f,d]}return KB[l]=L}function vJe(e){const t=Xse.call(e);if(XB[t])return XB[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7];const c=l*o,f=-u*s,d=u*o,h=l*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,S=r+g+x*p,C=n+m,_=r+v,E=C+x*v,A=_-x*m;return XB[t]=[c*w+f*S,d*w+h*S,c*E+f*A,d*E+h*A,c*C+f*_,d*C+h*_]}const ps=["l",0,0,0,0,0,0,0];function yJe(e,t,n){const r=ps[0]=e[0];if(r==="a"||r==="A")ps[1]=t*e[1],ps[2]=n*e[2],ps[3]=e[3],ps[4]=e[4],ps[5]=e[5],ps[6]=t*e[6],ps[7]=n*e[7];else if(r==="h"||r==="H")ps[1]=t*e[1];else if(r==="v"||r==="V")ps[1]=n*e[1];else for(var i=1,a=e.length;i<a;++i)ps[i]=(i%2==1?t:n)*e[i];return ps}function Y1(e,t,n,r,i,a){var o,s=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(o=t[m],(i!==1||a!==1)&&(o=yJe(o,i,a)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-p,f=2*l-g):s[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":Yse(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":Yse(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}s=o}}function Yse(e,t,n,r){const i=mJe(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let a=0;a<i.length;++a){const o=vJe(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Zse=.5773502691896257,Jse={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,fl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n,i=r-n*Zse,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n,i=r-n*Zse;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Mv*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Qse(e){return _t(Jse,e)?Jse[e]:bJe(e)}var YB={};function bJe(e){if(!_t(YB,e)){const t=Fv(e);YB[e]={draw:function(n,r){Y1(n,t,0,0,Math.sqrt(r)/2)}}}return YB[e]}const vd=.448084975506;function xJe(e){return e.x}function wJe(e){return e.y}function _Je(e){return e.width}function SJe(e){return e.height}function Cc(e){return typeof e=="function"?e:()=>+e}function jA(e,t,n){return Math.max(t,Math.min(e,n))}function eue(){var e=xJe,t=wJe,n=_Je,r=SJe,i=Cc(0),a=i,o=i,s=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=jA(+i.call(this,c),0,y),x=jA(+a.call(this,c),0,y),w=jA(+o.call(this,c),0,y),S=jA(+s.call(this,c),0,y);if(u||(u=h=yp()),b<=0&&x<=0&&w<=0&&S<=0)u.rect(p,g,m,v);else{var C=p+m,_=g+v;u.moveTo(p+b,g),u.lineTo(C-x,g),u.bezierCurveTo(C-vd*x,g,C,g+vd*x,C,g+x),u.lineTo(C,_-S),u.bezierCurveTo(C,_-vd*S,C-vd*S,_,C-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+vd*w,_,p,_-vd*w,p,_-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+vd*b,p+vd*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Cc(c),l):e},l.y=function(c){return arguments.length?(t=Cc(c),l):t},l.width=function(c){return arguments.length?(n=Cc(c),l):n},l.height=function(c){return arguments.length?(r=Cc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Cc(c),a=f!=null?Cc(f):i,s=d!=null?Cc(d):i,o=h!=null?Cc(h):a,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function tue(){var e,t,n,r,i=null,a,o,s,u;function l(f,d,h){const p=h/2;if(a){var g=s-d,m=f-o;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,x=Math.atan2(m,g);i.moveTo(o-y,s-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,x-Math.PI,x),i.lineTo(o+y,s+b),i.arc(o,s,u,x,x+Math.PI)}else i.arc(f,d,p,0,fl);i.closePath()}else a=1;o=f,s=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=yp()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(a=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function Z1(e,t){return e??t}const J1=e=>e.x||0,Q1=e=>e.y||0,EJe=e=>e.width||0,CJe=e=>e.height||0,AJe=e=>(e.x||0)+(e.width||0),kJe=e=>(e.y||0)+(e.height||0),TJe=e=>e.startAngle||0,OJe=e=>e.endAngle||0,IJe=e=>e.padAngle||0,NJe=e=>e.innerRadius||0,DJe=e=>e.outerRadius||0,RJe=e=>e.cornerRadius||0,FJe=e=>Z1(e.cornerRadiusTopLeft,e.cornerRadius)||0,MJe=e=>Z1(e.cornerRadiusTopRight,e.cornerRadius)||0,PJe=e=>Z1(e.cornerRadiusBottomRight,e.cornerRadius)||0,$Je=e=>Z1(e.cornerRadiusBottomLeft,e.cornerRadius)||0,LJe=e=>Z1(e.size,64),BJe=e=>e.size||1,UA=e=>e.defined!==!1,zJe=e=>Qse(e.shape||"circle"),jJe=dYe().startAngle(TJe).endAngle(OJe).padAngle(IJe).innerRadius(NJe).outerRadius(DJe).cornerRadius(RJe),UJe=Hae().x(J1).y1(Q1).y0(kJe).defined(UA),WJe=Hae().y(Q1).x1(J1).x0(AJe).defined(UA),VJe=qae().x(J1).y(Q1).defined(UA),qJe=eue().x(J1).y(Q1).width(EJe).height(CJe).cornerRadius(FJe,MJe,PJe,$Je),HJe=pYe().type(zJe).size(LJe),GJe=tue().x(J1).y(Q1).defined(UA).size(BJe);function ZB(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function KJe(e,t){return jJe.context(e)(t)}function XJe(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?WJe:UJe).curve(GB(r,n.orient,n.tension)).context(e)(t)}function YJe(e,t){const n=t[0],r=n.interpolate||"linear";return VJe.curve(GB(r,n.orient,n.tension)).context(e)(t)}function Pv(e,t,n,r){return qJe.context(e)(t,n,r)}function ZJe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function JJe(e,t){return HJe.context(e)(t)}function QJe(e,t){return GJe.context(e)(t)}var nue=1;function rue(){nue=1}function JB(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+nue++),o=i.clipping[a]||(i.clipping[a]={id:a});return Lt(r)?o.path=r(null):ZB(n)?o.path=Pv(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function li(e){this.clear(),e&&this.union(e)}li.prototype={clone(){return new li(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*o+l,u*r+s*o+c,s*a-u*i+l,u*a+s*i+c,s*a-u*o+l,u*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function WA(e){this.mark=e,this.bounds=this.bounds||new li}function VA(e){WA.call(this,e),this.items=this.items||[]}$e(VA,WA);function QB(e){this._pending=0,this._loader=e||XC()}function iue(e){e._pending+=1}function ex(e){e._pending-=1}QB.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return iue(t),t._loader.sanitize(e,{context:"href"}).then(n=>(ex(t),n)).catch(()=>(ex(t),null))},loadImage(e){const t=this,n=DYe();return iue(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=_t(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>ex(t),a.onerror=()=>ex(t),a.src=i,a}).catch(r=>(ex(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Ac(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?eQe(t,r):0))}return e}function eQe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const tQe=fl-1e-8;let qA,HA,GA,kp,ez,KA,tz,nz;const yd=(e,t)=>qA.add(e,t),XA=(e,t)=>yd(HA=e,GA=t),aue=e=>yd(e,qA.y1),oue=e=>yd(qA.x1,e),Tp=(e,t)=>ez*e+tz*t,Op=(e,t)=>KA*e+nz*t,rz=(e,t)=>yd(Tp(e,t),Op(e,t)),iz=(e,t)=>XA(Tp(e,t),Op(e,t));function tx(e,t){return qA=e,t?(kp=t*md,ez=nz=Math.cos(kp),KA=Math.sin(kp),tz=-KA):(ez=nz=1,kp=KA=tz=0),nQe}const nQe={beginPath(){},closePath(){},moveTo:iz,lineTo:iz,rect(e,t,n,r){kp?(rz(e+n,t),rz(e+n,t+r),rz(e,t+r),iz(e,t)):(yd(e+n,t+r),XA(e,t))},quadraticCurveTo(e,t,n,r){const i=Tp(e,t),a=Op(e,t),o=Tp(n,r),s=Op(n,r);sue(HA,i,o,aue),sue(GA,a,s,oue),XA(o,s)},bezierCurveTo(e,t,n,r,i,a){const o=Tp(e,t),s=Op(e,t),u=Tp(n,r),l=Op(n,r),c=Tp(i,a),f=Op(i,a);uue(HA,o,u,c,aue),uue(GA,s,l,f,oue),XA(c,f)},arc(e,t,n,r,i,a){if(r+=kp,i+=kp,HA=n*Math.cos(i)+e,GA=n*Math.sin(i)+t,Math.abs(i-r)>tQe)yd(e-n,t-n),yd(e+n,t+n);else{const o=l=>yd(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(o(r),o(i),i!==r)if(r=r%fl,r<0&&(r+=fl),i=i%fl,i<0&&(i+=fl),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=fl,s=r-r%Ap,u=0;u<4&&s>i;++u,s-=Ap)o(s);else for(s=r-r%Ap+Ap,u=0;u<4&&s<i;++u,s=s+Ap)o(s)}}};function sue(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function uue(e,t,n,r,i){const a=r-e+3*t-3*n,o=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(a)>gJe?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(lue(u,e,t,n,r)),0<l&&l<1&&i(lue(l,e,t,n,r))}function lue(e,t,n,r,i){const a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*r+s*e*i}var bd=(bd=Ev(1,1))?bd.getContext("2d"):null;const az=new li;function oz(e){return function(t,n){if(!bd)return!0;e(bd,t),az.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=az;for(let s=i;s<=o;++s)for(let u=r;u<=a;++u)if(bd.isPointInPath(u,s))return!0;return!1}}function sz(e,t){return t.contains(e.x||0,e.y||0)}function cue(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(az.set(n,r,n+i,r+a))}function fue(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return $v(t,n,r,i,a)}function $v(e,t,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(a-t)),m===1&&(h=l,p=s-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Lv(e,t){e.globalCompositeOperation=t.blend||"source-over"}function iu(e,t){return e??t}function due(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function rQe(e,t,n){const r=n.width(),i=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+iu(t.x1,.5)*r,n.y1+iu(t.y1,.5)*i,Math.max(r,i)*iu(t.r1,0),n.x1+iu(t.x2,.5)*r,n.y1+iu(t.y2,.5)*i,Math.max(r,i)*iu(t.r2,.5));else{const o=iu(t.x1,0),s=iu(t.y1,0),u=iu(t.x2,1),l=iu(t.y2,0);if(o===u||s===l||r===i)a=e.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=Ev(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=due(f.createLinearGradient(o,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return due(a,t.stops)}function hue(e,t,n){return HB(n)?rQe(e,n,t.bounds):n}function YA(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=hue(e,t,t.fill),!0):!1}var iQe=[];function Bv(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=hue(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||iQe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function aQe(e,t){return e.zindex-t.zindex||e.index-t.index}function uz(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(aQe)}function au(e,t){var n=e.items,r,i;if(!n||!n.length)return;const a=uz(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=a}for(r=0,i=n.length;r<i;++r)t(n[r])}function ZA(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const a=uz(e);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===a){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function lz(e){return function(t,n,r){au(n,i=>{(!r||r.intersects(i.bounds))&&pue(e,t,i,i)})}}function oQe(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&pue(e,t,n.items[0],n.items)}}function pue(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Lv(t,n),n.fill&&YA(t,n,i)&&t.fill(),n.stroke&&Bv(t,n,i)&&t.stroke()))}function JA(e){return e=e||ls,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,ZA(n,s=>{const u=s.bounds;if(!(u&&!u.contains(a,o)||!u)&&e(t,s,r,i,a,o))return s})}}function nx(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,s=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:s&&n.isPointInPath(i,a)||u&&n.isPointInStroke(i,a)}}function cz(e){return JA(nx(e))}function Ip(e,t){return"translate("+e+","+t+")"}function fz(e){return"rotate("+e+")"}function sQe(e,t){return"scale("+e+","+t+")"}function gue(e){return Ip(e.x||0,e.y||0)}function uQe(e){return Ip(e.x||0,e.y||0)+(e.angle?" "+fz(e.angle):"")}function lQe(e){return Ip(e.x||0,e.y||0)+(e.angle?" "+fz(e.angle):"")+(e.scaleX||e.scaleY?" "+sQe(e.scaleX||1,e.scaleY||1):"")}function dz(e,t,n){function r(o,s){o("transform",uQe(s)),o("d",t(null,s))}function i(o,s){return t(tx(o,s.angle),s),Ac(o,s).translate(s.x||0,s.y||0)}function a(o,s){var u=s.x||0,l=s.y||0,c=s.angle||0;o.translate(u,l),c&&o.rotate(c*=md),o.beginPath(),t(o,s),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:lz(a),pick:cz(a),isect:n||oz(a)}}var cQe=dz("arc",KJe);function fQe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=1/0,o,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<a&&(a=s,o=e[i]));return o}function dQe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],a=e[r].y-t[1],o=i*i+a*a,o<n))return e[r];return null}function hQe(e,t){for(var n=e.length,r,i,a;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],a=r*r+i*i,r=e[n].size||1,a<r*r))return e[n];return null}function hz(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(tx(u),c),Ac(u,c[0]))}function a(u,l){u.beginPath(),t(u,l)}const o=nx(a);function s(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:oQe(a),pick:s,isect:sz,tip:n}}var pQe=hz("area",XJe,fQe);function gQe(e,t){var n=t.clip;e.save(),Lt(n)?(e.beginPath(),n(e),e.clip()):mue(e,t.group)}function mue(e,t){e.beginPath(),ZB(t)?Pv(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function vue(e){const t=iu(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function mQe(e,t){e("transform",gue(t))}function yue(e,t){const n=vue(t);e("d",Pv(null,t,n,n))}function vQe(e,t){e("class","background"),e("aria-hidden",!0),yue(e,t)}function yQe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?yue(e,t):e("d","")}function bQe(e,t,n){const r=t.clip?JB(n,t,t):null;e("clip-path",r)}function xQe(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ac(e,t),e.translate(t.x||0,t.y||0)}function rx(e,t,n,r){const i=vue(t);e.beginPath(),Pv(e,t,(n||0)+i,(r||0)+i)}const wQe=nx(rx),_Qe=nx(rx,!1),SQe=nx(rx,!0);function EQe(e,t,n){au(t,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(rx(e,r,i,a),Lv(e,r),r.fill&&YA(e,r,s)&&e.fill(),r.stroke&&!o&&Bv(e,r,s)&&e.stroke()),e.save(),e.translate(i,a),r.clip&&mue(e,r),n&&n.translate(-i,-a),au(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,a),e.restore(),o&&r.stroke&&s&&(rx(e,r,i,a),Lv(e,r),Bv(e,r,s)&&e.stroke())})}function CQe(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;const o=n*e.pixelRatio,s=r*e.pixelRatio;return ZA(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,a))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||a<f||a>p))return;if(e.save(),e.translate(c,f),c=i-c,f=a-f,g&&ZB(u)&&!SQe(e,u,o,s))return e.restore(),null;const m=u.strokeForeground,v=t.interactive!==!1;return v&&m&&u.stroke&&_Qe(e,u,o,s)?(e.restore(),u):(l=ZA(u,y=>AQe(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&wQe(e,u,o,s)&&(l=u),e.restore(),l||null)})}function AQe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var kQe={type:"group",tag:"g",nested:!1,attr:mQe,bound:xQe,draw:EQe,pick:CQe,isect:cue,content:bQe,background:vQe,foreground:yQe},ix={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function pz(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function gz(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function mz(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function QA(e,t){return e==="center"?t/2:e==="right"?t:0}function ek(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function TQe(e,t,n){const r=pz(t,n),i=gz(t,r),a=mz(t,r),o=(t.x||0)-QA(t.align,i),s=(t.y||0)-ek(t.baseline,a),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,ix["xmlns:xlink"],"xlink:href"),e("transform",Ip(o,s)),e("width",i),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function OQe(e,t){const n=t.image,r=gz(t,n),i=mz(t,n),a=(t.x||0)-QA(t.align,r),o=(t.y||0)-ek(t.baseline,i);return e.set(a,o,a+r,o+i)}function IQe(e,t,n){au(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=pz(r,this);let a=gz(r,i),o=mz(r,i);if(a===0||o===0)return;let s=(r.x||0)-QA(r.align,a),u=(r.y||0)-ek(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=a/c,u+=(o-d)/2,o=d):(d=o*c,s+=(a-d)/2,a=d))),(i.complete||i.toDataURL)&&(Lv(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,a,o))})}var NQe={type:"image",tag:"image",nested:!1,attr:TQe,bound:OQe,draw:IQe,pick:JA(),isect:ls,get:pz,xOffset:QA,yOffset:ek},DQe=hz("line",YJe,dQe);function RQe(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",lQe(t)),e("d",t.path)}function tk(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*md,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Fv(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),Y1(e,u,0,0,a,o),e.rotate(-s),e.translate(-r,-i)):Y1(e,u,r,i,a,o)}function FQe(e,t){return tk(tx(e,t.angle),t)?e.set(0,0,0,0):Ac(e,t,!0)}var MQe={type:"path",tag:"path",nested:!1,attr:RQe,bound:FQe,draw:lz(tk),pick:cz(tk),isect:oz(tk)};function PQe(e,t){e("d",Pv(null,t))}function $Qe(e,t){var n,r;return Ac(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function bue(e,t){e.beginPath(),Pv(e,t)}var LQe={type:"rect",tag:"path",nested:!1,attr:PQe,bound:$Qe,draw:lz(bue),pick:cz(bue),isect:cue};function BQe(e,t){e("transform",gue(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function zQe(e,t){var n,r;return Ac(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function xue(e,t,n){var r,i,a,o;return t.stroke&&Bv(e,t,n)?(r=t.x||0,i=t.y||0,a=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0):!1}function jQe(e,t,n){au(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&xue(e,r,i)&&(Lv(e,r),e.stroke())}})}function UQe(e,t,n,r){return e.isPointInStroke?xue(e,t,1)&&e.isPointInStroke(n,r):!1}var WQe={type:"rule",tag:"line",nested:!1,attr:BQe,bound:zQe,draw:jQe,pick:JA(UQe),isect:fue},VQe=dz("shape",ZJe),qQe=dz("symbol",JJe,sz);const wue=ire();var dl={height:hl,measureWidth:yz,estimateWidth:vz,width:vz,canvas:_ue};_ue(!0);function _ue(e){dl.width=e&&bd?yz:vz}function vz(e,t){return Sue(wd(e,t),hl(e))}function Sue(e,t){return~~(.8*e.length*t)}function yz(e,t){return hl(e)<=0||!(t=wd(e,t))?0:Eue(t,nk(e))}function Eue(e,t){const n=`(${t}) ${e}`;let r=wue.get(n);return r===void 0&&(bd.font=t,r=bd.measureText(e).width,wue.set(n,r)),r}function hl(e){return e.fontSize!=null?+e.fontSize||0:11}function xd(e){return e.lineHeight!=null?e.lineHeight:hl(e)+2}function HQe(e){return ut(e)?e.length>1?e:e[0]:e}function ax(e){return HQe(e.lineBreak&&e.text&&!ut(e.text)?e.text.split(e.lineBreak):e.text)}function bz(e){const t=ax(e);return(ut(t)?t.length-1:0)*xd(e)}function wd(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?KQe(e,n):n}function GQe(e){if(dl.width===yz){const t=nk(e);return n=>Eue(n,t)}else{const t=hl(e);return n=>Sue(n,t)}}function KQe(e,t){var n=+e.limit,r=GQe(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",a=e.dir==="rtl",o=0,s=t.length,u;if(n-=r(i),a){for(;o<s;)u=o+s>>>1,r(t.slice(u))>n?o=u+1:s=u;return i+t.slice(o)}else{for(;o<s;)u=1+(o+s>>>1),r(t.slice(0,u))<n?o=u:s=u-1;return t.slice(0,o)+i}}function ox(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function nk(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+hl(e)+"px "+ox(e,t)}function xz(e){var t=e.baseline,n=hl(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*xd(e):t==="line-bottom"?.29*n-.5*xd(e):0)}const XQe={left:"start",center:"middle",right:"end"},sx=new li;function rk(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Ap,t+=r*Math.cos(i),n+=r*Math.sin(i)),sx.x1=t,sx.y1=n,sx}function YQe(e,t){var n=t.dx||0,r=(t.dy||0)+xz(t),i=rk(t),a=i.x1,o=i.y1,s=t.angle||0,u;e("text-anchor",XQe[t.align]||"start"),s?(u=Ip(a,o)+" "+fz(s),(n||r)&&(u+=" "+Ip(n,r))):u=Ip(a+n,o+r),e("transform",u)}function wz(e,t,n){var r=dl.height(t),i=t.align,a=rk(t),o=a.x1,s=a.y1,u=t.dx||0,l=(t.dy||0)+xz(t)-Math.round(.8*r),c=ax(t),f;if(ut(c)?(r+=xd(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,dl.width(t,h)),0)):f=dl.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*md,o,s);else if(n===2)return e.rotatedPoints(t.angle*md,o,s);return e}function ZQe(e,t,n){au(t,r=>{var i=r.opacity==null?1:r.opacity,a,o,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=nk(r),e.textAlign=r.align||"left",a=rk(r),o=a.x1,s=a.y1,r.angle&&(e.save(),e.translate(o,s),e.rotate(r.angle*md),o=s=0),o+=r.dx||0,s+=(r.dy||0)+xz(r),c=ax(r),Lv(e,r),ut(c))for(l=xd(r),u=0;u<c.length;++u)f=wd(r,c[u]),r.fill&&YA(e,r,i)&&e.fillText(f,o,s),r.stroke&&Bv(e,r,i)&&e.strokeText(f,o,s),s+=l;else f=wd(r,c),r.fill&&YA(e,r,i)&&e.fillText(f,o,s),r.stroke&&Bv(e,r,i)&&e.strokeText(f,o,s);r.angle&&e.restore()}})}function JQe(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=rk(t),s=o.x1,u=o.y1,l=wz(sx,t,1),c=-t.angle*md,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(s-f*s+d*u),p=d*i+f*a+(u-d*s-f*u);return l.contains(h,p)}function QQe(e,t){const n=wz(sx,e,2);return $v(t,n[0],n[1],n[2],n[3])||$v(t,n[0],n[1],n[4],n[5])||$v(t,n[4],n[5],n[6],n[7])||$v(t,n[2],n[3],n[6],n[7])}var eet={type:"text",tag:"text",nested:!1,attr:YQe,bound:wz,draw:ZQe,pick:JA(JQe),isect:QQe},tet=hz("trail",QJe,hQe),Uo={arc:cQe,area:pQe,group:kQe,image:NQe,line:DQe,path:MQe,rect:LQe,rule:WQe,shape:VQe,symbol:qQe,text:eet,trail:tet};function _z(e,t,n){var r=Uo[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new li),e,n)}var Cue={mark:null};function Aue(e,t,n){var r=Uo[e.marktype],i=r.bound,a=e.items,o=a&&a.length,s,u,l,c;if(r.nested)return o?l=a[0]:(Cue.mark=e,l=Cue),c=_z(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new li,o)for(s=0,u=a.length;s<u;++s)t.union(_z(a[s],i,n));return e.bounds=t}const net=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function kue(e,t){return JSON.stringify(e,net,t)}function Tue(e){const t=typeof e=="string"?JSON.parse(e):e;return Oue(t)}function Oue(e){var t=e.marktype,n=e.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&Oue(n[i]);return t&&Aue(e),e}function Sz(e){arguments.length?this.root=Tue(e):(this.root=Iue({marktype:"group",name:"root",role:"frame"}),this.root.items=[new VA(this.root)])}Sz.prototype={toJSON(e){return kue(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=Iue(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function Iue(e,t){const n={bounds:new li,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function _d(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Ez(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function lo(e,t,n,r){var i=e.childNodes[t],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=_d(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function ou(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Nue(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function ik(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function ret(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Uo[i.marktype]).tip){for(o=ik(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=a.tip(i.items,o)}return e}function Sd(e,t){this._active=null,this._handlers={},this._loader=e||XC(),this._tooltip=t||iet}function iet(e,t,n,r){e.element().setAttribute("title",r||"")}Sd.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),a=_d(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=ret(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}};function pl(e){this._el=null,this._bgcolor=null,this._loader=new QB(e)}pl.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const aet="keydown",oet="keypress",set="keyup",Due="dragenter",ak="dragleave",Rue="dragover",Cz="mousedown",uet="mouseup",ok="mousemove",ux="mouseout",Fue="mouseover",sk="click",cet="dblclick",fet="wheel",Mue="mousewheel",uk="touchstart",lk="touchmove",ck="touchend",det=[aet,oet,set,Due,ak,Rue,Cz,uet,ok,ux,Fue,sk,cet,fet,Mue,uk,lk,ck],Az=ok,lx=ux,kz=sk;function cx(e,t){Sd.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const het=e=>e===uk||e===lk||e===ck?[uk,lk,ck]:[e];function Pue(e,t){het(t).forEach(n=>pet(e,n))}function pet(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function $ue(e,t,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function Lue(e){return function(t){this.fire(e,t),this._active=null}}$e(cx,Sd,{initialize(e,t,n){return this._canvas=e&&Ez(e,"canvas"),[sk,Cz,ok,ux,ak].forEach(r=>Pue(this,r)),Sd.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:det,DOMMouseScroll(e){this.fire(Mue,e)},mousemove:$ue(ok,Fue,ux),dragover:$ue(Rue,Due,ak),mouseout:Lue(ux),dragleave:Lue(ak),mousedown(e){this._down=this._active,this.fire(Cz,e)},click(e){this._down===this._active&&(this.fire(sk,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(uk,e,!0)},touchmove(e){this.fire(lk,e,!0)},touchend(e){this.fire(ck,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===kz&&r&&r.href?this.handleHref(t,r,r.href):(e===Az||e===lx)&&this.handleTooltip(t,r,e!==lx),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(Pue(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=ik(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const a=this.context();return Uo[e.marktype].pick.call(this,a,e,t,n,r,i)}});function get(){return typeof window!="undefined"&&window.devicePixelRatio||1}var met=get();function vet(e,t,n,r,i,a){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=o?met:i;e.width=t*u,e.height=n*u;for(const l in a)s[l]=a[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function fk(e){pl.call(this,e),this._options={},this._redraw=!1,this._dirty=new li,this._tempb=new li}const Bue=pl.prototype,yet=(e,t,n)=>new li().set(0,0,t,n).translate(-e[0],-e[1]);function bet(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}$e(fk,pl,{initialize(e,t,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Ev(1,1,this._options.type),e&&this._canvas&&(ou(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Bue.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(Bue.resize.call(this,e,t,n,r),this._canvas)vet(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||Se("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=yet(n,r,i);t.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):bet(t,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),a.clear(),this},draw(e,t,n){const r=Uo[t.marktype];t.clip&&gQe(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(e,t,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,r))}});function Tz(e,t){Sd.call(this,e,t);const n=this;n._hrefHandler=Oz(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=Oz(n,(r,i)=>{n.handleTooltip(r,i,r.type!==lx)})}const Oz=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};$e(Tz,Sd,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(kz,this._hrefHandler),r.removeEventListener(Az,this._tooltipHandler),r.removeEventListener(lx,this._tooltipHandler)),this._svg=r=e&&Ez(e,"svg"),r&&(r.addEventListener(kz,this._hrefHandler),r.addEventListener(Az,this._tooltipHandler),r.addEventListener(lx,this._tooltipHandler)),Sd.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const a={type:e,handler:t,listener:Oz(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const zue="aria-hidden",Iz="aria-label",Nz="role",Dz="aria-roledescription",jue="graphics-object",Rz="graphics-symbol",Uue=(e,t,n)=>({[Nz]:e,[Dz]:t,[Iz]:n||void 0}),xet=tu(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Wue={axis:{desc:"axis",caption:Eet},legend:{desc:"legend",caption:Cet},"title-text":{desc:"title",caption:e=>`Title text '${Gue(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Gue(e)}'`}},Vue={ariaRole:Nz,ariaRoleDescription:Dz,description:Iz};function que(e,t){const n=t.aria===!1;if(e(zue,n||void 0),n||t.description==null)for(const r in Vue)e(Vue[r],void 0);else{const r=t.mark.marktype;e(Iz,t.description),e(Nz,t.ariaRole||(r==="group"?jue:Rz)),e(Dz,t.ariaRoleDescription||`${r} mark`)}}function Hue(e){return e.aria===!1?{[zue]:!0}:xet[e.role]?null:Wue[e.role]?_et(e,Wue[e.role]):wet(e)}function wet(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return Uue(n?jue:Rz,`${t} mark container`,e.description)}function _et(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return Uue(t.role||Rz,t.desc,n.description||r(n))}catch(n){return null}}function Gue(e){return wt(e.text).join(" ")}function Eet(e){const t=e.datum,n=e.orient,r=t.title?Kue(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),s=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Rv(s)?"discrete":s} scale with ${Vse(o,a,e)}`}function Cet(e){const t=e.datum,n=t.title?Kue(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,a=Object.keys(i),o=e.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return ket(r)+(n?` titled '${n}'`:"")+` for ${Aet(a)} with ${Vse(u,s,e)}`}function Kue(e){try{return wt(sn(e.items).items[0].text).join(" ")}catch(t){return null}}function Aet(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+sn(e)}function ket(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Xue=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Tet=e=>Xue(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Fz(){let e="",t="",n="";const r=[],i=()=>t=n="",a=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${Tet(l)}"`),s),s={open(u,...l){a(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:o,text:u=>(n+=Xue(u),s),toString:()=>e};return s}const Yue=e=>Zue(Fz(),e)+"";function Zue(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?e.text(a.nodeValue):Zue(e,a)}}return e.close()}const dk={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Jue={fill:"none","stroke-miterlimit":10},fx=0,Que="http://www.w3.org/2000/xmlns/",ci=ix.xmlns;function Mz(e){pl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Pz=pl.prototype;$e(Mz,pl,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=lo(e,0,"svg",ci),this._svg.setAttributeNS(Que,"xmlns",ci),this._svg.setAttributeNS(Que,"xmlns:xlink",ix["xmlns:xlink"]),this._svg.setAttribute("version",ix.version),this._svg.setAttribute("class","marks"),ou(e,1),this._root=lo(this._svg,fx,"g",ci),Ed(this._root,Jue),ou(this._svg,fx+1)),this.background(this._bgcolor),Pz.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Pz.background.apply(this,arguments)},resize(e,t,n,r){return Pz.resize.call(this,e,t,n,r),this._svg&&(Ed(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=lo(e,fx,"rect",ci),Ed(n,{width:this._width,height:this._height,fill:t}));const r=Yue(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),ou(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=e.length;o<s;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Uo[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,ele(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,ele(n,t)):this._update(a,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Uo[t.marktype],a=t.interactive===!1?"none":null,o=i.tag==="g";let s=null,u=0;const l=tle(t,e,n,"g",r);l.setAttribute("class",Nue(t));const c=Hue(t);for(const d in c)Na(l,d,c[d]);o||Na(l,"pointer-events",a),Na(l,"clip-path",t.clip?JB(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=tle(d,l,s,i.tag,r);h&&(this._update(i,p,d),o&&Net(this,p,d)),s=p,++u};return i.nested?t.items.length&&f(t.items[0]):au(t,f),ou(l,u),l},_update(e,t,n){kc=t,ra=t.__values__,que(dx,n),e.attr(dx,n,this);const r=Ret[e.type];r&&r.call(this,e,t,n),kc&&this.style(kc,n)},style(e,t){if(t!=null)for(const n in dk){let r=n==="font"?ox(t):t[n];if(r===ra[n])continue;const i=dk[n];r==null?e.removeAttribute(i):(HB(r)&&(r=Hse(r,this._defs.gradient,nle())),e.setAttribute(i,r+"")),ra[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=lo(e,fx+1,"defs",ci)),r=Oet(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=lo(e,fx+1,"defs",ci)),r=Iet(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):ou(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function ele(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Oet(e,t,n){let r,i,a;if(t.gradient==="radial"){let o=lo(e,n++,"pattern",ci);Ed(o,{id:zA+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=lo(o,0,"rect",ci),Ed(o,{width:1,height:1,fill:`url(${nle()}#${t.id})`}),e=lo(e,n++,"radialGradient",ci),Ed(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=lo(e,n++,"linearGradient",ci),Ed(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)a=lo(e,r,"stop",ci),a.setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return ou(e,r),n}function Iet(e,t,n){let r;return e=lo(e,n,"clipPath",ci),e.setAttribute("id",t.id),t.path?(r=lo(e,0,"path",ci),r.setAttribute("d",t.path)):(r=lo(e,0,"rect",ci),Ed(r,{x:0,y:0,width:t.width,height:t.height})),ou(e,1),n+1}function Net(e,t,n){t=t.lastChild.previousSibling;let r,i=0;au(n,a=>{r=e.mark(t,a,r),++i}),ou(t,1+i)}function tle(e,t,n,r,i){let a=e._svg,o;if(!a&&(o=t.ownerDocument,a=_d(o,r,ci),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},r==="g"))){const s=_d(o,"path",ci);a.appendChild(s),s.__data__=e;const u=_d(o,"g",ci);a.appendChild(u),u.__data__=e;const l=_d(o,"path",ci);a.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||Det(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function Det(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let kc=null,ra=null;const Ret={group(e,t,n){const r=kc=t.childNodes[2];ra=r.__values__,e.foreground(dx,n,this),ra=t.__values__,kc=t.childNodes[1],e.content(dx,n,this);const i=kc=t.childNodes[0];e.background(dx,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==ra.events&&(Na(r,"pointer-events",a),Na(i,"pointer-events",a),ra.events=a),n.strokeForeground&&n.stroke){const o=n.fill;Na(r,"display",null),this.style(i,n),Na(i,"stroke",null),o&&(n.fill=null),ra=r.__values__,this.style(r,n),o&&(n.fill=o),kc=null}else Na(r,"display","none")},image(e,t,n){n.smooth===!1?($z(t,"image-rendering","optimizeSpeed"),$z(t,"image-rendering","pixelated")):$z(t,"image-rendering",null)},text(e,t,n){const r=ax(n);let i,a,o,s;ut(r)?(a=r.map(u=>wd(n,u)),i=a.join(`
`),i!==ra.text&&(ou(t,0),o=t.ownerDocument,s=xd(n),a.forEach((u,l)=>{const c=_d(o,"tspan",ci);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),ra.text=i)):(a=wd(n,r),a!==ra.text&&(t.textContent=a,ra.text=a)),Na(t,"font-family",ox(n)),Na(t,"font-size",hl(n)+"px"),Na(t,"font-style",n.fontStyle),Na(t,"font-variant",n.fontVariant),Na(t,"font-weight",n.fontWeight)}};function dx(e,t,n){t!==ra[e]&&(n?Fet(kc,e,t,n):Na(kc,e,t),ra[e]=t)}function $z(e,t,n){n!==ra[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ra[t]=n)}function Ed(e,t){for(const n in t)Na(e,n,t[n])}function Na(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Fet(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function nle(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Lz(e){pl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}$e(Lz,pl,{svg(){return this._text},_render(e){const t=Fz();t.open("svg",Rt({},ix,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Jue,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Uo[t.marktype],r=n.tag,i=[que,n.attr];e.open("g",{class:Nue(t),"clip-path":t.clip?JB(this,t,t.group):null},Hue(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const a=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=ax(o);if(ut(u)){const l={x:0,dy:xd(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(wd(o,u[c])).close()}else e.text(wd(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),au(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&a(t.items[0]):au(t,a),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},a=(o,s,u,l)=>{i[l||o]=s};return Array.isArray(n)?n.forEach(o=>o(a,t,this)):n(a,t,this),r&&Met(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const a=t[i],o=a.stops;a.gradient==="radial"?(e.open("pattern",{id:zA+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let s=0;s<o.length;++s)e.open("stop",{offset:o[s].offset,"stop-color":o[s].color}).close();e.close()}for(const i in n){const a=n[i];e.open("clipPath",{id:i}),a.path?e.open("path",{d:a.path}).close():e.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),e.close()}e.close()}}});function Met(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=ox(t),e["font-size"]=hl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in dk){let o=t[a];const s=dk[a];o==="transparent"&&(s==="fill"||s==="stroke")||o!=null&&(HB(o)&&(o=Hse(o,i.gradient,"")),e[s]=o)}return e}const rle="canvas",ile="png",ale="svg",ole="none",Cd={Canvas:rle,PNG:ile,SVG:ale,None:ole},zv={};zv[rle]=zv[ile]={renderer:fk,headless:fk,handler:cx},zv[ale]={renderer:Mz,headless:Lz,handler:Tz},zv[ole]={};function hk(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(zv[e]=t,this):zv[e]}function sle(e,t,n){const r=[],i=new li().union(t),a=e.marktype;return a?ule(e,i,n,r):a==="group"?lle(e,i,n,r):Se("Intersect scene must be mark node or group item.")}function ule(e,t,n,r){if(Pet(e,t,n)){const i=e.items,a=e.marktype,o=i.length;let s=0;if(a==="group")for(;s<o;++s)lle(i[s],t,n,r);else for(const u=Uo[a].isect;s<o;++s){const l=i[s];cle(l,t,u)&&r.push(l)}}return r}function Pet(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function lle(e,t,n,r){n&&n(e.mark)&&cle(e,t,Uo.group.isect)&&r.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let u=0;u<a;++u)ule(i[u],t,n,r);t.translate(o,s)}return r}function cle(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const Bz=new li;function fle(e){const t=e.clip;if(Lt(t))t(tx(Bz.clear()));else if(t)Bz.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Bz)}const $et=1e-9;function zz(e,t,n){return e===t?!0:n==="path"?dle(e,t):e instanceof Date&&t instanceof Date?+e==+t:Jf(e)&&Jf(t)?Math.abs(e-t)<=$et:!e||!t||!Nt(e)&&!Nt(t)?e==t:Let(e,t)}function dle(e,t){return zz(Fv(e),Fv(t))}function Let(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!zz(e[i],t[i],i))return!1;return typeof e==typeof t}function Bet(){rue(),hJe()}const jv="top",su="left",uu="right",Ad="bottom",zet="top-left",jet="top-right",Uet="bottom-left",Wet="bottom-right",jz="start",Uz="middle",Da="end",Vet="x",qet="y",pk="group",Wz="axis",Vz="title",Het="frame",Get="scope",qz="legend",hle="row-header",ple="row-footer",gle="row-title",mle="column-header",vle="column-footer",yle="column-title",Ket="padding",Xet="symbol",ble="fit",Yet="fit-x",Zet="fit-y",Jet="pad",Hz="none",gk="all",Gz="each",Kz="flush",kd="column",Td="row";function xle(e){ve.call(this,null,e)}$e(xle,ve,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,a=Uo[i],o=a.bound;let s=r.bounds,u;if(a.nested)r.items.length&&n.dirty(r.items[0]),s=mk(r,o),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===pk||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(mk(l,o))),r.role){case Wz:case qz:case Vz:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(mk(l,o))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(mk(l,o))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return fle(r),t.modifies("bounds")}});function mk(e,t,n){return t(e.bounds.clear(),e,n)}const wle=":vega_identifier:";function Xz(e){ve.call(this,0,e)}Xz.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},$e(Xz,ve,{transform(e,t){const n=Qet(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),t}});function Qet(e){return e._signals[wle]||(e._signals[wle]=e.add(0))}function _le(e){ve.call(this,null,e)}$e(_le,ve,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,ett(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===pk?VA:WA;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function ett(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Sle(e){ve.call(this,null,e)}const Ele={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!Cle(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},Cle=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),Ale=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n)if(Cle(i,a=e[n].bounds,t))return!0},ttt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},ntt=(e,t,n)=>{var r=e.range(),i=new li;return t===jv||t===Ad?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},kle=e=>(e.forEach(t=>t.opacity=1),e),Tle=(e,t)=>e.reflow(t.modified()).modifies("opacity");$e(Sle,ve,{transform(e,t){const n=Ele[e.method]||Ele.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(kle(i),t=Tle(t,e)),t;if(i=i.filter(ttt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),a=kle(i),t=Tle(t,e),a.length>=3&&Ale(a,r)){do a=n(a,r);while(a.length>=3&&Ale(a,r));a.length<3&&!sn(i).opacity&&(a.length>1&&(sn(a).opacity=0),sn(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=ntt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const s=a[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function Ole(e){ve.call(this,null,e)}$e(Ole,ve,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ia=new li;function Uv(e,t,n){return e[t]===n?0:(e[t]=n,1)}function rtt(e){var t=e.items[0].orient;return t===su||t===uu}function itt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function att(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,s=i.orient,u=itt(a),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&bz(p),y=0,b=0,x,w;switch(ia.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case jv:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&vk(e,p,w,g,v,0,-1,m);break;case su:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&vk(e,p,w,g,v,1,-1,m);break;case uu:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&vk(e,p,w,g,v,1,1,m);break;case Ad:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&vk(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Ac(m.translate(y,b),i),Uv(i,"x",y+o)|Uv(i,"y",b+o)&&(i.bounds=ia,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function vk(e,t,n,r,i,a,o,s){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),a?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const Ile=(e,t)=>Math.floor(Math.min(e,t)),Nle=(e,t)=>Math.ceil(Math.max(e,t));function ott(e){var t=e.items,n=t.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],a=i.items,i.marktype===pk)switch(i.role){case Wz:case qz:case Vz:break;case hle:o.rowheaders.push(...a);break;case ple:o.rowfooters.push(...a);break;case mle:o.colheaders.push(...a);break;case vle:o.colfooters.push(...a);break;case gle:o.rowtitle=a[0];break;case yle:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function stt(e){return new li().set(0,0,e.width||0,e.height||0)}function utt(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function lr(e,t,n){const r=Nt(e)?e[t]:e;return r??(n!==void 0?n:0)}function Dle(e){return e<0?Math.ceil(-e):0}function Rle(e,t,n){var r=!n.nodirty,i=n.bounds===Kz?stt:utt,a=ia.set(0,0,0,0),o=lr(n.align,kd),s=lr(n.align,Td),u=lr(n.padding,kd),l=lr(n.padding,Td),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),x=Array(d),w=Array(d),S,C,_,E,A,k,T,I,N,O,D;for(C=0;C<c;++C)p[C]=0;for(C=0;C<f;++C)v[C]=0;for(C=0;C<d;++C)k=t[C],A=w[C]=i(k),k.x=k.x||0,b[C]=0,k.y=k.y||0,x[C]=0,_=C%c,E=~~(C/c),g=Math.max(g,T=Math.ceil(A.x2)),y=Math.max(y,I=Math.ceil(A.y2)),p[_]=Math.max(p[_],T),v[E]=Math.max(v[E],I),h[C]=u+Dle(A.x1),m[C]=l+Dle(A.y1),r&&e.dirty(t[C]);for(C=0;C<d;++C)C%c==0&&(h[C]=0),C<c&&(m[C]=0);if(o===Gz)for(_=1;_<c;++_){for(D=0,C=_;C<d;C+=c)D<h[C]&&(D=h[C]);for(C=_;C<d;C+=c)h[C]=D+p[_-1]}else if(o===gk){for(D=0,C=0;C<d;++C)C%c&&D<h[C]&&(D=h[C]);for(C=0;C<d;++C)C%c&&(h[C]=D+g)}else for(o=!1,_=1;_<c;++_)for(C=_;C<d;C+=c)h[C]+=p[_-1];if(s===Gz)for(E=1;E<f;++E){for(D=0,C=E*c,S=C+c;C<S;++C)D<m[C]&&(D=m[C]);for(C=E*c;C<S;++C)m[C]=D+v[E-1]}else if(s===gk){for(D=0,C=c;C<d;++C)D<m[C]&&(D=m[C]);for(C=c;C<d;++C)m[C]=D+y}else for(s=!1,E=1;E<f;++E)for(C=E*c,S=C+c;C<S;++C)m[C]+=v[E-1];for(N=0,C=0;C<d;++C)N=h[C]+(C%c?N:0),b[C]+=N-t[C].x;for(_=0;_<c;++_)for(O=0,C=_;C<d;C+=c)O+=m[C],x[C]+=O-t[C].y;if(o&&lr(n.center,kd)&&f>1)for(C=0;C<d;++C)A=o===gk?g:p[C%c],N=A-w[C].x2-t[C].x-b[C],N>0&&(b[C]+=N/2);if(s&&lr(n.center,Td)&&c!==1)for(C=0;C<d;++C)A=s===gk?y:v[~~(C/c)],O=A-w[C].y2-t[C].y-x[C],O>0&&(x[C]+=O/2);for(C=0;C<d;++C)a.union(w[C].translate(b[C],x[C]));switch(N=lr(n.anchor,Vet),O=lr(n.anchor,qet),lr(n.anchor,kd)){case Da:N-=a.width();break;case Uz:N-=a.width()/2}switch(lr(n.anchor,Td)){case Da:O-=a.height();break;case Uz:O-=a.height()/2}for(N=Math.round(N),O=Math.round(O),a.clear(),C=0;C<d;++C)t[C].mark.bounds.clear();for(C=0;C<d;++C)k=t[C],k.x+=b[C]+=N,k.y+=x[C]+=O,a.union(k.mark.bounds.union(k.bounds.translate(b[C],x[C]))),r&&e.dirty(k);return a}function ltt(e,t,n){var r=ott(t),i=r.marks,a=n.bounds===Kz?ctt:ftt,o=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,p,g,m;const v=Rle(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=lr(n.headerBand,Td,null),c=yk(e,r.rowheaders,i,s,u,-lr(o,"rowHeader"),Ile,0,a,"x1",0,s,1,g)),r.colheaders&&(g=lr(n.headerBand,kd,null),f=yk(e,r.colheaders,i,s,s,-lr(o,"columnHeader"),Ile,1,a,"y1",0,1,s,g)),r.rowfooters&&(g=lr(n.footerBand,Td,null),d=yk(e,r.rowfooters,i,s,u,lr(o,"rowFooter"),Nle,0,a,"x2",s-1,s,1,g)),r.colfooters&&(g=lr(n.footerBand,kd,null),h=yk(e,r.colfooters,i,s,s,lr(o,"columnFooter"),Nle,1,a,"y2",l-s,1,s,g)),r.rowtitle&&(p=lr(n.titleAnchor,Td),m=lr(o,"rowTitle"),m=p===Da?d+m:c-m,g=lr(n.titleBand,Td,.5),Fle(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=lr(n.titleAnchor,kd),m=lr(o,"columnTitle"),m=p===Da?h+m:f-m,g=lr(n.titleBand,kd,.5),Fle(e,r.coltitle,m,1,v,g))}function ctt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function ftt(e,t){return e.bounds[t]}function yk(e,t,n,r,i,a,o,s,u,l,c,f,d,h){var p=n.length,g=0,m=0,v,y,b,x,w,S,C,_,E;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=o(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=a,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(S=t[y],w=S.mark.bounds,b=v;b>=0&&(C=n[b])==null;b-=d);s?(_=h==null?C.x:Math.round(C.bounds.x1+h*C.bounds.width()),E=g):(_=g,E=h==null?C.y:Math.round(C.bounds.y1+h*C.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),E-(S.y||0))),S.x=_,S.y=E,e.dirty(S),m=o(m,w[l])}return m}function Fle(e,t,n,r,i,a){if(!!t){e.dirty(t);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}function dtt(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function htt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function ptt(e,t,n,r,i,a,o){const s=dtt(n,t),u=htt(e,s("offset",0)),l=s("anchor",jz),c=l===Da?1:l===Uz?.5:0,f={align:Gz,bounds:s("bounds",Kz),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case su:f.anchor={x:Math.floor(r.x1)-u,column:Da,y:c*(o||r.height()+2*r.y1),row:l};break;case uu:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case jv:f.anchor={y:Math.floor(i.y1)-u,row:Da,x:c*(a||i.width()+2*i.x1),column:l};break;case Ad:f.anchor={y:Math.ceil(i.y2)+u,x:c*(a||i.width()+2*i.x1),column:l};break;case zet:f.anchor={x:u,y:u};break;case jet:f.anchor={x:a-u,y:u,column:Da};break;case Uet:f.anchor={x:u,y:o-u,row:Da};break;case Wet:f.anchor={x:a-u,y:o-u,column:Da,row:Da};break}return f}function gtt(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),vtt(e,n,n.items[0].items[0]),a=mtt(n,a),u=2*n.padding,l=2*n.padding,a.empty()||(u=Math.ceil(a.width()+u),l=Math.ceil(a.height()+l)),r.type===Xet&&ytt(n.items[0].items[0].items[0].items),i!==Hz&&(n.x=o=0,n.y=s=0),n.width=u,n.height=l,Ac(a.set(o,s,o+u,s+l),n),n.mark.bounds.clear().union(a),n}function mtt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function vtt(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title)(i||a)&&hx(e,n,i,a);else{var o=t.items[1].items[0],s=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case su:i+=Math.ceil(o.bounds.width())+u;break;case uu:case Ad:break;default:a+=o.bounds.height()+u}switch((i||a)&&hx(e,n,i,a),o.orient){case su:c+=Wv(t,n,o,s,1,1);break;case uu:l+=Wv(t,n,o,Da,0,0)+u,c+=Wv(t,n,o,s,1,1);break;case Ad:l+=Wv(t,n,o,s,0,0),c+=Wv(t,n,o,Da,-1,0,1)+u;break;default:l+=Wv(t,n,o,s,0,0)}(l||c)&&hx(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(hx(e,n,-l,0),hx(e,o,-l,0))}}function Wv(e,t,n,r,i,a,o){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(a||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&a?c:0,d=u&&a?0:c,h=i<=0?0:bz(n);return Math.round(r===jz?f:r===Da?d-h:.5*(c-h))}function hx(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function ytt(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function btt(e,t,n,r,i){var a=t.items[0],o=a.frame,s=a.orient,u=a.anchor,l=a.offset,c=a.padding,f=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=s===su||s===uu?r:n,p=0,g=0,m=0,v=0,y=0,b;if(o!==pk?s===su?(p=i.y2,h=i.y1):s===uu?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):s===su&&(p=r,h=0),b=u===jz?p:u===Da?h:(p+h)/2,d&&d.text){switch(s){case jv:case Ad:y=f.bounds.height()+c;break;case su:v=f.bounds.width()+c;break;case uu:v=-f.bounds.width()-c;break}ia.clear().union(d.bounds),ia.translate(v-(d.x||0),y-(d.y||0)),Uv(d,"x",v)|Uv(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(ia),d.mark.bounds.clear().union(ia),e.dirty(d)),ia.clear().union(d.bounds)}else ia.clear();switch(ia.union(f.bounds),s){case jv:g=b,m=i.y1-ia.height()-l;break;case su:g=i.x1-ia.width()-l,m=b;break;case uu:g=i.x2+ia.width()+l,m=b;break;case Ad:g=b,m=i.y2+l;break;default:g=a.x,m=a.y}return Uv(a,"x",g)|Uv(a,"y",m)&&(ia.translate(g,m),e.dirty(a),a.bounds.clear().union(ia),t.bounds.clear().union(ia),e.dirty(a)),a.bounds}function Mle(e){ve.call(this,null,e)}$e(Mle,ve,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&ltt(n,r,e.layout),wtt(n,r,e)}),xtt(e.mark.group)?t.reflow():t}});function xtt(e){return e&&e.mark.role!=="legend-entry"}function wtt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=new li().set(0,0,i,a),s=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case Wz:h=rtt(f)?s:u,h.union(att(e,f,i,a));break;case Vz:c=f;break;case qz:l.push(gtt(e,f));break;case Het:case Get:case hle:case ple:case gle:case mle:case vle:case yle:s.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{d=v.orient||uu,d!==Hz&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];Rle(e,y,ptt(y,v,n.legends,s,u,i,a))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&n.autosize.type===ble)switch(v.orient){case su:case uu:o.add(y.x1,0).add(y.x2,0);break;case jv:case Ad:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(s).union(u),c&&o.union(btt(e,c,i,a,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),_tt(e,t,o,n)}function _tt(e,t,n,r){const i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;let o=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Ket){const p=e.padding();o-=p.left+p.right,s-=p.top+p.bottom}a===Hz?(l=0,f=0,u=o,c=s):a===ble?(u=Math.max(0,o-l-d),c=Math.max(0,s-f-h)):a===Yet?(u=Math.max(0,o-l-d),s=c+f+h):a===Zet?(o=u+l+d,c=Math.max(0,s-f-h)):a===Jet&&(o=u+l+d,s=c+f+h),e._resizeView(o,s,u,c,[l,f],i.resize)}var Stt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:xle,identifier:Xz,mark:_le,overlap:Sle,render:Ole,viewlayout:Mle});function Ple(e){ve.call(this,null,e)}$e(Ple,ve,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,s=WB(a,o,e.minstep),u=e.format||$se(n,a,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?Pse(a,e.values,s):VB(a,s);return i&&(r.rem=i),i=l.map((c,f)=>In({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(In({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function $le(e){ve.call(this,null,e)}function Ett(){return In({})}function Ctt(e){const t=cv().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}$e($le,ve,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Ett,a=e.key||lt,o=this.value;return ut(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(a))&&Se("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=Ctt(a)),t.visit(t.ADD,s=>{const u=a(s);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),o.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=a(s),l=o.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=a(s),l=o.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function Lle(e){ve.call(this,null,e)}$e(Lle,ve,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,a=t.encode;if(ut(a))if(n.changed()||a.every(f=>i[f]))a=a[0],n.encode=null;else return t.StopPropagation;var o=a==="enter",s=i.update||Yf,u=i.enter||Yf,l=i.exit||Yf,c=(a&&!o?i[a]:s)||Yf;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Yf&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Yf&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Yf){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function Ble(e){ve.call(this,[],e)}$e(Ble,ve,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||BA,o=e.scale,s=+e.limit,u=WB(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===BA,c=e.format||jse(n,o,u,a,e.formatSpecifier,e.formatType,l),f=e.values||zse(o,u),d,h,p,g,m;return i&&(r.rem=i),a===BA?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,Lt(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=Ji(g=p||8),i=i.map((v,y)=>In({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(In({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):a===eJe?(d=o.domain(),h=Dse(o,d[0],sn(d)),f.length<3&&!e.values&&d[0]!==sn(d)&&(f=[d[0],sn(d)]),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=fJe(o),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const Att=e=>e.source.x,ktt=e=>e.source.y,Ttt=e=>e.target.x,Ott=e=>e.target.y;function Yz(e){ve.call(this,{},e)}Yz.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},$e(Yz,ve,{transform(e,t){var n=e.sourceX||Att,r=e.sourceY||ktt,i=e.targetX||Ttt,a=e.targetY||Ott,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=Wle.get(u+"-"+s)||Wle.get(u);return l||Se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),a(c))}),t.reflow(e.modified()).modifies(o)}});const zle=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Itt=(e,t,n,r)=>zle(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),jle=(e,t,n,r)=>{var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,s=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+s+" 0 1 "+n+","+r},Ntt=(e,t,n,r)=>jle(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Ule=(e,t,n,r)=>{const i=n-e,a=r-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},Dtt=(e,t,n,r)=>Ule(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Rtt=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Ftt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Mtt=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+r*o+","+r*s},Ptt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},$tt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Ltt=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s},Wle=cv({line:zle,"line-radial":Itt,arc:jle,"arc-radial":Ntt,curve:Ule,"curve-radial":Dtt,"orthogonal-horizontal":Rtt,"orthogonal-vertical":Ftt,"orthogonal-radial":Mtt,"diagonal-horizontal":Ptt,"diagonal-vertical":$tt,"diagonal-radial":Ltt});function Zz(e){ve.call(this,null,e)}Zz.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},$e(Zz,ve,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||lv,o=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(a),c=l.length,f=o,d=(s-o)/kre(l),h=Bo(c),p,g,m;for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Btt=5;function ztt(e){const t=e.type;return!e.bins&&(t===Iv||t===q1||t===H1)}function Vle(e){return BB(e)&&e!==ll}const jtt=tu(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function qle(e){ve.call(this,null,e),this.modified(!0)}$e(qle,ve,{transform(e,t){var n=t.dataflow,r=this.value,i=Utt(e);(!r||i!==r.type)&&(this.value=r=Sn(i)());for(i in e)if(!jtt[i]){if(i==="padding"&&Vle(r.type))continue;Lt(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Ktt(r,e,Gtt(r,e,Vtt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Utt(e){var t=e.type,n="",r;return t===ll?ll+"-"+Iv:(Wtt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?ll+"-":r===3?Nv+"-":""),(n+t||Iv).toLowerCase())}function Wtt(e){const t=e.type;return BB(t)&&t!==Sp&&t!==Ep&&(e.scheme||e.range&&e.range.length&&e.range.every(Bn))}function Vtt(e,t,n){const r=qtt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===void 0&&ztt(e),s,u;if(!i)return 0;if(Vle(a)&&t.padding&&i[0]!==sn(i)&&(i=Htt(a,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(Hle(a,i,n)),a===FB&&e.unknown(t.domainImplicit?rB:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&WB(e,t.nice)||null),i.length}function qtt(e,t,n){return t?(e.domain(Hle(e.type,t,n)),t.length):-1}function Htt(e,t,n,r,i,a){var o=Math.abs(sn(n)-n[0]),s=o/(o-2*r),u=e===Ec?t4(t,null,s):e===H1?$C(t,null,s,.5):e===q1?$C(t,null,s,i||1):e===FA?n4(t,null,s,a||1):e4(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Hle(e,t,n){if(kse(e)){var r=Math.abs(t.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+gt(t))}return t}function Gtt(e,t,n){let r=t.bins;if(r&&!ut(r)){const i=e.domain(),a=i[0],o=sn(i),s=r.step;let u=r.start==null?a:r.start,l=r.stop==null?o:r.stop;s||Se("Scale bins parameter missing step property."),u<a&&(u=s*Math.ceil(a/s)),l>o&&(l=s*Math.floor(o/s)),r=Bo(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===PB&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Ktt(e,t,n){var r=e.type,i=t.round||!1,a=t.range;if(t.rangeStep!=null)a=Xtt(r,t,n);else if(t.scheme&&(a=Ytt(r,t,n),Lt(a))){if(e.interpolator)return e.interpolator(a);Se("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&Tse(r))return e.interpolator(LA(Jz(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(jB(t.interpolate,t.interpolateGamma)):Lt(e.round)?e.round(i):Lt(e.rangeRound)&&e.interpolate(i?U1:pd),a&&e.range(Jz(a,t.reverse))}function Xtt(e,t,n){e!==Sse&&e!==MB&&Se("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===MB?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*RB(n,i,r)]}function Ytt(e,t,n){var r=t.schemeExtent,i,a;return ut(t.scheme)?a=LA(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),a=UB(i),a||Se("Unrecognized scheme name: ".concat(t.scheme))),n=e===PA?n+1:e===PB?n-1:e===Dv||e===MA?+t.schemeCount||Btt:n,Tse(e)?Gle(a,r,t.reverse):Lt(a)?Nse(Gle(a,r),n):e===FB?a:a.slice(0,n)}function Gle(e,t,n){return Lt(e)&&(t||n)?Ise(e,Jz(t||[0,1],n)):e}function Jz(e,t){return t?e.slice().reverse():e}function Kle(e){ve.call(this,null,e)}$e(Kle,ve,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(gp(e.sort)),this.modified(n),t}});const Xle="zero",Yle="center",Zle="normalize",Jle=["y0","y1"];function Qz(e){ve.call(this,null,e)}Qz.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Xle,values:[Xle,Yle,Zle]},{name:"as",type:"string",array:!0,length:2,default:Jle}]},$e(Qz,ve,{transform(e,t){var n=e.as||Jle,r=n[0],i=n[1],a=gp(e.sort),o=e.field||lv,s=e.offset===Yle?Ztt:e.offset===Zle?Jtt:Qtt,u,l,c,f;for(u=ent(t.source,e.groupby,a,o),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function Ztt(e,t,n,r,i){for(var a=(t-e.sum)/2,o=e.length,s=0,u;s<o;++s)u=e[s],u[r]=a,u[i]=a+=Math.abs(n(u))}function Jtt(e,t,n,r,i){for(var a=1/e.sum,o=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=o,c[i]=o=a*(l+=Math.abs(n(c)))}function Qtt(e,t,n,r,i){for(var a=0,o=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=a,c[i]=a+=l)}function ent(e,t,n,r){var i=[],a=g=>g(c),o,s,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(a),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}var tnt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:Ple,datajoin:$le,encode:Lle,legendentries:Ble,linkpath:Yz,pie:Zz,scale:qle,sortitems:Kle,stack:Qz}),mt=1e-6,bk=1e-12,Gt=Math.PI,Or=Gt/2,xk=Gt/4,Ra=Gt*2,Lr=180/Gt,Kt=Gt/180,hn=Math.abs,Vv=Math.atan,gs=Math.atan2,yt=Math.cos,wk=Math.ceil,Qle=Math.exp,e5=Math.hypot,_k=Math.log,t5=Math.pow,ct=Math.sin,ms=Math.sign||function(e){return e>0?1:e<0?-1:0},Fa=Math.sqrt,n5=Math.tan;function ece(e){return e>1?0:e<-1?Gt:Math.acos(e)}function co(e){return e>1?Or:e<-1?-Or:Math.asin(e)}function zi(){}function Sk(e,t){e&&nce.hasOwnProperty(e.type)&&nce[e.type](e,t)}var tce={Feature:function(e,t){Sk(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Sk(n[r].geometry,t)}},nce={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){r5(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)r5(n[r],t,0)},Polygon:function(e,t){rce(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)rce(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Sk(n[r],t)}};function r5(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function rce(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)r5(e[n],t,1);t.polygonEnd()}function Tc(e,t){e&&tce.hasOwnProperty(e.type)?tce[e.type](e,t):Sk(e,t)}var Ek=new Ia,Ck=new Ia,ice,ace,i5,a5,o5,gl={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Ek=new Ia,gl.lineStart=nnt,gl.lineEnd=rnt},polygonEnd:function(){var e=+Ek;Ck.add(e<0?Ra+e:e),this.lineStart=this.lineEnd=this.point=zi},sphere:function(){Ck.add(Ra)}};function nnt(){gl.point=int}function rnt(){oce(ice,ace)}function int(e,t){gl.point=oce,ice=e,ace=t,e*=Kt,t*=Kt,i5=e,a5=yt(t=t/2+xk),o5=ct(t)}function oce(e,t){e*=Kt,t*=Kt,t=t/2+xk;var n=e-i5,r=n>=0?1:-1,i=r*n,a=yt(t),o=ct(t),s=o5*o,u=a5*a+s*yt(i),l=s*r*ct(i);Ek.add(gs(l,u)),i5=e,a5=a,o5=o}function ant(e){return Ck=new Ia,Tc(e,gl),Ck*2}function Ak(e){return[gs(e[1],e[0]),co(e[2])]}function Np(e){var t=e[0],n=e[1],r=yt(n);return[r*yt(t),r*ct(t),ct(n)]}function kk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qv(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function s5(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Tk(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ok(e){var t=Fa(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var yr,fo,Ir,Wo,Dp,sce,uce,Hv,px,Od,Oc,Ic={point:u5,lineStart:cce,lineEnd:fce,polygonStart:function(){Ic.point=dce,Ic.lineStart=ont,Ic.lineEnd=snt,px=new Ia,gl.polygonStart()},polygonEnd:function(){gl.polygonEnd(),Ic.point=u5,Ic.lineStart=cce,Ic.lineEnd=fce,Ek<0?(yr=-(Ir=180),fo=-(Wo=90)):px>mt?Wo=90:px<-mt&&(fo=-90),Oc[0]=yr,Oc[1]=Ir},sphere:function(){yr=-(Ir=180),fo=-(Wo=90)}};function u5(e,t){Od.push(Oc=[yr=e,Ir=e]),t<fo&&(fo=t),t>Wo&&(Wo=t)}function lce(e,t){var n=Np([e*Kt,t*Kt]);if(Hv){var r=qv(Hv,n),i=[r[1],-r[0],0],a=qv(i,r);Ok(a),a=Ak(a);var o=e-Dp,s=o>0?1:-1,u=a[0]*Lr*s,l,c=hn(o)>180;c^(s*Dp<u&&u<s*e)?(l=a[1]*Lr,l>Wo&&(Wo=l)):(u=(u+360)%360-180,c^(s*Dp<u&&u<s*e)?(l=-a[1]*Lr,l<fo&&(fo=l)):(t<fo&&(fo=t),t>Wo&&(Wo=t))),c?e<Dp?Vo(yr,e)>Vo(yr,Ir)&&(Ir=e):Vo(e,Ir)>Vo(yr,Ir)&&(yr=e):Ir>=yr?(e<yr&&(yr=e),e>Ir&&(Ir=e)):e>Dp?Vo(yr,e)>Vo(yr,Ir)&&(Ir=e):Vo(e,Ir)>Vo(yr,Ir)&&(yr=e)}else Od.push(Oc=[yr=e,Ir=e]);t<fo&&(fo=t),t>Wo&&(Wo=t),Hv=n,Dp=e}function cce(){Ic.point=lce}function fce(){Oc[0]=yr,Oc[1]=Ir,Ic.point=u5,Hv=null}function dce(e,t){if(Hv){var n=e-Dp;px.add(hn(n)>180?n+(n>0?360:-360):n)}else sce=e,uce=t;gl.point(e,t),lce(e,t)}function ont(){gl.lineStart()}function snt(){dce(sce,uce),gl.lineEnd(),hn(px)>mt&&(yr=-(Ir=180)),Oc[0]=yr,Oc[1]=Ir,Hv=null}function Vo(e,t){return(t-=e)<0?t+360:t}function unt(e,t){return e[0]-t[0]}function hce(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function lnt(e){var t,n,r,i,a,o,s;if(Wo=Ir=-(yr=fo=1/0),Od=[],Tc(e,Ic),n=Od.length){for(Od.sort(unt),t=1,r=Od[0],a=[r];t<n;++t)i=Od[t],hce(r,i[0])||hce(r,i[1])?(Vo(r[0],i[1])>Vo(r[0],r[1])&&(r[1]=i[1]),Vo(i[0],r[1])>Vo(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t)i=a[t],(s=Vo(r[1],i[0]))>o&&(o=s,yr=i[0],Ir=r[1])}return Od=Oc=null,yr===1/0||fo===1/0?[[NaN,NaN],[NaN,NaN]]:[[yr,fo],[Ir,Wo]]}var gx,Ik,Nk,Dk,Rk,Fk,Mk,Pk,l5,c5,f5,pce,gce,Ma,Pa,$a,lu={sphere:zi,point:d5,lineStart:mce,lineEnd:vce,polygonStart:function(){lu.lineStart=dnt,lu.lineEnd=hnt},polygonEnd:function(){lu.lineStart=mce,lu.lineEnd=vce}};function d5(e,t){e*=Kt,t*=Kt;var n=yt(t);mx(n*yt(e),n*ct(e),ct(t))}function mx(e,t,n){++gx,Nk+=(e-Nk)/gx,Dk+=(t-Dk)/gx,Rk+=(n-Rk)/gx}function mce(){lu.point=cnt}function cnt(e,t){e*=Kt,t*=Kt;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),lu.point=fnt,mx(Ma,Pa,$a)}function fnt(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=gs(Fa((o=Pa*a-$a*i)*o+(o=$a*r-Ma*a)*o+(o=Ma*i-Pa*r)*o),Ma*r+Pa*i+$a*a);Ik+=o,Fk+=o*(Ma+(Ma=r)),Mk+=o*(Pa+(Pa=i)),Pk+=o*($a+($a=a)),mx(Ma,Pa,$a)}function vce(){lu.point=d5}function dnt(){lu.point=pnt}function hnt(){yce(pce,gce),lu.point=d5}function pnt(e,t){pce=e,gce=t,e*=Kt,t*=Kt,lu.point=yce;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),mx(Ma,Pa,$a)}function yce(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=Pa*a-$a*i,s=$a*r-Ma*a,u=Ma*i-Pa*r,l=e5(o,s,u),c=co(l),f=l&&-c/l;l5.add(f*o),c5.add(f*s),f5.add(f*u),Ik+=c,Fk+=c*(Ma+(Ma=r)),Mk+=c*(Pa+(Pa=i)),Pk+=c*($a+($a=a)),mx(Ma,Pa,$a)}function gnt(e){gx=Ik=Nk=Dk=Rk=Fk=Mk=Pk=0,l5=new Ia,c5=new Ia,f5=new Ia,Tc(e,lu);var t=+l5,n=+c5,r=+f5,i=e5(t,n,r);return i<bk&&(t=Fk,n=Mk,r=Pk,Ik<mt&&(t=Nk,n=Dk,r=Rk),i=e5(t,n,r),i<bk)?[NaN,NaN]:[gs(n,t)*Lr,co(r/i)*Lr]}function h5(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function p5(e,t){return[hn(e)>Gt?e+Math.round(-e/Ra)*Ra:e,t]}p5.invert=p5;function bce(e,t,n){return(e%=Ra)?t||n?h5(wce(e),_ce(t,n)):wce(e):t||n?_ce(t,n):p5}function xce(e){return function(t,n){return t+=e,[t>Gt?t-Ra:t<-Gt?t+Ra:t,n]}}function wce(e){var t=xce(e);return t.invert=xce(-e),t}function _ce(e,t){var n=yt(e),r=ct(e),i=yt(t),a=ct(t);function o(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*n+c*r;return[gs(f*i-h*a,c*n-d*r),co(h*i+f*a)]}return o.invert=function(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*i-f*a;return[gs(f*i+d*a,c*n+h*r),co(h*n-c*r)]},o}function mnt(e){e=bce(e[0]*Kt,e[1]*Kt,e.length>2?e[2]*Kt:0);function t(n){return n=e(n[0]*Kt,n[1]*Kt),n[0]*=Lr,n[1]*=Lr,n}return t.invert=function(n){return n=e.invert(n[0]*Kt,n[1]*Kt),n[0]*=Lr,n[1]*=Lr,n},t}function vnt(e,t,n,r,i,a){if(!!n){var o=yt(t),s=ct(t),u=r*n;i==null?(i=t+r*Ra,a=t-u/2):(i=Sce(o,i),a=Sce(o,a),(r>0?i<a:i>a)&&(i+=r*Ra));for(var l,c=i;r>0?c>a:c<a;c-=u)l=Ak([o,-s*yt(c),-s*ct(c)]),e.point(l[0],l[1])}}function Sce(e,t){t=Np(t),t[0]-=e,Ok(t);var n=ece(-t[1]);return((-t[2]<0?-n:n)+Ra-mt)%Ra}function Ece(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:zi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function $k(e,t){return hn(e[0]-t[0])<mt&&hn(e[1]-t[1])<mt}function Lk(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Cce(e,t,n,r,i){var a=[],o=[],s,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if($k(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),s=0;s<g;++s)i.point((m=p[s])[0],m[1]);i.lineEnd();return}v[0]+=2*mt}a.push(y=new Lk(m,p,null,!0)),o.push(y.o=new Lk(m,null,y,!1)),a.push(y=new Lk(v,p,null,!1)),o.push(y.o=new Lk(v,null,y,!0))}}),!!a.length){for(o.sort(t),Ace(a),Ace(o),s=0,u=o.length;s<u;++s)o[s].e=n=!n;for(var l=a[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function Ace(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function g5(e){return hn(e[0])<=Gt?e[0]:ms(e[0])*((hn(e[0])+Gt)%Ra-Gt)}function ynt(e,t){var n=g5(t),r=t[1],i=ct(r),a=[ct(n),-yt(n),0],o=0,s=0,u=new Ia;i===1?r=Or+mt:i===-1&&(r=-Or-mt);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=g5(h),g=h[1]/2+xk,m=ct(g),v=yt(g),y=0;y<d;++y,p=x,m=S,v=C,h=b){var b=f[y],x=g5(b),w=b[1]/2+xk,S=ct(w),C=yt(w),_=x-p,E=_>=0?1:-1,A=E*_,k=A>Gt,T=m*S;if(u.add(gs(T*E*ct(A),v*C+T*yt(A))),o+=k?_+E*Ra:_,k^p>=n^x>=n){var I=qv(Np(h),Np(b));Ok(I);var N=qv(a,I);Ok(N);var O=(k^_>=0?-1:1)*co(N[2]);(r>O||r===O&&(I[0]||I[1]))&&(s+=k^_>=0?1:-1)}}return(o<-mt||o<mt&&u<-bk)^s&1}function kce(e,t,n,r){return function(i){var a=t(i),o=Ece(),s=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=Are(c);var x=ynt(l,r);c.length?(u||(i.polygonStart(),u=!0),Cce(c,xnt,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){a.point(x,w)}function g(){d.point=p,a.lineStart()}function m(){d.point=h,a.lineEnd()}function v(x,w){f.push([x,w]),s.point(x,w)}function y(){s.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=o.result(),S,C=w.length,_,E,A;if(f.pop(),l.push(f),f=null,!!C){if(x&1){if(E=w[0],(_=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((A=E[S])[0],A[1]);i.lineEnd()}return}C>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(bnt))}}return d}}function bnt(e){return e.length>1}function xnt(e,t){return((e=e.x)[0]<0?e[1]-Or-mt:Or-e[1])-((t=t.x)[0]<0?t[1]-Or-mt:Or-t[1])}var Tce=kce(function(){return!0},wnt,Snt,[-Gt,-Or]);function wnt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?Gt:-Gt,u=hn(a-t);hn(u-Gt)<mt?(e.point(t,n=(n+o)/2>0?Or:-Or),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&u>=Gt&&(hn(t-r)<mt&&(t-=r*mt),hn(a-s)<mt&&(a-=s*mt),n=_nt(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function _nt(e,t,n,r){var i,a,o=ct(e-n);return hn(o)>mt?Vv((ct(t)*(a=yt(r))*ct(n)-ct(r)*(i=yt(t))*ct(e))/(i*a*o)):(t+r)/2}function Snt(e,t,n,r){var i;if(e==null)i=n*Or,r.point(-Gt,i),r.point(0,i),r.point(Gt,i),r.point(Gt,0),r.point(Gt,-i),r.point(0,-i),r.point(-Gt,-i),r.point(-Gt,0),r.point(-Gt,i);else if(hn(e[0]-t[0])>mt){var a=e[0]<t[0]?Gt:-Gt;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function Ent(e){var t=yt(e),n=6*Kt,r=t>0,i=hn(t)>mt;function a(c,f,d,h){vnt(h,e,n,d,c,f)}function o(c,f){return yt(c)*yt(f)>t}function s(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var y=[m,v],b,x=o(m,v),w=r?x?0:l(m,v):x?l(m+(m<0?Gt:-Gt),v):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,y),(!b||$k(f,b)||$k(y,b))&&(y[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!$k(f,y))&&c.point(y[0],y[1]),f=y,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Np(c),p=Np(f),g=[1,0,0],m=qv(h,p),v=kk(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var x=t*v/b,w=-t*y/b,S=qv(g,m),C=Tk(g,x),_=Tk(m,w);s5(C,_);var E=S,A=kk(C,E),k=kk(E,E),T=A*A-k*(kk(C,C)-1);if(!(T<0)){var I=Fa(T),N=Tk(E,(-A-I)/k);if(s5(N,C),N=Ak(N),!d)return N;var O=c[0],D=f[0],L=c[1],W=f[1],G;D<O&&(G=O,O=D,D=G);var K=D-O,ee=hn(K-Gt)<mt,ce=ee||K<mt;if(!ee&&W<L&&(G=L,L=W,W=G),ce?ee?L+W>0^N[1]<(hn(N[0]-O)<mt?L:W):L<=N[1]&&N[1]<=W:K>Gt^(O<=N[0]&&N[0]<=D)){var he=Tk(E,(-A+I)/k);return s5(he,C),[N,Ak(he)]}}}function l(c,f){var d=r?e:Gt-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return kce(o,s,a,r?[0,-e]:[-Gt,e-Gt])}function Cnt(e,t,n,r,i,a){var o=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-s,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=a-s,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=s+c*h),f<1&&(t[0]=o+f*d,t[1]=s+f*h),!0}}}}}var vx=1e9,Bk=-vx;function Oce(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function a(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return hn(l[0]-e)<mt?c>0?0:3:hn(l[0]-n)<mt?c>0?2:1:hn(l[1]-t)<mt?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=Ece(),d,h,p,g,m,v,y,b,x,w,S,C={point:_,lineStart:T,lineEnd:I,polygonStart:A,polygonEnd:k};function _(O,D){i(O,D)&&c.point(O,D)}function E(){for(var O=0,D=0,L=h.length;D<L;++D)for(var W=h[D],G=1,K=W.length,ee=W[0],ce,he,Oe=ee[0],Te=ee[1];G<K;++G)ce=Oe,he=Te,ee=W[G],Oe=ee[0],Te=ee[1],he<=r?Te>r&&(Oe-ce)*(r-he)>(Te-he)*(e-ce)&&++O:Te<=r&&(Oe-ce)*(r-he)<(Te-he)*(e-ce)&&--O;return O}function A(){c=f,d=[],h=[],S=!0}function k(){var O=E(),D=S&&O,L=(d=Are(d)).length;(D||L)&&(l.polygonStart(),D&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),L&&Cce(d,s,O,a,l),l.polygonEnd()),c=l,d=h=p=null}function T(){C.point=N,h&&h.push(p=[]),w=!0,x=!1,y=b=NaN}function I(){d&&(N(g,m),v&&x&&f.rejoin(),d.push(f.result())),C.point=_,x&&c.lineEnd()}function N(O,D){var L=i(O,D);if(h&&p.push([O,D]),w)g=O,m=D,v=L,w=!1,L&&(c.lineStart(),c.point(O,D));else if(L&&x)c.point(O,D);else{var W=[y=Math.max(Bk,Math.min(vx,y)),b=Math.max(Bk,Math.min(vx,b))],G=[O=Math.max(Bk,Math.min(vx,O)),D=Math.max(Bk,Math.min(vx,D))];Cnt(W,G,e,t,n,r)?(x||(c.lineStart(),c.point(W[0],W[1])),c.point(G[0],G[1]),L||c.lineEnd(),S=!1):L&&(c.lineStart(),c.point(O,D),S=!1)}y=O,b=D,x=L}return C}}function Ice(e,t,n){var r=Bo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[i,a]})}}function Nce(e,t,n){var r=Bo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[a,i]})}}function Ant(){var e,t,n,r,i,a,o,s,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Bo(wk(r/c)*c,n,c).map(p).concat(Bo(wk(s/f)*f,o,f).map(g)).concat(Bo(wk(t/u)*u,e,u).filter(function(b){return hn(b%c)>mt}).map(d)).concat(Bo(wk(a/l)*l,i,l).filter(function(b){return hn(b%f)>mt}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(s).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],o=+b[1][1],r>n&&(b=r,r=n,n=b),s>o&&(b=s,s=o,o=b),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],a=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),a>i&&(b=a,a=i,i=b),v.precision(m)):[[t,a],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=Ice(a,i,90),h=Nce(t,e,m),p=Ice(s,o,90),g=Nce(r,n,m),v):m},v.extentMajor([[-180,-90+mt],[180,90-mt]]).extentMinor([[-180,-80-mt],[180,80+mt]])}var yx=e=>e,m5=new Ia,v5=new Ia,Dce,Rce,y5,b5,Id={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Id.lineStart=knt,Id.lineEnd=Ont},polygonEnd:function(){Id.lineStart=Id.lineEnd=Id.point=zi,m5.add(hn(v5)),v5=new Ia},result:function(){var e=m5/2;return m5=new Ia,e}};function knt(){Id.point=Tnt}function Tnt(e,t){Id.point=Fce,Dce=y5=e,Rce=b5=t}function Fce(e,t){v5.add(b5*e-y5*t),y5=e,b5=t}function Ont(){Fce(Dce,Rce)}var Mce=Id,Gv=1/0,zk=Gv,bx=-Gv,jk=bx,Int={point:Nnt,lineStart:zi,lineEnd:zi,polygonStart:zi,polygonEnd:zi,result:function(){var e=[[Gv,zk],[bx,jk]];return bx=jk=-(zk=Gv=1/0),e}};function Nnt(e,t){e<Gv&&(Gv=e),e>bx&&(bx=e),t<zk&&(zk=t),t>jk&&(jk=t)}var Uk=Int,x5=0,w5=0,xx=0,Wk=0,Vk=0,Kv=0,_5=0,S5=0,wx=0,Pce,$ce,ml,vl,cu={point:Rp,lineStart:Lce,lineEnd:Bce,polygonStart:function(){cu.lineStart=Fnt,cu.lineEnd=Mnt},polygonEnd:function(){cu.point=Rp,cu.lineStart=Lce,cu.lineEnd=Bce},result:function(){var e=wx?[_5/wx,S5/wx]:Kv?[Wk/Kv,Vk/Kv]:xx?[x5/xx,w5/xx]:[NaN,NaN];return x5=w5=xx=Wk=Vk=Kv=_5=S5=wx=0,e}};function Rp(e,t){x5+=e,w5+=t,++xx}function Lce(){cu.point=Dnt}function Dnt(e,t){cu.point=Rnt,Rp(ml=e,vl=t)}function Rnt(e,t){var n=e-ml,r=t-vl,i=Fa(n*n+r*r);Wk+=i*(ml+e)/2,Vk+=i*(vl+t)/2,Kv+=i,Rp(ml=e,vl=t)}function Bce(){cu.point=Rp}function Fnt(){cu.point=Pnt}function Mnt(){zce(Pce,$ce)}function Pnt(e,t){cu.point=zce,Rp(Pce=ml=e,$ce=vl=t)}function zce(e,t){var n=e-ml,r=t-vl,i=Fa(n*n+r*r);Wk+=i*(ml+e)/2,Vk+=i*(vl+t)/2,Kv+=i,i=vl*e-ml*t,_5+=i*(ml+e),S5+=i*(vl+t),wx+=i*3,Rp(ml=e,vl=t)}var jce=cu;function Uce(e){this._context=e}Uce.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ra);break}}},result:zi};var E5=new Ia,C5,Wce,Vce,_x,Sx,qk={point:zi,lineStart:function(){qk.point=$nt},lineEnd:function(){C5&&qce(Wce,Vce),qk.point=zi},polygonStart:function(){C5=!0},polygonEnd:function(){C5=null},result:function(){var e=+E5;return E5=new Ia,e}};function $nt(e,t){qk.point=qce,Wce=_x=e,Vce=Sx=t}function qce(e,t){_x-=e,Sx-=t,E5.add(Fa(_x*_x+Sx*Sx)),_x=e,Sx=t}var Hce=qk;function Gce(){this._string=[]}Gce.prototype={_radius:4.5,_circle:Kce(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Kce(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Kce(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Xce(e,t){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Tc(o,r(i))),i.result()}return a.area=function(o){return Tc(o,r(Mce)),Mce.result()},a.measure=function(o){return Tc(o,r(Hce)),Hce.result()},a.bounds=function(o){return Tc(o,r(Uk)),Uk.result()},a.centroid=function(o){return Tc(o,r(jce)),jce.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,yx):(e=o).stream,a):e},a.context=function(o){return arguments.length?(i=o==null?(t=null,new Gce):new Uce(t=o),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(e).context(t)}function Hk(e){return function(t){var n=new A5;for(var r in e)n[r]=e[r];return n.stream=t,n}}function A5(){}A5.prototype={constructor:A5,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function k5(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Tc(n,e.stream(Uk)),t(Uk.result()),r!=null&&e.clipExtent(r),e}function Gk(e,t,n){return k5(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,u])},n)}function T5(e,t,n){return Gk(e,[[0,0],t],n)}function O5(e,t,n){return k5(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function I5(e,t,n){return k5(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var Yce=16,Lnt=yt(30*Kt);function Zce(e,t){return+t?znt(e,t):Bnt(e)}function Bnt(e){return Hk({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function znt(e,t){function n(r,i,a,o,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=o+d,w=s+h,S=u+p,C=Fa(x*x+w*w+S*S),_=co(S/=C),E=hn(hn(S)-1)<mt||hn(a-f)<mt?(a+f)/2:gs(w,x),A=e(E,_),k=A[0],T=A[1],I=k-r,N=T-i,O=y*I-v*N;(O*O/b>t||hn((v*I+y*N)/b-.5)>.3||o*d+s*h+u*p<Lnt)&&(n(r,i,a,o,s,u,k,T,E,x/=C,w/=C,S,g,m),m.point(k,T),n(k,T,E,x,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,a,o,s,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,E){_=e(_,E),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,E){var A=Np([_,E]),k=e(_,E);n(f,d,c,h,p,g,f=k[0],d=k[1],c=_,h=A[0],p=A[1],g=A[2],Yce,r),r.point(f,d)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=S,m.lineEnd=C}function S(_,E){b(i=_,E),a=f,o=d,s=h,u=p,l=g,m.point=b}function C(){n(f,d,c,h,p,g,a,o,i,s,u,l,Yce,r),m.lineEnd=x,x()}return m}}var jnt=Hk({point:function(e,t){this.stream.point(e*Kt,t*Kt)}});function Unt(e){return Hk({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Wnt(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function Jce(e,t,n,r,i,a){if(!a)return Wnt(e,t,n,r,i);var o=yt(a),s=ct(a),u=o*e,l=s*e,c=o/e,f=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function yl(e){return Qce(function(){return e})()}function Qce(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=Tce,m=null,v,y,b,x=yx,w=.5,S,C,_,E,A;function k(O){return _(O[0]*Kt,O[1]*Kt)}function T(O){return O=_.invert(O[0],O[1]),O&&[O[0]*Lr,O[1]*Lr]}k.stream=function(O){return E&&A===O?E:E=jnt(Unt(c)(g(S(x(A=O)))))},k.preclip=function(O){return arguments.length?(g=O,p=void 0,N()):g},k.postclip=function(O){return arguments.length?(x=O,m=v=y=b=null,N()):x},k.clipAngle=function(O){return arguments.length?(g=+O?Ent(p=O*Kt):(p=null,Tce),N()):p*Lr},k.clipExtent=function(O){return arguments.length?(x=O==null?(m=v=y=b=null,yx):Oce(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),N()):m==null?null:[[m,v],[y,b]]},k.scale=function(O){return arguments.length?(n=+O,I()):n},k.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],I()):[r,i]},k.center=function(O){return arguments.length?(a=O[0]%360*Kt,o=O[1]%360*Kt,I()):[a*Lr,o*Lr]},k.rotate=function(O){return arguments.length?(s=O[0]%360*Kt,u=O[1]%360*Kt,l=O.length>2?O[2]%360*Kt:0,I()):[s*Lr,u*Lr,l*Lr]},k.angle=function(O){return arguments.length?(f=O%360*Kt,I()):f*Lr},k.reflectX=function(O){return arguments.length?(d=O?-1:1,I()):d<0},k.reflectY=function(O){return arguments.length?(h=O?-1:1,I()):h<0},k.precision=function(O){return arguments.length?(S=Zce(C,w=O*O),N()):Fa(w)},k.fitExtent=function(O,D){return Gk(k,O,D)},k.fitSize=function(O,D){return T5(k,O,D)},k.fitWidth=function(O,D){return O5(k,O,D)},k.fitHeight=function(O,D){return I5(k,O,D)};function I(){var O=Jce(n,0,0,d,h,f).apply(null,t(a,o)),D=Jce(n,r-O[0],i-O[1],d,h,f);return c=bce(s,u,l),C=h5(t,D),_=h5(c,C),S=Zce(C,w),N()}function N(){return E=A=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&T,I()}}function N5(e){var t=0,n=Gt/3,r=Qce(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*Kt,n=a[1]*Kt):[t*Lr,n*Lr]},i}function Vnt(e){var t=yt(e);function n(r,i){return[r*t,ct(i)/t]}return n.invert=function(r,i){return[r/t,co(i*t)]},n}function qnt(e,t){var n=ct(e),r=(n+ct(t))/2;if(hn(r)<mt)return Vnt(e);var i=1+n*(2*r-n),a=Fa(i)/r;function o(s,u){var l=Fa(i-2*r*ct(u))/r;return[l*ct(s*=r),a-l*yt(s)]}return o.invert=function(s,u){var l=a-u,c=gs(s,hn(l))*ms(l);return l*r<0&&(c-=Gt*ms(s)*ms(l)),[c/r,co((i-(s*s+l*l)*r*r)/(2*r))]},o}function Kk(){return N5(qnt).scale(155.424).center([0,33.6442])}function efe(){return Kk().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Hnt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Gnt(){var e,t,n=efe(),r,i=Kk().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=Kk().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(a.point(h,p),u)||(s.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Hnt([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),a=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+mt,g+.12*h+mt],[p-.214*h-mt,g+.234*h-mt]]).stream(l),s=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+mt,g+.166*h+mt],[p-.115*h-mt,g+.234*h-mt]]).stream(l),f()},c.fitExtent=function(d,h){return Gk(c,d,h)},c.fitSize=function(d,h){return T5(c,d,h)},c.fitWidth=function(d,h){return O5(c,d,h)},c.fitHeight=function(d,h){return I5(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function tfe(e){return function(t,n){var r=yt(t),i=yt(n),a=e(r*i);return a===1/0?[2,0]:[a*i*ct(t),a*ct(n)]}}function Ex(e){return function(t,n){var r=Fa(t*t+n*n),i=e(r),a=ct(i),o=yt(i);return[gs(t*a,r*o),co(r&&n*a/r)]}}var nfe=tfe(function(e){return Fa(2/(1+e))});nfe.invert=Ex(function(e){return 2*co(e/2)});function Knt(){return yl(nfe).scale(124.75).clipAngle(180-.001)}var rfe=tfe(function(e){return(e=ece(e))&&e/ct(e)});rfe.invert=Ex(function(e){return e});function Xnt(){return yl(rfe).scale(79.4188).clipAngle(180-.001)}function Xk(e,t){return[e,_k(n5((Or+t)/2))]}Xk.invert=function(e,t){return[e,2*Vv(Qle(t))-Or]};function Ynt(){return ife(Xk).scale(961/Ra)}function ife(e){var t=yl(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=s=u=l=null:(o=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,s],[u,l]]};function c(){var f=Gt*r(),d=t(mnt(t.rotate()).invert([0,0]));return a(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Xk?[[Math.max(d[0]-f,o),s],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function Yk(e){return n5((Or+e)/2)}function Znt(e,t){var n=yt(e),r=e===t?ct(e):_k(n/yt(t))/_k(Yk(t)/Yk(e)),i=n*t5(Yk(e),r)/r;if(!r)return Xk;function a(o,s){i>0?s<-Or+mt&&(s=-Or+mt):s>Or-mt&&(s=Or-mt);var u=i/t5(Yk(s),r);return[u*ct(r*o),i-u*yt(r*o)]}return a.invert=function(o,s){var u=i-s,l=ms(r)*Fa(o*o+u*u),c=gs(o,hn(u))*ms(u);return u*r<0&&(c-=Gt*ms(o)*ms(u)),[c/r,2*Vv(t5(i/l,1/r))-Or]},a}function Jnt(){return N5(Znt).scale(109.5).parallels([30,30])}function Zk(e,t){return[e,t]}Zk.invert=Zk;function Qnt(){return yl(Zk).scale(152.63)}function ert(e,t){var n=yt(e),r=e===t?ct(e):(n-yt(t))/(t-e),i=n/r+e;if(hn(r)<mt)return Zk;function a(o,s){var u=i-s,l=r*o;return[u*ct(l),i-u*yt(l)]}return a.invert=function(o,s){var u=i-s,l=gs(o,hn(u))*ms(u);return u*r<0&&(l-=Gt*ms(o)*ms(u)),[l/r,i-ms(r)*Fa(o*o+u*u)]},a}function trt(){return N5(ert).scale(131.154).center([0,13.9389])}var Cx=1.340264,Ax=-.081106,kx=893e-6,Tx=.003796,Jk=Fa(3)/2,nrt=12;function afe(e,t){var n=co(Jk*ct(t)),r=n*n,i=r*r*r;return[e*yt(n)/(Jk*(Cx+3*Ax*r+i*(7*kx+9*Tx*r))),n*(Cx+Ax*r+i*(kx+Tx*r))]}afe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,u;a<nrt&&(s=n*(Cx+Ax*r+i*(kx+Tx*r))-t,u=Cx+3*Ax*r+i*(7*kx+9*Tx*r),n-=o=s/u,r=n*n,i=r*r*r,!(hn(o)<bk));++a);return[Jk*e*(Cx+3*Ax*r+i*(7*kx+9*Tx*r))/yt(n),co(ct(n)/Jk)]};function rrt(){return yl(afe).scale(177.158)}function ofe(e,t){var n=yt(t),r=yt(e)*n;return[n*ct(e)/r,ct(t)/r]}ofe.invert=Ex(Vv);function irt(){return yl(ofe).scale(144.049).clipAngle(60)}function art(){var e=1,t=0,n=0,r=1,i=1,a=0,o,s,u=null,l,c,f,d=1,h=1,p=Hk({point:function(x,w){var S=b([x,w]);this.stream.point(S[0],S[1])}}),g=yx,m,v;function y(){return d=e*r,h=e*i,m=v=null,b}function b(x){var w=x[0]*d,S=x[1]*h;if(a){var C=S*o-w*s;w=w*o+S*s,S=C}return[w+t,S+n]}return b.invert=function(x){var w=x[0]-t,S=x[1]-n;if(a){var C=S*o+w*s;w=w*o-S*s,S=C}return[w/d,S/h]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,yx):Oce(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(a=x%360*Kt,s=ct(a),o=yt(a),y()):a*Lr},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return Gk(b,x,w)},b.fitSize=function(x,w){return T5(b,x,w)},b.fitWidth=function(x,w){return O5(b,x,w)},b.fitHeight=function(x,w){return I5(b,x,w)},b}function sfe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}sfe.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(hn(i)>mt&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function ort(){return yl(sfe).scale(175.295)}function ufe(e,t){return[yt(t)*ct(e),ct(t)]}ufe.invert=Ex(co);function srt(){return yl(ufe).scale(249.5).clipAngle(90+mt)}function lfe(e,t){var n=yt(t),r=1+yt(e)*n;return[n*ct(e)/r,ct(t)/r]}lfe.invert=Ex(function(e){return 2*Vv(e)});function urt(){return yl(lfe).scale(250).clipAngle(142)}function cfe(e,t){return[_k(n5((Or+t)/2)),-e]}cfe.invert=function(e,t){return[-t,2*Vv(Qle(e))-Or]};function lrt(){var e=ife(cfe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var crt=Math.abs,D5=Math.cos,Qk=Math.sin,frt=1e-6,ffe=Math.PI,R5=ffe/2,dfe=drt(2);function hfe(e){return e>1?R5:e<-1?-R5:Math.asin(e)}function drt(e){return e>0?Math.sqrt(e):0}function hrt(e,t){var n=e*Qk(t),r=30,i;do t-=i=(t+Qk(t)-n)/(1+D5(t));while(crt(i)>frt&&--r>0);return t/2}function prt(e,t,n){function r(i,a){return[e*i*D5(a=hrt(n,a)),t*Qk(a)]}return r.invert=function(i,a){return a=hfe(a/t),[i/(e*D5(a)),hfe((2*a+Qk(2*a))/n)]},r}var grt=prt(dfe/R5,dfe,ffe);function mrt(){return yl(grt).scale(169.529)}const vrt=Xce(),F5=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function yrt(e,t){return function n(){const r=t();return r.type=e,r.path=Xce().projection(r),r.copy=r.copy||function(){const i=n();return F5.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function M5(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(eT[e]=yrt(e,t),this):eT[e]||null}function pfe(e){return e&&e.path||vrt}const eT={albers:efe,albersusa:Gnt,azimuthalequalarea:Knt,azimuthalequidistant:Xnt,conicconformal:Jnt,conicequalarea:Kk,conicequidistant:trt,equalEarth:rrt,equirectangular:Qnt,gnomonic:irt,identity:art,mercator:Ynt,mollweide:mrt,naturalEarth1:ort,orthographic:srt,stereographic:urt,transversemercator:lrt};for(const e in eT)M5(e,eT[e]);function brt(){}const Nc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function gfe(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return a(u,l,d=>{n(d,u,l),xrt(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(wrt((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function a(u,l,c){var f=new Array,d=new Array,h,p,g,m,v,y;for(h=p=-1,m=u[0]>=l,Nc[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,Nc[g|m<<1].forEach(b);for(Nc[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,v=u[p*e]>=l,Nc[m<<1|v<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,y=v,v=u[p*e+h+1]>=l,Nc[g|m<<1|v<<2|y<<3].forEach(b);Nc[m|v<<3].forEach(b)}for(h=-1,v=u[p*e]>=l,Nc[v<<2].forEach(b);++h<e-1;)y=v,v=u[p*e+h+1]>=l,Nc[v<<2|y<<3].forEach(b);Nc[v<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],S=[x[1][0]+h,x[1][1]+p],C=o(w),_=o(S),E,A;(E=d[C])?(A=f[_])?(delete d[E.end],delete f[A.start],E===A?(E.ring.push(S),c(E.ring)):f[E.start]=d[A.end]={start:E.start,end:A.end,ring:E.ring.concat(A.ring)}):(delete d[E.end],E.ring.push(S),d[E.end=_]=E):(E=f[_])?(A=d[C])?(delete f[E.start],delete d[A.end],E===A?(E.ring.push(S),c(E.ring)):f[A.start]=d[E.end]={start:A.start,end:E.end,ring:A.ring.concat(E.ring)}):(delete f[E.start],E.ring.unshift(w),f[E.start=C]=E):f[C]=d[_]={start:C,end:_,ring:[w,S]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,v=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(v-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||Se("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:brt,r):n===s},r}function xrt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function wrt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=_rt(e,t[n]))return i;return 0}function _rt(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var u=e[a],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(Srt(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function Srt(e,t,n){var r;return Ert(e,t,n)&&Crt(e[r=+(e[0]===t[0])],n[r],t[r])}function Ert(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function Crt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function mfe(e,t,n){return function(r){var i=tl(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=t?ed(a,o,e):s/(e+1);return Bo(a+u,o,u)}}function P5(e){ve.call(this,null,e)}P5.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},$e(P5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Oa,a=gfe().smooth(e.smooth!==!1),o=e.thresholds||Art(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=a.size([c.width,c.height])(c.values,ut(o)?o:o(c.values));krt(f,c,l,e),f.forEach(d=>{u.push(QC(l,In(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Art(e,t,n){const r=mfe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>cp(t(i).values)))}function krt(e,t,n,r){let i=r.scale||t.scale,a=r.translate||t.translate;if(Lt(i)&&(i=i(n,r)),Lt(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(Jf(i)?i:i[0])||1,s=(Jf(i)?i:i[1])||1,u=a&&a[0]||0,l=a&&a[1]||0;e.forEach(vfe(t,o,s,u,l))}function vfe(e,t,n,r,i){const a=e.x1||0,o=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-a)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function yfe(e,t,n){const r=e>=0?e:aL(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function $5(e){return Lt(e)?e:Ji(+e)}function bfe(){var e=u=>u[0],t=u=>u[1],n=lv,r=[-1,-1],i=960,a=500,o=2;function s(u,l){const c=yfe(r[0],u,e)>>o,f=yfe(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),g=2*h+(a>>o),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(x=>{const w=d+(+e(x)>>o),S=h+(+t(x)>>o);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(x))}),c>0&&f>0?(Xv(p,g,m,v,c),Yv(p,g,v,m,f),Xv(p,g,m,v,c),Yv(p,g,v,m,f),Xv(p,g,m,v,c),Yv(p,g,v,m,f)):c>0?(Xv(p,g,m,v,c),Xv(p,g,v,m,c),Xv(p,g,m,v,c),y=v):f>0&&(Yv(p,g,m,v,f),Yv(p,g,v,m,f),Yv(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*o):1/kre(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(i>>o),y2:h+(a>>o)}}return s.x=function(u){return arguments.length?(e=$5(u),s):e},s.y=function(u){return arguments.length?(t=$5(u),s):t},s.weight=function(u){return arguments.length?(n=$5(u),s):n},s.size=function(u){if(!arguments.length)return[i,a];var l=+u[0],c=+u[1];return l>=0&&c>=0||Se("invalid size"),i=l,a=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||Se("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),s):1<<o},s.bandwidth=function(u){return arguments.length?(u=wt(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&Se("invalid bandwidth"),r=u,s):r},s}function Xv(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+o*e]),s>=i&&(s>=a&&(u-=n[s-a+o*e]),r[s-i+o*e]=u/Math.min(s+1,e-1+a-s,a))}function Yv(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[o+s*e]),s>=i&&(s>=a&&(u-=n[o+(s-a)*e]),r[o+(s-i)*e]=u/Math.min(s+1,t-1+a-s,a))}function L5(e){ve.call(this,null,e)}L5.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Trt=["x","y","weight","size","cellSize","bandwidth"];function xfe(e,t){return Trt.forEach(n=>t[n]!=null?e[n](t[n]):0),e}$e(L5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Ort(r,e.groupby),a=(e.groupby||[]).map(Tr),o=xfe(bfe(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<a.length;++d)c[a[d]]=f[d];return c}return u=i.map(c=>In(l({[s]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Ort(e,t){var n=[],r=c=>c(s),i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function B5(e){ve.call(this,null,e)}B5.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},$e(B5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=gfe().smooth(e.smooth!==!1),i=e.values,a=e.thresholds||mfe(e.count||10,e.nice,!!i),o=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=xfe(bfe(),e)(i,!0),u=vfe(s,s.scale||1,s.scale||1,0,0),o=[s.width,s.height],i=s.values),a=ut(a)?a:a(i),i=r.size(o)(i,a),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(In),n}});const z5="Feature",j5="FeatureCollection",Irt="MultiPoint";function U5(e){ve.call(this,null,e)}U5.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},$e(U5,ve,{transform(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],s=e.geojson||!i&&Oa,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Yi(s))||a&&t.modified(Yi(a))||o&&t.modified(Yi(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),a&&o&&(t.visit(u,c=>{var f=a(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:z5,geometry:{type:Irt,coordinates:r}})),this.value={type:j5,features:n}}});function W5(e){ve.call(this,null,e)}W5.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},$e(W5,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Oa,a=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=pfe(e.projection),n.materialize().reflow()):o=i===Oa||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=Nrt(r,e.pointRadius);return n.visit(o,u=>u[a]=r(i(u))),r.pointRadius(s),n.modifies(a)}});function Nrt(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function V5(e){ve.call(this,null,e)}V5.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},$e(V5,ve,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],s=a[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[s]=f[1]):(c[o]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(a)}});function q5(e){ve.call(this,null,e)}q5.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},$e(q5,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;return(!r||e.modified())&&(this.value=r=Drt(pfe(e.projection),e.field||io("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function Drt(e,t,n){const r=n==null?i=>e(t(i)):i=>{var a=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(a),o};return r.context=i=>(e.context(i),r),r}function H5(e){ve.call(this,[],e),this.generator=Ant()}H5.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},$e(H5,ve,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const a in e)Lt(r[a])&&r[a](e[a]);return i=r(),n.length?t.mod.push(Pie(n[0],i)):t.add.push(In(i)),n[0]=i,t}});function G5(e){ve.call(this,null,e)}G5.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},$e(G5,ve,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||Oa,a=Frt(e.opacity,e),o=Rrt(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?cp(n.map(l=>cp(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Rt({},l,u);r||(f.$max=cp(c.values||[])),l[s]=Mrt(c,f,o.dep?o:Ji(o(f)),a.dep?a:Ji(a(f)))}),t.reflow(!0).modifies(s)}});function Rrt(e,t){let n;return Lt(e)?(n=r=>hd(e(r,t)),n.dep=wfe(e)):n=Ji(hd(e||"#888")),n}function Frt(e,t){let n;return Lt(e)?(n=r=>e(r,t),n.dep=wfe(e)):e?n=Ji(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function wfe(e){if(!Lt(e))return!1;const t=tu(Yi(e));return t.$x||t.$y||t.$value||t.$max}function Mrt(e,t,n,r){const i=e.width,a=e.height,o=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||a,c=e.values,f=c?m=>c[m]:Xf,d=Ev(u-o,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-s),g=p.data;for(let m=s,v=0;m<l;++m){t.$y=m-s;for(let y=o,b=m*i;y<u;++y,v+=4){t.$x=y-o,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function _fe(e){ve.call(this,null,e),this.modified(!0)}$e(_fe,ve,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=$rt(e.type),F5.forEach(r=>{e[r]!=null&&Sfe(n,r,e[r])})):F5.forEach(r=>{e.modified(r)&&Sfe(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Prt(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Prt(e,t){const n=Lrt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function $rt(e){const t=M5((e||"mercator").toLowerCase());return t||Se("Unrecognized projection type: "+e),t()}function Sfe(e,t,n){Lt(e[t])&&e[t](n)}function Lrt(e){return e=wt(e),e.length===1?e[0]:{type:j5,features:e.reduce((t,n)=>t.concat(Brt(n)),[])}}function Brt(e){return e.type===j5?e.features:wt(e).filter(t=>t!=null).map(t=>t.type===z5?t:{type:z5,geometry:t})}var zrt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:B5,geojson:U5,geopath:W5,geopoint:V5,geoshape:q5,graticule:H5,heatmap:G5,isocontour:P5,kde2d:L5,projection:_fe});function jrt(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,u=0,l=0;for(a=0;a<o;++a)s=n[a],u+=s.x,l+=s.y;for(u=(u/o-e)*r,l=(l/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=u,s.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Urt(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Efe(this.cover(t,n),t,n,e)}function Efe(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,v,y;if(!a)return e._root=o,e;for(;a.length;)if((g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,e;if(h=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===h&&n===p)return o.next=a,i?i[v]=o:e._root=o,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=a,i[v]=o,e}function Wrt(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>f&&(f=a));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)Efe(this,o[n],s[n],e[n]);return this}function Vrt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function qrt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Hrt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function La(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Grt(e,t,n){var r,i=this._x0,a=this._y0,o,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new La(h,i,a,c,f)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(u=p.x1)<i||(l=p.y1)<a))if(h.length){var m=(o+u)/2,v=(s+l)/2;d.push(new La(h[3],m,v,u,l),new La(h[2],o,v,m,l),new La(h[1],m,s,u,v),new La(h[0],o,s,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,a=t-w,c=e+w,f=t+w,r=h.data}}return r}function Krt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function Xrt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Yrt(){return this._root}function Zrt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Jrt(e){var t=[],n,r=this._root,i,a,o,s,u;for(r&&t.push(new La(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(a+s)/2,c=(o+u)/2;(i=r[3])&&t.push(new La(i,l,c,s,u)),(i=r[2])&&t.push(new La(i,a,c,l,u)),(i=r[1])&&t.push(new La(i,l,o,s,c)),(i=r[0])&&t.push(new La(i,a,o,l,c))}return this}function Qrt(e){var t=[],n=[],r;for(this._root&&t.push(new La(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(s+l)/2;(a=i[0])&&t.push(new La(a,o,s,c,f)),(a=i[1])&&t.push(new La(a,c,s,u,f)),(a=i[2])&&t.push(new La(a,o,f,c,l)),(a=i[3])&&t.push(new La(a,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function eit(e){return e[0]}function tit(e){return arguments.length?(this._x=e,this):this._x}function nit(e){return e[1]}function rit(e){return arguments.length?(this._y=e,this):this._y}function K5(e,t,n){var r=new X5(t??eit,n??nit,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function X5(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Cfe(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ba=K5.prototype=X5.prototype;Ba.copy=function(){var e=new X5(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Cfe(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Cfe(r));return e},Ba.add=Urt,Ba.addAll=Wrt,Ba.cover=Vrt,Ba.data=qrt,Ba.extent=Hrt,Ba.find=Grt,Ba.remove=Krt,Ba.removeAll=Xrt,Ba.root=Yrt,Ba.size=Zrt,Ba.visit=Jrt,Ba.visitAfter=Qrt,Ba.x=tit,Ba.y=rit;function za(e){return function(){return e}}function Nd(e){return(e()-.5)*1e-6}function iit(e){return e.x+e.vx}function ait(e){return e.y+e.vy}function oit(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=za(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,v=0;v<a;++v)for(f=K5(t,iit,ait).visitAfter(s),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,x,w,S,C){var _=b.data,E=b.r,A=g+E;if(_){if(_.index>d.index){var k=h-_.x-_.vx,T=p-_.y-_.vy,I=k*k+T*T;I<A*A&&(k===0&&(k=Nd(r),I+=k*k),T===0&&(T=Nd(r),I+=T*T),I=(A-(I=Math.sqrt(I)))/I*i,d.vx+=(k*=I)*(A=(E*=E)/(m+E)),d.vy+=(T*=I)*A,_.vx-=k*(A=1-A),_.vy-=T*A)}return}return x>h+A||S<h-A||w>p+A||C<p-A}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:za(+l),u(),o):e},o}function sit(e){return e.index}function Afe(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function uit(e){var t=sit,n=f,r,i=za(30),a,o,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,S,C,_,E,A;b<y;++b)x=e[b],w=x.source,S=x.target,C=S.x+S.vx-w.x-w.vx||Nd(l),_=S.y+S.vy-w.y-w.vy||Nd(l),E=Math.sqrt(C*C+_*_),E=(E-a[b])/E*m*r[b],C*=E,_*=E,S.vx-=C*(A=u[b]),S.vy-=_*A,w.vx+=C*(A=1-A),w.vy+=_*A}function h(){if(!!o){var m,v=o.length,y=e.length,b=new Map(o.map((w,S)=>[t(w,S,o),w])),x;for(m=0,s=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=Afe(b,x.source)),typeof x.target!="object"&&(x.target=Afe(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(!!o)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!o)for(var m=0,v=e.length;m<v;++m)a[m]=+i(e[m],m,e)}return d.initialize=function(m,v){o=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:za(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:za(+m),g(),d):i},d}var lit={value:()=>{}};function kfe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new tT(n)}function tT(e){this._=e}function cit(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}tT.prototype=kfe.prototype={constructor:tT,on:function(e,t){var n=this._,r=cit(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=fit(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=Tfe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Tfe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new tT(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function fit(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Tfe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=lit,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Zv=0,Ox=0,Ix=0,Ofe=1e3,nT,Nx,rT=0,Fp=0,iT=0,Dx=typeof performance=="object"&&performance.now?performance:Date,Ife=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Y5(){return Fp||(Ife(dit),Fp=Dx.now()+iT)}function dit(){Fp=0}function aT(){this._call=this._time=this._next=null}aT.prototype=Nfe.prototype={constructor:aT,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Y5():+n)+(t==null?0:+t),!this._next&&Nx!==this&&(Nx?Nx._next=this:nT=this,Nx=this),this._call=e,this._time=n,Z5()},stop:function(){this._call&&(this._call=null,this._time=1/0,Z5())}};function Nfe(e,t,n){var r=new aT;return r.restart(e,t,n),r}function hit(){Y5(),++Zv;for(var e=nT,t;e;)(t=Fp-e._time)>=0&&e._call.call(null,t),e=e._next;--Zv}function Dfe(){Fp=(rT=Dx.now())+iT,Zv=Ox=0;try{hit()}finally{Zv=0,git(),Fp=0}}function pit(){var e=Dx.now(),t=e-rT;t>Ofe&&(iT-=t,rT=e)}function git(){for(var e,t=nT,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:nT=n);Nx=e,Z5(r)}function Z5(e){if(!Zv){Ox&&(Ox=clearTimeout(Ox));var t=e-Fp;t>24?(e<1/0&&(Ox=setTimeout(Dfe,e-Dx.now()-iT)),Ix&&(Ix=clearInterval(Ix))):(Ix||(rT=Dx.now(),Ix=setInterval(pit,Ofe)),Zv=1,Ife(Dfe))}}function mit(e,t,n){var r=new aT,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(a,o,s){o=+o,s=s==null?Y5():+s,r._restart(function u(l){l+=i,r._restart(u,i+=o,s),a(l)},o,s)},r.restart(e,t,n),r)}const vit=1664525,yit=1013904223,Rfe=4294967296;function bit(){let e=1;return()=>(e=(vit*e+yit)%Rfe)/Rfe}function xit(e){return e.x}function wit(e){return e.y}var _it=10,Sit=Math.PI*(3-Math.sqrt(5));function Eit(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=Nfe(f),l=kfe("tick","end"),c=bit();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(a-n)*i,s.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=_it*Math.sqrt(.5+g),b=g*Sit;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(a=+g,t):a},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,s.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?s.delete(g):s.set(g,p(m)),t):s.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,S,C,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)C=e[y],x=g-C.x,w=m-C.y,S=x*x+w*w,S<v&&(_=C,v=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function Cit(){var e,t,n,r,i=za(-30),a,o=1,s=1/0,u=.81;function l(h){var p,g=e.length,m=K5(e,xit,wit).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(a=new Array(p),h=0;h<p;++h)g=e[h],a[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,v=0,y,b,x;if(h.length){for(y=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,x=v*v+y*y;if(b*b/u<x)return x<s&&(v===0&&(v=Nd(n),x+=v*v),y===0&&(y=Nd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)),t.vx+=v*h.value*r/x,t.vy+=y*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(v===0&&(v=Nd(n),x+=v*v),y===0&&(y=Nd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=a[h.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:za(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Ait(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}function kit(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}const Ffe={center:jrt,collide:oit,nbody:Cit,link:uit,x:Ait,y:kit},Rx="forces",J5=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Tit=["static","iterations"],Mfe=["x","y","vx","vy"];function Q5(e){ve.call(this,null,e)}Q5.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Mfe}]},$e(Q5,ve,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(J5),a=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&Pfe(n,e,0,t)):(this.value=n=Iit(t.source,e),n.on("tick",Oit(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Tit)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==Rx||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(Mfe)}});function Oit(e,t){return()=>e.touch(t).run()}function Iit(e,t){const n=Eit(e),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),Pfe(n,t,!0).on("end",()=>a=!0)}function Pfe(e,t,n,r){var i=wt(t.forces),a,o,s,u;for(a=0,o=J5.length;a<o;++a)s=J5[a],s!==Rx&&t.modified(s)&&e[s](t[s]);for(a=0,o=i.length;a<o;++a)u=Rx+a,s=n||t.modified(Rx,a)?Dit(i[a]):r&&Nit(i[a],r)?e.force(u):null,s&&e.force(u,s);for(o=e.numForces||0;a<o;++a)e.force(Rx+a,null);return e.numForces=i.length,e}function Nit(e,t){var n,r;for(n in e)if(Lt(r=e[n])&&t.modified(Yi(r)))return 1;return 0}function Dit(e){var t,n;_t(Ffe,e.force)||Se("Unrecognized force: "+e.force),t=Ffe[e.force]();for(n in e)Lt(t[n])&&Rit(t[n],e[n],e);return t}function Rit(e,t,n){e(Lt(t)?r=>t(r,n):t)}var Fit=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Q5});function Mit(e,t){return e.parent===t.parent?1:2}function Pit(e){return e.reduce($it,0)/e.length}function $it(e,t){return e+t.x}function Lit(e){return 1+e.reduce(Bit,0)}function Bit(e,t){return Math.max(e,t.y)}function zit(e){for(var t;t=e.children;)e=t[0];return e}function jit(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Uit(){var e=Mit,t=1,n=1,r=!1;function i(a){var o,s=0;a.eachAfter(function(d){var h=d.children;h?(d.x=Pit(h),d.y=Lit(h)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var u=zit(a),l=jit(a),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return a.eachAfter(r?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],i):r?null:[t,n]},i.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],i):r?[t,n]:null},i}function Wit(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Vit(){return this.eachAfter(Wit)}function qit(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Hit(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function Git(e,t){for(var n=this,r=[n],i=[],a,o,s,u=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function Kit(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Xit(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Yit(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Zit(e){for(var t=this,n=Jit(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Jit(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Qit(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function eat(){return Array.from(this)}function tat(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function nat(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*rat(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function e6(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=oat)):t===void 0&&(t=aat);for(var n=new Jv(e),r,i=[n],a,o,s,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new Jv(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore($fe)}function iat(){return e6(this).eachBefore(sat)}function aat(e){return e.children}function oat(e){return Array.isArray(e)?e[1]:null}function sat(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function $fe(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Jv(e){this.data=e,this.depth=this.height=0,this.parent=null}Jv.prototype=e6.prototype={constructor:Jv,count:Vit,each:qit,eachAfter:Git,eachBefore:Hit,find:Kit,sum:Xit,sort:Yit,path:Zit,ancestors:Qit,descendants:eat,leaves:tat,links:nat,copy:iat,[Symbol.iterator]:rat};function uat(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function lat(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function cat(e){for(var t=0,n=(e=lat(Array.from(e))).length,r=[],i,a;t<n;)i=e[t],a&&Lfe(a,i)?++t:(a=dat(r=fat(r,i)),t=0);return a}function fat(e,t){var n,r;if(t6(t,e))return[t];for(n=0;n<e.length;++n)if(oT(t,e[n])&&t6(Fx(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(oT(Fx(e[n],e[r]),t)&&oT(Fx(e[n],t),e[r])&&oT(Fx(e[r],t),e[n])&&t6(Bfe(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function oT(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function Lfe(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function t6(e,t){for(var n=0;n<t.length;++n)if(!Lfe(e,t[n]))return!1;return!0}function dat(e){switch(e.length){case 1:return hat(e[0]);case 2:return Fx(e[0],e[1]);case 3:return Bfe(e[0],e[1],e[2])}}function hat(e){return{x:e.x,y:e.y,r:e.r}}function Fx(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,u=a-n,l=o-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+a+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+s)/2}}function Bfe(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-s,g=i-c,m=u-a,v=f-a,y=r*r+i*i-a*a,b=y-o*o-s*s+u*u,x=y-l*l-c*c+f*f,w=h*p-d*g,S=(p*x-g*b)/(w*2)-r,C=(g*m-p*v)/w,_=(h*b-d*x)/(w*2)-i,E=(d*v-h*m)/w,A=C*C+E*E-1,k=2*(a+S*C+_*E),T=S*S+_*_-a*a,I=-(A?(k+Math.sqrt(k*k-4*A*T))/(2*A):T/k);return{x:r+S+C*I,y:i+_+E*I,r:I}}function zfe(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,s,u,l=r*r+o*o;l?(a=t.r+n.r,a*=a,u=e.r+n.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*o,n.y=e.y-i*o+s*r):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x+i*r-s*o,n.y=t.y+i*o+s*r)):(n.x=t.x+n.r,n.y=t.y)}function jfe(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Ufe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function sT(e){this._=e,this.next=null,this.previous=null}function pat(e){if(!(i=(e=uat(e)).length))return 0;var t,n,r,i,a,o,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;zfe(n,t,r=e[2]),t=new sT(t),n=new sT(n),r=new sT(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){zfe(t._,n._,r=e[s]),r=new sT(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(jfe(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(jfe(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,a=Ufe(t);(r=r.next)!==n;)(o=Ufe(r))<a&&(t=r,a=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=cat(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function gat(e){return e==null?null:uT(e)}function uT(e){if(typeof e!="function")throw new Error;return e}function Mp(){return 0}function Qv(e){return function(){return e}}function mat(e){return Math.sqrt(e.value)}function vat(){var e=null,t=1,n=1,r=Mp;function i(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(Wfe(e)).eachAfter(n6(r,.5)).eachBefore(Vfe(1)):a.eachBefore(Wfe(mat)).eachAfter(n6(Mp,1)).eachAfter(n6(r,a.r/Math.min(t,n))).eachBefore(Vfe(Math.min(t,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=gat(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],n=+a[1],i):[t,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:Qv(+a),i):r},i}function Wfe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function n6(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,s;if(o)for(i=0;i<a;++i)r[i].r+=o;if(s=pat(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=s+o}}}function Vfe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function qfe(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Mx(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)o=a[s],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function yat(){var e=1,t=1,n=0,r=!1;function i(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),r&&o.eachBefore(qfe),o}function a(o,s){return function(u){u.children&&Mx(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var bat={depth:-1},Hfe={};function xat(e){return e.id}function wat(e){return e.parentId}function Gfe(){var e=xat,t=wat;function n(r){var i=Array.from(r),a=i.length,o,s,u,l,c,f,d,h=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new Jv(o),(f=e(o,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Hfe:c)),(f=t(o,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Hfe)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=bat,u.eachBefore(function(p){p.depth=p.parent.depth+1,--a}).eachBefore($fe),u.parent=null,a>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=uT(r),n):e},n.parentId=function(r){return arguments.length?(t=uT(r),n):t},n}function _at(e,t){return e.parent===t.parent?1:2}function r6(e){var t=e.children;return t?t[0]:e.t}function i6(e){var t=e.children;return t?t[t.length-1]:e.t}function Sat(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Eat(e){for(var t=0,n=0,r=e.children,i=r.length,a;--i>=0;)a=r[i],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function Cat(e,t,n){return e.a.parent===t.parent?e.a:n}function lT(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}lT.prototype=Object.create(Jv.prototype);function Aat(e){for(var t=new lT(e,0),n,r=[t],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new lT(a[o],o)),i.parent=n;return(t.parent=new lT(null,0)).children=[t],t}function kat(){var e=_at,t=1,n=1,r=null;function i(l){var c=Aat(l);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function a(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Eat(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m,x;p=i6(p),d=r6(d),p&&d;)g=r6(g),h=i6(h),h.a=l,x=p.z+y-d.z-m+e(p._,d._),x>0&&(Sat(Cat(p,l,f),l,x),m+=x,v+=x),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!i6(h)&&(h.t=p,h.m+=y-v),d&&!r6(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function cT(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)o=a[s],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var Kfe=(1+Math.sqrt(5))/2;function Xfe(e,t,n,r,i,a){for(var o=[],s=t.children,u,l,c=0,f=0,d=s.length,h,p,g=t.value,m,v,y,b,x,w,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=y=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,x=Math.max(y/S,S/v);f<d;++f){if(m+=l=s[f].value,l<v&&(v=l),l>y&&(y=l),S=m*m*w,b=Math.max(y/S,S/v),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:s.slice(c,f)}),u.dice?Mx(u,n,r,i,g?r+=p*m/g:a):cT(u,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}var Yfe=function e(t){function n(r,i,a,o,s){Xfe(t,r,i,a,o,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Kfe);function Tat(){var e=Yfe,t=!1,n=1,r=1,i=[0],a=Mp,o=Mp,s=Mp,u=Mp,l=Mp;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(qfe),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=l(d)-h,g+=o(d)-h,m-=s(d)-h,v-=u(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=uT(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:Qv(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:Qv(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:Qv(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Qv(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Qv(+d),c):l},c}function Oat(e,t,n,r,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,p,g,m,v){if(f>=d-1){var y=a[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=l[f],x=h/2+b,w=f+1,S=d-1;w<S;){var C=w+S>>>1;l[C]<x?w=C+1:S=C}x-l[w-1]<l[w]-x&&f+1<w&&--w;var _=l[w]-b,E=h-_;if(m-p>v-g){var A=h?(p*E+m*_)/h:m;c(f,w,_,p,g,A,v),c(w,d,E,A,g,m,v)}else{var k=h?(g*E+v*_)/h:v;c(f,w,_,p,g,m,k),c(w,d,E,p,k,m,v)}}}function Iat(e,t,n,r,i){(e.depth&1?cT:Mx)(e,t,n,r,i)}var Nat=function e(t){function n(r,i,a,o,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Mx(l,i,a,o,g?a+=(s-a)*l.value/g:s):cT(l,i,a,g?i+=(o-i)*l.value/g:o,s),g-=l.value}else r._squarify=u=Xfe(t,r,i,a,o,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Kfe);function a6(e,t,n){const r={};return e.each(i=>{const a=i.data;n(a)&&(r[t(a)]=i)}),e.lookup=r,e}function o6(e){ve.call(this,null,e)}o6.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Dat=e=>e.values;$e(o6,ve,{transform(e,t){t.source||Se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;return(!a||r||t.changed())&&(a&&a.each(o=>{o.children&&JC(o.data)&&i.rem.push(o.data)}),this.value=a=e6({values:wt(e.keys).reduce((o,s)=>(o.key(s),o),Rat()).entries(i.source)},Dat),n&&a.each(o=>{o.children&&(o=In(o.data),i.add.push(o),i.source.push(o))}),a6(a,lt,lt)),i.source.root=a,i}});function Rat(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,a){if(a>=e.length)return i;const o=i.length,s=e[a++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],a);return l}function r(i,a){if(++a>e.length)return i;const o=[];for(const s in i)o.push({key:s,values:r(i[s],a)});return o}return t}function Dc(e){ve.call(this,null,e)}const Fat=(e,t)=>e.parent===t.parent?1:2;$e(Dc,ve,{transform(e,t){(!t.source||!t.source.root)&&Se(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(gp(e.sort,o=>o.data)),Mat(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Fat:lv);try{this.value=n(i)}catch(o){Se(o)}return i.each(o=>Pat(o,r,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function Mat(e,t,n){for(let r,i=0,a=t.length;i<a;++i)r=t[i],r in n&&e[r](n[r])}function Pat(e,t,n){const r=e.data,i=t.length-1;for(let a=0;a<i;++a)r[n[a]]=e[t[a]];r[n[i]]=e.children?e.children.length:0}const s6=["x","y","r","depth","children"];function u6(e){Dc.call(this,e)}u6.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:s6.length,default:s6}]},$e(u6,Dc,{layout:vat,params:["radius","size","padding"],fields:s6});const l6=["x0","y0","x1","y1","depth","children"];function c6(e){Dc.call(this,e)}c6.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:l6.length,default:l6}]},$e(c6,Dc,{layout:yat,params:["size","round","padding"],fields:l6});function f6(e){ve.call(this,null,e)}f6.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},$e(f6,ve,{transform(e,t){t.source||Se("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?a6(Gfe().id(e.key).parentId(e.parentKey)(i.source),e.key,ls):a6(Gfe()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Zfe={tidy:kat,cluster:Uit},d6=["x","y","depth","children"];function h6(e){Dc.call(this,e)}h6.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:d6.length,default:d6}]},$e(h6,Dc,{layout(e){const t=e||"tidy";if(_t(Zfe,t))return Zfe[t]();Se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:d6});function p6(e){ve.call(this,[],e)}p6.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},$e(p6,ve,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return r||Se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>a[lt(o)]=1),r.each(o=>{const s=o.data,u=o.parent&&o.parent.data;u&&a[lt(s)]&&a[lt(u)]&&i.add.push(In({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>a[lt(o)]=1),n.forEach(o=>{(a[lt(o.source)]||a[lt(o.target)])&&i.mod.push(o)})),i}});const Jfe={binary:Oat,dice:Mx,slice:cT,slicedice:Iat,squarify:Yfe,resquarify:Nat},g6=["x0","y0","x1","y1","depth","children"];function m6(e){Dc.call(this,e)}m6.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:g6.length,default:g6}]},$e(m6,Dc,{layout(){const e=Tat();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{_t(Jfe,t)?e.tile(Jfe[t]):Se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:g6});var $at=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:o6,pack:u6,partition:c6,stratify:f6,tree:h6,treelinks:p6,treemap:m6});const Lat=4278190080,Bat=268435456,zat=.0625;function jat(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Uat(e,t,n,r){const i=e.width,a=e.height,o=n||r,s=Ev(i,a).getContext("2d");t.forEach(m=>Qfe(s,m,o));const u=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,g;for(d=0;d<a;++d)for(f=0;f<i;++f)g=u[d*i+f]&Lat,g&&(h=e(f),p=e(d),r||l.set(h,p),o&&g^Bat&&c.set(h,p));return[l,c]}function Qfe(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(a=>Qfe(e,a.items,n))}):Uo[r].draw(e,{items:n?t.map(Wat):t})}function Wat(e){const t=QC(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=zat,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Rc=5,ja=31,Px=32,Dd=new Uint32Array(Px+1),fu=new Uint32Array(Px+1);fu[0]=0,Dd[0]=~fu[0];for(let e=1;e<=Px;++e)fu[e]=fu[e-1]<<1|1,Dd[e]=~fu[e];function Vat(e,t){const n=new Uint32Array(~~((e*t+Px)/Px));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const s=o*e+a;return n[s>>>Rc]&1<<(s&ja)},set:(a,o)=>{const s=o*e+a;r(s>>>Rc,1<<(s&ja))},clear:(a,o)=>{const s=o*e+a;i(s>>>Rc,~(1<<(s&ja)))},getRange:(a,o,s,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+a,f=l*e+s,d=c>>>Rc,h=f>>>Rc,d===h){if(n[d]&Dd[c&ja]&fu[(f&ja)+1])return!0}else{if(n[d]&Dd[c&ja]||n[h]&fu[(f&ja)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Rc,d=c>>>Rc,f===d)r(f,Dd[l&ja]&fu[(c&ja)+1]);else for(r(f,Dd[l&ja]),r(d,fu[(c&ja)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Rc,d=c>>>Rc,f===d)i(f,fu[l&ja]|Dd[(c&ja)+1]);else for(i(f,fu[l&ja]),i(d,Dd[(c&ja)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(a,o,s,u)=>a<0||o<0||u>=t||s>=e}}function qat(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=s=>~~((s+n)/r);return o.invert=s=>s*r-n,o.bitmap=()=>Vat(i,a),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function Hat(e,t,n,r){const i=e.width,a=e.height;return function(o){const s=o.datum.datum.items[r].items,u=s.length,l=o.datum.fontSize,c=dl.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,v,y;for(let b=0;b<u;++b)d=s[b].x,p=s[b].y,h=s[b].x2===void 0?d:s[b].x2,g=s[b].y2===void 0?p:s[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=v);return m=c/2,v=l/2,d=o.x-m,h=o.x+m,p=o.y-v,g=o.y+v,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&g<=a?o.baseline="top":0<=p&&a<g&&(o.baseline="bottom"),!0}}function fT(e,t,n,r,i,a){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function Rd(e,t,n,r,i,a,o,s){const u=i*a/(r*2),l=e(t-u),c=e(t+u),f=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function Gat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,v=a,y;if(!fT(p,g,d,h,i,a)&&!Rd(e,p,g,h,d,m,o,s)&&!Rd(e,p,g,h,d,h,o,null)){for(;v-m>=1;)y=(m+v)/2,Rd(e,p,g,h,d,y,o,s)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=dl.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,v=0,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W;for(let G=0;G<f;++G){for(y=c[G].x,x=c[G].y,b=c[G].x2===void 0?y:c[G].x2,w=c[G].y2===void 0?x:c[G].y2,y>b&&(W=y,y=b,b=W),x>w&&(W=x,x=w,w=W),A=e(y),T=e(b),k=~~((A+T)/2),I=e(x),O=e(w),N=~~((I+O)/2),_=k;_>=A;--_)for(E=N;E>=I;--E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);for(_=k;_<=T;++_)for(E=N;E<=O;++E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);!g&&!n&&(D=Math.abs(b-y+w-x),S=(y+b)/2,C=(x+w)/2,D>=v&&!fT(S,C,h,d,i,a)&&!Rd(e,S,C,d,h,d,o,null)&&(v=D,l.x=S,l.y=C,m=!0))}return g||m?(S=h/2,C=d/2,o.setRange(e(l.x-S),e(l.y-C),e(l.x+S),e(l.y+C)),l.align="center",l.baseline="middle",!0):!1}}const Kat=[-1,-1,1,1],Xat=[-1,1,-1,1];function Yat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=dl.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,v=!1,y=0,b,x,w,S,C,_,E,A,k,T,I,N;for(let O=0;O<f;++O){for(b=c[O].x,w=c[O].y,x=c[O].x2===void 0?b:c[O].x2,S=c[O].y2===void 0?w:c[O].y2,p.push([e((b+x)/2),e((w+S)/2)]);p.length;)if([E,A]=p.pop(),!(o.get(E,A)||s.get(E,A)||u.get(E,A))){u.set(E,A);for(let D=0;D<4;++D)C=E+Kat[D],_=A+Xat[D],u.outOfBounds(C,_,C,_)||p.push([C,_]);if(C=e.invert(E),_=e.invert(A),k=g,T=a,!fT(C,_,h,d,i,a)&&!Rd(e,C,_,d,h,k,o,s)&&!Rd(e,C,_,d,h,d,o,null)){for(;T-k>=1;)I=(k+T)/2,Rd(e,C,_,d,h,I,o,s)?T=I:k=I;k>g&&(l.x=C,l.y=_,g=k,m=!0)}}!m&&!n&&(N=Math.abs(x-b+S-w),C=(b+x)/2,_=(w+S)/2,N>=y&&!fT(C,_,h,d,i,a)&&!Rd(e,C,_,d,h,d,o,null)&&(y=N,l.x=C,l.y=_,v=!0))}return m||v?(C=h/2,_=d/2,o.setRange(e(l.x-C),e(l.y-_),e(l.x+C),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Zat=["right","center","left"],Jat=["bottom","middle","top"];function Qat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>a)return!1;let d=0,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k;for(let T=0;T<u;++T){if(h=(n[T]&3)-1,p=(n[T]>>>2&3)-1,g=h===0&&p===0||r[T]<0,m=h&&p?Math.SQRT1_2:1,v=r[T]<0?-1:1,y=c[1+h]+r[T]*h*m,C=c[4+p]+v*f*p/2+r[T]*p*m,x=C-f/2,w=C+f/2,_=e(y),A=e(x),k=e(w),!d)if(ede(_,_,A,k,o,s,y,y,x,w,c,g))d=dl.width(l.datum,l.datum.text);else continue;if(S=y+v*d*h/2,y=S-d/2,b=S+d/2,_=e(y),E=e(b),ede(_,E,A,k,o,s,y,b,x,w,c,g))return l.x=h?h*v<0?b:y:S,l.y=p?p*v<0?w:x:C,l.align=Zat[h*v+1],l.baseline=Jat[p*v+1],o.setRange(_,A,E,k),!0}return!1}}function ede(e,t,n,r,i,a,o,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&a?a.getRange(e,n,t,r)||!eot(o,u,s,l,c):i.getRange(e,n,t,r)))}function eot(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const v6=0,y6=4,b6=8,x6=0,w6=1,_6=2,tot={"top-left":v6+x6,top:v6+w6,"top-right":v6+_6,left:y6+x6,middle:y6+w6,right:y6+_6,"bottom-left":b6+x6,bottom:b6+w6,"bottom-right":b6+_6},not={naive:Hat,"reduced-search":Gat,floodfill:Yat};function rot(e,t,n,r,i,a,o,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=iot(r,f),h=aot(i,f),p=oot(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",v=sot(p,g,s,u),y=qat(t[0],t[1],l),b=m&&c==="naive",x=e.map(C=>({datum:C,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(C)}));let w;if(!b){n&&x.sort((_,E)=>n(_.datum,E.datum));let C=!1;for(let _=0;_<h.length&&!C;++_)C=h[_]===5||d[_]<0;p&&(o||m)&&(a=[e.map(_=>_.datum)].concat(a)),w=a.length?Uat(y,a,C,m):jat(y,o&&x)}const S=m?not[c](y,w,o,u):Qat(y,w,h,d);return x.forEach(C=>C.opacity=+S(C)),x}function iot(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function aot(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=tot[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function oot(e){return e&&e.mark&&e.mark.marktype}function sot(e,t,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>i(a.datum):t==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const S6=["x","y","opacity","align","baseline"],tde=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function E6(e){ve.call(this,null,e)}E6.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:tde},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:S6.length,default:S6}]},$e(E6,ve,{transform(e,t){function n(a){const o=e[a];return Lt(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Se("Size parameter should be specified as a [width, height] array.");const i=e.as||S6;return rot(t.materialize(t.SOURCE).source,e.size,e.sort,wt(e.offset||1),wt(e.anchor||tde),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),t.reflow(r).modifies(i)}});var uot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:E6});function nde(e,t){var n=[],r=function(c){return c(s)},i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function C6(e){ve.call(this,null,e)}C6.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},$e(C6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=nde(r,e.groupby),a=(e.groupby||[]).map(Tr),o=a.length,s=e.as||[Tr(e.x),Tr(e.y)],u=[];i.forEach(l=>{uae(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[a[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(In(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const A6={linear:vL,log:nae,exp:rae,pow:iae,quad:yL,poly:aae},lot=(e,t)=>e==="poly"?t:e==="quad"?2:1;function k6(e){ve.call(this,null,e)}k6.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(A6)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},$e(k6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=nde(r,e.groupby),a=(e.groupby||[]).map(Tr),o=e.method||"linear",s=e.order||3,u=lot(o,s),l=e.as||[Tr(e.x),Tr(e.y)],c=A6[o],f=[];let d=e.extent;_t(A6,o)||Se("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,s);if(e.params){f.push(In({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||tl(h,e.x),v=y=>{const b={};for(let x=0;x<a.length;++x)b[a[x]]=h.dims[x];b[l[0]]=y[0],b[l[1]]=y[1],f.push(In(b))};o==="linear"?m.forEach(y=>v([y,g.predict(y)])):lA(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var cot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:C6,regression:k6});const rde=Math.pow(2,-52),dT=new Uint32Array(512);class hT{static from(t,n=got,r=mot){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new hT(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let A=0;A<o;A++){const k=t[2*A],T=t[2*A+1];k<s&&(s=k),T<u&&(u=T),k>l&&(l=k),T>c&&(c=T),this._ids[A]=A}const f=(s+l)/2,d=(u+c)/2;let h=1/0,p,g,m;for(let A=0;A<o;A++){const k=T6(f,d,t[2*A],t[2*A+1]);k<h&&(p=A,h=k)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let A=0;A<o;A++){if(A===p)continue;const k=T6(v,y,t[2*A],t[2*A+1]);k<h&&k>0&&(g=A,h=k)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let A=0;A<o;A++){if(A===p||A===g)continue;const k=hot(v,y,b,x,t[2*A],t[2*A+1]);k<w&&(m=A,w=k)}let S=t[2*m],C=t[2*m+1];if(w===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];e0(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let k=0;for(let T=0,I=-1/0;T<o;T++){const N=this._ids[T];this._dists[N]>I&&(A[k++]=N,I=this._dists[N])}this.hull=A.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(pT(v,y,b,x,S,C)){const A=g,k=b,T=x;g=m,b=S,x=C,m=A,S=k,C=T}const _=pot(v,y,b,x,S,C);this._cx=_.x,this._cy=_.y;for(let A=0;A<o;A++)this._dists[A]=T6(t[2*A],t[2*A+1],_.x,_.y);e0(this._ids,this._dists,0,o-1),this._hullStart=p;let E=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,a.fill(-1),a[this._hashKey(v,y)]=p,a[this._hashKey(b,x)]=g,a[this._hashKey(S,C)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let A=0,k,T;A<this._ids.length;A++){const I=this._ids[A],N=t[2*I],O=t[2*I+1];if(A>0&&Math.abs(N-k)<=rde&&Math.abs(O-T)<=rde||(k=N,T=O,I===p||I===g||I===m))continue;let D=0;for(let ee=0,ce=this._hashKey(N,O);ee<this._hashSize&&(D=a[(ce+ee)%this._hashSize],!(D!==-1&&D!==r[D]));ee++);D=n[D];let L=D,W;for(;W=r[L],!pT(N,O,t[2*L],t[2*L+1],t[2*W],t[2*W+1]);)if(L=W,L===D){L=-1;break}if(L===-1)continue;let G=this._addTriangle(L,I,r[L],-1,-1,i[L]);i[I]=this._legalize(G+2),i[L]=G,E++;let K=r[L];for(;W=r[K],pT(N,O,t[2*K],t[2*K+1],t[2*W],t[2*W+1]);)G=this._addTriangle(K,I,W,i[I],-1,i[K]),i[I]=this._legalize(G+2),r[K]=K,E--,K=W;if(L===D)for(;W=n[L],pT(N,O,t[2*W],t[2*W+1],t[2*L],t[2*L+1]);)G=this._addTriangle(W,I,L,-1,i[L],i[W]),this._legalize(G+2),i[W]=G,r[L]=L,E--,L=W;this._hullStart=n[I]=L,r[L]=n[K]=I,r[I]=K,a[this._hashKey(N,O)]=I,a[this._hashKey(t[2*L],t[2*L+1])]=L}this.hull=new Uint32Array(E);for(let A=0,k=this._hullStart;A<E;A++)this.hull[A]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(fot(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const s=r[t],u=t-t%3;if(o=u+(t+2)%3,s===-1){if(a===0)break;t=dT[--a];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(dot(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[s]=d;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(s,r[o]),this._link(o,f);const y=l+(s+1)%3;a<dT.length&&(dT[a++]=y)}else{if(a===0)break;t=dT[--a]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,a,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,a),this._link(s+2,o),this.trianglesLen+=3,s}}function fot(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function T6(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function O6(e,t,n,r,i,a){const o=(r-t)*(i-e),s=(n-e)*(a-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function pT(e,t,n,r,i,a){return(O6(i,a,e,t,n,r)||O6(e,t,n,r,i,a)||O6(n,r,i,a,e,t))<0}function dot(e,t,n,r,i,a,o,s){const u=e-o,l=t-s,c=n-o,f=r-s,d=i-o,h=a-s,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function hot(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=(l*c-s*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function pot(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=e+(l*c-s*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function e0(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=e[i],o=t[a];let s=i-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{const i=n+r>>1;let a=n+1,o=r;$x(e,i,a),t[e[n]]>t[e[r]]&&$x(e,n,r),t[e[a]]>t[e[r]]&&$x(e,a,r),t[e[n]]>t[e[a]]&&$x(e,n,a);const s=e[a],u=t[s];for(;;){do a++;while(t[e[a]]<u);do o--;while(t[e[o]]>u);if(o<a)break;$x(e,a,o)}e[n+1]=e[o],e[o]=s,r-a+1>=o-n?(e0(e,t,a,r),e0(e,t,n,o-1)):(e0(e,t,n,o-1),e0(e,t,a,r))}}function $x(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function got(e){return e[0]}function mot(e){return e[1]}const ide=1e-6;class Pp{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>ide||Math.abs(this._y1-a)>ide)&&(this._+="L"+i+","+a),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class I6{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class vot{constructor(t,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,g=r.length,m,v;h<g;h+=3,p+=2){const y=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[y],S=t[y+1],C=t[b],_=t[b+1],E=t[x],A=t[x+1],k=C-w,T=_-S,I=E-w,N=A-S,O=k*k+T*T,D=I*I+N*N,L=(k*N-T*I)*2;if(!L)m=(w+E)/2-1e8*N,v=(S+A)/2+1e8*I;else if(Math.abs(L)<1e-8)m=(w+E)/2,v=(S+A)/2;else{const W=1/L;m=w+(N*O-T*D)*W,v=S+(k*D-I*O)*W}a[p]=m,a[p+1]=v}let o=n[n.length-1],s,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],s=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new Pp:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:s}=this;if(a.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],v=o[p],y=o[p+1];this._renderSegment(g,m,v,y,t)}let u,l=a[a.length-1];for(let c=0;c<a.length;++c){u=l,l=a[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,s[p+2],s[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Pp:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new Pp:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new I6;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,a){let o;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(a.moveTo(t,n),a.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,s,u))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let a=0,o=n.length;a<o;a+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[a]==i[s]&&n[a+1]==i[s+1]&&n[(a+2)%o]==i[(s+u-2)%u]&&n[(a+3)%o]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[t];if(o===-1)return null;const s=[];let u=o;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,a[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,a,o,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(a=s,o=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let p,g,m,v,y;if(l===0){if((p=this._clipSegment(a,o,s,u,l,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(s,u,a,o,c,l))===null)continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,a,o){for(;;){if(a===0&&o===0)return[t,n,r,i];if(a&o)return null;let s,u,l=a||o;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),a?(t=s,n=u,a=this._regioncode(t,n)):(r=s,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,a,o){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],a,o))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,a){for(;n!==r;){let o,s;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,s=this.ymin;break}(i[a]!==o||i[a+1]!==s)&&this.contains(t,o,s)&&(i.splice(a,0,o,s),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const s=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[s]&&i[s]===i[u]||i[o+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),o-=2)}return a}_project(t,n,r,i){let a=1/0,o,s,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(u=this.ymin,s=t+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(u=this.ymax,s=t+(a=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<a&&(s=this.xmax,u=n+(a=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<a&&(s=this.xmin,u=n+(a=o)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const yot=2*Math.PI,t0=Math.pow;function bot(e){return e[0]}function xot(e){return e[1]}function wot(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function _ot(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class N6{static from(t,n=bot,r=xot,i){return new N6("length"in t?Sot(t,n,r,i):Float64Array.from(Eot(t,n,r,i)))}constructor(t){this._delaunator=new hT(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&wot(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=_ot(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new hT(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=a[u%3==2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new vot(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=a[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,t,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(t,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=t0(n-l[t*2],2)+t0(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=t0(n-l[p*2],2)+t0(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=a[(o[t]+1)%a.length],h!==p&&t0(n-l[h*2],2)+t0(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Pp:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,s=i.length;o<s;++o){const u=i[o];if(u<o)continue;const l=a[o]*2,c=a[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new Pp:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const s=i[a],u=i[a+1];t.moveTo(s+n,u),t.arc(s,u,n,0,yot)}return r&&r.value()}renderHull(t){const n=t==null?t=new Pp:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;t.moveTo(i[a],i[a+1]);for(let s=1;s<o;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new I6;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new Pp:void 0,{points:i,triangles:a}=this,o=a[t*=3]*2,s=a[t+1]*2,u=a[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new I6;return this.renderTriangle(t,n),n.value()}}function Sot(e,t,n,r){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const s=e[o];a[o*2]=t.call(r,s,o,e),a[o*2+1]=n.call(r,s,o,e)}return a}function*Eot(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}function D6(e){ve.call(this,null,e)}D6.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Cot=[-1e5,-1e5,1e5,1e5];$e(D6,ve,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Cot;const a=this.value=N6.from(r,e.x,e.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const u=a.cellPolygon(o);r[o][n]=u?Aot(u):null}return t.reflow(e.modified()).modifies(n)}});function Aot(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var kot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:D6}),R6=Math.PI/180,Lx=1<<11>>5,gT=1<<11;function Tot(){var e=[256,256],t,n,r,i,a,o,s,u=ade,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Ev()),g=Fot((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],x=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:a(S),rotate:o(S),size:~~(r(S)+1e-14),padding:s(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,C)=>C.size-S.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Oot(p,w,x,y),w.hasText&&h(g,w,m)&&(b.push(w),m?Not(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Lx<<5)/g,p.height=gT/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,C,_,E;(C=x(S+=w))&&(_=~~C[0],E=~~C[1],!(Math.min(Math.abs(_),Math.abs(E))>=b));)if(g.x=v+_,g.y=y+E,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!Iot(g,p,e[0]))&&(!m||Dot(g,m))){for(var A=g.sprite,k=g.width>>5,T=e[0]>>5,I=g.x-(k<<4),N=I&127,O=32-N,D=g.y1-g.y0,L=(g.y+g.y0)*T+(I>>5),W,G=0;G<D;G++){W=0;for(var K=0;K<=k;K++)p[L+K]|=W<<O|(K<k?(W=A[G*k+K])>>>N:0);L+=T}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=$p(p),f):n},f.fontStyle=function(p){return arguments.length?(i=$p(p),f):i},f.fontWeight=function(p){return arguments.length?(a=$p(p),f):a},f.rotate=function(p){return arguments.length?(o=$p(p),f):o},f.text=function(p){return arguments.length?(t=$p(p),f):t},f.spiral=function(p){return arguments.length?(u=Mot[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=$p(p),f):r},f.padding=function(p){return arguments.length?(s=$p(p),f):s},f.random=function(p){return arguments.length?(c=p,f):c},f}function Oot(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(Lx<<5)/a,gT/a);var o=0,s=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,c=i.measureText(t.text+"m").width*a,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*R6),m=Math.cos(t.rotate*R6),v=c*m,y=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=Lx<<5&&(o=0,s+=u,u=0),s+d>=gT)break;i.translate((o+(c>>1))/a,(s+(d>>1))/a),t.rotate&&i.rotate(t.rotate*R6),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(Lx<<5)/a,gT/a).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;s=t.yoff;var C=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),A=w[(s+p)*(Lx<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=A,C|=A}C?_=p:(t.y0++,d--,p--,s++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Iot(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Not(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Dot(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function ade(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Rot(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Fot(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function $p(e){return typeof e=="function"?e:function(){return e}}var Mot={archimedean:ade,rectangular:Rot};const ode=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Pot=["text","font","rotate","fontSize","fontStyle","fontWeight"];function F6(e){ve.call(this,Tot(),e)}F6.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:ode}]},$e(F6,ve,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Se("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Lt(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Pot.some(n)))return;const i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||ode;let s=e.fontSize||14,u;if(Lt(s)?u=e.fontSizeRange:s=Ji(s),u){const p=s,g=Sn("sqrt")().domain(tl(i,p)).range(u);s=m=>g(p(m))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(ds).layout(),c=a.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(r).modifies(o)}});var $ot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:F6});const Lot=e=>new Uint8Array(e),Bot=e=>new Uint16Array(e),Bx=e=>new Uint32Array(e);function zot(){let e=8,t=[],n=Bx(0),r=mT(0,e),i=mT(0,e);return{data:()=>t,seen:()=>n=jot(n,t.length),add(a){for(let o=0,s=t.length,u=a.length,l;o<u;++o)l=a[o],l._index=s++,t.push(l)},remove(a,o){const s=t.length,u=Array(s-a),l=t;let c,f,d;for(f=0;!o[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const s=r.length;(a>s||o>e)&&(e=Math.max(o,e),r=mT(a,e,r),i=mT(a,e))}}}function jot(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function mT(e,t,n){const r=(t<257?Lot:t<65537?Bot:Bx)(e);return n&&r.set(n),r}function sde(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,a){const o=this,s=o.bisect(o.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)a[u[d]]|=r;for(d=c;d<f;++d)a[u[d]]|=r;return o}}}function ude(){let e=Bx(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Bx(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=Uot(h,d),c)p=t,g=e,t=Array(c+f),e=Bx(c+f),Wot(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function a(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function o(s,u){let l;return u?l=u.length:(u=t,l=n),[NHe(u,s[0],0,l),UC(u,s[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>e,size:()=>n}}function Uot(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],a=e[r];return i<a?-1:i>a?1:0}),FHe(e,t)}function Wot(e,t,n,r,i,a,o,s,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}function M6(e){ve.call(this,zot(),e),this._indices=null,this._dims=null}M6.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},$e(M6,ve,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;let s=0,u,l;for(;s<o;++s)u=n[s].fname,l=i[u]||(i[u]=ude()),a.push(sde(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,x,w,S,C;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,S=y.length;w<S;++w)x[y[w]._index]=1;for(w=0;w<h;++w)C=r[w],(!o[w]||e.modified("fields",w)||t.modified(C.fields))&&(v=C.fname,(g=p[v])||(a[v]=m=ude(),p[v]=g=m.insert(C,t.source,0)),o[w]=sde(m,w,i[w]).onAdd(g,u));for(w=0,S=s.data().length;w<S;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,a=this._dims,o=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=a.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=s[h].fname,g=u[p]||(u[p]=o[p].insert(s[h],r,d)),a[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;let s,u,l;for(s=0,u=o.length;s<u;++s)l=o[s]._index,i[l]!==a&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const a=i.remove(t,n);for(const o in r)r[o].reindex(a)})},update(e,t,n){const r=this._dims,i=e.query,a=t.stamp,o=r.length;let s=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<o;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,a=i.curr(),o=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],a[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],a[m]^=h,r.push(m);e.range=t.slice()}});function P6(e){ve.call(this,null,e)}P6.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},$e(P6,ve,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const a=t.fork(t.ALL),o=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:o[c];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?o[c]:null}),a.filter(a.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(a.filter(a.ADD,l),a.filter(a.REM,c=>(s[c]&n)===i?o[c]:null)),a.filter(a.SOURCE,c=>l(c._index))}});var Vot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:M6,resolvefilter:P6});const qot="RawCode",Lp="Literal",Hot="Property",Got="Identifier",Kot="ArrayExpression",Xot="BinaryExpression",lde="CallExpression",Yot="ConditionalExpression",Zot="LogicalExpression",Jot="MemberExpression",Qot="ObjectExpression",est="UnaryExpression";function du(e){this.type=e}du.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=tst(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function tst(e){switch(e.type){case Kot:return e.elements;case Xot:case Zot:return[e.left,e.right];case lde:return[e.callee].concat(e.arguments);case Yot:return[e.test,e.consequent,e.alternate];case Jot:return[e.object,e.property];case Qot:return e.properties;case Hot:return[e.key,e.value];case est:return[e.argument];case Got:case Lp:case qot:default:return[]}}var bl,at,we,aa,zn,vT=1,zx=2,Bp=3,Fd=4,yT=5,zp=6,ho=7,jx=8,nst=9;bl={},bl[vT]="Boolean",bl[zx]="<end>",bl[Bp]="Identifier",bl[Fd]="Keyword",bl[yT]="Null",bl[zp]="Numeric",bl[ho]="Punctuator",bl[jx]="String",bl[nst]="RegularExpression";var rst="ArrayExpression",ist="BinaryExpression",ast="CallExpression",ost="ConditionalExpression",cde="Identifier",sst="Literal",ust="LogicalExpression",lst="MemberExpression",cst="ObjectExpression",fst="Property",dst="UnaryExpression",Si="Unexpected token %0",hst="Unexpected number",pst="Unexpected string",gst="Unexpected identifier",mst="Unexpected reserved word",vst="Unexpected end of input",$6="Invalid regular expression",L6="Invalid regular expression: missing /",fde="Octal literals are not allowed in strict mode.",yst="Duplicate data property in object literal not allowed in strict mode",ji="ILLEGAL",Ux="Disabled.",bst=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),xst=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function bT(e,t){if(!e)throw new Error("ASSERT: "+t)}function Fc(e){return e>=48&&e<=57}function B6(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Wx(e){return"01234567".indexOf(e)>=0}function wst(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Vx(e){return e===10||e===13||e===8232||e===8233}function qx(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&bst.test(String.fromCharCode(e))}function xT(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&xst.test(String.fromCharCode(e))}const _st={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function dde(){for(;we<aa;){const e=at.charCodeAt(we);if(wst(e)||Vx(e))++we;else break}}function z6(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<aa&&B6(at[we])?(r=at[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):En({},Si,ji);return String.fromCharCode(i)}function Sst(){var e,t,n,r;for(e=at[we],t=0,e==="}"&&En({},Si,ji);we<aa&&(e=at[we++],!!B6(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&En({},Si,ji),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function hde(){var e,t;for(e=at.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=z6("u"),(!e||e==="\\"||!qx(e.charCodeAt(0)))&&En({},Si,ji),t=e);we<aa&&(e=at.charCodeAt(we),!!xT(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=z6("u"),(!e||e==="\\"||!xT(e.charCodeAt(0)))&&En({},Si,ji),t+=e);return t}function Est(){var e,t;for(e=we++;we<aa;){if(t=at.charCodeAt(we),t===92)return we=e,hde();if(xT(t))++we;else break}return at.slice(e,we)}function Cst(){var e,t,n;return e=we,t=at.charCodeAt(we)===92?hde():Est(),t.length===1?n=Bp:_st.hasOwnProperty(t)?n=Fd:t==="null"?n=yT:t==="true"||t==="false"?n=vT:n=Bp,{type:n,value:t,start:e,end:we}}function j6(){var e=we,t=at.charCodeAt(we),n,r=at[we],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:ho,value:String.fromCharCode(t),start:e,end:we};default:if(n=at.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:ho,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,at.charCodeAt(we)===61&&++we,{type:ho,value:at.slice(e,we),start:e,end:we}}}if(o=at.substr(we,4),o===">>>=")return we+=4,{type:ho,value:o,start:e,end:we};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return we+=3,{type:ho,value:a,start:e,end:we};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:ho,value:i,start:e,end:we};if(i==="//"&&En({},Si,ji),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:ho,value:r,start:e,end:we};En({},Si,ji)}function Ast(e){let t="";for(;we<aa&&B6(at[we]);)t+=at[we++];return t.length===0&&En({},Si,ji),qx(at.charCodeAt(we))&&En({},Si,ji),{type:zp,value:parseInt("0x"+t,16),start:e,end:we}}function kst(e){let t="0"+at[we++];for(;we<aa&&Wx(at[we]);)t+=at[we++];return(qx(at.charCodeAt(we))||Fc(at.charCodeAt(we)))&&En({},Si,ji),{type:zp,value:parseInt(t,8),octal:!0,start:e,end:we}}function pde(){var e,t,n;if(n=at[we],bT(Fc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=at[we++],n=at[we],e==="0"){if(n==="x"||n==="X")return++we,Ast(t);if(Wx(n))return kst(t);n&&Fc(n.charCodeAt(0))&&En({},Si,ji)}for(;Fc(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="."){for(e+=at[we++];Fc(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="e"||n==="E")if(e+=at[we++],n=at[we],(n==="+"||n==="-")&&(e+=at[we++]),Fc(at.charCodeAt(we)))for(;Fc(at.charCodeAt(we));)e+=at[we++];else En({},Si,ji);return qx(at.charCodeAt(we))&&En({},Si,ji),{type:zp,value:parseFloat(e),start:t,end:we}}function Tst(){var e="",t,n,r,i,a=!1;for(t=at[we],bT(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<aa;)if(r=at[we++],r===t){t="";break}else if(r==="\\")if(r=at[we++],!r||!Vx(r.charCodeAt(0)))switch(r){case"u":case"x":at[we]==="{"?(++we,e+=Sst()):e+=z6(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Wx(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),we<aa&&Wx(at[we])&&(a=!0,i=i*8+"01234567".indexOf(at[we++]),"0123".indexOf(r)>=0&&we<aa&&Wx(at[we])&&(i=i*8+"01234567".indexOf(at[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&at[we]===`
`&&++we;else{if(Vx(r.charCodeAt(0)))break;e+=r}return t!==""&&En({},Si,ji),{type:jx,value:e,octal:a,start:n,end:we}}function Ost(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";En({},$6)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){En({},$6)}try{return new RegExp(e,t)}catch(r){return null}}function Ist(){var e,t,n,r,i;for(e=at[we],bT(e==="/","Regular expression literal must start with a slash"),t=at[we++],n=!1,r=!1;we<aa;)if(e=at[we++],t+=e,e==="\\")e=at[we++],Vx(e.charCodeAt(0))&&En({},L6),t+=e;else if(Vx(e.charCodeAt(0)))En({},L6);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||En({},L6),i=t.substr(1,t.length-2),{value:i,literal:t}}function Nst(){var e,t,n;for(t="",n="";we<aa&&(e=at[we],!!xT(e.charCodeAt(0)));)++we,e==="\\"&&we<aa?En({},Si,ji):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&En({},$6,n),{value:n,literal:t}}function Dst(){var e,t,n,r;return zn=null,dde(),e=we,t=Ist(),n=Nst(),r=Ost(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function Rst(e){return e.type===Bp||e.type===Fd||e.type===vT||e.type===yT}function gde(){if(dde(),we>=aa)return{type:zx,start:we,end:we};const e=at.charCodeAt(we);return qx(e)?Cst():e===40||e===41||e===59?j6():e===39||e===34?Tst():e===46?Fc(at.charCodeAt(we+1))?pde():j6():Fc(e)?pde():j6()}function po(){const e=zn;return we=e.end,zn=gde(),we=e.end,e}function mde(){const e=we;zn=gde(),we=e}function Fst(e){const t=new du(rst);return t.elements=e,t}function vde(e,t,n){const r=new du(e==="||"||e==="&&"?ust:ist);return r.operator=e,r.left=t,r.right=n,r}function Mst(e,t){const n=new du(ast);return n.callee=e,n.arguments=t,n}function Pst(e,t,n){const r=new du(ost);return r.test=e,r.consequent=t,r.alternate=n,r}function U6(e){const t=new du(cde);return t.name=e,t}function Hx(e){const t=new du(sst);return t.value=e.value,t.raw=at.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function yde(e,t,n){const r=new du(lst);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function $st(e){const t=new du(cst);return t.properties=e,t}function bde(e,t,n){const r=new du(fst);return r.key=t,r.value=n,r.kind=e,r}function Lst(e,t){const n=new du(dst);return n.operator=e,n.argument=t,n.prefix=!0,n}function En(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(a,o)=>(bT(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=we,n.description=i,n}function wT(e){e.type===zx&&En(e,vst),e.type===zp&&En(e,hst),e.type===jx&&En(e,pst),e.type===Bp&&En(e,gst),e.type===Fd&&En(e,mst),En(e,Si,e.value)}function oa(e){const t=po();(t.type!==ho||t.value!==e)&&wT(t)}function ir(e){return zn.type===ho&&zn.value===e}function W6(e){return zn.type===Fd&&zn.value===e}function Bst(){const e=[];for(we=zn.start,oa("[");!ir("]");)ir(",")?(po(),e.push(null)):(e.push(jp()),ir("]")||oa(","));return po(),Fst(e)}function xde(){we=zn.start;const e=po();return e.type===jx||e.type===zp?(e.octal&&En(e,fde),Hx(e)):U6(e.value)}function zst(){var e,t,n,r;if(we=zn.start,e=zn,e.type===Bp)return n=xde(),oa(":"),r=jp(),bde("init",n,r);if(e.type===zx||e.type===ho)wT(e);else return t=xde(),oa(":"),r=jp(),bde("init",t,r)}function jst(){var e=[],t,n,r,i={},a=String;for(we=zn.start,oa("{");!ir("}");)t=zst(),t.key.type===cde?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?En({},yst):i[r]=!0,e.push(t),ir("}")||oa(",");return oa("}"),$st(e)}function Ust(){oa("(");const e=V6();return oa(")"),e}const Wst={if:1};function Vst(){var e,t,n;if(ir("("))return Ust();if(ir("["))return Bst();if(ir("{"))return jst();if(e=zn.type,we=zn.start,e===Bp||Wst[zn.value])n=U6(po().value);else if(e===jx||e===zp)zn.octal&&En(zn,fde),n=Hx(po());else{if(e===Fd)throw new Error(Ux);e===vT?(t=po(),t.value=t.value==="true",n=Hx(t)):e===yT?(t=po(),t.value=null,n=Hx(t)):ir("/")||ir("/=")?(n=Hx(Dst()),mde()):wT(po())}return n}function qst(){const e=[];if(oa("("),!ir(")"))for(;we<aa&&(e.push(jp()),!ir(")"));)oa(",");return oa(")"),e}function Hst(){we=zn.start;const e=po();return Rst(e)||wT(e),U6(e.value)}function Gst(){return oa("."),Hst()}function Kst(){oa("[");const e=V6();return oa("]"),e}function Xst(){var e,t,n;for(e=Vst();;)if(ir("."))n=Gst(),e=yde(".",e,n);else if(ir("("))t=qst(),e=Mst(e,t);else if(ir("["))n=Kst(),e=yde("[",e,n);else break;return e}function wde(){const e=Xst();if(zn.type===ho&&(ir("++")||ir("--")))throw new Error(Ux);return e}function _T(){var e,t;if(zn.type!==ho&&zn.type!==Fd)t=wde();else{if(ir("++")||ir("--"))throw new Error(Ux);if(ir("+")||ir("-")||ir("~")||ir("!"))e=po(),t=_T(),t=Lst(e.value,t);else{if(W6("delete")||W6("void")||W6("typeof"))throw new Error(Ux);t=wde()}}return t}function _de(e){let t=0;if(e.type!==ho&&e.type!==Fd)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Yst(){var e,t,n,r,i,a,o,s,u,l;if(e=zn,u=_T(),r=zn,i=_de(r),i===0)return u;for(r.prec=i,po(),t=[e,zn],o=_T(),a=[u,r,o];(i=_de(zn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=vde(s,u,o),a.push(n);r=po(),r.prec=i,a.push(r),t.push(zn),n=_T(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=vde(a[l-1].value,a[l-2],n),l-=2;return n}function jp(){var e,t,n;return e=Yst(),ir("?")&&(po(),t=jp(),oa(":"),n=jp(),e=Pst(e,t,n)),e}function V6(){const e=jp();if(ir(","))throw new Error(Ux);return e}function Sde(e){at=e,we=0,aa=at.length,zn=null,mde();const t=V6();if(zn.type!==zx)throw new Error("Unexpect token after expression.");return t}var Ede={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Cde(e){function t(o,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(o,s,u){return l=>t(o,l,s,u)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Se("Missing arguments to clamp function."),o.length>3&&Se("Too many arguments to clamp function.");const s=o.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&Se("Missing arguments to if function."),o.length>3&&Se("Too many arguments to if function.");const s=o.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function Zst(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function Ade(e){e=e||{};const t=e.allowed?tu(e.allowed):{},n=e.forbidden?tu(e.forbidden):{},r=e.constants||Ede,i=(e.functions||Cde)(f),a=e.globalvar,o=e.fieldvar,s=Lt(a)?a:p=>"".concat(a,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(Bn(p))return p;const g=d[p.type];return g==null&&Se("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:_t(n,g)?Se("Illegal identifier: "+g):_t(r,g)?r[g]:_t(t,g)?g:(u[g]=1,s(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===o&&(l[Zst(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Se("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=_t(i,g)&&i[g];return v||Se("Unrecognized function: "+g),Lt(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function Jst(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Qst(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=eut(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function eut(e){return(t,n)=>Jst(e(t),n)}const q6="intersect",kde="union",tut="vlMulti",nut="vlPoint",Tde="or",rut="and",iut="_vgsid_",aut="E",out="R",sut="R-E",uut="R-LE",lut="R-RE",ST="index:unit";function Ode(e,t){for(var n=t.fields,r=t.values,i=n.length,a=0,o,s;a<i;++a)if(s=n[a],s.getter=io.getter||io(s.field),o=s.getter(e),Zf(o)&&(o=Zi(o)),Zf(r[a])&&(r[a]=Zi(r[a])),Zf(r[a][0])&&(r[a]=r[a].map(Zi)),s.type===aut){if(ut(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(s.type===out){if(!fv(o,r[a]))return!1}else if(s.type===lut){if(!fv(o,r[a],!0,!1))return!1}else if(s.type===sut){if(!fv(o,r[a],!1,!1))return!1}else if(s.type===uut&&!fv(o,r[a],!1,!0))return!1;return!0}function cut(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],a=r?r[ST]&&r[ST].value:void 0,o=n===q6,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],a&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=Ode(t,l),c[d]=h?-1:++f,h&&a.size===1)return!0;if(!h&&f===a.get(d).count)return!1}else if(h=Ode(t,l),o^h)return h;return s&&o}const H6=io(iut),Ide=Qst(H6),fut=Ide.left,dut=Ide.right;function hut(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],a=r?r[ST]&&r[ST].value:void 0,o=n===q6,s=H6(t),u=fut(i,s);if(u===i.length||H6(i[u])!==s)return!1;if(a&&o){if(a.size===1)return!0;if(dut(i,s)-u<a.size)return!1}return!0}function put(e,t){return e.map(n=>Rt({values:t.fields.map(r=>(r.getter||(r.getter=io(r.field)))(n.datum))},t))}function gut(e,t,n,r){for(var i=this.context.data[e],a=i?i.values.value:[],o={},s={},u={},l,c,f,d,h,p,g,m,v,y=a.length,b=0,x,w;b<y;++b){for(l=a[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],p=o[h.field]||(o[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),v=Nde[m+"_union"],p[d]=v(g,wt(f[x]));n&&(g=s[d]||(s[d]=[]),g.push(wt(f).reduce((S,C,_)=>(S[c[_].field]=C,S),{})))}if(t=t||kde,Object.keys(o).forEach(S=>{o[S]=Object.keys(o[S]).map(C=>o[S][C]).reduce((C,_)=>C===void 0?_:Nde[u[S]+"_"+t](C,_))}),a=Object.keys(s),n&&a.length){const S=r?nut:tut;o[S]=t===kde?{[Tde]:a.reduce((C,_)=>(C.push(...s[_]),C),[])}:{[rut]:a.map(C=>({[Tde]:s[C]}))}}return o}var Nde={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const mut=":",vut="@";function G6(e,t,n,r){t[0].type!==Lp&&Se("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&sn(t).value,o="unit",s=vut+o,u=mut+i;a===q6&&!_t(r,s)&&(r[s]=n.getData(i).indataRef(n,o)),_t(r,u)||(r[u]=n.getData(i).tuplesRef())}function Dde(e){const t=this.context.data[e];return t?t.values.value:[]}function yut(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function but(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ls).insert(t)),1}function xut(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Gx=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},wut=Gx("format"),Rde=Gx("timeFormat"),_ut=Gx("utcFormat"),Sut=Gx("timeParse"),Eut=Gx("utcParse"),ET=new Date(2e3,0,1);function CT(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(ET.setYear(2e3),ET.setMonth(e),ET.setDate(t),Rde.call(this,ET,n))}function Cut(e){return CT.call(this,e,1,"%B")}function Aut(e){return CT.call(this,e,1,"%b")}function kut(e){return CT.call(this,0,2+e,"%A")}function Tut(e){return CT.call(this,0,2+e,"%a")}const Out=":",Iut="@",K6="%",Fde="$";function X6(e,t,n,r){t[0].type!==Lp&&Se("First argument to data functions must be a string literal.");const i=t[0].value,a=Out+i;if(!_t(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Nut(e,t,n,r){t[0].type!==Lp&&Se("First argument to indata must be a string literal."),t[1].type!==Lp&&Se("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=Iut+a;_t(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function go(e,t,n,r){if(t[0].type===Lp)Mde(n,r,t[0].value);else for(e in n.scales)Mde(n,r,e)}function Mde(e,t,n){const r=K6+n;if(!_t(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function Mc(e,t){let n;return Lt(e)?e:Bn(e)?(n=t.scales[e])&&n.value:void 0}function Dut(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=go,n._range=go,n._scale=go;const r=i=>"_["+(i.type===Lp?gt(K6+i.value):gt(K6)+"+"+e(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(e(i[1]),")")}}function Y6(e,t){return function(n,r,i){if(n){const a=Mc(n,(i||this).context);return a&&a.path[e](r)}else return t(r)}}const Rut=Y6("area",ant),Fut=Y6("bounds",lnt),Mut=Y6("centroid",gnt);function Put(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Z6(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function $ut(){return Z6(this.context.dataflow,"warn",arguments)}function Lut(){return Z6(this.context.dataflow,"info",arguments)}function But(){return Z6(this.context.dataflow,"debug",arguments)}function J6(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Q6(e){const t=hd(e),n=J6(t.r),r=J6(t.g),i=J6(t.b);return .2126*n+.7152*r+.0722*i}function zut(e,t){const n=Q6(e),r=Q6(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function jut(){const e=[].slice.call(arguments);return e.unshift({}),Rt(...e)}function Pde(e,t){return e===t||e!==e&&t!==t?!0:ut(e)?ut(t)&&e.length===t.length?Uut(e,t):!1:Nt(e)&&Nt(t)?$de(e,t):!1}function Uut(e,t){for(let n=0,r=e.length;n<r;++n)if(!Pde(e[n],t[n]))return!1;return!0}function $de(e,t){for(const n in e)if(!Pde(e[n],t[n]))return!1;return!0}function Lde(e){return t=>$de(e,t)}function Wut(e,t,n,r,i,a){const o=this.context.dataflow,s=this.context.data[e],u=s.input,l=o.stamp();let c=s.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{s.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?ls:ut(n)||JC(n)?n:Lde(n),c.remove(f)),t&&c.insert(t),r&&(f=Lde(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in a)c.modify(i,d,a[d]);return 1}function Vut(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function qut(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Bde={};function Hut(e,t){const n=Bde[t]||(Bde[t]=io(t));return ut(e)?e.map(n):n(e)}function ej(e){return ut(e)||ArrayBuffer.isView(e)?e:null}function tj(e){return ej(e)||(Bn(e)?e:null)}function Gut(e,...t){return ej(e).join(...t)}function Kut(e,...t){return tj(e).indexOf(...t)}function Xut(e,...t){return tj(e).lastIndexOf(...t)}function Yut(e,...t){return tj(e).slice(...t)}function Zut(e,t,n){return Lt(n)&&Se("Function argument passed to replace."),String(e).replace(t,n)}function Jut(e){return ej(e).slice().reverse()}function Qut(e,t,n){return RB(e||0,t||0,n||0)}function elt(e,t){const n=Mc(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function tlt(e,t){const n=Mc(e,(t||this).context);return n?n.copy():void 0}function nlt(e,t){const n=Mc(e,(t||this).context);return n?n.domain():[]}function rlt(e,t,n){const r=Mc(e,(n||this).context);return r?ut(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function ilt(e,t){const n=Mc(e,(t||this).context);return n&&n.range?n.range():[]}function alt(e,t,n){const r=Mc(e,(n||this).context);return r?r(t):void 0}function olt(e,t,n,r,i){e=Mc(e,(i||this).context);const a=Gse(t,n);let o=e.domain(),s=o[0],u=sn(o),l=Oa;return u-s?l=Dse(e,s,u):e=(e.interpolator?Sn("sequential")().interpolator(e.interpolator()):Sn("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(o=e.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==sn(o)&&o.push(u)),o.forEach(c=>a.stop(l(c),e(c))),a}function slt(e,t,n){const r=Mc(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function ult(e){let t=null;return function(n){return n?Y1(n,t=t||Fv(e)):e}}const zde=e=>e.data;function jde(e,t){const n=Dde.call(t,e);return n.root&&n.root.lookup||{}}function llt(e,t,n){const r=jde(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(zde):void 0}function clt(e,t){const n=jde(e,this)[t];return n?n.ancestors().map(zde):void 0}const Ude=()=>typeof window!="undefined"&&window||null;function flt(){const e=Ude();return e?e.screen:{}}function dlt(){const e=Ude();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function hlt(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function plt(e,t,n){if(!e)return[];const[r,i]=e,a=new li().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return sle(o,a,glt(t))}function glt(e){let t=null;if(e){const n=wt(e.marktype),r=wt(e.markname);t=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return t}const Kx={random(){return ds()},cumulativeNormal:oA,cumulativeLogNormal:fL,cumulativeUniform:gL,densityNormal:oL,densityLogNormal:cL,densityUniform:pL,quantileNormal:sA,quantileLogNormal:dL,quantileUniform:mL,sampleNormal:aA,sampleLogNormal:lL,sampleUniform:hL,isArray:ut,isBoolean:a4,isDate:Zf,isDefined(e){return e!==void 0},isNumber:Jf,isObject:Nt,isRegExp:nre,isString:Bn,isTuple:JC,isValid(e){return e!=null&&e===e},toBoolean:s4,toDate:u4,toNumber:Zi,toString:l4,indexof:Kut,join:Gut,lastindexof:Xut,replace:Zut,reverse:Jut,slice:Yut,flush:ere,lerp:rre,merge:jut,pad:ore,peek:sn,pluck:Hut,span:u1,inrange:fv,truncate:sre,rgb:hd,lab:_A,hcl:SA,hsl:xA,luminance:Q6,contrast:zut,sequence:Bo,format:wut,utcFormat:_ut,utcParse:Eut,utcOffset:Qre,utcSequence:nie,timeFormat:Rde,timeParse:Sut,timeOffset:Jre,timeSequence:tie,timeUnitSpecifier:jre,monthFormat:Cut,monthAbbrevFormat:Aut,dayFormat:kut,dayAbbrevFormat:Tut,quarter:Yne,utcquarter:Zne,week:Wre,utcweek:Hre,dayofyear:Ure,utcdayofyear:qre,warn:$ut,info:Lut,debug:But,extent:tl,inScope:Put,intersect:plt,clampRange:Jne,pinchDistance:Vut,pinchAngle:qut,screen:flt,containerSize:hlt,windowSize:dlt,bandspace:Qut,setdata:but,pathShape:ult,panLinear:Hne,panLog:Gne,panPow:Kne,panSymlog:Xne,zoomLinear:e4,zoomLog:t4,zoomPow:$C,zoomSymlog:n4,encode:xut,modify:Wut},mlt=["view","item","group","xy","x","y"],vlt="event.vega.",Wde="this.",nj={},Vde={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(gt(Fde+e),"]"),functions:ylt,constants:Ede,visitors:nj},rj=Ade(Vde);function ylt(e){const t=Cde(e);mlt.forEach(n=>t[n]=vlt+n);for(const n in Kx)t[n]=Wde+n;return Rt(t,Dut(e,Kx,nj)),t}function Zr(e,t,n){return arguments.length===1?Kx[e]:(Kx[e]=t,n&&(nj[e]=n),rj&&(rj.functions[e]=Wde+e),this)}Zr("bandwidth",elt,go),Zr("copy",tlt,go),Zr("domain",nlt,go),Zr("range",ilt,go),Zr("invert",rlt,go),Zr("scale",alt,go),Zr("gradient",olt,go),Zr("geoArea",Rut,go),Zr("geoBounds",Fut,go),Zr("geoCentroid",Mut,go),Zr("geoShape",slt,go),Zr("indata",yut,Nut),Zr("data",Dde,X6),Zr("treePath",llt,X6),Zr("treeAncestors",clt,X6),Zr("vlSelectionTest",cut,G6),Zr("vlSelectionIdTest",hut,G6),Zr("vlSelectionResolve",gut,G6),Zr("vlSelectionTuples",put);function xl(e,t){const n={};let r;try{e=Bn(e)?e:gt(e)+"",r=Sde(e)}catch(a){Se("Expression parse error: "+e)}r.visit(a=>{if(a.type!==lde)return;const o=a.callee.name,s=Vde.visitors[o];s&&s(o,a.arguments,t,n)});const i=rj(r);return i.globals.forEach(a=>{const o=Fde+a;!_t(n,o)&&t.getSignal(a)&&(n[o]=t.signalRef(a))}),{$expr:Rt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function blt(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const xlt=tu(["rule"]),qde=tu(["group","image","rect"]);function wlt(e,t){let n="";return xlt[t]||(e.x2&&(e.x?(qde[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(qde[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function ij(e){return(e+"").toLowerCase()}function _lt(e){return ij(e)==="operator"}function Slt(e){return ij(e)==="collect"}function Xx(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Elt(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var Clt={operator:(e,t)=>Xx(e,["_"],t.code),parameter:(e,t)=>Xx(e,["datum","_"],t.code),event:(e,t)=>Xx(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Xx(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+gt(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=wlt(r,n),i+="return m;",Xx(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(gt).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(a,o)=>{const s=t[o];let u,l;return a.path?(u="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),Elt(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Alt(e){const t=this;_lt(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function klt(e){const t=this;if(e.params){const n=t.get(e.id);n||Se("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Tlt(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ut(i)?i.map(a=>Hde(a,n,t)):Hde(i,n,t)}return t}function Hde(e,t,n){if(!e||!Nt(e))return e;for(let r=0,i=Gde.length,a;r<i;++r)if(a=Gde[r],_t(e,a.key))return a.parse(e,t,n);return e}var Gde=[{key:"$ref",parse:Olt},{key:"$key",parse:Nlt},{key:"$expr",parse:Ilt},{key:"$field",parse:Dlt},{key:"$encode",parse:Flt},{key:"$compare",parse:Rlt},{key:"$context",parse:Mlt},{key:"$subflow",parse:Plt},{key:"$tupleid",parse:$lt}];function Olt(e,t){return t.get(e.$ref)||Se("Operator not defined: "+e.$ref)}function Ilt(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=ro(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Nlt(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=o4(e.$key,e.$flat,t.expr.codegen))}function Dlt(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=io(e.$field,e.$name,t.expr.codegen))}function Rlt(e,t){const n="c:"+e.$compare+"_"+e.$order,r=wt(e.$compare).map(i=>i&&i.$tupleid?lt:i);return t.fn[n]||(t.fn[n]=r4(r,e.$order,t.expr.codegen))}function Flt(e,t){const n=e.$encode,r={};for(const i in n){const a=n[i];r[i]=ro(t.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function Mlt(e,t){return t}function Plt(e,t){const n=e.$subflow;return function(r,i,a){const o=t.fork().parse(n),s=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(a),s.detachSubflow=()=>t.detach(o),s}}function $lt(){return lt}function Llt(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(a=>t.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(a=>t.get(a)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Se("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Blt(e){var t=this,n=Nt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=void 0;r||Se("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(o=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,r,i,a,o)}const zlt={skip:!0};function jlt(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(a=>{const o=t.signals[a];e.signals(a,o)&&(r[a]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(a=>{const o=t.data[a];e.data(a,o)&&(i[a]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function Ult(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(a=>{n.update(t.signals[a],i[a],zlt)}),Object.keys(r||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(ls).insert(r[a]))}),(e.subcontext||[]).forEach((a,o)=>{const s=t.subcontext[o];s&&s.setState(a)})}function Kde(e,t,n,r){return new Xde(e,t,n,r)}function Xde(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Clt,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Yde(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Xde.prototype=Yde.prototype={fork(){const e=new Yde(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),Slt(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(r.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),r.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const o=n.data[a]||(n.data[a]={});e.data[a].forEach(s=>o[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[ij(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:blt,parseOperator:Alt,parseOperatorParameters:klt,parseParameters:Tlt,parseStream:Llt,parseUpdate:Blt,getState:jlt,setState:Ult};function Wlt(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Zde(t,e.description()))}function Zde(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Vlt(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const aj="default";function qlt(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:aj,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,a=i?Bn(i)?i:i.user:aj,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Bn(r)||(i=r.item,r=r.user),oj(e,r&&r!==aj?r:i||r),i},{cursor:t})}function oj(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function AT(e,t){var n=e._runtime.data;return _t(n,t)||Se("Unrecognized data set: "+t),n[t]}function Hlt(e,t){return arguments.length<2?AT(this,e).values.value:kT.call(this,e,mp().remove(ls).insert(t))}function kT(e,t){$ie(t)||Se("Second argument to changes must be a changeset.");const n=AT(this,e);return n.modified=!0,this.pulse(n.input,t)}function Glt(e,t){return kT.call(this,e,mp().insert(t))}function Klt(e,t){return kT.call(this,e,mp().remove(t))}function Jde(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Qde(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function TT(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Xlt(e){var t=TT(e),n=Jde(e),r=Qde(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){e.error(a)}})}function Ylt(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,s;return i&&(s=TT(e),o=t.changedTouches?t.changedTouches[0]:t,a=ik(o,i),a[0]-=s[0],a[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Zlt(e,n,a),t}function Zlt(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var s=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function a(o){if(!o)return n;Bn(o)&&(o=i(o));const s=n.slice();for(;o;)s[0]-=o.x||0,s[1]-=o.y||0,o=o.mark&&o.mark.group;return s}return{view:Ji(e),item:Ji(t||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const ehe="view",Jlt="timer",Qlt="window",ect={trap:!1};function tct(e){const t=Rt({defaults:{}},e),n=(r,i)=>{i.forEach(a=>{ut(r[a])&&(r[a]=tu(r[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function the(e,t,n,r){e._eventListeners.push({type:n,sources:wt(t),handler:r})}function nct(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function OT(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Nt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function rct(e,t,n){var r=this,i=new nA(n),a=function(l,c){r.runAsync(null,()=>{e===ehe&&nct(r,t)&&l.preventDefault(),i.receive(Ylt(r,l,c))})},o;if(e===Jlt)OT(r,"timer",t)&&r.timer(a,t);else if(e===ehe)OT(r,"view",t)&&r.addEventListener(t,a,ect);else if(e===Qlt?OT(r,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&OT(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=o.length;s<u;++s)o[s].addEventListener(t,a);the(r,o,t,a)}return i}function nhe(e){return e.item}function rhe(e){return e.item.mark.source}function ihe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function ict(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",nhe),rhe,ihe(e)),this.on(this.events("view","mouseout",nhe),rhe,ihe(t)),this}function act(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return e&&e.call(this,this._handler,null,null,null),this}function qo(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const oct="vega-bind",sct="vega-bind-name",uct="vega-bind-radio";function lct(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=i4(r.debounce,i.update))),(r.input==null&&r.element?cct:dct)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function cct(e,t,n,r){const i=n.event||"input",a=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,a),the(r,t,i,a),e.set=o=>{t.value=o,t.dispatchEvent(fct(i))}}function fct(e){return typeof Event!="undefined"?new Event(e):{type:e}}function dct(e,t,n,r){const i=r.signal(n.signal),a=qo("div",{class:oct}),o=n.input==="radio"?a:a.appendChild(qo("label"));o.appendChild(qo("span",{class:sct},n.name||n.signal)),t.appendChild(a);let s=hct;switch(n.input){case"checkbox":s=pct;break;case"select":s=gct;break;case"radio":s=mct;break;case"range":s=vct;break}s(e,o,n,i)}function hct(e,t,n,r){const i=qo("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=a=>i.value=a}function pct(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=qo("input",i);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=o=>a.checked=!!o||null}function gct(e,t,n,r){const i=qo("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,s)=>{const u={value:o};IT(o,r)&&(u.selected=!0),i.appendChild(qo("option",u,(a[s]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let s=0,u=n.options.length;s<u;++s)if(IT(n.options[s],o)){i.selectedIndex=s;return}}}function mct(e,t,n,r){const i=qo("span",{class:uct}),a=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,s)=>{const u={type:"radio",name:n.signal,value:o};IT(o,r)&&(u.checked=!0);const l=qo("input",u);l.addEventListener("change",()=>e.update(o));const c=qo("label",{},(a[s]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)IT(s[l].value,o)&&(s[l].checked=!0)}}function vct(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||ed(a,i,100),s=qo("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=qo("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function IT(e,t){return e===t||e+""==t+""}function ahe(e,t,n,r,i,a){return t=t||new r(e.loader()),t.initialize(n,Jde(e),Qde(e),TT(e),i,a).background(e.background())}function sj(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function yct(e,t,n,r){const i=new r(e.loader(),sj(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,TT(e),e);return t&&t.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function bct(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,a=hk(r);e=n._el=e?uj(n,e,!0):null,Wlt(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||cx,s=e?a.renderer:a.headless;return n._renderer=s?ahe(n,n._renderer,e,s):null,n._handler=yct(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=uj(n,t,!0):e.appendChild(qo("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=uj(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{lct(n,u.element||t,u)})),n}function uj(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const Yx=e=>+e||0,xct=e=>({top:e,bottom:e,left:e,right:e});function ohe(e){return Nt(e)?{top:Yx(e.top),bottom:Yx(e.bottom),left:Yx(e.left),right:Yx(e.right)}:xct(Yx(e))}async function lj(e,t,n,r){const i=hk(t),a=i&&i.headless;return a||Se("Unrecognized renderer type: "+t),await e.runAsync(),ahe(e,null,null,a,n,r).renderAsync(e._scenegraph.root)}async function wct(e,t){e!==Cd.Canvas&&e!==Cd.SVG&&e!==Cd.PNG&&Se("Unrecognized image type: "+e);const n=await lj(this,e,t);return e===Cd.SVG?_ct(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function _ct(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Sct(e,t){return(await lj(this,Cd.Canvas,e,t)).canvas()}async function Ect(e){return(await lj(this,Cd.SVG,e)).svg()}function Cct(e,t,n){return Kde(e,xv,Kx,n).parse(t)}function Act(e){var t=this._runtime.scales;return _t(t,e)||Se("Unrecognized scale or projection: "+e),t[e].value}var she="width",uhe="height",cj="padding",lhe={skip:!0};function che(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===cj?r.left+r.right:0)}function fhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===cj?r.top+r.bottom:0)}function kct(e){var t=e._signals,n=t[she],r=t[uhe],i=t[cj];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=che(e,s.size),a()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=fhe(e,s.size),a()},{size:r});const o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function Tct(e,t,n,r,i,a){this.runAfter(o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(she,n,lhe),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal(uhe,r,lhe),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(u=>u.resize())},!1,1)}function Oct(e){return this._runtime.getState(e||{data:Ict,signals:Nct,recurse:!0})}function Ict(e,t){return t.modified&&ut(t.input.value)&&e.indexOf("_:vega:_")}function Nct(e,t){return!(e==="parent"||t instanceof xv.proxy)}function Dct(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Rct(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(mit(n,t))}function Fct(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Mct(r))}function Mct(e){return e==null?"":ut(e)?dhe(e):Nt(e)&&!Zf(e)?Pct(e):e+""}function Pct(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ut(n)?dhe(n):hhe(n))}).join(`
`)}function dhe(e){return"["+e.map(hhe).join(", ")+"]"}function hhe(e){return ut(e)?"[\u2026]":Nt(e)&&!Zf(e)?"{\u2026}":e}function phe(e,t){const n=this;if(t=t||{},bv.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Rt({},e.locale,t.locale);n.locale(Die(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Cd.Canvas,n._scenegraph=new Sz;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Fct,n._redraw=!0,n._handler=new cx().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=tct(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=Cct(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Rt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=che(n,n._width),n._viewHeight=fhe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,kct(n),Vlt(n),qlt(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function NT(e,t){return _t(e._signals,t)?e._signals[t]:Se("Unrecognized signal name: "+gt(t))}function ghe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function mhe(e,t,n,r){let i=ghe(n,r);return i||(i=sj(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function vhe(e,t,n){const r=ghe(t,n);return r&&t._targets.remove(r),e}$e(phe,bv,{async evaluate(e,t,n){if(await bv.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Xlt(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&ZC(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Zde(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=NT(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",ohe(e)):ohe(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(hk(e)||Se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(bv.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(NT(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Tct,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=sj(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return mhe(this,e,NT(this,e),t)},removeSignalListener(e,t){return vhe(this,NT(this,e),t)},addDataListener(e,t){return mhe(this,e,AT(this,e).values,t)},removeDataListener(e,t){return vhe(this,AT(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=oj(this,null);this._globalCursor=!!e,t&&oj(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Rct,events:rct,finalize:act,hover:ict,data:Hlt,change:kT,insert:Glt,remove:Klt,scale:Act,initialize:bct,toImageURL:wct,toCanvas:Sct,toSVG:Ect,getState:Oct,setState:Dct});const $ct="view",DT="[",RT="]",yhe="{",bhe="}",Lct=":",xhe=",",Bct="@",zct=">",jct=/[[\]{}]/,Uct={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let whe,_he;function Md(e,t,n){return whe=t||$ct,_he=n||Uct,She(e.trim()).map(fj)}function Wct(e){return _he[e]}function Zx(e,t,n,r,i){const a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;i&&i.indexOf(s)>=0?--o:r&&r.indexOf(s)>=0&&++o}return t}function She(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Zx(e,i,xhe,DT+yhe,RT+bhe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function fj(e){return e[0]==="["?Vct(e):qct(e)}function Vct(e){const t=e.length;let n=1,r;if(n=Zx(e,n,RT,DT,RT),n===t)throw"Empty between selector: "+e;if(r=She(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==zct)throw"Expected '>' after between selector: "+e;r=r.map(fj);const i=fj(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function qct(e){const t={source:whe},n=[];let r=[0,0],i=0,a=0,o=e.length,s=0,u,l;if(e[o-1]===bhe){if(s=e.lastIndexOf(yhe),s>=0){try{r=Hct(e.substring(s+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),o=e.length}else throw"Unmatched right brace: "+e;s=0}if(!o)throw e;if(e[0]===Bct&&(i=++s),u=Zx(e,s,Lct),u<o&&(n.push(e.substring(a,u).trim()),a=s=++u),s=Zx(e,s,DT),s===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),l=[],a=++s,a===o)throw"Unmatched left bracket: "+e;for(;s<o;){if(s=Zx(e,s,RT),s===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==DT)throw"Expected left bracket: "+e;a=++s}if(!(o=n.length)||jct.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):Wct(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Hct(e){const t=e.split(xhe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Gct(e){return Nt(e)?e:{type:e||"pad"}}const Jx=e=>+e||0,Kct=e=>({top:e,bottom:e,left:e,right:e});function Xct(e){return Nt(e)?e.signal?e:{top:Jx(e.top),bottom:Jx(e.bottom),left:Jx(e.left),right:Jx(e.right)}:Kct(Jx(e))}const Ei=e=>Nt(e)&&!ut(e)?Rt({},e):{value:e};function Ehe(e,t,n,r){return n!=null?(Nt(n)&&!ut(n)||ut(n)&&n.length&&Nt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Ui(e,t,n){for(const r in t)Ehe(e,r,t[r]);for(const r in n)Ehe(e,r,n[r],"update")}function n0(e,t,n){for(const r in t)n&&_t(n,r)||(e[r]=Rt(e[r]||{},t[r]));return e}function r0(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const dj="mark",hj="frame",pj="scope",Yct="axis",Zct="axis-domain",Jct="axis-grid",Qct="axis-label",eft="axis-tick",tft="axis-title",nft="legend",rft="legend-band",ift="legend-entry",aft="legend-gradient",Che="legend-label",oft="legend-symbol",sft="legend-title",uft="title",lft="title-text",cft="title-subtitle";function fft(e,t,n,r,i){const a={},o={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!r0(u,e)&&gj(a,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===hj?i.group:n===dj?Rt({},i.mark,i[t]):null;for(u in c)l=r0(u,e)||(u==="fill"||u==="stroke")&&(r0("fill",e)||r0("stroke",e)),l||gj(a,u,c[u]);wt(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)r0(h,e)||gj(a,h,d[h])}),e=Rt({},e);for(u in a)c=a[u],c.signal?(s=s||{})[u]=c:o[u]=c;return e.enter=Rt(o,e.enter),s&&(e.update=Rt(s,e.update)),e}function gj(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const Ahe=e=>Bn(e)?gt(e):e.signal?"(".concat(e.signal,")"):khe(e);function FT(e){if(e.gradient!=null)return hft(e);let t=e.signal?"(".concat(e.signal,")"):e.color?dft(e.color):e.field!=null?khe(e.field):e.value!==void 0?gt(e.value):void 0;return e.scale!=null&&(t=pft(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat(PT(e.exponent),")")),e.mult!=null&&(t+="*".concat(PT(e.mult))),e.offset!=null&&(t+="+".concat(PT(e.offset))),e.round&&(t="round(".concat(t,")")),t}const MT=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(FT).join(","),")+'')");function dft(e){return e.c?MT("hcl",e.h,e.c,e.l):e.h||e.s?MT("hsl",e.h,e.s,e.l):e.l||e.a?MT("lab",e.l,e.a,e.b):e.r||e.g||e.b?MT("rgb",e.r,e.g,e.b):null}function hft(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:gt(n));for(;t.length&&sn(t)==null;)t.pop();return t.unshift(Ahe(e.gradient)),"gradient(".concat(t.join(","),")")}function PT(e){return Nt(e)?"("+FT(e)+")":e}function khe(e){return The(Nt(e)?e:{datum:e})}function The(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Se("Invalid field reference: "+gt(e));return e.signal||(r=Bn(r)?IC(r).map(gt).join("]["):The(r)),t+"["+r+"]"}function pft(e,t){const n=Ahe(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+PT(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function gft(e){let t="";return e.forEach(n=>{const r=FT(n);t+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),sn(t)===":"&&(t+="null"),t}function Ohe(e,t,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},e=fft(e,t,n,r,i.config);for(const s in e)o[s]=mft(e[s],t,a,i);return a}function mft(e,t,n,r){const i={},a={};for(const o in e)e[o]!=null&&(i[o]=yft(vft(e[o]),r,n,a));return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function vft(e){return ut(e)?gft(e):FT(e)}function yft(e,t,n,r){const i=xl(e,t);return i.$fields.forEach(a=>r[a]=1),Rt(n,i.$params),i.$expr}const bft="outer",xft=["value","update","init","react","bind"];function Ihe(e,t){Se(e+' for "outer" push: '+gt(t))}function Nhe(e,t){const n=e.name;if(e.push===bft)t.signals[n]||Ihe("No prior signal definition",n),xft.forEach(r=>{e[r]!==void 0&&Ihe("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function mj(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function $T(e,t,n,r){return new mj(e,t,n,r)}function LT(e,t){return $T("operator",e,t)}function ft(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Qx(e,t){return t?{$field:e,$name:t}:{$field:e}}const vj=Qx("key");function Dhe(e,t){return{$compare:e,$order:t}}function wft(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const _ft="ascending",Sft="descending";function Eft(e){return Nt(e)?(e.order===Sft?"-":"+")+BT(e.op,e.field):""}function BT(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const yj="scope",bj="view";function fi(e){return e&&e.signal}function Cft(e){return e&&e.expr}function zT(e){if(fi(e))return!0;if(Nt(e)){for(const t in e)if(zT(e[t]))return!0}return!1}function hu(e,t){return e??t}function Up(e){return e&&e.signal||e}const Rhe="timer";function ew(e,t){return(e.merge?kft:e.stream?Tft:e.type?Oft:Se("Invalid stream specification: "+gt(e)))(e,t)}function Aft(e){return e===yj?bj:e||bj}function kft(e,t){const n=e.merge.map(i=>ew(i,t)),r=xj({merge:n},e,t);return t.addStream(r).id}function Tft(e,t){const n=ew(e.stream,t),r=xj({stream:n},e,t);return t.addStream(r).id}function Oft(e,t){let n;e.type===Rhe?(n=t.event(Rhe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Aft(e.source),e.type);const r=xj({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function xj(e,t,n){let r=t.between;return r&&(r.length!==2&&Se('Stream "between" parameter must have 2 entries: '+gt(t)),e.between=[ew(r[0],n),ew(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Ift(t.marktype,t.markname,t.markrole)),t.source===yj&&r.push("inScope(event.item)"),r.length&&(e.filter=xl("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Ift(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Nft={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Dft(e,t,n){const r=e.encode,i={target:n};let a=e.events,o=e.update,s=[];a||Se("Signal update missing events specification."),Bn(a)&&(a=Md(a,t.isSubscope()?yj:bj)),a=wt(a).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Fft(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&Se("Signal encode and update are mutually exclusive."),o="encode(item(),"+gt(r)+")"),i.update=Bn(o)?xl(o,t):o.expr!=null?xl(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:Nft,$params:{$value:t.signalRef(o.signal)}}:Se("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(Rt(Rft(u,t),i)))}function Rft(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):ew(e,t)}}function Fft(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Mft(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=xl(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Dft(i,t,n.id))}const Vn=e=>(t,n,r)=>$T(e,n,t||void 0,r),Fhe=Vn("aggregate"),Pft=Vn("axisticks"),Mhe=Vn("bound"),pu=Vn("collect"),Phe=Vn("compare"),$ft=Vn("datajoin"),$he=Vn("encode"),Lft=Vn("expression"),Bft=Vn("facet"),zft=Vn("field"),jft=Vn("key"),Uft=Vn("legendentries"),Wft=Vn("load"),Vft=Vn("mark"),qft=Vn("multiextent"),Hft=Vn("multivalues"),Gft=Vn("overlap"),Kft=Vn("params"),Lhe=Vn("prefacet"),Xft=Vn("projection"),Yft=Vn("proxy"),Zft=Vn("relay"),Bhe=Vn("render"),Jft=Vn("scale"),Wp=Vn("sieve"),Qft=Vn("sortitems"),zhe=Vn("viewlayout"),edt=Vn("values");let tdt=0;const jhe={min:"min",max:"max",count:"sum"};function ndt(e,t){const n=e.type||"linear";Ase(n)||Se("Unrecognized scale type: "+gt(n)),t.addScale(e.name,{type:n,domain:void 0})}function rdt(e,t){const n=t.getScale(e.name).params;let r;n.domain=Uhe(e.domain,e,t),e.range!=null&&(n.range=Vhe(e,t,n)),e.interpolate!=null&&hdt(e.interpolate,n),e.nice!=null&&(n.nice=ddt(e.nice)),e.bins!=null&&(n.bins=fdt(e.bins,t));for(r in e)_t(n,r)||r==="name"||(n[r]=vs(e[r],t))}function vs(e,t){return Nt(e)?e.signal?t.signalRef(e.signal):Se("Unsupported object: "+gt(e)):e}function jT(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>vs(n,t))}function UT(e){Se("Can not find data set: "+gt(e))}function Uhe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Se("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ut(e)?idt:e.fields?odt:adt)(e,t,n)}function idt(e,t,n){return e.map(r=>vs(r,n))}function adt(e,t,n){const r=n.getData(e.data);return r||UT(e.data),Rv(t.type)?r.valuesRef(n,e.field,Whe(e.sort,!1)):Ose(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function odt(e,t,n){const r=e.data,i=e.fields.reduce((a,o)=>(o=Bn(o)?{data:r,field:o}:ut(o)||o.signal?sdt(o,n):o,a.push(o),a),[]);return(Rv(t.type)?udt:Ose(t.type)?ldt:cdt)(e,n,i)}function sdt(e,t){const n="_:vega:_"+tdt++,r=pu({});if(ut(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+gt(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Wp({})]),{data:n,field:"data"}}function udt(e,t,n){const r=Whe(e.sort,!0);let i,a;const o=n.map(l=>{const c=t.getData(l.data);return c||UT(l.data),c.countsRef(t,l.field,r)}),s={groupby:vj,pulse:o};r&&(i=r.op||"count",a=r.field?BT(i,r.field):"count",s.ops=[jhe[i]],s.fields=[t.fieldRef(a)],s.as=[a]),i=t.add(Fhe(s));const u=t.add(pu({pulse:ft(i)}));return a=t.add(edt({field:vj,sort:t.sortRef(r),pulse:ft(u)})),ft(a)}function Whe(e,t){return e&&(!e.field&&!e.op?Nt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Se("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!jhe[e.op]&&Se("Multiple domain scales can not be sorted using "+e.op)),e}function ldt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||UT(i.data),a.domainRef(t,i.field)});return ft(t.add(Hft({values:r})))}function cdt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||UT(i.data),a.extentRef(t,i.field)});return ft(t.add(qft({extents:r})))}function fdt(e,t){return e.signal||ut(e)?jT(e,t):t.objectProperty(e)}function ddt(e){return Nt(e)?{interval:vs(e.interval),step:vs(e.step)}:vs(e)}function hdt(e,t){t.interpolate=vs(e.type||e),e.gamma!=null&&(t.interpolateGamma=vs(e.gamma))}function Vhe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Bn(i)){if(r&&_t(r,i))return e=Rt({},e,{range:r[i]}),Vhe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Rv(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Se("Unrecognized scale range value: "+gt(i))}else if(i.scheme){n.scheme=ut(i.scheme)?jT(i.scheme,t):vs(i.scheme,t),i.extent&&(n.schemeExtent=jT(i.extent,t)),i.count&&(n.schemeCount=vs(i.count,t));return}else if(i.step){n.rangeStep=vs(i.step,t);return}else{if(Rv(e.type)&&!ut(i))return Uhe(i,e,t);ut(i)||Se("Unsupported range type: "+gt(i))}return i.map(a=>(ut(a)?jT:vs)(a,t))}function pdt(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=wj(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=wj(n[i],i,t));t.addProjection(e.name,r)}function wj(e,t,n){return ut(e)?e.map(r=>wj(r,t,n)):Nt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Se("Unsupported parameter object: "+gt(e)):e}const gu="top",i0="left",a0="right",Pd="bottom",qhe="center",gdt="vertical",mdt="start",vdt="middle",ydt="end",_j="index",Sj="label",bdt="offset",o0="perc",xdt="perc2",ys="value",tw="guide-label",Ej="guide-title",wdt="group-title",_dt="group-subtitle",Hhe="symbol",WT="gradient",Cj="discrete",Aj="size",Sdt="shape",Edt="fill",Cdt="stroke",Adt="strokeWidth",kdt="strokeDash",Tdt="opacity",kj=[Aj,Sdt,Edt,Cdt,Adt,kdt,Tdt],nw={name:1,style:1,interactive:1},pn={value:0},bs={value:1},VT="group",Ghe="rect",Tj="rule",Odt="symbol",Vp="text";function rw(e){return e.type=VT,e.interactive=e.interactive||!1,e}function mo(e,t){const n=(r,i)=>hu(e[r],hu(t[r],i));return n.isVertical=r=>gdt===hu(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>hu(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>hu(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>hu(e.columns,hu(t.columns,+n.isVertical(!0))),n}function Khe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Idt(e,t,n){const r=t.config.style[n];return r&&r[e]}function qT(e,t,n){return"item.anchor === '".concat(mdt,"' ? ").concat(e," : item.anchor === '").concat(ydt,"' ? ").concat(t," : ").concat(n)}const Oj=qT(gt(i0),gt(a0),gt(qhe));function Ndt(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(t.signal,") === 'extent'")},Nt(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function Xhe(e,t){return t?e?Nt(e)?Object.assign({},e,{offset:Xhe(e.offset,t)}):{value:e,offset:t}:t:e}function Ho(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=n0(e.encode,t,nw)):e.interactive=!1,e}function Ddt(e,t,n,r){const i=mo(e,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;a?(l=[0,1],c=[0,0],f=o,d=s):(l=[0,0],c=[1,0],f=s,d=o);const h={enter:u={opacity:pn,x:pn,y:pn,width:Ei(f),height:Ei(d)},update:Rt({},u,{opacity:bs,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:pn}};return Ui(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ho({type:Ghe,role:aft,encode:h},r)}function Rdt(e,t,n,r,i){const a=mo(e,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:pn,fill:{scale:t,field:ys}};p[l]={signal:h+"datum."+o0,mult:u},p[c]=pn,p[f]={signal:h+"datum."+xdt,mult:u},p[d]=Ei(s);const g={enter:p,update:Rt({},p,{opacity:bs}),exit:{opacity:pn}};return Ui(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Ho({type:Ghe,role:rft,key:ys,from:i,encode:g},r)}const Fdt="datum.".concat(o0,'<=0?"').concat(i0,'":datum.').concat(o0,'>=1?"').concat(a0,'":"').concat(qhe,'"'),Mdt="datum.".concat(o0,'<=0?"').concat(Pd,'":datum.').concat(o0,'>=1?"').concat(gu,'":"').concat(vdt,'"');function Yhe(e,t,n,r){const i=mo(e,t),a=i.isVertical(),o=Ei(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:pn},update:c={opacity:bs,text:{field:Sj}},exit:{opacity:pn}};return Ui(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:hu(e.labelLimit,t.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=c.baseline={signal:Mdt},f="y",d="x",h="1-"):(l.align=c.align={signal:Fdt},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+o0,mult:s},l[d]=c[d]=o,o.offset=hu(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+_j}:void 0,Ho({type:Vp,role:Che,style:tw,key:ys,from:r,encode:p,overlap:u},n)}function Pdt(e,t,n,r,i){const a=mo(e,t),o=n.entries,s=!!(o&&o.interactive),u=o?o.name:void 0,l=a("clipHeight"),c=a("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(bdt," : datum.").concat(Aj),h=l?Ei(l):{field:Aj},p="datum.".concat(_j),g="max(1, ".concat(i,")");let m,v,y,b,x;h.mult=.5,m={enter:v={opacity:pn,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:bs,x:v.x,y:v.y},exit:{opacity:pn}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Ui(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",S),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),kj.forEach(A=>{e[A]&&(y[A]=v[A]={scale:e[A],field:ys})});const C=Ho({type:Odt,role:oft,key:ys,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=Ei(c);_.offset=a("labelOffset"),m={enter:v={opacity:pn,x:{signal:d,offset:_},y:h},update:y={opacity:bs,text:{field:Sj},x:v.x,y:v.y},exit:{opacity:pn}},Ui(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const E=Ho({type:Vp,role:Che,style:tw,key:ys,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:pn,height:l?Ei(l):pn,opacity:pn},exit:{opacity:pn},update:y={opacity:bs,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),r={facet:{data:r,name:"value",groupby:_j}},rw({role:pj,from:r,encode:n0(m,o,nw),marks:[C,E],name:u,interactive:s,sort:x})}function $dt(e,t){const n=mo(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Ij='item.orient === "left"',Nj='item.orient === "right"',HT="(".concat(Ij," || ").concat(Nj,")"),Ldt="datum.vgrad && ".concat(HT),Bdt=qT('"top"','"bottom"','"middle"'),zdt=qT('"right"','"left"','"center"'),jdt="datum.vgrad && ".concat(Nj," ? (").concat(zdt,") : (").concat(HT," && !(datum.vgrad && ").concat(Ij,')) ? "left" : ').concat(Oj),Udt="item._anchor || (".concat(HT,' ? "middle" : "start")'),Wdt="".concat(Ldt," ? (").concat(Ij," ? -90 : 90) : 0"),Vdt="".concat(HT," ? (datum.vgrad ? (").concat(Nj,' ? "bottom" : "top") : ').concat(Bdt,') : "top"');function qdt(e,t,n,r){const i=mo(e,t),a={enter:{opacity:pn},update:{opacity:bs,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:pn}};return Ui(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Udt},angle:{signal:Wdt},align:{signal:jdt},baseline:{signal:Vdt},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ho({type:Vp,role:sft,style:Ej,from:r,encode:a},n)}function Hdt(e,t){let n;return Nt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Zhe(e.path)+")":e.sphere&&(n="geoShape("+Zhe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Zhe(e){return Nt(e)&&e.signal?e.signal:gt(e)}function Jhe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===VT?pj:t||dj}function Gdt(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Jhe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Kdt(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Dj(e,t){const n=Hie(e.type);n||Se("Unrecognized transform type: "+gt(e.type));const r=$T(n.type.toLowerCase(),null,Qhe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function Qhe(e,t,n){const r={},i=e.params.length;for(let a=0;a<i;++a){const o=e.params[a];r[o.name]=Xdt(o,t,n)}return r}function Xdt(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return Ydt(e,t,n);if(i===void 0){e.required&&Se("Missing required "+gt(t.type)+" parameter: "+gt(e.name));return}else{if(r==="param")return Zdt(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!fi(i)?i.map(a=>epe(e,a,n)):epe(e,i,n)}function epe(e,t,n){const r=e.type;if(fi(t))return npe(r)?Se("Expression references can not be signals."):Rj(r)?n.fieldRef(t):rpe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||Rj(r);return i&&Jdt(t)?n.exprRef(t.expr,t.as):i&&Qdt(t)?Qx(t.field,t.as):npe(r)?xl(t,n):eht(r)?ft(n.getData(t).values):Rj(r)?Qx(t):rpe(r)?n.compareRef(t):t}}function Ydt(e,t,n){return Bn(t.from)||Se('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Zdt(e,t,n){const r=t[e.name];return e.array?(ut(r)||Se("Expected an array of sub-parameters. Instead: "+gt(r)),r.map(i=>tpe(e,i,n))):tpe(e,r,n)}function tpe(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||Se("Unsupported parameter: "+gt(t));const a=Rt(Qhe(i,t,n),i.key);return ft(n.add(Kft(a)))}const Jdt=e=>e&&e.expr,Qdt=e=>e&&e.field,eht=e=>e==="data",npe=e=>e==="expr",Rj=e=>e==="field",rpe=e=>e==="compare";function tht(e,t,n){let r,i,a,o,s;return e?(r=e.facet)&&(t||Se("Only group marks can be faceted."),r.field!=null?o=s=GT(r,n):(e.data?s=ft(n.getData(e.data).aggregate):(a=Dj(Rt({type:"aggregate",groupby:wt(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=GT(r,n),o=s=ft(n.add(a))),i=n.keyRef(r.groupby,!0))):o=ft(n.add(pu(null,[{}]))),o||(o=GT(e,n)),{key:i,pulse:o,parent:s}}function GT(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ft(t.getData(e.data).output)}function qp(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}qp.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let a=t[0],o=null,s=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ft(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(o=t[s]);return new qp(e,a,i,r,o)};function ipe(e){return Bn(e)?e:null}function ape(e,t,n){const r=BT(n.op,n.field);let i;if(t.ops){for(let a=0,o=t.as.length;a<o;++a)if(t.as[a]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function iw(e,t,n,r,i,a,o){const s=t[n]||(t[n]={}),u=Eft(a);let l=ipe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=a?{field:vj,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:ft(t.output)};u&&(d.sort=e.sortRef(a)),f=e.add($T(r,void 0,d)),o&&(t.index[i]=f),c=ft(f),l!=null&&(s[l]=c)}return c}qp.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),a=ipe(t);let o,s,u;return a!=null&&(e=r.scope,o=i[a]),o?n&&n.field&&ape(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ft(r.output)},n&&n.field&&ape(e,u,n),s=e.add(Fhe(u)),o=e.add(pu({pulse:ft(s)})),o={agg:s,ref:ft(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return ft(this.values)},extentRef(e,t){return iw(e,this,"extent","extent",t,!1)},domainRef(e,t){return iw(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return iw(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return iw(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return iw(e,this,"indata","tupleindex",t,!0,!0)}};function nht(e,t,n){const r=e.from.facet,i=r.name,a=GT(r,t);let o;r.name||Se("Facet must have a name: "+gt(r)),r.data||Se("Facet must reference a data set: "+gt(r)),r.field?o=t.add(Lhe({field:t.fieldRef(r.field),pulse:a})):r.groupby?o=t.add(Bft({key:t.keyRef(r.groupby),group:ft(t.proxy(n.parent)),pulse:a})):Se("Facet must specify groupby or field: "+gt(r));const s=t.fork(),u=s.add(pu()),l=s.add(Wp({pulse:ft(u)}));s.addData(i,new qp(s,u,u,l)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(e).toRuntime()}}function rht(e,t,n){const r=t.add(Lhe({pulse:n.pulse})),i=t.fork();i.add(Wp()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function ope(e,t,n){const r=e.remove,i=e.insert,a=e.toggle,o=e.modify,s=e.values,u=t.add(LT()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(f=>f??"null").join(",")+"),0)",c=xl(l,t);u.update=c.$expr,u.params=c.$params}function KT(e,t){const n=Jhe(e),r=e.type===VT,i=e.from&&e.from.facet,a=e.overlap;let o=e.layout||n===pj||n===hj,s,u,l,c,f,d,h;const p=n===dj||o||i,g=tht(e.from,r,t);u=t.add($ft({key:g.key||(e.key?Qx(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ft(u);u=l=t.add(pu({pulse:m})),u=t.add(Vft({markdef:Gdt(e),interactive:Kdt(e.interactive,t),clip:Hdt(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ft(u)}));const v=ft(u);u=c=t.add($he(Ohe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const C=Dj(S,t),_=C.metadata;(_.generates||_.changes)&&Se("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),C.params.pulse=ft(u),t.add(u=C)}),e.sort&&(u=t.add(Qft({sort:t.compareRef(e.sort),pulse:ft(u)})));const y=ft(u);(i||o)&&(o=t.add(zhe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=ft(o));const b=t.add(Mhe({mark:v,pulse:d||y}));h=ft(b),r&&(p&&(s=t.operators,s.pop(),o&&s.pop()),t.pushState(y,d||h,m),i?nht(e,t,g):p?rht(e,t,g):t.parse(e),t.popState(),p&&(o&&s.push(o),s.push(b))),a&&(h=iht(a,h,t));const x=t.add(Bhe({pulse:h})),w=t.add(Wp({pulse:ft(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new qp(t,l,x,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&Se("Marks only support modify triggers."),ope(S,t,f)}))}function iht(e,t,n){const r=e.method,i=e.bound,a=e.separation,o={separation:fi(a)?n.signalRef(a.signal):a,method:fi(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;o.boundTolerance=fi(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return ft(n.add(Gft(o)))}function aht(e,t){const n=t.config.legend,r=e.encode||{},i=mo(e,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,l={};let c=0,f,d,h;kj.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||Se("Missing valid scale for legend.");const p=oht(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ft(t.add(pu(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=ft(t.add(Uft(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===WT?(h=[Ddt(e,c,n,r.gradient),Yhe(e,n,r.labels,y)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(Up(i.gradientLength()),")/100))"))):p===Cj?h=[Rdt(e,c,n,r.gradient,y),Yhe(e,n,r.labels,y)]:(f=$dt(e,n),h=[Pdt(e,n,r,y,Up(f.columns))],d.size=lht(e,t,h[0].marks)),h=[rw({role:ift,from:m,encode:v,marks:h,layout:f,interactive:s})],g.title&&h.push(qdt(e,n,r.title,m)),KT(rw({role:nft,from:m,encode:n0(uht(i,e,n),a,nw),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),t)}function oht(e,t){let n=e.type||Hhe;return!e.type&&sht(e)===1&&(e.fill||e.stroke)&&(n=BB(t)?WT:zB(t)?Cj:Hhe),n!==WT?n:zB(t)?Cj:WT}function sht(e){return kj.reduce((t,n)=>t+(e[n]?1:0),0)}function uht(e,t,n){const r={enter:{},update:{}};return Ui(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function lht(e,t,n){const r=Up(spe("size",e,n)),i=Up(spe("strokeWidth",e,n)),a=Up(cht(n[1].encode,t,tw));return xl("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function spe(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):Khe(e,n[0].encode)}function cht(e,t,n){return Khe("fontSize",e)||Idt("fontSize",t,n)}const fht='item.orient==="'.concat(i0,'"?-90:item.orient==="').concat(a0,'"?90:0');function dht(e,t){e=Bn(e)?{text:e}:e;const n=mo(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],l={},c=ft(t.add(pu(null,[l])));return u.push(ght(e,n,hht(e),c)),e.subtitle&&u.push(mht(e,n,r.subtitle,c)),KT(rw({role:uft,from:c,encode:pht(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),t)}function hht(e){const t=e.encode;return t&&t.title||Rt({name:e.name,interactive:e.interactive,style:e.style},t)}function pht(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Oj},angle:{signal:fht},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),n0(n,t,nw)}function ght(e,t,n,r){const i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ho({type:Vp,role:lft,style:wdt,from:r,encode:o},n)}function mht(e,t,n,r){const i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ho({type:Vp,role:cft,style:_dt,from:r,encode:o},n)}function vht(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(Dj(r,t))}),e.on&&e.on.forEach(r=>{ope(r,t,e.name)}),t.addDataPipeline(e.name,yht(e,t,n))}function yht(e,t,n){const r=[];let i=null,a=!1,o=!1,s,u,l,c,f;for(e.values?fi(e.values)||zT(e.format)?(r.push(upe(t,e)),r.push(i=Hp())):r.push(i=Hp({$ingest:e.values,$format:e.format})):e.url?zT(e.url)||zT(e.format)?(r.push(upe(t,e)),r.push(i=Hp())):r.push(i=Hp({$request:e.url,$format:e.format})):e.source&&(i=s=wt(e.source).map(d=>ft(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Hp()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(a=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=Zft({derive:a,pulse:l?s:s[0]}),(a||l)&&r.splice(1,0,Hp())),i||r.push(Hp()),r.push(Wp({})),r}function Hp(e){const t=pu({},e);return t.metadata={source:!0},t}function upe(e,t){return Wft({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const lpe=e=>e===Pd||e===gu,XT=(e,t,n)=>fi(e)?_ht(e.signal,t,n):e===i0||e===gu?t:n,Ci=(e,t,n)=>fi(e)?xht(e.signal,t,n):lpe(e)?t:n,mu=(e,t,n)=>fi(e)?wht(e.signal,t,n):lpe(e)?n:t,cpe=(e,t,n)=>fi(e)?Sht(e.signal,t,n):e===gu?{value:t}:{value:n},bht=(e,t,n)=>fi(e)?Eht(e.signal,t,n):e===a0?{value:t}:{value:n},xht=(e,t,n)=>fpe("".concat(e," === '").concat(gu,"' || ").concat(e," === '").concat(Pd,"'"),t,n),wht=(e,t,n)=>fpe("".concat(e," !== '").concat(gu,"' && ").concat(e," !== '").concat(Pd,"'"),t,n),_ht=(e,t,n)=>Fj("".concat(e," === '").concat(i0,"' || ").concat(e," === '").concat(gu,"'"),t,n),Sht=(e,t,n)=>Fj("".concat(e," === '").concat(gu,"'"),t,n),Eht=(e,t,n)=>Fj("".concat(e," === '").concat(a0,"'"),t,n),fpe=(e,t,n)=>(t=t!=null?Ei(t):t,n=n!=null?Ei(n):n,dpe(t)&&dpe(n)?(t=t?t.signal||gt(t.value):null,n=n?n.signal||gt(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Rt({test:e},t)].concat(n||[])),dpe=e=>e==null||Object.keys(e).length===1,Fj=(e,t,n)=>({signal:"".concat(e," ? (").concat(s0(t),") : (").concat(s0(n),")")}),Cht=(e,t,n,r,i)=>({signal:(r!=null?"".concat(e," === '").concat(i0,"' ? (").concat(s0(r),") : "):"")+(n!=null?"".concat(e," === '").concat(Pd,"' ? (").concat(s0(n),") : "):"")+(i!=null?"".concat(e," === '").concat(a0,"' ? (").concat(s0(i),") : "):"")+(t!=null?"".concat(e," === '").concat(gu,"' ? (").concat(s0(t),") : "):"")+"(null)"}),s0=e=>fi(e)?e.signal:e==null?null:gt(e),Aht=(e,t)=>t===0?0:fi(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},u0=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function l0(e,t,n,r){let i;if(t&&_t(t,e))return t[e];if(_t(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Ej][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[tw][i]}return null}function hpe(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function kht(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,s,u,l;if(fi(o)){const f=hpe([n.axisX,n.axisY]),d=hpe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=Ci(o,l0(l,n.axisX,i,r),l0(l,n.axisY,i,r));u={};for(l of d)u[l]=Cht(o.signal,l0(l,n.axisTop,i,r),l0(l,n.axisBottom,i,r),l0(l,n.axisLeft,i,r),l0(l,n.axisRight,i,r))}else s=o===gu||o===Pd?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return s||u||a?Rt({},i,s,u,a):i}function Tht(e,t,n,r){const i=mo(e,t),a=e.orient;let o,s;const u={enter:o={opacity:pn},update:s={opacity:bs},exit:{opacity:pn}};Ui(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=ppe(e,0),c=ppe(e,1);return o.x=s.x=Ci(a,l,pn),o.x2=s.x2=Ci(a,c),o.y=s.y=mu(a,l,pn),o.y2=s.y2=mu(a,c),Ho({type:Tj,role:Zct,from:r,encode:u},n)}function ppe(e,t){return{scale:e.scale,range:t}}function Oht(e,t,n,r,i){const a=mo(e,t),o=e.orient,s=e.gridScale,u=XT(o,1,-1),l=Iht(e.offset,u);let c,f,d;const h={enter:c={opacity:pn},update:d={opacity:bs},exit:f={opacity:pn}};Ui(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:e.scale,field:ys,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=Ci(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},v=s?{scale:s,range:1,mult:u,offset:l}:Rt(g,{mult:u,offset:l});return c.x=d.x=Ci(o,p,m),c.y=d.y=mu(o,p,m),c.x2=d.x2=mu(o,v),c.y2=d.y2=Ci(o,v),f.x=Ci(o,p),f.y=mu(o,p),Ho({type:Tj,role:Jct,key:ys,from:r,encode:h},n)}function Iht(e,t){if(t!==1)if(!Nt(e))e=fi(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=Rt({},e);for(;n.mult!=null;)if(Nt(n.mult))n=n.mult=Rt({},n.mult);else return n.mult=fi(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function Nht(e,t,n,r,i,a){const o=mo(e,t),s=e.orient,u=XT(s,-1,1);let l,c,f;const d={enter:l={opacity:pn},update:f={opacity:bs},exit:c={opacity:pn}};Ui(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Ei(i);h.mult=u;const p={scale:e.scale,field:ys,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return f.y=l.y=Ci(s,pn,p),f.y2=l.y2=Ci(s,h),c.x=Ci(s,p),f.x=l.x=mu(s,pn,p),f.x2=l.x2=mu(s,h),c.y=mu(s,p),Ho({type:Tj,role:eft,key:ys,from:r,encode:d},n)}function Mj(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Dht(e,t,n,r,i,a){const o=mo(e,t),s=e.orient,u=e.scale,l=XT(s,-1,1),c=Up(o("labelFlush")),f=Up(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=Ei(i);m.mult=l,m.offset=Ei(o("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:ys,band:.5,offset:Xhe(a.offset,o("labelOffset"))},y=Ci(s,p?Mj(u,c,'"left"','"right"','"center"'):{value:"center"},bht(s,"left","right")),b=Ci(s,cpe(s,"bottom","top"),p?Mj(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=Mj(u,c,"-(".concat(f,")"),f,0);p=p&&f;const w={opacity:pn,x:Ci(s,v,m),y:mu(s,v,m)},S={enter:w,update:g={opacity:bs,text:{field:Sj},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:pn,x:w.x,y:w.y}};Ui(S,{dx:!d&&p?Ci(s,x):null,dy:!h&&p?mu(s,x):null}),Ui(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const C=o("labelBound");let _=o("labelOverlap");return _=_||C?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:C?{scale:u,orient:s,tolerance:C}:null}:void 0,g.align!==y&&(g.align=u0(g.align,y)),g.baseline!==b&&(g.baseline=u0(g.baseline,b)),Ho({type:Vp,role:Qct,style:tw,key:ys,from:r,encode:S,overlap:_},n)}function Rht(e,t,n,r){const i=mo(e,t),a=e.orient,o=XT(a,-1,1);let s,u;const l={enter:s={opacity:pn,anchor:Ei(i("titleAnchor",null)),align:{signal:Oj}},update:u=Rt({},s,{opacity:bs,text:Ei(e.title)}),exit:{opacity:pn}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(qT(0,1,.5),")")};return u.x=Ci(a,c),u.y=mu(a,c),s.angle=Ci(a,pn,Aht(o,90)),s.baseline=Ci(a,cpe(a,Pd,gu),{value:Pd}),u.angle=s.angle,u.baseline=s.baseline,Ui(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Fht(i,a,l,n),l.update.align=u0(l.update.align,s.align),l.update.angle=u0(l.update.angle,s.angle),l.update.baseline=u0(l.update.baseline,s.baseline),Ho({type:Vp,role:tft,style:Ej,from:r,encode:l},n)}function Fht(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=u0(Ei(s),n.update[u]),!1):!r0(u,r),a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?Ei(o):Ci(t,Ei(o),Ei(a))}function Mht(e,t){const n=kht(e,t),r=e.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=mo(e,n),l=Ndt(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ft(t.add(pu({},[c]))),d=ft(t.add(Pft({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Oht(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Nht(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(Dht(e,n,r.labels,d,p,l))),c.domain&&h.push(Tht(e,n,r.domain,f)),c.title&&h.push(Rht(e,n,r.title,f)),KT(rw({role:Yct,from:f,encode:n0(Pht(u,e),i,nw),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),t)}function Pht(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),offset:e("offset")||0,position:hu(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function gpe(e,t,n){const r=wt(e.signals),i=wt(e.scales);return n||r.forEach(a=>Nhe(a,t)),wt(e.projections).forEach(a=>pdt(a,t)),i.forEach(a=>ndt(a,t)),wt(e.data).forEach(a=>vht(a,t)),i.forEach(a=>rdt(a,t)),(n||r).forEach(a=>Mft(a,t)),wt(e.axes).forEach(a=>Mht(a,t)),wt(e.marks).forEach(a=>KT(a,t)),wt(e.legends).forEach(a=>aht(a,t)),e.title&&dht(e.title,t),t.parseLambdas(),t}const $ht=e=>n0({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Lht(e,t){const n=t.config,r=ft(t.root=t.add(LT())),i=Bht(e,n);i.forEach(l=>Nhe(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(pu()),o=t.add($he(Ohe($ht(e.encode),VT,hj,e.style,t,{pulse:ft(a)}))),s=t.add(zhe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ft(o)}));t.operators.pop(),t.pushState(ft(o),ft(s),null),gpe(e,t,i),t.operators.push(s);let u=t.add(Mhe({mark:r,pulse:ft(s)}));return u=t.add(Bhe({pulse:ft(u)})),u=t.add(Wp({pulse:ft(u)})),t.addData("root",new qp(t,a,a,u)),t}function aw(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Bht(e,t){const n=o=>hu(e[o],t[o]),r=[aw("background",n("background")),aw("autosize",Gct(n("autosize"))),aw("padding",Xct(n("padding"))),aw("width",n("width")||0),aw("height",n("height")||0)],i=r.reduce((o,s)=>(o[s.name]=s,o),{}),a={};return wt(e.signals).forEach(o=>{_t(i,o.name)?o=Rt(i[o.name],o):r.push(o),a[o.name]=o}),wt(t.signals).forEach(o=>{!_t(a,o.name)&&!_t(i,o.name)&&r.push(o)}),r}function mpe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function vpe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}mpe.prototype=vpe.prototype={parse(e){return gpe(e,this)},fork(){return new vpe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof mj?ft(e):e;return this.add(Yft({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,a){let o,s;r&&(o=r.data||(r.data={}),s=o[i]||(o[i]=[]),s.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ft(this.add(Wp({pulse:e})))),this._parent.push(t),this._lookup.push(n?ft(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return sn(this._parent)},encode(){return sn(this._encode)},lookup(){return sn(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Bn(e))return Qx(e,t);e.signal||Se("Unsupported field reference: "+gt(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ft(this.add(zft(i)))}return r},compareRef(e){let t=!1;const n=a=>fi(a)?(t=!0,this.signalRef(a.signal)):Cft(a)?(t=!0,this.exprRef(a.expr)):a,r=wt(e.field).map(n),i=wt(e.order).map(n);return t?ft(this.add(Phe({fields:r,orders:i}))):Dhe(r,i)},keyRef(e,t){let n=!1;const r=a=>fi(a)?(n=!0,ft(i[a.signal])):a,i=this.signals;return e=wt(e).map(r),n?ft(this.add(jft({fields:e,flat:t}))):wft(e,t)},sortRef(e){if(!e)return e;const t=BT(e.op,e.field),n=e.order||_ft;return n.signal?ft(this.add(Phe({fields:t,orders:this.signalRef(n.signal)}))):Dhe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return _t(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Se("Duplicate signal name: "+gt(e));const n=t instanceof mj?t:this.add(LT(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Se("Unrecognized signal name: "+gt(e)),this.signals[e]},signalRef(e){return this.signals[e]?ft(this.signals[e]):(_t(this.lambdas,e)||(this.lambdas[e]=this.add(LT(null))),ft(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=xl(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Nt(e)?e:this.signalRef(e.signal||Pj(e))},exprRef(e,t){const n={expr:xl(e,this)};return t&&(n.expr.$name=t),ft(this.add(Lft(n)))},addBinding(e,t){this.bindings||Se("Nested signals do not support binding: "+gt(e)),this.bindings.push(Rt({signal:e},t))},addScaleProj(e,t){_t(this.scales,e)&&Se("Duplicate scale or projection name: "+gt(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Jft(t))},addProjection(e,t){this.addScaleProj(e,Xft(t))},getScale(e){return this.scales[e]||Se("Unrecognized scale name: "+gt(e)),this.scales[e]},scaleRef(e){return ft(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.data[e]=t},getData(e){return this.data[e]||Se("Undefined data set name: "+gt(e)),this.data[e]},addDataPipeline(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.addData(e,qp.fromEntries(this,t))}};function Pj(e){return(ut(e)?zht:jht)(e)}function zht(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Nt(i)?i.signal||Pj(i):gt(i))}return n+"]"}function jht(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+gt(r)+":"+(Nt(i)?i.signal||Pj(i):gt(i));return t+"}"}function Uht(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Wht(e,t,n){return Nt(e)||Se("Input Vega specification must be an object."),t=DC(Uht(),t,e.config),Lht(e,new mpe(t,n)).toRuntime()}var Vht="vega",qht="5.20.0",Hht="The Vega visualization grammar.",Ght=["vega","visualization","interaction","dataflow","library","data","d3"],Kht="BSD-3-Clause",Xht="UW Interactive Data Lab (http://idl.cs.washington.edu)",Yht="build/vega-node.js",Zht="build/vega.module.js",Jht="build/vega.min.js",Qht="build/vega.min.js",ept="index.d.ts",tpt="vega/vega",npt={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},rpt={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},ipt={"vega-schema":"*"},apt="f262105e75449760b0f35fda70e6b576a31d68a4",opt={name:Vht,version:qht,description:Hht,keywords:Ght,license:Kht,author:Xht,main:Yht,module:Zht,unpkg:Jht,jsdelivr:Qht,types:ept,repository:tpt,scripts:npt,dependencies:rpt,devDependencies:ipt,gitHead:apt};Rt(xv,nYe,Stt,tnt,zrt,Fit,uot,$at,cot,kot,$ot,Vot);const spt=opt.version;var upt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:spt,Dataflow:bv,EventStream:nA,MultiPulse:tL,Operator:Xn,Parameters:tA,Pulse:ud,Transform:ve,changeset:mp,definition:Hie,ingest:In,isTuple:JC,transform:Gie,transforms:xv,tupleid:lt,interpolate:jB,interpolateColors:LA,interpolateRange:Ise,quantizeInterpolator:Nse,scale:Sn,scheme:UB,projection:M5,View:phe,defaultLocale:J4,formatLocale:KC,locale:Die,resetDefaultLocale:wKe,timeFormatLocale:O1,expressionFunction:Zr,parse:Wht,runtimeContext:Kde,codegenExpression:Ade,parseExpression:Sde,parseSelector:Md,Debug:Bne,Error:Q$,Info:Lne,None:Pne,Warn:$ne,accessor:ro,accessorFields:Yi,accessorName:Tr,array:wt,ascending:LC,clampRange:Jne,compare:r4,constant:Ji,debounce:i4,error:Se,extend:Rt,extent:tl,extentIndex:Qne,falsy:Yf,fastmap:cv,field:io,flush:ere,hasOwnProperty:_t,id:o1,identity:Oa,inherits:$e,inrange:fv,isArray:ut,isBoolean:a4,isDate:Zf,isFunction:Lt,isIterable:tre,isNumber:Jf,isObject:Nt,isRegExp:nre,isString:Bn,key:o4,lerp:rre,logger:zne,lruCache:ire,merge:are,mergeConfig:DC,one:lv,pad:ore,panLinear:Hne,panLog:Gne,panPow:Kne,panSymlog:Xne,peek:sn,quarter:Yne,repeat:s1,span:u1,splitAccessPath:IC,stringValue:gt,toBoolean:s4,toDate:u4,toNumber:Zi,toSet:tu,toString:l4,truncate:sre,truthy:ls,utcquarter:Zne,visitArray:Qf,writeConfig:RC,zero:Xf,zoomLinear:e4,zoomLog:t4,zoomPow:$C,zoomSymlog:n4,bandwidthNRD:aL,bin:Xie,bootstrapCI:Yie,cumulativeLogNormal:fL,cumulativeNormal:oA,cumulativeUniform:gL,densityLogNormal:cL,densityNormal:oL,densityUniform:pL,dotbin:Zie,quantileLogNormal:dL,quantileNormal:sA,quantileUniform:mL,quantiles:rL,quartiles:iL,get random(){return ds},randomInteger:sXe,randomKDE:uL,randomLCG:oXe,randomLogNormal:Qie,randomMixture:eae,randomNormal:sL,randomUniform:tae,regressionExp:rae,regressionLinear:vL,regressionLoess:uae,regressionLog:nae,regressionPoly:aae,regressionPow:iae,regressionQuad:yL,sampleCurve:lA,sampleLogNormal:lL,sampleNormal:aA,sampleUniform:hL,setRandom:iXe,DATE:so,DAY:ea,DAYOFYEAR:nl,HOURS:zo,MILLISECONDS:nu,MINUTES:jo,MONTH:Qi,QUARTER:oo,SECONDS:fs,TIME_UNITS:P4,WEEK:si,YEAR:$i,dayofyear:Ure,timeBin:sie,timeFloor:Xre,timeInterval:gv,timeOffset:Jre,timeSequence:tie,timeUnitSpecifier:jre,timeUnits:L4,utcFloor:Yre,utcInterval:mv,utcOffset:Qre,utcSequence:nie,utcdayofyear:qre,utcweek:Hre,week:Wre,read:Rie,inferType:cre,inferTypes:fre,typeParsers:c4,format:jC,formats:m4,responseType:bre,loader:XC,Bounds:li,CanvasHandler:cx,CanvasRenderer:fk,Gradient:Gse,GroupItem:VA,Handler:Sd,Item:WA,Marks:Uo,RenderType:Cd,Renderer:pl,ResourceLoader:QB,SVGHandler:Tz,SVGRenderer:Mz,SVGStringRenderer:Lz,Scenegraph:Sz,boundClip:fle,boundContext:tx,boundItem:_z,boundMark:Aue,boundStroke:Ac,domChild:lo,domClear:ou,domCreate:_d,domFind:Ez,font:nk,fontFamily:ox,fontSize:hl,intersect:sle,intersectBoxLine:$v,intersectPath:oz,intersectPoint:sz,intersectRule:fue,lineHeight:xd,markup:Fz,multiLineOffset:bz,pathCurves:GB,pathEqual:dle,pathParse:Fv,pathRectangle:eue,pathRender:Y1,pathSymbols:Qse,pathTrail:tue,point:ik,renderModule:hk,resetSVGClipId:rue,resetSVGDefIds:Bet,sceneEqual:zz,sceneFromJSON:Tue,scenePickVisit:ZA,sceneToJSON:kue,sceneVisit:au,sceneZOrder:uz,serializeXML:Yue,textMetrics:dl});const lpt="vega-lite",cpt='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',fpt="4.13.1",dpt=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],hpt="https://vega.github.io/vega-lite/",ppt="Vega-Lite is a concise high-level language for interactive visualization.",gpt="build/vega-lite.js",mpt="build/vega-lite.min.js",vpt="build/vega-lite.min.js",ypt="build/src/index",bpt="build/src/index.d.ts",xpt={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},wpt={test:"test"},_pt={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},Spt={type:"git",url:"https://github.com/vega/vega-lite.git"},Ept="BSD-3-Clause",Cpt={url:"https://github.com/vega/vega-lite/issues"},Apt={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},kpt={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},Tpt={vega:"^5.12.1"},Opt={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1};var Ipt={name:lpt,author:cpt,version:fpt,collaborators:dpt,homepage:hpt,description:ppt,main:gpt,unpkg:mpt,jsdelivr:vpt,module:ypt,types:bpt,bin:xpt,directories:wpt,scripts:_pt,repository:Spt,license:Ept,bugs:Cpt,devDependencies:Apt,dependencies:kpt,peerDependencies:Tpt,jest:Opt};function c0(e,t,n){return e.fields=t||[],e.fname=n,e}function Npt(e){return e.length===1?Dpt(e[0]):Rpt(e)}const Dpt=e=>function(t){return t[e]},Rpt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function $j(e){throw Error(e)}function Gp(e){var t=[],n=null,r=0,i=e.length,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<i;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=s+1,n=u):u==="."&&!r?s>o?l():o=s+1:u==="["?(s>o&&l(),r=o=s+1):u==="]"&&(r||$j("Access path missing open bracket: "+e),r>0&&l(),r=0,o=s+1)}return r&&$j("Access path missing closing bracket: "+e),n&&$j("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function Fpt(e,t,n){const r=Gp(e);return e=r.length===1?r[0]:e,c0((n&&n.get||Npt)(r),[e],t||e)}var ow=[];Fpt("id");var Mpt=c0(function(e){return e},ow,"identity");c0(function(){return 0},ow,"zero"),c0(function(){return 1},ow,"one"),c0(function(){return!0},ow,"true"),c0(function(){return!1},ow,"false");function YT(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Ppt=0,$pt=1,ype=2,Lpt=3,Bpt=4;function zpt(e,t){var n=e||Ppt;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=$pt&&YT(t||"error","ERROR",arguments),this},warn:function(){return n>=ype&&YT(t||"warn","WARN",arguments),this},info:function(){return n>=Lpt&&YT(t||"log","INFO",arguments),this},debug:function(){return n>=Bpt&&YT(t||"log","DEBUG",arguments),this}}}var vt=Array.isArray;function Ai(e){return e===Object(e)}const bpe=e=>e!=="__proto__";function xpe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=jpt(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;Lj(t,r,n[r],i)}return t},{})}function Lj(e,t,n,r){if(!!bpe(t)){var i,a;if(Ai(n)&&!vt(n)){a=Ai(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Lj(a,i,n[i]):bpe(i)&&(a[i]=n[i])}else e[t]=n}}function jpt(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function Br(e){return e!=null?vt(e)?e:[e]:[]}function Upt(e){return typeof e=="function"}const Wpt=Object.prototype.hasOwnProperty;function Kp(e,t){return Wpt.call(e,t)}function sw(e){return typeof e=="boolean"}function Jr(e){return typeof e=="number"}function Xt(e){return typeof e=="string"}function gn(e){return vt(e)?"["+e.map(gn)+"]":Ai(e)||Xt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Xp(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var wpe={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var a;try{a=Promise}catch(d){a=function(){}}function o(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var v=[],y=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var C,_;if(typeof w!="object")return w;if(n(w,r))C=new r;else if(n(w,i))C=new i;else if(n(w,a))C=new a(function(L,W){w.then(function(G){L(x(G,S-1))},function(G){W(x(G,S-1))})});else if(o.__isArray(w))C=[];else if(o.__isRegExp(w))C=new RegExp(w.source,f(w)),w.lastIndex&&(C.lastIndex=w.lastIndex);else if(o.__isDate(w))C=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(w.length):C=new Buffer(w.length),w.copy(C),C;n(w,Error)?C=Object.create(w):typeof g=="undefined"?(_=Object.getPrototypeOf(w),C=Object.create(_)):(C=Object.create(g),_=g)}if(h){var E=v.indexOf(w);if(E!=-1)return y[E];v.push(w),y.push(C)}n(w,r)&&w.forEach(function(L,W){var G=x(W,S-1),K=x(L,S-1);C.set(G,K)}),n(w,i)&&w.forEach(function(L){var W=x(L,S-1);C.add(W)});for(var A in w){var k;_&&(k=Object.getOwnPropertyDescriptor(_,A)),!(k&&k.set==null)&&(C[A]=x(w[A],S-1))}if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(w),A=0;A<T.length;A++){var I=T[A],N=Object.getOwnPropertyDescriptor(w,I);N&&!N.enumerable&&!m||(C[I]=x(w[I],S-1),N.enumerable||Object.defineProperty(C,I,{enumerable:!1}))}if(m)for(var O=Object.getOwnPropertyNames(w),A=0;A<O.length;A++){var D=O[A],N=Object.getOwnPropertyDescriptor(w,D);N&&N.enumerable||(C[D]=x(w[D],S-1),Object.defineProperty(C,D,{enumerable:!1}))}return C}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function s(d){return Object.prototype.toString.call(d)}o.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(wpe);var Vpt=wpe.exports,qpt=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!=0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},uw=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(a){return function(o){return function(s,u){var l={key:s,value:o[s]},c={key:u,value:o[u]};return a(l,c)}}}(t.cmp),i=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var s,u;if(Array.isArray(o)){for(u="[",s=0;s<o.length;s++)s&&(u+=","),u+=a(o[s])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",s=0;s<c.length;s++){var f=c[s],d=a(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function Bj(e){return!!e.or}function zj(e){return!!e.and}function jj(e){return!!e.not}function ZT(e,t){if(jj(e))ZT(e.not,t);else if(zj(e))for(const n of e.and)ZT(n,t);else if(Bj(e))for(const n of e.or)ZT(n,t);else t(e)}function JT(e,t){return jj(e)?{not:JT(e.not,t)}:zj(e)?{and:e.and.map(n=>JT(n,t))}:Bj(e)?{or:e.or.map(n=>JT(n,t))}:t(e)}const lw=qpt,Yt=Vpt;function cw(e,t){const n={};for(const r of t)Kp(e,r)&&(n[r]=e[r]);return n}function Pc(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>uw(e)).join(",")})`};const cr=uw;function yn(e){if(Jr(e))return e;const t=Xt(e)?e:uw(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function _pe(e){return e===!1||e===null}function bt(e,t){return e.indexOf(t)>-1}function fw(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function Spe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function Hpt(e,...t){for(const n of t)Gpt(e,n??{});return e}function Gpt(e,t){for(const n of Be(t))Lj(e,n,t[n],!0)}function $d(e,t){const n=[],r={};let i;for(const a of e)i=t(a),!(i in r)&&(r[i]=1,n.push(a));return n}function Kpt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Epe(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Cpe(e){const t=new Set;for(const n of e){const i=Gp(n).map((o,s)=>s===0?o:`[${o}]`),a=i.map((o,s)=>i.slice(0,s+1).join(""));for(const o of a)t.add(o)}return t}function Ape(e,t){return e===void 0||t===void 0?!0:Epe(Cpe(e),Cpe(t))}function Yn(e){return Be(e).length===0}const Be=Object.keys,Ld=Object.values;function kpe(e){const t=[];for(const n in e)Kp(e,n)&&t.push({key:n,value:e[n]});return t}function QT(e){return e===!0||e===!1}function fr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function dw(e,t){return jj(e)?"!("+dw(e.not,t)+")":zj(e)?"("+e.and.map(n=>dw(n,t)).join(") && (")+")":Bj(e)?"("+e.or.map(n=>dw(n,t)).join(") || (")+")":t(e)}function Uj(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Uj(e[n],t)&&delete e[n],Yn(e)}function eO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Tpe(e,t="datum"){const n=Gp(e),r=[];for(let i=1;i<=n.length;i++){const a=`[${n.slice(0,i).map(gn).join("][")}]`;r.push(`${t}${a}`)}return r.join(" && ")}function Xpt(e,t="datum"){return`${t}[${gn(Gp(e).join("."))}]`}function Ypt(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Bd(e){return`${Gp(e).map(Ypt).join("\\.")}`}function f0(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Ope(e){return`${Gp(e).join(".")}`}function hw(e){return e?Gp(e).length:0}function Qr(...e){for(const t of e)if(t!==void 0)return t}let Zpt=42;function Jpt(e){const t=++Zpt;return e?String(e)+t:t}function Qpt(e){return egt(e)?e:`__${e}`}function egt(e){return e.indexOf("__")===0}function tO(e){if(e!==void 0)return(e%360+360)%360}function Wj(e){return Jr(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const Ipe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function Vj(e){return e&&e.condition}const Npe=["domain","grid","labels","ticks","title"],tgt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Dpe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},ngt=Object.assign(Object.assign({},Dpe),{style:1,labelExpr:1,encoding:1});function Rpe(e){return!!ngt[e]}const Ua={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Fpe=Ua.arc,nO=Ua.area,rO=Ua.bar,rgt=Ua.image,iO=Ua.line,aO=Ua.point,igt=Ua.rect,oO=Ua.rule,Mpe=Ua.text,qj=Ua.tick,agt=Ua.trail,Hj=Ua.circle,Gj=Ua.square,Ppe=Ua.geoshape;function Yp(e){return bt(["line","area","trail"],e)}function $pe(e){return bt(["rect","bar","image","arc"],e)}const Lpe=Be(Ua);function wl(e){return e.type}Xp(Lpe);const ogt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],sgt=["fill","fillOpacity"],ugt=[...ogt,...sgt],lgt={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},Bpe=Be(lgt),cgt={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},fgt={color:"#4c78a8",invalid:"filter",timeUnitBand:1},dgt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},zpe=5,hgt={binSpacing:1,continuousBandSize:zpe,timeUnitBandPosition:.5},pgt={binSpacing:0,continuousBandSize:zpe,timeUnitBandPosition:.5},ggt={thickness:1};function mgt(e){return wl(e)?e.type:e}function $c(e){return"mark"in e}class sO{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return $c(t)?mgt(t.mark)===this.name:!1}}const vgt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},ygt={count:1,min:1,max:1};function zd(e){return!!e&&!!e.argmin}function Zp(e){return!!e&&!!e.argmax}function Kj(e){return Xt(e)&&!!vgt[e]}const bgt=["count","valid","missing","distinct"];function jpe(e){return Xt(e)&&bt(bgt,e)}function xgt(e){return Xt(e)&&bt(["min","max"],e)}const wgt=["count","sum","distinct","valid","missing"],_gt=["mean","average","median","q1","q3","min","max"],Sgt=Xp(_gt),Lc="row",Bc="column",uO="facet",br="x",di="y",vu="x2",_l="y2",Sl="radius",zc="radius2",yu="theta",jc="theta2",El="latitude",Cl="longitude",bu="latitude2",xs="longitude2",vo="color",Al="fill",kl="stroke",yo="shape",Uc="size",Jp="angle",Wc="opacity",jd="fillOpacity",Ud="strokeOpacity",Wd="strokeWidth",Vd="strokeDash",pw="text",gw="order",mw="detail",lO="key",Qp="tooltip",cO="href",fO="url",dO="description",Egt={x:1,y:1,x2:1,y2:1},Upe={theta:1,theta2:1,radius:1,radius2:1};function Wpe(e){return e in Upe}const Xj={longitude:1,longitude2:1,latitude:1,latitude2:1};function Cgt(e){switch(e){case El:return"y";case bu:return"y2";case Cl:return"x";case xs:return"x2"}}function Agt(e){return e in Xj}const kgt=Be(Xj),Vpe=Object.assign(Object.assign(Object.assign(Object.assign({},Egt),Upe),Xj),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function d0(e){return e===vo||e===Al||e===kl}const qpe={row:1,column:1,facet:1},ws=Be(qpe),Yj=Object.assign(Object.assign({},Vpe),qpe),Hpe=Be(Yj),Tgt=dt(Yj,["order","detail","tooltip"]),Ogt=dt(Tgt,["row","column","facet"]);function Igt(e){return!!Ogt[e]}function Gpe(e){return!!Yj[e]}const Ngt=[vu,_l,bu,xs,jc,zc];function Kpe(e){return eg(e)!==e}function eg(e){switch(e){case vu:return br;case _l:return di;case bu:return El;case xs:return Cl;case jc:return yu;case zc:return Sl}return e}function qd(e){if(Wpe(e))switch(e){case yu:return"startAngle";case jc:return"endAngle";case Sl:return"outerRadius";case zc:return"innerRadius"}return e}function Tl(e){switch(e){case br:return vu;case di:return _l;case El:return bu;case Cl:return xs;case yu:return jc;case Sl:return zc}}function Ol(e){switch(e){case br:case vu:return"width";case di:case _l:return"height"}}function Dgt(e){switch(e){case br:return"xOffset";case di:return"yOffset";case vu:return"x2Offset";case _l:return"y2Offset";case yu:return"thetaOffset";case Sl:return"radiusOffset";case jc:return"theta2Offset";case zc:return"radius2Offset"}}const Zj=dt(Vpe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Rgt=Be(Zj),Hd={x:1,y:1},_s=Be(Hd);function Il(e){return e in Hd}const Jj={theta:1,radius:1},Fgt=Be(Jj);function hO(e){return e==="width"?br:di}const Xpe=dt(Zj,["text","tooltip","href","url","description","detail","key","order"]),Mgt=Be(Xpe);function Pgt(e){return!!Zj[e]}function $gt(e){switch(e){case vo:case Al:case kl:case Uc:case yo:case Wc:case Wd:case Vd:return!0;case jd:case Ud:case Jp:return!1}}const Ype=Object.assign(Object.assign(Object.assign({},Hd),Jj),Xpe),pO=Be(Ype);function Gd(e){return!!Ype[e]}function Lgt(e,t){return zgt(e)[t]}const Zpe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Bgt=dt(Zpe,["geoshape"]);function zgt(e){switch(e){case vo:case Al:case kl:case dO:case mw:case lO:case Qp:case cO:case gw:case Wc:case jd:case Ud:case Wd:case uO:case Lc:case Bc:return Zpe;case br:case di:case El:case Cl:return Bgt;case vu:case _l:case bu:case xs:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Uc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Vd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case yo:return{point:"always",geoshape:"always"};case pw:return{text:"always"};case Jp:return{point:"always",square:"always",text:"always"};case fO:return{image:"always"};case yu:return{text:"always",arc:"always"};case Sl:return{text:"always",arc:"always"};case jc:case zc:return{arc:"always"}}}function gO(e){switch(e){case br:case di:case yu:case Sl:case Uc:case Jp:case Wd:case Wc:case jd:case Ud:case vu:case _l:case jc:case zc:return;case uO:case Lc:case Bc:case yo:case Vd:case pw:case Qp:case cO:case fO:case dO:return"discrete";case vo:case Al:case kl:return"flexible";case El:case Cl:case bu:case xs:case mw:case lO:case gw:return}}function Jpe(e){return sw(e)&&(e=kO(e,void 0)),"bin"+Be(e).map(t=>mO(e[t])?fr(`_${t}_${Object.entries(e[t])}`):fr(`_${t}_${e[t]}`)).join("")}function Qn(e){return e===!0||vw(e)&&!e.binned}function Wa(e){return e==="binned"||vw(e)&&e.binned===!0}function vw(e){return Ai(e)}function mO(e){return e==null?void 0:e.selection}function Qpe(e){switch(e){case Lc:case Bc:case Uc:case vo:case Al:case kl:case Wd:case Wc:case jd:case Ud:case yo:return 6;case Vd:return 4;default:return 10}}function Qj(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const jgt='Autosize "fit" only works for single views and layered views.';function ege(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function tge(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function nge(e){return e?`Dropping "fit-${e}" because spec has discrete ${Ol(e)}.`:'Dropping "fit" because spec has discrete size.'}function rge(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Ugt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Wgt(e){return`The "nearest" transform is not supported for ${e} marks.`}function ige(e){return`Selection not supported for ${e} yet.`}function Vgt(e){return`Cannot find a selection named "${e}".`}const qgt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Hgt="Legend bindings are only supported for selections over an individual field or encoding channel.";function Ggt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function Kgt(e){return`Unknown repeated value "${e}".`}function age(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Xgt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Ygt(e){return`Unrecognized parse "${e}".`}function oge(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function Zgt(e){return`Ignoring an invalid transform: ${cr(e)}.`}const Jgt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function sge(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Qgt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function emt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${cr(t)} is overridden by a child projection ${cr(n)}.`}const tmt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function nmt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${cr(n)}}.`}function uge(e){return`Invalid field type "${e}".`}function rmt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function imt(e){return`Invalid aggregation operator "${e}".`}function amt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function lge(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function e8(e,t){return`Dropping ${cr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const omt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function vO(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function smt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function umt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function lmt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function t8(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function cmt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function fmt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const dmt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function hmt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function pmt(e){return`Using unaggregated domain with raw field has no effect (${cr(e)}).`}function gmt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function mmt(e){return`Unaggregated domain is currently unsupported for log scale (${cr(e)}).`}function vmt(e){return`Cannot apply size to non-oriented mark "${e}".`}function ymt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function bmt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function cge(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function fge(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function xmt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${cr(n)} and ${cr(r)}). Using ${cr(n)}.`}function wmt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${cr(n)} and ${cr(r)}). Using the union of the two domains.`}function _mt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Smt(e){return`Dropping sort property ${cr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const dge="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Emt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Cmt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Amt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function kmt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Tmt(e){return`Cannot stack non-linear scale (${e}).`}function Omt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function yO(e,t){return`Invalid ${e}: ${cr(t)}.`}function Imt(e){return`Dropping day from datetime ${cr(e)} as day cannot be combined with other units.`}function Nmt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Dmt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Rmt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Fmt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function hge(e){return`1D error band does not support ${e}.`}function pge(e){return`Channel ${e} is required for "binned" bin.`}function Mmt(e){return`Domain for ${e} is required for threshold scale.`}const gge=zpt(ype);let h0=gge;function Pmt(e){return h0=e,h0}function $mt(){return h0=gge,h0}function Me(...e){h0.warn(...e)}function Lmt(...e){h0.debug(...e)}function p0(e){if(e&&Ai(e)){for(const t of r8)if(t in e)return!0}return!1}const mge=["january","february","march","april","may","june","july","august","september","october","november","december"],Bmt=mge.map(e=>e.substr(0,3)),vge=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],zmt=vge.map(e=>e.substr(0,3));function jmt(e){if(Wj(e)&&(e=+e),Jr(e))return e>4&&Me(yO("quarter",e)),e-1;throw new Error(yO("quarter",e))}function Umt(e){if(Wj(e)&&(e=+e),Jr(e))return e-1;{const t=e.toLowerCase(),n=mge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Bmt.indexOf(r);if(i!==-1)return i;throw new Error(yO("month",e))}}function Wmt(e){if(Wj(e)&&(e=+e),Jr(e))return e%7;{const t=e.toLowerCase(),n=vge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=zmt.indexOf(r);if(i!==-1)return i;throw new Error(yO("day",e))}}function n8(e,t){const n=[];if(t&&e.day!==void 0&&Be(e).length>1&&(Me(Imt(e)),e=Yt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?Umt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?jmt(e.quarter):e.quarter;n.push(Jr(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?Wmt(e.day):e.day;n.push(Jr(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function yw(e){const n=n8(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Vmt(e){const n=n8(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function qmt(e){const t=n8(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const yge={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},r8=Be(yge);function Hmt(e){return!!yge[e]}function i8(e){return e.startsWith("utc")}function Gmt(e){return e.substr(3)}const Kmt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function a8(e){const t=[];for(const n of r8)bge(e,n)&&t.push(n);return t}function bge(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Xmt(e,t,{end:n}={end:!1}){const r=Tpe(t),i=i8(e)?"utc":"";function a(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const s={};for(const u of r8)bge(e,u)&&(s[u]=a(u),o=u);return n&&(s[o]+="+1"),Vmt(s)}function xge(e){if(!e)return;const t=a8(e);return`timeUnitSpecifier(${uw(t)}, ${uw(Kmt)})`}function Ymt(e,t,n){if(!e)return;const r=xge(e);return`${n||i8(e)?"utc":"time"}Format(${t}, ${r})`}function Va(e){if(!e)return;let t;return Xt(e)?t={unit:e}:Ai(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),i8(t.unit)&&(t.utc=!0,t.unit=Gmt(t.unit)),t}function Zmt(e){const t=Va(e),{utc:n}=t,r=dt(t,["utc"]);return r.unit?(n?"utc":"")+Be(r).map(i=>fr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Be(r).map(i=>fr(`_${i}_${r[i]}`)).join("")}function Et(e){return e&&!!e.signal}function Kd(e){return!!e.step}function Jmt(e){return vt(e)?!1:"fields"in e&&!("data"in e)}function Qmt(e){return vt(e)?!1:"fields"in e&&"data"in e}function Xd(e){return vt(e)?!1:"field"in e&&"data"in e}const evt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},tvt=Be(evt),nvt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},o8=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function rvt(e){return e==null?void 0:e.selection}function s8(e){return e&&!!e.field&&e.equal!==void 0}function wge(e){return e&&!!e.field&&e.lt!==void 0}function _ge(e){return e&&!!e.field&&e.lte!==void 0}function Sge(e){return e&&!!e.field&&e.gt!==void 0}function Ege(e){return e&&!!e.field&&e.gte!==void 0}function u8(e){if(e&&e.field){if(vt(e.range)&&e.range.length===2)return!0;if(Et(e.range))return!0}return!1}function l8(e){return e&&!!e.field&&(vt(e.oneOf)||vt(e.in))}function ivt(e){return e&&!!e.field&&e.valid!==void 0}function Cge(e){return l8(e)||s8(e)||u8(e)||wge(e)||Sge(e)||_ge(e)||Ege(e)}function Nl(e,t){return k8(e,{timeUnit:t,wrapTime:!0})}function avt(e,t){return e.map(n=>Nl(n,t))}function Age(e,t=!0){var n;const{field:r}=e,i=(n=Va(e.timeUnit))===null||n===void 0?void 0:n.unit,a=i?"time("+Xmt(i,r)+")":Ue(e,{expr:"datum"});if(s8(e))return a+"==="+Nl(e.equal,i);if(wge(e)){const o=e.lt;return`${a}<${Nl(o,i)}`}else if(Sge(e)){const o=e.gt;return`${a}>${Nl(o,i)}`}else if(_ge(e)){const o=e.lte;return`${a}<=${Nl(o,i)}`}else if(Ege(e)){const o=e.gte;return`${a}>=${Nl(o,i)}`}else{if(l8(e))return`indexof([${avt(e.oneOf,i).join(",")}], ${a}) !== -1`;if(ivt(e))return c8(a,e.valid);if(u8(e)){const{range:o}=e,s=Et(o)?{signal:`${o.signal}[0]`}:o[0],u=Et(o)?{signal:`${o.signal}[1]`}:o[1];if(s!==null&&u!==null&&t)return"inrange("+a+", ["+Nl(s,i)+", "+Nl(u,i)+"])";const l=[];return s!==null&&l.push(`${a} >= ${Nl(s,i)}`),u!==null&&l.push(`${a} <= ${Nl(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function c8(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function ovt(e){var t;return Cge(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Va(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const g0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},tg=g0.quantitative,f8=g0.ordinal,m0=g0.temporal,d8=g0.nominal,v0=g0.geojson,svt=Be(g0);function uvt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case tg:return"quantitative";case"t":case m0:return"temporal";case"o":case f8:return"ordinal";case"n":case d8:return"nominal";case v0:return"geojson"}}const ei={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},h8={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},lvt=Be(h8);function cvt(e,t){const n=h8[e],r=h8[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const fvt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function kge(e){return fvt[e]}const Tge=["linear","log","pow","sqrt","symlog","time","utc"],dvt=Xp(Tge),hvt=["linear","log","pow","sqrt","symlog"],pvt=Xp(hvt);function gvt(e){return e in pvt}const mvt=["quantile","quantize","threshold"],vvt=Xp(mvt),yvt=Tge.concat(["quantile","quantize","threshold","sequential","identity"]),bvt=Xp(yvt),xvt=["ordinal","bin-ordinal","point","band"],wvt=Xp(xvt);function bo(e){return e in wvt}function Ss(e){return e in bvt}function xu(e){return e in dvt}function bO(e){return e in vvt}const _vt={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function Svt(e){return!Xt(e)&&!!e.name}function Oge(e){return e==null?void 0:e.selection}function Evt(e){return e&&e.unionWith}const Cvt={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Avt=dt(Cvt,["type","domain","range","scheme"]),kvt=Be(Avt);Tvt();function Ige(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!bt(["point","band","identity"],e);case"bins":return!bt(["point","band","identity","ordinal"],e);case"round":return xu(e)||e==="band"||e==="point";case"padding":return xu(e)||bt(["point","band"],e);case"paddingOuter":case"align":return bt(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return xu(e);case"nice":return xu(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Ss(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function Nge(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return d0(e)?void 0:hmt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function Dge(e,t){return bt([f8,d8],t)?e===void 0||bo(e):t===m0?bt([ei.TIME,ei.UTC,void 0],e):t===tg?bt([ei.LOG,ei.POW,ei.SQRT,ei.SYMLOG,ei.QUANTILE,ei.QUANTIZE,ei.THRESHOLD,ei.LINEAR,void 0],e):!0}function Rge(e,t){if(!Gd(e))return!1;switch(e){case br:case di:case yu:case Sl:return xu(t)||bt(["band","point"],t);case Uc:case Wd:case Wc:case jd:case Ud:case Jp:return xu(t)||bO(t)||bt(["band","point","ordinal"],t);case vo:case Al:case kl:return t!=="band";case Vd:return t==="ordinal"||bO(t);case yo:return t==="ordinal"}}function Tvt(){var e;const t={};for(const n of Hpe)for(const r of svt)for(const i of lvt){const a=Ovt(n,r);Rge(n,i)&&Dge(i,r)&&(t[a]=(e=t[a])!==null&&e!==void 0?e:[],t[a].push(i))}return t}function Ovt(e,t){return e+"_"+t}function p8(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:a}=e,o=Mge(e);return We(n)&&!jpe(n.aggregate)&&i&&xu(i.get("type"))&&i.get("zero")===!1?Fge({fieldDef:n,channel:t,markDef:r,ref:o,config:a}):o}function Fge({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Yp(n.type)||Fn("invalid",n,i)===null?r:[Ivt(e,t),r]}function Ivt(e,t){const n=g8(e,!0),i=eg(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function g8(e,t=!0){return c8(Xt(e)?e:Ue(e,{expr:"datum"}),!t)}function Nvt(e){const{datum:t}=e;return p0(t)?yw(t):`${JSON.stringify(t)}`}function ng(e,t,n,r){const i={};if(t&&(i.scale=t),Zd(e)){const{datum:a}=e;p0(a)?i.signal=yw(a):Et(a)?i.signal=a.signal:i.value=a}else i.field=Ue(e,n);if(r){const{offset:a,band:o}=r;a&&(i.offset=a),o&&(i.band=o)}return i}function xO({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=Ue(t,{expr:o,suffix:i}),u=n!==void 0?Ue(n,{expr:o}):Ue(t,{suffix:"end",expr:o}),l={};if(a===0||a===1){l.scale=e;const c=a===0?s:u;l.field=c}else{const c=`${a} * ${s} + ${1-a} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function Mge({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l,band:c}){var f;if(t){if(It(t)){if(Go(t)){c=c??ww({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:g}=t;if(Qn(h)||c&&p&&g===m0)return s&&s.impute?ng(t,a,{binSuffix:"mid"},{offset:u}):c?xO({scaleName:a,fieldOrDatumDef:t,band:c,offset:u}):ng(t,a,_w(t,e)?{binSuffix:"range"}:{},{offset:u});if(Wa(h)){if(We(n))return xO({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});Me(pge(e===br?vu:_l))}}const d=o==null?void 0:o.get("type");return ng(t,a,bo(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Vc(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},bw(e,d)),h)}}return Upt(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function bw(e,t){return bt(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:bt(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:zr(t)}function rg(e){return e&&e!=="number"&&e!=="time"}function Pge(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const Dvt=" \u2013 ";function m8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(rg(n))return v8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:a});const u=$ge(e,r,i);if(TO(e)){const l=Fvt(u,We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,a.timeFormat,S8(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ei.UTC);return l?{signal:l}:void 0}if(t=zge(Yd(e),t,a),We(e)&&Qn(e.bin)){const l=Ue(e,{expr:r,binSuffix:"end"});return{signal:wO(u,l,t,n,a)}}else return t||Yd(e)==="quantitative"?{signal:`${jge(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function $ge(e,t,n){return We(e)?n?`${Ue(e,{expr:t,suffix:"end"})}-${Ue(e,{expr:t,suffix:"start"})}`:Ue(e,{expr:t}):Nvt(e)}function v8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=o??$ge(e,r,i),We(e)&&Qn(e.bin)){const s=Ue(e,{expr:r,binSuffix:"end"});return{signal:wO(o,s,t,n,a)}}return{signal:Pge(n,o,t)}}function Lge(e,t,n,r,i,a){var o;if(!rg(r)){if(TO(e)){const s=We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return Rvt(n,s,i,a)}return zge(t,n,i)}}function Bge(e,t,n){if(e&&(Et(e)||e==="number"||e==="time"))return e;if(TO(t)&&n!=="time"&&n!=="utc")return"time"}function zge(e,t,n){if(Xt(t))return t;if(e===tg)return n.numberFormat}function Rvt(e,t,n,r){return e||(t?{signal:xge(t)}:r?void 0:n.timeFormat)}function jge(e,t){return`format(${e}, "${t||""}")`}function Uge(e,t,n,r){var i;return rg(n)?Pge(n,e,t):jge(e,(i=Xt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function wO(e,t,n,r,i){const a=Uge(e,n,r,i),o=Uge(t,n,r,i);return`${c8(e,!1)} ? "null" : ${a} + "${Dvt}" + ${o}`}function Fvt(e,t,n,r,i){return!t||n?(n=Xt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):Ymt(t,e,i)}const _O="min",Mvt={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Wge(e){return e in Mvt}function Vge(e){return!!e&&!!e.encoding}function Dl(e){return!!e&&(e.op==="count"||!!e.field)}function qge(e){return!!e&&vt(e)}function xw(e){return"row"in e||"column"in e}function y8(e){return!!e&&"header"in e}function SO(e){return"facet"in e}function Pvt(e){return e.selection}function $vt(e){return e&&!Xt(e)&&"repeat"in e}function Hge(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Gge(e){return Go(e)&&"sort"in e}function ww({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(It(t)&&t.band!==void 0)return t.band;if(We(t)){const{timeUnit:s,bin:u}=t;if(s&&!n)return o?og("timeUnitBandPosition",r,a):$pe(r.type)?og("timeUnitBand",r,a):0;if(Qn(u))return $pe(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function b8(e,t,n,r,i,a){return Qn(t.bin)||t.timeUnit&&Go(t)&&t.type==="temporal"?!!ww({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a}):!1}function x8(e){return!!e&&"condition"in e}function EO(e){const t=e&&e.condition;return!!t&&!vt(t)&&We(t)}function w8(e){const t=e&&e.condition;return!!t&&!vt(t)&&It(t)}function Lvt(e){const t=e&&e.condition;return!!t&&(vt(t)||Vc(t))}function We(e){return!!e&&(!!e.field||e.aggregate==="count")}function Yd(e){return e&&e.type}function Zd(e){return!!e&&"datum"in e}function Rl(e){return Go(e)&&Zge(e)||_8(e)}function _8(e){return Zd(e)&&Jr(e.datum)}function It(e){return We(e)||Zd(e)}function Go(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Vc(e){return e&&"value"in e&&"value"in e}function S8(e){return!!e&&("scale"in e||"sort"in e)}function E8(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Kge(e){return!!e&&"legend"in e}function Xge(e){return!!e&&("format"in e||"formatType"in e)}function Bvt(e){return"op"in e}function Ue(e,t={}){var n,r,i;let a=e.field;const o=t.prefix;let s=t.suffix,u="";if(zvt(e))a=Qpt("count");else{let l;if(!t.nofn)if(Bvt(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Qn(c)?(l=Jpe(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Zp(f)?(u=`["${a}"]`,a=`argmax_${f.argmax}`):zd(f)?(u=`["${a}"]`,a=`argmin_${f.argmin}`):l=String(f):d&&(l=Zmt(d),s=(!bt(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(a=a?`${l}_${a}`:l)}return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),t.forAs?Ope(a):t.expr?Xpt(a,t.expr)+u:Bd(a)+u}function Yge(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return We(e)&&!!e.bin;case"temporal":return!1}throw new Error(uge(e.type))}function Zge(e){return!Yge(e)}function zvt(e){return e.aggregate==="count"}function jvt(e,t){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=e;if(o==="count")return t.countTitle;if(Qn(i))return`${r} (binned)`;if(a){const s=(n=Va(a))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${a8(s).join("-")})`}else if(o)return Zp(o)?`${r} for max ${o.argmax}`:zd(o)?`${r} for min ${o.argmin}`:`${eO(o)} of ${r}`;return r}function Uvt(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Zp(t))return`${i} for argmax(${t.argmax})`;if(zd(t))return`${i} for argmin(${t.argmin})`;const a=Va(r),o=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||Qn(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const Jge=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Uvt(e);default:return jvt(e,t)}};let Qge=Jge;function eme(e){Qge=e}function Wvt(){eme(Jge)}function ig(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,a;const s=((i=C8(e))!==null&&i!==void 0?i:{}).title;if(!We(e))return s;const u=e,l=r?tme(u,t):void 0;return n?Qr(s,u.title,l):(a=s??u.title)!==null&&a!==void 0?a:l}function C8(e){if(E8(e)&&e.axis)return e.axis;if(Kge(e)&&e.legend)return e.legend;if(y8(e)&&e.header)return e.header}function tme(e,t){return Qge(e,t)}function CO(e){var t;if(Xge(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=C8(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function Vvt(e,t){if(e.timeUnit)return"temporal";if(Qn(e.bin))return"quantitative";switch(gO(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Fl(e){if(We(e))return e;if(EO(e))return e.condition}function hi(e){if(It(e))return e;if(w8(e))return e.condition}function A8(e,t,n){if(Xt(e)||Jr(e)||sw(e)){const r=Xt(e)?"string":Jr(e)?"number":"boolean";return Me(nmt(t,r,e)),{value:e}}return It(e)?AO(e,t,n):w8(e)?Object.assign(Object.assign({},e),{condition:AO(e.condition,t,n)}):e}function AO(e,t,n){if(Xge(e)){const{format:r,formatType:i}=e,a=dt(e,["format","formatType"]);if(rg(i)&&!n.customFormatTypes)return Me(sge(t)),AO(a,t,n)}else{const r=E8(e)?"axis":Kge(e)?"legend":y8(e)?"header":null;if(r&&e[r]){const i=e[r],{format:a,formatType:o}=i,s=dt(i,["format","formatType"]);if(rg(o)&&!n.customFormatTypes)return Me(sge(t)),AO(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return We(e)?nme(e,t):qvt(e)}function qvt(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Jr(n)?"quantitative":Xt(n)?"nominal":p0(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function nme(e,t){const{aggregate:n,timeUnit:r,bin:i,field:a}=e,o=Object.assign({},e);if(n&&!Kj(n)&&!Zp(n)&&!zd(n)&&(Me(imt(n)),delete o.aggregate),r&&(o.timeUnit=Va(r)),a&&(o.field=`${a}`),Qn(i)&&(o.bin=kO(i,t)),Wa(i)&&!Il(t)&&Me(`Channel ${t} should not be used with "binned" bin.`),Go(o)){const{type:s}=o,u=uvt(s);s!==u&&(o.type=u),s!=="quantitative"&&jpe(n)&&(Me(rmt(s,n)),o.type="quantitative")}else if(!Kpe(t)){const s=Vvt(o,t);Me(amt(t,s)),o.type=s}if(Go(o)){const{compatible:s,warning:u}=Hvt(o,t);s||Me(u)}if(Gge(o)&&Xt(o.sort)){const{sort:s}=o;if(Wge(s))return Object.assign(Object.assign({},o),{sort:{encoding:s}});const u=s.substr(1);if(s.charAt(0)==="-"&&Wge(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(y8(o)){const{header:s}=o,{orient:u}=s,l=dt(s,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:s.labelOrient||u,titleOrient:s.titleOrient||u})})}return o}function kO(e,t){return sw(e)?{maxbins:Qpe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:Qpe(t)}):e}const ag={compatible:!0};function Hvt(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Lc:case Bc:case uO:return Zge(e)?{compatible:!1,warning:umt(t)}:ag;case br:case di:case vo:case Al:case kl:case pw:case mw:case lO:case Qp:case cO:case fO:case Jp:case yu:case Sl:case dO:return ag;case Cl:case xs:case El:case bu:return n!==tg?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:ag;case Wc:case jd:case Ud:case Wd:case Uc:case jc:case zc:case vu:case _l:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:ag;case Vd:return bt(["ordinal","nominal"],e.type)?ag:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case yo:return bt(["ordinal","nominal","geojson"],e.type)?ag:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case gw:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:ag}}function TO(e){const{formatType:t}=CO(e);return t==="time"||!t&&Gvt(e)}function Gvt(e){return e&&(e.type==="temporal"||We(e)&&!!e.timeUnit)}function k8(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=t&&((a=Va(t))===null||a===void 0?void 0:a.unit);let s=o||n==="temporal",u;return Et(e)?u=e.signal:p0(e)?(s=!0,u=yw(e)):(Xt(e)||Jr(e))&&s&&(u=`datetime(${JSON.stringify(e)})`,Hmt(o)&&(Jr(e)&&e<1e4||Xt(e)&&isNaN(Date.parse(e)))&&(u=yw({[o]:e}))),u?r&&s?`time(${u})`:u:i?void 0:JSON.stringify(e)}function rme(e,t){const{type:n}=e;return t.map(r=>{const i=k8(r,{timeUnit:We(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function _w(e,t){return Qn(e.bin)?Gd(t)&&bt(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function ime(e){const{anchor:t,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=dt(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),v=cw(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function Jd(e){return Xt(e)||vt(e)&&Xt(e[0])}function zr(e){return Et(e)?e:e!==void 0?{value:e}:void 0}function ame(e){return Et(e)?e.signal:gn(e.value)}function Sw(e){return Et(e)?e.signal:e==null?null:gn(e)}function Kvt(e,t,n){for(const r of n){const i=og(r,t.markDef,t.config);i!==void 0&&(e[r]=zr(i))}return e}function ome(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Fn(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:a&&(!i||i===e)?void 0:og(e,t,n,r)}function og(e,t,n,{vgChannel:r}={}){return Qr(r?OO(e,t,n.style):void 0,OO(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function OO(e,t,n){return sme(e,ome(t),n)}function sme(e,t,n){t=Br(t);let r;for(const i of t){const a=n[i];a&&a[e]!==void 0&&(r=a[e])}return r}function ume(e,t){return Br(e).reduce((n,r)=>{var i;return n.field.push(Ue(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function lme(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(lw(i,r))return;n.push(r)}),n}function cme(e,t){return lw(e,t)||!t?e:e?[...Br(e),...Br(t)].join(", "):t}function fme(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Jd(n)||Et(n))&&(Jd(r)||Et(r)))return{explicit:e.explicit,value:cme(n,r)};if(Jd(n)||Et(n))return{explicit:e.explicit,value:n};if(Jd(r)||Et(r))return{explicit:e.explicit,value:r};if(!Jd(n)&&!Et(n)&&!Jd(r)&&!Et(r))return{explicit:e.explicit,value:lme(n,r)};throw new Error("It should never reach here")}function sg(e,t){const n=e&&e[t];return n?vt(n)?fw(n,r=>!!r.field):We(n)||EO(n):!1}function T8(e){return fw(Hpe,t=>{if(sg(e,t)){const n=e[t];if(vt(n))return fw(n,r=>!!r.aggregate);{const r=Fl(n);return r&&!!r.aggregate}}return!1})}function O8(e,t){const n=[],r=[],i=[],a=[],o={};return I8(e,(s,u)=>{if(We(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=dt(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=C8(s),g=p&&p.title;let m=Ue(s,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:ig(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Zp(c)?(y="argmax",m=Ue({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):zd(c)?(y="argmin",m=Ue({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),a.push(b)}}else if(n.push(m),Go(s)&&Qn(f)){if(r.push({bin:f,field:l,as:m}),n.push(Ue(s,{binSuffix:"end"})),_w(s,u)&&n.push(Ue(s,{binSuffix:"range"})),Il(u)){const y={field:m+"_end"};o[u+"2"]=y}v.bin="binned",Kpe(u)||(v.type=tg)}else if(d){i.push({timeUnit:d,field:l,as:m});const y=Go(s)&&s.type!==m0&&"time";y&&(u===pw||u===Qp?v.formatType=y:Pgt(u)?v.legend=Object.assign({formatType:y},v.legend):Il(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}o[u]=v}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function Xvt(e,t,n){const r=Lgt(t,n);if(r){if(r==="binned"){const i=e[t===vu?br:di];return!!(We(i)&&We(e[t])&&Wa(i.bin))}}else return!1;return!0}function Yvt(e,t,n){const r=t.type;return Be(e).reduce((i,a)=>{if(!Gpe(a))return Me(smt(a)),i;const o=e[a];if(a==="angle"&&r==="arc"&&!e.theta&&(Me(tmt),a=yu),!Xvt(e,a,r))return Me(vO(a,r)),i;if(a===Uc&&r==="line"){const s=Fl(e[a]);if(s==null?void 0:s.aggregate)return Me(omt),i}if(a===vo&&(t.filled?"fill"in e:"stroke"in e))return Me(lge("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(a===mw||a===gw&&!vt(o)&&!Vc(o)||a===Qp&&vt(o))o&&(i[a]=Br(o).reduce((s,u)=>(We(u)?s.push(nme(u,a)):Me(e8(u,a)),s),[]));else{if(a===Qp&&o===null)i[a]=null;else if(!We(o)&&!Zd(o)&&!Vc(o)&&!x8(o)&&!Et(o))return Me(e8(o,a)),i;i[a]=A8(o,a,n)}return i},{})}function Zvt(e){const t=[];for(const n of Be(e))if(sg(e,n)){const r=e[n],i=Br(r);for(const a of i)We(a)?t.push(a):EO(a)&&t.push(a.condition)}return t}function I8(e,t,n){if(!!e)for(const r of Be(e)){const i=e[r];if(vt(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function dme(e,t,n,r){return e?Be(e).reduce((i,a)=>{const o=e[a];return vt(o)?o.reduce((s,u)=>t.call(r,s,u,a),i):t.call(r,i,o,a)},n):n}function hme(e,t){return Be(t).reduce((n,r)=>{switch(r){case br:case di:case cO:case dO:case fO:case vu:case _l:case yu:case jc:case Sl:case zc:case El:case Cl:case bu:case xs:case pw:case yo:case Jp:case Qp:return n;case gw:if(e==="line"||e==="trail")return n;case mw:case lO:{const i=t[r];if(vt(i)||We(i))for(const a of Br(i))a.aggregate||n.push(Ue(a,{}));return n}case Uc:if(e==="trail")return n;case vo:case Al:case kl:case Wc:case jd:case Ud:case Vd:case Wd:{const i=Fl(t[r]);return i&&!i.aggregate&&n.push(Ue(i,{})),n}}},[])}function Jvt(e){const{tooltip:t}=e,n=dt(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(vt(t)){for(const a of t)a.aggregate?(r||(r=[]),r.push(a)):(i||(i=[]),i.push(a));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return vt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function N8(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:a,titlePrefix:o})=>{const s=r?` of ${t.field}`:"";return{field:a+t.field,type:t.type,title:Et(o)?{signal:o+`"${escape(s)}"`}:o+s}}),...Zvt(n)]}}function pme(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:Qr(n,r)}function D8(e,t,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=pme(n);return gme(e,s,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),a!==void 0?{scale:a}:{}),o!==void 0?{axis:o}:{})},Xt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function gme(e,t,n,r,i){const{clip:a,color:o,opacity:s}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),wl(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),sw(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function mme(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:IO(a,n),continuousAxisChannelDef2:IO(o,n),continuousAxisChannelDefError:IO(s,n),continuousAxisChannelDefError2:IO(u,n),continuousAxis:i}}function IO(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=dt(e,["aggregate"]);return n!==t&&Me(Rmt(n,t)),r}else return e}function vme(e,t){const{mark:n,encoding:r}=e,{x:i,y:a}=r;if(Rl(i)){if(Rl(a)){const o=We(i)&&i.aggregate,s=We(a)&&a.aggregate;if(!o&&s===t)return"vertical";if(!s&&o===t)return"horizontal";if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");return wl(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Rl(a))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const NO="boxplot",Qvt=["box","median","outliers","rule","ticks"],e0t=new sO(NO,bme);function yme(e){return Jr(e)?"tukey":e}function bme(e,{config:t}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=wl(i)?i:{type:i};o&&Me(ige("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Fn("size",l,t),d=yme(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=t0t(e,c,t),{color:S,size:C}=y,_=dt(y,["color","size"]),E=G=>D8(l,g,p,G,t.boxplot),A=E(_),k=E(y),T=E(Object.assign(Object.assign({},_),C?{size:C}:{})),I=N8([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),N={type:"tick",color:"black",opacity:1,orient:b,invalid:null},O=d==="min-max"?I:N8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),D=[...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],L=[...d!=="tukey"?D:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:I}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ai(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:I})];let W;if(d!=="min-max"){const G=`datum["lower_box_${p.field}"]`,K=`datum["upper_box_${p.field}"]`,ee=`(${K} - ${G})`,ce=`${G} - ${c} * ${ee}`,he=`${K} + ${c} * ${ee}`,Oe=`datum["${p.field}"]`,Te={joinaggregate:xme(p.field),groupby:m};let De;d==="tukey"&&(De={transform:[{filter:`(${ce} <= ${Oe}) && (${Oe} <= ${he})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:D});const me=dt(_,["tooltip"]),{scale:P,axis:F}=p,V=pme(p),ae=gme(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Oe} < ${ce}) || (${Oe} > ${he})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},V!==void 0?{title:V}:{}),P!==void 0?{scale:P}:{}),F!==void 0?{axis:F}:{})},me),w?{tooltip:w}:{})})[0];ae&&De?W={transform:[Te],layer:[ae,De]}:ae?(W=ae,W.transform.unshift(Te)):De&&(W=De,W.transform.unshift(Te))}return W?Object.assign(Object.assign({},u),{layer:[W,{transform:h,layer:L}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:L})}function xme(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function t0t(e,t,n){const r=vme(e,NO),{continuousAxisChannelDef:i,continuousAxis:a}=mme(e,r,NO),o=i.field,s=yme(t),u=[...xme(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(s==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(s==="min-max"?"upper_whisker_":"max_")+o}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=a;c[f];const d=dt(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=Jvt(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=O8(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...u],groupby:y},...l],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const R8="errorbar",n0t=["ticks","rule"],r0t=new sO(R8,wme);function wme(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:l}=_me(e,R8,t),c=D8(s,i,r,a,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function i0t(e,t){const{encoding:n}=e;if(a0t(n))return{orient:vme(e,t),inputType:"raw"};const r=o0t(n),i=s0t(n),a=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(It(s)&&It(u))throw new Error(`${t} cannot have both x2 and y2`);if(It(s)){if(Rl(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(It(u)){if(Rl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(It(u)&&!It(s))throw new Error(`${t} cannot have xError2 without xError`);if(It(c)&&!It(l))throw new Error(`${t} cannot have yError2 without yError`);if(It(s)&&It(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(It(s)){if(Rl(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(It(l)){if(Rl(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function a0t(e){return(It(e.x)||It(e.y))&&!It(e.x2)&&!It(e.y2)&&!It(e.xError)&&!It(e.xError2)&&!It(e.yError)&&!It(e.yError2)}function o0t(e){return It(e.x2)||It(e.y2)}function s0t(e){return It(e.xError)||It(e.xError2)||It(e.yError)||It(e.yError2)}function _me(e,t,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=wl(i)?i:{type:i};o&&Me(ige(t));const{orient:c,inputType:f}=i0t(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=mme(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=u0t(l,d,h,p,g,f,t,n),w=a,S=m;w[S];const C=m==="x"?"x2":"y2";w[C];const _=m==="x"?"xError":"yError";w[_];const E=m==="x"?"xError2":"yError2";w[E];const A=dt(w,[typeof S=="symbol"?S:S+"",typeof C=="symbol"?C:C+"",typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+""]),{bins:k,timeUnits:T,aggregate:I,groupby:N,encoding:O}=O8(A,n),D=[...I,...v],L=f!=="raw"?[]:N,W=N8(b,d,O,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...k,...T,...D.length===0?[]:[{aggregate:D,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:W}}function u0t(e,t,n,r,i,a,o,s){let u=[],l=[];const c=t.field;let f,d=!1;if(a==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Me(Dmt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:eO(h)},{fieldPrefix:"upper_",titlePrefix:Sme(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:Sme(h,p,"-")}],d=!0;else{e.center&&e.extent&&Me(Fmt(e.extent,o));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:ig({field:c,aggregate:v,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ig({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ig({field:c,aggregate:g,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Me(Nmt(e.center,e.extent)),a==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):a==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:f0(f0(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function Sme(e,t,n){return eO(e)+" "+n+" "+t}const F8="errorband",l0t=["band","borders"],c0t=new sO(F8,Eme);function Eme(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=_me(e,F8,t),l=o,c=D8(l,i,r,a,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?Me(hge("interpolate")):l.tension&&Me(hge("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const Cme={};function M8(e,t,n){const r=new sO(e,t);Cme[e]={normalizer:r,parts:n}}function f0t(){return Be(Cme)}M8(NO,bme,Qvt),M8(R8,wme,n0t),M8(F8,Eme,l0t);const d0t=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Ame=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],h0t={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},p0t={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},g0t={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},y0="_vgsid_",m0t={single:{on:"click",fields:[y0],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[y0],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function P8(e){return!!e&&(e==="legend"||!!e.legend)}function $8(e){return P8(e)&&Ai(e)}function v0t(e){return DO(e)||B8(e)||L8(e)}function L8(e){return"concat"in e}function DO(e){return"vconcat"in e}function B8(e){return"hconcat"in e}function Ml(e){return Ai(e)&&e.step!==void 0}function kme(e){return e.view||e.width||e.height}const Tme=20,y0t={align:1,bounds:1,center:1,columns:1,spacing:1},b0t=Be(y0t);function x0t(e,t,n){var r,i;const a=n[t],o={},{spacing:s,columns:u}=a;s!==void 0&&(o.spacing=s),u!==void 0&&(SO(e)&&!xw(e.facet)||L8(e))&&(o.columns=u),DO(e)&&(o.columns=1);for(const l of b0t)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Jr(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else o[l]=e[l];return o}function z8(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function RO(e,t){const n=Ew(e,t);return Ml(n)?n.step:j8}function Ew(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Qr(r,{step:e.step})}const j8=20,w0t={continuousWidth:200,continuousHeight:200,step:j8},_0t={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:w0t,mark:fgt,arc:{},area:{},bar:hgt,circle:{},geoshape:{},image:{},line:{},point:{},rect:pgt,rule:{color:"black"},square:{},text:{color:"black"},tick:ggt,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:_vt,projection:{},legend:p0t,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:m0t,style:{},title:{},facet:{spacing:Tme},concat:{spacing:Tme}},qc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Ome={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Ime={blue:qc[0],orange:qc[1],red:qc[2],teal:qc[3],green:qc[4],yellow:qc[5],purple:qc[6],pink:qc[7],brown:qc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function S0t(e={}){return{signals:[{name:"color",value:Ai(e)?Object.assign(Object.assign({},Ime),e):Ime}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function E0t(e){return{signals:[{name:"fontSize",value:Ai(e)?Object.assign(Object.assign({},Ome),e):Ome}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function C0t(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Nme(e={}){const{color:t,font:n,fontSize:r}=e,i=dt(e,["color","font","fontSize"]);return xpe({},_0t,n?C0t(n):{},t?S0t(t):{},r?E0t(r):{},i||{})}const A0t=["view",...Lpe],k0t=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],T0t=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},cgt);function O0t(e){e=Yt(e);for(const t of k0t)delete e[t];if(e.axis)for(const t in e.axis)Vj(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of d0t)delete e.legend[t];if(e.mark){for(const t of Bpe)delete e.mark[t];e.mark.tooltip&&Ai(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of A0t){for(const r of Bpe)delete e[t][r];const n=T0t[t];if(n)for(const r of n)delete e[t][r];N0t(e,t)}for(const t of f0t())delete e[t];I0t(e);for(const t in e)Ai(e[t])&&Yn(e[t])&&delete e[t];return Yn(e)?void 0:e}function I0t(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=ime(e.title);Yn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Yn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Yn(r)?delete e.title:e.title=r}function N0t(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const a=Object.assign(Object.assign({},i),e.style[n??t]);Yn(a)||(e.style[n??t]=a),r||delete e[t]}function FO(e){return"layer"in e}function D0t(e){return"repeat"in e}function R0t(e){return!vt(e.repeat)&&e.repeat.layer}class Dme{map(t,n){return SO(t)?this.mapFacet(t,n):D0t(t)?this.mapRepeat(t,n):B8(t)?this.mapHConcat(t,n):DO(t)?this.mapVConcat(t,n):L8(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(FO(t))return this.mapLayer(t,n);if($c(t))return this.mapUnit(t,n);throw new Error(Qj(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=dt(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(a=>this.map(a,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const F0t={zero:1,center:1,normalize:1};function M0t(e){return e in F0t}const P0t=new Set([Fpe,rO,nO,oO,aO,Hj,Gj,iO,Mpe,qj]),$0t=new Set([rO,nO,Fpe]);function Rme(e,t){var n,r;const i=t==="x"?"y":"radius",a=e[t],o=e[i];if(We(a)&&We(o))if(Yd(a)==="quantitative"&&Yd(o)==="quantitative"){if(a.stack)return t;if(o.stack)return i;const s=We(a)&&!!a.aggregate,u=We(o)&&!!o.aggregate;if(s!==u)return s?t:i;{const l=(n=a.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Yd(a)==="quantitative")return t;if(Yd(o)==="quantitative")return i}else{if(Yd(a)==="quantitative")return t;if(Yd(o)==="quantitative")return i}}function L0t(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Fme(e,t,n={}){const r=wl(e)?e.type:e;if(!P0t.has(r))return null;const i=Rme(t,"x")||Rme(t,"theta");if(!i)return null;const a=t[i],o=We(a)?Ue(a,{}):void 0;let s=L0t(i),u=t[s],l=We(u)?Ue(u,{}):void 0;l===o&&(l=void 0,u=void 0,s=void 0);const c=Rgt.reduce((d,h)=>{if(h!=="tooltip"&&sg(t,h)){const p=t[h];for(const g of Br(p)){const m=Fl(g);if(m.aggregate)continue;const v=Ue(m,{});(!v||v!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(a.stack!==void 0?sw(a.stack)?f=a.stack?"zero":null:f=a.stack:c.length>0&&$0t.has(r)&&(f="zero"),!f||!M0t(f)||T8(t)&&c.length===0)return null;if(a.scale&&a.scale.type&&a.scale.type!==ei.LINEAR){if(n.disallowNonLinearStack)return null;Me(Tmt(a.scale.type))}return It(t[Tl(i)])?(a.stack!==void 0&&Me(kmt(i)),null):(We(a)&&a.aggregate&&!bt(wgt,a.aggregate)&&Me(Omt(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:a.impute===null?!1:Yp(r),stackBy:c,offset:f})}function B0t(e){const t=dt(e,["point","line"]);return Be(t).length>1?t:t.type}function z0t(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Pc(e[t],["point","line"])}));return e}function U8(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ai(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ai(t.point)?t.point:{}:void 0}function Mme(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class j0t{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if($c(t)){const{mark:r,encoding:i}=t,a=wl(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!U8(a,n[a.type],i);case"area":return!!U8(a,n[a.type],i)||!!Mme(a,n[a.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:a,projection:o,encoding:s,mark:u}=t,l=dt(t,["selection","projection","encoding","mark"]),c=wl(u)?u:{type:u},f=U8(c,i[c.type],s),d=c.type==="area"&&Mme(c,i[c.type]),h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:B0t(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:Pc(s,["shape"])})],p=Fme(c,s);let g=s;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},s),{[m]:Object.assign(Object.assign({},s[m]),v?{stack:v}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},cw(c,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},cw(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:z0t(i)}))}}class U0t{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if($c(t)&&t.encoding)for(const r of _s){const i=t.encoding[r];if(i&&It(i)&&((n=i==null?void 0:i.scale)===null||n===void 0?void 0:n.rangeStep))return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const a of _s){const o=Ol(a),s=i[a];if(s&&It(s)&&((n=s==null?void 0:s.scale)===null||n===void 0?void 0:n.rangeStep)){const{scale:u}=s,l=dt(s,["scale"]),c=u,f=dt(c,["rangeStep"]);r[o]={step:u.rangeStep},Me(dmt),i=Object.assign(Object.assign({},i),{[a]:Object.assign(Object.assign({},l),Yn(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function W0t(e,t){return t?xw(e)?Bme(e,t):Pme(e,t):e}function W8(e,t){return t?Bme(e,t):e}function V8(e,t,n){const r=t[e];if($vt(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Me(Kgt(r.repeat));return}return t}function Pme(e,t){if(e=V8("field",e,t),e!==void 0){if(e===null)return null;if(Gge(e)&&Dl(e.sort)){const n=V8("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function $me(e,t){if(We(e))return Pme(e,t);{const n=V8("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Lme(e,t){if(It(e)){const n=$me(e,t);if(n)return n;if(x8(e))return{condition:e.condition}}else{if(w8(e)){const n=$me(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):dt(e,["condition"])}return e}}function Bme(e,t){const n={};for(const r in e)if(Kp(e,r)){const i=e[r];if(vt(i))n[r]=i.map(a=>Lme(a,t)).filter(a=>a);else{const a=Lme(i,t);a!==void 0&&(n[r]=a)}}return n}class V0t{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if($c(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of Ngt){const a=eg(i),o=n[a];if(n[i]&&(We(o)&&!Wa(o.bin)||Zd(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Me(cmt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class q0t extends Dme{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[e0t,r0t,c0t,new j0t,new V0t,new U0t]}map(t,n){if($c(t)){const r=sg(t.encoding,Lc),i=sg(t.encoding,Bc),a=sg(t.encoding,uO);if(r||i||a)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,a=Object.assign(Object.assign({},t),{encoding:W8(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,n.config))return s.run(a,n,o);return a}mapRepeat(t,n){return R0t(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,a=dt(t,["repeat","spec"]),{row:o,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},a),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${fr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:a,data:o}=t,s=dt(t,["repeat","spec","data"]);!vt(i)&&t.columns&&(t=Pc(t,["columns"]),Me(age("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!vt(i)&&i.row||[l?l.row:null],d=!vt(i)&&i.column||[l?l.column:null],h=vt(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(a.name||"")+c+"child__"+(vt(i)?`${fr(g)}`:(i.row?`row_${fr(m)}`:"")+(i.column?`column_${fr(v)}`:"")),x=this.map(a,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,u.push(Pc(x,["data"]))}const p=vt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=a.data)!==null&&r!==void 0?r:o,align:"all"},s),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return xw(r)&&t.columns&&(t=Pc(t,["columns"]),Me(age("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:a,parentProjection:o,config:s}=n,u=jme({parentProjection:o,projection:i}),l=zme({parentEncoding:a,encoding:W8(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:a,facet:o}=r,s=dt(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,g=dt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:a,facet:o},n),y=W8(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:a,facet:o}=t;if(i||a){o&&Me(lmt([...i?[Lc]:[],...a?[Bc]:[]]));const s={},u={};for(const l of[Lc,Bc]){const c=t[l];if(c){const f=dt(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=o,f=dt(o,["align","center","spacing","columns"]);return{facetMapping:W0t(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,a=dt(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,u=dt(t,["encoding","projection"]),l=Object.assign(Object.assign({},a),{parentEncoding:zme({parentEncoding:r,encoding:o}),parentProjection:jme({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function zme(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Be(t).reduce((a,o)=>(n[o]&&a.push(o),a),[]);i.length>0&&Me(Qgt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return Yn(r)?void 0:r}function jme(e){const{parentProjection:t,projection:n}=e;return t&&n&&Me(emt({parentProjection:t,projection:n})),n??t}function Ume(e,t){t===void 0&&(t=Nme(e.config));const n=G0t(e,t),{width:r,height:i}=e,a=K0t(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const H0t=new q0t;function G0t(e,t={}){return H0t.map(e,{config:t})}function Wme(e){return Xt(e)?{type:e}:e??{}}function K0t(e,t,n){let{width:r,height:i}=t;const a=$c(e)||FO(e),o={};a?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(Me(ege("width")),r=void 0),i=="container"&&(Me(ege("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Wme(n.autosize):{}),Wme(e.autosize));if(s.type==="fit"&&!a&&(Me(jgt),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&Me(tge("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&Me(tge("height")),!lw(s,{type:"pad"}))return s}function X0t(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Y0t(e){return e?`fit-${hO(e)}`:"fit"}const Z0t=["background","padding"];function Vme(e){return Z0t.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class Hc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Hc(Yt(this.explicit),Yt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Qr(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Be(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function ug(e){return{explicit:!0,value:e}}function Ko(e){return{explicit:!1,value:e}}function qme(e){return(t,n,r,i)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:MO(t,n,r,i)}}function MO(e,t,n,r){return e.explicit&&t.explicit&&Me(xmt(n,r,e.value,t.value)),e}function Qd(e,t,n,r,i=MO){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:lw(e.value,t.value)?e:i(e,t,n,r)}class J0t extends Hc{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Cw(e){return"url"in e}function PO(e){return"values"in e}function Hme(e){return"name"in e&&!Cw(e)&&!PO(e)&&!lg(e)}function lg(e){return e&&(Gme(e)||Kme(e)||q8(e))}function Gme(e){return"sequence"in e}function Kme(e){return"sphere"in e}function q8(e){return"graticule"in e}const sa="main",$O="raw";function Xme(e){return"filter"in e}function Q0t(e){return(e==null?void 0:e.stop)!==void 0}function eyt(e){return"lookup"in e}function tyt(e){return"data"in e}function nyt(e){return"selection"in e}function ryt(e){return"pivot"in e}function iyt(e){return"density"in e}function ayt(e){return"quantile"in e}function oyt(e){return"regression"in e}function syt(e){return"loess"in e}function uyt(e){return"sample"in e}function lyt(e){return"window"in e}function cyt(e){return"joinaggregate"in e}function fyt(e){return"flatten"in e}function dyt(e){return"calculate"in e}function hyt(e){return"bin"in e}function pyt(e){return"impute"in e}function gyt(e){return"timeUnit"in e}function myt(e){return"aggregate"in e}function vyt(e){return"stack"in e}function yyt(e){return"fold"in e}function byt(e){return e.map(t=>Xme(t)?{filter:JT(t.filter,ovt)}:t)}function Aw(e,t,n,r){const i=x8(t)&&t.condition,a=r(t);if(i){const s=Br(i).map(u=>{const l=r(u),c=Pvt(u)?Fve(e,u.selection):XO(e,u.test);return Object.assign({test:c},l)});return{[n]:[...s,...a!==void 0?[a]:[]]}}else return a!==void 0?{[n]:a}:{}}function H8(e,t="text"){const n=e.encoding[t];return Aw(e,n,t,r=>LO(r,e.config))}function LO(e,t,n="datum"){if(e){if(Vc(e))return zr(e.value);if(It(e)){const{format:r,formatType:i}=CO(e);return m8({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Yme(e,t={}){const{encoding:n,markDef:r,config:i,stack:a}=e,o=n.tooltip;if(vt(o))return{tooltip:Jme({tooltip:o},a,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Aw(e,o,"tooltip",u=>{const l=LO(u,i,s);if(l)return l;if(u===null)return;let c=Fn("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),Xt(c))return{value:c};if(Ai(c))return c.content==="encoding"?Jme(n,a,i,t):{signal:s}})}}function Zme(e,t,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(l,c){const f=eg(c),d=Go(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=Br(ig(d,n,{allowDisabling:!1})).join(", ");let p;if(Il(c)){const g=c==="x"?"x2":"y2",m=Fl(e[g]);if(Wa(d.bin)&&m){const v=Ue(d,{expr:a}),y=Ue(m,{expr:a}),{format:b,formatType:x}=CO(d);p=wO(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=CO(d);p=m8({fieldOrDatumDef:d,format:v,formatType:y,expr:a,config:n,normalizeStack:!0}).signal}}p=p??LO(d,n,a).signal,o.push({channel:c,key:h,value:p})}I8(e,(l,c)=>{We(l)?s(l,c):EO(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[gn(c)]=f);return u}function Jme(e,t,n,{reactiveGeom:r}={}){const i=Zme(e,t,n,{reactiveGeom:r}),a=kpe(i).map(({key:o,value:s})=>`${o}: ${s}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function xyt(e){const{markDef:t,config:n}=e,r=Fn("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),wyt(e)),_yt(e))}function wyt(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Fn("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in nvt?{}:{ariaRoleDescription:{value:t}}}function _yt(e){const{encoding:t,markDef:n,config:r,stack:i}=e,a=t.description;if(a)return Aw(e,a,"description",u=>LO(u,e.config));const o=Fn("description",n,r);if(o!=null)return{description:zr(o)};if(r.aria===!1)return{};const s=Zme(t,i,r);if(!Yn(s))return{description:{signal:kpe(s).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function ki(e,t,n={}){const{markDef:r,encoding:i,config:a}=t,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u=u??Fn(e,r,a,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(s=zr(u)));const l=i[e];return Aw(t,l,o??e,c=>Mge({channel:e,channelDef:c,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function Qme(e,t={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Fn("filled",o,u),f=bt(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=Fn(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(a=Fn(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&a!==void 0?a:u.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:zr(d)}:{}),h?{stroke:zr(h)}:{});return o.color&&(c?o.fill:o.stroke)&&Me(lge("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),ki("color",e,{vgChannel:p,defaultValue:c?d:h})),ki("fill",e,{defaultValue:s.fill?d:void 0})),ki("stroke",e,{defaultValue:s.stroke?h:void 0}))}function kw(e,t){const n=Dgt(e),r=t[n];if(r)return r}function ua(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=t,l=a[e],c=a[Tl(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=kw(e,o),p=G8({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!l&&Il(e)&&(a.latitude||a.longitude)?{field:t.getName(e)}:Syt({channel:e,channelDef:l,channel2Def:c,markDef:o,config:s,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[r||e]:g}:void 0}function Syt(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=e;if(It(n)&&a&&t===a.fieldChannel){if(We(n)){const l=ww({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(l!==void 0)return xO({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return ng(n,i,{suffix:"end"},{offset:o})}return p8(e)}function G8({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=e;return()=>{const s=eg(n),u=qd(n),l=Fn(n,a,o,{vgChannel:u});if(l!==void 0)return bw(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!bt([ei.LOG,ei.TIME,ei.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Ol(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const Eyt={left:"x",center:"xc",right:"x2"},Cyt={top:"y",middle:"yc",bottom:"y2"};function eve(e,t,n,r="middle"){if(e==="radius"||e==="theta")return qd(e);const a=Fn(e==="x"?"align":"baseline",t,n);return e==="x"?Eyt[a||(r==="top"?"left":"center")]:Cyt[a||r]}function BO(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?tve(e,t,{defaultPos:n,defaultPos2:r}):ua(e,t,{defaultPos:n})}function tve(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=t,o=Tl(e),s=Ol(e),u=Ayt(t,r,o),l=u[s]?eve(e,i,a):qd(e);return Object.assign(Object.assign({},ua(e,t,{defaultPos:n,vgChannel:l})),u)}function Ayt(e,t,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=e,u=eg(n),l=Ol(n),c=qd(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in a?kw(n,e.markDef):kw(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=kyt({channel:n,channelDef:f,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:zO(n,a)||zO(n,{[n]:OO(n,a,s.style),[l]:OO(l,a,s.style)})||zO(n,s[i])||zO(n,s.mark)||{[c]:G8({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function kyt({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l}){return It(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?ng(t,a,{suffix:"start"},{offset:u}):p8({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function zO(e,t){const n=Ol(e),r=qd(e);if(t[r]!==void 0)return{[r]:bw(e,t[r])};if(t[e]!==void 0)return{[r]:bw(e,t[e])};if(t[n])return{[n]:bw(e,t[n])}}function eh(e,t,n){var r,i,a,o;const{config:s,encoding:u,markDef:l,stack:c}=e,f=Tl(t),d=Ol(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=l.orient,b=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:Fn("size",l,s,{vgChannel:d}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(We(h)&&(Qn(h.bin)||Wa(h.bin)||h.timeUnit&&!p)&&!b&&!bo(m)){const w=ww({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),S=(a=e.component.axes[t])===null||a===void 0?void 0:a[0],C=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return Iyt({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:v,band:w,axisTranslate:C,spacing:Il(t)?Fn("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(It(h)&&bo(m)||x)&&!p?Oyt(n,h,t,e):tve(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Tyt(e,t,n,r,i,a){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===ei.POINT){const l=r.get("range");return Kd(l)&&Jr(l.step)?{value:l.step-2}:{value:j8-2}}else return{scale:n,band:a}}else return{value:i[e].continuousBandSize}}const o=RO(i.view,t),s=Qr(i[e].discreteBandSize,o-2);return s!==void 0?{value:s}:void 0}function Oyt(e,t,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,l=a.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=Ol(n),h=Tl(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",g=Fn(p?"size":d,a,s,{vgChannel:d});let m;(o.size||g!==void 0)&&(p?m=ki("size",r,{vgChannel:d,defaultValue:g}):Me(vmt(a.type)));const v=(i=It(t)?ww({channel:n,fieldDef:t,markDef:a,stack:u,config:s}):void 0)!==null&&i!==void 0?i:1;m=m||{[d]:Tyt(e,d,c,f,s,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),b=eve(n,a,s,y?"middle":"top"),x=kw(n,a),w=p8({channel:n,channelDef:t,markDef:a,config:s,scaleName:c,scale:f,stack:u,offset:x,defaultRef:G8({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const S=qd(h),C=m[d],_=x?Object.assign(Object.assign({},C),{offset:x}):C;return{[b]:w,[S]:vt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function Tw(e,t,n,r,i){if(Wpe(e))return 0;const a=e==="x"||e==="y2"?-t/2:t/2;if(Et(n)){const o=Sw(i);return{signal:`${n.signal} ? ${r-a}${o?"-"+o:""} : ${r+a}${o?"+"+o:""}`}}else{if(Et(i)){const o=r+(n?-a:a);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}}function Iyt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:l}){const c=Tl(n),f=qd(n),d=qd(c),h=kw(n,a);if(Qn(e.bin)||e.timeUnit)return{[d]:nve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:(1-r)/2,offset:Tw(c,o,u,s,h),config:l}),[f]:nve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:1-(1-r)/2,offset:Tw(n,o,u,s,h),config:l})};if(Wa(e.bin)){const p=ng(e,i,{},{offset:Tw(c,o,u,s,h)});if(We(t))return{[d]:p,[f]:ng(t,i,{},{offset:Tw(n,o,u,s,h)})};if(vw(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Ue(e,{expr:"datum"})} + ${e.bin.step})`,offset:Tw(n,o,u,s,h)}}}Me(pge(c))}function nve({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:a,config:o}){const s=xO({scaleName:n,fieldOrDatumDef:t,band:i,offset:a});return Fge({fieldDef:t,channel:e,markDef:r,ref:s,config:o})}const Nyt=new Set(["aria"]);function Es(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Qme(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Dyt(e.markDef,t)),rve(e,"fill",n)),rve(e,"stroke",r)),ki("opacity",e)),ki("fillOpacity",e)),ki("strokeOpacity",e)),ki("strokeWidth",e)),ki("strokeDash",e)),Yme(e)),H8(e,"href")),xyt(e))}function rve(e,t,n){const{config:r,mark:i,markDef:a}=e;if(Fn("invalid",a,r)==="hide"&&n&&!Yp(i)){const s=Ryt(e,{invalid:!0,channels:pO});if(s)return{[t]:[{test:s,value:null},...Br(n)]}}return n?{[t]:n}:{}}function Dyt(e,t){return tvt.reduce((n,r)=>(!Nyt.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=zr(e[r])),n),{})}function Ryt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&Ss(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>g8(o,t)).join(` ${a} `)}}function K8(e){const{config:t,markDef:n}=e;if(Fn("invalid",n,t)){const i=Fyt(e,{channels:_s});if(i)return{defined:{signal:i}}}return{}}function Fyt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&Ss(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>g8(o,t)).join(` ${a} `)}}function ive(e,t){if(t!==void 0)return{[e]:zr(t)}}const X8="voronoi",ave={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(X8)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,a=e.mark;if(Yp(a))return Me(Wgt(a)),n;const o={name:e.getName(X8),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Yme(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(X8)>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class qn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qa extends qn{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Jpt()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class Pl extends qn{constructor(t,n){super(t);this.formula=n}clone(){return new Pl(null,Yt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{const{field:s,timeUnit:u}=a,l=Nr(n)?n.encoding[Tl(o)]:void 0,c=Nr(n)&&b8(o,a,l,n.stack,n.markDef,n.config);if(u){const f=Ue(a,{forAs:!0});i[yn({as:f,field:s,timeUnit:u})]=Object.assign({as:f,field:s,timeUnit:u},c?{band:!0}:{})}return i},{});return Yn(r)?null:new Pl(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,a=dt(r,["timeUnit"]),o=Va(i),s=Object.assign(Object.assign({},a),{timeUnit:o});return new Pl(t,{[yn(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(Ld(this.formula).map(t=>t.as))}dependentFields(){return new Set(Ld(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${yn(this.formula)}`}assemble(){const t=[];for(const n of Ld(this.formula)){const{field:r,as:i,timeUnit:a}=n,o=Va(a),{unit:s,utc:u}=o,l=dt(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Bd(r),type:"timeunit"},s?{units:a8(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const Ow="_tuple_fields";class Myt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Pyt={has:()=>!0,parse:(e,t,n)=>{var r,i,a;const o=t.name,s=(r=t.project)!==null&&r!==void 0?r:t.project=new Myt,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let g=fr(`${o}_${p}`);for(let m=1;c.has(g);m++)g=fr(`${o}_${p}_${m}`);return c.add(g),{[h]:g}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of Br(n.init))for(const p of Be(h))Igt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Me('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),s.items.push(h),s.hasField[d]=h}for(const d of(a=n.encodings)!==null&&a!==void 0?a:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){Me(Ugt(d,h.aggregate));continue}else if(!p){Me(rge(d));continue}if(h.timeUnit){p=e.vgField(d);const g={timeUnit:h.timeUnit,as:p,field:h.field};l[yn(g)]=g}if(!u[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(d).get("type");Ss(v)&&(g="R")}else h.bin&&(g="R-RE");const m={field:p,channel:d,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),s.items.push(u[p]=m),s.hasField[p]=s.hasChannel[d]=u[p]}}else Me(rge(d))}if(n.init){const d=h=>s.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=Br(n.init);t.init=h.map(d)}}Yn(l)||(s.timeUnit=new Pl(null,l))},signals:(e,t,n)=>{const r=t.name+Ow;return n.filter(a=>a.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(a=>{const o=dt(a,["signals","hasLegend"]);return o.field=Bd(o.field),o})})}},ove={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!P8(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],s=ave.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=fr(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:b0(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${gn(u.field)}] : null`}]:[],bind:(f=(c=a[u.field])!==null&&c!==void 0?c:a[u.channel])!==null&&f!==void 0?f:a}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.filter(l=>l.name===r+$l)[0],o=r+Ow,s=i.items.map(l=>fr(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}},jO="_toggle",sve={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+jO,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+$l,r=t.name+jO;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Gc(e)}}, `)+`${r} ? ${n} : null`}},$yt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=Xt(n.clear)?Md(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(ove.has(t))for(const r of t.project.items){const i=n.findIndex(a=>a.name===fr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,a){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const i of t.project.items){const a=n.findIndex(o=>o.name===i.signals.visual);if(r(a,"[0, 0]"),a===-1){const o=n.findIndex(s=>s.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(a=>a.name===t.name+$l);r(i,"null"),sve.has(t)&&(i=n.findIndex(a=>a.name===t.name+jO),r(i,"false"))}return n}},th={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Gd(i))continue;const a=e.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!Ss(o)){Me(qgt);continue}const s={selection:t.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(s=>s.name===o.signals.data).length===0);if(!e.parent||Z8(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let a=i.update;if(a.indexOf(yve)>=0)i.update=`{${r.map(o=>`${gn(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const s=`${gn(o.field)}: ${o.signals.data}`;a.indexOf(s)<0&&(a=`${a.substring(0,a.length-1)}, ${s}}`)}i.update=a}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Z8(e))for(const r of t.scales){const i=n.filter(a=>a.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function Y8(e,t){return`domain(${gn(e.scaleName(t))})`}function Z8(e){var t;return e.parent&&T0(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:Z8(e.parent.parent))}const uve={has:e=>{const t=e.resolve==="global"&&e.bind&&P8(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==y0;return t&&!n&&Me(Hgt),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=Br((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(s)<0&&u.filter.push(s)}const a=$8(t.bind)?t.bind.legend:"click",o=Xt(a)?Md(a,"view"):Br(a);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=$8(t.bind)&&t.bind.legend,a=o=>s=>{const u=Yt(s);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${fr(o.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(a(`${s}_symbols`)).concat(i.merge.map(a(`${s}_labels`))).concat(i.merge.map(a(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.find(d=>d.name===r+$l),o=r+Ow,s=i.items.filter(d=>d.hasLegend).map(d=>fr(`${r}_${fr(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?a.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(a.update=l,delete a.value,delete a.on);const c=n.find(d=>d.name===r+jO),f=$8(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function Lyt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;fg(e,a=>{var o,s;const u=(o=a.project.hasField[i])!==null&&o!==void 0?o:a.project.hasChannel[t];if(u&&uve.has(a)){const l=(s=n.get("selections"))!==null&&s!==void 0?s:[];l.push(a.name),n.set("selections",l,!1),u.hasLegend=!0}})}const lve="_translate_anchor",cve="_translate_delta",Byt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=th.has(t),a=r+lve,{x:o,y:s}=t.project.hasChannel;let u=Md(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Iw,l))),n.push({name:a,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?Y8(e,br):`slice(${o.signals.visual})`):"")+(s!==void 0?", extent_y: "+(i?Y8(e,di):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+cve,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),o!==void 0&&fve(e,t,o,"width",n),s!==void 0&&fve(e,t,s,"height",n),n}};function fve(e,t,n,r,i){var a;const o=t.name,s=o+lve,u=o+cve,l=n.channel,c=th.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),g=c&&l===br?"-":"",m=`${s}.extent_${l}`,v=`${g}${u}.${l} / `+(c?`${d}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(a=h.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";f.on.push({events:{signal:u},update:c?b:`clampRange(${b}, 0, ${d})`})}const dve="_zoom_anchor",hve="_zoom_delta",zyt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=th.has(t),a=r+hve,{x:o,y:s}=t.project.hasChannel,u=gn(e.scaleName(br)),l=gn(e.scaleName(di));let c=Md(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Iw,f))),n.push({name:r+dve,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&pve(e,t,o,"width",n),s!==void 0&&pve(e,t,s,"height",n),n}};function pve(e,t,n,r,i){var a;const o=t.name,s=n.channel,u=th.has(t),l=i.filter(y=>y.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?Y8(e,s):l.name,p=o+hve,g=`${o}${dve}.${s}`,v=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${g}, ${p}`+(u&&d==="pow"?`, ${(a=f.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";l.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${c})`})}const jyt=[Pyt,sve,th,uve,Byt,zyt,ove,ave,$yt];function UO(e,t){for(const n of jyt)n.has(e)&&t(n)}function b0(e,t=!0,n=Mpt){if(vt(e)){const r=e.map(i=>b0(i,t,n));return t?`[${r.join(", ")}]`:r}else if(p0(e))return n(t?yw(e):qmt(e));return t?n(JSON.stringify(e)):e}function Uyt(e,t){return fg(e,(n,r)=>{const i=n.name;let a=r.modifyExpr(e,n);t.push(...r.signals(e,n)),UO(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(a=o.modifyExpr(e,n,a))}),t.push({name:i+Jyt,on:[{events:{signal:n.name+$l},update:`modify(${gn(n.name+cg)}, ${a})`}]})}),J8(t)}function Wyt(e,t){if(e.component.selection&&Be(e.component.selection).length){const n=gn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Md("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return J8(t)}function Vyt(e,t){let n=!1;return fg(e,(r,i)=>{const a=r.name,o=gn(a+cg);if(t.filter(u=>u.name===a).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${yve}(${o}, ${gn(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),UO(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),J8(t)}function qyt(e,t){const n=[...t];return fg(e,r=>{const i={name:r.name+cg};if(r.init){const o=r.project.items.map(u=>dt(u,["signals"])),s=r.init.map(u=>b0(u,!1));i.values=r.type==="interval"?[{unit:Gc(e,{escape:!1}),fields:o,values:s}]:s.map(u=>({unit:Gc(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+cg).length||n.push(i)}),n}function gve(e,t){return fg(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,UO(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function Hyt(e,t){for(const n of e.children)Nr(n)&&(t=gve(n,t));return t}function Gyt(e,t){const n=t.selection,r=e.getSelectionComponent(n,fr(n));return{signal:Mve(r,t)}}function J8(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Iw="_brush",Q8="_scale_trigger",Kyt={signals:(e,t)=>{const n=t.name,r=n+Ow,i=th.has(t),a=[],o=[],s=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${gn(n+Iw)}`;mve(t,(f,d)=>{var h;const p=Br((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==br&&d!==di){Me("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=Xyt(e,t,c,h),g=c.signals.data,m=c.signals.visual,v=gn(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),b=Ss(y)?"+":"";a.push(...p),o.push(g),s.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||a.push({name:n+Q8,value:{},on:[{events:s.map(c=>({scale:c.scaleName})),update:s.map(c=>c.expr).join(" && ")+` ? ${n+Q8} : {}`}]});const u=t.init,l=`unit: ${Gc(e)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+$l},u?{init:`{${l}: ${b0(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"true":`{unit: ${Gc(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:a}=t.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${gn(t.name+cg)})`;if(th.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:a!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Be(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Gc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=dt(c,["fill","fillOpacity","cursor"]),g=Be(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,a!==void 0&&`${s}[0] !== ${s}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+Iw+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+Iw,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function Xyt(e,t,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=th.has(t),u=gn(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===br?"width":"height").signal,h=`${i}(unit)`,p=mve(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${a}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+Q8},update:Ss(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:b0(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:b0(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}function mve(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Me(`${r} is not an ordered event stream for interval selections.`),n),[])}function vve(e,t){const n=t.name,r=n+Ow,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${a}[${gn(e.vgField(l.channel,{}))}], ${a}[${gn(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${a}[${gn(l.field)}]`}).join(", "),s=`unit: ${Gc(e)}, fields: ${r}, values`,u=t.events;return[{name:n+$l,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const Yyt={signals:vve,modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"null":`{unit: ${Gc(e)}}`)},Zyt={signals:vve,modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"true":`{unit: ${Gc(e)}}`)},cg="_store",$l="_tuple",Jyt="_modify",yve="vlSelectionResolve",Qyt={single:Zyt,multi:Yyt,interval:Kyt};function fg(e,t){const n=e.component.selection;if(n){for(const r of Ld(n))if(t(r,Qyt[r.type])===!0)break}}function ebt(e){let t=e.parent;for(;t&&!Eu(t);)t=t.parent;return t}function Gc(e,{escape:t}={escape:!0}){let n=t?gn(e.name):e.name;const r=ebt(e);if(r){const{facet:i}=r;for(const a of ws)i[a]&&(n+=` + '__facet_${a}_' + (facet[${gn(r.vgField(a))}])`)}return n}function e9(e){let t=!1;return fg(e,n=>{t=t||n.project.items.some(r=>r.field===y0)}),t}const tbt="RawCode",nbt="Literal",rbt="Property",ibt="Identifier",abt="ArrayExpression",obt="BinaryExpression",sbt="CallExpression",ubt="ConditionalExpression",lbt="LogicalExpression",cbt="MemberExpression",fbt="ObjectExpression",dbt="UnaryExpression";function wu(e){this.type=e}wu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=hbt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function hbt(e){switch(e.type){case abt:return e.elements;case obt:case lbt:return[e.left,e.right];case sbt:return[e.callee].concat(e.arguments);case ubt:return[e.test,e.consequent,e.alternate];case cbt:return[e.object,e.property];case fbt:return e.properties;case rbt:return[e.key,e.value];case dbt:return[e.argument];case ibt:case nbt:case tbt:default:return[]}}var Ll,ot,_e,la,jn,WO=1,Nw=2,dg=3,nh=4,VO=5,hg=6,xo=7,Dw=8,pbt=9;Ll={},Ll[WO]="Boolean",Ll[Nw]="<end>",Ll[dg]="Identifier",Ll[nh]="Keyword",Ll[VO]="Null",Ll[hg]="Numeric",Ll[xo]="Punctuator",Ll[Dw]="String",Ll[pbt]="RegularExpression";var gbt="ArrayExpression",mbt="BinaryExpression",vbt="CallExpression",ybt="ConditionalExpression",bve="Identifier",bbt="Literal",xbt="LogicalExpression",wbt="MemberExpression",_bt="ObjectExpression",Sbt="Property",Ebt="UnaryExpression",Wi="Unexpected token %0",Cbt="Unexpected number",Abt="Unexpected string",kbt="Unexpected identifier",Tbt="Unexpected reserved word",Obt="Unexpected end of input",t9="Invalid regular expression",n9="Invalid regular expression: missing /",xve="Octal literals are not allowed in strict mode.",Ibt="Duplicate data property in object literal not allowed in strict mode",ca="ILLEGAL",Rw="Disabled.",Nbt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Dbt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function qO(e,t){if(!e)throw new Error("ASSERT: "+t)}function Kc(e){return e>=48&&e<=57}function r9(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Fw(e){return"01234567".indexOf(e)>=0}function Rbt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Mw(e){return e===10||e===13||e===8232||e===8233}function Pw(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Nbt.test(String.fromCharCode(e))}function HO(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Dbt.test(String.fromCharCode(e))}var Fbt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function wve(){for(var e;_e<la&&(e=ot.charCodeAt(_e),Rbt(e)||Mw(e));)++_e}function i9(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)_e<la&&r9(ot[_e])?(r=ot[_e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Nn({},Wi,ca);return String.fromCharCode(i)}function Mbt(){var e,t,n,r;for(e=ot[_e],t=0,e==="}"&&Nn({},Wi,ca);_e<la&&(e=ot[_e++],!!r9(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Nn({},Wi,ca),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function _ve(){var e,t;for(e=ot.charCodeAt(_e++),t=String.fromCharCode(e),e===92&&(ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=i9("u"),(!e||e==="\\"||!Pw(e.charCodeAt(0)))&&Nn({},Wi,ca),t=e);_e<la&&(e=ot.charCodeAt(_e),!!HO(e));)++_e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=i9("u"),(!e||e==="\\"||!HO(e.charCodeAt(0)))&&Nn({},Wi,ca),t+=e);return t}function Pbt(){var e,t;for(e=_e++;_e<la;){if(t=ot.charCodeAt(_e),t===92)return _e=e,_ve();if(HO(t))++_e;else break}return ot.slice(e,_e)}function $bt(){var e,t,n;return e=_e,t=ot.charCodeAt(_e)===92?_ve():Pbt(),t.length===1?n=dg:Fbt.hasOwnProperty(t)?n=nh:t==="null"?n=VO:t==="true"||t==="false"?n=WO:n=dg,{type:n,value:t,start:e,end:_e}}function a9(){var e=_e,t=ot.charCodeAt(_e),n,r=ot[_e],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,{type:xo,value:String.fromCharCode(t),start:e,end:_e};default:if(n=ot.charCodeAt(_e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:xo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:_e};case 33:case 61:return _e+=2,ot.charCodeAt(_e)===61&&++_e,{type:xo,value:ot.slice(e,_e),start:e,end:_e}}}if(o=ot.substr(_e,4),o===">>>=")return _e+=4,{type:xo,value:o,start:e,end:_e};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return _e+=3,{type:xo,value:a,start:e,end:_e};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return _e+=2,{type:xo,value:i,start:e,end:_e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++_e,{type:xo,value:r,start:e,end:_e};Nn({},Wi,ca)}function Lbt(e){for(var t="";_e<la&&r9(ot[_e]);)t+=ot[_e++];return t.length===0&&Nn({},Wi,ca),Pw(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:hg,value:parseInt("0x"+t,16),start:e,end:_e}}function Bbt(e){for(var t="0"+ot[_e++];_e<la&&Fw(ot[_e]);)t+=ot[_e++];return(Pw(ot.charCodeAt(_e))||Kc(ot.charCodeAt(_e)))&&Nn({},Wi,ca),{type:hg,value:parseInt(t,8),octal:!0,start:e,end:_e}}function Sve(){var e,t,n;if(n=ot[_e],qO(Kc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="",n!=="."){if(e=ot[_e++],n=ot[_e],e==="0"){if(n==="x"||n==="X")return++_e,Lbt(t);if(Fw(n))return Bbt(t);n&&Kc(n.charCodeAt(0))&&Nn({},Wi,ca)}for(;Kc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="."){for(e+=ot[_e++];Kc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="e"||n==="E")if(e+=ot[_e++],n=ot[_e],(n==="+"||n==="-")&&(e+=ot[_e++]),Kc(ot.charCodeAt(_e)))for(;Kc(ot.charCodeAt(_e));)e+=ot[_e++];else Nn({},Wi,ca);return Pw(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:hg,value:parseFloat(e),start:t,end:_e}}function zbt(){var e="",t,n,r,i,a=!1;for(t=ot[_e],qO(t==="'"||t==='"',"String literal must starts with a quote"),n=_e,++_e;_e<la;)if(r=ot[_e++],r===t){t="";break}else if(r==="\\")if(r=ot[_e++],!r||!Mw(r.charCodeAt(0)))switch(r){case"u":case"x":ot[_e]==="{"?(++_e,e+=Mbt()):e+=i9(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Fw(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),_e<la&&Fw(ot[_e])&&(a=!0,i=i*8+"01234567".indexOf(ot[_e++]),"0123".indexOf(r)>=0&&_e<la&&Fw(ot[_e])&&(i=i*8+"01234567".indexOf(ot[_e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ot[_e]===`
`&&++_e;else{if(Mw(r.charCodeAt(0)))break;e+=r}return t!==""&&Nn({},Wi,ca),{type:Dw,value:e,octal:a,start:n,end:_e}}function jbt(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";Nn({},t9)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Nn({},t9)}try{return new RegExp(e,t)}catch(r){return null}}function Ubt(){var e,t,n,r,i;for(e=ot[_e],qO(e==="/","Regular expression literal must start with a slash"),t=ot[_e++],n=!1,r=!1;_e<la;)if(e=ot[_e++],t+=e,e==="\\")e=ot[_e++],Mw(e.charCodeAt(0))&&Nn({},n9),t+=e;else if(Mw(e.charCodeAt(0)))Nn({},n9);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Nn({},n9),i=t.substr(1,t.length-2),{value:i,literal:t}}function Wbt(){var e,t,n;for(t="",n="";_e<la&&(e=ot[_e],!!HO(e.charCodeAt(0)));)++_e,e==="\\"&&_e<la?Nn({},Wi,ca):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Nn({},t9,n),{value:n,literal:t}}function Vbt(){var e,t,n,r;return jn=null,wve(),e=_e,t=Ubt(),n=Wbt(),r=jbt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_e}}function qbt(e){return e.type===dg||e.type===nh||e.type===WO||e.type===VO}function Eve(){var e;return wve(),_e>=la?{type:Nw,start:_e,end:_e}:(e=ot.charCodeAt(_e),Pw(e)?$bt():e===40||e===41||e===59?a9():e===39||e===34?zbt():e===46?Kc(ot.charCodeAt(_e+1))?Sve():a9():Kc(e)?Sve():a9())}function wo(){var e;return e=jn,_e=e.end,jn=Eve(),_e=e.end,e}function Cve(){var e;e=_e,jn=Eve(),_e=e}function Hbt(e){var t=new wu(gbt);return t.elements=e,t}function Ave(e,t,n){var r=new wu(e==="||"||e==="&&"?xbt:mbt);return r.operator=e,r.left=t,r.right=n,r}function Gbt(e,t){var n=new wu(vbt);return n.callee=e,n.arguments=t,n}function Kbt(e,t,n){var r=new wu(ybt);return r.test=e,r.consequent=t,r.alternate=n,r}function o9(e){var t=new wu(bve);return t.name=e,t}function $w(e){var t=new wu(bbt);return t.value=e.value,t.raw=ot.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function kve(e,t,n){var r=new wu(wbt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Xbt(e){var t=new wu(_bt);return t.properties=e,t}function Tve(e,t,n){var r=new wu(Sbt);return r.key=t,r.value=n,r.kind=e,r}function Ybt(e,t){var n=new wu(Ebt);return n.operator=e,n.argument=t,n.prefix=!0,n}function Nn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(a,o){return qO(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=_e,n.description=i,n}function GO(e){e.type===Nw&&Nn(e,Obt),e.type===hg&&Nn(e,Cbt),e.type===Dw&&Nn(e,Abt),e.type===dg&&Nn(e,kbt),e.type===nh&&Nn(e,Tbt),Nn(e,Wi,e.value)}function fa(e){var t=wo();(t.type!==xo||t.value!==e)&&GO(t)}function ar(e){return jn.type===xo&&jn.value===e}function s9(e){return jn.type===nh&&jn.value===e}function Zbt(){var e=[];for(_e=jn.start,fa("[");!ar("]");)ar(",")?(wo(),e.push(null)):(e.push(pg()),ar("]")||fa(","));return wo(),Hbt(e)}function Ove(){var e;return _e=jn.start,e=wo(),e.type===Dw||e.type===hg?(e.octal&&Nn(e,xve),$w(e)):o9(e.value)}function Jbt(){var e,t,n,r;if(_e=jn.start,e=jn,e.type===dg)return n=Ove(),fa(":"),r=pg(),Tve("init",n,r);if(e.type===Nw||e.type===xo)GO(e);else return t=Ove(),fa(":"),r=pg(),Tve("init",t,r)}function Qbt(){var e=[],t,n,r,i={},a=String;for(_e=jn.start,fa("{");!ar("}");)t=Jbt(),t.key.type===bve?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Nn({},Ibt):i[r]=!0,e.push(t),ar("}")||fa(",");return fa("}"),Xbt(e)}function e1t(){var e;return fa("("),e=u9(),fa(")"),e}var t1t={if:1};function n1t(){var e,t,n;if(ar("("))return e1t();if(ar("["))return Zbt();if(ar("{"))return Qbt();if(e=jn.type,_e=jn.start,e===dg||t1t[jn.value])n=o9(wo().value);else if(e===Dw||e===hg)jn.octal&&Nn(jn,xve),n=$w(wo());else{if(e===nh)throw new Error(Rw);e===WO?(t=wo(),t.value=t.value==="true",n=$w(t)):e===VO?(t=wo(),t.value=null,n=$w(t)):ar("/")||ar("/=")?(n=$w(Vbt()),Cve()):GO(wo())}return n}function r1t(){var e=[];if(fa("("),!ar(")"))for(;_e<la&&(e.push(pg()),!ar(")"));)fa(",");return fa(")"),e}function i1t(){var e;return _e=jn.start,e=wo(),qbt(e)||GO(e),o9(e.value)}function a1t(){return fa("."),i1t()}function o1t(){var e;return fa("["),e=u9(),fa("]"),e}function s1t(){var e,t,n;for(e=n1t();;)if(ar("."))n=a1t(),e=kve(".",e,n);else if(ar("("))t=r1t(),e=Gbt(e,t);else if(ar("["))n=o1t(),e=kve("[",e,n);else break;return e}function Ive(){var e=s1t();if(jn.type===xo&&(ar("++")||ar("--")))throw new Error(Rw);return e}function KO(){var e,t;if(jn.type!==xo&&jn.type!==nh)t=Ive();else{if(ar("++")||ar("--"))throw new Error(Rw);if(ar("+")||ar("-")||ar("~")||ar("!"))e=wo(),t=KO(),t=Ybt(e.value,t);else{if(s9("delete")||s9("void")||s9("typeof"))throw new Error(Rw);t=Ive()}}return t}function Nve(e){var t=0;if(e.type!==xo&&e.type!==nh)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function u1t(){var e,t,n,r,i,a,o,s,u,l;if(e=jn,u=KO(),r=jn,i=Nve(r),i===0)return u;for(r.prec=i,wo(),t=[e,jn],o=KO(),a=[u,r,o];(i=Nve(jn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=Ave(s,u,o),a.push(n);r=wo(),r.prec=i,a.push(r),t.push(jn),n=KO(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=Ave(a[l-1].value,a[l-2],n),l-=2;return n}function pg(){var e,t,n;return e=u1t(),ar("?")&&(wo(),t=pg(),fa(":"),n=pg(),e=Kbt(e,t,n)),e}function u9(){var e=pg();if(ar(","))throw new Error(Rw);return e}function l1t(e){ot=e,_e=0,la=ot.length,jn=null,Cve();var t=u9();if(jn.type!==Nw)throw new Error("Unexpect token after expression.");return t}function x0(e,t,n){return e.fields=t||[],e.fname=n,e}function c1t(e){return e.length===1?f1t(e[0]):d1t(e)}const f1t=e=>function(t){return t[e]},d1t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function l9(e){throw Error(e)}function h1t(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||l9("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&l9("Access path missing closing bracket: "+e),r&&l9("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function p1t(e,t,n){const r=h1t(e);return e=r.length===1?r[0]:e,x0((n&&n.get||c1t)(r),[e],t||e)}p1t("id"),x0(e=>e,[],"identity"),x0(()=>0,[],"zero"),x0(()=>1,[],"one"),x0(()=>!0,[],"true"),x0(()=>!1,[],"false");function c9(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...c9(e.object)),t.push(...c9(e.property))),t)}function Dve(e){return e.object.type==="MemberExpression"?Dve(e.object):e.object.name==="datum"}function Rve(e){const t=l1t(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&Dve(r)&&n.add(c9(r).slice(1).join("."))}),n}class w0 extends qn{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=XO(this.model,this.filter,this),this._dependentFields=Rve(this.expr)}clone(){return new w0(null,this.model,Yt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function g1t(e,t){var n;const r={},i=e.config.selection;for(const a of Be(t??{})){const o=Yt(t[a]),s=i[o.type],u=dt(s,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=fr(a),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:Xt(o.on)?Md(o.on,"scope"):Yt(o.on)});UO(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[a])})}return r}function Fve(e,t,n,r="datum"){const i=[];function a(s){const u=fr(s),l=e.getSelectionComponent(u,s),c=gn(u+cg);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${gn(l.resolve)})`)}const o=dw(t,a);return(i.length?"!("+i.map(s=>`length(data(${s}))`).join(" || ")+") || ":"")+`(${o})`}function Mve(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Me(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${gn(r)}.`);else if(n&&!r){const i=e.project.items.filter(a=>a.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Me((i.length?"Multiple ":"No ")+`matching ${gn(n)} encoding found for selection ${gn(t.selection)}. Using "field": ${gn(r)}.`)):r=i[0].field}return`${e.name}[${gn(r)}]`}function m1t(e,t){fg(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new qa(new w0(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function XO(e,t,n){return dw(t,r=>Xt(r)?r:rvt(r)?Fve(e,r.selection,n):Age(r))}function v1t(e,t){if(!!e)return vt(e)&&!Jd(e)?e.map(n=>tme(n,t)).join(", "):e}function f9(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function Lw(e,t,n,r={header:!1}){var i,a;const o=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=dt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const p in h){const g=tgt[p],m=h[p];if(g&&g!==t&&g!=="both")delete h[p];else if(Vj(m)){const{condition:v}=m,y=dt(m,["condition"]),b=Br(v),x=Ipe[p];if(x){const{vgProp:w,part:S}=x,C=[...b.map(_=>{const{test:E}=_,A=dt(_,["test"]);return Object.assign({test:XO(null,E)},A)}),y];f9(h,S,w,C),delete h[p]}else if(x===null){const w={signal:b.map(S=>{const{test:C}=S,_=dt(S,["test"]);return`${XO(null,C)} ? ${ame(_)} : `}).join("")+ame(y)};h[p]=w}}else if(Et(m)){const v=Ipe[p];if(v){const{vgProp:y,part:b}=v;f9(h,b,y,m),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Yn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Qr(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&Et(h.encode.labels.update.text)&&(g=f0(c,"datum.label",h.encode.labels.update.text.signal)),f9(h,"labels","text",{signal:g})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const g of Npe)e.hasAxisPart(g)||delete h.encode[g];Yn(h.encode)&&delete h.encode}const p=v1t(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:Qr(d,0)})}}}function Pve(e){const{axes:t}=e.component,n=[];for(const r of _s)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const a=r==="x"?"height":"width",o=e.getSizeSignalRef(a).signal;a!==o&&n.push({name:a,update:o})}}return n}function y1t(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>Lw(i,"grid",t)),...r.map(i=>Lw(i,"grid",t)),...n.map(i=>Lw(i,"main",t)),...r.map(i=>Lw(i,"main",t))].filter(i=>i)}const $ve={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Lve={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},b1t=Be($ve),x1t=Be(Lve);function Bve(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const a=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Be(o),...Be(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${a}" ? ${Sw(o[c])} : ${Sw(s[c])}`};return l}return t[i]})])}function w1t(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:gvt(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",o=Et(n)?"axisOrient":"axis"+eO(n),s=[...i,...i.map(l=>a+l.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:Bve(s,r,e,n),vgAxisConfig:Bve(u,r,e,n),axisConfigStyle:_1t([...u,...s],r)}}function _1t(e,t){var n;const r=[{}];for(const i of e){let a=(n=t[i])===null||n===void 0?void 0:n.style;if(a){a=Br(a);for(const o of a)r.push(t.style[o])}}return Object.assign.apply(null,r)}function d9(e,t,n,r={}){var i;const a=sme(e,n,t.style);if(a!==void 0)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const zve={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return Lge(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Bge(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return We(e)&&Wa(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:S1t(n,e)},gridScale:({model:e,channel:t})=>E1t(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||Uve(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||jve(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:A1t(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:k1t(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!==null&&a!==void 0?a:O1t({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=Wve(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),a=n==="x"?"x2":"y2",o=t.fieldDef(a);return lme(i?[Hge(i)]:[],We(o)?[Hge(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>I1t(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:N1t(n,t)}};function S1t(e,t){return!bo(e)&&We(t)&&!Qn(t==null?void 0:t.bin)}function E1t(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function C1t(e,t,n,r,i){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Et(a)?a:tO(a);{const{configValue:o}=d9("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?tO(o):n===br&&bt([d8,f8],r.type)?270:void 0}}function h9(e){return`(((${e.signal} % 360) + 360) % 360)`}function jve(e,t,n,r){if(e!==void 0)if(n==="x"){if(Et(e)){const i=h9(e),a=Et(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Et(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Et(e)){const i=h9(e),a=Et(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Et(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function Uve(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,a=r?"bottom":"left";if(Et(e)){const o=h9(e),s=Et(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(Et(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${a}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===a)?"left":"right"}function A1t(e,t){if(t==="x"&&bt(["quantitative","temporal"],e))return!0}function k1t(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function T1t(e){return e==="x"?"bottom":"left"}function O1t({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!bo(t)&&t!=="log"){if(We(e)){if(Qn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],(i=Va(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function Wve(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;if(a&&o)return cme(a,o);if(a)return a;if(o)return o;if(a!==void 0)return a;if(o!==void 0)return o}function I1t(e,t){const n=e.values;if(vt(n))return rme(t,n);if(Et(n))return n}function N1t(e,t){return e==="rect"&&Yge(t)?1:0}class _0 extends qn{constructor(t,n){super(t);this.transform=n,this._dependentFields=Rve(this.transform.calculate)}clone(){return new _0(null,Yt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!S8(r)&&qge(r.sort)){const{field:a,timeUnit:o}=r,s=r.sort,u=s.map((l,c)=>`${Age({field:a,timeUnit:o,equal:l})} ? ${c} : `).join("")+s.length;t=new _0(t,{calculate:u,as:S0(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${yn(this.transform)}`}}function S0(e,t,n){return Ue(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function YO(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||e==="row"?"row":"column"}function E0(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Qr(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function ZO(e,t,n,r){const i={};for(const a of e){const o=E0(a,t,n,r);o!==void 0&&(i[a]=o)}return i}const p9=["row","column"],g9=["header","footer"];function D1t(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=ZO(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=YO(t,s),l=tO(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),qve(l,u)),Vve(u,l,a)),Hve(r,i,t,b1t,$ve))}}function Vve(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=Uve(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function qve(e,t){const n=jve(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function R1t(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of g9)if(n[i])for(const a of n[i]){const o=M1t(e,t,i,n,a);o!=null&&r.push(o)}return r}function F1t(e,t){var n;const{sort:r}=e;return Dl(r)?{field:Ue(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:vt(r)?{field:S0(e,t,{expr:"datum"}),order:"ascending"}:{field:Ue(e,{expr:"datum"}),order:r??"ascending"}}function m9(e,t,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=ZO(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=m8({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=YO(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?f0(f0(u,"datum.label",l),"datum.value",Ue(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),qve(a,c)),Vve(c,a,o)),Hve(n,e,t,x1t,Lve))}function M1t(e,t,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=ZO(["labelOrient"],o,s,t);(t==="row"&&!bt(["top","bottom"],f)||t==="column"&&!bt(["left","right"],f))&&(a=m9(o,t,s))}const u=Eu(e)&&!xw(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(a||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:F1t(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const P1t={column:{start:0,end:1},row:{start:1,end:0}};function $1t(e,t){return P1t[t][e]}function L1t(e,t){const n={};for(const r of ws){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:a,titleOrient:o}=ZO(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),s=YO(r,o),u=$1t(a,s);u!==void 0&&(n[s]=u)}}return Yn(n)?void 0:n}function Hve(e,t,n,r,i){const a={};for(const o of r){if(!i[o])continue;const s=E0(o,t,e,n);s!==void 0&&(a[i[o]]=s)}return a}function v9(e){return[...JO(e,"width"),...JO(e,"height"),...JO(e,"childWidth"),...JO(e,"childHeight")]}function JO(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const a=e.getScaleComponent(n);if(a){const o=a.get("type"),s=a.get("range");if(bo(o)&&Kd(s)){const u=e.scaleName(n);return Eu(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Gve(u,s)]:[Gve(u,s),{name:i,update:Kve(u,a,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const a=i.endsWith("width"),o=a?"containerSize()[0]":"containerSize()[1]",s=z8(e.config.view,a?"width":"height"),u=`isFinite(${o}) ? ${o} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Gve(e,t){return{name:e+"_step",value:t.step}}function Kve(e,t,n){const r=t.get("type"),i=t.get("padding"),a=Qr(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${e}_step`}function Xve(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function Yve(e,t){return Be(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Aw(t,i,r,a=>Et(a)?a:{value:a.value}))},{})}function B1t(e,t){if(T0(t)||Eu(t))return"shared";if(I9(t))return Il(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function y9(e,t){const n=e.scale[t],r=Il(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Me(_mt(t)),"independent"):e[r][t]||"shared"}const z1t=Object.assign(Object.assign({},g0t),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Zve=Be(z1t);class j1t extends Hc{}const Jve={symbols:U1t,gradient:W1t,labels:V1t,entries:q1t};function U1t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,l,c;if(a!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},Kvt({},n,ugt)),Qme(n,{filled:g}));const v=(o=Qve(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(r==="fill"||g&&r===vo)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=zr((s=h.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black"),m.fillOpacity=zr(v??1));else if(vt(m.fill)){const y=(c=(l=b9((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=zr(y))}}if(m.stroke){if(r==="stroke"||!g&&r===vo)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(vt(m.stroke)){const y=Qr(b9(d.stroke||d.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==Wc){const y=We(t)&&t0e(n,i,t);y?m.opacity=[Object.assign({test:y},zr(v??1)),zr(h.legend.unselectedOpacity)]:v&&(m.opacity=zr(v))}return m=Object.assign(Object.assign({},m),e),Yn(m)?void 0:m}function W1t(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=Qve(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=zr(i)),r=Object.assign(Object.assign({},r),e),Yn(r)?void 0:r}function V1t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=We(t)?t0e(n,i,t):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=a,f=rg(c)?v8({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Yn(d)?void 0:d}function q1t(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function Qve(e){return e0e(e,(t,n)=>Math.max(t,n.value))}function b9(e){return e0e(e,(t,n)=>Qr(t,n.value))}function e0e(e,t){if(Lvt(e))return Br(e.condition).reduce(t,e.value);if(Vc(e))return e.value}function t0e(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=gn(n.field);return r.map(a=>`(!length(data(${gn(fr(a)+cg)})) || (${a}[${i}] && indexof(${a}[${i}], datum.value) >= 0))`).join(" || ")}const n0e={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return Lge(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Bge(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:J1t(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:Q1t(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:G1t(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>ig(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(d0(n)&&xu(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>H1t(t,e)};function H1t(e,t){const n=e.values;if(vt(n))return rme(t,n);if(Et(n))return n}function G1t(e,t,n,r){var i;if(t!=="shape"){const a=(i=b9(n))!==null&&i!==void 0?i:r;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function K1t(e){const{legend:t}=e;return Qr(t.type,X1t(e))}function X1t({channel:e,timeUnit:t,scaleType:n}){if(d0(e)){if(bt(["quarter","month","day"],t))return"symbol";if(xu(n))return"gradient"}return"symbol"}function Y1t({legendConfig:e,legendType:t,orient:n,legend:r}){var i,a;return(a=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&a!==void 0?a:Z1t(n,t)}function Z1t(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function J1t({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(xu(i))return n==="horizontal"?r==="top"||r==="bottom"?r0e(t,"width",o,a):o:r0e(t,"height",u,s)}function r0e(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Q1t(e){if(bt(["quantile","threshold","log"],e))return"greedy"}function i0e(e){const t=Nr(e)?ext(e):ixt(e);return e.component.legends=t,t}function ext(e){const{encoding:t}=e,n={};for(const r of[vo,...Ame]){const i=hi(t[r]);!i||!e.getScaleComponent(r)||r===yo&&We(i)&&i.type===v0||(n[r]=rxt(e,r))}return n}function txt(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function nxt(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function rxt(e,t){var n,r,i;let a=e.legend(t);const{markDef:o,encoding:s,config:u}=e,l=u.legend,c=new j1t({},txt(e,t));Lyt(e,t,c);const f=a!==void 0?!a:l.disable;if(c.set("disable",f,a!==void 0),f)return c;a=a||{};const d=e.getScaleComponent(t).get("type"),h=hi(s[t]),p=We(h)?(n=Va(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",m=K1t({legend:a,channel:t,timeUnit:p,scaleType:d}),v=Y1t({legend:a,legendType:m,orient:g,legendConfig:l}),y={legend:a,channel:t,model:e,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const C of Zve){const _=C in n0e?n0e[C](y):a[C];if(_!==void 0){const E=nxt(_,C,a,e.fieldDef(t));(E||u.legend[C]===void 0)&&c.set(C,_,E)}}const b=(r=a==null?void 0:a.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},S={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const C of["labels","legend","title","symbols","gradient","entries"]){const _=Yve((i=b[C])!==null&&i!==void 0?i:{},e),E=C in Jve?Jve[C](_,S):_;E!==void 0&&!Yn(E)&&(w[C]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&We(h)?{name:`${fr(h.field)}_legend_${C}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:E}))}return Yn(w)||c.set("encode",w,!!(a==null?void 0:a.encoding)),c}function ixt(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){i0e(r);for(const i of Be(r.component.legends))n.legend[i]=y9(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=a0e(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Be(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function a0e(e,t){var n,r,i,a;if(!e)return t.clone();const o=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const l of Zve){const c=Qd(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return axt(f,d);case"title":return fme(f,d);case"type":return u=!0,Ko("symbol")}return MO(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&Uj(e.implicit,["encode","gradient"]),((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient)&&Uj(e.explicit,["encode","gradient"])),e}function axt(e,t){return t.value==="circle"?t:e}function o0e(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function s0e(e){const t=e.component.legends,n={};for(const i of Be(t)){const a=e.getScaleComponent(i),o=cr(a.get("domains"));if(n[o])for(const s of n[o])a0e(s,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return Ld(n).flat().map(i=>oxt(i,e.config)).filter(i=>i!==void 0)}function oxt(e,t){var n,r,i;const a=e.combine(),{disable:o,labelExpr:s,selections:u}=a,l=dt(a,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of Ame)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&Et(l.encode.labels.update.text)&&(c=f0(s,"datum.label",l.encode.labels.update.text.signal)),o0e(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(Et(f)){const d=h0t[c];if(d){const{vgProp:h,part:p}=d;o0e(l,p,h,f),delete l[c]}}}return l}}function sxt(e){return T0(e)||I9(e)?uxt(e):u0e(e)}function uxt(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),u0e(e))}function u0e(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},a=t.data.reduce((o,s)=>{const u=Et(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return bt(o,u)||o.push(u),o},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const lxt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class l0e extends Hc{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function c0e(e){e.component.projection=Nr(e)?cxt(e):hxt(e)}function cxt(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,a=r?fxt(e):void 0;return new l0e(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,a)}}function fxt(e){const t=[],{encoding:n}=e;for(const r of[[Cl,El],[xs,bu]])(hi(n[r[0]])||hi(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(yo)&&e.typedFieldDef(yo).type===v0&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(sa)),t}function dxt(e,t){const n=Spe(lxt,i=>!!(!Kp(e.explicit,i)&&!Kp(t.explicit,i)||Kp(e.explicit,i)&&Kp(t.explicit,i)&&cr(e.get(i))===cr(t.get(i))));if(cr(e.size)===cr(t.size)){if(n)return e;if(cr(e.explicit)===cr({}))return t;if(cr(t.explicit)===cr({}))return e}return null}function hxt(e){if(e.children.length===0)return;let t;for(const r of e.children)c0e(r);const n=Spe(e.children,r=>{const i=r.component.projection;if(i)if(t){const a=dxt(t,i);return a&&(t=a),!!a}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new l0e(r,t.specifiedProjection,t.size,Yt(t.data));for(const a of e.children){const o=a.component.projection;o&&(o.isFit&&i.data.push(...a.component.projection.data),a.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function pxt(e,t,n,r){var i,a;if(_w(t,n)){const o=Nr(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{},s=Ue(t,{expr:"datum"}),u=Ue(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ue(t,{binSuffix:"range",forAs:!0}),formula:wO(s,u,o.format,o.formatType,r)}}return{}}function f0e(e,t){return`${Jpe(e)}_${t}`}function gxt(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function x9(e,t,n){var r;const i=(r=kO(n,void 0))!==null&&r!==void 0?r:{},a=f0e(i,t);return e.getName(`${a}_bins`)}function mxt(e){return"as"in e}function d0e(e,t,n){let r,i;mxt(e)?r=Xt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ue(e,{forAs:!0}),Ue(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},kO(t,void 0)),o=f0e(a,e.field),{signal:s,extentSignal:u}=gxt(n,o);if(mO(a.extent)){const c=a.extent,f=c.selection;i=Mve(n.getSelectionComponent(fr(f),f),c),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class Bl extends qn{constructor(t,n){super(t);this.bins=n}clone(){return new Bl(null,Yt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{if(Go(a)&&Qn(a.bin)){const{key:s,binComponent:u}=d0e(a,a.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),pxt(n,a,o,n.config))}return i},{});return Yn(r)?null:new Bl(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:a}=d0e(n,n.bin,r);return new Bl(t,{[i]:a})}merge(t,n){for(const r of Be(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=$d([...this.bins[r].as,...t.bins[r].as],yn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Ld(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Ld(this.bins).map(t=>t.field))}hash(){return`Bin ${yn(this.bins)}`}assemble(){return Ld(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,a=t.bin,{extent:o}=a,s=dt(a,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Bd(t.field),as:r,signal:t.signal},mO(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:Bd(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ue({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class C0 extends qn{constructor(t){super(null);t=t??{name:"source"};let n;if(lg(t)||(n=t.format?Object.assign({},Pc(t.format,["parse"])):{}),PO(t))this._data={values:t.values};else if(Cw(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Kme(t)?this._data={values:[{type:"Sphere"}]}:(Hme(t)||lg(t))&&(this._data={});this._generator=lg(t),t.name&&(this._name=t.name),n&&!Yn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function w9(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!w9(t.children))return!1}return!0}class Bw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new Bw(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${yn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class zw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new zw(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${yn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function QO(e){return e instanceof C0||e instanceof Bw||e instanceof zw}class h0e{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Xc extends h0e{constructor(){super();this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(QO(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class _9 extends h0e{}function vxt(e,t,n,r){const i=Nr(r)?r.encoding[Tl(t)]:void 0;if(Go(n)&&Nr(r)&&b8(t,n,i,r.stack,r.markDef,r.config))e.add(Ue(n,{})),e.add(Ue(n,{suffix:"end"})),n.bin&&_w(n,t)&&e.add(Ue(n,{binSuffix:"range"}));else if(Agt(t)){const a=Cgt(t);e.add(r.getName(a))}else e.add(Ue(n));return e}function yxt(e,t){var n;for(const r of Be(t)){const i=t[r];for(const a of Be(i))r in e?e[r][a]=new Set([...(n=e[r][a])!==null&&n!==void 0?n:[],...i[a]]):e[r]={[a]:i[a]}}}class _u extends qn{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new _u(null,new Set(this.dimensions),Yt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},a=new Set;return!r||(n.forEachFieldDef((o,s)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Ue(o,{forAs:!0})]);else{if(zd(d)||Zp(d)){const p=zd(d)?"argmin":"argmax",g=d[p];i[g]=(l=i[g])!==null&&l!==void 0?l:{},i[g][p]=new Set([Ue({op:p,field:g},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Ue(o,{forAs:!0})]);Gd(s)&&n.scaleDomain(s)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Ue({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Ue({field:h,aggregate:"max"},{forAs:!0})]))}else vxt(a,s,o,n)}),a.size+Be(i).length===0)?null:new _u(t,a,i)}static makeFromTransform(t,n){var r,i,a;const o=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(s["*"]=(r=s["*"])!==null&&r!==void 0?r:{},s["*"].count=new Set([f||Ue(u,{forAs:!0})])):(s[c]=(i=s[c])!==null&&i!==void 0?i:{},s[c][l]=new Set([f||Ue(u,{forAs:!0})])))}for(const u of(a=n.groupby)!==null&&a!==void 0?a:[])o.add(u);return o.size+Be(s).length===0?null:new _u(t,o,s)}merge(t){return Kpt(this.dimensions,t.dimensions)?(yxt(this.measures,t.measures),!0):(Lmt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Be(this.measures)])}producedFields(){const t=new Set;for(const n of Be(this.measures))for(const r of Be(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${yn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const a of Be(this.measures))for(const o of Be(this.measures[a]))for(const s of this.measures[a][o])r.push(s),t.push(o),n.push(a==="*"?null:Bd(a));return{type:"aggregate",groupby:[...this.dimensions].map(Bd),ops:t,fields:n,as:r}}}class A0 extends qn{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const a of ws){const o=n.facet[a];if(o){const{bin:s,sort:u}=o;this[a]=Object.assign({name:n.getName(`${a}_domain`),fields:[Ue(o),...Qn(s)?[Ue(o,{binSuffix:"end"})]:[]]},Dl(u)?{sortField:u}:vt(u)?{sortIndexField:S0(o,a)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of ws)this[n]&&(t+=` ${n.charAt(0)}:${yn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of ws)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of ws)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of _s){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),a=r.get("range");if(bo(i)&&Kd(a)){const o=tI(this.childModel,n),s=T9(o);s?t[n]=s:Me(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],a=[],o=[],s=[];r&&r[i]&&(n?(a.push(`distinct_${r[i]}`),o.push("max")):(a.push(r[i]),o.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=_O,field:f}=u;a.push(f),o.push(c),s.push(Ue(u,{forAs:!0}))}else l&&(a.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},a.length?{fields:a,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:a}=this.model.component,o=[],s={};for(const c of p9){for(const f of g9){const d=(n=a[c]&&a[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const a=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:u}=this;if(o&&s&&(a.x||a.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=a.x)!==null&&t!==void 0?t:[],(n=a.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Bc,Lc])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,a));if(u){const l=this.assembleFacetHeaderData(a);l&&r.push(...l)}return r}}function p0e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function bxt(e,t){const n=Tpe(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=p0e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=p0e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Me(Ygt(t)),null}function xxt(e){const t={};return ZT(e.filter,n=>{var r;if(Cge(n)){let i=null;s8(n)?i=n.equal:u8(n)?i=n.range[0]:l8(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(p0(i)?t[n.field]="date":Jr(i)?t[n.field]="number":Xt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function wxt(e){const t={};function n(r){TO(r)?t[r.field]="date":r.type==="quantitative"&&xgt(r.aggregate)?t[r.field]="number":hw(r.field)>1?r.field in t||(t[r.field]="flatten"):S8(r)&&Dl(r.sort)&&hw(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Nr(e)||Eu(e))&&e.forEachFieldDef((r,i)=>{if(Go(r))n(r);else{const a=eg(i),o=e.fieldDef(a);n(Object.assign(Object.assign({},r),{type:o.type}))}}),Nr(e)){const{mark:r,markDef:i,encoding:a}=e;if(Yp(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",s=a[o];We(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function _xt(e){const t={};if(Nr(e)&&e.component.selection)for(const n of Be(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&hw(i.field)>1&&(t[i.field]="flatten")}return t}class da extends qn{constructor(t,n){super(t);this._parse=n}clone(){return new da(null,Yt(this._parse))}hash(){return`Parse ${yn(this._parse)}`}static makeExplicit(t,n,r){let i={};const a=n.data;return!lg(a)&&a&&a.format&&a.format.parse&&(i=a.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const s of Be(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:Me(oge(s,r[s],u.value)))}for(const s of Be(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:Me(oge(s,n[s],u)))}const a=new Hc(n,r);i.copyAll(a);const o={};for(const s of Be(a.combine())){const u=a.get(s);u!==null&&(o[s]=u)}return Be(o).length===0||i.parseNothing?null:new da(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Be(this._parse)){const r=this._parse[n];hw(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Be(this._parse))}dependentFields(){return new Set(Be(this._parse))}assembleTransforms(t=!1){return Be(this._parse).filter(n=>t?hw(n)>1:!0).map(n=>{const r=bxt(n,this._parse[n]);return r?{type:"formula",expr:r,as:Ope(n)}:null}).filter(n=>n!==null)}}class rh extends qn{clone(){return new rh(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([y0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:y0}}}class gg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new gg(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=$d(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`JoinAggregateTransform ${yn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const a of this.transform.joinaggregate)n.push(a.op),r.push(this.getDefaultName(a)),t.push(a.field===void 0?null:a.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function Sxt(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Ue(r);return i&&t.push(i),t},[])}function Ext(e){return vt(e)&&e.every(t=>Xt(t))&&e.length>1}class Yc extends qn{constructor(t,n){super(t);this._stack=n}clone(){return new Yc(null,Yt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:a,offset:o="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(Qr(f.order,"ascending"));const l={field:s,order:u};let c;return Ext(a)?c=a:Xt(a)?c=[a,a+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Yc(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:a,fieldChannel:o,offset:s,impute:u}=r;let l;if(a){const h=i[a];l=Fl(h)}const c=Sxt(n),f=n.encoding.order;let d;return vt(f)||We(f)?d=ume(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Yc(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${yn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ue(t,{binSuffix:"mid"})]:[Ue(t,{}),Ue(t,{binSuffix:"end"})]:[Ue(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:a,sort:o,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ue(r,{expr:"datum"})+`+${1-c}*`+Ue(r,{expr:"datum",binSuffix:"end"}),as:Ue(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...a,...n],key:Ue(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:s}),t}}class k0 extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new k0(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=$d(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`WindowTransform ${yn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],a=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),a.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>Kj(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}class Cxt extends Xc{run(t){const n=t.parent;if(t instanceof da){if(QO(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof da)this.setMutated(),n.merge(t);else{if(Ape(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class Axt extends _9{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Be(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class kxt extends Xc{run(t){return t instanceof qa||t.numChildren()>0||t instanceof A0?this.flags:(this.setMutated(),t.remove(),this.flags)}}class Txt extends Xc{constructor(){super(...arguments);this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof Pl){const n=t.producedFields();Epe(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class Oxt extends Xc{run(t){this.setContinue();const r=t.parent.children.filter(a=>a instanceof Pl),i=r.pop();for(const a of r)this.setMutated(),i.merge(a);return this.flags}}function Ixt(e){function t(n){if(!(n instanceof A0)){const r=n.clone();if(r instanceof qa){const i=E9+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof _u||r instanceof Yc||r instanceof k0||r instanceof gg)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function S9(e){if(e instanceof A0)if(e.numChildren()===1&&!(e.children[0]instanceof qa)){const t=e.children[0];(t instanceof _u||t instanceof Yc||t instanceof k0||t instanceof gg)&&t.addDimensions(e.fields),t.swapWithParent(),S9(e)}else{const t=e.model.component.data.main;g0e(t);const n=Ixt(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(S9)}function g0e(e){if(e instanceof qa&&e.type===sa&&e.numChildren()===1){const t=e.children[0];t instanceof A0||(t.swapWithParent(),g0e(e))}}class Nxt extends _9{constructor(){super()}run(t){t instanceof qa&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class Dxt extends _9{constructor(t){super();this.requiresSelectionId=t&&e9(t)}run(t){t instanceof rh&&(this.requiresSelectionId&&(QO(t.parent)||t.parent instanceof _u||t.parent instanceof da)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class Rxt extends Xc{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(a=>a instanceof da);if(n.numChildren()>1&&i.length>=1){const a={},o=new Set;for(const s of i){const u=s.parse;for(const l of Be(u))l in a?a[l]!==u[l]&&o.add(l):a[l]=u[l]}for(const s of o)delete a[s];if(!Yn(a)){this.setMutated();const s=new da(n,a);for(const u of r){if(u instanceof da)for(const l of Be(a))delete u.parse[l];n.removeChild(u),u.parent=s,u instanceof da&&Be(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class Fxt extends Xc{run(t){const n=t.parent,r=n.children.filter(a=>a instanceof _u),i={};for(const a of r){const o=yn(a.groupBy);o in i||(i[o]=[]),i[o].push(a)}for(const a of Be(i)){const o=i[a];if(o.length>1){const s=o.pop();for(const u of o)s.merge(u)&&(n.removeChild(u),u.parent=s,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class Mxt extends Xc{constructor(t){super();this.model=t}run(t){const n=t.parent,r=!(QO(n)||n instanceof w0||n instanceof da||n instanceof rh),i=[],a=[];for(const o of n.children)o instanceof Bl&&(r&&!Ape(n.producedFields(),o.dependentFields())?i.push(o):a.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Bl?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(a.length>1){const o=a.pop();for(const s of a)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class Pxt extends Xc{run(t){const n=t.parent,r=[...n.children];if(!fw(r,s=>s instanceof qa)||n.numChildren()<=1)return this.setContinue(),this.flags;const a=[];let o;for(const s of r)if(s instanceof qa){let u=s;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof qa)u=l;else break}a.push(...u.children),o?(n.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else a.push(s);if(a.length){this.setMutated();for(const s of a)s.parent.removeChild(s),s.parent=o}return this.setContinue(),this.flags}}const E9="scale_",eI=5;function ih(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function $xt(e){return e}function Su(e,t){return t.map(r=>{if(e instanceof Xc){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some($xt)}function m0e(e,t){let n=e.sources;const r=new Set;return r.add(Su(new Nxt,n)),r.add(Su(new Dxt(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(Su(new kxt,ih(n))),n=n.filter(i=>i.numChildren()>0),r.add(Su(new Cxt,ih(n))),r.add(Su(new Mxt(t),ih(n))),r.add(Su(new Txt,ih(n))),r.add(Su(new Rxt,ih(n))),r.add(Su(new Fxt,ih(n))),r.add(Su(new Oxt,ih(n))),r.add(Su(new Axt,n)),r.add(Su(new Pxt,ih(n))),e.sources=n,r.has(!0)}function Lxt(e,t){w9(e.sources);let n=0,r=0;for(let i=0;i<eI&&m0e(e,t);i++)n++;e.sources.map(S9);for(let i=0;i<eI&&m0e(e,t);i++)r++;w9(e.sources),Math.max(n,r)===eI&&Me(`Maximum optimization runs(${eI}) reached.`)}class Xo{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Xo(()=>t(n))}}function v0e(e){Nr(e)?Bxt(e):zxt(e)}function Bxt(e){const t=e.component.scales;for(const n of Be(t)){const r=Uxt(e,n);if(t[n].setWithExplicit("domains",r),Vxt(e,n),e.component.data.isFaceted){let a=e;for(;!Eu(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const s of r.value)Xd(s)&&(s.data=E9+s.data.replace(E9,""))}}}function zxt(e){for(const n of e.children)v0e(n);const t=e.component.scales;for(const n of Be(t)){let r,i=null;for(const a of e.children){const o=a.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=Qd(r,o.getWithExplicit("domains"),"domains","scale",k9);const s=o.get("selectionExtent");i&&s&&i.selection!==s.selection&&Me("The same selection must be used to override scale domains in a layered view."),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function jxt(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:a}=y0e(t,n);if(!i){Me(a);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=y0e(t,n);if(i)return"unaggregated"}return e}function Uxt(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=jxt(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&hi(r.x2)?hi(r.x)?Qd(ah(n,i,e,"x"),ah(n,i,e,"x2"),"domain","scale",k9):ah(n,i,e,"x2"):t==="y"&&hi(r.y2)?hi(r.y)?Qd(ah(n,i,e,"y"),ah(n,i,e,"y2"),"domain","scale",k9):ah(n,i,e,"y2"):ah(n,i,e,t)}function Wxt(e,t,n){return e.map(r=>({signal:`{data: ${k8(r,{timeUnit:n,type:t})}}`}))}function C9(e,t,n){var r;const i=(r=Va(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?Wxt(e,t,i):[e]}function ah(e,t,n,r){const{encoding:i}=n,a=hi(i[r]),{type:o}=a,s=a.timeUnit;if(Evt(t)){const f=ah(e,void 0,n,r),d=C9(t.unionWith,o,s);return ug([...f.value,...d])}else{if(Et(t))return ug([t]);if(t&&t!=="unaggregated"&&!Oge(t))return ug(C9(t,o,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Ko([[0,1]]);const f=n.requestDataName(sa);return Ko([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Gd(r)&&We(a)?qxt(n,r,e):void 0;if(Zd(a)){const f=C9([a.datum],o,s);return Ko(f)}const c=a;if(t==="unaggregated"){const f=n.requestDataName(sa),{field:d}=a;return Ko([{data:f,field:Ue({field:d,aggregate:"min"})},{data:f,field:Ue({field:d,aggregate:"max"})}])}else if(Qn(c.bin)){if(bo(e))return Ko(e==="bin-ordinal"?[]:[{data:QT(l)?n.requestDataName(sa):n.requestDataName($O),field:n.vgField(r,_w(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!Ai(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Qn(f)){const d=x9(n,c.field,f);return Ko([new Xo(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Ko([{data:n.requestDataName(sa),field:n.vgField(r,{})}])}}else if(c.timeUnit&&bt(["time","utc"],e)&&b8(r,c,Nr(n)?n.encoding[Tl(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(sa);return Ko([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Ko(l?[{data:QT(l)?n.requestDataName(sa):n.requestDataName($O),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(sa),field:n.vgField(r)}])}function A9(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":_O)},r?{field:Bd(r)}:{}),i?{order:i}:{})}function Vxt(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=Oge(i)&&i,s=vw(a)&&mO(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",o??s,!0)}function qxt(e,t,n){if(!bo(n))return;const r=e.fieldDef(t),i=r.sort;if(qge(i))return{op:"min",field:S0(r,t),order:"ascending"};const{stack:a}=e,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Dl(i)){const s=a&&!bt(o,i.field);return A9(i,s)}else if(Vge(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=a&&!bt(o,f);if(zd(c)||Zp(c))return A9({field:Ue(l),order:u},d);if(Kj(c)||!c)return A9({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],i))return!0}}function y0e(e,t){const{aggregate:n,type:r}=e;return n?Xt(n)&&!Sgt[n]?{valid:!1,reason:gmt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:mmt(e)}:{valid:!0}:{valid:!1,reason:pmt(e)}}function k9(e,t,n,r){return e.explicit&&t.explicit&&Me(wmt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Hxt(e){const t=$d(e.map(o=>Xd(o)?dt(o,["sort"]):o),yn),n=$d(e.map(o=>{if(Xd(o)){const s=o.sort;return s!==void 0&&!QT(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(o=>o!==void 0),yn);if(t.length===0)return;if(t.length===1){const o=e[0];if(Xd(o)&&n.length>0){let s=n[0];if(n.length>1)Me(dge),s=!0;else if(Ai(s)&&"field"in s){const u=s.field;o.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},o),{sort:s})}return o}const r=$d(n.map(o=>QT(o)||!("op"in o)||o.op in ygt?o:(Me(Smt(o)),!0)),yn);let i;r.length===1?i=r[0]:r.length>1&&(Me(dge),i=!0);const a=$d(e.map(o=>Xd(o)?o.data:null),o=>o);return a.length===1&&a[0]!==null?Object.assign({data:a[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function T9(e){if(Xd(e)&&Xt(e.field))return e.field;if(Jmt(e)){let t;for(const n of e.fields)if(Xd(n)&&Xt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Me(Emt),t}return Me(Cmt),t}else if(Qmt(e)){Me(Amt);const t=e.fields[0];return Xt(t)?t:void 0}}function tI(e,t){const r=e.component.scales[t].get("domains").map(i=>(Xd(i)&&(i.data=e.lookupDataSource(i.data)),i));return Hxt(r)}function b0e(e){return T0(e)||I9(e)?e.children.reduce((t,n)=>t.concat(b0e(n)),x0e(e)):x0e(e)}function x0e(e){return Be(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=dt(i,["name","type","selectionExtent","domains","range","reverse"]),d=Gxt(i.range,a,n);let h;s&&(h=Gyt(e,s));const p=tI(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Gxt(e,t,n){return Il(n)&&Kd(e)?{step:{signal:t+"_step"}}:e}class w0e extends Hc{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:fw(this.get("domains"),t=>vt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Kxt=["range","scheme"];function _0e(e){return e==="x"?"width":e==="y"?"height":void 0}function Xxt(e){const t=e.component.scales;for(const n of pO){const r=t[n];if(!r)continue;const i=Yxt(n,e);r.setWithExplicit("range",i)}}function S0e(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Qn(n.bin)){const r=x9(e,n.field,n.bin),i=_0e(t),a=e.getName(i);return new Xo(()=>{const o=e.getSignalName(r),s=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(a)} / (${s})`})}}function Yxt(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e).get("type");for(const o of Kxt)if(n[o]!==void 0){const s=Ige(a,o),u=Nge(e,o);if(!s)Me(cge(a,o,e));else if(u)Me(u);else switch(o){case"range":return vt(n.range)&&Il(e)?ug(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return Xo.fromName(f,c)}return l})):ug(n.range);case"scheme":return ug(Zxt(n[o]))}}if(e===br||e===di){const o=e===br?"width":"height",s=r[o];if(Ml(s)){if(bo(a))return ug({step:s.step});Me(fge(o))}}return Ko(Jxt(e,t))}function Zxt(e){return Svt(e)?Object.assign({scheme:e.name},Pc(e,["name"])):{scheme:e}}function Jxt(e,t){const{size:n,config:r,mark:i,encoding:a}=t,o=t.getSignalName.bind(t),{type:s}=hi(a[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case br:case di:{if(bt(["point","band"],l)){if(e===br&&!n.width){const p=Ew(r.view,"width");if(Ml(p))return p}else if(e===di&&!n.height){const p=Ew(r.view,"height");if(Ml(p))return p}}const d=_0e(e),h=t.getName(d);return e===di&&Ss(l)?[Xo.fromName(o,h),0]:[0,Xo.fromName(o,h)]}case Uc:{const d=t.component.scales[e].get("zero"),h=E0e(i,d,r),p=twt(i,n,t,r);return bO(l)?ewt(h,p,Qxt(l,r,c,e)):[h,p]}case yu:return[0,Math.PI*2];case Jp:return[0,360];case Sl:return[0,new Xo(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case Wd:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Vd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case yo:return"symbol";case vo:case Al:case kl:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Wc:case jd:case Ud:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function Qxt(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&vt(n)?n.length+1:(Me(Mmt(r)),3)}}function ewt(e,t,n){const r=()=>{const i=Sw(t),a=Sw(e),o=`(${i} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${i} + ${o}, ${o})`};return Et(t)?new Xo(r):{signal:r()}}function E0e(e,t,n){if(t)return Et(t)?{signal:`${t.signal} ? 0 : ${E0e(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(vO("size",e))}const C0e=.95;function twt(e,t,n,r){const i={x:S0e(n,"x"),y:S0e(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const a=A0e(t,i,r.view);return Jr(a)?a-1:new Xo(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const a=A0e(t,i,r.view);return Jr(a)?Math.pow(C0e*a,2):new Xo(()=>`pow(${C0e} * ${a.signal}, 2)`)}}throw new Error(vO("size",e))}function A0e(e,t,n){const r=Ml(e.width)?e.width.step:RO(n,"width"),i=Ml(e.height)?e.height.step:RO(n,"height");return t.x||t.y?new Xo(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function k0e(e,t){Nr(e)?nwt(e,t):I0e(e,t)}function nwt(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=e;for(const s of Be(n)){const u=o[s],l=n[s],c=e.getScaleComponent(s),f=hi(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=Ige(h,t),v=Nge(s,t);if(d!==void 0&&(m?v&&Me(v):Me(cge(h,t,s))),m&&v===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const y=t in T0e?T0e[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:a,config:r}):r.scale[t];y!==void 0&&l.set(t,y,!1)}}}const T0e={bins:({model:e,fieldOrDatumDef:t})=>We(t)?rwt(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>iwt(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>awt(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>owt(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>swt(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>uwt(e,t,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=We(e)?e.sort:void 0;return lwt(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>cwt(e,t,n,r,i)};function O0e(e){Nr(e)?Xxt(e):I0e(e,"range")}function I0e(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?O0e(r):k0e(r,t);for(const r of Be(n)){let i;for(const a of e.children){const o=a.component.scales[r];if(o){const s=o.getWithExplicit(t);i=Qd(i,s,t,"scale",qme((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function rwt(e,t){const n=t.bin;if(Qn(n)){const r=x9(e,t.field,n);return new Xo(()=>e.getSignalName(r))}else if(Wa(n)&&vw(n)&&n.step!==void 0)return{step:n.step}}function iwt(e,t){if(bt([vo,Al,kl],e)&&t!=="nominal")return"hcl"}function awt(e,t,n){var r;if(!(((r=Fl(n))===null||r===void 0?void 0:r.bin)||bt([ei.TIME,ei.UTC],e)))return t in Hd?!0:void 0}function owt(e,t,n,r,i,a){if(e in Hd){if(xu(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:s}=i;if(o==="bar"&&!(We(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===ei.POINT)return n.pointPadding}}function swt(e,t,n,r){if(e===void 0&&t in Hd){const{bandPaddingInner:i,barBandPaddingInner:a,rectBandPaddingInner:o}=r;return Qr(i,n==="bar"?a:o)}}function uwt(e,t,n,r,i,a){if(e===void 0&&t in Hd&&n===ei.BAND){const{bandPaddingOuter:o}=a;return Qr(o,Et(i)?{signal:`${i.signal}/2`}:i/2)}}function lwt(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Ss(e)&&t==="descending"?Et(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Ss(e)&&t==="descending")return!0}function cwt(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&Ss(i)){if(vt(n)){const o=n[0],s=n[n.length-1];if(o<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!bO(i))return!0;if(!(We(t)&&t.bin)&&bt([..._s,...Fgt],e)){const{orient:o,type:s}=r;return!(bt(["bar","area","line","trail"],s)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function fwt(e,t,n,r){const i=dwt(t,n,r),{type:a}=e;return Gd(t)?a!==void 0?Rge(t,a)?We(n)&&!Dge(a,n.type)?(Me(bmt(a,i)),i):a:(Me(ymt(t,a,i)),i):i:null}function dwt(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(d0(e)||gO(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Me(t8(e,"ordinal")),"ordinal";if(e in Hd){if(bt(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in Jj)return"band";return t.band!==void 0||E8(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return d0(e)?"time":gO(e)==="discrete"?(Me(t8(e,"temporal")),"ordinal"):We(t)&&t.timeUnit&&Va(t.timeUnit).utc?"utc":"time";case"quantitative":return d0(e)?We(t)&&Qn(t.bin)?"bin-ordinal":"linear":gO(e)==="discrete"?(Me(t8(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(uge(t.type))}function hwt(e,{ignoreRange:t}={}){N0e(e),v0e(e);for(const n of kvt)k0e(e,n);t||O0e(e)}function N0e(e){Nr(e)?e.component.scales=pwt(e):e.component.scales=mwt(e)}function pwt(e){const{encoding:t,mark:n}=e;return pO.reduce((r,i)=>{const a=hi(t[i]);if(a&&n===Ppe&&i===yo&&a.type===v0)return r;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o=o??{};const s=fwt(o,i,a,n);r[i]=new w0e(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}const gwt=qme((e,t)=>kge(e)-kge(t));function mwt(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const a of e.children){N0e(a);for(const o of Be(a.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:B1t(o,e),i.scale[o]==="shared"){const s=r[o],u=a.component.scales[o].getWithExplicit("type");s?cvt(s.value,u.value)?r[o]=Qd(s,u,"type","scale",gwt):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const a of Be(r)){const o=e.scaleName(a,!0),s=r[a];n[a]=new w0e(o,s);for(const u of e.children){const l=u.component.scales[a];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class O9{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Nr(e){return(e==null?void 0:e.type)==="unit"}function Eu(e){return(e==null?void 0:e.type)==="facet"}function I9(e){return(e==null?void 0:e.type)==="concat"}function T0(e){return(e==null?void 0:e.type)==="layer"}class N9{constructor(t,n,r,i,a,o,s){var u,l;this.type=n,this.parent=r,this.config=a,this.view=s,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=a,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=Jd(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new O9,this.projectionNameMap=r?r.projectionNameMap:new O9,this.signalNameMap=r?r.signalNameMap:new O9,this.data=t.data,this.description=t.description,this.transforms=byt((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:x0t(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:SO(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Hc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Yt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){hwt(this)}parseProjection(){c0e(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){i0e(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=dt(t,["style"]),r={};for(const i of Be(n)){const a=n[i];a!==void 0&&(r[i]=zr(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=zr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Yn(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=dt(t,["spacing"]),{component:i,config:a}=this,o=L1t(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of ws)t[r].title&&n.push(D1t(this,r));for(const r of p9)n=n.concat(R1t(this,r));return n}assembleAxes(){return y1t(this.component.axes,this.config)}assembleLegends(){return s0e(this)}assembleProjections(){return sxt(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:a}=i,o=dt(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},ime(this.config.title).nonMark),o),a?{encode:{update:a}}:{});if(s.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],s.anchor)&&(s.frame=(n=s.frame)!==null&&n!==void 0?n:"group"):s.anchor=(r=s.anchor)!==null&&r!==void 0?r:"start",Yn(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Eu(this.parent)?b0e(this):[];i.length>0&&(n.scales=i);const a=this.assembleAxes();a.length>0&&(n.axes=a);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return fr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Eu(this.parent)){const n=Xve(t),r=hO(n),i=this.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(bo(a)&&Kd(o)){const s=i.get("name"),u=tI(this,r),l=T9(u);if(l){const c=Ue({aggregate:"distinct",field:l},{expr:"datum"});return{signal:Kve(s,i,c)}}else return Me(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Gpe(t)&&Gd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Vgt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class D0e extends N9{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Ue(r,n)}reduceFieldDef(t,n){return dme(this.getMapping(),(r,i,a)=>{const o=Fl(i);return o?t(r,o,a):r},n)}forEachFieldDef(t,n){I8(this.getMapping(),(r,i)=>{const a=Fl(r);a&&t(a,i)},n)}}class nI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(a=o[1])!==null&&a!==void 0?a:"density"]}clone(){return new nI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=dt(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class jw extends qn{constructor(t,n){super(t);this.filter=n}clone(){return new jw(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:a}=n;if(Fn("invalid",a,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Gd(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Ss(d)&&l.aggregate!=="count"&&!Yp(i)&&(u[l.field]=l)}return u},{});return Be(s).length?new jw(t,s):null}dependentFields(){return new Set(Be(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${yn(this.filter)}`}assemble(){const t=Be(this.filter).reduce((n,r)=>{const i=this.filter[r],a=Ue(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${a}) || (isValid(${a}) && isFinite(+${a})))`):i.type==="quantitative"&&(n.push(`isValid(${a})`),n.push(`isFinite(+${a})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class rI extends qn{constructor(t,n){super(t);this.transform=n,this.transform=Yt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((a,o)=>{var s;return(s=i[o])!==null&&s!==void 0?s:a})}clone(){return new rI(this.parent,Yt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${yn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class iI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new iI(null,Yt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${yn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class O0 extends qn{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new O0(null,Yt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Cl,El],[xs,bu]]){const a=i.map(o=>{const s=hi(n.encoding[o]);return We(s)?s.field:Zd(s)?{expr:`${s.datum}`}:Vc(s)?{expr:`${s.value}`}:void 0});(a[0]||a[1])&&(t=new O0(t,a,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(yo)){const i=n.typedFieldDef(yo);i.type===v0&&(t=new O0(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(Xt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${yn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class Uw extends qn{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new Uw(null,this.projection,Yt(this.fields),Yt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Cl,El],[xs,bu]]){const i=r.map(o=>{const s=hi(n.encoding[o]);return We(s)?s.field:Zd(s)?{expr:`${s.datum}`}:Vc(s)?{expr:`${s.value}`}:void 0}),a=r[0]===xs?"2":"";(i[0]||i[1])&&(t=new Uw(t,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}return t}dependentFields(){return new Set(this.fields.filter(Xt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${yn(this.fields)} ${yn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class mg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new mg(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new mg(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,a=r.y;if(We(i)&&We(a)){const o=i.impute?i:a.impute?a:void 0;if(o===void 0)return;const s=i.impute?a:a.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=hme(n.mark,r);return new mg(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${yn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:a,value:o,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:Q0t(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},a?{groupby:a}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class aI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.loess]}clone(){return new aI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=dt(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class Ww extends qn{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new Ww(null,Yt(this.transform),this.secondary)}static make(t,n,r,i){const a=n.component.data.sources,{from:o}=r;let s=null;if(tyt(o)){let u=P0e(o.data,a);u||(u=new C0(o.data),a.push(u));const l=n.getName(`lookup_${i}`);s=new qa(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(nyt(o)){const u=o.selection;if(r=Object.assign({as:u},r),s=n.getSelectionComponent(fr(u),u).materialized,!s)throw new Error(Ggt(u))}return new Ww(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Br(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${yn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Br(this.transform.as)}:{});else{let n=this.transform.as;Xt(n)||(Me(Jgt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class oI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new oI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=dt(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class sI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.regression]}clone(){return new sI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=dt(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class uI extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new uI(null,Yt(this.transform))}addDimensions(t){var n;this.transform.groupby=$d(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${yn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:a}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),a!==void 0?{op:a}:{}),r!==void 0?{groupby:r}:{})}}class lI extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new lI(null,Yt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${yn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function R0e(e){let t=0;function n(r,i){var a;if(r instanceof C0&&!r.isGenerator&&!Cw(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof da&&(r.parent instanceof C0&&!i.source?(i.format=Object.assign(Object.assign({},(a=i.format)!==null&&a!==void 0?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof A0){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof Bw||r instanceof zw||r instanceof jw||r instanceof w0||r instanceof _0||r instanceof Uw||r instanceof O0||r instanceof _u||r instanceof Ww||r instanceof k0||r instanceof gg||r instanceof iI||r instanceof rI||r instanceof nI||r instanceof aI||r instanceof oI||r instanceof sI||r instanceof rh||r instanceof lI||r instanceof uI)&&i.transform.push(r.assemble()),(r instanceof Bl||r instanceof Pl||r instanceof mg||r instanceof Yc)&&i.transform.push(...r.assemble()),r instanceof qa&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof qa?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof qa&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function vwt(e){const t=[],n=R0e(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function ywt(e,t){var n,r;const i=[],a=R0e(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();a(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function bwt(e){return e==="top"||e==="left"||Et(e)?"header":"footer"}function xwt(e){for(const t of ws)wwt(e,t);M0e(e,"x"),M0e(e,"y")}function wwt(e,t){var n;const{facet:r,config:i,child:a,component:o}=e;if(e.channelHasField(t)){const s=r[t],u=E0("title",null,i,t);let l=ig(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});a.component.layoutHeaders[t].title&&(l=vt(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const c=E0("labelOrient",s,i,t),f=(n=s.header)!==null&&n!==void 0?n:{},d=Qr(f.labels,i.header.labels,!0),h=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:s,[h]:t==="facet"?[]:[F0e(e,t,d)]}}}function F0e(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function M0e(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:a}=e.component;if(a.axis[t]=y9(a,t),a.axis[t]==="shared"){const o=t==="x"?"column":"row",s=i[o];for(const u of r.component.axes[t]){const l=bwt(u.get("orient"));s[l]=(n=s[l])!==null&&n!==void 0?n:[F0e(e,o,!1)];const c=Lw(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function _wt(e){D9(e),cI(e,"width"),cI(e,"height")}function Swt(e){D9(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";cI(e,t),cI(e,n)}function D9(e){for(const t of e.children)t.parseLayoutSize()}function cI(e,t){const n=Xve(t),r=hO(n),i=e.component.resolve,a=e.component.layoutSize;let o;for(const s of e.children){const u=s.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=Qd(o,u,n,"")}else o=u}if(o){for(const s of e.children)e.renameSignal(s.getName(n),e.getName(t)),s.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function Ewt(e){const{size:t,component:n}=e;for(const r of _s){const i=Ol(r);if(t[i]){const a=t[i];n.layoutSize.set(i,Ml(a)?"step":a,!0)}else{const a=Cwt(e,i);n.layoutSize.set(i,a,!1)}}}function Cwt(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const a=i.get("type"),o=i.get("range");if(bo(a)){const s=Ew(r.view,t);return Kd(o)||Ml(s)?"step":s}else return z8(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return z8(r.view,t);{const a=Ew(r.view,t);return Ml(a)?a.step:a}}}function R9(e,t,n){return Ue(t,Object.assign({suffix:`by_${Ue(e)}`},n??{}))}class Vw extends D0e{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=$9(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return xw(t)?dme(t,(r,i,a)=>bt([Lc,Bc],a)?i.field===void 0?(Me(e8(i,a)),r):(r[a]=A8(i,a,n),r):(Me(vO(a,"facet")),r),{}):{facet:A8(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=fI(this),this.child.parseData()}parseLayoutSize(){D9(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),xwt(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const a of ws)for(const o of g9){const s=this.component.layoutHeaders[a],u=s[o],{facetFieldDef:l}=s;if(l){const c=E0("titleOrient",l,this.config,a);if(bt(["right","bottom"],c)){const f=YO(a,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=a==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";a!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][a]=.5),s.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[a==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Vw))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof Vw?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ue(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Vw){if(this.child.channelHasField("column")){const i=Ue(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of _s){const a=this.child.component.scales[i];if(a&&!a.merged){const o=a.get("type"),s=a.get("range");if(bo(o)&&Kd(s)){const u=tI(this.child,i),l=T9(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):Me(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:a,ops:o,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of ws){const f=this.facet[c];if(f){u.push(Ue(f));const{bin:d,sort:h}=f;if(Qn(d)&&u.push(Ue(f,{binSuffix:"end"})),Dl(h)){const{field:p,op:g=_O}=h,m=R9(f,h);r&&i?(a.push(m),o.push("max"),s.push(m)):(a.push(p),o.push(g),s.push(m))}else if(vt(h)){const p=S0(f,c);a.push(p),o.push("max"),s.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||a.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),a.length?{fields:a,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Dl(r.sort)?[R9(r,r.sort,{expr:"datum"})]:vt(r.sort)?[S0(r,t,{expr:"datum"})]:[Ue(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Dl(i)?i.order:!vt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return m9(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of p9)if(t[i]){const a=E0("labelOrient",t[i],n,i);if(bt(r[i],a))return m9(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=vwt(n),i=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:ws.map(u=>this.facetSortFields(u)).flat(),order:ws.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Wyt(this,[])))]}getMapping(){return this.facet}}function Awt(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const a of[n,r])if(Dl(a.sort)){const{field:o,op:s=_O}=a.sort;e=i=new gg(e,{joinaggregate:[{op:s,field:o,as:R9(a,a.sort,{forAs:!0})}],groupby:[Ue(a)]})}return i}return null}function P0e(e,t){var n,r,i,a,o,s,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=h.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((a=h.format)===null||a===void 0?void 0:a.feature))&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((s=h.format)===null||s===void 0?void 0:s.feature))&&!((((u=e.format)===null||u===void 0?void 0:u.mesh)||((l=h.format)===null||l===void 0?void 0:l.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(PO(e)&&PO(h)){if(lw(e.values,h.values))return d}else if(Cw(e)&&Cw(h)){if(e.url===h.url)return d}else if(Hme(e)&&e.name===d.dataName)return d}}return null}function kwt(e,t){if(e.data||!e.parent){if(e.data===null){const r=new C0({values:[]});return t.push(r),r}const n=P0e(e.data,t);if(n)return lg(e.data)||(n.data.format=Hpt({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new C0(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Twt(e,t,n){var r,i;let a=0;for(const o of t.transforms){let s,u;if(dyt(o))u=e=new _0(e,o),s="derived";else if(Xme(o)){const l=xxt(o);u=e=(r=da.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new w0(e,t,o.filter)}else if(hyt(o))u=e=Bl.makeFromTransform(e,o,t),s="number";else if(gyt(o))s="date",n.getWithExplicit(o.field).value===void 0&&(e=new da(e,{[o.field]:s}),n.set(o.field,s,!1)),u=e=Pl.makeFromTransform(e,o);else if(myt(o))u=e=_u.makeFromTransform(e,o),s="number",e9(t)&&(e=new rh(e));else if(eyt(o))u=e=Ww.make(e,t,o,a++),s="derived";else if(lyt(o))u=e=new k0(e,o),s="number";else if(cyt(o))u=e=new gg(e,o),s="number";else if(vyt(o))u=e=Yc.makeFromTransform(e,o),s="derived";else if(yyt(o))u=e=new iI(e,o),s="derived";else if(fyt(o))u=e=new rI(e,o),s="derived";else if(ryt(o))u=e=new uI(e,o),s="derived";else if(uyt(o))e=new lI(e,o);else if(pyt(o))u=e=mg.makeFromTransform(e,o),s="derived";else if(iyt(o))u=e=new nI(e,o),s="derived";else if(ayt(o))u=e=new oI(e,o),s="derived";else if(oyt(o))u=e=new sI(e,o),s="derived";else if(syt(o))u=e=new aI(e,o),s="derived";else{Me(Zgt(o));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function fI(e){var t,n,r,i,a,o,s,u,l,c;let f=kwt(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new J0t,g=e.data;lg(g)?(Gme(g)?f=new zw(f,g.sequence):q8(g)&&(f=new Bw(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=da.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new rh(f);const m=e.parent&&T0(e.parent);(Nr(e)||Eu(e))&&m&&(f=(r=Bl.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=Twt(f,e,p));const v=_xt(e),y=wxt(e);f=(i=da.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,Nr(e)&&(f=O0.parseAll(f,e),f=Uw.parseAll(f,e)),(Nr(e)||Eu(e))&&(m||(f=(a=Bl.makeFromEncoding(f,e))!==null&&a!==void 0?a:f),f=(o=Pl.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=_0.parseAllForSortIndex(f,e));const b=e.getName($O),x=new qa(f,b,$O,h);if(d[b]=x,f=x,Nr(e)){const _=_u.makeFromEncoding(f,e);_&&(f=_,e9(e)&&(f=new rh(f))),f=(s=mg.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=Yc.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}Nr(e)&&(f=(l=jw.make(f,e))!==null&&l!==void 0?l:f);const w=e.getName(sa),S=new qa(f,w,sa,h);d[w]=S,f=S,Nr(e)&&m1t(e,S);let C=null;if(Eu(e)){const _=e.getName("facet");f=(c=Awt(f,e.facet))!==null&&c!==void 0?c:f,C=new A0(f,e,_,S.getSource()),d[_]=C}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:S,facetRoot:C,ancestorParse:p})}class Owt extends N9{constructor(t,n,r,i){var a,o,s,u;super(t,"concat",n,r,i,t.resolve);(((o=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&Me(Xgt),this.children=this.getChildren(t).map((l,c)=>$9(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=fI(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return DO(t)?t.vconcat:B8(t)?t.hconcat:t.concat}parseLayoutSize(){Swt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=v9(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Iwt(e){return e===!1||e===null}const Nwt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Dpe),{labelExpr:1,encode:1}),$0e=Be(Nwt);class F9 extends Hc{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new F9(Yt(this.explicit),Yt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Iwt(this.get(t))}hasOrientSignalRef(){return Et(this.explicit.orient)}}function Dwt(e,t,n){var r;const{encoding:i,config:a}=e,o=(r=hi(i[t]))!==null&&r!==void 0?r:hi(i[Tl(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return rg(l)?Object.assign({text:v8({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:a})},n):n}function Rwt(e){return _s.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[zwt(n,e)]),t),{})}const Fwt={bottom:"top",top:"bottom",left:"right",right:"left"};function Mwt(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const o of Be(a.component.axes))r.axis[o]=y9(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=Pwt(n[o],a.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const a of _s){for(const o of e.children)if(!!o.component.axes[a]){if(r.axis[a]==="independent"){n[a]=((t=n[a])!==null&&t!==void 0?t:[]).concat(o.component.axes[a]);for(const s of o.component.axes[a]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!Et(u)){if(i[u]>0&&!l){const c=Fwt[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete o.component.axes[a]}if(r.axis[a]==="independent"&&n[a]&&n[a].length>1)for(const o of n[a])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function Pwt(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){const o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=$wt(i,a)}}}else return t.map(n=>n.clone());return e}function $wt(e,t){for(const n of $0e){const r=Qd(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,a)=>{switch(n){case"title":return fme(i,a);case"gridScale":return{explicit:i.explicit,value:Qr(i.value,a.value)}}return MO(i,a,n,"axis")});e.setWithExplicit(n,r)}return e}function Lwt(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Et(n.labelAngle)?n.labelAngle:tO(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Wve(r,i))return!0}return e===n[t]}const Bwt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function zwt(e,t){var n,r,i;let a=t.axis(e);const o=new F9,s=hi(t.encoding[e]),{mark:u,config:l}=t,c=(a==null?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||T1t(e),f=t.getScaleComponent(e).get("type"),d=w1t(e,f,c,t.config),h=a!==void 0?!a:d9("disable",l,a==null?void 0:a.style,d).configValue;if(o.set("disable",h,a!==void 0),h)return o;a=a||{};const p=C1t(t,a,e,s,d),g={fieldOrDatumDef:s,axis:a,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of $0e){const b=y in zve?zve[y](g):Rpe(y)?a[y]:void 0,x=b!==void 0,w=Lwt(b,y,a,t,e);if(x&&w)o.set(y,b,w);else{const{configValue:S=void 0,configFrom:C=void 0}=Rpe(y)&&y!=="values"?d9(y,t.config,a.style,d):{},_=S!==void 0;x&&!_?o.set(y,b,w):(C!=="vgAxisConfig"||Bwt.has(y)&&_||Vj(S)||Et(S))&&o.set(y,S,!1)}}const m=(i=a.encoding)!==null&&i!==void 0?i:{},v=Npe.reduce((y,b)=>{var x;if(!o.hasAxisPart(b))return y;const w=Yve((x=m[b])!==null&&x!==void 0?x:{},t),S=b==="labels"?Dwt(t,e,w):w;return S!==void 0&&!Yn(S)&&(y[b]={update:S}),y},{});return Yn(v)||o.set("encode",v,!!a.encoding||a.labelAngle!==void 0),o}function jwt({encoding:e,size:t}){for(const n of _s){const r=Ol(n);Ml(t[r])&&Rl(e[n])&&(delete t[r],Me(fge(r)))}return t}function Uwt(e,t,n,{graticule:r}){const i=wl(e)?Object.assign({},e):{type:e},a=Fn("orient",i,n);if(i.orient=Hwt(i.type,t,a),a!==void 0&&a!==i.orient&&Me(fmt(i.orient,a)),i.type==="bar"&&i.orient){const l=Fn("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:dgt[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Fn("opacity",i,n)===void 0&&(i.opacity=Vwt(i.type,t)),i.filled===void 0&&(i.filled=r?!1:qwt(i,n)),Fn("cursor",i,n)===void 0&&(i.cursor=Wwt(i,t,n)),i}function Wwt(e,t,n){return t.href||e.href||Fn("href",e,n)?"pointer":e.cursor}function Vwt(e,t){if(bt([aO,qj,Hj,Gj],e)&&!T8(t))return .7}function qwt(e,t){const n=og("filled",e,t),r=e.type;return Qr(n,r!==aO&&r!==iO&&r!==oO)}function Hwt(e,t,n){switch(e){case aO:case Hj:case Gj:case Mpe:case igt:case rgt:return}const{x:r,y:i,x2:a,y2:o}=t;switch(e){case rO:if(We(r)&&(Wa(r.bin)||We(i)&&i.aggregate&&!r.aggregate))return"vertical";if(We(i)&&(Wa(i.bin)||We(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(We(r)&&r.type===tg&&!Qn(r.bin)||_8(r)))return"horizontal";if(!o&&(We(i)&&i.type===tg&&!Qn(i.bin)||_8(i)))return"vertical"}case oO:if(a&&!(We(r)&&Wa(r.bin))&&o&&!(We(i)&&Wa(i.bin)))return;case nO:if(o)return We(i)&&Wa(i.bin)?"horizontal":"vertical";if(a)return We(r)&&Wa(r.bin)?"vertical":"horizontal";if(e===oO){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case iO:case qj:{const s=Rl(r),u=Rl(i);if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===m0,d=c.type===m0;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const Gwt={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),eh(e,"radius","arc")),eh(e,"theta","arc"))},Kwt={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),BO("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),BO("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),K8(e))},Xwt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),eh(e,"x","bar")),eh(e,"y","bar"))},Ywt={vgMark:"shape",encodeEntry:e=>Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&We(n)&&n.type===v0?{field:Ue(n,{expr:"datum"})}:{})]}},Zwt={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),eh(e,"x","image")),eh(e,"y","image")),H8(e,"url"))},Jwt={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e,{vgChannel:"strokeWidth"})),K8(e))},Qwt={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),K8(e))};function M9(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),ki("angle",e)),e2t(e,n,t))}function e2t(e,t,n){return n?{shape:{value:n}}:ki("shape",e)}const t2t={vgMark:"symbol",encodeEntry:e=>M9(e)},n2t={vgMark:"symbol",encodeEntry:e=>M9(e,"circle")},r2t={vgMark:"symbol",encodeEntry:e=>M9(e,"square")},i2t={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),eh(e,"x","rect")),eh(e,"y","rect"))},a2t={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),BO("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),BO("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),ki("size",e,{vgChannel:"strokeWidth"}))}},o2t={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),H8(e)),ki("size",e,{vgChannel:"fontSize"})),ki("angle",e)),ive("align",s2t(e.markDef,n,t))),ive("baseline",u2t(e.markDef,n,t))),ua("radius",e,{defaultPos:null,isMidPoint:!0})),ua("theta",e,{defaultPos:null,isMidPoint:!0}))}};function s2t(e,t,n){if(Fn("align",e,n)===void 0)return"center"}function u2t(e,t,n){if(Fn("baseline",e,n)===void 0)return"middle"}const l2t={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",a=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Es(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid",vgChannel:"xc"})),ua("y",e,{defaultPos:"mid",vgChannel:"yc"})),ki("size",e,{defaultValue:c2t(e),vgChannel:i})),{[a]:zr(Fn("thickness",n,t))})}};function c2t(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,a=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=Fn("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&Kd(u)&&Jr(u.step)?u.step*3/4:RO(n.view,a)*3/4}}const dI={arc:Gwt,area:Kwt,bar:Xwt,circle:n2t,geoshape:Ywt,image:Zwt,line:Jwt,point:t2t,rect:i2t,rule:a2t,square:r2t,text:o2t,tick:l2t,trail:Qwt};function f2t(e){return bt([iO,nO,agt],e.mark)?d2t(e):bt([rO],e.mark)?h2t(e):hI(e)}const L0e="faceted_path_";function d2t(e){const t=hme(e.mark,e.encoding),n=hI(e,{fromPrefix:t.length>0?L0e:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:L0e+e.requestDataName(sa),data:e.requestDataName(sa),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const B0e="stack_group_";function h2t(e){const t=o8.some(n=>Fn(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=hI(e,{fromPrefix:B0e}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),a=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},cw(n.encode.update,["y","yc","y2","height",...o8])),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Pc(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},cw(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Pc(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of o8){const d=og(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=zr(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Ue(u)?[Ue(u)]:[];return((u==null?void 0:u.bin)||(u==null?void 0:u.timeUnit))&&l.push(Ue(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=og(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:zr(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(sa),name:B0e+e.requestDataName(sa),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}else return hI(e)}function p2t(e){const{encoding:t,stack:n,mark:r,markDef:i,config:a}=e,o=t.order;if(!(!vt(o)&&Vc(o)&&_pe(o.value)||!o&&_pe(Fn("order",i,a)))){if((vt(o)||We(o))&&!n)return ume(o,{expr:"datum"});if(Yp(r)){const s=i.orient==="horizontal"?"y":"x",u=t[s];if(We(u)){const l=u.sort;if(vt(l))return{field:Ue(u,{prefix:s,suffix:"sort_index",expr:"datum"})};if(Dl(l))return{field:Ue({aggregate:T8(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(Vge(l)){const c=e.fieldDef(l.encoding);return{field:Ue(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Ue(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function hI(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,a=Qr(r.clip,g2t(e),m2t(e)),o=ome(r),s=e.encoding.key,u=p2t(e),l=v2t(e),c=Fn("aria",r,i),f=dI[n].postEncodingTransform?dI[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:dI[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(sa)},encode:{update:dI[n].encodeEntry(e)}}),f?{transform:f}:{})]}function g2t(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function m2t(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function v2t(e){if(!e.component.selection)return null;const t=Be(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Be(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class z0e extends D0e{constructor(t,n,r,i={},a){var o,s;super(t,"unit",n,r,a,void 0,kme(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=wl(t.mark)?t.mark.type:t.mark;this.markDef=Uwt(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},a,{graticule:t.data&&q8(t.data)});const l=this.encoding=Yvt((s=t.encoding)!==null&&s!==void 0?s:{},this.markDef,a);this.size=jwt({encoding:l,size:kme(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=Fme(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===Ppe,r=t&&kgt.some(i=>It(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return pO.reduce((r,i)=>{var a;const o=hi(n[i]);return o&&(r[i]=(a=o.scale)!==null&&a!==void 0?a:{}),r},{})}initAxes(t){return _s.reduce((n,r)=>{const i=t[r];if(It(i)||r===br&&It(t.x2)||r===di&&It(t.y2)){const a=It(i)?i.axis:void 0;n[r]=a&&Object.assign({},a)}return n},{})}initLegend(t){return Mgt.reduce((n,r)=>{const i=hi(t[r]);if(i&&$gt(r)){const a=i.legend;n[r]=a&&Object.assign({},a)}return n},{})}parseData(){this.component.data=fI(this)}parseLayoutSize(){Ewt(this)}parseSelections(){this.component.selection=g1t(this,this.selection)}parseMarkGroup(){this.component.mark=f2t(this)}parseAxesAndHeaders(){this.component.axes=Rwt(this)}assembleSelectionTopLevelSignals(t){return Vyt(this,t)}assembleSignals(){return[...Pve(this),...Uyt(this,[])]}assembleSelectionData(t){return qyt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return v9(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!T0(this.parent))&&(n=gve(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return sg(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Fl(n)}typedFieldDef(t){const n=this.fieldDef(t);return Go(n)?n:null}}class P9 extends N9{constructor(t,n,r,i,a){super(t,"layer",n,r,a,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(FO(s))return new P9(s,this,this.getName("layer_"+u),o,a);if($c(s))return new z0e(s,this,this.getName("layer_"+u),o,a);throw new Error(Qj(s))})}parseData(){this.component.data=fI(this);for(const t of this.children)t.parseData()}parseLayoutSize(){_wt(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Mwt(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Pve(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),v9(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Hyt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),s0e(this))}}function $9(e,t,n,r,i){if(SO(e))return new Vw(e,t,n,i);if(FO(e))return new P9(e,t,n,r,i);if($c(e))return new z0e(e,t,n,r,i);if(v0t(e))return new Owt(e,t,n,i);throw new Error(Qj(e))}function y2t(e,t={}){t.logger&&Pmt(t.logger),t.fieldTitle&&eme(t.fieldTitle);try{const n=Nme(xpe(t.config,e.config)),r=Ume(e,n),i=$9(r,null,"",void 0,n);return i.parse(),Lxt(i.component.data,i),{spec:x2t(i,b2t(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&$mt(),t.fieldTitle&&Wvt()}}function b2t(e,t,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Xt(t)&&(t={type:t}),i&&a&&X0t(t.type)){if(i==="step"&&a==="step")Me(nge()),t.type="pad";else if(i==="step"||a==="step"){const o=i==="step"?"width":"height";Me(nge(hO(o)));const s=o==="width"?"height":"width";t.type=Y0t(s)}}return Object.assign(Object.assign(Object.assign({},Be(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Vme(n)),Vme(e))}function x2t(e,t,n={},r){const i=e.config?O0t(e.config):void 0,a=[].concat(e.assembleSelectionData([]),ywt(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class w2t extends Dme{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:a,timeUnits:o,aggregate:s,groupby:u,encoding:l}=O8(r,n),c=[...i||[],...a,...o,...s.length===0?[]:[{aggregate:s,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const _2t=new w2t;function S2t(e,t){return _2t.map(e,{config:t})}const E2t=Ipt.version;var C2t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",normalize:Ume,version:E2t,compile:y2t,extractTransforms:S2t});function j0e(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var A2t="vega-themes",k2t="2.10.0",T2t="Themes for stylized Vega and Vega-Lite visualizations.",O2t=["vega","vega-lite","themes","style"],I2t="BSD-3-Clause",N2t={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},D2t=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],R2t="build/vega-themes.js",F2t="build/vega-themes.module.js",M2t="build/vega-themes.min.js",P2t="build/vega-themes.min.js",$2t="build/vega-themes.module.d.ts",L2t={type:"git",url:"https://github.com/vega/vega-themes.git"},B2t=["src","build"],z2t={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},j2t={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},U2t={vega:"*","vega-lite":"*"},W2t={name:A2t,version:k2t,description:T2t,keywords:O2t,license:I2t,author:N2t,contributors:D2t,main:R2t,module:F2t,unpkg:M2t,jsdelivr:P2t,types:$2t,repository:L2t,files:B2t,scripts:z2t,devDependencies:j2t,peerDependencies:U2t};const I0="#fff",V2t="#888",q2t={background:"#333",title:{color:I0,subtitleColor:I0},style:{"guide-label":{fill:I0},"guide-title":{fill:I0}},axis:{domainColor:I0,gridColor:V2t,tickColor:I0}},vg="#4572a7",H2t={background:"#fff",arc:{fill:vg},area:{fill:vg},line:{stroke:vg,strokeWidth:2},path:{stroke:vg},rect:{fill:vg},shape:{stroke:vg},symbol:{fill:vg,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},yg="#30a2da",L9="#cbcbcb",G2t="#999",K2t="#333",U0e="#f0f0f0",W0e="#333",X2t={arc:{fill:yg},area:{fill:yg},axis:{domainColor:L9,grid:!0,gridColor:L9,gridWidth:1,labelColor:G2t,labelFontSize:10,titleColor:K2t,tickColor:L9,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:U0e,group:{fill:U0e},legend:{labelColor:W0e,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:W0e,titleFontSize:14,titlePadding:10},line:{stroke:yg,strokeWidth:2},path:{stroke:yg,strokeWidth:.5},rect:{fill:yg},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:yg},bar:{binSpacing:2,fill:yg,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},bg="#000",Y2t={group:{fill:"#e5e5e5"},arc:{fill:bg},area:{fill:bg},line:{stroke:bg},path:{stroke:bg},rect:{fill:bg},shape:{stroke:bg},symbol:{fill:bg,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Z2t=22,J2t="normal",V0e="Benton Gothic, sans-serif",q0e=11.5,Q2t="normal",xg="#82c6df",B9="Benton Gothic Bold, sans-serif",H0e="normal",G0e=13,qw={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},e_t={background:"#ffffff",title:{anchor:"start",color:"#000000",font:B9,fontSize:Z2t,fontWeight:J2t},arc:{fill:xg},area:{fill:xg},line:{stroke:xg,strokeWidth:2},path:{stroke:xg},rect:{fill:xg},shape:{stroke:xg},symbol:{fill:xg,size:30},axis:{labelFont:V0e,labelFontSize:q0e,labelFontWeight:Q2t,titleFont:B9,titleFontSize:G0e,titleFontWeight:H0e},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:V0e,labelFontSize:q0e,symbolType:"square",titleFont:B9,titleFontSize:G0e,titleFontWeight:H0e},range:{category:qw["category-6"],diverging:qw["fireandice-6"],heatmap:qw["fire-7"],ordinal:qw["fire-7"],ramp:qw["fire-7"]}},wg="#ab5787",pI="#979797",t_t={background:"#f9f9f9",arc:{fill:wg},area:{fill:wg},line:{stroke:wg},path:{stroke:wg},rect:{fill:wg},shape:{stroke:wg},symbol:{fill:wg,size:30},axis:{domainColor:pI,domainWidth:.5,gridWidth:.2,labelColor:pI,tickColor:pI,tickWidth:.2,titleColor:pI},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},_g="#3e5c69",n_t={background:"#fff",arc:{fill:_g},area:{fill:_g},line:{stroke:_g},path:{stroke:_g},rect:{fill:_g},shape:{stroke:_g},symbol:{fill:_g},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Cs="#1696d2",K0e="#000000",r_t="#FFFFFF",gI="Lato",z9="Lato",i_t="Lato",a_t="#DEDDDD",o_t=18,Hw={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},s_t={background:r_t,title:{anchor:"start",fontSize:o_t,font:gI},axisX:{domain:!0,domainColor:K0e,domainWidth:1,grid:!1,labelFontSize:12,labelFont:z9,labelAngle:0,tickColor:K0e,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:gI},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:a_t,gridWidth:1,labelFontSize:12,labelFont:z9,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:gI,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:z9,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:gI,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Hw["six-groups-cat-1"],diverging:Hw["diverging-colors"],heatmap:Hw["diverging-colors"],ordinal:Hw["six-groups-seq"],ramp:Hw["shades-blue"]},area:{fill:Cs},rect:{fill:Cs},line:{color:Cs,stroke:Cs,strokeWidth:5},trail:{color:Cs,stroke:Cs,strokeWidth:0,size:1},path:{stroke:Cs,strokeWidth:.5},point:{filled:!0},text:{font:i_t,color:Cs,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Cs,stroke:null}},arc:{fill:Cs},shape:{stroke:Cs},symbol:{fill:Cs,size:30}},Sg="#3366CC",X0e="#ccc",mI="Arial, sans-serif",u_t={arc:{fill:Sg},area:{fill:Sg},path:{stroke:Sg},rect:{fill:Sg},shape:{stroke:Sg},symbol:{stroke:Sg},circle:{fill:Sg},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:mI,fontSize:12},"guide-title":{font:mI,fontSize:12},"group-title":{font:mI,fontSize:12}},title:{font:mI,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:X0e,tickColor:X0e,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},l_t=W2t.version;var c_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:q2t,excel:H2t,fivethirtyeight:X2t,ggplot2:Y2t,googlecharts:u_t,latimes:e_t,quartz:t_t,urbaninstitute:s_t,version:l_t,vox:n_t}),f_t=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const Y0e="vg-tooltip-element",d_t={offsetX:10,offsetY:10,id:Y0e,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:h_t,maxDepth:2};function h_t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function p_t(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return f_t.toString().replace(Y0e,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function g_t(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function m_t(e,t,n){if(ut(e))return`[${e.map(r=>t(Bn(r)?r:Z0e(r,n))).join(", ")}]`;if(Nt(e)){let r="";const i=e,{title:a,image:o}=i,s=g_t(i,["title","image"]);a&&(r+=`<h2>${t(a)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Nt(c)&&(c=Z0e(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function v_t(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Z0e(e,t){return JSON.stringify(e,v_t(t))}function y_t(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}class b_t{constructor(t){this.options=Object.assign(Object.assign({},d_t),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=p_t(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=m_t(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=y_t(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function vI(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function x_t(e,t,n){const r=e.open(t),i=1e4,a=250,{origin:o}=new URL(t);let s=~~(i/a);function u(c){c.source===r&&(s=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){s<=0||(r.postMessage(n,o),setTimeout(l,a),s-=1)}setTimeout(l,a)}var w_t=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function J0e(e,...t){for(const n of t)__t(e,n);return e}function __t(e,t){for(const n of Object.keys(t))RC(e,n,t[n],!0)}var j9;const Zc=upt;let N0=C2t;const yI=typeof window!="undefined"?window:void 0;N0===void 0&&((j9=yI==null?void 0:yI.vl)===null||j9===void 0?void 0:j9.compile)&&(N0=yI.vl);const Q0e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},S_t={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Gw={vega:"Vega","vega-lite":"Vega-Lite"},bI={vega:Zc.version,"vega-lite":N0?N0.version:"not available"},E_t={vega:e=>e,"vega-lite":(e,t)=>N0.compile(e,{config:t}).spec},C_t=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,A_t="chart-wrapper";function k_t(e){return typeof e=="function"}function eye(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+a),o.document.title=`${Gw[r]} JSON Source`}function tye(e,t){var n;if(e.$schema){const r=j0e(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${Gw[r.library]}, but mode argument sets ${(n=Gw[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return Fne.satisfies(bI[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${Gw[i]} ${r.version}, but the current version of ${Gw[i]} is v${bI[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function T_t(e){return!!(e&&"load"in e)}function nye(e){return T_t(e)?e:Zc.loader(e)}function rye(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function O_t(e,t,n={}){var r,i,a;return vI(this,void 0,void 0,function*(){let o,s;Bn(t)?(s=nye(n.loader),o=JSON.parse(yield s.load(t))):o=t;const u=rye(o).loader;(!s||u)&&(s=nye((r=n.loader)!==null&&r!==void 0?r:u));const l=yield iye(rye(o),s),c=yield iye(n,s),f=Object.assign(Object.assign({},J0e(c,l)),{config:DC((i=c.config)!==null&&i!==void 0?i:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield N_t(e,o,f,s)})}function iye(e,t){var n;return vI(this,void 0,void 0,function*(){const r=Bn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=Bn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function I_t(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function N_t(e,t,n={},r){var i,a,o,s,u,l;return vI(this,void 0,void 0,function*(){const c=n.theme?DC(c_t[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=a4(n.actions)?n.actions:J0e({},Q0e,(a=n.actions)!==null&&a!==void 0?a:{}),d=Object.assign(Object.assign({},S_t),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(s=n.logLevel)!==null&&s!==void 0?s:Zc.Warn,g=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:T,rootContainer:I}=I_t(m);if(!T.getElementById(k)){const N=document.createElement("style");N.id=k,N.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?w_t.toString():n.defaultStyle,I.appendChild(N)}}const v=tye(t,n.mode);let y=E_t[v](t,c);if(v==="vega-lite"&&y.$schema){const k=j0e(y.$schema);Fne.satisfies(bI.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${bI.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const k=document.createElement("div");k.classList.add(A_t),m.appendChild(k),b=k}const x=n.patch;x&&(x instanceof Function?y=x(y):y=gC(y,x,!0,!1).newDocument),n.formatLocale&&Zc.formatLocale(n.formatLocale),n.timeFormatLocale&&Zc.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,S=Zc.parse(y,v==="vega-lite"?{}:c,{ast:w}),C=new(n.viewClass||Zc.View)(S,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:Zc.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;k_t(n.tooltip)?k=n.tooltip:k=new b_t(n.tooltip===!0?{}:n.tooltip).call,C.tooltip(k)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:k,updateSet:T}=typeof _=="boolean"?{}:_;C.hover(k,T)}n&&(n.width!=null&&C.width(n.width),n.height!=null&&C.height(n.height),n.padding!=null&&C.padding(n.padding)),yield C.initialize(b,n.bind).runAsync();let E;if(f!==!1){let k=m;if(n.defaultStyle!==!1){const I=document.createElement("details");I.title=d.CLICK_TO_VIEW_ACTIONS,m.append(I),k=I;const N=document.createElement("summary");N.innerHTML=C_t,I.append(N),E=O=>{I.contains(O.target)||I.removeAttribute("open")},document.addEventListener("click",E)}const T=document.createElement("div");if(k.append(T),T.classList.add("vega-actions"),f===!0||f.export!==!1){for(const I of["svg","png"])if(f===!0||f.export===!0||f.export[I]){const N=d[`${I.toUpperCase()}_ACTION`],O=document.createElement("a");O.text=N,O.href="#",O.target="_blank",O.download=`${g}.${I}`,O.addEventListener("mousedown",function(D){return vI(this,void 0,void 0,function*(){D.preventDefault();const L=yield C.toImageURL(I,n.scaleFactor);this.href=L})}),T.append(O)}}if(f===!0||f.source!==!1){const I=document.createElement("a");I.text=d.SOURCE_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;eye(P$(t),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"",v),N.preventDefault()}),T.append(I)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const I=document.createElement("a");I.text=d.COMPILED_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;eye(P$(y),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"","vega"),N.preventDefault()}),T.append(I)}if(f===!0||f.editor!==!1){const I=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",N=document.createElement("a");N.text=d.EDITOR_ACTION,N.href="#",N.addEventListener("click",function(O){x_t(window,I,{config:c,mode:v,renderer:h,spec:P$(t)}),O.preventDefault()}),T.append(N)}}function A(){E&&document.removeEventListener("click",E),C.finalize()}return{view:C,spec:t,vgSpec:y,finalize:A}})}var D_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:O_t,DEFAULT_ACTIONS:Q0e,guessMode:tye,vega:Zc,get vegaLite(){return N0}}),D0=gh(D_t),As={},Le={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var aye=Object.getOwnPropertySymbols,R_t=Object.prototype.hasOwnProperty,F_t=Object.prototype.propertyIsEnumerable;function M_t(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function P_t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(a){return!1}}var U9=P_t()?Object.assign:function(e,t){for(var n,r=M_t(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)R_t.call(n,o)&&(r[o]=n[o]);if(aye){i=aye(n);for(var s=0;s<i.length;s++)F_t.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},W9={};Object.defineProperty(W9,"__esModule",{value:!0}),W9.StyleSheet=uye;var $_t=U9,L_t=B_t($_t);function B_t(e){return e&&e.__esModule?e:{default:e}}function z_t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function V9(e){return e[e.length-1]}function oye(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var Eg=typeof window!="undefined",j_t=!1,U_t=function(){if(Eg){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function sye(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function uye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!j_t:t,r=e.maxLength,i=r===void 0?Eg&&U_t?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,L_t.default)(uye.prototype,{getSheet:function(){return oye(V9(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");Eg?this.tags[0]=sye():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch(r){}},insert:function(t){if(Eg)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=V9(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else V9(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,Eg&&this.ctr%this.maxLength==0&&this.tags.push(sye()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){Eg?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!Eg)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(z_t(Array.from(oye(n).cssRules))))}),t}});var R0={},W_t=/-(.)/g;function V_t(e){return e.replace(W_t,function(t,n){return n.toUpperCase()})}var q_t=V_t,H_t=q_t,G_t=/^-ms-/;function K_t(e){return H_t(e.replace(G_t,"ms-"))}var X_t=K_t,q9={},H9={};Object.defineProperty(H9,"__esModule",{value:!0});var xI={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function Y_t(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var Z_t=["Webkit","ms","Moz","O"];Object.keys(xI).forEach(function(e){Z_t.forEach(function(t){xI[Y_t(t,e)]=xI[e]})});var J_t={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},Q_t={isUnitlessNumber:xI,shorthandPropertyExpansions:J_t};H9.default=Q_t;function wI(e){return function(){return e}}var Cg=function(){};Cg.thatReturns=wI,Cg.thatReturnsFalse=wI(!1),Cg.thatReturnsTrue=wI(!0),Cg.thatReturnsNull=wI(null),Cg.thatReturnsThis=function(){return this},Cg.thatReturnsArgument=function(e){return e};var eSt=Cg,tSt=eSt,nSt=tSt,lye=nSt;Object.defineProperty(q9,"__esModule",{value:!0});var rSt=H9,iSt=cye(rSt),aSt=lye;cye(aSt);function cye(e){return e&&e.__esModule?e:{default:e}}var fye=iSt.default.isUnitlessNumber;function oSt(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||fye.hasOwnProperty(e)&&fye[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}q9.default=oSt;var sSt=/([A-Z])/g;function uSt(e){return e.replace(sSt,"-$1").toLowerCase()}var lSt=uSt,cSt=lSt,fSt=/^ms-/;function dSt(e){return cSt(e).replace(fSt,"-ms-")}var hSt=dSt;function pSt(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var gSt=pSt;Object.defineProperty(R0,"__esModule",{value:!0}),R0.processStyleName=void 0,R0.createMarkupForStyles=CSt;var mSt=X_t;Kw(mSt);var vSt=q9,ySt=Kw(vSt),bSt=hSt,xSt=Kw(bSt),wSt=gSt,_St=Kw(wSt),SSt=lye;Kw(SSt);function Kw(e){return e&&e.__esModule?e:{default:e}}var ESt=R0.processStyleName=(0,_St.default)(xSt.default);function CSt(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var a=e[r];a!=null&&(i?n+=r+":"+a+";":(n+=ESt(r)+":",n+=(0,ySt.default)(r,a,t)+";"))}}return n||null}var G9={};Object.defineProperty(G9,"__esModule",{value:!0});var dye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};G9.default=K9;function ASt(e){return e==null||e===!1||(typeof e=="undefined"?"undefined":dye(e))==="object"&&Object.keys(e).length===0}function kSt(e){if(ASt(e))return null;if((typeof e=="undefined"?"undefined":dye(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var a=e[n[i]],o=K9(a);(o===null||o!==a)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function TSt(e){var t=!1,n=[];return e.forEach(function(r){var i=K9(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function K9(e){return Array.isArray(e)?TSt(e):kSt(e)}var F0={},X9={},Y9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(Y9,Y9.exports);var Z9={exports:{}},_I={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(_I,_I.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=_I.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u){if(o.hasOwnProperty(s))for(var l=o[s],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(s)]=u[s]}e.exports=t.default}(Z9,Z9.exports);var J9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,a,o,s){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,a,o,s);if(c)return c}}e.exports=t.default})(J9,J9.exports);var Q9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(a,o){if(a==="cursor"&&r.hasOwnProperty(o))return n.map(function(s){return s+o})}e.exports=t.default})(Q9,Q9.exports);var e7={exports:{}},Ag={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(Ag,Ag.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ag.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return a.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(e7,e7.exports);var t7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ag.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return a.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(t7,t7.exports);var n7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,a){if(i==="display"&&n.hasOwnProperty(a))return n[a]}e.exports=t.default})(n7,n7.exports);var r7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(a,o,s){a==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?s.WebkitBoxOrient="vertical":s.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?s.WebkitBoxDirection="reverse":s.WebkitBoxDirection="normal"),r.hasOwnProperty(a)&&(s[r[a]]=n[o]||o)}e.exports=t.default})(r7,r7.exports);var i7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=Ag.exports,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var a=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function s(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return a.map(function(c){return c+l})}e.exports=t.default})(i7,i7.exports);var a7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ag.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return a.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(a7,a7.exports);var o7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(o7,o7.exports);var s7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function a(o,s){if(r.hasOwnProperty(o)&&i.hasOwnProperty(s))return n.map(function(u){return u+s})}e.exports=t.default})(s7,s7.exports);var u7={exports:{}},l7={exports:{}},OSt=/[A-Z]/g,ISt=/^ms-/,c7={};function NSt(e){return"-"+e.toLowerCase()}function DSt(e){if(c7.hasOwnProperty(e))return c7[e];var t=e.replace(OSt,NSt);return c7[e]=ISt.test(t)?"-"+t:t}var RSt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:DSt}),FSt=gh(RSt);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=FSt,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return(0,r.default)(o)}e.exports=t.default})(l7,l7.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=l7.exports,r=u(n),i=Ag.exports,a=u(i),o=_I.exports,s=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,a.default)(h))return h;for(var g=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var S=p[x],C=0,_=S.length;C<_;++C)b.unshift(y.replace(w,c[S[C]]+w))}g[m]=b.join(",")}return g.join(",")}function d(h,p,g,m){if(typeof p=="string"&&l.hasOwnProperty(h)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?b:(g["Webkit"+(0,s.default)(h)]=y,g["Moz"+(0,s.default)(h)]=b,v)}}e.exports=t.default}(u7,u7.exports),Object.defineProperty(X9,"__esModule",{value:!0}),X9.default=uEt;var MSt=Y9.exports,PSt=Yo(MSt),$St=Z9.exports,LSt=Yo($St),BSt=J9.exports,zSt=Yo(BSt),jSt=Q9.exports,USt=Yo(jSt),WSt=e7.exports,VSt=Yo(WSt),qSt=t7.exports,HSt=Yo(qSt),GSt=n7.exports,KSt=Yo(GSt),XSt=r7.exports,YSt=Yo(XSt),ZSt=i7.exports,JSt=Yo(ZSt),QSt=a7.exports,eEt=Yo(QSt),tEt=o7.exports,nEt=Yo(tEt),rEt=s7.exports,iEt=Yo(rEt),aEt=u7.exports,oEt=Yo(aEt);function Yo(e){return e&&e.__esModule?e:{default:e}}var sEt=[VSt.default,USt.default,HSt.default,YSt.default,JSt.default,eEt.default,nEt.default,iEt.default,oEt.default,KSt.default],hye=PSt.default.prefixMap;function uEt(e){for(var t in e){var n=e[t],r=(0,zSt.default)(sEt,t,n,e,hye);r&&(e[t]=r),(0,LSt.default)(hye,t,e)}return e}Object.defineProperty(F0,"__esModule",{value:!0});var f7=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};F0.PluginSet=gye,F0.fallbacks=pEt,F0.contentWrap=mEt,F0.prefixes=vEt;var lEt=U9,d7=pye(lEt),cEt=R0,fEt=X9,dEt=pye(fEt);function pye(e){return e&&e.__esModule?e:{default:e}}var hEt=function(e){return e==="development"||!e}("production");function gye(e){this.fns=e||[]}(0,d7.default)(gye.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(a){t.fns.indexOf(a)>=0?hEt&&console.warn("adding the same plugin again, ignoring"):t.fns=[a].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function pEt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,a){return i[a]=Array.isArray(n[a])?n[a].join("; "+(0,cEt.processStyleName)(a)+": "):n[a],i},{});return(0,d7.default)({},e,{style:r})}return e}var gEt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function mEt(e){if(e.style.content){var t=e.style.content;return gEt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:f7({},e,{style:f7({},e.style,{content:'"'+t+'"'})})}return e}function vEt(e){return(0,d7.default)({},e,{style:(0,dEt.default)(f7({},e.style))})}var h7={};Object.defineProperty(h7,"__esModule",{value:!0}),h7.default=yEt;function yEt(e,t){for(var n=1540483477,r=24,i=t^e.length,a=e.length,o=0;a>=4;){var s=bEt(e,o);s=kg(s,n),s^=s>>>r,s=kg(s,n),i=kg(i,n),i^=s,o+=4,a-=4}switch(a){case 3:i^=mye(e,o),i^=e.charCodeAt(o+2)<<16,i=kg(i,n);break;case 2:i^=mye(e,o),i=kg(i,n);break;case 1:i^=e.charCodeAt(o),i=kg(i,n);break}return i^=i>>>13,i=kg(i,n),i^=i>>>15,i>>>0}function bEt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function mye(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function kg(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(Le,"__esModule",{value:!0}),Le.compose=Le.merge=Le.$=Le.style=Le.presets=Le.keyframes=Le.fontFace=Le.insertGlobal=Le.insertRule=Le.plugins=Le.styleSheet=void 0,Le.speedy=AEt,Le.simulations=kEt,Le.simulate=TEt,Le.cssLabels=OEt,Le.isLikeRule=y7,Le.idFor=b7,Le.css=Ti,Le.rehydrate=WEt,Le.flush=VEt,Le.select=_7,Le.parent=HEt,Le.media=GEt,Le.pseudo=kt,Le.active=KEt,Le.any=XEt,Le.checked=YEt,Le.disabled=ZEt,Le.empty=JEt,Le.enabled=QEt,Le._default=eCt,Le.first=tCt,Le.firstChild=nCt,Le.firstOfType=rCt,Le.fullscreen=iCt,Le.focus=aCt,Le.hover=oCt,Le.indeterminate=sCt,Le.inRange=uCt,Le.invalid=lCt,Le.lastChild=cCt,Le.lastOfType=fCt,Le.left=dCt,Le.link=hCt,Le.onlyChild=pCt,Le.onlyOfType=gCt,Le.optional=mCt,Le.outOfRange=vCt,Le.readOnly=yCt,Le.readWrite=bCt,Le.required=xCt,Le.right=wCt,Le.root=_Ct,Le.scope=SCt,Le.target=ECt,Le.valid=CCt,Le.visited=ACt,Le.dir=kCt,Le.lang=TCt,Le.not=OCt,Le.nthChild=ICt,Le.nthLastChild=NCt,Le.nthLastOfType=DCt,Le.nthOfType=RCt,Le.after=FCt,Le.before=MCt,Le.firstLetter=PCt,Le.firstLine=$Ct,Le.selection=LCt,Le.backdrop=BCt,Le.placeholder=zCt,Le.cssFor=jCt,Le.attribsFor=UCt;var xEt=U9,wEt=g7(xEt),_Et=W9,p7=R0,SEt=G9,oh=g7(SEt),Jc=F0,EEt=h7,CEt=g7(EEt);function g7(e){return e&&e.__esModule?e:{default:e}}function Xw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zo=Le.styleSheet=new _Et.StyleSheet;Zo.inject();function AEt(e){return Zo.speedy(e)}var Yw=Le.plugins=Zo.plugins=new Jc.PluginSet([Jc.prefixes,Jc.contentWrap,Jc.fallbacks]);Yw.media=new Jc.PluginSet,Yw.fontFace=new Jc.PluginSet,Yw.keyframes=new Jc.PluginSet([Jc.prefixes,Jc.fallbacks]);var m7=!1,SI=typeof window!="undefined",v7=m7,vye=!1,yye=!1;function kEt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;v7=!!e}function TEt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,oh.default)(t),t?v7?t.reduce(function(r,i){return r["data-simulate-"+EI(i)]="",r},{}):(vye||(console.warn("can't simulate without once calling simulations(true)"),vye=!0),yye||(console.warn("don't use simulation outside dev"),yye=!0),{}):{}}var Zw=m7;function OEt(e){Zw=!!e}function EI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function Jw(e){var t=JSON.stringify(e),n=(0,CEt.default)(t).toString(36);return e.label&&e.label.length>0&&m7?EI(e.label.join("."),"-")+"-"+n:n}function y7(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function b7(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var IEt=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function x7(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=IEt.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function bye(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=x7(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return v7&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+EI(t)+"],[data-css-"+e+"][data-simulate-"+EI(t)+"]"),n}function w7(e){var t=e.selector,n=e.style,r=Yw.transform({selector:t,style:n});return r.selector+"{"+(0,p7.createMarkupForStyles)(r.style)+"}"}function CI(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(a){a.indexOf("&")>=0?(n=n||{},n[a]=e[a]):a.indexOf("@media")===0?(r=r||{},r[a]=CI(e[a])):a.indexOf("@supports")===0?(i=i||{},i[a]=CI(e[a])):a==="label"?e.label.length>0&&(t=t||{},t.label=Zw?e.label.join("."):""):(t=t||{},t[a]=e[a])}),{plain:t,selects:n,medias:r,supports:i}}function AI(e,t){var n=[],r=t.plain,i=t.selects,a=t.medias,o=t.supports;return r&&n.push(w7({style:r,selector:bye(e)})),i&&Object.keys(i).forEach(function(s){return n.push(w7({style:i[s],selector:bye(e,s)}))}),a&&Object.keys(a).forEach(function(s){return n.push(s+"{"+AI(e,a[s]).join("")+"}")}),o&&Object.keys(o).forEach(function(s){return n.push(s+"{"+AI(e,o[s]).join("")+"}")}),n}var Cu=Zo.inserted={};function NEt(e){if(!Cu[e.id]){Cu[e.id]=!0;var t=CI(e.style),n=AI(e.id,t);Cu[e.id]=SI?!0:n,n.forEach(function(r){return Zo.insert(r)})}}var Qw=Zo.registered={};function kI(e){Qw[e.id]||(Qw[e.id]=e)}function DEt(e){if(y7(e)){var t=Qw[b7(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var TI={};function REt(e){if(kI(e),NEt(e),TI[e.id])return TI[e.id];var t=Xw({},"data-css-"+e.id,Zw&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),TI[e.id]=t,t}function FEt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function xye(e,t){var n=x7(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=x7(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,a){return i.concat(n.map(function(o){return a.replace(/\&/g,o)}))},[]).join(",")}function MEt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function PEt(e){return e.indexOf("@media")===0}function $Et(e){return e.indexOf("@supports")===0}function LEt(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function wye(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(wye(e[n])):t=t.concat(e[n]);return t}var _ye={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function Tg(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,a=i===void 0?"":i,o=t.supp,s=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=wye(l),l.forEach(function(c){if(y7(c)){var f=DEt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,oh.default)(c),c&&c.composes&&Tg(e,{selector:r,mq:a,supp:s,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(FEt(d))_ye[d]&&_ye[d].forEach(function(p){return Tg(e,{selector:xye(r,p),mq:a,supp:s,src:c[d]})}),Tg(e,{selector:xye(r,d),mq:a,supp:s,src:c[d]});else if(PEt(d))Tg(e,{selector:r,mq:MEt(a,d),supp:s,src:c[d]});else if($Et(d))Tg(e,{selector:r,mq:a,supp:LEt(s,d),src:c[d]});else if(d!=="composes"){var h=e;s&&(h[s]=h[s]||{},h=h[s]),a&&(h[a]=h[a]||{},h=h[a]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?Zw&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function Sye(e){var t={label:[]};Tg(t,{src:e});var n={id:Jw(t),style:t,label:Zw?t.label.join("."):"",type:"css"};return REt(n)}var OI={};Object.defineProperty(OI,"toString",{enumerable:!1,value:function(){return"css-nil"}});var II=typeof WeakMap!="undefined"?[OI,new WeakMap,new WeakMap,new WeakMap]:[OI];function BEt(e){return function(t){if(II[t.length]){for(var n=II[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(Qw[i.toString().substring(4)])return i}}var a=e(t);if(II[t.length]){for(var o=0,s=II[t.length];o<t.length-1;)s=s.get(t[o]),o++;try{s.set(t[o],a)}catch(u){}}return a}}var zEt=typeof WeakMap!="undefined"?BEt(Sye):Sye;function Ti(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,oh.default)(t),t?zEt(t):OI}Ti.insert=function(e){var t={id:Jw(e),css:e,type:"raw"};kI(t),Cu[t.id]||(Zo.insert(t.css),Cu[t.id]=SI?!0:[t.css])},Le.insertRule=Ti.insert,Ti.global=function(e,t){if(t=(0,oh.default)(t),t)return Ti.insert(w7({selector:e,style:t}))},Le.insertGlobal=Ti.global;function jEt(e){if(!Cu[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=Yw.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,p7.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Zo.insert(r)}),Cu[e.id]=SI?!0:n}}Ti.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,oh.default)(t)||{};var n={id:Jw({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return kI(n),jEt(n),e+"_"+n.id},Ti.fontFace=function(e){e=(0,oh.default)(e);var t={id:Jw(e),type:"font-face",font:e};return kI(t),UEt(t),e.fontFamily},Le.fontFace=Ti.fontFace,Le.keyframes=Ti.keyframes;function UEt(e){if(!Cu[e.id]){var t="@font-face{"+(0,p7.createMarkupForStyles)(e.font)+"}";Zo.insert(t),Cu[e.id]=SI?!0:[t]}}function WEt(e){(0,wEt.default)(Cu,e.reduce(function(t,n){return t[n]=!0,t},{}))}function VEt(){Cu=Zo.inserted={},Qw=Zo.registered={},TI={},Zo.flush(),Zo.inject()}Le.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var qEt=Le.style=Ti;function _7(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Ti(Xw({},e,n)):qEt(n)}Le.$=_7;function HEt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Xw({},e+" &",n))}Le.merge=Ti,Le.compose=Ti;function GEt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Xw({},"@media "+e,n))}function kt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Xw({},e,n))}function KEt(e){return kt(":active",e)}function XEt(e){return kt(":any",e)}function YEt(e){return kt(":checked",e)}function ZEt(e){return kt(":disabled",e)}function JEt(e){return kt(":empty",e)}function QEt(e){return kt(":enabled",e)}function eCt(e){return kt(":default",e)}function tCt(e){return kt(":first",e)}function nCt(e){return kt(":first-child",e)}function rCt(e){return kt(":first-of-type",e)}function iCt(e){return kt(":fullscreen",e)}function aCt(e){return kt(":focus",e)}function oCt(e){return kt(":hover",e)}function sCt(e){return kt(":indeterminate",e)}function uCt(e){return kt(":in-range",e)}function lCt(e){return kt(":invalid",e)}function cCt(e){return kt(":last-child",e)}function fCt(e){return kt(":last-of-type",e)}function dCt(e){return kt(":left",e)}function hCt(e){return kt(":link",e)}function pCt(e){return kt(":only-child",e)}function gCt(e){return kt(":only-of-type",e)}function mCt(e){return kt(":optional",e)}function vCt(e){return kt(":out-of-range",e)}function yCt(e){return kt(":read-only",e)}function bCt(e){return kt(":read-write",e)}function xCt(e){return kt(":required",e)}function wCt(e){return kt(":right",e)}function _Ct(e){return kt(":root",e)}function SCt(e){return kt(":scope",e)}function ECt(e){return kt(":target",e)}function CCt(e){return kt(":valid",e)}function ACt(e){return kt(":visited",e)}function kCt(e,t){return kt(":dir("+e+")",t)}function TCt(e,t){return kt(":lang("+e+")",t)}function OCt(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?kt(":not("+e+")",t):_7(n.join(""),t)}function ICt(e,t){return kt(":nth-child("+e+")",t)}function NCt(e,t){return kt(":nth-last-child("+e+")",t)}function DCt(e,t){return kt(":nth-last-of-type("+e+")",t)}function RCt(e,t){return kt(":nth-of-type("+e+")",t)}function FCt(e){return kt("::after",e)}function MCt(e){return kt("::before",e)}function PCt(e){return kt("::first-letter",e)}function $Ct(e){return kt("::first-line",e)}function LCt(e){return kt("::selection",e)}function BCt(e){return kt("::backdrop",e)}function zCt(e){return Ti({"::placeholder":e})}function jCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,oh.default)(t),t?t.map(function(r){var i={label:[]};return Tg(i,{src:r}),AI(Jw(i),CI(i)).join("")}).join(""):""}function UCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,oh.default)(t);var r=t?t.map(function(i){b7(i);var a=Object.keys(i)[0],o=i[a];return a+'="'+(o||"")+'"'}).join(" "):"";return r}var Ha={},e2={};Object.defineProperty(e2,"__esModule",{value:!0});function WCt(e){return e.name!=null}e2.isSurfaceInfo=WCt;function VCt(e){return e.drawArea instanceof HTMLElement}e2.isSurface=VCt;var t2={},S7={};function qCt(){}var _o={},M0=[],Eye=[];function n2(e,t){var n=Eye,r,i,a,o;for(o=arguments.length;o-- >2;)M0.push(arguments[o]);for(t&&t.children!=null&&(M0.length||M0.push(t.children),delete t.children);M0.length;)if((i=M0.pop())&&i.pop!==void 0)for(o=i.length;o--;)M0.push(i[o]);else typeof i=="boolean"&&(i=null),(a=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(a=!1)),a&&r?n[n.length-1]+=i:n===Eye?n=[i]:n.push(i),r=a;var s=new qCt;return s.nodeName=e,s.children=n,s.attributes=t??void 0,s.key=t==null?void 0:t.key,_o.vnode!==void 0&&_o.vnode(s),s}function sh(e,t){for(var n in t)e[n]=t[n];return e}var HCt=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function Cye(e,t){return n2(e.nodeName,sh(sh({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var GCt=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,E7=[];function Aye(e){!e._dirty&&(e._dirty=!0)&&E7.push(e)==1&&(_o.debounceRendering||HCt)(C7)}function C7(){var e,t=E7;for(E7=[];e=t.pop();)e._dirty&&RI(e)}function KCt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&kye(e,t.nodeName):n||e._componentConstructor===t.nodeName}function kye(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function Tye(e){var t=sh({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function XCt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function A7(e){var t=e.parentNode;t&&t.removeChild(e)}function Oye(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]=typeof r[a]=="number"&&GCt.test(a)===!1?r[a]+"px":r[a]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,Iye,o):e.removeEventListener(t,Iye,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)YCt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function YCt(e,t,n){try{e[t]=n}catch(r){}}function Iye(e){return this._listeners[e.type](_o.event&&_o.event(e)||e)}var Nye=[],k7=0,uh=!1,NI=!1;function Dye(){for(var e;e=Nye.pop();)_o.afterMount&&_o.afterMount(e),e.componentDidMount&&e.componentDidMount()}function Rye(e,t,n,r,i,a){k7++||(uh=i!=null&&i.ownerSVGElement!==void 0,NI=e!=null&&!("__preactattr_"in e));var o=Fye(e,t,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--k7||(NI=!1,a||Dye()),o}function Fye(e,t,n,r,i){var a=e,o=uh;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),Og(e,!0))),a.__preactattr_=!0,a;var s=t.nodeName;if(typeof s=="function")return tAt(e,t,n,r);if(uh=s==="svg"?!0:s==="foreignObject"?!1:uh,s=String(s),(!e||!kye(e,s))&&(a=XCt(s,uh),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),Og(e,!0)}var u=a.firstChild,l=a.__preactattr_,c=t.children;if(l==null){l=a.__preactattr_={};for(var f=a.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!NI&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&ZCt(a,c,n,r,NI||l.dangerouslySetInnerHTML!=null),JCt(a,t.attributes,l),uh=o,a}function ZCt(e,t,n,r,i){var a=e.childNodes,o=[],s={},u=0,l=0,c=a.length,f=0,d=t?t.length:0,h,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=a[y],x=b.__preactattr_,w=d&&x?b._component?b._component.__key:x.key:null;w!=null?(u++,s[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(o[f++]=b)}if(d!==0)for(var y=0;y<d;y++){m=t[y],v=null;var w=m.key;if(w!=null)u&&s[w]!==void 0&&(v=s[w],s[w]=void 0,u--);else if(!v&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&KCt(p=o[h],m,i)){v=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}v=Fye(v,m,n,r),g=a[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?A7(g):e.insertBefore(v,g))}if(u)for(var y in s)s[y]!==void 0&&Og(s[y],!1);for(;l<=f;)(v=o[f--])!==void 0&&Og(v,!1)}function Og(e,t){var n=e._component;n?FI(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&A7(e),Mye(e))}function Mye(e){for(e=e.lastChild;e;){var t=e.previousSibling;Og(e,!0),e=t}}function JCt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&Oye(e,r,n[r],n[r]=void 0,uh);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&Oye(e,r,n[r],n[r]=t[r],uh)}var T7={};function QCt(e){var t=e.constructor.name;(T7[t]||(T7[t]=[])).push(e)}function Pye(e,t,n){var r=T7[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),r2.call(i,t,n)):(i=new r2(t,n),i.constructor=e,i.render=eAt),r){for(var a=r.length;a--;)if(r[a].constructor===e){i.nextBase=r[a].nextBase,r.splice(a,1);break}}return i}function eAt(e,t,n){return this.constructor(e,n)}function DI(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||_o.syncComponentUpdates!==!1||!e.base?RI(e,1,i):Aye(e)),e.__ref&&e.__ref(e))}function RI(e,t,n,r){if(!e._disable){var i=e.props,a=e.state,o=e.context,s=e.prevProps||i,u=e.prevState||a,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,g,m,v;if(c&&(e.props=s,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,a,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,a,o),e.props=i,e.state=a,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,a,o),e.getChildContext&&(o=sh(sh({},o),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=Tye(g);m=h,m&&m.constructor===y&&w.key==m.__key?DI(m,w,1,o,!1):(b=m,e._component=m=Pye(y,w,o),m.nextBase=m.nextBase||f,m._parentComponent=e,DI(m,w,0,o,!1),RI(m,1,n,!0)),x=m.base}else v=d,b=h,b&&(v=e._component=null),(d||t===1)&&(v&&(v._component=null),x=Rye(v,g,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&m!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),b||(d._component=null,Og(d,!1)))}if(b&&FI(b),e.base=x,x&&!r){for(var C=e,_=e;_=_._parentComponent;)(C=_).base=x;x._component=C,x._componentConstructor=C.constructor}}if(!c||n?Nye.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(s,u,l),_o.afterUpdate&&_o.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!k7&&!r&&Dye()}}function tAt(e,t,n,r){for(var i=e&&e._component,a=i,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=Tye(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(DI(i,l,3,n,r),e=i.base):(a&&!s&&(FI(a),e=o=null),i=Pye(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),DI(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Og(o,!1))),e}function FI(e){_o.beforeUnmount&&_o.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?FI(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,A7(t),QCt(e),Mye(t)),e.__ref&&e.__ref(null)}function r2(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}sh(r2.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=sh({},r)),sh(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),Aye(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),RI(this,2)},render:function(){}});function $ye(e,t,n){return Rye(n,e,{},!1,t,!1)}var nAt={h:n2,createElement:n2,cloneElement:Cye,Component:r2,render:$ye,rerender:C7,options:_o},rAt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:nAt,h:n2,createElement:n2,cloneElement:Cye,Component:r2,render:$ye,rerender:C7,options:_o}),O7=gh(rAt),I7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(I7,"__esModule",{value:!0});const MI=O7,N7=Le;class P0 extends MI.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},P0.defaultStyles,r),{width:a,height:o}=i;let{maxHeight:s,maxWidth:u}=i;s=o===P0.defaultStyles.height?s:o,u=a===P0.defaultStyles.width?u:a;const l=N7.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:a,maxHeight:s,maxWidth:u,overflow:"auto"}),c=N7.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=N7.css({boxSizing:"border-box"});return MI.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},MI.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),MI.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}P0.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},I7.SurfaceComponent=P0;var D7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(D7,"__esModule",{value:!0});const i2=O7,Lye=Le;class iAt extends i2.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>i2.h(aAt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,a=Lye.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return i2.h("div",{className:`${a} visor-tabs`},i)}}D7.Tabs=iAt;class aAt extends i2.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,a=Lye.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return i2.h("a",{className:`${a} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(S7,"__esModule",{value:!0});const Au=O7,Ig=Le,oAt=I7,sAt=D7;class R7 extends Au.Component{static render(t,n,r){return Au.render(Au.h(R7,Object.assign({},r)),t,n)}constructor(t){super(t);this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(a=>a.tab),r=this.state.tabs;let i;for(const a of n)r.has(a)||(r.add(a),i=a);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){const n=192;t.keyCode===n&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,a=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=Ig.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=Ig.css({right:"0"}),f=Ig.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=Ig.css({});return Au.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},Au.h(uAt,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),Au.h(sAt.Tabs,{tabNames:a,activeTab:r,handleClick:this.setActiveTab.bind(this)}),Au.h("div",{className:`${h} visor-surfaces`},i.map(p=>Au.h(oAt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}S7.VisorComponent=R7;function uAt(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=Ig.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),a=Ig.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=Ig.css({marginLeft:"auto"});return Au.h("div",{className:`${i} visor-controls`},Au.h("button",{className:`${a}`,onClick:n},t?"Minimize":"Maximize"),Au.h("button",{className:`${a} ${o}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(t2,"__esModule",{value:!0});const lAt=S7;let PI;const cAt="Visor",F7="tfjs-visor-container";function fAt(){if(typeof document=="undefined")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(F7)&&PI!=null)return PI;let e=document.getElementById(F7);e==null&&(e=document.createElement("div"),e.id=F7,document.body.appendChild(e));let t;function n(a,o){let s=null;return t=lAt.VisorComponent.render(a,t,{ref:u=>s=u,surfaceList:Array.from(o.values())}),s}const r=new Map,i=n(e,r);return PI=new Bye(i,e,r,n),PI}t2.visor=fAt;class Bye{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?cAt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),a=`${n}-${r}`;return this.surfaceList.has(a)||this.surfaceList.set(a,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}t2.Visor=Bye;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dAt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ha,"__esModule",{value:!0});const zye=e2,hAt=t2;function pAt(e){if(e instanceof HTMLElement)return e;if(zye.isSurface(e))return e.drawArea;if(zye.isSurfaceInfo(e))return hAt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Ha.getDrawArea=pAt;function gAt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a])return!1}return!0}Ha.shallowEquals=gAt;function mAt(){return dAt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Ha.nextFrame=mAt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(As,"__esModule",{value:!0});const jye=Le,vAt=Ha,yAt={prepend:!1};function bAt(e,t,n={}){const r=vAt.getDrawArea(e),i=jye.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),a=jye.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},yAt,n);let s=r.querySelector(`div[data-name=${t}]`);if(!s){if(s=document.createElement("div"),s.setAttribute("class",`${i}`),s.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${a}`),u.innerText=o.title,s.appendChild(u)}o.prepend?r.insertBefore(s,r.firstChild):r.appendChild(s)}return s}As.subSurface=bAt;function xAt(e){const t=50;let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=t;return r.clientWidth-n}As.getDefaultWidth=xAt;function wAt(e){return e.clientHeight===0?200:e.clientHeight}As.getDefaultHeight=wAt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _At=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},SAt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T$,"__esModule",{value:!0});const EAt=SAt(D0),Uye=As,$I=Ha;function CAt(e,t,n={}){return _At(this,void 0,void 0,function*(){const r=$I.getDrawArea(e),i=t,a=Object.assign({},AAt,n);if(M7.has(r)){const m=M7.get(r);if($I.shallowEquals(a,m.lastOptions)){yield $I.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:o,yLabel:s,xType:u,yType:l}=a;let c=null;o!=null&&(c={title:o});let f=null;s!=null&&(f={title:s});const d={actions:!1,mode:"vega-lite",defaultStyle:!1};let h;a.color!=null?Array.isArray(a.color)?h={field:"index",type:"nominal",scale:{range:a.color}}:h={value:a.color}:h={value:"#4C78A0"};const p={width:a.width||Uye.getDefaultWidth(r),height:a.height||Uye.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f},color:h}};yield $I.nextFrame();const g=yield EAt.default(r,p,d);M7.set(r,{view:g.view,lastOptions:a})})}T$.barchart=CAt;const AAt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},M7=new Map;var P7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var kAt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},TAt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(P7,"__esModule",{value:!0});const OAt=TAt(D0),Wye=As,IAt=Ha;function NAt(e,t,n={}){return kAt(this,void 0,void 0,function*(){const r=Object.assign({},DAt,n),i=IAt.getDrawArea(e),a=[],o=t.values,s=t.tickLabels||[],u=s.length===0;let l=!0;for(let h=0;h<o.length;h++){const p=u?`Class ${h}`:s[h];u&&s.push(p);for(let g=0;g<o[h].length;g++){const m=u?`Class ${g}`:s[g],v=o[h][g];h===g&&!r.shadeDiagonal?a.push({label:p,prediction:m,count:v,noFill:!0}):(a.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const h of a)h.noFill===!0&&(h.noFill=!1,h.scaleCount=h.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Wye.getDefaultWidth(i),height:r.height||Wye.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:a},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:s}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:s}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield OAt.default(i,f,c)})}P7.confusionMatrix=NAt;const DAt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var $7={},Qc={};Object.defineProperty(Qc,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vye(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}Qc.assert=Vye;function RAt(e,t,n=""){Vye(qye(e,t),n+` Shapes ${e} and ${t} must match`)}Qc.assertShapesMatch=RAt;function qye(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Qc.arraysEqual=qye,Qc.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hye=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},FAt=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},MAt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($7,"__esModule",{value:!0});const a2=FAt(cte),PAt=MAt(D0),Gye=As,o2=Qc,$At=Ha;function LAt(e,t,n={}){return Hye(this,void 0,void 0,function*(){const r=Object.assign({},zAt,n),i=$At.getDrawArea(e);let a=t.values;r.rowMajor&&(a=yield BAt(t.values));const{xTickLabels:o,yTickLabels:s}=t;o!=null&&Kye(a,o,0),s!=null&&Kye(a,s,1);const u="@tfidx@",l=[];if(a instanceof a2.Tensor){o2.assert(a.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield a.data(),[m,v]=a.shape;for(let y=0;y<m;y++){const b=o?`${o[y]}${u}${y}`:y;for(let x=0;x<v;x++){const w=s?`${s[x]}${u}${x}`:x,S=y*v+x,C=g[S];l.push({x:b,y:w,value:C})}}}else{const g=a;for(let m=0;m<g.length;m++){const v=o?`${o[m]}${u}${m}`:m;for(let y=0;y<g[m].length;y++){const b=s?`${s[y]}${u}${y}`:y,x=g[m][y];l.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Gye.getDefaultWidth(i),height:r.height||Gye.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:l},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${u}\\d+$`,h=new RegExp(d);o&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),s&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(o||s)&&(c.tooltip={sanitize:g=>String(g).replace(h,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield PAt.default(i,f,c)})}$7.heatmap=LAt;function BAt(e){return Hye(this,void 0,void 0,function*(){let t,n;e instanceof a2.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=a2.tidy(()=>a2.tensor2d(e).transpose())),o2.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return o2.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function Kye(e,t,n){const r=e instanceof a2.Tensor?e.shape:[e.length,e[0].length];n===0?o2.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&o2.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const zAt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var s2={},Xye=gh(CZe),zl={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var LI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(zl,"__esModule",{value:!0});const Ng=cte,lh=Qc;function jAt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?a+=1:isFinite(l)||(o+=1)}const s={numVals:t,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s}zl.arrayStats=jAt;function UAt(e){return LI(this,void 0,void 0,function*(){const[t,n,r]=Ng.tidy(()=>{const i=Ng.scalar(0,e.dtype),a=e.min(),o=e.max(),s=e.equal(i).sum();return[a,o,s]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,a,o,s])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const g=i[p];isNaN(g)?l+=1:isFinite(g)||(c+=1)}let f=a[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:s[0],numNans:l,min:f,max:d,numInfs:c}})})}zl.tensorStats=UAt;function WAt(e,t,n,r){return LI(this,void 0,void 0,function*(){lh.assert(e.rank===1,"labels must be a 1D tensor"),lh.assert(t.rank===1,"predictions must be a 1D tensor"),lh.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&lh.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),a=t.cast("int32");n==null&&(n=Ng.tidy(()=>Ng.maximum(i.max(),a.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),a.data(),o]).then(([s,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<s.length;f++){const d=s[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}zl.confusionMatrix=WAt;function VAt(e,t){return LI(this,void 0,void 0,function*(){lh.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Ng.dispose([n,r]),i})}zl.accuracy=VAt;function qAt(e,t,n){return LI(this,void 0,void 0,function*(){return lh.assert(e.rank===1,"labels must be a 1D tensor"),lh.assert(t.rank===1,"predictions must be a 1D tensor"),lh.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Ng.tidy(()=>Ng.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const a=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];a[l]+=1,l===c&&(o[l]+=1)}const s=[];for(let u=0;u<a.length;u++)s.push({count:a[u],accuracy:a[u]===0?0:o[u]/a[u]});return s})})}zl.perClassAccuracy=qAt;var $0={},L7="http://www.w3.org/1999/xhtml",B7={svg:"http://www.w3.org/2000/svg",xhtml:L7,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function z7(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),B7.hasOwnProperty(t)?{space:B7[t],local:e}:e}function HAt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===L7&&t.documentElement.namespaceURI===L7?t.createElement(e):t.createElementNS(n,e)}}function GAt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function BI(e){var t=z7(e);return(t.local?GAt:HAt)(t)}function KAt(){}function j7(e){return e==null?KAt:function(){return this.querySelector(e)}}function XAt(e){typeof e!="function"&&(e=j7(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=e.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new Ga(r,this._parents)}function YAt(){return[]}function Yye(e){return e==null?YAt:function(){return this.querySelectorAll(e)}}function ZAt(e){typeof e!="function"&&(e=Yye(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Ga(r,i)}var Zye=function(e){return function(){return this.matches(e)}};if(typeof document!="undefined"){var u2=document.documentElement;if(!u2.matches){var JAt=u2.webkitMatchesSelector||u2.msMatchesSelector||u2.mozMatchesSelector||u2.oMatchesSelector;Zye=function(e){return function(){return JAt.call(this,e)}}}}var Jye=Zye;function QAt(e){typeof e!="function"&&(e=Jye(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&e.call(u,u.__data__,l,a)&&s.push(u);return new Ga(r,this._parents)}function Qye(e){return new Array(e.length)}function ekt(){return new Ga(this._enter||this._groups.map(Qye),this._parents)}function zI(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zI.prototype={constructor:zI,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function tkt(e){return function(){return e}}var ebe="$";function nkt(e,t,n,r,i,a){for(var o=0,s,u=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new zI(e,a[o]);for(;o<u;++o)(s=t[o])&&(i[o]=s)}function rkt(e,t,n,r,i,a,o){var s,u,l={},c=t.length,f=a.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=ebe+o.call(u,u.__data__,s,t),h in l?i[s]=u:l[h]=u);for(s=0;s<f;++s)h=ebe+o.call(e,a[s],s,a),(u=l[h])?(r[s]=u,u.__data__=a[s],l[h]=null):n[s]=new zI(e,a[s]);for(s=0;s<c;++s)(u=t[s])&&l[d[s]]===u&&(i[s]=u)}function ikt(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?rkt:nkt,r=this._parents,i=this._groups;typeof e!="function"&&(e=tkt(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=o[l]=new Array(p),v=u[l]=new Array(d);n(c,f,g,m,v,h,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return o=new Ga(o,r),o._enter=s,o._exit=u,o}function akt(){return new Ga(this._exit||this._groups.map(Qye),this._parents)}function okt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=t[s],l=n[s],c=u.length,f=o[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)o[s]=t[s];return new Ga(o,this._parents)}function skt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&a!==o.nextSibling&&a.parentNode.insertBefore(o,a),a=o);return this}function ukt(e){e||(e=lkt);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Ga(i,this._parents).order()}function lkt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ckt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function fkt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function dkt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function hkt(){var e=0;return this.each(function(){++e}),e}function pkt(){return!this.node()}function gkt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function mkt(e){return function(){this.removeAttribute(e)}}function vkt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ykt(e,t){return function(){this.setAttribute(e,t)}}function bkt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function xkt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function wkt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function _kt(e,t){var n=z7(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?vkt:mkt:typeof t=="function"?n.local?wkt:xkt:n.local?bkt:ykt)(n,t))}function U7(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Skt(e){return function(){this.style.removeProperty(e)}}function Ekt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ckt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Akt(e,t,n){return arguments.length>1?this.each((t==null?Skt:typeof t=="function"?Ckt:Ekt)(e,t,n??"")):tbe(this.node(),e)}function tbe(e,t){return e.style.getPropertyValue(t)||U7(e).getComputedStyle(e,null).getPropertyValue(t)}function kkt(e){return function(){delete this[e]}}function Tkt(e,t){return function(){this[e]=t}}function Okt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ikt(e,t){return arguments.length>1?this.each((t==null?kkt:typeof t=="function"?Okt:Tkt)(e,t)):this.node()[e]}function nbe(e){return e.trim().split(/^|\s+/)}function W7(e){return e.classList||new rbe(e)}function rbe(e){this._node=e,this._names=nbe(e.getAttribute("class")||"")}rbe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ibe(e,t){for(var n=W7(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function abe(e,t){for(var n=W7(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Nkt(e){return function(){ibe(this,e)}}function Dkt(e){return function(){abe(this,e)}}function Rkt(e,t){return function(){(t.apply(this,arguments)?ibe:abe)(this,e)}}function Fkt(e,t){var n=nbe(e+"");if(arguments.length<2){for(var r=W7(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Rkt:t?Nkt:Dkt)(n,t))}function Mkt(){this.textContent=""}function Pkt(e){return function(){this.textContent=e}}function $kt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Lkt(e){return arguments.length?this.each(e==null?Mkt:(typeof e=="function"?$kt:Pkt)(e)):this.node().textContent}function Bkt(){this.innerHTML=""}function zkt(e){return function(){this.innerHTML=e}}function jkt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ukt(e){return arguments.length?this.each(e==null?Bkt:(typeof e=="function"?jkt:zkt)(e)):this.node().innerHTML}function Wkt(){this.nextSibling&&this.parentNode.appendChild(this)}function Vkt(){return this.each(Wkt)}function qkt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Hkt(){return this.each(qkt)}function Gkt(e){var t=typeof e=="function"?e:BI(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Kkt(){return null}function Xkt(e,t){var n=typeof e=="function"?e:BI(e),r=t==null?Kkt:typeof t=="function"?t:j7(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ykt(){var e=this.parentNode;e&&e.removeChild(this)}function Zkt(){return this.each(Ykt)}function Jkt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Qkt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function eTt(e){return this.select(e?Qkt:Jkt)}function tTt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var obe={},ef=null;if(typeof document!="undefined"){var nTt=document.documentElement;"onmouseenter"in nTt||(obe={mouseenter:"mouseover",mouseleave:"mouseout"})}function rTt(e,t,n){return e=sbe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function sbe(e,t,n){return function(r){var i=ef;ef=r;try{e.call(this,this.__data__,t,n)}finally{ef=i}}}function iTt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function aTt(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function oTt(e,t,n){var r=obe.hasOwnProperty(e.type)?rTt:sbe;return function(i,a,o){var s=this.__on,u,l=r(t,a,o);if(s){for(var c=0,f=s.length;c<f;++c)if((u=s[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},s?s.push(u):this.__on=[u]}}function sTt(e,t,n){var r=iTt(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?oTt:aTt,n==null&&(n=!1),i=0;i<a;++i)this.each(s(r[i],t,n));return this}function uTt(e,t,n,r){var i=ef;e.sourceEvent=ef,ef=e;try{return t.apply(n,r)}finally{ef=i}}function ube(e,t,n){var r=U7(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function lTt(e,t){return function(){return ube(this,e,t)}}function cTt(e,t){return function(){return ube(this,e,t.apply(this,arguments))}}function fTt(e,t){return this.each((typeof t=="function"?cTt:lTt)(e,t))}var V7=[null];function Ga(e,t){this._groups=e,this._parents=t}function lbe(){return new Ga([[document.documentElement]],V7)}Ga.prototype=lbe.prototype={constructor:Ga,select:XAt,selectAll:ZAt,filter:QAt,data:ikt,enter:ekt,exit:akt,merge:okt,order:skt,sort:ukt,call:ckt,nodes:fkt,node:dkt,size:hkt,empty:pkt,each:gkt,attr:_kt,style:Akt,property:Ikt,classed:Fkt,text:Lkt,html:Ukt,raise:Vkt,lower:Hkt,append:Gkt,insert:Xkt,remove:Zkt,clone:eTt,datum:tTt,on:sTt,dispatch:fTt};function cbe(e){return typeof e=="string"?new Ga([[document.querySelector(e)]],[document.documentElement]):new Ga([[e]],V7)}function dTt(e){return cbe(BI(e).call(document.documentElement))}var hTt=0;function fbe(){return new q7}function q7(){this._="@"+(++hTt).toString(36)}q7.prototype=fbe.prototype={constructor:q7,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function H7(){for(var e=ef,t;t=e.sourceEvent;)e=t;return e}function jI(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function pTt(e){var t=H7();return t.changedTouches&&(t=t.changedTouches[0]),jI(e,t)}function gTt(e){return typeof e=="string"?new Ga([document.querySelectorAll(e)],[document.documentElement]):new Ga([e??[]],V7)}function mTt(e,t,n){arguments.length<3&&(n=t,t=H7().changedTouches);for(var r=0,i=t?t.length:0,a;r<i;++r)if((a=t[r]).identifier===n)return jI(e,a);return null}function vTt(e,t){t==null&&(t=H7().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=jI(e,t[n]);return i}var yTt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:dTt,creator:BI,local:fbe,matcher:Jye,mouse:pTt,namespace:z7,namespaces:B7,clientPoint:jI,select:cbe,selectAll:gTt,selection:lbe,selector:j7,selectorAll:Yye,style:tbe,touch:mTt,touches:vTt,window:U7,get event(){return ef},customEvent:uTt}),bTt=gh(yTt);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty($0,"__esModule",{value:!0});const xTt=Xye,dbe=bTt,G7=Le,wTt=Ha;function _Tt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=wTt.getDrawArea(e),i=Object.assign({},STt,n);let a=dbe.select(r).select("table.tf-table");const o=G7.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(a.size()===0&&(a=dbe.select(r).append("table"),a.attr("class",` ${o} tf-table`),a.append("thead").append("tr"),a.append("tbody")),a.size()!==1)throw new Error("Error inserting table");const s=G7.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),u=a.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${s}`);u.merge(l).html(m=>m),u.exit().remove();const c=xTt.format(",.4~f"),f=a.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=G7.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(d).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${h}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}$0.table=_Tt;const STt={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ETt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},CTt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s2,"__esModule",{value:!0});const hbe=Xye,ATt=CTt(D0),UI=As,kTt=zl,TTt=$0,OTt={maxBins:12,fontSize:11};function ITt(e,t,n={}){return ETt(this,void 0,void 0,function*(){const r=DTt(t),i=Object.assign({},OTt,n),a={actions:!1,mode:"vega-lite",defaultStyle:!1},o=UI.subSurface(e,"histogram");if(n.stats!==!1){const l=UI.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=kTt.arrayStats(r.map(f=>f.value)),NTt(c,l,{fontSize:i.fontSize})}if(r.length===0)return;const s=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&s.push(r[l])}const u={width:i.width||UI.getDefaultWidth(o),height:i.height||UI.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:s},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return ATt.default(o,u,a)})}s2.histogram=ITt;function NTt(e,t,n){const r=hbe.format(",.4~f"),i=hbe.format(".4~p"),a=[],o=[];if(e.numVals!=null&&(a.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(a.push("Min"),o.push(r(e.min))),e.max!=null&&(a.push("Max"),o.push(r(e.max))),e.numZeros!=null){a.push("# Zeros");let s="";e.numVals&&(s=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${s}`)}if(e.numNans!=null){a.push("# NaNs");let s="";e.numVals&&(s=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${s}`)}if(e.numInfs!=null){a.push("# Infinity");let s="";e.numVals&&(s=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${s}`)}TTt.table(t,{headers:a,values:[o]},n)}function DTt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var WI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var RTt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},FTt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(WI,"__esModule",{value:!0});const MTt=FTt(D0),pbe=As,gbe=Qc,PTt=Ha;function $Tt(e,t,n={}){return RTt(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,a=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);gbe.assert(a.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&gbe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=[];for(let g=0;g<i;g++){const m={x:g};a.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),o.push(m)}const s=Object.assign({},LTt,n),u=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},l={x:{field:"x",type:s.xType,title:s.xLabel},tooltip:[{field:"x",type:"quantitative"},...a.map(g=>({field:g,type:"quantitative"}))]},c=a.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:s.yType,title:s.yLabel,scale:u()},color:{field:`${g}-name`,type:"nominal",legend:{values:a,title:null},scale:{range:s.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=PTt.getDrawArea(e),h={width:s.width||pbe.getDefaultWidth(d),height:s.height||pbe.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:o},encoding:l,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield MTt.default(d,h,p),Promise.resolve()})}WI.linechart=$Tt;const LTt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var K7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BTt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},zTt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(K7,"__esModule",{value:!0});const jTt=zTt(D0),mbe=As,UTt=Qc,WTt=Ha;function VTt(e,t,n={}){return BTt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const a=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,g=d.map(m=>Object.assign({},m,{series:p}));a.push(...g)}),n.seriesColors!=null&&UTt.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=WTt.getDrawArea(e),s=Object.assign({},qTt,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(s.zoomToFit)return{zero:!1};if(s.xAxisDomain!=null)return{domain:s.xAxisDomain}},c=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},f={width:s.width||mbe.getDefaultWidth(o),height:s.height||mbe.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:a},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:s.xType,title:s.xLabel,scale:l()},y:{field:"y",type:s.yType,title:s.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:s.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield jTt.default(o,f,u),Promise.resolve()})}K7.scatterplot=VTt;const qTt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var VI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(VI,"__esModule",{value:!0});const HTt=WI,X7=Ha,ybe=As;function bbe(e,t,n,r={}){return vbe(this,void 0,void 0,function*(){const i=X7.getDrawArea(e),a={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");xbe(a,c);const f=wbe(t,l,n.indexOf(l));a[c].series.push(l),a[c].values.push(f)}else{const c=wbe(t,l,n.indexOf(l));xbe(a,l),a[l].series.push(l),a[l].values.push(c)}const o=Object.keys(a),s=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=ybe.subSurface(i,l),f=a[l].series,d=a[l].values;f.every(p=>Boolean(p.match("acc")))&&(s.zoomToFitAccuracy?s.zoomToFit=!0:(s.yAxisDomain=[0,1],delete s.zoomToFit));const h=HTt.linechart(c,{values:d,series:f},s);u.push(h)}yield Promise.all(u)})}VI.history=bbe;function xbe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function wbe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let a=0;a<r.length;a++){const o=r[a];i.push({x:a,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function GTt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],a=X7.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function s(l){return(c,f)=>vbe(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const g of t)if(f[g]!=null){h.push(g);const m=KTt(r,l,g);m.push({[g]:f[g]}),d.push(m)}const p=ybe.subSurface(a,l,{title:l});bbe(p,d,h,o),yield X7.nextFrame()})}const u={};return i.forEach(l=>{u[l]=s(l)}),u}VI.fitCallbacks=GTt;function KTt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var qI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var HI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(qI,"__esModule",{value:!0});const XTt=s2,_be=Ha,Sbe=$0,Y7=As,YTt=zl;function ZTt(e,t){return HI(this,void 0,void 0,function*(){const n=_be.getDrawArea(e),r=QTt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],a=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);Sbe.table(n,{headers:i,values:a})})}qI.modelSummary=ZTt;function JTt(e,t){return HI(this,void 0,void 0,function*(){const n=_be.getDrawArea(e),r=yield tOt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],a=Y7.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);Sbe.table(a,{headers:i,values:o});const s=Y7.subSurface(n,"select-layer"),u=Y7.subSurface(n,"param-distribution"),l=c=>HI(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();XTt.histogram(u,d,{height:150,width:460,stats:!1})});nOt(r.map(c=>c.name),s,l)})}qI.layer=JTt;function QTt(e){return{layers:e.layers.map(eOt)}}function eOt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>Z7(r)).join(", ")}]`:t=Z7(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function tOt(e){return HI(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(YTt.tensorStats),i=yield Promise.all(r),a=t.map(o=>o.shape);return t.map((o,s)=>({name:n[s].name,stats:i[s],shape:Z7(a[s]),weight:o}))})}function Z7(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function nOt(e,t,n){const a=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=a;const o=t.querySelector("button"),s=t.querySelector("select");o.addEventListener("click",()=>{n(s.selectedOptions[0].label)})}var J7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var rOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(J7,"__esModule",{value:!0});const iOt=Ha,aOt=$0;function oOt(e,t,n){return rOt(this,void 0,void 0,function*(){const r=iOt.getDrawArea(e),i=["Class","Accuracy","# Samples"],a=[];for(let o=0;o<t.length;o++){const s=n?n[o]:o.toString(),u=t[o];a.push([s,u.accuracy,u.count])}return aOt.table(r,{headers:i,values:a})})}J7.perClassAccuracy=oOt;var Q7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Q7,"__esModule",{value:!0});const uOt=s2,lOt=Ha,cOt=zl;function fOt(e,t){return sOt(this,void 0,void 0,function*(){const n=lOt.getDrawArea(e),r=yield cOt.tensorStats(t),i=yield t.data();uOt.histogram(n,i,{height:150,stats:r})})}Q7.valuesDistribution=fOt;var eU={};/** @license See the LICENSE file. */Object.defineProperty(eU,"__esModule",{value:!0});const dOt="1.5.1";eU.version=dOt,function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=T$,r=P7,i=$7,a=s2,o=WI,s=K7,u=$0,l=VI,c=qI,f=J7,d=Q7,h=zl,p=eU;e.version_vis=p.version;const g={barchart:n.barchart,table:u.table,histogram:a.histogram,linechart:o.linechart,scatterplot:s.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=t2;e.visor=y.visor,t(e2)}(lte);var Ebe={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof uf=="function"&&uf;if(!c&&f)return f(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var g=r[l][1][p];return o(g||p)},h,h.exports,n,r,i,a)}return i[l].exports}for(var s=typeof uf=="function"&&uf,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,s;if(o){var u=0,l=new o(p),c=a.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var f=new a.MessageChannel;f.port1.onmessage=p,s=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?s=function(){var m=a.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:s=function(){setTimeout(p,0)};var d,h=[];function p(){d=!0;for(var m,v,y=h.length;y;){for(v=h,h=[],m=-1;++m<y;)v[m]();y=h.length}d=!1}r.exports=g;function g(m){h.push(m)===1&&!d&&s()}}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=f;function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,S){if(typeof w!="function"&&this.state===l||typeof S!="function"&&this.state===u)return this;var C=new this.constructor(o);if(this.state!==c){var _=this.state===l?w:S;h(C,_,this.outcome)}else this.queue.push(new d(C,w,S));return C};function d(w,S,C){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){s.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){s.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)};function h(w,S,C){a(function(){var _;try{_=S(C)}catch(E){return s.reject(w,E)}_===w?s.reject(w,new TypeError("Cannot resolve promise with itself")):s.resolve(w,_)})}s.resolve=function(w,S){var C=m(p,S);if(C.status==="error")return s.reject(w,C.value);var _=C.value;if(_)g(w,_);else{w.state=l,w.outcome=S;for(var E=-1,A=w.queue.length;++E<A;)w.queue[E].callFulfilled(S)}return w},s.reject=function(w,S){w.state=u,w.outcome=S;for(var C=-1,_=w.queue.length;++C<_;)w.queue[C].callRejected(S);return w};function p(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var C=!1;function _(T){C||(C=!0,s.reject(w,T))}function E(T){C||(C=!0,s.resolve(w,T))}function A(){S(E,_)}var k=m(A);k.status==="error"&&_(k.value)}function m(w,S){var C={};try{C.value=w(S),C.status="success"}catch(_){C.status="error",C.value=_}return C}f.resolve=v;function v(w){return w instanceof this?w:s.resolve(new this(o),w)}f.reject=y;function y(w){var S=new this(o);return s.reject(S,w)}f.all=b;function b(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=new Array(C),A=0,k=-1,T=new this(o);++k<C;)I(w[k],k);return T;function I(N,O){S.resolve(N).then(D,function(L){_||(_=!0,s.reject(T,L))});function D(L){E[O]=L,++A===C&&!_&&(_=!0,s.resolve(T,E))}}}f.race=x;function x(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=-1,A=new this(o);++E<C;)k(w[E]);return A;function k(T){S.resolve(T).then(function(I){_||(_=!0,s.resolve(A,I))},function(I){_||(_=!0,s.reject(A,I))})}}},{"1":1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z};function o(z,Z){if(!(z instanceof Z))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(z){return}}var u=s();function l(){try{if(!u||!u.open)return!1;var z=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Z=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!z||Z)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(q){return!1}}function c(z,Z){z=z||[],Z=Z||{};try{return new Blob(z,Z)}catch(te){if(te.name!=="TypeError")throw te;for(var q=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,re=new q,oe=0;oe<z.length;oe+=1)re.append(z[oe]);return re.getBlob(Z.type)}}typeof Promise=="undefined"&&n(3);var f=Promise;function d(z,Z){Z&&z.then(function(q){Z(null,q)},function(q){Z(q)})}function h(z,Z,q){typeof Z=="function"&&z.then(Z),typeof q=="function"&&z.catch(q)}function p(z){return typeof z!="string"&&(console.warn(z+" used as a key, but it is not a string."),z=String(z)),z}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",v=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function S(z){for(var Z=z.length,q=new ArrayBuffer(Z),re=new Uint8Array(q),oe=0;oe<Z;oe++)re[oe]=z.charCodeAt(oe);return q}function C(z){return new f(function(Z){var q=z.transaction(m,w),re=c([""]);q.objectStore(m).put(re,"key"),q.onabort=function(oe){oe.preventDefault(),oe.stopPropagation(),Z(!1)},q.oncomplete=function(){var oe=navigator.userAgent.match(/Chrome\/(\d+)/),te=navigator.userAgent.match(/Edge\//);Z(te||!oe||parseInt(oe[1],10)>=43)}}).catch(function(){return!1})}function _(z){return typeof v=="boolean"?f.resolve(v):C(z).then(function(Z){return v=Z,v})}function E(z){var Z=y[z.name],q={};q.promise=new f(function(re,oe){q.resolve=re,q.reject=oe}),Z.deferredOperations.push(q),Z.dbReady?Z.dbReady=Z.dbReady.then(function(){return q.promise}):Z.dbReady=q.promise}function A(z){var Z=y[z.name],q=Z.deferredOperations.pop();if(q)return q.resolve(),q.promise}function k(z,Z){var q=y[z.name],re=q.deferredOperations.pop();if(re)return re.reject(Z),re.promise}function T(z,Z){return new f(function(q,re){if(y[z.name]=y[z.name]||ce(),z.db)if(Z)E(z),z.db.close();else return q(z.db);var oe=[z.name];Z&&oe.push(z.version);var te=u.open.apply(u,oe);Z&&(te.onupgradeneeded=function(Ce){var Re=te.result;try{Re.createObjectStore(z.storeName),Ce.oldVersion<=1&&Re.createObjectStore(m)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+z.name+'" has been upgraded from version '+Ce.oldVersion+" to version "+Ce.newVersion+', but the storage "'+z.storeName+'" already exists.');else throw Fe}}),te.onerror=function(Ce){Ce.preventDefault(),re(te.error)},te.onsuccess=function(){q(te.result),A(z)}})}function I(z){return T(z,!1)}function N(z){return T(z,!0)}function O(z,Z){if(!z.db)return!0;var q=!z.db.objectStoreNames.contains(z.storeName),re=z.version<z.db.version,oe=z.version>z.db.version;if(re&&(z.version!==Z&&console.warn('The database "'+z.name+`" can't be downgraded from version `+z.db.version+" to version "+z.version+"."),z.version=z.db.version),oe||q){if(q){var te=z.db.version+1;te>z.version&&(z.version=te)}return!0}return!1}function D(z){return new f(function(Z,q){var re=new FileReader;re.onerror=q,re.onloadend=function(oe){var te=btoa(oe.target.result||"");Z({__local_forage_encoded_blob:!0,data:te,type:z.type})},re.readAsBinaryString(z)})}function L(z){var Z=S(atob(z.data));return c([Z],{type:z.type})}function W(z){return z&&z.__local_forage_encoded_blob}function G(z){var Z=this,q=Z._initReady().then(function(){var re=y[Z._dbInfo.name];if(re&&re.dbReady)return re.dbReady});return h(q,z,z),q}function K(z){E(z);for(var Z=y[z.name],q=Z.forages,re=0;re<q.length;re++){var oe=q[re];oe._dbInfo.db&&(oe._dbInfo.db.close(),oe._dbInfo.db=null)}return z.db=null,I(z).then(function(te){return z.db=te,O(z)?N(z):te}).then(function(te){z.db=Z.db=te;for(var Ce=0;Ce<q.length;Ce++)q[Ce]._dbInfo.db=te}).catch(function(te){throw k(z,te),te})}function ee(z,Z,q,re){re===void 0&&(re=1);try{var oe=z.db.transaction(z.storeName,Z);q(null,oe)}catch(te){if(re>0&&(!z.db||te.name==="InvalidStateError"||te.name==="NotFoundError"))return f.resolve().then(function(){if(!z.db||te.name==="NotFoundError"&&!z.db.objectStoreNames.contains(z.storeName)&&z.version<=z.db.version)return z.db&&(z.version=z.db.version+1),N(z)}).then(function(){return K(z).then(function(){ee(z,Z,q,re-1)})}).catch(q);q(te)}}function ce(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function he(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=z[re];var oe=y[q.name];oe||(oe=ce(),y[q.name]=oe),oe.forages.push(Z),Z._initReady||(Z._initReady=Z.ready,Z.ready=G);var te=[];function Ce(){return f.resolve()}for(var Re=0;Re<oe.forages.length;Re++){var Fe=oe.forages[Re];Fe!==Z&&te.push(Fe._initReady().catch(Ce))}var Pe=oe.forages.slice(0);return f.all(te).then(function(){return q.db=oe.db,I(q)}).then(function(je){return q.db=je,O(q,Z._defaultConfig.version)?N(q):je}).then(function(je){q.db=oe.db=je,Z._dbInfo=q;for(var it=0;it<Pe.length;it++){var Ft=Pe[it];Ft!==Z&&(Ft._dbInfo.db=q.db,Ft._dbInfo.version=q.version)}})}function Oe(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.get(z);Pe.onsuccess=function(){var je=Pe.result;je===void 0&&(je=null),W(je)&&(je=L(je)),oe(je)},Pe.onerror=function(){te(Pe.error)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function Te(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.openCursor(),je=1;Pe.onsuccess=function(){var it=Pe.result;if(it){var Ft=it.value;W(Ft)&&(Ft=L(Ft));var bn=z(Ft,it.key,je++);bn!==void 0?oe(bn):it.continue()}else oe()},Pe.onerror=function(){te(Pe.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function De(z,Z,q){var re=this;z=p(z);var oe=new f(function(te,Ce){var Re;re.ready().then(function(){return Re=re._dbInfo,b.call(Z)==="[object Blob]"?_(Re.db).then(function(Fe){return Fe?Z:D(Z)}):Z}).then(function(Fe){ee(re._dbInfo,w,function(Pe,je){if(Pe)return Ce(Pe);try{var it=je.objectStore(re._dbInfo.storeName);Fe===null&&(Fe=void 0);var Ft=it.put(Fe,z);je.oncomplete=function(){Fe===void 0&&(Fe=null),te(Fe)},je.onabort=je.onerror=function(){var bn=Ft.error?Ft.error:Ft.transaction.error;Ce(bn)}}catch(bn){Ce(bn)}})}).catch(Ce)});return d(oe,q),oe}function me(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,w,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.delete(z);Re.oncomplete=function(){oe()},Re.onerror=function(){te(Pe.error)},Re.onabort=function(){var je=Pe.error?Pe.error:Pe.transaction.error;te(je)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function P(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,w,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.clear();Ce.oncomplete=function(){re()},Ce.onabort=Ce.onerror=function(){var Pe=Fe.error?Fe.error:Fe.transaction.error;oe(Pe)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function F(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.count();Fe.onsuccess=function(){re(Fe.result)},Fe.onerror=function(){oe(Fe.error)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function V(z,Z){var q=this,re=new f(function(oe,te){if(z<0){oe(null);return}q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=!1,je=Fe.openKeyCursor();je.onsuccess=function(){var it=je.result;if(!it){oe(null);return}z===0||Pe?oe(it.key):(Pe=!0,it.advance(z))},je.onerror=function(){te(je.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function ae(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.openKeyCursor(),Pe=[];Fe.onsuccess=function(){var je=Fe.result;if(!je){re(Pe);return}Pe.push(je.key),je.continue()},Fe.onerror=function(){oe(Fe.error)}}catch(je){oe(je)}})}).catch(oe)});return d(q,z),q}function Y(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;if(!z.name)oe=f.reject("Invalid arguments");else{var te=z.name===q.name&&re._dbInfo.db,Ce=te?f.resolve(re._dbInfo.db):I(z).then(function(Re){var Fe=y[z.name],Pe=Fe.forages;Fe.db=Re;for(var je=0;je<Pe.length;je++)Pe[je]._dbInfo.db=Re;return Re});z.storeName?oe=Ce.then(function(Re){if(!!Re.objectStoreNames.contains(z.storeName)){var Fe=Re.version+1;E(z);var Pe=y[z.name],je=Pe.forages;Re.close();for(var it=0;it<je.length;it++){var Ft=je[it];Ft._dbInfo.db=null,Ft._dbInfo.version=Fe}var bn=new f(function(Cn,Dr){var dr=u.open(z.name,Fe);dr.onerror=function(Oi){var dh=dr.result;dh.close(),Dr(Oi)},dr.onupgradeneeded=function(){var Oi=dr.result;Oi.deleteObjectStore(z.storeName)},dr.onsuccess=function(){var Oi=dr.result;Oi.close(),Cn(Oi)}});return bn.then(function(Cn){Pe.db=Cn;for(var Dr=0;Dr<je.length;Dr++){var dr=je[Dr];dr._dbInfo.db=Cn,A(dr._dbInfo)}}).catch(function(Cn){throw(k(z,Cn)||f.resolve()).catch(function(){}),Cn})}}):oe=Ce.then(function(Re){E(z);var Fe=y[z.name],Pe=Fe.forages;Re.close();for(var je=0;je<Pe.length;je++){var it=Pe[je];it._dbInfo.db=null}var Ft=new f(function(bn,Cn){var Dr=u.deleteDatabase(z.name);Dr.onerror=Dr.onblocked=function(dr){var Oi=Dr.result;Oi&&Oi.close(),Cn(dr)},Dr.onsuccess=function(){var dr=Dr.result;dr&&dr.close(),bn(dr)}});return Ft.then(function(bn){Fe.db=bn;for(var Cn=0;Cn<Pe.length;Cn++){var Dr=Pe[Cn];A(Dr._dbInfo)}}).catch(function(bn){throw(k(z,bn)||f.resolve()).catch(function(){}),bn})})}return d(oe,Z),oe}var M={_driver:"asyncStorage",_initStorage:he,_support:l(),iterate:Te,getItem:Oe,setItem:De,removeItem:me,clear:P,length:F,key:V,keys:ae,dropInstance:Y};function B(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",ge=/^~~local_forage_type~([^~]+)~/,xe="__lfsc__:",ze=xe.length,Ke="arbf",Ze="blob",Bt="si08",Je="ui08",Zt="uic8",mn="si16",Hn="si32",ti="ur16",er="ui32",Dn="fl32",Jo="fl64",Ka=ze+Ke.length,jl=Object.prototype.toString;function ks(z){var Z=z.length*.75,q=z.length,re,oe=0,te,Ce,Re,Fe;z[z.length-1]==="="&&(Z--,z[z.length-2]==="="&&Z--);var Pe=new ArrayBuffer(Z),je=new Uint8Array(Pe);for(re=0;re<q;re+=4)te=R.indexOf(z[re]),Ce=R.indexOf(z[re+1]),Re=R.indexOf(z[re+2]),Fe=R.indexOf(z[re+3]),je[oe++]=te<<2|Ce>>4,je[oe++]=(Ce&15)<<4|Re>>2,je[oe++]=(Re&3)<<6|Fe&63;return Pe}function Ts(z){var Z=new Uint8Array(z),q="",re;for(re=0;re<Z.length;re+=3)q+=R[Z[re]>>2],q+=R[(Z[re]&3)<<4|Z[re+1]>>4],q+=R[(Z[re+1]&15)<<2|Z[re+2]>>6],q+=R[Z[re+2]&63];return Z.length%3==2?q=q.substring(0,q.length-1)+"=":Z.length%3==1&&(q=q.substring(0,q.length-2)+"=="),q}function Ul(z,Z){var q="";if(z&&(q=jl.call(z)),z&&(q==="[object ArrayBuffer]"||z.buffer&&jl.call(z.buffer)==="[object ArrayBuffer]")){var re,oe=xe;z instanceof ArrayBuffer?(re=z,oe+=Ke):(re=z.buffer,q==="[object Int8Array]"?oe+=Bt:q==="[object Uint8Array]"?oe+=Je:q==="[object Uint8ClampedArray]"?oe+=Zt:q==="[object Int16Array]"?oe+=mn:q==="[object Uint16Array]"?oe+=ti:q==="[object Int32Array]"?oe+=Hn:q==="[object Uint32Array]"?oe+=er:q==="[object Float32Array]"?oe+=Dn:q==="[object Float64Array]"?oe+=Jo:Z(new Error("Failed to get type for BinaryArray"))),Z(oe+Ts(re))}else if(q==="[object Blob]"){var te=new FileReader;te.onload=function(){var Ce=X+z.type+"~"+Ts(this.result);Z(xe+Ze+Ce)},te.readAsArrayBuffer(z)}else try{Z(JSON.stringify(z))}catch(Ce){console.error("Couldn't convert value into a JSON string: ",z),Z(null,Ce)}}function Wl(z){if(z.substring(0,ze)!==xe)return JSON.parse(z);var Z=z.substring(Ka),q=z.substring(ze,Ka),re;if(q===Ze&&ge.test(Z)){var oe=Z.match(ge);re=oe[1],Z=Z.substring(oe[0].length)}var te=ks(Z);switch(q){case Ke:return te;case Ze:return c([te],{type:re});case Bt:return new Int8Array(te);case Je:return new Uint8Array(te);case Zt:return new Uint8ClampedArray(te);case mn:return new Int16Array(te);case ti:return new Uint16Array(te);case Hn:return new Int32Array(te);case er:return new Uint32Array(te);case Dn:return new Float32Array(te);case Jo:return new Float64Array(te);default:throw new Error("Unkown type: "+q)}}var tf={serialize:Ul,deserialize:Wl,stringToBuffer:ks,bufferToString:Ts};function l2(z,Z,q,re){z.executeSql("CREATE TABLE IF NOT EXISTS "+Z.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,re)}function c2(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=typeof z[re]!="string"?z[re].toString():z[re];var oe=new f(function(te,Ce){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(Re){return Ce(Re)}q.db.transaction(function(Re){l2(Re,q,function(){Z._dbInfo=q,te()},function(Fe,Pe){Ce(Pe)})},Ce)});return q.serializer=tf,oe}function ku(z,Z,q,re,oe,te){z.executeSql(q,re,oe,function(Ce,Re){Re.code===Re.SYNTAX_ERR?Ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Z.storeName],function(Fe,Pe){Pe.rows.length?te(Fe,Re):l2(Fe,Z,function(){Fe.executeSql(q,re,oe,te)},te)},te):te(Ce,Re)},te)}function f2(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT * FROM "+Ce.storeName+" WHERE key = ? LIMIT 1",[z],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).value:null;je&&(je=Ce.serializer.deserialize(je)),oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function ch(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT * FROM "+Ce.storeName,[],function(Fe,Pe){for(var je=Pe.rows,it=je.length,Ft=0;Ft<it;Ft++){var bn=je.item(Ft),Cn=bn.value;if(Cn&&(Cn=Ce.serializer.deserialize(Cn)),Cn=z(Cn,bn.key,Ft+1),Cn!==void 0){oe(Cn);return}}oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function d2(z,Z,q,re){var oe=this;z=p(z);var te=new f(function(Ce,Re){oe.ready().then(function(){Z===void 0&&(Z=null);var Fe=Z,Pe=oe._dbInfo;Pe.serializer.serialize(Z,function(je,it){it?Re(it):Pe.db.transaction(function(Ft){ku(Ft,Pe,"INSERT OR REPLACE INTO "+Pe.storeName+" (key, value) VALUES (?, ?)",[z,je],function(){Ce(Fe)},function(bn,Cn){Re(Cn)})},function(Ft){if(Ft.code===Ft.QUOTA_ERR){if(re>0){Ce(d2.apply(oe,[z,Fe,q,re-1]));return}Re(Ft)}})})}).catch(Re)});return d(te,q),te}function Vl(z,Z,q){return d2.apply(this,[z,Z,q,1])}function GI(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"DELETE FROM "+Ce.storeName+" WHERE key = ?",[z],function(){oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function KI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"DELETE FROM "+te.storeName,[],function(){re()},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function XI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"SELECT COUNT(key) as c FROM "+te.storeName,[],function(Re,Fe){var Pe=Fe.rows.item(0).c;re(Pe)},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function YI(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT key FROM "+Ce.storeName+" WHERE id = ? LIMIT 1",[z+1],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).key:null;oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function ZI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"SELECT key FROM "+te.storeName,[],function(Re,Fe){for(var Pe=[],je=0;je<Fe.rows.length;je++)Pe.push(Fe.rows.item(je).key);re(Pe)},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function Os(z){return new f(function(Z,q){z.transaction(function(re){re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(oe,te){for(var Ce=[],Re=0;Re<te.rows.length;Re++)Ce.push(te.rows.item(Re).name);Z({db:z,storeNames:Ce})},function(oe,te){q(te)})},function(re){q(re)})})}function JI(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;return z.name?oe=new f(function(te){var Ce;z.name===q.name?Ce=re._dbInfo.db:Ce=openDatabase(z.name,"","",0),z.storeName?te({db:Ce,storeNames:[z.storeName]}):te(Os(Ce))}).then(function(te){return new f(function(Ce,Re){te.db.transaction(function(Fe){function Pe(bn){return new f(function(Cn,Dr){Fe.executeSql("DROP TABLE IF EXISTS "+bn,[],function(){Cn()},function(dr,Oi){Dr(Oi)})})}for(var je=[],it=0,Ft=te.storeNames.length;it<Ft;it++)je.push(Pe(te.storeNames[it]));f.all(je).then(function(){Ce()}).catch(function(bn){Re(bn)})},function(Fe){Re(Fe)})})}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var QI={_driver:"webSQLStorage",_initStorage:c2,_support:B(),iterate:ch,getItem:f2,setItem:Vl,removeItem:GI,clear:KI,length:XI,key:YI,keys:ZI,dropInstance:JI};function eN(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(z){return!1}}function h2(z,Z){var q=z.name+"/";return z.storeName!==Z.storeName&&(q+=z.storeName+"/"),q}function tN(){var z="_localforage_support_test";try{return localStorage.setItem(z,!0),localStorage.removeItem(z),!1}catch(Z){return!0}}function nf(){return!tN()||localStorage.length>0}function nN(z){var Z=this,q={};if(z)for(var re in z)q[re]=z[re];return q.keyPrefix=h2(z,Z._defaultConfig),nf()?(Z._dbInfo=q,q.serializer=tf,f.resolve()):f.reject()}function rN(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo.keyPrefix,oe=localStorage.length-1;oe>=0;oe--){var te=localStorage.key(oe);te.indexOf(re)===0&&localStorage.removeItem(te)}});return d(q,z),q}function iN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo,te=localStorage.getItem(oe.keyPrefix+z);return te&&(te=oe.serializer.deserialize(te)),te});return d(re,Z),re}function aN(z,Z){var q=this,re=q.ready().then(function(){for(var oe=q._dbInfo,te=oe.keyPrefix,Ce=te.length,Re=localStorage.length,Fe=1,Pe=0;Pe<Re;Pe++){var je=localStorage.key(Pe);if(je.indexOf(te)===0){var it=localStorage.getItem(je);if(it&&(it=oe.serializer.deserialize(it)),it=z(it,je.substring(Ce),Fe++),it!==void 0)return it}}});return d(re,Z),re}function oN(z,Z){var q=this,re=q.ready().then(function(){var oe=q._dbInfo,te;try{te=localStorage.key(z)}catch(Ce){te=null}return te&&(te=te.substring(oe.keyPrefix.length)),te});return d(re,Z),re}function rf(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo,oe=localStorage.length,te=[],Ce=0;Ce<oe;Ce++){var Re=localStorage.key(Ce);Re.indexOf(re.keyPrefix)===0&&te.push(Re.substring(re.keyPrefix.length))}return te});return d(q,z),q}function sN(z){var Z=this,q=Z.keys().then(function(re){return re.length});return d(q,z),q}function uN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo;localStorage.removeItem(oe.keyPrefix+z)});return d(re,Z),re}function lN(z,Z,q){var re=this;z=p(z);var oe=re.ready().then(function(){Z===void 0&&(Z=null);var te=Z;return new f(function(Ce,Re){var Fe=re._dbInfo;Fe.serializer.serialize(Z,function(Pe,je){if(je)Re(je);else try{localStorage.setItem(Fe.keyPrefix+z,Pe),Ce(te)}catch(it){(it.name==="QuotaExceededError"||it.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Re(it),Re(it)}})})});return d(oe,q),oe}function cN(z,Z){if(Z=g.apply(this,arguments),z=typeof z!="function"&&z||{},!z.name){var q=this.config();z.name=z.name||q.name,z.storeName=z.storeName||q.storeName}var re=this,oe;return z.name?oe=new f(function(te){z.storeName?te(h2(z,re._defaultConfig)):te(z.name+"/")}).then(function(te){for(var Ce=localStorage.length-1;Ce>=0;Ce--){var Re=localStorage.key(Ce);Re.indexOf(te)===0&&localStorage.removeItem(Re)}}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var fN={_driver:"localStorageWrapper",_initStorage:nN,_support:eN(),iterate:aN,getItem:iN,setItem:lN,removeItem:uN,clear:rN,length:sN,key:oN,keys:rf,dropInstance:cN},dN=function(Z,q){return Z===q||typeof Z=="number"&&typeof q=="number"&&isNaN(Z)&&isNaN(q)},L0=function(Z,q){for(var re=Z.length,oe=0;oe<re;){if(dN(Z[oe],q))return!0;oe++}return!1},p2=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"},Tu={},Dg={},af={INDEXEDDB:M,WEBSQL:QI,LOCALSTORAGE:fN},Rg=[af.INDEXEDDB._driver,af.WEBSQL._driver,af.LOCALSTORAGE._driver],fh=["dropInstance"],B0=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(fh),hN={description:"",driver:Rg.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function pN(z,Z){z[Z]=function(){var q=arguments;return z.ready().then(function(){return z[Z].apply(z,q)})}}function Fg(){for(var z=1;z<arguments.length;z++){var Z=arguments[z];if(Z)for(var q in Z)Z.hasOwnProperty(q)&&(p2(Z[q])?arguments[0][q]=Z[q].slice():arguments[0][q]=Z[q])}return arguments[0]}var gN=function(){function z(Z){o(this,z);for(var q in af)if(af.hasOwnProperty(q)){var re=af[q],oe=re._driver;this[q]=oe,Tu[oe]||this.defineDriver(re)}this._defaultConfig=Fg({},hN),this._config=Fg({},this._defaultConfig,Z),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return z.prototype.config=function(q){if((typeof q=="undefined"?"undefined":a(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var re in q){if(re==="storeName"&&(q[re]=q[re].replace(/\W/g,"_")),re==="version"&&typeof q[re]!="number")return new Error("Database version must be a number.");this._config[re]=q[re]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},z.prototype.defineDriver=function(q,re,oe){var te=new f(function(Ce,Re){try{var Fe=q._driver,Pe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){Re(Pe);return}for(var je=B0.concat("_initStorage"),it=0,Ft=je.length;it<Ft;it++){var bn=je[it],Cn=!L0(fh,bn);if((Cn||q[bn])&&typeof q[bn]!="function"){Re(Pe);return}}var Dr=function(){for(var dh=function(vN){return function(){var Mg=new Error("Method "+vN+" is not implemented by the current driver"),Pg=f.reject(Mg);return d(Pg,arguments[arguments.length-1]),Pg}},z0=0,j0=fh.length;z0<j0;z0++){var U0=fh[z0];q[U0]||(q[U0]=dh(U0))}};Dr();var dr=function(dh){Tu[Fe]&&console.info("Redefining LocalForage driver: "+Fe),Tu[Fe]=q,Dg[Fe]=dh,Ce()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(dr,Re):dr(!!q._support):dr(!0)}catch(Oi){Re(Oi)}});return h(te,re,oe),te},z.prototype.driver=function(){return this._driver||null},z.prototype.getDriver=function(q,re,oe){var te=Tu[q]?f.resolve(Tu[q]):f.reject(new Error("Driver not found."));return h(te,re,oe),te},z.prototype.getSerializer=function(q){var re=f.resolve(tf);return h(re,q),re},z.prototype.ready=function(q){var re=this,oe=re._driverSet.then(function(){return re._ready===null&&(re._ready=re._initDriver()),re._ready});return h(oe,q,q),oe},z.prototype.setDriver=function(q,re,oe){var te=this;p2(q)||(q=[q]);var Ce=this._getSupportedDrivers(q);function Re(){te._config.driver=te.driver()}function Fe(it){return te._extend(it),Re(),te._ready=te._initStorage(te._config),te._ready}function Pe(it){return function(){var Ft=0;function bn(){for(;Ft<it.length;){var Cn=it[Ft];return Ft++,te._dbInfo=null,te._ready=null,te.getDriver(Cn).then(Fe).catch(bn)}Re();var Dr=new Error("No available storage method found.");return te._driverSet=f.reject(Dr),te._driverSet}return bn()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=je.then(function(){var it=Ce[0];return te._dbInfo=null,te._ready=null,te.getDriver(it).then(function(Ft){te._driver=Ft._driver,Re(),te._wrapLibraryMethodsWithReady(),te._initDriver=Pe(Ce)})}).catch(function(){Re();var it=new Error("No available storage method found.");return te._driverSet=f.reject(it),te._driverSet}),h(this._driverSet,re,oe),this._driverSet},z.prototype.supports=function(q){return!!Dg[q]},z.prototype._extend=function(q){Fg(this,q)},z.prototype._getSupportedDrivers=function(q){for(var re=[],oe=0,te=q.length;oe<te;oe++){var Ce=q[oe];this.supports(Ce)&&re.push(Ce)}return re},z.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,re=B0.length;q<re;q++)pN(this,B0[q])},z.prototype.createInstance=function(q){return new z(q)},z}(),mN=new gN;r.exports=mN},{"3":3}]},{},[4])(4)})})(Ebe);var hOt=Ebe.exports;export{P3e as $,st as A,wa as B,FDe as C,SK as D,$De as E,MDe as F,PDe as G,Kwe as H,q_ as I,a1e as J,QDe as K,oRe as L,bK as M,tRe as N,W3e as O,CS as P,U3e as Q,rRe as R,FG as S,xRe as T,aRe as U,z3e as V,dRe as W,uRe as X,G_ as Y,le as Z,F3e as _,h3e as a,M3e as a0,L3e as a1,$3e as a2,hOt as a3,Lg as a4,Q1e as a5,Jke as a6,xK as b,_K as c,Vi as d,xje as e,SG as f,Uu as g,CBe as h,exe as i,a5e as j,lte as k,an as l,J1e as m,i1e as n,H3e as o,ABe as p,wRe as q,zf as r,pt as s,ERe as t,HU as u,ue as v,SRe as w,_Re as x,qt as y,CRe as z};
//# sourceMappingURL=vendor.314a901a.js.map
