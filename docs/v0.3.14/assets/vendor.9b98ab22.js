var Kb,Et,AV,Xb,kV,TV,OV,kS={},IV=[],h2e=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function gf(e,t){for(var n in t)e[n]=t[n];return e}function NV(e){var t=e.parentNode;t&&t.removeChild(e)}function pe(e,t,n){var r,i,a,o={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?Kb.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return Yb(e,o,r,i,null)}function Yb(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++AV};return Et.vnode!=null&&Et.vnode(a),a}function DV(){return{current:null}}function Zi(e){return e.children}function ru(e,t){this.props=e,this.context=t}function Ev(e,t){if(t==null)return e.__?Ev(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Ev(e):null}function RV(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return RV(e)}}function xR(e){(!e.__d&&(e.__d=!0)&&Xb.push(e)&&!TS.__r++||TV!==Et.debounceRendering)&&((TV=Et.debounceRendering)||kV)(TS)}function TS(){for(var e;TS.__r=Xb.length;)e=Xb.sort(function(t,n){return t.__v.__b-n.__v.__b}),Xb=[],e.some(function(t){var n,r,i,a,o,s;t.__d&&(o=(a=(n=t).__v).__e,(s=n.__P)&&(r=[],(i=gf({},a)).__v=a.__v+1,wR(s,a,i,n.__n,s.ownerSVGElement!==void 0,a.__h!=null?[o]:null,r,o??Ev(a),a.__h),zV(r,a),a.__e!=o&&RV(a)))})}function FV(e,t,n,r,i,a,o,s,u,l){var c,f,d,h,p,g,m,v=r&&r.__k||IV,y=v.length;for(n.__k=[],c=0;c<t.length;c++)if((h=n.__k[c]=(h=t[c])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?Yb(null,h,null,null,h):Array.isArray(h)?Yb(Zi,{children:h},null,null,null):h.__b>0?Yb(h.type,h.props,h.key,null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(d=v[c])===null||d&&h.key==d.key&&h.type===d.type)v[c]=void 0;else for(f=0;f<y;f++){if((d=v[f])&&h.key==d.key&&h.type===d.type){v[f]=void 0;break}d=null}wR(e,h,d=d||kS,i,a,o,s,u,l),p=h.__e,(f=h.ref)&&d.ref!=f&&(m||(m=[]),d.ref&&m.push(d.ref,null,h),m.push(f,h.__c||p,h)),p!=null?(g==null&&(g=p),typeof h.type=="function"&&h.__k!=null&&h.__k===d.__k?h.__d=u=MV(h,u,e):u=PV(e,h,d,v,p,u),l||n.type!=="option"?typeof n.type=="function"&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=Ev(d))}for(n.__e=g,c=y;c--;)v[c]!=null&&(typeof n.type=="function"&&v[c].__e!=null&&v[c].__e==n.__d&&(n.__d=Ev(r,c+1)),UV(v[c],v[c]));if(m)for(c=0;c<m.length;c++)jV(m[c],m[++c],m[++c])}function MV(e,t,n){var r,i;for(r=0;r<e.__k.length;r++)(i=e.__k[r])&&(i.__=e,t=typeof i.type=="function"?MV(i,t,n):PV(n,i,i,e.__k,i.__e,t));return t}function mf(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){mf(n,t)}):t.push(e)),t}function PV(e,t,n,r,i,a){var o,s,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break e;e.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function p2e(e,t,n,r,i){var a;for(a in n)a==="children"||a==="key"||a in t||OS(e,a,null,n[a],r);for(a in t)i&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||OS(e,a,t[a],n[a],r)}function $V(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||h2e.test(t)?n:n+"px"}function OS(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||$V(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||$V(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?BV:LV,a):e.removeEventListener(t,a?BV:LV,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch(o){}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function LV(e){this.l[e.type+!1](Et.event?Et.event(e):e)}function BV(e){this.l[e.type+!0](Et.event?Et.event(e):e)}function wR(e,t,n,r,i,a,o,s,u){var l,c,f,d,h,p,g,m,v,y,b,x=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,s=t.__e=n.__e,t.__h=null,a=[s]),(l=Et.__b)&&l(t);try{e:if(typeof x=="function"){if(m=t.props,v=(l=x.contextType)&&r[l.__c],y=l?v?v.props.value:l.__:r,n.__c?g=(c=t.__c=n.__c).__=c.__E:("prototype"in x&&x.prototype.render?t.__c=c=new x(m,y):(t.__c=c=new ru(m,y),c.constructor=x,c.render=m2e),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,f=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=gf({},c.__s)),gf(c.__s,x.getDerivedStateFromProps(m,c.__s))),d=c.props,h=c.state,f)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&m!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(m,y),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(m,c.__s,y)===!1||t.__v===n.__v){c.props=m,c.state=c.__s,t.__v!==n.__v&&(c.__d=!1),c.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(w){w&&(w.__=t)}),c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(m,c.__s,y),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,h,p)})}c.context=y,c.props=m,c.state=c.__s,(l=Et.__r)&&l(t),c.__d=!1,c.__v=t,c.__P=e,l=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(r=gf(gf({},r),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(p=c.getSnapshotBeforeUpdate(d,h)),b=l!=null&&l.type===Zi&&l.key==null?l.props.children:l,FV(e,Array.isArray(b)?b:[b],t,n,r,i,a,o,s,u),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=g2e(n.__e,t,n,r,i,a,o,u);(l=Et.diffed)&&l(t)}catch(w){t.__v=null,(u||a!=null)&&(t.__e=s,t.__h=!!u,a[a.indexOf(s)]=null),Et.__e(w,t,n)}}function zV(e,t){Et.__c&&Et.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){Et.__e(r,n.__v)}})}function g2e(e,t,n,r,i,a,o,s){var u,l,c,f=n.props,d=t.props,h=t.type,p=0;if(h==="svg"&&(i=!0),a!=null){for(;p<a.length;p++)if((u=a[p])&&(u===e||(h?u.localName==h:u.nodeType==3))){e=u,a[p]=null;break}}if(e==null){if(h===null)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,d.is&&d),a=null,s=!1}if(h===null)f===d||s&&e.data===d||(e.data=d);else{if(a=a&&Kb.call(e.childNodes),l=(f=n.props||kS).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(a!=null)for(f={},p=0;p<e.attributes.length;p++)f[e.attributes[p].name]=e.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(p2e(e,d,f,i,s),c)t.__k=[];else if(p=t.props.children,FV(e,Array.isArray(p)?p:[p],t,n,r,i&&h!=="foreignObject",a,o,a?a[0]:n.__k&&Ev(n,0),s),a!=null)for(p=a.length;p--;)a[p]!=null&&NV(a[p]);s||("value"in d&&(p=d.value)!==void 0&&(p!==e.value||h==="progress"&&!p)&&OS(e,"value",p,f.value,!1),"checked"in d&&(p=d.checked)!==void 0&&p!==e.checked&&OS(e,"checked",p,f.checked,!1))}return e}function jV(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){Et.__e(r,n)}}function UV(e,t,n){var r,i;if(Et.unmount&&Et.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||jV(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){Et.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&UV(r[i],t,typeof e.type!="function");n||e.__e==null||NV(e.__e),e.__e=e.__d=void 0}function m2e(e,t,n){return this.constructor(e,n)}function Cv(e,t,n){var r,i,a;Et.__&&Et.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],wR(t,e=(!r&&n||t).__k=pe(Zi,null,[e]),i||kS,kS,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?Kb.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r),zV(a,e)}function WV(e,t){Cv(e,t,WV)}function v2e(e,t,n){var r,i,a,o=gf({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?Kb.call(arguments,2):n),Yb(e.type,o,r||e.key,i||e.ref,null)}function Na(e,t){var n={__c:t="__cC"+OV++,__:e,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,a;return this.getChildContext||(i=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(xR)},this.sub=function(o){i.push(o);var s=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),s&&s.call(o)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Kb=IV.slice,Et={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(a){e=a}throw e}},AV=0,ru.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=gf({},this.state),typeof e=="function"&&(e=e(gf({},n),this.props)),e&&gf(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),xR(this))},ru.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),xR(this))},ru.prototype.render=Zi,Xb=[],kV=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,TS.__r=0,OV=0;var Yp,pa,VV,Av=0,_R=[],qV=Et.__b,HV=Et.__r,GV=Et.diffed,KV=Et.__c,XV=Et.unmount;function kv(e,t){Et.__h&&Et.__h(pa,e,Av||t),Av=0;var n=pa.__H||(pa.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function xn(e){return Av=1,IS(QV,e)}function IS(e,t,n){var r=kv(Yp++,2);return r.t=e,r.__c||(r.__=[n?n(t):QV(void 0,t),function(i){var a=r.t(r.__[0],i);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=pa),r.__}function an(e,t){var n=kv(Yp++,3);!Et.__s&&ER(n.__H,t)&&(n.__=e,n.__H=t,pa.__H.__h.push(n))}function vf(e,t){var n=kv(Yp++,4);!Et.__s&&ER(n.__H,t)&&(n.__=e,n.__H=t,pa.__h.push(n))}function cn(e){return Av=5,zr(function(){return{current:e}},[])}function YV(e,t,n){Av=6,vf(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function zr(e,t){var n=kv(Yp++,7);return ER(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function vt(e,t){return Av=8,zr(function(){return e},t)}function ir(e){var t=pa.context[e.__c],n=kv(Yp++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(pa)),t.props.value):e.__}function ZV(e,t){Et.useDebugValue&&Et.useDebugValue(t?t(e):e)}function y2e(e){var t=kv(Yp++,10),n=xn();return t.__=e,pa.componentDidCatch||(pa.componentDidCatch=function(r){t.__&&t.__(r),n[1](r)}),[n[0],function(){n[1](void 0)}]}function b2e(){_R.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(NS),e.__H.__h.forEach(SR),e.__H.__h=[]}catch(t){e.__H.__h=[],Et.__e(t,e.__v)}}),_R=[]}Et.__b=function(e){pa=null,qV&&qV(e)},Et.__r=function(e){HV&&HV(e),Yp=0;var t=(pa=e.__c).__H;t&&(t.__h.forEach(NS),t.__h.forEach(SR),t.__h=[])},Et.diffed=function(e){GV&&GV(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(_R.push(t)!==1&&VV===Et.requestAnimationFrame||((VV=Et.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),JV&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);JV&&(r=requestAnimationFrame(i))})(b2e)),pa=void 0},Et.__c=function(e,t){t.some(function(n){try{n.__h.forEach(NS),n.__h=n.__h.filter(function(r){return!r.__||SR(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],Et.__e(r,n.__v)}}),KV&&KV(e,t)},Et.unmount=function(e){XV&&XV(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(NS)}catch(n){Et.__e(n,t.__v)}};var JV=typeof requestAnimationFrame=="function";function NS(e){var t=pa;typeof e.__c=="function"&&e.__c(),pa=t}function SR(e){var t=pa;e.__c=e.__(),pa=t}function ER(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function QV(e,t){return typeof t=="function"?t(e):t}function eq(e,t){for(var n in t)e[n]=t[n];return e}function CR(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Zb(e){this.props=e}function AR(e,t){function n(i){var a=this.props.ref,o=a==i.ref;return!o&&a&&(a.call?a(null):a.current=null),t?!t(this.props,i)||!o:CR(this.props,i)}function r(i){return this.shouldComponentUpdate=n,pe(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(Zb.prototype=new ru).isPureReactComponent=!0,Zb.prototype.shouldComponentUpdate=function(e,t){return CR(this.props,e)||CR(this.state,t)};var tq=Et.__b;Et.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),tq&&tq(e)};var x2e=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Gl(e){function t(n,r){var i=eq({},n);return delete i.ref,e(i,(r=n.ref||r)&&(typeof r!="object"||"current"in r)?r:null)}return t.$$typeof=x2e,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var nq=function(e,t){return e==null?null:mf(mf(e).map(t))},Jb={map:nq,forEach:nq,count:function(e){return e?mf(e).length:0},only:function(e){var t=mf(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:mf},w2e=Et.__e;Et.__e=function(e,t,n){if(e.then){for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}w2e(e,t,n)};var rq=Et.unmount;function Qb(){this.__u=0,this.t=null,this.__b=null}function iq(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function aq(e){var t,n,r;function i(a){if(t||(t=e()).then(function(o){n=o.default||o},function(o){r=o}),r)throw r;if(!n)throw t;return pe(n,a)}return i.displayName="Lazy",i.__f=!0,i}function Tv(){this.u=null,this.o=null}Et.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),rq&&rq(e)},(Qb.prototype=new ru).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var i=iq(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__e){var l=r.state.__e;r.__v.__k[0]=function f(d,h,p){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(g){return f(g,h,p)}),d.__c&&d.__c.__P===h&&(d.__e&&p.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=p)),d}(l,l.__c.__P,l.__c.__O)}var c;for(r.setState({__e:r.__b=null});c=r.t.pop();)c.forceUpdate()}},u=t.__h===!0;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},Qb.prototype.componentWillUnmount=function(){this.t=[]},Qb.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(o,s,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),o.__c.__H=null),(o=eq({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=s),o.__c=null),o.__k=o.__k&&o.__k.map(function(l){return a(l,s,u)})),o}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&pe(Zi,null,e.fallback);return i&&(i.__h=null),[pe(Zi,null,t.__e?null:e.children),i]};var oq=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function _2e(e){return this.getChildContext=function(){return e.context},e.children}function S2e(e){var t=this,n=e.i;t.componentWillUnmount=function(){Cv(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Cv(pe(_2e,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function DS(e,t){return pe(S2e,{__v:e,i:t})}(Tv.prototype=new ru).__e=function(e){var t=this,n=iq(t.__v),r=t.o.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),oq(t,e,r)):i()};n?n(a):a()}},Tv.prototype.render=function(e){this.u=null,this.o=new Map;var t=mf(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Tv.prototype.componentDidUpdate=Tv.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){oq(e,n,t)})};var sq=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,E2e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,C2e=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function uq(e,t,n){return t.__k==null&&(t.textContent=""),Cv(e,t),typeof n=="function"&&n(),e?e.__c:null}function lq(e,t,n){return WV(e,t),typeof n=="function"&&n(),e?e.__c:null}ru.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(ru.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var cq=Et.event;function A2e(){}function k2e(){return this.cancelBubble}function T2e(){return this.defaultPrevented}Et.event=function(e){return cq&&(e=cq(e)),e.persist=A2e,e.isPropagationStopped=k2e,e.isDefaultPrevented=T2e,e.nativeEvent=e};var fq,dq={configurable:!0,get:function(){return this.class}},hq=Et.vnode;Et.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){for(var i in r={},n){var a=n[i];i==="value"&&"defaultValue"in n&&a==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&a===!0?a="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!C2e(n.type)?i="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(i)?i=i.toLowerCase():E2e.test(i)?i=i.replace(/[A-Z0-9]/,"-$&").toLowerCase():a===null&&(a=void 0),r[i]=a)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=mf(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=mf(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),e.props=r}t&&n.class!=n.className&&(dq.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",dq)),e.$$typeof=sq,hq&&hq(e)};var pq=Et.__r;Et.__r=function(e){pq&&pq(e),fq=e.__c};var gq={ReactCurrentDispatcher:{current:{readContext:function(e){return fq.__n[e.__c].props.value}}}},O2e="17.0.2";function mq(e){return pe.bind(null,e)}function Pd(e){return!!e&&e.$$typeof===sq}function yf(e){return Pd(e)?v2e.apply(null,arguments):e}function vq(e){return!!e.__k&&(Cv(null,e),!0)}function yq(e){return e&&(e.base||e.nodeType===1&&e)||null}var bq=function(e,t){return e(t)},xq=function(e,t){return e(t)},I2e=Zi,Jt={useState:xn,useReducer:IS,useEffect:an,useLayoutEffect:vf,useRef:cn,useImperativeHandle:YV,useMemo:zr,useCallback:vt,useContext:ir,useDebugValue:ZV,version:"17.0.2",Children:Jb,render:uq,hydrate:lq,unmountComponentAtNode:vq,createPortal:DS,createElement:pe,createContext:Na,createFactory:mq,cloneElement:yf,createRef:DV,Fragment:Zi,isValidElement:Pd,findDOMNode:yq,Component:ru,PureComponent:Zb,memo:AR,forwardRef:Gl,flushSync:xq,unstable_batchedUpdates:bq,StrictMode:Zi,Suspense:Qb,SuspenseList:Tv,lazy:aq,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:gq},N2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Jt,version:O2e,Children:Jb,render:uq,hydrate:lq,unmountComponentAtNode:vq,createPortal:DS,createFactory:mq,cloneElement:yf,isValidElement:Pd,findDOMNode:yq,PureComponent:Zb,memo:AR,forwardRef:Gl,flushSync:xq,unstable_batchedUpdates:bq,StrictMode:I2e,Suspense:Qb,SuspenseList:Tv,lazy:aq,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:gq,createElement:pe,createContext:Na,createRef:DV,Fragment:Zi,Component:ru,useState:xn,useReducer:IS,useEffect:an,useLayoutEffect:vf,useRef:cn,useImperativeHandle:YV,useMemo:zr,useCallback:vt,useContext:ir,useDebugValue:ZV,useErrorBoundary:y2e});const kR=(e,t)=>{const[n,r]=xn(TR()[1][e]||t);an(()=>{const a=o=>{const s=TR()[1];r(s[e])};return window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const i=vt((a,o)=>{const s=TR()[1];let u=!1;if(s.hasOwnProperty(e)&&a===null||a===void 0?(delete s[e],u=!0):s[e]!==a&&(s[e]=a,u=!0),!u)return[];const l=Object.keys(s);l.sort();const c=l.map((g,m)=>`${g}=${s[g]}`).join("&");let f=window.location.hash.substr(1);const d=f.indexOf("?");let h="";d>-1&&(h=f.substr(0,d));const p=new URL(window.location.href);p.hash=`${h}?${c}`,(o==null?void 0:o.modifyHistory)?window.location.hash=`${h}?${c}`:(window.history.replaceState(null,document.title,`${p.pathname}${p.search}${p.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},[]);return[n,i]},TR=()=>{let e=window.location.hash.substr(1);const t=e.indexOf("?");if(t===-1)return[e,{}];const n=e.substr(0,t);e=e.substr(t+1);const r=Object.fromEntries(e.split("&").filter(i=>i.length>0).map(i=>i.split("=")));return[n,r]},D2e=(e,t)=>{const[n,r]=kR(e,t?`${t}`:void 0),[i,a]=xn(n==="true");an(()=>{a(n==="true")},[e,n,a]);const o=vt((s,u)=>{s==null||s===!1?r(void 0,u):r("true",u)},[r]);return[i,o]},R2e=(e,t)=>{const[n,r]=kR(e,t?t.toString():void 0),[i,a]=xn(n?parseInt(n):void 0);an(()=>{a(n?parseInt(n):void 0)},[e,n,a]);const o=vt((s,u)=>{r(s?s.toString():void 0,u)},[r]);return[i,o]},wq=(e,t)=>{const[n,r]=kR(e,t?_q(t):void 0),[i,a]=xn(Sq(n));an(()=>{a(Sq(n))},[e,n,a]);const o=vt((s,u)=>{if(s==null)r(void 0,u);else{const l=_q(s);r(l,u)}},[r]);return[i,o]},_q=e=>btoa(JSON.stringify(e)),Sq=e=>{if(e&&e.length>0)try{return JSON.parse(atob(e))}catch(t){console.error(t)}};var lt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function F2e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function bf(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}function $d(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var M2e={},P2e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:M2e}),$2e=bf(P2e),L2e=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r],r);B2e(i)?n.push.apply(n,i):n.push(i)}return n},B2e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},z2e=Eq;function Eq(e,t,n){e instanceof RegExp&&(e=Cq(e,n)),t instanceof RegExp&&(t=Cq(t,n));var r=Aq(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function Cq(e,t){var n=t.match(e);return n?n[0]:null}Eq.range=Aq;function Aq(e,t,n){var r,i,a,o,s,u=n.indexOf(e),l=n.indexOf(t,u+1),c=u;if(u>=0&&l>0){if(e===t)return[u,l];for(r=[],a=n.length;c>=0&&!s;)c==u?(r.push(c),u=n.indexOf(e,c+1)):r.length==1?s=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,o=l),l=n.indexOf(t,c+1)),c=u<l&&u>=0?u:l;r.length&&(s=[a,o])}return s}var j2e=L2e,kq=z2e,U2e=q2e,Tq="\0SLASH"+Math.random()+"\0",Oq="\0OPEN"+Math.random()+"\0",OR="\0CLOSE"+Math.random()+"\0",Iq="\0COMMA"+Math.random()+"\0",Nq="\0PERIOD"+Math.random()+"\0";function IR(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function W2e(e){return e.split("\\\\").join(Tq).split("\\{").join(Oq).split("\\}").join(OR).split("\\,").join(Iq).split("\\.").join(Nq)}function V2e(e){return e.split(Tq).join("\\").split(Oq).join("{").split(OR).join("}").split(Iq).join(",").split(Nq).join(".")}function Dq(e){if(!e)return[""];var t=[],n=kq("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=Dq(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function q2e(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),Ov(W2e(e),!0).map(V2e)):[]}function H2e(e){return"{"+e+"}"}function G2e(e){return/^-?0\d/.test(e)}function K2e(e,t){return e<=t}function X2e(e,t){return e>=t}function Ov(e,t){var n=[],r=kq("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||a,s=r.body.indexOf(",")>=0;if(!o&&!s)return r.post.match(/,.*\}/)?(e=r.pre+"{"+r.body+OR+r.post,Ov(e)):[e];var u;if(o)u=r.body.split(/\.\./);else if(u=Dq(r.body),u.length===1&&(u=Ov(u[0],!1).map(H2e),u.length===1)){var c=r.post.length?Ov(r.post,!1):[""];return c.map(function(k){return r.pre+u[0]+k})}var l=r.pre,c=r.post.length?Ov(r.post,!1):[""],f;if(o){var d=IR(u[0]),h=IR(u[1]),p=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(IR(u[2])):1,m=K2e,v=h<d;v&&(g*=-1,m=X2e);var y=u.some(G2e);f=[];for(var b=d;m(b,h);b+=g){var x;if(a)x=String.fromCharCode(b),x==="\\"&&(x="");else if(x=String(b),y){var w=p-x.length;if(w>0){var S=new Array(w+1).join("0");b<0?x="-"+S+x.slice(1):x=S+x}}f.push(x)}}else f=j2e(u,function(A){return Ov(A,!1)});for(var C=0;C<f.length;C++)for(var _=0;_<c.length;_++){var E=l+f[C]+c[_];(!t||o||E)&&n.push(E)}return n}var Y2e=iu;iu.Minimatch=Ji;var e1={sep:"/"};try{e1=$2e}catch(e){}var NR=iu.GLOBSTAR=Ji.GLOBSTAR={},Z2e=U2e,Rq={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},DR="[^/]",RR=DR+"*?",J2e="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Q2e="(?:(?!(?:\\/|^)\\.).)*?",Fq=e_e("().*{}+?[]^$\\!");function e_e(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var Mq=/\/+/;iu.filter=t_e;function t_e(e,t){return t=t||{},function(n,r,i){return iu(n,e,t)}}function Pq(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(r){n[r]=t[r]}),Object.keys(e).forEach(function(r){n[r]=e[r]}),n}iu.defaults=function(e){if(!e||!Object.keys(e).length)return iu;var t=iu,n=function(i,a,o){return t.minimatch(i,a,Pq(e,o))};return n.Minimatch=function(i,a){return new t.Minimatch(i,Pq(e,a))},n},Ji.defaults=function(e){return!e||!Object.keys(e).length?Ji:iu.defaults(e).Minimatch};function iu(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new Ji(t,n).match(e)}function Ji(e,t){if(!(this instanceof Ji))return new Ji(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),e1.sep!=="/"&&(e=e.split(e1.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}Ji.prototype.debug=function(){},Ji.prototype.make=n_e;function n_e(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(r){return r.split(Mq)}),this.debug(this.pattern,n),n=n.map(function(r,i,a){return r.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}Ji.prototype.parseNegate=r_e;function r_e(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,a=e.length;i<a&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}iu.braceExpand=function(e,t){return $q(e,t)},Ji.prototype.braceExpand=$q;function $q(e,t){if(t||(this instanceof Ji?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:Z2e(e)}Ji.prototype.parse=i_e;var RS={};function i_e(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return NR;if(e==="")return"";var r="",i=!!n.nocase,a=!1,o=[],s=[],u,l=!1,c=-1,f=-1,d=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function p(){if(u){switch(u){case"*":r+=RR,i=!0;break;case"?":r+=DR,i=!0;break;default:r+="\\"+u;break}h.debug("clearStateChar %j %j",u,r),u=!1}}for(var g=0,m=e.length,v;g<m&&(v=e.charAt(g));g++){if(this.debug("%s	%s %s %j",e,g,r,v),a&&Fq[v]){r+="\\"+v,a=!1;continue}switch(v){case"/":return!1;case"\\":p(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,g,r,v),l){this.debug("  in class"),v==="!"&&g===f+1&&(v="^"),r+=v;continue}h.debug("call clearStateChar %j",u),p(),u=v,n.noext&&p();continue;case"(":if(l){r+="(";continue}if(!u){r+="\\(";continue}o.push({type:u,start:g-1,reStart:r.length,open:Rq[u].open,close:Rq[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(l||!o.length){r+="\\)";continue}p(),i=!0;var y=o.pop();r+=y.close,y.type==="!"&&s.push(y),y.reEnd=r.length;continue;case"|":if(l||!o.length||a){r+="\\|",a=!1;continue}p(),r+="|";continue;case"[":if(p(),l){r+="\\"+v;continue}l=!0,f=g,c=r.length,r+=v;continue;case"]":if(g===f+1||!l){r+="\\"+v,a=!1;continue}if(l){var b=e.substring(f+1,g);try{RegExp("["+b+"]")}catch(X){var x=this.parse(b,RS);r=r.substr(0,c)+"\\["+x[0]+"\\]",i=i||x[1],l=!1;continue}}i=!0,l=!1,r+=v;continue;default:p(),a?a=!1:Fq[v]&&!(v==="^"&&l)&&(r+="\\"),r+=v}}for(l&&(b=e.substr(f+1),x=this.parse(b,RS),r=r.substr(0,c)+"\\["+x[0],i=i||x[1]),y=o.pop();y;y=o.pop()){var w=r.slice(y.reStart+y.open.length);this.debug("setting tail",r,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(X,Q,me){return me||(me="\\"),Q+Q+me+"|"}),this.debug(`tail=%j
   %s`,w,w,y,r);var S=y.type==="*"?RR:y.type==="?"?DR:"\\"+y.type;i=!0,r=r.slice(0,y.reStart)+S+"\\("+w}p(),a&&(r+="\\\\");var C=!1;switch(r.charAt(0)){case".":case"[":case"(":C=!0}for(var _=s.length-1;_>-1;_--){var E=s[_],A=r.slice(0,E.reStart),k=r.slice(E.reStart,E.reEnd-8),T=r.slice(E.reEnd-8,E.reEnd),I=r.slice(E.reEnd);T+=I;var N=A.split("(").length-1,O=I;for(g=0;g<N;g++)O=O.replace(/\)[+*?]?/,"");I=O;var D="";I===""&&t!==RS&&(D="$");var P=A+k+I+D+T;r=P}if(r!==""&&i&&(r="(?=.)"+r),C&&(r=d+r),t===RS)return[r,i];if(!i)return s_e(e);var V=n.nocase?"i":"";try{var Y=new RegExp("^"+r+"$",V)}catch(X){return new RegExp("$.")}return Y._glob=e,Y._src=r,Y}iu.makeRe=function(e,t){return new Ji(e,t||{}).makeRe()},Ji.prototype.makeRe=a_e;function a_e(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?RR:t.dot?J2e:Q2e,r=t.nocase?"i":"",i=e.map(function(a){return a.map(function(o){return o===NR?n:typeof o=="string"?u_e(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(a){this.regexp=!1}return this.regexp}iu.match=function(e,t,n){n=n||{};var r=new Ji(t,n);return e=e.filter(function(i){return r.match(i)}),r.options.nonull&&!e.length&&e.push(t),e},Ji.prototype.match=o_e;function o_e(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;e1.sep!=="/"&&(e=e.split(e1.sep).join("/")),e=e.split(Mq),this.debug(this.pattern,"split",e);var r=this.set;this.debug(this.pattern,"set",r);var i,a;for(a=e.length-1;a>=0&&(i=e[a],!i);a--);for(a=0;a<r.length;a++){var o=r[a],s=e;n.matchBase&&o.length===1&&(s=[i]);var u=this.matchOne(s,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}Ji.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,a=0,o=e.length,s=t.length;i<o&&a<s;i++,a++){this.debug("matchOne loop");var u=t[a],l=e[i];if(this.debug(t,u,l),u===!1)return!1;if(u===NR){this.debug("GLOBSTAR",[t,u,l]);var c=i,f=a+1;if(f===s){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}for(;c<o;){var d=e[c];if(this.debug(`
globstar while`,e,c,t,f,d),this.matchOne(e.slice(c),t.slice(f),n))return this.debug("globstar found match!",c,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,c,t,f);break}this.debug("globstar swallow a segment, and continue"),c++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,c,t,f),c===o))}var h;if(typeof u=="string"?(r.nocase?h=l.toLowerCase()===u.toLowerCase():h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===o&&a===s)return!0;if(i===o)return n;if(a===s){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function s_e(e){return e.replace(/\\(.)/g,"$1")}function u_e(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var FS;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(FS||(FS={}));var Wu;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(Wu||(Wu={}));const Lq=Object.keys(FS);FS.V0_4;const Bq=Object.keys(Wu),MS=Wu.V0_3;var on;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(on||(on={}));var ro;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(ro||(ro={}));var xf;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(xf||(xf={}));var FR;(function(e){e.State="metapage/state"})(FR||(FR={}));const Kl="metapage/definition",Ld="metapage/state",zq=Bq[Bq.length-1],l_e=Lq[Lq.length-1];var t1={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(lt,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function r(f,d){return f.indexOf(d)===-1?f.length:f.indexOf(d)}function i(f){var d=f.replace(/^v/,"").replace(/\+.*$/,""),h=r(d,"-"),p=d.substring(0,h).split(".");return p.push(d.substring(h+1)),p}function a(f){return isNaN(Number(f))?f:Number(f)}function o(f){if(typeof f!="string")throw new TypeError("Invalid argument expected string");if(!n.test(f))throw new Error("Invalid argument not valid semver ('"+f+"' received)")}function s(f,d){[f,d].forEach(o);for(var h=i(f),p=i(d),g=0;g<Math.max(h.length-1,p.length-1);g++){var m=parseInt(h[g]||0,10),v=parseInt(p[g]||0,10);if(m>v)return 1;if(v>m)return-1}var y=h[h.length-1],b=p[p.length-1];if(y&&b){var x=y.split(".").map(a),w=b.split(".").map(a);for(g=0;g<Math.max(x.length,w.length);g++){if(x[g]===void 0||typeof w[g]=="string"&&typeof x[g]=="number")return-1;if(w[g]===void 0||typeof x[g]=="string"&&typeof w[g]=="number"||x[g]>w[g])return 1;if(w[g]>x[g])return-1}}else if(y||b)return y?-1:1;return 0}var u=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function c(f){if(typeof f!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof f);if(u.indexOf(f)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return s.validate=function(f){return typeof f=="string"&&n.test(f)},s.compare=function(f,d,h){c(h);var p=s(f,d);return l[h].indexOf(p)>-1},s})})(t1);var PS={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,f||u,d),p=n?n+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount==0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},s.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,d,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,d),!0;case 5:return m.fn.call(m.context,c,f,d,h),!0;case 6:return m.fn.call(m.context,c,f,d,h,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var x=m.length,w;for(b=0;b<x;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,f);break;case 4:m[b].fn.call(m[b].context,c,f,d);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];m[b].fn.apply(m[b].context,y)}}return!0},s.prototype.on=function(l,c,f){return a(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return a(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,d){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!d||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||f&&p[g].context!==f)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(PS);var $S;(function(e){e.mp_debug="mp_debug"})($S||($S={}));const c_e=()=>{try{return window!==window.top}catch(e){return!1}};class f_e extends PS.exports.EventEmitter{constructor(){super();this._definition={version:Wu.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var d_e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};const jq=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch(n){throw`Cannot parse into JSON:
${e}`}let t;switch(p_e(e.version)){case Wu.V0_2:{t=jq(h_e(e));break}case Wu.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${MS}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},h_e=e=>(e.version=Wu.V0_3,e),LS=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(r=>{n=!0,t[r]===void 0?delete e[r]:e[r]=t[r]}),n},p_e=e=>{if(e=="latest")return MS;if(t1.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return t1.exports.compare(e,"0.2",">=")&&t1.exports.compare(e,Wu.V0_3,"<")?Wu.V0_2:t1.exports.compare(e,"0.3",">=")?Wu.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${MS}`),MS)},MR=()=>{const e=new URLSearchParams(window.location.search).get($S.mp_debug);return e==="true"||e==="1"},g_e=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,m_e=(e=8)=>v_e(e),Uq="abcdefghijklmnopqrstuvwxyz0123456789",v_e=(e=8)=>{for(var t="",n=Uq.length,r=0;r<e;r++)t+=Uq.charAt(Math.floor(Math.random()*n));return t},PR=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let r;if(typeof e=="string"?r=e:typeof e=="number"?r=e+"":r=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var i=`color: #${t}`;n&&(i=`${i}; background: #${n}`),r=`%c${r}`,window.console.log(r,i)}else window.console.log(r)},Wq=e=>b_e(y_e(e)),y_e=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},b_e=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},$R=()=>document.readyState=="complete"||document.readyState=="interactive",LR=()=>d_e(void 0,void 0,void 0,function*(){return $R()?Promise.resolve():new Promise(e=>{if($R()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&$R()&&(t=!0,e())},200)})});var Vq=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};class qq extends PS.exports.EventEmitter{constructor(t,n,r,i,a,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var s=new URL(this.url);o&&s.searchParams.set($S.mp_debug,"true"),this.url=s.href,this.id=r,this._debug=o,this._parentId=i,this._color=Wq(this.id),this._consoleBackgroundColor=a,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(l=>{LR().then(()=>Vq(this,void 0,void 0,function*(){if(u._iframe){const c=yield u.getDefinition();if(!u._iframe)return;(c==null?void 0:c.allow)&&(u._iframe.allow=c.allow),u._iframe.src=this.url,l(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Ld]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Kl]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return Vq(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const r=yield n.json();return this._definition=r,this._definition}else this.emit(on.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(on.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var r={};r[t]=n,this.setInputs(r)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!LS(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(on.Inputs,this.inputs),this._metapage.listenerCount(on.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(on.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){if(!!LS(this.outputs,t)&&(this.emit(on.Outputs,t),this._metapage.listenerCount(on.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(on.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(on.Inputs,t)}onInput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(on.Inputs,r)}onOutputs(t){return this.addListenerReturnDisposer(on.Outputs,t)}onOutput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(on.Outputs,r)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:zq};this.sendRpcInternal(xf.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(xf.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const r=this;this._onLoaded.push(()=>{r.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(xf.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),PR(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const r={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(r):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(r).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(r=>n._iframe.contentWindow.postMessage(r,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var x_e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},Hq;(function(e){e.all="all",e.delta="delta"})(Hq||(Hq={}));const Gq=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),w_e="bcbcbc";class Vu extends f_e{constructor(t){super();this._state=Gq(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=MR(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:m_e(),this._consoleBackgroundColor=t&&t.color?t.color:w_e,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),LR().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch(i){throw"Cannot parse into JSON:\n${metaPageDef}"}var r=new Vu;return r.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=g_e(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(on.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const r=jq(t);return r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(r.plugins&&r.plugins.includes(i))throw this.emitErrorMessage(`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var a=r.metaframes[i];if(typeof a!="object")throw this.emitErrorMessage(`Metaframe "${i}" is not an object`),`Metaframe "${i}" is not an object`;if(!a.url)throw this.emitErrorMessage(`Metaframe "${i}" missing field: url`),`Metaframe "${i}" missing field: url`}),this._definition=r,Object.keys(this._metaframes).forEach(i=>{(!r.metaframes||!r.metaframes[i])&&this.removeMetaframe(i)}),Object.keys(this._plugins).forEach(i=>{r.plugins&&!r.plugins.includes(i)&&this.removePlugin(i)}),this._pluginOrder=r.plugins?r.plugins:[],n&&(this._state=n),r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(!this._metaframes.hasOwnProperty(i)){const a=r.metaframes[i];this.addMetaframe(i,a)}}),r.plugins&&r.plugins.forEach(i=>{this._plugins.hasOwnProperty(i)||this.addPlugin(i)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(on.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(on.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var r;const i=this._inputMap[n];let a=0;for(;a<=i.length;)((r=i[a])===null||r===void 0?void 0:r.metaframe)===t?i.splice(a,1):a++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=Gq(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var r=new qq(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=r,r.addListener(on.Error,i=>{this.emit(on.Error,{metaframeId:r.id,metaframeUrl:r.url,error:i})}),n.inputs&&n.inputs.forEach(i=>this.addPipe(t,i)),r.setInputs(this._state.metaframes.inputs[t]),r}addPlugin(t){if(!t)throw"Plugin missing url";const n=new qq(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return __e(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,r){!this.debug||this.logInternal(t,n,r)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(on.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var r=[];this._cachedInputLookupMap[t][n]=r,Object.keys(this._inputMap).forEach(i=>{i!==t&&this._inputMap[i].forEach(a=>{if(a.metaframe==t&&Y2e(n,a.source)){var o=a.target;(!a.target||a.target.startsWith("*")||a.target==="")&&(o=n),r.push({metaframe:i,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case ro.SetupIframeClientRequest:return!0;default:var r=t.iframeId;return!(r&&!(t.parentId===this._id&&(this._metaframes[r]||this._plugins[r])))}}setInput(t,n,r){this.setInputStateOnly(t,n,r),this.setMetaframeClientInputAndSentClientEvent(t,n,r),this.emit(on.State,this._state),this.emit(on.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,r){if(typeof t=="object"){if(n||r)throw"bad arguments, see API docs";const i=t;Object.keys(i).forEach(a=>{var o=a,s=i[o];if(typeof s!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(s):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const i=this._metaframes[t];if(i==null&&this.error(`No iframe id=${t}`),typeof n=="string")i.setInput(n,r);else if(typeof n=="object")i.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,r){this.setInput(t,n,r)}setOutputStateOnly(t,n,r){this._setStateOnly(!1,t,n,r)}setInputStateOnly(t,n,r){this._setStateOnly(!0,t,n,r)}_setStateOnly(t,n,r,i){if(typeof n=="object"){if(r||i)throw"If first argument is an object, subsequent args should be undefined";const a=n;Object.keys(a).forEach(o=>{var s=a[o];if(typeof s!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const l=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;l[o]=l[o]?l[o]:{},Object.keys(s).forEach(c=>{s[c]===void 0?delete l[o][c]:l[o][c]=s[c]})})}else if(typeof n=="string"){const a=n,o=this._metaframes.hasOwnProperty(a);if(!o&&!this._plugins.hasOwnProperty(a))throw`No metaframe or plugin: ${a}`;const s=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof r=="string"){s[a]=s[a]?s[a]:{};const u=r;i===void 0?delete s[a][u]:s[a][u]=i}else if(typeof r=="object"){s[a]=s[a]?s[a]:{};const u=r;Object.keys(u).forEach(l=>{u[l]===void 0?delete s[a][l]:s[a][l]=u[l]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const s=o.iframeId;if(!s)return;const u=this.getMetaframeOrPlugin(s),l=this._plugins[s];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case ro.SetupIframeClientRequest:u&&u.register();break;case ro.SetupIframeServerResponseAck:if(u){const f=o.params;u.registered(f.version)}break;case ro.OutputsUpdate:const c=o.params;if(this._metaframes[s]){var r=this._metaframes[s];this.setOutputStateOnly(s,c),r.setOutputs(c),this.emit(on.State,this._state);var i=!1;const f=Object.keys(c),d={};f.forEach((h,p)=>{const g=this.getInputsFromOutput(s,h);g.length>0&&g.forEach(m=>{d[m.metaframe]||(d[m.metaframe]={}),d[m.metaframe][m.pipe]=c[h],this.setInputStateOnly(m.metaframe,m.pipe,c[h]),i=!0})}),Object.keys(d).forEach(h=>{this._metaframes[h].setInputs(d[h])}),i&&this.emit(on.State,this._state),this.debug&&r.ack({jsonrpc:o,state:this._state})}else if(this._plugins[s]){const f=!c[Ld]&&!c[Kl];f&&this.setOutputStateOnly(s,c),this._plugins[s].setOutputs(c),f&&this.emit(on.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case ro.InputsUpdate:var a=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(a)} from ${s}`),this._metaframes[s])this.setInputStateOnly(s,a),this._metaframes[s].setInputs(a),this.emit(on.State,this._state),this.debug&&this._metaframes[s].ack({jsonrpc:o,state:this._state});else if(this._plugins[s]){const f=!a[Ld]&&!a[Kl];f&&this.setInputStateOnly(s,a),this._plugins[s].setInputs(a),f&&this.emit(on.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`);break;case ro.PluginRequest:l&&u&&u.hasPermissionsState()&&(u.setInput(Ld,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case ro.HashParamsUpdate:if(!l&&u){const f=o.params,d=new URL(u.url);d.hash=f.hash,u.url=d.href,this._definition.metaframes[f.metaframe].url=d.href,this.emit(on.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(on.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&S_e(t)})}logInternal(t,n,r){r=r||this._consoleBackgroundColor;let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),i=this._id?`Metapage[${this._id}] ${i}`:i,PR(i,n,r)}}Vu.version=zq,Vu.DEFINITION=on.Definition,Vu.DEFINITION_UPDATE_REQUEST=on.DefinitionUpdateRequest,Vu.ERROR=on.Error,Vu.INPUTS=on.Inputs,Vu.MESSAGE=on.Message,Vu.OUTPUTS=on.Outputs,Vu.STATE=on.State,Vu.URL_HASH_UPDATE=on.UrlHashUpdate;const __e=(e,t)=>x_e(void 0,void 0,void 0,function*(){try{const i=yield t.getDefinition();if(!i)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(on.Definition,a=>{t.setInput(Kl,a.definition)});t._disposables.push(n);var r=e.getDefinition();if(r&&(t.setInput(Kl,r),i.outputs)){var n=t.onOutput(Kl,o=>{e.emit(on.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&i.outputs){var n=t.onOutput(Ld,o=>{e.setState(o)});t._disposables.push(n)}}catch(i){console.error(i),e.emit(on.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${i}`)}}),S_e=e=>{const t=e._metapage.getDefinition();e.setInput(Kl,t)};var E_e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},Bd;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(Bd||(Bd={}));var Qi;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(Qi||(Qi={}));class qu extends PS.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=Bd.WaitingForPageLoad,this._messageSendCount=0,this.debug=MR(),this.id=window.name,this.debug=MR(),this._isIframe=c_e(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;LR().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(ro.SetupIframeClientRequest,{version:qu.version}),n._state=Bd.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===Bd.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=Wq(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=Bd.Ready,this.sendRpc(ro.SetupIframeServerResponseAck,{version:qu.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(Qi.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(Qi.Input,n,this._inputPipeValues[n]))),this.emit(Qi.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new C_e(this)),this.emit(Qi.Connected))}connected(){return E_e(this,void 0,void 0,function*(){if(this._state!==Bd.Ready)return new Promise((t,n)=>{let r;r=this.addListenerReturnDisposer(Qi.Connected,()=>{t(),r()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,r){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,r){let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),n=n&&n+"",i=(this.id?`Metaframe[${this.id}] `:"")+`${i}`,PR(i,n,r)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===Qi.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(Qi.Input,(r,i)=>{t===r&&n(i)})}onInputs(t){return this.addListenerReturnDisposer(Qi.Inputs,t)}setInput(t,n){var r={};r[t]=n,this.setInputs(r)}setInputs(t){this.sendRpc(ro.InputsUpdate,t)}setInternalInputsAndNotify(t){!LS(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(Qi.Input,n,t[n])),this.emit(Qi.Inputs,t))}getInput(t){return console.assert(t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(t),this._outputPipeValues[t]}setOutput(t,n){console.assert(t),console.assert(n);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){!LS(this._outputPipeValues,t)||this.sendRpc(ro.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(ro.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const r={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(r,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let r=t.data;if(r.jsonrpc==="2.0"){var n=r.method;if(!(n==xf.SetupIframeServerResponse||r.parentId==this._parentId&&r.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${r.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${r.iframeId} id=${this.id}`);return}switch(n){case xf.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(r.params);break;case xf.InputsUpdate:if(this._state!==Bd.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(r.params.inputs);break;case xf.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(r)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(r)}`);break}this.emit(Qi.Message,r)}}}}qu.version=l_e,qu.ERROR=Qi.Error,qu.CONNECTED=Qi.Connected,qu.INPUT=Qi.Input,qu.INPUTS=Qi.Inputs,qu.MESSAGE=Qi.Message;class C_e{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:FR.State};this._metaframe.sendRpc(ro.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(Ld,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(Ld)}setState(t){this._metaframe.setOutput(Ld,t)}onDefinition(t){var n=this._metaframe.onInput(Kl,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(Kl,t)}getDefinition(){return this._metaframe.getInput(Kl)}}const A_e={inputs:{}},Kq=Na(A_e),k_e=()=>ir(Kq),T_e=e=>{const[t,n]=xn({inputs:{}}),[r,i]=xn(void 0),[a,o]=xn(t.inputs);return an(()=>{const s=new qu,u=l=>{o(l)};return s.onInputs(u),i(s),()=>{s.removeListener(qu.INPUTS,u),s.dispose()}},[i,o]),an(()=>{a&&r&&n({metaframe:r,inputs:a,setOutputs:r.setOutputs})},[a,r]),Jt.createElement(Kq.Provider,{value:t},e.children)},O_e=()=>{try{return window!==window.top}catch(e){return!1}};function I_e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function N_e(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Xq=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?a=r.prepend?r.container.firstChild:r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(N_e(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=I_e(i);try{a.insertRule(r,a.cssRules.length)}catch(o){}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Da="-ms-",BS="-moz-",Hn="-webkit-",Yq="comm",BR="rule",zR="decl",D_e="@import",R_e="@keyframes",F_e=Math.abs,zS=String.fromCharCode;function M_e(e,t){return(((t<<2^zo(e,0))<<2^zo(e,1))<<2^zo(e,2))<<2^zo(e,3)}function Zq(e){return e.trim()}function P_e(e,t){return(e=t.exec(e))?e[0]:e}function ar(e,t,n){return e.replace(t,n)}function Jq(e,t){return e.indexOf(t)}function zo(e,t){return e.charCodeAt(t)|0}function n1(e,t,n){return e.slice(t,n)}function Xl(e){return e.length}function jR(e){return e.length}function jS(e,t){return t.push(e),e}function $_e(e,t){return e.map(t).join("")}var US=1,Iv=1,Qq=0,ws=0,xi=0,Nv="";function WS(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:US,column:Iv,length:o,return:""}}function r1(e,t,n){return WS(e,t.root,t.parent,n,t.props,t.children,0)}function L_e(){return xi}function B_e(){return xi=ws>0?zo(Nv,--ws):0,Iv--,xi===10&&(Iv=1,US--),xi}function au(){return xi=ws<Qq?zo(Nv,ws++):0,Iv++,xi===10&&(Iv=1,US++),xi}function wf(){return zo(Nv,ws)}function VS(){return ws}function qS(e,t){return n1(Nv,e,t)}function HS(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function eH(e){return US=Iv=1,Qq=Xl(Nv=e),ws=0,[]}function tH(e){return Nv="",e}function UR(e){return Zq(qS(ws-1,WR(e===91?e+2:e===40?e+1:e)))}function z_e(e){for(;(xi=wf())&&xi<33;)au();return HS(e)>2||HS(xi)>3?"":" "}function j_e(e,t){for(;--t&&au()&&!(xi<48||xi>102||xi>57&&xi<65||xi>70&&xi<97););return qS(e,VS()+(t<6&&wf()==32&&au()==32))}function WR(e){for(;au();)switch(xi){case e:return ws;case 34:case 39:return WR(e===34||e===39?e:xi);case 40:e===41&&WR(e);break;case 92:au();break}return ws}function U_e(e,t){for(;au()&&e+xi!==47+10;)if(e+xi===42+42&&wf()===47)break;return"/*"+qS(t,ws-1)+"*"+zS(e===47?e:au())}function nH(e){for(;!HS(wf());)au();return qS(e,ws)}function W_e(e){return tH(GS("",null,null,null,[""],e=eH(e),0,[0],e))}function GS(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,f=o,d=0,h=0,p=0,g=1,m=1,v=1,y=0,b="",x=i,w=a,S=r,C=b;m;)switch(p=y,y=au()){case 34:case 39:case 91:case 40:C+=UR(y);break;case 9:case 10:case 13:case 32:C+=z_e(p);break;case 92:C+=j_e(VS()-1,7);continue;case 47:switch(wf()){case 42:case 47:jS(V_e(U_e(au(),VS()),t,n),u);break;default:C+="/"}break;case 123*g:s[l++]=Xl(C)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:h>0&&Xl(C)-f&&jS(h>32?iH(C+";",r,n,f-1):iH(ar(C," ","")+";",r,n,f-2),u);break;case 59:C+=";";default:if(jS(S=rH(C,t,n,l,c,i,s,b,x=[],w=[],f),a),y===123)if(c===0)GS(C,t,S,S,x,a,f,s,w);else switch(d){case 100:case 109:case 115:GS(e,S,S,r&&jS(rH(e,S,S,0,0,i,s,b,i,x=[],f),w),i,w,f,s,r?x:w);break;default:GS(C,S,S,S,[""],w,f,s,w)}}l=c=h=0,g=v=1,b=C="",f=o;break;case 58:f=1+Xl(C),h=p;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&B_e()==125)continue}switch(C+=zS(y),y*g){case 38:v=c>0?1:(C+="\f",-1);break;case 44:s[l++]=(Xl(C)-1)*v,v=1;break;case 64:wf()===45&&(C+=UR(au())),d=wf(),c=Xl(b=C+=nH(VS())),y++;break;case 45:p===45&&Xl(C)==2&&(g=0)}}return a}function rH(e,t,n,r,i,a,o,s,u,l,c){for(var f=i-1,d=i===0?a:[""],h=jR(d),p=0,g=0,m=0;p<r;++p)for(var v=0,y=n1(e,f+1,f=F_e(g=o[p])),b=e;v<h;++v)(b=Zq(g>0?d[v]+" "+y:ar(y,/&\f/g,d[v])))&&(u[m++]=b);return WS(e,t,n,i===0?BR:s,u,l,c)}function V_e(e,t,n){return WS(e,t,n,Yq,zS(L_e()),n1(e,2,-2),0)}function iH(e,t,n,r){return WS(e,t,n,zR,n1(e,0,r),n1(e,r+1,-1),r)}function aH(e,t){switch(M_e(e,t)){case 5103:return Hn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Hn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Hn+e+BS+e+Da+e+e;case 6828:case 4268:return Hn+e+Da+e+e;case 6165:return Hn+e+Da+"flex-"+e+e;case 5187:return Hn+e+ar(e,/(\w+).+(:[^]+)/,Hn+"box-$1$2"+Da+"flex-$1$2")+e;case 5443:return Hn+e+Da+"flex-item-"+ar(e,/flex-|-self/,"")+e;case 4675:return Hn+e+Da+"flex-line-pack"+ar(e,/align-content|flex-|-self/,"")+e;case 5548:return Hn+e+Da+ar(e,"shrink","negative")+e;case 5292:return Hn+e+Da+ar(e,"basis","preferred-size")+e;case 6060:return Hn+"box-"+ar(e,"-grow","")+Hn+e+Da+ar(e,"grow","positive")+e;case 4554:return Hn+ar(e,/([^-])(transform)/g,"$1"+Hn+"$2")+e;case 6187:return ar(ar(ar(e,/(zoom-|grab)/,Hn+"$1"),/(image-set)/,Hn+"$1"),e,"")+e;case 5495:case 3959:return ar(e,/(image-set\([^]*)/,Hn+"$1$`$1");case 4968:return ar(ar(e,/(.+:)(flex-)?(.*)/,Hn+"box-pack:$3"+Da+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Hn+e+e;case 4095:case 3583:case 4068:case 2532:return ar(e,/(.+)-inline(.+)/,Hn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xl(e)-1-t>6)switch(zo(e,t+1)){case 109:if(zo(e,t+4)!==45)break;case 102:return ar(e,/(.+:)(.+)-([^]+)/,"$1"+Hn+"$2-$3$1"+BS+(zo(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Jq(e,"stretch")?aH(ar(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(zo(e,t+1)!==115)break;case 6444:switch(zo(e,Xl(e)-3-(~Jq(e,"!important")&&10))){case 107:return ar(e,":",":"+Hn)+e;case 101:return ar(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Hn+(zo(e,14)===45?"inline-":"")+"box$3$1"+Hn+"$2$3$1"+Da+"$2box$3")+e}break;case 5936:switch(zo(e,t+11)){case 114:return Hn+e+Da+ar(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Hn+e+Da+ar(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Hn+e+Da+ar(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Hn+e+Da+e+e}return e}function i1(e,t){for(var n="",r=jR(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function q_e(e,t,n,r){switch(e.type){case D_e:case zR:return e.return=e.return||e.value;case Yq:return"";case BR:e.value=e.props.join(",")}return Xl(n=i1(e.children,r))?e.return=e.value+"{"+n+"}":""}function H_e(e){var t=jR(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}function G_e(e){return function(t){t.root||(t=t.return)&&e(t)}}function K_e(e,t,n,r){if(!e.return)switch(e.type){case zR:e.return=aH(e.value,e.length);break;case R_e:return i1([r1(ar(e.value,"@","@"+Hn),e,"")],r);case BR:if(e.length)return $_e(e.props,function(i){switch(P_e(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return i1([r1(ar(i,/:(read-\w+)/,":"+BS+"$1"),e,"")],r);case"::placeholder":return i1([r1(ar(i,/:(plac\w+)/,":"+Hn+"input-$1"),e,""),r1(ar(i,/:(plac\w+)/,":"+BS+"$1"),e,""),r1(ar(i,/:(plac\w+)/,Da+"input-$1"),e,"")],r)}return""})}}var oH=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function sH(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var X_e=function(t,n){var r=-1,i=44;do switch(HS(i)){case 0:i===38&&wf()===12&&(n[r]=1),t[r]+=nH(ws-1);break;case 2:t[r]+=UR(i);break;case 4:if(i===44){t[++r]=wf()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=zS(i)}while(i=au());return t},Y_e=function(t,n){return tH(X_e(eH(t),n))},uH=new WeakMap,Z_e=function(t){if(!(t.type!=="rule"||!t.parent||!t.length)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!uH.get(r))&&!i){uH.set(t,!0);for(var a=[],o=Y_e(n,a),s=r.props,u=0,l=0;u<o.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=a[u]?o[u].replace(/&\f/g,s[c]):s[c]+" "+o[u]}}},J_e=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}},Q_e=[K_e],eSe=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||Q_e,a={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),v=1;v<m.length;v++)a[m[v]]=!0;s.push(g)});var u,l=[Z_e,J_e];{var c,f=[q_e,G_e(function(g){c.insert(g)})],d=H_e(l.concat(i,f)),h=function(m){return i1(W_e(m),d)};u=function(m,v,y,b){c=y,h(m?m+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new Xq({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:a,registered:{},insert:u};return p.sheet.hydrate(s),p};function Zp(){return Zp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zp.apply(this,arguments)}var lH={exports:{}},or={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ea=typeof Symbol=="function"&&Symbol.for,VR=ea?Symbol.for("react.element"):60103,qR=ea?Symbol.for("react.portal"):60106,KS=ea?Symbol.for("react.fragment"):60107,XS=ea?Symbol.for("react.strict_mode"):60108,YS=ea?Symbol.for("react.profiler"):60114,ZS=ea?Symbol.for("react.provider"):60109,JS=ea?Symbol.for("react.context"):60110,HR=ea?Symbol.for("react.async_mode"):60111,QS=ea?Symbol.for("react.concurrent_mode"):60111,eE=ea?Symbol.for("react.forward_ref"):60112,tE=ea?Symbol.for("react.suspense"):60113,tSe=ea?Symbol.for("react.suspense_list"):60120,nE=ea?Symbol.for("react.memo"):60115,rE=ea?Symbol.for("react.lazy"):60116,nSe=ea?Symbol.for("react.block"):60121,rSe=ea?Symbol.for("react.fundamental"):60117,iSe=ea?Symbol.for("react.responder"):60118,aSe=ea?Symbol.for("react.scope"):60119;function _s(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case VR:switch(e=e.type,e){case HR:case QS:case KS:case YS:case XS:case tE:return e;default:switch(e=e&&e.$$typeof,e){case JS:case eE:case rE:case nE:case ZS:return e;default:return t}}case qR:return t}}}function cH(e){return _s(e)===QS}or.AsyncMode=HR,or.ConcurrentMode=QS,or.ContextConsumer=JS,or.ContextProvider=ZS,or.Element=VR,or.ForwardRef=eE,or.Fragment=KS,or.Lazy=rE,or.Memo=nE,or.Portal=qR,or.Profiler=YS,or.StrictMode=XS,or.Suspense=tE,or.isAsyncMode=function(e){return cH(e)||_s(e)===HR},or.isConcurrentMode=cH,or.isContextConsumer=function(e){return _s(e)===JS},or.isContextProvider=function(e){return _s(e)===ZS},or.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===VR},or.isForwardRef=function(e){return _s(e)===eE},or.isFragment=function(e){return _s(e)===KS},or.isLazy=function(e){return _s(e)===rE},or.isMemo=function(e){return _s(e)===nE},or.isPortal=function(e){return _s(e)===qR},or.isProfiler=function(e){return _s(e)===YS},or.isStrictMode=function(e){return _s(e)===XS},or.isSuspense=function(e){return _s(e)===tE},or.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===KS||e===QS||e===YS||e===XS||e===tE||e===tSe||typeof e=="object"&&e!==null&&(e.$$typeof===rE||e.$$typeof===nE||e.$$typeof===ZS||e.$$typeof===JS||e.$$typeof===eE||e.$$typeof===rSe||e.$$typeof===iSe||e.$$typeof===aSe||e.$$typeof===nSe)},or.typeOf=_s,lH.exports=or;var fH=lH.exports,oSe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},sSe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dH={};dH[fH.ForwardRef]=oSe,dH[fH.Memo]=sSe;var uSe=!0;function lSe(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var hH=function(t,n,r){var i=t.key+"-"+n.name;if((r===!1||uSe===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles),t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function cSe(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var fSe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},dSe=/[A-Z]|^ms/g,hSe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,pH=function(t){return t.charCodeAt(1)===45},gH=function(t){return t!=null&&typeof t!="boolean"},GR=sH(function(e){return pH(e)?e:e.replace(dSe,"-$&").toLowerCase()}),mH=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(hSe,function(r,i,a){return Yl={name:i,styles:a,next:Yl},i})}return fSe[t]!==1&&!pH(t)&&typeof n=="number"&&n!==0?n+"px":n};function a1(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Yl={name:n.name,styles:n.styles,next:Yl},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Yl={name:r.name,styles:r.styles,next:Yl},r=r.next;var i=n.styles+";";return i}return pSe(e,t,n)}case"function":{if(e!==void 0){var a=Yl,o=n(e);return Yl=a,a1(e,t,o)}break}}if(t==null)return n;var s=t[n];return s!==void 0?s:n}function pSe(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=a1(e,t,n[i])+";";else for(var a in n){var o=n[a];if(typeof o!="object")t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":gH(o)&&(r+=GR(a)+":"+mH(a,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var s=0;s<o.length;s++)gH(o[s])&&(r+=GR(a)+":"+mH(a,o[s])+";");else{var u=a1(e,t,o);switch(a){case"animation":case"animationName":{r+=GR(a)+":"+u+";";break}default:r+=a+"{"+u+"}"}}}return r}var vH=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Yl,KR=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";Yl=void 0;var o=t[0];o==null||o.raw===void 0?(i=!1,a+=a1(r,n,o)):a+=o[0];for(var s=1;s<t.length;s++)a+=a1(r,n,t[s]),i&&(a+=o[s]);vH.lastIndex=0;for(var u="",l;(l=vH.exec(a))!==null;)u+="-"+l[1];var c=cSe(a)+u;return{name:c,styles:a,next:Yl}},yH=Na(typeof HTMLElement!="undefined"?eSe({key:"css"}):null);yH.Provider;var bH=function(t){return Gl(function(n,r){var i=ir(yH);return t(n,i,r)})},o1=Na({}),gSe=function(t,n){if(typeof n=="function"){var r=n(t);return r}return Zp({},t,n)},mSe=oH(function(e){return oH(function(t){return gSe(e,t)})}),vSe=function(t){var n=ir(o1);return t.theme!==n&&(n=mSe(n)(t.theme)),pe(o1.Provider,{value:n},t.children)},XR=bH(function(e,t){var n=e.styles,r=KR([n],void 0,typeof n=="function"||Array.isArray(n)?ir(o1):void 0),i=cn();return vf(function(){var a=t.key+"-global",o=new Xq({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",a),o.hydrate([u])),i.current=[o,s],function(){o.flush()}},[t]),vf(function(){var a=i.current,o=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&hH(t,r.next,!0),o.tags.length){var u=o.tags[o.tags.length-1].nextElementSibling;o.before=u,o.flush()}t.insert("",r,o,!1)},[t,r.name]),null});function ySe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KR(t)}var xH=function(){var t=ySe.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},bSe=()=>pe(XR,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;      
        -moz-osx-font-smoothing: grayscale; 
        touch-action: manipulation; 
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
        vertical-align: middle;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }
    `}),xSe=bSe;function wSe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function zd(e){return typeof e=="number"}function YR(e){return Array.isArray(e)}function wH(e){return typeof e=="function"}function Zl(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")&&!YR(e)}function _Se(e){return Zl(e)&&Object.keys(e).length===0}function _H(e){return e==null}function ZR(e){return Object.prototype.toString.call(e)==="[object String]"}function SH(e){return/^var\(--.+\)$/.test(e)}var iE=!1,JR={exports:{}};(function(e,t){var n=200,r="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",y="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",C="[object Undefined]",_="[object WeakMap]",E="[object ArrayBuffer]",A="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",I="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",D="[object Uint8Array]",P="[object Uint8ClampedArray]",V="[object Uint16Array]",Y="[object Uint32Array]",X=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,ce={};ce[k]=ce[T]=ce[I]=ce[N]=ce[O]=ce[D]=ce[P]=ce[V]=ce[Y]=!0,ce[s]=ce[u]=ce[E]=ce[c]=ce[A]=ce[f]=ce[d]=ce[h]=ce[g]=ce[m]=ce[y]=ce[x]=ce[w]=ce[S]=ce[_]=!1;var Ne=typeof lt=="object"&&lt&&lt.Object===Object&&lt,Oe=typeof self=="object"&&self&&self.Object===Object&&self,$e=Ne||Oe||Function("return this")(),ve=t&&!t.nodeType&&t,$=ve&&!0&&e&&!e.nodeType&&e,F=$&&$.exports===ve,q=F&&Ne.process,ue=function(){try{var K=$&&$.require&&$.require("util").types;return K||q&&q.binding&&q.binding("util")}catch(oe){}}(),J=ue&&ue.isTypedArray;function L(K,oe,be){switch(be.length){case 0:return K.call(oe);case 1:return K.call(oe,be[0]);case 2:return K.call(oe,be[0],be[1]);case 3:return K.call(oe,be[0],be[1],be[2])}return K.apply(oe,be)}function z(K,oe){for(var be=-1,nt=Array(K);++be<K;)nt[be]=oe(be);return nt}function R(K){return function(oe){return K(oe)}}function Z(K,oe){return K==null?void 0:K[oe]}function xe(K,oe){return function(be){return K(oe(be))}}var Ee=Array.prototype,Me=Function.prototype,Ve=Object.prototype,Je=$e["__core-js_shared__"],Ft=Me.toString,et=Ve.hasOwnProperty,Gt=function(){var K=/[^.]+$/.exec(Je&&Je.keys&&Je.keys.IE_PROTO||"");return K?"Symbol(src)_1."+K:""}(),rn=Ve.toString,kn=Ft.call(Object),Br=RegExp("^"+Ft.call(et).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jn=F?$e.Buffer:void 0,_n=$e.Symbol,Xi=$e.Uint8Array,kr=Jn?Jn.allocUnsafe:void 0,ms=xe(Object.getPrototypeOf,Object),$o=Object.create,vs=Ve.propertyIsEnumerable,Ru=Ee.splice,Fu=_n?_n.toStringTag:void 0,jl=function(){try{var K=Fe(Object,"defineProperty");return K({},"",{}),K}catch(oe){}}(),vv=Jn?Jn.isBuffer:void 0,Wt=Math.max,to=Date.now,sf=Fe($e,"Map"),si=Fe(Object,"create"),yv=function(){function K(){}return function(oe){if(!hf(oe))return{};if($o)return $o(oe);K.prototype=oe;var be=new K;return K.prototype=void 0,be}}();function Zs(K){var oe=-1,be=K==null?0:K.length;for(this.clear();++oe<be;){var nt=K[oe];this.set(nt[0],nt[1])}}function Mb(){this.__data__=si?si(null):{},this.size=0}function Pb(K){var oe=this.has(K)&&delete this.__data__[K];return this.size-=oe?1:0,oe}function Mu(K){var oe=this.__data__;if(si){var be=oe[K];return be===r?void 0:be}return et.call(oe,K)?oe[K]:void 0}function $b(K){var oe=this.__data__;return si?oe[K]!==void 0:et.call(oe,K)}function uf(K,oe){var be=this.__data__;return this.size+=this.has(K)?0:1,be[K]=si&&oe===void 0?r:oe,this}Zs.prototype.clear=Mb,Zs.prototype.delete=Pb,Zs.prototype.get=Mu,Zs.prototype.has=$b,Zs.prototype.set=uf;function Lo(K){var oe=-1,be=K==null?0:K.length;for(this.clear();++oe<be;){var nt=K[oe];this.set(nt[0],nt[1])}}function Js(){this.__data__=[],this.size=0}function Yi(K){var oe=this.__data__,be=Qs(oe,K);if(be<0)return!1;var nt=oe.length-1;return be==nt?oe.pop():Ru.call(oe,be,1),--this.size,!0}function ui(K){var oe=this.__data__,be=Qs(oe,K);return be<0?void 0:oe[be][1]}function Kr(K){return Qs(this.__data__,K)>-1}function Td(K,oe){var be=this.__data__,nt=Qs(be,K);return nt<0?(++this.size,be.push([K,oe])):be[nt][1]=oe,this}Lo.prototype.clear=Js,Lo.prototype.delete=Yi,Lo.prototype.get=ui,Lo.prototype.has=Kr,Lo.prototype.set=Td;function li(K){var oe=-1,be=K==null?0:K.length;for(this.clear();++oe<be;){var nt=K[oe];this.set(nt[0],nt[1])}}function Od(){this.size=0,this.__data__={hash:new Zs,map:new(sf||Lo),string:new Zs}}function bv(K){var oe=We(this,K).delete(K);return this.size-=oe?1:0,oe}function Up(K){return We(this,K).get(K)}function xv(K){return We(this,K).has(K)}function Lb(K,oe){var be=We(this,K),nt=be.size;return be.set(K,oe),this.size+=be.size==nt?0:1,this}li.prototype.clear=Od,li.prototype.delete=bv,li.prototype.get=Up,li.prototype.has=xv,li.prototype.set=Lb;function Ul(K){var oe=this.__data__=new Lo(K);this.size=oe.size}function Bb(){this.__data__=new Lo,this.size=0}function wv(K){var oe=this.__data__,be=oe.delete(K);return this.size=oe.size,be}function _v(K){return this.__data__.get(K)}function zb(K){return this.__data__.has(K)}function Sv(K,oe){var be=this.__data__;if(be instanceof Lo){var nt=be.__data__;if(!sf||nt.length<n-1)return nt.push([K,oe]),this.size=++be.size,this;be=this.__data__=new li(nt)}return be.set(K,oe),this.size=be.size,this}Ul.prototype.clear=Bb,Ul.prototype.delete=wv,Ul.prototype.get=_v,Ul.prototype.has=zb,Ul.prototype.set=Sv;function Wp(K,oe){var be=Rd(K),nt=!be&&tu(K),yn=!be&&!nt&&ES(K),Qn=!be&&!nt&&!yn&&Wb(K),mr=be||nt||yn||Qn,bn=mr?z(K.length,String):[],vr=bn.length;for(var no in K)(oe||et.call(K,no))&&!(mr&&(no=="length"||yn&&(no=="offset"||no=="parent")||Qn&&(no=="buffer"||no=="byteLength"||no=="byteOffset")||yt(no,vr)))&&bn.push(no);return bn}function Wl(K,oe,be){(be!==void 0&&!Dd(K[oe],be)||be===void 0&&!(oe in K))&&cf(K,oe,be)}function lf(K,oe,be){var nt=K[oe];(!(et.call(K,oe)&&Dd(nt,be))||be===void 0&&!(oe in K))&&cf(K,oe,be)}function Qs(K,oe){for(var be=K.length;be--;)if(Dd(K[be][0],oe))return be;return-1}function cf(K,oe,be){oe=="__proto__"&&jl?jl(K,oe,{configurable:!0,enumerable:!0,value:be,writable:!0}):K[oe]=be}var Vl=Ue();function Id(K){return K==null?K===void 0?C:v:Fu&&Fu in Object(K)?Le(K):df(K)}function ff(K){return Xp(K)&&Id(K)==s}function Pu(K){if(!hf(K)||Tn(K))return!1;var oe=Ub(K)?Br:Q;return oe.test(jb(K))}function Vp(K){return Xp(K)&&nu(K.length)&&!!ce[Id(K)]}function $u(K){if(!hf(K))return Xr(K);var oe=rr(K),be=[];for(var nt in K)nt=="constructor"&&(oe||!et.call(K,nt))||be.push(nt);return be}function Nd(K,oe,be,nt,yn){K!==oe&&Vl(oe,function(Qn,mr){if(yn||(yn=new Ul),hf(Qn))qp(K,oe,mr,be,Nd,nt,yn);else{var bn=nt?nt(Ia(K,mr),Qn,mr+"",K,oe,yn):void 0;bn===void 0&&(bn=Qn),Wl(K,mr,bn)}},pf)}function qp(K,oe,be,nt,yn,Qn,mr){var bn=Ia(K,be),vr=Ia(oe,be),no=mr.get(vr);if(no){Wl(K,be,no);return}var bi=Qn?Qn(bn,vr,be+"",K,oe,mr):void 0,ql=bi===void 0;if(ql){var Mi=Rd(vr),ci=!Mi&&ES(vr),qb=!Mi&&!ci&&Wb(vr);bi=vr,Mi||ci||qb?Rd(bn)?bi=bn:Kp(bn)?bi=fe(bn):ci?(ql=!1,bi=ee(vr,!0)):qb?(ql=!1,bi=se(vr,!0)):bi=[]:CS(vr)||tu(vr)?(bi=bn,tu(bn)?bi=Md(bn):(!hf(bn)||Ub(bn))&&(bi=at(vr))):ql=!1}ql&&(mr.set(vr,bi),yn(bi,vr,nt,Qn,mr),mr.delete(vr)),Wl(K,be,bi)}function Hp(K,oe){return Gp(eu(K,oe,Vb),K+"")}var j=jl?function(K,oe){return jl(K,"toString",{configurable:!0,enumerable:!1,value:AS(oe),writable:!0})}:Vb;function ee(K,oe){if(oe)return K.slice();var be=K.length,nt=kr?kr(be):new K.constructor(be);return K.copy(nt),nt}function G(K){var oe=new K.constructor(K.byteLength);return new Xi(oe).set(new Xi(K)),oe}function se(K,oe){var be=oe?G(K.buffer):K.buffer;return new K.constructor(be,K.byteOffset,K.length)}function fe(K,oe){var be=-1,nt=K.length;for(oe||(oe=Array(nt));++be<nt;)oe[be]=K[be];return oe}function ae(K,oe,be,nt){var yn=!be;be||(be={});for(var Qn=-1,mr=oe.length;++Qn<mr;){var bn=oe[Qn],vr=nt?nt(be[bn],K[bn],bn,be,K):void 0;vr===void 0&&(vr=K[bn]),yn?cf(be,bn,vr):lf(be,bn,vr)}return be}function De(K){return Hp(function(oe,be){var nt=-1,yn=be.length,Qn=yn>1?be[yn-1]:void 0,mr=yn>2?be[2]:void 0;for(Qn=K.length>3&&typeof Qn=="function"?(yn--,Qn):void 0,mr&&Mt(be[0],be[1],mr)&&(Qn=yn<3?void 0:Qn,yn=1),oe=Object(oe);++nt<yn;){var bn=be[nt];bn&&K(oe,bn,nt,Qn)}return oe})}function Ue(K){return function(oe,be,nt){for(var yn=-1,Qn=Object(oe),mr=nt(oe),bn=mr.length;bn--;){var vr=mr[K?bn:++yn];if(be(Qn[vr],vr,Qn)===!1)break}return oe}}function We(K,oe){var be=K.__data__;return $t(oe)?be[typeof oe=="string"?"string":"hash"]:be.map}function Fe(K,oe){var be=Z(K,oe);return Pu(be)?be:void 0}function Le(K){var oe=et.call(K,Fu),be=K[Fu];try{K[Fu]=void 0;var nt=!0}catch(Qn){}var yn=rn.call(K);return nt&&(oe?K[Fu]=be:delete K[Fu]),yn}function at(K){return typeof K.constructor=="function"&&!rr(K)?yv(ms(K)):{}}function yt(K,oe){var be=typeof K;return oe=oe??o,!!oe&&(be=="number"||be!="symbol"&&me.test(K))&&K>-1&&K%1==0&&K<oe}function Mt(K,oe,be){if(!hf(be))return!1;var nt=typeof oe;return(nt=="number"?Fd(be)&&yt(oe,be.length):nt=="string"&&oe in be)?Dd(be[oe],K):!1}function $t(K){var oe=typeof K;return oe=="string"||oe=="number"||oe=="symbol"||oe=="boolean"?K!=="__proto__":K===null}function Tn(K){return!!Gt&&Gt in K}function rr(K){var oe=K&&K.constructor,be=typeof oe=="function"&&oe.prototype||Ve;return K===be}function Xr(K){var oe=[];if(K!=null)for(var be in Object(K))oe.push(be);return oe}function df(K){return rn.call(K)}function eu(K,oe,be){return oe=Wt(oe===void 0?K.length-1:oe,0),function(){for(var nt=arguments,yn=-1,Qn=Wt(nt.length-oe,0),mr=Array(Qn);++yn<Qn;)mr[yn]=nt[oe+yn];yn=-1;for(var bn=Array(oe+1);++yn<oe;)bn[yn]=nt[yn];return bn[oe]=be(mr),L(K,this,bn)}}function Ia(K,oe){if(!(oe==="constructor"&&typeof K[oe]=="function")&&oe!="__proto__")return K[oe]}var Gp=SS(j);function SS(K){var oe=0,be=0;return function(){var nt=to(),yn=a-(nt-be);if(be=nt,yn>0){if(++oe>=i)return arguments[0]}else oe=0;return K.apply(void 0,arguments)}}function jb(K){if(K!=null){try{return Ft.call(K)}catch(oe){}try{return K+""}catch(oe){}}return""}function Dd(K,oe){return K===oe||K!==K&&oe!==oe}var tu=ff(function(){return arguments}())?ff:function(K){return Xp(K)&&et.call(K,"callee")&&!vs.call(K,"callee")},Rd=Array.isArray;function Fd(K){return K!=null&&nu(K.length)&&!Ub(K)}function Kp(K){return Xp(K)&&Fd(K)}var ES=vv||Lu;function Ub(K){if(!hf(K))return!1;var oe=Id(K);return oe==h||oe==p||oe==l||oe==b}function nu(K){return typeof K=="number"&&K>-1&&K%1==0&&K<=o}function hf(K){var oe=typeof K;return K!=null&&(oe=="object"||oe=="function")}function Xp(K){return K!=null&&typeof K=="object"}function CS(K){if(!Xp(K)||Id(K)!=y)return!1;var oe=ms(K);if(oe===null)return!0;var be=et.call(oe,"constructor")&&oe.constructor;return typeof be=="function"&&be instanceof be&&Ft.call(be)==kn}var Wb=J?R(J):Vp;function Md(K){return ae(K,pf(K))}function pf(K){return Fd(K)?Wp(K,!0):$u(K)}var vR=De(function(K,oe,be,nt){Nd(K,oe,be,nt)});function AS(K){return function(){return K}}function Vb(K){return K}function Lu(){return!1}e.exports=vR})(JR,JR.exports);var Jl=JR.exports;function QR(e,t){var n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n}function SSe(e,t){var n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n}function ESe(e,t){var n={},r={};return Object.keys(e).forEach(i=>{t.includes(i)?n[i]=e[i]:r[i]=e[i]}),[n,r]}function CSe(e,t,n,r){var i=typeof t=="string"?t.split("."):[t];for(r=0;r<i.length&&e;r+=1)e=e[i[r]];return e===void 0?n:e}var ASe=e=>{var t=new WeakMap,n=(r,i,a,o)=>{if(typeof r=="undefined")return e(r,i,a);t.has(r)||t.set(r,new Map);var s=t.get(r);if(s.has(i))return s.get(i);var u=e(r,i,a,o);return s.set(i,u),u};return n},aE=ASe(CSe);function EH(e,t){var n={};return Object.keys(e).forEach(r=>{var i=e[r],a=t(i,r,e);a&&(n[r]=i)}),n}var oE=e=>EH(e,t=>t!=null),sE=e=>Object.keys(e),kSe=e=>e.reduce((t,n)=>{var[r,i]=n;return t[r]=i,t},{});function TSe(e){var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}}function eF(e){if(e==null)return e;var{unitless:t}=TSe(e);return t||zd(e)?e+"px":e}var CH=(e,t)=>parseInt(e[1],10)>parseInt(t[1],10)?1:-1,tF=e=>kSe(Object.entries(e).sort(CH));function AH(e){var t=tF(e);return Object.assign(Object.values(t),t)}function OSe(e){var t=Object.keys(tF(e));return new Set(t)}function ISe(e){var t;if(!e)return e;e=(t=eF(e))!=null?t:e;var n=e.endsWith("px")?-1:-.0635;return zd(e)?""+(e+n):e.replace(/([0-9]+\.?[0-9]*)/,r=>""+(parseFloat(r)+n))}function uE(e,t){var n=[];return e&&n.push("@media screen and (min-width: "+eF(e)+")"),n.length>0&&t&&n.push("and"),t&&n.push("@media screen and (max-width: "+eF(t)+")"),n.join(" ")}function NSe(e){var t;if(!e)return null;e.base=(t=e.base)!=null?t:"0px";var n=AH(e),r=Object.entries(e).sort(CH).map((o,s,u)=>{var l,[c,f]=o,[,d]=(l=u[s+1])!=null?l:[];return d=parseFloat(d)>0?ISe(d):void 0,{breakpoint:c,minW:f,maxW:d,maxWQuery:uE(null,d),minWQuery:uE(f),minMaxQuery:uE(f,d)}}),i=OSe(e),a=Array.from(i.values());return{keys:i,normalized:n,isResponsive(o){var s=Object.keys(o);return s.length>0&&s.every(u=>i.has(u))},asObject:tF(e),asArray:AH(e),details:r,media:[null,...n.map(o=>uE(o)).slice(1)],toArrayValue(o){if(!Zl(o))throw new Error("toArrayValue: value must be an object");for(var s=a.map(u=>{var l;return(l=o[u])!=null?l:null});wSe(s)===null;)s.pop();return s},toObjectValue(o){if(!Array.isArray(o))throw new Error("toObjectValue: value must be an array");return o.reduce((s,u,l)=>{var c=a[l];return c!=null&&u!=null&&(s[c]=u),s},{})}}}function kH(e){var t;return e instanceof Element&&(t=e.ownerDocument)!=null?t:document}function DSe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Dv=DSe(),ga=e=>e?"":void 0,nF=e=>e?!0:void 0,dr=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter(Boolean).join(" ")};function RSe(e){var{key:t,keyCode:n}=e,r=n>=37&&n<=40&&t.indexOf("Arrow")!==0,i=r?"Arrow"+t:t;return i}function TH(e){return e.button!==0}var FSe=e=>e.hasAttribute("tabindex");function MSe(e){return Boolean(e.getAttribute("disabled"))===!0||Boolean(e.getAttribute("aria-disabled"))===!0}function PSe(e){return OH(e)&&e.tagName.toLowerCase()==="input"&&"select"in e}function $Se(e){var t=e instanceof HTMLElement?kH(e):document;return t.activeElement===e}function OH(e){return e instanceof HTMLElement}function IH(e){return e.parentElement&&IH(e.parentElement)?!0:e.hidden}function LSe(e){var t=e.getAttribute("contenteditable");return t!=="false"&&t!=null}function BSe(e){if(!OH(e)||IH(e)||MSe(e))return!1;var{localName:t}=e,n=["input","select","textarea","button"];if(n.indexOf(t)>=0)return!0;var r={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in r?r[t]():LSe(e)?!0:FSe(e)}var zSe=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","embed","iframe","object","a[href]","area[href]","button:not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],jSe=zSe.join();function USe(e){var t=Array.from(e.querySelectorAll(jSe));return t.unshift(e),t.filter(BSe).filter(n=>window.getComputedStyle(n).display!=="none")}function Hu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wH(e)?e(...n):e}function Yr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){t.some(a=>(a==null||a(i),i==null?void 0:i.defaultPrevented))}}function WSe(e){var t;return function(){if(e){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=e.apply(this,i),e=null}return t}}var s1=()=>{},rF=WSe(e=>()=>{var{condition:t,message:n}=e;t&&iE&&console.warn(n)}),VSe=e=>{Promise.resolve().then(e)},qSe=typeof queueMicrotask=="function"?queueMicrotask:VSe;function Rv(e,t){t===void 0&&(t={});var{isActive:n=$Se,nextTick:r,preventScroll:i=!0,selectTextIfInput:a=!0}=t;if(!e||n(e))return-1;function o(){if(!e){rF({condition:!0,message:"[chakra-ui]: can't call focus() on `null` or `undefined` element"});return}if(HSe())e.focus({preventScroll:i});else if(e.focus(),i){var s=GSe(e);KSe(s)}PSe(e)&&a&&e.select()}return r?requestAnimationFrame(o):(o(),-1)}var lE=null;function HSe(){if(lE==null){lE=!1;try{var e=document.createElement("div");e.focus({get preventScroll(){return lE=!0,!0}})}catch(t){}}return lE}function GSe(e){for(var t=kH(e),n=e.parentNode,r=[],i=t.scrollingElement||t.documentElement;n instanceof HTMLElement&&n!==i;)(n.offsetHeight<n.scrollHeight||n.offsetWidth<n.scrollWidth)&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),n=n.parentNode;return i instanceof HTMLElement&&r.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),r}function KSe(e){for(var{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function XSe(e){var{hasBeenSelected:t,isLazy:n,isSelected:r,lazyBehavior:i="unmount"}=e;return!!(!n||r||i==="keepMounted"&&t)}var NH=1/60*1e3,YSe=typeof performance!="undefined"?function(){return performance.now()}:function(){return Date.now()},DH=typeof window!="undefined"?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(YSe())},NH)};function ZSe(e){var t=[],n=[],r=0,i=!1,a=new WeakSet,o={schedule:function(s,u,l){u===void 0&&(u=!1),l===void 0&&(l=!1);var c=l&&i,f=c?t:n;return u&&a.add(s),f.indexOf(s)===-1&&(f.push(s),c&&i&&(r=t.length)),s},cancel:function(s){var u=n.indexOf(s);u!==-1&&n.splice(u,1),a.delete(s)},process:function(s){var u;if(i=!0,u=[n,t],t=u[0],n=u[1],n.length=0,r=t.length,r)for(var l=0;l<r;l++){var c=t[l];c(s),a.has(c)&&(o.schedule(c),e())}i=!1}};return o}var JSe=40,iF=!0,u1=!1,aF=!1,Fv={delta:0,timestamp:0},l1=["read","update","preRender","render","postRender"],cE=l1.reduce(function(e,t){return e[t]=ZSe(function(){return u1=!0}),e},{}),Ql=l1.reduce(function(e,t){var n=cE[t];return e[t]=function(r,i,a){return i===void 0&&(i=!1),a===void 0&&(a=!1),u1||eEe(),n.schedule(r,i,a)},e},{}),c1=l1.reduce(function(e,t){return e[t]=cE[t].cancel,e},{}),Mv=l1.reduce(function(e,t){return e[t]=function(){return cE[t].process(Fv)},e},{}),QSe=function(e){return cE[e].process(Fv)},RH=function(e){u1=!1,Fv.delta=iF?NH:Math.max(Math.min(e-Fv.timestamp,JSe),1),Fv.timestamp=e,aF=!0,l1.forEach(QSe),aF=!1,u1&&(iF=!1,DH(RH))},eEe=function(){u1=!0,iF=!0,aF||DH(RH)},fE=function(){return Fv};Object.freeze(["base","sm","md","lg","xl","2xl"]);function f1(e,t){return YR(e)?e.map(n=>n===null?null:t(n)):Zl(e)?sE(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):e!=null?t(e):null}function tEe(e,t){function n(r,i){return i===void 0&&(i=[]),YR(r)?r.map((a,o)=>n(a,[...i,String(o)])):Zl(r)?Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,n(s,[...i,o])]})):t(r,i)}return n(e)}function nEe(e,t){if(e!=null){if(wH(e)){e(t);return}try{e.current=t}catch(n){throw new Error("Cannot assign value '"+t+"' to ref '"+e+"'")}}}function jd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=>{t.forEach(i=>nEe(i,r))}}function ec(e){e===void 0&&(e={});var{strict:t=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=e,i=Na(void 0);i.displayName=r;function a(){var o=ir(i);if(!o&&t){var s=new Error(n);throw s.name="ContextError",Error.captureStackTrace==null||Error.captureStackTrace(s,a),s}return o}return[i.Provider,a,i]}function oF(e){return Jb.toArray(e).filter(t=>Pd(t))}var[rEe,iEe]=ec({strict:!1,name:"PortalManagerContext"});function FH(e){var{children:t,zIndex:n}=e;return pe(rEe,{value:{zIndex:n}},t)}iE&&(FH.displayName="PortalManager");function sF(e){e===void 0&&(e=!1);var[t,n]=xn(e),r=vt(()=>{n(!0)},[]),i=vt(()=>{n(!1)},[]),a=vt(()=>{n(o=>!o)},[]);return[t,{on:r,off:i,toggle:a}]}var Pv=Dv?vf:an;function d1(e,t){t===void 0&&(t=[]);var n=cn(e);return Pv(()=>{n.current=e}),vt(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.current==null?void 0:n.current(...i)},t)}function aEe(e,t){var n=e!==void 0,r=n&&typeof e!="undefined"?e:t;return[n,r]}function oEe(e){var{value:t,defaultValue:n,onChange:r,shouldUpdate:i=(d,h)=>d!==h}=e,a=d1(r),o=d1(i),[s,u]=xn(n),l=t!==void 0,c=l?t:s,f=vt(d=>{var h=Hu(d,c);!o(c,h)||(l||u(h),a(h))},[l,a,c,o]);return[c,f]}var MH={prefix:Math.round(Math.random()*1e10),current:0},uF=Na(MH),sEe=AR(e=>{var{children:t}=e,n=ir(uF),r=n===MH,i=zr(()=>({prefix:r?0:++n.prefix,current:0}),[r,n]);return pe(uF.Provider,{value:i},t)});function PH(e,t){var n=ir(uF);return zr(()=>e||[t,n.prefix,++n.current].filter(Boolean).join("-"),[e,t])}function uEe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=PH(e);return zr(()=>n.map(a=>a+"-"+i),[i,n])}function lEe(e,t){return t===void 0&&(t=[]),an(()=>()=>e(),t)}function $H(){var e=cn(!1),[t,n]=xn(0);return lEe(()=>{e.current=!0}),vt(()=>{e.current||n(t+1)},[t])}function lF(){return lF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lF.apply(this,arguments)}function cEe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[LH,fEe]=ec({strict:!1,name:"PortalContext"}),cF="chakra-portal",dEe=".chakra-portal",hEe=e=>pe("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0}},e.children),pEe=e=>{var{appendToParentPortal:t,children:n}=e,r=cn(null),i=cn(null),a=$H(),o=fEe(),s=iEe();Pv(()=>{if(!!r.current){var l=r.current.ownerDocument,c=t?o??l.body:l.body;if(!!c){i.current=l.createElement("div"),i.current.className=cF,c.appendChild(i.current),a();var f=i.current;return()=>{c.contains(f)&&c.removeChild(f)}}}},[]);var u=s!=null&&s.zIndex?pe(hEe,{zIndex:s==null?void 0:s.zIndex},n):n;return i.current?DS(pe(LH,{value:i.current},u),i.current):pe("span",{ref:r})},gEe=e=>{var{children:t,containerRef:n,appendToParentPortal:r}=e,i=n.current,a=i??(Dv?document.body:void 0),o=zr(()=>{var u=i==null?void 0:i.ownerDocument.createElement("div");return u&&(u.className=cF),u},[i]),s=$H();return Pv(()=>{s()},[]),Pv(()=>{if(!(!o||!a))return a.appendChild(o),()=>{a.removeChild(o)}},[o,a]),a&&o?DS(pe(LH,{value:r?o:null},t),o):null};function dE(e){var{containerRef:t}=e,n=cEe(e,["containerRef"]);return t?pe(gEe,lF({containerRef:t},n)):pe(pEe,n)}dE.defaultProps={appendToParentPortal:!0},dE.className=cF,dE.selector=dEe;var hE={light:"chakra-ui-light",dark:"chakra-ui-dark"},mEe={classList:{add:s1,remove:s1}},vEe=()=>Dv?document.body:mEe;function yEe(e){var t=vEe();t.classList.add(e?hE.dark:hE.light),t.classList.remove(e?hE.light:hE.dark)}function bEe(e){var t=window.matchMedia==null?void 0:window.matchMedia(e);if(!!t)return!!t.media===t.matches}var BH={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"};function xEe(e){var t,n=(t=bEe(BH.dark))!=null?t:e==="dark";return n?"dark":"light"}function wEe(e){if(!("matchMedia"in window))return s1;var t=window.matchMedia(BH.dark),n=()=>{e(t.matches?"dark":"light")};return n(),t.addListener(n),()=>{t.removeListener(n)}}var zH={get:()=>document.documentElement.style.getPropertyValue("--chakra-ui-color-mode"),set:e=>{Dv&&document.documentElement.style.setProperty("--chakra-ui-color-mode",e)}},jH=()=>typeof Storage!="undefined",UH="chakra-ui-color-mode",_Ee={get(e){if(!jH())return e;try{var t=localStorage.getItem(UH);return t??e}catch(n){return e}},set(e){if(!!jH())try{localStorage.setItem(UH,e)}catch(t){}},type:"localStorage"},fF=Na({});iE&&(fF.displayName="ColorModeContext");var dF=()=>{var e=ir(fF);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e};function WH(e){var{value:t,children:n,options:{useSystemColorMode:r,initialColorMode:i},colorModeManager:a=_Ee}=e,[o,s]=xn(a.type==="cookie"?a.get(i):i);an(()=>{if(Dv&&a.type==="localStorage"){var f=r?xEe(i):zH.get()||a.get();f&&s(f)}},[a,r,i]),an(()=>{var f=o==="dark";yEe(f),zH.set(f?"dark":"light")},[o]);var u=vt(f=>{a.set(f),s(f)},[a]),l=vt(()=>{u(o==="light"?"dark":"light")},[o,u]);an(()=>{var f;return r&&(f=wEe(u)),()=>{f&&r&&f()}},[u,r]);var c=zr(()=>({colorMode:t??o,toggleColorMode:t?s1:l,setColorMode:t?s1:u}),[o,u,l,t]);return pe(fF.Provider,{value:c},n)}iE&&(WH.displayName="ColorModeProvider");function SEe(e,t){var{colorMode:n}=dF();return n==="dark"?t:e}var EEe=(e,t)=>n=>{var r=String(t),i=e?e+"."+r:r;return Zl(n.__cssMap)&&i in n.__cssMap?n.__cssMap[i].varRef:t};function h1(e){var{scale:t,transform:n,compose:r}=e,i=(a,o)=>{var s,u=EEe(t,a)(o),l=(s=n==null?void 0:n(u,o))!=null?s:u;return r&&(l=r(l,o)),l};return i}function Gu(e,t){return n=>{var r={property:n,scale:e};return r.transform=h1({scale:e,transform:t}),r}}var CEe=e=>{var{rtl:t,ltr:n}=e;return r=>r.direction==="rtl"?t:n};function AEe(e){var{property:t,scale:n,transform:r}=e;return{scale:n,property:CEe(t),transform:n?h1({scale:n,compose:r}):r}}var VH=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function kEe(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...VH].join(" ")}function TEe(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...VH].join(" ")}var OEe={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},IEe={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function NEe(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var DEe={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},qH="& > :not(style) ~ :not(style)",REe={[qH]:{marginInlineStart:"calc(var(--chakra-space-x) * calc(1 - var(--chakra-space-x-reverse)))",marginInlineEnd:"calc(var(--chakra-space-x) * var(--chakra-space-x-reverse))"}},FEe={[qH]:{marginTop:"calc(var(--chakra-space-y) * calc(1 - var(--chakra-space-y-reverse)))",marginBottom:"calc(var(--chakra-space-y) * var(--chakra-space-y-reverse))"}};function hF(e,t){hF=function(u,l){return new a(u,void 0,l)};var n=pF(RegExp),r=RegExp.prototype,i=new WeakMap;function a(s,u,l){var c=n.call(this,s,u);return i.set(c,l||i.get(s)),c}MEe(a,n),a.prototype.exec=function(s){var u=r.exec.call(this,s);return u&&(u.groups=o(u,this)),u},a.prototype[Symbol.replace]=function(s,u){if(typeof u=="string"){var l=i.get(this);return r[Symbol.replace].call(this,s,u.replace(/\$<([^>]+)>/g,function(f,d){return"$"+l[d]}))}else if(typeof u=="function"){var c=this;return r[Symbol.replace].call(this,s,function(){var f=[];return f.push.apply(f,arguments),typeof f[f.length-1]!="object"&&f.push(o(f,c)),u.apply(this,f)})}else return r[Symbol.replace].call(this,s,u)};function o(s,u){var l=i.get(u);return Object.keys(l).reduce(function(c,f){return c[f]=s[l[f]],c},Object.create(null))}return hF.apply(this,arguments)}function MEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p1(e,t)}function pF(e){var t=typeof Map=="function"?new Map:void 0;return pF=function(r){if(r===null||!$Ee(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return pE(r,arguments,gF(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),p1(i,r)},pF(e)}function pE(e,t,n){return PEe()?pE=Reflect.construct:pE=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&p1(l,o.prototype),l},pE.apply(null,arguments)}function PEe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function $Ee(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function p1(e,t){return p1=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},p1(e,t)}function gF(e){return gF=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},gF(e)}var mF={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},LEe=new Set(Object.values(mF)),HH=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),BEe=e=>e.trim();function zEe(e,t){var n,r;if(e==null||HH.has(e))return e;var i=hF(/(^[\x2DA-Za-z]+)\(((.*))\)/g,{type:1,values:2}),{type:a,values:o}=(n=(r=i.exec(e))==null?void 0:r.groups)!=null?n:{};if(!a||!o)return e;var s=a.includes("-gradient")?a:a+"-gradient",[u,...l]=o.split(",").map(BEe).filter(Boolean);if((l==null?void 0:l.length)===0)return e;var c=u in mF?mF[u]:u;l.unshift(c);var f=l.map(d=>{if(LEe.has(d))return d;var[h,p]=d.split(" "),g="colors."+h,m=g in t.__cssMap?t.__cssMap[g].varRef:h;return p?[m,p].join(" "):m});return s+"("+f.join(", ")+")"}var jEe=(e,t)=>zEe(e,t??{}),UEe=e=>{var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}},tc=e=>t=>e+"("+t+")",sr={filter(e){return e!=="auto"?e:OEe},backdropFilter(e){return e!=="auto"?e:IEe},ring(e){return NEe(sr.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?kEe():e==="auto-gpu"?TEe():e},px(e){if(e==null)return e;var{unitless:t}=UEe(e);return t||zd(e)?e+"px":e},fraction(e){return!zd(e)||e>1?e:e*100+"%"},float(e,t){var n={left:"right",right:"left"};return t.direction==="rtl"?n[e]:e},degree(e){if(SH(e)||e==null)return e;var t=ZR(e)&&!e.endsWith("deg");return zd(e)||t?e+"deg":e},gradient:jEe,blur:tc("blur"),opacity:tc("opacity"),brightness:tc("brightness"),contrast:tc("contrast"),dropShadow:tc("drop-shadow"),grayscale:tc("grayscale"),hueRotate:tc("hue-rotate"),invert:tc("invert"),saturate:tc("saturate"),sepia:tc("sepia"),bgImage(e){if(e==null)return e;var t=WEe(e)||HH.has(e);return t?e:"url("+e+")"},outline(e){var t=String(e)==="0"||String(e)==="none";return e!==null&&t?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var t,{space:n,divide:r}=(t=DEe[e])!=null?t:{},i={flexDirection:e};return n&&(i[n]=1),r&&(i[r]=1),i}},WEe=e=>ZR(e)&&e.includes("(")&&e.includes(")");function vF(){return vF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vF.apply(this,arguments)}var de={borderWidths:Gu("borderWidths"),borderStyles:Gu("borderStyles"),colors:Gu("colors"),borders:Gu("borders"),radii:Gu("radii",sr.px),space:Gu("space",sr.px),spaceT:Gu("space",sr.px),degreeT(e){return{property:e,transform:sr.degree}},prop(e,t,n){return vF({property:e,scale:t},t&&{transform:h1({scale:t,transform:n})})},propT(e,t){return{property:e,transform:t}},sizes:Gu("sizes",sr.px),sizesT:Gu("sizes",sr.fraction),shadows:Gu("shadows"),logical:AEe,blur:Gu("blur",sr.blur)},gE={background:de.colors("background"),backgroundColor:de.colors("backgroundColor"),backgroundImage:de.propT("backgroundImage",sr.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:sr.bgClip},bgSize:de.prop("backgroundSize"),bgPosition:de.prop("backgroundPosition"),bg:de.colors("background"),bgColor:de.colors("backgroundColor"),bgPos:de.prop("backgroundPosition"),bgRepeat:de.prop("backgroundRepeat"),bgAttachment:de.prop("backgroundAttachment"),bgGradient:de.propT("backgroundImage",sr.gradient),bgClip:{transform:sr.bgClip}};Object.assign(gE,{bgImage:gE.backgroundImage,bgImg:gE.backgroundImage});var Gn={border:de.borders("border"),borderWidth:de.borderWidths("borderWidth"),borderStyle:de.borderStyles("borderStyle"),borderColor:de.colors("borderColor"),borderRadius:de.radii("borderRadius"),borderTop:de.borders("borderTop"),borderBlockStart:de.borders("borderBlockStart"),borderTopLeftRadius:de.radii("borderTopLeftRadius"),borderStartStartRadius:de.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:de.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:de.radii("borderTopRightRadius"),borderStartEndRadius:de.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:de.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:de.borders("borderRight"),borderInlineEnd:de.borders("borderInlineEnd"),borderBottom:de.borders("borderBottom"),borderBlockEnd:de.borders("borderBlockEnd"),borderBottomLeftRadius:de.radii("borderBottomLeftRadius"),borderBottomRightRadius:de.radii("borderBottomRightRadius"),borderLeft:de.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:de.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:de.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:de.borders(["borderLeft","borderRight"]),borderInline:de.borders("borderInline"),borderY:de.borders(["borderTop","borderBottom"]),borderBlock:de.borders("borderBlock"),borderTopWidth:de.borderWidths("borderTopWidth"),borderBlockStartWidth:de.borderWidths("borderBlockStartWidth"),borderTopColor:de.colors("borderTopColor"),borderBlockStartColor:de.colors("borderBlockStartColor"),borderTopStyle:de.borderStyles("borderTopStyle"),borderBlockStartStyle:de.borderStyles("borderBlockStartStyle"),borderBottomWidth:de.borderWidths("borderBottomWidth"),borderBlockEndWidth:de.borderWidths("borderBlockEndWidth"),borderBottomColor:de.colors("borderBottomColor"),borderBlockEndColor:de.colors("borderBlockEndColor"),borderBottomStyle:de.borderStyles("borderBottomStyle"),borderBlockEndStyle:de.borderStyles("borderBlockEndStyle"),borderLeftWidth:de.borderWidths("borderLeftWidth"),borderInlineStartWidth:de.borderWidths("borderInlineStartWidth"),borderLeftColor:de.colors("borderLeftColor"),borderInlineStartColor:de.colors("borderInlineStartColor"),borderLeftStyle:de.borderStyles("borderLeftStyle"),borderInlineStartStyle:de.borderStyles("borderInlineStartStyle"),borderRightWidth:de.borderWidths("borderRightWidth"),borderInlineEndWidth:de.borderWidths("borderInlineEndWidth"),borderRightColor:de.colors("borderRightColor"),borderInlineEndColor:de.colors("borderInlineEndColor"),borderRightStyle:de.borderStyles("borderRightStyle"),borderInlineEndStyle:de.borderStyles("borderInlineEndStyle"),borderTopRadius:de.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:de.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:de.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:de.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(Gn,{rounded:Gn.borderRadius,roundedTop:Gn.borderTopRadius,roundedTopLeft:Gn.borderTopLeftRadius,roundedTopRight:Gn.borderTopRightRadius,roundedTopStart:Gn.borderStartStartRadius,roundedTopEnd:Gn.borderStartEndRadius,roundedBottom:Gn.borderBottomRadius,roundedBottomLeft:Gn.borderBottomLeftRadius,roundedBottomRight:Gn.borderBottomRightRadius,roundedBottomStart:Gn.borderEndStartRadius,roundedBottomEnd:Gn.borderEndEndRadius,roundedLeft:Gn.borderLeftRadius,roundedRight:Gn.borderRightRadius,roundedStart:Gn.borderInlineStartRadius,roundedEnd:Gn.borderInlineEndRadius,borderStart:Gn.borderInlineStart,borderEnd:Gn.borderInlineEnd,borderTopStartRadius:Gn.borderStartStartRadius,borderTopEndRadius:Gn.borderStartEndRadius,borderBottomStartRadius:Gn.borderEndStartRadius,borderBottomEndRadius:Gn.borderEndEndRadius,borderStartRadius:Gn.borderInlineStartRadius,borderEndRadius:Gn.borderInlineEndRadius,borderStartWidth:Gn.borderInlineStartWidth,borderEndWidth:Gn.borderInlineEndWidth,borderStartColor:Gn.borderInlineStartColor,borderEndColor:Gn.borderInlineEndColor,borderStartStyle:Gn.borderInlineStartStyle,borderEndStyle:Gn.borderInlineEndStyle});var VEe={color:de.colors("color"),textColor:de.colors("color"),fill:de.colors("fill"),stroke:de.colors("stroke")},yF={boxShadow:de.shadows("boxShadow"),mixBlendMode:!0,blendMode:de.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:de.prop("backgroundBlendMode"),opacity:!0};Object.assign(yF,{shadow:yF.boxShadow});var qEe={filter:{transform:sr.filter},blur:de.blur("--chakra-blur"),brightness:de.propT("--chakra-brightness",sr.brightness),contrast:de.propT("--chakra-contrast",sr.contrast),hueRotate:de.degreeT("--chakra-hue-rotate"),invert:de.propT("--chakra-invert",sr.invert),saturate:de.propT("--chakra-saturate",sr.saturate),dropShadow:de.propT("--chakra-drop-shadow",sr.dropShadow),backdropFilter:{transform:sr.backdropFilter},backdropBlur:de.blur("--chakra-backdrop-blur"),backdropBrightness:de.propT("--chakra-backdrop-brightness",sr.brightness),backdropContrast:de.propT("--chakra-backdrop-contrast",sr.contrast),backdropHueRotate:de.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:de.propT("--chakra-backdrop-invert",sr.invert),backdropSaturate:de.propT("--chakra-backdrop-saturate",sr.saturate)},mE={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:sr.flexDirection},experimental_spaceX:{static:REe,transform:h1({scale:"space",transform:e=>e!==null?{"--chakra-space-x":e}:null})},experimental_spaceY:{static:FEe,transform:h1({scale:"space",transform:e=>e!=null?{"--chakra-space-y":e}:null})},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:de.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0};Object.assign(mE,{flexDir:mE.flexDirection});var GH={gridGap:de.space("gridGap"),gridColumnGap:de.space("gridColumnGap"),gridRowGap:de.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},HEe={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:sr.outline},outlineOffset:!0,outlineColor:de.colors("outlineColor")},ou={width:de.sizesT("width"),inlineSize:de.sizesT("inlineSize"),height:de.sizes("height"),blockSize:de.sizes("blockSize"),boxSize:de.sizes(["width","height"]),minWidth:de.sizes("minWidth"),minInlineSize:de.sizes("minInlineSize"),minHeight:de.sizes("minHeight"),minBlockSize:de.sizes("minBlockSize"),maxWidth:de.sizes("maxWidth"),maxInlineSize:de.sizes("maxInlineSize"),maxHeight:de.sizes("maxHeight"),maxBlockSize:de.sizes("maxBlockSize"),d:de.prop("display"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:de.propT("float",sr.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(ou,{w:ou.width,h:ou.height,minW:ou.minWidth,maxW:ou.maxWidth,minH:ou.minHeight,maxH:ou.maxHeight,overscroll:ou.overscrollBehavior,overscrollX:ou.overscrollBehaviorX,overscrollY:ou.overscrollBehaviorY});var GEe={listStyleType:!0,listStylePosition:!0,listStylePos:de.prop("listStylePosition"),listStyleImage:!0,listStyleImg:de.prop("listStyleImage")},KEe={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},XEe={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},bF=(e,t,n)=>{var r={},i=aE(e,t,{});for(var a in i){var o=a in n&&n[a]!=null;o||(r[a]=i[a])}return r},YEe={srOnly:{transform(e){return e===!0?KEe:e==="focusable"?XEe:{}}},layerStyle:{processResult:!0,transform:(e,t,n)=>bF(t,"layerStyles."+e,n)},textStyle:{processResult:!0,transform:(e,t,n)=>bF(t,"textStyles."+e,n)},apply:{processResult:!0,transform:(e,t,n)=>bF(t,e,n)}},g1={position:!0,pos:de.prop("position"),zIndex:de.prop("zIndex","zIndices"),inset:de.spaceT(["top","right","bottom","left"]),insetX:de.spaceT(["left","right"]),insetInline:de.spaceT("insetInline"),insetY:de.spaceT(["top","bottom"]),insetBlock:de.spaceT("insetBlock"),top:de.spaceT("top"),insetBlockStart:de.spaceT("insetBlockStart"),bottom:de.spaceT("bottom"),insetBlockEnd:de.spaceT("insetBlockEnd"),left:de.spaceT("left"),insetInlineStart:de.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:de.spaceT("right"),insetInlineEnd:de.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(g1,{insetStart:g1.insetInlineStart,insetEnd:g1.insetInlineEnd});var ZEe={ring:{transform:sr.ring},ringColor:de.colors("--chakra-ring-color"),ringOffset:de.prop("--chakra-ring-offset-width"),ringOffsetColor:de.colors("--chakra-ring-offset-color"),ringInset:de.prop("--chakra-ring-inset")},Tr={margin:de.spaceT("margin"),marginTop:de.spaceT("marginTop"),marginBlockStart:de.spaceT("marginBlockStart"),marginRight:de.spaceT("marginRight"),marginInlineEnd:de.spaceT("marginInlineEnd"),marginBottom:de.spaceT("marginBottom"),marginBlockEnd:de.spaceT("marginBlockEnd"),marginLeft:de.spaceT("marginLeft"),marginInlineStart:de.spaceT("marginInlineStart"),marginX:de.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:de.spaceT("marginInline"),marginY:de.spaceT(["marginTop","marginBottom"]),marginBlock:de.spaceT("marginBlock"),padding:de.space("padding"),paddingTop:de.space("paddingTop"),paddingBlockStart:de.space("paddingBlockStart"),paddingRight:de.space("paddingRight"),paddingBottom:de.space("paddingBottom"),paddingBlockEnd:de.space("paddingBlockEnd"),paddingLeft:de.space("paddingLeft"),paddingInlineStart:de.space("paddingInlineStart"),paddingInlineEnd:de.space("paddingInlineEnd"),paddingX:de.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:de.space("paddingInline"),paddingY:de.space(["paddingTop","paddingBottom"]),paddingBlock:de.space("paddingBlock")};Object.assign(Tr,{m:Tr.margin,mt:Tr.marginTop,mr:Tr.marginRight,me:Tr.marginInlineEnd,marginEnd:Tr.marginInlineEnd,mb:Tr.marginBottom,ml:Tr.marginLeft,ms:Tr.marginInlineStart,marginStart:Tr.marginInlineStart,mx:Tr.marginX,my:Tr.marginY,p:Tr.padding,pt:Tr.paddingTop,py:Tr.paddingY,px:Tr.paddingX,pb:Tr.paddingBottom,pl:Tr.paddingLeft,ps:Tr.paddingInlineStart,paddingStart:Tr.paddingInlineStart,pr:Tr.paddingRight,pe:Tr.paddingInlineEnd,paddingEnd:Tr.paddingInlineEnd});var JEe={textDecorationColor:de.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:de.shadows("textShadow")},QEe={clipPath:!0,transform:de.propT("transform",sr.transform),transformOrigin:!0,translateX:de.spaceT("--chakra-translate-x"),translateY:de.spaceT("--chakra-translate-y"),skewX:de.degreeT("--chakra-skew-x"),skewY:de.degreeT("--chakra-skew-y"),scaleX:de.prop("--chakra-scale-x"),scaleY:de.prop("--chakra-scale-y"),scale:de.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:de.degreeT("--chakra-rotate")},eCe={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:de.prop("transitionDuration","transition.duration"),transitionProperty:de.prop("transitionProperty","transition.property"),transitionTimingFunction:de.prop("transitionTimingFunction","transition.easing")},tCe={fontFamily:de.prop("fontFamily","fonts"),fontSize:de.prop("fontSize","fontSizes",sr.px),fontWeight:de.prop("fontWeight","fontWeights"),lineHeight:de.prop("lineHeight","lineHeights"),letterSpacing:de.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"},isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}},$v={hover:e=>e+":hover &, "+e+"[data-hover] &",focus:e=>e+":focus &, "+e+"[data-focus] &",active:e=>e+":active &, "+e+"[data-active] &",disabled:e=>e+":disabled &, "+e+"[data-disabled] &",invalid:e=>e+":invalid &, "+e+"[data-invalid] &",checked:e=>e+":checked &, "+e+"[data-checked] &",indeterminate:e=>e+":indeterminate &, "+e+"[aria-checked=mixed] &, "+e+"[data-indeterminate] &",readOnly:e=>e+":read-only &, "+e+"[readonly] &, "+e+"[data-read-only] &",expanded:e=>e+":read-only &, "+e+"[aria-expanded=true] &, "+e+"[data-expanded] &"},Lv=e=>nCe(e,"[role=group]","[data-group]",".group"),nCe=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(t).join(", ")},xF={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible",_disabled:"&[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:Lv($v.hover),_groupFocus:Lv($v.focus),_groupActive:Lv($v.active),_groupDisabled:Lv($v.disabled),_groupInvalid:Lv($v.invalid),_groupChecked:Lv($v.checked),_placeholder:"&::placeholder",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &",_mediaDark:"@media (prefers-color-scheme: dark)",_dark:".chakra-ui-dark &, [data-theme=dark] &, &[data-theme=dark]",_light:".chakra-ui-light &, [data-theme=light] &, &[data-theme=light]"},rCe=sE(xF);function wF(){return wF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wF.apply(this,arguments)}var _F=Jl({},gE,Gn,VEe,mE,ou,qEe,ZEe,HEe,GH,YEe,g1,yF,Tr,tCe,JEe,QEe,GEe,eCe),iCe=Object.assign({},Tr,ou,mE,GH,g1),aCe=sE(iCe),oCe=[...sE(_F),...rCe],sCe=wF({},_F,xF),uCe=e=>e in sCe,lCe=e=>t=>{if(!t.__breakpoints)return e;var{isResponsive:n,toArrayValue:r,media:i}=t.__breakpoints,a={};for(var o in e){var s=Hu(e[o],t);if(s!=null){if(s=Zl(s)&&n(s)?r(s):s,!Array.isArray(s)){a[o]=s;continue}for(var u=s.slice(0,i.length).length,l=0;l<u;l+=1){var c=i==null?void 0:i[l];if(!c){a[o]=s[l];continue}a[c]=a[c]||{},s[l]!=null&&(a[c][o]=s[l])}}}return a},cCe=(e,t)=>e.startsWith("--")&&ZR(t)&&!SH(t),fCe=(e,t)=>{var n,r;if(t==null)return t;var i=l=>{var c,f;return(c=e.__cssMap)==null||(f=c[l])==null?void 0:f.varRef},a=l=>{var c;return(c=i(l))!=null?c:l},o=t.split(",").map(l=>l.trim()),[s,u]=o;return t=(n=(r=i(s))!=null?r:a(u))!=null?n:a(t),t};function dCe(e){var{configs:t={},pseudos:n={},theme:r}=e,i=function a(o,s){s===void 0&&(s=!1);var u=Hu(o,r),l=lCe(u)(r),c={};for(var f in l){var d,h,p,g,m,v=l[f],y=Hu(v,r);f in n&&(f=n[f]),cCe(f,y)&&(y=fCe(r,y));var b=t[f];if(b===!0&&(b={property:f}),Zl(y)){var x;c[f]=(x=c[f])!=null?x:{},c[f]=Jl({},c[f],a(y,!0));continue}var w=(d=(h=b)==null||h.transform==null?void 0:h.transform(y,r,u))!=null?d:y;w=(p=b)!=null&&p.processResult?a(w,!0):w;var S=Hu((g=b)==null?void 0:g.property,r);if(!s&&(m=b)!=null&&m.static){var C=Hu(b.static,r);c=Jl({},c,C)}if(S&&Array.isArray(S)){for(var _ of S)c[_]=w;continue}if(S){S==="&"&&Zl(w)?c=Jl({},c,w):c[S]=w;continue}if(Zl(w)){c=Jl({},c,w);continue}c[f]=w}return c};return i}var KH=e=>t=>{var n=dCe({theme:t,pseudos:xF,configs:_F});return n(e)};function XH(e){return Zl(e)&&e.reference?e.reference:String(e)}var vE=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(XH).join(" "+t+" ").replace(/calc/g,"")},YH=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+vE("+",...n)+")"},ZH=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+vE("-",...n)+")"},SF=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+vE("*",...n)+")"},JH=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+vE("/",...n)+")"},QH=e=>{var t=XH(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:SF(t,-1)},Jp=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jp(YH(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jp(ZH(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jp(SF(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jp(JH(e,...r))},negate:()=>Jp(QH(e)),toString:()=>e.toString()}),{add:YH,subtract:ZH,multiply:SF,divide:JH,negate:QH});function hCe(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function eG(e){var t=hCe(e.toString());if(t.includes("\\."))return e;var n=!Number.isInteger(parseFloat(e.toString()));return n?t.replace(".","\\."):e}function pCe(e,t){return t===void 0&&(t=""),[t,eG(e)].filter(Boolean).join("-")}function gCe(e,t){return"var("+eG(e)+(t?", "+t:"")+")"}function mCe(e,t){return t===void 0&&(t=""),"--"+pCe(e,t)}function tG(e,t,n){var r=mCe(e,n);return{variable:r,reference:gCe(r,t)}}function EF(){return EF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EF.apply(this,arguments)}function vCe(e,t){var n={cssMap:{},cssVars:{}};return tEe(e,(r,i)=>{var a,[o]=i,s=(a=CF[o])!=null?a:CF.defaultHandler,{cssVars:u,cssMap:l}=s(i,r,t);Object.assign(n.cssVars,u),Object.assign(n.cssMap,l)}),n}var CF={space:(e,t,n)=>{var r=CF.defaultHandler(e,t,n),[i,...a]=e,o=i+".-"+a.join("."),s=e.join("-"),{variable:u,reference:l}=tG(s,void 0,n.cssVarPrefix),c=Jp.negate(t),f=Jp.negate(l);return{cssVars:r.cssVars,cssMap:EF({},r.cssMap,{[o]:{value:""+c,var:""+u,varRef:f}})}},defaultHandler:(e,t,n)=>{var r=e.join("."),i=e.join("-"),{variable:a,reference:o}=tG(i,void 0,n.cssVarPrefix);return{cssVars:{[a]:t},cssMap:{[r]:{value:t,var:a,varRef:o}}}}};function yCe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var bCe=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur"];function xCe(e){var t=bCe;return SSe(e,t)}function wCe(e){var t=yCe(e,["__cssMap","__cssVars","__breakpoints"]);return t}function AF(){return AF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AF.apply(this,arguments)}function _Ce(e){var t,n=wCe(e),r=xCe(n),i=(t=n.config)==null?void 0:t.cssVarPrefix,{cssMap:a,cssVars:o}=vCe(r,{cssVarPrefix:i}),s={"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"};return Object.assign(n,{__cssVars:AF({},s,o),__cssMap:a,__breakpoints:NSe(n.breakpoints)}),n}var SCe=typeof Element!="undefined",ECe=typeof Map=="function",CCe=typeof Set=="function",ACe=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function yE(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(!yE(e[r],t[r]))return!1;return!0}var a;if(ECe&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;for(a=e.entries();!(r=a.next()).done;)if(!yE(r.value[1],t.get(r.value[0])))return!1;return!0}if(CCe&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(ACe&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(SCe&&e instanceof Element)return!1;for(r=n;r--!=0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!yE(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var kCe=function(t,n){try{return yE(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},TCe=kCe,OCe=e=>{var{cssVarsRoot:t=":host, :root",theme:n,children:r}=e,i=zr(()=>_Ce(n),[n]);return pe(vSe,{theme:i},pe(XR,{styles:a=>({[t]:a.__cssVars})}),r)};function nG(){var e=ir(o1);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var[m1,ta]=ec({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "}),ICe=()=>{var{colorMode:e}=dF();return pe(XR,{styles:t=>{var n=aE(t,"styles.global"),r=Hu(n,{theme:t,colorMode:e});if(!!r){var i=KH(r)(t);return i}}})},NCe=["a","b","article","aside","blockquote","button","caption","cite","circle","code","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","img","input","kbd","label","li","main","mark","nav","ol","p","path","pre","q","rect","s","svg","section","select","strong","small","span","sub","sup","table","tbody","td","textarea","tfoot","th","thead","tr","ul"];function Ss(e){return QR(e,["styleConfig","size","variant","colorScheme"])}function kF(){return kF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kF.apply(this,arguments)}function DCe(){var e=dF(),t=nG();return kF({},e,{theme:t})}var RCe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,FCe=sH(function(e){return RCe.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),MCe=FCe,PCe=function(t){return t!=="theme"},rG=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?MCe:PCe},iG=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},$Ce=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,o;n!==void 0&&(a=n.label,o=n.target);var s=iG(t,n,r),u=s||rG(i),l=!u("as");return function(){var c=arguments,f=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),c[0]==null||c[0].raw===void 0)f.push.apply(f,c);else{f.push(c[0][0]);for(var d=c.length,h=1;h<d;h++)f.push(c[h],c[0][h])}var p=bH(function(g,m,v){var y=l&&g.as||i,b="",x=[],w=g;if(g.theme==null){w={};for(var S in g)w[S]=g[S];w.theme=ir(o1)}typeof g.className=="string"?b=lSe(m.registered,x,g.className):g.className!=null&&(b=g.className+" ");var C=KR(f.concat(x),m.registered,w);hH(m,C,typeof y=="string"),b+=m.key+"-"+C.name,o!==void 0&&(b+=" "+o);var _=l&&s===void 0?rG(y):u,E={};for(var A in g)l&&A==="as"||_(A)&&(E[A]=g[A]);E.className=b,E.ref=v;var k=pe(y,E);return k});return p.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=i,p.__emotion_styles=f,p.__emotion_forwardProp=s,Object.defineProperty(p,"toString",{value:function(){return"."+o}}),p.withComponent=function(g,m){return e(g,Zp({},n,m,{shouldForwardProp:iG(p,m,!0)})).apply(void 0,f)},p}},LCe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],TF=$Ce.bind();LCe.forEach(function(e){TF[e]=TF(e)});var BCe=new Set([...oCe,"textStyle","layerStyle","apply","isTruncated","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),zCe=new Set(["htmlWidth","htmlHeight","htmlSize"]),jCe=e=>zCe.has(e)||!BCe.has(e);function aG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var UCe=e=>{var{baseStyle:t}=e;return n=>{var{css:r,__css:i,sx:a}=n,o=aG(n,["theme","css","__css","sx"]),s=EH(o,(f,d)=>uCe(d)),u=Hu(t,n),l=Object.assign({},i,u,oE(s),a),c=KH(l)(n.theme);return r?[c,r]:c}};function WCe(e,t){var n=t??{},{baseStyle:r}=n,i=aG(n,["baseStyle"]);i.shouldForwardProp||(i.shouldForwardProp=jCe);var a=UCe({baseStyle:r});return TF(e,i)(a)}var Nt=WCe;NCe.forEach(e=>{Nt[e]=Nt(e)});function Qt(e){return Gl(e)}function VCe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Qp(e,t,n){var r,i;t===void 0&&(t={}),n===void 0&&(n={});var{styleConfig:a}=t,o=VCe(t,["styleConfig"]),{theme:s,colorMode:u}=DCe(),l=aE(s,"components."+e),c=a||l,f=Jl({theme:s,colorMode:u},(r=c==null?void 0:c.defaultProps)!=null?r:{},oE(QR(o,["children"]))),d=cn({});return zr(()=>{if(c){var h,p,g,m,v,y,b=Hu((h=c.baseStyle)!=null?h:{},f),x=Hu((p=(g=c.variants)==null?void 0:g[f.variant])!=null?p:{},f),w=Hu((m=(v=c.sizes)==null?void 0:v[f.size])!=null?m:{},f),S=Jl({},b,w,x);(y=n)!=null&&y.isMultiPart&&c.parts&&c.parts.forEach(_=>{var E;S[_]=(E=S[_])!=null?E:{}});var C=TCe(d.current,S);C||(d.current=S)}return d.current},[c,f,(i=n)==null?void 0:i.isMultiPart])}function Ud(e,t){return Qp(e,t,{isMultiPart:!0})}var qCe=["container","button","panel","icon"],HCe={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},GCe={transitionProperty:"common",transitionDuration:"normal",fontSize:"1rem",_focus:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:4,py:2},KCe={pt:2,px:4,pb:5},XCe={fontSize:"1.25em"},YCe={container:HCe,button:GCe,panel:KCe,icon:XCe},ZCe={parts:qCe,baseStyle:YCe},oG={exports:{}};(function(e){(function(t){var n=/^\s+/,r=/\s+$/,i=0,a=t.round,o=t.min,s=t.max,u=t.random;function l(L,z){if(L=L||"",z=z||{},L instanceof l)return L;if(!(this instanceof l))return new l(L,z);var R=c(L);this._originalInput=L,this._r=R.r,this._g=R.g,this._b=R.b,this._a=R.a,this._roundA=a(100*this._a)/100,this._format=z.format||R.format,this._gradientType=z.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=R.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var L=this.toRgb();return(L.r*299+L.g*587+L.b*114)/1e3},getLuminance:function(){var L=this.toRgb(),z,R,Z,xe,Ee,Me;return z=L.r/255,R=L.g/255,Z=L.b/255,z<=.03928?xe=z/12.92:xe=t.pow((z+.055)/1.055,2.4),R<=.03928?Ee=R/12.92:Ee=t.pow((R+.055)/1.055,2.4),Z<=.03928?Me=Z/12.92:Me=t.pow((Z+.055)/1.055,2.4),.2126*xe+.7152*Ee+.0722*Me},setAlpha:function(L){return this._a=Y(L),this._roundA=a(100*this._a)/100,this},toHsv:function(){var L=p(this._r,this._g,this._b);return{h:L.h*360,s:L.s,v:L.v,a:this._a}},toHsvString:function(){var L=p(this._r,this._g,this._b),z=a(L.h*360),R=a(L.s*100),Z=a(L.v*100);return this._a==1?"hsv("+z+", "+R+"%, "+Z+"%)":"hsva("+z+", "+R+"%, "+Z+"%, "+this._roundA+")"},toHsl:function(){var L=d(this._r,this._g,this._b);return{h:L.h*360,s:L.s,l:L.l,a:this._a}},toHslString:function(){var L=d(this._r,this._g,this._b),z=a(L.h*360),R=a(L.s*100),Z=a(L.l*100);return this._a==1?"hsl("+z+", "+R+"%, "+Z+"%)":"hsla("+z+", "+R+"%, "+Z+"%, "+this._roundA+")"},toHex:function(L){return m(this._r,this._g,this._b,L)},toHexString:function(L){return"#"+this.toHex(L)},toHex8:function(L){return v(this._r,this._g,this._b,this._a,L)},toHex8String:function(L){return"#"+this.toHex8(L)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(X(this._r,255)*100)+"%",g:a(X(this._g,255)*100)+"%",b:a(X(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(X(this._r,255)*100)+"%, "+a(X(this._g,255)*100)+"%, "+a(X(this._b,255)*100)+"%)":"rgba("+a(X(this._r,255)*100)+"%, "+a(X(this._g,255)*100)+"%, "+a(X(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:P[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(L){var z="#"+y(this._r,this._g,this._b,this._a),R=z,Z=this._gradientType?"GradientType = 1, ":"";if(L){var xe=l(L);R="#"+y(xe._r,xe._g,xe._b,xe._a)}return"progid:DXImageTransform.Microsoft.gradient("+Z+"startColorstr="+z+",endColorstr="+R+")"},toString:function(L){var z=!!L;L=L||this._format;var R=!1,Z=this._a<1&&this._a>=0,xe=!z&&Z&&(L==="hex"||L==="hex6"||L==="hex3"||L==="hex4"||L==="hex8"||L==="name");return xe?L==="name"&&this._a===0?this.toName():this.toRgbString():(L==="rgb"&&(R=this.toRgbString()),L==="prgb"&&(R=this.toPercentageRgbString()),(L==="hex"||L==="hex6")&&(R=this.toHexString()),L==="hex3"&&(R=this.toHexString(!0)),L==="hex4"&&(R=this.toHex8String(!0)),L==="hex8"&&(R=this.toHex8String()),L==="name"&&(R=this.toName()),L==="hsl"&&(R=this.toHslString()),L==="hsv"&&(R=this.toHsvString()),R||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(L,z){var R=L.apply(null,[this].concat([].slice.call(z)));return this._r=R._r,this._g=R._g,this._b=R._b,this.setAlpha(R._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(C,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(L,z){return L.apply(null,[this].concat([].slice.call(z)))},analogous:function(){return this._applyCombination(N,arguments)},complement:function(){return this._applyCombination(A,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},l.fromRatio=function(L,z){if(typeof L=="object"){var R={};for(var Z in L)L.hasOwnProperty(Z)&&(Z==="a"?R[Z]=L[Z]:R[Z]=$e(L[Z]));L=R}return l(L,z)};function c(L){var z={r:0,g:0,b:0},R=1,Z=null,xe=null,Ee=null,Me=!1,Ve=!1;return typeof L=="string"&&(L=ue(L)),typeof L=="object"&&(q(L.r)&&q(L.g)&&q(L.b)?(z=f(L.r,L.g,L.b),Me=!0,Ve=String(L.r).substr(-1)==="%"?"prgb":"rgb"):q(L.h)&&q(L.s)&&q(L.v)?(Z=$e(L.s),xe=$e(L.v),z=g(L.h,Z,xe),Me=!0,Ve="hsv"):q(L.h)&&q(L.s)&&q(L.l)&&(Z=$e(L.s),Ee=$e(L.l),z=h(L.h,Z,Ee),Me=!0,Ve="hsl"),L.hasOwnProperty("a")&&(R=L.a)),R=Y(R),{ok:Me,format:L.format||Ve,r:o(255,s(z.r,0)),g:o(255,s(z.g,0)),b:o(255,s(z.b,0)),a:R}}function f(L,z,R){return{r:X(L,255)*255,g:X(z,255)*255,b:X(R,255)*255}}function d(L,z,R){L=X(L,255),z=X(z,255),R=X(R,255);var Z=s(L,z,R),xe=o(L,z,R),Ee,Me,Ve=(Z+xe)/2;if(Z==xe)Ee=Me=0;else{var Je=Z-xe;switch(Me=Ve>.5?Je/(2-Z-xe):Je/(Z+xe),Z){case L:Ee=(z-R)/Je+(z<R?6:0);break;case z:Ee=(R-L)/Je+2;break;case R:Ee=(L-z)/Je+4;break}Ee/=6}return{h:Ee,s:Me,l:Ve}}function h(L,z,R){var Z,xe,Ee;L=X(L,360),z=X(z,100),R=X(R,100);function Me(Ft,et,Gt){return Gt<0&&(Gt+=1),Gt>1&&(Gt-=1),Gt<1/6?Ft+(et-Ft)*6*Gt:Gt<1/2?et:Gt<2/3?Ft+(et-Ft)*(2/3-Gt)*6:Ft}if(z===0)Z=xe=Ee=R;else{var Ve=R<.5?R*(1+z):R+z-R*z,Je=2*R-Ve;Z=Me(Je,Ve,L+1/3),xe=Me(Je,Ve,L),Ee=Me(Je,Ve,L-1/3)}return{r:Z*255,g:xe*255,b:Ee*255}}function p(L,z,R){L=X(L,255),z=X(z,255),R=X(R,255);var Z=s(L,z,R),xe=o(L,z,R),Ee,Me,Ve=Z,Je=Z-xe;if(Me=Z===0?0:Je/Z,Z==xe)Ee=0;else{switch(Z){case L:Ee=(z-R)/Je+(z<R?6:0);break;case z:Ee=(R-L)/Je+2;break;case R:Ee=(L-z)/Je+4;break}Ee/=6}return{h:Ee,s:Me,v:Ve}}function g(L,z,R){L=X(L,360)*6,z=X(z,100),R=X(R,100);var Z=t.floor(L),xe=L-Z,Ee=R*(1-z),Me=R*(1-xe*z),Ve=R*(1-(1-xe)*z),Je=Z%6,Ft=[R,Me,Ee,Ee,Ve,R][Je],et=[Ve,R,R,Me,Ee,Ee][Je],Gt=[Ee,Ee,Ve,R,R,Me][Je];return{r:Ft*255,g:et*255,b:Gt*255}}function m(L,z,R,Z){var xe=[Oe(a(L).toString(16)),Oe(a(z).toString(16)),Oe(a(R).toString(16))];return Z&&xe[0].charAt(0)==xe[0].charAt(1)&&xe[1].charAt(0)==xe[1].charAt(1)&&xe[2].charAt(0)==xe[2].charAt(1)?xe[0].charAt(0)+xe[1].charAt(0)+xe[2].charAt(0):xe.join("")}function v(L,z,R,Z,xe){var Ee=[Oe(a(L).toString(16)),Oe(a(z).toString(16)),Oe(a(R).toString(16)),Oe(ve(Z))];return xe&&Ee[0].charAt(0)==Ee[0].charAt(1)&&Ee[1].charAt(0)==Ee[1].charAt(1)&&Ee[2].charAt(0)==Ee[2].charAt(1)&&Ee[3].charAt(0)==Ee[3].charAt(1)?Ee[0].charAt(0)+Ee[1].charAt(0)+Ee[2].charAt(0)+Ee[3].charAt(0):Ee.join("")}function y(L,z,R,Z){var xe=[Oe(ve(Z)),Oe(a(L).toString(16)),Oe(a(z).toString(16)),Oe(a(R).toString(16))];return xe.join("")}l.equals=function(L,z){return!L||!z?!1:l(L).toRgbString()==l(z).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(L,z){z=z===0?0:z||10;var R=l(L).toHsl();return R.s-=z/100,R.s=Q(R.s),l(R)}function x(L,z){z=z===0?0:z||10;var R=l(L).toHsl();return R.s+=z/100,R.s=Q(R.s),l(R)}function w(L){return l(L).desaturate(100)}function S(L,z){z=z===0?0:z||10;var R=l(L).toHsl();return R.l+=z/100,R.l=Q(R.l),l(R)}function C(L,z){z=z===0?0:z||10;var R=l(L).toRgb();return R.r=s(0,o(255,R.r-a(255*-(z/100)))),R.g=s(0,o(255,R.g-a(255*-(z/100)))),R.b=s(0,o(255,R.b-a(255*-(z/100)))),l(R)}function _(L,z){z=z===0?0:z||10;var R=l(L).toHsl();return R.l-=z/100,R.l=Q(R.l),l(R)}function E(L,z){var R=l(L).toHsl(),Z=(R.h+z)%360;return R.h=Z<0?360+Z:Z,l(R)}function A(L){var z=l(L).toHsl();return z.h=(z.h+180)%360,l(z)}function k(L){var z=l(L).toHsl(),R=z.h;return[l(L),l({h:(R+120)%360,s:z.s,l:z.l}),l({h:(R+240)%360,s:z.s,l:z.l})]}function T(L){var z=l(L).toHsl(),R=z.h;return[l(L),l({h:(R+90)%360,s:z.s,l:z.l}),l({h:(R+180)%360,s:z.s,l:z.l}),l({h:(R+270)%360,s:z.s,l:z.l})]}function I(L){var z=l(L).toHsl(),R=z.h;return[l(L),l({h:(R+72)%360,s:z.s,l:z.l}),l({h:(R+216)%360,s:z.s,l:z.l})]}function N(L,z,R){z=z||6,R=R||30;var Z=l(L).toHsl(),xe=360/R,Ee=[l(L)];for(Z.h=(Z.h-(xe*z>>1)+720)%360;--z;)Z.h=(Z.h+xe)%360,Ee.push(l(Z));return Ee}function O(L,z){z=z||6;for(var R=l(L).toHsv(),Z=R.h,xe=R.s,Ee=R.v,Me=[],Ve=1/z;z--;)Me.push(l({h:Z,s:xe,v:Ee})),Ee=(Ee+Ve)%1;return Me}l.mix=function(L,z,R){R=R===0?0:R||50;var Z=l(L).toRgb(),xe=l(z).toRgb(),Ee=R/100,Me={r:(xe.r-Z.r)*Ee+Z.r,g:(xe.g-Z.g)*Ee+Z.g,b:(xe.b-Z.b)*Ee+Z.b,a:(xe.a-Z.a)*Ee+Z.a};return l(Me)},l.readability=function(L,z){var R=l(L),Z=l(z);return(t.max(R.getLuminance(),Z.getLuminance())+.05)/(t.min(R.getLuminance(),Z.getLuminance())+.05)},l.isReadable=function(L,z,R){var Z=l.readability(L,z),xe,Ee;switch(Ee=!1,xe=J(R),xe.level+xe.size){case"AAsmall":case"AAAlarge":Ee=Z>=4.5;break;case"AAlarge":Ee=Z>=3;break;case"AAAsmall":Ee=Z>=7;break}return Ee},l.mostReadable=function(L,z,R){var Z=null,xe=0,Ee,Me,Ve,Je;R=R||{},Me=R.includeFallbackColors,Ve=R.level,Je=R.size;for(var Ft=0;Ft<z.length;Ft++)Ee=l.readability(L,z[Ft]),Ee>xe&&(xe=Ee,Z=l(z[Ft]));return l.isReadable(L,Z,{level:Ve,size:Je})||!Me?Z:(R.includeFallbackColors=!1,l.mostReadable(L,["#fff","#000"],R))};var D=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=l.hexNames=V(D);function V(L){var z={};for(var R in L)L.hasOwnProperty(R)&&(z[L[R]]=R);return z}function Y(L){return L=parseFloat(L),(isNaN(L)||L<0||L>1)&&(L=1),L}function X(L,z){ce(L)&&(L="100%");var R=Ne(L);return L=o(z,s(0,parseFloat(L))),R&&(L=parseInt(L*z,10)/100),t.abs(L-z)<1e-6?1:L%z/parseFloat(z)}function Q(L){return o(1,s(0,L))}function me(L){return parseInt(L,16)}function ce(L){return typeof L=="string"&&L.indexOf(".")!=-1&&parseFloat(L)===1}function Ne(L){return typeof L=="string"&&L.indexOf("%")!=-1}function Oe(L){return L.length==1?"0"+L:""+L}function $e(L){return L<=1&&(L=L*100+"%"),L}function ve(L){return t.round(parseFloat(L)*255).toString(16)}function $(L){return me(L)/255}var F=function(){var L="[-\\+]?\\d+%?",z="[-\\+]?\\d*\\.\\d+%?",R="(?:"+z+")|(?:"+L+")",Z="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",xe="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";return{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+Z),rgba:new RegExp("rgba"+xe),hsl:new RegExp("hsl"+Z),hsla:new RegExp("hsla"+xe),hsv:new RegExp("hsv"+Z),hsva:new RegExp("hsva"+xe),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function q(L){return!!F.CSS_UNIT.exec(L)}function ue(L){L=L.replace(n,"").replace(r,"").toLowerCase();var z=!1;if(D[L])L=D[L],z=!0;else if(L=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var R;return(R=F.rgb.exec(L))?{r:R[1],g:R[2],b:R[3]}:(R=F.rgba.exec(L))?{r:R[1],g:R[2],b:R[3],a:R[4]}:(R=F.hsl.exec(L))?{h:R[1],s:R[2],l:R[3]}:(R=F.hsla.exec(L))?{h:R[1],s:R[2],l:R[3],a:R[4]}:(R=F.hsv.exec(L))?{h:R[1],s:R[2],v:R[3]}:(R=F.hsva.exec(L))?{h:R[1],s:R[2],v:R[3],a:R[4]}:(R=F.hex8.exec(L))?{r:me(R[1]),g:me(R[2]),b:me(R[3]),a:$(R[4]),format:z?"name":"hex8"}:(R=F.hex6.exec(L))?{r:me(R[1]),g:me(R[2]),b:me(R[3]),format:z?"name":"hex"}:(R=F.hex4.exec(L))?{r:me(R[1]+""+R[1]),g:me(R[2]+""+R[2]),b:me(R[3]+""+R[3]),a:$(R[4]+""+R[4]),format:z?"name":"hex8"}:(R=F.hex3.exec(L))?{r:me(R[1]+""+R[1]),g:me(R[2]+""+R[2]),b:me(R[3]+""+R[3]),format:z?"name":"hex"}:!1}function J(L){var z,R;return L=L||{level:"AA",size:"small"},z=(L.level||"AA").toUpperCase(),R=(L.size||"small").toLowerCase(),z!=="AA"&&z!=="AAA"&&(z="AA"),R!=="small"&&R!=="large"&&(R="small"),{level:z,size:R}}e.exports?e.exports=l:window.tinycolor=l})(Math)})(oG);var bE=oG.exports,Pi=(e,t,n)=>{var r=aE(e,"colors."+t,t),i=bE(r).isValid();return i?r:n},JCe=e=>t=>{var n=Pi(t,e),r=bE(n).isDark();return r?"dark":"light"},QCe=e=>t=>JCe(e)(t)==="dark",Bv=(e,t)=>n=>{var r=Pi(n,e);return bE(r).setAlpha(t).toRgbString()};function sG(e,t){return e===void 0&&(e="1rem"),t===void 0&&(t="rgba(255, 255, 255, 0.15)"),{backgroundImage:`linear-gradient(
    45deg,
    `+t+` 25%,
    transparent 25%,
    transparent 50%,
    `+t+` 50%,
    `+t+` 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:e+" "+e}}function eAe(e){var t=bE.random().toHexString();return!e||_Se(e)?t:e.string&&e.colors?nAe(e.string,e.colors):e.string&&!e.colors?tAe(e.string):e.colors&&!e.string?rAe(e.colors):t}function tAe(e){var t=0;if(e.length===0)return t.toString();for(var n=0;n<e.length;n+=1)t=e.charCodeAt(n)+((t<<5)-t),t=t&t;for(var r="#",i=0;i<3;i+=1){var a=t>>i*8&255;r+=("00"+a.toString(16)).substr(-2)}return r}function nAe(e,t){var n=0;if(e.length===0)return t[0];for(var r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]}function rAe(e){return e[Math.floor(Math.random()*e.length)]}function Pe(e,t){return n=>n.colorMode==="dark"?t:e}function v1(e){var{orientation:t,vertical:n,horizontal:r}=e;return t?t==="vertical"?n:r:{}}function OF(){return OF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OF.apply(this,arguments)}var iAe=e=>(rF({condition:!0,message:["[chakra-ui]: createBreakpoints(...) will be deprecated pretty soon","simply pass the breakpoints as an object. Remove the createBreakpoint(..) call"].join("")}),OF({base:"0em"},e)),aAe=["container","title","description","icon"],oAe={container:{px:4,py:3},title:{fontWeight:"bold",lineHeight:6,marginEnd:2},description:{lineHeight:6},icon:{flexShrink:0,marginEnd:3,w:5,h:6}};function IF(e){var{theme:t,colorScheme:n}=e,r=Pi(t,n+".100",n),i=Bv(n+".200",.16)(t);return Pe(r,i)(e)}function sAe(e){var{colorScheme:t}=e;return{container:{bg:IF(e)},icon:{color:Pe(t+".500",t+".200")(e)}}}function uAe(e){var{colorScheme:t}=e;return{container:{paddingStart:3,borderStartWidth:"4px",borderStartColor:Pe(t+".500",t+".200")(e),bg:IF(e)},icon:{color:Pe(t+".500",t+".200")(e)}}}function lAe(e){var{colorScheme:t}=e;return{container:{pt:2,borderTopWidth:"4px",borderTopColor:Pe(t+".500",t+".200")(e),bg:IF(e)},icon:{color:Pe(t+".500",t+".200")(e)}}}function cAe(e){var{colorScheme:t}=e;return{container:{bg:Pe(t+".500",t+".200")(e),color:Pe("white","gray.900")(e)}}}var fAe={subtle:sAe,"left-accent":uAe,"top-accent":lAe,solid:cAe},dAe={variant:"subtle",colorScheme:"blue"},hAe={parts:aAe,baseStyle:oAe,variants:fAe,defaultProps:dAe},uG={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"};function NF(){return NF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NF.apply(this,arguments)}var pAe={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem"},gAe={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},mAe=NF({},uG,pAe,{container:gAe}),lG=mAe,vAe=["container","excessLabel","badge","label"];function yAe(e){return{transform:"translate(25%, 25%)",borderRadius:"full",border:"0.2em solid",borderColor:Pe("white","gray.800")(e)}}function bAe(e){return{bg:Pe("gray.200","whiteAlpha.400")(e)}}function xAe(e){var{name:t,theme:n}=e,r=t?eAe({string:t}):"gray.400",i=QCe(r)(n),a="white";i||(a="gray.800");var o=Pe("white","gray.800")(e);return{bg:r,color:a,borderColor:o,verticalAlign:"top"}}var wAe=e=>({badge:yAe(e),excessLabel:bAe(e),container:xAe(e)});function Wd(e){var t=lG[e];return{container:{width:e,height:e,fontSize:"calc("+(t??e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(t??e)+" / 2.5)",lineHeight:e!=="100%"?t??e:void 0}}}var _Ae={"2xs":Wd("4"),xs:Wd("6"),sm:Wd("8"),md:Wd("12"),lg:Wd("16"),xl:Wd("24"),"2xl":Wd("32"),full:Wd("100%")},SAe={size:"md"},EAe={parts:vAe,baseStyle:wAe,sizes:_Ae,defaultProps:SAe},CAe={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"};function AAe(e){var{colorScheme:t,theme:n}=e,r=Bv(t+".500",.6)(n);return{bg:Pe(t+".500",r)(e),color:Pe("white","whiteAlpha.800")(e)}}function kAe(e){var{colorScheme:t,theme:n}=e,r=Bv(t+".200",.16)(n);return{bg:Pe(t+".100",r)(e),color:Pe(t+".800",t+".200")(e)}}function TAe(e){var{colorScheme:t,theme:n}=e,r=Bv(t+".200",.8)(n),i=Pi(n,t+".500"),a=Pe(i,r)(e);return{color:a,boxShadow:"inset 0 0 0px 1px "+a}}var OAe={solid:AAe,subtle:kAe,outline:TAe},IAe={variant:"subtle",colorScheme:"gray"},y1={baseStyle:CAe,variants:OAe,defaultProps:IAe},NAe=["container","item","link","separator"],DAe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},RAe={link:DAe},FAe={parts:NAe,baseStyle:RAe};function DF(){return DF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DF.apply(this,arguments)}var MAe={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}};function cG(e){var{colorScheme:t,theme:n}=e;if(t==="gray")return{color:Pe("inherit","whiteAlpha.900")(e),_hover:{bg:Pe("gray.100","whiteAlpha.200")(e)},_active:{bg:Pe("gray.200","whiteAlpha.300")(e)}};var r=Bv(t+".200",.12)(n),i=Bv(t+".200",.24)(n);return{color:Pe(t+".600",t+".200")(e),bg:"transparent",_hover:{bg:Pe(t+".50",r)(e)},_active:{bg:Pe(t+".100",i)(e)}}}function PAe(e){var{colorScheme:t}=e,n=Pe("gray.200","whiteAlpha.300")(e);return DF({border:"1px solid",borderColor:t==="gray"?n:"currentColor"},cG(e))}var $Ae={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}};function LAe(e){var{colorScheme:t}=e;if(t==="gray"){var n=Pe("gray.100","whiteAlpha.200")(e);return{bg:n,_hover:{bg:Pe("gray.200","whiteAlpha.300")(e),_disabled:{bg:n}},_active:{bg:Pe("gray.300","whiteAlpha.400")(e)}}}var{bg:r=t+".500",color:i="white",hoverBg:a=t+".600",activeBg:o=t+".700"}=$Ae[t]||{},s=Pe(r,t+".200")(e);return{bg:s,color:Pe(i,"gray.800")(e),_hover:{bg:Pe(a,t+".300")(e),_disabled:{bg:s}},_active:{bg:Pe(o,t+".400")(e)}}}function BAe(e){var{colorScheme:t}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Pe(t+".500",t+".200")(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Pe(t+".700",t+".500")(e)}}}var zAe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0},jAe={ghost:cG,outline:PAe,solid:LAe,link:BAe,unstyled:zAe},UAe={lg:{h:12,minW:12,fontSize:"lg",px:6},md:{h:10,minW:10,fontSize:"md",px:4},sm:{h:8,minW:8,fontSize:"sm",px:3},xs:{h:6,minW:6,fontSize:"xs",px:2}},WAe={variant:"solid",size:"md",colorScheme:"gray"},VAe={baseStyle:MAe,variants:jAe,sizes:UAe,defaultProps:WAe},qAe=["container","control","label","icon"];function HAe(e){var{colorScheme:t}=e;return{w:"100%",transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Pe(t+".500",t+".200")(e),borderColor:Pe(t+".500",t+".200")(e),color:Pe("white","gray.900")(e),_hover:{bg:Pe(t+".600",t+".300")(e),borderColor:Pe(t+".600",t+".300")(e)},_disabled:{borderColor:Pe("gray.200","transparent")(e),bg:Pe("gray.200","whiteAlpha.300")(e),color:Pe("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Pe(t+".500",t+".200")(e),borderColor:Pe(t+".500",t+".200")(e),color:Pe("white","gray.900")(e)},_disabled:{bg:Pe("gray.100","whiteAlpha.100")(e),borderColor:Pe("gray.100","transparent")(e)},_focus:{boxShadow:"outline"},_invalid:{borderColor:Pe("red.500","red.300")(e)}}}var GAe={userSelect:"none",_disabled:{opacity:.4}},KAe={transitionProperty:"transform",transitionDuration:"normal"},XAe=e=>({icon:KAe,control:HAe(e),label:GAe}),YAe={sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45rem"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625rem"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625rem"}}},ZAe={size:"md",colorScheme:"blue"},RF={parts:qAe,baseStyle:XAe,sizes:YAe,defaultProps:ZAe};function JAe(e){var t=Pe("blackAlpha.100","whiteAlpha.100")(e),n=Pe("blackAlpha.200","whiteAlpha.200")(e);return{borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{bg:t},_active:{bg:n},_focus:{boxShadow:"outline"}}}var QAe={lg:{w:"40px",h:"40px",fontSize:"16px"},md:{w:"32px",h:"32px",fontSize:"12px"},sm:{w:"24px",h:"24px",fontSize:"10px"}},eke={size:"md"},tke={baseStyle:JAe,sizes:QAe,defaultProps:eke},{variants:nke,defaultProps:rke}=y1,ike={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},ake={baseStyle:ike,variants:nke,defaultProps:rke},oke={w:"100%",mx:"auto",maxW:"60ch",px:"1rem"},ske={baseStyle:oke},uke={opacity:.6,borderColor:"inherit"},lke={borderStyle:"solid"},cke={borderStyle:"dashed"},fke={solid:lke,dashed:cke},dke={variant:"solid"},hke={baseStyle:uke,variants:fke,defaultProps:dke},pke=["overlay","dialogContainer","dialog","header","closeButton","body","footer"],gke={bg:"blackAlpha.600",zIndex:"modal"};function mke(e){var{isCentered:t,scrollBehavior:n}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:t?"center":"flex-start",overflow:n==="inside"?"hidden":"auto"}}function vke(e){var{scrollBehavior:t}=e;return{borderRadius:"md",bg:Pe("white","gray.700")(e),color:"inherit",my:"3.75rem",zIndex:"modal",maxH:t==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:Pe("lg","dark-lg")(e)}}var yke={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},bke={position:"absolute",top:2,insetEnd:3};function xke(e){var{scrollBehavior:t}=e;return{px:6,py:2,flex:1,overflow:t==="inside"?"auto":void 0}}var wke={px:6,py:4},_ke=e=>({overlay:gke,dialogContainer:mke(e),dialog:vke(e),header:yke,closeButton:bke,body:xke(e),footer:wke});function Ku(e){return e==="full"?{dialog:{maxW:"100vw",minH:"100vh"}}:{dialog:{maxW:e}}}var Ske={xs:Ku("xs"),sm:Ku("sm"),md:Ku("md"),lg:Ku("lg"),xl:Ku("xl"),"2xl":Ku("2xl"),"3xl":Ku("3xl"),"4xl":Ku("4xl"),"5xl":Ku("5xl"),"6xl":Ku("6xl"),full:Ku("full")},Eke={size:"md"},fG={parts:pke,baseStyle:_ke,sizes:Ske,defaultProps:Eke};function FF(){return FF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FF.apply(this,arguments)}var Cke=fG.parts;function zv(e){return e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}}}var Ake={bg:"blackAlpha.600",zIndex:"overlay"},kke={display:"flex",zIndex:"modal",justifyContent:"center"};function Tke(e){var{isFullHeight:t}=e;return FF({},t&&{height:"100vh"},{zIndex:"modal",maxH:"100vh",bg:Pe("white","gray.700")(e),color:"inherit",boxShadow:Pe("lg","dark-lg")(e)})}var Oke={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},Ike={position:"absolute",top:2,insetEnd:3},Nke={px:6,py:2,flex:1,overflow:"auto"},Dke={px:6,py:4},Rke=e=>({overlay:Ake,dialogContainer:kke,dialog:Tke(e),header:Oke,closeButton:Ike,body:Nke,footer:Dke}),Fke={xs:zv("xs"),sm:zv("md"),md:zv("lg"),lg:zv("2xl"),xl:zv("4xl"),full:zv("full")},Mke={size:"xs"},Pke={parts:Cke,baseStyle:Rke,sizes:Fke,defaultProps:Mke},$ke=["preview","input"],Lke={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal"},Bke={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal",width:"full",_focus:{boxShadow:"outline"},_placeholder:{opacity:.6}},zke={preview:Lke,input:Bke},jke={parts:$ke,baseStyle:zke},Uke=["requiredIndicator","helperText"];function Wke(e){return{marginStart:1,color:Pe("red.500","red.300")(e)}}function Vke(e){return{mt:2,color:Pe("gray.500","whiteAlpha.600")(e),lineHeight:"normal",fontSize:"sm"}}var qke=e=>({requiredIndicator:Wke(e),helperText:Vke(e)}),Hke={parts:Uke,baseStyle:qke},Gke={fontSize:"md",marginEnd:3,mb:2,fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},Kke={baseStyle:Gke},Xke={fontFamily:"heading",fontWeight:"bold"},Yke={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},Zke={size:"xl"},Jke={baseStyle:Xke,sizes:Yke,defaultProps:Zke},Qke=["field","addon"],eTe={field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal"}},Vd={lg:{fontSize:"lg",px:4,h:12,borderRadius:"md"},md:{fontSize:"md",px:4,h:10,borderRadius:"md"},sm:{fontSize:"sm",px:3,h:8,borderRadius:"sm"},xs:{fontSize:"xs",px:2,h:6,borderRadius:"sm"}},tTe={lg:{field:Vd.lg,addon:Vd.lg},md:{field:Vd.md,addon:Vd.md},sm:{field:Vd.sm,addon:Vd.sm},xs:{field:Vd.xs,addon:Vd.xs}};function MF(e){var{focusBorderColor:t,errorBorderColor:n}=e;return{focusBorderColor:t||Pe("blue.500","blue.300")(e),errorBorderColor:n||Pe("red.500","red.300")(e)}}function nTe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=MF(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Pe("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:Pi(t,r),boxShadow:"0 0 0 1px "+Pi(t,r)},_focus:{zIndex:1,borderColor:Pi(t,n),boxShadow:"0 0 0 1px "+Pi(t,n)}},addon:{border:"1px solid",borderColor:Pe("inherit","whiteAlpha.50")(e),bg:Pe("gray.100","whiteAlpha.300")(e)}}}function rTe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=MF(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Pe("gray.100","whiteAlpha.50")(e),_hover:{bg:Pe("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:Pi(t,r)},_focus:{bg:"transparent",borderColor:Pi(t,n)}},addon:{border:"2px solid",borderColor:"transparent",bg:Pe("gray.100","whiteAlpha.50")(e)}}}function iTe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=MF(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Pi(t,r),boxShadow:"0px 1px 0px 0px "+Pi(t,r)},_focus:{borderColor:Pi(t,n),boxShadow:"0px 1px 0px 0px "+Pi(t,n)}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent"}}}var aTe={field:{bg:"transparent",px:0,height:"auto"},addon:{bg:"transparent",px:0,height:"auto"}},oTe={outline:nTe,filled:rTe,flushed:iTe,unstyled:aTe},sTe={size:"md",variant:"outline"},jr={parts:Qke,baseStyle:eTe,sizes:tTe,variants:oTe,defaultProps:sTe};function uTe(e){return{bg:Pe("gray.100","whiteAlpha")(e),borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"}}var lTe={baseStyle:uTe},cTe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},fTe={baseStyle:cTe},dTe=["container","item","icon"],hTe={},pTe={},gTe={marginEnd:"0.5rem",display:"inline",verticalAlign:"text-bottom"},mTe={container:hTe,item:pTe,icon:gTe},vTe={parts:dTe,baseStyle:mTe},yTe=["item","command","list","button","groupTitle","divider"];function bTe(e){return{bg:Pe("#fff","gray.700")(e),boxShadow:Pe("sm","dark-lg")(e),color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px"}}function xTe(e){return{py:"0.4rem",px:"0.8rem",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:Pe("gray.100","whiteAlpha.100")(e)},_active:{bg:Pe("gray.200","whiteAlpha.200")(e)},_expanded:{bg:Pe("gray.100","whiteAlpha.100")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var wTe={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},_Te={opacity:.6},STe={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"0.5rem",opacity:.6},ETe={transitionProperty:"common",transitionDuration:"normal"},CTe=e=>({button:ETe,list:bTe(e),item:xTe(e),groupTitle:wTe,command:_Te,divider:STe}),ATe={parts:yTe,baseStyle:CTe},kTe={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2","3":".75rem","4":"1rem","5":"1.25rem","6":"1.5rem","7":"1.75rem","8":"2rem","9":"2.25rem","10":"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},dG=kTe,hG;function PF(){return PF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PF.apply(this,arguments)}var TTe=["root","field","stepper","stepperGroup"],{variants:OTe,defaultProps:ITe}=jr,NTe={"--number-input-stepper-width":"24px","--number-input-field-padding":"calc(var(--number-input-stepper-width) + 0.5rem)"},DTe=(hG=jr.baseStyle)==null?void 0:hG.field,RTe={width:"var(--number-input-stepper-width)"};function FTe(e){return{borderStart:"1px solid",borderStartColor:Pe("inherit","whiteAlpha.300")(e),color:Pe("inherit","whiteAlpha.800")(e),_active:{bg:Pe("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var MTe=e=>({root:NTe,field:DTe,stepperGroup:RTe,stepper:FTe(e)});function xE(e){var t=jr.sizes[e],n={lg:"md",md:"md",sm:"sm",xs:"sm"},r=dG.fontSizes[t.field.fontSize];return{field:PF({},t.field,{paddingInlineEnd:"var(--number-input-field-padding)",verticalAlign:"top"}),stepper:{fontSize:"calc("+r+" * 0.75)",_first:{borderTopEndRadius:n[e]},_last:{borderBottomEndRadius:n[e],mt:"-1px",borderTopWidth:1}}}}var PTe={xs:xE("xs"),sm:xE("sm"),md:xE("md"),lg:xE("lg")},$Te={parts:TTe,baseStyle:MTe,sizes:PTe,variants:OTe,defaultProps:ITe};function $F(){return $F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$F.apply(this,arguments)}var LTe=$F({},jr.baseStyle.field,{textAlign:"center"}),BTe={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},zTe={outline:e=>jr.variants.outline(e).field,flushed:e=>jr.variants.flushed(e).field,filled:e=>jr.variants.filled(e).field,unstyled:jr.variants.unstyled.field},jTe=jr.defaultProps,UTe={baseStyle:LTe,sizes:BTe,variants:zTe,defaultProps:jTe},WTe=["popper","content","header","body","footer","arrow"],VTe={zIndex:10};function qTe(e){var t=Pe("white","gray.700")(e),n=Pe("gray.200","whiteAlpha.300")(e);return{"--popover-bg":"colors."+t,bg:"var(--popover-bg)","--popper-arrow-bg":"var(--popover-bg)","--popper-arrow-shadow-color":"colors."+n,width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focus:{outline:0,boxShadow:"outline"}}}var HTe={px:3,py:2,borderBottomWidth:"1px"},GTe={px:3,py:2},KTe={px:3,py:2,borderTopWidth:"1px"},XTe=e=>({popper:VTe,content:qTe(e),header:HTe,body:GTe,footer:KTe,arrow:{}}),YTe={parts:WTe,baseStyle:XTe};function wE(){return wE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wE.apply(this,arguments)}var ZTe=["track","filledTrack","label"];function JTe(e){var{colorScheme:t,theme:n,isIndeterminate:r,hasStripe:i}=e,a=Pe(sG(),sG("1rem","rgba(0,0,0,0.1)"))(e),o=Pe(t+".500",t+".200")(e),s=`linear-gradient(
    to right,
    transparent 0%,
    `+Pi(n,o)+` 50%,
    transparent 100%
  )`,u=!r&&i;return wE({},u&&a,r?{bgImage:s}:{bgColor:o})}var QTe={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"};function eOe(e){return{bg:Pe("gray.100","whiteAlpha.300")(e)}}function tOe(e){return wE({transitionProperty:"common",transitionDuration:"slow"},JTe(e))}var nOe=e=>({label:QTe,filledTrack:tOe(e),track:eOe(e)}),rOe={xs:{track:{h:"0.25rem"}},sm:{track:{h:"0.5rem"}},md:{track:{h:"0.75rem"}},lg:{track:{h:"1rem"}}},iOe={size:"md",colorScheme:"blue"},aOe={parts:ZTe,sizes:rOe,baseStyle:nOe,defaultProps:iOe};function _E(){return _E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_E.apply(this,arguments)}var oOe=["container","control","label"];function sOe(e){var{control:t}=RF.baseStyle(e);return _E({},t,{borderRadius:"full",_checked:_E({},t._checked,{_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}})})}var uOe=e=>({label:RF.baseStyle(e).label,control:sOe(e)}),lOe={md:{control:{w:4,h:4},label:{fontSize:"md"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"}},sm:{control:{width:3,height:3},label:{fontSize:"sm"}}},cOe={size:"md",colorScheme:"blue"},fOe={parts:oOe,baseStyle:uOe,sizes:lOe,defaultProps:cOe};function LF(){return LF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LF.apply(this,arguments)}var dOe=["field","icon"];function hOe(e){return LF({},jr.baseStyle.field,{appearance:"none",paddingBottom:"1px",lineHeight:"normal","> option, > optgroup":{bg:Pe("white","gray.700")(e)}})}var pOe={width:"1.5rem",height:"100%",insetEnd:"0.5rem",position:"relative",color:"currentColor",fontSize:"1.25rem",_disabled:{opacity:.5}},gOe=e=>({field:hOe(e),icon:pOe}),mOe=Jl({},jr.sizes,{xs:{icon:{insetEnd:"0.25rem"}}}),vOe={parts:dOe,baseStyle:gOe,sizes:mOe,variants:jr.variants,defaultProps:jr.defaultProps},yOe=(e,t)=>xH({from:{borderColor:e,background:e},to:{borderColor:t,background:t}}),bOe=e=>{var t=Pe("gray.100","gray.800")(e),n=Pe("gray.400","gray.600")(e),{startColor:r=t,endColor:i=n,speed:a,theme:o}=e,s=Pi(o,r),u=Pi(o,i);return{opacity:.7,borderRadius:"2px",borderColor:s,background:u,animation:a+"s linear infinite alternate "+yOe(s,u)}},xOe={baseStyle:bOe},wOe=e=>({borderRadius:"md",fontWeight:"semibold",_focus:{boxShadow:"outline",padding:"1rem",position:"fixed",top:"1.5rem",insetStart:"1.5rem",bg:Pe("white","gray.700")(e)}}),_Oe={baseStyle:wOe};function SE(){return SE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SE.apply(this,arguments)}var SOe=["container","thumb","track","filledTrack"];function EOe(e){return v1({orientation:e.orientation,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})}var COe=e=>{var{orientation:t}=e;return SE({_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"}},v1({orientation:t,vertical:{h:"100%"},horizontal:{w:"100%"}}))};function AOe(e){return{borderRadius:"sm",bg:Pe("gray.200","whiteAlpha.200")(e),_disabled:{bg:Pe("gray.300","whiteAlpha.300")(e)}}}function kOe(e){return SE({zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{bg:"gray.300"}},EOe(e))}function TOe(e){var{colorScheme:t}=e;return{bg:Pe(t+".500",t+".200")(e)}}var OOe=e=>({container:COe(e),track:AOe(e),thumb:kOe(e),filledTrack:TOe(e)});function IOe(e){return{thumb:{w:"16px",h:"16px"},track:v1({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function NOe(e){return{thumb:{w:"14px",h:"14px"},track:v1({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function DOe(e){return{thumb:{w:"10px",h:"10px"},track:v1({orientation:e.orientation,horizontal:{h:"2px"},vertical:{w:"2px"}})}}var ROe={lg:IOe,md:NOe,sm:DOe},FOe={size:"md",colorScheme:"blue"},MOe={parts:SOe,sizes:ROe,baseStyle:OOe,defaultProps:FOe},POe={width:"var(--spinner-size)",height:"var(--spinner-size)"},$Oe={xs:{"--spinner-size":"0.75rem"},sm:{"--spinner-size":"1rem"},md:{"--spinner-size":"1.5rem"},lg:{"--spinner-size":"2rem"},xl:{"--spinner-size":"3rem"}},LOe={size:"md"},BOe={baseStyle:POe,sizes:$Oe,defaultProps:LOe},zOe=["label","number","icon","helpText"],jOe={fontWeight:"medium"},UOe={opacity:.8,marginBottom:2},WOe={verticalAlign:"baseline",fontWeight:"semibold"},VOe={marginEnd:1,w:"14px",h:"14px",verticalAlign:"middle"},qOe={label:jOe,helpText:UOe,number:WOe,icon:VOe},HOe={md:{label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}}},GOe={size:"md"},KOe={parts:zOe,baseStyle:qOe,sizes:HOe,defaultProps:GOe},XOe=["container","track","thumb"];function YOe(e){var{colorScheme:t}=e;return{borderRadius:"full",p:"2px",width:"var(--slider-track-width)",height:"var(--slider-track-height)",transitionProperty:"common",transitionDuration:"fast",bg:Pe("gray.300","whiteAlpha.400")(e),_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{bg:Pe(t+".500",t+".200")(e)}}}var ZOe={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:"var(--slider-track-height)",height:"var(--slider-track-height)",_checked:{transform:"translateX(var(--slider-thumb-x))"}},JOe=e=>({container:{"--slider-track-diff":"calc(var(--slider-track-width) - var(--slider-track-height))","--slider-thumb-x":"var(--slider-track-diff)",_rtl:{"--slider-thumb-x":"calc(-1 * var(--slider-track-diff))"}},track:YOe(e),thumb:ZOe}),QOe={sm:{container:{"--slider-track-width":"1.375rem","--slider-track-height":"0.75rem"}},md:{container:{"--slider-track-width":"1.875rem","--slider-track-height":"1rem"}},lg:{container:{"--slider-track-width":"2.875rem","--slider-track-height":"1.5rem"}}},eIe={size:"md",colorScheme:"blue"},tIe={parts:XOe,baseStyle:JOe,sizes:QOe,defaultProps:eIe};function jv(){return jv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jv.apply(this,arguments)}var nIe=["table","thead","tbody","tr","th","td","caption"],rIe={table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}},EE={"&[data-is-numeric=true]":{textAlign:"end"}},iIe=e=>{var{colorScheme:t}=e;return{th:jv({color:Pe("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Pe(t+".100",t+".700")(e)},EE),td:jv({borderBottom:"1px",borderColor:Pe(t+".100",t+".700")(e)},EE),caption:{color:Pe("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},aIe=e=>{var{colorScheme:t}=e;return{th:jv({color:Pe("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Pe(t+".100",t+".700")(e)},EE),td:jv({borderBottom:"1px",borderColor:Pe(t+".100",t+".700")(e)},EE),caption:{color:Pe("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Pe(t+".100",t+".700")(e)},td:{background:Pe(t+".100",t+".700")(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},oIe={simple:iIe,striped:aIe,unstyled:{}},sIe={sm:{th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}},md:{th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}},lg:{th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}}},uIe={variant:"simple",size:"md",colorScheme:"gray"},lIe={parts:nIe,baseStyle:rIe,variants:oIe,sizes:sIe,defaultProps:uIe},cIe=["root","tablist","tab","tabpanels","tabpanel","indicator"];function fIe(e){var{orientation:t}=e;return{display:t==="vertical"?"flex":"block"}}function dIe(e){var{isFitted:t}=e;return{flex:t?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focus:{zIndex:1,boxShadow:"outline"}}}function hIe(e){var{align:t="start",orientation:n}=e,r={end:"flex-end",center:"center",start:"flex-start"};return{justifyContent:r[t],flexDirection:n==="vertical"?"column":"row"}}var pIe={p:4},gIe=e=>({root:fIe(e),tab:dIe(e),tablist:hIe(e),tabpanel:pIe}),mIe={sm:{tab:{py:1,px:4,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:4}}};function vIe(e){var{colorScheme:t,orientation:n}=e,r=n==="vertical",i=n==="vertical"?"borderStart":"borderBottom",a=r?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[a]:"-2px",_selected:{color:Pe(t+".600",t+".300")(e),borderColor:"currentColor"},_active:{bg:Pe("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}}function yIe(e){var{colorScheme:t}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",_selected:{color:Pe(t+".600",t+".300")(e),borderColor:"inherit",borderBottomColor:Pe("white","gray.800")(e)}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function bIe(e){var{colorScheme:t}=e;return{tab:{border:"1px solid",borderColor:"inherit",bg:Pe("gray.50","whiteAlpha.50")(e),mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{bg:Pe("#fff","gray.800")(e),color:Pe(t+".600",t+".300")(e),borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function xIe(e){var{colorScheme:t,theme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:Pi(n,t+".700"),bg:Pi(n,t+".100")}}}}function wIe(e){var{colorScheme:t}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:Pe("gray.600","inherit")(e),_selected:{color:Pe("#fff","gray.800")(e),bg:Pe(t+".600",t+".300")(e)}}}}var _Ie={},SIe={line:vIe,enclosed:yIe,"enclosed-colored":bIe,"soft-rounded":xIe,"solid-rounded":wIe,unstyled:_Ie},EIe={size:"md",variant:"line",colorScheme:"blue"},CIe={parts:cIe,baseStyle:gIe,sizes:mIe,variants:SIe,defaultProps:EIe},AIe=["container","label","closeButton"],kIe={fontWeight:"medium",lineHeight:1.2,outline:0,_focus:{boxShadow:"outline"}},TIe={lineHeight:1.2},OIe={fontSize:"18px",w:"1.25rem",h:"1.25rem",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"0.375rem",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focus:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},IIe={container:kIe,label:TIe,closeButton:OIe},NIe={sm:{container:{minH:"1.25rem",minW:"1.25rem",fontSize:"xs",px:2,borderRadius:"md"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}},md:{container:{minH:"1.5rem",minW:"1.5rem",fontSize:"sm",borderRadius:"md",px:2}},lg:{container:{minH:8,minW:8,fontSize:"md",borderRadius:"md",px:3}}},DIe={subtle:e=>({container:y1.variants.subtle(e)}),solid:e=>({container:y1.variants.solid(e)}),outline:e=>({container:y1.variants.outline(e)})},RIe={size:"md",variant:"subtle",colorScheme:"gray"},FIe={parts:AIe,variants:DIe,baseStyle:IIe,sizes:NIe,defaultProps:RIe};function BF(){return BF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BF.apply(this,arguments)}var MIe=BF({},jr.baseStyle.field,{paddingY:"8px",minHeight:"80px",lineHeight:"short",verticalAlign:"top"}),PIe={outline:e=>jr.variants.outline(e).field,flushed:e=>jr.variants.flushed(e).field,filled:e=>jr.variants.filled(e).field,unstyled:jr.variants.unstyled.field},$Ie={xs:jr.sizes.xs.field,sm:jr.sizes.sm.field,md:jr.sizes.md.field,lg:jr.sizes.lg.field},LIe={size:"md",variant:"outline"},BIe={baseStyle:MIe,sizes:$Ie,variants:PIe,defaultProps:LIe};function zIe(e){var t=Pe("gray.700","gray.300")(e);return{"--tooltip-bg":"colors."+t,px:"8px",py:"2px",bg:"var(--tooltip-bg)","--popper-arrow-bg":"var(--tooltip-bg)",color:Pe("whiteAlpha.900","gray.900")(e),borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"320px",zIndex:"tooltip"}}var jIe={baseStyle:zIe},UIe=["text","icon"];function WIe(e){return{color:Pe("red.500","red.300")(e),mt:2,fontSize:"sm"}}function VIe(e){return{marginEnd:"0.5em",color:Pe("red.500","red.300")(e)}}var qIe=e=>({text:WIe(e),icon:VIe(e)}),HIe={parts:UIe,baseStyle:qIe},GIe={Accordion:ZCe,Alert:hAe,Avatar:EAe,Badge:y1,Breadcrumb:FAe,Button:VAe,Checkbox:RF,CloseButton:tke,Code:ake,Container:ske,Divider:hke,Drawer:Pke,Editable:jke,Form:Hke,FormLabel:Kke,Heading:Jke,Input:jr,Kbd:lTe,Link:fTe,List:vTe,Menu:ATe,Modal:fG,NumberInput:$Te,PinInput:UTe,Popover:YTe,Progress:aOe,Radio:fOe,Select:vOe,Skeleton:xOe,SkipLink:_Oe,Slider:MOe,Spinner:BOe,Stat:KOe,Switch:tIe,Table:lIe,Tabs:CIe,Tag:FIe,Textarea:BIe,Tooltip:jIe,FormError:HIe},KIe={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},XIe=KIe,YIe=iAe({sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"}),ZIe=YIe,JIe={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},QIe=JIe,eNe={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},tNe=eNe,nNe={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},rNe=nNe,iNe={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},aNe={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},oNe={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},sNe={property:iNe,easing:aNe,duration:oNe},uNe=sNe,lNe={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},cNe=lNe,fNe={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},dNe=fNe;function zF(){return zF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zF.apply(this,arguments)}var hNe=zF({breakpoints:ZIe,zIndices:cNe,radii:tNe,blur:dNe,colors:QIe},dG,{sizes:lG,shadows:rNe,space:uG,borders:XIe,transition:uNe}),pNe=hNe,gNe={global:e=>({body:{fontFamily:"body",color:Pe("gray.800","whiteAlpha.900")(e),bg:Pe("white","gray.800")(e),transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:Pe("gray.400","whiteAlpha.400")(e)},"*, *::before, &::after":{borderColor:Pe("gray.200","whiteAlpha.300")(e),wordWrap:"break-word"}})},mNe=gNe;function jF(){return jF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jF.apply(this,arguments)}var vNe="ltr",yNe={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},bNe=jF({direction:vNe},pNe,{components:GIe,styles:mNe,config:yNe}),xNe=bNe,wNe={body:{classList:{add(){},remove(){}}},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}}},pG=wNe,Uv=()=>{},_Ne={document:pG,navigator:{userAgent:""},CustomEvent:function(){return this},addEventListener:Uv,removeEventListener:Uv,getComputedStyle(){return{getPropertyValue(){return""}}},matchMedia(){return{matches:!1,addListener:Uv,removeListener:Uv}},requestAnimationFrame(e){return typeof setTimeout=="undefined"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout!="undefined"&&clearTimeout(e)},setTimeout:()=>0,clearTimeout:Uv,setInterval:()=>0,clearInterval:Uv},SNe=_Ne,ENe={window:SNe,document:pG},gG=Dv?{window,document}:ENe,CNe=Na(gG);function ANe(e){var{children:t,environment:n}=e,[r,i]=xn(null),a=zr(()=>{var s,u=r==null?void 0:r.ownerDocument,l=r==null?void 0:r.ownerDocument.defaultView,c=u?{document:u,window:l}:void 0,f=(s=n??c)!=null?s:gG;return f},[r,n]),o=!r&&!n;return Jt.createElement(CNe.Provider,{value:a},t,o&&Jt.createElement("span",{ref:s=>{s&&i(s)}}))}var kNe=e=>{var{children:t,colorModeManager:n,portalZIndex:r,resetCSS:i=!0,theme:a=xNe,environment:o,cssVarsRoot:s}=e,u=pe(ANe,{environment:o},t);return pe(sEe,null,pe(OCe,{theme:a,cssVarsRoot:s},pe(WH,{colorModeManager:n,options:a.config},i&&pe(xSe,null),pe(ICe,null),r?pe(FH,{zIndex:r},u):u)))};function b1(){return b1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b1.apply(this,arguments)}function TNe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var mG={path:pe("g",{stroke:"currentColor",strokeWidth:"1.5"},pe("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),pe("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),pe("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})),viewBox:"0 0 24 24"},x1=Qt((e,t)=>{var{as:n,viewBox:r,color:i="currentColor",focusable:a=!1,children:o,className:s,__css:u}=e,l=TNe(e,["as","viewBox","color","focusable","children","className","__css"]),c=dr("chakra-icon",s),f=b1({w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i},u),d={ref:t,focusable:a,className:c,__css:f},h=r??mG.viewBox;if(n&&typeof n!="string")return pe(Nt.svg,b1({as:n},d,l));var p=o??mG.path;return pe(Nt.svg,b1({verticalAlign:"middle",viewBox:h},d,l),p)});function UF(){return UF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UF.apply(this,arguments)}function w1(e){var{viewBox:t="0 0 24 24",d:n,path:r,displayName:i,defaultProps:a={}}=e,o=Qt((s,u)=>pe(x1,UF({ref:u,viewBox:t},a,s),r??pe("path",{fill:"currentColor",d:n})));return o}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var WF=function(e,t){return WF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},WF(e,t)};function vG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");WF(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var ze=function(){return ze=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ze.apply(this,arguments)};function Es(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function Ur(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function io(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||t)}var _f=function(e){return{isEnabled:function(t){return e.some(function(n){return!!t[n]})}}},VF={measureLayout:_f(["layout","layoutId","drag","_layoutResetTransform"]),animation:_f(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag"]),exit:_f(["exit"]),drag:_f(["drag","dragControls"]),focus:_f(["whileFocus"]),hover:_f(["whileHover","onHoverStart","onHoverEnd"]),tap:_f(["whileTap","onTap","onTapStart","onTapCancel"]),pan:_f(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),layoutAnimation:_f(["layout","layoutId"])};function ONe(e){for(var t in e){var n=e[t];n!==null&&(VF[t].Component=n)}}var _1=function(){},yG=Na({strict:!1}),bG=Object.keys(VF),INe=bG.length;function NNe(e,t,n){var r=[];if(ir(yG),!t)return null;for(var i=0;i<INe;i++){var a=bG[i],o=VF[a],s=o.isEnabled,u=o.Component;s(e)&&u&&r.push(pe(u,ze({key:a},e,{visualElement:t})))}return r}var CE=Na({transformPagePoint:function(e){return e},isStatic:!1}),AE=Na({});function DNe(){return ir(AE).visualElement}var S1=Na(null);function E1(e){var t=cn(null);return t.current===null&&(t.current=e()),t.current}function qF(){var e=ir(S1);if(e===null)return[!0,null];var t=e.isPresent,n=e.onExitComplete,r=e.register,i=PNe();an(function(){return r(i)},[]);var a=function(){return n==null?void 0:n(i)};return!t&&n?[!1,a]:[!0]}function RNe(e){return e===null?!0:e.isPresent}var FNe=0,MNe=function(){return FNe++},PNe=function(){return E1(MNe)},$Ne=Na(null),C1=typeof window!="undefined",xG=C1?vf:an;function LNe(e){var t=e.layoutId,n=ir($Ne);return n&&t!==void 0?n+"-"+t:t}function BNe(e,t,n,r){var i=ir(CE),a=ir(yG),o=DNe(),s=ir(S1),u=LNe(n),l=cn(void 0);r||(r=a.renderer),!l.current&&r&&(l.current=r(e,{visualState:t,parent:o,props:ze(ze({},n),{layoutId:u}),presenceId:s==null?void 0:s.id,blockInitialAnimation:(s==null?void 0:s.initial)===!1}));var c=l.current;return xG(function(){!c||(c.setProps(ze(ze(ze({},i),n),{layoutId:u})),c.isPresent=RNe(s),c.isPresenceRoot=!o||o.presenceId!==(s==null?void 0:s.id),c.syncRender())}),an(function(){var f;!c||(f=c.animationState)===null||f===void 0||f.animateChanges()}),xG(function(){return function(){return c==null?void 0:c.notifyUnmount()}},[]),c}function HF(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function zNe(e,t,n){return vt(function(r){var i;r&&((i=e.mount)===null||i===void 0||i.call(e,r)),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):HF(n)&&(n.current=r))},[t])}function wG(e){return Array.isArray(e)}function Xu(e){return typeof e=="string"||wG(e)}function jNe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.get()}),t}function UNe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.getVelocity()}),t}function _G(e,t,n,r,i){var a;return r===void 0&&(r={}),i===void 0&&(i={}),typeof t=="string"&&(t=(a=e.variants)===null||a===void 0?void 0:a[t]),typeof t=="function"?t(n??e.custom,r,i):t}function kE(e,t,n){var r=e.getProps();return _G(r,t,n??r.custom,jNe(e),UNe(e))}function TE(e){var t;return typeof((t=e.animate)===null||t===void 0?void 0:t.start)=="function"||Xu(e.initial)||Xu(e.animate)||Xu(e.whileHover)||Xu(e.whileDrag)||Xu(e.whileTap)||Xu(e.whileFocus)||Xu(e.exit)}function SG(e){return Boolean(TE(e)||e.variants)}function WNe(e,t){if(TE(e)){var n=e.initial,r=e.animate;return{initial:n===!1||Xu(n)?n:void 0,animate:Xu(r)?r:void 0}}return e.inherit!==!1?t:{}}function VNe(e,t){var n=WNe(e,ir(AE)),r=n.initial,i=n.animate;return zr(function(){return{initial:r,animate:i}},t?[EG(r),EG(i)]:[])}function EG(e){return Array.isArray(e)?e.join(" "):e}function qNe(e){var t=e.preloadedFeatures,n=e.createVisualElement,r=e.useRender,i=e.useVisualState,a=e.Component;t&&ONe(t);function o(s,u){var l=ir(CE).isStatic,c=null,f=VNe(s,l),d=i(s,l);return!l&&C1&&(f.visualElement=BNe(a,d,s,n),c=NNe(s,f.visualElement)),pe(Zi,null,pe(AE.Provider,{value:f},r(a,s,zNe(d,f.visualElement,u),d,l)),c)}return Gl(o)}function HNe(e){function t(r,i){return i===void 0&&(i={}),qNe(e(r,i))}var n=new Map;return new Proxy(t,{get:function(r,i){return n.has(i)||n.set(i,t(i)),n.get(i)}})}var GNe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function GF(e){return typeof e!="string"||e.includes("-")?!1:!!(GNe.indexOf(e)>-1||/[A-Z]/.test(e))}var A1={};function KNe(e){for(var t in e)A1[t]=e[t]}var XNe=["","X","Y","Z"],YNe=["translate","scale","rotate","skew"],k1=["transformPerspective","x","y","z"];YNe.forEach(function(e){return XNe.forEach(function(t){return k1.push(e+t)})});function ZNe(e,t){return k1.indexOf(e)-k1.indexOf(t)}var JNe=new Set(k1);function OE(e){return JNe.has(e)}var QNe=new Set(["originX","originY","originZ"]);function CG(e){return QNe.has(e)}function AG(e,t){var n=t.layout,r=t.layoutId;return OE(e)||CG(e)||(n||r!==void 0)&&(!!A1[e]||e==="opacity")}var qd=function(e){return e!==null&&typeof e=="object"&&e.getVelocity},eDe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function tDe(e,t,n,r){var i=e.transform,a=e.transformKeys,o=t.enableHardwareAcceleration,s=o===void 0?!0:o,u=t.allowTransformNone,l=u===void 0?!0:u,c="";a.sort(ZNe);for(var f=!1,d=a.length,h=0;h<d;h++){var p=a[h];c+=(eDe[p]||p)+"("+i[p]+") ",p==="z"&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(i,n?"":c):l&&n&&(c="none"),c}function nDe(e){var t=e.originX,n=t===void 0?"50%":t,r=e.originY,i=r===void 0?"50%":r,a=e.originZ,o=a===void 0?0:a;return n+" "+i+" "+o}function kG(e){return e.startsWith("--")}var rDe=function(e,t){return t&&typeof e=="number"?t.transform(e):e},TG=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},T1=function(e){return e%1?Number(e.toFixed(5)):e},O1=/(-)?([\d]*\.?[\d])+/g,KF=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,iDe=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function I1(e){return typeof e=="string"}var eg={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},N1=ze(ze({},eg),{transform:TG(0,1)}),IE=ze(ze({},eg),{default:1}),D1=function(e){return{test:function(t){return I1(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},Hd=D1("deg"),Wv=D1("%"),qt=D1("px"),aDe=D1("vh"),oDe=D1("vw"),OG=ze(ze({},Wv),{parse:function(e){return Wv.parse(e)/100},transform:function(e){return Wv.transform(e*100)}}),XF=function(e,t){return function(n){return Boolean(I1(n)&&iDe.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},IG=function(e,t,n){return function(r){var i;if(!I1(r))return r;var a=r.match(O1),o=a[0],s=a[1],u=a[2],l=a[3];return i={},i[e]=parseFloat(o),i[t]=parseFloat(s),i[n]=parseFloat(u),i.alpha=l!==void 0?parseFloat(l):1,i}},Vv={test:XF("hsl","hue"),parse:IG("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,i=e.alpha,a=i===void 0?1:i;return"hsla("+Math.round(t)+", "+Wv.transform(T1(n))+", "+Wv.transform(T1(r))+", "+T1(N1.transform(a))+")"}},sDe=TG(0,255),YF=ze(ze({},eg),{transform:function(e){return Math.round(sDe(e))}}),qv={test:XF("rgb","red"),parse:IG("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,i=e.alpha,a=i===void 0?1:i;return"rgba("+YF.transform(t)+", "+YF.transform(n)+", "+YF.transform(r)+", "+T1(N1.transform(a))+")"}};function uDe(e){var t="",n="",r="",i="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),i=e.substr(4,1),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var ZF={test:XF("#"),parse:uDe,transform:qv.transform},ao={test:function(e){return qv.test(e)||ZF.test(e)||Vv.test(e)},parse:function(e){return qv.test(e)?qv.parse(e):Vv.test(e)?Vv.parse(e):ZF.parse(e)},transform:function(e){return I1(e)?e:e.hasOwnProperty("red")?qv.transform(e):Vv.transform(e)}},NG="${c}",DG="${n}";function lDe(e){var t,n,r,i;return isNaN(e)&&I1(e)&&((n=(t=e.match(O1))===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+((i=(r=e.match(KF))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0}function RG(e){var t=[],n=0,r=e.match(KF);r&&(n=r.length,e=e.replace(KF,NG),t.push.apply(t,r.map(ao.parse)));var i=e.match(O1);return i&&(e=e.replace(O1,DG),t.push.apply(t,i.map(eg.parse))),{values:t,numColors:n,tokenised:e}}function FG(e){return RG(e).values}function MG(e){var t=RG(e),n=t.values,r=t.numColors,i=t.tokenised,a=n.length;return function(o){for(var s=i,u=0;u<a;u++)s=s.replace(u<r?NG:DG,u<r?ao.transform(o[u]):T1(o[u]));return s}}var cDe=function(e){return typeof e=="number"?0:e};function fDe(e){var t=FG(e),n=MG(e);return n(t.map(cDe))}var Sf={test:lDe,parse:FG,createTransformer:MG,getAnimatableNone:fDe},dDe=new Set(["brightness","contrast","saturate","opacity"]);function hDe(e){var t=e.slice(0,-1).split("("),n=t[0],r=t[1];if(n==="drop-shadow")return e;var i=(r.match(O1)||[])[0];if(!i)return e;var a=r.replace(i,""),o=dDe.has(n)?1:0;return i!==r&&(o*=100),n+"("+o+a+")"}var pDe=/([a-z-]*)\(.*?\)/g,JF=ze(ze({},Sf),{getAnimatableNone:function(e){var t=e.match(pDe);return t?t.map(hDe).join(" "):e}}),PG=ze(ze({},eg),{transform:Math.round}),$G={borderWidth:qt,borderTopWidth:qt,borderRightWidth:qt,borderBottomWidth:qt,borderLeftWidth:qt,borderRadius:qt,radius:qt,borderTopLeftRadius:qt,borderTopRightRadius:qt,borderBottomRightRadius:qt,borderBottomLeftRadius:qt,width:qt,maxWidth:qt,height:qt,maxHeight:qt,size:qt,top:qt,right:qt,bottom:qt,left:qt,padding:qt,paddingTop:qt,paddingRight:qt,paddingBottom:qt,paddingLeft:qt,margin:qt,marginTop:qt,marginRight:qt,marginBottom:qt,marginLeft:qt,rotate:Hd,rotateX:Hd,rotateY:Hd,rotateZ:Hd,scale:IE,scaleX:IE,scaleY:IE,scaleZ:IE,skew:Hd,skewX:Hd,skewY:Hd,distance:qt,translateX:qt,translateY:qt,translateZ:qt,x:qt,y:qt,z:qt,perspective:qt,transformPerspective:qt,opacity:N1,originX:OG,originY:OG,originZ:qt,zIndex:PG,fillOpacity:N1,strokeOpacity:N1,numOctaves:PG};function QF(e,t,n,r,i,a,o,s){var u,l=e.style,c=e.vars,f=e.transform,d=e.transformKeys,h=e.transformOrigin;d.length=0;var p=!1,g=!1,m=!0;for(var v in t){var y=t[v];if(kG(v)){c[v]=y;continue}var b=$G[v],x=rDe(y,b);if(OE(v)){if(p=!0,f[v]=x,d.push(v),!m)continue;y!==((u=b.default)!==null&&u!==void 0?u:0)&&(m=!1)}else if(CG(v))h[v]=x,g=!0;else if((n==null?void 0:n.isHydrated)&&(r==null?void 0:r.isHydrated)&&A1[v]){var w=A1[v].process(y,r,n),S=A1[v].applyTo;if(S)for(var C=S.length,_=0;_<C;_++)l[S[_]]=w;else l[v]=w}else l[v]=x}r&&n&&o&&s?(l.transform=o(r.deltaFinal,r.treeScale,p?f:void 0),a&&(l.transform=a(f,l.transform)),l.transformOrigin=s(r)):(p&&(l.transform=tDe(e,i,m,a)),g&&(l.transformOrigin=nDe(h)))}var e3=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function LG(e,t,n){for(var r in t)!qd(t[r])&&!AG(r,n)&&(e[r]=t[r])}function gDe(e,t,n){var r=e.transformTemplate;return zr(function(){var i=e3();QF(i,t,void 0,void 0,{enableHardwareAcceleration:!n},r);var a=i.vars,o=i.style;return ze(ze({},a),o)},[t])}function mDe(e,t,n){var r=e.style||{},i={};return LG(i,r,e),Object.assign(i,gDe(e,t,n)),e.transformValues&&(i=e.transformValues(i)),i}function vDe(e,t,n){var r={},i=mDe(e,t,n);return Boolean(e.drag)&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":"pan-"+(e.drag==="x"?"y":"x")),r.style=i,r}var yDe=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","_layoutResetTransform","onLayoutAnimationComplete","onViewportBoxUpdate","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover"]);function NE(e){return yDe.has(e)}var BG=function(e){return!NE(e)};try{var bDe=require("@emotion/is-prop-valid").default;BG=function(e){return e.startsWith("on")?!NE(e):bDe(e)}}catch(e){}function xDe(e,t,n){var r={};for(var i in e)(BG(i)||n===!0&&NE(i)||!t&&!NE(i))&&(r[i]=e[i]);return r}function zG(e,t,n){return typeof e=="string"?e:qt.transform(t+n*e)}function wDe(e,t,n){var r=zG(t,e.x,e.width),i=zG(n,e.y,e.height);return r+" "+i}var t3=function(e,t){return qt.transform(e*t)},_De={offset:"stroke-dashoffset",array:"stroke-dasharray"},SDe={offset:"strokeDashoffset",array:"strokeDasharray"};function EDe(e,t,n,r,i,a){r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=!0);var o=a?_De:SDe;e[o.offset]=t3(-i,t);var s=t3(n,t),u=t3(r,t);e[o.array]=s+" "+u}function n3(e,t,n,r,i,a,o,s){var u=t.attrX,l=t.attrY,c=t.originX,f=t.originY,d=t.pathLength,h=t.pathSpacing,p=h===void 0?1:h,g=t.pathOffset,m=g===void 0?0:g,v=Es(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);QF(e,v,n,r,i,a,o,s),e.attrs=e.style,e.style={};var y=e.attrs,b=e.style,x=e.dimensions,w=e.totalPathLength;y.transform&&(x&&(b.transform=y.transform),delete y.transform),x&&(c!==void 0||f!==void 0||b.transform)&&(b.transformOrigin=wDe(x,c!==void 0?c:.5,f!==void 0?f:.5)),u!==void 0&&(y.x=u),l!==void 0&&(y.y=l),w!==void 0&&d!==void 0&&EDe(y,w,d,p,m,!1)}var jG=function(){return ze(ze({},e3()),{attrs:{}})};function CDe(e,t){var n=zr(function(){var i=jG();return n3(i,t,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),ze(ze({},i.attrs),{style:ze({},i.style)})},[t]);if(e.style){var r={};LG(r,e.style,e),n.style=ze(ze({},r),n.style)}return n}function ADe(e){e===void 0&&(e=!1);var t=function(n,r,i,a,o){var s=a.latestValues,u=GF(n)?CDe:vDe,l=u(r,s,o),c=xDe(r,typeof n=="string",e),f=ze(ze(ze({},c),l),{ref:i});return pe(n,f)};return t}var kDe=/([a-z])([A-Z])/g,TDe="$1-$2",UG=function(e){return e.replace(kDe,TDe).toLowerCase()};function WG(e,t){var n=t.style,r=t.vars;Object.assign(e.style,n);for(var i in r)e.style.setProperty(i,r[i])}var VG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform"]);function qG(e,t){WG(e,t);for(var n in t.attrs)e.setAttribute(VG.has(n)?n:UG(n),t.attrs[n])}function r3(e){var t=e.style,n={};for(var r in t)(qd(t[r])||AG(r,e))&&(n[r]=t[r]);return n}function HG(e){var t=r3(e);for(var n in e)if(qd(e[n])){var r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;t[r]=e[n]}return t}function i3(e){return typeof e=="object"&&typeof e.start=="function"}var R1=function(e){return Array.isArray(e)},ODe=function(e){return Boolean(e&&typeof e=="object"&&e.mix&&e.toValue)},IDe=function(e){return R1(e)?e[e.length-1]||0:e};function NDe(e){var t=qd(e)?e.get():e;return ODe(t)?t.toValue():t}function GG(e,t,n,r){var i=e.scrapeMotionValuesFromProps,a=e.createRenderState,o=e.onMount,s={latestValues:DDe(t,n,r,i),renderState:a()};return o&&(s.mount=function(u){return o(t,u,s)}),s}var KG=function(e){return function(t,n){var r=ir(AE),i=ir(S1);return n?GG(e,t,r,i):E1(function(){return GG(e,t,r,i)})}};function DDe(e,t,n,r){var i={},a=(n==null?void 0:n.initial)===!1,o=r(e);for(var s in o)i[s]=NDe(o[s]);var u=e.initial,l=e.animate,c=TE(e),f=SG(e);t&&f&&!c&&e.inherit!==!1&&(u??(u=t.initial),l??(l=t.animate));var d=a||u===!1?l:u;if(d&&typeof d!="boolean"&&!i3(d)){var h=Array.isArray(d)?d:[d];h.forEach(function(p){var g=_G(e,p);if(!!g){var m=g.transitionEnd;g.transition;var v=Es(g,["transitionEnd","transition"]);for(var y in v)i[y]=v[y];for(var y in m)i[y]=m[y]}})}return i}var RDe={useVisualState:KG({scrapeMotionValuesFromProps:HG,createRenderState:jG,onMount:function(e,t,n){var r=n.renderState,i=n.latestValues;try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch(a){r.dimensions={x:0,y:0,width:0,height:0}}FDe(t)&&(r.totalPathLength=t.getTotalLength()),n3(r,i,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),qG(t,r)}})};function FDe(e){return e.tagName==="path"}var MDe={useVisualState:KG({scrapeMotionValuesFromProps:r3,createRenderState:e3})};function PDe(e,t,n,r){var i=t.forwardMotionProps,a=i===void 0?!1:i,o=GF(e)?RDe:MDe;return ze(ze({},o),{preloadedFeatures:n,useRender:ADe(a),createVisualElement:r,Component:e})}var Zr;(function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.Exit="exit"})(Zr||(Zr={}));function a3(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function o3(e,t,n,r){an(function(){var i=e.current;if(n&&i)return a3(i,t,n,r)},[e,t,n,r])}function $De(e){var t=e.whileFocus,n=e.visualElement,r=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Zr.Focus,!0)},i=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Zr.Focus,!1)};o3(n,"focus",t?r:void 0),o3(n,"blur",t?i:void 0)}function XG(e){return typeof PointerEvent!="undefined"&&e instanceof PointerEvent?e.pointerType==="mouse":e instanceof MouseEvent}function YG(e){var t=!!e.touches;return t}function LDe(e){return function(t){var n=t instanceof MouseEvent,r=!n||n&&t.button===0;r&&e(t)}}var BDe={pageX:0,pageY:0};function zDe(e,t){t===void 0&&(t="page");var n=e.touches[0]||e.changedTouches[0],r=n||BDe;return{x:r[t+"X"],y:r[t+"Y"]}}function jDe(e,t){return t===void 0&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function s3(e,t){return t===void 0&&(t="page"),{point:YG(e)?zDe(e,t):jDe(e,t)}}function UDe(e){return s3(e,"client")}var ZG=function(e,t){t===void 0&&(t=!1);var n=function(r){return e(r,s3(r))};return t?LDe(n):n},WDe=function(){return C1&&window.onpointerdown===null},VDe=function(){return C1&&window.ontouchstart===null},qDe=function(){return C1&&window.onmousedown===null},HDe={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},GDe={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function JG(e){return WDe()?e:VDe()?GDe[e]:qDe()?HDe[e]:e}function Hv(e,t,n,r){return a3(e,JG(t),ZG(n,t==="pointerdown"),r)}function DE(e,t,n,r){return o3(e,JG(t),n&&ZG(n,t==="pointerdown"),r)}function QG(e){var t=null;return function(){var n=function(){t=null};return t===null?(t=e,n):!1}}var eK=QG("dragHorizontal"),tK=QG("dragVertical");function nK(e){var t=!1;if(e==="y")t=tK();else if(e==="x")t=eK();else{var n=eK(),r=tK();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function rK(){var e=nK(!0);return e?(e(),!1):!0}function iK(e,t,n){return function(r,i){var a;!XG(r)||rK()||(n==null||n(r,i),(a=e.animationState)===null||a===void 0||a.setActive(Zr.Hover,t))}}function KDe(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,i=e.visualElement;DE(i,"pointerenter",t||r?iK(i,!0,t):void 0),DE(i,"pointerleave",n||r?iK(i,!1,n):void 0)}var aK=function(e,t){return t?e===t?!0:aK(e,t.parentElement):!1};function u3(e){return an(function(){return function(){return e()}},[])}var RE=function(e,t,n){return Math.min(Math.max(n,e),t)},l3=.001,XDe=.01,YDe=10,ZDe=.05,JDe=1;function QDe(e){var t=e.duration,n=t===void 0?800:t,r=e.bounce,i=r===void 0?.25:r,a=e.velocity,o=a===void 0?0:a,s=e.mass,u=s===void 0?1:s,l,c,f=1-i;f=RE(ZDe,JDe,f),n=RE(XDe,YDe,n/1e3),f<1?(l=function(g){var m=g*f,v=m*n,y=m-o,b=c3(g,f),x=Math.exp(-v);return l3-y/b*x},c=function(g){var m=g*f,v=m*n,y=v*o+o,b=Math.pow(f,2)*Math.pow(g,2)*n,x=Math.exp(-v),w=c3(Math.pow(g,2),f),S=-l(g)+l3>0?-1:1;return S*((y-b)*x)/w}):(l=function(g){var m=Math.exp(-g*n),v=(g-o)*n+1;return-l3+m*v},c=function(g){var m=Math.exp(-g*n),v=(o-g)*(n*n);return m*v});var d=5/n,h=tRe(l,c,d);if(n=n*1e3,isNaN(h))return{stiffness:100,damping:10,duration:n};var p=Math.pow(h,2)*u;return{stiffness:p,damping:f*2*Math.sqrt(u*p),duration:n}}var eRe=12;function tRe(e,t,n){for(var r=n,i=1;i<eRe;i++)r=r-e(r)/t(r);return r}function c3(e,t){return e*Math.sqrt(1-t*t)}var nRe=["duration","bounce"],rRe=["stiffness","damping","mass"];function oK(e,t){return t.some(function(n){return e[n]!==void 0})}function iRe(e){var t=ze({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!oK(e,rRe)&&oK(e,nRe)){var n=QDe(e);t=ze(ze(ze({},t),n),{velocity:0,mass:1}),t.isResolvedFromDuration=!0}return t}function f3(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.restSpeed,o=a===void 0?2:a,s=e.restDelta,u=Es(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=iRe(u),f=c.stiffness,d=c.damping,h=c.mass,p=c.velocity,g=c.duration,m=c.isResolvedFromDuration,v=sK,y=sK;function b(){var x=p?-(p/1e3):0,w=i-n,S=d/(2*Math.sqrt(f*h)),C=Math.sqrt(f/h)/1e3;if(s??(s=Math.abs(i-n)<=1?.01:.4),S<1){var _=c3(C,S);v=function(A){var k=Math.exp(-S*C*A);return i-k*((x+S*C*w)/_*Math.sin(_*A)+w*Math.cos(_*A))},y=function(A){var k=Math.exp(-S*C*A);return S*C*k*(Math.sin(_*A)*(x+S*C*w)/_+w*Math.cos(_*A))-k*(Math.cos(_*A)*(x+S*C*w)-_*w*Math.sin(_*A))}}else if(S===1)v=function(A){return i-Math.exp(-C*A)*(w+(x+C*w)*A)};else{var E=C*Math.sqrt(S*S-1);v=function(A){var k=Math.exp(-S*C*A),T=Math.min(E*A,300);return i-k*((x+S*C*w)*Math.sinh(T)+E*w*Math.cosh(T))/E}}}return b(),{next:function(x){var w=v(x);if(m)l.done=x>=g;else{var S=y(x)*1e3,C=Math.abs(S)<=o,_=Math.abs(i-w)<=s;l.done=C&&_}return l.value=l.done?i:w,l},flipTarget:function(){var x;p=-p,x=[i,n],n=x[0],i=x[1],b()}}}f3.needsInterpolation=function(e,t){return typeof e=="string"||typeof t=="string"};var sK=function(e){return 0},F1=function(e,t,n){var r=t-e;return r===0?1:(n-e)/r},jo=function(e,t,n){return-n*e+n*t+e},aRe=function(e,t,n){var r=e*e,i=t*t;return Math.sqrt(Math.max(0,n*(i-r)+r))},oRe=[ZF,qv,Vv],uK=function(e){return oRe.find(function(t){return t.test(e)})},lK=function(e,t){var n=uK(e),r=uK(t);_1(n.transform===r.transform);var i=n.parse(e),a=r.parse(t),o=ze({},i),s=n===Vv?jo:aRe;return function(u){for(var l in o)l!=="alpha"&&(o[l]=s(i[l],a[l],u));return o.alpha=jo(i.alpha,a.alpha,u),n.transform(o)}},d3=function(e){return typeof e=="number"},sRe=function(e,t){return function(n){return t(e(n))}},M1=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(sRe)};function cK(e,t){return d3(e)?function(n){return jo(e,t,n)}:ao.test(e)?lK(e,t):hK(e,t)}var fK=function(e,t){var n=io([],e),r=n.length,i=e.map(function(a,o){return cK(a,t[o])});return function(a){for(var o=0;o<r;o++)n[o]=i[o](a);return n}},uRe=function(e,t){var n=ze(ze({},e),t),r={};for(var i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=cK(e[i],t[i]));return function(a){for(var o in r)n[o]=r[o](a);return n}};function dK(e){for(var t=Sf.parse(e),n=t.length,r=0,i=0,a=0,o=0;o<n;o++)r||typeof t[o]=="number"?r++:t[o].hue!==void 0?a++:i++;return{parsed:t,numNumbers:r,numRGB:i,numHSL:a}}var hK=function(e,t){var n=Sf.createTransformer(t),r=dK(e),i=dK(t);return M1(fK(r.parsed,i.parsed),n)},lRe=function(e,t){return function(n){return jo(e,t,n)}};function cRe(e){if(typeof e=="number")return lRe;if(typeof e=="string")return ao.test(e)?lK:hK;if(Array.isArray(e))return fK;if(typeof e=="object")return uRe}function fRe(e,t,n){for(var r=[],i=n||cRe(e[0]),a=e.length-1,o=0;o<a;o++){var s=i(e[o],e[o+1]);if(t){var u=Array.isArray(t)?t[o]:t;s=M1(u,s)}r.push(s)}return r}function dRe(e,t){var n=e[0],r=e[1],i=t[0];return function(a){return i(F1(n,r,a))}}function hRe(e,t){var n=e.length,r=n-1;return function(i){var a=0,o=!1;if(i<=e[0]?o=!0:i>=e[r]&&(a=r-1,o=!0),!o){for(var s=1;s<n&&!(e[s]>i||s===r);s++);a=s-1}var u=F1(e[a],e[a+1],i);return t[a](u)}}function pK(e,t,n){var r=n===void 0?{}:n,i=r.clamp,a=i===void 0?!0:i,o=r.ease,s=r.mixer,u=e.length;_1(u===t.length),_1(!o||!Array.isArray(o)||o.length===u-1),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var l=fRe(t,o,s),c=u===2?dRe(e,l):hRe(e,l);return a?function(f){return c(RE(e[0],e[u-1],f))}:c}var FE=function(e){return function(t){return 1-e(1-t)}},h3=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},pRe=function(e){return function(t){return Math.pow(t,e)}},gK=function(e){return function(t){return t*t*((e+1)*t-e)}},gRe=function(e){var t=gK(e);return function(n){return(n*=2)<1?.5*t(n):.5*(2-Math.pow(2,-10*(n-1)))}},mK=1.525,mRe=4/11,vRe=8/11,yRe=9/10,vK=function(e){return e},p3=pRe(2),bRe=FE(p3),yK=h3(p3),bK=function(e){return 1-Math.sin(Math.acos(e))},xK=FE(bK),xRe=h3(xK),g3=gK(mK),wRe=FE(g3),_Re=h3(g3),SRe=gRe(mK),ERe=4356/361,CRe=35442/1805,ARe=16061/1805,ME=function(e){if(e===1||e===0)return e;var t=e*e;return e<mRe?7.5625*t:e<vRe?9.075*t-9.9*e+3.4:e<yRe?ERe*t-CRe*e+ARe:10.8*e*e-20.52*e+10.72},kRe=FE(ME),TRe=function(e){return e<.5?.5*(1-ME(1-e*2)):.5*ME(e*2-1)+.5};function ORe(e,t){return e.map(function(){return t||yK}).splice(0,e.length-1)}function IRe(e){var t=e.length;return e.map(function(n,r){return r!==0?r/(t-1):0})}function NRe(e,t){return e.map(function(n){return n*t})}function PE(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.ease,o=e.offset,s=e.duration,u=s===void 0?300:s,l={done:!1,value:n},c=Array.isArray(i)?i:[n,i],f=NRe(o&&o.length===c.length?o:IRe(c),u);function d(){return pK(f,c,{ease:Array.isArray(a)?a:ORe(c,a)})}var h=d();return{next:function(p){return l.value=h(p),l.done=p>=u,l},flipTarget:function(){c.reverse(),h=d()}}}function DRe(e){var t=e.velocity,n=t===void 0?0:t,r=e.from,i=r===void 0?0:r,a=e.power,o=a===void 0?.8:a,s=e.timeConstant,u=s===void 0?350:s,l=e.restDelta,c=l===void 0?.5:l,f=e.modifyTarget,d={done:!1,value:i},h=o*n,p=i+h,g=f===void 0?p:f(p);return g!==p&&(h=g-i),{next:function(m){var v=-h*Math.exp(-m/u);return d.done=!(v>c||v<-c),d.value=d.done?g:g+v,d},flipTarget:function(){}}}var wK={keyframes:PE,spring:f3,decay:DRe};function RRe(e){if(Array.isArray(e.to))return PE;if(wK[e.type])return wK[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?PE:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?f3:PE}function _K(e,t,n){return n===void 0&&(n=0),e-t-n}function FRe(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=!0),r?_K(t+-e,t,n):t-(e-t)+n}function MRe(e,t,n,r){return r?e>=t+n:e<=-n}var PRe=function(e){var t=function(n){var r=n.delta;return e(r)};return{start:function(){return Ql.update(t,!0)},stop:function(){return c1.update(t)}}};function SK(e){var t,n,r=e.from,i=e.autoplay,a=i===void 0?!0:i,o=e.driver,s=o===void 0?PRe:o,u=e.elapsed,l=u===void 0?0:u,c=e.repeat,f=c===void 0?0:c,d=e.repeatType,h=d===void 0?"loop":d,p=e.repeatDelay,g=p===void 0?0:p,m=e.onPlay,v=e.onStop,y=e.onComplete,b=e.onRepeat,x=e.onUpdate,w=Es(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),S=w.to,C,_=0,E=w.duration,A,k=!1,T=!0,I,N=RRe(w);((n=(t=N).needsInterpolation)===null||n===void 0?void 0:n.call(t,r,S))&&(I=pK([0,100],[r,S],{clamp:!1}),r=0,S=100);var O=N(ze(ze({},w),{from:r,to:S}));function D(){_++,h==="reverse"?(T=_%2==0,l=FRe(l,E,g,T)):(l=_K(l,E,g),h==="mirror"&&O.flipTarget()),k=!1,b&&b()}function P(){C.stop(),y&&y()}function V(X){if(T||(X=-X),l+=X,!k){var Q=O.next(Math.max(0,l));A=Q.value,I&&(A=I(A)),k=T?Q.done:l<=0}x==null||x(A),k&&(_===0&&(E??(E=l)),_<f?MRe(l,E,g,T)&&D():P())}function Y(){m==null||m(),C=s(V),C.start()}return a&&Y(),{stop:function(){v==null||v(),C.stop()}}}function EK(e,t){return t?e*(1e3/t):0}function $Re(e){var t=e.from,n=t===void 0?0:t,r=e.velocity,i=r===void 0?0:r,a=e.min,o=e.max,s=e.power,u=s===void 0?.8:s,l=e.timeConstant,c=l===void 0?750:l,f=e.bounceStiffness,d=f===void 0?500:f,h=e.bounceDamping,p=h===void 0?10:h,g=e.restDelta,m=g===void 0?1:g,v=e.modifyTarget,y=e.driver,b=e.onUpdate,x=e.onComplete,w;function S(D){return a!==void 0&&D<a||o!==void 0&&D>o}function C(D){return a===void 0?o:o===void 0||Math.abs(a-D)<Math.abs(o-D)?a:o}function _(D){w==null||w.stop(),w=SK(ze(ze({},D),{driver:y,onUpdate:function(P){var V;b==null||b(P),(V=D.onUpdate)===null||V===void 0||V.call(D,P)},onComplete:x}))}function E(D){_(ze({type:"spring",stiffness:d,damping:p,restDelta:m},D))}if(S(n))E({from:n,velocity:i,to:C(n)});else{var A=u*i+n;typeof v!="undefined"&&(A=v(A));var k=C(A),T=k===a?-1:1,I,N,O=function(D){I=N,N=D,i=EK(D-I,fE().delta),(T===1&&D>k||T===-1&&D<k)&&E({from:D,to:k,velocity:i})};_({type:"decay",from:n,velocity:i,timeConstant:c,power:u,restDelta:m,modifyTarget:v,onUpdate:S(A)?O:void 0})}return{stop:function(){return w==null?void 0:w.stop()}}}var m3=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},CK=function(e){return m3(e)&&e.hasOwnProperty("z")},$E=function(e,t){return Math.abs(e-t)};function AK(e,t){if(d3(e)&&d3(t))return $E(e,t);if(m3(e)&&m3(t)){var n=$E(e.x,t.x),r=$E(e.y,t.y),i=CK(e)&&CK(t)?$E(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}}var kK=function(e,t){return 1-3*t+3*e},TK=function(e,t){return 3*t-6*e},OK=function(e){return 3*e},LE=function(e,t,n){return((kK(t,n)*e+TK(t,n))*e+OK(t))*e},IK=function(e,t,n){return 3*kK(t,n)*e*e+2*TK(t,n)*e+OK(t)},LRe=1e-7,BRe=10;function zRe(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=LE(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>LRe&&++s<BRe);return o}var jRe=8,URe=.001;function WRe(e,t,n,r){for(var i=0;i<jRe;++i){var a=IK(t,n,r);if(a===0)return t;var o=LE(t,n,r)-e;t-=o/a}return t}var BE=11,zE=1/(BE-1);function VRe(e,t,n,r){if(e===t&&n===r)return vK;for(var i=new Float32Array(BE),a=0;a<BE;++a)i[a]=LE(a*zE,e,n);function o(s){for(var u=0,l=1,c=BE-1;l!==c&&i[l]<=s;++l)u+=zE;--l;var f=(s-i[l])/(i[l+1]-i[l]),d=u+f*zE,h=IK(d,e,n);return h>=URe?WRe(s,d,e,n):h===0?d:zRe(s,u,u+zE,e,n)}return function(s){return s===0||s===1?s:LE(o(s),t,r)}}function qRe(e){var t=e.onTap,n=e.onTapStart,r=e.onTapCancel,i=e.whileTap,a=e.visualElement,o=t||n||r||i,s=cn(!1),u=cn(null);function l(){var p;(p=u.current)===null||p===void 0||p.call(u),u.current=null}function c(){var p;return l(),s.current=!1,(p=a.animationState)===null||p===void 0||p.setActive(Zr.Tap,!1),!rK()}function f(p,g){!c()||(aK(a.getInstance(),p.target)?t==null||t(p,g):r==null||r(p,g))}function d(p,g){!c()||r==null||r(p,g)}function h(p,g){var m;l(),!s.current&&(s.current=!0,u.current=M1(Hv(window,"pointerup",f),Hv(window,"pointercancel",d)),n==null||n(p,g),(m=a.animationState)===null||m===void 0||m.setActive(Zr.Tap,!0))}DE(a,"pointerdown",o?h:void 0),u3(l)}var tg=function(e){return function(t){return e(t),null}},HRe={tap:tg(qRe),focus:tg($De),hover:tg(KDe)};function NK(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var jE=function(e){return e*1e3},GRe={linear:vK,easeIn:p3,easeInOut:yK,easeOut:bRe,circIn:bK,circInOut:xRe,circOut:xK,backIn:g3,backInOut:_Re,backOut:wRe,anticipate:SRe,bounceIn:kRe,bounceInOut:TRe,bounceOut:ME},DK=function(e){if(Array.isArray(e)){_1(e.length===4);var t=Ur(e,4),n=t[0],r=t[1],i=t[2],a=t[3];return VRe(n,r,i,a)}else if(typeof e=="string")return GRe[e];return e},KRe=function(e){return Array.isArray(e)&&typeof e[0]!="number"},RK=function(e,t){return e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&Sf.test(t)&&!t.startsWith("url("))},ng=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},UE=function(e){return{type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restDelta:.01,restSpeed:10}},v3=function(){return{type:"keyframes",ease:"linear",duration:.3}},XRe=function(e){return{type:"keyframes",duration:.8,values:e}},FK={x:ng,y:ng,z:ng,rotate:ng,rotateX:ng,rotateY:ng,rotateZ:ng,scaleX:UE,scaleY:UE,scale:UE,opacity:v3,backgroundColor:v3,color:v3,default:UE},YRe=function(e,t){var n;return R1(t)?n=XRe:n=FK[e]||FK.default,ze({to:t},n(t))},ZRe=ze(ze({},$G),{color:ao,backgroundColor:ao,outlineColor:ao,fill:ao,stroke:ao,borderColor:ao,borderTopColor:ao,borderRightColor:ao,borderBottomColor:ao,borderLeftColor:ao,filter:JF,WebkitFilter:JF}),y3=function(e){return ZRe[e]};function b3(e,t){var n,r=y3(e);return r!==JF&&(r=Sf),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,t)}function JRe(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=Es(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}function QRe(e){var t=e.ease,n=e.times,r=e.yoyo,i=e.flip,a=e.loop,o=Es(e,["ease","times","yoyo","flip","loop"]),s=ze({},o);return n&&(s.offset=n),o.duration&&(s.duration=jE(o.duration)),o.repeatDelay&&(s.repeatDelay=jE(o.repeatDelay)),t&&(s.ease=KRe(t)?t.map(DK):DK(t)),o.type==="tween"&&(s.type="keyframes"),(r||a||i)&&(r?s.repeatType="reverse":a?s.repeatType="loop":i&&(s.repeatType="mirror"),s.repeat=a||r||i||o.repeat),o.type!=="spring"&&(s.type="keyframes"),s}function eFe(e,t){var n,r=x3(e,t)||{};return(n=r.delay)!==null&&n!==void 0?n:0}function tFe(e){return Array.isArray(e.to)&&e.to[0]===null&&(e.to=io([],Ur(e.to)),e.to[0]=e.from),e}function nFe(e,t,n){var r;return Array.isArray(t.to)&&((r=e.duration)!==null&&r!==void 0||(e.duration=.8)),tFe(t),JRe(e)||(e=ze(ze({},e),YRe(n,t.to))),ze(ze({},t),QRe(e))}function rFe(e,t,n,r,i){var a,o=x3(r,e),s=(a=o.from)!==null&&a!==void 0?a:t.get(),u=RK(e,n);s==="none"&&u&&typeof n=="string"?s=b3(e,n):MK(s)&&typeof n=="string"?s=PK(n):!Array.isArray(n)&&MK(n)&&typeof s=="string"&&(n=PK(s));var l=RK(e,s);function c(){var d={from:s,to:n,velocity:t.getVelocity(),onComplete:i,onUpdate:function(h){return t.set(h)}};return o.type==="inertia"||o.type==="decay"?$Re(ze(ze({},d),o)):SK(ze(ze({},nFe(o,d,e)),{onUpdate:function(h){var p;d.onUpdate(h),(p=o.onUpdate)===null||p===void 0||p.call(o,h)},onComplete:function(){var h;d.onComplete(),(h=o.onComplete)===null||h===void 0||h.call(o)}}))}function f(){var d;return t.set(n),i(),(d=o==null?void 0:o.onComplete)===null||d===void 0||d.call(o),{stop:function(){}}}return!l||!u||o.type===!1?f:c}function MK(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function PK(e){return typeof e=="number"?0:b3("",e)}function x3(e,t){return e[t]||e.default||e}function WE(e,t,n,r){return r===void 0&&(r={}),t.start(function(i){var a,o,s=rFe(e,t,n,r,i),u=eFe(r,e),l=function(){return o=s()};return u?a=setTimeout(l,jE(u)):l(),function(){clearTimeout(a),o==null||o.stop()}})}var iFe=function(e){return/^\-?\d*\.?\d+$/.test(e)};function $K(e,t){e.indexOf(t)===-1&&e.push(t)}function LK(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var VE=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(t){var n=this;return $K(this.subscriptions,t),function(){return LK(n.subscriptions,t)}},e.prototype.notify=function(t,n,r){var i=this.subscriptions.length;if(!!i)if(i===1)this.subscriptions[0](t,n,r);else for(var a=0;a<i;a++){var o=this.subscriptions[a];o&&o(t,n,r)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),aFe=function(e){return!isNaN(parseFloat(e))},oFe=function(){function e(t){var n=this;this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new VE,this.velocityUpdateSubscribers=new VE,this.renderSubscribers=new VE,this.canTrackVelocity=!1,this.updateAndNotify=function(r,i){i===void 0&&(i=!0),n.prev=n.current,n.current=r;var a=fE(),o=a.delta,s=a.timestamp;n.lastUpdated!==s&&(n.timeDelta=o,n.lastUpdated=s,Ql.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),i&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Ql.postRender(n.velocityCheck)},this.velocityCheck=function(r){var i=r.timestamp;i!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=aFe(this.current)}return e.prototype.onChange=function(t){return this.updateSubscribers.add(t)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(t){return t(this.get()),this.renderSubscribers.add(t)},e.prototype.attach=function(t){this.passiveEffect=t},e.prototype.set=function(t,n){n===void 0&&(n=!0),!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?EK(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(t){var n=this;return this.stop(),new Promise(function(r){n.hasAnimated=!0,n.stopAnimation=t(r)}).then(function(){return n.clearAnimation()})},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function rg(e){return new oFe(e)}var BK=function(e){return function(t){return t.test(e)}},sFe={test:function(e){return e==="auto"},parse:function(e){return e}},zK=[eg,qt,Wv,Hd,oDe,aDe,sFe],qE=function(e){return zK.find(BK(e))},uFe=io(io([],Ur(zK)),[ao,Sf]),lFe=function(e){return uFe.find(BK(e))};function cFe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,rg(n))}function fFe(e,t){var n=kE(e,t),r=n?e.makeTargetAnimatable(n,!1):{},i=r.transitionEnd,a=i===void 0?{}:i;r.transition;var o=Es(r,["transitionEnd","transition"]);o=ze(ze({},o),a);for(var s in o){var u=IDe(o[s]);cFe(e,s,u)}}function dFe(e,t,n){var r,i,a,o,s=Object.keys(t).filter(function(h){return!e.hasValue(h)}),u=s.length;if(!!u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),d===null&&(d=(i=(r=n[c])!==null&&r!==void 0?r:e.readValue(c))!==null&&i!==void 0?i:t[c]),d!=null&&(typeof d=="string"&&iFe(d)?d=parseFloat(d):!lFe(d)&&Sf.test(f)&&(d=b3(c,f)),e.addValue(c,rg(d)),(a=(o=n)[c])!==null&&a!==void 0||(o[c]=d),e.setBaseTarget(c,d))}}function hFe(e,t){if(!!t){var n=t[e]||t.default||t;return n.from}}function pFe(e,t,n){var r,i,a={};for(var o in e)a[o]=(r=hFe(o,t))!==null&&r!==void 0?r:(i=n.getValue(o))===null||i===void 0?void 0:i.get();return a}function gFe(e,t,n){n===void 0&&(n={}),e.notifyAnimationStart();var r;if(Array.isArray(t)){var i=t.map(function(o){return w3(e,o,n)});r=Promise.all(i)}else if(typeof t=="string")r=w3(e,t,n);else{var a=typeof t=="function"?kE(e,t,n.custom):t;r=jK(e,a,n)}return r.then(function(){return e.notifyAnimationComplete(t)})}function w3(e,t,n){var r;n===void 0&&(n={});var i=kE(e,t,n.custom),a=(i||{}).transition,o=a===void 0?e.getDefaultTransition()||{}:a;n.transitionOverride&&(o=n.transitionOverride);var s=i?function(){return jK(e,i,n)}:function(){return Promise.resolve()},u=((r=e.variantChildren)===null||r===void 0?void 0:r.size)?function(h){h===void 0&&(h=0);var p=o.delayChildren,g=p===void 0?0:p,m=o.staggerChildren,v=o.staggerDirection;return mFe(e,t,g+h,m,v,n)}:function(){return Promise.resolve()},l=o.when;if(l){var c=Ur(l==="beforeChildren"?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}else return Promise.all([s(),u(n.delay)])}function jK(e,t,n){var r,i=n===void 0?{}:n,a=i.delay,o=a===void 0?0:a,s=i.transitionOverride,u=i.type,l=e.makeTargetAnimatable(t),c=l.transition,f=c===void 0?e.getDefaultTransition():c,d=l.transitionEnd,h=Es(l,["transition","transitionEnd"]);s&&(f=s);var p=[],g=u&&((r=e.animationState)===null||r===void 0?void 0:r.getState()[u]);for(var m in h){var v=e.getValue(m),y=h[m];if(!(!v||y===void 0||g&&yFe(g,m))){var b=WE(m,v,y,ze({delay:o},f));p.push(b)}}return Promise.all(p).then(function(){d&&fFe(e,d)})}function mFe(e,t,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1);var o=[],s=(e.variantChildren.size-1)*r,u=i===1?function(l){return l===void 0&&(l=0),l*r}:function(l){return l===void 0&&(l=0),s-l*r};return Array.from(e.variantChildren).sort(vFe).forEach(function(l,c){o.push(w3(l,t,ze(ze({},a),{delay:n+u(c)})).then(function(){return l.notifyAnimationComplete(t)}))}),Promise.all(o)}function vFe(e,t){return e.sortNodePosition(t)}function yFe(e,t){var n=e.protectedKeys,r=e.needsAnimating,i=n.hasOwnProperty(t)&&r[t]!==!0;return r[t]=!1,i}var _3=[Zr.Animate,Zr.Hover,Zr.Tap,Zr.Drag,Zr.Focus,Zr.Exit],bFe=io([],Ur(_3)).reverse(),xFe=_3.length;function wFe(e){return function(t){return Promise.all(t.map(function(n){var r=n.animation,i=n.options;return gFe(e,r,i)}))}}function _Fe(e){var t=wFe(e),n=EFe(),r={},i=!0,a=function(c,f){var d=kE(e,f);if(d){d.transition;var h=d.transitionEnd,p=Es(d,["transition","transitionEnd"]);c=ze(ze(ze({},c),p),h)}return c};function o(c){return r[c]!==void 0}function s(c){t=c(e)}function u(c,f){for(var d,h=e.getProps(),p=e.getVariantContext(!0)||{},g=[],m=new Set,v={},y=1/0,b=function(C){var _=bFe[C],E=n[_],A=(d=h[_])!==null&&d!==void 0?d:p[_],k=Xu(A),T=_===f?E.isActive:null;T===!1&&(y=C);var I=A===p[_]&&A!==h[_]&&k;if(I&&i&&e.manuallyAnimateOnMount&&(I=!1),E.protectedKeys=ze({},v),!E.isActive&&T===null||!A&&!E.prevProp||i3(A)||typeof A=="boolean")return"continue";var N=SFe(E.prevProp,A)||_===f&&E.isActive&&!I&&k||C>y&&k,O=Array.isArray(A)?A:[A],D=O.reduce(a,{});T===!1&&(D={});var P=E.prevResolvedValues,V=P===void 0?{}:P,Y=ze(ze({},V),D),X=function(Ne){N=!0,m.delete(Ne),E.needsAnimating[Ne]=!0};for(var Q in Y){var me=D[Q],ce=V[Q];v.hasOwnProperty(Q)||(me!==ce?R1(me)&&R1(ce)?NK(me,ce)?E.protectedKeys[Q]=!0:X(Q):me!==void 0?X(Q):m.add(Q):me!==void 0&&m.has(Q)?X(Q):E.protectedKeys[Q]=!0)}E.prevProp=A,E.prevResolvedValues=D,E.isActive&&(v=ze(ze({},v),D)),i&&e.blockInitialAnimation&&(N=!1),N&&!I&&g.push.apply(g,io([],Ur(O.map(function(Ne){return{animation:Ne,options:ze({type:_},c)}}))))},x=0;x<xFe;x++)b(x);if(r=ze({},v),m.size){var w={};m.forEach(function(C){var _=e.getBaseTarget(C);_!==void 0&&(w[C]=_)}),g.push({animation:w})}var S=Boolean(g.length);return i&&h.initial===!1&&!e.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function l(c,f,d){var h;return n[c].isActive===f?Promise.resolve():((h=e.variantChildren)===null||h===void 0||h.forEach(function(p){var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(c,f)}),n[c].isActive=f,u(d,c))}return{isAnimated:o,animateChanges:u,setActive:l,setAnimateFunction:s,getState:function(){return n}}}function SFe(e,t){return typeof t=="string"?t!==e:wG(t)?!NK(t,e):!1}function Gv(e){return e===void 0&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function EFe(){var e;return e={},e[Zr.Animate]=Gv(!0),e[Zr.Hover]=Gv(),e[Zr.Tap]=Gv(),e[Zr.Drag]=Gv(),e[Zr.Focus]=Gv(),e[Zr.Exit]=Gv(),e}var CFe={animation:tg(function(e){var t=e.visualElement,n=e.animate;t.animationState||(t.animationState=_Fe(t)),i3(n)&&an(function(){return n.subscribe(t)},[n])}),exit:tg(function(e){var t=e.custom,n=e.visualElement,r=Ur(qF(),2),i=r[0],a=r[1],o=ir(S1);an(function(){var s,u,l=(s=n.animationState)===null||s===void 0?void 0:s.setActive(Zr.Exit,!i,{custom:(u=o==null?void 0:o.custom)!==null&&u!==void 0?u:t});!i&&(l==null||l.then(a))},[i])})},UK=function(){function e(t,n,r){var i=this,a=r===void 0?{}:r,o=a.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(!!(i.lastMoveEvent&&i.lastMoveEventInfo)){var d=E3(i.lastMoveEventInfo,i.history),h=i.startEvent!==null,p=AK(d.offset,{x:0,y:0})>=3;if(!(!h&&!p)){var g=d.point,m=fE().timestamp;i.history.push(ze(ze({},g),{timestamp:m}));var v=i.handlers,y=v.onStart,b=v.onMove;h||(y&&y(i.lastMoveEvent,d),i.startEvent=i.lastMoveEvent),b&&b(i.lastMoveEvent,d)}}},this.handlePointerMove=function(d,h){if(i.lastMoveEvent=d,i.lastMoveEventInfo=S3(h,i.transformPagePoint),XG(d)&&d.buttons===0){i.handlePointerUp(d,h);return}Ql.update(i.updatePoint,!0)},this.handlePointerUp=function(d,h){i.end();var p=i.handlers,g=p.onEnd,m=p.onSessionEnd,v=E3(S3(h,i.transformPagePoint),i.history);i.startEvent&&g&&g(d,v),m&&m(d,v)},!(YG(t)&&t.touches.length>1)){this.handlers=n,this.transformPagePoint=o;var s=s3(t),u=S3(s,this.transformPagePoint),l=u.point,c=fE().timestamp;this.history=[ze(ze({},l),{timestamp:c})];var f=n.onSessionStart;f&&f(t,E3(u,this.history)),this.removeListeners=M1(Hv(window,"pointermove",this.handlePointerMove),Hv(window,"pointerup",this.handlePointerUp),Hv(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(t){this.handlers=t},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),c1.update(this.updatePoint)},e}();function S3(e,t){return t?{point:t(e.point)}:e}function WK(e,t){return{x:e.x-t.x,y:e.y-t.y}}function E3(e,t){var n=e.point;return{point:n,delta:WK(n,VK(t)),offset:WK(n,AFe(t)),velocity:kFe(t,.1)}}function AFe(e){return e[0]}function VK(e){return e[e.length-1]}function kFe(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,i=VK(e);n>=0&&(r=e[n],!(i.timestamp-r.timestamp>jE(t)));)n--;if(!r)return{x:0,y:0};var a=(i.timestamp-r.timestamp)/1e3;if(a===0)return{x:0,y:0};var o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function TFe(e){return e}function qK(e){var t=e.top,n=e.left,r=e.right,i=e.bottom;return{x:{min:n,max:r},y:{min:t,max:i}}}function OFe(e){var t=e.x,n=e.y;return{top:n.min,bottom:n.max,left:t.min,right:t.max}}function IFe(e,t){var n=e.top,r=e.left,i=e.bottom,a=e.right;t===void 0&&(t=TFe);var o=t({x:r,y:n}),s=t({x:a,y:i});return{top:o.y,left:o.x,bottom:s.y,right:s.x}}function Gd(){return{x:{min:0,max:1},y:{min:0,max:1}}}function NFe(e){return{x:ze({},e.x),y:ze({},e.y)}}var HK={translate:0,scale:1,origin:0,originPoint:0};function GK(){return{x:ze({},HK),y:ze({},HK)}}function Uo(e){return[e("x"),e("y")]}function KK(e,t,n){var r=t.min,i=t.max;return r!==void 0&&e<r?e=n?jo(r,e,n.min):Math.max(e,r):i!==void 0&&e>i&&(e=n?jo(i,e,n.max):Math.min(e,i)),e}function DFe(e,t,n,r,i){var a=e-t*n;return r?KK(a,r,i):a}function XK(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function RFe(e,t){var n=t.top,r=t.left,i=t.bottom,a=t.right;return{x:XK(e.x,r,a),y:XK(e.y,n,i)}}function YK(e,t){var n,r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&(n=Ur([i,r],2),r=n[0],i=n[1]),{min:e.min+r,max:e.min+i}}function FFe(e,t){return{x:YK(e.x,t.x),y:YK(e.y,t.y)}}function MFe(e,t,n){var r=e.max-e.min,i=jo(t.min,t.max-r,n);return{min:i,max:i+r}}function PFe(e,t){var n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var ZK=.35;function $Fe(e){return e===!1?e=0:e===!0&&(e=ZK),{x:JK(e,"left","right"),y:JK(e,"top","bottom")}}function JK(e,t,n){return{min:QK(e,t),max:QK(e,n)}}function QK(e,t){var n;return typeof e=="number"?e:(n=e[t])!==null&&n!==void 0?n:0}function eX(e,t){var n=e.getBoundingClientRect();return qK(IFe(n,t))}var LFe=function(e){return RE(0,1,e)};function tX(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=.01),AK(e,t)<n}function P1(e){return e.max-e.min}function BFe(e,t){var n=.5,r=P1(e),i=P1(t);return i>r?n=F1(t.min,t.max-r,e.min):r>i&&(n=F1(e.min,e.max-i,t.min)),LFe(n)}function nX(e,t,n,r){r===void 0&&(r=.5),e.origin=r,e.originPoint=jo(t.min,t.max,e.origin),e.scale=P1(n)/P1(t),tX(e.scale,1,1e-4)&&(e.scale=1),e.translate=jo(n.min,n.max,e.origin)-e.originPoint,tX(e.translate)&&(e.translate=0)}function rX(e,t,n,r){nX(e.x,t.x,n.x,iX(r.originX)),nX(e.y,t.y,n.y,iX(r.originY))}function iX(e){return typeof e=="number"?e:.5}function aX(e,t,n){e.min=n.min+t.min,e.max=e.min+P1(t)}function zFe(e,t){aX(e.target.x,e.relativeTarget.x,t.target.x),aX(e.target.y,e.relativeTarget.y,t.target.y)}var C3=function(e,t){return e.depth-t.depth};function oX(e){var t=e.projection.isEnabled;return t||e.shouldResetTransform()}function HE(e,t){t===void 0&&(t=[]);var n=e.parent;return n&&HE(n,t),oX(e)&&t.push(e),t}function jFe(e){var t=[],n=function(r){oX(r)&&t.push(r),r.children.forEach(n)};return e.children.forEach(n),t.sort(C3)}function GE(e){if(!e.shouldResetTransform()){var t=e.getLayoutState();e.notifyBeforeLayoutMeasure(t.layout),t.isHydrated=!0,t.layout=e.measureViewportBox(),t.layoutCorrected=NFe(t.layout),e.notifyLayoutMeasure(t.layout,e.prevViewportBox||t.layout),Ql.update(function(){return e.rebaseProjectionTarget()})}}function UFe(e){e.shouldResetTransform()||(e.prevViewportBox=e.measureViewportBox(!1),e.rebaseProjectionTarget(!1,e.prevViewportBox))}function WFe(e,t,n,r){e.min=jo(t.min,n.min,r),e.max=jo(t.max,n.max,r)}function sX(e,t){return{min:t.min-e.min,max:t.max-e.min}}function Kv(e,t){return{x:sX(e.x,t.x),y:sX(e.y,t.y)}}function VFe(e,t){var n=e.getLayoutId(),r=t.getLayoutId();return n!==r||r===void 0&&e!==t}function uX(e){var t=e.getProps(),n=t.drag,r=t._dragX;return n&&!r}function lX(e,t){e.min=t.min,e.max=t.max}function qFe(e,t){lX(e.x,t.x),lX(e.y,t.y)}function KE(e,t,n){var r=e-n,i=t*r;return n+i}function cX(e,t,n,r,i){return i!==void 0&&(e=KE(e,i,r)),KE(e,n,r)+t}function A3(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),e.min=cX(e.min,t,n,r,i),e.max=cX(e.max,t,n,r,i)}function HFe(e,t){var n=t.x,r=t.y;A3(e.x,n.translate,n.scale,n.originPoint),A3(e.y,r.translate,r.scale,r.originPoint)}function fX(e,t,n,r){var i=Ur(r,3),a=i[0],o=i[1],s=i[2];e.min=t.min,e.max=t.max;var u=n[s]!==void 0?n[s]:.5,l=jo(t.min,t.max,u);A3(e,n[a],n[o],l,n.scale)}var dX=["x","scaleX","originX"],hX=["y","scaleY","originY"];function k3(e,t,n){fX(e.x,t.x,n,dX),fX(e.y,t.y,n,hX)}function pX(e,t,n,r,i){return e-=t,e=KE(e,1/n,r),i!==void 0&&(e=KE(e,1/i,r)),e}function GFe(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=.5);var a=jo(e.min,e.max,r)-t;e.min=pX(e.min,t,n,a,i),e.max=pX(e.max,t,n,a,i)}function gX(e,t,n){var r=Ur(n,3),i=r[0],a=r[1],o=r[2];GFe(e,t[i],t[a],t[o],t.scale)}function mX(e,t){gX(e.x,t,dX),gX(e.y,t,hX)}function KFe(e,t,n){var r=n.length;if(!!r){t.x=t.y=1;for(var i,a,o=0;o<r;o++)i=n[o],a=i.getLayoutState().delta,t.x*=a.x.scale,t.y*=a.y.scale,HFe(e,a),uX(i)&&k3(e,e,i.getLatestValues())}}function XFe(e,t){t===void 0&&(t=!0);var n=e.getProjectionParent();if(!n)return!1;var r;return t?(r=Kv(n.projection.target,e.projection.target),mX(r,n.getLatestValues())):r=Kv(n.getLayoutState().layout,e.getLayoutState().layout),Uo(function(i){return e.setProjectionTargetAxis(i,r[i].min,r[i].max,!0)}),!0}var $1=new Set;function vX(e,t,n){e[n]||(e[n]=[]),e[n].push(t)}function T3(e){return $1.add(e),function(){return $1.delete(e)}}function O3(){if(!!$1.size){var e=0,t=[[]],n=[],r=function(s){return vX(t,s,e)},i=function(s){vX(n,s,e),e++};$1.forEach(function(s){s(r,i),e=0}),$1.clear();for(var a=n.length,o=0;o<=a;o++)t[o]&&t[o].forEach(yX),n[o]&&n[o].forEach(yX)}}var yX=function(e){return e()},YFe=new WeakMap,bX,ZFe=function(){function e(t){var n=t.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=Gd(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=n,this.visualElement.enableLayoutProjection(),YFe.set(n,this)}return e.prototype.start=function(t,n){var r=this,i=n===void 0?{}:n,a=i.snapToCursor,o=a===void 0?!1:a,s=i.cursorProgress,u=function(h){var p;r.stopMotion();var g=UDe(h).point;(p=r.cancelLayout)===null||p===void 0||p.call(r),r.cancelLayout=T3(function(m,v){var y=HE(r.visualElement),b=jFe(r.visualElement),x=io(io([],Ur(y)),Ur(b)),w=!1;r.isLayoutDrag()&&r.visualElement.lockProjectionTarget(),v(function(){x.forEach(function(S){return S.resetTransform()})}),m(function(){GE(r.visualElement),b.forEach(GE)}),v(function(){x.forEach(function(S){return S.restoreTransform()}),o&&(w=r.snapToCursor(g))}),m(function(){var S=Boolean(r.getAxisMotionValue("x")&&!r.isExternalDrag());S||r.visualElement.rebaseProjectionTarget(!0,r.visualElement.measureViewportBox(!1)),r.visualElement.scheduleUpdateLayoutProjection();var C=r.visualElement.projection;Uo(function(_){if(!w){var E=C.target[_],A=E.min,k=E.max;r.cursorProgress[_]=s?s[_]:F1(A,k,g[_])}var T=r.getAxisMotionValue(_);T&&(r.originPoint[_]=T.get())})}),v(function(){Mv.update(),Mv.preRender(),Mv.render(),Mv.postRender()}),m(function(){return r.resolveDragConstraints()})})},l=function(h,p){var g,m,v,y=r.props,b=y.drag,x=y.dragPropagation;b&&!x&&(r.openGlobalLock&&r.openGlobalLock(),r.openGlobalLock=nK(b),!r.openGlobalLock)||(O3(),r.isDragging=!0,r.currentDirection=null,(m=(g=r.props).onDragStart)===null||m===void 0||m.call(g,h,p),(v=r.visualElement.animationState)===null||v===void 0||v.setActive(Zr.Drag,!0))},c=function(h,p){var g,m,v,y,b=r.props,x=b.dragPropagation,w=b.dragDirectionLock;if(!(!x&&!r.openGlobalLock)){var S=p.offset;if(w&&r.currentDirection===null){r.currentDirection=JFe(S),r.currentDirection!==null&&((m=(g=r.props).onDirectionLock)===null||m===void 0||m.call(g,r.currentDirection));return}r.updateAxis("x",p.point,S),r.updateAxis("y",p.point,S),(y=(v=r.props).onDrag)===null||y===void 0||y.call(v,h,p),bX=h}},f=function(h,p){return r.stop(h,p)},d=this.props.transformPagePoint;this.panSession=new UK(t,{onSessionStart:u,onStart:l,onMove:c,onSessionEnd:f},{transformPagePoint:d})},e.prototype.resolveDragConstraints=function(){var t=this,n=this.props,r=n.dragConstraints,i=n.dragElastic,a=this.visualElement.getLayoutState().layoutCorrected;r?this.constraints=HF(r)?this.resolveRefConstraints(a,r):RFe(a,r):this.constraints=!1,this.elastic=$Fe(i),this.constraints&&!this.hasMutatedConstraints&&Uo(function(o){t.getAxisMotionValue(o)&&(t.constraints[o]=PFe(a[o],t.constraints[o]))})},e.prototype.resolveRefConstraints=function(t,n){var r=this.props,i=r.onMeasureDragConstraints,a=r.transformPagePoint,o=n.current;this.constraintsBox=eX(o,a);var s=FFe(t,this.constraintsBox);if(i){var u=i(OFe(s));this.hasMutatedConstraints=!!u,u&&(s=qK(u))}return s},e.prototype.cancelDrag=function(){var t,n;this.visualElement.unlockProjectionTarget(),(t=this.cancelLayout)===null||t===void 0||t.call(this),this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(Zr.Drag,!1)},e.prototype.stop=function(t,n){var r,i,a;(r=this.panSession)===null||r===void 0||r.end(),this.panSession=null;var o=this.isDragging;if(this.cancelDrag(),!!o){var s=n.velocity;this.animateDragEnd(s),(a=(i=this.props).onDragEnd)===null||a===void 0||a.call(i,t,n)}},e.prototype.snapToCursor=function(t){var n=this;return Uo(function(r){var i=n.props.drag;if(!!XE(r,i,n.currentDirection)){var a=n.getAxisMotionValue(r);if(a){var o=n.visualElement.getLayoutState().layout,s=o[r].max-o[r].min,u=o[r].min+s/2,l=t[r]-u;n.originPoint[r]=t[r],a.set(l)}else return n.cursorProgress[r]=.5,!0}}).includes(!0)},e.prototype.updateAxis=function(t,n,r){var i=this.props.drag;if(!!XE(t,i,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,r):this.updateVisualElementAxis(t,n)},e.prototype.updateAxisMotionValue=function(t,n){var r=this.getAxisMotionValue(t);if(!(!n||!r)){var i=this.originPoint[t]+n[t],a=this.constraints?KK(i,this.constraints[t],this.elastic[t]):i;r.set(a)}},e.prototype.updateVisualElementAxis=function(t,n){var r,i=this.visualElement.getLayoutState().layout[t],a=i.max-i.min,o=this.cursorProgress[t],s=DFe(n[t],a,o,(r=this.constraints)===null||r===void 0?void 0:r[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,s,s+a)},e.prototype.setProps=function(t){var n=t.drag,r=n===void 0?!1:n,i=t.dragDirectionLock,a=i===void 0?!1:i,o=t.dragPropagation,s=o===void 0?!1:o,u=t.dragConstraints,l=u===void 0?!1:u,c=t.dragElastic,f=c===void 0?ZK:c,d=t.dragMomentum,h=d===void 0?!0:d,p=Es(t,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=ze({drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:l,dragElastic:f,dragMomentum:h},p)},e.prototype.getAxisMotionValue=function(t){var n=this.props,r=n.layout,i=n.layoutId,a="_drag"+t.toUpperCase();if(this.props[a])return this.props[a];if(!r&&i===void 0)return this.visualElement.getValue(t,0)},e.prototype.isLayoutDrag=function(){return!this.getAxisMotionValue("x")},e.prototype.isExternalDrag=function(){var t=this.props,n=t._dragX,r=t._dragY;return n||r},e.prototype.animateDragEnd=function(t){var n=this,r=this.props,i=r.drag,a=r.dragMomentum,o=r.dragElastic,s=r.dragTransition,u=XFe(this.visualElement,this.isLayoutDrag()&&!this.isExternalDrag()),l=this.constraints||{};if(u&&Object.keys(l).length&&this.isLayoutDrag()){var c=this.visualElement.getProjectionParent();if(c){var f=Kv(c.projection.targetFinal,l);Uo(function(h){var p=f[h],g=p.min,m=p.max;l[h]={min:isNaN(g)?void 0:g,max:isNaN(m)?void 0:m}})}}var d=Uo(function(h){var p;if(!!XE(h,i,n.currentDirection)){var g=(p=l==null?void 0:l[h])!==null&&p!==void 0?p:{},m=o?200:1e6,v=o?40:1e7,y=ze(ze({type:"inertia",velocity:a?t[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10},s),g);return n.getAxisMotionValue(h)?n.startAxisValueAnimation(h,y):n.visualElement.startLayoutAnimation(h,y,u)}});return Promise.all(d).then(function(){var h,p;(p=(h=n.props).onDragTransitionEnd)===null||p===void 0||p.call(h)})},e.prototype.stopMotion=function(){var t=this;Uo(function(n){var r=t.getAxisMotionValue(n);r?r.stop():t.visualElement.stopLayoutAnimation()})},e.prototype.startAxisValueAnimation=function(t,n){var r=this.getAxisMotionValue(t);if(!!r){var i=r.get();return r.set(i),r.set(i),WE(t,r,0,n)}},e.prototype.scalePoint=function(){var t=this,n=this.props,r=n.drag,i=n.dragConstraints;if(!(!HF(i)||!this.constraintsBox)){this.stopMotion();var a={x:0,y:0};Uo(function(o){a[o]=BFe(t.visualElement.projection.target[o],t.constraintsBox[o])}),this.updateConstraints(function(){Uo(function(o){if(!!XE(o,r,null)){var s=MFe(t.visualElement.projection.target[o],t.constraintsBox[o],a[o]),u=s.min,l=s.max;t.visualElement.setProjectionTargetAxis(o,u,l)}})}),setTimeout(O3,1)}},e.prototype.updateConstraints=function(t){var n=this;this.cancelLayout=T3(function(r,i){var a=HE(n.visualElement);i(function(){return a.forEach(function(o){return o.resetTransform()})}),r(function(){return GE(n.visualElement)}),i(function(){return a.forEach(function(o){return o.restoreTransform()})}),r(function(){n.resolveDragConstraints()}),t&&i(t)})},e.prototype.mount=function(t){var n=this,r=t.getInstance(),i=Hv(r,"pointerdown",function(u){var l=n.props,c=l.drag,f=l.dragListener,d=f===void 0?!0:f;c&&d&&n.start(u)}),a=a3(window,"resize",function(){n.scalePoint()}),o=t.onLayoutUpdate(function(){n.isDragging&&n.resolveDragConstraints()}),s=t.prevDragCursor;return s&&this.start(bX,{cursorProgress:s}),function(){i==null||i(),a==null||a(),o==null||o(),n.cancelDrag()}},e}();function XE(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function JFe(e,t){t===void 0&&(t=10);var n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}function QFe(e){var t=e.dragControls,n=e.visualElement,r=ir(CE).transformPagePoint,i=E1(function(){return new ZFe({visualElement:n})});i.setProps(ze(ze({},e),{transformPagePoint:r})),an(function(){return t&&t.subscribe(i)},[i]),an(function(){return i.mount(n)},[])}function e3e(e){var t=e.onPan,n=e.onPanStart,r=e.onPanEnd,i=e.onPanSessionStart,a=e.visualElement,o=t||n||r||i,s=cn(null),u=ir(CE).transformPagePoint,l={onSessionStart:i,onStart:n,onMove:t,onEnd:function(f,d){s.current=null,r&&r(f,d)}};an(function(){s.current!==null&&s.current.updateHandlers(l)});function c(f){s.current=new UK(f,l,{transformPagePoint:u})}DE(a,"pointerdown",o&&c),u3(function(){return s.current&&s.current.end()})}var t3e={pan:tg(e3e),drag:tg(QFe)},L1;(function(e){e[e.Entering=0]="Entering",e[e.Present=1]="Present",e[e.Exiting=2]="Exiting"})(L1||(L1={}));var I3;(function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"})(I3||(I3={}));function N3(e){return typeof e=="string"&&e.startsWith("var(--")}var xX=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function n3e(e){var t=xX.exec(e);if(!t)return[,];var n=Ur(t,3),r=n[1],i=n[2];return[r,i]}function D3(e,t,n){var r=Ur(n3e(e),2),i=r[0],a=r[1];if(!!i){var o=window.getComputedStyle(t).getPropertyValue(i);return o?o.trim():N3(a)?D3(a,t):a}}function r3e(e,t,n){var r,i=Es(t,[]),a=e.getInstance();if(!(a instanceof HTMLElement))return{target:i,transitionEnd:n};n&&(n=ze({},n)),e.forEachValue(function(l){var c=l.get();if(!!N3(c)){var f=D3(c,a);f&&l.set(f)}});for(var o in i){var s=i[o];if(!!N3(s)){var u=D3(s,a);!u||(i[o]=u,n&&((r=n[o])!==null&&r!==void 0||(n[o]=s)))}}return{target:i,transitionEnd:n}}function wX(e,t){return e/(t.max-t.min)*100}function i3e(e,t,n){var r=n.target;if(typeof e=="string")if(qt.test(e))e=parseFloat(e);else return e;var i=wX(e,r.x),a=wX(e,r.y);return i+"% "+a+"%"}var _X="_$css";function a3e(e,t){var n=t.delta,r=t.treeScale,i=e,a=e.includes("var("),o=[];a&&(e=e.replace(xX,function(g){return o.push(g),_X}));var s=Sf.parse(e);if(s.length>5)return i;var u=Sf.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*r.x,f=n.y.scale*r.y;s[0+l]/=c,s[1+l]/=f;var d=jo(c,f,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);var h=u(s);if(a){var p=0;h=h.replace(_X,function(){var g=o[p];return p++,g})}return h}var B1={process:i3e},o3e={borderRadius:ze(ze({},B1),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:B1,borderTopRightRadius:B1,borderBottomLeftRadius:B1,borderBottomRightRadius:B1,boxShadow:{process:a3e}},SX=1e3,s3e=function(e){vG(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.frameTarget=Gd(),n.currentAnimationTarget=Gd(),n.isAnimating={x:!1,y:!1},n.stopAxisAnimation={x:void 0,y:void 0},n.isAnimatingTree=!1,n.animate=function(r,i,a){a===void 0&&(a={});var o=a.originBox,s=a.targetBox,u=a.visibilityAction,l=a.shouldStackAnimate,c=a.onComplete,f=a.prevParent,d=Es(a,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete","prevParent"]),h=n.props,p=h.visualElement,g=h.layout;if(l===!1)return n.isAnimatingTree=!1,n.safeToRemove();if(!(n.isAnimatingTree&&l!==!0)){l&&(n.isAnimatingTree=!0),i=o||i,r=s||r;var m=!1,v=p.getProjectionParent();if(v){var y=v.prevViewportBox,b=v.getLayoutState().layout;f&&(s&&(b=f.getLayoutState().layout),o&&!VFe(f,v)&&f.prevViewportBox&&(y=f.prevViewportBox)),y&&f3e(f,o,s)&&(m=!0,i=Kv(y,i),r=Kv(b,r))}var x=l3e(i,r),w=Uo(function(S){var C,_;if(g==="position"){var E=r[S].max-r[S].min;i[S].max=i[S].min+E}if(!p.projection.isTargetLocked)if(u!==void 0)p.setVisibility(u===I3.Show);else return x?n.animateAxis(S,r[S],i[S],ze(ze({},d),{isRelative:m})):((_=(C=n.stopAxisAnimation)[S])===null||_===void 0||_.call(C),p.setProjectionTargetAxis(S,r[S].min,r[S].max,m))});return p.syncRender(),Promise.all(w).then(function(){n.isAnimatingTree=!1,c&&c(),p.notifyLayoutAnimationComplete()})}},n}return t.prototype.componentDidMount=function(){var n=this,r=this.props.visualElement;r.animateMotionValue=WE,r.enableLayoutProjection(),this.unsubLayoutReady=r.onLayoutUpdate(this.animate),r.layoutSafeToRemove=function(){return n.safeToRemove()},KNe(o3e)},t.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),Uo(function(r){var i,a;return(a=(i=n.stopAxisAnimation)[r])===null||a===void 0?void 0:a.call(i)})},t.prototype.animateAxis=function(n,r,i,a){var o=this,s,u,l=a===void 0?{}:a,c=l.transition,f=l.isRelative;if(!(this.isAnimating[n]&&z1(r,this.currentAnimationTarget[n]))){(u=(s=this.stopAxisAnimation)[n])===null||u===void 0||u.call(s),this.isAnimating[n]=!0;var d=this.props.visualElement,h=this.frameTarget[n],p=d.getProjectionAnimationProgress()[n];p.clearListeners(),p.set(0),p.set(0);var g=function(){var b=p.get()/SX;WFe(h,i,r,b),d.setProjectionTargetAxis(n,h.min,h.max,f)};g();var m=p.onChange(g);this.stopAxisAnimation[n]=function(){o.isAnimating[n]=!1,p.stop(),m()},this.currentAnimationTarget[n]=r;var v=c||d.getDefaultTransition()||c3e,y=WE(n==="x"?"layoutX":"layoutY",p,SX,v&&x3(v,"layout")).then(this.stopAxisAnimation[n]);return y}},t.prototype.safeToRemove=function(){var n,r;(r=(n=this.props).safeToRemove)===null||r===void 0||r.call(n)},t.prototype.render=function(){return null},t}(ru);function u3e(e){var t=Ur(qF(),2),n=t[1];return pe(s3e,ze({},e,{safeToRemove:n}))}function l3e(e,t){return!CX(e)&&!CX(t)&&(!z1(e.x,t.x)||!z1(e.y,t.y))}var EX={min:0,max:0};function CX(e){return z1(e.x,EX)&&z1(e.y,EX)}function z1(e,t){return e.min===t.min&&e.max===t.max}var c3e={duration:.45,ease:[.4,0,.1,1]};function f3e(e,t,n){return e||!e&&!(t||n)}var d3e={layoutReady:function(e){return e.notifyLayoutReady()}};function AX(){var e=new Set;return{add:function(t){return e.add(t)},flush:function(t){var n=t===void 0?d3e:t,r=n.layoutReady,i=n.parent;T3(function(a,o){var s=Array.from(e).sort(C3),u=i?HE(i):[];o(function(){var l=io(io([],Ur(u)),Ur(s));l.forEach(function(c){return c.resetTransform()})}),a(function(){s.forEach(GE)}),o(function(){u.forEach(function(l){return l.restoreTransform()}),s.forEach(r)}),a(function(){s.forEach(function(l){l.isPresent&&(l.presence=L1.Present)})}),o(function(){Mv.preRender(),Mv.render()}),a(function(){Ql.postRender(function(){return s.forEach(h3e)}),e.clear()})}),O3()}}}function h3e(e){e.prevViewportBox=e.projection.target}var kX=Na(AX()),p3e=Na(AX());function ig(e){return!!e.forceUpdate}var g3e=function(e){vG(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){var n=this.props,r=n.syncLayout,i=n.framerSyncLayout,a=n.visualElement;ig(r)&&r.register(a),ig(i)&&i.register(a),a.onUnmount(function(){ig(r)&&r.remove(a),ig(i)&&i.remove(a)})},t.prototype.getSnapshotBeforeUpdate=function(){var n=this.props,r=n.syncLayout,i=n.visualElement;return ig(r)?r.syncUpdate():(UFe(i),r.add(i)),null},t.prototype.componentDidUpdate=function(){var n=this.props.syncLayout;ig(n)||n.flush()},t.prototype.render=function(){return null},t}(Jt.Component);function m3e(e){var t=ir(kX),n=ir(p3e);return Jt.createElement(g3e,ze({},e,{syncLayout:t,framerSyncLayout:n}))}var v3e={measureLayout:m3e,layoutAnimation:u3e},y3e=function(){return{isEnabled:!1,isHydrated:!1,isTargetLocked:!1,target:Gd(),targetFinal:Gd()}};function TX(){return{isHydrated:!1,layout:Gd(),layoutCorrected:Gd(),treeScale:{x:1,y:1},delta:GK(),deltaFinal:GK(),deltaTransform:""}}var OX=TX();function YE(e,t,n){var r=e.x,i=e.y,a=r.translate/t.x,o=i.translate/t.y,s="translate3d("+a+"px, "+o+"px, 0) ";if(n){var u=n.rotate,l=n.rotateX,c=n.rotateY;u&&(s+="rotate("+u+") "),l&&(s+="rotateX("+l+") "),c&&(s+="rotateY("+c+") ")}return s+="scale("+r.scale+", "+i.scale+")",!n&&s===b3e?"":s}function IX(e){var t=e.deltaFinal;return t.x.origin*100+"% "+t.y.origin*100+"% 0"}var b3e=YE(OX.delta,OX.treeScale,{x:1,y:1}),ZE=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","SetAxisTarget","Unmount"];function x3e(){var e=ZE.map(function(){return new VE}),t={},n={clearAllListeners:function(){return e.forEach(function(r){return r.clear()})},updatePropListeners:function(r){return ZE.forEach(function(i){var a;(a=t[i])===null||a===void 0||a.call(t);var o="on"+i,s=r[o];s&&(t[i]=n[o](s))})}};return e.forEach(function(r,i){n["on"+ZE[i]]=function(a){return r.add(a)},n["notify"+ZE[i]]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.notify.apply(r,io([],Ur(a)))}}),n}function w3e(e,t,n){var r;for(var i in t){var a=t[i],o=n[i];if(qd(a))e.addValue(i,a);else if(qd(o))e.addValue(i,rg(a));else if(o!==a)if(e.hasValue(i)){var s=e.getValue(i);!s.hasAnimated&&s.set(a)}else e.addValue(i,rg((r=e.getStaticValue(i))!==null&&r!==void 0?r:a))}for(var i in n)t[i]===void 0&&e.removeValue(i);return t}function _3e(e,t,n,r){var i=e.delta,a=e.layout,o=e.layoutCorrected,s=e.treeScale,u=t.target;qFe(o,a),KFe(o,s,n),rX(i,o,u,r)}var S3e=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(t){$K(this.children,t),this.isDirty=!0},e.prototype.remove=function(t){LK(this.children,t),this.isDirty=!0},e.prototype.forEach=function(t){this.isDirty&&this.children.sort(C3),this.isDirty=!1,this.children.forEach(t)},e}();function E3e(e){var t=e.getProjectionParent();if(!t){e.rebaseProjectionTarget();return}var n=Kv(t.getLayoutState().layout,e.getLayoutState().layout);Uo(function(r){e.setProjectionTargetAxis(r,n[r].min,n[r].max,!0)})}var NX=function(e){var t=e.treeType,n=t===void 0?"":t,r=e.build,i=e.getBaseTarget,a=e.makeTargetAnimatable,o=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.resetTransform,c=e.restoreTransform,f=e.removeValueFromRenderState,d=e.sortNodePosition,h=e.scrapeMotionValuesFromProps;return function(p,g){var m=p.parent,v=p.props,y=p.presenceId,b=p.blockInitialAnimation,x=p.visualState;g===void 0&&(g={});var w=x.latestValues,S=x.renderState,C,_=x3e(),E=y3e(),A,k=E,T=w,I,N=TX(),O,D=!1,P=new Map,V=new Map,Y={},X,Q=ze({},w),me;function ce(){!C||(z.isProjectionReady()&&(k3(k.targetFinal,k.target,T),rX(N.deltaFinal,N.layoutCorrected,k.targetFinal,w)),Ne(),s(C,S))}function Ne(){var R=w;if(O&&O.isActive()){var Z=O.getCrossfadeState(z);Z&&(R=Z)}r(z,S,R,k,N,g,v)}function Oe(){_.notifyUpdate(w)}function $e(){if(!!z.isProjectionReady()){var R=N.delta,Z=N.treeScale,xe=Z.x,Ee=Z.y,Me=N.deltaTransform;_3e(N,k,z.path,w),D&&z.notifyViewportBoxUpdate(k.target,R),D=!1;var Ve=YE(R,Z);(Ve!==Me||xe!==Z.x||Ee!==Z.y)&&z.scheduleRender(),N.deltaTransform=Ve}}function ve(){z.layoutTree.forEach(A3e)}function $(R,Z){var xe=Z.onChange(function(Me){w[R]=Me,v.onUpdate&&Ql.update(Oe,!1,!0)}),Ee=Z.onRenderRequest(z.scheduleRender);V.set(R,function(){xe(),Ee()})}var F=h(v);for(var q in F){var ue=F[q];w[q]!==void 0&&qd(ue)&&ue.set(w[q],!1)}var J=TE(v),L=SG(v),z=ze(ze({treeType:n,current:null,depth:m?m.depth+1:0,parent:m,children:new Set,path:m?io(io([],Ur(m.path)),[m]):[],layoutTree:m?m.layoutTree:new S3e,presenceId:y,projection:E,variantChildren:L?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(m==null?void 0:m.isMounted()),blockInitialAnimation:b,isMounted:function(){return Boolean(C)},mount:function(R){C=z.current=R,z.pointTo(z),L&&m&&!J&&(me=m==null?void 0:m.addVariantChild(z)),m==null||m.children.add(z)},unmount:function(){c1.update(Oe),c1.render(ce),c1.preRender(z.updateLayoutProjection),V.forEach(function(R){return R()}),z.stopLayoutAnimation(),z.layoutTree.remove(z),me==null||me(),m==null||m.children.delete(z),I==null||I(),_.clearAllListeners()},addVariantChild:function(R){var Z,xe=z.getClosestVariantNode();if(xe)return(Z=xe.variantChildren)===null||Z===void 0||Z.add(R),function(){return xe.variantChildren.delete(R)}},sortNodePosition:function(R){return!d||n!==R.treeType?0:d(z.getInstance(),R.getInstance())},getClosestVariantNode:function(){return L?z:m==null?void 0:m.getClosestVariantNode()},scheduleUpdateLayoutProjection:m?m.scheduleUpdateLayoutProjection:function(){return Ql.preRender(z.updateTreeLayoutProjection,!1,!0)},getLayoutId:function(){return v.layoutId},getInstance:function(){return C},getStaticValue:function(R){return w[R]},setStaticValue:function(R,Z){return w[R]=Z},getLatestValues:function(){return w},setVisibility:function(R){z.isVisible!==R&&(z.isVisible=R,z.scheduleRender())},makeTargetAnimatable:function(R,Z){return Z===void 0&&(Z=!0),a(z,R,v,Z)},addValue:function(R,Z){z.hasValue(R)&&z.removeValue(R),P.set(R,Z),w[R]=Z.get(),$(R,Z)},removeValue:function(R){var Z;P.delete(R),(Z=V.get(R))===null||Z===void 0||Z(),V.delete(R),delete w[R],f(R,S)},hasValue:function(R){return P.has(R)},getValue:function(R,Z){var xe=P.get(R);return xe===void 0&&Z!==void 0&&(xe=rg(Z),z.addValue(R,xe)),xe},forEachValue:function(R){return P.forEach(R)},readValue:function(R){var Z;return(Z=w[R])!==null&&Z!==void 0?Z:u(C,R,g)},setBaseTarget:function(R,Z){Q[R]=Z},getBaseTarget:function(R){if(i){var Z=i(v,R);if(Z!==void 0&&!qd(Z))return Z}return Q[R]}},_),{build:function(){return Ne(),S},scheduleRender:function(){Ql.render(ce,!1,!0)},syncRender:ce,setProps:function(R){v=R,_.updatePropListeners(R),Y=w3e(z,h(v),Y)},getProps:function(){return v},getVariant:function(R){var Z;return(Z=v.variants)===null||Z===void 0?void 0:Z[R]},getDefaultTransition:function(){return v.transition},getVariantContext:function(R){if(R===void 0&&(R=!1),R)return m==null?void 0:m.getVariantContext();if(!J){var Z=(m==null?void 0:m.getVariantContext())||{};return v.initial!==void 0&&(Z.initial=v.initial),Z}for(var xe={},Ee=0;Ee<k3e;Ee++){var Me=DX[Ee],Ve=v[Me];(Xu(Ve)||Ve===!1)&&(xe[Me]=Ve)}return xe},enableLayoutProjection:function(){E.isEnabled=!0,z.layoutTree.add(z)},lockProjectionTarget:function(){E.isTargetLocked=!0},unlockProjectionTarget:function(){z.stopLayoutAnimation(),E.isTargetLocked=!1},getLayoutState:function(){return N},setCrossfader:function(R){O=R},isProjectionReady:function(){return E.isEnabled&&E.isHydrated&&N.isHydrated},startLayoutAnimation:function(R,Z,xe){xe===void 0&&(xe=!1);var Ee=z.getProjectionAnimationProgress()[R],Me=xe?E.relativeTarget[R]:E.target[R],Ve=Me.min,Je=Me.max,Ft=Je-Ve;return Ee.clearListeners(),Ee.set(Ve),Ee.set(Ve),Ee.onChange(function(et){z.setProjectionTargetAxis(R,et,et+Ft,xe)}),z.animateMotionValue(R,Ee,0,Z)},stopLayoutAnimation:function(){Uo(function(R){return z.getProjectionAnimationProgress()[R].stop()})},measureViewportBox:function(R){R===void 0&&(R=!0);var Z=o(C,g);return R||mX(Z,w),Z},getProjectionAnimationProgress:function(){return X||(X={x:rg(0),y:rg(0)}),X},setProjectionTargetAxis:function(R,Z,xe,Ee){Ee===void 0&&(Ee=!1);var Me;Ee?(E.relativeTarget||(E.relativeTarget=Gd()),Me=E.relativeTarget[R]):(E.relativeTarget=void 0,Me=E.target[R]),E.isHydrated=!0,Me.min=Z,Me.max=xe,D=!0,_.notifySetAxisTarget()},rebaseProjectionTarget:function(R,Z){Z===void 0&&(Z=N.layout);var xe=z.getProjectionAnimationProgress(),Ee=xe.x,Me=xe.y,Ve=!E.relativeTarget&&!E.isTargetLocked&&!Ee.isAnimating()&&!Me.isAnimating();(R||Ve)&&Uo(function(Je){var Ft=Z[Je],et=Ft.min,Gt=Ft.max;z.setProjectionTargetAxis(Je,et,Gt)})},notifyLayoutReady:function(R){E3e(z),z.notifyLayoutUpdate(N.layout,z.prevViewportBox||N.layout,R)},resetTransform:function(){return l(z,C,v)},restoreTransform:function(){return c(C,S)},updateLayoutProjection:$e,updateTreeLayoutProjection:function(){z.layoutTree.forEach(C3e),Ql.preRender(ve,!1,!0)},getProjectionParent:function(){if(A===void 0){for(var R=!1,Z=z.path.length-1;Z>=0;Z--){var xe=z.path[Z];if(xe.projection.isEnabled){R=xe;break}}A=R}return A},resolveRelativeTargetBox:function(){var R=z.getProjectionParent();if(!(!E.relativeTarget||!R)&&(zFe(E,R.projection),uX(R))){var Z=E.target;k3(Z,Z,R.getLatestValues())}},shouldResetTransform:function(){return Boolean(v._layoutResetTransform)},pointTo:function(R){k=R.projection,T=R.getLatestValues(),I==null||I(),I=M1(R.onSetAxisTarget(z.scheduleUpdateLayoutProjection),R.onLayoutAnimationComplete(function(){var Z;z.isPresent?z.presence=L1.Present:(Z=z.layoutSafeToRemove)===null||Z===void 0||Z.call(z)}))},isPresent:!0,presence:L1.Entering});return z}};function C3e(e){e.resolveRelativeTargetBox()}function A3e(e){e.updateLayoutProjection()}var DX=io(["initial"],Ur(_3)),k3e=DX.length,T3e=new Set(["width","height","top","left","right","bottom","x","y"]),RX=function(e){return T3e.has(e)},O3e=function(e){return Object.keys(e).some(RX)},FX=function(e,t){e.set(t,!1),e.set(t)},MX=function(e){return e===eg||e===qt},PX;(function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"})(PX||(PX={}));var $X=function(e,t){return parseFloat(e.split(", ")[t])},LX=function(e,t){return function(n,r){var i=r.transform;if(i==="none"||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return $X(a[1],t);var o=i.match(/^matrix\((.+)\)$/);return o?$X(o[1],e):0}},I3e=new Set(["x","y","z"]),N3e=k1.filter(function(e){return!I3e.has(e)});function D3e(e){var t=[];return N3e.forEach(function(n){var r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.syncRender(),t}var BX={width:function(e){var t=e.x;return t.max-t.min},height:function(e){var t=e.y;return t.max-t.min},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:LX(4,13),y:LX(5,14)},R3e=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),o=a.display,s=a.top,u=a.left,l=a.bottom,c=a.right,f=a.transform,d={top:s,left:u,bottom:l,right:c,transform:f};o==="none"&&t.setStaticValue("display",e.display||"block"),t.syncRender();var h=t.measureViewportBox();return n.forEach(function(p){var g=t.getValue(p);FX(g,BX[p](r,d)),e[p]=BX[p](h,a)}),e},F3e=function(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),t=ze({},t),r=ze({},r);var i=Object.keys(t).filter(RX),a=[],o=!1,s=[];if(i.forEach(function(l){var c=e.getValue(l);if(!!e.hasValue(l)){var f=n[l],d=t[l],h=qE(f),p;if(R1(d))for(var g=d.length,m=d[0]===null?1:0;m<g;m++)p?_1(qE(d[m])===p):p=qE(d[m]);else p=qE(d);if(h!==p)if(MX(h)&&MX(p)){var v=c.get();typeof v=="string"&&c.set(parseFloat(v)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===qt&&(t[l]=d.map(parseFloat))}else(h==null?void 0:h.transform)&&(p==null?void 0:p.transform)&&(f===0||d===0)?f===0?c.set(p.transform(f)):t[l]=h.transform(d):(o||(a=D3e(e),o=!0),s.push(l),r[l]=r[l]!==void 0?r[l]:t[l],FX(c,d))}}),s.length){var u=R3e(t,e,s);return a.length&&a.forEach(function(l){var c=Ur(l,2),f=c[0],d=c[1];e.getValue(f).set(d)}),e.syncRender(),{target:u,transitionEnd:r}}else return{target:t,transitionEnd:r}};function M3e(e,t,n,r){return O3e(t)?F3e(e,t,n,r):{target:t,transitionEnd:r}}var P3e=function(e,t,n,r){var i=r3e(e,t,r);return t=i.target,r=i.transitionEnd,M3e(e,t,n,r)};function $3e(e){return window.getComputedStyle(e)}var zX={treeType:"dom",readValueFromInstance:function(e,t){if(OE(t)){var n=y3(t);return n&&n.default||0}else{var r=$3e(e);return(kG(t)?r.getPropertyValue(t):r[t])||0}},sortNodePosition:function(e,t){return e.compareDocumentPosition(t)&2?1:-1},getBaseTarget:function(e,t){var n;return(n=e.style)===null||n===void 0?void 0:n[t]},measureViewportBox:function(e,t){var n=t.transformPagePoint;return eX(e,n)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var i=n.transformValues;r===void 0&&(r=!0);var a=t.transition,o=t.transitionEnd,s=Es(t,["transition","transitionEnd"]),u=pFe(s,a||{},e);if(i&&(o&&(o=i(o)),s&&(s=i(s)),u&&(u=i(u))),r){dFe(e,s,u);var l=P3e(e,s,u,o);o=l.transitionEnd,s=l.target}return ze({transition:a,transitionEnd:o},s)},scrapeMotionValuesFromProps:r3,build:function(e,t,n,r,i,a,o){e.isVisible!==void 0&&(t.style.visibility=e.isVisible?"visible":"hidden");var s=r.isEnabled&&i.isHydrated;QF(t,n,r,i,a,o.transformTemplate,s?YE:void 0,s?IX:void 0)},render:WG},L3e=NX(zX),B3e=NX(ze(ze({},zX),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return OE(t)?((n=y3(t))===null||n===void 0?void 0:n.default)||0:(t=VG.has(t)?t:UG(t),e.getAttribute(t))},scrapeMotionValuesFromProps:HG,build:function(e,t,n,r,i,a,o){var s=r.isEnabled&&i.isHydrated;n3(t,n,r,i,a,o.transformTemplate,s?YE:void 0,s?IX:void 0)},render:qG})),z3e=function(e,t){return GF(e)?B3e(t,{enableHardwareAcceleration:!1}):L3e(t,{enableHardwareAcceleration:!0})},j3e=ze(ze(ze(ze({},CFe),HRe),t3e),v3e),jX=HNe(function(e,t){return PDe(e,t,j3e,z3e)});function U3e(){var e=cn(!1),t=Ur(xn(0),2),n=t[0],r=t[1];return u3(function(){return e.current=!0}),vt(function(){!e.current&&r(n+1)},[n])}var UX=0;function W3e(){var e=UX;return UX++,e}var R3=function(e){var t=e.children,n=e.initial,r=e.isPresent,i=e.onExitComplete,a=e.custom,o=e.presenceAffectsLayout,s=E1(V3e),u=E1(W3e),l=zr(function(){return{id:u,initial:n,isPresent:r,custom:a,onExitComplete:function(c){s.set(c,!0);var f=!0;s.forEach(function(d){d||(f=!1)}),f&&(i==null||i())},register:function(c){return s.set(c,!1),function(){return s.delete(c)}}}},o?void 0:[r]);return zr(function(){s.forEach(function(c,f){return s.set(f,!1)})},[r]),an(function(){!r&&!s.size&&(i==null||i())},[r]),pe(S1.Provider,{value:l},t)};function V3e(){return new Map}function Xv(e){return e.key||""}function q3e(e,t){e.forEach(function(n){var r=Xv(n);t.set(r,n)})}function H3e(e){var t=[];return Jb.forEach(e,function(n){Pd(n)&&t.push(n)}),t}var WX=function(e){var t=e.children,n=e.custom,r=e.initial,i=r===void 0?!0:r,a=e.onExitComplete,o=e.exitBeforeEnter,s=e.presenceAffectsLayout,u=s===void 0?!0:s,l=U3e(),c=ir(kX);ig(c)&&(l=c.forceUpdate);var f=cn(!0),d=H3e(t),h=cn(d),p=cn(new Map).current,g=cn(new Set).current;if(q3e(d,p),f.current)return f.current=!1,pe(Zi,null,d.map(function(S){return pe(R3,{key:Xv(S),isPresent:!0,initial:i?void 0:!1,presenceAffectsLayout:u},S)}));for(var m=io([],Ur(d)),v=h.current.map(Xv),y=d.map(Xv),b=v.length,x=0;x<b;x++){var w=v[x];y.indexOf(w)===-1?g.add(w):g.delete(w)}return o&&g.size&&(m=[]),g.forEach(function(S){if(y.indexOf(S)===-1){var C=p.get(S);if(!!C){var _=v.indexOf(S),E=function(){p.delete(S),g.delete(S);var A=h.current.findIndex(function(k){return k.key===S});h.current.splice(A,1),g.size||(h.current=d,l(),a&&a())};m.splice(_,0,pe(R3,{key:Xv(C),isPresent:!1,onExitComplete:E,custom:n,presenceAffectsLayout:u},C))}}}),m=m.map(function(S){var C=S.key;return g.has(C)?S:pe(R3,{key:Xv(S),isPresent:!0,presenceAffectsLayout:u},S)}),h.current=m,pe(Zi,null,g.size?m:m.map(function(S){return yf(S)}))};function JE(){return JE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JE.apply(this,arguments)}var F3={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},j1={scale:{enter:{scale:1},exit:{scale:.95}},fade:{enter:{opacity:1},exit:{opacity:0}},pushLeft:{enter:{x:"100%"},exit:{x:"-30%"}},pushRight:{enter:{x:"-100%"},exit:{x:"30%"}},pushUp:{enter:{y:"100%"},exit:{y:"-30%"}},pushDown:{enter:{y:"-100%"},exit:{y:"30%"}},slideLeft:{position:{left:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"-100%"}},slideRight:{position:{right:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"100%"}},slideUp:{position:{top:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"-100%"}},slideDown:{position:{bottom:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"100%"}}};function M3(e){var t,n=(t=e==null?void 0:e.direction)!=null?t:"right";switch(n){case"right":return j1.slideRight;case"left":return j1.slideLeft;case"bottom":return j1.slideDown;case"top":return j1.slideUp;default:return j1.slideRight}}var VX={enter:{duration:.2,ease:F3.easeOut},exit:{duration:.1,ease:F3.easeIn}},QE={enter:(e,t)=>JE({},e,{delay:zd(t)?t:t==null?void 0:t.enter}),exit:(e,t)=>JE({},e,{delay:zd(t)?t:t==null?void 0:t.exit})},G3e={enter:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:1,transition:(n=r==null?void 0:r.enter)!=null?n:QE.enter(VX.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:0,transition:(n=r==null?void 0:r.exit)!=null?n:QE.exit(VX.exit,a),transitionEnd:i==null?void 0:i.exit}}},K3e={initial:"exit",animate:"enter",exit:"exit",variants:G3e};function X3e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function U1(){return U1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U1.apply(this,arguments)}var qX={exit:{duration:.15,ease:F3.easeInOut},enter:{type:"spring",damping:25,stiffness:180}},Y3e={exit:e=>{var t,{direction:n,transition:r,transitionEnd:i,delay:a}=e,{exit:o}=M3({direction:n});return U1({},o,{transition:(t=r==null?void 0:r.exit)!=null?t:QE.exit(qX.exit,a),transitionEnd:i==null?void 0:i.exit})},enter:e=>{var t,{direction:n,transitionEnd:r,transition:i,delay:a}=e,{enter:o}=M3({direction:n});return U1({},o,{transition:(t=i==null?void 0:i.enter)!=null?t:QE.enter(qX.enter,a),transitionEnd:r==null?void 0:r.enter})}},Z3e=Gl((e,t)=>{var{direction:n="right",style:r,unmountOnExit:i,in:a,className:o,transition:s,transitionEnd:u,delay:l}=e,c=X3e(e,["direction","style","unmountOnExit","in","className","transition","transitionEnd","delay"]),f=M3({direction:n}),d=Object.assign({position:"fixed"},f.position,r),h=i?a&&i:!0,p=a||i?"enter":"exit",g={transitionEnd:u,transition:s,direction:n,delay:l};return pe(WX,{custom:g},h&&pe(jX.div,U1({ref:t,initial:"exit",className:dr("chakra-slide",o),animate:p,exit:"exit",custom:g,variants:Y3e,style:d},c)))});function HX(e){return e.sort((t,n)=>{var r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var J3e=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function GX(e,t,n){var r=e+1;return n&&r>=t&&(r=0),r}function KX(e,t,n){var r=e-1;return n&&r<0&&(r=t),r}var P3=typeof window!="undefined"?vf:an,eC=e=>e;function $3(){return $3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$3.apply(this,arguments)}function Jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Q3e{constructor(){var t=this;Jr(this,"descendants",new Map),Jr(this,"register",n=>{if(n!=null)return J3e(n)?this.registerNode(n):r=>{this.registerNode(r,n)}}),Jr(this,"unregister",n=>{this.descendants.delete(n);var r=HX(Array.from(this.descendants.keys()));this.assignIndex(r)}),Jr(this,"destroy",()=>{this.descendants.clear()}),Jr(this,"assignIndex",n=>{this.descendants.forEach(r=>{var i=n.indexOf(r.node);r.index=i,r.node.dataset.index=r.index.toString()})}),Jr(this,"count",()=>this.descendants.size),Jr(this,"enabledCount",()=>this.enabledValues().length),Jr(this,"values",()=>{var n=Array.from(this.descendants.values());return n.sort((r,i)=>r.index-i.index)}),Jr(this,"enabledValues",()=>this.values().filter(n=>!n.disabled)),Jr(this,"item",n=>{if(this.count()!==0)return this.values()[n]}),Jr(this,"enabledItem",n=>{if(this.enabledCount()!==0)return this.enabledValues()[n]}),Jr(this,"first",()=>this.item(0)),Jr(this,"firstEnabled",()=>this.enabledItem(0)),Jr(this,"last",()=>this.item(this.descendants.size-1)),Jr(this,"lastEnabled",()=>{var n=this.enabledValues().length-1;return this.enabledItem(n)}),Jr(this,"indexOf",n=>{var r,i;return n&&(r=(i=this.descendants.get(n))==null?void 0:i.index)!=null?r:-1}),Jr(this,"enabledIndexOf",n=>n==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(n))),Jr(this,"next",function(n,r){r===void 0&&(r=!0);var i=GX(n,t.count(),r);return t.item(i)}),Jr(this,"nextEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=GX(a,t.enabledCount(),r);return t.enabledItem(o)}}),Jr(this,"prev",function(n,r){r===void 0&&(r=!0);var i=KX(n,t.count()-1,r);return t.item(i)}),Jr(this,"prevEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=KX(a,t.enabledCount()-1,r);return t.enabledItem(o)}}),Jr(this,"registerNode",(n,r)=>{if(!(!n||this.descendants.has(n))){var i=Array.from(this.descendants.keys()).concat(n),a=HX(i);r!=null&&r.disabled&&(r.disabled=!!r.disabled);var o=$3({node:n,index:-1},r);this.descendants.set(n,o),this.assignIndex(a)}})}}function eMe(){var[e]=xn(()=>new Q3e);return P3(()=>()=>e.destroy()),e}var[tMe,XX]=ec({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function nMe(e){var t=XX(),[n,r]=xn(-1),i=cn(null);P3(()=>()=>{!i.current||t.unregister(i.current)},[]),P3(()=>{if(!!i.current){var o=Number(i.current.dataset.index);n!=o&&!Number.isNaN(o)&&r(o)}});var a=eC(e?t.register(e):t.register);return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(i.current),register:jd(a,i)}}function rMe(){var e=eC(tMe),t=()=>eC(XX()),n=i=>nMe(i),r=()=>eMe();return[e,t,r,n]}function W1(){return W1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W1.apply(this,arguments)}var iMe=e=>pe(x1,W1({viewBox:"0 0 24 24"},e),pe("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})),aMe=e=>pe(x1,W1({viewBox:"0 0 24 24"},e),pe("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})),YX=e=>pe(x1,W1({viewBox:"0 0 24 24"},e),pe("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"}));function Ef(){return Ef=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ef.apply(this,arguments)}function oMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var ZX={info:{icon:aMe,colorScheme:"blue"},warning:{icon:YX,colorScheme:"orange"},success:{icon:iMe,colorScheme:"green"},error:{icon:YX,colorScheme:"red"}},[sMe,uMe]=ec({name:"AlertContext",errorMessage:"useAlertContext: `context` is undefined. Seems you forgot to wrap alert components in `<Alert />`"}),lMe=Qt((e,t)=>{var n,r=Ss(e),{status:i="info"}=r,a=oMe(r,["status"]),o=(n=e.colorScheme)!=null?n:ZX[i].colorScheme,s=Ud("Alert",Ef({},e,{colorScheme:o})),u=Ef({width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden"},s.container);return pe(sMe,{value:{status:i}},pe(m1,{value:s},pe(Nt.div,Ef({role:"alert",ref:t},a,{className:dr("chakra-alert",e.className),__css:u}))))}),cMe=Qt((e,t)=>{var n=ta();return pe(Nt.div,Ef({ref:t},e,{className:dr("chakra-alert__title",e.className),__css:n.title}))}),fMe=Qt((e,t)=>{var n=ta(),r=Ef({display:"inline"},n.description);return pe(Nt.div,Ef({ref:t},e,{className:dr("chakra-alert__desc",e.className),__css:r}))}),dMe=e=>{var{status:t}=uMe(),{icon:n}=ZX[t],r=ta();return pe(Nt.span,Ef({display:"inherit"},e,{className:dr("chakra-alert__icon",e.className),__css:r.icon}),pe(n,{w:"100%",h:"100%"}))},L3={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},hMe=Nt("span",{baseStyle:L3});Nt("input",{baseStyle:L3});function tC(){return tC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tC.apply(this,arguments)}function pMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var gMe=xH({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),mMe=Qt((e,t)=>{var n=Qp("Spinner",e),r=Ss(e),{label:i="Loading...",thickness:a="2px",speed:o="0.45s",emptyColor:s="transparent",className:u}=r,l=pMe(r,["label","thickness","speed","emptyColor","className"]),c=dr("chakra-spinner",u),f=tC({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:a,borderBottomColor:s,borderLeftColor:s,animation:gMe+" "+o+" linear infinite"},n);return pe(Nt.div,tC({ref:t,__css:f,className:c},l),i&&pe(hMe,null,i))}),[PFt,vMe]=ec({strict:!1,name:"ButtonGroupContext"});function B3(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Kd(){return Kd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kd.apply(this,arguments)}var JX=Qt((e,t)=>{var n,r=vMe(),i=Qp("Button",Kd({},r,e)),a=Ss(e),{isDisabled:o=r==null?void 0:r.isDisabled,isLoading:s,isActive:u,isFullWidth:l,children:c,leftIcon:f,rightIcon:d,loadingText:h,iconSpacing:p="0.5rem",type:g,spinner:m,spinnerPlacement:v="start",className:y,as:b}=a,x=B3(a,["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"]),w=Jl({},(n=i==null?void 0:i._focus)!=null?n:{},{zIndex:1}),S=Kd({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:l?"100%":"auto"},i,!!r&&{_focus:w}),{ref:C,type:_}=yMe(b);return pe(Nt.button,Kd({disabled:o||s,ref:jd(t,C),as:b,type:g??_,"data-active":ga(u),"data-loading":ga(s),__css:S,className:dr("chakra-button",y)},x),f&&!s&&pe(QX,{marginEnd:p},f),s&&v==="start"&&pe(eY,{className:"chakra-button__spinner--start",label:h,placement:"start"},m),s?h||pe(Nt.span,{opacity:0},c):c,s&&v==="end"&&pe(eY,{className:"chakra-button__spinner--end",label:h,placement:"end"},m),d&&!s&&pe(QX,{marginStart:p},d))});function yMe(e){var[t,n]=xn(!e),r=vt(a=>{!a||n(a.tagName==="BUTTON")},[]),i=t?"button":void 0;return{ref:r,type:i}}var QX=e=>{var{children:t,className:n}=e,r=B3(e,["children","className"]),i=Pd(t)?yf(t,{"aria-hidden":!0,focusable:!1}):t,a=dr("chakra-button__icon",n);return pe(Nt.span,Kd({display:"inline-flex",alignSelf:"center",flexShrink:0},r,{className:a}),i)},eY=e=>{var{label:t,placement:n,children:r=pe(mMe,{color:"currentColor",width:"1em",height:"1em"}),className:i,__css:a}=e,o=B3(e,["label","placement","spacing","children","className","__css"]),s=dr("chakra-button__spinner",i),u=n==="start"?"marginEnd":"marginStart",l=Kd({display:"flex",alignItems:"center",position:t?"relative":"absolute",[u]:t?"0.5rem":0,fontSize:"1em",lineHeight:"normal"},a);return pe(Nt.div,Kd({className:s},o,{__css:l}),r)};function z3(){return z3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z3.apply(this,arguments)}function bMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var nC=Qt((e,t)=>{var{icon:n,children:r,isRound:i,"aria-label":a}=e,o=bMe(e,["icon","children","isRound","aria-label"]),s=n||r,u=Pd(s)?yf(s,{"aria-hidden":!0,focusable:!1}):null;return pe(JX,z3({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":a},o),u)});function Yv(){return Yv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yv.apply(this,arguments)}function xMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function wMe(e){e===void 0&&(e={});var{defaultIsChecked:t,defaultChecked:n=t,isChecked:r,isFocusable:i,isDisabled:a,isReadOnly:o,isRequired:s,onChange:u,isIndeterminate:l,isInvalid:c,name:f,value:d,id:h,onBlur:p,onFocus:g,"aria-label":m,"aria-labelledby":v,"aria-invalid":y,"aria-describedby":b}=e,x=xMe(e,["defaultIsChecked","defaultChecked","isChecked","isFocusable","isDisabled","isReadOnly","isRequired","onChange","isIndeterminate","isInvalid","name","value","id","onBlur","onFocus","aria-label","aria-labelledby","aria-invalid","aria-describedby"]),w=d1(u),S=d1(p),C=d1(g),[_,E]=sF(),[A,k]=sF(),[T,I]=sF(),N=cn(null),[O,D]=xn(!0),[P,V]=xn(!!n),[Y,X]=aEe(r,P);rF({condition:!!t,message:'The "defaultIsChecked" prop has been deprecated and will be removed in a future version. Please use the "defaultChecked" prop instead, which mirrors default React checkbox behavior.'});var Q=vt(F=>{if(o||a){F.preventDefault();return}Y||V(X?F.target.checked:l?!0:F.target.checked),w==null||w(F)},[o,a,X,Y,l,w]);Pv(()=>{N.current&&(N.current.indeterminate=Boolean(l))},[l]);var me=a&&!i,ce=vt(F=>{F.key===" "&&I.on()},[I]),Ne=vt(F=>{F.key===" "&&I.off()},[I]);Pv(()=>{if(!!N.current){var F=N.current.checked!==X;F&&V(N.current.checked)}},[N.current]);var Oe=vt(function(F,q){F===void 0&&(F={}),q===void 0&&(q=null);var ue=J=>{J.preventDefault(),I.on()};return Yv({},F,{ref:q,"data-active":ga(T),"data-hover":ga(A),"data-checked":ga(X),"data-focus":ga(_),"data-indeterminate":ga(l),"data-disabled":ga(a),"data-invalid":ga(c),"data-readonly":ga(o),"aria-hidden":!0,onMouseDown:Yr(F.onMouseDown,ue),onMouseUp:Yr(F.onMouseUp,I.off),onMouseEnter:Yr(F.onMouseEnter,k.on),onMouseLeave:Yr(F.onMouseLeave,k.off)})},[T,X,a,_,A,l,c,o,I,k.off,k.on]),$e=vt(function(F,q){return F===void 0&&(F={}),q===void 0&&(q=null),Yv({},x,F,{ref:jd(q,ue=>{!ue||D(ue.tagName==="LABEL")}),onClick:Yr(F.onClick,()=>{if(!O){var ue;(ue=N.current)==null||ue.click(),Rv(N.current,{nextTick:!0})}}),"data-disabled":ga(a)})},[x,a,O]),ve=vt(function(F,q){F===void 0&&(F={}),q===void 0&&(q=null);var ue=()=>{qSe(E.on)};return Yv({},F,{ref:jd(N,q),type:"checkbox",name:f,value:d,id:h,onChange:Yr(F.onChange,Q),onBlur:Yr(F.onBlur,S,E.off),onFocus:Yr(F.onFocus,C,ue),onKeyDown:Yr(F.onKeyDown,ce),onKeyUp:Yr(F.onKeyUp,Ne),required:s,checked:X,disabled:me,readOnly:o,"aria-label":m,"aria-labelledby":v,"aria-invalid":y?Boolean(y):c,"aria-describedby":b,"aria-disabled":a,style:L3})},[f,d,h,Q,E.off,E.on,S,C,ce,Ne,s,X,me,o,m,v,y,c,b,a]),$=vt(function(F,q){return F===void 0&&(F={}),q===void 0&&(q=null),Yv({},F,{ref:q,onMouseDown:Yr(F.onMouseDown,tY),onTouchStart:Yr(F.onTouchStart,tY),"data-disabled":ga(a),"data-checked":ga(X),"data-invalid":ga(c)})},[X,a,c]);return{state:{isInvalid:c,isFocused:_,isChecked:X,isActive:T,isHovered:A,isIndeterminate:l,isDisabled:a,isReadOnly:o,isRequired:s},getRootProps:$e,getCheckboxProps:Oe,getInputProps:ve,getLabelProps:$,htmlProps:x}}function tY(e){e.preventDefault(),e.stopPropagation()}function _Me(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function V1(){return V1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V1.apply(this,arguments)}var SMe=e=>pe(x1,V1({focusable:"false","aria-hidden":!0},e),pe("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})),EMe=Qt((e,t)=>{var n=Qp("CloseButton",e),r=Ss(e),{children:i,isDisabled:a,__css:o}=r,s=_Me(r,["children","isDisabled","__css"]),u={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return pe(Nt.button,V1({type:"button","aria-label":"Close",ref:t,disabled:a,__css:V1({},u,n,o)},s),i||pe(SMe,{width:"1em",height:"1em"}))}),[$Ft,CMe]=ec({strict:!1,name:"FormControlContext"});function rC(){return rC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rC.apply(this,arguments)}function nY(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function rY(e){var t=AMe(e),{isDisabled:n,isInvalid:r,isReadOnly:i,isRequired:a}=t,o=nY(t,["isDisabled","isInvalid","isReadOnly","isRequired"]);return rC({},o,{disabled:n,readOnly:i,required:a,"aria-invalid":nF(r),"aria-required":nF(a),"aria-readonly":nF(i)})}function AMe(e){var t,n,r,i=CMe(),{id:a,disabled:o,readOnly:s,required:u,isRequired:l,isInvalid:c,isReadOnly:f,isDisabled:d,onFocus:h,onBlur:p}=e,g=nY(e,["id","disabled","readOnly","required","isRequired","isInvalid","isReadOnly","isDisabled","onFocus","onBlur"]),m=[];return i!=null&&i.hasFeedbackText&&i!=null&&i.isInvalid&&m.push(i.feedbackId),i!=null&&i.hasHelpText&&m.push(i.helpTextId),rC({},g,{"aria-describedby":m.join(" ")||void 0,id:a??(i==null?void 0:i.id),isDisabled:(t=o??d)!=null?t:i==null?void 0:i.isDisabled,isReadOnly:(n=s??f)!=null?n:i==null?void 0:i.isReadOnly,isRequired:(r=u??l)!=null?r:i==null?void 0:i.isRequired,isInvalid:c??(i==null?void 0:i.isInvalid),onFocus:Yr(i==null?void 0:i.onFocus,h),onBlur:Yr(i==null?void 0:i.onBlur,p)})}function j3(){return j3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j3.apply(this,arguments)}var iY=Qt((e,t)=>{var n=Ud("Input",e),r=Ss(e),i=rY(r),a=dr("chakra-input",e.className);return pe(Nt.input,j3({},i,{__css:n.field,ref:t,className:a}))});iY.id="Input";var iC=Nt("div");function U3(){return U3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U3.apply(this,arguments)}function kMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var TMe=Qt((e,t)=>{var{direction:n,align:r,justify:i,wrap:a,basis:o,grow:s,shrink:u}=e,l=kMe(e,["direction","align","justify","wrap","basis","grow","shrink"]),c={display:"flex",flexDirection:n,alignItems:r,justifyContent:i,flexWrap:a,flexBasis:o,flexGrow:s,flexShrink:u};return pe(Nt.div,U3({ref:t,__css:c},l))});function aC(){return aC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aC.apply(this,arguments)}function aY(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var oY=Qt((e,t)=>{var{area:n,templateAreas:r,gap:i,rowGap:a,columnGap:o,column:s,row:u,autoFlow:l,autoRows:c,templateRows:f,autoColumns:d,templateColumns:h}=e,p=aY(e,["area","templateAreas","gap","rowGap","columnGap","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns"]),g={display:"grid",gridArea:n,gridTemplateAreas:r,gridGap:i,gridRowGap:a,gridColumnGap:o,gridAutoColumns:d,gridColumn:s,gridRow:u,gridAutoFlow:l,gridAutoRows:c,gridTemplateRows:f,gridTemplateColumns:h};return pe(Nt.div,aC({ref:t,__css:g},p))});function sY(e){return f1(e,t=>t==="auto"?"auto":"span "+t+"/span "+t)}var ag=Qt((e,t)=>{var{colSpan:n,colStart:r,colEnd:i,rowEnd:a,rowSpan:o,rowStart:s}=e,u=aY(e,["colSpan","colStart","colEnd","rowEnd","rowSpan","rowStart"]),l=oE({gridColumn:sY(n),gridRow:sY(o),gridColumnStart:r,gridColumnEnd:i,gridRowStart:s,gridRowEnd:a});return pe(Nt.div,aC({ref:t,__css:l},u))});function W3(){return W3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W3.apply(this,arguments)}function OMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var IMe=Qt((e,t)=>{var n=Qp("Heading",e),r=Ss(e),i=OMe(r,["className"]);return pe(Nt.h2,W3({ref:t,className:dr("chakra-heading",e.className)},i,{__css:n}))});function V3(){return V3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V3.apply(this,arguments)}function NMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var DMe=Qt((e,t)=>{var n=Qp("Link",e),r=Ss(e),{className:i,isExternal:a}=r,o=NMe(r,["className","isExternal"]);return pe(Nt.a,V3({target:a?"_blank":void 0,rel:a?"noopener noreferrer":void 0,ref:t,className:dr("chakra-link",i)},o,{__css:n}))});function Zv(){return Zv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zv.apply(this,arguments)}function uY(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var RMe=Qt((e,t)=>{var n=Ud("List",e),r=Ss(e),{children:i,styleType:a="none",stylePosition:o,spacing:s}=r,u=uY(r,["children","styleType","stylePosition","spacing"]),l=oF(i),c="& > *:not(style) ~ *:not(style)",f=s?{[c]:{mt:s}}:{};return pe(m1,{value:n},pe(Nt.ul,Zv({ref:t,listStyleType:a,listStylePosition:o,role:"list",__css:Zv({},n.container,f)},u),l))}),FMe=Qt((e,t)=>{var n=uY(e,["as"]);return pe(RMe,Zv({ref:t,as:"ul",styleType:"initial",marginStart:"1em"},n))}),MMe=Qt((e,t)=>{var n=ta();return pe(Nt.li,Zv({ref:t},e,{__css:n.item}))});function q3(){return q3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q3.apply(this,arguments)}function PMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var $Me=Qt((e,t)=>{var{columns:n,spacingX:r,spacingY:i,spacing:a,minChildWidth:o}=e,s=PMe(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),u=o?BMe(o):zMe(n);return pe(oY,q3({ref:t,gap:a,columnGap:r,rowGap:i,templateColumns:u},s))});function LMe(e){return zd(e)?e+"px":e}function BMe(e){return f1(e,t=>_H(t)?null:"repeat(auto-fit, minmax("+LMe(t)+", 1fr))")}function zMe(e){return f1(e,t=>_H(t)?null:"repeat("+t+", minmax(0, 1fr))")}var jMe=Nt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}}),H3="& > *:not(style) ~ *:not(style)";function UMe(e){var{spacing:t,direction:n}=e,r={column:{marginTop:t,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:t},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:t,marginStart:0},"row-reverse":{marginTop:0,marginEnd:t,marginBottom:0,marginStart:0}};return{flexDirection:n,[H3]:f1(n,i=>r[i])}}function WMe(e){var{spacing:t,direction:n}=e,r={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":f1(n,i=>r[i])}}function VMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Jv(){return Jv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jv.apply(this,arguments)}var qMe=e=>pe(Nt.div,Jv({className:"chakra-stack__item"},e,{__css:Jv({display:"inline-block",flex:"0 0 auto",minWidth:0},e.__css)})),lY=Qt((e,t)=>{var{isInline:n,direction:r,align:i,justify:a,spacing:o="0.5rem",wrap:s,children:u,divider:l,className:c,shouldWrapChildren:f}=e,d=VMe(e,["isInline","direction","align","justify","spacing","wrap","children","divider","className","shouldWrapChildren"]),h=n?"row":r??"column",p=zr(()=>UMe({direction:h,spacing:o}),[h,o]),g=zr(()=>WMe({spacing:o,direction:h}),[o,h]),m=!!l,v=!f&&!m,y=oF(u),b=v?y:y.map((w,S)=>{var C=S+1===y.length,_=pe(qMe,{key:S},w),E=f?_:w;if(!m)return E;var A=yf(l,{__css:g}),k=C?null:A;return pe(Zi,{key:S},E,k)}),x=dr("chakra-stack",c);return pe(Nt.div,Jv({ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:p.flexDirection,flexWrap:s,className:x,__css:m?{}:{[H3]:p[H3]}},d),b)}),HMe=Qt((e,t)=>pe(lY,Jv({align:"center"},e,{direction:"row",ref:t})));function G3(){return G3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},G3.apply(this,arguments)}function GMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var KMe=Qt((e,t)=>{var n=Qp("Text",e),r=Ss(e),i=GMe(r,["className","align","decoration","casing"]),a=oE({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return pe(Nt.p,G3({ref:t,className:dr("chakra-text",e.className)},a,i,{__css:n}))});function Xd(){return Xd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xd.apply(this,arguments)}function K3(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var XMe=Qt((e,t)=>{var n=Ud("Table",e),r=Ss(e),{className:i}=r,a=K3(r,["className"]);return pe(m1,{value:n},pe(Nt.table,Xd({role:"table",ref:t,__css:n.table,className:dr("chakra-table",i)},a)))}),YMe=Qt((e,t)=>{var n=ta();return pe(Nt.thead,Xd({},e,{ref:t,__css:n.thead}))}),ZMe=Qt((e,t)=>{var n=ta();return pe(Nt.tbody,Xd({},e,{ref:t,__css:n.tbody}))}),JMe=Qt((e,t)=>{var{isNumeric:n}=e,r=K3(e,["isNumeric"]),i=ta();return pe(Nt.th,Xd({},r,{ref:t,__css:i.th,"data-is-numeric":n}))}),QMe=Qt((e,t)=>{var n=ta();return pe(Nt.tr,Xd({role:"row"},e,{ref:t,__css:n.tr}))}),ePe=Qt((e,t)=>{var{isNumeric:n}=e,r=K3(e,["isNumeric"]),i=ta();return pe(Nt.td,Xd({role:"gridcell"},r,{ref:t,__css:i.td,"data-is-numeric":n}))});function tPe(){var e=cn(new Map),t=e.current,n=vt((i,a,o,s)=>{e.current.set(o,{type:a,el:i,options:s}),i.addEventListener(a,o,s)},[]),r=vt((i,a,o,s)=>{i.removeEventListener(a,o,s),e.current.delete(o)},[]);return an(()=>()=>{t.forEach((i,a)=>{r(i.el,i.type,a,i.options)})},[r,t]),{add:n,remove:r}}function oC(){return oC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oC.apply(this,arguments)}function nPe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function X3(e){var t=e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function rPe(e){e===void 0&&(e={});var{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:i=!0,clickOnSpace:a=!0,onMouseDown:o,onMouseUp:s,onClick:u,onKeyDown:l,onKeyUp:c,tabIndex:f,onMouseOver:d,onMouseLeave:h}=e,p=nPe(e,["ref","isDisabled","isFocusable","clickOnEnter","clickOnSpace","onMouseDown","onMouseUp","onClick","onKeyDown","onKeyUp","tabIndex","onMouseOver","onMouseLeave"]),[g,m]=xn(!0),[v,y]=xn(!1),b=tPe(),x=P=>{!P||P.tagName!=="BUTTON"&&m(!1)},w=g?f:f||0,S=n&&!r,C=vt(P=>{if(n){P.stopPropagation(),P.preventDefault();return}var V=P.currentTarget;V.focus(),u==null||u(P)},[n,u]),_=vt(P=>{v&&X3(P)&&(P.preventDefault(),P.stopPropagation(),y(!1),b.remove(document,"keyup",_,!1))},[v,b]),E=vt(P=>{if(l==null||l(P),!(n||P.defaultPrevented||P.metaKey)&&!(!X3(P.nativeEvent)||g)){var V=i&&P.key==="Enter",Y=a&&P.key===" ";if(Y&&(P.preventDefault(),y(!0)),V){P.preventDefault();var X=P.currentTarget;X.click()}b.add(document,"keyup",_,!1)}},[n,g,l,i,a,b,_]),A=vt(P=>{if(c==null||c(P),!(n||P.defaultPrevented||P.metaKey)&&!(!X3(P.nativeEvent)||g)){var V=a&&P.key===" ";if(V){P.preventDefault(),y(!1);var Y=P.currentTarget;Y.click()}}},[a,g,n,c]),k=vt(P=>{P.button===0&&(y(!1),b.remove(document,"mouseup",k,!1))},[b]),T=vt(P=>{if(!TH(P)){if(n){P.stopPropagation(),P.preventDefault();return}g||y(!0);var V=P.currentTarget;V.focus({preventScroll:!0}),b.add(document,"mouseup",k,!1),o==null||o(P)}},[n,g,o,b,k]),I=vt(P=>{TH(P)||(g||y(!1),s==null||s(P))},[s,g]),N=vt(P=>{if(n){P.preventDefault();return}d==null||d(P)},[n,d]),O=vt(P=>{v&&(P.preventDefault(),y(!1)),h==null||h(P)},[v,h]),D=jd(t,x);return g?oC({},p,{ref:D,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:C,onMouseDown:o,onMouseUp:s,onKeyUp:c,onKeyDown:l,onMouseOver:d,onMouseLeave:h}):oC({},p,{ref:D,role:"button","data-active":ga(v),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:w,onClick:C,onMouseDown:T,onMouseUp:I,onKeyUp:A,onKeyDown:E,onMouseOver:N,onMouseLeave:O})}function iPe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var aPe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",oPe=aPe,sPe=oPe;function cY(){}function fY(){}fY.resetWarningCache=cY;var uPe=function(){function e(r,i,a,o,s,u){if(u!==sPe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:fY,resetWarningCache:cY};return n.PropTypes=n,n};uPe();var Y3="data-focus-lock",dY="data-focus-lock-disabled",lPe="data-no-focus-lock",cPe="data-autofocus-inside";function fPe(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function dPe(e,t){var n=xn(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function hY(e,t){return dPe(t,function(n){return e.forEach(function(r){return fPe(r,n)})})}var Z3={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sC=function(){return sC=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},sC.apply(this,arguments)};function hPe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function pY(e){return e}function gY(e,t){t===void 0&&(t=pY);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=t(a,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(r=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(a),o=n}var u=function(){var c=o;o=[],c.forEach(a)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){o.push(c),l()},filter:function(c){return o=o.filter(c),n}}}};return i}function J3(e,t){return t===void 0&&(t=pY),gY(e,t)}function mY(e){e===void 0&&(e={});var t=gY(null);return t.options=sC({async:!0,ssr:!1},e),t}var vY=function(e){var t=e.sideCar,n=hPe(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return pe(r,sC({},n))};vY.isSideCarExport=!0;function pPe(e,t){return e.useMedium(t),vY}var yY=J3({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),bY=J3(),gPe=J3(),mPe=mY({async:!0}),vPe=[],Q3=Gl(function(t,n){var r,i=xn(),a=i[0],o=i[1],s=cn(),u=cn(!1),l=cn(null),c=t.children,f=t.disabled,d=t.noFocusGuards,h=t.persistentFocus,p=t.crossFrame,g=t.autoFocus;t.allowTextSelection;var m=t.group,v=t.className,y=t.whiteList,b=t.shards,x=b===void 0?vPe:b,w=t.as,S=w===void 0?"div":w,C=t.lockProps,_=C===void 0?{}:C,E=t.sideCar,A=t.returnFocus,k=t.onActivation,T=t.onDeactivation,I=xn({}),N=I[0],O=vt(function(){l.current=l.current||document&&document.activeElement,s.current&&k&&k(s.current),u.current=!0},[k]),D=vt(function(){u.current=!1,T&&T(s.current)},[T]),P=vt(function(Oe){var $e=l.current;if(Boolean(A)&&$e&&$e.focus){var ve=typeof A=="object"?A:void 0;l.current=null,Oe?Promise.resolve().then(function(){return $e.focus(ve)}):$e.focus(ve)}},[A]),V=vt(function(Oe){u.current&&yY.useMedium(Oe)},[]),Y=bY.useMedium,X=vt(function(Oe){s.current!==Oe&&(s.current=Oe,o(Oe))},[]),Q=Zp((r={},r[dY]=f&&"disabled",r[Y3]=m,r),_),me=d!==!0,ce=me&&d!=="tail",Ne=hY([n,X]);return pe(Zi,null,me&&[pe("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:Z3}),pe("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:Z3})],!f&&pe(E,{id:N,sideCar:mPe,observed:a,disabled:f,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:y,shards:x,onActivation:O,onDeactivation:D,returnFocus:P}),pe(S,Zp({ref:Ne},Q,{className:v,onBlur:Y,onFocus:V}),c),ce&&pe("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:Z3}))});Q3.propTypes={},Q3.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var xY=Q3;function eM(e,t){return eM=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},eM(e,t)}function yPe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,eM(e,t)}function bPe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xPe(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var a=[],o;function s(){o=e(a.map(function(l){return l.props})),t(o)}var u=function(l){yPe(c,l);function c(){return l.apply(this,arguments)||this}c.peek=function(){return o};var f=c.prototype;return f.componentDidMount=function(){a.push(this),s()},f.componentDidUpdate=function(){s()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),s()},f.render=function(){return Jt.createElement(i,this.props)},c}(Zb);return bPe(u,"displayName","SideEffect("+n(i)+")"),u}}var Yd=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},tM=function(e){return Array.isArray(e)?e:[e]},wPe=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var a=e[r].compareDocumentPosition(e[i]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,s){return!t.has(s)})},wY=function(e){return e.parentNode?wY(e.parentNode):e},nM=function(e){var t=tM(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(Y3);return n.push.apply(n,i?wPe(Yd(wY(r).querySelectorAll("["+Y3+'="'+i+'"]:not(['+dY+'="disabled"])'))):[r]),n},[])},_Pe=function(e){return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},_Y=function(e){return!e||e===document||e&&e.nodeType===Node.DOCUMENT_NODE||!_Pe(window.getComputedStyle(e,null))&&_Y(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode)},SPe=function(e){return!((e.tagName==="INPUT"||e.tagName==="BUTTON")&&(e.type==="hidden"||e.disabled))},rM=function(e){return Boolean(e&&e.dataset&&e.dataset.focusGuard)},uC=function(e){return!rM(e)},EPe=function(e){return Boolean(e)},CPe=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},SY=function(e,t,n){return Yd(e).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!t||r.tabIndex>=0}).sort(CPe)},APe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],iM=APe.join(","),kPe=iM+", [data-focus-guard]",aM=function(e,t){return e.reduce(function(n,r){return n.concat(Yd(r.querySelectorAll(t?kPe:iM)),r.parentNode?Yd(r.parentNode.querySelectorAll(iM)).filter(function(i){return i===r}):[])},[])},TPe=function(e){var t=e.querySelectorAll("["+cPe+"]");return Yd(t).map(function(n){return aM([n])}).reduce(function(n,r){return n.concat(r)},[])},oM=function(e){return Yd(e).filter(function(t){return _Y(t)}).filter(function(t){return SPe(t)})},sM=function(e,t){return SY(oM(aM(e,t)),!0,t)},EY=function(e){return SY(oM(aM(e)),!1)},OPe=function(e){return oM(TPe(e))},uM=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&uM(e.parentNode,t),t},lM=function(e,t){for(var n=uM(e),r=uM(t),i=0;i<n.length;i+=1){var a=n[i];if(r.indexOf(a)>=0)return a}return!1},CY=function(e,t,n){var r=tM(e),i=tM(t),a=r[0],o=!1;return i.filter(Boolean).forEach(function(s){o=lM(o||s,s)||o,n.filter(Boolean).forEach(function(u){var l=lM(a,u);l&&(!o||l.contains(o)?o=l:o=lM(l,o))})}),o},IPe=function(e){return e.reduce(function(t,n){return t.concat(OPe(n))},[])},NPe=function(e){var t=nM(e).filter(uC),n=CY(e,e,t),r=sM([n],!0),i=sM(t).filter(function(a){var o=a.node;return uC(o)}).map(function(a){var o=a.node;return o});return r.map(function(a){var o=a.node,s=a.index;return{node:o,index:s,lockItem:i.indexOf(o)>=0,guard:rM(o)}})},DPe=function(e){return e===document.activeElement},RPe=function(e){return Boolean(Yd(e.querySelectorAll("iframe")).some(function(t){return DPe(t)}))},AY=function(e){var t=document&&document.activeElement;return!t||t.dataset&&t.dataset.focusGuard?!1:nM(e).reduce(function(n,r){return n||r.contains(t)||RPe(r)},!1)},FPe=function(){return document&&Yd(document.querySelectorAll("["+lPe+"]")).some(function(e){return e.contains(document.activeElement)})},kY=function(e){return e.tagName==="INPUT"&&e.type==="radio"},MPe=function(e,t){return t.filter(kY).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},cM=function(e,t){return kY(e)&&e.name?MPe(e,t):e},PPe=function(e){var t=new Set;return e.forEach(function(n){return t.add(cM(n,e))}),e.filter(function(n){return t.has(n)})},TY=function(e){return e[0]&&e.length>1?cM(e[0],e):e[0]},OY=function(e,t){return e.length>1?e.indexOf(cM(e[t],e)):t},IY="NEW_FOCUS",$Pe=function(e,t,n,r){var i=e.length,a=e[0],o=e[i-1],s=rM(n);if(!(e.indexOf(n)>=0)){var u=t.indexOf(n),l=r?t.indexOf(r):u,c=r?e.indexOf(r):-1,f=u-l,d=t.indexOf(a),h=t.indexOf(o),p=PPe(t),g=p.indexOf(n)-(r?p.indexOf(r):u),m=OY(e,0),v=OY(e,i-1);if(u===-1||c===-1)return IY;if(!f&&c>=0)return c;if(u<=d&&s&&Math.abs(f)>1)return v;if(u>=h&&s&&Math.abs(f)>1)return m;if(f&&Math.abs(g)>1)return c;if(u<=d)return v;if(u>h)return m;if(f)return Math.abs(f)>1?c:(i+c+f)%i}},LPe=function(e){return function(t){return t.autofocus||t.dataset&&!!t.dataset.autofocus||e.indexOf(t)>=0}},BPe=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(EPe)},zPe=function(e,t){var n=document&&document.activeElement,r=nM(e).filter(uC),i=CY(n||e,e,r),a=EY(r),o=sM(r).filter(function(d){var h=d.node;return uC(h)});if(!(!o[0]&&(o=a,!o[0]))){var s=EY([i]).map(function(d){var h=d.node;return h}),u=BPe(s,o),l=u.map(function(d){var h=d.node;return h}),c=$Pe(l,s,n,t);if(c===IY){var f=a.map(function(d){var h=d.node;return h}).filter(LPe(IPe(r)));return{node:f&&f.length?TY(f):TY(l)}}return c===void 0?c:u[c]}},jPe=function(e){e.focus(),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},fM=0,dM=!1,UPe=function(e,t){var n=zPe(e,t);if(!dM&&n){if(fM>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),dM=!0,setTimeout(function(){dM=!1},1);return}fM++,jPe(n.node),fM--}},NY=UPe;function DY(e){var t=window,n=t.setImmediate;typeof n!="undefined"?n(e):setTimeout(e,1)}var WPe=function(){return document&&document.activeElement===document.body},VPe=function(){return WPe()||FPe()},Qv=null,e0=null,t0=null,q1=!1,qPe=function(){return!0},HPe=function(t){return(Qv.whiteList||qPe)(t)},GPe=function(t,n){t0={observerNode:t,portaledElement:n}},KPe=function(t){return t0&&t0.portaledElement===t};function RY(e,t,n,r){var i=null,a=e;do{var o=r[a];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(a!==e)return;i=null}else break}while((a+=n)!==t);i&&(i.node.tabIndex=0)}var XPe=function(t){return t&&"current"in t?t.current:t},YPe=function(t){return t?Boolean(q1):q1==="meanwhile"},lC=function(){var t=!1;if(Qv){var n=Qv,r=n.observed,i=n.persistentFocus,a=n.autoFocus,o=n.shards,s=n.crossFrame,u=r||t0&&t0.portaledElement,l=document&&document.activeElement;if(u){var c=[u].concat(o.map(XPe).filter(Boolean));if((!l||HPe(l))&&(i||YPe(s)||!VPe()||!e0&&a)&&(u&&!(AY(c)||KPe(l))&&(document&&!e0&&l&&!a?(l.blur&&l.blur(),document.body.focus()):(t=NY(c,e0),t0={})),q1=!1,e0=document&&document.activeElement),document){var f=document&&document.activeElement,d=NPe(c),h=d.map(function(p){var g=p.node;return g}).indexOf(f);h>-1&&(d.filter(function(p){var g=p.guard,m=p.node;return g&&m.dataset.focusAutoGuard}).forEach(function(p){var g=p.node;return g.removeAttribute("tabIndex")}),RY(h,d.length,1,d),RY(h,-1,-1,d))}}}return t},FY=function(t){lC()&&t&&(t.stopPropagation(),t.preventDefault())},hM=function(){return DY(lC)},ZPe=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||GPe(r,n)},JPe=function(){return null},MY=function(){q1="just",setTimeout(function(){q1="meanwhile"},0)},QPe=function(){document.addEventListener("focusin",FY,!0),document.addEventListener("focusout",hM),window.addEventListener("blur",MY)},e$e=function(){document.removeEventListener("focusin",FY,!0),document.removeEventListener("focusout",hM),window.removeEventListener("blur",MY)};function t$e(e){return e.filter(function(t){var n=t.disabled;return!n})}function n$e(e){var t=e.slice(-1)[0];t&&!Qv&&QPe();var n=Qv,r=n&&t&&t.id===n.id;Qv=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var a=i.id;return a===n.id}).length||n.returnFocus(!t)),t?(e0=null,(!r||n.observed!==t.observed)&&t.onActivation(),lC(),DY(lC)):(e$e(),e0=null)}yY.assignSyncMedium(ZPe),bY.assignMedium(hM),gPe.assignMedium(function(e){return e({moveFocusInside:NY,focusInside:AY})});var r$e=xPe(t$e,n$e)(JPe),PY=Gl(function(t,n){return pe(xY,Zp({sideCar:r$e,ref:n},t))}),$Y=xY.propTypes||{};$Y.sideCar,iPe($Y,["sideCar"]),PY.propTypes={};var i$e=PY,a$e=e=>{var{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:i,children:a,isDisabled:o,autoFocus:s,persistentFocus:u,lockFocusAcrossFrames:l}=e,c=vt(()=>{if(t!=null&&t.current)t.current.focus();else if(r!=null&&r.current){var h=USe(r.current);h.length===0&&Rv(r.current,{nextTick:!0})}},[t,r]),f=vt(()=>{var h;n==null||(h=n.current)==null||h.focus()},[n]),d=i&&!n;return pe(i$e,{crossFrame:l,persistentFocus:u,autoFocus:s,disabled:o,onActivation:c,onDeactivation:f,returnFocus:d},a)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var n0=function(){return n0=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},n0.apply(this,arguments)};function o$e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var cC="right-scroll-bar-position",fC="width-before-scroll-bar",s$e="with-scroll-bars-hidden",u$e="--removed-body-scroll-bar-size",LY=mY(),pM=function(){},dC=Gl(function(e,t){var n=cn(null),r=xn({onScrollCapture:pM,onWheelCapture:pM,onTouchMoveCapture:pM}),i=r[0],a=r[1],o=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,f=e.shards,d=e.sideCar,h=e.noIsolation,p=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,y=o$e(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=d,x=hY([n,t]),w=n0({},y,i);return pe(Zi,null,c&&pe(b,{sideCar:LY,removeScrollBar:l,shards:f,noIsolation:h,inert:p,setCallbacks:a,allowPinchZoom:!!g,lockRef:n}),o?yf(Jb.only(s),n0({},w,{ref:x})):pe(v,n0({},w,{className:u,ref:x}),s))});dC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},dC.classNames={fullWidth:fC,zeroRight:cC};var l$e=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function c$e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=l$e();return t&&e.setAttribute("nonce",t),e}function f$e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function d$e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var h$e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=c$e())&&(f$e(t,n),d$e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},p$e=function(){var e=h$e();return function(t){an(function(){return e.add(t),function(){e.remove()}},[])}},BY=function(){var e=p$e(),t=function(n){var r=n.styles;return e(r),null};return t},g$e={left:0,top:0,right:0,gap:0},gM=function(e){return parseInt(e||"",10)||0},m$e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[gM(n),gM(r),gM(i)]},zY=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return g$e;var t=m$e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},v$e=BY(),y$e=function(e,t,n,r){var i=e.left,a=e.top,o=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`+s$e+` {
   overflow: hidden `+r+`;
   padding-right: `+s+"px "+r+`;
  }
  body {
    overflow: hidden `+r+`;
    `+[t&&"position: relative "+r+";",n==="margin"&&`
    padding-left: `+i+`px;
    padding-top: `+a+`px;
    padding-right: `+o+`px;
    margin-left:0;
    margin-top:0;
    margin-right: `+s+"px "+r+`;
    `,n==="padding"&&"padding-right: "+s+"px "+r+";"].filter(Boolean).join("")+`
  }
  
  .`+cC+` {
    right: `+s+"px "+r+`;
  }
  
  .`+fC+` {
    margin-right: `+s+"px "+r+`;
  }
  
  .`+cC+" ."+cC+` {
    right: 0 `+r+`;
  }
  
  .`+fC+" ."+fC+` {
    margin-right: 0 `+r+`;
  }
  
  body {
    `+u$e+": "+s+`px;
  }
`},b$e=function(e){var t=xn(zY(e.gapMode)),n=t[0],r=t[1];an(function(){r(zY(e.gapMode))},[e.gapMode]);var i=e.noRelative,a=e.noImportant,o=e.gapMode,s=o===void 0?"margin":o;return pe(v$e,{styles:y$e(n,!i,s,a?"":"!important")})},x$e=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},w$e=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},jY=function(e,t){var n=t;do{var r=UY(e,n);if(r){var i=WY(e,n),a=i[1],o=i[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},_$e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},S$e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},UY=function(e,t){return e==="v"?x$e(t):w$e(t)},WY=function(e,t){return e==="v"?_$e(t):S$e(t)},E$e=function(e,t,n,r,i){var a=r,o=n.target,s=t.contains(o),u=!1,l=a>0,c=0,f=0;do{var d=WY(e,o),h=d[0],p=d[1],g=d[2],m=p-g-h;(h||m)&&UY(e,o)&&(c+=m,f+=h),o=o.parentNode}while(!s&&o!==document.body||s&&(t.contains(o)||t===o));return(l&&(i&&c===0||!i&&a>c)||!l&&(i&&f===0||!i&&-a>f))&&(u=!0),u},mM=!1;if(typeof window!="undefined")try{var hC=Object.defineProperty({},"passive",{get:function(){return mM=!0,!0}});window.addEventListener("test",hC,hC),window.removeEventListener("test",hC,hC)}catch(e){mM=!1}var r0=mM?{passive:!1}:!1,pC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},VY=function(e){return[e.deltaX,e.deltaY]},qY=function(e){return e&&"current"in e?e.current:e},C$e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},A$e=function(e){return`
  .block-interactivity-`+e+` {pointer-events: none;}
  .allow-interactivity-`+e+` {pointer-events: all;}
`},k$e=0,i0=[];function T$e(e){var t=cn([]),n=cn([0,0]),r=cn(),i=xn(k$e++)[0],a=xn(function(){return BY()})[0],o=cn(e);an(function(){o.current=e},[e]),an(function(){if(e.inert){document.body.classList.add("block-interactivity-"+i);var g=[e.lockRef.current].concat((e.shards||[]).map(qY)).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-"+i)}),function(){document.body.classList.remove("block-interactivity-"+i),g.forEach(function(m){return m.classList.remove("allow-interactivity-"+i)})}}},[e.inert,e.lockRef.current,e.shards]);var s=vt(function(g,m){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var v=pC(g),y=n.current,b="deltaX"in g?g.deltaX:y[0]-v[0],x="deltaY"in g?g.deltaY:y[1]-v[1],w,S=g.target,C=Math.abs(b)>Math.abs(x)?"h":"v",_=jY(C,S);if(!_)return!0;if(_?w=C:(w=C==="v"?"h":"v",_=jY(C,S)),!_)return!1;if(!r.current&&"changedTouches"in g&&(b||x)&&(r.current=w),!w)return!0;var E=r.current||w;return E$e(E,m,g,E==="h"?b:x,!0)},[]),u=vt(function(g){var m=g;if(!(!i0.length||i0[i0.length-1]!==a)){var v="deltaY"in m?VY(m):pC(m),y=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&C$e(w.delta,v)})[0];if(y&&y.should){m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(qY).filter(Boolean).filter(function(w){return w.contains(m.target)}),x=b.length>0?s(m,b[0]):!o.current.noIsolation;x&&m.preventDefault()}}},[]),l=vt(function(g,m,v,y){var b={name:g,delta:m,target:v,should:y};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(x){return x!==b})},1)},[]),c=vt(function(g){n.current=pC(g),r.current=void 0},[]),f=vt(function(g){l(g.type,VY(g),g.target,s(g,e.lockRef.current))},[]),d=vt(function(g){l(g.type,pC(g),g.target,s(g,e.lockRef.current))},[]);an(function(){return i0.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",u,r0),document.addEventListener("touchmove",u,r0),document.addEventListener("touchstart",c,r0),function(){i0=i0.filter(function(g){return g!==a}),document.removeEventListener("wheel",u,r0),document.removeEventListener("touchmove",u,r0),document.removeEventListener("touchstart",c,r0)}},[]);var h=e.removeScrollBar,p=e.inert;return pe(Zi,null,p?pe(a,{styles:A$e(i)}):null,h?pe(b$e,{gapMode:"margin"}):null)}var O$e=pPe(LY,T$e),HY=Gl(function(e,t){return pe(dC,n0({},e,{ref:t,sideCar:O$e}))});HY.classNames=dC.classNames;var I$e=HY,N$e=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},a0=new WeakMap,gC=new WeakMap,mC={},vM=0,D$e=function(e,t,n){t===void 0&&(t=N$e(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];mC[n]||(mC[n]=new WeakMap);var i=mC[n],a=[],o=new Set,s=function(l){!l||o.has(l)||(o.add(l),s(l.parentNode))};r.forEach(s);var u=function(l){!l||r.indexOf(l)>=0||Array.prototype.forEach.call(l.children,function(c){if(o.has(c))u(c);else{var f=c.getAttribute("aria-hidden"),d=f!==null&&f!=="false",h=(a0.get(c)||0)+1,p=(i.get(c)||0)+1;a0.set(c,h),i.set(c,p),a.push(c),h===1&&d&&gC.set(c,!0),p===1&&c.setAttribute(n,"true"),d||c.setAttribute("aria-hidden","true")}})};return u(t),o.clear(),vM++,function(){a.forEach(function(l){var c=a0.get(l)-1,f=i.get(l)-1;a0.set(l,c),i.set(l,f),c||(gC.has(l)||l.removeAttribute("aria-hidden"),gC.delete(l)),f||l.removeAttribute(n)}),vM--,vM||(a0=new WeakMap,a0=new WeakMap,gC=new WeakMap,mC={})}};function R$e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class F$e{constructor(){R$e(this,"modals",void 0),this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(n=>n!==t)}isTopModal(t){var n=this.modals[this.modals.length-1];return n===t}}var yM=new F$e;function M$e(e,t){an(()=>(t&&yM.add(e),()=>{yM.remove(e)}),[t,e])}function vC(){return vC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vC.apply(this,arguments)}function P$e(e){var{isOpen:t,onClose:n,id:r,closeOnOverlayClick:i=!0,closeOnEsc:a=!0,useInert:o=!0,onOverlayClick:s,onEsc:u}=e,l=cn(null),c=cn(null),[f,d,h]=uEe(r,"chakra-modal","chakra-modal--header","chakra-modal--body");$$e(l,t&&o),M$e(l,t);var p=cn(null),g=vt(_=>{p.current=_.target},[]),m=vt(_=>{_.key==="Escape"&&(_.stopPropagation(),a&&(n==null||n()),u==null||u())},[a,n,u]),[v,y]=xn(!1),[b,x]=xn(!1),w=vt(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),vC({role:"dialog"},_,{ref:jd(E,l),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":v?d:void 0,"aria-describedby":b?h:void 0,onClick:Yr(_.onClick,A=>A.stopPropagation())})},[h,b,f,d,v]),S=vt(_=>{_.stopPropagation(),p.current===_.target&&(!yM.isTopModal(l)||(i&&(n==null||n()),s==null||s()))},[n,i,s]),C=vt(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),vC({},_,{ref:jd(E,c),onClick:Yr(_.onClick,S),onKeyDown:Yr(_.onKeyDown,m),onMouseDown:Yr(_.onMouseDown,g)})},[m,g,S]);return{isOpen:t,onClose:n,headerId:d,bodyId:h,setBodyMounted:x,setHeaderMounted:y,dialogRef:l,overlayRef:c,getDialogProps:w,getDialogContainerProps:C}}function $$e(e,t){an(()=>{if(!!e.current){var n=null;return t&&e.current&&(n=D$e(e.current)),()=>{t&&(n==null||n())}}},[t,e])}function yC(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Cf(){return Cf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cf.apply(this,arguments)}var[L$e,o0]=ec({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),GY=e=>{var{portalProps:t,children:n,autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d}=e,h=Ud("Modal",e),p=P$e(e),g=Cf({},p,{autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d});return pe(L$e,{value:g},pe(m1,{value:h},pe(WX,null,g.isOpen&&pe(dE,t,n))))};GY.defaultProps={lockFocusAcrossFrames:!0,returnFocusOnClose:!0,scrollBehavior:"outside",trapFocus:!0,autoFocus:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale"};var B$e=Nt(jX.div);function z$e(e){var{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:i,blockScrollOnMount:a,allowPinchZoom:o,finalFocusRef:s,returnFocusOnClose:u,preserveScrollBarGap:l,lockFocusAcrossFrames:c}=o0(),[f,d]=qF();return an(()=>{!f&&d&&setTimeout(d)},[f,d]),pe(a$e,{autoFocus:t,isDisabled:!n,initialFocusRef:i,finalFocusRef:s,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:c},pe(I$e,{removeScrollBar:!l,allowPinchZoom:o,enabled:a,forwardProps:!0},e.children))}var KY=Qt((e,t)=>{var{className:n}=e,r=yC(e,["className","transition"]),i=dr("chakra-modal__overlay",n),a=ta(),o=Cf({pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh"},a.overlay),{motionPreset:s}=o0(),u=s==="none"?{}:K3e;return pe(B$e,Cf({},u,{__css:o,ref:t,className:i},r))}),j$e=Qt((e,t)=>{var{className:n}=e,r=yC(e,["className"]),{headerId:i,setHeaderMounted:a}=o0();an(()=>(a(!0),()=>a(!1)),[a]);var o=dr("chakra-modal__header",n),s=ta(),u=Cf({flex:0},s.header);return pe(Nt.header,Cf({ref:t,className:o,id:i},r,{__css:u}))}),XY=Qt((e,t)=>{var{className:n}=e,r=yC(e,["className"]),{bodyId:i,setBodyMounted:a}=o0();an(()=>(a(!0),()=>a(!1)),[a]);var o=dr("chakra-modal__body",n),s=ta();return pe(Nt.div,Cf({ref:t,className:o,id:i},r,{__css:s.body}))}),U$e=Qt((e,t)=>{var{onClick:n,className:r}=e,i=yC(e,["onClick","className"]),{onClose:a}=o0(),o=dr("chakra-modal__close-btn",r),s=ta();return pe(EMe,Cf({ref:t,__css:s.closeButton,className:o,onClick:Yr(n,u=>{u.stopPropagation(),a()})},i))});function og(){return og=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},og.apply(this,arguments)}function YY(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[W$e,V$e]=ec();function ZY(e){var t,{isOpen:n,onClose:r,placement:i="right",children:a}=e,o=YY(e,["isOpen","onClose","placement","children"]),s=nG(),u=(t=s.components)==null?void 0:t.Drawer;return pe(W$e,{value:{placement:i}},pe(GY,og({isOpen:n,onClose:r,styleConfig:u},o),a))}var q$e=Nt(Z3e),JY=Qt((e,t)=>{var{className:n,children:r}=e,i=YY(e,["className","children"]),{getDialogProps:a,getDialogContainerProps:o,isOpen:s}=o0(),u=a(i,t),l=o(),c=dr("chakra-modal__content",n),f=ta(),d=og({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0},f.dialog),h=og({display:"flex",width:"100vw",height:"100vh",position:"fixed",left:0,top:0},f.dialogContainer),{placement:p}=V$e();return pe(Nt.div,og({},l,{className:"chakra-modal__content-container",__css:h}),pe(z$e,null,pe(q$e,og({direction:p,in:s,className:c},u,{__css:d}),r)))});function Zd(){return Zd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zd.apply(this,arguments)}function bM(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var H$e=Qt((e,t)=>{var{children:n,placeholder:r,className:i}=e,a=bM(e,["children","placeholder","className"]),o=rY(a);return pe(Nt.select,Zd({},o,{ref:t,className:dr("chakra-select",i)}),r&&pe("option",{value:""},r),n)}),G$e=Qt((e,t)=>{var n=Ud("Select",e),r=Ss(e),{rootProps:i,placeholder:a,icon:o,color:s,height:u,h:l,minH:c,minHeight:f,iconColor:d,iconSize:h}=r,p=bM(r,["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"]),[g,m]=ESe(p,aCe),v={width:"100%",height:"fit-content",position:"relative",color:s},y=Jl({},n.field,{paddingEnd:"2rem",_focus:{zIndex:"unset"}});return pe(Nt.div,Zd({className:"chakra-select__wrapper",__css:v},g,i),pe(H$e,Zd({ref:t,height:l??u,minH:c??f,placeholder:a},m,{__css:y}),e.children),pe(Y$e,Zd({"data-disabled":e.isDisabled},(d||s)&&{color:d||s},{__css:n.icon},h&&{fontSize:h}),o))}),K$e=e=>pe("svg",Zd({viewBox:"0 0 24 24"},e),pe("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})),X$e=Nt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),Y$e=e=>{var{children:t=pe(K$e,null)}=e,n=bM(e,["children"]),r=yf(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return pe(X$e,Zd({},n,{className:"chakra-select__icon-wrapper"}),Pd(t)?r:null)};function Af(){return Af=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Af.apply(this,arguments)}function Z$e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var J$e=Qt((e,t)=>{var n=Ud("Switch",e),r=Ss(e),{spacing:i="0.5rem",children:a}=r,o=Z$e(r,["spacing","children"]),{state:s,getInputProps:u,getCheckboxProps:l,getRootProps:c,getLabelProps:f}=wMe(o),d=zr(()=>Af({display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},n.container),[n.container]),h=zr(()=>Af({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer"},n.track),[n.track]),p=zr(()=>Af({userSelect:"none",marginStart:i},n.label),[i,n.label]);return pe(Nt.label,Af({},c(),{className:dr("chakra-switch",e.className),__css:d}),pe("input",Af({className:"chakra-switch__input"},u({},t))),pe(Nt.span,Af({},l(),{className:"chakra-switch__track",__css:h}),pe(Nt.span,{__css:n.thumb,className:"chakra-switch__thumb","data-checked":ga(s.isChecked),"data-hover":ga(s.isHovered)})),a&&pe(Nt.span,Af({className:"chakra-switch__label"},f(),{__css:p}),a))});function sg(){return sg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sg.apply(this,arguments)}function xM(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[Q$e,eLe,tLe,nLe]=rMe();function rLe(e){var{defaultIndex:t,onChange:n,index:r,isManual:i,isLazy:a,lazyBehavior:o="unmount",orientation:s="horizontal",direction:u="ltr"}=e,l=xM(e,["defaultIndex","onChange","index","isManual","isLazy","lazyBehavior","orientation","direction"]),[c,f]=xn(t??0),[d,h]=oEe({defaultValue:t??0,value:r,onChange:n});an(()=>{r!=null&&f(r)},[r]);var p=tLe(),g=PH(e.id,"tabs");return{id:g,selectedIndex:d,focusedIndex:c,setSelectedIndex:h,setFocusedIndex:f,isManual:i,isLazy:a,lazyBehavior:o,orientation:s,descendants:p,direction:u,htmlProps:l}}var[iLe,bC]=ec({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function aLe(e){var{focusedIndex:t,orientation:n,direction:r}=bC(),i=eLe(),a=vt(o=>{var s=()=>{var y=i.nextEnabled(t);y&&Rv(y.node)},u=()=>{var y=i.prevEnabled(t);y&&Rv(y.node)},l=()=>{var y=i.firstEnabled();y&&Rv(y.node)},c=()=>{var y=i.lastEnabled();y&&Rv(y.node)},f=n==="horizontal",d=n==="vertical",h=RSe(o),p=r==="ltr"?"ArrowLeft":"ArrowRight",g=r==="ltr"?"ArrowRight":"ArrowLeft",m={[p]:()=>f&&u(),[g]:()=>f&&s(),ArrowDown:()=>d&&s(),ArrowUp:()=>d&&u(),Home:l,End:c},v=m[h];v&&(o.preventDefault(),v(o))},[i,t,n,r]);return sg({},e,{role:"tablist","aria-orientation":n,onKeyDown:Yr(e.onKeyDown,a)})}function oLe(e){var{isDisabled:t,isFocusable:n}=e,r=xM(e,["isDisabled","isFocusable"]),{setSelectedIndex:i,isManual:a,id:o,setFocusedIndex:s,selectedIndex:u}=bC(),{index:l,register:c}=nLe({disabled:t&&!n}),f=l===u,d=()=>{i(l)},h=()=>{s(l);var m=t&&n,v=!a&&!m;v&&i(l)},p=rPe(sg({},r,{ref:jd(c,e.ref),isDisabled:t,isFocusable:n,onClick:Yr(e.onClick,d)})),g="button";return sg({},p,{id:QY(o,l),role:"tab",tabIndex:f?0:-1,type:g,"aria-selected":f,"aria-controls":eZ(o,l),onFocus:t?void 0:Yr(e.onFocus,h)})}function sLe(e){var t=bC(),{id:n,selectedIndex:r}=t,i=oF(e.children),a=i.map((o,s)=>yf(o,{isSelected:s===r,id:eZ(n,s),"aria-labelledby":QY(n,s)}));return sg({},e,{children:a})}function uLe(e){var{isSelected:t,id:n,children:r}=e,i=xM(e,["isSelected","id","children"]),{isLazy:a,lazyBehavior:o}=bC(),s=cn(!1);t&&(s.current=!0);var u=XSe({hasBeenSelected:s.current,isSelected:t,isLazy:a,lazyBehavior:o});return sg({tabIndex:0},i,{children:u?r:null,role:"tabpanel",hidden:!t,id:n})}function QY(e,t){return e+"--tab-"+t}function eZ(e,t){return e+"--tabpanel-"+t}function su(){return su=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},su.apply(this,arguments)}function tZ(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var lLe=Qt((e,t)=>{var n=Ud("Tabs",e),r=Ss(e),{children:i,className:a}=r,o=tZ(r,["children","className"]),s=rLe(o),{htmlProps:u,descendants:l}=s,c=tZ(s,["htmlProps","descendants"]),f=zr(()=>c,[c]),d=QR(u,["isFitted"]);return pe(Q$e,{value:l},pe(iLe,{value:f},pe(m1,{value:n},pe(Nt.div,su({className:dr("chakra-tabs",a),ref:t},d,{__css:n.root}),i))))}),cLe=Qt((e,t)=>{var n=ta(),r=oLe(su({},e,{ref:t})),i=su({outline:"0",display:"flex",alignItems:"center",justifyContent:"center"},n.tab);return pe(Nt.button,su({},r,{className:dr("chakra-tabs__tab",e.className),__css:i}))}),fLe=Qt((e,t)=>{var n=aLe(su({},e,{ref:t})),r=ta(),i=su({display:"flex"},r.tablist);return pe(Nt.div,su({},n,{className:dr("chakra-tabs__tablist",e.className),__css:i}))}),dLe=Qt((e,t)=>{var n=uLe(su({},e,{ref:t})),r=ta();return pe(Nt.div,su({outline:"0"},n,{className:dr("chakra-tabs__tab-panel",e.className),__css:r.tabpanel}))}),hLe=Qt((e,t)=>{var n=sLe(e),r=ta();return pe(Nt.div,su({},n,{width:"100%",ref:t,className:dr("chakra-tabs__tab-panels",e.className),__css:r.tabpanels}))}),pLe=w1({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),gLe=w1({displayName:"ExternalLinkIcon",path:pe("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},pe("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),pe("path",{d:"M15 3h6v6"}),pe("path",{d:"M10 14L21 3"}))}),mLe=w1({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),vLe=w1({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,19a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,12,19Zm1.6-6.08a1,1,0,0,0-.6.917,1,1,0,1,1-2,0,3,3,0,0,1,1.8-2.75A2,2,0,1,0,10,9.255a1,1,0,1,1-2,0,4,4,0,1,1,5.6,3.666Z",displayName:"QuestionIcon"}),nZ=w1({viewBox:"0 0 14 14",path:pe("g",{fill:"currentColor"},pe("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"}))});const yLe=({options:e})=>{const[t,n]=xn(!1),r=vt(()=>{n(!t)},[t]);return Jt.createElement(Jt.Fragment,null,Jt.createElement(nC,{verticalAlign:"top","aria-label":"Metaframe settings",icon:Jt.createElement(pLe,null),size:"lg",onClick:r}),Jt.createElement(bLe,{isOpen:t,setOpen:n,options:e}))},bLe=({isOpen:e,setOpen:t,options:n})=>{const[r,i]=wq("options",Object.fromEntries(n.filter(d=>d.default).map(d=>[d.name,d.default]))),[a,o]=xn(r||{}),[s,u]=xn(void 0),l=vt(d=>{const{name:h,value:p}=d.target,g=n.find(m=>m.name===h);if(!g){console.error(`No option found for name=${h}`);return}g.type==="boolean"?o(Object.assign(Object.assign({},a),{[h]:p==="1"})):o(Object.assign(Object.assign({},a),{[h]:p}))},[a,o,n]),c=vt(()=>{t(!e)},[t,e]),f=vt(()=>{const d={};if(Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);if(g&&g.validator&&g.type!=="boolean"){const m=g.validator(a[p]);m&&(d[p]=m)}}),Object.keys(d).length>0){u(d);return}u(void 0);const h={};Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);g?g.map?h[p]=g.map(a[p]):g.type==="boolean"?h[p]=a[p]===!0||a[p]==="1"||a[p]==="true":h[p]=a[p]:h[p]=a[p]}),t(!e),i(h)},[t,e,n,a,i,u]);return an(()=>{const d=h=>{h.key==="Enter"&&e&&f()};return window.addEventListener("keyup",d),()=>{window.removeEventListener("keyup",d)}},[f,e]),Jt.createElement(ZY,{placement:"top",onClose:f,isOpen:e},Jt.createElement(KY,null,Jt.createElement(JY,null,Jt.createElement(j$e,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),Jt.createElement(XY,null,Jt.createElement(iC,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},Jt.createElement(oY,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(d=>Jt.createElement(Jt.Fragment,null,Jt.createElement(ag,{rowSpan:1,colSpan:4},Jt.createElement(iC,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},Jt.createElement(KMe,{textAlign:"right",verticalAlign:"bottom"},d.displayName||d.name,":"))),Jt.createElement(ag,{rowSpan:1,colSpan:8}," ",xLe(d,a[d.name],l)))),Jt.createElement(ag,{rowSpan:1,colSpan:12}),Jt.createElement(ag,{rowSpan:1,colSpan:12}),Jt.createElement(ag,{rowSpan:1,colSpan:12}),Jt.createElement(ag,{rowSpan:1,colSpan:10}),Jt.createElement(ag,{rowSpan:0,colSpan:2},Jt.createElement(HMe,{spacing:2,justify:"flex-end",direction:"row"},Jt.createElement(nC,{size:"lg",color:"red",icon:Jt.createElement(mLe,null),onClick:c}),Jt.createElement(nC,{size:"lg",color:"green",icon:Jt.createElement(nZ,null),onClick:f})))))))))},xLe=(e,t,n)=>{switch(e.type){case"option":return Jt.createElement(G$e,{name:e.name,value:t,onChange:n,placeholder:"Select option"},e.options.map(r=>Jt.createElement("option",{value:r},r)));case"boolean":return Jt.createElement(J$e,{name:e.name,rightIcon:Jt.createElement(nZ,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return Jt.createElement(iC,{w:"100%",h:"10"},Jt.createElement(iY,{name:e.name,type:"text",placeholder:"",value:t,onInput:n}))}};var rZ={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof $d=="function"&&$d;if(!c&&f)return f(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+l+"'")}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(h){var p=r[l][1][h];return o(p||h)},d,d.exports,n,r,i,a)}return i[l].exports}for(var s=typeof $d=="function"&&$d,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("crypto");function g(S,C){return function(_,E){var A;if(A=E.algorithm!=="passthrough"?p.createHash(E.algorithm):new w,A.write===void 0&&(A.write=A.update,A.end=A.update),x(E,A).dispatch(_),A.update||A.end(""),A.digest)return A.digest(E.encoding==="buffer"?void 0:E.encoding);var k=A.read();return E.encoding!=="buffer"?k.toString(E.encoding):k}(S,C=y(S,C))}(i=r.exports=g).sha1=function(S){return g(S)},i.keys=function(S){return g(S,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(S){return g(S,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(S){return g(S,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"];m.push("passthrough");var v=["buffer","hex","binary","base64"];function y(S,C){C=C||{};var _={};if(_.algorithm=C.algorithm||"sha1",_.encoding=C.encoding||"hex",_.excludeValues=!!C.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=C.ignoreUnknown===!0,_.respectType=C.respectType!==!1,_.respectFunctionNames=C.respectFunctionNames!==!1,_.respectFunctionProperties=C.respectFunctionProperties!==!1,_.unorderedArrays=C.unorderedArrays===!0,_.unorderedSets=C.unorderedSets!==!1,_.unorderedObjects=C.unorderedObjects!==!1,_.replacer=C.replacer||void 0,_.excludeKeys=C.excludeKeys||void 0,S===void 0)throw new Error("Object argument required.");for(var E=0;E<m.length;++E)m[E].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=m[E]);if(m.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+m.join(", "));if(v.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+v.join(", "));return _}function b(S){if(typeof S=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(S))!=null}function x(S,C,_){_=_||[];function E(A){return C.update?C.update(A,"utf8"):C.write(A,"utf8")}return{dispatch:function(A){return S.replacer&&(A=S.replacer(A)),this["_"+(A===null?"null":typeof A)](A)},_object:function(A){var k=Object.prototype.toString.call(A),T=/\[object (.*)\]/i.exec(k);T=(T=T?T[1]:"unknown:["+k+"]").toLowerCase();var I;if(0<=(I=_.indexOf(A)))return this.dispatch("[CIRCULAR:"+I+"]");if(_.push(A),s!==void 0&&s.isBuffer&&s.isBuffer(A))return E("buffer:"),E(A);if(T==="object"||T==="function"||T==="asyncfunction"){var N=Object.keys(A);S.unorderedObjects&&(N=N.sort()),S.respectType===!1||b(A)||N.splice(0,0,"prototype","__proto__","constructor"),S.excludeKeys&&(N=N.filter(function(D){return!S.excludeKeys(D)})),E("object:"+N.length+":");var O=this;return N.forEach(function(D){O.dispatch(D),E(":"),S.excludeValues||O.dispatch(A[D]),E(",")})}if(!this["_"+T]){if(S.ignoreUnknown)return E("["+T+"]");throw new Error('Unknown object type "'+T+'"')}this["_"+T](A)},_array:function(A,k){k=k!==void 0?k:S.unorderedArrays!==!1;var T=this;if(E("array:"+A.length+":"),!k||A.length<=1)return A.forEach(function(O){return T.dispatch(O)});var I=[],N=A.map(function(O){var D=new w,P=_.slice();return x(S,D,P).dispatch(O),I=I.concat(P.slice(_.length)),D.read().toString()});return _=_.concat(I),N.sort(),this._array(N,!1)},_date:function(A){return E("date:"+A.toJSON())},_symbol:function(A){return E("symbol:"+A.toString())},_error:function(A){return E("error:"+A.toString())},_boolean:function(A){return E("bool:"+A.toString())},_string:function(A){E("string:"+A.length+":"),E(A.toString())},_function:function(A){E("fn:"),b(A)?this.dispatch("[native]"):this.dispatch(A.toString()),S.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(A.name)),S.respectFunctionProperties&&this._object(A)},_number:function(A){return E("number:"+A.toString())},_xml:function(A){return E("xml:"+A.toString())},_null:function(){return E("Null")},_undefined:function(){return E("Undefined")},_regexp:function(A){return E("regex:"+A.toString())},_uint8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint8clampedarray:function(A){return E("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(A))},_int8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_int16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_uint32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_int32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_float32array:function(A){return E("float32array:"),this.dispatch(Array.prototype.slice.call(A))},_float64array:function(A){return E("float64array:"),this.dispatch(Array.prototype.slice.call(A))},_arraybuffer:function(A){return E("arraybuffer:"),this.dispatch(new Uint8Array(A))},_url:function(A){return E("url:"+A.toString())},_map:function(A){E("map:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_set:function(A){E("set:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_file:function(A){return E("file:"),this.dispatch([A.name,A.size,A.type,A.lastModfied])},_blob:function(){if(S.ignoreUnknown)return E("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return E("domwindow")},_bigint:function(A){return E("bigint:"+A.toString())},_process:function(){return E("process")},_timer:function(){return E("timer")},_pipe:function(){return E("pipe")},_tcp:function(){return E("tcp")},_udp:function(){return E("udp")},_tty:function(){return E("tty")},_statwatcher:function(){return E("statwatcher")},_securecontext:function(){return E("securecontext")},_connection:function(){return E("connection")},_zlib:function(){return E("zlib")},_context:function(){return E("context")},_nodescript:function(){return E("nodescript")},_httpparser:function(){return E("httpparser")},_dataview:function(){return E("dataview")},_signal:function(){return E("signal")},_fsevent:function(){return E("fsevent")},_tlswrap:function(){return E("tlswrap")}}}function w(){return{buf:"",write:function(S){this.buf+=S},end:function(S){this.buf+=S},read:function(){return this.buf}}}i.writeToStream=function(S,C,_){return _===void 0&&(_=C,C={}),x(C=y(S,C),_).dispatch(S)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){(function(p){var g=typeof Uint8Array!="undefined"?Uint8Array:Array,m="+".charCodeAt(0),v="/".charCodeAt(0),y="0".charCodeAt(0),b="a".charCodeAt(0),x="A".charCodeAt(0),w="-".charCodeAt(0),S="_".charCodeAt(0);function C(_){var E=_.charCodeAt(0);return E===m||E===w?62:E===v||E===S?63:E<y?-1:E<y+10?E-y+26+26:E<x+26?E-x:E<b+26?E-b+26:void 0}p.toByteArray=function(_){var E,A;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var k=_.length,T=_.charAt(k-2)==="="?2:_.charAt(k-1)==="="?1:0,I=new g(3*_.length/4-T),N=0<T?_.length-4:_.length,O=0;function D(P){I[O++]=P}for(E=0;E<N;E+=4,0)D((16711680&(A=C(_.charAt(E))<<18|C(_.charAt(E+1))<<12|C(_.charAt(E+2))<<6|C(_.charAt(E+3))))>>16),D((65280&A)>>8),D(255&A);return T==2?D(255&(A=C(_.charAt(E))<<2|C(_.charAt(E+1))>>4)):T==1&&(D((A=C(_.charAt(E))<<10|C(_.charAt(E+1))<<4|C(_.charAt(E+2))>>2)>>8&255),D(255&A)),I},p.fromByteArray=function(_){var E,A,k,T,I=_.length%3,N="";function O(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(E=0,k=_.length-I;E<k;E+=3)A=(_[E]<<16)+(_[E+1]<<8)+_[E+2],N+=O((T=A)>>18&63)+O(T>>12&63)+O(T>>6&63)+O(63&T);switch(I){case 1:N+=O((A=_[_.length-1])>>2),N+=O(A<<4&63),N+="==";break;case 2:N+=O((A=(_[_.length-2]<<8)+_[_.length-1])>>10),N+=O(A>>4&63),N+=O(A<<2&63),N+="="}return N}})(i===void 0?this.base64js={}:i)}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("base64-js"),g=n("ieee754");function s($,F,q){if(!(this instanceof s))return new s($,F,q);var ue,J,L,z,R,Z=typeof $;if(F==="base64"&&Z=="string")for($=(ue=$).trim?ue.trim():ue.replace(/^\s+|\s+$/g,"");$.length%4!=0;)$+="=";if(Z=="number")J=P($);else if(Z=="string")J=s.byteLength($,F);else{if(Z!="object")throw new Error("First argument needs to be a number, array or string.");J=P($.length)}if(s._useTypedArrays?L=s._augment(new Uint8Array(J)):((L=this).length=J,L._isBuffer=!0),s._useTypedArrays&&typeof $.byteLength=="number")L._set($);else if(V(R=$)||s.isBuffer(R)||R&&typeof R=="object"&&typeof R.length=="number")for(z=0;z<J;z++)s.isBuffer($)?L[z]=$.readUInt8(z):L[z]=$[z];else if(Z=="string")L.write($,0,F);else if(Z=="number"&&!s._useTypedArrays&&!q)for(z=0;z<J;z++)L[z]=0;return L}function m($,F,q,ue){return s._charsWritten=me(function(J){for(var L=[],z=0;z<J.length;z++)L.push(255&J.charCodeAt(z));return L}(F),$,q,ue)}function v($,F,q,ue){return s._charsWritten=me(function(J){for(var L,z,R,Z=[],xe=0;xe<J.length;xe++)L=J.charCodeAt(xe),z=L>>8,R=L%256,Z.push(R),Z.push(z);return Z}(F),$,q,ue)}function y($,F,q){var ue="";q=Math.min($.length,q);for(var J=F;J<q;J++)ue+=String.fromCharCode($[J]);return ue}function b($,F,q,ue){ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F!=null,"missing offset"),ve(F+1<$.length,"Trying to read beyond buffer length"));var J,L=$.length;if(!(L<=F))return q?(J=$[F],F+1<L&&(J|=$[F+1]<<8)):(J=$[F]<<8,F+1<L&&(J|=$[F+1])),J}function x($,F,q,ue){ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F!=null,"missing offset"),ve(F+3<$.length,"Trying to read beyond buffer length"));var J,L=$.length;if(!(L<=F))return q?(F+2<L&&(J=$[F+2]<<16),F+1<L&&(J|=$[F+1]<<8),J|=$[F],F+3<L&&(J+=$[F+3]<<24>>>0)):(F+1<L&&(J=$[F+1]<<16),F+2<L&&(J|=$[F+2]<<8),F+3<L&&(J|=$[F+3]),J+=$[F]<<24>>>0),J}function w($,F,q,ue){if(ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F!=null,"missing offset"),ve(F+1<$.length,"Trying to read beyond buffer length")),!($.length<=F)){var J=b($,F,q,!0);return 32768&J?-1*(65535-J+1):J}}function S($,F,q,ue){if(ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F!=null,"missing offset"),ve(F+3<$.length,"Trying to read beyond buffer length")),!($.length<=F)){var J=x($,F,q,!0);return 2147483648&J?-1*(4294967295-J+1):J}}function C($,F,q,ue){return ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F+3<$.length,"Trying to read beyond buffer length")),g.read($,F,q,23,4)}function _($,F,q,ue){return ue||(ve(typeof q=="boolean","missing or invalid endian"),ve(F+7<$.length,"Trying to read beyond buffer length")),g.read($,F,q,52,8)}function E($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+1<$.length,"trying to write beyond buffer length"),Ne(F,65535));var L=$.length;if(!(L<=q))for(var z=0,R=Math.min(L-q,2);z<R;z++)$[q+z]=(F&255<<8*(ue?z:1-z))>>>8*(ue?z:1-z)}function A($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+3<$.length,"trying to write beyond buffer length"),Ne(F,4294967295));var L=$.length;if(!(L<=q))for(var z=0,R=Math.min(L-q,4);z<R;z++)$[q+z]=F>>>8*(ue?z:3-z)&255}function k($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+1<$.length,"Trying to write beyond buffer length"),Oe(F,32767,-32768)),$.length<=q||E($,0<=F?F:65535+F+1,q,ue,J)}function T($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+3<$.length,"Trying to write beyond buffer length"),Oe(F,2147483647,-2147483648)),$.length<=q||A($,0<=F?F:4294967295+F+1,q,ue,J)}function I($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+3<$.length,"Trying to write beyond buffer length"),$e(F,34028234663852886e22,-34028234663852886e22)),$.length<=q||g.write($,F,q,ue,23,4)}function N($,F,q,ue,J){J||(ve(F!=null,"missing value"),ve(typeof ue=="boolean","missing or invalid endian"),ve(q!=null,"missing offset"),ve(q+7<$.length,"Trying to write beyond buffer length"),$e(F,17976931348623157e292,-17976931348623157e292)),$.length<=q||g.write($,F,q,ue,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var $=new ArrayBuffer(0),F=new Uint8Array($);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(q){return!1}}(),s.isEncoding=function($){switch(String($).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function($){return!($==null||!$._isBuffer)},s.byteLength=function($,F){var q;switch($+="",F||"utf8"){case"hex":q=$.length/2;break;case"utf8":case"utf-8":q=X($).length;break;case"ascii":case"binary":case"raw":q=$.length;break;case"base64":q=Q($).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":q=2*$.length;break;default:throw new Error("Unknown encoding")}return q},s.concat=function($,F){if(ve(V($),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),$.length===0)return new s(0);if($.length===1)return $[0];if(typeof F!="number")for(J=F=0;J<$.length;J++)F+=$[J].length;for(var q=new s(F),ue=0,J=0;J<$.length;J++){var L=$[J];L.copy(q,ue),ue+=L.length}return q},s.prototype.write=function($,F,q,ue){var J;isFinite(F)?isFinite(q)||(ue=q,q=void 0):(J=ue,ue=F,F=q,q=J),F=Number(F)||0;var L,z,R,Z,xe,Ee,Me,Ve,Je,Ft=this.length-F;switch((!q||Ft<(q=Number(q)))&&(q=Ft),ue=String(ue||"utf8").toLowerCase()){case"hex":L=function(et,Gt,rn,kn){rn=Number(rn)||0;var Br=et.length-rn;(!kn||Br<(kn=Number(kn)))&&(kn=Br);var Jn=Gt.length;ve(Jn%2==0,"Invalid hex string"),Jn/2<kn&&(kn=Jn/2);for(var _n=0;_n<kn;_n++){var Xi=parseInt(Gt.substr(2*_n,2),16);ve(!isNaN(Xi),"Invalid hex string"),et[rn+_n]=Xi}return s._charsWritten=2*_n,_n}(this,$,F,q);break;case"utf8":case"utf-8":Ee=this,Me=$,Ve=F,Je=q,L=s._charsWritten=me(X(Me),Ee,Ve,Je);break;case"ascii":case"binary":L=m(this,$,F,q);break;case"base64":z=this,R=$,Z=F,xe=q,L=s._charsWritten=me(Q(R),z,Z,xe);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":L=v(this,$,F,q);break;default:throw new Error("Unknown encoding")}return L},s.prototype.toString=function($,F,q){var ue,J,L,z,R=this;if($=String($||"utf8").toLowerCase(),F=Number(F)||0,(q=q!==void 0?Number(q):q=R.length)===F)return"";switch($){case"hex":ue=function(Z,xe,Ee){var Me=Z.length;(!xe||xe<0)&&(xe=0),(!Ee||Ee<0||Me<Ee)&&(Ee=Me);for(var Ve="",Je=xe;Je<Ee;Je++)Ve+=Y(Z[Je]);return Ve}(R,F,q);break;case"utf8":case"utf-8":ue=function(Z,xe,Ee){var Me="",Ve="";Ee=Math.min(Z.length,Ee);for(var Je=xe;Je<Ee;Je++)Z[Je]<=127?(Me+=ce(Ve)+String.fromCharCode(Z[Je]),Ve=""):Ve+="%"+Z[Je].toString(16);return Me+ce(Ve)}(R,F,q);break;case"ascii":case"binary":ue=y(R,F,q);break;case"base64":J=R,z=q,ue=(L=F)===0&&z===J.length?p.fromByteArray(J):p.fromByteArray(J.slice(L,z));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ue=function(Z,xe,Ee){for(var Me=Z.slice(xe,Ee),Ve="",Je=0;Je<Me.length;Je+=2)Ve+=String.fromCharCode(Me[Je]+256*Me[Je+1]);return Ve}(R,F,q);break;default:throw new Error("Unknown encoding")}return ue},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function($,F,q,ue){if(q=q||0,ue||ue===0||(ue=this.length),F=F||0,ue!==q&&$.length!==0&&this.length!==0){ve(q<=ue,"sourceEnd < sourceStart"),ve(0<=F&&F<$.length,"targetStart out of bounds"),ve(0<=q&&q<this.length,"sourceStart out of bounds"),ve(0<=ue&&ue<=this.length,"sourceEnd out of bounds"),ue>this.length&&(ue=this.length),$.length-F<ue-q&&(ue=$.length-F+q);var J=ue-q;if(J<100||!s._useTypedArrays)for(var L=0;L<J;L++)$[L+F]=this[L+q];else $._set(this.subarray(q,q+J),F)}},s.prototype.slice=function($,F){var q=this.length;if($=D($,q,0),F=D(F,q,q),s._useTypedArrays)return s._augment(this.subarray($,F));for(var ue=F-$,J=new s(ue,void 0,!0),L=0;L<ue;L++)J[L]=this[L+$];return J},s.prototype.get=function($){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8($)},s.prototype.set=function($,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8($,F)},s.prototype.readUInt8=function($,F){if(F||(ve($!=null,"missing offset"),ve($<this.length,"Trying to read beyond buffer length")),!($>=this.length))return this[$]},s.prototype.readUInt16LE=function($,F){return b(this,$,!0,F)},s.prototype.readUInt16BE=function($,F){return b(this,$,!1,F)},s.prototype.readUInt32LE=function($,F){return x(this,$,!0,F)},s.prototype.readUInt32BE=function($,F){return x(this,$,!1,F)},s.prototype.readInt8=function($,F){if(F||(ve($!=null,"missing offset"),ve($<this.length,"Trying to read beyond buffer length")),!($>=this.length))return 128&this[$]?-1*(255-this[$]+1):this[$]},s.prototype.readInt16LE=function($,F){return w(this,$,!0,F)},s.prototype.readInt16BE=function($,F){return w(this,$,!1,F)},s.prototype.readInt32LE=function($,F){return S(this,$,!0,F)},s.prototype.readInt32BE=function($,F){return S(this,$,!1,F)},s.prototype.readFloatLE=function($,F){return C(this,$,!0,F)},s.prototype.readFloatBE=function($,F){return C(this,$,!1,F)},s.prototype.readDoubleLE=function($,F){return _(this,$,!0,F)},s.prototype.readDoubleBE=function($,F){return _(this,$,!1,F)},s.prototype.writeUInt8=function($,F,q){q||(ve($!=null,"missing value"),ve(F!=null,"missing offset"),ve(F<this.length,"trying to write beyond buffer length"),Ne($,255)),F>=this.length||(this[F]=$)},s.prototype.writeUInt16LE=function($,F,q){E(this,$,F,!0,q)},s.prototype.writeUInt16BE=function($,F,q){E(this,$,F,!1,q)},s.prototype.writeUInt32LE=function($,F,q){A(this,$,F,!0,q)},s.prototype.writeUInt32BE=function($,F,q){A(this,$,F,!1,q)},s.prototype.writeInt8=function($,F,q){q||(ve($!=null,"missing value"),ve(F!=null,"missing offset"),ve(F<this.length,"Trying to write beyond buffer length"),Oe($,127,-128)),F>=this.length||(0<=$?this.writeUInt8($,F,q):this.writeUInt8(255+$+1,F,q))},s.prototype.writeInt16LE=function($,F,q){k(this,$,F,!0,q)},s.prototype.writeInt16BE=function($,F,q){k(this,$,F,!1,q)},s.prototype.writeInt32LE=function($,F,q){T(this,$,F,!0,q)},s.prototype.writeInt32BE=function($,F,q){T(this,$,F,!1,q)},s.prototype.writeFloatLE=function($,F,q){I(this,$,F,!0,q)},s.prototype.writeFloatBE=function($,F,q){I(this,$,F,!1,q)},s.prototype.writeDoubleLE=function($,F,q){N(this,$,F,!0,q)},s.prototype.writeDoubleBE=function($,F,q){N(this,$,F,!1,q)},s.prototype.fill=function($,F,q){if($=$||0,F=F||0,q=q||this.length,typeof $=="string"&&($=$.charCodeAt(0)),ve(typeof $=="number"&&!isNaN($),"value is not a number"),ve(F<=q,"end < start"),q!==F&&this.length!==0){ve(0<=F&&F<this.length,"start out of bounds"),ve(0<=q&&q<=this.length,"end out of bounds");for(var ue=F;ue<q;ue++)this[ue]=$}},s.prototype.inspect=function(){for(var $=[],F=this.length,q=0;q<F;q++)if($[q]=Y(this[q]),q===i.INSPECT_MAX_BYTES){$[q+1]="...";break}return"<Buffer "+$.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var $=new Uint8Array(this.length),F=0,q=$.length;F<q;F+=1)$[F]=this[F];return $.buffer};var O=s.prototype;function D($,F,q){return typeof $!="number"?q:F<=($=~~$)?F:0<=$||0<=($+=F)?$:0}function P($){return($=~~Math.ceil(+$))<0?0:$}function V($){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})($)}function Y($){return $<16?"0"+$.toString(16):$.toString(16)}function X($){for(var F=[],q=0;q<$.length;q++){var ue=$.charCodeAt(q);if(ue<=127)F.push($.charCodeAt(q));else{var J=q;55296<=ue&&ue<=57343&&q++;for(var L=encodeURIComponent($.slice(J,q+1)).substr(1).split("%"),z=0;z<L.length;z++)F.push(parseInt(L[z],16))}}return F}function Q($){return p.toByteArray($)}function me($,F,q,ue){for(var J=0;J<ue&&!(J+q>=F.length||J>=$.length);J++)F[J+q]=$[J];return J}function ce($){try{return decodeURIComponent($)}catch(F){return String.fromCharCode(65533)}}function Ne($,F){ve(typeof $=="number","cannot write a non-number as a number"),ve(0<=$,"specified a negative value for writing an unsigned value"),ve($<=F,"value is larger than maximum value for type"),ve(Math.floor($)===$,"value has a fractional component")}function Oe($,F,q){ve(typeof $=="number","cannot write a non-number as a number"),ve($<=F,"value larger than maximum allowed value"),ve(q<=$,"value smaller than minimum allowed value"),ve(Math.floor($)===$,"value has a fractional component")}function $e($,F,q){ve(typeof $=="number","cannot write a non-number as a number"),ve($<=F,"value larger than maximum allowed value"),ve(q<=$,"value smaller than minimum allowed value")}function ve($,F){if(!$)throw new Error(F||"Failed assertion")}s._augment=function($){return $._isBuffer=!0,$._get=$.get,$._set=$.set,$.get=O.get,$.set=O.set,$.write=O.write,$.toString=O.toString,$.toLocaleString=O.toString,$.toJSON=O.toJSON,$.copy=O.copy,$.slice=O.slice,$.readUInt8=O.readUInt8,$.readUInt16LE=O.readUInt16LE,$.readUInt16BE=O.readUInt16BE,$.readUInt32LE=O.readUInt32LE,$.readUInt32BE=O.readUInt32BE,$.readInt8=O.readInt8,$.readInt16LE=O.readInt16LE,$.readInt16BE=O.readInt16BE,$.readInt32LE=O.readInt32LE,$.readInt32BE=O.readInt32BE,$.readFloatLE=O.readFloatLE,$.readFloatBE=O.readFloatBE,$.readDoubleLE=O.readDoubleLE,$.readDoubleBE=O.readDoubleBE,$.writeUInt8=O.writeUInt8,$.writeUInt16LE=O.writeUInt16LE,$.writeUInt16BE=O.writeUInt16BE,$.writeUInt32LE=O.writeUInt32LE,$.writeUInt32BE=O.writeUInt32BE,$.writeInt8=O.writeInt8,$.writeInt16LE=O.writeInt16LE,$.writeInt16BE=O.writeInt16BE,$.writeInt32LE=O.writeInt32LE,$.writeInt32BE=O.writeInt32BE,$.writeFloatLE=O.writeFloatLE,$.writeFloatBE=O.writeFloatBE,$.writeDoubleLE=O.writeDoubleLE,$.writeDoubleBE=O.writeDoubleBE,$.fill=O.fill,$.inspect=O.inspect,$.toArrayBuffer=O.toArrayBuffer,$}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=4,g=new s(p);g.fill(0),r.exports={hash:function(m,v,y,b){return s.isBuffer(m)||(m=new s(m)),function(x,w,S){for(var C=new s(w),_=S?C.writeInt32BE:C.writeInt32LE,E=0;E<x.length;E++)_.call(C,x[E],4*E,!0);return C}(v(function(x,w){var S;x.length%p!=0&&(S=x.length+(p-x.length%p),x=s.concat([x,g],S));for(var C=[],_=w?x.readInt32BE:x.readInt32LE,E=0;E<x.length;E+=p)C.push(_.call(x,E));return C}(m,b),8*m.length),y,b)}}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=n("./sha"),g=n("./sha256"),m=n("./rng"),v={sha1:p,sha256:g,md5:n("./md5")},y=64,b=new s(y);function x(S,C){var _=v[S=S||"sha1"],E=[];return _||w("algorithm:",S,"is not yet supported"),{update:function(A){return s.isBuffer(A)||(A=new s(A)),E.push(A),A.length,this},digest:function(A){var k=s.concat(E),T=C?function(I,N,O){s.isBuffer(N)||(N=new s(N)),s.isBuffer(O)||(O=new s(O)),N.length>y?N=I(N):N.length<y&&(N=s.concat([N,b],y));for(var D=new s(y),P=new s(y),V=0;V<y;V++)D[V]=54^N[V],P[V]=92^N[V];var Y=I(s.concat([D,O]));return I(s.concat([P,Y]))}(_,C,k):_(k);return E=null,A?T.toString(A):T}}}function w(){var S=[].slice.call(arguments).join(" ");throw new Error([S,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}b.fill(0),i.createHash=function(S){return x(S)},i.createHmac=x,i.randomBytes=function(S,C){if(!C||!C.call)return new s(m(S));try{C.call(this,void 0,new s(m(S)))}catch(_){C(_)}},function(S,C){for(var _ in S)C(S[_],_)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(S){i[S]=function(){w("sorry,",S,"is not implemented yet")}})}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(S,C){S[C>>5]|=128<<C%32,S[14+(C+64>>>9<<4)]=C;for(var _=1732584193,E=-271733879,A=-1732584194,k=271733878,T=0;T<S.length;T+=16){var I=_,N=E,O=A,D=k,_=v(_,E,A,k,S[T+0],7,-680876936),k=v(k,_,E,A,S[T+1],12,-389564586),A=v(A,k,_,E,S[T+2],17,606105819),E=v(E,A,k,_,S[T+3],22,-1044525330);_=v(_,E,A,k,S[T+4],7,-176418897),k=v(k,_,E,A,S[T+5],12,1200080426),A=v(A,k,_,E,S[T+6],17,-1473231341),E=v(E,A,k,_,S[T+7],22,-45705983),_=v(_,E,A,k,S[T+8],7,1770035416),k=v(k,_,E,A,S[T+9],12,-1958414417),A=v(A,k,_,E,S[T+10],17,-42063),E=v(E,A,k,_,S[T+11],22,-1990404162),_=v(_,E,A,k,S[T+12],7,1804603682),k=v(k,_,E,A,S[T+13],12,-40341101),A=v(A,k,_,E,S[T+14],17,-1502002290),_=y(_,E=v(E,A,k,_,S[T+15],22,1236535329),A,k,S[T+1],5,-165796510),k=y(k,_,E,A,S[T+6],9,-1069501632),A=y(A,k,_,E,S[T+11],14,643717713),E=y(E,A,k,_,S[T+0],20,-373897302),_=y(_,E,A,k,S[T+5],5,-701558691),k=y(k,_,E,A,S[T+10],9,38016083),A=y(A,k,_,E,S[T+15],14,-660478335),E=y(E,A,k,_,S[T+4],20,-405537848),_=y(_,E,A,k,S[T+9],5,568446438),k=y(k,_,E,A,S[T+14],9,-1019803690),A=y(A,k,_,E,S[T+3],14,-187363961),E=y(E,A,k,_,S[T+8],20,1163531501),_=y(_,E,A,k,S[T+13],5,-1444681467),k=y(k,_,E,A,S[T+2],9,-51403784),A=y(A,k,_,E,S[T+7],14,1735328473),_=b(_,E=y(E,A,k,_,S[T+12],20,-1926607734),A,k,S[T+5],4,-378558),k=b(k,_,E,A,S[T+8],11,-2022574463),A=b(A,k,_,E,S[T+11],16,1839030562),E=b(E,A,k,_,S[T+14],23,-35309556),_=b(_,E,A,k,S[T+1],4,-1530992060),k=b(k,_,E,A,S[T+4],11,1272893353),A=b(A,k,_,E,S[T+7],16,-155497632),E=b(E,A,k,_,S[T+10],23,-1094730640),_=b(_,E,A,k,S[T+13],4,681279174),k=b(k,_,E,A,S[T+0],11,-358537222),A=b(A,k,_,E,S[T+3],16,-722521979),E=b(E,A,k,_,S[T+6],23,76029189),_=b(_,E,A,k,S[T+9],4,-640364487),k=b(k,_,E,A,S[T+12],11,-421815835),A=b(A,k,_,E,S[T+15],16,530742520),_=x(_,E=b(E,A,k,_,S[T+2],23,-995338651),A,k,S[T+0],6,-198630844),k=x(k,_,E,A,S[T+7],10,1126891415),A=x(A,k,_,E,S[T+14],15,-1416354905),E=x(E,A,k,_,S[T+5],21,-57434055),_=x(_,E,A,k,S[T+12],6,1700485571),k=x(k,_,E,A,S[T+3],10,-1894986606),A=x(A,k,_,E,S[T+10],15,-1051523),E=x(E,A,k,_,S[T+1],21,-2054922799),_=x(_,E,A,k,S[T+8],6,1873313359),k=x(k,_,E,A,S[T+15],10,-30611744),A=x(A,k,_,E,S[T+6],15,-1560198380),E=x(E,A,k,_,S[T+13],21,1309151649),_=x(_,E,A,k,S[T+4],6,-145523070),k=x(k,_,E,A,S[T+11],10,-1120210379),A=x(A,k,_,E,S[T+2],15,718787259),E=x(E,A,k,_,S[T+9],21,-343485551),_=w(_,I),E=w(E,N),A=w(A,O),k=w(k,D)}return Array(_,E,A,k)}function m(S,C,_,E,A,k){return w((T=w(w(C,S),w(E,k)))<<(I=A)|T>>>32-I,_);var T,I}function v(S,C,_,E,A,k,T){return m(C&_|~C&E,S,C,A,k,T)}function y(S,C,_,E,A,k,T){return m(C&E|_&~E,S,C,A,k,T)}function b(S,C,_,E,A,k,T){return m(C^_^E,S,C,A,k,T)}function x(S,C,_,E,A,k,T){return m(_^(C|~E),S,C,A,k,T)}function w(S,C){var _=(65535&S)+(65535&C);return(S>>16)+(C>>16)+(_>>16)<<16|65535&_}r.exports=function(S){return p.hash(S,g,16)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p;p=function(g){for(var m,v=new Array(g),y=0;y<g;y++)(3&y)==0&&(m=4294967296*Math.random()),v[y]=m>>>((3&y)<<3)&255;return v},r.exports=p}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(y,b){y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var x,w,S,C,_,E=Array(80),A=1732584193,k=-271733879,T=-1732584194,I=271733878,N=-1009589776,O=0;O<y.length;O+=16){for(var D=A,P=k,V=T,Y=I,X=N,Q=0;Q<80;Q++){E[Q]=Q<16?y[O+Q]:v(E[Q-3]^E[Q-8]^E[Q-14]^E[Q-16],1);var me=m(m(v(A,5),(S=k,C=T,_=I,(w=Q)<20?S&C|~S&_:!(w<40)&&w<60?S&C|S&_|C&_:S^C^_)),m(m(N,E[Q]),(x=Q)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),N=I,I=T,T=v(k,30),k=A,A=me}A=m(A,D),k=m(k,P),T=m(T,V),I=m(I,Y),N=m(N,X)}return Array(A,k,T,I,N)}function m(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function v(y,b){return y<<b|y>>>32-b}r.exports=function(y){return p.hash(y,g,20,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function g(y,b){return y>>>b|y<<32-b}function m(y,b){var x,w,S,C,_,E,A,k,T,I,N=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64);y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var P,V,Y,X,Q,me,ce,Ne,Oe=0;Oe<y.length;Oe+=16){x=O[0],w=O[1],S=O[2],C=O[3],_=O[4],E=O[5],A=O[6],k=O[7];for(var $e=0;$e<64;$e++)D[$e]=$e<16?y[$e+Oe]:p(p(p((Ne=D[$e-2],g(Ne,17)^g(Ne,19)^Ne>>>10),D[$e-7]),(ce=D[$e-15],g(ce,7)^g(ce,18)^ce>>>3)),D[$e-16]),T=p(p(p(p(k,g(me=_,6)^g(me,11)^g(me,25)),(Q=_)&E^~Q&A),N[$e]),D[$e]),I=p(g(X=x,2)^g(X,13)^g(X,22),(P=x)&(V=w)^P&(Y=S)^V&Y),k=A,A=E,E=_,_=p(C,T),C=S,S=w,w=x,x=p(T,I);O[0]=p(x,O[0]),O[1]=p(w,O[1]),O[2]=p(S,O[2]),O[3]=p(C,O[3]),O[4]=p(_,O[4]),O[5]=p(E,O[5]),O[6]=p(A,O[6]),O[7]=p(k,O[7])}return O}var v=n("./helpers");r.exports=function(y){return v.hash(y,m,32,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(){}(a=r.exports={}).nextTick=function(){var g=typeof window!="undefined"&&window.setImmediate,m=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(g)return function(y){return window.setImmediate(y)};if(m){var v=[];return window.addEventListener("message",function(y){var b=y.source;b!==window&&b!==null||y.data!=="process-tick"||(y.stopPropagation(),0<v.length&&v.shift()())},!0),function(y){v.push(y),window.postMessage("process-tick","*")}}return function(y){setTimeout(y,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){i.read=function(p,g,m,v,y){var b,x,w=8*y-v-1,S=(1<<w)-1,C=S>>1,_=-7,E=m?y-1:0,A=m?-1:1,k=p[g+E];for(E+=A,b=k&(1<<-_)-1,k>>=-_,_+=w;0<_;b=256*b+p[g+E],E+=A,_-=8);for(x=b&(1<<-_)-1,b>>=-_,_+=v;0<_;x=256*x+p[g+E],E+=A,_-=8);if(b===0)b=1-C;else{if(b===S)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,v),b-=C}return(k?-1:1)*x*Math.pow(2,b-v)},i.write=function(p,g,m,v,y,b){var x,w,S,C=8*b-y-1,_=(1<<C)-1,E=_>>1,A=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=v?0:b-1,T=v?1:-1,I=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,x=_):(x=Math.floor(Math.log(g)/Math.LN2),g*(S=Math.pow(2,-x))<1&&(x--,S*=2),2<=(g+=1<=x+E?A/S:A*Math.pow(2,1-E))*S&&(x++,S/=2),_<=x+E?(w=0,x=_):1<=x+E?(w=(g*S-1)*Math.pow(2,y),x+=E):(w=g*Math.pow(2,E-1)*Math.pow(2,y),x=0));8<=y;p[m+k]=255&w,k+=T,w/=256,y-=8);for(x=x<<y|w,C+=y;0<C;p[m+k]=255&x,k+=T,x/=256,C-=8);p[m+k-T]|=128*I}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)})})(rZ);var wLe=rZ.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var iZ=function(e,t){return(iZ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Yu(e,t){function n(){this.constructor=e}iZ(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function dt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function ht(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var aZ=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return _Le(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(a){var o=a.split(":"),s=o[0],u=o[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function _Le(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function we(){return wM}var wM=null,s0=new Map,H1=new Map;function _M(e,t){var n=AM(e,t);return s0.get(n)}function SM(e){return H1.get(e)}function EM(e){for(var t=s0.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===e&&n.push(s)}return n}function CM(e){var t=e.kernelName,n=e.backendName,r=AM(t,n);if(s0.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");s0.set(r,e)}function oZ(e){var t=e.kernelName;H1.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),H1.set(t,e)}function SLe(e,t){var n=AM(e,t);if(!s0.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");s0.delete(n)}function ELe(e){if(!H1.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");H1.delete(e)}function AM(e,t){return t+"_"+e}function sZ(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function xC(e,t,n){return Math.max(e,Math.min(t,n))}function kM(e){return e%2==0?e:e+1}function uZ(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function H(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function On(e,t,n){n===void 0&&(n=""),H(wi(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function ug(e){H(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function kf(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||ma(e)&&!n)for(var r=0;r<e.length;++r)kf(e[r],t,n);else t.push(e);return t}function ft(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function wi(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Wr(e){return e%1==0}function lZ(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function wC(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function lg(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function TM(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?i():setTimeout(o,s)}};o()})}function cZ(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function _i(e,t){var n=t.length;return H((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),H(e.every(function(r){return Wr(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Jd(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:_i(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function cg(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function G1(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function fZ(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function dZ(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function hZ(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function ma(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function OM(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function pZ(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Qd(e){return typeof e=="string"||e instanceof String}function gZ(e){return typeof e=="boolean"}function mZ(e){return typeof e=="number"}function u0(e){return Array.isArray(e)?u0(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":mZ(e)?"float32":Qd(e)?"string":gZ(e)?"bool":"float32"}function eh(e){return!!(e&&e.constructor&&e.call&&e.apply)}function _C(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Wo(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function IM(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=kf(e)),n&&fZ(e,t),function(a,o){return a instanceof Float32Array&&o==="float32"||a instanceof Int32Array&&o==="int32"||a instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function NM(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,a,o){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=o[i+l];else{u=a[0];var c=a.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(i+l*f,c,o)}return s}(0,e,t)}function DM(e,t){for(var n=l0(e,t),r=0;r<n.length;r++)n[r]=1;return n}function l0(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Zu(){return we().platform.now()}function RM(e){e.forEach(function(t){H(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function vZ(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",we().platform.encode(e,t)}function K1(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",we().platform.decode(e,t)}function SC(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function FM(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var Ct=Object.freeze({shuffle:sZ,clamp:xC,nearestLargerEven:kM,sum:uZ,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:H,assertShapesMatch:On,assertNonNull:ug,flatten:kf,sizeFromShape:ft,isScalarShape:function(e){return e.length===0},arraysEqual:wi,isInt:Wr,tanh:lZ,sizeToSquarishShape:wC,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return sZ(t),t},rightPad:lg,repeatedTry:TM,inferFromImplicitShape:cZ,parseAxisParam:_i,squeezeShape:Jd,getTypedArrayFromDType:cg,getArrayFromDType:G1,checkConversionForErrors:fZ,isValidDtype:dZ,hasEncodingLoss:hZ,isTypedArray:ma,bytesPerElement:OM,bytesFromStringArray:pZ,isString:Qd,isBoolean:gZ,isNumber:mZ,inferDtype:u0,isFunction:eh,nearestDivisor:_C,computeStrides:Wo,toTypedArray:IM,toNestedArray:NM,makeOnesTypedArray:DM,makeZerosTypedArray:l0,now:Zu,assertNonNegativeIntegerDimensions:RM,fetch:function(e,t){return we().platform.fetch(e,t)},encodeString:vZ,decodeString:K1,locToIndex:SC,indexToLoc:FM}),CLe=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new ALe)}return e.prototype.profileKernel=function(t,n,r){var i,a=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),o.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),i},e}(),ALe=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?lg(i+"ms",9):i.error,u=lg(t,25),l=n.rank,c=n.size,f=lg(n.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||n.shape,g=p.length;d+=h+": "+g+"D "+(g>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),yZ=20,X1=3,MM=7;function kLe(e,t,n,r){var i=Wo(t),a=function(l,c,f,d){var h=ft(c),p=d[d.length-1],g=new Array(p).fill(0),m=c.length,v=f==="complex64"?Z1(l):l;if(m>1)for(var y=0;y<h/p;y++)for(var b=y*p,x=0;x<p;x++)g[x]=Math.max(g[x],Y1(v[b+x],0,f).length);return g}(e,t,n,i),o=t.length,s=function l(c,f,d,h,p,g){g===void 0&&(g=!0);var m=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[Y1(Z1(c)[0],0,d)]:d==="bool"?[bZ(c[0])]:[c[0].toString()];if(y===1){if(v>yZ){var b=X1*m,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-X1)*m,v*m));return d==="complex64"&&(x=Z1(x),w=Z1(w)),["["+x.map(function(O,D){return Y1(O,p[D],d)}).join(", ")+", ..., "+w.map(function(O,D){return Y1(O,p[v-X1+D],d)}).join(", ")+"]"]}return["["+(d==="complex64"?Z1(c):Array.from(c)).map(function(O,D){return Y1(O,p[D],d)}).join(", ")+"]"]}var S=f.slice(1),C=h.slice(1),_=h[0]*m,E=[];if(v>yZ){for(var A=0;A<X1;A++){var k=(T=A*_)+_;E.push.apply(E,l(c.slice(T,k),S,d,C,p,!1))}for(E.push("..."),A=v-X1;A<v;A++)k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}else for(A=0;A<v;A++){var T;k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}var I=y===2?",":"";for(E[0]="["+E[0]+I,A=1;A<E.length-1;A++)E[A]=" "+E[A]+I;var N=`,
`;for(A=2;A<y;A++)N+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(g?"":N),E}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Y1(e,t,n){return lg(Array.isArray(e)?parseFloat(e[0].toFixed(MM))+" + "+parseFloat(e[1].toFixed(MM))+"j":Qd(e)?"'"+e+"'":n==="bool"?bZ(e):parseFloat(e.toFixed(MM)).toString(),t)}function bZ(e){return e===0?"false":"true"}function Z1(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var c0=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=ft(t),r!=null){var a=r.length;H(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||G1(n,this.size),this.strides=Wo(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),H(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return nc().makeTensor(this.values,this.shape,this.dtype)},e}(),nc=null,Ce=null,xZ=null,fn=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ft(t),this.strides=Wo(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),H(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),Ce.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return dt(this,void 0,void 0,function(){var t;return ht(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Ce.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Ce.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return dt(this,void 0,void 0,function(){var t;return ht(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,NM(this.shape,t)]}})})},e.prototype.arraySync=function(){return NM(this.shape,this.dataSync())},e.prototype.data=function(){return dt(this,void 0,void 0,function(){var t,n;return ht(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=nc().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return K1(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=nc().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return K1(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return dt(this,void 0,void 0,function(){var t;return ht(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,nc().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(nc().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Ce.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Ce.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Ce.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),Ce.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Ce.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Ce.clone(this)},e.prototype.toString=function(t){return t===void 0&&(t=!1),kLe(this.dataSync(),this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Ce.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),Ce.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),Ce.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),Ce.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Ce.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Ce.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Ce.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Ce.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Ce.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Ce.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),xZ("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ce.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Ce.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Ce.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Ce.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Ce.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Ce.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Ce.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Ce.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Ce.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Ce.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Ce.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Ce.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Ce.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Ce.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Ce.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Ce.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Ce.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Ce.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Ce.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Ce.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Ce.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Ce.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Ce.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Ce.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Ce.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Ce.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Ce.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Ce.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Ce.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Ce.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Ce.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ce.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Ce.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ce.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Ce.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Ce.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Ce.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Ce.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Ce.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Ce.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Ce.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Ce.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Ce.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Ce.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Ce.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Ce.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Ce.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Ce.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Ce.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Ce.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Ce.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Ce.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Ce.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Ce.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Ce.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Ce.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Ce.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Ce.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Ce.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Ce.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Ce.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Ce.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ce.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Ce.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Ce.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Ce.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Ce.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Ce.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Ce.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Ce.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Ce.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Ce.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Ce.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Ce.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Ce.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Ce.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Ce.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Ce.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Ce.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Ce.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Ce.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Ce.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Ce.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Ce.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Ce.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),Ce.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),Ce.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),Ce.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),Ce.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),Ce.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),Ce.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),Ce.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),Ce.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),Ce.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),nc().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Ce.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Ce.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Ce.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Ce.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),Ce.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Ce.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Ce.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Ce.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Ce.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Ce.spectral.irfft(this)},e}();Object.defineProperty(fn,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var PM,$M,LM,BM,zM,J1=function(e){function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return Yu(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!wi(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");nc().disposeTensor(this),this.dataId=n.dataId,nc().incRef(this,null)},t.prototype.dispose=function(){nc().disposeVariable(this),this.isDisposedInternal=!0},t}(fn);Object.defineProperty(J1,Symbol.hasInstance,{value:function(e){return e instanceof fn&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(PM||(PM={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}($M||($M={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(LM||(LM={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(BM||(BM={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(zM||(zM={}));var TLe={float32:BM,int32:$M,bool:LM,complex64:zM};function na(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return TLe[e][t]}function EC(e){return na(e,"int32")}function Mr(e,t){if(e.dtype===t.dtype)return[e,t];var n=na(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function wZ(e,t){H(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function jM(e){var t=[];return function n(r,i,a){if(r!=null){if(r instanceof fn)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,i,a))}}}}(e,t,new Set),t}var UM,rc=Object.freeze({makeTypesMatch:Mr,assertTypesMatch:wZ,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:jM}),_Z=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),OLe=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new _Z}return e.prototype.ready=function(){return dt(this,void 0,void 0,function(){var t,n,r;return ht(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return dt(this,void 0,void 0,function(){var n,r,i;return ht(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=a.sent(),[3,3];case 2:i=r,a.label=3;case 3:if(!i)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new CLe(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;EM(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;EM(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var a=++this.pendingBackendInitId,o=i.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),a=i.success,o=i.asyncInit;if(o||a)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return i.startScope(a)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[],{}),n},e.prototype.runKernel=function(t,n,r,i,a){return this.runKernelFunc(null,n,null,t,r,i,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-a-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,a,o,s){var u,l=this,c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=_M(i,this.backendName);if(m!=null)d=function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:a,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b);var x=b.map(function(C){var _=C.dataId,E=C.shape,A=C.dtype;return l.makeTensorFromDataId(_,E,A)});if(f){var w=l.getTensorsForGradient(i,n,x);if(w==null){s==null&&(s=[]);var S=x.filter(function(C,_){return s[_]});w=(o||[]).slice().concat(S)}c=l.saveTensorsForBackwardMode(w)}return x};else{var v=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))};d=function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,v)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b),b}}return this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,n,function(){return d()}):d()}),f&&this.addTapeNode(i,n,u,r,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.saveTensorsForBackwardMode=function(t){var n=this;return t.map(function(r){return n.keep(n.clone(r))})},e.prototype.getTensorsForGradient=function(t,n,r){var i=SM(t);if(i!=null){var a=i.inputsToSave||[],o=i.outputsToSave||[],s=void 0;i.saveAllInputs?(H(Array.isArray(n),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(n).map(function(l){return n[l]})):s=a.map(function(l){return n[l]});var u=r.filter(function(l,c){return o[c]});return s.concat(u)}return null},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var a=t;r==="string"&&Qd(t[0])&&(a=t.map(function(c){return vZ(c)}));var o=i.write(a,n,r),s=new fn(n,r,o,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(o),l=pZ(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var a=new fn(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,i),a},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var a=new J1(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*OM(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof J1||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return dt(this,void 0,void 0,function(){var n,r;return ht(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,a,o){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=SM(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=function(c){return c=c.map(function(f,d){if(f==null){var h=r[d],p=l0(h.size,h.dtype);return s.makeTensor(p,h.shape,h.dtype)}return f}),i(c.length>1?c:c[0],a,o)}),this.state.activeTape.push(u)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=jM(t),i=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||i.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var a=this;if(i===void 0&&(i=!1),H(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});H(o instanceof fn,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var g in p){for(var m=p[g],v=!1,y=0;y<l.length;y++)if(f[m.id]){S.outputs.forEach(function(A){return f[A.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var g in p)b[p[g].id]=!0,x[S.id]=!0;break}var w=[];for(h=0;h<u.length;h++){var S;if(d[(S=u[h]).id]&&x[S.id]){var C={};for(var g in S.inputs){var _=S.inputs[g];f[_.id]&&(C[g]=_)}var E=Object.assign({},S);E.inputs=C,E.outputs=S.outputs,w.push(E)}}return w}(this.state.activeTape,n,o);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[o.id]=r??(u=o.shape,l=DM(ft(u),"float32"),te.makeTensor(l,u,"float32")),function(d,h,p){for(var g=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(C){var _=d[C.id];_!=null?b.push(_):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(C){if(!(C in x))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(x)+".");var _=p(function(){return x[C]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+_.dtype+"'");var E=y.inputs[C];if(!wi(_.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+C+"' has shape '"+_.shape+"', which does not match the shape of the input '"+E.shape+"'");if(d[E.id]==null)d[E.id]=_;else{var A=d[E.id];d[E.id]=A.add(_),A.dispose()}};for(var S in y.inputs)w(S)},m=h.length-1;m>=0;m--)g(m)}(c,s,function(d){return a.tidy(d)});var f=n.map(function(d){return c[d.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:o,grads:f}})},e.prototype.customGrad=function(t){var n=this;return H(eh(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];H(i.every(function(s){return s instanceof fn}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(s,u){o[u]=s}),n.runKernelFunc(function(s,u){return H((r=t.apply(void 0,i.concat([u]))).value instanceof fn,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),H(eh(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];H(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),H(c.every(function(d){return d instanceof fn}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return dt(this,void 0,void 0,function(){var n,r;return ht(this,function(i){switch(i.label){case 0:return n=Zu(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=Zu()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new _Z,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),te=function(){var e=function(){if(UM==null){var n=void 0;if(typeof window!="undefined")n=window;else if(typeof global!="undefined")n=global;else if(typeof process!="undefined")n=process;else{if(typeof self=="undefined")throw new Error("Could not find a global object");n=self}UM=n}return UM}();if(e._tfengine==null){var t=new aZ(e);e._tfengine=new OLe(t)}return function(n){wM=n}(e._tfengine.ENV),nc=function(){return e._tfengine},e._tfengine}();function SZ(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Tf=we();Tf.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Tf.registerFlag("IS_BROWSER",function(){return SZ()}),Tf.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&process.versions!==void 0&&process.versions.node!==void 0}),Tf.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Tf.registerFlag("PROD",function(){return!1}),Tf.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Tf.getBool("DEBUG")}),Tf.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Tf.registerFlag("IS_TEST",function(){return!1});var Q1,Cs,As,fg={},WM={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function EZ(e,t){fg[e]=t}function ic(e){e in fg||(fg[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete fg[n]},!1),n===1?r.getContext("webgl",WM)||r.getContext("experimental-webgl",WM):r.getContext("webgl2",WM)}(e));var t=fg[e];return t.isContextLost()?(delete fg[e],ic(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),fg[e])}function CC(e,t){return[t,e]}function ex(e){var t=ft(e);return wC(Math.ceil(t/4))}function tx(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function VM(e,t){var n,r,i,a,o,s,u,l,c,f=e;return we().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,i=f.RGBA16F,a=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=f.RGBA,o=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ct(e,t,n){var r=n();return t&&function(i){var a=i.getError();if(a!==i.NO_ERROR)throw new Error("WebGL Error: "+AZ(i,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Q1||(Q1={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Cs||(Cs={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(As||(As={}));var ILe=596e-10,NLe=65504;function CZ(e){return!!(we().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||ILe<Math.abs(e)&&Math.abs(e)<NLe)}function AZ(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function nx(e,t,n){return Of(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function kZ(e,t,n){var r=Of(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ct(e,t,function(){return e.shaderSource(r,n)}),ct(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function TZ(e,t,n){var r=Of(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ct(e,t,function(){return e.shaderSource(r,n)}),ct(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,a){var o=DLe.exec(a);if(o==null)return console.log("Couldn't parse line number in error: "+a),void console.log(i);for(var s=+o[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,v){return lg((v+1).toString(),l)+m}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+lg(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var AC,kC,DLe=/ERROR: [0-9]+:([0-9]+):/g;function OZ(e,t){return Of(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function IZ(e,t,n){if(ct(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function TC(e,t,n){if(ct(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function NZ(e,t,n){var r=Of(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ct(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ct(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function DZ(e,t,n){var r=Of(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ct(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ct(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function RZ(e,t){return Of(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function FZ(e,t){var n=we().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function MZ(e,t){return Of(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function qM(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return u!==-1&&(ct(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),ct(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)}),ct(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function PZ(e,t,n,r){jZ(e,r),ct(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function $Z(e,t,n,r){return Of(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function LZ(e,t,n){return e.getUniformLocation(t,n)}function BZ(e,t,n,r,i,a){ct(e,t,function(){return PZ(e,t,r,a)}),ct(e,t,function(){return e.uniform1i(i,a)})}function OC(e,t,n,r){ct(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ct(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function HM(e,t,n){ct(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ct(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function rx(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+zZ(e,t))}function zZ(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Of(e,t,n,r){var i=ct(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function jZ(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function ix(e,t){return t===void 0&&(t=2),ft(e.slice(0,e.length-t))}function ax(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function IC(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[ix(e)].concat(ax(e))),t}function UZ(e,t){var n;t===void 0&&(t=!1);var r=we().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?kM(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=Jd(e);e=i.newShape}var a=ft(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=ix(e),s=2,u=2;return e.length&&(s=(n=ax(e))[0],u=n[1]),wC(a=o*(s/2)*(u/2)).map(function(l){return 2*l})}return wC(a)}function NC(e){return e%2==0}function ox(e,t){if(wi(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||NC(n)&&NC(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&NC(e[0])&&NC(t[0])}function WZ(e){if(AC==null){var t=ic(e);AC=t.getParameter(t.MAX_TEXTURE_SIZE)}return AC}function VZ(e){if(kC==null){var t=ic(e);kC=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,kC)}function qZ(e){if(e===0)return 0;var t=ic(e);return ks(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ks(t,"EXT_disjoint_timer_query")?1:0}function ks(e,t){return e.getExtension(t)!=null}function GM(e){try{if(ic(e)!=null)return!0}catch(t){return!1}return!1}function HZ(e){if(e===0)return!1;var t=ic(e);if(e===1){if(!ks(t,"OES_texture_float"))return!1}else if(!ks(t,"EXT_color_buffer_float"))return!1;return KM(t)}function GZ(e){if(e===0)return!1;var t=ic(e);if(e!==1){if(ks(t,"EXT_color_buffer_float"))return KM(t);if(ks(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var a=VM(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!ks(t,"OES_texture_float")&&!!ks(t,"WEBGL_color_buffer_float")&&KM(t)}function KM(e){var t=VM(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function KZ(e){return e===2&&ic(e).fenceSync!=null}var RLe=Object.freeze({callAndCheck:ct,canBeRepresented:CZ,getWebGLErrorMessage:AZ,getExtensionOrThrow:nx,createVertexShader:kZ,createFragmentShader:TZ,createProgram:OZ,linkProgram:IZ,validateProgram:TC,createStaticVertexBuffer:NZ,createStaticIndexBuffer:DZ,getNumChannels:function(){return we().getNumber("WEBGL_VERSION")===2?1:4},createTexture:RZ,validateTextureSize:FZ,createFramebuffer:MZ,bindVertexBufferToProgramAttribute:qM,bindTextureUnit:PZ,unbindTextureUnit:function(e,t,n){jZ(e,n),ct(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:$Z,getProgramUniformLocation:LZ,bindTextureToProgramUniformSampler:BZ,bindCanvasToFramebuffer:function(e,t){ct(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),ct(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),ct(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:OC,unbindColorTextureFromFramebuffer:HM,validateFramebuffer:rx,getFramebufferErrorMessage:zZ,getBatchDim:ix,getRowsCols:ax,getShapeAs3D:IC,getTextureShapeFromLogicalShape:UZ,isReshapeFree:ox,getWebGLMaxTextureSize:WZ,resetMaxTextureSize:function(){AC=null},resetMaxTexturesInShader:function(){kC=null},getMaxTexturesInShader:VZ,getWebGLDisjointQueryTimerVersion:qZ,hasExtension:ks,isWebGLVersionEnabled:GM,isCapableOfRenderingToFloatTexture:HZ,isDownloadFloatTextureEnabled:GZ,isWebGLFenceEnabled:KZ}),zt=we();function FLe(){we().set("PROD",!0)}function MLe(){we().set("DEBUG",!0)}function PLe(){we().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function DC(e){we().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function $Le(){te.disposeVariables()}function LLe(){return te}function RC(){return te.memory()}function BLe(e){return te.profile(e)}function ge(e,t){return te.tidy(e,t)}function sn(e){jM(e).forEach(function(t){return t.dispose()})}function ac(e){return te.keep(e)}function zLe(e){return te.time(e)}function jLe(e){return te.setBackend(e)}function ULe(){return te.ready()}function WLe(){return te.backendName}function VLe(e){te.removeBackend(e)}function qLe(e){return te.findBackend(e)}function HLe(e){return te.findBackendFactory(e)}function GLe(e,t,n){return n===void 0&&(n=1),te.registerBackend(e,t,n)}function XZ(){return te.backend}function KLe(e,t){we().setPlatform(e,t)}function FC(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];we().getBool("IS_TEST")||console.warn.apply(console,e)}function oc(e,t){var n=e;if(ma(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||ma(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&we().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(a,o,s){if(s=s||[],!Array.isArray(a)&&!ma(a))return void H(o.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});H(o.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),H(a.length===o[0],function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+a.length+" elements"});for(var u=o.slice(1),l=0;l<a.length;++l)i(a[l],u,s.concat(l))}(e,r,[]),r}function YZ(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function U(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof fn)return YZ(r,e.dtype,t,n),e;var i=u0(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),YZ(r,i,t,n),e==null||!ma(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=oc(e,i);ma(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?IM(e,i,we().getBool("DEBUG")):kf(e,[],!0);return te.makeTensor(s,o,i)}function sx(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,a){return U(i,t+"["+a+"]",n)},r)}function XM(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function ZZ(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function va(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(a){return e[a]})]}function oo(e,t){return ZZ(e,t.map(function(n){return 1}),t)}function Vo(e,t,n){H(XM(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Ju(e,t){if(XM(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function MC(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Qu(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function JZ(e,t){var n=e[0].length;e.forEach(function(i,a){H(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),H(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)H(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function dg(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function ne(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];te.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),te.endScope(s),s}catch(u){throw te.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}zt.registerFlag("HAS_WEBGL",function(){return zt.getNumber("WEBGL_VERSION")>0}),zt.registerFlag("WEBGL_VERSION",function(){return GM(2)?2:GM(1)?1:0}),zt.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return zt.get("WEBGL_VERSION")===2}),zt.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),zt.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),zt.registerFlag("WEBGL_PACK",function(){return zt.getBool("HAS_WEBGL")}),zt.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_CLIP",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),zt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_PACK_REDUCE",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_LAZILY_UNPACK",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_CONV_IM2COL",function(){return zt.getBool("WEBGL_PACK")}),zt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return WZ(zt.getNumber("WEBGL_VERSION"))}),zt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return VZ(zt.getNumber("WEBGL_VERSION"))}),zt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=zt.getNumber("WEBGL_VERSION");return e===0?0:qZ(e)}),zt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return zt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),zt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return HZ(zt.getNumber("WEBGL_VERSION"))}),zt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!zt.getBool("WEBGL_FORCE_F16_TEXTURES")&&zt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),zt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return GZ(zt.getNumber("WEBGL_VERSION"))}),zt.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return KZ(zt.getNumber("WEBGL_VERSION"))}),zt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return zt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),xZ=DC;var $i=ne({complex_:function(e,t){var n=U(e,"real","complex"),r=U(t,"imag","complex");return On(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),te.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),qo=ne({real_:function(e){var t=U(e,"input","real");return te.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),uu=ne({imag_:function(e){var t=U(e,"input","imag");return te.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function fi(e,t,n){return th(e,t,oc(e,n),n)}function th(e,t,n,r){if(r==null&&(r=u0(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ma(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){RM(t);var i=ft(t),a=ft(n);H(i===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a});for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==ft(t.slice(o));H(n[o]===t[o]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return ma(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?IM(e,r,we().getBool("DEBUG")):kf(e,[],!0),te.makeTensor(e,t,r)}function rt(e,t){if((ma(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&ma(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return th(e,[],[],t)}function so(e,t){ug(e);var n=oc(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return th(e,null,n,t)}function sc(e,t,n){if(ug(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=oc(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return th(e,t,r,n)}function PC(e,t,n){if(ug(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=oc(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return th(e,t,r,n)}function nh(e,t,n){if(ug(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=oc(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return th(e,t,r,n)}function QZ(e,t,n){if(ug(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=oc(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return th(e,t,r,n)}function eJ(e,t,n){if(ug(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=oc(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return th(e,t=t||r,r,n)}function YM(e,t,n,r){return t===void 0&&(t=!0),te.makeVariable(e,t,n,r)}function uc(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=uc(e,"float32"),r=Kn(e,"float32");return $i(n,r)}var i=DM(ft(e),t);return te.makeTensor(i,e,t)}function Kn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Kn(e,"float32"),r=Kn(e,"float32");return $i(n,r)}var i=l0(ft(e),t);return te.makeTensor(i,e,t)}function f0(e,t,n){return te.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function ZM(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return te.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function d0(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Kn([0],r);var i=l0(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return so(i,r)}var Ts=ne({onesLike_:function(e){var t=U(e,"x","onesLike");if(t.dtype==="complex64"){var n=Ts(qo(t)),r=wn(uu(t));return $i(n,r)}return te.runKernelFunc(function(i){return i.onesLike(t)},{x:t},function(i,a){return{x:function(){return wn(i)}}},"OnesLike")}}),wn=ne({zerosLike_:function(e){var t=U(e,"x","zerosLike");return te.runKernelFunc(function(n){return n.zerosLike(t)},{x:t},function(n,r){return{x:function(){return wn(n)}}},"ZerosLike")}}),Ra=ne({concat_:function(e,t){t===void 0&&(t=0),H(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=sx(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=_i(t,n[0].shape)[0];var r=dg(n.map(function(s){return s.shape}),t);if(ft(r)===0)return fi([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});JZ(i,t);var a=n,o={axis:t};return te.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=i.map(function(l){return l[t]});return If(s,u,t).map(function(l){return function(){return l}})},"Concat",o)}}),JM=ne({concat1d_:function(e){return Ra(e,0)}}),QM=ne({concat2d_:function(e,t){return Ra(e,t)}}),eP=ne({concat3d_:function(e,t){return Ra(e,t)}}),tP=ne({concat4d_:function(e,t){return Ra(e,t)}}),If=ne({split_:function(e,t,n){n===void 0&&(n=0);var r,i=U(e,"x","split");return n=_i(n,i.shape)[0],typeof t=="number"?(H(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(H(i.shape[n]===t.reduce(function(a,o){return a+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),te.runKernelFunc(function(a){return a.split(i,r,n)},{$x:i},function(a){return{$x:function(){return Ra(a,n)}}})}});function Ht(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",RM(e),new c0(e,t,n)}function tJ(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var $C=ne({batchToSpaceND_:function(e,t,n){var r=U(e,"x","batchToSpaceND"),i=t.reduce(function(a,o){return a*o});return H(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),H(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),H(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),te.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),LC=ne({cast_:function(e,t){var n=U(e,"x","cast");if(!dZ(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return te.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),nJ=ne({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=U(e,"x","cumsum"),a=Ju([t|=0],i.rank),o=i;a!=null&&(o=i.transpose(a));var s=Qu(1,i.rank)[0],u=te.runKernelFunc(function(l){return l.cumsum(o,s,n,r)},{permutedX:o},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),nP=ne({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=U(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return H(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),H(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),H(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),te.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Os=ne({expandDims_:function(e,t){t===void 0&&(t=0);var n=U(e,"x","expandDims",null);H(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(H(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),el(n,r)}}),el=ne({reshape_:function(e,t){var n=U(e,"x","reshape",null);t=cZ(t,n.size),H(n.size===ft(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return te.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),BC=ne({spaceToBatchND_:function(e,t,n){var r=U(e,"x","spaceToBatchND");return H(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),H(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),H(r.shape.reduce(function(i,a,o){return o>0&&o<=t.length?i&&(a+n[o-1][0]+n[o-1][1])%t[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),te.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),ux=ne({squeeze_:function(e,t){var n=U(e,"x","squeeze");return el(n,Jd(n.shape,t).newShape)}}),lu=ne({stack_:function(e,t){t===void 0&&(t=0);var n=sx(e,"tensors","stack");if(H(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;H(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){On(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){H(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(s){return s.expandDims(t)});return Ra(o,t)}}),rh=ne({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=U(e,"x","unstack");H(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return te.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return lu(i,t)}}},"Unpack",r)}}),rP=function(e,t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f;return ht(this,function(d){switch(d.label){case 0:return n=U(e,"x","setdiff1d"),r=U(t,"y","setdiff1d"),H(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),H(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),H(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(a=d.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(u=new c0([s],n.dtype),l=new c0([s],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function zC(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function jC(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function UC(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function rJ(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function iJ(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var iP="Add",XLe="AddN",lx="Div",YLe="FusedBatchNorm",cx="SquaredDifference",ZLe="Square",JLe="Transpose",QLe="NonMaxSuppressionV5",aP="BroadcastTo",oP="OneHot",sP="Identity",uP="Tile",lP="PadV2",e4e="FromPixels",t4e="MaxPoolWithArgmax",un=ne({add_:function(e,t){var n,r=U(e,"a","add"),i=U(t,"b","add");n=Mr(r,i),r=n[0],i=n[1];var a={a:r,b:i};return te.runKernelFunc(function(o,s){var u=o.add(r,i);return s([r,i]),u},a,null,iP)}});function Nf(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function Si(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function vn(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}var ih=ne({abs_:function(e){var t=U(e,"x","abs");return t.dtype==="complex64"?te.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):te.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),cP=ne({acos_:function(e){var t=U(e,"x","acos");return te.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(rt(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),fP=ne({acosh_:function(e){var t=U(e,"x","acosh");return te.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),dP=ne({asin_:function(e){var t=U(e,"x","asin");return te.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(rt(1).sub(i.toFloat().square()).sqrt())}}})}}),hP=ne({asinh_:function(e){var t=U(e,"x","asinh");return te.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(rt(1).add(i.toFloat().square()).sqrt())}}})}}),pP=ne({atan_:function(e){var t=U(e,"x","atan");return te.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),gP=ne({atanh_:function(e){var t=U(e,"x","atanh");return te.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(rt(1).sub(i.toFloat().square()))}}})}}),mP=ne({ceil_:function(e){var t=U(e,"x","ceil");return te.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),uo=ne({clipByValue_:function(e,t,n){var r=U(e,"x","clipByValue");H(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],a={min:t,max:n};return te.runKernelFunc(function(o,s){var u=o.clip(r,t,n);return s([r]),u},{x:r},function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),wn(o))}}},"ClipByValue",a,i)}}),vP=ne({cos_:function(e){var t=U(e,"x","cos"),n=[t];return te.runKernelFunc(function(r,i){var a=r.cos(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),yP=ne({cosh_:function(e){var t=U(e,"x","cosh");return te.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),bP=ne({erf_:function(e){var t=U(e,"x","erf");return H(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),te.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),xP=ne({exp_:function(e){var t=U(e,"x","exp");return te.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),wP=ne({expm1_:function(e){var t=U(e,"x","expm1");return te.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),WC=ne({floor_:function(e){var t=U(e,"x","floor");return te.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),Df=ne({log_:function(e){var t=U(e,"x","log"),n=[t];return te.runKernelFunc(function(r,i){var a=r.log(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),_P=ne({log1p_:function(e){var t=U(e,"x","log1p");return te.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),aJ=ne({logSigmoid_:function(e){var t=U(e,"x","logSigmoid");return te.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),ah=ne({neg_:function(e){var t=U(e,"x","neg"),n=[t];return te.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),SP=ne({reciprocal_:function(e){var t=U(e,"x","reciprocal");return te.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),EP=ne({round_:function(e){var t=U(e,"x","round");return te.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),VC=ne({rsqrt_:function(e){var t=U(e,"x","rsqrt"),n=[t];return te.runKernelFunc(function(r,i){var a=r.rsqrt(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),qC=ne({sigmoid_:function(e){var t=U(e,"x","sigmoid");return te.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(rt(1).sub(i)))}}},"Sigmoid")}}),CP=ne({sign_:function(e){var t=U(e,"x","sign");return te.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),oJ=ne({isNaN_:function(e){var t=U(e,"x","isNaN");return te.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),sJ=ne({isInf_:function(e){var t=U(e,"x","isInf");return te.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),uJ=ne({isFinite_:function(e){var t=U(e,"x","isFinite");return te.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return wn(n)}}})}}),AP=ne({sin_:function(e){var t=U(e,"x","sin"),n=[t];return te.runKernelFunc(function(r,i){var a=r.sin(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),kP=ne({sinh_:function(e){var t=U(e,"x","sinh");return te.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),fx=ne({softplus_:function(e){var t=U(e,"x","softplus");return te.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),dx=ne({sqrt_:function(e){var t=U(e,"x","sqrt");return te.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),lJ=ne({step_:function(e,t){t===void 0&&(t=0);var n=U(e,"x","step");return te.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return wn(r)}}})}}),TP=ne({tan_:function(e){var t=U(e,"x","tan");return te.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),HC=ne({tanh_:function(e){var t=U(e,"x","tanh");return te.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return rt(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}}),cJ=ne({addStrict_:function(e,t){var n=U(e,"a","addStrict"),r=U(t,"b","addStrict");return On(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),OP=ne({atan2_:function(e,t){var n,r=U(e,"a","atan2"),i=U(t,"b","atan2");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape);return te.runKernelFunc(function(o,s){var u=o.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=un(u.square(),l.square()),f=o.mul(l.div(c)),d=Si(u.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=un(u.square(),l.square()),f=ah(o.mul(u.div(c))),d=Si(l.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),fJ=ne({divStrict_:function(e,t){var n=U(e,"a","div"),r=U(t,"b","div");return On(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),GC=ne({floorDiv_:function(e,t){var n,r=U(e,"a","floorDiv"),i=U(t,"b","floorDiv");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape);return te.runKernelFunc(function(o,s){var u=o.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.div(l.toFloat()),f=Si(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Si(l.shape,a);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),lc=ne({maximum_:function(e,t){var n,r=U(e,"a","maximum"),i=U(t,"b","maximum");return n=Mr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),vn(r.shape,i.shape),te.runKernelFunc(function(a,o){var s=a.maximum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),dJ=ne({maximumStrict_:function(e,t){var n=U(e,"a","maximumStrict"),r=U(t,"b","maximumStrict");return On(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),h0=ne({minimum_:function(e,t){var n,r=U(e,"a","minimum"),i=U(t,"b","minimum");return n=Mr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),vn(r.shape,i.shape),te.runKernelFunc(function(a,o){var s=a.minimum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),hJ=ne({minimumStrict_:function(e,t){var n=U(e,"a","minimumStrict"),r=U(t,"b","minimumStrict");return On(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),IP=ne({mod_:function(e,t){var n,r=U(e,"a","mod"),i=U(t,"b","mod");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape);return te.runKernelFunc(function(o,s){var u=o.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Si(u.shape,a);return c.length>0?o.sum(c).reshape(u.shape):o},$b:function(){var c=o.mul(u.div(l).floor().neg()),f=Si(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),pJ=ne({modStrict_:function(e,t){var n=U(e,"a","modStrict"),r=U(t,"b","modStrict");return On(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),pt=ne({mul_:function(e,t){var n,r=U(e,"a","mul"),i=U(t,"b","mul");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape);return te.runKernelFunc(function(o,s){var u=o.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.mul(l.toFloat()),f=Si(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Si(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),KC=ne({mulStrict_:function(e,t){var n=U(e,"a","mul"),r=U(t,"b","mul");return On(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),p0=ne({pow_:function(e,t){var n,r=U(e,"base","pow"),i=U(t,"exp","pow");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape),o=[r,i];return te.runKernelFunc(function(s,u){var l=s.pow(r,i);return u([r,i,l]),l},{a:r,b:i},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(rt(1))))),p=Si(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,wn(l)),p=s.mul(f.mul(h)),g=Si(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),gJ=ne({powStrict_:function(e,t){return On(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),mJ=ne({squaredDifferenceStrict_:function(e,t){var n=U(e,"a","squaredDifferenceStrict"),r=U(t,"b","squaredDifferenceStrict");return On(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Qr=ne({sub_:function(e,t){var n,r=U(e,"a","sub"),i=U(t,"b","sub");n=Mr(r,i),r=n[0],i=n[1];var a=vn(r.shape,i.shape);return te.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var s=o,u=Si(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=o,u=Si(i.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),vJ=ne({subStrict_:function(e,t){var n=U(e,"a","subStrict"),r=U(t,"b","subStrict");return On(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),ei=ne({div_:function(e,t){var n,r=U(e,"a","div"),i=U(t,"b","div");if(n=Mr(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return GC(r,i);var a={a:r,b:i};return te.runKernelFunc(function(o,s){var u=o.realDivide(r,i);return s([r,i]),u},a,null,lx,{})}});function NP(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var l=Wo(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var n4e=Object.freeze({prepareAndValidate:NP}),DP=30;function XC(e){return e<=DP?e:_C(e,Math.floor(Math.sqrt(e)))}function yJ(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}function bJ(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}yJ(n,t,e)}function hx(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:ft(t.shape)/u,sliceSize:o,strides:Wo(n.slice(0,i)).concat([1]),outputSize:ft(n)}}var r4e=Object.freeze({validateUpdateShape:yJ,validateInput:bJ,calculateShapes:hx});function xJ(e,t,n){H(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),H(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){H(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},i=0;i<e.rank;++i)r(i)}function RP(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function YC(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function wJ(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=xC(0,a,s-1)}function _J(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?xC(0,a,s):xC(-1,a,s-1)}function FP(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function MP(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}var i4e=Object.freeze({assertParamsValid:xJ,maskToAxes:RP,computeOutShape:YC,startForAxis:wJ,stopForAxis:_J,isSliceContinous:FP,computeFlatOffset:MP});function a4e(e){return H(eh(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var r=U(t,"x","tf.grad",null),i=n!=null?U(n,"dy","tf.grad"):null;return te.tidy(function(){var a=te.gradients(function(){return e(r)},[r],i),o=a.value,s=a.grads;return i!=null&&On(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ZC(s),s[0]})}}function o4e(e){return H(eh(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){H(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=sx(t,"args","tf.grads",null),i=n!=null?U(n,"dy","tf.grads"):null;return te.tidy(function(){var a=te.gradients(function(){return e.apply(void 0,r)},r,i),o=a.value,s=a.grads;return i!=null&&On(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ZC(s),s})}}function s4e(e){return H(eh(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){H(t instanceof fn,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),H(n==null||n instanceof fn,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=te.gradients(function(){return e(t)},[t],n),i=r.grads,a=r.value;return ZC(i),{grad:i[0],value:a}}}function u4e(e){return H(eh(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){H(Array.isArray(t)&&t.every(function(i){return i instanceof fn}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),H(n==null||n instanceof fn,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=te.gradients(function(){return e.apply(void 0,t)},t,n);return n!=null&&On(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ZC(r.grads),r}}function SJ(e,t){H(eh(e),function(){return"The f passed in variableGrads(f) must be a function"}),H(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof J1}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],te.registeredVariables)t.push(te.registeredVariables[r]);var i=n?t.filter(function(c){return!c.trainable}):null,a=t.length;H((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var o=te.gradients(e,t,null,!0),s=o.value,u=o.grads;H(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),H(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function px(e){return te.customGrad(e)}function ZC(e){if(e.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var hg=ne({softmax_:function(e,t){t===void 0&&(t=-1);var n=U(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return te.runKernelFunc(function(r,i){var a=r.softmax(n,t);return i([a]),a},{logits:n},function(r,i){var a=i[0],o=r.mul(a);return{logits:function(){return o.sub(o.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),JC=ne({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=U(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return px(function(r,i){var a=r.max(t,!0),o=r.sub(a),s=o.toFloat().sub(o.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),In=ne({transpose_:function(e,t){var n=U(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),H(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){H(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return te.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}}),PP=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),$P=function(){function e(){}return e.prototype.time=function(t){return ye("time")},e.prototype.read=function(t){return ye("read")},e.prototype.readSync=function(t){return ye("readSync")},e.prototype.numDataIds=function(){return ye("numDataIds")},e.prototype.disposeData=function(t){return ye("disposeData")},e.prototype.write=function(t,n,r){return ye("write")},e.prototype.move=function(t,n,r,i){return ye("move")},e.prototype.memory=function(){return ye("memory")},e.prototype.floatPrecision=function(){return ye("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return ye("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ye("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return ye("slice")},e.prototype.stridedSlice=function(t,n,r,i){return ye("stridedSlice")},e.prototype.unstack=function(t,n){return ye("unstack")},e.prototype.reverse=function(t,n){return ye("reverse")},e.prototype.concat=function(t,n){return ye("concat")},e.prototype.neg=function(t){return ye("neg")},e.prototype.add=function(t,n){return ye("add")},e.prototype.addN=function(t){return ye("addN")},e.prototype.subtract=function(t,n){return ye("subtract")},e.prototype.multiply=function(t,n){return ye("multiply")},e.prototype.realDivide=function(t,n){return ye("realDivide")},e.prototype.floorDiv=function(t,n){return ye("floorDiv")},e.prototype.sum=function(t,n){return ye("sum")},e.prototype.prod=function(t,n){return ye("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return ye("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return ye("argMin")},e.prototype.argMax=function(t,n){return ye("argMax")},e.prototype.equal=function(t,n){return ye("equal")},e.prototype.notEqual=function(t,n){return ye("notEqual")},e.prototype.less=function(t,n){return ye("less")},e.prototype.lessEqual=function(t,n){return ye("lessEqual")},e.prototype.greater=function(t,n){return ye("greater")},e.prototype.greaterEqual=function(t,n){return ye("greaterEqual")},e.prototype.logicalNot=function(t){return ye("logicalNot")},e.prototype.logicalAnd=function(t,n){return ye("logicalAnd")},e.prototype.logicalOr=function(t,n){return ye("logicalOr")},e.prototype.where=function(t){return ye("where")},e.prototype.select=function(t,n,r){return ye("select")},e.prototype.topk=function(t,n,r){return ye("topk")},e.prototype.min=function(t,n){return ye("min")},e.prototype.minimum=function(t,n){return ye("minimum")},e.prototype.mod=function(t,n){return ye("mod")},e.prototype.max=function(t,n){return ye("max")},e.prototype.maximum=function(t,n){return ye("maximum")},e.prototype.all=function(t,n){return ye("all")},e.prototype.any=function(t,n){return ye("any")},e.prototype.squaredDifference=function(t,n){return ye("squaredDifference")},e.prototype.ceil=function(t){return ye("ceil")},e.prototype.floor=function(t){return ye("floor")},e.prototype.round=function(t){return ye("round")},e.prototype.sign=function(t){return ye("sign")},e.prototype.isNaN=function(t){return ye("isNaN")},e.prototype.isInf=function(t){return ye("isInf")},e.prototype.isFinite=function(t){return ye("isFinite")},e.prototype.pow=function(t,n){return ye("pow")},e.prototype.exp=function(t){return ye("exp")},e.prototype.expm1=function(t){return ye("expm1")},e.prototype.softmax=function(t,n){return ye("softmax")},e.prototype.log=function(t){return ye("log")},e.prototype.log1p=function(t){return ye("log1p")},e.prototype.sqrt=function(t){return ye("sqrt")},e.prototype.rsqrt=function(t){return ye("rsqrt")},e.prototype.square=function(t){return ye("square")},e.prototype.reciprocal=function(t){return ye("reciprocal")},e.prototype.relu=function(t){return ye("relu")},e.prototype.relu6=function(t){return ye("relu6")},e.prototype.prelu=function(t,n){return ye("prelu")},e.prototype.elu=function(t){return ye("elu")},e.prototype.eluDer=function(t,n){return ye("eluDer")},e.prototype.selu=function(t){return ye("selu")},e.prototype.int=function(t){return ye("int")},e.prototype.clip=function(t,n,r){return ye("clip")},e.prototype.abs=function(t){return ye("abs")},e.prototype.complexAbs=function(t){return ye("complexAbs")},e.prototype.sigmoid=function(t){return ye("sigmoid")},e.prototype.softplus=function(t){return ye("softplus")},e.prototype.sin=function(t){return ye("sin")},e.prototype.cos=function(t){return ye("cos")},e.prototype.tan=function(t){return ye("tan")},e.prototype.asin=function(t){return ye("asin")},e.prototype.acos=function(t){return ye("acos")},e.prototype.atan=function(t){return ye("atan")},e.prototype.atan2=function(t,n){return ye("atan2")},e.prototype.sinh=function(t){return ye("sinh")},e.prototype.cosh=function(t){return ye("cosh")},e.prototype.tanh=function(t){return ye("tanh")},e.prototype.asinh=function(t){return ye("asinh")},e.prototype.acosh=function(t){return ye("acosh")},e.prototype.atanh=function(t){return ye("atanh")},e.prototype.erf=function(t){return ye("erf")},e.prototype.step=function(t,n){return ye("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ye("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return ye("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return ye("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return ye("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ye("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return ye("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return ye("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return ye("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return ye("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return ye("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return ye("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return ye("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return ye("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return ye("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return ye("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return ye("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return ye("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return ye("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return ye("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return ye("reshape")},e.prototype.cast=function(t,n){return ye("cast")},e.prototype.tile=function(t,n){return ye("tile")},e.prototype.pad=function(t,n,r){return ye("pad")},e.prototype.transpose=function(t,n){return ye("transpose")},e.prototype.gather=function(t,n,r){return ye("gather")},e.prototype.gatherND=function(t,n){return ye("gatherND")},e.prototype.scatterND=function(t,n,r){return ye("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return ye("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return ye("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return ye("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return ye("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return ye("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return ye("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,a,o){return ye("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,a){return ye("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,a,o,s){return ye("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return ye("multinomial")},e.prototype.oneHot=function(t,n,r,i){return ye("oneHot")},e.prototype.cumsum=function(t,n,r,i){return ye("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,a){return ye("nonMaxSuppression")},e.prototype.fft=function(t){return ye("fft")},e.prototype.ifft=function(t){return ye("ifft")},e.prototype.complex=function(t,n){return ye("complex")},e.prototype.real=function(t){return ye("real")},e.prototype.imag=function(t){return ye("imag")},e.prototype.cropAndResize=function(t,n,r,i,a,o){return ye("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return ye("depthToSpace")},e.prototype.split=function(t,n,r){return ye("split")},e.prototype.sparseToDense=function(t,n,r,i){return ye("sparseToDense")},e.prototype.diag=function(t){return ye("diag")},e.prototype.fill=function(t,n,r){return ye("fill")},e.prototype.onesLike=function(t){return ye("onesLike")},e.prototype.zerosLike=function(t){return ye("zerosLike")},e.prototype.linspace=function(t,n,r){return ye("linspace")},e.prototype.dispose=function(){return ye("dispose")},e}();function ye(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function oh(e,t,n,r,i,a,o){o===void 0&&(o="channelsLast");var s,u=QC(t),l=u[0],c=u[1];if(o==="channelsLast")s=[l,c,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,c,e[1],e[1]]}return sh(e,s,n,r,i,a,!1,o)}function gx(e,t,n,r,i,a,o){o===void 0&&(o="NDHWC");var s,u,l=BP(t),c=l[0],f=l[1],d=l[2];if(o==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return mx(e,s,n,r,i,!1,u,a)}function sh(e,t,n,r,i,a,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],g=t[1],m=t[3],v=QC(n),y=v[0],b=v[1],x=QC(r),w=x[0],S=x[1],C=g0(p,w),_=g0(g,S),E=function(N,O,D,P,V,Y,X,Q){var me,ce,Ne;if(typeof N=="number"){me={top:N,bottom:N,left:N,right:N,type:N===0?"VALID":"NUMBER"};var Oe=function(ue,J,L,z,R){z==null&&(z=LP(ue,J,L));var Z=ue[0],xe=ue[1],Ee=vx((Z-J+2*z)/L+1,R);H(Wr(Ee),function(){return"The output # of rows ("+Ee+") must be an integer. Change the stride and/or zero pad parameters"});var Me=vx((xe-J+2*z)/L+1,R);return H(Wr(Me),function(){return"The output # of columns ("+Me+") must be an integer. Change the stride and/or zero pad parameters"}),[Ee,Me]}([O,D],Y,P,N,Q);ce=Oe[0],Ne=Oe[1]}else if(N==="same"){ce=Math.ceil(O/P),Ne=Math.ceil(D/V);var $e=Math.max(0,(ce-1)*P+Y-O),ve=Math.max(0,(Ne-1)*V+X-D),$=Math.floor($e/2),F=$e-$,q=Math.floor(ve/2);me={top:$,bottom:F,left:q,right:ve-q,type:"SAME"}}else{if(N!=="valid")throw Error("Unknown padding parameter: "+N);me={top:0,bottom:0,left:0,right:0,type:"VALID"},ce=Math.ceil((O-Y+1)/P),Ne=Math.ceil((D-X+1)/V)}return{padInfo:me,outHeight:ce,outWidth:Ne}}(i,c,f,y,b,C,_,a),A=E.padInfo,k=E.outHeight,T=E.outWidth,I=o?m*d:m;return s==="channelsFirst"?h=[l,I,k,T]:s==="channelsLast"&&(h=[l,k,T,I]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:k,outWidth:T,outChannels:I,padInfo:A,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function mx(e,t,n,r,i,a,o,s){a===void 0&&(a=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(o==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],y=t[4],b=BP(n),x=b[0],w=b[1],S=b[2],C=BP(r),_=C[0],E=C[1],A=C[2],k=g0(g,_),T=g0(m,E),I=g0(v,A),N=function(X,Q,me,ce,Ne,Oe,$e,ve,$,F,q){var ue,J,L,z;if(typeof X=="number"){ue={top:X,bottom:X,left:X,right:X,front:X,back:X,type:X===0?"VALID":"NUMBER"};var R=function(Gt,rn,kn,Br,Jn,_n){Jn==null&&(Jn=LP(Gt,rn,Br));var Xi=Gt[0],kr=Gt[1],ms=Gt[2],$o=vx((Xi-rn+2*Jn)/Br+1,_n);H(Wr($o),function(){return"The output # of depths ("+$o+") must be an integer. Change the stride and/or zero pad parameters"});var vs=vx((kr-rn+2*Jn)/Br+1,_n);H(Wr(vs),function(){return"The output # of rows ("+vs+") must be an integer. Change the stride and/or zero pad parameters"});var Ru=vx((ms-rn+2*Jn)/Br+1,_n);return H(Wr(Ru),function(){return"The output # of columns ("+Ru+") must be an integer. Change the stride and/or zero pad parameters"}),[$o,vs,Ru,kn]}([Q,me,ce,1],ve,1,Ne,X,q);J=R[0],L=R[1],z=R[2]}else if(X==="same"){J=Math.ceil(Q/Ne),L=Math.ceil(me/Oe),z=Math.ceil(ce/$e);var Z=(J-1)*Ne+ve-Q,xe=(L-1)*Oe+$-me,Ee=(z-1)*$e+F-ce,Me=Math.floor(Z/2),Ve=Z-Me,Je=Math.floor(xe/2),Ft=xe-Je,et=Math.floor(Ee/2);ue={top:Je,bottom:Ft,left:et,right:Ee-et,front:Me,back:Ve,type:"SAME"}}else{if(X!=="valid")throw Error("Unknown padding parameter: "+X);ue={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},J=Math.ceil((Q-ve+1)/Ne),L=Math.ceil((me-$+1)/Oe),z=Math.ceil((ce-F+1)/$e)}return{padInfo:ue,outDepth:J,outHeight:L,outWidth:z}}(i,c,f,d,x,w,S,k,T,I,s),O=N.padInfo,D=N.outDepth,P=N.outHeight,V=N.outWidth,Y=a?y*h:y;return o==="channelsFirst"?p=[l,Y,D,P,V]:o==="channelsLast"&&(p=[l,D,P,V,Y]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:D,outHeight:P,outWidth:V,outChannels:Y,padInfo:O,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:_,dilationHeight:E,dilationWidth:A,inShape:e,outShape:p,filterShape:t}}function LP(e,t,n,r){r===void 0&&(r=1);var i=g0(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function QC(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function BP(e){return typeof e=="number"?[e,e,e]:e}function g0(e,t){return t<=1?e:e+(e-1)*(t-1)}function vx(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function pg(e){var t=QC(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Fa(e,t){return pg(e)||pg(t)}function eA(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function zP(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Kn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!hZ(e.dtype,t))return te.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=rt(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function tA(e,t){return te.makeTensorFromDataId(e.dataId,t,e.dtype)}function jP(e,t,n){var r=(t-e)/(n-1),i=l0(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return so(i,"float32")}var l4e=Object.freeze({castTensor:zP,reshapeTensor:tA,linspaceImpl:jP,upcastType:na,axesAreInnerMostDims:XM,combineLocations:ZZ,computeOutAndReduceShapes:va,expandShapeToKeepDim:oo,assertAxesAreInnerMostDims:Vo,getAxesPermutation:Ju,getUndoAxesPermutation:MC,getInnerMostAxes:Qu,getBroadcastDims:Nf,getReductionAxes:Si,assertAndGetBroadcastShape:vn,assertParamsConsistent:JZ,computeOutShape:dg,computePool2DInfo:oh,computePool3DInfo:gx,computeConv2DInfo:sh,computeConv3DInfo:mx,computeDefaultPad:LP,tupleValuesAreOne:pg,eitherStridesOrDilationsAreOne:Fa,convertConv2DDataFormat:eA,PARALLELIZE_THRESHOLD:DP,computeOptimalWindowSize:XC});function UP(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function EJ(e,t){return{real:e[2*t],imag:e[2*t+1]}}function c4e(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function f4e(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function d4e(e,t,n){var r=function(a,o,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var g=c(l,u[h=f+(d-f>>>1)]);g>0?f=h+1:(d=h,p=!g)}return p?f:-f-1}(a,o,s||h4e)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function h4e(e,t){return e>t?1:e<t?-1:0}function WP(e,t,n,r,i){return CJ(e,t,n,r,i,0).selectedIndices}function VP(e,t,n,r,i,a){var o=CJ(e,t,n,r,i,a);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function CJ(e,t,n,r,i,a,o,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>i}).sort(AJ),l=a>0?-.5/a:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(h<i)break;for(var m=!1,v=c.length-1;v>=g;--v){var y=p4e(e,p,c[v]);if(y>=r){m=!0;break}if(d.score=d.score*g4e(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,m||(d.score===h?(c.push(p),f.push(d.score)):d.score>i&&d4e(u,d,AJ))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:so(c,"int32"),selectedScores:so(f,"float32"),numValidOutputs:rt(b,"int32")}}function p4e(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var g=Math.max(a,l),m=Math.max(o,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(h+p-b)}function g4e(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function AJ(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function kJ(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(a){i[n]=a;var o=e.slice(r,i);return r[n]+=a,o})}function TJ(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=Ht(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function OJ(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],l=cg(n,s*r),c=cg("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort(function(x,w){return w.value-x.value});var m=f*r,v=l.subarray(m,m+r),y=c.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,y[g]=p[g].index}var b=t.slice();return b[b.length-1]=r,[fi(l,b,n),fi(c,b,"int32")]}function qP(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=Ht(e,"int32"),a=Ht([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var m4e=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},v4e=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},y4e=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function IJ(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function Ho(e,t){return t===1?[e]:IJ(e,t)}function Ma(){var e,t,n,r,i,a,o,s,u,l;return we().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function gg(e,t,n){n===void 0&&(n="index");var r=Wo(t);return r.map(function(i,a){return"int "+e[a]+" = "+n+" / "+i+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+i:"index -= "+e[a]+" * "+i)+";"}).join("")}function HP(e){var t=Wo(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var NJ=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function b4e(e,t,n,r){var i=[];e.forEach(function(h){var p=ft(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var a,o,s=i.join(`
`),u=e.map(function(h){return function(p,g,m){m===void 0&&(m=!1);var v="";v+=m?DJ(p):m0(p);var y=p.shapeInfo.logicalShape,b=g.logicalShape;return y.length<=b.length&&(v+=m?function(x,w){var S,C=x.name,_=C.charAt(0).toUpperCase()+C.slice(1),E="get"+_+"AtOutCoords",A=x.shapeInfo.logicalShape.length,k=w.logicalShape.length,T=Nf(x.shapeInfo.logicalShape,w.logicalShape),I=Er(k),N=k-A,O=["x","y","z","w","u","v"];S=A===0?"":k<2&&T.length>=1?"coords = 0;":T.map(function(me){return"coords."+O[me+N]+" = 0;"}).join(`
`);var D="";D=k<2&&A>0?"coords":x.shapeInfo.logicalShape.map(function(me,ce){return"coords."+O[ce+N]}).join(", ");var P="return outputValue;",V=ft(x.shapeInfo.logicalShape)===1,Y=ft(w.logicalShape)===1;if(A!==1||V||Y){if(V&&!Y)P=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var X=A-2,Q=A-1;T.indexOf(X)>-1&&T.indexOf(Q)>-1?P="return vec4(outputValue.x);":T.indexOf(X)>-1?P="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(Q)>-1&&(P="return vec4(outputValue.xx, outputValue.zz);")}}else P=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+I+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+_+"("+D+`);
      `+P+`
    }
  `}(p,g):function(x,w){var S=x.name,C=S.charAt(0).toUpperCase()+S.slice(1),_="get"+C+"AtOutCoords",E=w.texShape,A=x.shapeInfo.texShape,k=x.shapeInfo.logicalShape.length,T=w.logicalShape.length;if(!x.shapeInfo.isUniform&&k===T&&x.shapeInfo.flatOffset==null&&wi(A,E))return`
      float `+_+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var I,N=Er(T),O=Nf(x.shapeInfo.logicalShape,w.logicalShape),D=T-k,P=["x","y","z","w","u","v"];I=k===0?"":T<2&&O.length>=1?"coords = 0;":O.map(function(Y){return"coords."+P[Y+D]+" = 0;"}).join(`
`);var V="";return V=T<2&&k>0?"coords":x.shapeInfo.logicalShape.map(function(Y,X){return"coords."+P[X+D]}).join(", "),`
    float `+_+`() {
      `+N+` coords = getOutputCoords();
      `+I+`
      return get`+C+"("+V+`);
    }
  `}(p,g)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Ma(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+x4e+`
    `+w4e+`
    `+_4e+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(wi(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var C=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=h,m=p,v=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(g[2]/2),b=y*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],C=Math.ceil(x[x.length-1]/2),_=C*Math.ceil(x[x.length-2]/2),E=_,A="",k="b, r, c",T=2;T<x.length-1;T++)E*=x[x.length-T-1],A=`
      int b`+T+" = index / "+E+`;
      index -= b`+T+" * "+E+`;
    `+A,k="b"+T+", "+k;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+A+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+x.length+"("+k+`);
    }
  `}(h,p)}var g,m,v,y,b}(t.logicalShape,l),o=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return wi(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=p,m=gg(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=gg(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=gg(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=gg(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,m}(t.logicalShape,l),o=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=S4e),[d,f,o,s,a,u,n].join(`
`)}function m0(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(o===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=mg(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+v0(n)+`
      }
    `;var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(s===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=mg(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n.shapeInfo.texShape;if(o!=null&&wi(r,o)){var s=o[0],u=o[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Jd(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=y0(n,d);return`
      `+m0(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+b0(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+v0(n)+`
      }
    `;var p=o[0],g=o[1],m=mg(i);return g===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+p+", "+g+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],s=r[2],u=Jd(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=y0(n,f);return`
        `+m0(d)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+b0(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+v0(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],g=h[1],m=n.shapeInfo.flatOffset;if(g===o&&m==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(g===s&&m==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=mg(i);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+g+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],s=r[2]*o,u=r[1]*s,l=Jd(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=y0(n,c);return`
      `+m0(d)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+b0(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+v0(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=mg(i);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+m+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],s=r[3]*o,u=r[2]*s,l=r[1]*u,c=Jd(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=y0(n,f);return`
      `+m0(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+b0(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+v0(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],v=g[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===o&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=mg(i);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Jd(r),s=o.newShape,u=o.keptDims;if(s.length<r.length){var l=y0(n,s);return`
      `+m0(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+b0(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+v0(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],y=m[1];if(y===p&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=mg(i);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function DJ(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ma(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var a=i.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Ma();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],f=Ma();if(u!=null&&wi(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),f=y0(i,c);return`
        `+DJ(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+b0(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(a[2]/2),g=p*Math.ceil(a[1]/2),m=Ma();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+g+", "+p+`, b, row, col);
      return `+m.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(i){for(var a=i.shapeInfo.logicalShape,o=a.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),g="int b, int row, int col",m="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<o-1;v++)g="int b"+v+", "+g,p*=a[o-v-1],m="b"+v+" * "+p+" + "+m;var y=Ma();return`
    vec4 `+u+"("+g+`) {
      int index = `+m+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var x4e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,w4e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_4e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,S4e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function mg(e){return"offset"+e}function v0(e){var t=e.name,n=ft(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Er(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function y0(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function b0(e,t){return t.map(function(n){return e[n]}).join(", ")}var E4e=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,H(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,c=Er(l),f=Ho("coords",l);if(a===1){var d=Er(s=l+1);o=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,o=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],g=h.map(function(_){return"int "+_}),m=Ho("sourceLocR",s-1).concat("inIdx.r"),v=Ho("sourceLocG",s-1).concat("inIdx.g"),y=Ho("sourceLocB",s-1).concat("inIdx.b"),b=Ho("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",C=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},C4e=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},A4e=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+g+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},k4e=function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],vn(e,t),vn(e,n);var o="0.0";r!=null&&(vn(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";i!=null&&(vn(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},T4e=function(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],vn(e,t),vn(e,n);var o="vec4(0.0)";r!=null&&(vn(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(vn(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},O4e="return areal * breal - aimag * bimag;",I4e="return areal * bimag + aimag * breal;",RJ=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=vn(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},GP="return a + b;",KP="return a - b;",FJ="return a * b;",N4e=`
if (a == b) {
  return 1.0;
};
return a / b;`,MJ="return (a < 0.) ? b * a : a;",ti=function(e,t,n){this.variableNames=["A","B"],this.outputShape=vn(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},D4e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,PJ=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,cc=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=vn(t,n);var i=this.outputShape.length,a="";if(r)if(i===0||ft(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+Er(i)+` coords = getOutputCoords();
        `,i===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=Ho("coords",i);a+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},R4e=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),F4e=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),M4e=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},P4e=function(e){this.outputShape=[],this.outputShape=dg(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},$4e=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=dg(e,t);var n=this.outputShape,r=n.length,i=Er(r),a=Ho("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(m,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=o[t],c=o.slice(-2),f=o.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+nA(o,l,h)+`),
            vec2(`+nA(c,l,h)+`));
        }`}var p=s.length,g=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+nA(o,l,g)+`),
          vec2(`+nA(c,l,g)+"));",this.userCode=`
      float getValue(`+o.map(function(m){return"int "+m})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function nA(e,t,n){var r=e.indexOf(t);return e.map(function(i,a){return a===r?i+" - "+n:i}).join()}var L4e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},B4e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},z4e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},j4e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},U4e=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},W4e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},$J=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,m=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},V4e=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+a+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},LJ=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+m+`
        setOutput(result);
      }
    `},BJ=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<h;v++)g+=`
          vec4 xTexelR`+m+"C"+2*v+` = vec4(0.);
          vec4 wR`+m+"C"+v+` = vec4(0.);
          vec4 xR`+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<p;y++){if(g+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+m+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+`.xy);
                } else {
                  xR`+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xR`+m+"C"+v+" = xTexelR"+m+"C"+v+`;
              `,v+1<h)){var b=s%2==0?kM(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+`;
                `}}else v<h&&(g+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
              `,v+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+`.xy);
              `,v+1<h&&(g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
                `)),g+="}");v<h&&(g+=`
            vec4 wTexelR`+m+"C"+v+" = getW("+m+", "+v+`, d1, q);
            wR`+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+`.xz);
          `,v+1<h&&(g+=`
              vec4 wTexelR`+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+`, d1, q);
              wR`+m+"C"+(v+1)+` =
                vec4(wTexelR`+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<h;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},q4e=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[o-1+".0",s-1+".0"],p=h[0],g=h[1],m=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=x[0],S=x[1],C=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},H4e=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Er(r)+` coords = getOutputCoords();
        int end = `+zJ(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+zJ(r,"coords")+` = idx;
          val += getX(`+function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function zJ(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var G4e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Q1.DENSE;var t=ex(e),n=Ma();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+gg(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},K4e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Q1.DENSE;var t=ex(e),n=Ma();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+gg(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},X4e=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Y4e=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},Z4e=function(e){this.variableNames=["A"],this.outTexUsage=Cs.DOWNLOAD;var t=Ma();this.outputShape=e,this.userCode=`
      `+NJ+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},J4e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Cs.DOWNLOAD;var t=Ma();this.outputShape=e,this.userCode=`
      `+NJ+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},Q4e=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Ma(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+HP(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},eBe=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ma(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+HP(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+s+`;
      }
    `},tBe="return real * expR - imag * expI;",nBe="return real * expI + imag * expR;",jJ=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},rBe=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),iBe=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Er(this.rank),a=function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},aBe=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Er(t.length),i=Er(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function UJ(e,t){var n=Ma();return kZ(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function WJ(e,t){return NZ(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function VJ(e,t){return DZ(e,t,new Uint16Array([0,1,2,2,1,3]))}function yx(e,t,n,r,i,a,o){FZ(n,r);var s=RZ(e,t),u=e.TEXTURE_2D;return ct(e,t,function(){return e.bindTexture(u,s)}),ct(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ct(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ct(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ct(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ct(e,t,function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)}),ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function qJ(e,t,n,r,i){var a=CC(n,r);return yx(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function HJ(e,t,n,r,i){var a=CC(n,r);return yx(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function GJ(e,t,n,r,i){var a=CC(n,r);return yx(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function KJ(e,t,n,r,i){var a=tx(n,r);return yx(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function XJ(e,t,n,r,i){var a=tx(n,r);return yx(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function YJ(e,t,n,r){return ct(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),qM(e,t,n,"clipSpacePos",r,3,20,0)&&qM(e,t,n,"uv",r,2,20,12)}function ZJ(e,t,n,r,i,a,o){var s,u,l;ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=o.internalFormatPackedFloat),s.set(a),ct(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function JJ(e,t,n,r){ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ct(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ct(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ct(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function QJ(e,t,n,r,i){var a=e.createBuffer();ct(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var o=16*n*r;return ct(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),ct(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ct(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function eQ(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function tQ(e,t,n,r,i){var a=CC(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return ct(e,t,function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function nQ(e,t,n,r,i,a,o,s){var u=e,l=new Float32Array(function(c,f){var d=tx(c,f);return d[0]*d[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function rQ(e,t,n,r){var i=new Float32Array(n*r*4);return ct(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var oBe=Object.freeze({createVertexShader:UJ,createVertexBuffer:WJ,createIndexBuffer:VJ,createFloat32MatrixTexture:qJ,createFloat16MatrixTexture:HJ,createUnsignedBytesMatrixTexture:GJ,createPackedMatrixTexture:KJ,createFloat16PackedMatrixTexture:XJ,bindVertexProgramAttributeStreams:YJ,uploadDenseMatrixToTexture:ZJ,uploadPixelDataToTexture:JJ,createBufferFromOutputTexture:QJ,downloadFloat32MatrixFromBuffer:eQ,downloadByteEncodedFloatMatrixFromOutputTexture:tQ,downloadPackedMatrixFromBuffer:nQ,downloadMatrixFromPackedOutputTexture:rQ}),iQ=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=we().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,EZ(n,t)):this.gl=ic(n);var r="WEBGL_color_buffer_float";if(we().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=nx(this.gl,this.debug,"OES_texture_float"),ks(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=nx(this.gl,this.debug,"OES_texture_half_float");else if(we().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ks(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=nx(this.gl,this.debug,"EXT_color_buffer_half_float");else if(we().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ks(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!ks(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=WJ(this.gl,this.debug),this.indexBuffer=VJ(this.gl,this.debug),this.framebuffer=MZ(this.gl,this.debug),this.textureConfig=VM(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return we().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ct(n,this.debug,function(){return n.finish()}),ct(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ct(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ct(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ct(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ct(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),qJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),HJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),GJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),JJ(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),ZJ(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),XJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),KJ(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(HM(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ct(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return tQ(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,a,o){return nQ(this.gl,t,0,0,0,a,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return eQ(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=QJ(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(we().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(o,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=o}else we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return rQ(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=TZ(n,this.debug,t),i=UJ(n,this.debug),a=OZ(n,this.debug);return ct(n,this.debug,function(){return n.attachShader(a,i)}),ct(n,this.debug,function(){return n.attachShader(a,r)}),IZ(n,this.debug,a),this.debug&&TC(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=YJ(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ct(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&TC(this.gl,this.debug,this.program),ct(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?$Z(this.gl,this.debug,t,n):LZ(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ct(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),BZ(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=tx(n,r),a=i[0],o=i[1];this.setOutputMatrixTextureDriver(t,a,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&TC(this.gl,this.debug,this.program),rx(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ct(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ct(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=nx(this.gl,this.debug,we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return dt(this,void 0,void 0,function(){var n=this;return ht(this,function(r){switch(r.label){case 0:return[4,TM(function(){return n.disposed||n.isQueryAvailable(t,we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||TM(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),OC(this.gl,this.debug,t,this.framebuffer),this.debug&&rx(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(OC(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&rx(this.gl)):HM(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;OC(i,this.debug,t,this.framebuffer),this.debug&&rx(i),this.outputTexture=t,ct(i,this.debug,function(){return i.viewport(0,0,n,r)}),ct(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var a=this;this.throwIfDisposed(),ct(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function aQ(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,a=t[r],o=a.shape;if(!wi(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!wi(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var sBe=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=i*r,g=Ma(),m=f==="channelsLast",v=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},uBe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},lBe=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},cBe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},fBe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},dBe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},XP=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),a===void 0&&(a=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+p+`

        setOutput(result);
      }
    `},hBe=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),pBe=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},gBe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=Ho("rc",t),r=Er(t),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var g=0;g<=1;g++){for(var m=(p===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<f;v++)m=d[d.length-1-v]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},mBe=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,i=Er(r),a=t.map(function(u){return u[0]}).join(","),o=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+a+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},vBe=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(m,v){return m[0]+e[v]+m[1]});for(var r=e.length,i=Er(r),a=t.map(function(m){return m[0]}).join(","),o=t.map(function(m,v){return m[0]+e[v]}).join(","),s=Ho("rc",r),u=Ho("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,g=r===1?2:4;p<g;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+a+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},bx=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",g="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",v="0.0";if(p||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+s+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(r?i?g:m:"wR * "+f+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(a/4),x=a%4,w=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+w+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+w+`
          }
        }
        setOutput(`+y+`);
      }
    `}},YP=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+s+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = `+(r?i?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+h+" * "+p+` +
                      wR * `+p+" + wC")+`;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var w=4*Math.floor(a/4),S=a%4,C=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+s+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+C+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+C+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},yBe=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",s="min"):t==="max"&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},bBe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+gg(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+HP(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},xBe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},wBe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},_Be=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},SBe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},EBe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},CBe=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,o){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(o)}).join(","),i=Er(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},ABe=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Ho("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Er(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},oQ=function(e,t,n,r,i,a,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Er(i.length),u=Er(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},kBe=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},TBe=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var l=Er(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},OBe=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Er(this.rank),i="uniform int start["+this.rank+"];",a=function(o){if(o===1)return"sourceLoc";if(o<=6)return ZP.slice(0,o).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,s){return"sourceLoc."+ZP[s]+" = start["+s+"] + coords."+ZP[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),ZP=["x","y","z","w","u","v"],IBe=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Er(this.rank),r=Ho("coords",this.rank),i=Ho("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+a+")",s=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),NBe=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Er(n.length),a=Er(n.length),o="";if(r===1)o="coords * strides + begin";else{var s=0;o=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},DBe=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,a=sQ(n,r),o=uQ(t,a,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),a===As.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===As.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===As.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===As.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===As.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var a=uQ(n,sQ(r,i),i);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[a],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function sQ(e,t){if(e===Cs.UPLOAD)return As.PACKED_2X2_FLOAT32;if(e===Cs.RENDER||e==null)return function(n){return we().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?As.PACKED_2X2_FLOAT32:As.UNPACKED_FLOAT32:n?As.PACKED_2X2_FLOAT16:As.UNPACKED_FLOAT16}(t);if(e===Cs.DOWNLOAD||e===Cs.PIXELS)return As.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function uQ(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var RBe=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Er(this.rank),a=function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<o.length;c++)l.push("imod("+u[c]+", "+o[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},JP=1.7580993408473768,QP=1.0507009873554805,en=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},tl="if (isnan(x)) return x;",FBe="return x;",lQ="return abs(x);",cQ=tl+`
  return (x < 0.0) ? 0.0 : x;
`,fQ=tl+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,dQ="return (x >= 0.0) ? x : (exp(x) - 1.0);",MBe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+JP+`;
  float scale = `+QP+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,hQ="return -x;",pQ="return ceil(x);",gQ="return floor(x);",mQ="return exp(x);",vQ="return exp(x) - 1.0;",PBe=tl+`
  return sin(x);
`,$Be=tl+`
  return cos(x);
`,LBe=tl+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,BBe=tl+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,zBe=tl+`
  return atan(x);
`,jBe=tl+"return log(x + sqrt(x * x + 1.0));",UBe=tl+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,WBe=tl+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,rA="return x;",VBe="return x;",yQ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bQ=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xQ=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,xx=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},qBe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=Ho("rc",t),r=Er(t),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},iA={};function aA(e,t){if(t===void 0&&(t=!1),e==="linear")return t?VBe:FBe;if(e==="relu")return t?yQ:cQ;if(e==="elu")return t?xQ:dQ;if(e==="relu6")return t?bQ:fQ;if(e==="prelu")return t?PJ:MJ;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var HBe=600,wQ=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!we().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=ic(we().getNumber("WEBGL_VERSION"));i.binaryCache=((r=we().getNumber("WEBGL_VERSION"))in iA||(iA[r]={}),iA[r]),i.gpgpu=new iQ(a),i.canvas=a.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new DBe(i.gpgpu),i.numMBBeforeWarning=we().global.screen==null?1024:we().global.screen.height*we().global.screen.width*window.devicePixelRatio*HBe/1024/1024,i.texData=new PP(i,te),i}return Yu(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(we().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:i,values:n,usage:Cs.UPLOAD}),a},t.prototype.move=function(n,r,i,a){if(we().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:a,values:r,usage:Cs.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,a=r.dtype,o=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new xx(u,rA):new en(u,rA);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return i;var h,p,g=this.activeTimers!=null;return g&&(h=Zu()),a==="complex64"?p=UP(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=Zu()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return dt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return ht(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(A){return r.push(A)})];if(i=this.texData.get(n),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return f=void 0,f=c?new xx(o,rA):new en(o,rA),d=this.runWebGLProgram(f,[{dataId:n,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!we().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&we().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&we().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),m=this.texData.get(g.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(ex(o)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=E.sent(),b=y[0],x=y[1],v=UP(b,x),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(w=ft(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),E.label=5;case 5:return g!=null&&this.disposeData(g.dataId),S=this.convertAndCacheOnCPU(n,v),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(A){return A(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!CZ(i))throw we().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.isPacked,u=ft(a);if(we().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(ex(a))).subarray(0,u);return this.disposeData(l.dataId),f}var d=we().getBool("WEBGL_PACK")&&s===!0,h=d?IC(a):a,p=d?new J4e(h):new Z4e(h),g=this.runWebGLProgram(p,[{shape:h,dtype:o,dataId:n}],"float32"),m=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},t.prototype.time=function(n){return dt(this,void 0,void 0,function(){var r,i,a,o,s,u,l;return ht(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],a=!1,this.programTimersStack==null?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,n(),o=kf(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=kf(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=c.sent(),u.kernelMs=uZ(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zu(),endMs:null}},t.prototype.endTimer=function(n){return we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Zu(),n)},t.prototype.getQueryTime=function(n){return dt(this,void 0,void 0,function(){var r;return ht(this,function(i){return we().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,a=r.dtype,o=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,a),this.textureManager.releaseTexture(i,o,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return we().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=te.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return i.texData.get(a.dataId).texture==null&&ft(a.shape)<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:te.keep(n.clone()),imag:te.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(ft(i)===0)return fi([],i,n.dtype);var a=this.texData.get(n.dataId).isPacked,o=FP(n.shape,r,i);if(a||!o){var s=we().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IBe(i):new OBe(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var a=this.texData.get(n.dataId),o=this.makeOutput(i,n.dtype),s=this.texData.get(o.dataId);Object.assign(s,a),s.shape=i,s.dtype=n.dtype;var u=MP(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},t.prototype.stridedSlice=function(n,r,i,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,a);var o=YC(r,i,a);if(o.some(function(u){return u===0}))return fi([],o);var s=new NBe(r,a,o);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=we().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ABe(n.shape,r):new CBe(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return qo(h)}),a=n.map(function(h){return uu(h)});return $i(this.concat(i,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>we().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),s=this.concat(n.slice(0,o),r),u=this.concat(n.slice(o),r);return this.concat([s,u],r)}if(we().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new $4e(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=dg(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,ft(h.shape.slice(r)))}),d=new P4e(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,hQ,n.dtype);var r=new en(n.shape,hQ);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,a){var o=i?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],l=n.shape[0];if((o===1||s===1)&&u>1e3){i&&(n=In(n,[0,2,1])),a&&(r=In(r,[0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=na(n.dtype,r.dtype),p=new XP(n.shape,[l,o,s],i,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],d=r.shape[0],h=na(r.dtype,i.dtype),p=s!=null,g=l!=null,m=u?aA(u,!0):null,v=new XP(r.shape,[d,c,f],a,o,p,m,g),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),a=this.texData.get(r.dataId),o=new RJ(O4e,n.shape,r.shape),s=new RJ(I4e,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(o,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,FJ,n.dtype);var d=new ti(FJ,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){var u=[n,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(o!=null&&(c=o.shape,u.push(o)),we().getBool("WEBGL_PACK_NORMALIZATION")){var f=new T4e(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(f,u)}var d=new k4e(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){var s=we().getBool("WEBGL_PACK_NORMALIZATION")?new cBe(n.shape,r,i,a,o):new uBe(n.shape,r,i,a,o);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){var l=new lBe(r.shape,a,o,s,u);return this.compileAndRun(l,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(o){return K1(o)});return TJ(Ht(n.shape,n.dtype,i),r)}var a=new RBe(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,i){var a=we().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vBe(n.shape,r,i):new mBe(n.shape,r,i);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var a=new iBe(n.shape,r.size,i);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){H(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,d){return f*d}),o=zC(n.shape,r,a),s=jC(o.length,r.length),u=UC(n.shape,r,a),l=rJ(i,r.length),c=iJ(u,i,r.length);return In(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){H(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=zC(u.shape,r,a,!1),c=jC(l.length,r.length,!1),f=UC(u.shape,r,a,!1);return In(u.reshape(l),c).reshape(f)},t.prototype.reduce=function(n,r,i){var a=n.shape[0],o=n.shape[1],s=XC(o),u=new yBe({windowSize:s,inSize:o,batchSize:a},r),l=this.compileAndRun(u,[n],i);return l.shape[1]===1?l:this.reduce(l,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var a=n.shape[0],o=n.shape[1];i!=null&&(a=i.shape[0],o=i.shape[1]);var s=XC(o),u=new y4e({windowSize:s,inSize:o,batchSize:a},r,i==null),l=[n];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var a=i!=null?i.shape:n.shape,o=XC(a[a.length-1]),s=new E4e(a,o,r,i==null),u=i==null?[n]:[n,i],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){Vo("sum",r,n.rank);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o),u=EC(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o),u=EC(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,i){var a=0,o=Ju([a],n.rank),s=n;o!=null&&(s=In(n,o),a=Qu(1,n.rank)[0]);var u=function(h,p,g){for(var m=[],v=h.length,y=0;y<v;y++)y!==p?m.push(h[y]):m.push(g);return m}(s.shape,a,i),l=ft([s.shape[a]]),c=s.as2D(-1,l),f=EC(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(u);return o!=null&&(d=In(d,MC(o))),d},t.prototype.segOpCompute=function(n,r,i,a,o){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,g=!1;for(d<=DP?(p=d,g=!0):p=_C(d,Math.floor(Math.sqrt(d)));!g;)p>h||p===d?g=!0:p=_C(d,p+1);return p}(u,o),c=new kBe({windowSize:l,inSize:u,batchSize:s,numSegments:o},r),f=this.compileAndRun(c,[n,i],a);return f.shape[1]===o?f:(i=d0(0,o).tile([u/l]),this.segOpCompute(f,r,i,a,o))},t.prototype.argMinMaxReduce=function(n,r,i){var a=[r];if(Vo("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,n.rank),!we().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=va(n.shape,a),s=o[0],u=ft(o[1]),l=n.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new H4e(n.shape,i,a);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new ti("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new ti("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new ti("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new ti("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new ti("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new ti("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new en(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new ti("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new ti("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var a=new TBe(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,i],na(r.dtype,i.dtype))},t.prototype.where=function(n){FC("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return qP(n.shape,r)},t.prototype.topk=function(n,r,i){return OJ(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Vo("min",r,n.rank);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ti(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ti(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Vo("max",r,n.rank);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ti(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){Vo("all",r,n.rank);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){Vo("any",r,n.rank);var i=va(n.shape,r),a=i[0],o=ft(i[1]),s=n.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.floorDiv=function(n,r){if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new ti(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,GP);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=na(n.dtype,r.dtype);if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,GP,i);var a=new ti(GP,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var a=new xx(n.shape,r);return this.compileAndRun(a,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,a,o){o===void 0&&(o=!1);var s=new cc(i,n.shape,r.shape,o);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var a=this,o=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],g=a.makeComplexComponentTensorInfo(n,h),m=a.makeComplexComponentTensorInfo(r,p),v=new ti(i,n.shape,r.shape);return a.compileAndRun(v,[g,m],na(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>we().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([i,a])}var o=n.map(function(l){return l.dtype}).reduce(function(l,c){return na(l,c)}),s=n.map(function(l){return l.shape}),u=we().getBool("WEBGL_PACK")?new v4e(n[0].shape,s):new m4e(n[0].shape,s);return this.compileAndRun(u,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,KP);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=na(n.dtype,r.dtype);if(we().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,KP,n.dtype);var a=new ti(KP,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.pow=function(n,r){var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ti(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=na(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,pQ,n.dtype);var r=new en(n.shape,pQ);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,gQ,n.dtype);var r=new en(n.shape,gQ);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new en(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new en(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new en(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new en(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new en(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,mQ,n.dtype);var r=new en(n.shape,mQ);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,vQ,n.dtype);var r=new en(n.shape,vQ);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=_i([r],n.shape),a=this.max(n,i),o=oo(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return ei(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new en(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new en(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new en(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new en(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new en(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=we().getBool("WEBGL_PACK")?new xx(n.shape,yQ):new en(n.shape,cQ),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=we().getBool("WEBGL_PACK")?new xx(n.shape,bQ):new en(n.shape,fQ),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(PJ,n.shape,r.shape):new ti(MJ,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,xQ,n.dtype);var r=new en(n.shape,dQ);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new ti("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new en(n.shape,MBe);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new en(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var a,o=(a=we().getBool("WEBGL_PACK_CLIP")?new F4e(n.shape):new R4e(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(a,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(we().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,lQ,n.dtype);var r=new en(n.shape,lQ);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new M4e(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,a)},t.prototype.sigmoid=function(n){var r=new en(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new en(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new en(n.shape,PBe);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new en(n.shape,$Be);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new en(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new en(n.shape,LBe);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new en(n.shape,BBe);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new en(n.shape,zBe);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ti(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new en(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new en(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new en(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new en(n.shape,jBe);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new en(n.shape,UBe);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new en(n.shape,WBe);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new en(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new en(n.shape,function(a){return a===void 0&&(a=0),tl+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,a,o,s){var u=n.shape,l=this.texData.get(n.dataId),c=i.inChannels,f=u[0]*u[1]*u[2],d=i.outChannels,h=i.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(p||!we().getBool("WEBGL_LAZILY_UNPACK")||!we().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,m,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,H(ox(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,i.inChannels,i.outChannels]),C=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),_=this.texData.get(C.dataId);return H(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,_.shape=i.outShape,te.makeTensorFromDataId(C.dataId,i.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,a,o,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,f=i.outWidth,d=i.outHeight,h=i.dataFormat==="channelsLast",p=u*l*c,g=d*f,m=[p,g],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new sBe(m,v.shape,i),x=this.compileAndRun(b,[v]).reshape([1,m[0],m[1]]),w=a!=null,S=s!=null,C=o?aA(o,!0):null,_=new XP(x.shape,[1,g,i.outChannels],!0,!1,w,C,S),E=[x,y];a&&E.push(a),S&&E.push(s);var A=this.compileAndRun(_,E);return h?A.reshape([1,d,f,i.outChannels]):A.reshape([1,i.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,a,o,s,u);if(we().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,a,o,s,u);var l=o!=null,c=u!=null,f=s?aA(s,!1):null,d=new $J(a,l,f,c),h=[r,i];return o&&h.push(o),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(we().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var a=new $J(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var a=new B4e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var a=new L4e(i);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,a=n.filter,o=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=we().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=u?aA(u,c):null,d=[i,a],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new BJ(o,h,f,p),this.compileAndRun(r,d)):(r=new LJ(o,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,i){var a;return we().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(a=new BJ(i),this.compileAndRun(a,[n,r])):(a=new LJ(i),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var a=new W4e(i);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var a=new U4e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,i){var a=new V4e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var a=new j4e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var a=new z4e(i);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var i=new bx(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new bx(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,a){var o=new bx(a,"max",!0),s=this.compileAndRun(o,[r]),u=new fBe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,i){var a=new C4e(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return zP(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var i=new YP(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var a=new A4e(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new YP(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,a){var o=new YP(a,"max",!0),s=this.compileAndRun(o,[r]),u=new dBe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!ox(n.shape,r)&&(i.texture===null||!ox(i.shape,r))){var a=this.packedReshape(n,r);return te.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return tA(n,r)},t.prototype.resizeBilinear=function(n,r,i,a){var o=we().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new _Be(n.shape,r,i,a):new wBe(n.shape,r,i,a);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var a=new xBe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,a){var o=new EBe(n.shape,r,i,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var a=new SBe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,i,a){var o=r?n:hg(n),s=o.shape[0],u=o.shape[1],l=new hBe(s,u,i),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[o],"int32",c)},t.prototype.oneHot=function(n,r,i,a){var o=new pBe(n.size,r,i,a);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new Y4e(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return FC("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),WP(n.dataSync(),r.dataSync(),i,a,o)},t.prototype.cropAndResize=function(n,r,i,a,o,s){var u=new q4e(n.shape,r.shape,a,o,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){H(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],o=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],l=o*r,c=s*r,f=u/(r*r),d=new X4e(i==="NHWC"?[a,l,c,f]:[a,f,l,c],r,i);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,i){return kJ(n,r,i)},t.prototype.scatterND=function(n,r,i){var a=hx(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=[c/u,u],d=n.reshape([s,o]),h=r.reshape([s,u]);if(c===0)return tA(fi([]),i);var p=rt(0),g=new oQ(s,o,d.rank,h.rank,l,f);return this.compileAndRun(g,[h,d,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,a){var o=hx(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.strides,c=o.outputSize,f=new oQ(u,s,n.rank,r.rank,l,[c,1],!1);return this.compileAndRun(f,[r,n,a]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),a=new jJ(tBe,n.shape,r),o=new jJ(nBe,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(o,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=NP(n,r),s=o[0],u=o[1],l=o[2],c=o[3],f=r.reshape([u,a]),d=n.reshape([n.size/l,l]),h=new aBe(a,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||u0(r))==="string"){var a=G1(i,ft(n));return a.fill(r),te.makeTensor(a,n,i,this)}var o=new rBe(n,r),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return jP(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return te.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new qBe(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new gBe(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[ix(n.shape)].concat(ax(n.shape)),a={dtype:n.dtype,shape:i,dataId:n.dataId},o=[ix(r)].concat(ax(r)),s=new bBe(o,i),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),a=i.isPacked,o=i.shape,s=i.dtype,u=IC(o);return r=a?new K4e(u):new G4e(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,a,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(n.outputShape,i),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Q1.DENSE){var c=ex(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),ft(u.shape)===0)return l.values=cg(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&ft(b.shape)<=we().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!ox(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},g=function(b,x,w){var S="";x.concat(w).forEach(function(E){var A=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,k=E.isUniform?"uniform":E.texData.texShape;S+=E.shape+"_"+k+"_"+A});var C=b.userCode,_=b.constructor.name;return _+="_"+S+"_"+C}(n,d,p),m=this.getAndSaveBinary(g,function(){return function(b,x,w,S){var C=x.userCode,_=w.map(function(V,Y){var X={logicalShape:V.shape,texShape:V.isUniform?null:V.texData.texShape,isUniform:V.isUniform,isPacked:!V.isUniform&&V.texData.isPacked,flatOffset:null};return V.texData!=null&&V.texData.slice!=null&&V.texData.slice.flatOffset>0&&(X.flatOffset=V.texData.slice.flatOffset),{name:x.variableNames[Y],shapeInfo:X}}),E=_.map(function(V){return V.shapeInfo}),A={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},k=b4e(_,A,C,x.packedInputs),T=b.createProgram(k),I=null,N=b.getUniformLocation(T,"NAN",!1);we().getNumber("WEBGL_VERSION")===1&&(I=b.getUniformLocation(T,"INFINITY",!1));for(var O={},D=0;D<x.variableNames.length;D++){var P=x.variableNames[D];O[P]=b.getUniformLocation(T,P,!1),O["offset"+P]=b.getUniformLocation(T,"offset"+P,!1)}return{program:x,source:k,webGLProgram:T,uniformLocations:O,inShapeInfos:E,outShapeInfo:A,infLoc:I,nanLoc:N}}(s.gpgpu,n,d,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,x,w,S,C){aQ(x.inShapeInfos,w),aQ([x.outShapeInfo],[S]);var _=S.texData.texture,E=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(_,E[0],E[1]):b.setOutputMatrixTexture(_,E[0],E[1]),b.setProgram(x.webGLProgram),we().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(A,k){var T=x.program.variableNames[k],I=x.uniformLocations[T],N=x.uniformLocations["offset"+T];if(I!=null)if(A.isUniform)if(ft(A.shape)<2)b.gl.uniform1f(I,A.uniformValues[0]);else{var O=A.uniformValues;O instanceof Float32Array||(O=new Float32Array(O)),b.gl.uniform1fv(I,O)}else A.texData.slice!=null&&N!=null&&b.gl.uniform1i(N,A.texData.slice.flatOffset),b.setInputMatrixTexture(A.texData.texture,I,k)}),C!=null&&C(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,m,d,p,a),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!we().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,a,o){o===void 0&&(o=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,a,o);return te.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(we().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ge(function(){if(!we().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=we().getBool("DEBUG");we().set("DEBUG",!1);var i=n.abs(rt(1e-8)).dataSync()[0];if(we().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=Zu());var h=i.texShape;if(h==null&&(h=UZ(a,c),i.texShape=h),s!=null){var p=IC(a),g=void 0,m=h[1],v=h[0],y=s instanceof Uint8Array;c?(m=(r=tx(h[0],h[1]))[0],v=r[1],g=new eBe(p,[v,m],y)):g=new Q4e(p,[v,m],y);var b=this.makeTensorInfo([v,m],o);this.texData.get(b.dataId).usage=y?Cs.PIXELS:Cs.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,v,s);var x=this.runWebGLProgram(g,[b],o,null,!0),w=this.texData.get(x.dataId);i.texture=w.texture,i.texShape=w.texShape,i.isPacked=w.isPacked,i.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),i.values=null,d&&(this.uploadWaitMs+=Zu()-f)}else{var S=this.acquireTexture(h,l,o,c);i.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),a=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),i.values},t.prototype.acquireTexture=function(n,r,i,a){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*OM(r)},t}($P);SZ()&&te.registerBackend("webgl",function(){return new wQ},2);function vg(e,t){return e(t={exports:{}},t.exports),t.exports}var GBe=vg(function(e){(function(t,n,r){function i(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new i(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,e,!1)}),KBe=vg(function(e){(function(t,n,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,e,!1)}),XBe=vg(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,e,!1)}),YBe=vg(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,e,!1)}),ZBe=vg(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,g,m=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(g=g+1640531527|0,h=(f=m[127&p]^=d+g)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=m[h+34&127],f=m[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,m[h]=d^f;l.w=g,l.X=m,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,e,!1)}),JBe=vg(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,e,!1)}),yg=vg(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(v,y,b){var x=[],w=g(function _(E,A){var k,T=[],I=typeof E;if(A&&I=="object")for(k in E)try{T.push(_(E[k],A-1))}catch(N){}return T.length?T:I=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,m(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(_)),m(_)}catch(k){var E=i.navigator,A=E&&E.plugins;return[+new Date,i,A,i.screen,m(t)]}}(),3),x),S=new h(x),C=function(){for(var _=S.g(o),E=u,A=0;_<l;)_=(_+A)*a,E*=a,A=S.g(1);for(;_>=c;)_/=2,E/=2,A>>>=1;return(_+A)/E};return C.int32=function(){return 0|S.g(4)},C.quick=function(){return S.g(4)/4294967296},C.double=C,g(m(S.S),t),(y.pass||b||function(_,E,A,k){return k&&(k.S&&p(k,S),_.state=function(){return p(S,{})}),A?(n[s]=_,E):_})(C,w,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,C=x.S=[];for(b||(v=[b++]);w<a;)C[w]=w++;for(w=0;w<a;w++)C[w]=C[S=f&S+v[w%b]+(y=C[w])],C[S]=y;(x.g=function(_){for(var E,A=0,k=x.i,T=x.j,I=x.S;_--;)E=I[k=f&k+1],A=A*a+I[f&(I[k]=I[T=f&T+E])+(I[T]=E)];return x.i=k,x.j=T,A})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function g(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return m(y)}function m(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,g(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(v){}}})([],Math)});yg.alea=GBe,yg.xor128=KBe,yg.xorwow=XBe,yg.xorshift7=YBe,yg.xor4096=ZBe,yg.tychei=JBe;var oA=yg.alea,e$=ne({addN_:function(e){H(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),H(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,a){return U(i,"tensors"+a,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!wi(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return te.runKernelFunc(function(i,a){return i.addN(t)},r,null,"AddN")}});function sA(){DC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function _Q(e){return e.rank===0||e.rank===1?e.as4D(1,1,1,e.size):e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function SQ(e,t,n,r,i,a){a==null&&(a=.001);var o,s,u=U(e,"x","batchNorm"),l=U(t,"mean","batchNorm"),c=U(n,"variance","batchNorm");i!=null&&(o=U(i,"scale","batchNorm")),r!=null&&(s=U(r,"offset","batchNorm")),H(l.rank===c.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),H(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),H(o==null||l.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f={x:u,scale:o,offset:s,mean:l,variance:c},d={varianceEpsilon:a};return te.runKernelFunc(function(h,p){var g=_Q(u),m=h.batchNormalization(g,uA(l),uA(c),a,uA(o),uA(s));return p([u,l,c,o]),m},f,null,"FusedBatchNorm",d).reshape(u.shape)}function uA(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var EQ=ne({batchNormalization_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),sA(),SQ(e,t,n,a,i,r)}}),bg=ne({batchNorm_:SQ});function CQ(e,t,n,r,i,a){var o,s,u=U(e,"x","batchNorm"),l=U(t,"mean","batchNorm"),c=U(n,"variance","batchNorm");return i!=null&&(o=U(i,"scale","batchNorm")),r!=null&&(s=U(r,"offset","batchNorm")),H(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),H(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),H(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&H(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),s!=null&&H(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),bg(u,l,c,s,o,a)}var AQ=ne({batchNormalization2d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),sA(),CQ(e,t,n,a,i,r)}}),t$=ne({batchNorm2d_:CQ});function kQ(e,t,n,r,i,a){var o,s,u=U(e,"x","batchNorm"),l=U(t,"mean","batchNorm"),c=U(n,"variance","batchNorm");return i!=null&&(o=U(i,"scale","batchNorm")),r!=null&&(s=U(r,"offset","batchNorm")),H(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),H(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),H(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&H(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),s!=null&&H(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),bg(u,l,c,s,o,a)}var TQ=ne({batchNormalization3d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),sA(),kQ(e,t,n,a,i,r)}}),n$=ne({batchNorm3d_:kQ});function OQ(e,t,n,r,i,a){var o,s,u=U(e,"x","batchNorm"),l=U(t,"mean","batchNorm"),c=U(n,"variance","batchNorm");return i!=null&&(o=U(i,"scale","batchNorm")),r!=null&&(s=U(r,"offset","batchNorm")),H(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),H(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),H(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&H(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),s!=null&&H(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),bg(u,l,c,s,o,a)}var IQ=ne({batchNormalization4d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),sA(),OQ(e,t,n,a,i,r)}}),r$=ne({batchNorm4d_:OQ}),i$=ne({broadcastTo_:function(e,t){var n=U(e,"broadcastTo","x"),r=n.shape;if(t.some(function(f){return!(f>0)||f%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(f,d){return f>1?d:-1}).filter(function(f){return f>=0});if(u.length===0)return n.clone();var l={x:n},c={shape:t,inputShape:a};return te.runKernelFunc(function(f){return f.tile(n,o)},l,function(f){return{x:function(){return f.sum(u,!0)}}},aP,c)}}),NQ=ne({clone_:function(e){var t=U(e,"x","clone",null);return te.runKernelFunc(function(){return te.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{x:t},null,sP)}}),fc=ne({logicalAnd_:function(e,t){var n=U(e,"a","logicalAnd","bool"),r=U(t,"b","logicalAnd","bool");return vn(n.shape,r.shape),te.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),a$=ne({logicalNot_:function(e){var t=U(e,"x","logicalNot","bool");return te.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),lA=ne({logicalOr_:function(e,t){var n=U(e,"a","logicalOr","bool"),r=U(t,"b","logicalOr","bool");return vn(n.shape,r.shape),te.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),DQ=ne({logicalXor_:function(e,t){var n=U(e,"a","logicalXor","bool"),r=U(t,"b","logicalXor","bool");return vn(n.shape,r.shape),lA(e,t).logicalAnd(fc(e,t).logicalNot())}}),nl=ne({where_:function(e,t,n){var r=U(t,"a","where"),i=U(n,"b","where"),a=U(e,"condition","where","bool");return On(r.shape,i.shape,"Error in where: "),a.rank===1?H(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):On(a.shape,i.shape,"Error in where: "),te.runKernelFunc(function(o,s){var u=o.select(a,r,i);return s([a]),u},{$condition:a,$a:r,$b:i},function(o,s){var u=s[0];return{$condition:function(){return wn(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}})}}),cA=function(e){return dt(this,void 0,void 0,function(){var t,n,r;return ht(this,function(i){switch(i.label){case 0:return[4,(t=U(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=qP(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},fA=ne({divNoNan_:function(e,t){var n,r=U(e,"a","div"),i=U(t,"b","div");r=(n=Mr(r,i))[0],i=n[1];var a=ei(r,i),o=wn(a),s=i.equal(o);return nl(s,o,a)}}),Rf=ne({tile_:function(e,t){var n=U(e,"x","tile",null);H(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={x:n},a={reps:t};return te.runKernelFunc(function(o,s){var u=o.tile(n,t);return s([n]),u},i,null,uP,a,r)}}),dA=ne({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=Ht([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return Rf(Os(s,0),[n[0],1,1]);if(n.length===2)return Rf(Os(Os(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return Rf(Os(Os(Os(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),o$=ne({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=U(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=o===1?i.as2D(1,-1):i,u=te.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return o===1?u.as1D():u}}),xg=ne({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=U(e,"indices","oneHot","int32"),a=i.shape.concat([t]),o={indices:i=i.flatten()},s={depth:t,onValue:n,offValue:r};return te.runKernelFunc(function(u,l){return l([i]),u.oneHot(i,t,n,r)},o,null,oP,s).reshape(a)}}),dc=ne({pad_:function(e,t,n){n===void 0&&(n=0);var r=U(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n},a={x:r};return te.runKernelFunc(function(o,s){return s([r]),o.pad(r,t,n)},a,null,lP,i)}}),RQ=ne({pad1d_:function(e,t,n){return n===void 0&&(n=0),H(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),dc(e,[t],n)}}),FQ=ne({pad2d_:function(e,t,n){return n===void 0&&(n=0),H(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),dc(e,t,n)}}),MQ=ne({pad3d_:function(e,t,n){return n===void 0&&(n=0),H(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),dc(e,t,n)}}),PQ=ne({pad4d_:function(e,t,n){return n===void 0&&(n=0),H(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),dc(e,t,n)}}),$Q=ne({rand_:function(e,t,n){var r=ft(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return te.makeTensor(i,e,n)}}),QBe=.001,LQ=.1;function s$(){return te.backend.floatPrecision()===32?QBe:LQ}function u$(e,t,n){var r=!0;if((ma(e)||ma(t))&&(r=!1),ma(e)&&ma(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=oc(e),s=oc(t);if(!wi(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=ma(e)?e:kf(e),l=ma(t)?t:kf(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function l$(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var eze=Object.freeze({TEST_EPSILON_FLOAT16:LQ,expectArraysClose:function(e,t,n){return n==null&&(n=s$()),u$(e,t,function(r,i){return l$(r,i,n)})},testEpsilon:s$,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Qd(e)||Qd(e[0])||Qd(t)||Qd(t[0])?u$(e,n,function(r,i){return r==i}):u$(e,t,function(r,i){return l$(r,i,0)})},expectNumbersClose:function(e,t,n){if(n==null&&(n=s$()),!l$(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),c$=function(){function e(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=oA(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var a=void 0,o=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),tze=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=oA(a.toString()),this.randn=new c$(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,a,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),nze=function(){function e(t,n,r,i){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=oA(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),BQ=ne({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new tze(t,n,r,i),o=Ht(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),f$=ne({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new c$(t,n,r,!1,i),o=Ht(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),wg=ne({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Ht(e,r),o=new nze(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),hA=ne({square_:function(e){var t=U(e,"x","square"),n=[t];return te.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),pA=ne({squaredDifference_:function(e,t){var n,r=U(e,"a","squaredDifference"),i=U(t,"b","squaredDifference");n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return te.runKernelFunc(function(s,u){var l=s.squaredDifference(r,i);return u([r,i]),l},a,function(s,u){var l=u[0],c=u[1],f=rt(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},cx,{},o,[])}}),wx=ne({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new c$(t,n,r,!0,i),o=Ht(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),_g=ne({equal_:function(e,t){var n,r=U(e,"a","equal"),i=U(t,"b","equal");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a){return a.equal(r,i)},{$a:r,$b:i})}}),zQ=ne({equalStrict_:function(e,t){var n=U(e,"a","equalStrict"),r=U(t,"b","equalStrict");return On(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),x0=ne({greater_:function(e,t){var n,r=U(e,"a","greater"),i=U(t,"b","greater");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a){return a.greater(r,i)},{a:r,b:i},null,"Greater")}}),_x=ne({greaterEqual_:function(e,t){var n,r=U(e,"a","greaterEqual"),i=U(t,"b","greaterEqual");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a,o){var s=a.greaterEqual(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return wn(s)},b:function(){return wn(u)}}},"GreaterEqual")}}),jQ=ne({greaterEqualStrict_:function(e,t){var n=U(e,"a","greaterEqualStrict"),r=U(t,"b","greaterEqualStrict");return On(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),UQ=ne({greaterStrict_:function(e,t){var n=U(e,"a","greaterStrict"),r=U(t,"b","greaterStrict");return On(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),d$=ne({less_:function(e,t){var n,r=U(e,"a","less"),i=U(t,"b","less");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a){return a.less(r,i)},{a:r,b:i},null,"Less")}}),h$=ne({lessEqual_:function(e,t){var n,r=U(e,"a","lessEqual"),i=U(t,"b","lessEqual");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a,o){var s=a.lessEqual(r,i);return o([r,i]),s},{a:r,b:i},null,"LessEqual")}}),WQ=ne({lessEqualStrict_:function(e,t){var n=U(e,"a","lessEqualStrict"),r=U(t,"b","lessEqualStrict");return On(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),VQ=ne({lessStrict_:function(e,t){var n=U(e,"a","lessStrict"),r=U(t,"b","lessStrict");return On(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),w0=ne({notEqual_:function(e,t){var n,r=U(e,"a","notEqual"),i=U(t,"b","notEqual");return n=Mr(r,i),r=n[0],i=n[1],vn(r.shape,i.shape),te.runKernelFunc(function(a){return a.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),qQ=ne({notEqualStrict_:function(e,t){var n=U(e,"a","notEqualStrict"),r=U(t,"b","notEqualStrict");return On(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function HQ(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function GQ(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var _0=ne({gather_:function(e,t,n){n===void 0&&(n=0);var r=U(e,"x","gather"),i=U(t,"indices","gather","int32");n=_i(n,r.shape)[0];var a=function(o,s,u){for(var l=o.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(o.shape[h]),f*=o.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<o.rank;h++)c.push(o.shape[h]),d*=o.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,i,n);return te.runKernelFunc(function(o,s){var u=o.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(o,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,g=HQ(0,d),m=HQ(d+1,d+1+p),v=GQ([f,[c],h]),y=o.reshape(v),b=u.reshape([c]),x=GQ([[d],g,m]),w=y.transpose(x),S=p$(w,b,r.shape[n]),C=MC(x);return S=S.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),p$=ne({unsortedSegmentSum_:function(e,t,n){var r=U(e,"x","unsortedSegmentSum"),i=U(t,"segmentIds","unsortedSegmentSum","int32");return H(Wr(n),function(){return"numSegments must be of dtype int"}),te.runKernelFunc(function(a,o){var s=a.unsortedSegmentSum(r,i,n);return o([i]),s},{$x:r},function(a,o){var s=o[0];return{$x:function(){return function(u,l){for(var c=lc(l,wn(l)),f=_0(u,c),d=_x(l,rt(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Os(d,p+1);d=fc(d,uc(f.shape,"bool"));var g=wn(f);return nl(d,f,g)}(a,s)}}})}}),KQ=function(e,t,n){return dt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g;return ht(this,function(m){switch(m.label){case 0:for(r=U(e,"tensor","boolMask"),i=U(t,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,H(o>0,function(){return"mask cannot be scalar"}),On(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+o)),f=r.reshape(c),d=i.reshape([-1]),[4,cA(d)];case 1:return h=m.sent(),p=h.squeeze([1]),g=_0(f,p,a),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,g]}})})};function XQ(e,t,n,r,i,a,o){a===void 0&&(a="NHWC"),H(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),H(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),H(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),H(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],f=a==="NHWC"?u.shape[3]:u.shape[1];H(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),H(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&H(Wr(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=eA(a),h=sh(s,n.shape,r,1,i,o,!1,d),p=te.runKernelFunc(function(g,m){var v=g.conv2dDerInput(u,n,h);return m([n,u]),v},{dy4D:u,filter:n},function(g,m){var v=m[0],y=m[1];return{dy4D:function(){return Sg(g,v,r,i,a,1,o)},filter:function(){return m$(g,y,v.shape,r,i,a,o)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function g$(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function YQ(e,t,n,r,i){H(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,o=t,s=!1;t.rank===4&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=o.shape[4];H(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),H(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),H(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),H(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),H(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=mx(a,n.shape,r,1,i),f=te.runKernelFunc(function(d){return d.conv3dDerInput(o,n,c)},{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var gA=ne({conv1d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NWC"),a===void 0&&(a=1);var s=U(e,"x","conv1d"),u=U(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),H(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),H(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),o!=null&&H(Wr(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),H(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),H(Fa(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),H(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Sg(d,f,[1,n],r,"NHWC",[1,a],o);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Sg=ne({conv2d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]);var s=U(e,"x","conv2d"),u=U(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),H(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),H(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),o!=null&&H(Wr(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1];H(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),H(Fa(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var d=eA(i),h=sh(l.shape,u.shape,n,a,r,o,!1,d),p=[u,l],g=te.runKernelFunc(function(m,v){var y=m.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(m,v){var y=v,b=y[0],x=y[1];return H(pg(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return ZQ(x.shape,m,b,n,r,i)},filter:function(){return m$(x,m,b.shape,n,r,i)}}},"Conv2D",h,p);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),mA=ne({conv3d_:function(e,t,n,r,i,a){i===void 0&&(i="NDHWC"),a===void 0&&(a=[1,1,1]);var o=U(e,"x","conv3d"),s=U(t,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),H(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),H(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),H(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),H(function(d,h){return g$(d)||g$(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),H(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=mx(u.shape,s.shape,n,a,r),f=te.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){H(g$(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],g=h[1];return{x:function(){return YQ(p.shape,d,g,n,r)},$filter:function(){return function(m,v,y,b,x){var w=m;m.rank===4&&(w=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),H(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),H(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),H(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),H(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),H(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var C=mx(w.shape,y,b,1,x);return te.runKernelFunc(function(_){return _.conv3dDerFilter(w,S,C)},{x5D:w,dy5D:S})}(p,d,g.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),m$=ne({conv2dDerFilter_:function(e,t,n,r,i,a,o){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),H(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),H(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),H(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];H(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),H(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),o!=null&&H(Wr(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=eA(a),d=sh(s.shape,n,r,1,i,o,!1,f);return te.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),ZQ=ne({conv2dDerInput_:XQ}),S0=ne({depthwiseConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]);var s=U(e,"x","depthwiseConv2d"),u=U(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),H(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),H(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),H(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),H(Fa(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&H(Wr(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=sh(l.shape,u.shape,n,a,r,o,!0),d=[l,u],h=te.runKernelFunc(function(p,g){var m=p.depthwiseConv2D(l,u,f);return g([l,u]),m},{x:l,filter:u},function(p,g){H(pg(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var m=g[0],v=g[1];return{x:function(){return JQ(m.shape,p,v,f)},filter:function(){return QQ(m,p,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),JQ=ne({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;t.rank===3&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=te.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),QQ=ne({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),te.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,a,r)},{x4D:i,dy4D:a})}}),v$=ne({separableConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC");var s=U(e,"x","separableConv2d"),u=U(t,"depthwiseFilter","separableConv2d"),l=U(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");H(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),H(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),H(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),H(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),H(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];H(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=S0(c,u,r,i,o,a),g=Sg(p,l,1,"valid",o);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),vA=ne({conv2dTranspose_:function(e,t,n,r,i,a){return XQ(n,U(e,"x","conv2dTranspose"),U(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),eee=ne({conv3dTranspose_:function(e,t,n,r,i){return YQ(n,U(e,"x","conv3dTranspose"),U(t,"filter","conv3dTranspose"),r,i)}}),yA=ne({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=U(e,"a","matMul"),o=U(t,"b","matMul");i=Mr(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=ft(f),p=ft(d);H(a.rank>=2&&o.rank>=2&&a.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."}),H(wi(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."}),H(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=a.shape.slice(0,-2).concat([l,c]),m=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?o.as3D(p,c,u):o.as3D(p,u,c),y={transposeA:n,transposeB:r};return te.runKernelFunc(function(b,x){var w=b.batchMatMul(m,v,n,r);return x([m,v]),w},{a:m,b:v},function(b,x){var w=x,S=w[0],C=w[1];return n||r?!n&&r?{a:function(){return b.matMul(C,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return C.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return C.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(C,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(g)}}),tee=ne({dot_:function(e,t){var n=U(e,"t1","dot"),r=U(t,"t2","dot");H(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return H(i===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),nee=ne({outerProduct_:function(e,t){var n=U(e,"v1","outerProduct"),r=U(t,"v2","outerProduct");return H(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),hc=ne({reverse_:function(e,t){var n=U(e,"x","reverse");if(n.rank===0)return n.clone();var r=_i(t,n.shape);return te.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),ree=ne({reverse1d_:function(e){var t=U(e,"x","reverse");return H(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),hc(t,0)}}),iee=ne({reverse2d_:function(e,t){var n=U(e,"x","reverse");return H(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),hc(n,t)}}),aee=ne({reverse3d_:function(e,t){var n=U(e,"x","reverse");return H(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),hc(n,t)}}),oee=ne({reverse4d_:function(e,t){var n=U(e,"x","reverse");return H(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),hc(n,t)}});function see(e,t,n,r,i,a){var o=U(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),r==null&&(r=[1,1]),H(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),H(Fa(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&H(Wr(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=oh(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&wi(l.inShape,l.outShape))return o.clone();var c=[s],f=te.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=U(m,"dy","maxPoolBackprop"),E=U(v,"input","maxPoolBackprop"),A=U(y,"output","maxPoolBackprop");H(E.rank===_.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+_.rank+")"}),w==null&&(w=[1,1]),H(Fa(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),H(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),H(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."}),C!=null&&H(Wr(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var k=oh(E.shape,b,x,w,S,C);return te.runKernelFunc(function(T){return T.maxPoolBackprop(_,E,A,k)},{$dy:_,$input:E})}(d,p,g,t,n,r,i)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function uee(e,t,n,r,i,a){var o=U(e,"x","avgPool","float32");r==null&&(r=[1,1]),H(Fa(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),H(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&H(Wr(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=oh(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&wi(l.inShape,l.outShape))return o.clone();var c=te.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,g,m,v){var y=U(d,"dy","avgPoolBackprop"),b=U(h,"input","avgPoolBackprop");H(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),m==null&&(m=[1,1]),H(Fa(g,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),H(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),H(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var C=oh(x.shape,p,g,m,v),_=te.runKernelFunc(function(E){return E.avgPoolBackprop(w,x,C)},{dy4D:w,input4D:x});return S?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var bA=ne({maxPool_:function(e,t,n,r,i){return see(e,t,n,1,r,i)}}),xA=ne({avgPool_:function(e,t,n,r,i){return uee(e,t,n,1,r,i)}}),lee=ne({pool_:function(e,t,n,r,i,a){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");var o=U(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),H(Fa(a,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"});var l,c=oh(s.shape,t,a,i,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(E,A){return E+(E-1)*(w[A]-1)}).map(function(E){return E-1}),C=S.map(function(E){return Math.floor(E/2)}),_=S.map(function(E,A){return E-C[A]});return S.map(function(E,A){return[C[A],_[A]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(x,w,S){var C=S.map(function(N){return N[0]}),_=S.map(function(N){return N[1]}),E=x.concat(C,_),A=w.map(function(N,O){return(N-E[O]%N)%N}),k=_.map(function(N,O){return N+A[O]}),T=w.map(function(N,O){return[C[O],k[O]]}),I=w.map(function(N,O){return[0,A[O]]});return[T,I]}([c.inHeight,c.inWidth],f,l),p=h[0],g=h[1],m=d?r:"valid",v=d?s:BC(s,f,p),y=(n==="avg"?function(){return uee(v,t,a,1,m)}:function(){return see(v,t,a,1,m)})(),b=d?y:$C(y,f,g);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),wA=ne({maxPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=U(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),H(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),H(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),H(Fa(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&H(Wr(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=gx(u.shape,t,n,o,r,i,a),f=te.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=U(m,"dy","maxPool3dBackprop"),E=U(v,"input","maxPool3dBackprop"),A=U(y,"output","maxPool3dBackprop"),k=_,T=E,I=A,N=!1;E.rank===4&&(N=!0,k=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),I=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),H(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),H(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),H(I.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+I.rank+"."}),w==null&&(w=[1,1,1]),H(Fa(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),C!=null&&H(Wr(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var O=gx(T.shape,b,x,w,S,C),D=te.runKernelFunc(function(P){return P.maxPool3dBackprop(k,T,I,O)},{dy5D:k,input5D:T});return N?D.as4D(D.shape[1],D.shape[2],D.shape[3],D.shape[4]):D}(d,p,g,t,n,o,r,i)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),_A=ne({avgPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=U(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),H(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),H(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),H(Fa(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&H(Wr(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=gx(u.shape,t,n,o,r,i,a),f=te.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,g,m,v,y,b){var x=U(h,"dy","avgPool3dBackprop"),w=U(p,"input","avgPool3dBackprop"),S=x,C=w,_=!1;w.rank===4&&(_=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),H(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),H(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),v==null&&(v=[1,1,1]),H(Fa(m,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"}),b!=null&&H(Wr(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=gx(C.shape,g,m,v,y,b),A=te.runKernelFunc(function(k){return k.avgPool3dBackprop(S,C,E)},{dy5D:S,input5D:C});return _?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}(d,u,t,n,o,r,i)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),y$=ne({maxPoolWithArgmax_:function(e,t,n,r,i){i===void 0&&(i=!1);var a=U(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=te.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Is=ne({slice_:function(e,t,n){var r,i,a=U(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){H(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(H(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),xJ(a,r,i);var o=a.shape,s={begin:r,size:i};return te.runKernelFunc(function(u){return u.slice(a,r,i)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return dc(u,l)}}},"Slice",s)}}),Sx=ne({slice1d_:function(e,t,n){var r=U(e,"x","slice1d");return H(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Is(r,[t],[n])}}),SA=ne({slice2d_:function(e,t,n){var r=U(e,"x","slice2d");return H(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Is(r,t,n)}}),Ex=ne({slice3d_:function(e,t,n){var r=U(e,"x","slice3d");return H(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Is(r,t,n)}}),E0=ne({slice4d_:function(e,t,n){var r=U(e,"x","slice4d");return H(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Is(r,t,n)}});function cee(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(oo(t.shape,r))),e.rank<n.rank&&(e=e.reshape(oo(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return i==null?a:a.transpose(i)}}}var EA=ne({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","all","bool"),i=_i(t,r.shape),a=i,o=Ju(a,r.rank);o!=null&&(r=r.transpose(o),a=Qu(a.length,r.rank));var s=te.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=oo(s.shape,i);return s.reshape(u)}return s}}),Cx=ne({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","any","bool"),i=_i(t,r.shape),a=i,o=Ju(a,r.rank);o!=null&&(r=r.transpose(o),a=Qu(a.length,r.rank));var s=te.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=oo(s.shape,i);return s.reshape(u)}return s}}),Ax=ne({argMax_:function(e,t){t===void 0&&(t=0);var n=U(e,"x","argMax");t==null&&(t=0);var r=_i(t,n.shape),i=Ju(r,n.rank);i!=null&&(n=n.transpose(i),r=Qu(r.length,n.rank));var a={axis:r[0]},o=[n];return te.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return wn(l)}}},"ArgMax",a,o)}}),b$=ne({argMin_:function(e,t){t===void 0&&(t=0);var n=U(e,"x","argMin");t==null&&(t=0);var r=_i(t,n.shape),i=Ju(r,n.rank);return i!=null&&(n=n.transpose(i),r=Qu(r.length,n.rank)),te.runKernelFunc(function(a,o){var s=a.argMin(n,r[0]);return o([n]),s},{$x:n},function(a,o){var s=o[0];return{$x:function(){return wn(s)}}})}}),fee=ne({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","logSumExp"),i=_i(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=oo(s.shape,i);return s.reshape(u)}return s}}),uh=ne({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","max"),i=r,a=_i(t,r.shape),o=a,s=Ju(o,r.rank);s!=null&&(r=r.transpose(s),o=Qu(o.length,r.rank));var u=[r],l=te.runKernelFunc(function(f,d){var h=f.max(r,o);return d([i,h]),h},{x:r},function(f,d){return cee(f,d[1],d[0],a,s)},"Max",{axes:o},u,[!0]);if(n){var c=oo(l.shape,a);l=l.reshape(c)}return l}}),di=ne({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","mean"),i=_i(t,r.shape),a=ft(va(r.shape,i)[1]);return px(function(o){var s=rt(a);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=o.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(uc(o.shape,"float32")).div(a)}}})(r)}}),CA=ne({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","min"),i=r,a=_i(t,r.shape),o=a,s=Ju(o,r.rank);s!=null&&(r=r.transpose(s),o=Qu(o.length,r.rank));var u=[r],l=te.runKernelFunc(function(f,d){var h=f.min(r,o);return d([i,h]),h},{x:r},function(f,d){return cee(f,d[1],d[0],a,s)},"Min",{axes:o},u,[!0]);if(n){var c=oo(l.shape,a);l=l.reshape(c)}return l}}),kx=ne({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=_i(t,(e=U(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=oo(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),Ei=ne({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=_i(t,r.shape);return px(function(a){var o=Ju(i,a.rank),s=i,u=a;o!=null&&(u=a.transpose(o),s=Qu(s.length,a.rank));var l=function(h){var p=a.shape.slice();return i.forEach(function(g){p[g]=1}),h.reshape(p).mul(uc(a.shape,"float32"))},c={axes:s},f=te.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=oo(f.shape,i);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),AA=ne({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=U(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=_i(t,r.shape),a=Ju(i,r.rank),o=i,s=r;a!=null&&(s=r.transpose(a),o=Qu(o.length,r.rank));var u=te.runKernelFunc(function(c){return c.prod(s,o)},{permutedX:s});if(n){var l=oo(u.shape,i);u=u.reshape(l)}return u}}),C0=ne({elu_:function(e){var t=U(e,"x","elu");return te.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return te.runKernelFunc(function(a){return a.eluDer(n,i)},{dy:n,y:i})}}})}}),kA=ne({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=U(e,"x","leakyRelu");return lc(rt(t).mul(n),n)}}),Tx=ne({prelu_:function(e,t){var n=U(e,"x","prelu"),r=U(t,"alpha","prelu");return te.runKernelFunc(function(i,a){var o=i.prelu(n,r);return a([n,r]),o},{x:n,alpha:r},function(i,a){var o=a[0],s=a[1],u=o.greater(0);return{x:function(){return nl(u,i,i.mul(s))},alpha:function(){var l=nl(u,wn(i),i.mul(o)),c=Si(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),lh=ne({relu_:function(e){var t=U(e,"x","relu");return t.dtype==="bool"?t.toInt():te.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),x$=ne({relu6_:function(e){var t=U(e,"x","relu6");return t.dtype==="bool"?t.toInt():te.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],a=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),TA=ne({selu_:function(e){var t=U(e,"x","selu");return te.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var a=i.greater(rt(0)),o=rt(JP),s=rt(QP),u=n.mul(s),l=n.mul(o).mul(i.toFloat().exp());return nl(a,u,l)}}})}}),w$=ne({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var a=U(e,"x","localResponseNormalization");H(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),H(Wr(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=a,s=!1;a.rank===3&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=te.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(o,t,n,r,i);return c([o,f]),f},{x4D:o},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return te.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_$=ne({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(rt(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=U(e,"x","norm"),t,n),a=i.shape;if(r){var o=_i(n,e.shape);a=oo(i.shape,o)}return i.reshape(a)}}),dee=ne({basicLSTMCell_:function(e,t,n,r,i,a){var o=U(e,"forgetBias","basicLSTMCell"),s=U(t,"lstmKernel","basicLSTMCell"),u=U(n,"lstmBias","basicLSTMCell"),l=U(r,"data","basicLSTMCell"),c=U(i,"c","basicLSTMCell"),f=U(a,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,g=[h,p],m=d.slice([0,0],g),v=d.slice([0,p],g),y=d.slice([0,2*p],g),b=d.slice([0,3*p],g),x=m.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),hee=ne({multiRNNCell_:function(e,t,n,r){for(var i=U(t,"data","multiRNNCell"),a=sx(n,"c","multiRNNCell"),o=sx(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),pee=ne({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var a=U(e,"v","movingAverage"),o=U(t,"x","movingAverage"),s=U(n,"decay","movingAverage");wZ(a,o),H(wi(a.shape,o.shape),function(){return"Shape mismatch in v and x"});var u=rt(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){H(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=U(r,"step","movingAverage");c=c.div(u.sub(p0(s,f)))}return a.add(c)}}),S$=ne({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=U(e,"x","stridedSlice"),c=RP(s),f=l.shape.slice();c.forEach(function(m){t[m]=0,n[m]=1,f.splice(m,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=wJ(i,t,r,l.shape,d),n[d]=_J(a,n,r,l.shape,d),r[d]=r[d]||1;var h=RP(u);h.forEach(function(m){n[m]=t[m]+1,r[m]=1});var p=YC(t,n,r),g=p.filter(function(m,v){return h.indexOf(v)===-1});return r.every(function(m){return m===1})?Is(l,t,p).reshape(g):te.runKernelFunc(function(m){return m.stridedSlice(l,t,n,r)},{$x:l}).reshape(g)}}),E$=ne({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=U(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=te.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),C$=ne({scatterND_:function(e,t,n){var r=U(e,"indices","scatterND","int32"),i=U(t,"updates","scatterND");return bJ(i,r,n),te.runKernelFunc(function(a){return a.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Ox=ne({fft_:function(e){H(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return te.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),A0=ne({ifft_:function(e){H(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return te.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),Ix=ne({rfft_:function(e,t){H(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),o=e.shape.map(function(v){return v});o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Kn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=$i(n,u).as2D(i,r),c=Ox(l),f=Math.floor(r/2)+1,d=qo(c),h=uu(c),p=d.split([f,r-f],d.shape.length-1),g=h.split([f,r-f],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,$i(p[0],g[0]).reshape(m)}}),OA=ne({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=A0(r);return qo(i)}var a=[n,2*(t-1)],o=qo(e).as2D(n,t),s=uu(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(rt(-1)),c=o.concat(u,1),f=s.concat(l,1);return r=$i(c,f).as2D(a[0],a[1]),i=A0(r),qo(i)}}),gee=Object.freeze({fft:Ox,ifft:A0,rfft:Ix,irfft:OA}),IA=ne({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=U(e,"sparseIndices","sparseToDense","int32"),a=U(t,"sparseValues","sparseToDense"),o=U(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),te.runKernelFunc(function(s){return s.sparseToDense(i,a,n,o)},{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),A$=ne({gatherND_:function(e,t){var n=U(t,"indices","gatherND","int32"),r=U(e,"x","gatherND");return te.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),mee=ne({diag_:function(e){var t=U(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return te.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),k$=ne({dropout_:function(e,t,n,r){var i=U(e,"x","dropout");if(H(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),H(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof fn?i.clone():i;var a=function(u,l){if(l==null)return u.shape.slice();if(wi(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(i,n),o=1-t,s=wg(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function vee(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return so(i,"float32")}var NA=ne({hannWindow_:function(e){return vee(e,.5,.5)}}),T$=ne({hammingWindow_:function(e){return vee(e,.54,.46)}}),DA=ne({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Is(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Ra([Is(e,a,t-s),f0([s],i)]);o.push(u),a+=n}return o.length===0?sc([],[0,t]):Ra(o).as2D(o.length,t)}}),O$=ne({stft_:function(e,t,n,r,i){var a;i===void 0&&(i=NA),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=DA(e,t,n),s=pt(o,i(t)),u=[],l=0;l<o.shape[0];l++)u.push(Ix(s.slice([l,0],[1,t]),r));return Ra(u)}}),yee=Object.freeze({hannWindow:NA,hammingWindow:T$,frame:DA,stft:O$}),ya,bee=function(e,t,n){return n===void 0&&(n=1),dt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m;return ht(this,function(v){switch(v.label){case 0:return r=U(e,"predictions","inTopK"),i=U(t,"targets","inTopK"),H(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),H(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),On(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],H(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[o.length/a,a],c=u[1],f=cg("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=o.subarray(h,h+c),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(y,b){return b.value-y.value}),f[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,fi(f,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ya||(ya={}));var rze=ne({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=ya.SUM_BY_NONZERO_WEIGHTS);var i=U(e,"labels","absoluteDifference"),a=U(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=U(n,"weights","absoluteDifference")),On(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return Ff(s,o,r)}}),Ff=ne({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=ya.SUM_BY_NONZERO_WEIGHTS);var r=U(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=U(t,"weights","computeWeightedLoss"));var a=i==null?r:r.mul(i);if(n===ya.NONE)return a;if(n===ya.SUM)return a.sum();if(n===ya.MEAN){if(i==null)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(rt(o)):s}if(n===ya.SUM_BY_NONZERO_WEIGHTS){if(i==null)return a.sum().div(rt(r.size));var u=i.mul(uc(r.shape)).notEqual(rt(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),ize=ne({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=ya.SUM_BY_NONZERO_WEIGHTS);var a=U(e,"labels","cosineDistance"),o=U(t,"predictions","cosineDistance"),s=null;r!=null&&(s=U(r,"weights","cosineDistance")),On(a.shape,o.shape,"Error in cosineDistance: ");var u=rt(1).sub(a.mul(o).sum(n,!0));return Ff(u,s,i)}}),aze=ne({hingeLoss_:function(e,t,n,r){r===void 0&&(r=ya.SUM_BY_NONZERO_WEIGHTS);var i=U(e,"labels","hingeLoss"),a=U(t,"predictions","hingeLoss"),o=null;n!=null&&(o=U(n,"weights","hingeLoss")),On(i.shape,a.shape,"Error in hingeLoss: ");var s=rt(1);i=rt(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return Ff(u,o,r)}}),oze=ne({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=ya.SUM_BY_NONZERO_WEIGHTS);var a=U(e,"labels","huberLoss"),o=U(t,"predictions","huberLoss"),s=null;n!=null&&(s=U(n,"weights","huberLoss")),On(a.shape,o.shape,"Error in huberLoss: ");var u=rt(r),l=o.sub(a).abs(),c=h0(l,u),f=l.sub(c),d=rt(.5).mul(c.square()).add(u.mul(f));return Ff(d,s,i)}}),sze=ne({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=ya.SUM_BY_NONZERO_WEIGHTS);var a=U(e,"labels","logLoss"),o=U(t,"predictions","logLoss"),s=null;n!=null&&(s=U(n,"weights","logLoss")),On(a.shape,o.shape,"Error in logLoss: ");var u=rt(1),l=rt(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return Ff(c,s,i)}}),uze=ne({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=ya.SUM_BY_NONZERO_WEIGHTS);var i=U(e,"labels","meanSquaredError"),a=U(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=U(n,"weights","meanSquaredError")),On(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return Ff(s,o,r)}}),lze=ne({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=ya.SUM_BY_NONZERO_WEIGHTS);var a=U(e,"multiClassLabels","sigmoidCrossEntropy"),o=U(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=U(n,"weights","sigmoidCrossEntropy")),On(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=rt(r),l=rt(1),c=rt(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=U(d,"labels","sigmoidCrossEntropyWithLogits"),g=U(h,"logits","sigmoidCrossEntropyWithLogits");On(p.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=g.relu(),v=g.mul(p),y=g.abs().neg().exp().log1p();return m.sub(v).add(y)}(a,o);return Ff(f,s,i)}}),cze=ne({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=ya.SUM_BY_NONZERO_WEIGHTS);var a=U(e,"onehotLabels","softmaxCrossEntropy"),o=U(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=U(n,"weights","softmaxCrossEntropy")),On(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=rt(r),l=rt(1),c=rt(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return px(function(g,m,v){var y=m.logSumExp([p],!0),b=m.toFloat().sub(y);return v([g,b]),{value:b.mul(g).neg().sum([p]),gradFunc:function(x,w){var S=w[0],C=w[1],_=oo(x.shape,[p]);return[x.reshape(_).mul(S.toFloat().sub(C.exp())),x.reshape(_).mul(C.exp().sub(S.toFloat()))]}}})(d,h)}(a,o);return Ff(f,s,i)}}),xee=Object.freeze({get Reduction(){return ya},absoluteDifference:rze,computeWeightedLoss:Ff,cosineDistance:ize,hingeLoss:aze,huberLoss:oze,logLoss:sze,meanSquaredError:uze,sigmoidCrossEntropy:lze,softmaxCrossEntropy:cze});function wee(e,t){return t===void 0&&(t=!1),te.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=dA(n),a=e.clone(),o=sc([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(f){var d,h=a,p=s,g=i;d=te.tidy(function(){var m=a.slice([f,f],[n-f,1]),v=m.norm(),y=a.slice([f,f],[1,1]),b=sc([[-1]]).where(y.greater(0),sc([[1]])),x=y.sub(b.mul(v)),w=m.div(x);s=w.shape[0]===1?o.clone():o.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),C=a.slice([f,0],[n-f,r]),_=S.mul(s),E=s.transpose();if(f===0)a=C.sub(_.matMul(E.matMul(C)));else{var A=C.sub(_.matMul(E.matMul(C)));a=a.slice([0,0],[f,r]).concat(A,0)}var k=_.transpose(),T=i.slice([0,f],[n,i.shape[1]-f]);if(f===0)i=T.sub(T.matMul(s).matMul(k));else{var I=T.sub(T.matMul(s).matMul(k));i=i.slice([0,0],[n,f]).concat(I,1)}return[s,a,i]}),s=d[0],a=d[1],i=d[2],sn([h,p,g])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}var fze=ne({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=U(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=d0(0,o,1,"int32").reshape([-1,1]),l=d0(0,s,1,"int32"),c=Qr(u,l),f=fc(c.lessEqual(rt(+t,"int32")),c.greaterEqual(rt(-n,"int32"))),d=Kn([o,s],r.dtype);return lu(rh(r.reshape([-1,o,s])).map(function(h){return nl(f,h,d)})).reshape(i)}}),dze=ne({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,H(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){H(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=If(e,e.shape[0],0).map(function(u){return ux(u,[0])});H(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],o=e,s=function(u){a.push(te.tidy(function(){var l=o[u];if(u>0)for(var c=0;c<u;++c){var f=Ei(a[c].mulStrict(l)).mul(a[c]);l=l.sub(f)}return l.div(_$(l,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?lu(a,0):a}}),hze=ne({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return wee(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,s){return o*s}),r=rh(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(function(o){var s=wee(o,t),u=s[0],l=s[1];i.push(u),a.push(l)}),[lu(i,0).reshape(e.shape),lu(a,0).reshape(e.shape)]}}),I$=Object.freeze({bandPart:fze,gramSchmidt:dze,qr:hze});function RA(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);var o=e.shape[0];return n=Math.min(n,o),H(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),H(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),H(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),H(t.rank===1,function(){return"scores must be a 1D tensor"}),H(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),H(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var pze=ne({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=U(e,"images","resizeBilinear");H(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),H(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=te.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,o,s,n)},{x:i},function(l,c){return{x:function(){return te.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),gze=ne({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=U(e,"images","resizeNearestNeighbor");H(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),H(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),H(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=te.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,o,s,n)},{batchImages:i},function(l,c){return{batchImages:function(){return te.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),mze=ne({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var a=U(e,"boxes","nonMaxSuppression"),o=U(t,"scores","nonMaxSuppression"),s=RA(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return te.runKernelFunc(function(l){return l.nonMaxSuppression(a,o,n,r,i)},{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),vze=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),dt(this,void 0,void 0,function(){var a,o,s,u,l,c,f;return ht(this,function(d){switch(d.label){case 0:return a=U(e,"boxes","nonMaxSuppressionAsync"),o=U(t,"scores","nonMaxSuppressionAsync"),s=RA(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=WP(l,c,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,f]}})})},yze=ne({nonMaxSuppressionWithScore_:function(e,t,n,r,i,a){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var o=U(e,"boxes","nonMaxSuppression"),s=U(t,"scores","nonMaxSuppression"),u=RA(o,s,n,r,i,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=te.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),bze=function(e,t,n,r,i,a){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),dt(this,void 0,void 0,function(){var o,s,u,l,c,f,d;return ht(this,function(h){switch(h.label){case 0:return o=U(e,"boxes","nonMaxSuppressionAsync"),s=U(t,"scores","nonMaxSuppressionAsync"),u=RA(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=VP(c,f,n,r,i,a),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},xze=ne({cropAndResize_:function(e,t,n,r,i,a){var o=U(e,"image","cropAndResize"),s=U(t,"boxes","cropAndResize","float32"),u=U(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return H(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),H(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),H(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),H(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),H(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),H(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),te.runKernelFunc(function(c,f){return c.cropAndResize(o,s,u,r,i,a)},{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),ch=Object.freeze({resizeBilinear:pze,resizeNearestNeighbor:gze,nonMaxSuppression:mze,nonMaxSuppressionAsync:vze,nonMaxSuppressionWithScore:yze,nonMaxSuppressionWithScoreAsync:bze,cropAndResize:xze}),N$=function(e,t){return!(e>0)||t==="linear"},D$=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},R$=function(e,t){var n=t,r=Si(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},F$=function(e,t,n){if(t==="linear")return e;if(t==="relu")return lh(e);if(t==="elu")return C0(e);if(t==="relu6")return x$(e);if(t==="prelu")return Tx(e,n);throw new Error("Unknown fused activation "+t+".")},wze=ne({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=i!==void 0&&i,o=e.transposeB,s=o!==void 0&&o,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(N$(te.state.gradientDepth,c)===!1){var d=yA(n,r,a,s);return u!=null&&(d=un(d,u)),F$(d,c,f)}var h=U(n,"a","fused matMul"),p=U(r,"b","fused matMul");t=Mr(h,p),h=t[0],p=t[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),w=ft(b),S=ft(x);H(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),H(wi(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),H(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var C,_,E=h.shape.slice(0,-2).concat([v,y]),A=a?h.as3D(w,g,v):h.as3D(w,v,g),k=s?p.as3D(S,y,m):p.as3D(S,m,y);u!=null&&vn(E,(C=Mr(C=U(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=U(f,"prelu weights","fused matMul"));var T={a:A,b:k};u!=null&&(T.bias=C),f!=null&&(T.preluActivationWeights=_);var I=[A,k];return te.runKernelFunc(function(N,O){var D=N.fusedBatchMatMul({a:A,b:k,transposeA:a,transposeB:s,bias:C,activation:c,preluActivationWeights:_});return O([A,k,D]),D},T,function(N,O){var D=O[0],P=O[1],V=O[2],Y=D$(N,V,c),X={};return u!=null&&(X={bias:function(){return R$(C,Y)}}),Object.assign(a||s?!a&&s?{a:function(){return Y.matMul(P,!1,!1)},b:function(){return Y.matMul(D,!0,!1)}}:a&&!s?{a:function(){return P.matMul(Y,!1,!0)},b:function(){return D.matMul(Y,!1,!1)}}:{a:function(){return P.matMul(Y,!0,!0)},b:function(){return Y.matMul(D,!0,!0)}}:{a:function(){return Y.matMul(P,!1,!0)},b:function(){return D.matMul(Y,!0,!1)}},X)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},I,[!0]).reshape(E)}}),_ze=ne({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",N$(te.state.gradientDepth,d)===!1){var p=Sg(t,n,r,i,o,u,l);return c!=null&&(p=un(p,c)),F$(p,d,h)}var g=U(t,"x","conv2d"),m=U(n,"filter","conv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),H(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),H(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&H(Wr(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),H(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),H(Fa(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),H(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,w=sh(v.shape,m.shape,r,u,i,l);c!=null&&(b=Mr(b=U(c,"bias","fused conv2d"),g)[0],vn(w.outShape,b.shape)),h!=null&&(x=U(h,"prelu weights","fused conv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=te.runKernelFunc(function(E,A){var k=E.fusedConv2d({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){var k=A,T=k[0],I=k[1],N=k[2],O=D$(E,N,d);H(pg(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var D={};return c!=null&&(D={bias:function(){return R$(b,O)}}),Object.assign({x:function(){return ZQ(I.shape,O,T,r,i)},filter:function(){return m$(I,O,T.shape,r,i)}},D)},"FusedConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Sze=ne({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(N$(te.state.gradientDepth,d)===!1){var p=S0(t,n,r,i,o,u,l);return c!=null&&(p=un(p,c)),F$(p,d,h)}var g=U(t,"x","depthwiseConv2d"),m=U(n,"filter","depthwiseConv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),H(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),H(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),H(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),H(Fa(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&H(Wr(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=sh(v.shape,m.shape,r,u,i,l,!0);c!=null&&(b=Mr(b=U(c,"bias","fused conv2d"),g)[0],vn(w.outShape,b.shape)),h!=null&&(x=U(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=te.runKernelFunc(function(E,A){var k=E.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){H(pg(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=A[0],T=A[1],I=A[2],N=D$(E,I,d),O={};return c!=null&&(O={bias:function(){return R$(b,N)}}),Object.assign({x:function(){return JQ(T.shape,N,k,w)},filter:function(){return QQ(T,N,k.shape,w)}},O)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),fh=Object.freeze({matMul:wze,conv2d:_ze,depthwiseConv2d:Sze}),Eze=Object.freeze({image:ch,linalg:I$,losses:xee,spectral:gee,fused:fh,signal:yee,add:un,addN:e$,batchNorm:bg,batchNormalization:EQ,batchNorm2d:t$,batchNormalization2d:AQ,batchNorm3d:n$,batchNormalization3d:TQ,batchNorm4d:r$,batchNormalization4d:IQ,broadcastTo:i$,clone:NQ,div:ei,divNoNan:fA,eye:dA,multinomial:o$,oneHot:xg,pad:dc,pad1d:RQ,pad2d:FQ,pad3d:MQ,pad4d:PQ,rand:$Q,randomGamma:BQ,randomNormal:f$,randomUniform:wg,square:hA,squaredDifference:pA,tile:Rf,truncatedNormal:wx,conv1d:gA,conv2d:Sg,conv3d:mA,depthwiseConv2d:S0,separableConv2d:v$,conv2dTranspose:vA,conv3dTranspose:eee,op:ne,booleanMaskAsync:KQ,complex:$i,real:qo,imag:uu,concat:Ra,concat1d:JM,concat2d:QM,concat3d:eP,concat4d:tP,split:If,matMul:yA,dot:tee,outerProduct:nee,reverse:hc,reverse1d:ree,reverse2d:iee,reverse3d:aee,reverse4d:oee,maxPool:bA,avgPool:xA,pool:lee,maxPool3d:wA,avgPool3d:_A,maxPoolWithArgmax:y$,slice:Is,slice1d:Sx,slice2d:SA,slice3d:Ex,slice4d:E0,abs:ih,acos:cP,acosh:fP,asin:dP,asinh:hP,atan:pP,atanh:gP,ceil:mP,clipByValue:uo,cos:vP,cosh:yP,erf:bP,exp:xP,expm1:wP,floor:WC,log:Df,log1p:_P,logSigmoid:aJ,neg:ah,reciprocal:SP,round:EP,rsqrt:VC,sigmoid:qC,sign:CP,isNaN:oJ,isInf:sJ,isFinite:uJ,sin:AP,sinh:kP,softplus:fx,sqrt:dx,step:lJ,tan:TP,tanh:HC,all:EA,any:Cx,argMax:Ax,argMin:b$,logSumExp:fee,max:uh,mean:di,min:CA,moments:kx,sum:Ei,prod:AA,equal:_g,equalStrict:zQ,greater:x0,greaterEqual:_x,greaterEqualStrict:jQ,greaterStrict:UQ,less:d$,lessEqual:h$,lessEqualStrict:WQ,lessStrict:VQ,notEqual:w0,notEqualStrict:qQ,addStrict:cJ,atan2:OP,divStrict:fJ,floorDiv:GC,maximum:lc,maximumStrict:dJ,minimum:h0,minimumStrict:hJ,mod:IP,modStrict:pJ,mul:pt,mulStrict:KC,pow:p0,powStrict:gJ,squaredDifferenceStrict:mJ,sub:Qr,subStrict:vJ,elu:C0,leakyRelu:kA,prelu:Tx,relu:lh,relu6:x$,selu:TA,logicalAnd:fc,logicalNot:a$,logicalOr:lA,logicalXor:DQ,where:nl,whereAsync:cA,buffer:Ht,print:tJ,batchToSpaceND:$C,cast:LC,cumsum:nJ,depthToSpace:nP,expandDims:Os,reshape:el,spaceToBatchND:BC,squeeze:ux,stack:lu,unstack:rh,setdiff1dAsync:rP,fill:f0,linspace:ZM,ones:uc,range:d0,scalar:rt,tensor:fi,tensor1d:so,tensor2d:sc,tensor3d:PC,tensor4d:nh,tensor5d:QZ,tensor6d:eJ,variable:YM,zeros:Kn,onesLike:Ts,zerosLike:wn,transpose:In,softmax:hg,logSoftmax:JC,localResponseNormalization:w$,norm:_$,gather:_0,unsortedSegmentSum:p$,basicLSTMCell:dee,multiRNNCell:hee,movingAverage:pee,stridedSlice:S$,topk:E$,scatterND:C$,fft:Ox,ifft:A0,rfft:Ix,irfft:OA,sparseToDense:IA,gatherND:A$,diag:mee,dropout:k$,hannWindow:NA,hammingWindow:T$,frame:DA,stft:O$,inTopKAsync:bee});function Be(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&H(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function M$(e,t,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ht(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],x=0;x<i.batchSize;++x)for(var w=x*v,S=x*r[0],C=0;C<i.inChannels;++C)for(var _=0;_<i.outHeight;++_)for(var E=_*o-d,A=Math.max(0,E),k=Math.min(i.inHeight,c+E),T=w+_*y,I=0;I<i.outWidth;++I){for(var N=I*s-h,O=Math.max(0,N),D=Math.min(i.inWidth,f+N),P=p,V=0,Y=0,X=A;X<k;X+=u){for(var Q=S+X*r[1],me=O;me<D;me+=l){var ce=e[Q+me*r[2]+C];a==="max"&&ce>P?P=ce:a==="avg"&&(V+=ce,Y++)}if(isNaN(P))break}m[T+I*b+C]=a==="avg"?V/Y:P}return g}function _ee(e,t,n,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);for(var o=Ht(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Ht(t,n,e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=l;for(var w=Math.min(r.inHeight,f+b),S=0;S<r.outWidth;++S){for(var C=S*u-p,_=C;_<0;)_+=c;for(var E=Math.min(r.inWidth,d+C),A=Number.NEGATIVE_INFINITY,k=-1,T=x;T<w;T+=l)for(var I=T-b,N=_;N<E;N+=c){var O=N-C,D=g.get(m,T,N,v);D>A&&(A=D,k=i?a?((m*r.inHeight+T)*r.inWidth+N)*r.inChannels+v:(T*r.inWidth+N)*r.inChannels+v:I*d+O)}o.set(k,m,y,S,v)}}return o}function P$(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Cze=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new PP(n,te),n}return Yu(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,we().get("IS_NODE")&&FC(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:i}),a},t.prototype.move=function(n,r,i,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,a=r.complexTensors;return i==="complex64"?UP(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(a){return K1(a)})}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ht(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var a=this.write(n,r,i);return te.makeTensorFromDataId(a,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return dt(this,void 0,void 0,function(){var r;return ht(this,function(i){return r=Zu(),n(),[2,{kernelMs:Zu()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:te.keep(n.clone()),imag:te.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(Be(n,"slice"),FP(n.shape,r,i)){var a=MP(r,n.strides),o=ft(i);return fi(this.readSync(n.dataId).subarray(a,a+o),i,n.dtype)}for(var s=Ht(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,a){Be(n,"stridedSlice");var o=YC(r,i,a);if(o.some(function(h){return h===0}))return fi([],o);for(var s=Ht(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*a[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=Ht([n.size,n.size],n.dtype),a=i.values,o=0;o<r.length;o++)a[o*n.size+o]=r[o];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){Be(n,"reverse");for(var i=Ht(n.shape,n.dtype),a=this.bufferSync(n),o=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),i.set.apply(i,[a.get.apply(a,c)].concat(l))},s=0;s<i.size;s++)o(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return qo(h)}),o=n.map(function(h){return uu(h)});return $i(this.concat(a,r),this.concat(o,r))}var s=n.map(function(h){var p=ft(h.shape.slice(r));return h.as2D(-1,p)}),u=dg(s.map(function(h){return h.shape}),1),l=Ht(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(i.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),g=0,m=0;m<h.shape[0];++m)for(var v=m*u[1]+f,y=0;y<h.shape[1];++y)l[v+y]=p[g++];f+=h.shape[1]})}var d=dg(n.map(function(h){return h.shape}),r);return fi(l,d,n[0].dtype)},t.prototype.neg=function(n){return Be(n,"neg"),this.multiply(rt(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i+o,imag:a+s}}):this.broadcastedBinaryOp(n,r,na(n.dtype,r.dtype),function(i,a){return i+a})},t.prototype.addN=function(n){var r=this;Be(n,"addN");for(var i=n.map(function(c){return r.readSync(c.dataId)}),a=Ht(n[0].shape,n[0].dtype),o=a.values,s=0;s<n.length;s++)for(var u=i[s],l=0;l<o.length;l++)o[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var i=_i([r],n.shape),a=this.max(n,i),o=oo(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return ei(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i-o,imag:a-s}}):this.broadcastedBinaryOp(n,r,na(n.dtype,r.dtype),function(i,a){return i-a})},t.prototype.pow=function(n,r){return Be([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.pow(i,a)})},t.prototype.batchMatMul=function(n,r,i,a){Be([n,r],"matMul");for(var o=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],g=d[2],m=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=m[0],y=m[1],b=m[2],x=s*u,w=Ht([l,s,u],n.dtype),S=w.values,C=this.blockSize,_=0;_<l;_++)for(var E=0;E<s;E+=C)for(var A=0;A<u;A+=C)for(var k=0;k<o;k+=C)for(var T=Math.min(E+C,s),I=Math.min(A+C,u),N=Math.min(k+C,o),O=E;O<T;O++)for(var D=A;D<I;D++){for(var P=0,V=k;V<N;V++)P+=c[_*h+O*p+V*g]*f[V*v+D*y+_*b];S[_*x+(O*u+D)]+=P}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,i,a,o);return s&&(c=this.add(c,s)),u&&(c=P$(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i*o-a*s,imag:i*s+a*o}}):this.broadcastedBinaryOp(n,r,na(n.dtype,r.dtype),function(i,a){return i*a})},t.prototype.floorDiv=function(n,r){return Be([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,a){return Math.floor(i/a)})},t.prototype.sum=function(n,r){Be(n,"sum"),Vo("sum",r,n.rank);for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,na(n.dtype,"int32")),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){Be(n,"sum");for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,na(n.dtype,"int32")),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){Be(n,"unsortedSegmentSum");for(var a=[],o=n.rank-r.rank,s=0;s<o;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=rt(s,"int32"),l=_g(u,r).asType("float32").mul(n).sum(0);a.push(l)}return lu(a)},t.prototype.argMin=function(n,r){Be(n,"argMin");var i=[r];Vo("argMin",i,n.rank);for(var a=va(n.shape,i),o=a[0],s=a[1],u=Kn(o,"int32"),l=ft(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v<p&&(p=v,g=m)}c[d]=g}return u},t.prototype.argMax=function(n,r){Be(n,"argMax");var i=[r];Vo("argMax",i,n.rank);for(var a=va(n.shape,i),o=a[0],s=a[1],u=Kn(o,"int32"),l=ft(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v>p&&(p=v,g=m)}c[d]=g}return u},t.prototype.cumsum=function(n,r,i,a){if(Be(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=na(n.dtype,"int32"),s=Kn(n.shape,o),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=a?function(m,v){return m+c-v-1}:function(m,v){return m+v},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=i?0:l[p];else{var g=f(d,h-1);u[p]=i?l[g]+u[g]:l[p]+u[g]}}return s},t.prototype.equal=function(n,r){return Be([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i===a?1:0})},t.prototype.notEqual=function(n,r){return Be([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i!==a?1:0})},t.prototype.less=function(n,r){return Be([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<a?1:0})},t.prototype.lessEqual=function(n,r){return Be([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<=a?1:0})},t.prototype.greater=function(n,r){return Be([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>a?1:0})},t.prototype.greaterEqual=function(n,r){return Be([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>=a?1:0})},t.prototype.logicalNot=function(n){Be(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)i[a]=r[a]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return Be([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i&&a})},t.prototype.logicalOr=function(n,r){return Be([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i||a})},t.prototype.select=function(n,r,i){Be([n,r,i],"select");for(var a=this.readSync(n.dataId),o=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Kn(r.shape,na(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:ft(r.shape.slice(1)),d=0;d<a.length;d++)for(var h=0;h<f;h++)a[d]===1?l[c++]=o[d]:l[c++]=s[d];return u},t.prototype.where=function(n){Be([n],"where");var r=this.readSync(n.dataId);return qP(n.shape,r)},t.prototype.topk=function(n,r,i){return Be(n,"topk"),OJ(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Be(n,"min"),Vo("min",r,n.rank);for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,n.dtype),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g<h&&(h=g)}l[f]=h}return s},t.prototype.minimum=function(n,r){return Be([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.min(i,a)})},t.prototype.mod=function(n,r){return Be([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i%a;return i<0&&a<0||i>=0&&a>=0?o:(o+a)%a})},t.prototype.max=function(n,r){Be(n,"max"),Vo("max",r,n.rank);for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,n.dtype),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g>h&&(h=g)}l[f]=h}return s},t.prototype.maximum=function(n,r){return Be([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.max(i,a)})},t.prototype.all=function(n,r){Be(n,"all"),Vo("all",r,n.rank);for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,n.dtype),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h&&g}l[f]=h}return s},t.prototype.any=function(n,r){Be(n,"any"),Vo("any",r,n.rank);for(var i=va(n.shape,r),a=i[0],o=i[1],s=Kn(a,n.dtype),u=ft(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h||g}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return Be([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i-a;return o*o})},t.prototype.ceil=function(n){Be(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.ceil(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){Be(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.floor(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){Be(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?i[a]=-1:r[a]>0?i[a]=1:i[a]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){Be(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){Be(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){Be(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){Be(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=Math.floor(r[a]);r[a]-o<.5?i[a]=Math.floor(r[a]):r[a]-o>.5?i[a]=Math.ceil(r[a]):i[a]=o%2==0?o:o+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){Be(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.exp(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){Be(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.expm1(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){Be(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){Be(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log1p(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){Be(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){Be(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=1/Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){Be(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=1/r[a];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){Be(n,"relu");for(var r=Kn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.max(0,a[o]);return r},t.prototype.relu6=function(n){Be(n,"relu");for(var r=Kn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.min(Math.max(0,a[o]),6);return r},t.prototype.prelu=function(n,r){return Be([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return i<0?a*i:i})},t.prototype.elu=function(n){Be(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){Be([n,r],"eluDer");for(var i=new Float32Array(r.size),a=this.readSync(r.dataId),o=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){Be(n,"selu");for(var r=JP,i=QP,a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,i){Be(n,"clip");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>i?i:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.abs(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<n.size;++a){var o=i[2*a],s=i[2*a+1];r[a]=Math.hypot(o,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){Be(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=i[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){Be(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=1/(1+Math.exp(-i[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){Be(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o]>-r,u=a[o]<r,l=Math.exp(a[o]),c=void 0;c=u?l:s?a[o]:Math.log(1+l),i[o]=c}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){Be(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){Be(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){Be(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.tan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){Be(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){Be(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){Be(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return Be([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.atan2(i,a)})},t.prototype.sinh=function(n){Be(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){Be(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){Be(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=lZ(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){Be(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){Be(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){Be(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atanh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){Be(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=Math.sign(i[a]),s=Math.abs(i[a]),u=1/(1+.3275911*s);r[a]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),Be(n,"step");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o];isNaN(s)?i[o]=NaN:i[o]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,i,a);return o&&(l=this.add(l,o)),s&&(l=P$(this,l,s,u)),l},t.prototype.conv2d=function(n,r,i){Be([n,r],"conv2d");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",d=Ht(i.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],g=f?n.strides[2]:1,m=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),C=d.values,_=0;_<i.batchSize;++_)for(var E=_*h,A=_*v,k=0;k<i.outHeight;++k)for(var T=A+k*y,I=k*i.strideHeight-c,N=0;N<a;N++){var O=I+N*s;if(!(O<0||O>=i.inHeight))for(var D=N*r.strides[0],P=E+O*p,V=0;V<i.outWidth;++V)for(var Y=T+V*b,X=V*i.strideWidth-l,Q=0;Q<o;Q++){var me=X+Q*u;if(!(me<0||me>=i.inWidth))for(var ce=P+me*g,Ne=D+Q*r.strides[1],Oe=0;Oe<i.inChannels;++Oe){for(var $e=w[ce+Oe*m],ve=0;ve<i.outChannels;++ve)C[Y+ve*x]+=$e*S[Ne+ve];Ne+=i.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,i){for(var a=i.filterDepth,o=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,d=i.padInfo.left,h=i.padInfo.top,p=Ht(i.outShape,n.dtype),g=this.readSync(n.dataId),m=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],x=y*p.strides[0],w=0;w<i.outDepth;++w)for(var S=x+w*p.strides[1],C=w*i.strideDepth-f,_=0;_<a;_++){var E=C+_*u;if(!(E<0||E>=i.inDepth))for(var A=_*r.strides[0],k=b+E*n.strides[1],T=0;T<i.outHeight;++T)for(var I=S+T*p.strides[2],N=T*i.strideHeight-h,O=0;O<o;O++){var D=N+O*l;if(!(D<0||D>=i.inHeight))for(var P=A+O*r.strides[1],V=k+D*n.strides[2],Y=0;Y<i.outWidth;++Y)for(var X=I+Y*i.outChannels,Q=Y*i.strideWidth-d,me=0;me<s;me++){var ce=Q+me*c;if(!(ce<0||ce>=i.inWidth))for(var Ne=P+me*r.strides[2],Oe=V+ce*i.inChannels,$e=Ne,ve=0;ve<i.inChannels;++ve){for(var $=g[Oe+ve],F=0;F<i.outChannels;++F)v[X+F]+=$*m[$e+F];$e+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){Be([n,r],"conv2dDerInput");for(var a=Ht(i.inShape,"float32"),o=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=i.batchSize,p=i.filterHeight,g=i.filterWidth,m=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,x=i.outHeight,w=i.outWidth,S=i.strideHeight,C=i.strideWidth,_=i.dataFormat,E=p-1-i.padInfo.top,A=g-1-i.padInfo.left,k=_==="channelsLast",T=a.strides[0],I=k?a.strides[1]:a.strides[2],N=k?a.strides[2]:1,O=k?1:a.strides[1],D=n.strides[0],P=k?n.strides[1]:n.strides[2],V=k?n.strides[2]:1,Y=k?1:n.strides[1],X=0;X<h;++X)for(var Q=0;Q<m;++Q)for(var me=0;me<v;++me)for(var ce=me-E,Ne=Math.max(0,Math.ceil(ce/S)),Oe=Math.min(x,(p+ce)/S),$e=0;$e<y;++$e){for(var ve=$e-A,$=Math.max(0,Math.ceil(ve/C)),F=Math.min(w,(g+ve)/C),q=0,ue=Ne;ue<Oe;++ue)for(var J=ue*S-ce,L=$;L<F;++L)for(var z=D*X+P*ue+V*L,R=c*(p-1-J)+f*(g-1-(L*C-ve))+d*Q,Z=0;Z<b;++Z)q+=s[z+Y*Z]*u[R+Z];o[T*X+I*me+N*$e+O*Q]=q}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var a=Ht(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=i.batchSize,E=i.filterDepth,A=i.filterHeight,k=i.filterWidth,T=i.inChannels,I=i.inDepth,N=i.inHeight,O=i.inWidth,D=i.outChannels,P=i.outDepth,V=i.outHeight,Y=i.outWidth,X=i.strideDepth,Q=i.strideHeight,me=i.strideWidth,ce=E-1-i.padInfo.front,Ne=A-1-i.padInfo.top,Oe=k-1-i.padInfo.left,$e=0;$e<_;++$e)for(var ve=0;ve<T;++ve)for(var $=0;$<I;++$)for(var F=$-ce,q=Math.max(0,Math.ceil(F/X)),ue=Math.min(P,(E+F)/X),J=0;J<N;++J)for(var L=J-Ne,z=Math.max(0,Math.ceil(L/Q)),R=Math.min(V,(A+L)/Q),Z=0;Z<O;++Z){for(var xe=Z-Oe,Ee=Math.max(0,Math.ceil(xe/me)),Me=Math.min(Y,(k+xe)/me),Ve=0,Je=q;Je<ue;++Je)for(var Ft=Je*X-F,et=z;et<R;++et)for(var Gt=et*Q-L,rn=Ee;rn<Me;++rn)for(var kn=p*$e+g*Je+m*et+v*rn,Br=x*(E-1-Ft)+w*(A-1-Gt)+S*(k-1-(rn*me-xe))+C*ve,Jn=0;Jn<D;++Jn)Ve+=d[kn+Jn]*y[Br+Jn];o[u*$e+l*$+c*J+f*Z+ve]=Ve}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){Be([n,r],"conv2dDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=Ht(i.filterShape,"float32"),f=i.padInfo.left,d=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((d-g)/a)),v=Math.min(i.outHeight,(i.inHeight+d-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/o)),x=Math.min(i.outWidth,(i.inWidth+f-y)/o),w=0;w<i.inChannels;++w)for(var S=0;S<i.outChannels;++S){for(var C=0,_=0;_<i.batchSize;++_)for(var E=m;E<v;++E)for(var A=g+E*a-d,k=b;k<x;++k){var T=y+k*o-f;C+=l?h.get(_,A,T,w)*p.get(_,E,k,S):h.get(_,w,A,T)*p.get(_,S,E,k)}c.set(C,g,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=Ht(i.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=this.readSync(n.dataId),E=n.strides,A=E[0],k=E[1],T=E[2],I=E[3],N=i.padInfo.front,O=i.padInfo.left,D=i.padInfo.top,P=0;P<u;++P)for(var V=Math.max(0,Math.ceil((N-P)/a)),Y=Math.min(i.outDepth,(i.inDepth+N-P)/a),X=P*p,Q=0;Q<l;++Q)for(var me=Math.max(0,Math.ceil((D-Q)/o)),ce=Math.min(i.outHeight,(i.inHeight+D-Q)/o),Ne=Q*g+X,Oe=0;Oe<c;++Oe)for(var $e=Math.max(0,Math.ceil((O-Oe)/s)),ve=Math.min(i.outWidth,(i.inWidth+O-Oe)/s),$=Oe*m+Ne,F=0;F<i.inChannels;++F)for(var q=F*v+$,ue=0;ue<i.outChannels;++ue){for(var J=0,L=0;L<i.batchSize;++L)for(var z=L*A,R=L*x,Z=V;Z<Y;++Z)for(var xe=(P+Z*a-N)*k+z,Ee=Z*w+R,Me=me;Me<ce;++Me)for(var Ve=(Q+Me*o-D)*T+xe,Je=Me*S+Ee,Ft=$e;Ft<ve;++Ft){var et=Ft*C+Je;J+=_[(Oe+Ft*s-O)*I+Ve+F]*y[et+ue]}d[q+ue]=J}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,i,a);return o&&(l=this.add(l,o)),s&&(l=P$(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,i){Be([n,r],"depthwiseConv2D");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,d=Ht(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),g=d.values,m=0;m<i.batchSize;++m)for(var v=m*n.strides[0],y=m*d.strides[0],b=0;b<i.outHeight;++b)for(var x=y+b*d.strides[1],w=b*i.strideHeight-l,S=0;S<a;++S){var C=w+S*s;if(!(C<0||C>=i.inHeight))for(var _=S*r.strides[0],E=v+C*n.strides[1],A=0;A<i.outWidth;++A)for(var k=x+A*d.strides[2],T=A*i.strideWidth-c,I=0;I<o;++I){var N=T+I*u;if(!(N<0||N>=i.inWidth))for(var O=_+I*r.strides[1],D=E+N*i.inChannels,P=k,V=O,Y=0;Y<i.inChannels;++Y){for(var X=h[D+Y],Q=0;Q<f;++Q)g[P+Q]+=X*p[V+Q];P+=f,V+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){Be([n,r],"depthwiseConv2DDerInput");for(var a=Ht(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],g=d[2],m=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=i.batchSize,S=i.filterHeight,C=i.filterWidth,_=i.inChannels,E=i.inHeight,A=i.inWidth,k=i.outChannels,T=i.outHeight,I=i.outWidth,N=i.strideHeight,O=i.strideWidth,D=S-1-i.padInfo.top,P=C-1-i.padInfo.left,V=k/_,Y=0;Y<w;++Y)for(var X=0;X<_;++X)for(var Q=0;Q<E;++Q)for(var me=Q-D,ce=Math.max(0,Math.ceil(me/N)),Ne=Math.min(T,(S+me)/N),Oe=0;Oe<A;++Oe){for(var $e=Oe-P,ve=Math.max(0,Math.ceil($e/O)),$=Math.min(I,(C+$e)/O),F=0,q=ce;q<Ne;++q)for(var ue=q*N-me,J=ve;J<$;++J)for(var L=h*Y+p*q+g*J,z=y*(S-1-ue)+b*(C-1-(J*O-$e))+x*X,R=0;R<V;++R)F+=f[L+(X*V+R)]*m[z+R];o[u*Y+l*Q+c*Oe+X]=F}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){Be([n,r],"depthwiseConv2DDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=Ht(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,d=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((f-g)/a)),v=Math.min(i.outHeight,(i.inHeight+f-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/o)),x=Math.min(i.outWidth,(i.inWidth+c-y)/o),w=0;w<i.outChannels;++w){for(var S=Math.trunc(w/d),C=w%d,_=0,E=0;E<i.batchSize;++E)for(var A=m;A<v;++A)for(var k=g+A*a-f,T=b;T<x;++T){var I=y+T*o-c;_+=h.get(E,k,I,S)*p.get(E,A,T,w)}l.set(_,g,y,S,C)}return l.toTensor()},t.prototype.tile=function(n,r){return Be(n,"tile"),TJ(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){Be(n,"pad");var a=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),o=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ht(a,n.dtype);i!==0&&u.values.fill(i);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+o[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.gather=function(n,r,i){Be([n,r],"gather");var a=n.shape.slice(),o=this.readSync(r.dataId);a[i]=o.length;for(var s=Ht(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[i]=o[c[i]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){Be([n],"batchToSpaceND");var a=r.reduce(function(f,d){return f*d}),o=zC(n.shape,r,a),s=jC(o.length,r.length),u=UC(n.shape,r,a),l=rJ(i,r.length),c=iJ(u,i,r.length);return In(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){Be([n],"spaceToBatchND");var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=zC(u.shape,r,a,!1),c=jC(l.length,r.length,!1),f=UC(u.shape,r,a,!1);return In(u.reshape(l),c).reshape(f)},t.prototype.maxPool=function(n,r){return Be(n,"maxPool"),M$(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"max").toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,a){Be([r,i],"maxPoolBackprop");for(var o=this.readSync(r.dataId),s=Ht(a.outShape,r.dtype,_ee(o,r.shape,r.dtype,a).values),u=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=h-1-a.padInfo.left,g=d-1-a.padInfo.top,m=Ht(r.shape,"float32"),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var x=0;x<a.inHeight;++x)for(var w=0;w<a.inWidth;++w){for(var S=x-g,C=w-p,_=0,E=0;E<d;E+=c){var A=(S+E)/u;if(!(A<0||A>=a.outHeight||Math.floor(A)!==A))for(var k=0;k<h;k+=f){var T=(C+k)/l;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var I=d*h-1-s.get(y,A,T,b)===E*h+k?1:0;I!==0&&(_+=v.get(y,A,T,b)*I)}}}m.set(_,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){Be([n,r],"avgPoolBackprop");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,g=Ht(r.shape,"float32"),m=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-p,C=w-h,_=0,E=0;E<f;E+=l){var A=(S+E)/a;if(!(A<0||A>=i.outHeight||Math.floor(A)!==A))for(var k=0;k<d;k+=c){var T=(C+k)/o;T<0||T>=i.outWidth||Math.floor(T)!==T||(_+=v.get(y,A,T,b))}}g.set(_*m,y,x,w,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,i){Be(n,"pool3d");for(var a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Ht(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],_=r.outShape[4],E=0;E<r.batchSize;++E)for(var A=E*w,k=E*n.strides[0],T=0;T<r.inChannels;++T)for(var I=0;I<r.outDepth;++I){for(var N=I*a-p,O=N;O<0;)O+=u;for(var D=Math.min(r.inDepth,f+N),P=A+I*S,V=0;V<r.outHeight;++V){for(var Y=V*o-g,X=Y;X<0;)X+=l;for(var Q=Math.min(r.inHeight,d+Y),me=P+V*C,ce=0;ce<r.outWidth;++ce){for(var Ne=ce*s-m,Oe=Ne;Oe<0;)Oe+=c;for(var $e=Math.min(r.inWidth,h+Ne),ve=me+ce*_,$=v,F=0,q=0,ue=O;ue<D;ue+=u){for(var J=k+ue*n.strides[1],L=X;L<Q;L+=l){for(var z=J+L*n.strides[2],R=Oe;R<$e;R+=c){var Z=y[z+R*n.strides[3]+T];if(i==="max"&&Z>$?$=Z:i==="avg"&&(F+=Z,q++),isNaN($))break}if(isNaN($))break}if(isNaN($))break}x[ve+T]=i==="avg"?F/q:$}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return Be(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){Be([n,r],"avgPool3dBackprop");for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=m-1-i.padInfo.left,b=g-1-i.padInfo.top,x=Ht(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var _=0;_<i.inChannels;++_)for(var E=0;E<i.inDepth;++E)for(var A=0;A<i.inHeight;++A)for(var k=0;k<i.inWidth;++k){for(var T=E-v,I=A-b,N=k-y,O=0,D=0;D<p;D+=f){var P=(T+D)/a;if(!(P<0||P>=i.outDepth||Math.floor(P)!==P))for(var V=0;V<g;V+=d){var Y=(I+V)/o;if(!(Y<0||Y>=i.outHeight||Math.floor(Y)!==Y))for(var X=0;X<m;X+=h){var Q=(N+X)/s;Q<0||Q>=i.outWidth||Math.floor(Q)!==Q||(O+=S.get(C,P,Y,Q,_))}}}x.set(O*w,C,E,A,k,_)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return Be(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=Ht(r.outShape,"int32"),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*a-p,S=w;S<0;)S+=u;for(var C=Math.min(r.inDepth,f+w),_=0;_<r.outHeight;++_){for(var E=_*o-g,A=E;A<0;)A+=l;for(var k=Math.min(r.inHeight,d+E),T=0;T<r.outWidth;++T){for(var I=T*s-m,N=I;N<0;)N+=c;for(var O=Math.min(r.inWidth,h+I),D=Number.NEGATIVE_INFINITY,P=-1,V=S;V<C;V+=u)for(var Y=V-w,X=A;X<k;X+=l)for(var Q=X-E,me=N;me<O;me+=c){var ce=me-I,Ne=v.get(y,V,X,me,b);Ne>=D&&(D=Ne,P=Y*d*h+Q*d+ce)}i.set(P,y,x,_,T,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,a){Be([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=h-1-a.padInfo.front,v=g-1-a.padInfo.left,y=p-1-a.padInfo.top,b=Ht(r.shape,"float32"),x=this.bufferSync(o),w=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var C=0;C<a.inChannels;++C)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var A=0;A<a.inWidth;++A){for(var k=_-m,T=E-y,I=A-v,N=0,O=0;O<h;O+=c){var D=(k+O)/s;if(!(D<0||D>=a.outDepth||Math.floor(D)!==D))for(var P=0;P<p;P+=f){var V=(T+P)/u;if(!(V<0||V>=a.outHeight||Math.floor(V)!==V))for(var Y=0;Y<g;Y+=d){var X=(I+Y)/l;if(!(X<0||X>=a.outWidth||Math.floor(X)!==X)){var Q=h*p*g-1-x.get(S,D,V,X,C)===O*p*g+P*g+Y?1:0;Q!==0&&(N+=w.get(S,D,V,X,C)*Q)}}}}b.set(N,S,_,E,A,C)}return b.toTensor()},t.prototype.cast=function(n,r){return zP(n,r,this)},t.prototype.reshape=function(n,r){return tA(n,r)},t.prototype.avgPool=function(n,r){return Be(n,"avgPool"),Be(n,"maxPool"),M$(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(n,r,i,a){Be(n,"resizeBilinear");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(ft([s,r,i,c])),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=0,m=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=m*b,w=Math.floor(x),S=x-w,C=Math.min(u-1,Math.ceil(x)),_=y*n.strides[0]+w*n.strides[1],E=y*n.strides[0]+C*n.strides[1],A=0;A<i;A++)for(var k=v*A,T=Math.floor(k),I=k-T,N=Math.min(l-1,Math.ceil(k)),O=_+T*n.strides[2],D=E+T*n.strides[2],P=_+N*n.strides[2],V=E+N*n.strides[2],Y=0;Y<c;Y++){var X=f[O+Y],Q=f[D+Y],me=X+(f[P+Y]-X)*I,ce=me+(Q+(f[V+Y]-Q)*I-me)*S;d[g++]=ce}return fi(d,[s,r,i,c])},t.prototype.resizeBilinearBackprop=function(n,r,i){Be([n,r],"resizeBilinearBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=[i&&f>1?s-1:s,i&&d>1?u-1:u],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],m=p[0]/g[0],v=p[1]/g[1],y=this.readSync(n.dataId),b=0,x=0;x<o;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var C=S*m,_=Math.floor(C),E=Math.min(Math.ceil(C),s-1),A=w+_*r.strides[1],k=w+E*r.strides[1],T=C-_,I=1-T,N=0;N<d;N++)for(var O=N*v,D=Math.floor(O),P=Math.min(Math.ceil(O),u-1),V=O-D,Y=1-V,X=A+D*r.strides[2],Q=A+P*r.strides[2],me=k+D*r.strides[2],ce=k+P*r.strides[2],Ne=I*Y,Oe=I*V,$e=T*Y,ve=T*V,$=0;$<l;$++){var F=y[b++];h[X+$]+=F*Ne,h[Q+$]+=F*Oe,h[me+$]+=F*$e,h[ce+$]+=F*ve}return nh(h,[o,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,a){Be(n,"resizeNearestNeighbor");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*i*c),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=h[0]/p[0],m=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=g*x,S=b+Math.min(u-1,a?Math.round(w):Math.floor(w))*n.strides[1],C=0;C<i;C++)for(var _=m*C,E=S+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],A=0;A<c;A++){var k=f[E+A];d[v++]=k}return fi(d,[s,r,i,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){Be([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=this.readSync(n.dataId),g=[i&&f>1?s-1:s,i&&d>1?u-1:u],m=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,C=0;C<o;C++)for(var _=C*r.strides[0],E=0;E<s;E++)for(var A=_+E*r.strides[1],k=Math.floor(E*b),T=Math.floor(k-w/2),I=0;I<u;I++)for(var N=A+I*r.strides[2],O=Math.floor(I*x),D=Math.floor(O-S/2),P=0;P<l;P++){for(var V=0,Y=0;Y<w;Y++){var X=Y+T;if(!(X<0||X>=f)){var Q=_+X*n.strides[1],me=X*v;if(E===Math.min(s-1,i?Math.round(me):Math.floor(me)))for(var ce=0;ce<S;ce++){var Ne=ce+D;if(!(Ne<0||Ne>=d)){var Oe=Q+Ne*n.strides[2],$e=Ne*y;I===Math.min(u-1,i?Math.round($e):Math.floor($e))&&(V+=p[Oe+P])}}}}h[N+P]=V}return nh(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){Be([n,r,i,o,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,g=f.length,m=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)h[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+a),y>=p&&(y=0),b>=v&&(b=0),x>=g&&(x=0),w>=m&&(w=0);return nh(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){Be(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(m){for(var v=m%s,y=m-v+Math.max(0,v-r),b=m-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var h=0;h<c;h++){var p=d(h),g=l[h]*Math.pow(i+a*p,-o);f[h]=g}return nh(f,n.shape)},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){Be(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,g=0;g<p;g++){for(var m=g%l,v=g-m+Math.max(0,m-a),y=g-m+Math.min(l,m+a+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+o,x=v;x<y;x++){var w=-2*s*u*f[x]*d[g]/b;g===x&&(w+=Math.pow(b,-u)),w*=c[g],h[x]+=w}}return nh(h,n.shape)},t.prototype.multinomial=function(n,r,i,a){Be(n,"multinomial");for(var o=r?n:hg(n),s=o.shape[0],u=o.shape[1],l=Kn([s,i],"int32"),c=this.readSync(l.dataId),f=this.readSync(o.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var g=1;g<p.length;++g)p[g]=p[g-1]+f[h+g];for(var m=oA(a.toString()),v=d*i,y=0;y<i;++y){var b=m();c[v+y]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,i,a){Be(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(o[u*r+s[u]]=i);return sc(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return Be(n,"nonMaxSuppression"),WP(this.readSync(n.dataId),this.readSync(r.dataId),i,a,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],a=n.shape[1],o=Ht(n.shape,"float32"),s=Ht(n.shape,"float32"),u=qo(n).as2D(i,a),l=uu(n).as2D(i,a),c=0;c<i;c++)for(var f=u.slice([c,0],[1,a]),d=l.slice([c,0],[1,a]),h=$i(f,d),p=this.readSync(this.fftImpl(h,r).dataId),g=0;g<a;g++){var m=EJ(p,g);o.values[c*a+g]=m.real,s.values[c*a+g]=m.imag}return $i(o.toTensor(),s.toTensor()).as2D(i,a)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),a=i.size;if(this.isExponentOf2(a)){var o=this.fftRadix2(i,a,r).as2D(n.shape[0],n.shape[1]);return r&&(o=$i(qo(o).div(rt(a)),uu(o).div(rt(a)))),o}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,a,r));return $i(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var a=this.readSync(n.dataId),o=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),u=$i(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),c=$i(l.real,l.imag).as1D();u=this.fftRadix2(u,o,i),c=this.fftRadix2(c,o,i);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,i),d=$i(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),g=qo(h).concat(qo(p)),m=uu(h).concat(uu(p));return $i(g,m).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var a=new Float32Array(2*r),o=0;o<r;o++){for(var s=0,u=0,l=0;l<r;l++){var c=f4e(o*l,r,i),f=EJ(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}i&&(s/=r,u/=r),c4e(a,s,u,o)}return a},t.prototype.depthToSpace=function(n,r,i){H(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),H(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],o=n.shape[1],s=n.shape[2],u=n.shape[3],l=o*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(a*l*c*f),p=0,g=0;g<a;++g)for(var m=0;m<l;++m)for(var v=Math.floor(m/r),y=m%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var C=S+w+u*(x+s*(v+o*g));h[p++]=d[C]}return nh(h,[a,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,i,a){var o=vn(n.shape,r.shape),s=Ht(o,i),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Nf(n.shape,o),f=Nf(r.shape,o),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),g=this.bufferSync(r),m=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(C){return b[C]=0});var x=p.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(C){return w[C]=0});var S=g.locToIndex(w);d[v]=a(u[x],l[S])};for(h=0;h<d.length;++h)m(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var a=vn(n.shape,r.shape),o=Ht(a,"float32"),s=Ht(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Nf(n.shape,a),f=Nf(r.shape,a),d=o.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var g=p%u.length,m=p%l.length,v=i(u[2*g],u[2*g+1],l[2*m],l[2*m+1]);d[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=o.indexToLoc(w),C=S.slice(-n.rank);c.forEach(function(T){return C[T]=0});var _=y.locToIndex(C),E=S.slice(-r.rank);f.forEach(function(T){return E[T]=0});var A=b.locToIndex(E),k=i(u[2*_],u[2*_+1],l[2*A],l[2*A+1]);d[w]=k.real,h[w]=k.imag};for(p=0;p<d.length;p++)x(p)}return this.complex(o.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return kJ(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,a,o,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=a[0],g=a[1],m=Ht([h,p,g,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),x=n.strides,w=m.strides,S=0;S<h;S++){var C=4*S,_=v[C],E=v[C+1],A=v[C+2],k=v[C+3],T=y[S];if(!(T>=l))for(var I=p>1?(A-_)*(c-1)/(p-1):0,N=g>1?(k-E)*(f-1)/(g-1):0,O=0;O<p;O++){var D=p>1?_*(c-1)+O*I:.5*(_+A)*(c-1);if(D<0||D>c-1)for(var P=0;P<g;P++)for(var V=0;V<d;V++){var Y=V+P*w[2]+O*w[1]+S*w[0];m.values[Y]=s}else if(o==="bilinear"){var X=Math.floor(D),Q=Math.ceil(D),me=D-X;for(P=0;P<g;P++)if((ue=g>1?E*(f-1)+P*N:.5*(E+k)*(f-1))<0||ue>f-1)for(V=0;V<d;V++)Y=V+P*w[2]+O*w[1]+S*w[0],m.values[Y]=s;else{var ce=Math.floor(ue),Ne=Math.ceil(ue),Oe=ue-ce;for(V=0;V<d;V++){var $e=b[Y=V+ce*x[2]+X*x[1]+T*x[0]],ve=b[Y=V+Ne*x[2]+X*x[1]+T*x[0]],$=b[Y=V+ce*x[2]+Q*x[1]+T*x[0]],F=$e+(ve-$e)*Oe,q=$+(b[Y=V+Ne*x[2]+Q*x[1]+T*x[0]]-$)*Oe;Y=V+P*w[2]+O*w[1]+S*w[0],m.values[Y]=F+(q-F)*me}}}else for(P=0;P<g;++P){var ue;if((ue=g>1?E*(f-1)+P*N:.5*(E+k)*(f-1))<0||ue>f-1)for(V=0;V<d;V++)Y=V+P*w[2]+O*w[1]+S*w[0],m.values[Y]=s;else{var J=Math.round(ue),L=Math.round(D);for(V=0;V<d;V++){var z=V+J*x[2]+L*x[1]+T*x[0],R=V+P*w[2]+O*w[1]+S*w[0];m.values[R]=b[z]}}}}}return m.toTensor()},t.prototype.sparseToDense=function(n,r,i,a){var o=hx(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(n,r,i,f,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=NP(n,r),s=o[0],u=o[1],l=o[2],c=o[3];if(u===0)return fi([],s,n.dtype);for(var f=new c0([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var g=[],m=0,v=0;v<a;v++){var y=d[p*a+v];m+=y*c[v],g.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[p*l+b]=h[m*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var a=hx(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=rt(0);return this.scatter(n,r,i,c,u,s,o,l,f,!0)},t.prototype.fill=function(n,r,i){var a=G1(i=i||u0(r),ft(n));return a.fill(r),te.makeTensor(a,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=G1(n.dtype,ft(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return jP(n,r,i)},t.prototype.scatter=function(n,r,i,a,o,s,u,l,c,f){var d=[a/o,o],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return fi([],i,r.dtype);var g=new c0(d,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var v=[],y=0,b=0;b<u;b++){var x=h[m*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=a/o)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var w=0;w<o;w++)f?g.values[y*o+w]+=p[m*o+w]:g.values[y*o+w]=r.rank===0?p[0]:p[m*o+w]}return g.toTensor().reshape(i)},t}($P);function See(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;Be([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,f=t(o.shape,s.shape,l,c,o.dtype),d=f[0],h=f[1];return{dataId:u.write(d,h,o.dtype),shape:h,dtype:o.dtype}}}}function Eee(e){return function(t,n,r,i,a){var o=vn(t,n),s=o.length,u=Wo(o),l=cg(a,ft(o)),c=t.length,f=n.length,d=Wo(t),h=Wo(n),p=Nf(t,o),g=Nf(n,o);if(p.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],i[m%i.length]);else{var v=function(y){var b=FM(y,s,u),x=b.slice(-c);p.forEach(function(_){return x[_]=0});var w=SC(x,c,d),S=b.slice(-f);g.forEach(function(_){return S[_]=0});var C=SC(S,f,h);l[y]=e(r[w],i[C])};for(m=0;m<l.length;++m)v(m)}return[l,o]}}te.registerBackend("cpu",function(){return new Cze},1);var Aze=Eee(function(e,t){return e/t}),kze=See(lx,Aze),Tze={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;Be(i,"MaxPoolWithArgmax");var f=c.data.get(i.dataId).values,d=oh(i.shape,o,s,[1,1],u),h=function(y,b,x,w,S){var C=M$(y,0,x,Wo(b),S,"max"),_=_ee(y,b,x,S,!0,w);return[C.values,_.values]}(f,i.shape,i.dtype,l,d),p=h[0],g=h[1],m=c.write(p,d.outShape,i.dtype),v=c.write(g,d.outShape,i.dtype);return[{dataId:m,shape:d.outShape,dtype:i.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}},Oze={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;Be(a,"NonMaxSuppressionWithScore");var h=VP(d.data.get(a.dataId).values,d.data.get(o.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},Ize={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;Be(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Nze=Eee(function(e,t){var n=e-t;return n*n});function Cee(e,t,n,r,i){for(var a=ft(t),o=t.length,s=Wo(t),u=Wo(i),l=cg(n,ft(i)),c=0;c<a;++c){for(var f=FM(c,o,s),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];l[SC(d,o,u)]=e[c]}return l}for(var $$=0,Aee=[Oze,Ize,See(cx,Nze),kze,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n.perm,o=r;Be(i,"transpose");for(var s=i.shape.length,u=new Array(s),l=0;l<u.length;l++)u[l]=i.shape[a[l]];var c=Cee(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(c,u,i.dtype),shape:u,dtype:i.dtype}}},Tze];$$<Aee.length;$$++)CM(Aee[$$]);for(var k0,Dze=function(e){this.variableNames=["A"];var t=Ma(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},Rze=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ma(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `},Fze=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Er(this.rank),a=function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<o.length;c++)l[o[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},Mze=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Er(this.rank),a=IJ("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},L$=0,kee=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,a=r.numChannels,o=typeof HTMLVideoElement!="undefined"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],f=[c,l],d=[c,l,a];(s||o)&&(k0==null&&(k0=document.createElement("canvas").getContext("2d")),k0.canvas.width=l,k0.canvas.height=c,k0.drawImage(i,0,0,l,c),i=k0.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=Cs.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=we().getBool("WEBGL_PACK")?new Rze(d):new Dze(d),g=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:lx,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(i,a,o){var s=new ti(N4e,i.shape,a.shape);return we().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(s=new cc(D4e,i.shape,a.shape,!0)),o.runWebGLProgram(s,[i,a],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;FC("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=VP(d.readSync(a.dataId),d.readSync(o.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,a=new en(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:cx,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,a=r.b,o=n,s=we().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cc("return (a - b) * (a - b);",i.shape,a.shape):new ti("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,i=e.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=a.shape[o[c]];if(s.shouldExecuteOnCPU([a])){var f=Cee(s.texData.get(a.dataId).values,a.shape,a.dtype,o,l);t=s.makeTensorInfo(l,a.dtype),s.texData.get(t.dataId).values=f}else t=function(d,h,p){var g=we().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Mze(d.shape,h):new Fze(d.shape,h);return p.runWebGLProgram(g,[d],d.dtype)}(a,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;H(i.shape.length===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."});var f=[1,1];H(Fa(s,f),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"});var d=oh(i.shape,o,s,f,u),h=function(p,g,m,v){var y=new bx(m,"max",!1),b=v.runWebGLProgram(y,[p],"float32");return y=new bx(m,"max",!0,!0,g),[b,v.runWebGLProgram(y,[p],"float32")]}(i,l,d,c);return[h[0],h[1]]}}];L$<kee.length;L$++)CM(kee[L$]);for(var B$=0,Tee=[{kernelName:iP,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=vn(n.shape,r.shape);return{a:function(){var a=e,o=Si(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var a=e,o=Si(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach(function(r,i){n[i]=function(){return e.clone()}}),n}},{kernelName:aP,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(i[s]!==1)throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:lx,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=vn(n.shape,r.shape);return{a:function(){var a=ei(e,r.toFloat()),o=Si(n.shape,i);return o.length>0?Ei(a,o).reshape(n.shape):a},b:function(){var a=e.mul(n.toFloat()),o=Si(r.shape,i);o.length>0&&(a=Ei(a,o).reshape(r.shape));var s=hA(r);return ah(ei(a,s.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,i=t[0],a=t[1],o=t[2],s=t[3],u=_Q(i),l=s??rt(1),c=Si(a.shape,u.shape),f=[];if(a.rank===1){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var h=Qr(i,a),p=pt(e,l),g=VC(un(o,rt(r))),m=pt(pt(pt(g,g),g),rt(-.5));return{x:function(){return a.rank===1?el(pt(pt(e,Rf(g.as4D(1,1,1,a.shape[0]),f)),l),i.shape):el(pt(pt(e,g),l),i.shape)},mean:function(){var v=pt(pt(g,rt(-1)),p);return a.rank===1&&(v=Ei(v,c)),el(v,a.shape)},variance:function(){var v=pt(pt(m,h),p);return a.rank===1&&(v=Ei(v,c)),el(v,a.shape)},scale:function(){var v=pt(h,g),y=pt(e,v);return a.rank===1&&(y=Ei(y,c)),el(y,a.shape)},offset:function(){var v=e;return a.rank===1&&(v=Ei(v,c)),el(v,a.shape)}}}},{kernelName:sP,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:oP,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Kn(n.shape,"float32")}}}},{kernelName:lP,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map(function(a){return a[0]});return{x:function(){return e.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:cx,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=rt(2);return{a:function(){return pt(e,pt(i,Qr(n,r)))},b:function(){return pt(e,pt(i,Qr(r,n)))}}}},{kernelName:uP,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.reps;return{x:function(){var a=wn(r);if(r.rank===1)for(var o=0;o<i[0];++o)a=a.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(o=0;o<i[0];++o)for(var s=0;s<i[1];++s)a=a.add(e.slice([o*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(var u=0;u<i[2];++u)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(r.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(u=0;u<i[2];++u)for(var l=0;l<i[3];++l)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2],l*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return a}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=MC(n.perm);return{x:function(){return In(e,r)}}}}];B$<Tee.length;B$++)oZ(Tee[B$]);var Pze=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();we().get("IS_BROWSER")&&we().setPlatform("browser",new Pze);var z$,$ze=function(){return require("node-fetch")},Lze=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return we().global.fetch!=null?we().global.fetch(t,n):(z$==null&&(z$=$ze()),z$(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();we().get("IS_NODE")&&we().setPlatform("node",new Lze);var j$={float32:4,int32:4,uint16:2,uint8:1,bool:1},FA=4;function Oee(e,t){for(var n={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,f=ft(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=j$[h.dtype],g=e.slice(r,r+f*p),m=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")d=Float32Array.from(m,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(m,function(S){return Math.round(S*h.scale+h.min)})}r+=f*p}else if(l==="string"){var v=ft(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+FA))[0];r+=FA;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=j$[l];if(g=e.slice(r,r+f*w),l==="float32")d=new Float32Array(g);else if(l==="int32")d=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(g)}r+=f*w}n[u]=fi(d,c,l)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function Bze(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var U$=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function Iee(e){return U$?Buffer.byteLength(e):new Blob([e]).size}function W$(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function Nee(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Nx(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Iee(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Iee(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Ns=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var o=a(t,r);o!==null&&i.push(o)}),i},e}(),T0="://",dh=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){H(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(T0)&&(t=t.slice(0,t.indexOf(T0))),H(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();H(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function MA(e){if(e.indexOf(T0)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+dh.getSchemes().join(","));return{scheme:e.split(T0)[0],path:e.split(T0)[1]}}function Dee(e,t,n){return n===void 0&&(n=!1),dt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return ht(this,function(d){switch(d.label){case 0:return H(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),H((r=Ns.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),H(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],H((a=Ns.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),H(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=a[0],s=MA(e).scheme,u=MA(e).path,l=s===MA(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,dh.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,dh.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Eg="models_store",hh="model_info_store";function Ree(){if(!we().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function V$(e){var t=e.result;t.createObjectStore(Eg,{keyPath:"modelPath"}),t.createObjectStore(hh,{keyPath:"modelPath"})}var O0=function(){function e(t){if(this.indexedDB=Ree(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return dt(this,void 0,void 0,function(){return ht(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return dt(this,void 0,void 0,function(){return ht(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,a){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return V$(o)},o.onsuccess=function(){var s=o.result;if(n==null){var u=s.transaction(Eg,"readonly"),l=u.objectStore(Eg).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=Nx(n),d=s.transaction(hh,"readwrite"),h=d.objectStore(hh),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var g=(c=s.transaction(Eg,"readwrite")).objectStore(Eg).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});g.onsuccess=function(){return i({modelArtifactsInfo:f})},g.onerror=function(m){var v=(h=d.objectStore(hh)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(g.error)},v.onerror=function(y){return s.close(),a(g.error)}}},p.onerror=function(g){return s.close(),a(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return a(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),Fee=function(e){return we().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(O0.URL_SCHEME)?(t=e.slice(O0.URL_SCHEME.length),new O0(t)):null;var t};Ns.registerSaveRouter(Fee),Ns.registerLoadRouter(Fee);var zze=function(){function e(){this.indexedDB=Ree()}return e.prototype.listModels=function(){return dt(this,void 0,void 0,function(){var t=this;return ht(this,function(n){return[2,new Promise(function(r,i){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return V$(a)},a.onsuccess=function(){var o=a.result,s=o.transaction(hh,"readonly"),u=s.objectStore(hh).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return o.close(),i(u.error)},s.oncomplete=function(){return o.close()}},a.onerror=function(o){return i(a.error)}})]})})},e.prototype.removeModel=function(t){return dt(this,void 0,void 0,function(){var n=this;return ht(this,function(r){var i;return t=(i=t).startsWith(O0.URL_SCHEME)?i.slice(O0.URL_SCHEME.length):i,[2,new Promise(function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return V$(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(hh,"readwrite"),f=c.objectStore(hh),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var g=(u=l.transaction(Eg,"readwrite")).objectStore(Eg).delete(t);g.onsuccess=function(){return a(d.result.modelArtifactsInfo)},g.onerror=function(m){return o(d.error)}};h.onsuccess=p,h.onerror=function(g){return p(),l.close(),o(d.error)}},d.onerror=function(h){return l.close(),o(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}})]})})},e}();if(we().getBool("IS_BROWSER"))try{dh.registerManager(O0.URL_SCHEME,new zze)}catch(e){}var Mf="/",I0="tensorflowjs_models",Mee="info",jze="model_topology",Uze="weight_specs",Wze="weight_data",Vze="model_metadata";function Pee(e){return{info:[I0,e,Mee].join(Mf),topology:[I0,e,jze].join(Mf),weightSpecs:[I0,e,Uze].join(Mf),weightData:[I0,e,Wze].join(Mf),modelMetadata:[I0,e,Vze].join(Mf)}}function qze(e){var t=e.split(Mf);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Mf)}var N0=function(){function e(t){if(!we().getBool("IS_BROWSER")||typeof window=="undefined"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Pee(this.modelPath)}return e.prototype.save=function(t){return dt(this,void 0,void 0,function(){var n,r,i;return ht(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Nx(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(U$)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return dt(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return ht(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(U$){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),$ee=function(e){return we().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(N0.URL_SCHEME)?(t=e.slice(N0.URL_SCHEME.length),new N0(t)):null;var t};Ns.registerSaveRouter($ee),Ns.registerLoadRouter($ee);var Hze=function(){function e(){H(we().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),H(typeof window=="undefined"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return dt(this,void 0,void 0,function(){var t,n,r,i,a,o;return ht(this,function(s){for(t={},n=I0+Mf,r=Mf+Mee,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(o=qze(a),t[o]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return dt(this,void 0,void 0,function(){var n,r;return ht(this,function(i){var a;if(t=(a=t).startsWith(N0.URL_SCHEME)?a.slice(N0.URL_SCHEME.length):a,n=Pee(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(we().getBool("IS_BROWSER"))try{dh.registerManager(N0.URL_SCHEME,new Hze)}catch(e){}var Gze="model",Kze=".json",Xze=".weights.bin";function Lee(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var q$=function(){function e(t){if(!we().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=Gze),this.modelTopologyFileName=t+Kze,this.weightDataFileName=t+Xze}return e.prototype.save=function(t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s;return ht(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=a,[4,Lee(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Lee(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Nx(t)}]}})})},e.URL_SCHEME="downloads://",e}(),Yze=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return dt(this,void 0,void 0,function(){var t,n,r=this;return ht(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(m){return void o(m)}var h=[],p=[],g=[];f.forEach(function(m){m.paths.forEach(function(v){p.push(v),g.push(null)}),h.push.apply(h,m.weights)}),f.forEach(function(m){m.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=p.indexOf(v);g[w]=x,g.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:W$(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return Nee(u.name)}),a={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(u){var l=Nee(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[i.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function Bee(e,t,n,r){(function(a){H(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,o){H(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),H(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),H(o>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+o})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(a){return a.then(function(o){var s=n+ ++i/e.length*(r-n);return t(s),o}),a}))}function zee(e,t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return ht(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?we().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),i=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,Bee(r,t.onProgress,i,a)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,Bee(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function jee(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),dt(t,void 0,void 0,function(){var a,o,s,u,l,c,f,d,h,p;return ht(this,function(g){switch(g.label){case 0:if(a=n.map(function(){return!1}),o={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(m,v){var y=0;m.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=j$[x]*ft(b.shape),S=function(){a[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};i!=null?i.forEach(function(C,_){C===b.name&&(S(),s[_]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(m){return m}))throw l=i.filter(function(m,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(m,v,y){return v&&m.push(y),m},[]),f=[],c.forEach(function(m){n[m].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=g.sent(),h={},p=0,c.forEach(function(m){for(var v=n[m].paths.length,y=0,b=0;b<v;b++)y+=d[p+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,C=0;C<v;C++){var _=new Uint8Array(d[p+C]);w.set(_,S),S+=_.byteLength}o[m].forEach(function(E){var A=Oee(x.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var k in A)h[k]=A[k]}),p+=v}),[2,h]}})})}}Ns.registerSaveRouter(function(e){return we().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(q$.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new q$(t)}(e.slice(q$.URL_SCHEME.length)):null});var Uee=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(H(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=we().platform.fetch,H(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&H(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return dt(this,void 0,void 0,function(){var n,r,i,a;return ht(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:Nx(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return dt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u,l,c,f,d;return ht(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,i==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d;return ht(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var g=p.lastIndexOf("/"),m=p.lastIndexOf("?"),v=p.substring(0,g),y=m>g?p.substring(m):"";return[v+"/",y]}(n),i=r[0],a=r[1],o=this.weightPathPrefix||i,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(g){f.push(o+g+a)})}),[4,zee(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,W$(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function H$(e){return e.match(Uee.URL_SCHEME_REGEX)!=null}var Wee=function(e,t){return typeof fetch=="undefined"?null:(Array.isArray(e)?e.every(function(n){return H$(n)}):H$(e))?G$(e,{onProgress:t}):null};function G$(e,t){return new Uee(e,t)}Ns.registerSaveRouter(Wee),Ns.registerLoadRouter(Wee);var K$=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return dt(this,void 0,void 0,function(){return ht(this,function(t){return[2,this.modelArtifacts]})})},e}(),Zze=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return dt(this,void 0,void 0,function(){return ht(this,function(n){return[2,this.saveHandler(t)]})})},e}(),lo=Object.freeze({browserFiles:function(e){return new Yze(e)},browserHTTPRequest:function(e,t){return G$(e,t)},concatenateArrayBuffers:W$,decodeWeights:Oee,encodeWeights:function(e,t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s=this;return ht(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=i[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return dt(s,void 0,void 0,function(){var g,m,v,y,b,x,w;return ht(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(g=S.sent(),m=g.reduce(function(C,_){return C+_.length},0)+FA*g.length,v=new Uint8Array(m),y=0,b=0;b<g.length;b++)x=g[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=FA,v.set(x,y),y+=x.length;return p(v),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:Bze(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new K$(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new K$({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new K$({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Ns.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Nx,getSaveHandlers:function(e){return Ns.getSaveHandlers(e)},http:G$,isHTTPScheme:H$,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),dt(this,void 0,void 0,function(){return ht(this,function(i){return[2,jee(function(a){return zee(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Ns.registerLoadRouter(e)},registerSaveRouter:function(e){return Ns.registerSaveRouter(e)},weightsLoaderFactory:jee,withSaveHandler:function(e){return new Zze(e)},copyModel:function(e,t){return dt(this,void 0,void 0,function(){return ht(this,function(n){return[2,Dee(e,t,!1)]})})},listModels:function(){return dt(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return ht(this,function(s){switch(s.label){case 0:e=dh.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,dh.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+T0+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return dt(this,void 0,void 0,function(){return ht(this,function(n){return[2,Dee(e,t,!0)]})})},removeModel:function(e){return dt(this,void 0,void 0,function(){var t;return ht(this,function(n){return t=MA(e),[2,dh.getManager(t.scheme).removeModel(t.path)]})})}}),D0,Jze=ne({confusionMatrix_:function(e,t,n){var r=U(e,"labels","confusionMatrix"),i=U(t,"predictions","confusionMatrix");H(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),H(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),H(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),H(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),H(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=xg(r.asType("int32"),n),o=xg(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),Qze=Object.freeze({confusionMatrix:Jze}),e5e=ne({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement!="undefined"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(_M("FromPixels",te.backendName)!=null)return te.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(o?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(a||i)&&(D0==null&&(D0=document.createElement("canvas").getContext("2d")),D0.canvas.width=c,D0.canvas.height=f,D0.drawImage(e,0,0,c,f),s=D0.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return PC(u,[f,c,t],"int32")}}),Vee=Object.freeze({toPixels:function(e,t){return dt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return ht(this,function(E){switch(E.label){case 0:if(n=U(e,"img","toPixels"),e instanceof fn||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=E.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=E.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(g=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(a*i*4),v=0;v<i*a;++v)y=void 0,b=void 0,x=void 0,w=void 0,o===1?(y=s[v]*g,b=s[v]*g,x=s[v]*g,w=255):o===3?(y=s[3*v]*g,b=s[3*v+1]*g,x=s[3*v+2]*g,w=255):o===4&&(y=s[4*v]*g,b=s[4*v+1]*g,x=s[4*v+2]*g,w=s[4*v+3]*g),m[(S=4*v)+0]=Math.round(y),m[S+1]=Math.round(b),m[S+2]=Math.round(x),m[S+3]=Math.round(w);return t!=null&&(t.width=a,t.height=i,C=t.getContext("2d"),_=new ImageData(m,a,i),C.putImageData(_,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:e5e}),qee=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),Hee=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function ph(e){H(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),H(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),H(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Hee.register(e)}var je=Object.freeze({Serializable:qee,SerializationMap:Hee,registerClass:ph}),t5e="1.7.4",n5e=Object.freeze({gpgpu_util:oBe,webgl_util:RLe,forceHalfFloat:function(){we().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:wQ,setWebGLContext:EZ,GPGPUContext:iQ}),Pf=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Yu(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var a=this.computeGradients(n,i),o=a.value,s=a.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return sn(s),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return SJ(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&sn(this.iterations_)},t.prototype.saveIterations=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:rt(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return dt(this,void 0,void 0,function(){var r;return ht(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(qee);Object.defineProperty(Pf,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var X$=function(e){function t(n,r,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],i==null&&(a.epsilon=te.backend.epsilon()),a}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=te.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accum_grad",variable:ge(function(){return wn(o).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:i+"/accum_var",variable:ge(function(){return wn(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;ge(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(o);o.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(sn(this.accumulatedGrads.map(function(n){return n.variable})),sn(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){var n;return ht(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){var r;return ht(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(Pf);ph(X$);var Y$=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=te.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accumulator",variable:ge(function(){return f0(o.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable;ge(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(te.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&sn(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(Pf);ph(Y$);var Z$=function(e){function t(n,r,i,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=i,o.epsilon=a,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],ge(function(){o.accBeta1=rt(r).variable(),o.accBeta2=rt(i).variable()}),a==null&&(o.epsilon=te.backend.epsilon()),o}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ge(function(){var a=Qr(1,r.accBeta1),o=Qr(1,r.accBeta2);i.forEach(function(s,u){var l=te.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ge(function(){return wn(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ge(function(){return wn(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(a),m=p.div(o);f.assign(h),d.assign(p);var v=g.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&sn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&sn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){var n;return ht(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){var r,i=this;return ht(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),ge(function(){i.accBeta1.assign(p0(i.beta1,i.iterations_+1)),i.accBeta2.assign(p0(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(Pf);ph(Z$);var J$=function(e){function t(n,r,i,a,o){a===void 0&&(a=null),o===void 0&&(o=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=a,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ge(function(){s.iteration=rt(0).variable(),s.accBeta1=rt(r).variable()}),a==null&&(s.epsilon=te.backend.epsilon()),s}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ge(function(){var a=Qr(1,r.accBeta1),o=ei(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=te.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:wn(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:wn(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),g=c.abs(),m=p.maximum(g);f.assign(h),d.assign(m);var v=o.div(a).mul(h.div(m.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&sn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&sn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(Pf);ph(J$);var PA=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=Array.isArray(n)?n[a].tensor:n[i];if(o!=null){var s=te.registeredVariables[i];ge(function(){var u=r.c.mul(o).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=ac(rt(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(Pf);ph(PA);var Q$=function(e){function t(n,r,i){i===void 0&&(i=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=rt(a.momentum),a}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=te.registeredVariables[i];r.accumulations[a]==null&&(r.accumulations[a]={originalName:i+"/momentum",variable:ge(function(){return wn(o).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[i];u!=null&&ge(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),s.assign(c),o.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&sn(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){return ht(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){return ht(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(PA);ph(Q$);var eL=function(e){function t(n,r,i,a,o){r===void 0&&(r=.9),i===void 0&&(i=0),a===void 0&&(a=null),o===void 0&&(o=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,a==null&&(s.epsilon=te.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Yu(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=te.registeredVariables[i];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:i+"/rms",variable:ge(function(){return wn(o).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:i+"/momentum",variable:ge(function(){return wn(o).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:i+"/mg",variable:ge(function(){return wn(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;ge(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[a].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=o.sub(h);o.assign(p)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(h),p=o.sub(h),o.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&sn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&sn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&sn(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return dt(this,void 0,void 0,function(){var n;return ht(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return dt(this,void 0,void 0,function(){var r;return ht(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(Pf);ph(eL);var Cg=function(){function e(){}return e.sgd=function(t){return new PA(t)},e.momentum=function(t,n,r){return r===void 0&&(r=!1),new Q$(t,n,r)},e.rmsprop=function(t,n,r,i,a){return n===void 0&&(n=.9),r===void 0&&(r=0),i===void 0&&(i=null),a===void 0&&(a=!1),new eL(t,n,r,i,a)},e.adam=function(t,n,r,i){return t===void 0&&(t=.001),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new Z$(t,n,r,i)},e.adadelta=function(t,n,r){return t===void 0&&(t=.001),n===void 0&&(n=.95),r===void 0&&(r=null),new X$(t,n,r)},e.adamax=function(t,n,r,i,a){return t===void 0&&(t=.002),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),a===void 0&&(a=0),new J$(t,n,r,i,a)},e.adagrad=function(t,n){return n===void 0&&(n=.1),new Y$(t,n)},e}(),gh={sgd:Cg.sgd,momentum:Cg.momentum,adadelta:Cg.adadelta,adagrad:Cg.adagrad,rmsprop:Cg.rmsprop,adamax:Cg.adamax,adam:Cg.adam},r5e=typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(e){return e()};function $A(){return new Promise(function(e){return r5e(function(){return e()})})}fn.prototype.add=function(e){return un(this,e)},fn.prototype.broadcastTo=function(e){return i$(this,e)},fn.prototype.div=function(e){return ei(this,e)},fn.prototype.divNoNan=function(e){return fA(this,e)},fn.prototype.squaredDifference=function(e){return pA(this,e)},fn.prototype.tile=function(e){return Rf(this,e)},fn.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),xg(this,e,t,n)},fn.prototype.transpose=function(e){return In(this,e)},fn.prototype.pad=function(e,t){return dc(this,e,t)},fn.prototype.batchNorm=function(e,t,n,r,i){return bg(this,e,t,n,r,i)},Ce=Eze;var i5e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:X$,AdagradOptimizer:Y$,AdamOptimizer:Z$,AdamaxOptimizer:J$,Add:iP,AddN:XLe,BroadcastTo:aP,DataStorage:PP,Div:lx,get ENV(){return wM},Environment:aZ,FromPixels:e4e,FusedBatchNorm:YLe,Identity:sP,KernelBackend:$P,MaxPoolWithArgmax:t4e,MomentumOptimizer:Q$,NonMaxSuppressionV5:QLe,OneHot:oP,Optimizer:Pf,PadV2:lP,RMSPropOptimizer:eL,get Rank(){return PM},get Reduction(){return ya},SGDOptimizer:PA,Square:ZLe,SquaredDifference:cx,Tensor:fn,TensorBuffer:c0,Tile:uP,Transpose:JLe,Variable:J1,abs:ih,acos:cP,acosh:fP,add:un,addN:e$,addStrict:cJ,all:EA,any:Cx,argMax:Ax,argMin:b$,asin:dP,asinh:hP,atan:pP,atan2:OP,atanh:gP,avgPool:xA,avgPool3d:_A,backend:XZ,backend_util:l4e,basicLSTMCell:dee,batchNorm:bg,batchNorm2d:t$,batchNorm3d:n$,batchNorm4d:r$,batchNormalization:EQ,batchNormalization2d:AQ,batchNormalization3d:TQ,batchNormalization4d:IQ,batchToSpaceND:$C,booleanMaskAsync:KQ,broadcastTo:i$,browser:Vee,buffer:Ht,cast:LC,ceil:mP,clipByValue:uo,clone:NQ,complex:$i,concat:Ra,concat1d:JM,concat2d:QM,concat3d:eP,concat4d:tP,conv1d:gA,conv2d:Sg,conv2dTranspose:vA,conv3d:mA,conv3dTranspose:eee,cos:vP,cosh:yP,cumsum:nJ,customGrad:px,deprecationWarn:DC,depthToSpace:nP,depthwiseConv2d:S0,diag:mee,disableDeprecationWarnings:PLe,dispose:sn,disposeVariables:$Le,div:ei,divNoNan:fA,divStrict:fJ,dot:tee,dropout:k$,elu:C0,enableDebugMode:MLe,enableProdMode:FLe,engine:LLe,env:we,equal:_g,equalStrict:zQ,erf:bP,exp:xP,expandDims:Os,expm1:wP,eye:dA,fft:Ox,fill:f0,findBackend:qLe,findBackendFactory:HLe,floor:WC,floorDiv:GC,frame:DA,fused:fh,gather:_0,gatherND:A$,gather_util:n4e,getBackend:WLe,getGradient:SM,getKernel:_M,getKernelsForBackend:EM,grad:a4e,grads:o4e,greater:x0,greaterEqual:_x,greaterEqualStrict:jQ,greaterStrict:UQ,hammingWindow:T$,hannWindow:NA,ifft:A0,imag:uu,image:ch,inTopKAsync:bee,io:lo,irfft:OA,isFinite:uJ,isInf:sJ,isNaN:oJ,keep:ac,leakyRelu:kA,less:d$,lessEqual:h$,lessEqualStrict:WQ,lessStrict:VQ,linalg:I$,linspace:ZM,localResponseNormalization:w$,log:Df,log1p:_P,logSigmoid:aJ,logSoftmax:JC,logSumExp:fee,logicalAnd:fc,logicalNot:a$,logicalOr:lA,logicalXor:DQ,losses:xee,matMul:yA,math:Qze,max:uh,maxPool:bA,maxPool3d:wA,maxPoolWithArgmax:y$,maximum:lc,maximumStrict:dJ,mean:di,memory:RC,min:CA,minimum:h0,minimumStrict:hJ,mod:IP,modStrict:pJ,moments:kx,movingAverage:pee,mul:pt,mulStrict:KC,multiRNNCell:hee,multinomial:o$,neg:ah,nextFrame:$A,norm:_$,notEqual:w0,notEqualStrict:qQ,oneHot:xg,ones:uc,onesLike:Ts,op:ne,outerProduct:nee,pad:dc,pad1d:RQ,pad2d:FQ,pad3d:MQ,pad4d:PQ,pool:lee,pow:p0,powStrict:gJ,prelu:Tx,print:tJ,prod:AA,profile:BLe,rand:$Q,randomGamma:BQ,randomNormal:f$,randomUniform:wg,range:d0,ready:ULe,real:qo,reciprocal:SP,registerBackend:GLe,registerGradient:oZ,registerKernel:CM,relu:lh,relu6:x$,removeBackend:VLe,reshape:el,reverse:hc,reverse1d:ree,reverse2d:iee,reverse3d:aee,reverse4d:oee,rfft:Ix,round:EP,rsqrt:VC,scalar:rt,scatterND:C$,scatter_util:r4e,selu:TA,separableConv2d:v$,serialization:je,setBackend:jLe,setPlatform:KLe,setdiff1dAsync:rP,sigmoid:qC,sign:CP,signal:yee,sin:AP,sinh:kP,slice:Is,slice1d:Sx,slice2d:SA,slice3d:Ex,slice4d:E0,slice_util:i4e,softmax:hg,softplus:fx,spaceToBatchND:BC,sparseToDense:IA,spectral:gee,split:If,sqrt:dx,square:hA,squaredDifference:pA,squaredDifferenceStrict:mJ,squeeze:ux,stack:lu,step:lJ,stft:O$,stridedSlice:S$,sub:Qr,subStrict:vJ,sum:Ei,sumOutType:EC,tan:TP,tanh:HC,tensor:fi,tensor1d:so,tensor2d:sc,tensor3d:PC,tensor4d:nh,tensor5d:QZ,tensor6d:eJ,tensor_util:rc,test_util:eze,tidy:ge,tile:Rf,time:zLe,topk:E$,train:gh,transpose:In,truncatedNormal:wx,unregisterGradient:ELe,unregisterKernel:SLe,unsortedSegmentSum:p$,unstack:rh,util:Ct,valueAndGrad:s4e,valueAndGrads:u4e,variable:YM,variableGrads:SJ,version_core:t5e,webgl:n5e,where:nl,whereAsync:cA,zeros:Kn,zerosLike:wn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Gee=function(e,t){return(Gee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Re(e,t){function n(){this.constructor=e}Gee(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var tL,Dx=function(){return(Dx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function jt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Pt(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Ci(){return tL==null&&(tL=XZ().epsilon()),tL}function rl(){return"channelsLast"}var Ag=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t}(Error),pc=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t}(Error),le=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t}(Error),tn=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t}(Error),a5e=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t}(Error);(function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Re(t,e),t})(Error);function kg(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function gc(e,t){if(!e)throw new a5e(t)}function Kee(e,t){for(var n=0,r=0,i=e;r<i.length;r++)i[r]===t&&n++;return n}function co(e){return e.length===1?e[0]:e}function Cr(e){return Array.isArray(e)?e:[e]}function $f(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Tg(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,function(t,n){return n.toUpperCase()})}var cu={};function nL(e){if(e==null)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function rL(e){if(e!=null&&typeof e=="object")if(Array.isArray(e))e.forEach(function(a){return rL(a)});else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?rL(i):e[r]=i.value)}}function Rx(e,t,n,r,i){var a,o,s;if(t===void 0&&(t={}),n===void 0&&(n={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof e=="string"){var u=e,l=void 0;if(u in n)l=n[u];else if(u in cu)l=cu[u];else if((l=t[u])==null)throw new le("Unknown "+r+": "+e+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=e;if(c.className==null||c.config==null)throw new le(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var f=c.className,d=void 0,h=void 0;if(f in n?(d=(a=n[f])[0],h=a[1]):f in cu?(d=(o=cu.className)[0],h=o[1]):f in t&&(d=(s=t[f])[0],h=s[1]),d==null)throw new le("Unknown "+r+": "+f+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(h!=null){for(var p={},g=0,m=Object.keys(cu);g<m.length;g++)p[S=m[g]]=cu[S];for(var v=0,y=Object.keys(n);v<y.length;v++)p[S=y[v]]=n[S];c.config.customObjects=p;for(var b=Dx({},cu),x=0,w=Object.keys(n);x<w.length;x++){var S=w[x];cu[S]=n[S]}rL(c.config);var C=h(d,c.config,n,i);return cu=Dx({},b),C}b=Dx({},cu);for(var _=0,E=Object.keys(n);_<E.length;_++)S=E[_],cu[S]=n[S];return C=new d(c.config),cu=Dx({},b),C}function o5e(e,t){return e<t?-1:e>t?1:0}function LA(e,t){return-1*o5e(e,t)}function mh(e){if(e==null)return e;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)===-1&&t.push(i)}return t}function s5e(e){if(e==null)throw new le("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function R0(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new le(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function iL(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=1/0),gc(n>=0),gc(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(function(i){return typeof i===t})}function fo(e,t){Array.isArray(e)?(Ct.assert(e.length>0,function(){return t+" is unexpectedly an empty array."}),e.forEach(function(n,r){return fo(n,"element "+(r+1)+" of "+t)})):Ct.assert(Number.isInteger(e)&&e>0,function(){return"Expected "+t+" to be a positive integer, but got "+Xee(e)+"."})}function Xee(e){return e===null?"null":Array.isArray(e)?"["+e.map(function(t){return Xee(t)}).join(",")+"]":typeof e=="string"?'"'+e+'"':""+e}function u5e(e,t){var n,r=Ct.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Ct.now();return o-r<t?n:(r=o,n=e.apply(void 0,i))}}function Yee(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}function aL(e,t){return ge(function(){return dx(Ei(KC(e,e),t,!0))})}var Fx=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.getConfig=function(){return{}},t}(je.Serializable),Zee=function(e){function t(n){var r=e.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Re(t,e),t.prototype.apply=function(n){var r=this;return ge(function(){var i=aL(n,r.axis),a=uo(i,0,r.maxValue);return pt(n,ei(a,un(Ci(),i)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(Fx);je.registerClass(Zee);var Jee=function(e){function t(n){var r=e.call(this)||this;return r.defaultAxis=0,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Re(t,e),t.prototype.apply=function(n){var r=this;return ge(function(){return ei(n,un(Ci(),aL(n,r.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(Fx);je.registerClass(Jee);var Qee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return lh(n)},t.className="NonNeg",t}(Fx);je.registerClass(Qee);var ete=function(e){function t(n){var r=e.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=n.minValue!=null?n.minValue:r.defaultMinValue,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.rate=n.rate!=null?n.rate:r.defaultRate,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Re(t,e),t.prototype.apply=function(n){var r=this;return ge(function(){var i=aL(n,r.axis),a=un(pt(r.rate,uo(i,r.minValue,r.maxValue)),pt(1-r.rate,i));return pt(n,ei(a,un(Ci(),i)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(Fx);je.registerClass(ete);var tte={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ur(e){return nL(e)}function nte(e,t){return t===void 0&&(t={}),Rx(e,je.SerializationMap.getMap().classNameMap,t,"constraint")}function Ai(e){return e==null?null:typeof e=="string"?nte({className:e in tte?tte[e]:e,config:{}}):e instanceof Fx?e:nte(e)}function l5e(e){return new Zee(e)}function c5e(e){return new Jee(e)}function f5e(){return new Qee}function d5e(e){return new ete(e)}Object.freeze({maxNorm:l5e,unitNorm:c5e,nonNeg:f5e,minMaxNorm:d5e});var h5e=["channelsFirst","channelsLast"],p5e=["valid","same","causal"],g5e=["max","avg"],m5e=["sum","mul","concat","ave"],F0=new Map;function ki(e){R0(h5e,"DataFormat",e)}function fu(e){R0(p5e,"PaddingMode",e)}function rte(e){R0(g5e,"PoolMode",e)}var Mx=[],ite="/";function Og(e,t){Mx.push(e);try{var n=t();return Mx.pop(),n}catch(r){throw Mx.pop(),r}}function v5e(){return Mx.length===0?"":Mx.join(ite)+ite}function ate(e){if(!ste(e))throw new Error("Not a valid tensor name: '"+e+"'");return v5e()+e}function ote(e){if(!ste(e))throw new Error("Not a valid tensor name: '"+e+"'");F0.has(e)||F0.set(e,0);var t=F0.get(e);if(F0.set(e,F0.get(e)+1),t>0){var n=e+"_"+t;return F0.set(n,1),n}return e}var y5e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function ste(e){return!!e.match(y5e)}function b5e(e){return e===parseInt(e.toString(),10)}function vh(e,t,n){t==null&&(t=0),n==null&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r}function ute(e){return e=Array.isArray(e)?new Float32Array(e):e,so(e)}function M0(e){return CA(ute(e)).dataSync()[0]}function yh(e){return uh(ute(e)).dataSync()[0]}function il(e,t){if(t<e)throw new le("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function Px(e,t){return e.asType(t)}function $x(e,t){t===void 0&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function x5e(e,t){return ge(function(){if(e.shape.length!==2)throw new le("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return sL($x(e,1),[1,t,1])})}function w5e(e){var t=[vh(e.shape)];return e.reshape(t)}function _5e(e){if(e.rank<=1)throw new le("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],vh(e.shape,1)];return e.reshape(t)}function Ig(e,t,n){return ge(function(){switch(e.rank){case 1:return Sx(e,t,n);case 2:return SA(e,[t,0],[n,e.shape[1]]);case 3:return Ex(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return E0(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Is(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Is(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new le("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}})}function oL(e,t,n){return ge(function(){switch(e.rank){case 1:return Sx(e,t,n);case 2:return SA(e,[0,t],[e.shape[0],n]);case 3:return Ex(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return E0(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new le("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function BA(e,t,n,r){return ge(function(){switch(e.rank){case 1:return Sx(e,t,n);case 2:switch(r){case 1:return Ig(e,t,n);case 2:return oL(e,t,n);default:throw new le("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return Ig(e,t,n);case 2:return Ex(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return oL(e,t,n);default:throw new le("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return Ig(e,t,n);case 2:return E0(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return E0(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return oL(e,t,n);default:throw new le("The axis is not within the rank of the tensor "+r)}default:throw new le("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function lte(e,t){var n;return t===void 0&&(t=-1),t<0&&(t=(n=e[0].rank)!==0?n:0),t===e[0].rank&&(t=-1),Ra(e,t)}function cte(e,t){switch(e.rank){case 1:return JM([e,t]);case 2:return QM([e,t],0);case 3:return eP([e,t],0);case 4:return tP([e,t],0);default:throw new le("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function sL(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new le("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return Rf(e,t)}function zA(e,t,n,r,i){return t===void 0&&(t=0),n===void 0&&(n=1),f$(e,t,n,r,i)}function Lf(e,t,n,r){if(e.rank<2||t.rank<2)throw new tn("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&e.shape.slice(-1)[0]!==(c=t.shape.slice(-2)[0]))throw new tn("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(e.rank===2&&t.rank===2){var i=!1,a=!1;return fh.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?uL(e.rank,r,rl()):null,activation:n})}var o=e.shape.slice(),s=o.pop();e=e.reshape([-1,s]);var u=t.shape.slice(),l=u.pop(),c=u.pop(),f=u.concat([l]),d=Array.from({length:t.rank},function(p,g){return g===0?t.rank-2:g<=t.rank-2?g-1:g});t=t.transpose(d).reshape([c,-1]);var h=o.concat(f);return i=!1,a=!1,fh.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?uL(e.rank,r,rl()):null,activation:n}).reshape(h)}function fte(e,t,n){return ge(function(){return t=Array.isArray(t)?so(t,"int32"):t.toInt(),_0(e,t,n)})}function Lx(e){return KC(e,e)}function uL(e,t,n){var r=t.shape;if(t.rank!==1&&t.rank!==e)throw new le("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(e===5){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new le("Unsupported input rank by biasAdd: "+t.rank)}function Bf(e,t,n){return ge(function(){return n==null&&(n=rl()),ki(n),e.add(uL(e.rank,t,n))})}function S5e(e,t){if(t===void 0&&(t=1),t!==1)throw new tn("Support for alpha values other than 1 ("+t+") is not implemented yet.");return C0(e)}function E5e(e){return ge(function(){return ei(e,ih(e).add(1))})}function dte(e,t,n,r){return ge(function(){return k$(e,t,n,r)})}function C5e(e){return ge(function(){var t=un(.5,pt(.2,e));return uo(t,0,1)})}function P0(e,t,n){return n===void 0&&(n=!1),n?e():t()}var A5e=["fanIn","fanOut","fanAvg"],k5e=["normal","uniform","truncatedNormal"];function T5e(e){R0(A5e,"FanMode",e)}function O5e(e){R0(k5e,"Distribution",e)}var al=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(je.Serializable),hte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n,r){return Kn(n,r)},t.className="Zeros",t}(al);je.registerClass(hte);var lL=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n,r){return uc(n,r)},t.className="Ones",t}(al);je.registerClass(lL);var pte=function(e){function t(n){var r=e.call(this)||this;if(typeof n!="object")throw new le("Expected argument of type ConstantConfig but got "+n);if(n.value===void 0)throw new le("config must have value set but got "+n);return r.value=n.value,r}return Re(t,e),t.prototype.apply=function(n,r){var i=this;return ge(function(){return pt(rt(i.value),uc(n,r))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(al);je.registerClass(pte);var gte=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=n.minval||r.DEFAULT_MINVAL,r.maxval=n.maxval||r.DEFAULT_MAXVAL,r.seed=n.seed,r}return Re(t,e),t.prototype.apply=function(n,r){return wg(n,this.minval,this.maxval,r)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(al);je.registerClass(gte);var mte=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Re(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new tn("randomNormal does not support dType "+r+".");return zA(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(al);je.registerClass(mte);var vte=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Re(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new tn("truncatedNormal does not support dType "+r+".");return wx(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(al);je.registerClass(vte);var yte=function(e){function t(n){var r=e.call(this)||this;return r.gain=n.gain!=null?n.gain:1,r}return Re(t,e),t.prototype.apply=function(n,r){var i=this;return ge(function(){if(n.length!==2||n[0]!==n[1])throw new le("Identity matrix initializer can only be used for 2D square matrices.");return pt(i.gain,dA(n[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(al);function I5e(e,t){var n,r;if(t===void 0&&(t="channelsLast"),ki(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1)if(t==="channelsFirst"){var i=vh(e,2);n=e[1]*i,r=e[0]*i}else t==="channelsLast"&&(i=vh(e,0,e.length-2),n=e[e.length-2]*i,r=e[e.length-1]*i);else{var a=vh(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}je.registerClass(yte);var Go=function(e){function t(n){var r=e.call(this)||this;if(n.scale<0)throw new le("scale must be a positive float. Got: "+n.scale);return r.scale=n.scale==null?1:n.scale,r.mode=n.mode==null?"fanIn":n.mode,T5e(r.mode),r.distribution=n.distribution==null?"normal":n.distribution,O5e(r.distribution),r.seed=n.seed,r}return Re(t,e),t.prototype.apply=function(n,r){var i=I5e(n),a=i[0],o=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,a):this.mode==="fanOut"?s/=Math.max(1,o):s/=Math.max(1,(a+o)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new tn(this.getClassName()+" does not support dType "+r+".");return wx(n,0,u,r,this.seed)}var l=Math.sqrt(3*s);return wg(n,-l,l,r)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(al);je.registerClass(Go);var cL=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="GlorotUniform",t}(Go);je.registerClass(cL);var fL=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="GlorotNormal",t}(Go);je.registerClass(fL);var dL=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="HeNormal",t}(Go);je.registerClass(dL);var hL=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="HeUniform",t}(Go);je.registerClass(hL);var pL=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="LeCunNormal",t}(Go);je.registerClass(pL);var gL=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Re(t,e),t.prototype.getClassName=function(){return Go.className},t.className="LeCunNormal",t}(Go);je.registerClass(gL);var bte=function(e){function t(n){var r=e.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=n.gain==null?r.DEFAULT_GAIN:n.gain,r.seed=n.seed,r.seed!=null)throw new tn("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Re(t,e),t.prototype.apply=function(n,r){var i=this;return ge(function(){if(n.length!==2)throw new tn("The Orthogonal Initializer does not support non-2D shapes yet.");n[0]*n[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+n[0]*n[1]+") elements: Slowness may result.");var a=zA(n[0]>n[1]?[n[1],n[0]]:n,0,1,"float32"),o=I$.gramSchmidt(a);return n[0]>n[1]&&(o=o.transpose()),pt(i.gain,o)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(al);je.registerClass(bte);var xte={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function wte(e,t){return t===void 0&&(t={}),Rx(e,je.SerializationMap.getMap().classNameMap,t,"initializer")}function Pn(e){return nL(e)}function Or(e){if(typeof e=="string"){var t=e in xte?xte[e]:e;if(t==="GlorotNormal")return new fL;if(t==="GlorotUniform")return new cL;if(t==="HeNormal")return new dL;if(t==="HeUniform")return new hL;if(t==="LeCunNormal")return new pL;if(t==="LeCunUniform")return new gL;var n={};return n.className=t,n.config={},wte(n)}return e instanceof al?e:wte(e)}function N5e(){return new hte}function D5e(){return new lL}function R5e(e){return new pte(e)}function F5e(e){return new gte(e)}function M5e(e){return new mte(e)}function P5e(e){return new vte(e)}function $5e(e){return new yte(e)}function L5e(e){return new Go(e)}function B5e(e){return new cL(e)}function z5e(e){return new fL(e)}function j5e(e){return new dL(e)}function U5e(e){return new hL(e)}function W5e(e){return new pL(e)}function V5e(e){return new gL(e)}function q5e(e){return new bte(e)}Object.freeze({zeros:N5e,ones:D5e,constant:R5e,randomUniform:F5e,randomNormal:M5e,truncatedNormal:P5e,identity:$5e,varianceScaling:L5e,glorotUniform:B5e,glorotNormal:z5e,heNormal:j5e,heUniform:U5e,leCunNormal:W5e,leCunUniform:V5e,orthogonal:q5e});var H5e=0;function _te(){return H5e++}var jA={};function UA(e){return e===void 0&&(e=""),e in jA||(jA[e]=0),jA[e]+=1,e+jA[e].toString()}function mL(e){return Array.isArray(e)&&Array.isArray(e[0])}function WA(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Yt(e){var t;if(Array.isArray(e)){if(e.length!==1)throw new le("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function br(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return(e=e)[0];throw new le("Expected exactly 1 Shape; got "+e.length)}return e}function VA(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];i.shape.length===0?t+=1:t+=i.shape.reduce(function(a,o){return a*o})}return t}var Ste="Variable",G5e=function(){function e(t,n,r,i,a){n===void 0&&(n="float32"),r===void 0&&(r=Ste),i===void 0&&(i=!0),a===void 0&&(a=null),this.dtype=n??"float32",this.shape=t.shape,this.id=_te(),r=r??Ste,this.originalName=ate(r),this.name=ote(this.originalName),this.trainable_=i,this.constraint=a,this.val=YM(t,this.trainable_,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(t){return this.assertNotDisposed(),K5e(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),e}();function K5e(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function vL(e){return e.map(function(t){return t.read()})}function yL(e){e.forEach(function(t){t[0].write(t[1])})}var ba=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}(),mc=function(){return function(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=_te(),a!=null&&(this.originalName=ate(a),this.name=ote(this.originalName)),this.rank=t.length}}(),X5e=0,qA=function(){function e(t,n){this.callArgs=n,this.id=X5e++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var r=0,i=t.inboundLayers;r<i.length;r++){var a=i[r];a!=null&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var t=[],n=0,r=this.inboundLayers;n<r.length;n++){var i=r[n];i!=null?t.push(i.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),Y5e=0,Sn=function(e){function t(n){var r=e.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=Y5e++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=n.name;if(!i){var a=r.getClassName();i=$f(a)+"_"+UA(a)}if(r.name=i,r.trainable_=n.trainable==null||n.trainable,n.inputShape!=null||n.batchInputShape!=null){var o=void 0;if(n.batchInputShape!=null)o=n.batchInputShape;else if(n.inputShape!=null){var s=null;n.batchSize!=null&&(s=n.batchSize),o=[s].concat(n.inputShape)}r.batchInputShape=o;var u=n.dtype;u==null&&(u=n.inputDType),u==null&&(u="float32"),r.dtype=u}return n.weights!=null?r.initialWeights=n.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return Re(t,e),t.nodeKey=function(n,r){return n.name+"_ib-"+r.toString()},t.prototype.getNodeAtIndex=function(n,r){if(this.inboundNodes.length===0)throw new pc("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=n)throw new le("Asked to get "+r+" at node "+n+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[n]},t.prototype.getInputAt=function(n){return co(this.getNodeAtIndex(n,"input").inputTensors)},t.prototype.getOutputAt=function(n){return co(this.getNodeAtIndex(n,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Ag("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Ag("Layer "+this.name+" is not connected, no input to return.");return co(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Ag("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Ag("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return co(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(n){return n()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(n){this._built=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this._trainableWeights.forEach(function(r){return r.trainable=n}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(n){return n.trainable}):[]},set:function(n){this._trainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(n){return!n.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(n){this._nonTrainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(n){if(n=Cr(n),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Cr(this.inputSpec);if(n.length!==r.length)throw new le("Layer "+this.name+" expects "+r.length+" inputs, but it received "+n.length+" input tensors. Input received: "+n);for(var i=0;i<n.length;i++){var a=n[i],o=r[i];if(o!=null){var s=a.rank;if(o.ndim!=null&&s!==o.ndim)throw new le("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+s);if(o.maxNDim!=null&&s>o.maxNDim)throw new le("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+s);if(o.minNDim!=null&&s<o.minNDim)throw new le("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+s+".");if(o.dtype!=null&&a.dtype!==o.dtype)throw new le("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+a.dtype+".");if(o.axes){var u=a.shape;for(var l in o.axes){var c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new le("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+f+" but got shape "+u+".")}}if(o.shape!=null)for(var h=0;h<o.shape.length;++h){var p=o.shape[h],g=a.shape[h];if(p!=null&&g!=null&&p!==g)throw new le("Input "+i+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape="+a.shape+".")}}}}},t.prototype.call=function(n,r){return n},t.prototype.invokeCallHook=function(n,r){this._callHook!=null&&this._callHook(n,r)},t.prototype.setCallHook=function(n){this._callHook=n},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(n,r){var i=this;r=r||{},this.assertNotDisposed();for(var a=Cr(n),o=!0,s=0,u=a;s<u.length;s++)if(!(u[s]instanceof mc)){o=!1;break}for(var l=!0,c=0,f=a;c<f.length;c++)if(f[c]instanceof mc){l=!1;break}if(o===l)throw new le("Arguments to apply() must be all SymbolicTensors or all Tensors");return Og(this.name,function(){if(!i.built){i.assertInputCompatibility(n);for(var d=[],h=0,p=Cr(n);h<p.length;h++){var g=p[h];d.push(g.shape)}i.build(co(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(n),l){for(var m=[],v=0,y=Cr(S=i.call(n,r));v<y.length;v++){var b=y[v];a.indexOf(b)!==-1&&(b=b.clone()),m.push(b)}if(S=co(m),i.activityRegularizer!=null)throw new tn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S}var x=Z5e(n),w=i.computeOutputShape(x),S=void 0,C=J5e(n);if(i.warnOnIncompatibleInputShape(Array.isArray(n)?x[0]:x),S=w!=null&&w.length>0&&Array.isArray(w[0])?w.map(function(_,E){return new mc(C,_,i,Cr(n),r,i.name,E)}):new mc(C,w,i,Cr(n),r,i.name),i.addInboundNode(n,S,null,null,x,w,r),i._refCount++,i.activityRegularizer!=null)throw new tn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S})},t.prototype.warnOnIncompatibleInputShape=function(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(n)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,a){i!=null&&n[a]!=null&&n[a]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(n)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ag("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var n=[],r=0,i=this.inboundNodes;r<i.length;r++){var a=i[r],o=JSON.stringify(a.outputShapes);n.indexOf(o)===-1&&n.push(o)}if(n.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new Ag("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new pc("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return VA(this.weights)},t.prototype.build=function(n){this.built=!0},t.prototype.getWeights=function(n){return n===void 0&&(n=!1),vL(n?this.trainableWeights:this.weights)},t.prototype.setWeights=function(n){var r=this;ge(function(){var i=r.weights;if(i.length!==n.length)throw new le('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+n.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+n+"...");if(i.length!==0){for(var a=[],o=vL(i),s=0;s<o.length;++s){var u=o[s],l=i[s],c=n[s];if(!Ct.arraysEqual(u.shape,c.shape))throw new le("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);a.push([l,c])}yL(a)}})},t.prototype.addWeight=function(n,r,i,a,o,s,u){if(this._addedWeightNames.indexOf(n)!==-1)throw new le("Duplicate weight name "+n+" for layer "+this.name);this._addedWeightNames.push(n),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(a=Or("zeros"));var l=a.apply(r,i),c=new G5e(l,i,n,s,u);return l.dispose(),o!=null&&this.addLoss(function(){return o.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},t.prototype.setFastWeightInitDuringBuild=function(n){this.fastWeightInitDuringBuild=n},t.prototype.addLoss=function(n){var r;n==null||Array.isArray(n)&&n.length===0||(n=Cr(n),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,n))},t.prototype.computeOutputShape=function(n){return n},t.prototype.computeMask=function(n,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(a){if(a!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},t.prototype.addInboundNode=function(n,r,i,a,o,s,u){u===void 0&&(u=null);var l=Cr(n);r=Cr(r),i=Cr(i),a=Cr(a),o=WA(o),s=WA(s);for(var c=[],f=[],d=[],h=0,p=l;h<p.length;h++){var g=p[h];c.push(g.sourceLayer),f.push(g.nodeIndex),d.push(g.tensorIndex)}new qA({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:a,inputShapes:o,outputShapes:s},u);for(var m=0;m<r.length;m++)r[m].sourceLayer=this,r[m].nodeIndex=this.inboundNodes.length-1,r[m].tensorIndex=m},t.prototype.getConfig=function(){var n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n},t.prototype.disposeWeights=function(){return this.weights.forEach(function(n){return n.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var n=0;return--this._refCount==0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}},t}(je.Serializable);function Z5e(e){for(var t=[],n=0,r=e=Cr(e);n<r.length;n++){var i=r[n];t.push(i.shape)}return co(t)}function J5e(e){return"float32"}function Ete(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];var r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],a=0;a<r.inboundLayers.length;a++)for(var o=0,s=Ete(r.inputTensors[a],r.inboundLayers[a],r.nodeIndices[a]);o<s.length;o++){var u=s[o];i.indexOf(u)===-1&&i.push(u)}return i}var Cte,Bx=function(e){function t(n){var r=e.call(this,{dtype:n.dtype,name:n.name!=null?n.name:UA("input").toString()})||this;if(n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new le("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=n.batchInputShape;if(i==null){if(n.inputShape==null)throw new le("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new le("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=n.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new mc(r.dtype,r.batchInputShape,r,[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new qA({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return Re(t,e),t.prototype.apply=function(n,r){throw new le("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(Sn);function Ate(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new le("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));var n=e.dtype;return n==null&&(n="float32"),new Bx({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function bh(e){return jt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u;return Pt(this,function(l){switch(l.label){case 0:if(e==null)return[2];for(i in t=[],n=[],r=[],e)typeof(a=e[i])!="number"&&(o=a,t.push(o.data()),n.push(i),r.push(o));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];sn(r),l.label=2;case 2:return[2]}})})}function kte(e){if(e!=null)for(var t in e){var n=e[t];typeof n!="number"&&n.dispose()}}je.registerClass(Bx),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(Cte||(Cte={}));var Q5e=125,$0=function(){function e(){this.validationData=null}return e.prototype.setParams=function(t){this.params=t},e.prototype.onEpochBegin=function(t,n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return[2]})})},e.prototype.onEpochEnd=function(t,n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return[2]})})},e.prototype.onBatchBegin=function(t,n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return[2]})})},e.prototype.onBatchEnd=function(t,n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return[2]})})},e.prototype.onTrainBegin=function(t){return jt(this,void 0,void 0,function(){return Pt(this,function(n){return[2]})})},e.prototype.onTrainEnd=function(t){return jt(this,void 0,void 0,function(){return Pt(this,function(n){return[2]})})},e.prototype.setModel=function(t){},e}(),e6e=function(){function e(t,n){n===void 0&&(n=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=n}return e.prototype.append=function(t){this.callbacks.push(t)},e.prototype.setParams=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setParams(t)},e.prototype.setModel=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setModel(t)},e.prototype.onEpochBegin=function(t,n){return jt(this,void 0,void 0,function(){var r,i;return Pt(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return jt(this,void 0,void 0,function(){var r,i;return Pt(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(t,n){return jt(this,void 0,void 0,function(){var r,i;return Pt(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return jt(this,void 0,void 0,function(){var r,i;return Pt(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(t){return jt(this,void 0,void 0,function(){var n,r;return Pt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainBegin(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(t){return jt(this,void 0,void 0,function(){var n,r;return Pt(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainEnd(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e}(),t6e=function(e){function t(){return e.call(this)||this}return Re(t,e),t.prototype.onEpochBegin=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(n,r){return jt(this,void 0,void 0,function(){var i,a,o,s,u=this;return Pt(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,a=function(c){var f=r[c];if(typeof f=="number")o.totals.hasOwnProperty(c)||(o.totals[c]=0),o.totals[c]=o.totals[c]+f*i;else{var d=void 0;c in o.totals?d=o.totals[c]:o.totals[c]=0;var h=ge(function(){return un(u.totals[c],pt(f,i))});o.totals[c]=h,d!=null&&d.dispose()}},o=this,r)a(s);return[2]})})},t.prototype.onEpochEnd=function(n,r){return jt(this,void 0,void 0,function(){var i,a,o,s,u,l=this;return Pt(this,function(c){if(r!=null)for(i=function(f){if(a.totals[f]==null)return"continue";typeof a.totals[f]=="number"?r[f]=a.totals[f]/a.seen:ge(function(){var d=pt(ei(1,l.seen),l.totals[f]);r[f]=d,l.totals[f].dispose(),ac(r[f])})},a=this,o=0,s=this.params.metrics;o<s.length;o++)u=s[o],i(u);return[2]})})},t}($0),n6e=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.onTrainBegin=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(n,r){return jt(this,void 0,void 0,function(){var i;return Pt(this,function(a){for(i in r==null&&(r={}),this.epoch.push(n),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},t.prototype.syncData=function(){return jt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return Pt(this,function(f){switch(f.label){case 0:for(a in n=[],r=[],i=[],this.history)for(o=this.history[a],s=0;s<o.length;++s)typeof o[s]!="number"&&(u=o[s],n.push(u.data()),r.push(a),i.push(s));return[4,Promise.all(n)];case 1:for(l=f.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},t}($0),r6e=function(e){function t(n,r){var i=e.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=Q5e),i.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Ct.isNumber(i.yieldEvery)&&(i.maybeWait=u5e(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=n.onTrainBegin,i.trainEnd=n.onTrainEnd,i.epochBegin=n.onEpochBegin,i.epochEnd=n.onEpochEnd,i.batchBegin=n.onBatchBegin,i.batchEnd=n.onBatchEnd,i.yield=n.onYield,i}return Re(t,e),t.prototype.maybeWait=function(n,r,i){return jt(this,void 0,void 0,function(){var a;return Pt(this,function(o){switch(o.label){case 0:return a=[],this.yield==null?[3,2]:[4,bh(i)];case 1:o.sent(),a.push(this.yield(n,r,i)),o.label=2;case 2:return a.push($A()),[4,Promise.all(a)];case 3:return o.sent(),[2]}})})},t.prototype.onEpochBegin=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){switch(i.label){case 0:return this.currentEpoch=n,this.epochBegin==null?[3,3]:[4,bh(r)];case 1:return i.sent(),[4,this.epochBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(n,r){return jt(this,void 0,void 0,function(){var i;return Pt(this,function(a){switch(a.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,bh(r)];case 1:a.sent(),i.push(this.epochEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="epoch"&&i.push($A()),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onBatchBegin=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,bh(r)];case 1:return i.sent(),[4,this.batchBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(n,r){return jt(this,void 0,void 0,function(){var i;return Pt(this,function(a){switch(a.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,bh(r)];case 1:a.sent(),i.push(this.batchEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="batch"?i.push($A()):Ct.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,n,r)),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onTrainBegin=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,bh(n)];case 1:return r.sent(),[4,this.trainBegin(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,bh(n)];case 1:return r.sent(),[4,this.trainEnd(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}($0);function Tte(e,t){return e==null&&(e={}),e instanceof $0?[e]:Array.isArray(e)&&e[0]instanceof $0?e:Cr(e).map(function(n){return new r6e(n,t)})}var i6e=function(){function e(){}return e.registerCallbackConstructor=function(t,n){Ct.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),e.checkForDuplicate(n),e.constructors[t]==null&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach(function(r){if(r===t)throw new le("Duplicate callback constructor.")})},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var i=+r;t>=i&&n.push.apply(n,e.constructors[i])}return n.map(function(a){return new a})},e.constructors={},e}();function Ote(e,t,n,r,i,a,o,s,u){var l=new n6e,c=[new t6e].concat(i6e.createCallbacks(t));e!=null&&c.push.apply(c,e),c.push(l);var f=new e6e(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:l}}function ol(e,t,n){return t===void 0&&(t={}),n===void 0&&(n=!1),Rx(e,je.SerializationMap.getMap().classNameMap,t,"layer",n)}function HA(e,t){return ge(function(){e.dtype!=="float32"&&(e=e.asType("float32"));var n=Ei(Lx(e),t,!0),r=f0(n.shape,Ci()),i=dx(lc(n,r));return ei(e,i)})}function Ng(e,t){return ge(function(){return di(Lx(Qr(t,e)),-1)})}function GA(e,t){return ge(function(){return di(ih(Qr(t,e)),-1)})}function L0(e,t){return ge(function(){var n=Qr(e,t),r=uo(ih(e),Ci(),Number.MAX_VALUE),i=ih(ei(n,r));return pt(100,di(i,-1))})}function a6e(e,t){return ge(function(){var n=uo(t,Ci(),Number.MAX_VALUE),r=Df(un(1,n)),i=uo(e,Ci(),Number.MAX_VALUE),a=Df(un(1,i));return di(Lx(Qr(r,a)),-1)})}function o6e(e,t){return ge(function(){var n=lc(0,Qr(1,pt(e,t)));return di(Lx(n),-1)})}function s6e(e,t){return ge(function(){var n=lc(0,Qr(1,pt(e,t)));return di(n,-1)})}function u6e(e,t){return ge(function(){var n=Ei(pt(e,t),-1),r=uh(pt(Qr(1,e),t),-1);return lc(0,un(1,Qr(r,n)))})}function l6e(e,t){return ge(function(){var n=Math.log(2),r=Qr(t,e),i=Qr(un(r,fx(pt(-2,r))),n);return di(i,-1)})}function zx(e,t,n){return n===void 0&&(n=!1),ge(function(){if(n)t=hg(t);else{var r=Ei(t,t.shape.length-1,!0);t=ei(t,r)}return t=uo(t,Ci(),1-Ci()),ah(Ei(pt(e.toFloat(),Df(t)),t.shape.length-1))})}function KA(e,t){return ge(function(){var n=WC(w5e(e)).toInt(),r=(t=uo(t,Ci(),1-Ci())).shape;return zx(xg(n,r[r.length-1]).reshape(r),t,!1)})}function c6e(e,t){if(!Ct.arraysEqual(e.shape,t.shape))throw new le("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return ge(function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())})}function XA(e,t){return ge(function(){var n;return n=uo(t,Ci(),1-Ci()),n=Df(ei(n,Qr(1,n))),di(c6e(e,n),-1)})}function f6e(e,t){return ge(function(){var n=uo(e,Ci(),1),r=uo(t,Ci(),1);return Ei(pt(e,Df(ei(n,r))),-1)})}function d6e(e,t){return ge(function(){var n=Df(un(Ci(),t));return di(Qr(t,pt(e,n)),-1)})}function bL(e,t){return ge(function(){var n=HA(e,-1),r=HA(t,-1),i=pt(n,r);return ah(Ei(i,-1))})}var YA={meanSquaredError:Ng,meanAbsoluteError:GA,meanAbsolutePercentageError:L0,meanSquaredLogarithmicError:a6e,squaredHinge:o6e,hinge:s6e,categoricalHinge:u6e,logcosh:l6e,categoricalCrossentropy:zx,sparseCategoricalCrossentropy:KA,binaryCrossentropy:XA,kullbackLeiblerDivergence:f6e,poisson:d6e,cosineProximity:bL};function xL(e){if(typeof e=="string"){if(e in YA)return YA[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new le(t)}return e}function wL(e,t){return ge(function(){var n=pt(.5,Ts(t)),r=Px(x0(t,n),e.dtype);return di(_g(e,r),-1)})}function _L(e,t){return ge(function(){return Px(_g(Ax(e,-1),Ax(t,-1)),"float32")})}function Ite(e,t){return ge(function(){return fc(e.equal(1),t.equal(1)).sum().cast("float32")})}function h6e(e,t){return ge(function(){return fc(e.equal(1),t.equal(0)).sum().cast("float32")})}function p6e(e,t){return ge(function(){return fc(e.equal(0),t.equal(1)).sum().cast("float32")})}function Nte(e,t){return ge(function(){var n=Ite(e,t),r=p6e(e,t),i=n.add(r);return nl(x0(i,0),n.div(i),0).cast("float32")})}function g6e(e,t){return ge(function(){var n=Ite(e,t),r=h6e(e,t),i=n.add(r);return nl(x0(i,0),n.div(i),0).cast("float32")})}function Dte(e,t){return XA(e,t)}function Rte(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),_g(e,t).asType("float32")}var m6e=Ng,v6e=Ng,y6e=GA,b6e=GA,x6e=L0,w6e=L0,SL=zx,_6e=bL,Fte=KA,ZA={binaryAccuracy:wL,categoricalAccuracy:_L,precision:Nte,categoricalCrossentropy:SL,sparseCategoricalCrossentropy:Fte,mse:m6e,MSE:v6e,mae:y6e,MAE:b6e,mape:x6e,MAPE:w6e,cosine:_6e};function S6e(e){if(typeof e=="string"&&e in ZA)return ZA[e];if(typeof e!="string"&&e!=null)return e;throw new le("Unknown metric "+e)}function JA(e){if(gc(e!==null,"Unknown LossOrMetricFn "+e),typeof e=="string")return e;for(var t=void 0,n=0,r=Object.keys(YA);n<r.length;n++){var i=r[n];if(YA[i]===e){t=i;break}}if(t!==void 0)return t;for(var a=0,o=Object.keys(ZA);a<o.length;a++)if(i=o[a],ZA[i]===e){t=i;break}return t!==void 0?t:e.name}function E6e(e){var t={Adagrad:function(){return gh.adagrad(.01)},Adadelta:function(){return gh.adadelta(1,.95,Ci())},Adam:function(){return gh.adam(.001,.9,.999,Ci())},Adamax:function(){return gh.adamax(.002,.9,.999,Ci(),0)},RMSProp:function(){return gh.rmsprop(.001,.9,0,Ci())},SGD:function(){return gh.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new le("Unknown Optimizer "+e)}var Mte=1048576;function Pte(e,t,n){if(n===void 0&&(n=!1),e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!EL(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>Mte&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+Mte+".")}}function EL(e){if(e===null)return!0;if(typeof e=="object"){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(typeof r!="string"||!EL(e[r]))return!1}return!0}if(Array.isArray(e)){for(var i=0,a=e;i<a.length;i++)if(!EL(a[i]))return!1;return!0}return!1}var o=typeof e;return o==="string"||o==="number"||o==="boolean"}function C6e(e,t,n,r){r===void 0&&(r=console.log);var i,a=k6e(e),o=["Layer (type)","Output shape","Param #"];if(a?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(d){return Math.floor(t*d)})),!a)for(var s in o.push("Receives inputs"),i=[],e.nodesByDepth)i.push.apply(i,e.nodesByDepth[s]);r("_".repeat(t)),QA(o,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)a?T6e(u[l],n,r):O6e(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=A6e(e),f=VA(e.nonTrainableWeights);r("Total params: "+(c+f)),r("Trainable params: "+c),r("Non-trainable params: "+f),r("_".repeat(t))}function A6e(e){return e.collectedTrainableWeights!=null?VA(e.collectedTrainableWeights):VA(e.trainableWeights)}function k6e(e){var t=!0,n=[],r=[];for(var i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,f=0,d=l[u].inboundNodes;f<d.length;f++){var h=d[f];if(r.indexOf(h)!==-1){if(c){t=!1;break}c=!0}}if(!t)break}return t}function QA(e,t,n){n===void 0&&(n=console.log);for(var r="",i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[i]).slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function T6e(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(i){r="multiple"}QA([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function O6e(e,t,n,r){var i;try{i=JSON.stringify(e.outputShape)}catch(m){i="multiple"}for(var a=[],o=0,s=e.inboundNodes;o<s.length;o++){var u=s[o];if(!(n!=null&&n.length>0&&n.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,f=u.nodeIndices[l],d=u.tensorIndices[l];a.push(c+"["+f+"]["+d+"]")}}var h=e.name,p=e.getClassName(),g=a.length===0?"":a[0];for(QA([h+" ("+p+")",i,e.countParams().toString(),g],t,r),l=1;l<a.length;++l)QA(["","","",a[l]],t,r)}function $te(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function jx(e,t){if(e===null)return null;if(typeof e=="string")return Tg(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];$te(t,i,a)?n.push(a):n.push(jx(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if(l==="name"&&typeof c=="string")o[l]=c;else{var f=Tg(l);o[f]=jx(c,f)}}return o}function CL(e,t){if(e==null)return null;if(typeof e=="string")return $f(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];$te(t,i,a)?n.push(a):n.push(CL(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],f=$f(l);o[f]=l!=="name"&&l!=="className"||typeof c!="string"?CL(c,l):c}return o}var Lte="1.7.4";function I6e(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return LC(t,e.dtype)}catch(n){throw new le("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}var B0=function(){function e(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(var r=0,i=t;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return e.prototype.add=function(t,n,r){if(this.id2Value[t.id]!=null)throw new le("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=I6e(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r),this},e.prototype.addFeed=function(t){this.add(t.key,t.value)},e.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(t){if(t instanceof mc){if(this.id2Value[t.id]==null)throw new le("Nonexistent key: "+t.name);return this.id2Value[t.id]}var n=this.name2Id[t];if(n==null)throw new le("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[n]},e.prototype.getMask=function(t){if(t instanceof mc){if(this.id2Value[t.id]==null)throw new le("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var n=this.name2Id[t];if(n==null)throw new le("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[n]},e.prototype.disposeMasks=function(){this.id2Mask!=null&&sn(this.id2Mask)},e}(),AL={},Bte={};function Ux(e,t,n,r){for(var i=n!=null&&n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(function(Q){return Q.name}),u=[],l=t.names(),c=0,f=s;c<f.length;c++){var d=f[c];l.indexOf(d)!==-1?u.push(t.getValue(d)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p,g=s.join(",")+"|"+t.names().join(",");if(AL[g]==null){var m=N6e(o,t);h=m.sorted,p=m.recipientCounts,AL[g]=h,Bte[g]=p}h=AL[g],p={},i||Object.assign(p,Bte[g]);for(var v=new B0(t),y=0;y<h.length;++y){if(r!=null){var b=RC().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=h[y],w=x.sourceLayer;if(!(w instanceof Bx)){for(var S=[],C=[],_=[],E=!1,A=0,k=x.inputs;A<k.length;A++){var T=k[A],I=v.getValue(T),N=v.getMask(T);S.push(I),C.push(N),N!=null&&(E=!0),i||(p[T.name]--,p[T.name]!==0||t.hasKey(T)||s.indexOf(T.name)!==-1||I.isDisposed||T.sourceLayer.stateful===!0||_.push(I))}E&&((n=n||{}).mask=C[0]);var O=Cr(w.apply(S,n)),D=null;w.supportsMasking&&(D=w.computeMask(S,C));for(var P=R6e(x),V=Array.isArray(P)?P:[P],Y=0;Y<V.length;++Y){v.hasKey(V[Y])||v.add(V[Y],O[Y],Array.isArray(D)?D[0]:D);var X=s.indexOf(V[Y].name);X!==-1&&(u[X]=O[Y])}i||sn(_)}}return v.disposeMasks(),a?u:u[0]}function N6e(e,t){Ct.assert(e!=null&&e.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(e.length===1){var i=zte(e[0],t);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=e;o<s.length;o++){for(var u=zte(s[o],t),l=u.sorted,c=u.recipientMap,f=0,d=l;f<d.length;f++){var h=d[f];a.has(h.name)||(n.push(h),a.add(h.name))}var p=function(m){r[m]==null&&(r[m]=new Set),c[m].forEach(function(v){return r[m].add(v)})};for(var g in c)p(g)}return{sorted:n,recipientCounts:D6e(r)}}function D6e(e){var t={};for(var n in e)t[n]=e[n].size;return t}function zte(e,t){for(var n=new Set,r=[],i={},a=0,o=t.names();a<o.length;a++){var s=o[a];n.add(s)}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(n.has(c.name))u.pop();else{var f=l[l.length-1]===u.length-1;if(c.inputs.length===0||f)u.pop(),r.push(c),n.add(c.name),f&&l.pop();else{l.push(u.length-1);for(var d=0,h=c.inputs;d<h.length;d++){var p=h[d];i[p.name]==null&&(i[p.name]=new Set),i[p.name].add(c.name),n.has(p.name)||u.push(p)}}}}return{sorted:r,recipientMap:i}}function R6e(e){var t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var i=0,a=e.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var F6e=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=UA(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],mh(r.inputs).length!==r.inputs.length)throw new le("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(et){return et.name}));mh(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(et){return et.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(A=o[a]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,f=r.inputs;c<f.length;c++)s=(A=f[c]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex,gc(u===0,"input layer has >1 nodes"),gc(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof Bx))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,p=r.outputLayers;h<p.length;h++)s=p[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(et){return et.shape}),r.internalOutputShapes=r.outputs.map(function(et){return et.shape});for(var g={},m={},v={},y={},b={},x=[],w=function(et,Gt,rn,kn,Br,Jn){kn!=null&&Br!=null&&Jn!=null||(kn=et.sourceLayer,Br=et.nodeIndex,Jn=et.tensorIndex);var _n=kn.inboundNodes[Br];if(rn.indexOf(_n)!==-1)throw new pc("The tensor "+et.name+' at layer "'+kn.name+'" is part of a cycle.');if(Gt.indexOf(_n)===-1){r.containerNodes.add(t.nodeKey(kn,Br)),kn.id in b||(b[kn.id]=Object.keys(b).length),rn.indexOf(_n)===-1&&rn.push(_n);for(var Xi=_n.inboundLayers.length,kr=0;kr<Xi;kr++){var ms=_n.inputTensors[kr],$o=_n.inboundLayers[kr],vs=_n.nodeIndices[kr],Ru=_n.tensorIndices[kr];w(ms,Gt,rn,$o,vs,Ru)}for(Gt.push(_n);rn.indexOf(_n)>=0;)rn.splice(rn.indexOf(_n),1);x.push(_n)}},S=[],C=[],_=0,E=r.outputs;_<E.length;_++){var A=E[_];w(A,S,C)}for(var k=0,T=x.slice().reverse();k<T.length;k++){m[(z=T[k]).id]=z,z.id in g||(g[z.id]=0);var I=g[z.id],N=v[z.outboundLayer.id]==null?0:v[z.outboundLayer.id];for(I=Math.max(I,N),v[z.outboundLayer.id]=I,y[z.outboundLayer.id]=z.outboundLayer,g[z.id]=I,d=0;d<z.inboundLayers.length;d++){var O=z.inboundLayers[d],D=(u=z.nodeIndices[d],O.inboundNodes[u]),P=g[D.id]==null?0:g[D.id];g[D.id]=Math.max(I+1,P),m[D.id]=D}}var V={};for(var Y in g)(I=g[Y])in V||(V[I]=[]),V[I].push(m[Y]);var X={};for(var Q in v)(I=v[Q])in X||(X[I]=[]),X[I].push(y[Q]);var me=Object.keys(X).map(function(et){return parseInt(et,10)}).sort(LA);r.layers=[];for(var ce=0,Ne=me;ce<Ne.length;ce++){var Oe=X[I=Ne[ce]];Oe.sort(function(et,Gt){var rn=b[et.id],kn=b[Gt.id];return rn<kn?-1:rn>kn?1:0});for(var $e=0,ve=Oe;$e<ve.length;$e++)(s=ve[$e])instanceof t&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=X,me=Object.keys(V).map(function(et){return parseInt(et,10)}).sort(LA);for(var $=r.inputs.slice(),F=[],q=0,ue=me;q<ue.length;q++)for(var J=0,L=V[I=ue[q]];J<L.length;J++){var z;if((s=(z=L[J]).outboundLayer)!=null){for(var R=0,Z=z.inputTensors;R<Z.length;R++)if(A=Z[R],$.indexOf(A)===-1)throw new pc("Graph disconnected: cannot obtain value for tensor "+A+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+F);for(var xe=0,Ee=z.outputTensors;xe<Ee.length;xe++)A=Ee[xe],$.push(A);F.push(s.name)}}r.nodesByDepth=V;for(var Me=r.layers.map(function(et){return et.name}),Ve=function(et){var Gt=Me.filter(function(rn){return rn===et}).length;if(Gt!==1)throw new pc('The name "'+et+'" is used '+Gt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(Me))},Je=0,Ft=Me;Je<Ft.length;Je++)Ve(Ft[Je]);return r.outboundNodes=[],r.inboundNodes=[],new qA({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(et){return null}),outputMasks:r.outputs.map(function(et){return null}),inputShapes:r.inputs.map(function(et){return et.shape}),outputShapes:r.outputs.map(function(et){return et.shape})}),r.built=!0,r._refCount=1,r}return Re(t,e),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var a=i[r];n.numDisposedVariables+=a.dispose().numDisposedVariables}for(var o=0,s=this.internalContainerRefs;o<s.length;o++){var u=s[o];n.numDisposedVariables+=u.dispose().numDisposedVariables}}return n.refCountAfterDispose=this._refCount,n},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=n})}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new le("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n=n.concat(a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.layers;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(n,r){r===void 0&&(r=!0);for(var i={},a=0,o=0,s=this.layers;o<s.length;o++)for(var u=0,l=s[o].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new le("Duplicate weight name: "+c.originalName);i[c.originalName]=c,a++}var f=[];for(var d in n){if(i[d]!=null)f.push([i[d],n[d]]);else if(r)throw new le("Provided weight data has no target variable: "+d);delete i[d]}if(r){var h=[];for(var p in i)h.push(p);if(h.length>0)throw new le(h.length+" of "+a+" weights are not set: "+h)}yL(f)},t.prototype.updatedConfig=function(){var n=this.getConfig(),r={};return r.className=this.getClassName(),r.config=n,r.kerasVersion="tfjs-layers "+Lte,r.backend="TensorFlow.js",r},t.prototype.toJSON=function(n,r){r===void 0&&(r=!0);var i=CL(this.updatedConfig());return r?JSON.stringify(i):i},t.prototype.call=function(n,r){var i=this;return ge(function(){n=Cr(n);for(var a=new B0,o=0;o<i.inputs.length;++o)a.add(i.inputs[o],n[o]);return Ux(i.outputs,a,r)})},t.prototype.computeMask=function(n,r){var i=this;return ge(function(){var a;return n=Cr(n),a=r==null?kg(null,n.length):Cr(r),i.runInternalGraph(n,a)[1]})},t.prototype.computeOutputShape=function(n){var r=WA(n);if(r.length!==this.inputLayers.length)throw new le("Invalid inputShape argument "+n+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},a=0;a<r.length;a++){var o=this.inputLayers[a],s=r[a];i[E=o.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(k){return parseInt(k,10)}).sort(LA);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){var p=h[d];if(o=p.outboundLayer,this.inputLayers.map(function(k){return k.id}).indexOf(o.id)===-1){for(var g=[],m=0;m<p.inboundLayers.length;m++){var v=p.inboundLayers[m],y=p.nodeIndices[m],b=p.tensorIndices[m],x=i[E=v.name+"_"+y+"_"+b];g.push(x)}var w=WA(o.computeOutputShape(co(g))),S=o.inboundNodes.indexOf(p);for(m=0;m<w.length;m++)i[E=o.name+"_"+S+"_"+m]=w[m]}}var C=[],_=[];for(a=0;a<this.outputLayers.length;a++){o=this.outputLayers[a],S=this.outputLayersNodeIndices[a],b=this.outputLayersTensorIndices[a];var E=o.name+"_"+S+"_"+b;_.push(E)}for(a=0;a<_.length;a++){var A=_[a];gc(A in i),C.push(i[A])}return co(C)},t.prototype.runInternalGraph=function(n,r){r==null&&(r=kg(null,n.length));for(var i={},a=0;a<this.inputs.length;++a){var o=this.inputs[a],s=n[a],u=r[a];i[o.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(X){return parseInt(X,10)}).sort(LA);l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){for(var p=h[d],g=p.outboundLayer,m=p.inputTensors,v=p.outputTensors,y=new Array,b=0,x=m;b<x.length;b++)(o=x[b]).id in i&&y.push(i[o.id]);if(y.length===m.length){var w={},S=void 0,C=void 0,_=void 0,E=void 0;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){var A=y[0],k=A[0],T=A[1];w.mask==null&&(w.mask=T),_=Cr(g.call(k,w)),E=Cr(g.computeMask(k,T)),S=[k],C=[T]}else S=y.map(function(X){return X[0]}),C=y.map(function(X){return X[1]}),w.mask==null&&(w.mask=C),_=Cr(g.call(S,w)),E=Cr(g.computeMask(S,C));if(g.activityRegularizer)throw new tn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<v.length;++a)o=v[a],s=_[a],u=E[a],i[o.id]=[s,u]}}for(var I=[],N=[],O=[],D=0,P=this.outputs;D<P.length;D++){gc((o=P[D]).id in i,"Could not compute output "+o.name+" : "+o.id);var V=i[o.id],Y=V[0];u=V[1],O.push(Y.shape),I.push(Y),N.push(u)}return[I,N,O]},t.prototype.buildNodeConversionMap=function(n){for(var r,i={},a=0,o=this.layers;a<o.length;a++){var s=o[a];r=s instanceof t?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=t.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},t.prototype.getLayer=function(n,r){if(r!=null){if(this.layers.length<=r)throw new le("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(n==null)throw new le("Provide either a layer name or layer index");for(var i=0,a=this.layers;i<a.length;i++){var o=a[i];if(o.name===n)return o}throw new le("No such layer: "+n)},t.prototype.calculateLosses=function(){var n=this;return ge(function(){for(var r=[],i=0,a=n.layers;i<a.length;i++)for(var o=a[i],s=0;s<o.inboundNodes.length;++s){var u=t.nodeKey(o,s);n.containerNodes.has(u)&&r.push.apply(r,o.calculateLosses())}return r})},t.prototype.getConfig=function(){for(var n={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=0,o=this.layers;a<o.length;a++){for(var s=(w=o[a]).getClassName(),u=w.getConfig(),l=[],c=0;c<w.inboundNodes.length;c++){var f=w.inboundNodes[c],d=t.nodeKey(w,c),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(_){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+f.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],v=f.nodeIndices[g],y=f.tensorIndices[g];(C=r[t.nodeKey(m,v)])==null&&(C=0),p.push([m.name,C,y,h])}l.push(p)}}}var b={};b.name=w.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}n.layers=i;var x=[];for(g=0;g<this.inputLayers.length;g++){var w=this.inputLayers[g];v=this.inputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)&&((C=r[d])!==null&&C!==void 0||(C=0),y=this.inputLayersTensorIndices[g],x.push([w.name,C,y]))}n.inputLayers=x;var S=[];for(g=0;g<this.outputLayers.length;g++)if(w=this.outputLayers[g],v=this.outputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)){var C;(C=r[d])!==null&&C!==void 0||(C=0),y=this.outputLayersTensorIndices[g],S.push([w.name,C,y])}return n.outputLayers=S,n},t.fromConfig=function(n,r,i,a){a===void 0&&(a=!1);var o={},s={};function u(D,P){D.name in s?s[D.name].push(P):s[D.name]=[P]}function l(D,P){for(var V,Y=[],X=0,Q=P;X<Q.length;X++){var me=Q[X],ce=me[0],Ne=me[1],Oe=me[2];if(V=me[3]==null?{}:me[3],!(ce in o))return void u(D,P);var $e=o[ce];if($e.inboundNodes.length<=Ne)return void u(D,P);var ve=$e.inboundNodes[Ne];Y.push(ve.outputTensors[Oe])}Y.length>0&&D.apply(co(Y),V)}function c(D){var P=D.name,V=ol(D,r.customObjects!=null?r.customObjects:{});V.setFastWeightInitDuringBuild(a),o[P]=V,D.inboundNodes.forEach(function(Y){if(!(Y instanceof Array))throw new le("Corrupted configuration, expected array for nodeData: "+Y);u(V,Y)})}for(var f=r.name,d=r.layers,h=0,p=d;h<p.length;h++)c(v=p[h]);for(;!s5e(s);)for(var g=0,m=d;g<m.length;g++){var v=m[g];if((O=o[v.name]).name in s){var y=s[O.name];delete s[O.name];for(var b=0,x=y;b<x.length;b++)l(O,x[b])}}for(var w=[],S=[],C=0,_=r.inputLayers;C<_.length;C++){var E=(v=_[C])[0],A=v[1],k=v[2];gc(E in o);var T=(O=o[E]).inboundNodes[A].outputTensors;w.push(T[k])}for(var I=0,N=r.outputLayers;I<N.length;I++){E=(v=N[I])[0],A=v[1],k=v[2],gc(E in o);var O;T=(O=o[E]).inboundNodes[A].outputTensors,S.push(T[k])}return new n({inputs:w,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new le("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var n=0,r=this.layers;n<r.length;n++)if(r[n].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var n=this;ge(function(){n.layers.forEach(function(r){r.stateful&&r.resetStates()})})},t}(Sn);function M6e(e,t,n){var r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(a){return null});if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided "+n+" is an array of "+e.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return e}if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){var i=[];return t.forEach(function(a){a in e?i.push(e[a]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+t+" keys. Provided "+n+" not understood: "+JSON.stringify(e))}function jte(e,t){return M6e(e,t,"classWeight")}function Ute(e,t,n,r){return jt(this,void 0,void 0,function(){var i,a,o,s,u;return Pt(this,function(l){switch(l.label){case 0:if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return n==null?[3,2]:(i=ge(function(){if(e.shape.length===1)return e.clone();if(e.shape.length===2){if(e.shape[1]>1)return e.argMax(1);if(e.shape[1]===1)return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+e.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+e.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[l.sent()]),sn(i),u=[],a.forEach(function(c){if(n[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(n[c])}),[2,so(u,"float32")];case 2:return[2,null]}})})}function P6e(e,t){return pt(e,t)}var $6e=32;function Wte(e,t){var n,r,i=t;n=i.xs,r=i.ys,Ct.assert(n!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var a=Vte("input",e.inputNames,n),o=Vte("output",e.outputNames,r),s=a[0].shape[0];Ct.assert(a.length===e.inputs.length,function(){return"LayersModel has "+e.inputs.length+" inputs, but the dataset provides "+a.length+" inputs.  (Expected input keys: "+JSON.stringify(e.inputNames)+")"}),Ct.assert(o.length===e.outputs.length,function(){return"LayersModel has "+e.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(e.outputNames)+")"});for(var u=function(d){Ct.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: input "+e.inputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},l=0;l<a.length;l++)u(l);for(var c=function(d){Ct.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: output "+e.outputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},f=0;f<o.length;f++)c(f);return{xs:a,ys:o}}function Vte(e,t,n){if(n instanceof fn)return[n];if(Array.isArray(n))return Ct.assert(n.length===t.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+t.length+" to match the "+e+" keys "+t+"."}),n;for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i];if(n[o]==null)throw new le("The feature data generated by the dataset lacks the required "+e+" key '"+o+"'.");r.push(n[o])}return r}function L6e(e){if(e.length===3)throw new tn("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function B6e(e,t,n){return jt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,P,V,Y,X;return Pt(this,function(Q){switch(Q.label){case 0:if(r=n.batchesPerEpoch!=null,Ct.assert(e.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),Ct.assert(n!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),Ct.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),Ct.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),Ct.assert(n.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,Q.label=1;case 1:return Q.trys.push([1,,26,27]),i=n.validationData!=null,a=void 0,o=void 0,i&&(qte(n.validationData)?Ct.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(s=L6e(n.validationData),a=s.xs,o=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(me){return"val_"+me})):l.slice(),f=Tte(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,h=Ote(f,d,n.epochs,null,null,z6e(t,n),null,i,c),p=h.callbackList,g=h.history,p.setModel(e),e.history=g,[4,p.onTrainBegin()];case 2:return Q.sent(),e.stopTraining_=!1,m=n.initialEpoch==null?0:n.initialEpoch,[4,t.iterator()];case 3:v=Q.sent(),Q.label=4;case 4:return m<n.epochs?(y={},[4,p.onEpochBegin(m)]):[3,23];case 5:return Q.sent(),b=0,x=0,r?[3,7]:[4,t.iterator()];case 6:v=Q.sent(),Q.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,v.next()]:[3,21];case 8:return w=Q.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):w.value==null?[3,15]:(S=Wte(e,w.value),C=S.xs,_=S.ys,(E={}).batch=x,E.size=C[0].shape[0],[4,p.onBatchBegin(x,E)]);case 9:if(Q.sent(),A=[],n.classWeight==null)return[3,13];k=jte(n.classWeight,e.outputNames),X=0,Q.label=10;case 10:return X<k.length?(I=(T=A).push,[4,Ute(_[X],null,k[X])]):[3,13];case 11:I.apply(T,[Q.sent()]),Q.label=12;case 12:return++X,[3,10];case 13:for(N=C.concat(_).concat(A),O=u(N),sn(N),X=0;X<l.length;++X)D=l[X],P=O[X],E[D]=P,ac(P);return[4,p.onBatchEnd(x,E)];case 14:Q.sent(),kte(E),x++,b++,Q.label=15;case 15:return(r?b>=n.batchesPerEpoch:w.done)?i?(V=void 0,qte(n.validationData)?(Y=Cr,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return V=Y.apply(void 0,[Q.sent()]),[3,18];case 17:V=Cr(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?$6e:n.validationBatchSize,verbose:0})),Q.label=18;case 18:for(X=0;X<e.metricsNames.length;++X)y["val_"+e.metricsNames[X]]=V[X];Q.label=19;case 19:return[3,21];case 20:return e.stopTraining_?[3,21]:[3,7];case 21:return[4,p.onEpochEnd(m,y)];case 22:return Q.sent(),m++,e.stopTraining_?[3,23]:[3,4];case 23:return[4,p.onTrainEnd()];case 24:return Q.sent(),[4,e.history.syncData()];case 25:return Q.sent(),[2,e.history];case 26:return e.isTraining=!1,[7];case 27:return[2]}})})}function z6e(e,t){var n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function qte(e){return typeof e.iterator=="function"}function j6e(e){return typeof e.next=="function"}function U6e(e,t,n){return jt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d;return Pt(this,function(h){switch(h.label){case 0:if(r=(n=n||{}).batches!=null,i=e.testFunction,a=[],n.verbose>0)throw new tn("Verbose mode is not implemented yet.");return Ct.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),j6e(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,l=0,c=function(){var p;return Pt(this,function(g){switch(g.label){case 0:return[4,o.next()];case 1:return p=g.sent(),a=ge(function(){if(p.value){var m=Wte(e,p.value),v=m.xs,y=m.ys,b=v.concat(y),x=ge(function(){return i(b)});if(sn(b),l===0)for(var w=0;w<x.length;++w)a.push(rt(0));var S=b[0].shape[0],C=function(_){var E=x[_],A=a[_];a[_]=ge(function(){return un(a[_],pt(S,E))}),l>0&&sn(A)};for(w=0;w<x.length;++w)C(w);sn(x),u+=S,++l}return a}),p.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},h.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return h.sent()==="break"?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)d=a[f],a[f]=ei(a[f],u),sn(d);return[2,co(a)]}})})}function kL(e){Ct.assert(e>0&&Number.isInteger(e),function(){return"batchSize is required to be a positive integer, but got "+e})}function Wx(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(function(r){return Ig(r,t,n-t)}):Ig(e,t,n-t)}function TL(e,t){return ge(function(){return e==null?null:Array.isArray(e)?e.map(function(n){return TL(n,t)}):fte(e,t.dtype==="int32"?t:t.toInt())})}function OL(e,t){for(var n=[],r=0,i=null;r<e;)(i=r+t)>=e&&(i=e),n.push([r,i]),r=i;return n}function W6e(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p){return jt(this,void 0,void 0,function(){var g,m,v,y,b,x,w,S;return Pt(this,function(C){switch(C.label){case 0:if(i==null&&(i=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0),g=!1,u!=null&&l!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new le("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(m=e.checkNumSamples(n,i,h,"steps_per_epoch"))!=null&&(v=il(0,m)),o==null&&(o=1),y=Ote(s,o,a,d,m,h,i,g,f),b=y.callbackList,x=y.history,b.setModel(e),e.history=x,[4,b.onTrainBegin()];case 1:C.sent(),e.stopTraining_=!1,w=function(_){var E,A,k,T,I;return Pt(this,function(N){switch(N.label){case 0:return[4,b.onEpochBegin(_)];case 1:if(N.sent(),E={},h==null)return[3,2];throw new tn("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new tn("batch shuffling is not implemneted yet");c&&Ct.shuffle(v),A=so(v),k=OL(m,i),T=function(O){var D;return Pt(this,function(P){switch(P.label){case 0:return D={},[4,b.onBatchBegin(O,D)];case 1:return P.sent(),ge(function(){var V=k[O][0],Y=k[O][1],X=Ig(A,V,Y-V);D.batch=O,D.size=Y-V;for(var Q=TL(n,X),me=t(Q),ce=0;ce<r.length;++ce){var Ne=r[ce],Oe=me[ce];D[Ne]=Oe,ac(Oe)}if(O===k.length-1&&g){var $e=e.testLoop(u,l,i);for(ce=0;ce<r.length;++ce)Ne=r[ce],Oe=$e[ce],ac(Oe),E["val_"+Ne]=Oe}}),[4,b.onBatchEnd(O,D)];case 2:return P.sent(),kte(D),e.stopTraining_?[2,"break"]:[2]}})},I=0,N.label=3;case 3:return I<k.length?[5,T(I)]:[3,6];case 4:if(N.sent()==="break")return[3,6];N.label=5;case 5:return++I,[3,3];case 6:A.dispose(),N.label=7;case 7:return[4,b.onEpochEnd(_,E)];case 8:return N.sent(),e.stopTraining_?[2,"break"]:[2]}})},S=d,C.label=2;case 2:return S<a?[5,w(S)]:[3,5];case 3:if(C.sent()==="break")return[3,5];C.label=4;case 4:return++S,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return C.sent(),[4,e.history.syncData()];case 7:return C.sent(),[2,e.history]}})})}function V6e(e,t,n,r){return r===void 0&&(r={}),jt(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E;return Pt(this,function(A){switch(A.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,A.label=1;case 1:return A.trys.push([1,,7,8]),kL(f=r.batchSize==null?32:r.batchSize),d=!1,[4,e.standardizeUserData(t,n,r.sampleWeight,r.classWeight,d,f)];case 2:if(h=A.sent(),i=h[0],a=h[1],c=h[2],p=!1,g=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(p=!0,r.validationData.length!==2)throw r.validationData.length===3?new tn("validationData including sample weights is not supported yet."):new le("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],m=!0,[4,e.standardizeUserData(o,s,null,null,m,f)];case 3:return v=A.sent(),u=v[0],l=v[1],g=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(p=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=Wx(i,y,b),i=Wx(i,0,y),l=Wx(a,y,b),a=Wx(a,0,y),g=u.concat(l)):r.validationSteps!=null&&(p=!0),A.label=5;case 5:return x=i.concat(a).concat(c),e.checkTrainableWeightsConsistency(),w=e.makeTrainFunction(),S=e.getDedupedMetricsNames(),C=void 0,_=void 0,p?(e.makeTestFunction(),C=e.testFunction,_=S.slice().concat(S.map(function(k){return"val_"+k}))):(C=null,g=[],_=S.slice()),E=Tte(r.callbacks,r.yieldEvery),[4,W6e(e,w,x,S,f,r.epochs,r.verbose,E,C,g,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,A.sent()];case 7:return e.isTraining=!1,Dg(i,t),Dg(a,n),Dg(u,o),Dg(l,s),c!=null&&sn(c),[7];case 8:return[2]}})})}function Hte(e){var t=[];e instanceof fn&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(r.rank===1)t.push($x(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Dg(e,t){if(e!=null){var n=[];if(t instanceof fn)n.push(t.id);else if(Array.isArray(t))t.forEach(function(u){return n.push(u.id)});else if(t!=null)for(var r in t){var i=t[r];n.push(i.id)}var a=[];if(e instanceof fn)n.indexOf(e.id)===-1&&a.push(e);else if(Array.isArray(e))e.forEach(function(u){n.indexOf(u.id)===-1&&a.push(u)});else if(e!=null)for(var o in e){var s=e[o];n.indexOf(s.id)===-1&&a.push(s)}a.forEach(function(u){u.isDisposed||u.dispose()})}}function q6e(e){return e instanceof fn}function IL(e){return Array.isArray(e)}function Gte(e){return!q6e(e)&&!IL(e)}function Kte(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),t==null||t.length===0){if(e!=null){var a=!1;if(IL(e)&&e.length>0)a=!0;else if(Gte(e)){for(var o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new le("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(e==null)return t.map(function(m){return null});var s;if(Gte(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(e[c]==null)throw new le('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(IL(e)){if((e=e).length!==t.length)throw new le("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new le("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=Hte(s),n!=null){for(var f=0;f<t.length;++f)if(n[f]!=null){var d=s[f];if(d.shape.length!==n[f].length)throw new le("Error when checking "+i+": expected "+t[f]+" to have "+n[f].length+" dimension(s). but got array with shape "+d.shape);for(var h=0;h<n[f].length;++h)if(h!==0||r){var p=d.shape[h],g=n[f][h];if(g!=null&&g>=0&&p!==g)throw new le("Error when checking "+i+": expected "+t[f]+" to have shape ["+n[f]+"], but got array with shape ["+d.shape+"].")}}}return s}function H6e(e,t,n){var r=mh(e.map(function(a){return a.shape[0]}));r.sort();var i=mh(t.map(function(a){return a.shape[0]}));if(i.sort(),r.length>1)throw new le("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(a){return a.shape})));if(i.length>1)throw new le("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(a){return a.shape})));if(r.length>0&&i.length>0&&!Ct.arraysEqual(r,i))throw new le("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function G6e(e,t,n){for(var r=[Ng,XA,zx],i=0;i<e.length;++i){var a=e[i],o=t[i],s=n[i];if(o!=null){if(o===zx&&a.shape[a.shape.length-1]===1)throw new le("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(o)!==-1)for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var f=u[c],d=l[c];if(d!=null&&f!==d)throw new le("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function Xte(e,t,n,r,i){var a;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(e)){if(e.length!==t.length)throw new le("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(t.length>1)throw new le("The model expects "+t.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(n!=null){for(var o=0;o<t.length;++o)if(n[o]!=null){var s=a[o];if(s.shape.length!==n[o].length)throw new le("Error when checking "+i+": expected "+t[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(u!==0||r){var l=s.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new le("Error when checking "+i+": expected "+t[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function K6e(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(u){return[]});var n;if(typeof e=="string"||typeof e=="function")n=[e];else{if(!Array.isArray(e)&&typeof e!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map(function(u){return n});for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var X6e="layers-model",Vx=function(e){function t(n){var r=e.call(this,n)||this;return r.isTraining=!1,r}return Re(t,e),t.prototype.summary=function(n,r,i){if(i===void 0&&(i=console.log),!this.built)throw new le("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");C6e(this,n,r,i)},t.prototype.compile=function(n){var r=this;if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=E6e(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof Pf))throw new le("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(n.loss)||typeof n.loss=="string"||typeof n.loss=="function")if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new le("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+n.loss+".");var a=n.loss;i=a.map(function(m){return xL(m)})}else{var o=xL(n.loss);this.outputs.forEach(function(m){i.push(o)})}else{for(var s in n.loss=n.loss,n.loss)if(this.outputNames.indexOf(s)===-1)throw new le('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];n.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(xL(n.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],h=this.outputNames[f];this.feedOutputNames.push(h),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var p=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Og("loss",function(){for(var m=0;m<r.outputs.length;++m)if(p.indexOf(m)===-1){var v=r.lossFunctions[m];r.outputs.length>1&&(r.metricsTensors.push([v,m]),r.metricsNames.push(r.outputNames[m]+"_loss"))}});var g=K6e(n.metrics,this.outputNames);Og("metric",function(){for(var m=function(y){if(p.indexOf(y)!==-1)return"continue";(function(b){for(var x,w,S,C=function(A){if(typeof A=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(A)!==-1){var k=r.internalOutputShapes[y];k[k.length-1]===1||r.lossFunctions[y]===XA?["accuracy","acc"].indexOf(A)!==-1?w=wL:["crossentropy","ce"].indexOf(A)!==-1&&(w=Dte):r.lossFunctions[y]===KA?["accuracy","acc"].indexOf(A)!==-1?w=Rte:["crossentropy","ce"].indexOf(A)!==-1&&(w=Fte):["accuracy","acc"].indexOf(A)!==-1?w=_L:["crossentropy","ce"].indexOf(A)!==-1&&(w=SL);var T=void 0;["accuracy","acc"].indexOf(A)!==-1?T="acc":["crossentropy","ce"].indexOf(A)!==-1&&(T="ce"),S=w,x=""+T}else{var I=S6e(A);S=I,x=""+JA(A)}var N;Og(x,function(){N=S}),function(O,D,P){r.outputNames.length>1&&(D=r.outputNames[O]+"_"+D),r.metricsNames.push(D),r.metricsTensors.push([P,O])}(y,x,N)},_=0,E=b;_<E.length;_++)C(E[_])})(g[y])},v=0;v<r.outputs.length;++v)m(v)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(n,r,i){i===void 0&&(i={});var a=i.batchSize==null?32:i.batchSize;kL(a);var o=this.standardizeUserDataXY(n,r,!0,a);try{var s=o[0].concat(o[1]);this.makeTestFunction();var u=this.testFunction;return co(this.testLoop(u,s,a,i.verbose,i.steps))}finally{Dg(o[0],n),Dg(o[1],r)}},t.prototype.evaluateDataset=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){return this.makeTestFunction(),[2,U6e(this,n,r)]})})},t.prototype.checkNumSamples=function(n,r,i,a){var o;if(a===void 0&&(a="steps"),i!=null){if(o=null,r!=null)throw new le("If "+a+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(n==null)throw new le("Either the input data should have a defined shape, or "+a+" shoud be specified.");o=Array.isArray(n)?n[0].shape[0]:n.shape[0]}return o},t.prototype.execute=function(n,r){if(Array.isArray(r)&&r.length===0)throw new le("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),a=i?r:[r],o=this.retrieveSymbolicTensors(a),s=new B0;if(n instanceof fn&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new le("The number of inputs provided ("+n.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],n[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var f=c[l],d=n[f.name];if(d==null)throw new le("No value is provided for the model's input "+f.name);s.add(f,d)}var h=Ux(o,s);return i?h:h[0]},t.prototype.retrieveSymbolicTensors=function(n){for(var r=kg(null,n.length),i=n.length,a=0,o=this.layers;a<o.length;a++){for(var s=o[a],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(h){return h.name}),c=0;c<n.length;++c){var f=l.indexOf(n[c]);if(f!==-1&&(r[c]=u[f],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(h,p){h==null&&d.push(n[p])}),new le("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},t.prototype.predictLoop=function(n,r,i){var a=this;return r===void 0&&(r=32),i===void 0&&(i=!1),ge(function(){var o=a.checkNumSamples(n);if(i)throw new tn("Verbose predictLoop() is not implemented yet.");for(var s=OL(o,r),u=a.outputs.map(function(f){return[]}),l=function(f){ge(function(){var d=s[f][0],h=s[f][1],p=Wx(n,d,h),g=[];if(Array.isArray(p))for(var m=0;m<p.length;++m)g.push({key:a.inputs[m],value:p[m]});else g.push({key:a.inputs[0],value:p});var v=new B0(g);return Ux(a.outputs,v)}).forEach(function(d,h){return u[h].push(d)})},c=0;c<s.length;++c)l(c);return co(u.map(function(f){return Ra(f,0)}))})},t.prototype.predict=function(n,r){r===void 0&&(r={});var i=Hte(n);Xte(i,this.inputNames,this.feedInputShapes,!1);try{var a=r.batchSize==null?32:r.batchSize;return kL(a),this.predictLoop(i,a)}finally{Dg(i,n)}},t.prototype.predictOnBatch=function(n){Xte(n,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)},t.prototype.standardizeUserDataXY=function(n,r,i,a){if(this.optimizer_==null)throw new pc("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===KA?o.push(u.slice(0,u.length-1).concat([1])):o.push(u)}if(H6e(n=Kte(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=Kte(r,this.feedOutputNames,o,!1,"target")),G6e(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&n[0].shape[0]%a!=0)throw new le("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+a+". Found: "+n[0].shape[0]+" sample(s).");return[n,r]},t.prototype.standardizeUserData=function(n,r,i,a,o,s){return o===void 0&&(o=!0),jt(this,void 0,void 0,function(){var u,l,c,f,d,h,p,g;return Pt(this,function(m){switch(m.label){case 0:if(u=this.standardizeUserDataXY(n,r,o,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(f=null,a==null)return[3,4];d=jte(a,this.outputNames),f=[],h=0,m.label=1;case 1:return h<d.length?(g=(p=f).push,[4,Ute(c[h],null,d[h])]):[3,4];case 2:g.apply(p,[m.sent()]),m.label=3;case 3:return++h,[3,1];case 4:return[2,[l,c,f]]}})})},t.prototype.testLoop=function(n,r,i,a,o){var s=this;return a===void 0&&(a=0),ge(function(){var u=s.checkNumSamples(r,i,o,"steps"),l=[];if(a>0)throw new tn("Verbose mode is not implemented yet.");if(o!=null)throw new tn("steps mode in testLoop() is not implemented yet");for(var c=OL(u,i),f=so(il(0,u)),d=0;d<c.length;++d){var h=c[d][0],p=c[d][1],g=Ig(f,h,p-h),m=TL(r,g),v=n(m);if(d===0)for(var y=0;y<v.length;++y)l.push(rt(0));for(y=0;y<v.length;++y){var b=v[y];l[y]=un(l[y],pt(p-h,b))}}for(y=0;y<l.length;++y)l[y]=ei(l[y],u);return l})},t.prototype.getDedupedMetricsNames=function(){for(var n=this.metricsNames,r=[],i=0;i<n.length;++i){var a=n[i],o=a;Kee(n,a)>1&&(o+="_"+Kee(n.slice(0,i),a)),r.push(o)}return r},t.prototype.makeTrainFunction=function(){var n=this;return function(r){var i=[],a=r.slice(0,n.inputs.length),o=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),s=r.slice(n.inputs.length+n.outputs.length,n.inputs.length+2*n.outputs.length),u=[],l=n.collectedTrainableWeights.map(function(c){return c.read()});return[n.optimizer_.minimize(function(){for(var c=[],f=0;f<n.inputs.length;++f)c.push({key:n.inputs[f],value:a[f]});var d,h=new B0(c),p=Ux(n.outputs,h,{training:!0});for(f=0;f<n.lossFunctions.length;++f){var g=(0,n.lossFunctions[f])(o[f],p[f]);s[f]!=null&&(g=P6e(g,s[f]));var m=di(g);i.push(m),d=f===0?g:un(d,g)}for(f=0;f<n.metricsTensors.length;++f){var v=void 0;if(n.outputs.length>1&&f<n.outputs.length)v=i[f];else{var y=n.metricsTensors[f][0],b=n.metricsTensors[f][1];v=di(y(o[b],p[b]))}ac(v),u.push(v)}return d=di(d),n.calculateLosses().forEach(function(x){d=un(d,x)}),d},!0,l)].concat(u)}},t.prototype.makeTestFunction=function(){var n=this;this.testFunction=function(r){return ge(function(){for(var i,a=[],o=r.slice(0,n.inputs.length),s=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),u=[],l=0;l<n.inputs.length;++l)u.push({key:n.inputs[l],value:o[l]});var c=new B0(u),f=Ux(n.outputs,c);for(l=0;l<n.lossFunctions.length;++l){var d=n.lossFunctions[l],h=di(d(s[l],f[l]));i=l===0?h:un(i,h),a.push(i)}for(l=0;l<n.metricsTensors.length;++l){var p=n.metricsTensors[l][0],g=n.metricsTensors[l][1],m=di(p(s[g],f[g]));a.push(m)}return a})}},t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),jt(this,void 0,void 0,function(){return Pt(this,function(a){return[2,V6e(this,n,r,i)]})})},t.prototype.fitDataset=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){return[2,B6e(this,n,r)]})})},t.prototype.trainOnBatch=function(n,r){return jt(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d;return Pt(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(n,r)];case 1:i=h.sent(),a=i[0],o=i[1],s=this.makeTrainFunction(),u=s(a.concat(o)),l=[],c=0,f=u,h.label=2;case 2:return c<f.length?[4,f[c].data()]:[3,5];case 3:d=h.sent(),l.push(d[0]),h.label=4;case 4:return c++,[3,2];case 5:return sn(u),[2,co(l)]}})})},t.prototype.getNamedWeights=function(n){for(var r=[],i=n!=null&&n.trainableOnly,a=i?this.trainableWeights:this.weights,o=this.getWeights(i),s=0;s<a.length;++s)i&&!a[s].trainable||r.push({name:a[s].originalName,tensor:o[s]});return r},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(n){this.stopTraining_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=e.prototype.dispose.call(this);if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=RC().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-RC().numTensors}return n},t.prototype.getLossIdentifiers=function(){var n;if(typeof this.loss=="string")n=$f(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(function(c){return $f(c)})}else{var a=Object.keys(this.loss);n={};for(var o=this.loss,s=0,u=a;s<u.length;s++){var l=u[s];if(typeof o[l]!="string")throw new Error("Serialization of non-string loss is not supported.");n[l]=$f(o[l])}}return n},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[$f(JA(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return $f(JA(i))});var n={};for(var r in this.metrics)n[r]=$f(JA(this.metrics[r]));return n},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,a=ol(jx(n.optimizer_config));if(typeof n.loss=="string")r=Tg(n.loss);else if(Array.isArray(n.loss))r=n.loss.map(function(s){return Tg(s)});else if(n.loss!=null)for(var o in r={},n.loss)r[o]=Tg(n.loss[o]);if(Array.isArray(n.metrics))i=n.metrics.map(function(s){return Tg(s)});else if(n.metrics!=null)for(var o in i={},n.metrics)i[o]=Tg(n.metrics[o]);this.compile({loss:r,metrics:i,optimizer:a})},t.prototype.save=function(n,r){return jt(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v;return Pt(this,function(y){switch(y.label){case 0:if(typeof n=="string"){if((i=lo.getSaveHandlers(n)).length===0)throw new le("Cannot find any save handlers for URL '"+n+"'");if(i.length>1)throw new le("Found more than one ("+i.length+") save handlers for URL '"+n+"'");n=i[0]}if(n.save==null)throw new le("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,lo.encodeWeights(this.getNamedWeights(r))];case 1:return a=y.sent(),o=!1,s=null,u=this.toJSON(s,o),l={modelTopology:u,format:X6e,generatedBy:"TensorFlow.js tfjs-layers v"+Lte,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",g=(p=lo).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,g.apply(p,[y.sent(),c])];case 3:f=y.sent(),d=f.data,h=f.specs,(v=a.specs).push.apply(v,h),a.data=lo.concatenateArrayBuffers([a.data,d]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(m=!0,Pte(this.userDefinedMetadata,this.name,m),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=a.data,l.weightSpecs=a.specs,[2,n.save(l)]}})})},t.prototype.setUserDefinedMetadata=function(n){Pte(n,this.name),this.userDefinedMetadata=n},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(F6e);function Y6e(e,t){return jt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l;return Pt(this,function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),(n=(e=e).modelTopology).model_config!=null&&(n=n.model_config),r=jx(n),i=ol(r,t),e.weightsManifest==null?[3,2]:[4,lo.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(function(f){return f.originalName}))];case 1:for(a=c.sent(),o={},s=0,u=i.weights;s<u.length;s++)l=u[s],o[l.originalName]=a[l.originalName];i.loadWeights(o),sn(a),c.label=2;case 2:return[2,i]}})})}function Z6e(e,t){return jt(this,void 0,void 0,function(){var n;return Pt(this,function(r){if(t==null&&(t={}),typeof e=="string"){if((n=lo.getLoadHandlers(e,t.onProgress)).length===0)n.push(lo.browserHTTPRequest(e,t));else if(n.length>1)throw new le("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,J6e(e,void 0,t)]})})}function J6e(e,t,n){return jt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return Pt(this,function(d){switch(d.label){case 0:if(n==null&&(n={}),e.load==null)throw new le("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),a=n.strict==null||n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=ol(jx(i),t,o),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new le("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=Q6e(r.weightData,r.weightSpecs),c=l.modelWeights,f=l.optimizerWeights,s.loadWeights(c,a),s.optimizer!=null&&f.length>0?[4,s.optimizer.setWeights(f)]:[3,3];case 2:d.sent(),d.label=3;case 3:sn(c),sn(f.map(function(h){return h.tensor})),d.label=4;case 4:return[2,s]}})})}function Q6e(e,t){var n=lo.decodeWeights(e,t),r={},i=[];return t.forEach(function(a){a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}je.registerClass(Vx);var Yte=function(e){function t(n){var r=e.call(this,{inputs:[],outputs:[]})||this;if(n=n||{},r.trainable=!0,r.built=!1,r.name=n.name!=null?n.name:UA("sequential_"),n.layers!=null)for(var i=0,a=n.layers;i<a.length;i++){var o=a[i];r.add(o)}return r}return Re(t,e),t.prototype.checkShape=function(n){if(n.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new le("Negative dimension size caused by adding layer "+n.name+" with input shape ["+n.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(n){var r,i=n instanceof t||n instanceof Vx;if(i){if((r=n).outputs.length!==1)throw new le("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new le("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new le("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=Ate({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(a)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(n.inboundNodes.length!==1)throw new le("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+n.name+" which has "+n.inboundNodes.length+" pre-existing inbound connections.");if(n.inboundNodes[0].outputTensors.length!==1)throw new le("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=Ete(this.outputs[0])}this.inboundNodes=[],new qA({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:kg(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(n,r){return this.model==null&&this.build(),this.model.call(n,r)},t.prototype.build=function(n){if(br(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Vx({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(n,r,i){i===void 0&&(i=console.log),this.built||this.build(),e.prototype.summary.call(this,n,r,i)},t.prototype.setWeights=function(n){this.model==null&&this.build(),this.model.setWeights(n)},t.prototype.evaluate=function(n,r,i){if(i===void 0&&(i={}),!this.built)throw new pc("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)},t.prototype.evaluateDataset=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){if(!this.built)throw new pc("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(n,r)]})})},t.prototype.predict=function(n,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(n,r)},t.prototype.predictOnBatch=function(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)},t.prototype.compile=function(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(n){this.model.optimizer=n},enumerable:!0,configurable:!0}),t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),jt(this,void 0,void 0,function(){return Pt(this,function(a){if(!this.built)throw new pc("The model needs to be compiled before being used.");return[2,this.model.fit(n,r,i)]})})},t.prototype.fitDataset=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){if(!this.built)throw new pc("The model needs to be compiled before being used.");return[2,this.model.fitDataset(n,r)]})})},t.prototype.trainOnBatch=function(n,r){return jt(this,void 0,void 0,function(){return Pt(this,function(i){return[2,this.model.trainOnBatch(n,r)]})})},t.fromConfig=function(n,r,i,a){var o;a===void 0&&(a=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new le("Legacy serialization format not supported yet.");o=r}else Ct.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=r.layers,delete r.layers,s=r;var u=new n(s);if(!(u instanceof t))throw new tn("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=o;l<c.length;l++){var f=ol(c[l],void 0,a);a&&f.setFastWeightInitDuringBuild(!0),u.add(f)}return u},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new le("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(n){if(this.model==null)throw new le("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r],o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}return{name:this.name,layers:n}},t.className="Sequential",t}(Vx);function eje(e){return new Yte(e)}function tje(e,t){return t==null&&(t={}),Z6e(e,t)}function nje(e){return Ate(e)}je.registerClass(Yte);var Ds=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.getConfig=function(){return{}},t}(je.Serializable),rje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=1),S5e(n,r)},t.className="elu",t}(Ds);je.registerClass(rje);var ije=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return TA(n)},t.className="selu",t}(Ds);je.registerClass(ije);var aje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return lh(n)},t.className="relu",t}(Ds);je.registerClass(aje);var oje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return ge(function(){return h0(6,lh(n))})},t.className="relu6",t}(Ds);je.registerClass(oje);var sje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return n},t.className="linear",t}(Ds);je.registerClass(sje);var uje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return qC(n)},t.className="sigmoid",t}(Ds);je.registerClass(uje);var lje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return C5e(n)},t.className="hardSigmoid",t}(Ds);je.registerClass(lje);var cje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return fx(n)},t.className="softplus",t}(Ds);je.registerClass(cje);var fje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return E5e(n)},t.className="softsign",t}(Ds);je.registerClass(fje);var dje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n){return HC(n)},t.className="tanh",t}(Ds);je.registerClass(dje);var Zte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),hg(n,r)},t.className="softmax",t}(Ds);je.registerClass(Zte);var hje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),JC(n,r)},t.className="logSoftmax",t}(Ds);function Rs(e){return e.getClassName()}function NL(e,t){return t===void 0&&(t={}),Rx(e,je.SerializationMap.getMap().classNameMap,t,"activation")}function xh(e){var t;return e==null?NL(t={className:"linear",config:{}}):typeof e=="string"?((t={}).className=e,t.config={},NL(t)):e instanceof Ds?e:NL(e)}function DL(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}je.registerClass(hje);var Jte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t}(je.Serializable),ek=function(e){function t(n){var r=e.call(this)||this;return DL(n),r.l1=n==null||n.l1==null?.01:n.l1,r.l2=n==null||n.l2==null?.01:n.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return Re(t,e),t.prototype.apply=function(n){var r=this;return ge(function(){var i=Kn([1]);return r.hasL1&&(i=un(i,Ei(pt(r.l1,ih(n))))),r.hasL2&&(i=un(i,Ei(pt(r.l2,Lx(n))))),i.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(n,r){return new n({l1:r.l1,l2:r.l2})},t.className="L1L2",t}(Jte);function pje(e){return DL(e),new ek({l1:e!=null?e.l1:null,l2:0})}function gje(e){return DL(e),new ek({l2:e!=null?e.l2:null,l1:0})}je.registerClass(ek);var Qte={l1l2:"L1L2"};function ln(e){return nL(e)}function ene(e,t){return t===void 0&&(t={}),Rx(e,je.SerializationMap.getMap().classNameMap,t,"regularizer")}function Ir(e){return e==null?null:typeof e=="string"?ene({className:e in Qte?Qte[e]:e,config:{}}):e instanceof Jte?e:ene(e)}var tne=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,n!=null&&(r.maxValue=n.maxValue),r}return Re(t,e),t.prototype.call=function(n,r){n=Yt(n);var i=lh(n);return this.maxValue!=null&&(i=uo(i,0,this.maxValue)),i},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={maxValue:this.maxValue},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ReLU",t}(Sn);je.registerClass(tne);var nne=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_ALPHA=.3,n==null&&(n={}),r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Re(t,e),t.prototype.call=function(n,r){var i=Yt(n);return kA(i,this.alpha)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LeakyReLU",t}(Sn);je.registerClass(nne);var rne=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),r.supportsMasking=!0,r.alphaInitializer=Or(n.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Ir(n.alphaRegularizer),r.alphaConstraint=Ai(n.alphaConstraint),n.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(n.sharedAxes))r.sharedAxes=n.sharedAxes;else{if(typeof n.sharedAxes!="number")throw new le("Expected sharedAxes to be a number or an array of numbers, but got "+n.sharedAxes);r.sharedAxes=[n.sharedAxes]}return r}return Re(t,e),t.prototype.build=function(n){var r=(n=br(n)).slice(1);if(this.sharedAxes!=null)for(var i=0,a=this.sharedAxes;i<a.length;i++)r[(s=a[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(this.sharedAxes!=null)for(var s=1;s<n.length;++s)o[s]=n[s];this.inputSpec=[new ba({ndim:n.length,axes:o})],this.built=!0},t.prototype.call=function(n,r){return n=Yt(n),Tx(n,this.alpha.read())},t.prototype.getConfig=function(){var n={alphaInitializer:Pn(this.alphaInitializer),alphaRegularizer:ln(this.alphaRegularizer),alphaConstraint:ur(this.alphaConstraint),sharedAxes:this.sharedAxes},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="PReLU",t}(Sn);je.registerClass(rne);var ine=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==r.DEFAULT_ALPHA)throw new tn("Non-default alpha value ("+n.alpha+") is not supported by the ELU layer yet.");return r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Re(t,e),t.prototype.call=function(n,r){var i=Yt(n);return C0(i)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ELU",t}(Sn);je.registerClass(ine);var ane=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_THETA=1,n==null&&(n={}),r.theta=n.theta==null?r.DEFAULT_THETA:n.theta,r}return Re(t,e),t.prototype.call=function(n,r){var i=Yt(n);return i.mul(Px(i.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={theta:this.theta},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ThresholdedReLU",t}(Sn);je.registerClass(ane);var one=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_AXIS=1,n==null&&(n={}),r.softmax=new Zte().apply,r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r}return Re(t,e),t.prototype.call=function(n,r){var i=Yt(n);return this.softmax(i,this.axis)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Softmax",t}(Sn);function RL(e,t,n){if(typeof e=="number")return kg(e,t);if(e.length!==t)throw new le("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var i=e[r];if(!b5e(i))throw new le("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+i)}return e}function zf(e,t,n,r,i){return i===void 0&&(i=1),e==null?e:(a=n==="same"?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function tk(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+yh([n-t,0]);else{if(r!=="same")throw new le("Unsupport padding mode: "+r+".");e*=t}return e}function FL(e,t){return ge(function(){return ki(t),t==="channelsFirst"?In(e,[0,2,3,1]):e})}function sne(e,t){return ge(function(){return ki(t),t==="channelsFirst"?In(e,[0,2,3,4,1]):e})}function mje(e,t,n,r,i,a,o){return r===void 0&&(r=1),i===void 0&&(i="valid"),o===void 0&&(o=1),ge(function(){if(a==null&&(a=rl()),ki(a),e.shape.length!==3)throw new le("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(t.shape.length!==3)throw new le("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(n!=null&&n.shape.length!==1)throw new le("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(a==="channelsFirst"&&(e=In(e,[0,2,1])),i==="causal")throw new tn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=gA(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(s=Bf(s,n)),s})}function une(e,t,n,r,i,a,o,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),ge(function(){if(a==null&&(a=rl()),ki(a),e.rank!==3&&e.rank!==4)throw new le("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+e.rank+".");if(t.rank!==3&&t.rank!==4)throw new le("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+e.rank+".");var u=FL(e,a);if(i==="causal")throw new tn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=fh.conv2d({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),a==="channelsFirst"&&(u=In(u,[0,3,1,2])),u})}function vje(e,t,n,r,i,a,o){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),ge(function(){if(a==null&&(a=rl()),ki(a),e.rank!==4&&e.rank!==5)throw new le("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(t.rank!==4&&t.rank!==5)throw new le("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=sne(e,a);if(i==="causal")throw new tn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=mA(s,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(s=Bf(s,n)),a==="channelsFirst"&&(s=In(s,[0,4,1,2,3])),s})}je.registerClass(one);var lne=function(e){function t(n,r){var i=e.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(r),i.rank=n,fo(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new tn("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=RL(r.kernelSize,n,"kernelSize"),i.strides=RL(r.strides==null?1:r.strides,n,"strides"),i.padding=r.padding==null?"valid":r.padding,fu(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,ki(i.dataFormat),i.activation=xh(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=Or(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Ai(r.biasConstraint),i.biasRegularizer=Ir(r.biasRegularizer),i.activityRegularizer=Ir(r.activityRegularizer),i.dilationRate=RL(r.dilationRate==null?1:r.dilationRate,n,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new le("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new le("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new le("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return Re(t,e),t.verifyArgs=function(n){if(gc("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!iL(n.kernelSize,"number",1,3))throw new le("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(n.kernelSize)+".")},t.prototype.getConfig=function(){var n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Rs(this.activation),useBias:this.useBias,biasInitializer:Pn(this.biasInitializer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),biasConstraint:ur(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(Sn),nk=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.kernel=null,t.verifyArgs(r),i.filters=r.filters,fo(i.filters,"filters"),i.kernelInitializer=Or(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Ai(r.kernelConstraint),i.kernelRegularizer=Ir(r.kernelRegularizer),i}return Re(t,e),t.prototype.build=function(n){var r;n=br(n);var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new le("The channel dimension of the input should be defined. Found "+n[i]);var a=n[i],o=this.kernelSize.concat([a,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=a,r)}],this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a;n=Yt(n);var o=i.bias==null?null:i.bias.read(),s=Yee(i.activation.getClassName());if(s!=null&&i.rank===2)a=une(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)a=mje(n,i.kernel.read(),o,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)a=une(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new tn("convolutions greater than 3D are not implemented yet.");a=vje(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(a=i.activation.apply(a))}return a})},t.prototype.computeOutputShape=function(n){n=br(n);for(var r=[],i=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2),a=0;a<i.length;++a){var o=zf(i[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);r.push(o)}var s=[n[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},t.prototype.getConfig=function(){var n={filters:this.filters,kernelInitializer:Pn(this.kernelInitializer),kernelRegularizer:ln(this.kernelRegularizer),kernelConstraint:ur(this.kernelConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.verifyArgs=function(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new le("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(n.filters))},t}(lne),ML=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyArgs(n),r}return Re(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!iL(n.kernelSize,"number",1,2))throw new le("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv2D",t}(nk);je.registerClass(ML);var cne=function(e){function t(n){var r=e.call(this,3,n)||this;return t.verifyArgs(n),r}return Re(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&(!Array.isArray(n.kernelSize)||n.kernelSize.length!==1&&n.kernelSize.length!==3))throw new le("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv3D",t}(nk);je.registerClass(cne);var fne=function(e){function t(n){var r=e.call(this,n)||this;if(r.inputSpec=[new ba({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new le("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return Re(t,e),t.prototype.build=function(n){var r;if((n=br(n)).length!==4)throw new le("Input should have rank 4; Received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new le("The channel dimension of the inputs should be defined. Found `None`.");var a=n[i],o=this.kernelSize.concat([this.filters,a]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ba({ndim:4,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=Yt(n);if(a.shape.length!==4)throw new le("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+a.shape.length);var o,s,u=a.shape,l=u[0];i.dataFormat==="channelsFirst"?(o=2,s=3):(o=1,s=2);var c=u[o],f=u[s],d=i.kernelSize[0],h=i.kernelSize[1],p=i.strides[0],g=i.strides[1],m=[l,tk(c,p,d,i.padding),tk(f,g,h,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(a=In(a,[0,2,3,1]));var v=vA(a,i.kernel.read(),m,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(v=In(v,[0,3,1,2])),i.bias!=null&&(v=Bf(v,i.bias.read(),i.dataFormat)),i.activation!=null&&(v=i.activation.apply(v)),v})},t.prototype.computeOutputShape=function(n){var r,i,a,o=(n=br(n)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[r]=this.filters,o[i]=tk(o[i],l,s,this.padding),o[a]=tk(o[a],c,u,this.padding),o},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.dilationRate,n},t.className="Conv2DTranspose",t}(ML);je.registerClass(fne);var yje=function(e){function t(n,r){var i=e.call(this,n,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new le("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new le("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new le("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=Or(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=Ir(r.depthwiseRegularizer),i.depthwiseConstraint=Ai(r.depthwiseConstraint),i.pointwiseInitializer=Or(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=Ir(r.pointwiseRegularizer),i.pointwiseConstraint=Ai(r.pointwiseConstraint),i}return Re(t,e),t.prototype.build=function(n){var r;if((n=br(n)).length<this.rank+2)throw new le("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null||n[i]<0)throw new le("The channel dimension of the inputs should be defined, but found "+JSON.stringify(n[i]));for(var a=n[i],o=this.kernelSize.concat([a,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(a*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new ba({ndim:this.rank+2,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a;if(n=Yt(n),i.rank===1)throw new tn("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(n=In(n,[0,2,3,1])),a=v$(n,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(a=Bf(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),i.dataFormat==="channelsFirst"&&(a=In(a,[0,3,1,2])),a})},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=Pn(this.depthwiseInitializer),n.pointwiseInitializer=Pn(this.pointwiseInitializer),n.depthwiseRegularizer=ln(this.depthwiseRegularizer),n.pointwiseRegularizer=ln(this.pointwiseRegularizer),n.depthwiseConstraint=ur(this.depthwiseConstraint),n.pointwiseConstraint=ur(this.pointwiseConstraint),n},t.className="SeparableConv",t}(nk),dne=function(e){function t(n){return e.call(this,2,n)||this}return Re(t,e),t.className="SeparableConv2D",t}(yje);je.registerClass(dne);var hne=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Re(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.dataFormat,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!iL(n.kernelSize,"number",1,1))throw new le("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv1D",t}(nk);je.registerClass(hne);var pne=function(e){function t(n){var r=e.call(this,n)||this;return typeof n.cropping=="number"?r.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?r.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:r.cropping=n.cropping,r.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,r.inputSpec=[{ndim:4}],r}return Re(t,e),t.prototype.computeOutputShape=function(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]},t.prototype.call=function(n,r){var i=this;return ge(function(){return n=Yt(n),i.dataFormat==="channelsLast"?BA(BA(n,i.cropping[0][0],n.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],n.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):BA(BA(n,i.cropping[0][0],n.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],n.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},t.prototype.getConfig=function(){var n={cropping:this.cropping,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Cropping2D",t}(Sn);je.registerClass(pne);var gne=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=n.size==null?r.DEFAULT_SIZE:n.size,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,r}return Re(t,e),t.prototype.computeOutputShape=function(n){if(this.dataFormat==="channelsFirst"){var r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}return r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2],[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=Yt(n),o=a.shape;if(i.dataFormat==="channelsFirst"){a=In(a,[0,2,3,1]);var s=i.size[0]*o[2],u=i.size[1]*o[3],l=a.resizeNearestNeighbor([s,u]);return In(l,[0,3,1,2])}return s=i.size[0]*o[1],u=i.size[1]*o[2],a.resizeNearestNeighbor([s,u])})},t.prototype.getConfig=function(){var n={size:this.size,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="UpSampling2D",t}(Sn);function bje(e,t,n,r,i,a){return n===void 0&&(n=[1,1]),r===void 0&&(r="valid"),ge(function(){i==null&&(i=rl()),ki(i);var o=FL(e,i);if(e.rank!==4)throw new le("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(t.rank!==4)throw new le("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=S0(o,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=In(o,[0,3,1,2])),o})}je.registerClass(gne);var mne=function(e){function t(n){var r=e.call(this,2,n)||this;return r.depthwiseKernel=null,r.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,r.depthwiseInitializer=Or(n.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Ai(n.depthwiseConstraint),r.depthwiseRegularizer=Ir(n.depthwiseRegularizer),r}return Re(t,e),t.prototype.build=function(n){if((n=br(n)).length<4)throw new le("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(n)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new le("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+n[r]+").");var i=n[r],a=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=bje(n=Yt(n),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(a=Bf(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),a})},t.prototype.computeOutputShape=function(n){n=br(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,o=zf(r,this.kernelSize[0],this.padding,this.strides[0]),s=zf(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],a,o,s]:[n[0],o,s,a]},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=Pn(this.depthwiseInitializer),n.depthwiseRegularizer=ln(this.depthwiseRegularizer),n.depthwiseConstraint=ur(this.depthwiseRegularizer),n},t.className="DepthwiseConv2D",t}(lne);je.registerClass(mne);var PL=function(e){function t(n){var r=e.call(this,n)||this;return r.rate=Math.max(Math.min(n.rate,1),0),r.noiseShape=n.noiseShape,r.seed=n.seed,r.supportsMasking=!0,r}return Re(t,e),t.prototype.getNoiseShape=function(n){if(this.noiseShape==null)return this.noiseShape;for(var r=n.shape,i=[],a=0;a<this.noiseShape.length;++a)i.push(this.noiseShape[a]==null?r[a]:this.noiseShape[a]);return i},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);if(0<i.rate&&i.rate<1){var o=r.training!=null&&r.training,s=i.getNoiseShape(a);return P0(function(){return dte(a,i.rate,s,i.seed)},function(){return a},o)}return n})},t.prototype.getConfig=function(){var n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.dispose=function(){return e.prototype.dispose.call(this)},t.className="Dropout",t}(Sn);je.registerClass(PL);var vne=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[{ndim:3}],r}return Re(t,e),t.prototype.getNoiseShape=function(n){var r=n.shape;return[r[0],1,r[2]]},t.className="SpatialDropout1D",t}(PL);je.registerClass(vne);var yne=function(e){function t(n){var r=e.call(this,n)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){var i=null;n.batchSize!=null&&(i=n.batchSize),r.batchInputShape=[i,n.inputDim]}return r.units=n.units,fo(r.units,"units"),r.activation=xh(n.activation),n.useBias!=null&&(r.useBias=n.useBias),r.kernelInitializer=Or(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Or(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Ai(n.kernelConstraint),r.biasConstraint=Ai(n.biasConstraint),r.kernelRegularizer=Ir(n.kernelRegularizer),r.biasRegularizer=Ir(n.biasRegularizer),r.activityRegularizer=Ir(n.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Re(t,e),t.prototype.build=function(n){var r,i=(n=br(n))[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},t.prototype.computeOutputShape=function(n){var r=(n=br(n)).slice();return r[r.length-1]=this.units,r},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a,o=Yt(n),s=Yee(i.activation.getClassName());return s!=null?a=Lf(o,i.kernel.read(),s,i.bias?i.bias.read():null):(a=Lf(o,i.kernel.read()),i.bias!=null&&(a=Bf(a,i.bias.read())),i.activation!=null&&(a=i.activation.apply(a))),a})},t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),biasInitializer:Pn(this.biasInitializer),kernelRegularizer:ln(this.kernelRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),biasConstraint:ur(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dense",t}(Sn);je.registerClass(yne);var bne=function(e){function t(n){var r=this;return n=n||{},(r=e.call(this,n)||this).inputSpec=[{minNDim:3}],r.dataFormat=n.dataFormat,r}return Re(t,e),t.prototype.computeOutputShape=function(n){for(var r=0,i=(n=br(n)).slice(1);r<i.length;r++)if(i[r]==null)throw new le('The shape of the input to "Flatten" is not fully defined (got '+n.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[n[0],vh(n,1)]},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);if(i.dataFormat==="channelsFirst"&&a.rank>1){for(var o=[0],s=2;s<a.rank;++s)o.push(s);o.push(1),a=a.transpose(o)}return _5e(a)})},t.prototype.getConfig=function(){var n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);var r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Flatten",t}(Sn);je.registerClass(bne);var xne=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.activation=xh(n.activation),r}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);return i.activation.apply(a)})},t.prototype.getConfig=function(){var n={activation:Rs(this.activation)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Activation",t}(Sn);je.registerClass(xne);var wne=function(e){function t(n){var r=e.call(this,n)||this;return r.n=n.n,r.inputSpec=[{ndim:2}],r}return Re(t,e),t.prototype.computeOutputShape=function(n){return[n[0],this.n,n[1]]},t.prototype.call=function(n,r){var i=this;return ge(function(){return x5e(n=Yt(n),i.n)})},t.prototype.getConfig=function(){var n={n:this.n},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="RepeatVector",t}(Sn);je.registerClass(wne);var _ne=function(e){function t(n){var r=e.call(this,n)||this;r.targetShape=n.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return Re(t,e),t.prototype.isUnknown=function(n){return n<0||n==null},t.prototype.fixUnknownDimension=function(n,r){for(var i="Total size of new array must be unchanged.",a=r.slice(),o=1,s=null,u=0;u<a.length;++u){var l=a[u];if(this.isUnknown(l)){if(s!==null)throw new le("Can only specifiy one unknown dimension.");s=u}else o*=l}var c=vh(n);if(s!==null){if(o===0||c%o!=0)throw new le(i);a[s]=c/o}else if(c!==o)throw new le(i);return a},t.prototype.computeOutputShape=function(n){for(var r=!1,i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n),o=a.shape,s=o.slice(0,1).concat(i.fixUnknownDimension(o.slice(1),i.targetShape));return a.reshape(s)})},t.prototype.getConfig=function(){var n={targetShape:this.targetShape},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Reshape",t}(Sn);je.registerClass(_ne);var Sne=function(e){function t(n){var r=e.call(this,n)||this;if(n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+n.dims+" instead.");var i=il(1,n.dims.length+1);if(!Ct.arraysEqual(n.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=n.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new ba({ndim:r.dims.length+1})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){var r=(n=br(n)).slice();return this.dims.forEach(function(i,a){r[a+1]=n[i]}),r},t.prototype.call=function(n,r){return In(Yt(n),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var n={dims:this.dims},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Permute",t}(Sn);je.registerClass(Sne);var Ene=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,r.maskValue=n!=null?n.maskValue==null?0:n.maskValue:0,r}return Re(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,n),r},t.prototype.computeMask=function(n,r){var i=Yt(n);return Cx(w0(i,this.maskValue),-1)},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n),o=Cx(w0(a,i.maskValue),-1,!0);return a.mul(o.asType(a.dtype))})},t.className="Masking",t}(Sn);je.registerClass(Ene);var Cne=function(e){function t(n){var r=e.call(this,n)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){var i=null;n.batchSize!=null&&(i=n.batchSize),n.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Cr(n.inputLength))}return r.inputDim=n.inputDim,fo(r.inputDim,"inputDim"),r.outputDim=n.outputDim,fo(r.outputDim,"outputDim"),r.embeddingsInitializer=Or(n.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Ir(n.embeddingsRegularizer),r.activityRegularizer=Ir(n.activityRegularizer),r.embeddingsConstraint=Ai(n.embeddingsConstraint),r.maskZero=n.maskZero,r.supportsMasking=n.maskZero,r.inputLength=n.inputLength,r}return Re(t,e),t.prototype.build=function(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(n){},t.prototype.computeMask=function(n,r){var i=this;return ge(function(){return i.maskZero?(n=Yt(n),w0(n,wn(n))):null})},t.prototype.computeOutputShape=function(n){if(n=br(n),this.inputLength==null)return n.concat([this.outputDim]);var r=Cr(this.inputLength);if(r.length!==n.length-1)throw new le('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);for(var i=0,a=0;a<r.length;++a){var o=r[a],s=n[a+1];if(o!=null&&s!=null&&o!==s)throw new le('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);o==null&&(r[i]=s),i++}return[n[0]].concat(r,[this.outputDim])},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);return a.dtype!=="int32"&&(a=Px(a,"int32")),fte(i.embeddings.read(),a.as1D()).reshape(br(i.computeOutputShape(a.shape)))})},t.prototype.getConfig=function(){var n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Pn(this.embeddingsInitializer),embeddingsRegularizer:ln(this.embeddingsRegularizer),activityRegularizer:ln(this.activityRegularizer),embeddingsConstraint:ur(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Embedding",t}(Sn);je.registerClass(Cne);var Rg=function(e){function t(n){var r=e.call(this,n||{})||this;return r.supportsMasking=!0,r}return Re(t,e),t.prototype.mergeFunction=function(n){throw new tn},t.prototype.computeElementwiseOpOutputShape=function(n,r){if(n==null||r==null)return null;if(n.length<r.length)return this.computeElementwiseOpOutputShape(r,n);if(r.length===0)return n;for(var i=n.slice(0,n.length-r.length),a=0;a<r.length;++a){var o=n[n.length-r.length+a],s=r[a];if(o==null||s==null||o<0||s<0)i.push(null);else if(o===1)i.push(s);else if(s===1)i.push(o);else{if(o!==s)throw new le("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(r));i.push(o)}}return i},t.prototype.build=function(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[br(n)]),(n=n).length<2)throw new le("A merge layer should be called on an Array of at least 2 inputs. Got "+n.length+" input(s).");for(var r=[],i=0,a=n;i<a.length;i++)(u=a[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=mh(r)).length>1)throw new le("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(n)+".");for(var o=n[0]==null?null:n[0].slice(1),s=1;s<n.length;++s){var u=n[s]==null?null:n[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var l=n.map(function(c){return c.length});n.indexOf(null)===-1&&mh(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){if(n=n,i.reshapeRequired){var a=[],o=n.map(function(_){return _.rank});if(o.indexOf(null)===-1){for(var s=yh(o),u=0,l=n;u<l.length;u++){for(var c=(g=l[u]).rank,f=0;f<s-c;++f)g=$x(g,1);a.push(g)}return i.mergeFunction(a)}for(var d=!1,h=0,p=n;h<p.length;h++){var g;if((c=(g=p[h]).rank)==null){var m=g.shape,v=m[0],y=m.slice(1).concat([v]),b=g.reshape([v].concat(vh(m.slice(1))));b=(b=In(b,[1,0])).reshape(y),a.push(b),d=!0}else if(c>1){var x=il(1,c).concat([0]);a.push(In(g,x)),d=!0}else a.push(g)}var w=i.mergeFunction(a),S=w.rank;if(d)if(S==null){var C=w.shape;y=[v=C[C.length-1]].concat(C.slice(0,C.length-1)),w=In(w.reshape([-1,v]),[1,0]).reshape(y)}else S>1&&(x=[S-1].concat(il(0,S-1)),w=In(w,x));return w}return i.mergeFunction(n)})},t.prototype.computeOutputShape=function(n){var r;r=(n=n)[0]==null?null:n[0].slice(1);for(var i=1;i<n.length;++i){var a=n[i]==null?null:n[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}for(var o=[],s=0,u=n;s<u.length;s++)(a=u[s])!=null&&a[0]!==null&&o.push(a[0]);return r=(o=mh(o)).length===1?o.concat(r):[null].concat(r)},t.prototype.computeMask=function(n,r){return ge(function(){if(r==null)return null;if(!Array.isArray(r))throw new le("`mask` should be an Array");if(!Array.isArray(n))throw new le("`inputs` should be an Array");if(r.length!==n.length)throw new le("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+n.length+" vs "+r.length+")");if(r.every(function(o){return o==null}))return null;for(var i=(r=r.map(function(o){return o==null?o:Os(o,0)}))[0],a=1;a<r.length-1;++a)i=fc(i,r[a]);return i})},t}(Sn),Ane=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.mergeFunction=function(n){return ge(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=un(r,n[i]);return r})},t.className="Add",t}(Rg);je.registerClass(Ane);var kne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.mergeFunction=function(n){return ge(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=pt(r,n[i]);return r})},t.className="Multiply",t}(Rg);je.registerClass(kne);var Tne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.mergeFunction=function(n){return ge(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=un(r,n[i]);return pt(1/n.length,r)})},t.className="Average",t}(Rg);je.registerClass(Tne);var One=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.mergeFunction=function(n){return ge(function(){for(var r=n[0],i=1;i<n.length;++i)r=lc(r,n[i]);return r})},t.className="Maximum",t}(Rg);je.registerClass(One);var Ine=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.mergeFunction=function(n){return ge(function(){for(var r=n[0],i=1;i<n.length;++i)r=h0(r,n[i]);return r})},t.className="Minimum",t}(Rg);je.registerClass(Ine);var Nne=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_AXIS=-1,n==null&&(n={}),r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Re(t,e),t.prototype.build=function(n){if(!Array.isArray(n)||!Array.isArray(n[0])||n.length===1)throw new le("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,a=n=n;i<a.length;i++)if((d=a[i])!=null){r=!1;break}if(!r){for(var o=[],s=0;s<n.length;++s){var u=n[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,f=o;c<f.length;c++){var d=f[c];if(Ct.arraysEqual(d,u)){l=!0;break}}l||o.push(u)}if(o.length>1)throw new le("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}},t.prototype.mergeFunction=function(n){var r=this;return ge(function(){return lte(n,r.axis)})},t.prototype.computeOutputShape=function(n){if(!Array.isArray(n)||!Array.isArray(n[0]))throw new le("A `Concatenate` layer should be called on a list of inputs.");for(var r=n,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis,o=0,s=r.slice(1);o<s.length;o++){var u=s[o];if(i[a]==null||u[a]==null){i[a]=null;break}i[a]+=u[a]}return i},t.prototype.computeMask=function(n,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new le("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new le("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new le("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+n.length+")");return ge(function(){var a=!0;if(r.forEach(function(l){l==null||(a=!1)}),a)return null;for(var o=[],s=0;s<n.length;++s)r[s]==null?o.push(Ts(n[s]).asType("bool")):r[s].rank<n[s].rank?o.push(Os(r[s],-1)):o.push(r[s]);var u=Ra(o,i.axis);return EA(u,-1,!1)})},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Concatenate",t}(Rg);function qx(e,t){for(;e<0;)e+=t;return e}function xje(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new tn("batchDot is not implemented for tensors of 4D or higher rank yet");if(Ct.assert(e.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length}),Ct.assert(e.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new tn("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);var a=n;return ge(function(){var o,s;if(r>i){o=r-i;for(var u=[],l=0;l<o;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){for(o=i-r,u=[],l=0;l<o;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else o=0;if(e.shape.length===2&&t.shape.length===2)s=a[0]===a[1]?e.mulStrict(t).sum(a[0]):e.transpose([1,0]).mulStrict(t).sum(a[1]);else{var c=a[0]!==e.shape.length-1,f=a[1]===t.shape.length-1;s=e.matMul(t,c,f)}if(o>0){var d=void 0,h=[];for(l=d=r>i?r+i-3:r-1;l<d+o;++l)h.push(l);s=s.squeeze(h)}return s.shape.length===1&&(s=s.expandDims(1)),s})}je.registerClass(Nne);var Dne=function(e){function t(n){var r=e.call(this,n)||this;return r.axes=n.axes,r.normalize=n.normalize!=null&&n.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Re(t,e),t.prototype.build=function(n){Ct.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0],i=n[1];if(r.length>3||i.length>3)throw new tn("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);if(r[a[0]]!==i[a[1]])throw new le("Dimension incompatibility: "+r[a[0]]+" !== "+i[a[1]])},t.prototype.mergeFunction=function(n){if(n.length!==2)throw new le("A `Dot` layer must be called on exactly 2 inputs, but received "+n.length+" input(s).");var r,i=n[0],a=n[1];return r=Array.isArray(this.axes)?this.axes.map(function(o,s){return qx(o,n[s].shape.length)}):[qx(this.axes,i.shape.length),qx(this.axes,a.shape.length)],this.normalize&&(i=HA(i,r[0]),a=HA(a,r[1])),xje(i,a,r)},t.prototype.interpretAxes=function(n,r){return Array.isArray(this.axes)?this.axes:[qx(this.axes,n.length),qx(this.axes,r.length)]},t.prototype.computeOutputShape=function(n){Ct.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new tn("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);r.splice(a[0],1),i.splice(a[1],1),i.splice(0,1);var o=r.concat(i);return o.length===1&&o.push(1),o},t.prototype.computeMask=function(n,r){return null},t.prototype.getConfig=function(){var n={axes:this.axes,normalize:this.normalize},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dot",t}(Rg);je.registerClass(Dne);var Rne=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.stddev=n.stddev,r}return Re(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);return P0(function(){return zA(a.shape,0,i.stddev).add(a)},function(){return a},r.training||!1)})},t.className="GaussianNoise",t}(Sn);je.registerClass(Rne);var Fne=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r}return Re(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r);var a=Yt(n);return i.rate>0&&i.rate<1?P0(function(){var o=Math.sqrt(i.rate/(1-i.rate));return a.mul(zA(a.shape,1,o))},function(){return a},r.training||!1):a})},t.className="GaussianDropout",t}(Sn);je.registerClass(Fne);var Mne=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r.noiseShape=n.noiseShape,r}return Re(t,e),t.prototype._getNoiseShape=function(n){return this.noiseShape||Yt(n).shape},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ge(function(){if(i.rate<1&&i.rate>0){var a=i._getNoiseShape(n);return P0(function(){var o=Yt(n),s=-1.7580993408473766,u=_x(wg(a),i.rate);u=Px(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return o.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Yt(n)},r.training||!1)}return n})},t.className="AlphaDropout",t}(Sn);function Hx(e,t,n,r,i,a){var o;if(a===void 0&&(a=.001),e.rank===2)o=t$(e,t,n,r,i,a);else if(e.rank===3)o=n$(e,t,n,r,i,a);else{if(e.rank!==4)throw new tn("batchNormalization is not implemented for array of rank "+e.rank+" yet");o=r$(e,t,n,r,i,a)}return o}function wje(e,t,n,r,i){return i===void 0&&(i=.001),ge(function(){var a=kx(e,r),o=a.mean,s=a.variance;return[Hx(e,o,s,n,t,i),o,s]})}function _je(e,t,n,r,i){return i===void 0&&(i=.001),ge(function(){for(var a=kx(e,r),o=a.mean,s=a.variance,u=[],l=0,c=il(0,e.rank);l<c.length;l++){var f=c[l];r.indexOf(f)!==-1?u.push(1):u.push(e.shape[f])}var d=o.reshape(u),h=s.reshape(u),p=t==null?null:t.reshape(u),g=n==null?null:n.reshape(u);return[Hx(e,d,h,g,p,i),o,s]})}function Sje(e,t,n,r,i){return i===void 0&&(i=.001),Ct.arraysEqual(r.slice().sort(),il(0,e.rank-1))?wje(e,t,n,r,i):_je(e,t,n,r,i)}je.registerClass(Mne);var Pne=function(e){function t(n){var r=this;return n==null&&(n={}),(r=e.call(this,n)||this).supportsMasking=!0,r.axis=n.axis==null?-1:n.axis,r.momentum=n.momentum==null?.99:n.momentum,r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=Or(n.betaInitializer||"zeros"),r.gammaInitializer=Or(n.gammaInitializer||"ones"),r.movingMeanInitializer=Or(n.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Or(n.movingVarianceInitializer||"ones"),r.betaConstraint=Ai(n.betaConstraint),r.gammaConstraint=Ai(n.gammaConstraint),r.betaRegularizer=Ir(n.betaRegularizer),r.gammaRegularizer=Ir(n.gammaRegularizer),r}return Re(t,e),t.prototype.build=function(n){var r;n=br(n);var i=this.axis>=0?this.axis:this.axis+n.length,a=n[i];if(a==null)throw new le("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(n)+".");this.inputSpec=[new ba({ndim:n.length,axes:(r={},r[i]=a,r)})];var o=[a];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=r.training!=null&&r.training,o=Yt(n),s=o.shape,u=s.length,l=il(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var f=kg(1,u);f[c]=s[c];var d=l.slice();d.sort();var h=!Ct.arraysEqual(d,il(0,u).slice(0,u-1));if(!a)return function(){if(h){var b=i.movingMean.read().reshape(f),x=i.movingVariance.read().reshape(f),w=i.center?i.beta.read().reshape(f):null,S=i.scale?i.gamma.read().reshape(f):null;return Hx(o,b,x,w,S,i.epsilon)}return Hx(o,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var p=Sje(o,i.gamma.read(),i.beta.read(),l,i.epsilon),g=p[0],m=p[1],v=p[2],y=function(b,x,w){ge(function(){var S=1-w,C=b.read(),_=C.sub(x).mul(S);b.write(C.sub(_))})};return y(i.movingMean,m,i.momentum),y(i.movingVariance,v,i.momentum),g})},t.prototype.getConfig=function(){var n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Pn(this.betaInitializer),gammaInitializer:Pn(this.gammaInitializer),movingMeanInitializer:Pn(this.movingMeanInitializer),movingVarianceInitializer:Pn(this.movingVarianceInitializer),betaRegularizer:ln(this.betaRegularizer),gammaRegularizer:ln(this.gammaRegularizer),betaConstraint:ur(this.betaConstraint),gammaConstraint:ur(this.gammaConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="BatchNormalization",t}(Sn);je.registerClass(Pne);var $ne=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).axis=n.axis==null?-1:n.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,a=r.axis;i<a.length;i++){var o=a[i];if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=Or(n.betaInitializer||"zeros"),r.gammaInitializer=Or(n.gammaInitializer||"ones"),r.betaRegularizer=Ir(n.betaRegularizer),r.gammaRegularizer=Ir(n.gammaRegularizer),r.supportsMasking=!0,r}return Re(t,e),t.prototype.build=function(n){var r=(n=br(n)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var a=0,o=this.axis;a<o.length;a++){var s=o[a];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==mh(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return n[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(n,r){var i=this,a=Yt(n),o=a.shape,s=o.length;return ge(function(){for(var u=kx(a,i.axis,!0),l=u.mean,c=u.variance,f=kg(1,s),d=0,h=i.axis;d<h.length;d++){var p=h[d];f[p]=o[p]}for(var g=function(w){return w!=null&&w.shape.length!==s&&i.axis!==[s-1]?w.reshape(f):w},m=g(i.gamma.read()),v=g(i.beta.read()),y=[],b=[],x=0;x<s;++x)i.axis.indexOf(x)!==-1?(y.push(o[x]),b.push(1)):(y.push(1),b.push(o[x]));return l=l.tile(y),c=c.tile(y),m=m.tile(b),v=v.tile(b),Hx(a,l,c,v,m,i.epsilon)})},t.prototype.getConfig=function(){var n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Pn(this.betaInitializer),gammaInitializer:Pn(this.gammaInitializer),betaRegularizer:ln(this.betaRegularizer),gammaRegularizer:ln(this.gammaRegularizer)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LayerNormalization",t}(Sn);function Eje(e,t,n){return ge(function(){if(e.rank!==4)throw new le("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new le("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=rl()),n!=="channelsLast"&&n!=="channelsFirst")throw new le("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=n==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],dc(e,r)})}je.registerClass($ne);var Lne=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).dataFormat=n.dataFormat==null?rl():n.dataFormat,n.padding==null)r.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")r.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new le("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+n.padding.length+" array.");var i=void 0,a=void 0;if(typeof n.padding[0]=="number")i=[n.padding[0],n.padding[0]],a=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new le("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+n.padding[0].length+" array.");if(i=n.padding[0],n.padding[1].length!==2)throw new le("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+n.padding[1].length+" array.");a=n.padding[1]}r.padding=[i,a]}return r.inputSpec=[new ba({ndim:4})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){var r,i;return n=br(n),this.dataFormat==="channelsFirst"?(r=n[2]!=null&&n[2]>=0?n[2]+this.padding[0][0]+this.padding[0][1]:null,i=n[3]!=null&&n[3]>=0?n[3]+this.padding[1][0]+this.padding[1][1]:null,[n[0],n[1],r,i]):(r=n[1]!=null&&n[1]>=0?n[1]+this.padding[0][0]+this.padding[0][1]:null,i=n[2]!=null&&n[2]>=0?n[2]+this.padding[1][0]+this.padding[1][1]:null,[n[0],r,i,n[3]])},t.prototype.call=function(n,r){var i=this;return ge(function(){return Eje(Yt(n),i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={padding:this.padding,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ZeroPadding2D",t}(Sn);function rk(e,t,n,r,i,a){return ge(function(){var o;ki(i),rte(a),fu(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=rl()),a==null&&(a="max"),e=FL(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?bA(e,t,n,s):xA(e,t,n,s),i==="channelsFirst"&&(o=In(o,[0,3,1,2])),o})}function Bne(e,t,n,r,i,a){return ge(function(){var o;ki(i),rte(a),fu(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=rl()),a==null&&(a="max"),e=sne(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?wA(e,t,n,s):_A(e,t,n,s),i==="channelsFirst"&&(o=In(o,[0,4,1,2,3])),o})}je.registerClass(Lne);var zne=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=2),r=e.call(this,n)||this,typeof n.poolSize=="number")r.poolSize=[n.poolSize];else{if(!Array.isArray(n.poolSize)||n.poolSize.length!==1||typeof n.poolSize[0]!="number")throw new le("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.poolSize));r.poolSize=n.poolSize}if(fo(r.poolSize,"poolSize"),n.strides==null)r.strides=r.poolSize;else if(typeof n.strides=="number")r.strides=[n.strides];else{if(!Array.isArray(n.strides)||n.strides.length!==1||typeof n.strides[0]!="number")throw new le("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.strides));r.strides=n.strides}return fo(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,fu(r.padding),r.inputSpec=[new ba({ndim:3})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){var r=zf((n=br(n))[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],r,n[2]]},t.prototype.call=function(n,r){var i=this;return ge(function(){i.invokeCallHook(n,r),n=$x(Yt(n),2);var a=i.poolingFunction(Yt(n),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return ux(a,[2])})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(Sn),jne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),rk(n,r,i,a,o,"max")},t.className="MaxPooling1D",t}(zne);je.registerClass(jne);var Une=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),rk(n,r,i,a,o,"avg")},t.className="AveragePooling1D",t}(zne);je.registerClass(Une);var Wne=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new le("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides];return fo(r.poolSize,"poolSize"),fo(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,ki(r.dataFormat),fu(r.padding),r.inputSpec=[new ba({ndim:4})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){n=br(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2];return r=zf(r,this.poolSize[0],this.padding,this.strides[0]),i=zf(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i]:[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return ge(function(){return i.invokeCallHook(n,r),i.poolingFunction(Yt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(Sn),Vne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),rk(n,r,i,a,o,"max")},t.className="MaxPooling2D",t}(Wne);je.registerClass(Vne);var qne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),rk(n,r,i,a,o,"avg")},t.className="AveragePooling2D",t}(Wne);je.registerClass(qne);var Hne=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new le("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides,n.strides];return fo(r.poolSize,"poolSize"),fo(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,ki(r.dataFormat),fu(r.padding),r.inputSpec=[new ba({ndim:5})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){n=br(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[4]:n[3];return r=zf(r,this.poolSize[0],this.padding,this.strides[0]),i=zf(i,this.poolSize[1],this.padding,this.strides[1]),a=zf(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i,a]:[n[0],r,i,a,n[4]]},t.prototype.call=function(n,r){var i=this;return ge(function(){return i.invokeCallHook(n,r),i.poolingFunction(Yt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(Sn),Gne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),Bne(n,r,i,a,o,"max")},t.className="MaxPooling3D",t}(Hne);je.registerClass(Gne);var Kne=function(e){function t(n){return e.call(this,n)||this}return Re(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return ki(o),fu(a),Bne(n,r,i,a,o,"avg")},t.className="AveragePooling3D",t}(Hne);je.registerClass(Kne);var Xne=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[new ba({ndim:3})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){return[n[0],n[2]]},t.prototype.call=function(n,r){throw new tn},t}(Sn),Yne=function(e){function t(n){return e.call(this,n||{})||this}return Re(t,e),t.prototype.call=function(n,r){return ge(function(){var i=Yt(n);return di(i,1)})},t.className="GlobalAveragePooling1D",t}(Xne);je.registerClass(Yne);var Zne=function(e){function t(n){return e.call(this,n||{})||this}return Re(t,e),t.prototype.call=function(n,r){return ge(function(){var i=Yt(n);return uh(i,1)})},t.className="GlobalMaxPooling1D",t}(Xne);je.registerClass(Zne);var Jne=function(e){function t(n){var r=e.call(this,n)||this;return r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,ki(r.dataFormat),r.inputSpec=[new ba({ndim:4})],r}return Re(t,e),t.prototype.computeOutputShape=function(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]},t.prototype.call=function(n,r){throw new tn},t.prototype.getConfig=function(){var n={dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(Sn),Qne=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){var a=Yt(n);return i.dataFormat==="channelsLast"?di(a,[1,2]):di(a,[2,3])})},t.className="GlobalAveragePooling2D",t}(Jne);je.registerClass(Qne);var ere=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){var a=Yt(n);return i.dataFormat==="channelsLast"?uh(a,[1,2]):uh(a,[2,3])})},t.className="GlobalMaxPooling2D",t}(Jne);function tre(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new le("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function nre(e,t,n,r,i,a,o,s){return r===void 0&&(r=!1),o===void 0&&(o=!1),s===void 0&&(s=!1),ge(function(){var u=t.shape.length;if(u<3)throw new le("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(il(2,u));if(t=In(t,l),a!=null)throw new tn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Os(i,-1)),i=In(i,l)),r&&(t=hc(t,0),i!=null&&(i=hc(i,0)));var c,f,d=[],h=n,p=t.shape[0],g=rh(t);i!=null&&(f=rh(i));for(var m,v=function(b){var x=g[b],w=ge(function(){return e(x,h)});if(i==null)c=w[0],h=w[1];else{var S=ge(function(){var C=f[b],_=Ts(C).sub(C);return{output:w[0].mul(C).addStrict(h[0].mul(_)),newStates:h.map(function(E,A){return w[1][A].mul(C).addStrict(E.mul(_))})}});c=S.output,h=S.newStates}s&&d.push(c)},y=0;y<p;++y)v(y);return s&&(m=lu(d,1)),[c,m,h]})}je.registerClass(ere);var z0=function(e){function t(n){var r,i=e.call(this,n)||this;if(n.cell==null)throw new le("cell property is missing for the constructor of RNN.");if((r=Array.isArray(n.cell)?new zL({cells:n.cell}):n.cell).stateSize==null)throw new le("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=n.returnSequences!=null&&n.returnSequences,i.returnState=n.returnState!=null&&n.returnState,i.goBackwards=n.goBackwards!=null&&n.goBackwards,i._stateful=n.stateful!=null&&n.stateful,i.unroll=n.unroll!=null&&n.unroll,i.supportsMasking=!0,i.inputSpec=[new ba({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return Re(t,e),t.prototype.getStates=function(){return this.states_==null?il(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(n){return null}):this.states_},t.prototype.setStates=function(n){this.states_=n},t.prototype.computeOutputShape=function(n){mL(n)&&(n=n[0]),n=n;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[n[0],n[1],a]:[n[0],a],this.returnState){for(var o=[],s=0,u=r;s<u.length;s++){var l=u[s];o.push([n[0],l])}return[i].concat(o)}return i},t.prototype.computeMask=function(n,r){var i=this;return ge(function(){Array.isArray(r)&&(r=r[0]);var a=i.returnSequences?r:null;if(i.returnState){var o=i.states.map(function(s){return null});return[a].concat(o)}return a})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<n;++i)r.push(null);return r}return this.states_},set:function(n){this.states_=n},enumerable:!0,configurable:!0}),t.prototype.build=function(n){if(this.numConstants!=null)throw new tn("Constants support is not implemented in RNN yet.");mL(n)&&(n=n[0]),n=n;var r=this.stateful?n[0]:null,i=n[n.length-1];this.inputSpec[0]=new ba({shape:[r,null,i]});var a,o=[n[0]].concat(n.slice(2));if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!Ct.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),a))throw new le("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map(function(s){return new ba({shape:[null,s]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(n,r){var i=this;r===void 0&&(r=!1),ge(function(){if(!i.stateful)throw new Ag("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=i.inputSpec[0].shape[0];if(a==null)throw new le("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Kn([a,c])}):i.states_=[Kn([a,i.cell.stateSize])];else if(n==null)sn(i.states_),i.keptStates!=null&&(sn(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Kn([a,c])}):i.states_[0]=Kn([a,i.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==i.states_.length)throw new le("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+n.length+" state value(s). Input received: "+n);r===!0?i.keptStates.push(i.states_.slice()):sn(i.states_);for(var o=0;o<i.states_.length;++o){var s=n[o],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[o]:i.cell.stateSize,l=[a,u];if(!Ct.arraysEqual(s.shape,l))throw new le("State "+o+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[o]=s}}i.states_=i.states_.map(function(c){return ac(c.clone())})})},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=tre(n,i,a,this.numConstants);n=o.inputs,i=o.initialState,a=o.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var f=c[l];this.stateSpec.push(new ba({shape:f.shape}))}u=u.concat(this.stateSpec)}if(a!=null&&(r.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof mc){var d=[n].concat(s),h=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=h;var g=e.prototype.apply.call(this,d,r);return this.inputSpec=p,g}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=Yt(n),s==null&&(s=i.stateful?i.states_:i.getInitialState(n));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new le("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:o},c=nre(function(g,m){var v=i.cell.call([g].concat(m),l);return[v[0],v.slice(1)]},n,s,i.goBackwards,a,null,i.unroll,i.returnSequences),f=c[0],d=c[1],h=c[2];i.stateful&&i.resetStates(h,o);var p=i.returnSequences?d:f;return i.returnState?[p].concat(h):p})},t.prototype.getInitialState=function(n){var r=this;return ge(function(){var i=Kn(n.shape);return i=$x(i=Ei(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(a){return a>1?sL(i,[1,a]):i}):r.cell.stateSize>1?[sL(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);var r=this.cell.getConfig();n.cell={className:this.cell.getClassName(),config:r};var i=e.prototype.getConfig.call(this);return Object.assign(n,i),n},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=ol(r.cell,i);return new n(Object.assign(r,{cell:a}))},t.className="RNN",t}(Sn);je.registerClass(z0);var Gx=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Re(t,e),t}(Sn),$L=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,fo(r.units,"units"),r.activation=xh(n.activation==null?r.DEFAULT_ACTIVATION:n.activation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=Or(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Or(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Or(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Ir(n.kernelRegularizer),r.recurrentRegularizer=Ir(n.recurrentRegularizer),r.biasRegularizer=Ir(n.biasRegularizer),r.kernelConstraint=Ai(n.kernelConstraint),r.recurrentConstraint=Ai(n.recurrentConstraint),r.biasConstraint=Ai(n.biasConstraint),r.dropout=M0([1,yh([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=M0([1,yh([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Re(t,e),t.prototype.build=function(n){n=br(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){if((n=n).length!==2)throw new le("SimpleRNNCell expects 2 input Tensors, got "+n.length+".");var a=n[1];n=n[0];var o,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=j0(function(){return Ts(n)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=j0(function(){return Ts(a)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;o=Lf(u!=null?pt(n,u):n,i.kernel.read()),i.bias!=null&&(o=Bf(o,i.bias.read())),l!=null&&(a=pt(a,l));var c=un(o,Lf(a,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="SimpleRNNCell",t}(Gx);je.registerClass($L);var rre=function(e){function t(n){return n.cell=new $L(n),e.call(this,n)||this}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){i.cell.dropoutMask!=null&&(sn(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(sn(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return new n(r)},t.className="SimpleRNN",t}(z0);je.registerClass(rre);var LL=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,fo(r.units,"units"),r.activation=xh(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=xh(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=Or(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Or(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Or(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Ir(n.kernelRegularizer),r.recurrentRegularizer=Ir(n.recurrentRegularizer),r.biasRegularizer=Ir(n.biasRegularizer),r.kernelConstraint=Ai(n.kernelConstraint),r.recurrentConstraint=Ai(n.recurrentConstraint),r.biasConstraint=Ai(n.biasConstraint),r.dropout=M0([1,yh([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=M0([1,yh([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Re(t,e),t.prototype.build=function(n){var r=(n=br(n))[n.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){if((n=n).length!==2)throw new le("GRUCell expects 2 input Tensors (inputs, h, c), got "+n.length+".");var a=r.training!=null&&r.training,o=n[1];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=j0(function(){return Ts(n)},i.dropout,a,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=j0(function(){return Ts(o)},i.recurrentDropout,a,3));var s,u,l,c=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=pt(n,c[0]));var d=Lf(n,i.kernel.read());i.useBias&&(d=Bf(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(o=pt(o,f[0]));var h=i.recurrentKernel.read(),p=If(h,[2*i.units,i.units],h.rank-1),g=p[0],m=p[1],v=Lf(o,g),y=If(d,3,d.rank-1),b=y[0],x=y[1],w=y[2],S=If(v,2,v.rank-1),C=S[0],_=S[1];s=i.recurrentActivation.apply(un(b,C)),u=i.recurrentActivation.apply(un(x,_));var E=Lf(pt(u,o),m);l=i.activation.apply(un(w,E));var A=un(pt(s,o),pt(un(1,ah(s)),l));return[A,A]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),recurrentActivation:Rs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="GRUCell",t}(Gx);je.registerClass(LL);var ire=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new LL(n),e.call(this,n)||this}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){i.cell.dropoutMask!=null&&(sn(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(sn(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),recurrentActivation:Rs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="GRU",t}(z0);je.registerClass(ire);var BL=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,fo(r.units,"units"),r.activation=xh(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=xh(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=Or(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Or(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Or(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=n.unitForgetBias,r.kernelRegularizer=Ir(n.kernelRegularizer),r.recurrentRegularizer=Ir(n.recurrentRegularizer),r.biasRegularizer=Ir(n.biasRegularizer),r.kernelConstraint=Ai(n.kernelConstraint),r.recurrentConstraint=Ai(n.recurrentConstraint),r.biasConstraint=Ai(n.biasConstraint),r.dropout=M0([1,yh([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=M0([1,yh([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Re(t,e),t.prototype.build=function(n){var r,i,a=(n=br(n))[n.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return Re(l,u),l.prototype.apply=function(c,f){var d=o.apply([s]),h=new lL().apply([s]),p=o.apply([2*s]);return cte(cte(d,h),p)},l}(al)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(n,r){var i=this;return ge(function(){var a=r.training!=null&&r.training;if((n=n).length!==3)throw new le("LSTMCell expects 3 input Tensors (inputs, h, c), got "+n.length+".");var o=n[1],s=n[2];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=j0(function(){return Ts(n)},i.dropout,a,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=j0(function(){return Ts(o)},i.recurrentDropout,a,4));var u,l,c,f,d=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=pt(n,d[0]));var p=Lf(n,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(o=pt(o,h[0])),p=un(p,Lf(o,i.recurrentKernel.read())),i.useBias&&(p=Bf(p,i.bias.read()));var g=If(p,4,p.rank-1),m=g[0],v=g[1],y=g[2],b=g[3];u=i.recurrentActivation.apply(m),l=i.recurrentActivation.apply(v),c=un(pt(l,s),pt(u,i.activation.apply(y))),f=i.recurrentActivation.apply(b);var x=pt(f,i.activation.apply(c));return[x,x,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),recurrentActivation:Rs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LSTMCell",t}(Gx);je.registerClass(BL);var are=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new BL(n),e.call(this,n)||this}return Re(t,e),t.prototype.call=function(n,r){var i=this;return ge(function(){i.cell.dropoutMask!=null&&(sn(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(sn(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Rs(this.activation),recurrentActivation:Rs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Pn(this.kernelInitializer),recurrentInitializer:Pn(this.recurrentInitializer),biasInitializer:Pn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ln(this.kernelRegularizer),recurrentRegularizer:ln(this.recurrentRegularizer),biasRegularizer:ln(this.biasRegularizer),activityRegularizer:ln(this.activityRegularizer),kernelConstraint:ur(this.kernelConstraint),recurrentConstraint:ur(this.recurrentConstraint),biasConstraint:ur(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="LSTM",t}(z0);je.registerClass(are);var zL=function(e){function t(n){var r=e.call(this,n)||this;return r.cells=n.cells,r}return Re(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var n=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var a=i[r];Array.isArray(a.stateSize)?n.push.apply(n,a.stateSize):n.push(a.stateSize)}return n},enumerable:!0,configurable:!0}),t.prototype.call=function(n,r){var i=this;return ge(function(){for(var a=(n=n).slice(1),o=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?o.push(a.splice(0,l.stateSize.length)):o.push(a.splice(0,1))}o.reverse();for(var c,f=[],d=0;d<i.cells.length;++d)l=i.cells[d],a=o[d],c=d===0?[n[0]].concat(a):[c[0]].concat(a),c=l.call(c,r),f.push(c.slice(1));a=[];for(var h=0,p=f.slice().reverse();h<p.length;h++){var g=p[h];a.push.apply(a,g)}return[c[0]].concat(a)})},t.prototype.build=function(n){var r;mL(n)&&(n=n[0]),n=n,this.cells.forEach(function(i,a){Og("RNNCell_"+a,function(){i.build(n),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,n=[n[0],r]})}),this.built=!0},t.prototype.getConfig=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push({className:a.getClassName(),config:a.getConfig()})}var o={cells:n},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(n,r,i){i===void 0&&(i={});for(var a=[],o=0,s=r.cells;o<s.length;o++){var u=s[o];a.push(ol(u,i))}return new n({cells:a})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.cells;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.weights)}return vL(n)},t.prototype.setWeights=function(n){for(var r=[],i=0,a=this.cells;i<a.length;i++)for(var o=a[i],s=o.weights.length,u=n.splice(s),l=0;l<o.weights.length;++l)r.push([o.weights[l],u[l]]);yL(r)},t.className="StackedRNNCells",t}(Gx);function j0(e,t,n,r){function i(){return dte(e(),t)}if(n===void 0&&(n=null),r===void 0&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(P0(i,e,n));return a.map(function(s){return ac(s.clone())})}return ac(P0(i,e,n).clone())}je.registerClass(zL);var ore=function(e){function t(n){var r=e.call(this,n)||this;return r.layer=n.layer,r}return Re(t,e),t.prototype.build=function(n){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(n){this.layer!=null&&(this.layer.trainable=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(n){this.layer.setWeights(n)},t.prototype.getConfig=function(){var n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=ol(r.layer,i);delete r.layer;var o={layer:a};return Object.assign(o,r),new n(o)},t}(Sn),sre=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r}return Re(t,e),t.prototype.build=function(n){if((n=br(n)).length<3)throw new le("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(n));this.inputSpec=[{shape:n}];var r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),e.prototype.build.call(this,n)},t.prototype.computeOutputShape=function(n){var r=[(n=br(n))[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),a=n[1];return[i[0],a].concat(i.slice(1))},t.prototype.call=function(n,r){var i=this;return ge(function(){return nre(function(a,o){return[Yt(i.layer.call(a,r)),[]]},n=Yt(n),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(ore);function Cje(e){R0(m5e,"BidirectionalMergeMode",e)}je.registerClass(sre);var Aje="concat",ure=function(e){function t(n){var r=e.call(this,n)||this,i=n.layer.getConfig(),a={};a.className=n.layer.getClassName(),a.config=i,r.forwardLayer=ol(a),i.goBackwards=i.goBackwards!==!0;var o={};if(o.className=n.layer.getClassName(),o.config=i,r.backwardLayer=ol(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=n.mergeMode===void 0?Aje:n.mergeMode,Cje(r.mergeMode),n.weights)throw new tn("weights support is not implemented for Bidirectional layer yet.");return r._stateful=n.layer.stateful,r.returnSequences=n.layer.returnSequences,r.returnState=n.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=n.layer.inputSpec,r.numConstants=null,r}return Re(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(n){var r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))},t.prototype.computeOutputShape=function(n){var r,i,a,o=this.forwardLayer.computeOutputShape(n);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState&&(a=o.slice(1)),r=o[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):co(i)},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=tre(n,i,a,this.numConstants);if(n=o.inputs,i=o.initialState,a=o.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&a==null)return e.prototype.apply.call(this,n,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new le("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new ba({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(a!=null)throw new tn("Support for constants in Bidirectional layers is not implemented yet.");for(var f=s[0]instanceof mc,d=0,h=s;d<h.length;d++)if(h[d]instanceof mc!==f)throw new le("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(f){var p=[n].concat(s),g=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,r);return this.inputSpec=m,v}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return ge(function(){var a,o,s,u,l=r.initialState;if(l==null)a=i.forwardLayer.call(n,r),o=i.backwardLayer.call(n,r);else{var c=l.slice(0,l.length/2),f=l.slice(l.length/2);a=i.forwardLayer.call(n,Object.assign(r,{initialState:c})),o=i.backwardLayer.call(n,Object.assign(r,{initialState:f}))}return i.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),i.returnSequences&&(o=hc(o,1)),i.mergeMode==="concat"?u=lte([a,o]):i.mergeMode==="sum"?u=un(a,o):i.mergeMode==="ave"?u=pt(.5,un(a,o)):i.mergeMode==="mul"?u=pt(a,o):i.mergeMode==null&&(u=[a,o]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},t.prototype.resetStates=function(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(n){var r=this;Og(this.forwardLayer.name,function(){r.forwardLayer.build(n)}),Og(this.backwardLayer.name,function(){r.backwardLayer.build(n)}),this.built=!0},t.prototype.computeMask=function(n,r){var i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?this.mergeMode==null?[r,r]:r:this.mergeMode==null?[null,null]:null,this.returnState){var a=this.forwardLayer.states.map(function(o){return null});return Array.isArray(i)?i.concat(a).concat(a):[i].concat(a).concat(a)}return i},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={mergeMode:this.mergeMode},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.fromConfig=function(n,r){var i=ol(r.layer);if(delete r.layer,r.numConstants!=null)throw new tn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=r;return a.layer=i,new n(a)},t.className="Bidirectional",t}(ore);function kje(e){return new Bx(e)}function Tje(e){return new ine(e)}function Oje(e){return new tne(e)}function Ije(e){return new nne(e)}function Nje(e){return new rne(e)}function Dje(e){return new one(e)}function Rje(e){return new ane(e)}function Fje(e){return new hne(e)}function Mje(e){return new ML(e)}function Pje(e){return new fne(e)}function $je(e){return new cne(e)}function Lje(e){return new dne(e)}function Bje(e){return new pne(e)}function zje(e){return new gne(e)}function jje(e){return new mne(e)}function Uje(e){return new xne(e)}function Wje(e){return new yne(e)}function Vje(e){return new PL(e)}function qje(e){return new vne(e)}function Hje(e){return new bne(e)}function Gje(e){return new wne(e)}function Kje(e){return new _ne(e)}function Xje(e){return new Sne(e)}function Yje(e){return new Cne(e)}function Zje(e){return new Ane(e)}function Jje(e){return new Tne(e)}function Qje(e){return new Nne(e)}function e8e(e){return new One(e)}function t8e(e){return new Ine(e)}function n8e(e){return new kne(e)}function r8e(e){return new Dne(e)}function i8e(e){return new Pne(e)}function a8e(e){return new $ne(e)}function o8e(e){return new Lne(e)}function jL(e){return new Une(e)}function s8e(e){return jL(e)}function u8e(e){return jL(e)}function UL(e){return new qne(e)}function l8e(e){return UL(e)}function c8e(e){return UL(e)}function WL(e){return new Kne(e)}function f8e(e){return WL(e)}function d8e(e){return WL(e)}function h8e(e){return new Yne(e)}function p8e(e){return new Qne(e)}function lre(e){return new Zne(e)}function cre(e){return new ere(e)}function fre(e){return new jne(e)}function dre(e){return new Vne(e)}function g8e(e){return new Gne(e)}function m8e(e){return new ire(e)}function v8e(e){return new LL(e)}function y8e(e){return new are(e)}function b8e(e){return new BL(e)}function x8e(e){return new rre(e)}function w8e(e){return new $L(e)}function _8e(e){return new z0(e)}function S8e(e){return new zL(e)}function E8e(e){return new ure(e)}function C8e(e){return new sre(e)}je.registerClass(ure);var A8e=lre,k8e=cre,T8e=fre,O8e=dre;function I8e(e){return new Rne(e)}function N8e(e){return new Fne(e)}function D8e(e){return new Mne(e)}function R8e(e){return new Ene(e)}var F8e=Object.freeze({inputLayer:kje,elu:Tje,reLU:Oje,leakyReLU:Ije,prelu:Nje,softmax:Dje,thresholdedReLU:Rje,conv1d:Fje,conv2d:Mje,conv2dTranspose:Pje,conv3d:$je,separableConv2d:Lje,cropping2D:Bje,upSampling2d:zje,depthwiseConv2d:jje,activation:Uje,dense:Wje,dropout:Vje,spatialDropout1d:qje,flatten:Hje,repeatVector:Gje,reshape:Kje,permute:Xje,embedding:Yje,add:Zje,average:Jje,concatenate:Qje,maximum:e8e,minimum:t8e,multiply:n8e,dot:r8e,batchNormalization:i8e,layerNormalization:a8e,zeroPadding2d:o8e,averagePooling1d:jL,avgPool1d:s8e,avgPooling1d:u8e,averagePooling2d:UL,avgPool2d:l8e,avgPooling2d:c8e,averagePooling3d:WL,avgPool3d:f8e,avgPooling3d:d8e,globalAveragePooling1d:h8e,globalAveragePooling2d:p8e,globalMaxPooling1d:lre,globalMaxPooling2d:cre,maxPooling1d:fre,maxPooling2d:dre,maxPooling3d:g8e,gru:m8e,gruCell:v8e,lstm:y8e,lstmCell:b8e,simpleRNN:x8e,simpleRNNCell:w8e,rnn:_8e,stackedRNNCells:S8e,bidirectional:E8e,timeDistributed:C8e,globalMaxPool1d:A8e,globalMaxPool2d:k8e,maxPool1d:T8e,maxPool2d:O8e,Layer:Sn,RNN:z0,RNNCell:Gx,input:nje,gaussianNoise:I8e,gaussianDropout:N8e,alphaDropout:D8e,masking:R8e});function M8e(e,t){return wL(e,t)}function P8e(e,t){return Dte(e,t)}function $8e(e,t){return Rte(e,t)}function L8e(e,t){return _L(e,t)}function B8e(e,t){return SL(e,t)}function z8e(e,t){return Nte(e,t)}function j8e(e,t){return g6e(e,t)}function U8e(e,t){return bL(e,t)}function W8e(e,t){return GA(e,t)}function V8e(e,t){return L0(e,t)}function q8e(e,t){return L0(e,t)}function H8e(e,t){return L0(e,t)}function G8e(e,t){return Ng(e,t)}function K8e(e,t){return Ng(e,t)}function X8e(e,t){return Ng(e,t)}Object.freeze({binaryAccuracy:M8e,binaryCrossentropy:P8e,sparseCategoricalAccuracy:$8e,categoricalAccuracy:L8e,categoricalCrossentropy:B8e,precision:z8e,recall:j8e,cosineProximity:U8e,meanAbsoluteError:W8e,meanAbsolutePercentageError:V8e,MAPE:q8e,mape:H8e,meanSquaredError:G8e,MSE:K8e,mse:X8e}),Object.freeze({modelFromJSON:Y6e});function Y8e(e){return new ek(e)}function Z8e(e){return pje(e)}function J8e(e){return gje(e)}Object.freeze({l1l2:Y8e,l1:Z8e,l2:J8e});var Q8e=function(e){function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.model=null,n}return Re(t,e),t.prototype.setModel=function(n){if(!(n instanceof Vx))throw new Error("model must be a LayersModel, not some other Container");this.model=n},t}($0);function ik(e,t){return e<t}function hre(e,t){return e>t}(function(e){function t(n){var r=e.call(this)||this;if(n==null&&(n={}),n.restoreBestWeights)throw new tn("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=n.monitor||"val_loss",r.minDelta=Math.abs(n.minDelta||0),r.patience=n.patience||0,r.verbose=n.verbose||0,r.mode=n.mode||"auto",r.baseline=n.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=ik:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=hre:r.monitorFunc=ik,r.monitorFunc===ik&&(r.minDelta*=-1),r}return Re(t,e),t.prototype.onTrainBegin=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===ik?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(n,r){return jt(this,void 0,void 0,function(){var i;return Pt(this,function(a){switch(a.label){case 0:return[4,bh(r)];case 1:return a.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=n,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(n){return jt(this,void 0,void 0,function(){return Pt(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(n){n==null&&(n={});var r=n[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(n)),r},t})(Q8e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sl,pre,VL=function(){return(VL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Fg(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Mg(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(sl||(sl={})),function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(pre||(pre={}));var e9e={};function gre(e){return e9e[e]}function B(e,t,n,r){var i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){var a=i.inputIndexStart,o=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return ho(t.inputNames[i.inputIndexStart],n,r);if(i.type==="tensors")return t.inputNames.slice(a,o).map(function(l){return ho(l,n,r)});var s=Array.prototype.slice.call(ho(t.inputNames.slice(a)[0],n,r).dataSync());return i.type==="number"?s[0]:s}var u=t.attrParams[e];return u&&u.value}function ho(e,t,n){var r=Fs(e),i=r[0],a=r[1],o=n.currentContextIds.find(function(s){return!!t[ak(i,s)]});return o!==void 0?t[ak(i,o)][a]:void 0}function t9e(e,t,n){return t[ak(e,n.currentContextId)]}function U0(e,t){var n=Fs(e),r=n[0],i=n[1];return[ak(r,t&&t.currentContextId),i]}function ak(e,t){return t?e+"-"+t:e}function Fs(e){var t=e.lastIndexOf(":");return t===-1?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function qL(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var n9e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],r9e=Object.freeze({json:n9e}),i9e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],a9e=Object.freeze({json:i9e}),o9e=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],s9e=Object.freeze({json:o9e}),u9e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],l9e=Object.freeze({json:u9e}),c9e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],f9e=Object.freeze({json:c9e}),d9e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],h9e=Object.freeze({json:d9e}),p9e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],g9e=Object.freeze({json:p9e}),m9e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],v9e=Object.freeze({json:m9e}),y9e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],b9e=Object.freeze({json:y9e}),x9e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],w9e=Object.freeze({json:x9e}),_9e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],S9e=Object.freeze({json:_9e}),E9e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],C9e=Object.freeze({json:E9e}),A9e=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],k9e=Object.freeze({json:A9e}),T9e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],O9e=Object.freeze({json:T9e}),I9e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],N9e=Object.freeze({json:I9e}),D9e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],R9e=Object.freeze({json:D9e}),F9e=function(){function e(){var t=[r9e,a9e,s9e,l9e,f9e,h9e,g9e,w9e,b9e,v9e,S9e,C9e,k9e,O9e,N9e,R9e],n=[].concat.apply([],t.map(function(r){return r.json}));this.opMappers=n.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(t,n){var r=this;n===void 0&&(n={});var i=[],a=[],o=t.node.reduce(function(d,h){return d[h.name]=r.mapNode(h),h.op.startsWith("Placeholder")&&i.push(d[h.name]),h.op==="Const"&&a.push(d[h.name]),d},{}),s=[],u=[],l={},c={};n!=null&&(l=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var f=Object.keys(o);return f.forEach(function(d){var h=o[d];h.inputNames.forEach(function(p){var g=U0(p)[0];h.inputs.push(o[g]),o[g].children.push(h)})}),Object.keys(c).length===0?f.forEach(function(d){var h=o[d];h.children.length===0&&u.push(h)}):Object.keys(c).forEach(function(d){var h=U0(d)[0],p=o[h];p!=null&&(p.signatureKey=c[d],u.push(p))}),Object.keys(l).length>0?Object.keys(l).forEach(function(d){var h=U0(d)[0],p=o[h];p&&(p.signatureKey=l[d],s.push(p))}):s=i,{nodes:o,inputs:s,outputs:u,weights:a,placeholders:i,signature:n}},e.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce(function(n,r){return n[t[r].name]=r,n},{})},e.prototype.mapNode=function(t){var n=gre(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(r.inputParams=n.inputs.reduce(function(i,a){return i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i},{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce(function(i,a){var o=a.type,s=void 0;switch(a.type){case"string":(s=HL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=HL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":(s=QL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=QL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":(s=KL(t.attr,a.tfName,a.defaultValue||0))===void 0&&a.tfDeprecatedName&&(s=KL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":(s=JL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=JL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":(s=GL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=GL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":(s=t4(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=t4(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":(s=ZL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=ZL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":(s=e4(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=e4(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":(s=XL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=XL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":(s=YL(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=YL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+t.op)}return i[a.name]={value:s,type:o},i},{})),r},e}();function M9e(e){var t=we().global;if(t.atob!==void 0)return t.atob(e);if(typeof Buffer!="undefined")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function mre(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):M9e(e);return t?n:n.toLowerCase()}function HL(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i!=null?mre(i.s,r):n}function GL(e,t,n){var r=e[t];return r?r.b:n}function KL(e,t,n){var r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function vre(e){switch(typeof e=="string"&&(e=sl[e]),e){case sl.DT_FLOAT:return"float32";case sl.DT_INT32:case sl.DT_INT64:case sl.DT_INT8:case sl.DT_UINT8:return"int32";case sl.DT_BOOL:return"bool";case sl.DT_DOUBLE:return"float32";case sl.DT_STRING:return"string";default:return null}}function XL(e,t,n){var r=e[t];return r&&r.type?vre(r.type):n}function YL(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map(function(i){return vre(i)}):n}function yre(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function ZL(e,t,n){var r=e[t];return r&&r.shape?yre(r.shape):n}function JL(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):n}function QL(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i&&i.list&&i.list.s?i.list.s.map(function(a){return mre(a,r)}):n}function e4(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return yre(i)}):n}function t4(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var P9e=function(){function e(t,n,r){var i=this;this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(a){return i.getInput(a)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(a,o){return a[o]=i.getAttr(o),a},{}))}return e.prototype.getInput=function(t){return ho(t,this.tensorMap,this.context)},e.prototype.getAttr=function(t,n){var r=this.node.rawAttrs[t];if(r.tensor!=null)return ho(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return KL(this.node.rawAttrs,t,n);if(r.s!=null)return HL(this.node.rawAttrs,t,n);if(r.b!=null)return GL(this.node.rawAttrs,t,n);if(r.shape!=null)return ZL(this.node.rawAttrs,t,n);if(r.type!=null)return XL(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return JL(this.node.rawAttrs,t,n);if(r.list.s!=null)return QL(this.node.rawAttrs,t,n);if(r.list.shape!=null)return e4(this.node.rawAttrs,t,n);if(r.list.b!=null)return t4(this.node.rawAttrs,t,n);if(r.list.type!=null)return YL(this.node.rawAttrs,t,n)}return n},e}(),$9e=function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[un(B("a",e,t,n),B("b",e,t,n))];case"AddN":return[e$(B("tensors",e,t,n))];case"FloorMod":case"Mod":return[IP(B("a",e,t,n),B("b",e,t,n))];case"Mul":return[pt(B("a",e,t,n),B("b",e,t,n))];case"RealDiv":case"Div":return[ei(B("a",e,t,n),B("b",e,t,n))];case"DivNoNan":return[fA(B("a",e,t,n),B("b",e,t,n))];case"FloorDiv":return[GC(B("a",e,t,n),B("b",e,t,n))];case"Sub":return[Qr(B("a",e,t,n),B("b",e,t,n))];case"Minimum":return[h0(B("a",e,t,n),B("b",e,t,n))];case"Maximum":return[lc(B("a",e,t,n),B("b",e,t,n))];case"Pow":return[p0(B("a",e,t,n),B("b",e,t,n))];case"SquaredDifference":return[pA(B("a",e,t,n),B("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},L9e=function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[ih(B("x",e,t,n))];case"Acos":return[cP(B("x",e,t,n))];case"Acosh":return[fP(B("x",e,t,n))];case"Asin":return[dP(B("x",e,t,n))];case"Asinh":return[hP(B("x",e,t,n))];case"Atan":return[pP(B("x",e,t,n))];case"Atan2":return[OP(B("x",e,t,n),B("y",e,t,n))];case"Atanh":return[gP(B("x",e,t,n))];case"Ceil":return[mP(B("x",e,t,n))];case"Complex":return[$i(B("real",e,t,n),B("imag",e,t,n))];case"Cos":return[vP(B("x",e,t,n))];case"Cosh":return[yP(B("x",e,t,n))];case"Elu":return[C0(B("x",e,t,n))];case"Erf":return[bP(B("x",e,t,n))];case"Exp":return[xP(B("x",e,t,n))];case"Expm1":return[wP(B("x",e,t,n))];case"Floor":return[WC(B("x",e,t,n))];case"Log":return[Df(B("x",e,t,n))];case"Log1p":return[_P(B("x",e,t,n))];case"Imag":return[uu(B("x",e,t,n))];case"Neg":return[ah(B("x",e,t,n))];case"Reciprocal":return[SP(B("x",e,t,n))];case"Real":return[qo(B("x",e,t,n))];case"Relu":return[lh(B("x",e,t,n))];case"Round":return[EP(B("x",e,t,n))];case"Selu":return[TA(B("x",e,t,n))];case"Sigmoid":return[qC(B("x",e,t,n))];case"Sin":return[AP(B("x",e,t,n))];case"Sign":return[CP(B("x",e,t,n))];case"Sinh":return[kP(B("x",e,t,n))];case"Softplus":return[fx(B("x",e,t,n))];case"Sqrt":return[dx(B("x",e,t,n))];case"Square":return[hA(B("x",e,t,n))];case"Tanh":return[HC(B("x",e,t,n))];case"Tan":return[TP(B("x",e,t,n))];case"Relu6":case"ClipByValue":return[uo(B("x",e,t,n),B("clipValueMin",e,t,n),B("clipValueMax",e,t,n))];case"Rsqrt":return[VC(ho(e.inputNames[0],t,n))];case"Prod":return[AA(B("x",e,t,n),B("axes",e,t,n))];case"LeakyRelu":return[kA(B("x",e,t,n),B("alpha",e,t,n))];case"Prelu":return[Tx(B("x",e,t,n),B("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},B9e=function(){function e(t,n,r,i,a,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var n=this.tensors[t];if(n.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor},e.prototype.readMany=function(t){var n=this;return t.map(function(r){return n.read(r)})},e.prototype.write=function(t,n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+n.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=n.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,n.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");r.tensor=n,r.written=!0,this.tensors[t]=r},e.prototype.writeMany=function(t,n){var r=this;if(t.length!==n.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+n.length+".");t.forEach(function(i,a){return r.write(i,n[a])})},e.prototype.gather=function(t,n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+n);if(!t){t=[];for(var r=0;r<this.size();r++)t.push(r)}if(t.length===0)return fi([],[0].concat(this.elementShape));var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),lu(i,0)},e.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return fi([],[0].concat(this.elementShape));for(var n=[],r=0;r<this.size();r++)n.push(r);var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),Ra(i,0)},e.prototype.scatter=function(t,n){if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);if(t.length!==n.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+n.shape[0]);var r=Math.max.apply(Math,t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(t,rh(n,0))},e.prototype.split=function(t,n){var r=this;if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);var i=0,a=t.map(function(c){return i+=c});if(i!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+n.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=i===0?0:n.size/i,s=[];ge(function(){n=n.reshape([1,i,o]);for(var c=0;c<t.length;++c){var f=[0,c===0?0:a[c-1],0],d=[1,t[c],o];s[c]=Is(n,f,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},e.prototype.assertShapesMatchAllowUndefinedSize=function(t,n,r){r===void 0&&(r=""),Ct.assert(this.shapesEqualAllowUndefinedSize(t,n),function(){return r+" Shapes "+t+" and "+n+" must match"})},e.prototype.shapesEqualAllowUndefinedSize=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==-1&&n[r]!==-1&&t[r]!==n[r])return!1;return!0},e.nextId=0,e}(),z9e=void 0,j9e=function(e,t,n){return Fg(z9e,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,P,V,Y,X,Q;return Mg(this,function(me){switch(me.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[B("pred",e,t,n).clone()]];case 2:return r=B("pred",e,t,n),i=B("data",e,t,n),[4,r.data()];case 3:return[2,me.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=e.inputNames.find(function(ce){return ho(ce,t,n)!==void 0}))?[ho(a,t,n).clone()]:void 0];case 5:return o=B("frameName",e,t,n),s=B("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=B("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=B("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=B("size",e,t,n),f=B("dtype",e,t,n),d=B("elementShape",e,t,n),h=B("dynamicSize",e,t,n),p=B("clearAfterRead",e,t,n),g=B("identicalElementShapes",e,t,n),m=B("name",e,t,n),v=new B9e(m,f,c,d,g,h,p),n.addTensorArray(v),[2,[rt(v.id),rt(1)]];case 9:return y=B("tensorArrayId",e,t,n),b=B("index",e,t,n),x=B("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[rt(1)]];case 10:return w=B("tensorArrayId",e,t,n),S=B("index",e,t,n),[2,[n.getTensorArray(w).read(S)]];case 11:return C=B("tensorArrayId",e,t,n),_=B("indices",e,t,n),E=B("dtype",e,t,n),[2,[n.getTensorArray(C).gather(_,E)]];case 12:return A=B("tensorArrayId",e,t,n),k=B("indices",e,t,n),T=B("tensor",e,t,n),n.getTensorArray(A).scatter(k,T),[2,[rt(1)]];case 13:return I=B("tensorArrayId",e,t,n),N=n.getTensorArray(I),O=B("dtype",e,t,n),[2,[N.concat(O)]];case 14:return D=B("tensorArrayId",e,t,n),P=B("tensor",e,t,n),V=B("lengths",e,t,n),n.getTensorArray(D).split(V,P),[2,[rt(1)]];case 15:return Y=B("tensorArrayId",e,t,n),X=n.getTensorArray(Y),[2,[rt(X.size(),"int32")]];case 16:return Q=B("tensorArrayId",e,t,n),n.getTensorArray(Q).clearAndClose(),[2,[rt(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}})})},U9e=function(e,t,n){switch(e.op){case"Conv1D":var r=B("stride",e,t,n),i=B("pad",e,t,n),a=B("dataFormat",e,t,n).toUpperCase(),o=B("dilation",e,t,n);return[gA(B("x",e,t,n),B("filter",e,t,n),r,i,a,o)];case"Conv2D":r=B("strides",e,t,n),i=B("pad",e,t,n),a=B("dataFormat",e,t,n).toUpperCase();var s=B("dilations",e,t,n);return[Sg(B("x",e,t,n),B("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=B("fusedOps",e,t,n),l=u[0],c=u[1],f=l==="biasadd",d=c==="prelu",h=l==="fusedbatchnorm",p=B("numArgs",e,t,n);if(f){if(d&&p!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&p!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=B("strides",e,t,n),i=B("pad",e,t,n),a=B("dataFormat",e,t,n).toUpperCase(),s=B("dilations",e,t,n);var g=B("args",e,t,n),m=g[0],v=g[1];return[(e.op==="_FusedConv2D"?fh.conv2d:fh.depthwiseConv2d)({x:B("x",e,t,n),filter:B("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:m,activation:c,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=B("outputShape",e,t,n);return r=B("strides",e,t,n),i=B("pad",e,t,n),[vA(B("x",e,t,n),B("filter",e,t,n),y,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=B("strides",e,t,n),i=B("pad",e,t,n),s=B("dilations",e,t,n),a=B("dataFormat",e,t,n).toUpperCase(),[S0(B("input",e,t,n),B("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=B("strides",e,t,n),i=B("pad",e,t,n),a=B("dataFormat",e,t,n).toUpperCase(),s=B("dilations",e,t,n),[mA(B("x",e,t,n),B("filter",e,t,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=B("strides",e,t,n),i=B("pad",e,t,n);var b=B("kernelSize",e,t,n);return[xA(B("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=B("strides",e,t,n),i=B("pad",e,t,n),b=B("kernelSize",e,t,n),[bA(B("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=B("strides",e,t,n),i=B("pad",e,t,n),b=B("kernelSize",e,t,n);var x=B("includeBatchInIndex",e,t,n),w=y$(B("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i,x);return[w.result,w.indexes];case"AvgPool3D":return r=B("strides",e,t,n),i=B("pad",e,t,n),b=B("kernelSize",e,t,n),[_A(B("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=B("strides",e,t,n),i=B("pad",e,t,n),b=B("kernelSize",e,t,n),[wA(B("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},W9e=function(e,t,n){switch(e.op){case"Fill":var r=B("shape",e,t,n),i=B("dtype",e,t,n),a=B("value",e,t,n);return[f0(r,a,i)];case"LinSpace":var o=B("start",e,t,n),s=B("stop",e,t,n),u=B("num",e,t,n);return[ZM(o,s,u)];case"Multinomial":var l=B("logits",e,t,n),c=B("numSamples",e,t,n),f=B("seed",e,t,n);return[o$(l,c,f)];case"OneHot":var d=B("indices",e,t,n),h=B("depth",e,t,n),p=B("onValue",e,t,n),g=B("offValue",e,t,n);return[xg(d,h,p,g)];case"Ones":return[uc(B("shape",e,t,n),B("dtype",e,t,n))];case"OnesLike":return[Ts(B("x",e,t,n))];case"RandomUniform":return[wg(B("shape",e,t,n),B("minval",e,t,n),B("maxval",e,t,n),B("dtype",e,t,n))];case"Range":o=B("start",e,t,n);var m=B("stop",e,t,n),v=B("step",e,t,n);return[d0(o,m,v,B("dtype",e,t,n))];case"TruncatedNormal":r=B("shape",e,t,n);var y=B("mean",e,t,n),b=B("stdDev",e,t,n);return f=B("seed",e,t,n),[wx(r,y,b,B("dtype",e,t,n),f)];case"Zeros":return[Kn(B("shape",e,t,n),B("dtype",e,t,n))];case"ZerosLike":return[wn(B("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},V9e=void 0,q9e=function(e,t,n){return Fg(V9e,void 0,void 0,function(){var r,i,a,o,s,u,l,c;return Mg(this,function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=B("boxes",e,t,n),i=B("scores",e,t,n),a=B("maxOutputSize",e,t,n),o=B("iouThreshold",e,t,n),s=B("scoreThreshold",e,t,n),e.op!=="NonMaxSuppressionV5"?[3,3]:(u=B("softNmsSigma",e,t,n),[4,ch.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u)]);case 2:return[2,[(c=f.sent()).selectedIndices,c.selectedScores]];case 3:return[4,ch.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[f.sent()]];case 5:return l=B("condition",e,t,n).asType("bool"),[4,cA(l)];case 6:return c=[f.sent()],l.dispose(),[2,c];case 7:return[2,rP(B("x",e,t,n),B("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}})})},H9e=function(e,t,n){switch(e.op){case"TopKV2":var r=B("x",e,t,n),i=B("k",e,t,n),a=B("sorted",e,t,n),o=E$(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},G9e=function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=B("default",e,t,n);return[ho(e.name,t,n)||r];case"Placeholder":return[ho(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[B("x",e,t,n).clone()];case"IdentityN":return B("x",e,t,n).map(function(l){return l.clone()});case"Snapshot":return[B("x",e,t,n).clone()];case"Shape":return[so(B("x",e,t,n).shape,"int32")];case"ShapeN":return B("x",e,t,n).map(function(l){return so(l.shape)});case"Size":return[rt(B("x",e,t,n).size,"int32")];case"Rank":return[rt(B("x",e,t,n).rank,"int32")];case"NoOp":return[rt(1)];case"Print":var i=B("x",e,t,n),a=B("data",e,t,n),o=B("message",e,t,n),s=B("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+e.op+" is not implemented")}},K9e=function(e,t,n){switch(e.op){case"ResizeBilinear":var r=B("images",e,t,n),i=B("size",e,t,n),a=B("alignCorners",e,t,n);return[ch.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=B("images",e,t,n),i=B("size",e,t,n),a=B("alignCorners",e,t,n),[ch.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=B("image",e,t,n),s=B("boxes",e,t,n),u=B("boxInd",e,t,n),l=B("cropSize",e,t,n),c=B("method",e,t,n),f=B("extrapolationValue",e,t,n);return[ch.cropAndResize(o,s,u,l,c,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},X9e=function(e,t,n){switch(e.op){case"Equal":return[_g(B("a",e,t,n),B("b",e,t,n))];case"NotEqual":return[w0(B("a",e,t,n),B("b",e,t,n))];case"Greater":return[x0(B("a",e,t,n),B("b",e,t,n))];case"GreaterEqual":return[_x(B("a",e,t,n),B("b",e,t,n))];case"Less":return[d$(B("a",e,t,n),B("b",e,t,n))];case"LessEqual":return[h$(B("a",e,t,n),B("b",e,t,n))];case"LogicalAnd":return[fc(B("a",e,t,n),B("b",e,t,n))];case"LogicalNot":return[a$(B("a",e,t,n))];case"LogicalOr":return[lA(B("a",e,t,n),B("b",e,t,n))];case"Select":case"SelectV2":return[nl(B("condition",e,t,n),B("a",e,t,n),B("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},Y9e=function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[yA(B("a",e,t,n),B("b",e,t,n),B("transposeA",e,t,n),B("transposeB",e,t,n))];case"Transpose":return[In(B("x",e,t,n),B("perm",e,t,n))];case"_FusedMatMul":var r=B("fusedOps",e,t,n),i=r[0],a=r[1],o=i==="biasadd",s=a==="prelu",u=B("numArgs",e,t,n);if(o){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=B("args",e,t,n),c=l[0],f=l[1];return[fh.matMul({a:B("a",e,t,n),b:B("b",e,t,n),transposeA:B("transposeA",e,t,n),transposeB:B("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}},Z9e=function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[bg(B("x",e,t,n),B("mean",e,t,n),B("variance",e,t,n),B("offset",e,t,n),B("scale",e,t,n),B("epsilon",e,t,n))];case"LRN":return[w$(B("x",e,t,n),B("radius",e,t,n),B("bias",e,t,n),B("alpha",e,t,n),B("beta",e,t,n))];case"Softmax":return[hg(B("x",e,t,n))];case"LogSoftmax":return[JC(B("x",e,t,n))];case"SparseToDense":return[IA(B("sparseIndices",e,t,n),B("outputShape",e,t,n),B("sparseValues",e,t,n),B("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},J9e=function(e,t,n){switch(e.op){case"Max":var r=B("axis",e,t,n),i=B("keepDims",e,t,n);return[uh(B("x",e,t,n),r,i)];case"Mean":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[di(B("x",e,t,n),r,i)];case"Min":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[CA(B("x",e,t,n),r,i)];case"Sum":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[Ei(B("x",e,t,n),r,i)];case"All":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[EA(B("x",e,t,n),r,i)];case"Any":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[Cx(B("x",e,t,n),r,i)];case"ArgMax":return r=B("axis",e,t,n),[Ax(B("x",e,t,n),r)];case"ArgMin":return r=B("axis",e,t,n),[b$(B("x",e,t,n),r)];case"Prod":return r=B("axis",e,t,n),i=B("keepDims",e,t,n),[AA(B("x",e,t,n),r,i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},Q9e=function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=B("n",e,t,n),i=B("axis",e,t,n),a=B("tensors",e,t,n);return a=a.slice(0,r),[Ra(a,i)];case"GatherV2":case"Gather":i=B("axis",e,t,n);var o=B("x",e,t,n),s=B("indices",e,t,n);return[_0(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=B("axis",e,t,n),o=B("x",e,t,n),[hc(o,i)];case"Slice":var u=B("begin",e,t,n),l=B("size",e,t,n);return[Is(B("x",e,t,n),u,l)];case"StridedSlice":u=B("begin",e,t,n);var c=B("end",e,t,n),f=B("strides",e,t,n),d=B("beginMask",e,t,n),h=B("endMask",e,t,n),p=B("ellipsisMask",e,t,n),g=B("newAxisMask",e,t,n),m=B("shrinkAxisMask",e,t,n),v=B("x",e,t,n);if(u.length===1&&v.shape.length>1)for(var y=1;y<v.shape.length;y++)u.push(0),c.push(v.shape[y]),f.push(f[0]);return[S$(v,u,c,f,d,h,p,g,m)];case"Pack":return ge(function(){var A=B("axis",e,t,n),k=B("tensors",e,t,n),T=k[0].shape,I=k[0].squeeze().shape,N=k.map(function(O){var D=Ct.arraysEqual(O.shape,T);if(!D&&!Ct.arraysEqual(O.squeeze().shape,I))throw new Error("the input tensors shape does not match");return D?O:O.reshape(T)});return[lu(N,A)]});case"Unpack":return ge(function(){var A=B("axis",e,t,n),k=B("tensor",e,t,n);return rh(k,A)});case"Tile":var b=B("reps",e,t,n);return[Rf(B("x",e,t,n),b)];case"Split":case"SplitV":i=B("axis",e,t,n);var x=B("numOrSizeSplits",e,t,n);return If(B("x",e,t,n),x,i);case"ScatterNd":s=B("indices",e,t,n);var w=B("values",e,t,n),S=B("shape",e,t,n);return[C$(s,w,S)];case"GatherNd":var C=B("x",e,t,n);return s=B("indices",e,t,n),[A$(C,s)];case"SparseToDense":s=B("sparseIndices",e,t,n),S=B("outputShape",e,t,n);var _=B("sparseValues",e,t,n),E=B("defaultValue",e,t,n);return[IA(s,_,S,_.dtype===E.dtype?E:E.asType(_.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}},eUe=function(e,t,n){switch(e.op){case"FFT":return[Ox(B("x",e,t,n))];case"IFFT":return[A0(B("x",e,t,n))];case"RFFT":return[Ix(B("x",e,t,n))];case"IRFFT":return[OA(B("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},tUe=function(e,t,n){switch(e.op){case"Cast":return[LC(B("x",e,t,n),B("dtype",e,t,n))];case"ExpandDims":var r=B("axis",e,t,n);return[Os(B("x",e,t,n),r)];case"Squeeze":return r=B("axis",e,t,n),[ux(B("x",e,t,n),r)];case"Reshape":return[el(B("x",e,t,n),B("shape",e,t,n))];case"PadV2":case"Pad":return[dc(B("x",e,t,n),qL(B("padding",e,t,n),2),B("constantValue",e,t,n))];case"SpaceToBatchND":var i=B("blockShape",e,t,n),a=qL(B("paddings",e,t,n),2);return[BC(B("x",e,t,n),i,a)];case"BatchToSpaceND":i=B("blockShape",e,t,n);var o=qL(B("crops",e,t,n),2);return[$C(B("x",e,t,n),i,o)];case"DepthToSpace":var s=B("blockSize",e,t,n),u=B("dataFormat",e,t,n).toUpperCase();return[nP(B("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function bre(e,t,n){var r=function(i,a,o){switch(i.category){case"arithmetic":return ge(function(){return $9e(i,a,o)});case"basic_math":return ge(function(){return L9e(i,a,o)});case"control":return j9e(i,a,o);case"convolution":return ge(function(){return U9e(i,a,o)});case"creation":return ge(function(){return W9e(i,a,o)});case"dynamic":return q9e(i,a,o);case"evaluation":return ge(function(){return H9e(i,a,o)});case"image":return ge(function(){return K9e(i,a,o)});case"graph":return ge(function(){return G9e(i,a,o)});case"logical":return ge(function(){return X9e(i,a,o)});case"matrices":return ge(function(){return Y9e(i,a,o)});case"normalization":return ge(function(){return Z9e(i,a,o)});case"reduction":return ge(function(){return J9e(i,a,o)});case"slice_join":return ge(function(){return Q9e(i,a,o)});case"spectral":return ge(function(){return eUe(i,a,o)});case"transformation":return ge(function(){return tUe(i,a,o)});case"custom":var s=gre(i.op);if(s&&s.customExecutor)return s.customExecutor(new P9e(i,a,o));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var xre=function(){function e(t,n){this.weightMap=t,this.tensorArrayMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(t,n){return{id:t,frameName:n,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var t=[],n=0;n<this.contexts.length-1;n++){var r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t},e.prototype.contextIdforContexts=function(t){return t?t.map(function(n){return n.id===0&&n.iterationId===0?"":n.frameName+"-"+n.iterationId}).join("/"):""},e.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(t){return this.weightMap[t]},e.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},e.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},e}();function wre(e,t,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(e).map(function(f){return Fs(f)[0]}),l=t.slice();l.length>0;){var c=l.pop();(_re(c)||aUe(c))&&a==null&&(o=(a=c).children.map(function(f){return f.name}).filter(function(f){return r.has(f)})),r.add(c.name),n[c.name]==null&&u.indexOf(c.name)===-1&&(c.inputs.length!==0?c.inputs.forEach(function(f){s.has(f.name)||(s.add(f.name),l.push(f))}):i.push(c.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function nUe(e,t,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map(function(l){return Fs(l)[0]}).map(function(l){return e.nodes[l]}).forEach(function(l){r.has(l.name)&&a.push(l)}),e.weights.forEach(function(l){r.has(l.name)&&a.push(l)});for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach(function(l){!o.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return o.has(c.name)})&&a.push(l)})}return s}var rUe=["Switch","Merge","Enter","Exit","NextIteration"],iUe=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function _re(e){return rUe.indexOf(e.op)>=0}function aUe(e){return iUe.indexOf(e.op)>=0}var oUe=function(){function e(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var n=Object.keys(t).map(function(r){return t[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],n),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(t,n){var r=t.map(function(a){return a.name}).sort(),i=n.map(function(a){return a.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},e.prototype.compile=function(t,n){var r=wre(t,n,this.weightMap),i=r.missingInputs,a=r.dynamicNode,o=r.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+o+"]");if(i.length>0){var s=n.map(function(l){return l.name}),u=Object.keys(t);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return nUe(this.graph,this.weightMap,r)},e.prototype.execute=function(t,n){var r=this;t=this.mapInputs(t);var i=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);var a=i.map(function(c){return r.graph.nodes[Fs(c)[0]]}),o=n.map(function(c){return r.graph.nodes[Fs(c)[0]]}),s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);u==null&&(u=this.compile(t,o),this.compiledMap.set(s,u));var l={};return ge(function(){var c=new xre(r._weightMap,l),f=VL({},r.weightMap);Object.keys(t).forEach(function(v){var y=Fs(v),b=y[0],x=[];x[y[1]]=t[v],f[b]=x});for(var d=r.getFrozenTensorIds(f),h={},p=0;p<u.length;p++){var g=u[p];if(!f[g.name]){var m=bre(g,f,c);if(m instanceof Promise)throw new Error("The execution of the op '"+g.op+"' returned a promise. Please use model.executeAsync() instead.");f[g.name]=m,r.checkTensorForDisposal(g.name,g,f,c,d,n,h)}}return n.map(function(v){return ho(v,f,c)})})},e.prototype.getFrozenTensorIds=function(t){var n=[].concat.apply([],Object.keys(t).map(function(r){return t[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(n)},e.prototype.checkTensorForDisposal=function(t,n,r,i,a,o,s){n.category!=="control"&&o.indexOf(t)===-1&&(r[t].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+n.children.length)}),n.inputs.forEach(function(u){if(u.category!=="control"){var l=t9e(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!a.has(c.id)){var f=s[c.id];f===1?(c.dispose(),delete s[c.id]):f!=null&&s[c.id]--}})}}))},e.prototype.executeAsync=function(t,n){return Fg(this,void 0,void 0,function(){var r,i,a,o,s,u,l=this;return Mg(this,function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),r={},i=new xre(this._weightMap,r),[4,this.executeWithControlFlow(t,i,n)];case 1:return a=c.sent(),o=n.map(function(f){return ho(f,a,i)}),s=new Set(o.map(function(f){return f.id})),u=new Set(Object.keys(t).map(function(f){return t[f].id})),Object.keys(a).forEach(function(f){a[f].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,o]}})})},e.prototype.executeWithControlFlow=function(t,n,r){return Fg(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x=this;return Mg(this,function(w){switch(w.label){case 0:i=Object.keys(t),a=i.map(function(S){return x.graph.nodes[Fs(S)[0]]}),o=r.map(function(S){return x.graph.nodes[Fs(S)[0]]}),s=wre(t,o,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,f=s.syncInputs,d=a.concat(this.graph.weights).map(function(S){return{node:S,contexts:n.currentContext}}),h=VL({},this.weightMap),Object.keys(t).forEach(function(S){var C=Fs(S),_=C[0],E=[];E[C[1]]=t[S],h[_]=E}),p={},g=this.getFrozenTensorIds(h),m={},w.label=1;case 1:return d.length>0?(v=this.processStack(a,d,n,h,m,g,r,p,u),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(S){return!_re(S)&&!ho(S.name,h,n)}).map(function(S){return S.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+f+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,h]}})})},e.prototype.processStack=function(t,n,r,i,a,o,s,u,l){for(var c=this,f=[],d=function(){var p=n.pop();r.currentContext=p.contexts;var g="";if(p.node.op==="Enter"&&B("isConstant",p.node,i,r)&&(g=U0(p.node.name,r)[0]),t.indexOf(p.node)===-1){var m=bre(p.node,i,r);g||(g=U0(p.node.name,r)[0]);var v=r.currentContext;m instanceof Promise?f.push(m.then(function(y){return i[g]=y,r.currentContext=v,c.checkTensorForDisposal(g,p.node,i,r,o,s,u),c.processChildNodes(p.node,n,r,i,a,l),y})):(i[g]=m,h.checkTensorForDisposal(g,p.node,i,r,o,s,u),h.processChildNodes(p.node,n,r,i,a,l))}else h.processChildNodes(p.node,n,r,i,a,l)},h=this;n.length>0;)d();return f},e.prototype.processChildNodes=function(t,n,r,i,a,o){t.children.forEach(function(s){var u=U0(s.name,r)[0];!a[u]&&o.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!ho(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!ho(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})))})},e.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(n){return t.weightMap[n].forEach(function(r){return r.dispose()})})},e.prototype.checkInputShapeAndType=function(t){var n=this;Object.keys(t).forEach(function(r){var i=t[r],a=Fs(r)[0],o=n.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===i.shape.length&&i.shape.every(function(l,c){return s[c]===-1||s[c]===l});Ct.assert(u,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&Ct.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},e.prototype.mapInputs=function(t){var n={};for(var r in t)this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null?n[this._signature.inputs[r].name]=t[r]:n[r]=t[r];return n},e.prototype.checkInputs=function(t){var n=this,r=Object.keys(t).filter(function(i){var a=Fs(i)[0];return n.graph.nodes[a]==null});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},e.prototype.mapOutputs=function(t){var n=this;return t.map(function(r){return n._signature!=null&&n._signature.outputs!=null&&n._signature.outputs[r]!=null?n._signature.outputs[r].name:r},{})},e.prototype.checkOutputs=function(t){var n=this;t.forEach(function(r){var i=Fs(r)[0];if(!n.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},e}();(function(){function e(t,n){n===void 0&&(n={}),this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=lo.browserHTTPRequest(t,this.loadOptions);else{var n=lo.getLoadHandlers(t,this.loadOptions.onProgress);if(n.length===0)n.push(lo.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error("Found more than one ("+n.length+") load handlers for URL '"+[t]+"'");this.handler=n[0]}},e.prototype.load=function(){return Fg(this,void 0,void 0,function(){var t,n,r,i;return Mg(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),n=this.artifacts.modelTopology,r={},this.artifacts.userDefinedMetadata!=null&&(r=this.artifacts.userDefinedMetadata.signature),this.version=n.versions.producer+"."+n.versions.minConsumer,i=lo.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new oUe(F9e.Instance.transformGraph(n,r)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),[2,!0]}})})},e.prototype.save=function(t,n){return Fg(this,void 0,void 0,function(){var r;return Mg(this,function(i){if(typeof t=="string"){if((r=lo.getSaveHandlers(t)).length===0)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new Error("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]})})},e.prototype.predict=function(t,n){return this.execute(t,this.outputNodes)},e.prototype.normalizeInputs=function(t){if(!(t instanceof fn||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(n,r,i){return n[r]=t[i],n},{})},e.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},e.prototype.execute=function(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);var r=this.executor.execute(t,n);return r.length>1?r:r[0]},e.prototype.executeAsync=function(t,n){return Fg(this,void 0,void 0,function(){var r;return Mg(this,function(i){switch(i.label){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),[4,this.executor.executeAsync(t,n)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},e.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=[t[r]],n},{})},e.prototype.dispose=function(){this.executor.dispose()},e})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sre=function(e,t){return(Sre=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Xn(e,t){function n(){this.constructor=e}Sre(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function ot(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function st(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Pg(e,t){return e(t={exports:{}},t.exports),t.exports}var sUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}function a(o,s){var u=new function(f){var d,h=this,p=(d=4022871197,function(g){g=g.toString();for(var m=0;m<g.length;m++){var v=.02519603282416938*(d+=g.charCodeAt(m));v-=d=v>>>0,d=(v*=d)>>>0,d+=4294967296*(v-=d)}return 23283064365386963e-26*(d>>>0)});h.next=function(){var g=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=g-(h.c=0|g)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(f),h.s0<0&&(h.s0+=1),h.s1-=p(f),h.s1<0&&(h.s1+=1),h.s2-=p(f),h.s2<0&&(h.s2+=1),p=null}(o),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),uUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s}function a(o,s){var u=new function(f){var d=this,h="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var g=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^g^g>>>8},f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),lUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s.v=o.v,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^g^g<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),p==h.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),cUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.x=o.x.slice(),s.i=o.i,s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.x,m=d.i;return h=g[m],p=(h^=h>>>7)^h<<24,p^=(h=g[m+1&7])^h>>>10,p^=(h=g[m+3&7])^h>>>3,p^=(h=g[m+4&7])^h<<7,h=g[m+7&7],p^=(h^=h<<13)^h<<9,g[m]=p,d.i=m+1&7,p},function(h,p){var g,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,g=0;g<p.length;++g)m[7&g]=m[7&g]<<15^p.charCodeAt(g)+m[g+1&7]<<13;for(;m.length<8;)m.push(0);for(g=0;g<8&&m[g]===0;++g);for(g==8?m[7]=-1:m[g],h.x=m,h.i=0,g=256;g>0;--g)h.next()}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),fUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.i=o.i,s.w=o.w,s.X=o.X.slice(),s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.w,m=d.X,v=d.i;return d.w=g=g+1640531527|0,p=m[v+34&127],h=m[v=v+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[v]=p^h,d.i=v,p+(g^g>>>16)|0},function(h,p){var g,m,v,y,b,x=[],w=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,w=Math.max(w,p.length)),v=0,y=-32;y<w;++y)p&&(m^=p.charCodeAt((y+32)%p.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,v=(g=x[127&y]^=m+b)==0?v+1:0);for(v>=128&&(x[127&(p&&p.length||0)]=-1),v=127,y=512;y>0;--y)m=x[v+34&127],g=x[v=v+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,x[v]=m^g;h.w=b,h.X=x,h.i=v}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),dUe=Pg(function(e){(function(t,n,r){function i(o,s){return s.a=o.a,s.b=o.b,s.c=o.c,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.b,m=d.c,v=d.d,y=d.a;return g=g<<25^g>>>7^m,m=m-v|0,v=v<<24^v>>>8^y,y=y-g|0,d.b=g=g<<20^g>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^y,d.a=y-g|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,f===Math.floor(f)?(d.a=f/4294967296|0,d.b=0|f):h+=f;for(var p=0;p<h.length+20;p++)d.b^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),$g=Pg(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(m,v,y){var b=[],x=p(function C(_,E){var A,k=[],T=typeof _;if(E&&T=="object")for(A in _)try{k.push(C(_[A],E-1))}catch(I){}return k.length?k:T=="string"?_:_+"\0"}((v=v==1?{entropy:!0}:v||{}).entropy?[m,g(t)]:m??function(){try{var C;return r&&(C=r.randomBytes)?C=C(a):(C=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(C)),g(C)}catch(A){var _=i.navigator,E=_&&_.plugins;return[+new Date,i,E,i.screen,g(t)]}}(),3),b),w=new function(C){var _,E=C.length,A=this,k=0,T=A.i=A.j=0,I=A.S=[];for(E||(C=[E++]);k<a;)I[k]=k++;for(k=0;k<a;k++)I[k]=I[T=f&T+C[k%E]+(_=I[k])],I[T]=_;(A.g=function(N){for(var O,D=0,P=A.i,V=A.j,Y=A.S;N--;)O=Y[P=f&P+1],D=D*a+Y[f&(Y[P]=Y[V=f&V+O])+(Y[V]=O)];return A.i=P,A.j=V,D})(a)}(b),S=function(){for(var C=w.g(o),_=u,E=0;C<l;)C=(C+E)*a,_*=a,E=w.g(1);for(;C>=c;)C/=2,_/=2,E>>>=1;return(C+E)/_};return S.int32=function(){return 0|w.g(4)},S.quick=function(){return w.g(4)/4294967296},S.double=S,p(g(w.S),t),(v.pass||y||function(C,_,E,A){return A&&(A.S&&h(A,w),C.state=function(){return h(w,{})}),E?(n[s]=C,_):C})(S,x,"global"in v?v.global:this==n,v.state)}function h(m,v){return v.i=m.i,v.j=m.j,v.S=m.S.slice(),v}function p(m,v){for(var y,b=m+"",x=0;x<b.length;)v[f&x]=f&(y^=19*v[f&x])+b.charCodeAt(x++);return g(v)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,p(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(m){}}})([],Math)});$g.alea=sUe,$g.xor128=uUe,$g.xorwow=lUe,$g.xorshift7=cUe,$g.xor4096=fUe,$g.tychei=dUe;var hUe=$g,Ere=hUe.alea;function pUe(e,t){return ok(e,t)}function ok(e,t,n,r){if(n===void 0&&(n=new Map),r===void 0&&(r=new Set),e==null)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(sk(e)){var a=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=ok(e[o],t,n,r);a[o]=s}return r.delete(e),a}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,i.value),i.value}function gUe(e,t){return t===void 0&&(t=Are),Cre(e,t)}function Cre(e,t,n){n===void 0&&(n=new Set);var r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(sk(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(u){var l=Cre(e.map(function(c){return c[u]}),t,n);a[u]=l};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function Are(e){return e===null?null:sk(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function mUe(e,t){return ot(this,void 0,void 0,function(){var n,r,i,a,o,s;return st(this,function(u){switch(u.label){case 0:n=new Map,ok(e,t,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=i[r],(o=n.get(a))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(a,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,ok(e,t,n)]}})})}function sk(e){return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof fn))}function vUe(e){return e==null||yUe(e)||Array.isArray(e)||typeof e=="object"&&e instanceof fn||Ct.isTypedArray(e)}function yUe(e){return e===null||typeof e!="object"&&typeof e!="function"}function bUe(e){return pUe(e,xUe)}function xUe(e){return e instanceof fn?{value:e.clone(),recurse:!1}:sk(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var kre=function(){function e(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return e.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},e.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},e.prototype.set=function(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n},e.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return this.length()===0},e.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.push(i)}},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},e.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},e.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r},e}(),wUe=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return Xn(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,n)},t.prototype.unshift=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,n)},t.prototype.expand=function(){for(var n=2*this.capacity,r=new Array(n),i=this.length(),a=0;a<i;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=n,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},t.INITIAL_CAPACITY=32,t}(kre);function _Ue(e){return new CUe(e)}function SUe(e){return new AUe(e)}function EUe(e,t){return new Ore(e,t)}var W0,Li=function(){function e(){}return e.prototype.toArray=function(){return ot(this,void 0,void 0,function(){var t,n;return st(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,this.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,t]}})})},e.prototype.toArrayForTest=function(){return ot(this,void 0,void 0,function(){var t,n,r;return st(this,function(i){switch(i.label){case 0:return t=this.prefetch(100),n=[],[4,t.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(n.push(r.value),[4,t.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,n]}})})},e.prototype.resolveFully=function(){return ot(this,void 0,void 0,function(){var t;return st(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=n.sent(),[3,2];case 4:return[2]}})})},e.prototype.resolveWhile=function(t){return ot(this,void 0,void 0,function(){var n,r;return st(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:n=i.sent(),r=t(n.value),i.label=2;case 2:return n.done||!r?[3,4]:[4,this.next()];case 3:return n=i.sent(),r=t(n.value),[3,2];case 4:return[2]}})})},e.prototype.handleErrors=function(t){return new RUe(this,t)},e.prototype.filter=function(t){return new NUe(this,t)},e.prototype.map=function(t){return new DUe(this,t)},e.prototype.mapAsync=function(t){return new Tre(this,t)},e.prototype.serialMapAsync=function(t){return new Tre(this,t).serial()},e.prototype.flatmap=function(t){return new FUe(this,t)},e.prototype.forEachAsync=function(t){return ot(this,void 0,void 0,function(){return st(this,function(n){return[2,this.map(t).resolveFully()]})})},e.prototype.serialForEach=function(t){return ot(this,void 0,void 0,function(){return st(this,function(n){return[2,this.serialMapAsync(t).resolveWhile(function(r){return r===!0})]})})},e.prototype.rowMajorBatch=function(t,n){return n===void 0&&(n=!0),new IUe(this,t,n)},e.prototype.columnMajorBatch=function(t,n,r){return n===void 0&&(n=!0),r===void 0&&(r=Are),this.rowMajorBatch(t,n).map(function(i){return gUe(i,r)})},e.prototype.concatenate=function(t,n){return new Ore(_Ue([this,t]),n)},e.prototype.take=function(t){return t<0||t==null?this:new OUe(this,t)},e.prototype.skip=function(t){return t<0||t==null?this:new TUe(this,t)},e.prototype.prefetch=function(t){return new Ire(this,t)},e.prototype.shuffle=function(t,n){return new MUe(this,t,n)},e.prototype.serial=function(){return new kUe(this)},e}(),CUe=function(e){function t(n){var r=e.call(this)||this;return r.items=n,r.trav=0,r}return Xn(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(n=this.items[this.trav],this.trav++,[2,{value:bUe(n),done:!1}])})})},t}(Li),AUe=function(e){function t(n){var r=e.call(this)||this;return r.nextFn=n,r}return Xn(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},t}(Li),kUe=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return[2,this.upstream.next()]})})},t}(Li),TUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(n=r.sent()).done?[2,n]:(sn(n.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(Li),OUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(Li),IUe=function(e){function t(n,r,i){i===void 0&&(i=!0);var a=e.call(this)||this;return a.upstream=n,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){var n,r;return st(this,function(i){switch(i.label){case 0:n=[],i.label=1;case 1:return n.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&n.length>0?[2,{value:n,done:!1}]:[2,{value:null,done:!0}]:(n.push(r.value),[3,1]);case 3:return[2,{value:n,done:!1}]}})})},t}(Li),NUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(n=r.sent()).done||this.predicate(n.value)?[2,n]:(sn(n.value),[3,0]);case 2:return[2]}})})},t}(Li),DUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return st(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,{value:null,done:!0}];for(r=rc.getTensorsInContainer(n.value),i=this.transform(n.value),a=rc.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],rc.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(Li),RUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handler(n)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(Li),Tre=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return st(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(n=l.sent()).done?[2,{value:null,done:!0}]:(r=rc.getTensorsInContainer(n.value),[4,this.transform(n.value)]);case 2:for(i=l.sent(),a=rc.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],rc.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(Li),n4=function(e){function t(){var n=e.call(this)||this;return n.outputQueue=new wUe,n.lastRead=Promise.resolve({value:null,done:!1}),n}return Xn(t,e),t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){switch(n.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return n.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(Li),FUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return st(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,!1];for(r=rc.getTensorsInContainer(n.value),i=this.transform(n.value),a=rc.getTensorsInContainer(i),this.outputQueue.pushAll(i),o=0,s=r;o<s.length;o++)u=s[o],rc.isTensorInList(u,a)||u.dispose();return[2,!0]}})})},t}(n4),Ore=function(e){function t(n,r){var i=e.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=n,i}return Xn(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(n){return ot(this,void 0,void 0,function(){var r,i;return st(this,function(a){switch(a.label){case 0:return[4,n];case 1:return a.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=a.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),a.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=a.sent()).done?(this.iterator=null,[2,this.readFromChain(n)]):[2,i]}})})},t}(Li);(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(W0||(W0={})),function(e){function t(n,r){r===void 0&&(r=W0.FAIL);var i=e.call(this)||this;return i.iterators=n,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return Xn(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(n){return ot(this,void 0,void 0,function(){function r(s){return s instanceof Li?{value:s.next().then(function(u){return i++,u.done&&a++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,a,o;return st(this,function(s){switch(s.label){case 0:return[4,n];case 1:return s.sent(),i=0,a=0,[4,mUe(this.iterators,r)];case 2:if(o=s.sent(),i===a)return[2,{value:null,done:!0}];if(a>0)switch(this.mismatchMode){case W0.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case W0.SHORTEST:return[2,{value:null,done:!0}];case W0.LONGEST:}return this.count++,[2,{value:o,done:!1}]}})})},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(Li);var Ire=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.bufferSize=r,i.buffer=new kre(r),i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var n=this.upstream.next();this.buffer.push(n)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(Li),MUe=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.upstream=n,a.windowSize=r,a.upstreamExhausted=!1,a.random=Ere(i||Ct.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return Xn(t,e),t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n=this;return st(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(n){return Math.floor(this.random()*n)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return ot(this,void 0,void 0,function(){var n,r;return st(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(n=this.chooseIndex(),[4,this.buffer.shuffleExcise(n)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},t}(Ire),r4=function(){function e(){this.size=null}return e.prototype.batch=function(t,n){var r=this;n===void 0&&(n=!0);var i=this;return Ct.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),vc(function(){return ot(r,void 0,void 0,function(){return st(this,function(a){switch(a.label){case 0:return[4,i.iterator()];case 1:return[2,a.sent().columnMajorBatch(t,n,PUe)]}})})},this.size===1/0||this.size==null?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t))},e.prototype.concatenate=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){var i,a;return st(this,function(o){switch(o.label){case 0:return[4,r.iterator()];case 1:return a=(i=o.sent()).concatenate,[4,t.iterator()];case 2:return[2,a.apply(i,[o.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},e.prototype.filter=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(a){return ge(function(){return t(a)})})]}})})},this.size===1/0?1/0:null)},e.prototype.forEachAsync=function(t){return ot(this,void 0,void 0,function(){return st(this,function(n){switch(n.label){case 0:return[4,this.iterator()];case 1:return[2,n.sent().forEachAsync(t)]}})})},e.prototype.forEach=function(t){return ot(this,void 0,void 0,function(){return st(this,function(n){return DC("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},e.prototype.map=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(a){return ge(function(){return t(a)})})]}})})},this.size)},e.prototype.mapAsync=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(t)]}})})},this.size)},e.prototype.prefetch=function(t){var n=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(t)]}})})},this.size)},e.prototype.repeat=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){var i=this;return st(this,function(a){return[2,EUe(SUe(function(){return ot(i,void 0,void 0,function(){var o;return st(this,function(s){switch(s.label){case 0:return o={},[4,r.iterator()];case 1:return[2,(o.value=s.sent(),o.done=!1,o)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},e.prototype.skip=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},e.prototype.shuffle=function(t,n,r){var i=this;if(r===void 0&&(r=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,o=Ere(n||Ct.now().toString());return vc(function(){return ot(i,void 0,void 0,function(){var s;return st(this,function(u){switch(u.label){case 0:return s=o.int32(),r&&(s+=o.int32()),[4,a.iterator()];case 1:return[2,u.sent().shuffle(t,s.toString())]}})})},this.size)},e.prototype.take=function(t){var n=this,r=this;return vc(function(){return ot(n,void 0,void 0,function(){return st(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},e.prototype.toArray=function(){return ot(this,void 0,void 0,function(){return st(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},e.prototype.toArrayForTest=function(){return ot(this,void 0,void 0,function(){return st(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},e.MAX_BUFFER_SIZE=1e4,e}();function vc(e,t){return t===void 0&&(t=null),new(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.size=t,i}return Xn(r,n),r.prototype.iterator=function(){return ot(this,void 0,void 0,function(){return st(this,function(i){return[2,e()]})})},r}(r4))}function PUe(e){return e===null?null:vUe(e[0])?{value:$Ue(e),recurse:!1}:{value:null,recurse:!0}}function $Ue(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof fn?lu(e):fi(e)}var LUe=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r}return Xn(t,e),t.prototype.iterator=function(){return ot(this,void 0,void 0,function(){var n,r;return st(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return n=i.sent(),r=n.decodeUTF8(),[2,r.split(`
`).map(function(a){return a.endsWith("\r")&&(a=a.slice(0,-1)),a})]}})})},t}(r4),uk='"',Kx=Symbol("out"),Nre=Symbol("field"),lk=Symbol("quote"),i4=Symbol("quoteafterquote"),Dre=Symbol("quoteinquote");(function(e){function t(n,r){var i=e.call(this)||this;return i.input=n,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new LUe(n),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(Ct.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return Xn(t,e),t.prototype.columnNames=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o,s,u=this;return st(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(n=l.sent(),!this.fullColumnNames&&!n)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&n&&Ct.assert(n.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+n.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=n),r=this.fullColumnNames.reduce(function(c,f){return c[f]=c[f]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),Ct.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(a=0,o=Object.keys(this.columnConfigs);a<o.length;a++)if(s=o[a],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return ot(this,void 0,void 0,function(){var n,r;return st(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((n=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=n.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return ot(this,void 0,void 0,function(){var n,r=this;return st(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return n=i.sent(),this.hasHeader&&(n=n.skip(1)),[2,n.map(function(a){return r.makeDataElement(a)})]}})})},t.prototype.makeDataElement=function(n){for(var r=this.parseRow(n),i={},a={},o=0;o<this.fullColumnNames.length;o++){var s=this.fullColumnNames[o],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[o],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+n);c=void 0}else{var f=Number(l);if(isNaN(f))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}else c=f}u&&u.isLabel?a[s]=c:i[s]=c}}return Object.keys(a).length===0?i:{xs:i,ys:a}},t.prototype.getBoolean=function(n){return n==="1"||n.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(n,r){r===void 0&&(r=!0);for(var i=[],a=0,o=n.length,s=Kx,u=0;u<o;u++)switch(s){case Kx:switch(n.charAt(u)){case uk:a=u+1,s=lk;break;case this.delimiter:if(a=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=Kx;break;default:s=Nre,a=u}break;case Nre:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u)),s=Kx,a=u+1}break;case lk:switch(n.charAt(u)){case uk:s=i4}break;case i4:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u-1)),s=Kx,a=u+1;break;case uk:s=lk;break;default:s=Dre}break;case Dre:switch(n.charAt(u)){case uk:s=lk}}if(s===i4?i.push(n.substring(a,o-1)):i.push(n.substring(a)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},t})(r4),function(e){function t(n){var r=e.call(this)||this;r.microphoneConfig=n,r.isClosed=!1,r.fftSize=n.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=n.numFramesPerSpectrogram||43,r.sampleRateHz=n.sampleRateHz,r.columnTruncateLength=n.columnTruncateLength||r.fftSize,r.audioTrackConstraints=n.audioTrackConstraints,r.smoothingTimeConstant=n.smoothingTimeConstant||0,r.includeSpectrogram=n.includeSpectrogram!==!1,r.includeWaveform=n.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return Xn(t,e),t.prototype.summary=function(){return"microphone"},t.create=function(n){return n===void 0&&(n={}),ot(this,void 0,void 0,function(){var r;return st(this,function(i){switch(i.label){case 0:if(we().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new t(n)).start()];case 1:return i.sent(),[2,r]}})})},t.prototype.start=function(){return ot(this,void 0,void 0,function(){var n,r,i,a;return st(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return n.stream=o.sent(),[3,3];case 2:throw r=o.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return a=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,a.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o;return st(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(a=this.flattenQueue(i.freqDataQueue),n=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(o=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:n,waveform:r},done:!1}]}})})},t.prototype.capture=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.getAudioData=function(){return ot(this,void 0,void 0,function(){var n,r,i,a=this;return st(this,function(o){return n=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){a.includeSpectrogram&&(a.analyser.getFloatFrequencyData(a.freqData),a.freqData[0]===-1/0&&s({freqDataQueue:n,timeDataQueue:r}),n.push(a.freqData.slice(0,a.columnTruncateLength))),a.includeWaveform&&(a.analyser.getFloatTimeDomainData(a.timeData),r.push(a.timeData.slice())),++i===a.numFrames&&(clearInterval(u),s({freqDataQueue:n,timeDataQueue:r}))},a.fftSize/a.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(n){var r=n[0].length,i=new Float32Array(n.length*r);return n.forEach(function(a,o){return i.set(a,o*r)}),i},t.prototype.getTensorFromAudioDataArray=function(n,r){var i=new Float32Array(Ct.sizeFromShape(r));return i.set(n,i.length-n.length),fi(i,r)},t}(Li),function(e){function t(n,r){var i=e.call(this)||this;if(i.webcamVideoElement=n,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=so([0],"int32"),i.webcamConfig.centerCrop){var a=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,o=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,l=s+a,c=o+u;i.cropBox=sc([u,s,c,l],[1,4])}else i.cropBox=sc([0,0,1,1],[1,4]);return i}return Xn(t,e),t.prototype.summary=function(){return"webcam"},t.create=function(n,r){return r===void 0&&(r={}),ot(this,void 0,void 0,function(){var i;return st(this,function(a){switch(a.label){case 0:if(we().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!n){if(n=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");n.width=r.resizeWidth,n.height=r.resizeHeight}return[4,(i=new t(n,r)).start()];case 1:return a.sent(),[2,i]}})})},t.prototype.start=function(){return ot(this,void 0,void 0,function(){var n,r,i=this;return st(this,function(a){switch(a.label){case 0:this.webcamConfig.facingMode&&Ct.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),a.label=1;case 1:return a.trys.push([1,3,,4]),n=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return n.stream=a.sent(),[3,4];case 3:throw(r=a.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(o){console.log(o),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(o){i.webcamVideoElement.onloadedmetadata=function(){o()}})]}})})},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{n=Vee.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:n,done:!1}];try{return[2,{value:this.cropAndResizeFrame(n),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{n.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(n){var r=this;return ge(function(){var i,a=n.toFloat().expandDims(0),o=(i=ch.cropAndResize(a,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(o.slice(1))})},t.prototype.capture=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(n){return n.stop()});try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(Li);var Rre=function(){return function(){}}(),Fre=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Xn(t,e),t.prototype.split=function(n){return new BUe(this,n)},t}(Li),BUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.impl=new zUe(n,r),i}return Xn(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return[2,this.impl.next()]})})},t}(Fre),zUe=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.separator=r,i.carryover="",i}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return ot(this,void 0,void 0,function(){var n,r,i,a,o;return st(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((n=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=n.value.split(this.separator))[0]=this.carryover+r[0],i=0,a=r.slice(0,-1);i<a.length;i++)o=a[i],this.outputQueue.push(o);return this.carryover=r[r.length-1],[2,!0]}})})},t}(n4),jUe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Xn(t,e),t.prototype.decodeUTF8=function(){return new UUe(this)},t}(Li),UUe=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.impl=new WUe(n),r}return Xn(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return[2,this.impl.next()]})})},t}(Fre),WUe=function(e){function t(n){var r=e.call(this)||this;if(r.upstream=n,we().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return Xn(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return ot(this,void 0,void 0,function(){var n,r,i;return st(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(n=a.sent()).done?[2,!1]:(r=n.value,i=we().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},t}(n4),Mre=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.file=n,i.options=r,Ct.assert(n instanceof Uint8Array||!!we().get("IS_BROWSER")&&(n instanceof File||n instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return Xn(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return ot(this,void 0,void 0,function(){var n,r,i=this;return st(this,function(a){switch(a.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(n=new Promise(function(o,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)o(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(f){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));o(d)},l.onabort=function(f){return s(new Error("Aborted"))},l.onerror=function(f){return s(new Error(f.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,n]);case 1:return[2,(r.value=a.sent(),r.done=!1,r)]}})})},t}(jUe);function VUe(e,t){return t===void 0&&(t={}),ot(this,void 0,void 0,function(){var n,r,i,a,o;return st(this,function(s){switch(s.label){case 0:return typeof e=="string"?n=e:(n=e.url,r=qUe(e)),[4,Ct.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new Mre(a,t)];case 3:throw new Error(i.statusText)}})})}var qUe=function(e){return{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity}};function Pre(e){return typeof e=="string"&&e.substr(0,7)==="file://"}var HUe=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.input=n,i.options=r,i}return Xn(t,e),t.prototype.iterator=function(){return ot(this,void 0,void 0,function(){var n;return st(this,function(r){return Pre(this.input)&&we().get("IS_NODE")&&(n=require("fs"),this.input=n.readFileSync(this.input.substr(7))),[2,new Mre(this.input,this.options)]})})},t}(Rre);(function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.url=n,i.fileOptions=r,i}return Xn(t,e),t.prototype.iterator=function(){return ot(this,void 0,void 0,function(){return st(this,function(n){return Pre(this.url)?[2,new HUe(this.url,this.fileOptions).iterator()]:[2,VUe(this.url,this.fileOptions)]})})},t})(Rre);function GUe(e){let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(f!==t){const d=t;t=c?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a=(l,c=i,f=Object.is)=>{let d=c(t);function h(){const p=c(t);if(!f(d,p)){const g=d;l(d=p,g)}}return n.add(h),()=>n.delete(h)},u={setState:r,getState:i,subscribe:(l,c,f)=>c||f?a(l,c,f):(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,i,u),u}const KUe=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),$re=KUe?an:vf;function XUe(e){const t=typeof e=="function"?GUe(e):e,n=(r=t.getState,i=Object.is)=>{const[,a]=IS(g=>g+1,0),o=t.getState(),s=cn(o),u=cn(r),l=cn(i),c=cn(!1),f=cn();f.current===void 0&&(f.current=r(o));let d,h=!1;(s.current!==o||u.current!==r||l.current!==i||c.current)&&(d=r(o),h=!i(f.current,d)),$re(()=>{h&&(f.current=d),s.current=o,u.current=r,l.current=i,c.current=!1});const p=cn(o);return $re(()=>{const g=()=>{try{const v=t.getState(),y=u.current(v);l.current(f.current,y)||(s.current=v,f.current=y,a())}catch(v){c.current=!0,a()}},m=t.subscribe(g);return t.getState()!==p.current&&g(),m},[]),h?d:f.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var Lre={},Bre=bf(i5e),YUe={},ZUe={},ck={},Ti={},V0={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t="tfjsflags",n=function(){function u(l){this.global=l,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return u.prototype.setPlatform=function(l,c){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+c+".")),this.platformName=l,this.platform=c},u.prototype.registerFlag=function(l,c,f){if(this.flagRegistry[l]={evaluationFn:c,setHook:f},this.urlFlags[l]!=null){var d=this.urlFlags[l];console.warn("Setting feature override from URL "+l+": "+d+"."),this.set(l,d)}},u.prototype.get=function(l){return l in this.flags?this.flags[l]:(this.flags[l]=this.evaluateFlag(l),this.flags[l])},u.prototype.getNumber=function(l){return this.get(l)},u.prototype.getBool=function(l){return this.get(l)},u.prototype.getFlags=function(){return this.flags},Object.defineProperty(u.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),u.prototype.set=function(l,c){if(this.flagRegistry[l]==null)throw new Error("Cannot set flag "+l+" as it has not been registered.");this.flags[l]=c,this.flagRegistry[l].setHook!=null&&this.flagRegistry[l].setHook(c)},u.prototype.evaluateFlag=function(l){if(this.flagRegistry[l]==null)throw new Error("Cannot evaluate flag '"+l+"': no evaluation function found.");return this.flagRegistry[l].evaluationFn()},u.prototype.setFlags=function(l){this.flags=Object.assign({},l)},u.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},u.prototype.populateURLFlags=function(){var l=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var c=r(this.global.location.search);if(t in c){var f=c[t].split(",");f.forEach(function(d){var h=d.split(":"),p=h[0],g=h[1];l.urlFlags[p]=a(p,g)})}}},u}();e.Environment=n;function r(u){var l={};return u.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(c){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];return i(l,f[0],f[1]),f.join("=")}),l}e.getQueryParams=r;function i(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}function a(u,l){if(l=l.toLowerCase(),l==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+u+".")}function o(){return e.ENV}e.env=o,e.ENV=null;function s(u){e.ENV=u}e.setEnvironmentGlobal=s})(V0);var jf={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(jf,"__esModule",{value:!0});var q0=new Map,Xx=new Map;function JUe(e,t){var n=a4(e,t);return q0.get(n)}jf.getKernel=JUe;function QUe(e){return Xx.get(e)}jf.getGradient=QUe;function e7e(e){for(var t=q0.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1],u=o.split("_")[0];u===e&&n.push(s)}return n}jf.getKernelsForBackend=e7e;function t7e(e){var t=e.kernelName,n=e.backendName,r=a4(t,n);if(q0.has(r))throw new Error("The kernel '"+t+"' for backend "+("'"+n+"' is already registered"));q0.set(r,e)}jf.registerKernel=t7e;function n7e(e){var t=e.kernelName;Xx.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Xx.set(t,e)}jf.registerGradient=n7e;function r7e(e,t){var n=a4(e,t);if(!q0.has(n))throw new Error("The kernel '"+e+"' for backend "+("'"+t+"' is not registered"));q0.delete(n)}jf.unregisterKernel=r7e;function i7e(e){if(!Xx.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Xx.delete(e)}jf.unregisterGradient=i7e;function a4(e,t){return t+"_"+e}var Yx={},it={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(it,"__esModule",{value:!0});var fk=V0;function zre(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,t--,n=e[t],e[t]=e[r],e[r]=n}it.shuffle=zre;function a7e(e,t,n){return Math.max(e,Math.min(t,n))}it.clamp=a7e;function o7e(e){return e%2==0?e:e+1}it.nearestLargerEven=o7e;function s7e(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}it.sum=s7e;function u7e(e,t){var n=Math.random();return t*n+(1-n)*e}it.randUniform=u7e;function l7e(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n}it.distSquared=l7e;function H0(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}it.assert=H0;function c7e(e,t,n){n===void 0&&(n=""),H0(jre(e,t),function(){return n+(" Shapes "+e+" and "+t+" must match")})}it.assertShapesMatch=c7e;function f7e(e){H0(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}it.assertNonNull=f7e;function o4(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||qre(e)&&!n)for(var r=0;r<e.length;++r)o4(e[r],t,n);else t.push(e);return t}it.flatten=o4;function d7e(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}it.sizeFromShape=d7e;function h7e(e){return e.length===0}it.isScalarShape=h7e;function jre(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}it.arraysEqual=jre;function Ure(e){return e%1==0}it.isInt=Ure;function p7e(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}it.tanh=p7e;function g7e(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}it.sizeToSquarishShape=g7e;function m7e(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return zre(t),t}it.createShuffledIndices=m7e;function v7e(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}it.rightPad=v7e;function y7e(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e()){r();return}a++;var s=t(a);if(n!=null&&a>=n){i();return}setTimeout(o,s)};o()})}it.repeatedTry=y7e;function b7e(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+r+" and dim "+i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+t+" / "+n));var a=e.slice();return a[r]=t/n,a}it.inferFromImplicitShape=b7e;function Wre(e,t){var n=t.length;return e=e==null?t.map(function(r,i){return i}):[].concat(e),H0(e.every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but "+("got axis "+e)}),H0(e.every(function(r){return Ure(r)}),function(){return"All values in axis param must be integers but "+("got axis "+e)}),e.map(function(r){return r<0?n+r:r})}it.parseAxisParam=Wre;function x7e(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Wre(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}it.squeezeShape=x7e;function w7e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else throw new Error("Unknown data type "+e);return n}it.getTypedArrayFromDType=w7e;function _7e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type "+e);return n}it.getArrayFromDType=_7e;function Vre(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}it.checkConversionForErrors=Vre;function S7e(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}it.isValidDtype=S7e;function E7e(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}it.hasEncodingLoss=E7e;function qre(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}it.isTypedArray=qre;function C7e(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}it.bytesPerElement=C7e;function A7e(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}it.bytesFromStringArray=A7e;function Hre(e){return typeof e=="string"||e instanceof String}it.isString=Hre;function Gre(e){return typeof e=="boolean"}it.isBoolean=Gre;function Kre(e){return typeof e=="number"}it.isNumber=Kre;function Xre(e){return Array.isArray(e)?Xre(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":Kre(e)?"float32":Hre(e)?"string":Gre(e)?"bool":"float32"}it.inferDtype=Xre;function k7e(e){return!!(e&&e.constructor&&e.call&&e.apply)}it.isFunction=k7e;function T7e(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}it.nearestDivisor=T7e;function O7e(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}it.computeStrides=O7e;function I7e(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=o4(e)),n&&Vre(e,t),D7e(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}else throw new Error("Unknown data type "+t)}it.toTypedArray=I7e;function Yre(e,t,n){var r=new Array;if(t.length===1)for(var i=t[0],a=0;a<i;a++)r[a]=n[e+a];else for(var i=t[0],o=t.slice(1),s=o.reduce(function(l,c){return l*c}),a=0;a<i;a++)r[a]=Yre(e+a*s,o,n);return r}function N7e(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return Yre(0,e,t)}it.toNestedArray=N7e;function D7e(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function R7e(e,t){for(var n=Zre(e,t),r=0;r<n.length;r++)n[r]=1;return n}it.makeOnesTypedArray=R7e;function Zre(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}it.makeZerosTypedArray=Zre;function F7e(){return fk.env().platform.now()}it.now=F7e;function M7e(e){e.forEach(function(t){H0(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+e+"].")})})}it.assertNonNegativeIntegerDimensions=M7e;function P7e(e,t){return fk.env().platform.fetch(e,t)}it.fetch=P7e;function $7e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fk.env().platform.encode(e,t)}it.encodeString=$7e;function L7e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",fk.env().platform.decode(e,t)}it.decodeString=L7e;function B7e(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}it.locToIndex=B7e;function z7e(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}it.indexToLoc=z7e;/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Yx,"__esModule",{value:!0});var s4=it,j7e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Qre)}return e.prototype.profileKernel=function(t,n,r){var i=this,a,o=function(){a=r()},s=this.backendTimer.time(o);return a.forEach(function(u){u.data().then(function(l){Jre(l,u.dtype,t),s.then(function(c){var f="";c.getExtraProfileInfo!=null&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,u,l,c.kernelMs,n,f)})})}),a},e}();Yx.Profiler=j7e;function Jre(e,t,n){if(t!=="float32")return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}return!1}Yx.checkComputationForErrors=Jre;var Qre=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?s4.rightPad(i+"ms",9):i.error,u=s4.rightPad(t,25),l=n.rank,c=n.size,f=s4.rightPad(n.shape.toString(),14),d="";for(var h in a){var p=a[h],g=p.shape||n.shape,m=g.length;d+=h+": "+m+"D "+(m>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();Yx.Logger=Qre;var dk={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(dk,"__esModule",{value:!0});var U7e=it;function W7e(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(var a=0;a<e.length;a++){var o=e[a],s=o.inputs;for(var u in s){for(var l=s[u],c=!1,f=0;f<t.length;f++)if(r[l.id]){o.outputs.forEach(function(b){return r[b.id]=!0}),c=!0,i[o.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;for(var h={},a=e.length-1;a>=0;a--)for(var o=e[a],s=o.inputs,f=0;f<o.outputs.length;f++)if(d[o.outputs[f].id]){for(var u in s)d[s[u].id]=!0,h[o.id]=!0;break}for(var p=[],a=0;a<e.length;a++){var o=e[a];if(i[o.id]&&h[o.id]){var g={};for(var u in o.inputs){var m=o.inputs[u];r[m.id]&&(g[u]=m)}var v=Object.assign({},o);v.inputs=g,v.outputs=o.outputs,p.push(v)}}return p}dk.getFilteredNodesXToY=W7e;function V7e(e,t,n){for(var r=function(a){var o=t[a],s=[];if(o.outputs.forEach(function(f){var d=e[f.id];d!=null?s.push(d):s.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+o.kernelName+"."));var u=o.gradient(s),l=function(f){if(!(f in u))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(u)+"."));var d=n(function(){return u[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var h=o.inputs[f];if(!U7e.arraysEqual(d.shape,h.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+h.shape+"'"));if(e[h.id]==null)e[h.id]=d;else{var p=e[h.id];e[h.id]=p.add(d),p.dispose()}};for(var c in o.inputs)l(c)},i=t.length-1;i>=0;i--)r(i)}dk.backpropagateGradients=V7e;var ni={},u4={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(u4,"__esModule",{value:!0});var hk=it,eie=20,Zx=3,l4=7;function q7e(e,t,n,r){var i=hk.computeStrides(t),a=H7e(e,t,n,i),o=t.length,s=pk(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}u4.tensorToString=q7e;function H7e(e,t,n,r){var i=hk.sizeFromShape(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u=n==="complex64"?Qx(e):e;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,f=0;f<a;f++)o[f]=Math.max(o[f],Jx(u[c+f],0,n).length);return o}function Jx(e,t,n){var r;return Array.isArray(e)?r=parseFloat(e[0].toFixed(l4))+" + "+(parseFloat(e[1].toFixed(l4))+"j"):hk.isString(e)?r="'"+e+"'":n==="bool"?r=tie(e):r=parseFloat(e.toFixed(l4)).toString(),hk.rightPad(r,t)}function tie(e){return e===0?"false":"true"}function pk(e,t,n,r,i,a){a===void 0&&(a=!0);var o=n==="complex64"?2:1,s=t[0],u=t.length;if(u===0){if(n==="complex64"){var l=Qx(e);return[Jx(l[0],0,n)]}return n==="bool"?[tie(e[0])]:[e[0].toString()]}if(u===1){if(s>eie){var c=Zx*o,f=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-Zx)*o,s*o));return n==="complex64"&&(f=Qx(f),d=Qx(d)),["["+f.map(function(C,_){return Jx(C,i[_],n)}).join(", ")+", ..., "+d.map(function(C,_){return Jx(C,i[s-Zx+_],n)}).join(", ")+"]"]}var h=n==="complex64"?Qx(e):Array.from(e);return["["+h.map(function(C,_){return Jx(C,i[_],n)}).join(", ")+"]"]}var p=t.slice(1),g=r.slice(1),m=r[0]*o,v=[];if(s>eie){for(var y=0;y<Zx;y++){var b=y*m,x=b+m;v.push.apply(v,pk(e.slice(b,x),p,n,g,i,!1))}v.push("...");for(var y=s-Zx;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,pk(e.slice(b,x),p,n,g,i,y===s-1))}}else for(var y=0;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,pk(e.slice(b,x),p,n,g,i,y===s-1))}var w=u===2?",":"";v[0]="["+v[0]+w;for(var y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;for(var S=`,
`,y=2;y<u;y++)S+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":S),v}function Qx(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var G7e=lt&&lt.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),gk=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},mk=lt&&lt.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(ni,"__esModule",{value:!0});var K7e=u4,Uf=it,vk=it,X7e=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=Uf.sizeFromShape(t),r!=null){var a=r.length;Uf.assert(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+i.size+"'.")})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Uf.getArrayFromDType(n,this.size),this.strides=vk.computeStrides(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),Uf.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must "+("match the rank ("+n.rank+")")});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+". "+("  Buffer shape="+this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return yc().makeTensor(this.values,this.shape,this.dtype)},e}();ni.TensorBuffer=X7e;var yc=null,Ae=null,nie=null;function Y7e(e){yc=e}ni.setTensorTracker=Y7e;function Z7e(e){Ae=e}ni.setOpHandler=Z7e;function J7e(e){nie=e}ni.setDeprecationWarningFn=J7e;var yk=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Uf.sizeFromShape(t),this.strides=vk.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),Uf.assert(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),Ae.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return gk(this,void 0,void 0,function(){var t;return mk(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Ae.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return Ae.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return gk(this,void 0,void 0,function(){var t;return mk(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,vk.toNestedArray(this.shape,t)]}})})},e.prototype.arraySync=function(){return vk.toNestedArray(this.shape,this.dataSync())},e.prototype.data=function(){return gk(this,void 0,void 0,function(){var t,n;return mk(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=yc().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return Uf.decodeString(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=yc().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Uf.decodeString(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return gk(this,void 0,void 0,function(){var t;return mk(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,yc().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(yc().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),Ae.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),Ae.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),Ae.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),Ae.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),Ae.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),Ae.clone(this)},e.prototype.toString=function(t){t===void 0&&(t=!1);var n=this.dataSync();return K7e.tensorToString(n,this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Ae.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),Ae.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),Ae.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),Ae.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),Ae.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),Ae.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),Ae.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),Ae.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),Ae.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),Ae.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),nie("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),Ae.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Ae.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),Ae.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),Ae.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),Ae.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),Ae.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),Ae.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),Ae.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),Ae.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),Ae.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),Ae.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),Ae.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),Ae.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),Ae.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),Ae.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Ae.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),Ae.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Ae.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),Ae.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),Ae.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Ae.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),Ae.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Ae.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),Ae.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),Ae.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),Ae.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),Ae.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),Ae.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Ae.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),Ae.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Ae.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ae.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Ae.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ae.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),Ae.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),Ae.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),Ae.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),Ae.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),Ae.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),Ae.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),Ae.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),Ae.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),Ae.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),Ae.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),Ae.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),Ae.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),Ae.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),Ae.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),Ae.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),Ae.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),Ae.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),Ae.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),Ae.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),Ae.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),Ae.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),Ae.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),Ae.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),Ae.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),Ae.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),Ae.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),Ae.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),Ae.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ae.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),Ae.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),Ae.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),Ae.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),Ae.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),Ae.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),Ae.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),Ae.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),Ae.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),Ae.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),Ae.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),Ae.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),Ae.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),Ae.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),Ae.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),Ae.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),Ae.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),Ae.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),Ae.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Ae.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),Ae.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Ae.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),Ae.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),Ae.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),Ae.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),Ae.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),Ae.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),Ae.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),Ae.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),Ae.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),Ae.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),Ae.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),yc().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),Ae.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),Ae.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Ae.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),Ae.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),Ae.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),Ae.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),Ae.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),Ae.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),Ae.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),Ae.spectral.irfft(this)},e}();ni.Tensor=yk,Object.defineProperty(yk,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var rie=function(e){G7e(t,e);function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!Uf.arraysEqual(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and "+("previous value ("+this.shape+") must match"));yc().disposeTensor(this),this.dataId=n.dataId,yc().incRef(this,null)},t.prototype.dispose=function(){yc().disposeVariable(this),this.isDisposedInternal=!0},t}(yk);ni.Variable=rie,Object.defineProperty(rie,Symbol.hasInstance,{value:function(e){return e instanceof yk&&e.assign!=null&&e.assign instanceof Function}});var du={},iie={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),function(u){u.R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6"}(e.Rank||(e.Rank={}));var t;(function(u){u.float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64"})(t||(t={}));var n;(function(u){u.float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64"})(n||(n={}));var r;(function(u){u.float32="float32",u.int32="float32",u.bool="float32",u.complex64="complex64"})(r||(r={}));var i;(function(u){u.float32="complex64",u.int32="complex64",u.bool="complex64",u.complex64="complex64"})(i||(i={}));var a={float32:r,int32:t,bool:n,complex64:i};function o(u,l){if(u==="string"||l==="string"){if(u==="string"&&l==="string")return"string";throw new Error("Can not upcast "+u+" with "+l)}return a[u][l]}e.upcastType=o;function s(u){return o(u,"int32")}e.sumOutType=s})(iie);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(du,"__esModule",{value:!0});var Q7e=ni,eWe=iie,tWe=it;function nWe(e,t){if(e.dtype===t.dtype)return[e,t];var n=eWe.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}du.makeTypesMatch=nWe;function rWe(e,t){tWe.assert(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and"+(" second("+t.dtype+") input must match")})}du.assertTypesMatch=rWe;function iWe(e,t){return t.some(function(n){return n.id===e.id})}du.isTensorInList=iWe;function aWe(e){var t=[],n=new Set;return aie(e,t,n),t}du.getTensorsInContainer=aWe;function aie(e,t,n){if(e!=null){if(e instanceof Q7e.Tensor){t.push(e);return}if(!!oWe(e)){var r=e;for(var i in r){var a=r[i];n.has(a)||(n.add(a),aie(a,t,n))}}}}function oWe(e){return Array.isArray(e)||typeof e=="object"}(function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=lt&&lt.__awaiter||function(v,y,b,x){return new(b||(b=Promise))(function(w,S){function C(A){try{E(x.next(A))}catch(k){S(k)}}function _(A){try{E(x.throw(A))}catch(k){S(k)}}function E(A){A.done?w(A.value):new b(function(k){k(A.value)}).then(C,_)}E((x=x.apply(v,y||[])).next())})},n=lt&&lt.__generator||function(v,y){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},x,w,S,C;return C={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function _(A){return function(k){return E([A,k])}}function E(A){if(x)throw new TypeError("Generator is already executing.");for(;b;)try{if(x=1,w&&(S=A[0]&2?w.return:A[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,A[1])).done)return S;switch(w=0,S&&(A=[A[0]&2,S.value]),A[0]){case 0:case 1:S=A;break;case 4:return b.label++,{value:A[1],done:!1};case 5:b.label++,w=A[1],A=[0];continue;case 7:A=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(A[0]===6||A[0]===2)){b=0;continue}if(A[0]===3&&(!S||A[1]>S[0]&&A[1]<S[3])){b.label=A[1];break}if(A[0]===6&&b.label<S[1]){b.label=S[1],S=A;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(A);break}S[2]&&b.ops.pop(),b.trys.pop();continue}A=y.call(v,b)}catch(k){A=[6,k],w=0}finally{x=S=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=V0,i=jf,a=Yx,o=dk,s=ni,u=du,l=it,c=it,f=function(){function v(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return v.prototype.dispose=function(){for(var y in this.registeredVariables)this.registeredVariables[y].dispose()},v}(),d=function(){function v(y){this.ENV=y,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new f}return v.prototype.ready=function(){return t(this,void 0,void 0,function(){var y,b,x,w;return n(this,function(S){switch(S.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];y=this.getSortedBackends(),b=0,S.label=1;case 1:return b<y.length?(x=y[b],[4,this.initializeBackend(x).success]):[3,5];case 2:return w=S.sent(),w?[4,this.setBackend(x)]:[3,4];case 3:return S.sent(),[2];case 4:return b++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(v.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var y=this.initializeBackendsAndReturnBest(),b=y.name,x=y.asyncInit;if(x)throw new Error("The highest priority backend '"+b+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(b)}return this.backendInstance},enumerable:!0,configurable:!0}),v.prototype.backendNames=function(){return Object.keys(this.registryFactory)},v.prototype.findBackend=function(y){if(!(y in this.registry))if(y in this.registryFactory){var b=this.initializeBackend(y).asyncInit;if(b)return null}else return null;return this.registry[y]},v.prototype.findBackendFactory=function(y){return y in this.registryFactory?this.registryFactory[y].factory:null},v.prototype.registerBackend=function(y,b,x){return x===void 0&&(x=1),y in this.registryFactory?(console.warn(y+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[y]={factory:b,priority:x},!0)},v.prototype.setBackend=function(y){return t(this,void 0,void 0,function(){var b,x,w,S,C;return n(this,function(_){switch(_.label){case 0:if(this.registryFactory[y]==null)throw new Error("Backend name '"+y+"' not found in registry");return this.backendName=y,this.registry[y]!=null?[3,4]:(this.backendInstance=null,b=this.initializeBackend(y),x=b.success,w=b.asyncInit,w?[4,x]:[3,2]);case 1:return C=_.sent(),[3,3];case 2:C=x,_.label=3;case 3:if(S=C,!S)return[2,!1];_.label=4;case 4:return this.backendInstance=this.registry[y],this.setupRegisteredKernels(),this.profiler=new a.Profiler(this.backendInstance),[2,!0]}})})},v.prototype.setupRegisteredKernels=function(){var y=this,b=i.getKernelsForBackend(this.backendName);b.forEach(function(x){x.setupFunc!=null&&x.setupFunc(y.backendInstance)})},v.prototype.disposeRegisteredKernels=function(y){var b=this,x=i.getKernelsForBackend(y);x.forEach(function(w){w.disposeFunc!=null&&w.disposeFunc(b.registry[y])})},v.prototype.initializeBackend=function(y){var b=this,x=this.registryFactory[y];if(x==null)throw new Error("Cannot initialize backend "+y+", no registration found.");try{var w=x.factory();if(Promise.resolve(w)===w){var S=++this.pendingBackendInitId,C=w.then(function(_){return S<b.pendingBackendInitId?!1:(b.registry[y]=_,b.pendingBackendInit=null,!0)}).catch(function(_){return S<b.pendingBackendInitId||(b.pendingBackendInit=null,console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message)),!1});return this.pendingBackendInit=C,{success:C,asyncInit:!0}}else return this.registry[y]=w,{success:!0,asyncInit:!1}}catch(_){return console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message),{success:!1,asyncInit:!1}}},v.prototype.removeBackend=function(y){if(!(y in this.registryFactory))throw new Error(y+" backend not found in registry");this.backendName===y&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,y in this.registry&&(this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y]),delete this.registryFactory[y],this.backendName===y&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},v.prototype.getSortedBackends=function(){var y=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(b,x){return y.registryFactory[x].priority-y.registryFactory[b].priority})},v.prototype.initializeBackendsAndReturnBest=function(){for(var y=this.getSortedBackends(),b=0;b<y.length;b++){var x=y[b],w=this.initializeBackend(x),S=w.success,C=w.asyncInit;if(C||S)return{name:x,asyncInit:C}}throw new Error("Could not initialize any backends, all backend initializations failed.")},v.prototype.moveData=function(y,b){var x=this.state.tensorInfo.get(b),w=x.backend,S=this.readSync(b);w.disposeData(b),x.backend=y,y.move(b,S,x.shape,x.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},v.prototype.tidy=function(y,b){var x=this,w=null;if(b==null){if(typeof y!="function")throw new Error("Please provide a function to tidy()");b=y}else{if(typeof y!="string"&&!(y instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");w=y}var S;return this.scopedRun(function(){return x.startScope(w)},function(){return x.endScope(S)},function(){return S=b(),S instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),S})},v.prototype.scopedRun=function(y,b,x){y();try{var w=x();return b(),w}catch(S){throw b(),S}},v.prototype.nextTensorId=function(){return v.nextTensorId++},v.prototype.nextVariableId=function(){return v.nextVariableId++},v.prototype.clone=function(y){var b=this.makeTensorFromDataId(y.dataId,y.shape,y.dtype),x={x:y},w=function(C){return{x:function(){return C.toFloat()}}},S=[];return this.addTapeNode(this.state.activeScope.name,x,[b],w,S,{}),b},v.prototype.runKernel=function(y,b,x,w,S){var C=null,_=null;return this.runKernelFunc(C,b,_,y,x,w,S)},v.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},v.prototype.checkKernelForMemLeak=function(y,b,x){var w=this.backend.numDataIds(),S=0;x.forEach(function(E){S+=E.dtype==="complex64"?3:1});var C=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],_=w-b-S-C;if(_>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+_+" data ids) after running '"+y+"'"))},v.prototype.runKernelFunc=function(y,b,x,w,S,C,_){var E=this,A,k=[],T=this.isTapeOn();w==null&&(w=this.state.activeScope!=null?this.state.activeScope.name:"");var I=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var O,D=i.getKernel(w,this.backendName),P;if(D!=null)O=function(){var Y=E.backend.numDataIds();P=D.kernelFunc({inputs:b,attrs:S,backend:E.backend});var X=Array.isArray(P)?P:[P];E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,Y,X);var Q=X.map(function(Ne){var Oe=Ne.dataId,$e=Ne.shape,ve=Ne.dtype;return E.makeTensorFromDataId(Oe,$e,ve)});if(T){var me=E.getTensorsForGradient(w,b,Q);if(me==null){_==null&&(_=[]);var ce=Q.filter(function(Ne,Oe){return _[Oe]});me=(C||[]).slice().concat(ce)}k=E.saveTensorsForBackwardMode(me)}return Q};else{var V=function(Y){!T||(k=Y.map(function(X){return E.keep(E.clone(X))}))};O=function(){var Y=E.backend.numDataIds();P=E.tidy(function(){return y(E.backend,V)});var X=Array.isArray(P)?P:[P];return E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,Y,X),X}}return this.scopedRun(function(){return E.state.kernelDepth++},function(){return E.state.kernelDepth--},function(){E.ENV.getBool("DEBUG")?A=E.profiler.profileKernel(w,b,function(){return O()}):A=O()}),T&&this.addTapeNode(w,b,A,x,k,S),this.state.profiling&&this.state.activeProfile.kernels.push({name:w,bytesAdded:this.state.numBytes-I,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map(function(Y){return b[Y].shape}),outputShapes:A.map(function(Y){return Y.shape})}),Array.isArray(P)?A:A[0]},v.prototype.saveTensorsForBackwardMode=function(y){var b=this,x=y.map(function(w){return b.keep(b.clone(w))});return x},v.prototype.getTensorsForGradient=function(y,b,x){var w=i.getGradient(y);if(w!=null){var S=w.inputsToSave||[],C=w.outputsToSave||[],_=void 0;w.saveAllInputs?(l.assert(Array.isArray(b),function(){return"saveAllInputs is true, expected inputs to be an array."}),_=Object.keys(b).map(function(A){return b[A]})):_=S.map(function(A){return b[A]});var E=x.filter(function(A,k){return C[k]});return _.concat(E)}return null},v.prototype.makeTensor=function(y,b,x,w){if(y==null)throw new Error("Values passed to engine.makeTensor() are null");x=x||"float32",w=w||this.backend;var S=y;x==="string"&&l.isString(y[0])&&(S=y.map(function(k){return l.encodeString(k)}));var C=w.write(S,b,x),_=new s.Tensor(b,x,C,this.nextTensorId());if(this.incRef(_,w),x==="string"){var E=this.state.tensorInfo.get(C),A=c.bytesFromStringArray(S);this.state.numBytes+=A-E.bytes,E.bytes=A}return _},v.prototype.makeTensorFromDataId=function(y,b,x,w){x=x||"float32";var S=new s.Tensor(b,x,y,this.nextTensorId());return this.incRef(S,w),S},v.prototype.makeVariable=function(y,b,x,w){b===void 0&&(b=!0),x=x||this.nextVariableId().toString(),w!=null&&w!==y.dtype&&(y=y.asType(w));var S=new s.Variable(y,b,x,this.nextTensorId());if(this.state.registeredVariables[S.name]!=null)throw new Error("Variable with name "+S.name+" was already registered");return this.state.registeredVariables[S.name]=S,this.incRef(S,this.backend),S},v.prototype.incRef=function(y,b){var x=this.state.tensorInfo.has(y.dataId)?this.state.tensorInfo.get(y.dataId).refCount:0;if(this.state.numTensors++,y.dtype==="string"&&this.state.numStringTensors++,x===0){this.state.numDataBuffers++;var w=0;y.dtype!=="complex64"&&y.dtype!=="string"&&(w=y.size*l.bytesPerElement(y.dtype)),this.state.tensorInfo.set(y.dataId,{backend:b||this.backend,dtype:y.dtype,shape:y.shape,bytes:w,refCount:0}),this.state.numBytes+=w}this.state.tensorInfo.get(y.dataId).refCount++,y instanceof s.Variable||this.track(y)},v.prototype.disposeTensor=function(y){if(!!this.state.tensorInfo.has(y.dataId)){this.state.numTensors--,y.dtype==="string"&&this.state.numStringTensors--;var b=this.state.tensorInfo.get(y.dataId),x=b.refCount;x<=1?(y.dtype!=="complex64"&&(this.state.numBytes-=b.bytes),this.state.numDataBuffers--,b.backend.disposeData(y.dataId),this.state.tensorInfo.delete(y.dataId)):this.state.tensorInfo.get(y.dataId).refCount--}},v.prototype.disposeVariables=function(){for(var y in this.state.registeredVariables){var b=this.state.registeredVariables[y];this.disposeVariable(b)}},v.prototype.disposeVariable=function(y){this.disposeTensor(y),this.state.registeredVariables[y.name]!=null&&delete this.state.registeredVariables[y.name]},v.prototype.memory=function(){var y=this.backend.memory();return y.numTensors=this.state.numTensors,y.numDataBuffers=this.state.numDataBuffers,y.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(y.unreliable=!0,y.reasons==null&&(y.reasons=[]),y.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),y},v.prototype.profile=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){return this.state.profiling=!0,b=this.state.numBytes,x=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=y(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(S){return S.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-x,[2,this.state.activeProfile]})})},v.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},v.prototype.addTapeNode=function(y,b,x,w,S,C){var _=this,E={id:this.state.nextTapeNodeId++,kernelName:y,inputs:b,outputs:x,saved:S},A=i.getGradient(y);A!=null&&(w=A.gradFunc),w!=null&&(E.gradient=function(k){return k=k.map(function(T,I){if(T==null){var N=x[I],O=l.makeZerosTypedArray(N.size,N.dtype);return _.makeTensor(O,N.shape,N.dtype)}return T}),w(k.length>1?k:k[0],S,C)}),this.state.activeTape.push(E)},v.prototype.keep=function(y){return y.kept=!0,y},v.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},v.prototype.endTape=function(){this.state.gradientDepth--},v.prototype.startScope=function(y){var b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};y&&(b.name=y),this.state.scopeStack.push(b),this.state.activeScope=b},v.prototype.endScope=function(y){for(var b=this,x=u.getTensorsInContainer(y),w=new Set(x.map(function(E){return E.id})),S=0;S<this.state.activeScope.track.length;S++){var C=this.state.activeScope.track[S];!C.kept&&!w.has(C.id)&&C.dispose()}var _=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],x.forEach(function(E){!E.kept&&E.scopeId===_.id&&b.track(E)})},v.prototype.gradients=function(y,b,x,w){var S=this;if(w===void 0&&(w=!1),l.assert(b.length>0,function(){return"gradients() received an empty list of xs."}),x!=null&&x.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+x.dtype+"'");var C=this.scopedRun(function(){return S.startTape()},function(){return S.endTape()},function(){return S.tidy("forward",y)});l.assert(C instanceof s.Tensor,function(){return"The result y returned by f() must be a tensor."});var _=o.getFilteredNodesXToY(this.state.activeTape,b,C);if(!w&&_.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var E={};E[C.id]=x??h(C.shape),o.backpropagateGradients(E,_,function(k){return S.tidy(k)});var A=b.map(function(k){return E[k.id]});return S.state.gradientDepth===0&&(S.state.activeTape.forEach(function(k){for(var T=0,I=k.saved;T<I.length;T++){var N=I[T];N.dispose()}}),S.state.activeTape=null),{value:C,grads:A}})},v.prototype.customGrad=function(y){var b=this;return l.assert(l.isFunction(y),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];l.assert(x.every(function(_){return _ instanceof s.Tensor}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var S,C={};return x.forEach(function(_,E){C[E]=_}),b.runKernelFunc(function(_,E){return S=y.apply(void 0,x.concat([E])),l.assert(S.value instanceof s.Tensor,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),l.assert(l.isFunction(S.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),S.value},C,function(_,E){var A=S.gradFunc(_,E),k=Array.isArray(A)?A:[A];l.assert(k.length===x.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),l.assert(k.every(function(I){return I instanceof s.Tensor}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var T={};return k.forEach(function(I,N){T[N]=function(){return I}}),T})}},v.prototype.readSync=function(y){var b=this.state.tensorInfo.get(y);return b.backend.readSync(y)},v.prototype.read=function(y){var b=this.state.tensorInfo.get(y);return b.backend.read(y)},v.prototype.time=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){switch(w.label){case 0:return b=c.now(),[4,this.backend.time(y)];case 1:return x=w.sent(),x.wallMs=c.now()-b,[2,x]}})})},v.prototype.track=function(y){return this.state.activeScope!=null&&(y.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(y)),y},Object.defineProperty(v.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),v.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new f;for(var y in this.registry)this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},v.nextTensorId=0,v.nextVariableId=0,v}();e.Engine=d;function h(v){var y=c.makeOnesTypedArray(c.sizeFromShape(v),"float32");return e.ENGINE.makeTensor(y,v,"float32")}var p;function g(){if(p==null){var v=void 0;if(typeof window!="undefined")v=window;else if(typeof lt!="undefined")v=lt;else if(typeof process!="undefined")v=process;else if(typeof self!="undefined")v=self;else throw new Error("Could not find a global object");p=v}return p}function m(){var v=g();if(v._tfengine==null){var y=new r.Environment(v);v._tfengine=new d(y)}return r.setEnvironmentGlobal(v._tfengine.ENV),s.setTensorTracker(function(){return v._tfengine}),v._tfengine}e.ENGINE=m()})(Ti);var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Add="Add",Vr.AddN="AddN",Vr.Div="Div",Vr.FusedBatchNorm="FusedBatchNorm",Vr.SquaredDifference="SquaredDifference",Vr.Square="Square",Vr.Transpose="Transpose",Vr.NonMaxSuppressionV5="NonMaxSuppressionV5",Vr.BroadcastTo="BroadcastTo",Vr.OneHot="OneHot",Vr.Identity="Identity",Vr.Tile="Tile",Vr.PadV2="PadV2",Vr.FromPixels="FromPixels",Vr.MaxPoolWithArgmax="MaxPoolWithArgmax";var hi={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(hi,"__esModule",{value:!0});var sWe=Ti,oie=V0,uWe=ni,ul=it;function sie(e,t){var n=e;if(ul.isTypedArray(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||ul.isTypedArray(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&oie.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&uie(e,r,[]),r}hi.inferShape=sie;function uie(e,t,n){if(n=n||[],!Array.isArray(e)&&!ul.isTypedArray(e)){ul.assert(t.length===0,function(){return"Element arr["+n.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+t[0]+" elements")});return}ul.assert(t.length>0,function(){return"Element arr["+n.join("][")+"] should be a primitive, "+("but is an array of "+e.length+" elements")}),ul.assert(e.length===t[0],function(){return"Element arr["+n.join("][")+"] should have "+t[0]+" "+("elements, but has "+e.length+" elements")});for(var r=t.slice(1),i=0;i<e.length;++i)uie(e[i],r,n.concat(i))}function lie(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must "+("be "+e+" tensor, but got "+t+" tensor"))}function cie(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof uWe.Tensor)return lie(r,e.dtype,t,n),e;var i=ul.inferDtype(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),lie(r,i,t,n),e==null||!ul.isTypedArray(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var o=sie(e,i);!ul.isTypedArray(e)&&!Array.isArray(e)&&(e=[e]);var s=!0,u=i!=="string"?ul.toTypedArray(e,i,oie.env().getBool("DEBUG")):ul.flatten(e,[],s);return sWe.ENGINE.makeTensor(u,o,i)}hi.convertToTensor=cie;function lWe(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");var i=e;return i.map(function(a,o){return cie(a,t+"["+o+"]",n)},r)}hi.convertToTensorArray=lWe;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var c4=Ti;function cWe(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(t.length+" keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];c4.ENGINE.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),c4.ENGINE.endScope(s),s}catch(u){throw c4.ENGINE.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Bi.op=cWe,Object.defineProperty(ck,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fWe=Ti,dWe=Vr,hWe=du,fie=hi,pWe=Bi;function gWe(e,t){var n,r=fie.convertToTensor(e,"a","add"),i=fie.convertToTensor(t,"b","add");n=hWe.makeTypesMatch(r,i),r=n[0],i=n[1];var a=function(s,u){var l=s.add(r,i);return u([r,i]),l},o={a:r,b:i};return fWe.ENGINE.runKernelFunc(a,o,null,dWe.Add)}ck.add=pWe.op({add_:gWe}),Object.defineProperty(ZUe,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mWe=ck,vWe=ni;vWe.Tensor.prototype.add=function(e){return mWe.add(this,e)};var yWe={},f4={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(f4,"__esModule",{value:!0});var bWe=Ti,xWe=Vr,wWe=hi,_We=Bi;function SWe(e,t){var n=wWe.convertToTensor(e,"broadcastTo","x"),r=n.shape;if(t.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(p,g){return p>1?g:-1}).filter(function(p){return p>=0});if(u.length===0)return n.clone();var l=function(p){return p.tile(n,o)},c=!0,f=function(p){return{x:function(){return p.sum(u,c)}}},d={x:n},h={shape:t,inputShape:a};return bWe.ENGINE.runKernelFunc(l,d,f,xWe.BroadcastTo,h)}f4.broadcastTo=_We.op({broadcastTo_:SWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(yWe,"__esModule",{value:!0});var EWe=f4,CWe=ni;CWe.Tensor.prototype.broadcastTo=function(e){return EWe.broadcastTo(this,e)};var AWe={},bk={},zi={},Lg={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Lg,"__esModule",{value:!0});function kWe(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1,s=t[t.length-1-i]||1;s>1&&o===1&&r.unshift(a)}return r}Lg.getBroadcastDims=kWe;function TWe(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}Lg.getReductionAxes=TWe;function OWe(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){var s="Operands could not be broadcast together with shapes "+(e+" and "+t+".");throw Error(s)}else n.unshift(a)}return n}Lg.assertAndGetBroadcastShape=OWe;var Bg={},ew={};Object.defineProperty(ew,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var d4=Ti,xk=hi,IWe=it,h4=Bi;function NWe(e,t){var n=xk.convertToTensor(e,"real","complex"),r=xk.convertToTensor(t,"imag","complex");return IWe.assertShapesMatch(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),d4.ENGINE.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}function DWe(e){var t=xk.convertToTensor(e,"input","real");return d4.ENGINE.runKernelFunc(function(n){return n.real(t)},{$input:t})}function RWe(e){var t=xk.convertToTensor(e,"input","imag");return d4.ENGINE.runKernelFunc(function(n){return n.imag(t)},{$input:t})}ew.complex=h4.op({complex_:NWe}),ew.real=h4.op({real_:DWe}),ew.imag=h4.op({imag_:RWe}),function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Ti,n=V0,r=hi,i=it,a=ew,o=Bi;function s(_,E,A){var k=r.inferShape(_,A);return u(_,E,k,A)}e.tensor=s;function u(_,E,A,k){if(k==null&&(k=i.inferDtype(_)),k==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!i.isTypedArray(_)&&!Array.isArray(_)&&typeof _!="number"&&typeof _!="boolean"&&typeof _!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(E!=null){i.assertNonNegativeIntegerDimensions(E);var T=i.sizeFromShape(E),I=i.sizeFromShape(A);i.assert(T===I,function(){return"Based on the provided shape, ["+E+"], the tensor should have "+(T+" values but has "+I)});for(var N=0;N<A.length;++N){var O=A[N],D=N===A.length-1?O!==i.sizeFromShape(E.slice(N)):!0;i.assert(A[N]===E[N]||!D,function(){return"Error creating a new Tensor. Inferred shape "+("("+A+") does not match the provided ")+("shape ("+E+"). ")})}}return!i.isTypedArray(_)&&!Array.isArray(_)&&(_=[_]),E=E||A,_=k!=="string"?i.toTypedArray(_,k,n.env().getBool("DEBUG")):i.flatten(_,[],!0),t.ENGINE.makeTensor(_,E,k)}function l(_,E){if((i.isTypedArray(_)&&E!=="string"||Array.isArray(_))&&E!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(E==="string"&&i.isTypedArray(_)&&!(_ instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var A=[],k=[];return u(_,A,k,E)}e.scalar=l;function c(_,E){i.assertNonNull(_);var A=r.inferShape(_,E);if(A.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var k=null;return u(_,k,A,E)}e.tensor1d=c;function f(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var k=r.inferShape(_,A);if(k.length!==2&&k.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u(_,E,k,A)}e.tensor2d=f;function d(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var k=r.inferShape(_,A);if(k.length!==3&&k.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor3d=d;function h(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var k=r.inferShape(_,A);if(k.length!==4&&k.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor4d=h;function p(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var k=r.inferShape(_,A);if(k.length!==5&&k.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor5d=p;function g(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var k=r.inferShape(_,A);if(k.length!==6&&k.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return E=E||k,u(_,E,k,A)}e.tensor6d=g;function m(_,E,A,k){return E===void 0&&(E=!0),t.ENGINE.makeVariable(_,E,A,k)}e.variable=m;function v(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=v(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeOnesTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.ones=v;function y(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=y(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeZerosTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.zeros=y;function b(_,E,A){return t.ENGINE.runKernelFunc(function(k){return k.fill(_,E,A)},{})}e.fill=b;function x(_){var E=r.convertToTensor(_,"x","onesLike");if(E.dtype==="complex64"){var A=e.onesLike(a.real(E)),k=e.zerosLike(a.imag(E));return a.complex(A,k)}var T=function(I,N){return{x:function(){return e.zerosLike(I)}}};return t.ENGINE.runKernelFunc(function(I){return I.onesLike(E)},{x:E},T,"OnesLike")}function w(_){var E=r.convertToTensor(_,"x","zerosLike"),A=function(k,T){return{x:function(){return e.zerosLike(k)}}};return t.ENGINE.runKernelFunc(function(k){return k.zerosLike(E)},{x:E},A,"ZerosLike")}function S(_,E,A){if(A<=0)throw new Error("The number of values should be positive.");return t.ENGINE.runKernelFunc(function(k){return k.linspace(_,E,A)},{})}e.linspace=S;function C(_,E,A,k){if(A===void 0&&(A=1),k===void 0&&(k="float32"),A===0)throw new Error("Cannot have a step of zero");var T=_===E,I=_<E&&A<0,N=E<_&&A>1;if(T||I||N)return y([0],k);var O=Math.abs(Math.ceil((E-_)/A)),D=i.makeZerosTypedArray(O,k);E<_&&A===1&&(A=-1),D[0]=_;for(var P=1;P<D.length;P++)D[P]=D[P-1]+A;return c(D,k)}e.range=C,e.onesLike=o.op({onesLike_:x}),e.zerosLike=o.op({zerosLike_:w})}(Bg);var En={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(En,"__esModule",{value:!0});var Cn=Ti,Nn=hi,die=it,Dn=Bi,po=Bg;function FWe(e){var t=Nn.convertToTensor(e,"x","neg"),n=function(a){return{x:function(){return a.neg()}}},r={},i=[t];return Cn.ENGINE.runKernelFunc(function(a){return a.neg(t)},{x:t},n,"Neg",r,i)}function MWe(e){var t=Nn.convertToTensor(e,"x","ceil"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.ceil(t)},{$x:t},n)}function PWe(e){var t=Nn.convertToTensor(e,"x","floor"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.floor(t)},{$x:t},n)}function $We(e){var t=Nn.convertToTensor(e,"x","sign"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.sign(t)},{$x:t},n)}function LWe(e){var t=Nn.convertToTensor(e,"x","isNaN"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},n)}function BWe(e){var t=Nn.convertToTensor(e,"x","isInf"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.isInf(t)},{$x:t},n)}function zWe(e){var t=Nn.convertToTensor(e,"x","isFinite"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},n)}function jWe(e){var t=Nn.convertToTensor(e,"x","round"),n=function(r){return{$x:function(){return po.zerosLike(r)}}};return Cn.ENGINE.runKernelFunc(function(r){return r.round(t)},{$x:t},n)}function UWe(e){var t=Nn.convertToTensor(e,"x","exp"),n=function(o,s){return{x:function(){return o.mulStrict(s[0])}}},r={},i=[],a=[!0];return Cn.ENGINE.runKernelFunc(function(o,s){var u=o.exp(t);return s([u]),u},{x:t},n,"Exp",r,i,a)}function WWe(e){var t=Nn.convertToTensor(e,"x","expm1"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.exp())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.expm1(t);return i([t]),a},{$x:t},n)}function VWe(e){var t=Nn.convertToTensor(e,"x","log"),n=function(a,o){var s=o[0];return{x:function(){return a.div(s.toFloat())}}},r={},i=[t];return Cn.ENGINE.runKernelFunc(function(a,o){var s=a.log(t);return o([t]),s},{x:t},n,"Log",r,i)}function qWe(e){var t=Nn.convertToTensor(e,"x","log1p"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.add(1))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.log1p(t);return i([t]),a},{$x:t},n)}function HWe(e){var t=Nn.convertToTensor(e,"x","sqrt"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.sqrt(t);return i([t]),a},{$x:t},n)}function GWe(e){var t=Nn.convertToTensor(e,"x","rsqrt"),n=function(i,a){var o=a[0];return{x:function(){return i.div(o.pow(1.5).mul(2)).neg()}}},r=[t];return Cn.ENGINE.runKernelFunc(function(i,a){var o=i.rsqrt(t);return a([t]),o},{x:t},n,"Rsqrt",{},r)}function KWe(e){var t=Nn.convertToTensor(e,"x","reciprocal"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.square().neg())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.reciprocal(t);return i([t]),a},{$x:t},n)}function XWe(e){var t=Nn.convertToTensor(e,"x","abs");if(t.dtype==="complex64")return Cn.ENGINE.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t});var n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.abs(t);return i([t]),a},{x:t},n,"Abs")}function YWe(e,t,n){var r=Nn.convertToTensor(e,"x","clipByValue");die.assert(t<=n,function(){return"Error in clip: min ("+t+") must be "+("less than or equal to max ("+n+").")});var i=function(s,u){var l=u[0];return{x:function(){return s.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),po.zerosLike(s))}}},a=[r],o={min:t,max:n};return Cn.ENGINE.runKernelFunc(function(s,u){var l=s.clip(r,t,n);return u([r]),l},{x:r},i,"ClipByValue",o,a)}function ZWe(e){var t=Nn.convertToTensor(e,"x","sigmoid"),n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.mul(po.scalar(1).sub(a)))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.sigmoid(t);return i([a]),a},{x:t},n,"Sigmoid")}function JWe(e){var t=Nn.convertToTensor(e,"x","logSigmoid"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t.neg()).neg();return i([t]),a},{$x:t},n)}function QWe(e){var t=Nn.convertToTensor(e,"x","softplus"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.sigmoid())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t);return i([t]),a},{$x:t},n)}function eVe(e){var t=Nn.convertToTensor(e,"x","sin"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(i)}}},r=[t];return Cn.ENGINE.runKernelFunc(function(i,a){var o=i.sin(t);return a([t]),o},{x:t},n,"Sin",{},r)}function tVe(e){var t=Nn.convertToTensor(e,"x","cos"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(i)}}},r=[t];return Cn.ENGINE.runKernelFunc(function(i,a){var o=i.cos(t);return a([t]),o},{x:t},n,"Cos",{},r)}function nVe(e){var t=Nn.convertToTensor(e,"x","tan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.cos().square())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.tan(t);return i([t]),a},{$x:t},n)}function rVe(e){var t=Nn.convertToTensor(e,"x","asin"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(po.scalar(1).sub(a.toFloat().square()).sqrt())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.asin(t);return i([t]),a},{$x:t},n)}function iVe(e){var t=Nn.convertToTensor(e,"x","acos"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(po.scalar(1).sub(a.toFloat().square()).sqrt()).neg()}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.acos(t);return i([t]),a},{$x:t},n)}function aVe(e){var t=Nn.convertToTensor(e,"x","atan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.atan(t);return i([t]),a},{$x:t},n)}function oVe(e){var t=Nn.convertToTensor(e,"x","sinh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.sinh(t);return i([t]),a},{$x:t},n)}function sVe(e){var t=Nn.convertToTensor(e,"x","cosh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.cosh(t);return i([t]),a},{$x:t},n)}function uVe(e){var t=Nn.convertToTensor(e,"x","tanh"),n=function(i,a){var o=a[0];return{x:function(){return po.scalar(1).sub(o.square()).mulStrict(i)}}},r=[!0];return Cn.ENGINE.runKernelFunc(function(i,a){var o=i.tanh(t);return a([o]),o},{x:t},n,"Tanh",{},null,r)}function lVe(e){var t=Nn.convertToTensor(e,"x","asinh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(po.scalar(1).add(a.toFloat().square()).sqrt())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.asinh(t);return i([t]),a},{$x:t},n)}function cVe(e){var t=Nn.convertToTensor(e,"x","acosh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.acosh(t);return i([t]),a},{$x:t},n)}function fVe(e){var t=Nn.convertToTensor(e,"x","atanh"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(po.scalar(1).sub(a.toFloat().square()))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.atanh(t);return i([t]),a},{$x:t},n)}function dVe(e){var t=Nn.convertToTensor(e,"x","erf");die.assert(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat());var n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}};return Cn.ENGINE.runKernelFunc(function(r,i){var a=r.erf(t);return i([t]),a},{$x:t},n)}function hVe(e,t){t===void 0&&(t=0);var n=Nn.convertToTensor(e,"x","step"),r=function(i){return{$x:function(){return po.zerosLike(i)}}};return Cn.ENGINE.runKernelFunc(function(i){return i.step(n,t)},{$x:n},r)}En.abs=Dn.op({abs_:XWe}),En.acos=Dn.op({acos_:iVe}),En.acosh=Dn.op({acosh_:cVe}),En.asin=Dn.op({asin_:rVe}),En.asinh=Dn.op({asinh_:lVe}),En.atan=Dn.op({atan_:aVe}),En.atanh=Dn.op({atanh_:fVe}),En.ceil=Dn.op({ceil_:MWe}),En.clipByValue=Dn.op({clipByValue_:YWe}),En.cos=Dn.op({cos_:tVe}),En.cosh=Dn.op({cosh_:sVe}),En.erf=Dn.op({erf_:dVe}),En.exp=Dn.op({exp_:UWe}),En.expm1=Dn.op({expm1_:WWe}),En.floor=Dn.op({floor_:PWe}),En.log=Dn.op({log_:VWe}),En.log1p=Dn.op({log1p_:qWe}),En.logSigmoid=Dn.op({logSigmoid_:JWe}),En.neg=Dn.op({neg_:FWe}),En.reciprocal=Dn.op({reciprocal_:KWe}),En.round=Dn.op({round_:jWe}),En.rsqrt=Dn.op({rsqrt_:GWe}),En.sigmoid=Dn.op({sigmoid_:ZWe}),En.sign=Dn.op({sign_:$We}),En.isNaN=Dn.op({isNaN_:LWe}),En.isInf=Dn.op({isInf_:BWe}),En.isFinite=Dn.op({isFinite_:zWe}),En.sin=Dn.op({sin_:eVe}),En.sinh=Dn.op({sinh_:oVe}),En.softplus=Dn.op({softplus_:QWe}),En.sqrt=Dn.op({sqrt_:HWe}),En.step=Dn.op({step_:hVe}),En.tan=Dn.op({tan_:nVe}),En.tanh=Dn.op({tanh_:uVe});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(zi,"__esModule",{value:!0});var wh=Ti,_h=du,zn=hi,Wf=it,hie=ck,Oi=Lg,xa=Bi,pie=Bg,pVe=En;function gVe(e,t){var n=zn.convertToTensor(e,"a","addStrict"),r=zn.convertToTensor(t,"b","addStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in addStrict: "),n.add(r)}function mVe(e,t){var n,r=zn.convertToTensor(e,"a","sub"),i=zn.convertToTensor(t,"b","sub");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s){var u=function(){var c=s,f=Oi.getReductionAxes(r.shape,a);return f.length>0&&(c=c.sum(f)),c.reshape(r.shape)},l=function(){var c=s,f=Oi.getReductionAxes(i.shape,a);return f.length>0&&(c=c.sum(f)),c.neg().reshape(i.shape)};return{a:u,b:l}};return wh.ENGINE.runKernelFunc(function(s){return s.subtract(r,i)},{a:r,b:i},o,"Sub")}function vVe(e,t){var n=zn.convertToTensor(e,"a","subStrict"),r=zn.convertToTensor(t,"b","subStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}function yVe(e,t){var n,r=zn.convertToTensor(e,"base","pow"),i=zn.convertToTensor(t,"exp","pow");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(c,f){var d=f[0],h=f[1],p=f[2],g=function(){var v=h.toFloat(),y=c.mul(v.mul(d.pow(v.sub(pie.scalar(1))))),b=Oi.getReductionAxes(d.shape,a);return b.length>0&&(y=y.sum(b)),y.reshape(d.shape)},m=function(){var v=d.greater(0),y=d.log().where(v,pie.zerosLike(d)),b=c.mul(p.mul(y)),x=Oi.getReductionAxes(h.shape,a);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)};return{a:g,b:m}},s={},u=[r,i],l=[!0];return wh.ENGINE.runKernelFunc(function(c,f){var d=c.pow(r,i);return f([r,i,d]),d},{a:r,b:i},o,"Pow",s,u,l)}function bVe(e,t){return Wf.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}function xVe(e,t){var n,r=zn.convertToTensor(e,"a","mul"),i=zn.convertToTensor(t,"b","mul");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.mul(c.toFloat()),p=Oi.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Oi.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{a:f,b:d}};return wh.ENGINE.runKernelFunc(function(s,u){var l=s.multiply(r,i);return u([r,i]),l},{a:r,b:i},o,"Mul")}function wVe(e,t){var n=zn.convertToTensor(e,"a","mul"),r=zn.convertToTensor(t,"b","mul");return Wf.assertShapesMatch(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}function _Ve(e,t){var n,r=zn.convertToTensor(e,"a","floorDiv"),i=zn.convertToTensor(t,"b","floorDiv");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.div(c.toFloat()),p=Oi.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Oi.getReductionAxes(c.shape,a);p.length>0&&(h=h.sum(p).reshape(c.shape));var g=c.square();return h.div(g.toFloat()).neg()};return{a:f,b:d}};return wh.ENGINE.runKernelFunc(function(s,u){var l=s.floorDiv(r,i);return u([r,i]),l},{a:r,b:i},o,"FloorDiv")}function SVe(e,t){var n=zn.convertToTensor(e,"a","div"),r=zn.convertToTensor(t,"b","div");return Wf.assertShapesMatch(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}function EVe(e,t){var n,r=zn.convertToTensor(e,"a","mod"),i=zn.convertToTensor(t,"b","mod");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Oi.getReductionAxes(l.shape,a);return h.length>0?s.sum(h).reshape(l.shape):s},d=function(){var h=s.mul(l.div(c).floor().neg()),p=Oi.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{$a:f,$b:d}};return wh.ENGINE.runKernelFunc(function(s,u){var l=s.mod(r,i);return u([r,i]),l},{$a:r,$b:i},o)}function CVe(e,t){var n=zn.convertToTensor(e,"a","modStrict"),r=zn.convertToTensor(t,"b","modStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}function AVe(e,t){var n,r=zn.convertToTensor(e,"a","minimum"),i=zn.convertToTensor(t,"b","minimum");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Oi.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.lessEqual(l).toFloat())},f=function(){return o.mul(u.greater(l).toFloat())};return{a:c,b:f}};return wh.ENGINE.runKernelFunc(function(o,s){var u=o.minimum(r,i);return s([r,i]),u},{a:r,b:i},a,"Minimum")}function kVe(e,t){var n=zn.convertToTensor(e,"a","minimumStrict"),r=zn.convertToTensor(t,"b","minimumStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}function TVe(e,t){var n,r=zn.convertToTensor(e,"a","maximum"),i=zn.convertToTensor(t,"b","maximum");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Oi.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.greaterEqual(l).toFloat())},f=function(){return o.mul(u.less(l).toFloat())};return{a:c,b:f}};return wh.ENGINE.runKernelFunc(function(o,s){var u=o.maximum(r,i);return s([r,i]),u},{a:r,b:i},a,"Maximum")}function OVe(e,t){var n=zn.convertToTensor(e,"a","maximumStrict"),r=zn.convertToTensor(t,"b","maximumStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}function IVe(e,t){var n=zn.convertToTensor(e,"a","squaredDifferenceStrict"),r=zn.convertToTensor(t,"b","squaredDifferenceStrict");return Wf.assertShapesMatch(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}function NVe(e,t){var n,r=zn.convertToTensor(e,"a","atan2"),i=zn.convertToTensor(t,"b","atan2");n=_h.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Oi.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=hie.add(l.square(),c.square()),p=s.mul(c.div(h)),g=Oi.getReductionAxes(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},d=function(){var h=hie.add(l.square(),c.square()),p=pVe.neg(s.mul(l.div(h))),g=Oi.getReductionAxes(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)};return{$a:f,$b:d}};return wh.ENGINE.runKernelFunc(function(s,u){var l=s.atan2(r,i);return u([r,i]),l},{$a:r,$b:i},o)}zi.addStrict=xa.op({addStrict_:gVe}),zi.atan2=xa.op({atan2_:NVe}),zi.divStrict=xa.op({divStrict_:SVe}),zi.floorDiv=xa.op({floorDiv_:_Ve}),zi.maximum=xa.op({maximum_:TVe}),zi.maximumStrict=xa.op({maximumStrict_:OVe}),zi.minimum=xa.op({minimum_:AVe}),zi.minimumStrict=xa.op({minimumStrict_:kVe}),zi.mod=xa.op({mod_:EVe}),zi.modStrict=xa.op({modStrict_:CVe}),zi.mul=xa.op({mul_:xVe}),zi.mulStrict=xa.op({mulStrict_:wVe}),zi.pow=xa.op({pow_:yVe}),zi.powStrict=xa.op({powStrict_:bVe}),zi.squaredDifferenceStrict=xa.op({squaredDifferenceStrict_:IVe}),zi.sub=xa.op({sub_:mVe}),zi.subStrict=xa.op({subStrict_:vVe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(bk,"__esModule",{value:!0});var DVe=Ti,RVe=Vr,FVe=du,gie=hi,MVe=zi,PVe=Bi;function $Ve(e,t){var n,r=gie.convertToTensor(e,"a","div"),i=gie.convertToTensor(t,"b","div");if(n=FVe.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return MVe.floorDiv(r,i);var a=function(u,l){var c=u.realDivide(r,i);return l([r,i]),c},o={a:r,b:i},s={};return DVe.ENGINE.runKernelFunc(a,o,null,RVe.Div,s)}bk.div=PVe.op({div_:$Ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(AWe,"__esModule",{value:!0});var LVe=bk,BVe=ni;BVe.Tensor.prototype.div=function(e){return LVe.div(this,e)};var zVe={},p4={},mie={},g4={},vie={},bc={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(bc,"__esModule",{value:!0});var jVe=it;function m4(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}bc.axesAreInnerMostDims=m4;function yie(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}bc.combineLocations=yie;function UVe(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);var a=t.map(function(o){return e[o]});return[n,a]}bc.computeOutAndReduceShapes=UVe;function WVe(e,t){var n=t.map(function(r){return 1});return yie(e,n,t)}bc.expandShapeToKeepDim=WVe;function VVe(e,t,n){jVe.assert(m4(t,n),function(){return e+" supports only inner-most axes for now. "+("Got axes "+t+" and rank-"+n+" input.")})}bc.assertAxesAreInnerMostDims=VVe;function qVe(e,t){if(m4(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}bc.getAxesPermutation=qVe;function HVe(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}bc.getUndoAxesPermutation=HVe;function GVe(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}bc.getInnerMostAxes=GVe;var bie={},wk={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(wk,"__esModule",{value:!0});var v4=it;function KVe(e,t){var n=e[0].length;e.forEach(function(i,a){v4.assert(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+n+")")})}),v4.assert(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)v4.assert(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") "+("does not match the shape of the rest ("+r+") ")+("along the non-concatenated axis "+a+".")})})}wk.assertParamsConsistent=KVe;function XVe(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}wk.computeOutShape=XVe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Ti,n=hi,r=it,i=it,a=wk,o=Bi,s=Bg;function u(p){return e.concat(p,0)}function l(p,g){return e.concat(p,g)}function c(p,g){return e.concat(p,g)}function f(p,g){return e.concat(p,g)}function d(p,g){g===void 0&&(g=0),r.assert(p.length>=1,function(){return"Pass at least one tensor to concat"});var m=n.convertToTensorArray(p,"tensors","concat");m[0].dtype==="complex64"&&m.forEach(function(S){if(S.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+S.dtype+". ")}),g=i.parseAxisParam(g,m[0].shape)[0];var v=a.computeOutShape(m.map(function(S){return S.shape}),g);if(r.sizeFromShape(v)===0)return s.tensor([],v);if(m=m.filter(function(S){return S.size>0}),m.length===1)return m[0];var y=m.map(function(S){return S.shape});a.assertParamsConsistent(y,g);var b=function(S){var C=y.map(function(E){return E[g]}),_=e.split(S,C,g);return _.map(function(E){return function(){return E}})},x=m,w={axis:g};return t.ENGINE.runKernelFunc(function(S){return S.concat(m,g)},x,b,"Concat",w)}function h(p,g,m){m===void 0&&(m=0);var v=n.convertToTensor(p,"x","split");m=i.parseAxisParam(m,v.shape)[0];var y;typeof g=="number"?(r.assert(v.shape[m]%g==0,function(){return"Number of splits must evenly divide the axis."}),y=new Array(g).fill(v.shape[m]/g)):(r.assert(v.shape[m]===g.reduce(function(x,w){return x+w}),function(){return"The sum of sizes must match the size of the axis dimension."}),y=g);var b=function(x){return{$x:function(){return e.concat(x,m)}}};return t.ENGINE.runKernelFunc(function(x){return x.split(v,y,m)},{$x:v},b)}e.concat=o.op({concat_:d}),e.concat1d=o.op({concat1d_:u}),e.concat2d=o.op({concat2d_:l}),e.concat3d=o.op({concat3d_:c}),e.concat4d=o.op({concat4d_:f}),e.split=o.op({split_:h})}(bie),function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=lt&&lt.__awaiter||function(C,_,E,A){return new(E||(E=Promise))(function(k,T){function I(D){try{O(A.next(D))}catch(P){T(P)}}function N(D){try{O(A.throw(D))}catch(P){T(P)}}function O(D){D.done?k(D.value):new E(function(P){P(D.value)}).then(I,N)}O((A=A.apply(C,_||[])).next())})},n=lt&&lt.__generator||function(C,_){var E={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},A,k,T,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(D){return function(P){return O([D,P])}}function O(D){if(A)throw new TypeError("Generator is already executing.");for(;E;)try{if(A=1,k&&(T=D[0]&2?k.return:D[0]?k.throw||((T=k.return)&&T.call(k),0):k.next)&&!(T=T.call(k,D[1])).done)return T;switch(k=0,T&&(D=[D[0]&2,T.value]),D[0]){case 0:case 1:T=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,k=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(T=E.trys,!(T=T.length>0&&T[T.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!T||D[1]>T[0]&&D[1]<T[3])){E.label=D[1];break}if(D[0]===6&&E.label<T[1]){E.label=T[1],T=D;break}if(T&&E.label<T[2]){E.label=T[2],E.ops.push(D);break}T[2]&&E.ops.pop(),E.trys.pop();continue}D=_.call(C,E)}catch(P){D=[6,P],k=0}finally{A=T=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=Ti,i=ni,a=hi,o=it,s=bc,u=bie,l=Bi;function c(C,_){var E=a.convertToTensor(C,"x","reshape",null);_=o.inferFromImplicitShape(_,E.size),o.assert(E.size===o.sizeFromShape(_),function(){return"new shape and old shape must have the same number of elements."});var A=function(T){return{x:function(){return T.reshape(E.shape)}}},k={shape:_};return r.ENGINE.runKernelFunc(function(T){return T.reshape(E,_)},{x:E},A,"Reshape",k)}function f(C,_){var E=a.convertToTensor(C,"x","squeeze");return e.reshape(E,o.squeezeShape(E.shape,_).newShape)}function d(C,_){var E=a.convertToTensor(C,"x","cast");if(!o.isValidDtype(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&E.dtype!=="string"||_!=="string"&&E.dtype==="string")throw new Error("Only strings can be casted to strings");var A=function(T){return{x:function(){return T.clone()}}},k={dtype:_};return r.ENGINE.runKernelFunc(function(T){return T.cast(E,_)},{x:E},A,"Cast",k)}function h(C,_){_===void 0&&(_=0);var E=a.convertToTensorArray(C,"tensors","stack");if(o.assert(E.length>=1,function(){return"Pass at least one tensor to tf.stack"}),E.length===1)return E[0].expandDims(_);var A=E[0].rank,k=E[0].shape,T=E[0].dtype;o.assert(_<=A,function(){return"Axis must be <= rank of the tensor"}),E.forEach(function(N){o.assertShapesMatch(k,N.shape,"All tensors passed to stack must have matching shapes")}),E.forEach(function(N){o.assert(T===N.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var I=E.map(function(N){return N.expandDims(_)});return u.concat(I,_)}function p(C,_,E){var A=a.convertToTensor(C,"x","batchToSpaceND"),k=_.reduce(function(I,N){return I*N});o.assert(A.rank>=1+_.length,function(){return"input rank is "+A.rank+" but should be > than blockShape.length "+_.length}),o.assert(E.length===_.length,function(){return"crops.length is "+E.length+" but should be equal to blockShape.length  "+_.length}),o.assert(A.shape[0]%k==0,function(){return"input tensor batch is "+A.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+_.join(" * ")+" === "+k)});var T=function(I){return{$x:function(){return I.spaceToBatchND(_,E)}}};return r.ENGINE.runKernelFunc(function(I){return I.batchToSpaceND(A,_,E)},{$x:A},T)}function g(C,_,E){var A=a.convertToTensor(C,"x","spaceToBatchND");o.assert(A.rank>=1+_.length,function(){return"input rank "+A.rank+" should be > than [blockShape] "+_.length}),o.assert(E.length===_.length,function(){return"paddings.shape[0] "+E.length+" must be equal to [blockShape] "+_.length}),o.assert(A.shape.reduce(function(T,I,N){return N>0&&N<=_.length?T&&(I+E[N-1][0]+E[N-1][1])%_[N-1]==0:T},!0),function(){return"input spatial dimensions "+A.shape.slice(1)+" with paddings "+E.toString()+" must be divisible by blockShapes "+_.toString()});var k=function(T){return{$x:function(){return T.batchToSpaceND(_,E)}}};return r.ENGINE.runKernelFunc(function(T){return T.spaceToBatchND(A,_,E)},{$x:A},k)}function m(C,_){_===void 0&&(_=0),_=_||0;var E=a.convertToTensor(C,"x","unstack");o.assert(_>=-E.shape.length&&_<E.shape.length,function(){return"Axis = "+_+" is not in [-"+E.shape.length+", "+E.shape.length+")"}),_<0&&(_+=E.shape.length);var A=function(T){return{x:function(){return e.stack(T,_)}}},k={axis:_};return r.ENGINE.runKernelFunc(function(T){return T.unstack(E,_)},{x:E},A,"Unpack",k)}function v(C,_,E,A){_===void 0&&(_=0),E===void 0&&(E=!1),A===void 0&&(A=!1);var k=a.convertToTensor(C,"x","cumsum");_=_|0;var T=s.getAxesPermutation([_],k.rank),I=k;T!=null&&(I=k.transpose(T));var N=s.getInnerMostAxes(1,k.rank)[0],O=function(P){return{permutedX:function(){return P.cumsum(_,E,!A)}}},D=r.ENGINE.runKernelFunc(function(P){return P.cumsum(I,N,E,A)},{permutedX:I},O);return T!=null&&(D=D.transpose(T)),D}function y(C,_){_===void 0&&(_=0);var E=null,A=a.convertToTensor(C,"x","expandDims",E);o.assert(_<=A.rank,function(){return"Axis must be <= rank of the tensor"});var k=A.shape.slice();return _<0&&(o.assert(-(A.rank+1)<=_,function(){return"Axis must be in the interval ["+-(A.rank+1)+", "+A.rank+"]"}),_=A.rank+_+1),k.splice(_,0,1),e.reshape(A,k)}function b(C,_,E){E===void 0&&(E="NHWC");var A=a.convertToTensor(C,"x","depthToSpace"),k=E==="NHWC"?A.shape[1]:A.shape[2],T=E==="NHWC"?A.shape[2]:A.shape[3],I=E==="NHWC"?A.shape[3]:A.shape[1];return o.assert(k*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+k+" and "+_+`  for depthToSpace with input shape
      `+A.shape}),o.assert(T*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+T+" and "+_+` for depthToSpace with input shape
          `+A.shape}),o.assert(I%(_*_)==0,function(){return"Dimension size must be evenly divisible by "+_*_+" but is "+I+" for depthToSpace with input shape "+A.shape}),r.ENGINE.runKernelFunc(function(N){return N.depthToSpace(A,_,E)},{$x:A})}function x(C,_){return t(this,void 0,void 0,function(){var E,A,k,T,I,N,O,D,P,O,V;return n(this,function(Y){switch(Y.label){case 0:return E=a.convertToTensor(C,"x","setdiff1d"),A=a.convertToTensor(_,"y","setdiff1d"),o.assert(E.dtype===A.dtype,function(){return"x and y should have the same dtype, but got x ("+E.dtype+") and y ("+A.dtype+")."}),o.assert(E.rank===1,function(){return"x should be 1D tensor, but got x ("+E.shape+")."}),o.assert(A.rank===1,function(){return"y should be 1D tensor, but got y ("+A.shape+")."}),[4,E.data()];case 1:return k=Y.sent(),[4,A.data()];case 2:for(T=Y.sent(),I=new Set(T),N=0,O=0;O<k.length;O++)I.has(k[O])||N++;for(D=new i.TensorBuffer([N],E.dtype),P=new i.TensorBuffer([N],"int32"),O=0,V=0;O<k.length;O++)I.has(k[O])||(D.values[V]=k[O],P.values[V]=O,V++);return[2,[D.toTensor(),P.toTensor()]]}})})}function w(C,_,E){return _===void 0&&(_="float32"),_=_||"float32",o.assertNonNegativeIntegerDimensions(C),new i.TensorBuffer(C,_,E)}e.buffer=w;function S(C,_){_===void 0&&(_=!1),console.log(C.toString(_))}e.print=S,e.batchToSpaceND=l.op({batchToSpaceND_:p}),e.cast=l.op({cast_:d}),e.cumsum=l.op({cumsum_:v}),e.depthToSpace=l.op({depthToSpace_:b}),e.expandDims=l.op({expandDims_:y}),e.reshape=l.op({reshape_:c}),e.spaceToBatchND=l.op({spaceToBatchND_:g}),e.squeeze=l.op({squeeze_:f}),e.stack=l.op({stack_:h}),e.unstack=l.op({unstack_:m}),e.setdiff1dAsync=x}(vie);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(g4,"__esModule",{value:!0});var xie=vie;function YVe(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var i=xie.buffer(e,"int32"),a=xie.buffer([n.length,e.length],"int32"),r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}g4.whereImpl=YVe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=lt&&lt.__awaiter||function(m,v,y,b){return new(y||(y=Promise))(function(x,w){function S(E){try{_(b.next(E))}catch(A){w(A)}}function C(E){try{_(b.throw(E))}catch(A){w(A)}}function _(E){E.done?x(E.value):new y(function(A){A(E.value)}).then(S,C)}_((b=b.apply(m,v||[])).next())})},n=lt&&lt.__generator||function(m,v){var y={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},b,x,w,S;return S={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function C(E){return function(A){return _([E,A])}}function _(E){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,x&&(w=E[0]&2?x.return:E[0]?x.throw||((w=x.return)&&w.call(x),0):x.next)&&!(w=w.call(x,E[1])).done)return w;switch(x=0,w&&(E=[E[0]&2,w.value]),E[0]){case 0:case 1:w=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,x=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(w=y.trys,!(w=w.length>0&&w[w.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!w||E[1]>w[0]&&E[1]<w[3])){y.label=E[1];break}if(E[0]===6&&y.label<w[1]){y.label=w[1],w=E;break}if(w&&y.label<w[2]){y.label=w[2],y.ops.push(E);break}w[2]&&y.ops.pop(),y.trys.pop();continue}E=v.call(m,y)}catch(A){E=[6,A],x=0}finally{b=w=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=g4,i=Ti,a=hi,o=it,s=Lg,u=Bi,l=Bg;function c(m){var v=a.convertToTensor(m,"x","logicalNot","bool");return i.ENGINE.runKernelFunc(function(y){return y.logicalNot(v)},{$x:v})}function f(m,v){var y=a.convertToTensor(m,"a","logicalAnd","bool"),b=a.convertToTensor(v,"b","logicalAnd","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalAnd(y,b)},{a:y,b},null,"LogicalAnd")}function d(m,v){var y=a.convertToTensor(m,"a","logicalOr","bool"),b=a.convertToTensor(v,"b","logicalOr","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalOr(y,b)},{$a:y,$b:b})}function h(m,v){var y=a.convertToTensor(m,"a","logicalXor","bool"),b=a.convertToTensor(v,"b","logicalXor","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),e.logicalOr(m,v).logicalAnd(e.logicalAnd(m,v).logicalNot())}function p(m,v,y){var b=a.convertToTensor(v,"a","where"),x=a.convertToTensor(y,"b","where"),w=a.convertToTensor(m,"condition","where","bool");o.assertShapesMatch(b.shape,x.shape,"Error in where: "),w.rank===1?o.assert(w.shape[0]===b.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):o.assertShapesMatch(w.shape,x.shape,"Error in where: ");var S=function(C,_){var E=_[0];return{$condition:function(){return l.zerosLike(E).toFloat()},$a:function(){return C.mul(E.cast(C.dtype))},$b:function(){return C.mul(E.logicalNot().cast(C.dtype))}}};return i.ENGINE.runKernelFunc(function(C,_){var E=C.select(w,b,x);return _([w]),E},{$condition:w,$a:b,$b:x},S)}function g(m){return t(this,void 0,void 0,function(){var v,y,b;return n(this,function(x){switch(x.label){case 0:return v=a.convertToTensor(m,"condition","whereAsync","bool"),[4,v.data()];case 1:return y=x.sent(),b=r.whereImpl(v.shape,y),m!==v&&v.dispose(),[2,b]}})})}e.logicalAnd=u.op({logicalAnd_:f}),e.logicalNot=u.op({logicalNot_:c}),e.logicalOr=u.op({logicalOr_:d}),e.logicalXor=u.op({logicalXor_:h}),e.where=u.op({where_:p}),e.whereAsync=g}(mie);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(p4,"__esModule",{value:!0});var ZVe=du,wie=hi,JVe=bk,QVe=mie,eqe=Bi,tqe=Bg;function nqe(e,t){var n,r=wie.convertToTensor(e,"a","div"),i=wie.convertToTensor(t,"b","div");n=ZVe.makeTypesMatch(r,i),r=n[0],i=n[1];var a=JVe.div(r,i),o=tqe.zerosLike(a),s=i.equal(o);return QVe.where(s,o,a)}p4.divNoNan=eqe.op({divNoNan_:nqe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(zVe,"__esModule",{value:!0});var rqe=p4,iqe=ni;iqe.Tensor.prototype.divNoNan=function(e){return rqe.divNoNan(this,e)};var aqe={},y4={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(y4,"__esModule",{value:!0});var oqe=Ti,sqe=Vr,uqe=du,_ie=hi,lqe=Lg,cqe=Bi,fqe=Bg;function dqe(e,t){var n,r=_ie.convertToTensor(e,"a","squaredDifference"),i=_ie.convertToTensor(t,"b","squaredDifference");n=uqe.makeTypesMatch(r,i),r=n[0],i=n[1],lqe.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(f,d){var h=d[0],p=d[1],g=fqe.scalar(2),m=function(){return f.mul(h.sub(p).mul(g))},v=function(){return f.mul(p.sub(h).mul(g))};return{a:m,b:v}},o=function(f,d){var h=f.squaredDifference(r,i);return d([r,i]),h},s={a:r,b:i},u={},l=[r,i],c=[];return oqe.ENGINE.runKernelFunc(o,s,a,sqe.SquaredDifference,u,l,c)}y4.squaredDifference=cqe.op({squaredDifference_:dqe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(aqe,"__esModule",{value:!0});var hqe=y4,pqe=ni;pqe.Tensor.prototype.squaredDifference=function(e){return hqe.squaredDifference(this,e)};var gqe={},b4={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(b4,"__esModule",{value:!0});var mqe=Ti,vqe=Vr,yqe=hi,bqe=it,xqe=Bi;function wqe(e,t){var n=null,r=yqe.convertToTensor(e,"x","tile",n);bqe.assert(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" "+("must match length of reps "+t+".")});var i=function(u,l){var c=u.tile(r,t);return l([r]),c},a=[r],o={x:r},s={reps:t};return mqe.ENGINE.runKernelFunc(i,o,null,vqe.Tile,s,a)}b4.tile=xqe.op({tile_:wqe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(gqe,"__esModule",{value:!0});var _qe=b4,Sqe=ni;Sqe.Tensor.prototype.tile=function(e){return _qe.tile(this,e)};var Eqe={},x4={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(x4,"__esModule",{value:!0});var Cqe=Ti,Aqe=Vr,kqe=hi,Tqe=Bi;function Oqe(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=kqe.convertToTensor(e,"indices","oneHot","int32"),a=i.shape.concat([t]);i=i.flatten();var o=function(c,f){return f([i]),c.oneHot(i,t,n,r)},s={indices:i},u={depth:t,onValue:n,offValue:r},l=Cqe.ENGINE.runKernelFunc(o,s,null,Aqe.OneHot,u);return l.reshape(a)}x4.oneHot=Tqe.op({oneHot_:Oqe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Eqe,"__esModule",{value:!0});var Iqe=x4,Nqe=ni;Nqe.Tensor.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),Iqe.oneHot(this,e,t,n)};var Dqe={},w4={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(w4,"__esModule",{value:!0});var Rqe=Ti,Fqe=hi,Sie=it,Mqe=Bi;function Pqe(e,t){var n=Fqe.convertToTensor(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),Sie.assert(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" "+("must match length of perm "+t+".")}),t.forEach(function(i){Sie.assert(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+(" but got "+t)})}),n.rank<=1)return n.clone();var r={perm:t};return Rqe.ENGINE.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}w4.transpose=Mqe.op({transpose_:Pqe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Dqe,"__esModule",{value:!0});var $qe=w4,Lqe=ni;Lqe.Tensor.prototype.transpose=function(e){return $qe.transpose(this,e)};var Bqe={},_4={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(_4,"__esModule",{value:!0});var zqe=Ti,jqe=Vr,Uqe=hi,Wqe=Bi;function Vqe(e,t,n){n===void 0&&(n=0);var r=Uqe.convertToTensor(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=function(s,u){return u([r]),s.pad(r,t,n)},a={paddings:t,constantValue:n},o={x:r};return zqe.ENGINE.runKernelFunc(i,o,null,jqe.PadV2,a)}_4.pad=Wqe.op({pad_:Vqe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Bqe,"__esModule",{value:!0});var qqe=_4,Hqe=ni;Hqe.Tensor.prototype.pad=function(e,t){return qqe.pad(this,e,t)};var Gqe={},_k={},Sk={},qr={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(qr,"__esModule",{value:!0});var go=Ti,tw=V0,Kqe=ni,Xqe=du;function Yqe(){tw.env().set("PROD",!0)}qr.enableProdMode=Yqe;function Zqe(){tw.env().set("DEBUG",!0)}qr.enableDebugMode=Zqe;function Jqe(){tw.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}qr.disableDeprecationWarnings=Jqe;function Eie(e){tw.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}qr.deprecationWarn=Eie,Kqe.setDeprecationWarningFn(Eie);function Qqe(){go.ENGINE.disposeVariables()}qr.disposeVariables=Qqe;function eHe(){return go.ENGINE}qr.engine=eHe;function tHe(){return go.ENGINE.memory()}qr.memory=tHe;function nHe(e){return go.ENGINE.profile(e)}qr.profile=nHe;function rHe(e,t){return go.ENGINE.tidy(e,t)}qr.tidy=rHe;function iHe(e){var t=Xqe.getTensorsInContainer(e);t.forEach(function(n){return n.dispose()})}qr.dispose=iHe;function aHe(e){return go.ENGINE.keep(e)}qr.keep=aHe;function oHe(e){return go.ENGINE.time(e)}qr.time=oHe;function sHe(e){return go.ENGINE.setBackend(e)}qr.setBackend=sHe;function uHe(){return go.ENGINE.ready()}qr.ready=uHe;function lHe(){return go.ENGINE.backendName}qr.getBackend=lHe;function cHe(e){go.ENGINE.removeBackend(e)}qr.removeBackend=cHe;function fHe(e){return go.ENGINE.findBackend(e)}qr.findBackend=fHe;function dHe(e){return go.ENGINE.findBackendFactory(e)}qr.findBackendFactory=dHe;function hHe(e,t,n){return n===void 0&&(n=1),go.ENGINE.registerBackend(e,t,n)}qr.registerBackend=hHe;function pHe(){return go.ENGINE.backend}qr.backend=pHe;function gHe(e,t){tw.env().setPlatform(e,t)}qr.setPlatform=gHe,Object.defineProperty(Sk,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mHe=qr;function vHe(){mHe.deprecationWarn("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}Sk.warnDeprecation=vHe;function yHe(e){var t;return e.rank===0||e.rank===1?t=e.as4D(1,1,1,e.size):e.rank===2?t=e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?t=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):t=e,t}Sk.xAs4D=yHe;/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(_k,"__esModule",{value:!0});var bHe=Ti,nw=hi,S4=it,Cie=Sk,Aie=Bi;function xHe(e,t,n,r,i,a){return r===void 0&&(r=.001),Cie.warnDeprecation(),kie(e,t,n,a,i,r)}function kie(e,t,n,r,i,a){a==null&&(a=.001);var o=nw.convertToTensor(e,"x","batchNorm"),s=nw.convertToTensor(t,"mean","batchNorm"),u=nw.convertToTensor(n,"variance","batchNorm"),l;i!=null&&(l=nw.convertToTensor(i,"scale","batchNorm"));var c;r!=null&&(c=nw.convertToTensor(r,"offset","batchNorm")),S4.assert(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),S4.assert(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),S4.assert(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f=function(g,m){var v=Cie.xAs4D(o),y=g.batchNormalization(v,Ek(s),Ek(u),a,Ek(l),Ek(c));return m([o,s,u,l]),y},d={x:o,scale:l,offset:c,mean:s,variance:u},h={varianceEpsilon:a},p=bHe.ENGINE.runKernelFunc(f,d,null,"FusedBatchNorm",h);return p.reshape(o.shape)}function Ek(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}_k.batchNormalization=Aie.op({batchNormalization_:xHe}),_k.batchNorm=Aie.op({batchNorm_:kie}),Object.defineProperty(Gqe,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wHe=_k,_He=ni;_He.Tensor.prototype.batchNorm=function(e,t,n,r,i){return wHe.batchNorm(this,e,t,n,r,i)},Object.defineProperty(YUe,"__esModule",{value:!0});var E4={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var SHe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),EHe=Object.prototype.hasOwnProperty;function C4(e,t){return EHe.call(e,t)}function A4(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)C4(e,r)&&n.push(r);return n}function Ms(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function k4(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function zg(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Tie(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function T4(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(T4(e[t]))return!0}else if(typeof e=="object"){for(var r=A4(e),i=r.length,t=0;t<i;t++)if(T4(e[r[t]]))return!0}}return!1}function Oie(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var Iie=function(e){SHe(t,e);function t(n,r,i,a,o){var s=this.constructor,u=e.call(this,Oie(n,{name:r,index:i,operation:a,tree:o}))||this;return u.name=r,u.index=i,u.operation=a,u.tree=o,Object.setPrototypeOf(u,s.prototype),u.message=Oie(n,{name:r,index:i,operation:a,tree:o}),u}return t}(Error),pi=Iie,CHe=Ms,G0={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Ck(n,this.path);r&&(r=Ms(r));var i=jg(n,{op:"remove",path:this.from}).removed;return jg(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Ck(n,this.from);return jg(n,{op:"add",path:this.path,value:Ms(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:rw(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},AHe={add:function(e,t,n){return k4(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:G0.move,copy:G0.copy,test:G0.test,_get:G0._get};function Ck(e,t){if(t=="")return e;var n={op:"_get",path:t};return jg(e,n),n.value}function jg(e,t,n,r,i,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):kk(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Ck(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=rw(e,t.value),o.test===!1)throw new pi("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new pi("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}}else{r||(e=Ms(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=kk;;){if(h=u[c],i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!k4(h))throw new pi("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);k4(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new pi("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var o=AHe[t.op].call(t,l,h,e);if(o.test===!1)throw new pi("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(h&&h.indexOf("~")!=-1&&(h=Tie(h)),c>=f){var o=G0[t.op].call(t,l,h,e);if(o.test===!1)throw new pi("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}l=l[h]}}}function Ak(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new pi("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Ms(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=jg(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function kHe(e,t,n){var r=jg(e,t);if(r.test===!1)throw new pi("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function kk(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new pi("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(G0[e.op]){if(typeof e.path!="string")throw new pi("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new pi('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new pi("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new pi("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&T4(e.value))throw new pi("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new pi("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new pi("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},s=Nie([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new pi("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new pi("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Nie(e,t,n){try{if(!Array.isArray(e))throw new pi("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Ak(Ms(t),Ms(e),n||!0);else{n=n||kk;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof pi)return i;throw i}}function rw(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){if(a=e.length,a!=t.length)return!1;for(i=a;i--!=0;)if(!rw(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(a=s.length,a!==Object.keys(t).length)return!1;for(i=a;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=a;i--!=0;)if(o=s[i],!rw(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var THe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:pi,deepClone:CHe,getValueByPointer:Ck,applyOperation:jg,applyPatch:Ak,applyReducer:kHe,validator:kk,validate:Nie,_areEquals:rw});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var O4=new WeakMap,OHe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),IHe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function NHe(e){return O4.get(e)}function DHe(e,t){return e.observers.get(t)}function RHe(e,t){e.observers.delete(t.callback)}function FHe(e,t){t.unobserve()}function MHe(e,t){var n=[],r,i=NHe(e);if(!i)i=new OHe(e),O4.set(e,i);else{var a=DHe(i,t);r=a&&a.observer}if(r)return r;if(r={},i.value=Ms(e),t){r.callback=t,r.next=null;var o=function(){I4(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){I4(r),clearTimeout(r.next),RHe(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new IHe(t,r)),r}function I4(e,t){t===void 0&&(t=!1);var n=O4.get(e.object);N4(n.value,e.object,e.patches,"",t),e.patches.length&&Ak(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function N4(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=A4(t),o=A4(e),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(C4(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null?N4(c,f,n,r+"/"+zg(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+zg(l),value:Ms(c)}),n.push({op:"replace",path:r+"/"+zg(l),value:Ms(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+zg(l),value:Ms(c)}),n.push({op:"remove",path:r+"/"+zg(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&a.length==o.length))for(var u=0;u<a.length;u++){var l=a[u];!C4(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+zg(l),value:Ms(t[l])})}}}function PHe(e,t,n){n===void 0&&(n=!1);var r=[];return N4(e,t,r,"",n),r}var $He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:FHe,observe:MHe,generate:I4,compare:PHe});Object.assign({},THe,$He,{JsonPatchError:Iie,deepClone:Ms,escapePathComponent:zg,unescapePathComponent:Tie});var LHe=/("(?:[^\\"]|\\.)*")|[:,]/g,D4=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,a=n.replacer,function o(s,u,l){var c,f,d,h,p,g,m,v,y,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,a),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(y=x.replace(LHe,function(S,C){return C||S+" "}),y.length<=m))return y;if(a!=null&&(s=JSON.parse(x),a=void 0),typeof s=="object"&&s!==null){if(v=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(o(s[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(s),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=o(s[h],v,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[b,r+d.join(`,
`+v),c].join(`
`+u)}return x}(t,"",0)},Sh={exports:{}};const BHe="2.0.0",zHe=256,jHe=Number.MAX_SAFE_INTEGER||9007199254740991,UHe=16;var Tk={SEMVER_SPEC_VERSION:BHe,MAX_LENGTH:zHe,MAX_SAFE_INTEGER:jHe,MAX_SAFE_COMPONENT_LENGTH:UHe};const WHe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Ok=WHe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=Tk,r=Ok;t=e.exports={};const i=t.re=[],a=t.src=[],o=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),o[l]=d,a[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${a[o.NUMERICIDENTIFIER]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${a[o.NUMERICIDENTIFIERLOOSE]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${a[o.PRERELEASEIDENTIFIER]}(?:\\.${a[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${a[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${a[o.BUILDIDENTIFIER]}(?:\\.${a[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${a[o.MAINVERSION]}${a[o.PRERELEASE]}?${a[o.BUILD]}?`),u("FULL",`^${a[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${a[o.MAINVERSIONLOOSE]}${a[o.PRERELEASELOOSE]}?${a[o.BUILD]}?`),u("LOOSE",`^${a[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${a[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${a[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:${a[o.PRERELEASE]})?${a[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:${a[o.PRERELEASELOOSE]})?${a[o.BUILD]}?)?)?`),u("XRANGE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",a[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${a[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${a[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${a[o.LONECARET]}${a[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${a[o.LONECARET]}${a[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${a[o.GTLT]}\\s*(${a[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]}|${a[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${a[o.XRANGEPLAIN]})\\s+-\\s+(${a[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${a[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Sh,Sh.exports);const VHe=["includePrerelease","loose","rtl"],qHe=e=>e?typeof e!="object"?{loose:!0}:VHe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var Ik=qHe;const Die=/^[0-9]+$/,Rie=(e,t)=>{const n=Die.test(e),r=Die.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},HHe=(e,t)=>Rie(t,e);var R4={compareIdentifiers:Rie,rcompareIdentifiers:HHe};const Nk=Ok,{MAX_LENGTH:Fie,MAX_SAFE_INTEGER:Dk}=Tk,{re:Mie,t:Pie}=Sh.exports,GHe=Ik,{compareIdentifiers:iw}=R4;class ll{constructor(t,n){if(n=GHe(n),t instanceof ll){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>Fie)throw new TypeError(`version is longer than ${Fie} characters`);Nk("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?Mie[Pie.LOOSE]:Mie[Pie.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Dk||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Dk||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Dk||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<Dk)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Nk("SemVer.compare",this.version,this.options,t),!(t instanceof ll)){if(typeof t=="string"&&t===this.version)return 0;t=new ll(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof ll||(t=new ll(t,this.options)),iw(this.major,t.major)||iw(this.minor,t.minor)||iw(this.patch,t.patch)}comparePre(t){if(t instanceof ll||(t=new ll(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(Nk("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return iw(r,i)}while(++n)}compareBuild(t){t instanceof ll||(t=new ll(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(Nk("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return iw(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var mo=ll;const{MAX_LENGTH:KHe}=Tk,{re:$ie,t:Lie}=Sh.exports,Bie=mo,XHe=Ik,YHe=(e,t)=>{if(t=XHe(t),e instanceof Bie)return e;if(typeof e!="string"||e.length>KHe||!(t.loose?$ie[Lie.LOOSE]:$ie[Lie.FULL]).test(e))return null;try{return new Bie(e,t)}catch(r){return null}};var K0=YHe;const ZHe=K0,JHe=(e,t)=>{const n=ZHe(e,t);return n?n.version:null};var QHe=JHe;const eGe=K0,tGe=(e,t)=>{const n=eGe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var nGe=tGe;const rGe=mo,iGe=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new rGe(e,n).inc(t,r).version}catch(i){return null}};var aGe=iGe;const zie=mo,oGe=(e,t,n)=>new zie(e,n).compare(new zie(t,n));var cl=oGe;const sGe=cl,uGe=(e,t,n)=>sGe(e,t,n)===0;var F4=uGe;const jie=K0,lGe=F4,cGe=(e,t)=>{if(lGe(e,t))return null;{const n=jie(e),r=jie(t),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return a+s;return o}};var fGe=cGe;const dGe=mo,hGe=(e,t)=>new dGe(e,t).major;var pGe=hGe;const gGe=mo,mGe=(e,t)=>new gGe(e,t).minor;var vGe=mGe;const yGe=mo,bGe=(e,t)=>new yGe(e,t).patch;var xGe=bGe;const wGe=K0,_Ge=(e,t)=>{const n=wGe(e,t);return n&&n.prerelease.length?n.prerelease:null};var SGe=_Ge;const EGe=cl,CGe=(e,t,n)=>EGe(t,e,n);var AGe=CGe;const kGe=cl,TGe=(e,t)=>kGe(e,t,!0);var OGe=TGe;const Uie=mo,IGe=(e,t,n)=>{const r=new Uie(e,n),i=new Uie(t,n);return r.compare(i)||r.compareBuild(i)};var M4=IGe;const NGe=M4,DGe=(e,t)=>e.sort((n,r)=>NGe(n,r,t));var RGe=DGe;const FGe=M4,MGe=(e,t)=>e.sort((n,r)=>FGe(r,n,t));var PGe=MGe;const $Ge=cl,LGe=(e,t,n)=>$Ge(e,t,n)>0;var Rk=LGe;const BGe=cl,zGe=(e,t,n)=>BGe(e,t,n)<0;var P4=zGe;const jGe=cl,UGe=(e,t,n)=>jGe(e,t,n)!==0;var Wie=UGe;const WGe=cl,VGe=(e,t,n)=>WGe(e,t,n)>=0;var $4=VGe;const qGe=cl,HGe=(e,t,n)=>qGe(e,t,n)<=0;var L4=HGe;const GGe=F4,KGe=Wie,XGe=Rk,YGe=$4,ZGe=P4,JGe=L4,QGe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return GGe(e,n,r);case"!=":return KGe(e,n,r);case">":return XGe(e,n,r);case">=":return YGe(e,n,r);case"<":return ZGe(e,n,r);case"<=":return JGe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Vie=QGe;const eKe=mo,tKe=K0,{re:Fk,t:Mk}=Sh.exports,nKe=(e,t)=>{if(e instanceof eKe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(Fk[Mk.COERCE]);else{let r;for(;(r=Fk[Mk.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),Fk[Mk.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;Fk[Mk.COERCERTL].lastIndex=-1}return n===null?null:tKe(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var rKe=nKe,iKe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},aKe=jn;jn.Node=Ug,jn.create=jn;function jn(e){var t=this;if(t instanceof jn||(t=new jn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}jn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},jn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},jn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},jn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)sKe(this,arguments[e]);return this.length},jn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)uKe(this,arguments[e]);return this.length},jn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},jn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},jn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next},jn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev},jn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},jn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},jn.prototype.map=function(e,t){t=t||this;for(var n=new jn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n},jn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new jn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n},jn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n},jn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n},jn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},jn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},jn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new jn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n},jn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new jn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n},jn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var a=[],r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=oKe(this,i,n[r]);return a},jn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function oKe(e,t,n){var r=t===e.head?new Ug(n,null,t,e):new Ug(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function sKe(e,t){e.tail=new Ug(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function uKe(e,t){e.head=new Ug(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ug(e,t,n,r){if(!(this instanceof Ug))return new Ug(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{iKe(jn)}catch(e){}const lKe=aKe,Wg=Symbol("max"),Vf=Symbol("length"),X0=Symbol("lengthCalculator"),aw=Symbol("allowStale"),Vg=Symbol("maxAge"),qf=Symbol("dispose"),qie=Symbol("noDisposeOnSet"),ra=Symbol("lruList"),fl=Symbol("cache"),Hie=Symbol("updateAgeOnGet"),B4=()=>1;class cKe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Wg]=t.max||1/0;const n=t.length||B4;if(this[X0]=typeof n!="function"?B4:n,this[aw]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Vg]=t.maxAge||0,this[qf]=t.dispose,this[qie]=t.noDisposeOnSet||!1,this[Hie]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Wg]=t||1/0,ow(this)}get max(){return this[Wg]}set allowStale(t){this[aw]=!!t}get allowStale(){return this[aw]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Vg]=t,ow(this)}get maxAge(){return this[Vg]}set lengthCalculator(t){typeof t!="function"&&(t=B4),t!==this[X0]&&(this[X0]=t,this[Vf]=0,this[ra].forEach(n=>{n.length=this[X0](n.value,n.key),this[Vf]+=n.length})),ow(this)}get lengthCalculator(){return this[X0]}get length(){return this[Vf]}get itemCount(){return this[ra].length}rforEach(t,n){n=n||this;for(let r=this[ra].tail;r!==null;){const i=r.prev;Gie(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[ra].head;r!==null;){const i=r.next;Gie(this,t,r,n),r=i}}keys(){return this[ra].toArray().map(t=>t.key)}values(){return this[ra].toArray().map(t=>t.value)}reset(){this[qf]&&this[ra]&&this[ra].length&&this[ra].forEach(t=>this[qf](t.key,t.value)),this[fl]=new Map,this[ra]=new lKe,this[Vf]=0}dump(){return this[ra].map(t=>Pk(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[ra]}set(t,n,r){if(r=r||this[Vg],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,a=this[X0](n,t);if(this[fl].has(t)){if(a>this[Wg])return Y0(this,this[fl].get(t)),!1;const u=this[fl].get(t).value;return this[qf]&&(this[qie]||this[qf](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[Vf]+=a-u.length,u.length=a,this.get(t),ow(this),!0}const o=new fKe(t,n,a,i,r);return o.length>this[Wg]?(this[qf]&&this[qf](t,n),!1):(this[Vf]+=o.length,this[ra].unshift(o),this[fl].set(t,this[ra].head),ow(this),!0)}has(t){if(!this[fl].has(t))return!1;const n=this[fl].get(t).value;return!Pk(this,n)}get(t){return z4(this,t,!0)}peek(t){return z4(this,t,!1)}pop(){const t=this[ra].tail;return t?(Y0(this,t),t.value):null}del(t){Y0(this,this[fl].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-n;o>0&&this.set(i.k,i.v,o)}}}prune(){this[fl].forEach((t,n)=>z4(this,n,!1))}}const z4=(e,t,n)=>{const r=e[fl].get(t);if(r){const i=r.value;if(Pk(e,i)){if(Y0(e,r),!e[aw])return}else n&&(e[Hie]&&(r.value.now=Date.now()),e[ra].unshiftNode(r));return i.value}},Pk=(e,t)=>{if(!t||!t.maxAge&&!e[Vg])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Vg]&&n>e[Vg]},ow=e=>{if(e[Vf]>e[Wg])for(let t=e[ra].tail;e[Vf]>e[Wg]&&t!==null;){const n=t.prev;Y0(e,t),t=n}},Y0=(e,t)=>{if(t){const n=t.value;e[qf]&&e[qf](n.key,n.value),e[Vf]-=n.length,e[fl].delete(n.key),e[ra].removeNode(t)}};class fKe{constructor(t,n,r,i,a){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=a||0}}const Gie=(e,t,n,r)=>{let i=n.value;Pk(e,i)&&(Y0(e,n),e[aw]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var dKe=cKe;class sw{constructor(t,n){if(n=pKe(n),t instanceof sw)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new sw(t.raw,n);if(t instanceof j4)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!Xie(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&bKe(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=Kie.get(r);if(i)return i;const a=this.options.loose,o=a?Pa[wa.HYPHENRANGELOOSE]:Pa[wa.HYPHENRANGE];t=t.replace(o,OKe(this.options.includePrerelease)),gi("hyphen replace",t),t=t.replace(Pa[wa.COMPARATORTRIM],mKe),gi("comparator trim",t,Pa[wa.COMPARATORTRIM]),t=t.replace(Pa[wa.TILDETRIM],vKe),t=t.replace(Pa[wa.CARETTRIM],yKe),t=t.split(/\s+/).join(" ");const s=a?Pa[wa.COMPARATORLOOSE]:Pa[wa.COMPARATOR],u=t.split(" ").map(f=>xKe(f,this.options)).join(" ").split(/\s+/).map(f=>TKe(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new j4(f,this.options));u.length;const l=new Map;for(const f of u){if(Xie(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return Kie.set(r,c),c}intersects(t,n){if(!(t instanceof sw))throw new TypeError("a Range is required");return this.set.some(r=>Yie(r,n)&&t.set.some(i=>Yie(i,n)&&r.every(a=>i.every(o=>a.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new gKe(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(IKe(this.set[n],t,this.options))return!0;return!1}}var dl=sw;const hKe=dKe,Kie=new hKe({max:1e3}),pKe=Ik,j4=Lk,gi=Ok,gKe=mo,{re:Pa,t:wa,comparatorTrimReplace:mKe,tildeTrimReplace:vKe,caretTrimReplace:yKe}=Sh.exports,Xie=e=>e.value==="<0.0.0-0",bKe=e=>e.value==="",Yie=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(a=>i.intersects(a,t)),i=r.pop();return n},xKe=(e,t)=>(gi("comp",e,t),e=SKe(e,t),gi("caret",e),e=wKe(e,t),gi("tildes",e),e=CKe(e,t),gi("xrange",e),e=kKe(e,t),gi("stars",e),e),vo=e=>!e||e.toLowerCase()==="x"||e==="*",wKe=(e,t)=>e.trim().split(/\s+/).map(n=>_Ke(n,t)).join(" "),_Ke=(e,t)=>{const n=t.loose?Pa[wa.TILDELOOSE]:Pa[wa.TILDE];return e.replace(n,(r,i,a,o,s)=>{gi("tilde",e,r,i,a,o,s);let u;return vo(i)?u="":vo(a)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:vo(o)?u=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:s?(gi("replaceTilde pr",s),u=`>=${i}.${a}.${o}-${s} <${i}.${+a+1}.0-0`):u=`>=${i}.${a}.${o} <${i}.${+a+1}.0-0`,gi("tilde return",u),u})},SKe=(e,t)=>e.trim().split(/\s+/).map(n=>EKe(n,t)).join(" "),EKe=(e,t)=>{gi("caret",e,t);const n=t.loose?Pa[wa.CARETLOOSE]:Pa[wa.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,a,o,s,u)=>{gi("caret",e,i,a,o,s,u);let l;return vo(a)?l="":vo(o)?l=`>=${a}.0.0${r} <${+a+1}.0.0-0`:vo(s)?a==="0"?l=`>=${a}.${o}.0${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.0${r} <${+a+1}.0.0-0`:u?(gi("replaceCaret pr",u),a==="0"?o==="0"?l=`>=${a}.${o}.${s}-${u} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}-${u} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s}-${u} <${+a+1}.0.0-0`):(gi("no pr"),a==="0"?o==="0"?l=`>=${a}.${o}.${s}${r} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s} <${+a+1}.0.0-0`),gi("caret return",l),l})},CKe=(e,t)=>(gi("replaceXRanges",e,t),e.split(/\s+/).map(n=>AKe(n,t)).join(" ")),AKe=(e,t)=>{e=e.trim();const n=t.loose?Pa[wa.XRANGELOOSE]:Pa[wa.XRANGE];return e.replace(n,(r,i,a,o,s,u)=>{gi("xRange",e,r,i,a,o,s,u);const l=vo(a),c=l||vo(o),f=c||vo(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(o=0),s=0,i===">"?(i=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):i==="<="&&(i="<",c?a=+a+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:f&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),gi("xRange return",r),r})},kKe=(e,t)=>(gi("replaceStars",e,t),e.trim().replace(Pa[wa.STAR],"")),TKe=(e,t)=>(gi("replaceGTE0",e,t),e.trim().replace(Pa[t.includePrerelease?wa.GTE0PRE:wa.GTE0],"")),OKe=e=>(t,n,r,i,a,o,s,u,l,c,f,d,h)=>(vo(r)?n="":vo(i)?n=`>=${r}.0.0${e?"-0":""}`:vo(a)?n=`>=${r}.${i}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,vo(l)?u="":vo(c)?u=`<${+l+1}.0.0-0`:vo(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),IKe=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(gi(e[r].semver),e[r].semver!==j4.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},uw=Symbol("SemVer ANY");class $k{static get ANY(){return uw}constructor(t,n){if(n=NKe(n),t instanceof $k){if(t.loose===!!n.loose)return t;t=t.value}W4("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===uw?this.value="":this.value=this.operator+this.semver.version,W4("comp",this)}parse(t){const n=this.options.loose?Zie[Jie.COMPARATORLOOSE]:Zie[Jie.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Qie(r[2],this.options.loose):this.semver=uw}toString(){return this.value}test(t){if(W4("Comparator.test",t,this.options.loose),this.semver===uw||t===uw)return!0;if(typeof t=="string")try{t=new Qie(t,this.options)}catch(n){return!1}return U4(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof $k))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new eae(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new eae(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),a=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=U4(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=U4(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||s||u}}var Lk=$k;const NKe=Ik,{re:Zie,t:Jie}=Sh.exports,U4=Vie,W4=Ok,Qie=mo,eae=dl,DKe=dl,RKe=(e,t,n)=>{try{t=new DKe(t,n)}catch(r){return!1}return t.test(e)};var Bk=RKe;const FKe=dl,MKe=(e,t)=>new FKe(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var PKe=MKe;const $Ke=mo,LKe=dl,BKe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new LKe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new $Ke(r,n))}),r};var zKe=BKe;const jKe=mo,UKe=dl,WKe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new UKe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new jKe(r,n))}),r};var VKe=WKe;const V4=mo,qKe=dl,tae=Rk,HKe=(e,t)=>{e=new qKe(e,t);let n=new V4("0.0.0");if(e.test(n)||(n=new V4("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let a=null;i.forEach(o=>{const s=new V4(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||tae(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!n||tae(n,a))&&(n=a)}return n&&e.test(n)?n:null};var GKe=HKe;const KKe=dl,XKe=(e,t)=>{try{return new KKe(e,t).range||"*"}catch(n){return null}};var YKe=XKe;const ZKe=mo,nae=Lk,{ANY:JKe}=nae,QKe=dl,eXe=Bk,rae=Rk,iae=P4,tXe=L4,nXe=$4,rXe=(e,t,n,r)=>{e=new ZKe(e,r),t=new QKe(t,r);let i,a,o,s,u;switch(n){case">":i=rae,a=tXe,o=iae,s=">",u=">=";break;case"<":i=iae,a=nXe,o=rae,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(eXe(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===JKe&&(h=new nae(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:o(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var q4=rXe;const iXe=q4,aXe=(e,t,n)=>iXe(e,t,">",n);var oXe=aXe;const sXe=q4,uXe=(e,t,n)=>sXe(e,t,"<",n);var lXe=uXe;const aae=dl,cXe=(e,t,n)=>(e=new aae(e,n),t=new aae(t,n),e.intersects(t));var fXe=cXe;const dXe=Bk,hXe=cl;var pXe=(e,t,n)=>{const r=[];let i=null,a=null;const o=e.sort((c,f)=>hXe(c,f,n));for(const c of o)dXe(c,t,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const oae=dl,zk=Lk,{ANY:H4}=zk,lw=Bk,G4=cl,gXe=(e,t,n={})=>{if(e===t)return!0;e=new oae(e,n),t=new oae(t,n);let r=!1;e:for(const i of e.set){for(const a of t.set){const o=mXe(i,a,n);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},mXe=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===H4){if(t.length===1&&t[0].semver===H4)return!0;n.includePrerelease?e=[new zk(">=0.0.0-0")]:e=[new zk(">=0.0.0")]}if(t.length===1&&t[0].semver===H4){if(n.includePrerelease)return!0;t=[new zk(">=0.0.0")]}const r=new Set;let i,a;for(const h of e)h.operator===">"||h.operator===">="?i=sae(i,h,n):h.operator==="<"||h.operator==="<="?a=uae(a,h,n):r.add(h.semver);if(r.size>1)return null;let o;if(i&&a){if(o=G4(i.semver,a.semver,n),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!lw(h,String(i),n)||a&&!lw(h,String(a),n))return null;for(const p of t)if(!lw(h,String(p),n))return!1;return!0}let s,u,l,c,f=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=sae(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!lw(i.semver,String(h),n))return!1}if(a){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=uae(a,h,n),u===h&&u!==a)return!1}else if(a.operator==="<="&&!lw(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&o!==0)return!1}return!(i&&l&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},sae=(e,t,n)=>{if(!e)return t;const r=G4(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},uae=(e,t,n)=>{if(!e)return t;const r=G4(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var vXe=gXe;const K4=Sh.exports;var lae={re:K4.re,src:K4.src,tokens:K4.t,SEMVER_SPEC_VERSION:Tk.SEMVER_SPEC_VERSION,SemVer:mo,compareIdentifiers:R4.compareIdentifiers,rcompareIdentifiers:R4.rcompareIdentifiers,parse:K0,valid:QHe,clean:nGe,inc:aGe,diff:fGe,major:pGe,minor:vGe,patch:xGe,prerelease:SGe,compare:cl,rcompare:AGe,compareLoose:OGe,compareBuild:M4,sort:RGe,rsort:PGe,gt:Rk,lt:P4,eq:F4,neq:Wie,gte:$4,lte:L4,cmp:Vie,coerce:rKe,Comparator:Lk,Range:dl,satisfies:Bk,toComparators:PKe,maxSatisfying:zKe,minSatisfying:VKe,minVersion:GKe,validRange:YKe,outside:q4,gtr:oXe,ltr:lXe,intersects:fXe,simplifyRange:pXe,subset:vXe};function Ko(e,t,n){return e.fields=t||[],e.fname=n,e}function ri(e){return e==null?null:e.fname}function $a(e){return e==null?null:e.fields}function cae(e){return e.length===1?yXe(e[0]):bXe(e)}const yXe=e=>function(t){return t[e]},bXe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Ie(e){throw Error(e)}function jk(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||Ie("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&Ie("Access path missing closing bracket: "+e),r&&Ie("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function Xo(e,t,n){const r=jk(e);return e=r.length===1?r[0]:e,Ko((n&&n.get||cae)(r),[e],t||e)}const cw=Xo("id"),yo=Ko(e=>e,[],"identity"),Eh=Ko(()=>0,[],"zero"),Z0=Ko(()=>1,[],"one"),hu=Ko(()=>!0,[],"true"),Ch=Ko(()=>!1,[],"false");function Uk(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const fae=0,X4=1,dae=2,hae=3,pae=4;function gae(e,t){let n=e||fae;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=X4&&Uk(t||"error","ERROR",arguments),this},warn(){return n>=dae&&Uk(t||"warn","WARN",arguments),this},info(){return n>=hae&&Uk(t||"log","INFO",arguments),this},debug(){return n>=pae&&Uk(t||"log","DEBUG",arguments),this}}}var bt=Array.isArray;function Xt(e){return e===Object(e)}const mae=e=>e!=="__proto__";function Wk(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=xXe(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;Vk(t,r,n[r],i)}return t},{})}function Vk(e,t,n,r){if(!mae(t))return;let i,a;if(Xt(n)&&!bt(n)){a=Xt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Vk(a,i,n[i]):mae(i)&&(a[i]=n[i])}else e[t]=n}function xXe(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function An(e){return e[e.length-1]}function La(e){return e==null||e===""?null:+e}const vae=e=>t=>e*Math.exp(t),yae=e=>t=>Math.log(e*t),bae=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),xae=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,qk=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Hk(e,t,n,r){const i=n(e[0]),a=n(An(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function wae(e,t){return Hk(e,t,La,yo)}function _ae(e,t){var n=Math.sign(e[0]);return Hk(e,t,yae(n),vae(n))}function Sae(e,t,n){return Hk(e,t,qk(n),qk(1/n))}function Eae(e,t,n){return Hk(e,t,bae(n),xae(n))}function Gk(e,t,n,r,i){const a=r(e[0]),o=r(An(e)),s=t!=null?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Y4(e,t,n){return Gk(e,t,n,La,yo)}function Z4(e,t,n){const r=Math.sign(e[0]);return Gk(e,t,n,yae(r),vae(r))}function Kk(e,t,n,r){return Gk(e,t,n,qk(r),qk(1/r))}function J4(e,t,n,r){return Gk(e,t,n,bae(r),xae(r))}function Cae(e){return 1+~~(new Date(e).getMonth()/3)}function Aae(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Dt(e){return e!=null?bt(e)?e:[e]:[]}function kae(e,t,n){let r=e[0],i=e[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function nn(e){return typeof e=="function"}const wXe="descending";function Q4(e,t,n){n=n||{},t=Dt(t)||[];const r=[],i=[],a={},o=n.comparator||_Xe;return Dt(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===wXe?-1:1),i.push(s=nn(s)?s:Xo(s,null,n)),($a(s)||[]).forEach(l=>a[l]=1))}),i.length===0?null:Ko(o(i,r),Object.keys(a))}const Xk=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),_Xe=(e,t)=>e.length===1?SXe(e[0],t[0]):EXe(e,t,e.length),SXe=(e,t)=>function(n,r){return Xk(e(n),e(r))*t},EXe=(e,t,n)=>(t.push(0),function(r,i){let a,o=0,s=-1;for(;o===0&&++s<n;)a=e[s],o=Xk(a(r),a(i));return o*t[s]});function Ba(e){return nn(e)?e:()=>e}function eB(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Zt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function xc(e,t){let n=0,r,i,a,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(a=o=i;n<r;++n)i=e[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(a=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Tae(e,t){const n=e.length;let r=-1,i,a,o,s,u;if(t==null){for(;++r<n;)if(a=e[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=e[r],a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}else{for(;++r<n;)if(a=t(e[r],r,e),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=t(e[r],r,e),a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}return[s,u]}const CXe=Object.prototype.hasOwnProperty;function Rt(e,t){return CXe.call(e,t)}const Yk={};function J0(e){let t={},n;function r(a){return Rt(t,a)&&t[a]!==Yk}const i={size:0,empty:0,object:t,has:r,get(a){return r(a)?t[a]:void 0},set(a,o){return r(a)||(++i.size,t[a]===Yk&&--i.empty),t[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,t[a]=Yk),this},clear(){i.size=i.empty=0,i.object=t={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const s in t){const u=t[s];u!==Yk&&(!n||!n(u))&&(a[s]=u,++o)}i.size=o,i.empty=0,i.object=t=a}};return e&&Object.keys(e).forEach(a=>{i.set(a,e[a])}),i}function Oae(e,t,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let s=e[0],u=An(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:a}function Ge(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Zt(r,n)}function Q0(e,t,n,r){let i=t[0],a=t[t.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=a:e<a)}function tB(e){return typeof e=="boolean"}function Ah(e){return Object.prototype.toString.call(e)==="[object Date]"}function Iae(e){return e&&nn(e[Symbol.iterator])}function kh(e){return typeof e=="number"}function Nae(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function lr(e){return typeof e=="string"}function nB(e,t,n){e&&(e=t?Dt(e).map(s=>s.replace(/\\(.)/g,"$1")):Dt(e));const r=e&&e.length,i=n&&n.get||cae,a=s=>i(t?[s]:jk(s));let o;if(!r)o=function(){return""};else if(r===1){const s=a(e[0]);o=function(u){return""+s(u)}}else{const s=e.map(a);o=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return Ko(o,e,"key")}function Dae(e,t){const n=e[0],r=An(e),i=+t;return i?i===1?r:n+i*(r-n):n}const AXe=1e4;function Rae(e){e=+e||AXe;let t,n,r;const i=()=>{t={},n={},r=0},a=(o,s)=>(++r>e&&(n=t,t={},r=1),t[o]=s);return i(),{clear:i,has:o=>Rt(t,o)||Rt(n,o),get:o=>Rt(t,o)?t[o]:Rt(n,o)?a(o,n[o]):void 0,set:(o,s)=>Rt(t,o)?t[o]=s:a(o,s)}}function Fae(e,t,n,r){const i=t.length,a=n.length;if(!a)return t;if(!i)return n;const o=r||new t.constructor(i+a);let s=0,u=0,l=0;for(;s<i&&u<a;++l)o[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)o[l]=t[s];for(;u<a;++u,++l)o[l]=n[u];return o}function fw(e,t){let n="";for(;--t>=0;)n+=e;return n}function Mae(e,t,n,r){const i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?fw(i,o)+a:r==="center"?fw(i,~~(o/2))+a+fw(i,Math.ceil(o/2)):a+fw(i,o)}function dw(e){return e&&An(e)-e[0]||0}function At(e){return bt(e)?"["+e.map(At)+"]":Xt(e)||lr(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function rB(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const kXe=e=>kh(e)||Ah(e)?e:Date.parse(e);function iB(e,t){return t=t||kXe,e==null||e===""?null:t(e)}function aB(e){return e==null||e===""?null:e+""}function hl(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Pae(e,t,n,r){const i=r??"\u2026",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-s):n==="center"?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function Th(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const a=t(e[i]);a&&n(a,i,e)}}else e.forEach(n)}const TXe=/^([A-Za-z]+:)?\/\//,OXe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,IXe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,$ae="file://";function NXe(e,t){return n=>({options:n||{},sanitize:RXe,load:DXe,fileAccess:!!t,file:FXe(t),http:PXe(e)})}async function DXe(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function RXe(e,t){t=Zt({},this.options,t);const n=this.fileAccess,r={href:null};let i,a,o;const s=OXe.test(e.replace(IXe,""));(e==null||typeof e!="string"||!s)&&Ie("Sanitize failure, invalid URI: "+At(e));const u=TXe.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&o[o.length-1]!=="/"&&(e="/"+e),e=o+e),a=(i=e.startsWith($ae))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice($ae.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!a}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function FXe(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,a)=>{i?r(i):n(a)})}):MXe}async function MXe(){Ie("No file system access.")}function PXe(e){return e?async function(t,n){const r=Zt({},this.options.http,n),i=n&&n.response,a=await e(t,r);return a.ok?nn(a[i])?a[i]():a.text():Ie(a.status+""+a.statusText)}:$Xe}async function $Xe(){Ie("No HTTP fetch method available.")}const LXe=e=>e!=null&&e===e,BXe=e=>e==="true"||e==="false"||e===!0||e===!1,zXe=e=>!Number.isNaN(Date.parse(e)),Lae=e=>!Number.isNaN(+e)&&!(e instanceof Date),jXe=e=>Lae(e)&&Number.isInteger(+e),oB={boolean:rB,integer:La,number:La,date:iB,string:aB,unknown:yo},Zk=[BXe,jXe,Lae,zXe],UXe=["boolean","integer","number","date"];function Bae(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=Zk.length,i=Zk.map((a,o)=>o+1);for(let a=0,o=0,s,u;a<n;++a)for(u=t?e[a][t]:e[a],s=0;s<r;++s)if(i[s]&&LXe(u)&&!Zk[s](u)&&(i[s]=0,++o,o===Zk.length))return"string";return UXe[i.reduce((a,o)=>a===0?o:a,0)-1]}function zae(e,t){return t.reduce((n,r)=>(n[r]=Bae(e,r),n),{})}var jae={},sB={},uB=34,hw=10,lB=13;function Uae(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function WXe(e,t){var n=Uae(e);return function(r,i){return t(n(r),i,e)}}function Wae(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Yo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function VXe(e){return e<0?"-"+Yo(-e,6):e>9999?"+"+Yo(e,6):Yo(e,4)}function qXe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":VXe(e.getUTCFullYear())+"-"+Yo(e.getUTCMonth()+1,2)+"-"+Yo(e.getUTCDate(),2)+(i?"T"+Yo(t,2)+":"+Yo(n,2)+":"+Yo(r,2)+"."+Yo(i,3)+"Z":r?"T"+Yo(t,2)+":"+Yo(n,2)+":"+Yo(r,2)+"Z":n||t?"T"+Yo(t,2)+":"+Yo(n,2)+"Z":"")}function HXe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?WXe(m,d):Uae(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===hw&&--p,f.charCodeAt(p-1)===lB&&--p;function x(){if(y)return sB;if(b)return b=!1,jae;var S,C=g,_;if(f.charCodeAt(C)===uB){for(;g++<p&&f.charCodeAt(g)!==uB||f.charCodeAt(++g)===uB;);return(S=g)>=p?y=!0:(_=f.charCodeAt(g++))===hw?b=!0:_===lB&&(b=!0,f.charCodeAt(g)===hw&&++g),f.slice(C+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===hw)b=!0;else if(_===lB)b=!0,f.charCodeAt(g)===hw&&++g;else if(_!==n)continue;return f.slice(C,S)}return y=!0,f.slice(C,p)}for(;(v=x())!==sB;){for(var w=[];v!==jae&&v!==sB;)w.push(v),v=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function a(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=Wae(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=Wae(f)),a(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?qXe(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function Vae(e){const t=function(n,r){const i={delimiter:e};return cB(n,r?Zt(r,i):i)};return t.responseType="text",t}function cB(e,t){return t.header&&(e=t.header.map(At).join(t.delimiter)+`
`+e),HXe(t.delimiter).parse(e+"")}cB.responseType="text";function GXe(e){return typeof Buffer=="function"&&nn(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function fB(e,t){const n=t&&t.property?Xo(t.property):yo;return Xt(e)&&!GXe(e)?KXe(n(e),t):n(JSON.parse(e))}fB.responseType="json";function KXe(e,t){return!bt(e)&&Iae(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function XXe(e){return e}function YXe(e){if(e==null)return XXe;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+a,f[1]=(n+=s[1])*i+o;l<c;)f[l]=s[l],++l;return f}}function ZXe(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function JXe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return qae(e,n)})}:qae(e,t)}function qae(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=Hae(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function Hae(e,t){var n=YXe(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&ZXe(f,p)}function a(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function QXe(e,t){var n={},r={},i={},a=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),a.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function eYe(e){return Hae(e,tYe.apply(this,arguments))}function tYe(e,t,n){var r,i,a;if(arguments.length>1)r=nYe(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:QXe(e,r)}}function nYe(e,t,n){var r=[],i=[],a;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:a})}function s(f){f.forEach(o)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(a=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}const rYe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Gae(e,t){let n,r,i,a;return e=fB(e,t),t&&t.feature?(n=JXe,i=t.feature):t&&t.mesh?(n=eYe,i=t.mesh,a=rYe[t.filter]):Ie("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,a):Ie("Invalid TopoJSON object: "+i),r&&r.features||[r]}Gae.responseType="json";const Jk={dsv:cB,csv:Vae(","),tsv:Vae("	"),json:fB,topojson:Gae};function dB(e,t){return arguments.length>1?(Jk[e]=t,this):Rt(Jk,e)?Jk[e]:null}function Kae(e){const t=dB(e);return t&&t.responseType||"text"}function ey(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function pw(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=iYe(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function iYe(e){return(t,n)=>ey(e(t),n)}function Xae(e){return e===null?NaN:+e}function*aYe(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const Yae=pw(ey),Qk=Yae.right,oYe=Yae.left;pw(Xae).center;var gw=Qk;function sYe(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function uYe(e,t){const n=sYe(e,t);return n&&Math.sqrt(n)}class bo{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function lYe(e,t){return Array.from(t,n=>e[n])}var hB=Math.sqrt(50),pB=Math.sqrt(10),gB=Math.sqrt(2);function mB(e,t,n){var r,i=-1,a,o,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(s=Zae(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)/s}return r&&o.reverse(),o}function Zae(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=hB?10:a>=pB?5:a>=gB?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=hB?10:a>=pB?5:a>=gB?2:1)}function Oh(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=hB?i*=10:a>=pB?i*=5:a>=gB&&(i*=2),t<e?-i:i}function qg(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function vB(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Jae(e,t,n=0,r=e.length-1,i=ey){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));Jae(e,t,h,p,i)}const a=e[t];let o=n,s=r;for(mw(e,n,t),i(e[r],a)>0&&mw(e,n,r);o<s;){for(mw(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?mw(e,n,s):(++s,mw(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function mw(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function yB(e,t,n){if(e=Float64Array.from(aYe(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return vB(e);if(t>=1)return qg(e);var r,i=(r-1)*t,a=Math.floor(i),o=qg(Jae(e,a).subarray(0,a+1)),s=vB(e.subarray(a+1));return o+(s-o)*(i-a)}}function Qae(e,t,n=Xae){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function cYe(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function eoe(e,t){return yB(e,.5,t)}function*fYe(e){for(const t of e)yield*t}function toe(e){return Array.from(fYe(e))}function Ps(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function noe(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function dYe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function eT(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ty(e){return e=eT(Math.abs(e)),e?e[1]:NaN}function hYe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function pYe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var gYe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vw(e){if(!(t=gYe.exec(e)))throw new Error("invalid format: "+e);var t;return new bB({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}vw.prototype=bB.prototype;function bB(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}bB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function mYe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var roe;function vYe(e,t){var n=eT(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(roe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+eT(e,Math.max(0,t+a-1))[0]}function ioe(e,t){var n=eT(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var aoe={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dYe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ioe(e*100,t),r:ioe,s:vYe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ooe(e){return e}var soe=Array.prototype.map,uoe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function loe(e){var t=e.grouping===void 0||e.thousands===void 0?ooe:hYe(soe.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?ooe:pYe(soe.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=vw(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):aoe[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=g==="$"?r:/[%p]/.test(w)?o:"",_=aoe[w],E=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function A(k){var T=S,I=C,N,O,D;if(w==="c")I=_(k)+I,k="";else{k=+k;var P=k<0||1/k<0;if(k=isNaN(k)?u:_(Math.abs(k),b),x&&(k=mYe(k)),P&&+k==0&&p!=="+"&&(P=!1),T=(P?p==="("?p:s:p==="-"||p==="("?"":p)+T,I=(w==="s"?uoe[8+roe/3]:"")+I+(P&&p==="("?")":""),E){for(N=-1,O=k.length;++N<O;)if(D=k.charCodeAt(N),48>D||D>57){I=(D===46?i+k.slice(N+1):k.slice(N))+I,k=k.slice(0,N);break}}}y&&!m&&(k=t(k,1/0));var V=T.length+k.length+I.length,Y=V<v?new Array(v-V+1).join(d):"";switch(y&&m&&(k=t(Y+k,Y.length?v-I.length:1/0),Y=""),h){case"<":k=T+k+I+Y;break;case"=":k=T+Y+k+I;break;case"^":k=Y.slice(0,V=Y.length>>1)+T+k+I+Y.slice(V);break;default:k=Y+T+k+I;break}return a(k)}return A.toString=function(){return f+""},A}function c(f,d){var h=l((f=vw(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(ty(d)/3)))*3,g=Math.pow(10,-p),m=uoe[8+p/3];return function(v){return h(g*v)+m}}return{format:l,formatPrefix:c}}var tT,coe,foe;yYe({thousands:",",grouping:[3],currency:["$",""]});function yYe(e){return tT=loe(e),coe=tT.format,foe=tT.formatPrefix,tT}function bYe(e){return Math.max(0,-ty(Math.abs(e)))}function xYe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ty(t)/3)))*3-ty(Math.abs(e)))}function wYe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ty(t)-ty(e))+1}var xB=new Date,wB=new Date;function ia(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return ia(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},n&&(i.count=function(a,o){return xB.setTime(+a),wB.setTime(+o),e(xB),e(wB),Math.floor(n(xB,wB))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a==0}:function(o){return i.count(0,o)%a==0}):i}),i}var _B=ia(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});_B.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ia(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):_B};var SB=_B;const Hf=1e3,pu=Hf*60,Gf=pu*60,Hg=Gf*24,EB=Hg*7,doe=Hg*30,CB=Hg*365;var _Ye=ia(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Hf)},function(e,t){return(t-e)/Hf},function(e){return e.getUTCSeconds()}),Ih=_Ye,SYe=ia(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hf)},function(e,t){e.setTime(+e+t*pu)},function(e,t){return(t-e)/pu},function(e){return e.getMinutes()}),AB=SYe,EYe=ia(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hf-e.getMinutes()*pu)},function(e,t){e.setTime(+e+t*Gf)},function(e,t){return(t-e)/Gf},function(e){return e.getHours()}),kB=EYe,CYe=ia(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*pu)/Hg,e=>e.getDate()-1),Nh=CYe;function Gg(e){return ia(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*pu)/EB})}var yw=Gg(0),TB=Gg(1);Gg(2),Gg(3);var bw=Gg(4);Gg(5),Gg(6);var AYe=ia(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),nT=AYe,hoe=ia(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});hoe.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ia(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Dh=hoe,kYe=ia(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*pu)},function(e,t){return(t-e)/pu},function(e){return e.getUTCMinutes()}),OB=kYe,TYe=ia(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Gf)},function(e,t){return(t-e)/Gf},function(e){return e.getUTCHours()}),IB=TYe,OYe=ia(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Hg},function(e){return e.getUTCDate()-1}),Rh=OYe;function Kg(e){return ia(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/EB})}var xw=Kg(0),NB=Kg(1);Kg(2),Kg(3);var ww=Kg(4);Kg(5),Kg(6);var IYe=ia(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),rT=IYe,poe=ia(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});poe.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:ia(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Fh=poe;function goe(e,t,n,r,i,a){const o=[[Ih,1,Hf],[Ih,5,5*Hf],[Ih,15,15*Hf],[Ih,30,30*Hf],[a,1,pu],[a,5,5*pu],[a,15,15*pu],[a,30,30*pu],[i,1,Gf],[i,3,3*Gf],[i,6,6*Gf],[i,12,12*Gf],[r,1,Hg],[r,2,2*Hg],[n,1,EB],[t,1,doe],[t,3,3*doe],[e,1,CB]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=pw(([,,m])=>m).right(o,d);if(h===o.length)return e.every(Oh(l/CB,c/CB,f));if(h===0)return SB.every(Math.max(Oh(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[s,u]}const[NYe,DYe]=goe(Fh,rT,xw,Rh,IB,OB),[RYe,FYe]=goe(Dh,nT,yw,Nh,kB,AB),_a="year",Zo="quarter",za="month",ji="week",Jo="date",ja="day",wc="dayofyear",$s="hours",Ls="minutes",gu="seconds",pl="milliseconds",DB=[_a,Zo,za,ji,Jo,ja,wc,$s,Ls,gu,pl],RB=DB.reduce((e,t,n)=>(e[t]=1+n,e),{});function FB(e){const t=Dt(e).slice(),n={};return t.length||Ie("Missing time unit."),t.forEach(i=>{Rt(RB,i)?n[i]=1:Ie("Invalid time unit: ".concat(i,"."))}),(n[ji]||n[ja]?1:0)+(n[Zo]||n[za]||n[Jo]?1:0)+(n[wc]?1:0)>1&&Ie("Incompatible time units: ".concat(e)),t.sort((i,a)=>RB[i]-RB[a]),t}const MYe={[_a]:"%Y ",[Zo]:"Q%q ",[za]:"%b ",[Jo]:"%d ",[ji]:"W%U ",[ja]:"%a ",[wc]:"%j ",[$s]:"%H:00",[Ls]:"00:%M",[gu]:":%S",[pl]:".%L",["".concat(_a,"-").concat(za)]:"%Y-%m ",["".concat(_a,"-").concat(za,"-").concat(Jo)]:"%Y-%m-%d ",["".concat($s,"-").concat(Ls)]:"%H:%M"};function moe(e,t){const n=Zt({},MYe,t),r=FB(e),i=r.length;let a="",o=0,s,u;for(o=0;o<i;)for(s=r.length;s>o;--s)if(u=r.slice(o,s).join("-"),n[u]!=null){a+=n[u],o=s;break}return a.trim()}const Xg=new Date;function MB(e){return Xg.setFullYear(e),Xg.setMonth(0),Xg.setDate(1),Xg.setHours(0,0,0,0),Xg}function voe(e){return boe(new Date(e))}function yoe(e){return PB(new Date(e))}function boe(e){return Nh.count(MB(e.getFullYear())-1,e)}function PB(e){return yw.count(MB(e.getFullYear())-1,e)}function $B(e){return MB(e).getDay()}function PYe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,a,o);return s.setFullYear(e),s}return new Date(e,t,n,r,i,a,o)}function xoe(e){return _oe(new Date(e))}function woe(e){return LB(new Date(e))}function _oe(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Rh.count(t-1,e)}function LB(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return xw.count(t-1,e)}function BB(e){return Xg.setTime(Date.UTC(e,0,1)),Xg.getUTCDay()}function $Ye(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,a,o));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Soe(e,t,n,r,i){const a=t||1,o=An(e),s=(v,y,b)=>(b=b||v,LYe(n[b],r[b],v===o&&a,y)),u=new Date,l=hl(e),c=l[_a]?s(_a):Ba(2012),f=l[za]?s(za):l[Zo]?s(Zo):Eh,d=l[ji]&&l[ja]?s(ja,1,ji+ja):l[ji]?s(ji,1):l[ja]?s(ja,1):l[Jo]?s(Jo,1):l[wc]?s(wc,1):Z0,h=l[$s]?s($s):Eh,p=l[Ls]?s(Ls):Eh,g=l[gu]?s(gu):Eh,m=l[pl]?s(pl):Eh;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function LYe(e,t,n,r){const i=n<=1?e:r?(a,o)=>r+n*Math.floor((e(a,o)-r)/n):(a,o)=>n*Math.floor(e(a,o)/n);return t?(a,o)=>t(i(a,o),o):i}function ny(e,t,n){return t+e*7-(n+6)%7}const BYe={[_a]:e=>e.getFullYear(),[Zo]:e=>Math.floor(e.getMonth()/3),[za]:e=>e.getMonth(),[Jo]:e=>e.getDate(),[$s]:e=>e.getHours(),[Ls]:e=>e.getMinutes(),[gu]:e=>e.getSeconds(),[pl]:e=>e.getMilliseconds(),[wc]:e=>boe(e),[ji]:e=>PB(e),[ji+ja]:(e,t)=>ny(PB(e),e.getDay(),$B(t)),[ja]:(e,t)=>ny(1,e.getDay(),$B(t))},zYe={[Zo]:e=>3*e,[ji]:(e,t)=>ny(e,0,$B(t))};function Eoe(e,t){return Soe(e,t||1,BYe,zYe,PYe)}const jYe={[_a]:e=>e.getUTCFullYear(),[Zo]:e=>Math.floor(e.getUTCMonth()/3),[za]:e=>e.getUTCMonth(),[Jo]:e=>e.getUTCDate(),[$s]:e=>e.getUTCHours(),[Ls]:e=>e.getUTCMinutes(),[gu]:e=>e.getUTCSeconds(),[pl]:e=>e.getUTCMilliseconds(),[wc]:e=>_oe(e),[ji]:e=>LB(e),[ja]:(e,t)=>ny(1,e.getUTCDay(),BB(t)),[ji+ja]:(e,t)=>ny(LB(e),e.getUTCDay(),BB(t))},UYe={[Zo]:e=>3*e,[ji]:(e,t)=>ny(e,0,BB(t))};function Coe(e,t){return Soe(e,t||1,jYe,UYe,$Ye)}const WYe={[_a]:Dh,[Zo]:nT.every(3),[za]:nT,[ji]:yw,[Jo]:Nh,[ja]:Nh,[wc]:Nh,[$s]:kB,[Ls]:AB,[gu]:Ih,[pl]:SB},VYe={[_a]:Fh,[Zo]:rT.every(3),[za]:rT,[ji]:xw,[Jo]:Rh,[ja]:Rh,[wc]:Rh,[$s]:IB,[Ls]:OB,[gu]:Ih,[pl]:SB};function ry(e){return WYe[e]}function iy(e){return VYe[e]}function Aoe(e,t,n){return e?e.offset(t,n):void 0}function koe(e,t,n){return Aoe(ry(e),t,n)}function Toe(e,t,n){return Aoe(iy(e),t,n)}function Ooe(e,t,n,r){return e?e.range(t,n,r):void 0}function Ioe(e,t,n,r){return Ooe(ry(e),t,n,r)}function Noe(e,t,n,r){return Ooe(iy(e),t,n,r)}const _w=1e3,Sw=_w*60,Ew=Sw*60,iT=Ew*24,qYe=iT*7,Doe=iT*30,zB=iT*365,Roe=[_a,za,Jo,$s,Ls,gu,pl],Cw=Roe.slice(0,-1),Aw=Cw.slice(0,-1),kw=Aw.slice(0,-1),HYe=kw.slice(0,-1),GYe=[_a,ji],Foe=[_a,za],Moe=[_a],Tw=[[Cw,1,_w],[Cw,5,5*_w],[Cw,15,15*_w],[Cw,30,30*_w],[Aw,1,Sw],[Aw,5,5*Sw],[Aw,15,15*Sw],[Aw,30,30*Sw],[kw,1,Ew],[kw,3,3*Ew],[kw,6,6*Ew],[kw,12,12*Ew],[HYe,1,iT],[GYe,1,qYe],[Foe,1,Doe],[Foe,3,3*Doe],[Moe,1,zB]];function Poe(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(dw(t))/n;let i=pw(s=>s[2]).right(Tw,r),a,o;return i===Tw.length?(a=Moe,o=Oh(t[0]/zB,t[1]/zB,n)):i?(i=Tw[r/Tw[i-1][2]<Tw[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=Roe,o=Math.max(Oh(t[0],t[1],n),1)),{units:a,step:o}}function jB(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function UB(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ow(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function $oe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=Iw(i),c=Nw(i),f=Iw(a),d=Nw(a),h=Iw(o),p=Nw(o),g=Iw(s),m=Nw(s),v=Iw(u),y=Nw(u),b={a:P,A:V,b:Y,B:X,c:null,d:Woe,e:Woe,f:mZe,g:AZe,G:TZe,H:hZe,I:pZe,j:gZe,L:Voe,m:vZe,M:yZe,p:Q,q:me,Q:Yoe,s:Zoe,S:bZe,u:xZe,U:wZe,V:_Ze,w:SZe,W:EZe,x:null,X:null,y:CZe,Y:kZe,Z:OZe,"%":Xoe},x={a:ce,A:Ne,b:Oe,B:$e,c:null,d:Hoe,e:Hoe,f:RZe,g:WZe,G:qZe,H:IZe,I:NZe,j:DZe,L:Goe,m:FZe,M:MZe,p:ve,q:$,Q:Yoe,s:Zoe,S:PZe,u:$Ze,U:LZe,V:BZe,w:zZe,W:jZe,x:null,X:null,y:UZe,Y:VZe,Z:HZe,"%":Xoe},w={a:A,A:k,b:T,B:I,c:N,d:joe,e:joe,f:lZe,g:zoe,G:Boe,H:Uoe,I:Uoe,j:aZe,L:uZe,m:iZe,M:oZe,p:E,q:rZe,Q:fZe,s:dZe,S:sZe,u:JYe,U:QYe,V:eZe,w:ZYe,W:tZe,x:O,X:D,y:zoe,Y:Boe,Z:nZe,"%":cZe};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(F,q){return function(ue){var J=[],L=-1,z=0,R=F.length,Z,xe,Ee;for(ue instanceof Date||(ue=new Date(+ue));++L<R;)F.charCodeAt(L)===37&&(J.push(F.slice(z,L)),(xe=Loe[Z=F.charAt(++L)])!=null?Z=F.charAt(++L):xe=Z==="e"?" ":"0",(Ee=q[Z])&&(Z=Ee(ue,xe)),J.push(Z),z=L+1);return J.push(F.slice(z,L)),J.join("")}}function C(F,q){return function(ue){var J=Ow(1900,void 0,1),L=_(J,F,ue+="",0),z,R;if(L!=ue.length)return null;if("Q"in J)return new Date(J.Q);if("s"in J)return new Date(J.s*1e3+("L"in J?J.L:0));if(q&&!("Z"in J)&&(J.Z=0),"p"in J&&(J.H=J.H%12+J.p*12),J.m===void 0&&(J.m="q"in J?J.q:0),"V"in J){if(J.V<1||J.V>53)return null;"w"in J||(J.w=1),"Z"in J?(z=UB(Ow(J.y,0,1)),R=z.getUTCDay(),z=R>4||R===0?NB.ceil(z):NB(z),z=Rh.offset(z,(J.V-1)*7),J.y=z.getUTCFullYear(),J.m=z.getUTCMonth(),J.d=z.getUTCDate()+(J.w+6)%7):(z=jB(Ow(J.y,0,1)),R=z.getDay(),z=R>4||R===0?TB.ceil(z):TB(z),z=Nh.offset(z,(J.V-1)*7),J.y=z.getFullYear(),J.m=z.getMonth(),J.d=z.getDate()+(J.w+6)%7)}else("W"in J||"U"in J)&&("w"in J||(J.w="u"in J?J.u%7:"W"in J?1:0),R="Z"in J?UB(Ow(J.y,0,1)).getUTCDay():jB(Ow(J.y,0,1)).getDay(),J.m=0,J.d="W"in J?(J.w+6)%7+J.W*7-(R+5)%7:J.w+J.U*7-(R+6)%7);return"Z"in J?(J.H+=J.Z/100|0,J.M+=J.Z%100,UB(J)):jB(J)}}function _(F,q,ue,J){for(var L=0,z=q.length,R=ue.length,Z,xe;L<z;){if(J>=R)return-1;if(Z=q.charCodeAt(L++),Z===37){if(Z=q.charAt(L++),xe=w[Z in Loe?q.charAt(L++):Z],!xe||(J=xe(F,ue,J))<0)return-1}else if(Z!=ue.charCodeAt(J++))return-1}return J}function E(F,q,ue){var J=l.exec(q.slice(ue));return J?(F.p=c.get(J[0].toLowerCase()),ue+J[0].length):-1}function A(F,q,ue){var J=h.exec(q.slice(ue));return J?(F.w=p.get(J[0].toLowerCase()),ue+J[0].length):-1}function k(F,q,ue){var J=f.exec(q.slice(ue));return J?(F.w=d.get(J[0].toLowerCase()),ue+J[0].length):-1}function T(F,q,ue){var J=v.exec(q.slice(ue));return J?(F.m=y.get(J[0].toLowerCase()),ue+J[0].length):-1}function I(F,q,ue){var J=g.exec(q.slice(ue));return J?(F.m=m.get(J[0].toLowerCase()),ue+J[0].length):-1}function N(F,q,ue){return _(F,t,q,ue)}function O(F,q,ue){return _(F,n,q,ue)}function D(F,q,ue){return _(F,r,q,ue)}function P(F){return o[F.getDay()]}function V(F){return a[F.getDay()]}function Y(F){return u[F.getMonth()]}function X(F){return s[F.getMonth()]}function Q(F){return i[+(F.getHours()>=12)]}function me(F){return 1+~~(F.getMonth()/3)}function ce(F){return o[F.getUTCDay()]}function Ne(F){return a[F.getUTCDay()]}function Oe(F){return u[F.getUTCMonth()]}function $e(F){return s[F.getUTCMonth()]}function ve(F){return i[+(F.getUTCHours()>=12)]}function $(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var q=S(F+="",b);return q.toString=function(){return F},q},parse:function(F){var q=C(F+="",!1);return q.toString=function(){return F},q},utcFormat:function(F){var q=S(F+="",x);return q.toString=function(){return F},q},utcParse:function(F){var q=C(F+="",!0);return q.toString=function(){return F},q}}}var Loe={"-":"",_:" ","0":"0"},aa=/^\s*\d+/,KYe=/^%/,XYe=/[\\^$*+?|[\]().{}]/g;function Un(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function YYe(e){return e.replace(XYe,"\\$&")}function Iw(e){return new RegExp("^(?:"+e.map(YYe).join("|")+")","i")}function Nw(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function ZYe(e,t,n){var r=aa.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function JYe(e,t,n){var r=aa.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function QYe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function eZe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function tZe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Boe(e,t,n){var r=aa.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function zoe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nZe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rZe(e,t,n){var r=aa.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function iZe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function joe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function aZe(e,t,n){var r=aa.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Uoe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function oZe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function sZe(e,t,n){var r=aa.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function uZe(e,t,n){var r=aa.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function lZe(e,t,n){var r=aa.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function cZe(e,t,n){var r=KYe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function fZe(e,t,n){var r=aa.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function dZe(e,t,n){var r=aa.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Woe(e,t){return Un(e.getDate(),t,2)}function hZe(e,t){return Un(e.getHours(),t,2)}function pZe(e,t){return Un(e.getHours()%12||12,t,2)}function gZe(e,t){return Un(1+Nh.count(Dh(e),e),t,3)}function Voe(e,t){return Un(e.getMilliseconds(),t,3)}function mZe(e,t){return Voe(e,t)+"000"}function vZe(e,t){return Un(e.getMonth()+1,t,2)}function yZe(e,t){return Un(e.getMinutes(),t,2)}function bZe(e,t){return Un(e.getSeconds(),t,2)}function xZe(e){var t=e.getDay();return t===0?7:t}function wZe(e,t){return Un(yw.count(Dh(e)-1,e),t,2)}function qoe(e){var t=e.getDay();return t>=4||t===0?bw(e):bw.ceil(e)}function _Ze(e,t){return e=qoe(e),Un(bw.count(Dh(e),e)+(Dh(e).getDay()===4),t,2)}function SZe(e){return e.getDay()}function EZe(e,t){return Un(TB.count(Dh(e)-1,e),t,2)}function CZe(e,t){return Un(e.getFullYear()%100,t,2)}function AZe(e,t){return e=qoe(e),Un(e.getFullYear()%100,t,2)}function kZe(e,t){return Un(e.getFullYear()%1e4,t,4)}function TZe(e,t){var n=e.getDay();return e=n>=4||n===0?bw(e):bw.ceil(e),Un(e.getFullYear()%1e4,t,4)}function OZe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Un(t/60|0,"0",2)+Un(t%60,"0",2)}function Hoe(e,t){return Un(e.getUTCDate(),t,2)}function IZe(e,t){return Un(e.getUTCHours(),t,2)}function NZe(e,t){return Un(e.getUTCHours()%12||12,t,2)}function DZe(e,t){return Un(1+Rh.count(Fh(e),e),t,3)}function Goe(e,t){return Un(e.getUTCMilliseconds(),t,3)}function RZe(e,t){return Goe(e,t)+"000"}function FZe(e,t){return Un(e.getUTCMonth()+1,t,2)}function MZe(e,t){return Un(e.getUTCMinutes(),t,2)}function PZe(e,t){return Un(e.getUTCSeconds(),t,2)}function $Ze(e){var t=e.getUTCDay();return t===0?7:t}function LZe(e,t){return Un(xw.count(Fh(e)-1,e),t,2)}function Koe(e){var t=e.getUTCDay();return t>=4||t===0?ww(e):ww.ceil(e)}function BZe(e,t){return e=Koe(e),Un(ww.count(Fh(e),e)+(Fh(e).getUTCDay()===4),t,2)}function zZe(e){return e.getUTCDay()}function jZe(e,t){return Un(NB.count(Fh(e)-1,e),t,2)}function UZe(e,t){return Un(e.getUTCFullYear()%100,t,2)}function WZe(e,t){return e=Koe(e),Un(e.getUTCFullYear()%100,t,2)}function VZe(e,t){return Un(e.getUTCFullYear()%1e4,t,4)}function qZe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ww(e):ww.ceil(e),Un(e.getUTCFullYear()%1e4,t,4)}function HZe(){return"+0000"}function Xoe(){return"%"}function Yoe(e){return+e}function Zoe(e){return Math.floor(+e/1e3)}var ay,WB,Joe,VB,Qoe;GZe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function GZe(e){return ay=$oe(e),WB=ay.format,Joe=ay.parse,VB=ay.utcFormat,Qoe=ay.utcParse,ay}function Dw(e){const t={};return n=>t[n]||(t[n]=e(n))}function KZe(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let a=XZe(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function XZe(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function ese(e){const t=Dw(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=vw(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return KZe(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,a,o){o=vw(o??",f");const s=Oh(r,i,a),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=xYe(s,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=wYe(s,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=bYe(s))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let qB;tse();function tse(){return qB=ese({format:coe,formatPrefix:foe})}function nse(e){return ese(loe(e))}function aT(e){return arguments.length?qB=nse(e):qB}function rse(e,t,n){n=n||{},Xt(n)||Ie("Invalid time multi-format specifier: ".concat(n));const r=t(gu),i=t(Ls),a=t($s),o=t(Jo),s=t(ji),u=t(za),l=t(Zo),c=t(_a),f=e(n[pl]||".%L"),d=e(n[gu]||":%S"),h=e(n[Ls]||"%I:%M"),p=e(n[$s]||"%I %p"),g=e(n[Jo]||n[ja]||"%a %d"),m=e(n[ji]||"%b %d"),v=e(n[za]||"%B"),y=e(n[Zo]||"%B"),b=e(n[_a]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:a(x)<x?h:o(x)<x?p:u(x)<x?s(x)<x?g:m:c(x)<x?l(x)<x?v:y:b)(x)}function ise(e){const t=Dw(e.format),n=Dw(e.utcFormat);return{timeFormat:r=>lr(r)?t(r):rse(t,ry,r),utcFormat:r=>lr(r)?n(r):rse(n,iy,r),timeParse:Dw(e.parse),utcParse:Dw(e.utcParse)}}let HB;ase();function ase(){return HB=ise({format:WB,parse:Joe,utcFormat:VB,utcParse:Qoe})}function ose(e){return ise($oe(e))}function Rw(e){return arguments.length?HB=ose(e):HB}const GB=(e,t)=>Zt({},e,t);function sse(e,t){const n=e?nse(e):aT(),r=t?ose(t):Rw();return GB(n,r)}function KB(e,t){const n=arguments.length;return n&&n!==2&&Ie("defaultLocale expects either zero or two arguments."),n?GB(aT(e),Rw(t)):GB(aT(),Rw())}function YZe(){return tse(),ase(),KB()}function use(e,t,n,r){t=t||{};const i=dB(t.type||"json");return i||Ie("Unknown data format type: "+t.type),e=i(e,t),t.parse&&ZZe(e,t.parse,n,r),Rt(e,"columns")&&delete e.columns,e}function ZZe(e,t,n,r){if(!e.length)return;const i=Rw();n=n||i.timeParse,r=r||i.utcParse;let a=e.columns||Object.keys(e[0]),o,s,u,l,c,f;t==="auto"&&(t=zae(e,a)),a=Object.keys(t);const d=a.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!oB[p])throw Error("Illegal format pattern: "+h+":"+p);return oB[p]});for(u=0,c=e.length,f=a.length;u<c;++u)for(o=e[u],l=0;l<f;++l)s=a[l],o[s]=d[l](o[s])}const oT=NXe(typeof fetch!="undefined"&&fetch,null);function sT(e){const t=e||yo,n=[],r={};return n.add=i=>{const a=t(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=t(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function uT(e,t){try{await t(e)}catch(n){e.error(n)}}const lse=Symbol("vega_id");let JZe=1;function lT(e){return!!(e&&xt(e))}function xt(e){return e[lse]}function cse(e,t){return e[lse]=t,e}function Yn(e){const t=e===Object(e)?e:{data:e};return xt(t)?t:cse(t,JZe++)}function XB(e){return cT(e,Yn({}))}function cT(e,t){for(const n in e)t[n]=e[n];return t}function fse(e,t){return cse(t,xt(e))}function Yg(e,t){return e?t?(n,r)=>e(n,r)||xt(t(n))-xt(t(r)):(n,r)=>e(n,r)||xt(n)-xt(r):null}function dse(e){return e&&e.constructor===Zg}function Zg(){const e=[],t=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:Zg,insert(s){const u=Dt(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=nn(s)?r:t,l=Dt(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Ba(l)};return nn(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return nn(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return a=s,this},reflow(){return o=!0,this},pulse(s,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[xt(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[xt(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[xt(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=xt(g),l[m]?l[m]=1:s.add.push(Yn(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[xt(g)]<0&&s.rem.push(g);function v(y,b,x){x?y[b]=x(y):s.encode=b,o||(c[xt(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[xt(g)],m>0&&(v(g,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[xt(y)]>0&&v(y,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=t.length||r.length?u.filter(y=>l[xt(y)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(a||a==null&&(t.length||r.length))&&s.clean(!0),s}}}const fT="_:mod:_";function dT(){Object.defineProperty(this,fT,{writable:!0,value:{}})}dT.prototype={set(e,t,n,r){const i=this,a=i[e],o=i[fT];return t!=null&&t>=0?(a[t]!==n||r)&&(a[t]=n,o[t+":"+e]=-1,o[e]=-1):(a!==n||r)&&(i[e]=n,o[e]=bt(n)?1+n.length:-1),i},modified(e,t){const n=this[fT];if(arguments.length){if(bt(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[fT]={},this}};let QZe=0;const eJe="pulse",tJe=new dT,nJe=1,rJe=2;function xr(e,t,n,r){this.id=++QZe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function hse(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}xr.prototype={targets(){return this._targets||(this._targets=sT(cw))},set(e){return this.value!==e?(this.value=e,1):0},skip:hse(nJe),modified:hse(rJe),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new dT,i=this._argops=this._argops||[],a=[];let o,s,u,l;const c=(f,d,h)=>{h instanceof xr?(h!==this&&(t&&h.targets().add(this),a.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(s=e[o],o===eJe)Dt(s).forEach(f=>{f instanceof xr?f!==this&&(f.targets().add(this),a.push(f)):Ie("Pulse parameters must be operator instances.")}),this.source=s;else if(bt(s))for(r.set(o,-1,Array(u=s.length)),l=0;l<u;++l)c(o,l,s[l]);else c(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(e){const t=this._argval||tJe,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===e,t.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function iJe(e,t,n,r){let i=1,a;return e instanceof xr?a=e:e&&e.prototype instanceof xr?a=new e:nn(e)?a=new xr(null,e):(i=0,a=new xr(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function aJe(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let oJe=0;function hT(e,t,n){this.id=++oJe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Mh(e,t,n){return new hT(e,t,n)}hT.prototype={_filter:hu,_apply:yo,targets(){return this._targets||(this._targets=sT(cw))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Mh(e);return this.targets().add(t),t},apply(e){const t=Mh(null,e);return this.targets().add(t),t},merge(){const e=Mh();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Mh();return this.targets().add(Mh(null,null,eB(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Mh(null,null,()=>n=!0)),t.targets().add(Mh(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=hu,this._targets=null}};function sJe(e,t,n,r){const i=this,a=Mh(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=Dt(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,o);return a}function uJe(e,t){const n=this.locale();return use(e,t,n.timeParse,n.utcParse)}function lJe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function cJe(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:Kae(t&&t.type)});try{i=n.parse(i,t)}catch(a){r=-2,n.warn("Data ingestion failed",e,a)}}catch(a){r=-1,n.warn("Loading failed",e,a)}return{data:i,status:r}}async function fJe(e,t,n){const r=this,i=r._pending||dJe(r);i.requests+=1;const a=await r.request(t,n);return r.pulse(e,r.changeset().remove(hu).insert(a.data||[])),i.done(),a}function dJe(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const hJe={skip:!0};function pJe(e,t,n,r,i){return(e instanceof xr?mJe:gJe)(this,e,t,n,r,i),this}function gJe(e,t,n,r,i,a){const o=Zt({},a,hJe);let s,u;nn(n)||(n=Ba(n)),r===void 0?s=l=>e.touch(n(l)):nn(r)?(u=new xr(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;dse(f)?e.pulse(c,f,a):e.update(c,f,o)}):s=l=>e.update(n(l),r,o),t.apply(s)}function mJe(e,t,n,r,i,a){if(r===void 0)t.targets().add(n);else{const o=a||{},s=new xr(null,vJe(n,r),i,!1);s.modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function vJe(e,t){return t=nn(t)?t:Ba(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function yJe(e){e.rank=++this._rank}function bJe(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Ie("Cycle detected in dataflow graph.")}const pT={},_c=1<<0,Ph=1<<1,Kf=1<<2,xJe=_c|Ph,pse=_c|Kf,oy=_c|Ph|Kf,gse=1<<3,Fw=1<<4,mse=1<<5,vse=1<<6;function $h(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function YB(e,t){const n=[];return Th(e,t,r=>n.push(r)),n}function yse(e,t){const n={};return e.visit(t,r=>{n[xt(r)]=1}),r=>n[xt(r)]?null:r}function gT(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}$h.prototype={StopPropagation:pT,ADD:_c,REM:Ph,MOD:Kf,ADD_REM:xJe,ADD_MOD:pse,ALL:oy,REFLOW:gse,SOURCE:Fw,NO_SOURCE:mse,NO_FIELDS:vse,fork(e){return new $h(this.dataflow).init(this,e)},clone(){const e=this.fork(oy);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(oy|Fw)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new $h(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&vse)&&(n.fields=e.fields),t&_c?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Ph?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Kf?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&mse?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||oy;return t&_c&&this.add.length||t&Ph&&this.rem.length||t&Kf&&this.mod.length},reflow(e){if(e)return this.fork(oy).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Kf,yse(this,_c))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return bt(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?bt(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&_c&&(n.addF=gT(n.addF,t)),e&Ph&&(n.remF=gT(n.remF,t)),e&Kf&&(n.modF=gT(n.modF,t)),e&Fw&&(n.srcF=gT(n.srcF,t)),n},materialize(e){e=e||oy;const t=this;return e&_c&&t.addF&&(t.add=YB(t.add,t.addF),t.addF=null),e&Ph&&t.remF&&(t.rem=YB(t.rem,t.remF),t.remF=null),e&Kf&&t.modF&&(t.mod=YB(t.mod,t.modF),t.modF=null),e&Fw&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&Fw)return Th(n.source,n.srcF,r),n;e&_c&&Th(n.add,n.addF,r),e&Ph&&Th(n.rem,n.remF,r),e&Kf&&Th(n.mod,n.modF,r);const i=n.source;if(e&gse&&i){const a=n.add.length+n.mod.length;a===i.length||(a?Th(i,yse(n,pse),r):Th(i,n.srcF,r))}return n}};function ZB(e,t,n,r){const i=this,a=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<a;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(o|=i.ADD),u.changed(i.REM)&&(o|=i.REM),u.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}Ge(ZB,$h,{fork(e){const t=new $h(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?bt(e)?e.some(r=>n[r]):n[e]:0},filter(){Ie("MultiPulse does not support filtering.")},materialize(){Ie("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n}});async function wJe(e,t,n){const r=this,i=[];if(r._pulse)return bse(r);if(r._pending&&await r._pending,t&&await uT(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new $h(r,a,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=sT(cw);let o=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=pT),u!==pT&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await uT(r,c[f].callback)}return n&&await uT(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function _Je(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function SJe(e,t,n){return this._pulse?bse(this):(this.evaluate(e,t,n),this)}function EJe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function bse(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function CJe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function AJe(e,t){const n=e.source,r=this._clock;return n&&bt(n)?new ZB(this,r,n.map(i=>i.pulse),t):this._input[e.id]||kJe(this._pulse,n&&n.pulse)}function kJe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==pT&&(e.source=t.source),e)}const JB={skip:!1,force:!1};function TJe(e,t){const n=t||JB;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function OJe(e,t,n){const r=n||JB;return(e.set(t)||r.force)&&this.touch(e,r),this}function IJe(e,t,n){this.touch(e,n||JB);const r=new $h(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function NJe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),xse(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,DJe(t,0,e)):r=n,r}}}function xse(e,t,n,r){let i,a;const o=e[n];for(;n>t;){if(a=n-1>>1,i=e[a],r(o,i)<0){e[n]=i,n=a;continue}break}return e[n]=o}function DJe(e,t,n){const r=t,i=e.length,a=e[t];let o=(t<<1)+1,s;for(;o<i;)s=o+1,s<i&&n(e[o],e[s])>=0&&(o=s),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=a,xse(e,r,t,n)}function sy(){this.logger(gae()),this.logLevel(X4),this._clock=0,this._rank=0,this._locale=KB();try{this._loader=oT()}catch(e){}this._touched=sT(cw),this._input={},this._pulse=null,this._heap=NJe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Mw(e){return function(){return this._log[e].apply(this,arguments)}}sy.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Mw("error"),warn:Mw("warn"),info:Mw("info"),debug:Mw("debug"),logLevel:Mw("level"),cleanThreshold:1e4,add:iJe,connect:aJe,rank:yJe,rerank:bJe,pulse:IJe,touch:TJe,update:OJe,changeset:Zg,ingest:lJe,parse:uJe,preload:fJe,request:cJe,events:sJe,on:pJe,evaluate:wJe,run:SJe,runAsync:_Je,runAfter:EJe,_enqueue:CJe,_getPulse:AJe};function _e(e,t){xr.call(this,e,null,t)}Ge(_e,xr,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const uy={};function wse(e){const t=_se(e);return t&&t.Definition||null}function _se(e){return e=e&&e.toLowerCase(),Rt(uy,e)?uy[e]:null}function*Sse(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function QB(e,t,n){const r=Float64Array.from(Sse(e,n));return r.sort(ey),t.map(i=>Qae(r,i))}function ez(e,t){return QB(e,[.25,.5,.75],t)}function tz(e,t){const n=e.length,r=uYe(e,t),i=ez(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function Ese(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,u,l,c,f,d;const h=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(a/s+g)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}var mu=Math.random;function RJe(e){mu=e}function Cse(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Sse(e,r)),a=i.length,o=t;let s,u,l,c;for(l=0,c=Array(o);l<o;++l){for(s=0,u=0;u<a;++u)s+=i[~~(mu()*a)];c[l]=s/a}return c.sort(ey),[yB(c,n/2),yB(c,1-n/2)]}function Ase(e,t,n,r){r=r||(d=>d);const i=e.length,a=new Float64Array(i);let o=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;o<s;++o)a[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<s;++o)a[o]=l;return n?FJe(a,t+t/4):a}function FJe(e,t){const n=e.length;let r=0,i=1,a,o;for(;e[r]===e[i];)++i;for(;i<n;){for(a=i+1;e[i]===e[a];)++a;if(e[i]-e[i-1]<t){for(o=i+(r+a-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=a}return e}function MJe(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function PJe(e,t){t==null&&(t=e,e=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*mu())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const s=Math.floor(o);return s<n?0:s>=r?1:(s-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(e).max(t)}const kse=Math.sqrt(2*Math.PI),$Je=Math.SQRT2;let Pw=NaN;function mT(e,t){e=e||0,t=t??1;let n=0,r=0,i,a;if(Pw===Pw)n=Pw,Pw=NaN;else{do n=mu()*2-1,r=mu()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,Pw=r*a}return e+n*t}function nz(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*kse)}function vT(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,a=o*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,a=a/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,a=o/s/2.506628274631)}return r>0?1-a:a}function yT(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*$Je*LJe(2*e-1)}function LJe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function rz(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>mT(n,r),pdf:a=>nz(a,n,r),cdf:a=>vT(a,n,r),icdf:a=>yT(a,n,r)};return i.mean(e).stdev(t)}function iz(e,t){const n=rz();let r=0;const i={data(a){return arguments.length?(e=a,r=a?a.length:0,i.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=tz(e)),i):t},sample(){return e[~~(mu()*r)]+t*n.sample()},pdf(a){let o=0,s=0;for(;s<r;++s)o+=n.pdf((a-e[s])/t);return o/t/r},cdf(a){let o=0,s=0;for(;s<r;++s)o+=n.cdf((a-e[s])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function az(e,t){return e=e||0,t=t??1,Math.exp(e+mT()*t)}function oz(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*kse*e)}function sz(e,t,n){return vT(Math.log(e),t,n)}function uz(e,t,n){return Math.exp(yT(e,t,n))}function Tse(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>az(n,r),pdf:a=>oz(a,n,r),cdf:a=>sz(a,n,r),icdf:a=>uz(a,n,r)};return i.mean(e).stdev(t)}function Ose(e,t){let n=0,r;function i(o){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)s[l]/=u;return s}const a={weights(o){return arguments.length?(r=i(t=o||[]),a):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),a.weights(t)):e},sample(){const o=mu();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){s=e[l];break}return s.sample()},pdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(o);return s},cdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(o);return s},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function lz(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*mu()}function cz(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function fz(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function dz(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Ise(e,t){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a??1,i):r},sample:()=>lz(n,r),pdf:a=>cz(a,n,r),cdf:a=>fz(a,n,r),icdf:a=>dz(a,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function $w(e,t,n,r){const i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function bT(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,a=new Float64Array(i),o=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)a[s]=c=+t(d),o[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)a[s]-=u,o[s]-=l;return[a,o,u,l]}function Lw(e,t,n,r){let i=-1,a,o;for(const s of e)a=t(s),o=n(s),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function ly(e,t,n,r,i){let a=0,o=0;return Lw(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;a+=l*l,o+=c*c}),1-a/o}function hz(e,t,n){let r=0,i=0,a=0,o=0,s=0;Lw(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=$w(r,i,a,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:ly(e,t,n,i,l)}}function Nse(e,t,n){let r=0,i=0,a=0,o=0,s=0;Lw(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=$w(r,i,a,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:ly(e,t,n,i,l)}}function Dse(e,t,n){const[r,i,a,o]=bT(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,p;Lw(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,s+=(b*h-s)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=$w(u/o,s/o,l/o,c/o),v=y=>Math.exp(g+m*(y-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:ly(e,t,n,o,v)}}function Rse(e,t,n){let r=0,i=0,a=0,o=0,s=0,u=0;Lw(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,a+=(h*p-a)/u,o+=(h*h-o)/u,s+=(d-s)/u});const l=$w(r,i,a,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:ly(e,t,n,s,c)}}function pz(e,t,n){const[r,i,a,o]=bT(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<s;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,x=(f*v-d*l)/y,w=-b*u,S=C=>(C=C-a,b*C*C+x*C+w+o);return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:S,rSquared:ly(e,t,n,o,S)}}function Fse(e,t,n,r){if(r===1)return hz(e,t,n);if(r===2)return pz(e,t,n);const[i,a,o,s]=bT(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*a[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=zJe(c),y=b=>{b-=o;let x=s+v[0]+v[1]*b+v[2]*b*b;for(d=3;d<f;++d)x+=v[d]*Math.pow(b,d);return x};return{coef:BJe(f,v,-o,s),predict:y,rSquared:ly(e,t,n,s,y)}}function BJe(e,t,n,r){const i=Array(e);let a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function zJe(e){const t=e.length-1,n=[];let r,i,a,o,s;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(a=r;a<t+1;++a)s=e[a][r],e[a][r]=e[a][o],e[a][o]=s;for(i=r+1;i<t;++i)for(a=t;a>=r;a--)e[a][i]-=e[a][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*n[a];n[i]=(e[t][i]-s)/e[i][i]}return n}const Mse=2,Pse=1e-12;function $se(e,t,n,r){const[i,a,o,s]=bT(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=Mse;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,S=0,C=0,_=0,E=0;const A=1/Math.abs(i[x]-v||1);for(let I=y;I<=b;++I){const N=i[I],O=a[I],D=jJe(Math.abs(v-N)*A)*d[I],P=N*D;w+=D,S+=P,C+=O*D,_+=O*P,E+=N*P}const[k,T]=$w(S/w,C/w,_/w,E/w);c[m]=k+T*v,f[m]=Math.abs(a[m]-c[m]),UJe(i,m+1,p)}if(h===Mse)break;const g=eoe(f);if(Math.abs(g)<Pse)break;for(let m=0,v,y;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?Pse:(y=1-v*v)*y}return WJe(i,c,o,s)}function jJe(e){return(e=1-e*e*e)*e*e}function UJe(e,t,n){const r=e[t];let i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}function WJe(e,t,n,r){const i=e.length,a=[];let o=0,s=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[o]],a.push(u));return u[1]+=r,a}const VJe=.1*Math.PI/180;function xT(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=h=>[h,e(h)],a=t[0],o=t[1],s=o-a,u=s/r,l=[i(a)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(a+h/n*s));return l.push(i(o)),l}else{c.push(i(o));for(let h=n;--h>0;)c.push(i(a+h/n*s))}let f=l[0],d=c[c.length-1];for(;d;){const h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&qJe(f,h,d)>VJe?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function qJe(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function HJe(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function gz(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:HJe(e)}function Lse(e,t,n){return n||e+(t?"_"+t:"")}const mz=()=>{},GJe={init:mz,add:mz,rem:mz,idx:0},Bw={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},zw=Object.keys(Bw);function KJe(e,t){return n=>Zt({name:e,out:n||e},GJe,t)}zw.forEach(e=>{Bw[e]=KJe(e,Bw[e])});function Bse(e,t){return Bw[e](t)}function zse(e,t){return e.idx-t.idx}function XJe(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=Bw[i]())})};return e.forEach(n),Object.values(t).sort(zse)}function YJe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function ZJe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function JJe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function QJe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function jse(e,t){const n=t||yo,r=XJe(e),i=e.slice().sort(zse);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=YJe,a.prototype.add=ZJe,a.prototype.rem=JJe,a.prototype.set=QJe,a.prototype.get=n,a.fields=e.map(o=>o.out),a}function vz(e){this._key=e?Xo(e):xt,this.reset()}const Sa=vz.prototype;Sa.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Sa.add=function(e){this._add.push(e)},Sa.rem=function(e){this._rem.push(e)},Sa.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};let s,u,l;for(s=0;s<i;++s)o[n(t[s])]=1;for(s=0,u=0;s<r;++s)o[n(l=e[s])]?o[n(l)]=0:a[u++]=l;return this._rem=[],this._add=a},Sa.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,a;for(;--r>=0;)a=e(t[r])+"",Rt(n,a)||(n[a]=1,++i);return i},Sa.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Tae(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Sa.argmin=function(e){return this.extent(e)[0]||{}},Sa.argmax=function(e){return this.extent(e)[1]||{}},Sa.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Sa.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Sa.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=ez(this.values(),e),this._get=e),this._q},Sa.q1=function(e){return this.quartile(e)[0]},Sa.q2=function(e){return this.quartile(e)[1]},Sa.q3=function(e){return this.quartile(e)[2]},Sa.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=Cse(this.values(),1e3,.05,e),this._get=e),this._ci},Sa.ci0=function(e){return this.ci(e)[0]},Sa.ci1=function(e){return this.ci(e)[1]};function Lh(e){_e.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Lh.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:zw},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Ge(Lh,_e,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function a(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}a(e._prev),a(t);function o(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=Dt($a(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=Dt(e.groupby),this._dnames=this._dims.map(m=>{const v=ri(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:gz(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],o=e.ops||["count"],s=e.as||[],u=a.length,l={};let c,f,d,h,p,g;for(u!==o.length&&Ie("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=a[g],f=o[g],c==null&&f!=="count"&&Ie("Null aggregate field specified."),h=ri(c),p=Lse(f,h,s[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(Bse(f,p))}return this._measures=this._measures.map(m=>jse(m,m.field)),{}},cellkey:gz(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new vz),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](e);return t?fse(t.tuple,a):Yn(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const eQe=1e-14;function yz(e){_e.call(this,null,e)}yz.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Ge(yz,_e,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified($a(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+a*(1+(f-i)/a)}:c=>c[s]=r(c)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Ese(e),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,s;(o=e.anchor)!=null&&(s=o-(i+r*Math.floor((o-i)/r)),i+=s,a+=s);const u=function(l){let c=La(t(l));return c==null?null:c<i?-1/0:c>a?1/0:(c=Math.max(i,Math.min(c,a-r)),i+r*Math.floor(eQe+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=Ko(u,$a(t),e.name||"bin_"+ri(t))}});function Use(e,t,n){const r=e;let i=t||[],a=n||[],o={},s=0;return{add:u=>a.push(u),remove:u=>o[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!o[r(c)]),o={},s=0),l&&u&&i.sort(u),a.length&&(i=u?Fae(u,i,a.sort(u)):i.concat(a),a=[]),i)}}function bz(e){_e.call(this,[],e)}bz.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Ge(bz,_e,{transform(e,t){const n=t.fork(t.ALL),r=Use(xt,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(Yg(i),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function Wse(e){xr.call(this,null,tQe,e)}Ge(Wse,xr);function tQe(e){return this.value&&!e.modified()?this.value:Q4(e.fields,e.orders)}function xz(e){_e.call(this,null,e)}xz.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function nQe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Ge(xz,_e,{transform(e,t){const n=f=>d=>{for(var h=nQe(s(d),e.case,a)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=Yn({}),u[i]=s,u[a]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==l&&(u[a]=l,o.mod.push(u));return o.modifies(t)}});function wz(e){_e.call(this,null,e)}wz.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Ge(wz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=rQe(s,i,a,e.filter||hu)):n.mod=s,n.source=this.value,n.modifies(r)}});function rQe(e,t,n,r){for(var i=[],a={},o=e.length,s=0,u,l;s<o;++s)for(a[t]=l=e[s],u=0;u<o;++u)a[n]=e[u],r(a)&&(i.push(Yn(a)),a={},a[t]=l);return i}const Vse={kde:iz,mixture:Ose,normal:rz,lognormal:Tse,uniform:Ise},iQe="distributions",qse="function",aQe="field";function Hse(e,t){const n=e[qse];Rt(Vse,n)||Ie("Unknown distribution function: "+n);const r=Vse[n]();for(const i in e)i===aQe?r.data((e.from||t()).map(e[i])):i===iQe?r[i](e[i].map(a=>Hse(a,t))):typeof r[i]===qse&&r[i](e[i]);return r}function _z(e){_e.call(this,null,e)}const Gse=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],oQe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Gse},{name:"weights",type:"number",array:!0}]};_z.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Gse.concat(oQe)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Ge(_z,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=Hse(e.distribution,sQe(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Ie("Invalid density method: "+o),!e.extent&&!r.data&&Ie("Missing density extent parameter."),o=r[o];const s=e.as||["value","density"],u=e.extent||xc(r.data()),l=xT(o,u,i,a).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Yn(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function sQe(e){return()=>e.materialize(e.SOURCE).source}function Kse(e,t){return e?e.map((n,r)=>t[r]||ri(n)):null}function Sz(e,t,n){const r=[],i=f=>f(u);let a,o,s,u,l,c;if(t==null)r.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)u=e[o],l=t.map(i),c=a[l],c||(a[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const Xse="bin";function Ez(e){_e.call(this,null,e)}Ez.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Xse}]};const uQe=(e,t)=>dw(xc(e,t))/30;Ge(Ez,_e,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=Sz(t.source,e.groupby,yo),i=e.smooth||!1,a=e.field,o=e.step||uQe(n,a),s=Yg((p,g)=>a(p)-a(g)),u=e.as||Xse,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(s);h=-1;for(const g of Ase(p,o,i,a))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function Yse(e){xr.call(this,null,lQe,e),this.modified(!0)}Ge(Yse,xr);function lQe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Ko(n=>t(n,e),$a(t),ri(t))}function Cz(e){_e.call(this,[void 0,void 0],e)}Cz.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Ge(Cz,_e,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=La(r(s));u!=null&&(u<a&&(a=u),u>o&&(o=u))}),!Number.isFinite(a)||!Number.isFinite(o)){let s=ri(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function Az(e,t){xr.call(this,e),this.parent=t,this.count=0}Ge(Az,xr,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function wT(e){_e.call(this,{},e),this._keys=J0();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}Ge(wT,_e,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let a=Rt(i,e)&&i[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new Az(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),i[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=xt(u),c=a.get(l);c!==void 0&&(a.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);a.set(xt(u),l),s(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=xt(u),c=a.get(l),f=r(u);c===f?s(f).mod(u):(a.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(a.get(xt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=xt(u),c=a.get(l),f=r(u);c!==f&&(a.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function Zse(e){xr.call(this,null,cQe,e)}Ge(Zse,xr);function cQe(e){return this.value&&!e.modified()?this.value:bt(e.name)?Dt(e.name).map(t=>Xo(t)):Xo(e.name,e.as)}function kz(e){_e.call(this,J0(),e)}kz.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Ge(kz,_e,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=xt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?a.push(f):r.set(xt(f),1)});function c(f){const d=xt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),a.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function Tz(e){_e.call(this,[],e)}Tz.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Ge(Tz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Kse(r,e.as||[]),a=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(p=>p(s)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=XB(s),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;a&&(d[a]=c),n.add.push(d)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function Oz(e){_e.call(this,[],e)}Oz.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Ge(Oz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ri),a=e.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=XB(l),f[o]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(a)}});function Iz(e){_e.call(this,null,e)}Iz.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Ge(Iz,_e,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,o=>o[r]=n(o,e))}});function Jse(e){_e.call(this,[],e)}Ge(Jse,_e,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,a=e.size-i.length,o,s,u;if(a>0){for(o=[];--a>=0;)o.push(u=Yn(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-a);return n.source=this.value=i,n}});const _T={value:"value",median:eoe,mean:cYe,min:vB,max:qg},fQe=[];function Nz(e){_e.call(this,[],e)}Nz.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function dQe(e){var t=e.method||_T.value,n;if(_T[t]==null)Ie("Unrecognized imputation method: "+t);else return t===_T.value?(n=e.value!==void 0?e.value:0,()=>n):_T[t]}function hQe(e){const t=e.field;return n=>n?t(n):NaN}Ge(Nz,_e,{transform(e,t){var n=t.fork(t.ALL),r=dQe(e),i=hQe(e),a=ri(e.field),o=ri(e.key),s=(e.groupby||[]).map(ri),u=pQe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,v,y,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,y=0;y<f;++y)if(d[y]==null){for(g=u.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[s[v]]=p[v];w[o]=g,w[a]=Number.isNaN(h)?h=r(d,i):h,l.push(Yn(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function pQe(e,t,n,r){var i=v=>v(m),a=[],o=r?r.slice():[],s={},u={},l,c,f,d,h,p,g,m;for(o.forEach((v,y)=>s[v]=y+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=s[p]||(s[p]=o.push(p)),c=(l=t?t.map(i):fQe)+"",(f=u[c])||(f=u[c]=[],a.push(f),f.values=l),f[h-1]=m;return a.domain=o,a}function Dz(e){Lh.call(this,e)}Dz.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:zw},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Ge(Dz,Lh,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Zt(a,i[n.cellkey(a)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Rz(e){_e.call(this,null,e)}Rz.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Ge(Rz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Sz(r,e.groupby,e.field),a=(e.groupby||[]).map(ri),o=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&Ie("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=xc(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=iz(h,o)[s],g=e.counts?h.length:1,m=c||xc(h);xT(p,m,f,d).forEach(v=>{const y={};for(let b=0;b<a.length;++b)y[a[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(Yn(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function Qse(e){xr.call(this,null,gQe,e)}Ge(Qse,xr);function gQe(e){return this.value&&!e.modified()?this.value:nB(e.fields,e.flat)}function eue(e){_e.call(this,[],e),this._pending=null}Ge(eue,_e,{transform(e,t){const n=t.dataflow;return this._pending?Fz(this,t,this._pending):mQe(e)?t.StopPropagation:e.values?Fz(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=Dt(i.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(r=>Fz(this,t,Dt(r.data)))}});function mQe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Fz(e,t,n){n.forEach(Yn);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Mz(e){_e.call(this,{},e)}Mz.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Ge(Mz,_e,{transform(e,t){const n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),s=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&Ie('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&Ie('The "as" parameter has too few output field names.'),c=c||i.map(ri),f=function(p){for(var g=0,m=0,v,y;g<s;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<d;++v,++m)p[c[m]]=a;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||Ie("Missing output field names."),f=function(p){for(var g=0,m;g<s;++g)m=r.get(n[g](p)),p[c[g]]=m??a}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function tue(e){xr.call(this,null,vQe,e)}Ge(tue,xr);function vQe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=t[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function nue(e){xr.call(this,null,yQe,e)}Ge(nue,xr);function yQe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function rue(e){_e.call(this,null,e)}Ge(rue,_e,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Pz(e){Lh.call(this,e)}Pz.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:zw,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Ge(Pz,Lh,{_transform:Lh.prototype.transform,transform(e,t){return this._transform(bQe(e,t),t)}});function bQe(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=$a(n).concat($a(r)),o=wQe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(s=>xQe(s,n,r,a)),as:o.map(s=>s+""),modified:e.modified.bind(e)}}function xQe(e,t,n,r){return Ko(i=>t(i)===e?n(i):NaN,r,e+"")}function wQe(e,t,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=e(a);r[o]||(r[o]=1,i.push(o))}),i.sort(Xk),t?i.slice(0,t):i}function iue(e){wT.call(this,e)}Ge(iue,wT,{transform(e,t){const n=e.subflow,r=e.field,i=a=>this.subflow(xt(a),n,t,a);return(e.modified("field")||r&&t.modified($a(r)))&&Ie("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,a=>{const o=i(a);r(a).forEach(s=>o.mod(s))}),t.visit(t.ADD,a=>{const o=i(a);r(a).forEach(s=>o.add(Yn(s)))}),t.visit(t.REM,a=>{const o=i(a);r(a).forEach(s=>o.rem(s))})):(t.visit(t.MOD,a=>i(a).mod(a)),t.visit(t.ADD,a=>i(a).add(a)),t.visit(t.REM,a=>i(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function $z(e){_e.call(this,null,e)}$z.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Ge($z,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Kse(e.fields,e.as||[]),a=r?(s,u)=>_Qe(s,u,r,i):cT;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,s=>{const u=xt(s);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,s=>{const u=a(s,Yn({}));o[xt(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(a(s,o[xt(s)]))}),n}});function _Qe(e,t,n,r){for(let i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}function aue(e){_e.call(this,null,e)}Ge(aue,_e,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Lz(e){_e.call(this,null,e)}Lz.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const SQe=1e-14;Ge(Lz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,a=Sz(i,e.groupby,e.field),o=(e.groupby||[]).map(ri),s=[],u=e.step||.01,l=e.probs||Ps(u/2,1-SQe,u),c=l.length;return a.forEach(f=>{const d=QB(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],s.push(Yn(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function oue(e){_e.call(this,null,e)}Ge(oue,_e,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const a=xt(i);n.rem.push(r[a]),r[a]=null}),t.visit(t.ADD,i=>{const a=XB(i);r[xt(i)]=a,n.add.push(a)}),t.visit(t.MOD,i=>{const a=r[xt(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function Bz(e){_e.call(this,[],e),this.count=0}Bz.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Ge(Bz,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((c,f)=>(c[xt(f)]=1,c),{});let o=this.value,s=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((s+1)*mu()),d<o.length&&d>=u&&(f=o[d],a[xt(f)]&&n.rem.push(f),o[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=xt(c);a[f]&&(a[f]=-1,n.rem.push(c)),--s}),o=o.filter(c=>a[xt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=s=o.length,t.visit(t.SOURCE,c=>{a[xt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)a[xt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{a[xt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!a[xt(c)])),this.count=s,this.value=n.source=o,n}});function zz(e){_e.call(this,null,e)}zz.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Ge(zz,_e,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ps(e.start,e.stop,e.step||1).map(i=>{const a={};return a[r]=i,Yn(a)}),n.add=t.add.concat(this.value),n}});function sue(e){_e.call(this,null,e),this.modified(!0)}Ge(sue,_e,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function jz(e){_e.call(this,null,e)}const uue=["unit0","unit1"];jz.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:DB,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:uue}]},Ge(jz,_e,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",a=this._floor(e,t),o=(i?iy:ry)(a.unit).offset,s=e.as||uue,u=s[0],l=s[1],c=a.step;let f=a.start||1/0,d=a.stop||-1/0,h=t.ADD;return(e.modified()||t.modified($a(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=a(g),r&&(p[l]=v=o(m,c)),m<f&&(f=m),v>d&&(d=v))}),a.start=f,a.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Poe({extent:e.extent||xc(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=FB(r),o=this.value||{},s=(n?Coe:Eoe)(a,i);return s.unit=An(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}});function lue(e){_e.call(this,J0(),e)}Ge(lue,_e,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,a=s=>i.set(r(s),s);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function cue(e){_e.call(this,null,e)}Ge(cue,_e,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Yg(e.sort)):t.source).map(e.field))}});function EQe(e,t,n,r){const i=jw[e](t,n);return{init:i.init||Eh,update:function(a,o){o[r]=i.next(a)}}}const jw={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=jw.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Ie("ntile num must be greater than zero.");const n=jw.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Ie("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=CQe(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function CQe(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const AQe=Object.keys(jw);function fue(e){const t=Dt(e.ops),n=Dt(e.fields),r=Dt(e.params),i=Dt(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){Dt($a(h)).forEach(p=>s[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=ri(g),v=Lse(h,m,i[p]);if(d(g),a.push(v),Rt(jw,h))o.push(EQe(h,n[p],r[p],v));else{if(g==null&&h!=="count"&&Ie("Null aggregate field specified."),h==="count"){l.push(v);return}f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(Bse(h,v))}}),(l.length||c.length)&&(this.cell=kQe(c,l,f)),this.inputs=Object.keys(s)}const due=fue.prototype;due.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},due.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,a=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function kQe(e,t,n){e=e.map(u=>jse(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var s=r.data=new vz;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)a[l].add(a[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)a[l].rem(a[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=a.length;l<c;++l)a[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)a[u].init()},r}function Uz(e){_e.call(this,{},e),this._mlen=0,this._mods=[]}Uz.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:AQe.concat(zw)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Ge(Uz,_e,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=Yg(e.sort),i=gz(e.groupby),a=s=>this.group(i(s));let o=this.state;(!o||n)&&(o=this.state=new fue(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,s=>a(s).add(s))):(t.visit(t.REM,s=>a(s).remove(s)),t.visit(t.ADD,s=>a(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)TQe(this._mods[s],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Use(xt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function TQe(e,t,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=e.data(n),u=s.length,l=a?pw(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ba(-1)};t.init();for(let f=0;f<u;++f)OQe(c,o,f,u),a&&IQe(c,l),t.update(c,s[f])}function OQe(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function IQe(e,t){const n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}var NQe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Lh,bin:yz,collect:bz,compare:Wse,countpattern:xz,cross:wz,density:_z,dotbin:Ez,expression:Yse,extent:Cz,facet:wT,field:Zse,filter:kz,flatten:Tz,fold:Oz,formula:Iz,generate:Jse,impute:Nz,joinaggregate:Dz,kde:Rz,key:Qse,load:eue,lookup:Mz,multiextent:tue,multivalues:nue,params:rue,pivot:Pz,prefacet:iue,project:$z,proxy:aue,quantile:Lz,relay:oue,sample:Bz,sequence:zz,sieve:sue,subflow:Az,timeunit:jz,tupleindex:lue,values:cue,window:Uz});const Wz=Math.PI,Vz=2*Wz,Jg=1e-6,DQe=Vz-Jg;function qz(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Qg(){return new qz}qz.prototype=Qg.prototype={constructor:qz,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Jg)if(!(Math.abs(c*s-u*l)>Jg)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-a,h=r-o,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((Wz-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>Jg&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Jg||Math.abs(this._y1-l)>Jg)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Vz+Vz),f>DQe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>Jg&&(this._+="A"+n+","+n+",0,"+ +(f>=Wz)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function er(e){return function(){return e}}var hue=Math.abs,Ua=Math.atan2,em=Math.cos,RQe=Math.max,Hz=Math.min,Sc=Math.sin,cy=Math.sqrt,Wa=1e-12,fy=Math.PI,ST=fy/2,pue=2*fy;function FQe(e){return e>1?0:e<-1?fy:Math.acos(e)}function gue(e){return e>=1?ST:e<=-1?-ST:Math.asin(e)}function MQe(e){return e.innerRadius}function PQe(e){return e.outerRadius}function $Qe(e){return e.startAngle}function LQe(e){return e.endAngle}function BQe(e){return e&&e.padAngle}function zQe(e,t,n,r,i,a,o,s){var u=n-e,l=r-t,c=o-i,f=s-a,d=f*u-c*l;if(!(d*d<Wa))return d=(c*(t-a)-f*(e-i))/d,[e+d*u,t+d*l]}function ET(e,t,n,r,i,a,o){var s=e-n,u=t-r,l=(o?a:-a)/cy(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,x=y*y+b*b,w=i-a,S=d*g-p*h,C=(b<0?-1:1)*cy(RQe(0,w*w*x-S*S)),_=(S*b-y*C)/x,E=(-S*y-b*C)/x,A=(S*b+y*C)/x,k=(-S*y+b*C)/x,T=_-m,I=E-v,N=A-m,O=k-v;return T*T+I*I>N*N+O*O&&(_=A,E=k),{cx:_,cy:E,x01:-c,y01:-f,x11:_*(i/w-1),y11:E*(i/w-1)}}function jQe(){var e=MQe,t=PQe,n=er(0),r=null,i=$Qe,a=LQe,o=BQe,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-ST,p=a.apply(this,arguments)-ST,g=hue(p-h),m=p>h;if(s||(s=l=Qg()),d<f&&(c=d,d=f,f=c),!(d>Wa))s.moveTo(0,0);else if(g>pue-Wa)s.moveTo(d*em(h),d*Sc(h)),s.arc(0,0,d,h,p,!m),f>Wa&&(s.moveTo(f*em(p),f*Sc(p)),s.arc(0,0,f,p,h,m));else{var v=h,y=p,b=h,x=p,w=g,S=g,C=o.apply(this,arguments)/2,_=C>Wa&&(r?+r.apply(this,arguments):cy(f*f+d*d)),E=Hz(hue(d-f)/2,+n.apply(this,arguments)),A=E,k=E,T,I;if(_>Wa){var N=gue(_/f*Sc(C)),O=gue(_/d*Sc(C));(w-=N*2)>Wa?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+p)/2),(S-=O*2)>Wa?(O*=m?1:-1,v+=O,y-=O):(S=0,v=y=(h+p)/2)}var D=d*em(v),P=d*Sc(v),V=f*em(x),Y=f*Sc(x);if(E>Wa){var X=d*em(y),Q=d*Sc(y),me=f*em(b),ce=f*Sc(b),Ne;if(g<fy&&(Ne=zQe(D,P,me,ce,X,Q,V,Y))){var Oe=D-Ne[0],$e=P-Ne[1],ve=X-Ne[0],$=Q-Ne[1],F=1/Sc(FQe((Oe*ve+$e*$)/(cy(Oe*Oe+$e*$e)*cy(ve*ve+$*$)))/2),q=cy(Ne[0]*Ne[0]+Ne[1]*Ne[1]);A=Hz(E,(f-q)/(F-1)),k=Hz(E,(d-q)/(F+1))}}S>Wa?k>Wa?(T=ET(me,ce,D,P,d,k,m),I=ET(X,Q,V,Y,d,k,m),s.moveTo(T.cx+T.x01,T.cy+T.y01),k<E?s.arc(T.cx,T.cy,k,Ua(T.y01,T.x01),Ua(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,k,Ua(T.y01,T.x01),Ua(T.y11,T.x11),!m),s.arc(0,0,d,Ua(T.cy+T.y11,T.cx+T.x11),Ua(I.cy+I.y11,I.cx+I.x11),!m),s.arc(I.cx,I.cy,k,Ua(I.y11,I.x11),Ua(I.y01,I.x01),!m))):(s.moveTo(D,P),s.arc(0,0,d,v,y,!m)):s.moveTo(D,P),!(f>Wa)||!(w>Wa)?s.lineTo(V,Y):A>Wa?(T=ET(V,Y,X,Q,f,-A,m),I=ET(D,P,me,ce,f,-A,m),s.lineTo(T.cx+T.x01,T.cy+T.y01),A<E?s.arc(T.cx,T.cy,A,Ua(T.y01,T.x01),Ua(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,A,Ua(T.y01,T.x01),Ua(T.y11,T.x11),!m),s.arc(0,0,f,Ua(T.cy+T.y11,T.cx+T.x11),Ua(I.cy+I.y11,I.cx+I.x11),m),s.arc(I.cx,I.cy,A,Ua(I.y11,I.x11),Ua(I.y01,I.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-fy/2;return[em(c)*l,Sc(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:er(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:er(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:er(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:er(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:er(+l),u):i},u.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:er(+l),u):a},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:er(+l),u):o},u.context=function(l){return arguments.length?(s=l??null,u):s},u}function mue(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vue(e){this._context=e}vue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Gz(e){return new vue(e)}function yue(e){return e[0]}function bue(e){return e[1]}function xue(e,t){var n=er(!0),r=null,i=Gz,a=null;e=typeof e=="function"?e:e===void 0?yue:er(e),t=typeof t=="function"?t:t===void 0?bue:er(t);function o(s){var u,l=(s=mue(s)).length,c,f=!1,d;for(r==null&&(a=i(d=Qg())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,u,s),+t(c,u,s));if(d)return a=null,d+""||null}return o.x=function(s){return arguments.length?(e=typeof s=="function"?s:er(+s),o):e},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:er(+s),o):t},o.defined=function(s){return arguments.length?(n=typeof s=="function"?s:er(!!s),o):n},o.curve=function(s){return arguments.length?(i=s,r!=null&&(a=i(r)),o):i},o.context=function(s){return arguments.length?(s==null?r=a=null:a=i(r=s),o):r},o}function wue(e,t,n){var r=null,i=er(!0),a=null,o=Gz,s=null;e=typeof e=="function"?e:e===void 0?yue:er(+e),t=typeof t=="function"?t:er(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?bue:er(+n);function u(c){var f,d,h,p=(c=mue(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(a==null&&(s=o(v=Qg())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(y[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),s.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return s=null,v+""||null}function l(){return xue().defined(i).curve(o).context(a)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:er(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:er(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:er(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:er(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:er(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:er(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:er(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,a!=null&&(s=o(a)),u):o},u.context=function(c){return arguments.length?(c==null?a=s=null:s=o(a=c),u):a},u}var UQe={draw:function(e,t){var n=Math.sqrt(t/fy);e.moveTo(n,0),e.arc(0,0,n,0,pue)}};function WQe(e,t){var n=null;e=typeof e=="function"?e:er(e||UQe),t=typeof t=="function"?t:er(t===void 0?64:+t);function r(){var i;if(n||(n=i=Qg()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:er(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:er(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function Bh(){}function CT(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function AT(e){this._context=e}AT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:CT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:CT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function VQe(e){return new AT(e)}function _ue(e){this._context=e}_ue.prototype={areaStart:Bh,areaEnd:Bh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:CT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function qQe(e){return new _ue(e)}function Sue(e){this._context=e}Sue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:CT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function HQe(e){return new Sue(e)}function Eue(e,t){this._basis=new AT(e),this._beta=t}Eue.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*a),this._beta*t[s]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var GQe=function e(t){function n(r){return t===1?new AT(r):new Eue(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function kT(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Kz(e,t){this._context=e,this._k=(1-t)/6}Kz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:kT(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:kT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var KQe=function e(t){function n(r){return new Kz(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Xz(e,t){this._context=e,this._k=(1-t)/6}Xz.prototype={areaStart:Bh,areaEnd:Bh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:kT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var XQe=function e(t){function n(r){return new Xz(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Yz(e,t){this._context=e,this._k=(1-t)/6}Yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var YQe=function e(t){function n(r){return new Yz(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Zz(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>Wa){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Wa){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function Cue(e,t){this._context=e,this._alpha=t}Cue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Zz(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ZQe=function e(t){function n(r){return t?new Cue(r,t):new Kz(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Aue(e,t){this._context=e,this._alpha=t}Aue.prototype={areaStart:Bh,areaEnd:Bh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Zz(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var JQe=function e(t){function n(r){return t?new Aue(r,t):new Xz(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function kue(e,t){this._context=e,this._alpha=t}kue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Zz(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var QQe=function e(t){function n(r){return t?new kue(r,t):new Yz(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Tue(e){this._context=e}Tue.prototype={areaStart:Bh,areaEnd:Bh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function eet(e){return new Tue(e)}function Oue(e){return e<0?-1:1}function Iue(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Oue(a)+Oue(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Nue(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Jz(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function TT(e){this._context=e}TT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jz(this,this._t0,Nue(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Jz(this,Nue(this,n=Iue(this,e,t)),n);break;default:Jz(this,this._t0,n=Iue(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Due(e){this._context=new Rue(e)}(Due.prototype=Object.create(TT.prototype)).point=function(e,t){TT.prototype.point.call(this,t,e)};function Rue(e){this._context=e}Rue.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function tet(e){return new TT(e)}function net(e){return new Due(e)}function Fue(e){this._context=e}Fue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Mue(e),i=Mue(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Mue(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function ret(e){return new Fue(e)}function OT(e,t){this._context=e,this._t=t}OT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function iet(e){return new OT(e,.5)}function aet(e){return new OT(e,0)}function oet(e){return new OT(e,1)}function dy(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const set=()=>typeof Image!="undefined"?Image:null;function Ec(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function zh(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Qz=Symbol("implicit");function e5(){var e=new Map,t=[],n=[],r=Qz;function i(a){var o=a+"",s=e.get(o);if(!s){if(r!==Qz)return r;e.set(o,s=t.push(a))}return n[(s-1)%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of a){const s=o+"";e.has(s)||e.set(s,t.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return e5(t,n).unknown(r)},Ec.apply(i,arguments),i}function hy(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Uw(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function jh(){}var tm=.7,py=1/tm,gy="\\s*([+-]?\\d+)\\s*",Ww="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uet=/^#([0-9a-f]{3,8})$/,cet=new RegExp("^rgb\\("+[gy,gy,gy]+"\\)$"),fet=new RegExp("^rgb\\("+[Cc,Cc,Cc]+"\\)$"),det=new RegExp("^rgba\\("+[gy,gy,gy,Ww]+"\\)$"),het=new RegExp("^rgba\\("+[Cc,Cc,Cc,Ww]+"\\)$"),pet=new RegExp("^hsl\\("+[Ww,Cc,Cc]+"\\)$"),get=new RegExp("^hsla\\("+[Ww,Cc,Cc,Ww]+"\\)$"),Pue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hy(jh,Vw,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:$ue,formatHex:$ue,formatHsl:met,formatRgb:Lue,toString:Lue});function $ue(){return this.rgb().formatHex()}function met(){return Wue(this).formatHsl()}function Lue(){return this.rgb().formatRgb()}function Vw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=uet.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Bue(t):n===3?new Ea(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?IT(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?IT(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cet.exec(e))?new Ea(t[1],t[2],t[3],1):(t=fet.exec(e))?new Ea(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=det.exec(e))?IT(t[1],t[2],t[3],t[4]):(t=het.exec(e))?IT(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=pet.exec(e))?Uue(t[1],t[2]/100,t[3]/100,1):(t=get.exec(e))?Uue(t[1],t[2]/100,t[3]/100,t[4]):Pue.hasOwnProperty(e)?Bue(Pue[e]):e==="transparent"?new Ea(NaN,NaN,NaN,0):null}function Bue(e){return new Ea(e>>16&255,e>>8&255,e&255,1)}function IT(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ea(e,t,n,r)}function t5(e){return e instanceof jh||(e=Vw(e)),e?(e=e.rgb(),new Ea(e.r,e.g,e.b,e.opacity)):new Ea}function Uh(e,t,n,r){return arguments.length===1?t5(e):new Ea(e,t,n,r??1)}function Ea(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}hy(Ea,Uh,Uw(jh,{brighter:function(e){return e=e==null?py:Math.pow(py,e),new Ea(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?tm:Math.pow(tm,e),new Ea(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zue,formatHex:zue,formatRgb:jue,toString:jue}));function zue(){return"#"+n5(this.r)+n5(this.g)+n5(this.b)}function jue(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function n5(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Uue(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ac(e,t,n,r)}function Wue(e){if(e instanceof Ac)return new Ac(e.h,e.s,e.l,e.opacity);if(e instanceof jh||(e=Vw(e)),!e)return new Ac;if(e instanceof Ac)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Ac(o,s,u,e.opacity)}function NT(e,t,n,r){return arguments.length===1?Wue(e):new Ac(e,t,n,r??1)}function Ac(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}hy(Ac,NT,Uw(jh,{brighter:function(e){return e=e==null?py:Math.pow(py,e),new Ac(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?tm:Math.pow(tm,e),new Ac(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ea(r5(e>=240?e-240:e+120,i,r),r5(e,i,r),r5(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function r5(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vue=Math.PI/180,que=180/Math.PI,DT=18,Hue=.96422,Gue=1,Kue=.82521,Xue=4/29,my=6/29,Yue=3*my*my,vet=my*my*my;function Zue(e){if(e instanceof kc)return new kc(e.l,e.a,e.b,e.opacity);if(e instanceof Xf)return Jue(e);e instanceof Ea||(e=t5(e));var t=s5(e.r),n=s5(e.g),r=s5(e.b),i=i5((.2225045*t+.7168786*n+.0606169*r)/Gue),a,o;return t===n&&n===r?a=o=i:(a=i5((.4360747*t+.3850649*n+.1430804*r)/Hue),o=i5((.0139322*t+.0971045*n+.7141733*r)/Kue)),new kc(116*i-16,500*(a-i),200*(i-o),e.opacity)}function RT(e,t,n,r){return arguments.length===1?Zue(e):new kc(e,t,n,r??1)}function kc(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}hy(kc,RT,Uw(jh,{brighter:function(e){return new kc(this.l+DT*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new kc(this.l-DT*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Hue*a5(t),e=Gue*a5(e),n=Kue*a5(n),new Ea(o5(3.1338561*t-1.6168667*e-.4906146*n),o5(-.9787684*t+1.9161415*e+.033454*n),o5(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function i5(e){return e>vet?Math.pow(e,1/3):e/Yue+Xue}function a5(e){return e>my?e*e*e:Yue*(e-Xue)}function o5(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function s5(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function yet(e){if(e instanceof Xf)return new Xf(e.h,e.c,e.l,e.opacity);if(e instanceof kc||(e=Zue(e)),e.a===0&&e.b===0)return new Xf(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*que;return new Xf(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function FT(e,t,n,r){return arguments.length===1?yet(e):new Xf(e,t,n,r??1)}function Xf(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Jue(e){if(isNaN(e.h))return new kc(e.l,0,0,e.opacity);var t=e.h*Vue;return new kc(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}hy(Xf,FT,Uw(jh,{brighter:function(e){return new Xf(this.h,this.c,this.l+DT*(e??1),this.opacity)},darker:function(e){return new Xf(this.h,this.c,this.l-DT*(e??1),this.opacity)},rgb:function(){return Jue(this).rgb()}}));var Que=-.14861,u5=1.78277,l5=-.29227,MT=-.90649,qw=1.97294,ele=qw*MT,tle=qw*u5,nle=u5*l5-MT*Que;function bet(e){if(e instanceof nm)return new nm(e.h,e.s,e.l,e.opacity);e instanceof Ea||(e=t5(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(nle*r+ele*t-tle*n)/(nle+ele-tle),a=r-i,o=(qw*(n-i)-l5*a)/MT,s=Math.sqrt(o*o+a*a)/(qw*i*(1-i)),u=s?Math.atan2(o,a)*que-120:NaN;return new nm(u<0?u+360:u,s,i,e.opacity)}function c5(e,t,n,r){return arguments.length===1?bet(e):new nm(e,t,n,r??1)}function nm(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}hy(nm,c5,Uw(jh,{brighter:function(e){return e=e==null?py:Math.pow(py,e),new nm(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?tm:Math.pow(tm,e),new nm(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Vue,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Ea(255*(t+n*(Que*r+u5*i)),255*(t+n*(l5*r+MT*i)),255*(t+n*(qw*r)),this.opacity)}}));function rle(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function ile(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return rle((n-r/t)*t,o,i,a,s)}}function ale(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return rle((n-r/t)*t,i,a,o,s)}}var PT=e=>()=>e;function ole(e,t){return function(n){return e+n*t}}function xet(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function $T(e,t){var n=t-e;return n?ole(e,n>180||n<-180?n-360*Math.round(n/360):n):PT(isNaN(e)?t:e)}function wet(e){return(e=+e)==1?oa:function(t,n){return n-t?xet(t,n,e):PT(isNaN(t)?n:t)}}function oa(e,t){var n=t-e;return n?ole(e,n):PT(isNaN(e)?t:e)}var f5=function e(t){var n=wet(t);function r(i,a){var o=n((i=Uh(i)).r,(a=Uh(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=oa(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function sle(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=Uh(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=a(u),s+""}}}var _et=sle(ile),Eet=sle(ale);function d5(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function ule(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Cet(e,t){return(ule(t)?d5:lle)(e,t)}function lle(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=Wh(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function cle(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function gl(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function fle(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Wh(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var h5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,p5=new RegExp(h5.source,"g");function Aet(e){return function(){return e}}function ket(e){return function(t){return e(t)+""}}function dle(e,t){var n=h5.lastIndex=p5.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(e=e+"",t=t+"";(r=h5.exec(e))&&(i=p5.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:gl(r,i)})),n=p5.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?ket(u[0].x):Aet(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function Wh(e,t){var n=typeof t,r;return t==null||n==="boolean"?PT(t):(n==="number"?gl:n==="string"?(r=Vw(t))?(t=r,f5):dle:t instanceof Vw?f5:t instanceof Date?cle:ule(t)?d5:Array.isArray(t)?lle:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?fle:gl)(e,t)}function Tet(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Oet(e,t){var n=$T(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Hw(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var hle=180/Math.PI,g5={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ple(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*hle,skewX:Math.atan(u)*hle,scaleX:o,scaleY:s}}var LT;function Iet(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?g5:ple(t.a,t.b,t.c,t.d,t.e,t.f)}function Net(e){return e==null||(LT||(LT=document.createElementNS("http://www.w3.org/2000/svg","g")),LT.setAttribute("transform",e),!(e=LT.transform.baseVal.consolidate()))?g5:(e=e.matrix,ple(e.a,e.b,e.c,e.d,e.e,e.f))}function gle(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:gl(l,f)},{i:g-2,x:gl(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:gl(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:gl(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:gl(l,f)},{i:g-2,x:gl(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var Det=gle(Iet,"px, ","px)","deg)"),Ret=gle(Net,", ",")",")"),Fet=1e-12;function mle(e){return((e=Math.exp(e))+1/e)/2}function Met(e){return((e=Math.exp(e))-1/e)/2}function Pet(e){return((e=Math.exp(2*e))-1)/(e+1)}var $et=function e(t,n,r){function i(a,o){var s=a[0],u=a[1],l=a[2],c=o[0],f=o[1],d=o[2],h=c-s,p=f-u,g=h*h+p*p,m,v;if(g<Fet)v=Math.log(d/l)/t,m=function(C){return[s+C*h,u+C*p,l*Math.exp(t*C*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),x=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(x*x+1)-x);v=(S-w)/t,m=function(C){var _=C*v,E=mle(w),A=l/(n*y)*(E*Pet(t*_+w)-Met(w));return[s+A*h,u+A*p,l*E/mle(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,u=s*s;return e(o,s,u)},i}(Math.SQRT2,2,4);function vle(e){return function(t,n){var r=e((t=NT(t)).h,(n=NT(n)).h),i=oa(t.s,n.s),a=oa(t.l,n.l),o=oa(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var Let=vle($T),Bet=vle(oa);function zet(e,t){var n=oa((e=RT(e)).l,(t=RT(t)).l),r=oa(e.a,t.a),i=oa(e.b,t.b),a=oa(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function yle(e){return function(t,n){var r=e((t=FT(t)).h,(n=FT(n)).h),i=oa(t.c,n.c),a=oa(t.l,n.l),o=oa(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var jet=yle($T),Uet=yle(oa);function ble(e){return function t(n){n=+n;function r(i,a){var o=e((i=c5(i)).h,(a=c5(a)).h),s=oa(i.s,a.s),u=oa(i.l,a.l),l=oa(i.opacity,a.opacity);return function(c){return i.h=o(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var Wet=ble($T),Vet=ble(oa);function m5(e,t){t===void 0&&(t=e,e=Wh);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function qet(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Het=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Wh,interpolateArray:Cet,interpolateBasis:ile,interpolateBasisClosed:ale,interpolateDate:cle,interpolateDiscrete:Tet,interpolateHue:Oet,interpolateNumber:gl,interpolateNumberArray:d5,interpolateObject:fle,interpolateRound:Hw,interpolateString:dle,interpolateTransformCss:Det,interpolateTransformSvg:Ret,interpolateZoom:$et,interpolateRgb:f5,interpolateRgbBasis:_et,interpolateRgbBasisClosed:Eet,interpolateHsl:Let,interpolateHslLong:Bet,interpolateLab:zet,interpolateHcl:jet,interpolateHclLong:Uet,interpolateCubehelix:Wet,interpolateCubehelixLong:Vet,piecewise:m5,quantize:qet});function Get(e){return function(){return e}}function v5(e){return+e}var xle=[0,1];function Qo(e){return e}function y5(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Get(isNaN(t)?NaN:.5)}function Ket(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Xet(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=y5(i,r),a=n(o,a)):(r=y5(r,i),a=n(a,o)),function(s){return a(r(s))}}function Yet(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=y5(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var u=gw(e,s,1,r)-1;return a[u](i[u](s))}}function Gw(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function BT(){var e=xle,t=xle,n=Wh,r,i,a,o=Qo,s,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Qo&&(o=Ket(e[0],e[d-1])),s=d>2?Yet:Xet,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?a:(u||(u=s(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=s(t,e.map(r),gl)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,v5),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Hw,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Qo,c()):o!==Qo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function wle(){return BT()(Qo,Qo)}function zT(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function vy(e){return e=zT(Math.abs(e)),e?e[1]:NaN}function Zet(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function Jet(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Qet=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kw(e){return new b5(e)}Kw.prototype=b5.prototype;function b5(e){if(!(t=Qet.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}b5.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ett(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var _le;function ttt(e,t){var n=zT(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(_le=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+zT(e,Math.max(0,t+a-1))[0]}function Sle(e,t){var n=zT(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Ele={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Sle(e*100,t)},r:Sle,s:ttt,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Cle(e){return e}var Ale=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function kle(e){var t=e.grouping&&e.thousands?Zet(e.grouping,e.thousands):Cle,n=e.currency,r=e.decimal,i=e.numerals?Jet(e.numerals):Cle,a=e.percent||"%";function o(u){u=Kw(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,g=u.comma,m=u.precision,v=u.trim,y=u.type;y==="n"?(g=!0,y="g"):Ele[y]||(m==null&&(m=12),v=!0,y="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var b=d==="$"?n[0]:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(y)?a:"",w=Ele[y],S=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function C(_){var E=b,A=x,k,T,I;if(y==="c")A=w(_)+A,_="";else{_=+_;var N=_<0;if(_=w(Math.abs(_),m),v&&(_=ett(_)),N&&+_==0&&(N=!1),E=(N?f==="("?f:"-":f==="-"||f==="("?"":f)+E,A=(y==="s"?Ale[8+_le/3]:"")+A+(N&&f==="("?")":""),S){for(k=-1,T=_.length;++k<T;)if(I=_.charCodeAt(k),48>I||I>57){A=(I===46?r+_.slice(k+1):_.slice(k))+A,_=_.slice(0,k);break}}}g&&!h&&(_=t(_,1/0));var O=E.length+_.length+A.length,D=O<p?new Array(p-O+1).join(l):"";switch(g&&h&&(_=t(D+_,D.length?p-A.length:1/0),D=""),c){case"<":_=E+_+A+D;break;case"=":_=E+D+_+A;break;case"^":_=D.slice(0,O=D.length>>1)+E+_+A+D.slice(O);break;default:_=D+E+_+A;break}return i(_)}return C.toString=function(){return u+""},C}function s(u,l){var c=o((u=Kw(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(vy(l)/3)))*3,d=Math.pow(10,-f),h=Ale[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:s}}var jT,UT,x5;Tle({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function Tle(e){return jT=kle(e),UT=jT.format,x5=jT.formatPrefix,jT}function Ole(e){return Math.max(0,-vy(Math.abs(e)))}function Ile(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vy(t)/3)))*3-vy(Math.abs(e)))}function Nle(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vy(t)-vy(e))+1}var ntt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",formatDefaultLocale:Tle,get format(){return UT},get formatPrefix(){return x5},formatLocale:kle,formatSpecifier:Kw,precisionFixed:Ole,precisionPrefix:Ile,precisionRound:Nle});function Dle(e,t,n,r){var i=Oh(e,t,n),a;switch(r=Kw(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=Ile(i,o))&&(r.precision=a),x5(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Nle(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Ole(i))&&(r.precision=a-(r.type==="%")*2);break}}return UT(r)}function rm(e){var t=e.domain;return e.ticks=function(n){var r=t();return mB(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Dle(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=Zae(o,s,n),l===u)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function Rle(){var e=wle();return e.copy=function(){return Gw(e,Rle())},Ec.apply(e,arguments),rm(e)}function Fle(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,v5),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Fle(e).unknown(t)},e=arguments.length?Array.from(e,v5):[0,1],rm(n)}function Mle(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function Ple(e){return Math.log(e)}function $le(e){return Math.exp(e)}function rtt(e){return-Math.log(-e)}function itt(e){return-Math.exp(-e)}function att(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ott(e){return e===10?att:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function stt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Lle(e){return function(t){return-e(-t)}}function w5(e){var t=e(Ple,$le),n=t.domain,r=10,i,a;function o(){return i=stt(r),a=ott(r),n()[0]<0?(i=Lle(i),a=Lle(a),e(rtt,itt)):e(Ple,$le),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,g,m,v=s==null?10:+s,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=a(d);g<r;++g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=a(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}y.length*2<v&&(y=mB(l,c,v))}else y=mB(d,h,Math.min(h-d,v)).map(a);return f?y.reverse():y},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=UT(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(Mle(n(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function Ble(){var e=w5(BT()).domain([1,10]);return e.copy=function(){return Gw(e,Ble()).base(e.base())},Ec.apply(e,arguments),e}function zle(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function jle(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function _5(e){var t=1,n=e(zle(t),jle(t));return n.constant=function(r){return arguments.length?e(zle(t=+r),jle(t)):t},rm(n)}function Ule(){var e=_5(BT());return e.copy=function(){return Gw(e,Ule()).constant(e.constant())},Ec.apply(e,arguments)}function Wle(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function utt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ltt(e){return e<0?-e*e:e*e}function S5(e){var t=e(Qo,Qo),n=1;function r(){return n===1?e(Qo,Qo):n===.5?e(utt,ltt):e(Wle(n),Wle(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},rm(t)}function E5(){var e=S5(BT());return e.copy=function(){return Gw(e,E5()).exponent(e.exponent())},Ec.apply(e,arguments),e}function ctt(){return E5.apply(null,arguments).exponent(.5)}function Vle(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=Qae(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[gw(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ey),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return Vle().domain(e).range(t).unknown(r)},Ec.apply(a,arguments)}function qle(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(u){return u!=null&&u<=u?i[gw(r,u,0,n)]:a}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return qle().domain([e,t]).range(i).unknown(a)},Ec.apply(rm(o),arguments)}function Hle(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[gw(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Hle().domain(e).range(t).unknown(n)},Ec.apply(i,arguments)}function ftt(e){return new Date(e)}function dtt(e){return e instanceof Date?+e:+new Date(+e)}function C5(e,t,n,r,i,a,o,s,u,l){var c=wle(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:s(S)<S?p:o(S)<S?g:a(S)<S?m:r(S)<S?i(S)<S?v:y:n(S)<S?b:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,dtt)):d().map(ftt)},c.ticks=function(S){var C=d();return e(C[0],C[C.length-1],S??10)},c.tickFormat=function(S,C){return C==null?w:l(C)},c.nice=function(S){var C=d();return(!S||typeof S.range!="function")&&(S=t(C[0],C[C.length-1],S??10)),S?d(Mle(C,S)):c},c.copy=function(){return Gw(c,C5(e,t,n,r,i,a,o,s,u,l))},c}function htt(){return Ec.apply(C5(RYe,FYe,Dh,nT,yw,Nh,kB,AB,Ih,WB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ptt(){return Ec.apply(C5(NYe,DYe,Fh,rT,xw,Rh,IB,OB,Ih,VB).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function WT(){var e=0,t=1,n,r,i,a,o=Qo,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(Wh),l.rangeRound=c(Hw),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Vh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function A5(){var e=rm(WT()(Qo));return e.copy=function(){return Vh(e,A5())},zh.apply(e,arguments)}function Gle(){var e=w5(WT()).domain([1,10]);return e.copy=function(){return Vh(e,Gle()).base(e.base())},zh.apply(e,arguments)}function Kle(){var e=_5(WT());return e.copy=function(){return Vh(e,Kle()).constant(e.constant())},zh.apply(e,arguments)}function k5(){var e=S5(WT());return e.copy=function(){return Vh(e,k5()).exponent(e.exponent())},zh.apply(e,arguments)}function gtt(){return k5.apply(null,arguments).exponent(.5)}function VT(){var e=0,t=.5,n=1,r=1,i,a,o,s,u,l=Qo,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-a)*(r*g<r*a?s:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),a=c(t=+t),o=c(n=+n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=m5(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(Wh),h.rangeRound=p(Hw),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),a=g(t),o=g(n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function Xle(){var e=rm(VT()(Qo));return e.copy=function(){return Vh(e,Xle())},zh.apply(e,arguments)}function Yle(){var e=w5(VT()).domain([.1,1,10]);return e.copy=function(){return Vh(e,Yle()).base(e.base())},zh.apply(e,arguments)}function Zle(){var e=_5(VT());return e.copy=function(){return Vh(e,Zle()).constant(e.constant())},zh.apply(e,arguments)}function T5(){var e=S5(VT());return e.copy=function(){return Vh(e,T5()).exponent(e.exponent())},zh.apply(e,arguments)}function mtt(){return T5.apply(null,arguments).exponent(.5)}function O5(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const vtt="identity",yy="linear",Yf="log",Xw="pow",Yw="sqrt",qT="symlog",im="time",am="utc",Tc="sequential",by="diverging",xy="quantile",HT="quantize",GT="threshold",I5="ordinal",N5="point",Jle="band",D5="bin-ordinal",Ui="continuous",Zw="discrete",Jw="discretizing",vu="interpolating",R5="temporal";function ytt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function btt(e){return function(t){const n=e.range();let r=t[0],i=t[1],a=-1,o,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(a<0&&(a=u),o=u);if(!(a<0))return r=e.invertExtent(n[a]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function F5(){const e=e5().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,a,o=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=O5(f,s,u);let g=r[d-0];i=(h-g)/(p||1),o&&(i=Math.floor(i)),g+=(h-g-i*(f-s))*l,a=i*(1-s),o&&(g=Math.round(g),a=Math.round(a));const m=Ps(f).map(v=>g+i*v);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>r[1-d])))return v=Math.max(0,Qk(h,g)-1),y=g===m?v:Qk(h,m)-1,g-h[v]>a+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return F5().domain(t()).range(r).round(o).paddingInner(s).paddingOuter(u).align(l)},c()}function Qle(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Qle(t())},e}function xtt(){return Qle(F5().paddingInner(1))}var wtt=Array.prototype.map;function _tt(e){return wtt.call(e,La)}const Stt=Array.prototype.slice;function ece(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(gw(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=_tt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Stt.call(r),n):t.slice()},n.tickFormat=function(r,i){return Dle(e[0],An(e),r??10,i)},n.copy=function(){return ece().domain(n.domain()).range(n.range())},n}const KT={};function Ett(e,t,n){const r=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?ytt(a):a.invertExtent?btt(a):void 0),a.type=e,a};return r.metadata=hl(Dt(n)),r}function Wn(e,t,n){return arguments.length>1?(KT[e]=Ett(e,t,n),this):tce(e)?KT[e]:void 0}Wn(vtt,Fle),Wn(yy,Rle,Ui),Wn(Yf,Ble,[Ui,Yf]),Wn(Xw,E5,Ui),Wn(Yw,ctt,Ui),Wn(qT,Ule,Ui),Wn(im,htt,[Ui,R5]),Wn(am,ptt,[Ui,R5]),Wn(Tc,A5,[Ui,vu]),Wn("".concat(Tc,"-").concat(yy),A5,[Ui,vu]),Wn("".concat(Tc,"-").concat(Yf),Gle,[Ui,vu,Yf]),Wn("".concat(Tc,"-").concat(Xw),k5,[Ui,vu]),Wn("".concat(Tc,"-").concat(Yw),gtt,[Ui,vu]),Wn("".concat(Tc,"-").concat(qT),Kle,[Ui,vu]),Wn("".concat(by,"-").concat(yy),Xle,[Ui,vu]),Wn("".concat(by,"-").concat(Yf),Yle,[Ui,vu,Yf]),Wn("".concat(by,"-").concat(Xw),T5,[Ui,vu]),Wn("".concat(by,"-").concat(Yw),mtt,[Ui,vu]),Wn("".concat(by,"-").concat(qT),Zle,[Ui,vu]),Wn(xy,Vle,[Jw,xy]),Wn(HT,qle,Jw),Wn(GT,Hle,Jw),Wn(D5,ece,[Zw,Jw]),Wn(I5,e5,Zw),Wn(Jle,F5,Zw),Wn(N5,xtt,Zw);function tce(e){return Rt(KT,e)}function om(e,t){const n=KT[e];return n&&n.metadata[t]}function M5(e){return om(e,Ui)}function wy(e){return om(e,Zw)}function P5(e){return om(e,Jw)}function nce(e){return om(e,Yf)}function Ctt(e){return om(e,R5)}function rce(e){return om(e,vu)}function ice(e){return om(e,xy)}const Att=["clamp","base","constant","exponent"];function ace(e,t){const n=t[0],r=An(t)-n;return function(i){return e(n+i*r)}}function XT(e,t,n){return m5($5(t||"rgb",n),e)}function oce(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function sce(e,t,n){const r=n-t;let i,a,o;return!r||!Number.isFinite(r)?Ba(.5):(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Wn(a)().domain([t,n]).range([0,1]),Att.forEach(s=>e[s]?o[s](e[s]()):0),o)}function $5(e,t){const n=Het[ktt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function ktt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Ttt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Ott={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function uce(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function lce(e,t){for(const n in e)L5(n,t(e[n]))}const cce={};lce(Ott,uce),lce(Ttt,e=>XT(uce(e)));function L5(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(cce[e]=t,this):cce[e]}const YT="symbol",Itt="discrete",Ntt="gradient",Dtt=e=>bt(e)?e.map(t=>String(t)):String(e),Rtt=(e,t)=>e[1]-t[1],Ftt=(e,t)=>t[1]-e[1];function B5(e,t,n){let r;return kh(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(dw(e.domain())/n||1)))),Xt(t)&&(r=t.step,t=t.interval),lr(t)&&(t=e.type===im?ry(t):e.type==am?iy(t):Ie("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function fce(e,t,n){let r=e.range(),i=r[0],a=An(r),o=Rtt;if(i>a&&(r=a,a=i,i=r,o=Ftt),i=Math.floor(i),a=Math.ceil(a),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=a).sort(o).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],An(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function z5(e,t){return e.bins?fce(e,e.bins):e.ticks?e.ticks(t):e.domain()}function dce(e,t,n,r,i,a){const o=t.type;let s=Dtt;if(o===im||i===im)s=e.timeFormat(r);else if(o===am||i===am)s=e.utcFormat(r);else if(nce(o)){const u=e.formatFloat(r);if(a||t.bins)s=u;else{const l=hce(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function hce(e,t,n){const r=z5(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(s):s}const j5={[xy]:"quantiles",[HT]:"thresholds",[GT]:"domain"},pce={[xy]:"quantiles",[HT]:"domain"};function gce(e,t){return e.bins?$tt(e.bins):e.type===Yf?hce(e,t,!0):j5[e.type]?Ptt(e[j5[e.type]]()):z5(e,t)}function Mtt(e,t,n){const r=t[pce[t.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,3*10,n)}function Ptt(e){const t=[-1/0].concat(e);return t.max=1/0,t}function $tt(e){const t=e.slice(0,-1);return t.max=An(e),t}const Ltt=e=>j5[e.type]||e.bins;function mce(e,t,n,r,i,a,o){const s=pce[t.type]&&a!==im&&a!==am?Mtt(e,t,i):dce(e,t,n,i,a,o);return r===YT&&Ltt(t)?Btt(s):r===Itt?ztt(s):jtt(s)}const Btt=e=>(t,n,r)=>{const i=vce(r[n+1],vce(r.max,1/0)),a=yce(t,e),o=yce(i,e);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},vce=(e,t)=>e??t,ztt=e=>(t,n)=>n?e(t):null,jtt=e=>t=>e(t),yce=(e,t)=>Number.isFinite(e)?t(e):null;function Utt(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+An(t),a=i-r;if(e.type===GT){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function Wtt(e,t,n,r){const i=r||t.type;return lr(n)&&Ctt(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===im?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===am?e.utcFormat("%A, %d %B %Y, %X UTC"):mce(e,t,5,null,n,r,!0)}function bce(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Wtt(e,t,n.format,n.formatType);if(P5(t.type)){const a=gce(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(wy(t.type)){const a=t.domain(),o=a.length,s=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(s)}else{const a=t.domain();return"values from ".concat(i(a[0])," to ").concat(i(An(a)))}}let xce=0;function Vtt(){xce=0}const ZT="p_";function U5(e){return e&&e.gradient}function wce(e,t,n){const r=e.gradient;let i=e.id,a=r==="radial"?ZT:"";return i||(i=e.id="gradient_"+xce++,r==="radial"?(e.x1=Oc(e.x1,.5),e.y1=Oc(e.y1,.5),e.r1=Oc(e.r1,0),e.x2=Oc(e.x2,.5),e.y2=Oc(e.y2,.5),e.r2=Oc(e.r2,.5),a=ZT):(e.x1=Oc(e.x1,0),e.y1=Oc(e.y1,0),e.x2=Oc(e.x2,1),e.y2=Oc(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+a+i+")"}function Oc(e,t){return e??t}function _ce(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const Sce={basis:{curve:VQe},"basis-closed":{curve:qQe},"basis-open":{curve:HQe},bundle:{curve:GQe,tension:"beta",value:.85},cardinal:{curve:KQe,tension:"tension",value:0},"cardinal-open":{curve:YQe,tension:"tension",value:0},"cardinal-closed":{curve:XQe,tension:"tension",value:0},"catmull-rom":{curve:ZQe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:JQe,tension:"alpha",value:.5},"catmull-rom-open":{curve:QQe,tension:"alpha",value:.5},linear:{curve:Gz},"linear-closed":{curve:eet},monotone:{horizontal:net,vertical:tet},natural:{curve:ret},step:{curve:iet},"step-after":{curve:oet},"step-before":{curve:aet}};function W5(e,t,n){var r=Rt(Sce,e)&&Sce[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const qtt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Qw=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function _y(e){const t=[];let n,r,i,a,o,s,u,l,c,f;const d=e.slice().replace(Qw[0],"###$1").split(Qw[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(Qw[2],"$1###$2").replace(Qw[3],"$1###$2").split(Qw[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(s=qtt[o.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=s))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=s)t.push([o].concat(i.slice(l,l+s)))}else t.push(i)}return t}const qh=Math.PI/180,Htt=1e-14,sm=Math.PI/2,Ic=Math.PI*2,Sy=Math.sqrt(3)/2;var V5={},q5={},Ece=[].join;function Gtt(e,t,n,r,i,a,o,s,u){const l=Ece.call(arguments);if(V5[l])return V5[l];const c=o*qh,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,x=m*s+v*u,w=y*s+b*u,S=m*e+v*t,C=y*e+b*t,_=(S-x)*(S-x)+(C-w)*(C-w);let E=1/_-.25;E<0&&(E=0);let A=Math.sqrt(E);a==i&&(A=-A);const k=.5*(x+S)-A*(C-w),T=.5*(w+C)+A*(S-x),I=Math.atan2(w-T,x-k);let O=Math.atan2(C-T,S-k)-I;O<0&&a===1?O+=Ic:O>0&&a===0&&(O-=Ic);const D=Math.ceil(Math.abs(O/(sm+.001))),P=[];for(let V=0;V<D;++V){const Y=I+V*O/D,X=I+(V+1)*O/D;P[V]=[k,T,Y,X,n,r,f,d]}return V5[l]=P}function Ktt(e){const t=Ece.call(e);if(q5[t])return q5[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7];const c=l*o,f=-u*s,d=u*o,h=l*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,S=r+g+x*p,C=n+m,_=r+v,E=C+x*v,A=_-x*m;return q5[t]=[c*w+f*S,d*w+h*S,c*E+f*A,d*E+h*A,c*C+f*_,d*C+h*_]}const yu=["l",0,0,0,0,0,0,0];function Xtt(e,t,n){const r=yu[0]=e[0];if(r==="a"||r==="A")yu[1]=t*e[1],yu[2]=n*e[2],yu[3]=e[3],yu[4]=e[4],yu[5]=e[5],yu[6]=t*e[6],yu[7]=n*e[7];else if(r==="h"||r==="H")yu[1]=t*e[1];else if(r==="v"||r==="V")yu[1]=n*e[1];else for(var i=1,a=e.length;i<a;++i)yu[i]=(i%2==1?t:n)*e[i];return yu}function e2(e,t,n,r,i,a){var o,s=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(o=t[m],(i!==1||a!==1)&&(o=Xtt(o,i,a)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-p,f=2*l-g):s[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":Cce(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":Cce(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}s=o}}function Cce(e,t,n,r){const i=Gtt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let a=0;a<i.length;++a){const o=Ktt(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Ace=.5773502691896257,kce={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ic)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n,i=r-n*Ace,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n,i=r-n*Ace;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Sy*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Tce(e){return Rt(kce,e)?kce[e]:Ytt(e)}var H5={};function Ytt(e){if(!Rt(H5,e)){const t=_y(e);H5[e]={draw:function(n,r){e2(n,t,0,0,Math.sqrt(r)/2)}}}return H5[e]}const Hh=.448084975506;function Ztt(e){return e.x}function Jtt(e){return e.y}function Qtt(e){return e.width}function ent(e){return e.height}function Zf(e){return typeof e=="function"?e:()=>+e}function JT(e,t,n){return Math.max(t,Math.min(e,n))}function Oce(){var e=Ztt,t=Jtt,n=Qtt,r=ent,i=Zf(0),a=i,o=i,s=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=JT(+i.call(this,c),0,y),x=JT(+a.call(this,c),0,y),w=JT(+o.call(this,c),0,y),S=JT(+s.call(this,c),0,y);if(u||(u=h=Qg()),b<=0&&x<=0&&w<=0&&S<=0)u.rect(p,g,m,v);else{var C=p+m,_=g+v;u.moveTo(p+b,g),u.lineTo(C-x,g),u.bezierCurveTo(C-Hh*x,g,C,g+Hh*x,C,g+x),u.lineTo(C,_-S),u.bezierCurveTo(C,_-Hh*S,C-Hh*S,_,C-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+Hh*w,_,p,_-Hh*w,p,_-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+Hh*b,p+Hh*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Zf(c),l):e},l.y=function(c){return arguments.length?(t=Zf(c),l):t},l.width=function(c){return arguments.length?(n=Zf(c),l):n},l.height=function(c){return arguments.length?(r=Zf(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=Zf(c),a=f!=null?Zf(f):i,s=d!=null?Zf(d):i,o=h!=null?Zf(h):a,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function Ice(){var e,t,n,r,i=null,a,o,s,u;function l(f,d,h){const p=h/2;if(a){var g=s-d,m=f-o;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,x=Math.atan2(m,g);i.moveTo(o-y,s-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,x-Math.PI,x),i.lineTo(o+y,s+b),i.arc(o,s,u,x,x+Math.PI)}else i.arc(f,d,p,0,Ic);i.closePath()}else a=1;o=f,s=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=Qg()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(a=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function t2(e,t){return e??t}const n2=e=>e.x||0,r2=e=>e.y||0,tnt=e=>e.width||0,nnt=e=>e.height||0,rnt=e=>(e.x||0)+(e.width||0),int=e=>(e.y||0)+(e.height||0),ant=e=>e.startAngle||0,ont=e=>e.endAngle||0,snt=e=>e.padAngle||0,unt=e=>e.innerRadius||0,lnt=e=>e.outerRadius||0,cnt=e=>e.cornerRadius||0,fnt=e=>t2(e.cornerRadiusTopLeft,e.cornerRadius)||0,dnt=e=>t2(e.cornerRadiusTopRight,e.cornerRadius)||0,hnt=e=>t2(e.cornerRadiusBottomRight,e.cornerRadius)||0,pnt=e=>t2(e.cornerRadiusBottomLeft,e.cornerRadius)||0,gnt=e=>t2(e.size,64),mnt=e=>e.size||1,QT=e=>e.defined!==!1,vnt=e=>Tce(e.shape||"circle"),ynt=jQe().startAngle(ant).endAngle(ont).padAngle(snt).innerRadius(unt).outerRadius(lnt).cornerRadius(cnt),bnt=wue().x(n2).y1(r2).y0(int).defined(QT),xnt=wue().y(r2).x1(n2).x0(rnt).defined(QT),wnt=xue().x(n2).y(r2).defined(QT),_nt=Oce().x(n2).y(r2).width(tnt).height(nnt).cornerRadius(fnt,dnt,hnt,pnt),Snt=WQe().type(vnt).size(gnt),Ent=Ice().x(n2).y(r2).defined(QT).size(mnt);function G5(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Cnt(e,t){return ynt.context(e)(t)}function Ant(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?xnt:bnt).curve(W5(r,n.orient,n.tension)).context(e)(t)}function knt(e,t){const n=t[0],r=n.interpolate||"linear";return wnt.curve(W5(r,n.orient,n.tension)).context(e)(t)}function Ey(e,t,n,r){return _nt.context(e)(t,n,r)}function Tnt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Ont(e,t){return Snt.context(e)(t)}function Int(e,t){return Ent.context(e)(t)}var Nce=1;function Dce(){Nce=1}function K5(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Nce++),o=i.clipping[a]||(i.clipping[a]={id:a});return nn(r)?o.path=r(null):G5(n)?o.path=Ey(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function Wi(e){this.clear(),e&&this.union(e)}Wi.prototype={clone(){return new Wi(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*o+l,u*r+s*o+c,s*a-u*i+l,u*a+s*i+c,s*a-u*o+l,u*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function eO(e){this.mark=e,this.bounds=this.bounds||new Wi}function tO(e){eO.call(this,e),this.items=this.items||[]}Ge(tO,eO);function X5(e){this._pending=0,this._loader=e||oT()}function Rce(e){e._pending+=1}function i2(e){e._pending-=1}X5.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Rce(t),t._loader.sanitize(e,{context:"href"}).then(n=>(i2(t),n)).catch(()=>(i2(t),null))},loadImage(e){const t=this,n=set();return Rce(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=Rt(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>i2(t),a.onerror=()=>i2(t),a.src=i,a}).catch(r=>(i2(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Jf(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Nnt(t,r):0))}return e}function Nnt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Dnt=Ic-1e-8;let nO,rO,iO,um,Y5,aO,Z5,J5;const Gh=(e,t)=>nO.add(e,t),oO=(e,t)=>Gh(rO=e,iO=t),Fce=e=>Gh(e,nO.y1),Mce=e=>Gh(nO.x1,e),lm=(e,t)=>Y5*e+Z5*t,cm=(e,t)=>aO*e+J5*t,Q5=(e,t)=>Gh(lm(e,t),cm(e,t)),e6=(e,t)=>oO(lm(e,t),cm(e,t));function a2(e,t){return nO=e,t?(um=t*qh,Y5=J5=Math.cos(um),aO=Math.sin(um),Z5=-aO):(Y5=J5=1,um=aO=Z5=0),Rnt}const Rnt={beginPath(){},closePath(){},moveTo:e6,lineTo:e6,rect(e,t,n,r){um?(Q5(e+n,t),Q5(e+n,t+r),Q5(e,t+r),e6(e,t)):(Gh(e+n,t+r),oO(e,t))},quadraticCurveTo(e,t,n,r){const i=lm(e,t),a=cm(e,t),o=lm(n,r),s=cm(n,r);Pce(rO,i,o,Fce),Pce(iO,a,s,Mce),oO(o,s)},bezierCurveTo(e,t,n,r,i,a){const o=lm(e,t),s=cm(e,t),u=lm(n,r),l=cm(n,r),c=lm(i,a),f=cm(i,a);$ce(rO,o,u,c,Fce),$ce(iO,s,l,f,Mce),oO(c,f)},arc(e,t,n,r,i,a){if(r+=um,i+=um,rO=n*Math.cos(i)+e,iO=n*Math.sin(i)+t,Math.abs(i-r)>Dnt)Gh(e-n,t-n),Gh(e+n,t+n);else{const o=l=>Gh(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(o(r),o(i),i!==r)if(r=r%Ic,r<0&&(r+=Ic),i=i%Ic,i<0&&(i+=Ic),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=Ic,s=r-r%sm,u=0;u<4&&s>i;++u,s-=sm)o(s);else for(s=r-r%sm+sm,u=0;u<4&&s<i;++u,s=s+sm)o(s)}}};function Pce(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function $ce(e,t,n,r,i){const a=r-e+3*t-3*n,o=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(a)>Htt?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(Lce(u,e,t,n,r)),0<l&&l<1&&i(Lce(l,e,t,n,r))}function Lce(e,t,n,r,i){const a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*r+s*e*i}var Kh=(Kh=dy(1,1))?Kh.getContext("2d"):null;const t6=new Wi;function n6(e){return function(t,n){if(!Kh)return!0;e(Kh,t),t6.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=t6;for(let s=i;s<=o;++s)for(let u=r;u<=a;++u)if(Kh.isPointInPath(u,s))return!0;return!1}}function r6(e,t){return t.contains(e.x||0,e.y||0)}function Bce(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(t6.set(n,r,n+i,r+a))}function zce(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return Cy(t,n,r,i,a)}function Cy(e,t,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(a-t)),m===1&&(h=l,p=s-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Ay(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ml(e,t){return e??t}function jce(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Fnt(e,t,n){const r=n.width(),i=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+ml(t.x1,.5)*r,n.y1+ml(t.y1,.5)*i,Math.max(r,i)*ml(t.r1,0),n.x1+ml(t.x2,.5)*r,n.y1+ml(t.y2,.5)*i,Math.max(r,i)*ml(t.r2,.5));else{const o=ml(t.x1,0),s=ml(t.y1,0),u=ml(t.x2,1),l=ml(t.y2,0);if(o===u||s===l||r===i)a=e.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=dy(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=jce(f.createLinearGradient(o,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return jce(a,t.stops)}function Uce(e,t,n){return U5(n)?Fnt(e,n,t.bounds):n}function sO(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Uce(e,t,t.fill),!0):!1}var Mnt=[];function ky(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Uce(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Mnt),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Pnt(e,t){return e.zindex-t.zindex||e.index-t.index}function i6(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Pnt)}function vl(e,t){var n=e.items,r,i;if(!n||!n.length)return;const a=i6(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=a}for(r=0,i=n.length;r<i;++r)t(n[r])}function uO(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const a=i6(e);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===a){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function a6(e){return function(t,n,r){vl(n,i=>{(!r||r.intersects(i.bounds))&&Wce(e,t,i,i)})}}function $nt(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&Wce(e,t,n.items[0],n.items)}}function Wce(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Ay(t,n),n.fill&&sO(t,n,i)&&t.fill(),n.stroke&&ky(t,n,i)&&t.stroke()))}function lO(e){return e=e||hu,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,uO(n,s=>{const u=s.bounds;if(!(u&&!u.contains(a,o)||!u)&&e(t,s,r,i,a,o))return s})}}function o2(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,s=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:s&&n.isPointInPath(i,a)||u&&n.isPointInStroke(i,a)}}function o6(e){return lO(o2(e))}function fm(e,t){return"translate("+e+","+t+")"}function s6(e){return"rotate("+e+")"}function Lnt(e,t){return"scale("+e+","+t+")"}function Vce(e){return fm(e.x||0,e.y||0)}function Bnt(e){return fm(e.x||0,e.y||0)+(e.angle?" "+s6(e.angle):"")}function znt(e){return fm(e.x||0,e.y||0)+(e.angle?" "+s6(e.angle):"")+(e.scaleX||e.scaleY?" "+Lnt(e.scaleX||1,e.scaleY||1):"")}function u6(e,t,n){function r(o,s){o("transform",Bnt(s)),o("d",t(null,s))}function i(o,s){return t(a2(o,s.angle),s),Jf(o,s).translate(s.x||0,s.y||0)}function a(o,s){var u=s.x||0,l=s.y||0,c=s.angle||0;o.translate(u,l),c&&o.rotate(c*=qh),o.beginPath(),t(o,s),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:a6(a),pick:o6(a),isect:n||n6(a)}}var jnt=u6("arc",Cnt);function Unt(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=1/0,o,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<a&&(a=s,o=e[i]));return o}function Wnt(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],a=e[r].y-t[1],o=i*i+a*a,o<n))return e[r];return null}function Vnt(e,t){for(var n=e.length,r,i,a;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],a=r*r+i*i,r=e[n].size||1,a<r*r))return e[n];return null}function l6(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(a2(u),c),Jf(u,c[0]))}function a(u,l){u.beginPath(),t(u,l)}const o=o2(a);function s(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:$nt(a),pick:s,isect:r6,tip:n}}var qnt=l6("area",Ant,Unt);function Hnt(e,t){var n=t.clip;e.save(),nn(n)?(e.beginPath(),n(e),e.clip()):qce(e,t.group)}function qce(e,t){e.beginPath(),G5(t)?Ey(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Hce(e){const t=ml(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Gnt(e,t){e("transform",Vce(t))}function Gce(e,t){const n=Hce(t);e("d",Ey(null,t,n,n))}function Knt(e,t){e("class","background"),e("aria-hidden",!0),Gce(e,t)}function Xnt(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Gce(e,t):e("d","")}function Ynt(e,t,n){const r=t.clip?K5(n,t,t):null;e("clip-path",r)}function Znt(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Jf(e,t),e.translate(t.x||0,t.y||0)}function s2(e,t,n,r){const i=Hce(t);e.beginPath(),Ey(e,t,(n||0)+i,(r||0)+i)}const Jnt=o2(s2),Qnt=o2(s2,!1),ert=o2(s2,!0);function trt(e,t,n){vl(t,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(s2(e,r,i,a),Ay(e,r),r.fill&&sO(e,r,s)&&e.fill(),r.stroke&&!o&&ky(e,r,s)&&e.stroke()),e.save(),e.translate(i,a),r.clip&&qce(e,r),n&&n.translate(-i,-a),vl(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,a),e.restore(),o&&r.stroke&&s&&(s2(e,r,i,a),Ay(e,r),ky(e,r,s)&&e.stroke())})}function nrt(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;const o=n*e.pixelRatio,s=r*e.pixelRatio;return uO(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,a))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||a<f||a>p))return;if(e.save(),e.translate(c,f),c=i-c,f=a-f,g&&G5(u)&&!ert(e,u,o,s))return e.restore(),null;const m=u.strokeForeground,v=t.interactive!==!1;return v&&m&&u.stroke&&Qnt(e,u,o,s)?(e.restore(),u):(l=uO(u,y=>rrt(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&Jnt(e,u,o,s)&&(l=u),e.restore(),l||null)})}function rrt(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var irt={type:"group",tag:"g",nested:!1,attr:Gnt,bound:Znt,draw:trt,pick:nrt,isect:Bce,content:Ynt,background:Knt,foreground:Xnt},u2={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function c6(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function f6(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function d6(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function cO(e,t){return e==="center"?t/2:e==="right"?t:0}function fO(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function art(e,t,n){const r=c6(t,n),i=f6(t,r),a=d6(t,r),o=(t.x||0)-cO(t.align,i),s=(t.y||0)-fO(t.baseline,a),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,u2["xmlns:xlink"],"xlink:href"),e("transform",fm(o,s)),e("width",i),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function ort(e,t){const n=t.image,r=f6(t,n),i=d6(t,n),a=(t.x||0)-cO(t.align,r),o=(t.y||0)-fO(t.baseline,i);return e.set(a,o,a+r,o+i)}function srt(e,t,n){vl(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=c6(r,this);let a=f6(r,i),o=d6(r,i);if(a===0||o===0)return;let s=(r.x||0)-cO(r.align,a),u=(r.y||0)-fO(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=a/c,u+=(o-d)/2,o=d):(d=o*c,s+=(a-d)/2,a=d))),(i.complete||i.toDataURL)&&(Ay(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,a,o))})}var urt={type:"image",tag:"image",nested:!1,attr:art,bound:ort,draw:srt,pick:lO(),isect:hu,get:c6,xOffset:cO,yOffset:fO},lrt=l6("line",knt,Wnt);function crt(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",znt(t)),e("d",t.path)}function dO(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*qh,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=_y(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),e2(e,u,0,0,a,o),e.rotate(-s),e.translate(-r,-i)):e2(e,u,r,i,a,o)}function frt(e,t){return dO(a2(e,t.angle),t)?e.set(0,0,0,0):Jf(e,t,!0)}var drt={type:"path",tag:"path",nested:!1,attr:crt,bound:frt,draw:a6(dO),pick:o6(dO),isect:n6(dO)};function hrt(e,t){e("d",Ey(null,t))}function prt(e,t){var n,r;return Jf(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Kce(e,t){e.beginPath(),Ey(e,t)}var grt={type:"rect",tag:"path",nested:!1,attr:hrt,bound:prt,draw:a6(Kce),pick:o6(Kce),isect:Bce};function mrt(e,t){e("transform",Vce(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function vrt(e,t){var n,r;return Jf(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Xce(e,t,n){var r,i,a,o;return t.stroke&&ky(e,t,n)?(r=t.x||0,i=t.y||0,a=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0):!1}function yrt(e,t,n){vl(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&Xce(e,r,i)&&(Ay(e,r),e.stroke())}})}function brt(e,t,n,r){return e.isPointInStroke?Xce(e,t,1)&&e.isPointInStroke(n,r):!1}var xrt={type:"rule",tag:"line",nested:!1,attr:mrt,bound:vrt,draw:yrt,pick:lO(brt),isect:zce},wrt=u6("shape",Tnt),_rt=u6("symbol",Ont,r6);const Yce=Rae();var Nc={height:Dc,measureWidth:p6,estimateWidth:h6,width:h6,canvas:Zce};Zce(!0);function Zce(e){Nc.width=e&&Kh?p6:h6}function h6(e,t){return Jce(Yh(e,t),Dc(e))}function Jce(e,t){return~~(.8*e.length*t)}function p6(e,t){return Dc(e)<=0||!(t=Yh(e,t))?0:Qce(t,hO(e))}function Qce(e,t){const n=`(${t}) ${e}`;let r=Yce.get(n);return r===void 0&&(Kh.font=t,r=Kh.measureText(e).width,Yce.set(n,r)),r}function Dc(e){return e.fontSize!=null?+e.fontSize||0:11}function Xh(e){return e.lineHeight!=null?e.lineHeight:Dc(e)+2}function Srt(e){return bt(e)?e.length>1?e:e[0]:e}function l2(e){return Srt(e.lineBreak&&e.text&&!bt(e.text)?e.text.split(e.lineBreak):e.text)}function g6(e){const t=l2(e);return(bt(t)?t.length-1:0)*Xh(e)}function Yh(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Crt(e,n):n}function Ert(e){if(Nc.width===p6){const t=hO(e);return n=>Qce(n,t)}else{const t=Dc(e);return n=>Jce(n,t)}}function Crt(e,t){var n=+e.limit,r=Ert(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",a=e.dir==="rtl",o=0,s=t.length,u;if(n-=r(i),a){for(;o<s;)u=o+s>>>1,r(t.slice(u))>n?o=u+1:s=u;return i+t.slice(o)}else{for(;o<s;)u=1+(o+s>>>1),r(t.slice(0,u))<n?o=u:s=u-1;return t.slice(0,o)+i}}function c2(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function hO(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Dc(e)+"px "+c2(e,t)}function m6(e){var t=e.baseline,n=Dc(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Xh(e):t==="line-bottom"?.29*n-.5*Xh(e):0)}const Art={left:"start",center:"middle",right:"end"},f2=new Wi;function pO(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-sm,t+=r*Math.cos(i),n+=r*Math.sin(i)),f2.x1=t,f2.y1=n,f2}function krt(e,t){var n=t.dx||0,r=(t.dy||0)+m6(t),i=pO(t),a=i.x1,o=i.y1,s=t.angle||0,u;e("text-anchor",Art[t.align]||"start"),s?(u=fm(a,o)+" "+s6(s),(n||r)&&(u+=" "+fm(n,r))):u=fm(a+n,o+r),e("transform",u)}function v6(e,t,n){var r=Nc.height(t),i=t.align,a=pO(t),o=a.x1,s=a.y1,u=t.dx||0,l=(t.dy||0)+m6(t)-Math.round(.8*r),c=l2(t),f;if(bt(c)?(r+=Xh(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Nc.width(t,h)),0)):f=Nc.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*qh,o,s);else if(n===2)return e.rotatedPoints(t.angle*qh,o,s);return e}function Trt(e,t,n){vl(t,r=>{var i=r.opacity==null?1:r.opacity,a,o,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=hO(r),e.textAlign=r.align||"left",a=pO(r),o=a.x1,s=a.y1,r.angle&&(e.save(),e.translate(o,s),e.rotate(r.angle*qh),o=s=0),o+=r.dx||0,s+=(r.dy||0)+m6(r),c=l2(r),Ay(e,r),bt(c))for(l=Xh(r),u=0;u<c.length;++u)f=Yh(r,c[u]),r.fill&&sO(e,r,i)&&e.fillText(f,o,s),r.stroke&&ky(e,r,i)&&e.strokeText(f,o,s),s+=l;else f=Yh(r,c),r.fill&&sO(e,r,i)&&e.fillText(f,o,s),r.stroke&&ky(e,r,i)&&e.strokeText(f,o,s);r.angle&&e.restore()}})}function Ort(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=pO(t),s=o.x1,u=o.y1,l=v6(f2,t,1),c=-t.angle*qh,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(s-f*s+d*u),p=d*i+f*a+(u-d*s-f*u);return l.contains(h,p)}function Irt(e,t){const n=v6(f2,e,2);return Cy(t,n[0],n[1],n[2],n[3])||Cy(t,n[0],n[1],n[4],n[5])||Cy(t,n[4],n[5],n[6],n[7])||Cy(t,n[2],n[3],n[6],n[7])}var Nrt={type:"text",tag:"text",nested:!1,attr:krt,bound:v6,draw:Trt,pick:lO(Ort),isect:Irt},Drt=l6("trail",Int,Vnt),Bs={arc:jnt,area:qnt,group:irt,image:urt,line:lrt,path:drt,rect:grt,rule:xrt,shape:wrt,symbol:_rt,text:Nrt,trail:Drt};function y6(e,t,n){var r=Bs[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Wi),e,n)}var efe={mark:null};function tfe(e,t,n){var r=Bs[e.marktype],i=r.bound,a=e.items,o=a&&a.length,s,u,l,c;if(r.nested)return o?l=a[0]:(efe.mark=e,l=efe),c=y6(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Wi,o)for(s=0,u=a.length;s<u;++s)t.union(y6(a[s],i,n));return e.bounds=t}const Rrt=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function nfe(e,t){return JSON.stringify(e,Rrt,t)}function rfe(e){const t=typeof e=="string"?JSON.parse(e):e;return ife(t)}function ife(e){var t=e.marktype,n=e.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&ife(n[i]);return t&&tfe(e),e}function b6(e){arguments.length?this.root=rfe(e):(this.root=afe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new tO(this.root)])}b6.prototype={toJSON(e){return nfe(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=afe(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function afe(e,t){const n={bounds:new Wi,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Zh(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function x6(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function es(e,t,n,r){var i=e.childNodes[t],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=Zh(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function yl(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function ofe(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function gO(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Frt(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Bs[i.marktype]).tip){for(o=gO(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=a.tip(i.items,o)}return e}function Jh(e,t){this._active=null,this._handlers={},this._loader=e||oT(),this._tooltip=t||Mrt}function Mrt(e,t,n,r){e.element().setAttribute("title",r||"")}Jh.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),a=Zh(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Frt(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}};function Rc(e){this._el=null,this._bgcolor=null,this._loader=new X5(e)}Rc.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Prt="keydown",$rt="keypress",Lrt="keyup",sfe="dragenter",mO="dragleave",ufe="dragover",w6="mousedown",Brt="mouseup",vO="mousemove",d2="mouseout",lfe="mouseover",yO="click",zrt="dblclick",jrt="wheel",cfe="mousewheel",bO="touchstart",xO="touchmove",wO="touchend",Urt=[Prt,$rt,Lrt,sfe,mO,ufe,w6,Brt,vO,d2,lfe,yO,zrt,jrt,cfe,bO,xO,wO],_6=vO,h2=d2,S6=yO;function p2(e,t){Jh.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Wrt=e=>e===bO||e===xO||e===wO?[bO,xO,wO]:[e];function ffe(e,t){Wrt(t).forEach(n=>Vrt(e,n))}function Vrt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function dfe(e,t,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function hfe(e){return function(t){this.fire(e,t),this._active=null}}Ge(p2,Jh,{initialize(e,t,n){return this._canvas=e&&x6(e,"canvas"),[yO,w6,vO,d2,mO].forEach(r=>ffe(this,r)),Jh.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Urt,DOMMouseScroll(e){this.fire(cfe,e)},mousemove:dfe(vO,lfe,d2),dragover:dfe(ufe,sfe,mO),mouseout:hfe(d2),dragleave:hfe(mO),mousedown(e){this._down=this._active,this.fire(w6,e)},click(e){this._down===this._active&&(this.fire(yO,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(bO,e,!0)},touchmove(e){this.fire(xO,e,!0)},touchend(e){this.fire(wO,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===S6&&r&&r.href?this.handleHref(t,r,r.href):(e===_6||e===h2)&&this.handleTooltip(t,r,e!==h2),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(ffe(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=gO(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const a=this.context();return Bs[e.marktype].pick.call(this,a,e,t,n,r,i)}});function qrt(){return typeof window!="undefined"&&window.devicePixelRatio||1}var Hrt=qrt();function Grt(e,t,n,r,i,a){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=o?Hrt:i;e.width=t*u,e.height=n*u;for(const l in a)s[l]=a[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function _O(e){Rc.call(this,e),this._options={},this._redraw=!1,this._dirty=new Wi,this._tempb=new Wi}const pfe=Rc.prototype,Krt=(e,t,n)=>new Wi().set(0,0,t,n).translate(-e[0],-e[1]);function Xrt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}Ge(_O,Rc,{initialize(e,t,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:dy(1,1,this._options.type),e&&this._canvas&&(yl(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),pfe.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(pfe.resize.call(this,e,t,n,r),this._canvas)Grt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||Ie("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=Krt(n,r,i);t.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):Xrt(t,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),a.clear(),this},draw(e,t,n){const r=Bs[t.marktype];t.clip&&Hnt(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(e,t,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,r))}});function E6(e,t){Jh.call(this,e,t);const n=this;n._hrefHandler=C6(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=C6(n,(r,i)=>{n.handleTooltip(r,i,r.type!==h2)})}const C6=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};Ge(E6,Jh,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(S6,this._hrefHandler),r.removeEventListener(_6,this._tooltipHandler),r.removeEventListener(h2,this._tooltipHandler)),this._svg=r=e&&x6(e,"svg"),r&&(r.addEventListener(S6,this._hrefHandler),r.addEventListener(_6,this._tooltipHandler),r.addEventListener(h2,this._tooltipHandler)),Jh.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const a={type:e,handler:t,listener:C6(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const gfe="aria-hidden",A6="aria-label",k6="role",T6="aria-roledescription",mfe="graphics-object",O6="graphics-symbol",vfe=(e,t,n)=>({[k6]:e,[T6]:t,[A6]:n||void 0}),Yrt=hl(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),yfe={axis:{desc:"axis",caption:Qrt},legend:{desc:"legend",caption:eit},"title-text":{desc:"title",caption:e=>`Title text '${_fe(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${_fe(e)}'`}},bfe={ariaRole:k6,ariaRoleDescription:T6,description:A6};function xfe(e,t){const n=t.aria===!1;if(e(gfe,n||void 0),n||t.description==null)for(const r in bfe)e(bfe[r],void 0);else{const r=t.mark.marktype;e(A6,t.description),e(k6,t.ariaRole||(r==="group"?mfe:O6)),e(T6,t.ariaRoleDescription||`${r} mark`)}}function wfe(e){return e.aria===!1?{[gfe]:!0}:Yrt[e.role]?null:yfe[e.role]?Jrt(e,yfe[e.role]):Zrt(e)}function Zrt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return vfe(n?mfe:O6,`${t} mark container`,e.description)}function Jrt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return vfe(t.role||O6,t.desc,n.description||r(n))}catch(n){return null}}function _fe(e){return Dt(e.text).join(" ")}function Qrt(e){const t=e.datum,n=e.orient,r=t.title?Sfe(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),s=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${wy(s)?"discrete":s} scale with ${bce(o,a,e)}`}function eit(e){const t=e.datum,n=t.title?Sfe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,a=Object.keys(i),o=e.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return nit(r)+(n?` titled '${n}'`:"")+` for ${tit(a)} with ${bce(u,s,e)}`}function Sfe(e){try{return Dt(An(e.items).items[0].text).join(" ")}catch(t){return null}}function tit(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+An(e)}function nit(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Efe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),rit=e=>Efe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function I6(){let e="",t="",n="";const r=[],i=()=>t=n="",a=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${rit(l)}"`),s),s={open(u,...l){a(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:o,text:u=>(n+=Efe(u),s),toString:()=>e};return s}const Cfe=e=>Afe(I6(),e)+"";function Afe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?e.text(a.nodeValue):Afe(e,a)}}return e.close()}const SO={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},kfe={fill:"none","stroke-miterlimit":10},g2=0,Tfe="http://www.w3.org/2000/xmlns/",Vi=u2.xmlns;function N6(e){Rc.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const D6=Rc.prototype;Ge(N6,Rc,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=es(e,0,"svg",Vi),this._svg.setAttributeNS(Tfe,"xmlns",Vi),this._svg.setAttributeNS(Tfe,"xmlns:xlink",u2["xmlns:xlink"]),this._svg.setAttribute("version",u2.version),this._svg.setAttribute("class","marks"),yl(e,1),this._root=es(this._svg,g2,"g",Vi),Qh(this._root,kfe),yl(this._svg,g2+1)),this.background(this._bgcolor),D6.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),D6.background.apply(this,arguments)},resize(e,t,n,r){return D6.resize.call(this,e,t,n,r),this._svg&&(Qh(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=es(e,g2,"rect",Vi),Qh(n,{width:this._width,height:this._height,fill:t}));const r=Cfe(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),yl(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=e.length;o<s;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Bs[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Ofe(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Ofe(n,t)):this._update(a,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Bs[t.marktype],a=t.interactive===!1?"none":null,o=i.tag==="g";let s=null,u=0;const l=Ife(t,e,n,"g",r);l.setAttribute("class",ofe(t));const c=wfe(t);for(const d in c)xo(l,d,c[d]);o||xo(l,"pointer-events",a),xo(l,"clip-path",t.clip?K5(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=Ife(d,l,s,i.tag,r);h&&(this._update(i,p,d),o&&oit(this,p,d)),s=p,++u};return i.nested?t.items.length&&f(t.items[0]):vl(t,f),yl(l,u),l},_update(e,t,n){Qf=t,Va=t.__values__,xfe(m2,n),e.attr(m2,n,this);const r=uit[e.type];r&&r.call(this,e,t,n),Qf&&this.style(Qf,n)},style(e,t){if(t!=null)for(const n in SO){let r=n==="font"?c2(t):t[n];if(r===Va[n])continue;const i=SO[n];r==null?e.removeAttribute(i):(U5(r)&&(r=wce(r,this._defs.gradient,Nfe())),e.setAttribute(i,r+"")),Va[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=es(e,g2+1,"defs",Vi)),r=iit(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=es(e,g2+1,"defs",Vi)),r=ait(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):yl(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function Ofe(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function iit(e,t,n){let r,i,a;if(t.gradient==="radial"){let o=es(e,n++,"pattern",Vi);Qh(o,{id:ZT+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=es(o,0,"rect",Vi),Qh(o,{width:1,height:1,fill:`url(${Nfe()}#${t.id})`}),e=es(e,n++,"radialGradient",Vi),Qh(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=es(e,n++,"linearGradient",Vi),Qh(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)a=es(e,r,"stop",Vi),a.setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return yl(e,r),n}function ait(e,t,n){let r;return e=es(e,n,"clipPath",Vi),e.setAttribute("id",t.id),t.path?(r=es(e,0,"path",Vi),r.setAttribute("d",t.path)):(r=es(e,0,"rect",Vi),Qh(r,{x:0,y:0,width:t.width,height:t.height})),yl(e,1),n+1}function oit(e,t,n){t=t.lastChild.previousSibling;let r,i=0;vl(n,a=>{r=e.mark(t,a,r),++i}),yl(t,1+i)}function Ife(e,t,n,r,i){let a=e._svg,o;if(!a&&(o=t.ownerDocument,a=Zh(o,r,Vi),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},r==="g"))){const s=Zh(o,"path",Vi);a.appendChild(s),s.__data__=e;const u=Zh(o,"g",Vi);a.appendChild(u),u.__data__=e;const l=Zh(o,"path",Vi);a.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||sit(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function sit(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Qf=null,Va=null;const uit={group(e,t,n){const r=Qf=t.childNodes[2];Va=r.__values__,e.foreground(m2,n,this),Va=t.__values__,Qf=t.childNodes[1],e.content(m2,n,this);const i=Qf=t.childNodes[0];e.background(m2,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==Va.events&&(xo(r,"pointer-events",a),xo(i,"pointer-events",a),Va.events=a),n.strokeForeground&&n.stroke){const o=n.fill;xo(r,"display",null),this.style(i,n),xo(i,"stroke",null),o&&(n.fill=null),Va=r.__values__,this.style(r,n),o&&(n.fill=o),Qf=null}else xo(r,"display","none")},image(e,t,n){n.smooth===!1?(R6(t,"image-rendering","optimizeSpeed"),R6(t,"image-rendering","pixelated")):R6(t,"image-rendering",null)},text(e,t,n){const r=l2(n);let i,a,o,s;bt(r)?(a=r.map(u=>Yh(n,u)),i=a.join(`
`),i!==Va.text&&(yl(t,0),o=t.ownerDocument,s=Xh(n),a.forEach((u,l)=>{const c=Zh(o,"tspan",Vi);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),Va.text=i)):(a=Yh(n,r),a!==Va.text&&(t.textContent=a,Va.text=a)),xo(t,"font-family",c2(n)),xo(t,"font-size",Dc(n)+"px"),xo(t,"font-style",n.fontStyle),xo(t,"font-variant",n.fontVariant),xo(t,"font-weight",n.fontWeight)}};function m2(e,t,n){t!==Va[e]&&(n?lit(Qf,e,t,n):xo(Qf,e,t),Va[e]=t)}function R6(e,t,n){n!==Va[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Va[t]=n)}function Qh(e,t){for(const n in t)xo(e,n,t[n])}function xo(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function lit(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Nfe(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function F6(e){Rc.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Ge(F6,Rc,{svg(){return this._text},_render(e){const t=I6();t.open("svg",Zt({},u2,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",kfe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Bs[t.marktype],r=n.tag,i=[xfe,n.attr];e.open("g",{class:ofe(t),"clip-path":t.clip?K5(this,t,t.group):null},wfe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const a=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=l2(o);if(bt(u)){const l={x:0,dy:Xh(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Yh(o,u[c])).close()}else e.text(Yh(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),vl(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&a(t.items[0]):vl(t,a),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},a=(o,s,u,l)=>{i[l||o]=s};return Array.isArray(n)?n.forEach(o=>o(a,t,this)):n(a,t,this),r&&cit(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const a=t[i],o=a.stops;a.gradient==="radial"?(e.open("pattern",{id:ZT+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let s=0;s<o.length;++s)e.open("stop",{offset:o[s].offset,"stop-color":o[s].color}).close();e.close()}for(const i in n){const a=n[i];e.open("clipPath",{id:i}),a.path?e.open("path",{d:a.path}).close():e.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),e.close()}e.close()}}});function cit(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=c2(t),e["font-size"]=Dc(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in SO){let o=t[a];const s=SO[a];o==="transparent"&&(s==="fill"||s==="stroke")||o!=null&&(U5(o)&&(o=wce(o,i.gradient,"")),e[s]=o)}return e}const Dfe="canvas",Rfe="png",Ffe="svg",Mfe="none",ep={Canvas:Dfe,PNG:Rfe,SVG:Ffe,None:Mfe},Ty={};Ty[Dfe]=Ty[Rfe]={renderer:_O,headless:_O,handler:p2},Ty[Ffe]={renderer:N6,headless:F6,handler:E6},Ty[Mfe]={};function EO(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Ty[e]=t,this):Ty[e]}function Pfe(e,t,n){const r=[],i=new Wi().union(t),a=e.marktype;return a?$fe(e,i,n,r):a==="group"?Lfe(e,i,n,r):Ie("Intersect scene must be mark node or group item.")}function $fe(e,t,n,r){if(fit(e,t,n)){const i=e.items,a=e.marktype,o=i.length;let s=0;if(a==="group")for(;s<o;++s)Lfe(i[s],t,n,r);else for(const u=Bs[a].isect;s<o;++s){const l=i[s];Bfe(l,t,u)&&r.push(l)}}return r}function fit(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Lfe(e,t,n,r){n&&n(e.mark)&&Bfe(e,t,Bs.group.isect)&&r.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let u=0;u<a;++u)$fe(i[u],t,n,r);t.translate(o,s)}return r}function Bfe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const M6=new Wi;function zfe(e){const t=e.clip;if(nn(t))t(a2(M6.clear()));else if(t)M6.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(M6)}const dit=1e-9;function P6(e,t,n){return e===t?!0:n==="path"?jfe(e,t):e instanceof Date&&t instanceof Date?+e==+t:kh(e)&&kh(t)?Math.abs(e-t)<=dit:!e||!t||!Xt(e)&&!Xt(t)?e==t:hit(e,t)}function jfe(e,t){return P6(_y(e),_y(t))}function hit(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!P6(e[i],t[i],i))return!1;return typeof e==typeof t}function pit(){Dce(),Vtt()}const Oy="top",bl="left",xl="right",tp="bottom",git="top-left",mit="top-right",vit="bottom-left",yit="bottom-right",$6="start",L6="middle",wo="end",bit="x",xit="y",CO="group",B6="axis",z6="title",wit="frame",_it="scope",j6="legend",Ufe="row-header",Wfe="row-footer",Vfe="row-title",qfe="column-header",Hfe="column-footer",Gfe="column-title",Sit="padding",Eit="symbol",Kfe="fit",Cit="fit-x",Ait="fit-y",kit="pad",U6="none",AO="all",W6="each",V6="flush",np="column",rp="row";function Xfe(e){_e.call(this,null,e)}Ge(Xfe,_e,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,a=Bs[i],o=a.bound;let s=r.bounds,u;if(a.nested)r.items.length&&n.dirty(r.items[0]),s=kO(r,o),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===CO||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(kO(l,o))),r.role){case B6:case j6:case z6:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(kO(l,o))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(kO(l,o))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return zfe(r),t.modifies("bounds")}});function kO(e,t,n){return t(e.bounds.clear(),e,n)}const Yfe=":vega_identifier:";function q6(e){_e.call(this,0,e)}q6.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Ge(q6,_e,{transform(e,t){const n=Tit(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),t}});function Tit(e){return e._signals[Yfe]||(e._signals[Yfe]=e.add(0))}function Zfe(e){_e.call(this,null,e)}Ge(Zfe,_e,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,Oit(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===CO?tO:eO;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function Oit(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Jfe(e){_e.call(this,null,e)}const Qfe={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!ede(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},ede=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),tde=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n)if(ede(i,a=e[n].bounds,t))return!0},Iit=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Nit=(e,t,n)=>{var r=e.range(),i=new Wi;return t===Oy||t===tp?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},nde=e=>(e.forEach(t=>t.opacity=1),e),rde=(e,t)=>e.reflow(t.modified()).modifies("opacity");Ge(Jfe,_e,{transform(e,t){const n=Qfe[e.method]||Qfe.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(nde(i),t=rde(t,e)),t;if(i=i.filter(Iit),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),a=nde(i),t=rde(t,e),a.length>=3&&tde(a,r)){do a=n(a,r);while(a.length>=3&&tde(a,r));a.length<3&&!An(i).opacity&&(a.length>1&&(An(a).opacity=0),An(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=Nit(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const s=a[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function ide(e){_e.call(this,null,e)}Ge(ide,_e,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const qa=new Wi;function Iy(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Dit(e){var t=e.items[0].orient;return t===bl||t===xl}function Rit(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Fit(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,s=i.orient,u=Rit(a),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&g6(p),y=0,b=0,x,w;switch(qa.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case Oy:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&TO(e,p,w,g,v,0,-1,m);break;case bl:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&TO(e,p,w,g,v,1,-1,m);break;case xl:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&TO(e,p,w,g,v,1,1,m);break;case tp:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&TO(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Jf(m.translate(y,b),i),Iy(i,"x",y+o)|Iy(i,"y",b+o)&&(i.bounds=qa,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function TO(e,t,n,r,i,a,o,s){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),a?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const ade=(e,t)=>Math.floor(Math.min(e,t)),ode=(e,t)=>Math.ceil(Math.max(e,t));function Mit(e){var t=e.items,n=t.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],a=i.items,i.marktype===CO)switch(i.role){case B6:case j6:case z6:break;case Ufe:o.rowheaders.push(...a);break;case Wfe:o.rowfooters.push(...a);break;case qfe:o.colheaders.push(...a);break;case Hfe:o.colfooters.push(...a);break;case Vfe:o.rowtitle=a[0];break;case Gfe:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function Pit(e){return new Wi().set(0,0,e.width||0,e.height||0)}function $it(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Pr(e,t,n){const r=Xt(e)?e[t]:e;return r??(n!==void 0?n:0)}function sde(e){return e<0?Math.ceil(-e):0}function ude(e,t,n){var r=!n.nodirty,i=n.bounds===V6?Pit:$it,a=qa.set(0,0,0,0),o=Pr(n.align,np),s=Pr(n.align,rp),u=Pr(n.padding,np),l=Pr(n.padding,rp),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),x=Array(d),w=Array(d),S,C,_,E,A,k,T,I,N,O,D;for(C=0;C<c;++C)p[C]=0;for(C=0;C<f;++C)v[C]=0;for(C=0;C<d;++C)k=t[C],A=w[C]=i(k),k.x=k.x||0,b[C]=0,k.y=k.y||0,x[C]=0,_=C%c,E=~~(C/c),g=Math.max(g,T=Math.ceil(A.x2)),y=Math.max(y,I=Math.ceil(A.y2)),p[_]=Math.max(p[_],T),v[E]=Math.max(v[E],I),h[C]=u+sde(A.x1),m[C]=l+sde(A.y1),r&&e.dirty(t[C]);for(C=0;C<d;++C)C%c==0&&(h[C]=0),C<c&&(m[C]=0);if(o===W6)for(_=1;_<c;++_){for(D=0,C=_;C<d;C+=c)D<h[C]&&(D=h[C]);for(C=_;C<d;C+=c)h[C]=D+p[_-1]}else if(o===AO){for(D=0,C=0;C<d;++C)C%c&&D<h[C]&&(D=h[C]);for(C=0;C<d;++C)C%c&&(h[C]=D+g)}else for(o=!1,_=1;_<c;++_)for(C=_;C<d;C+=c)h[C]+=p[_-1];if(s===W6)for(E=1;E<f;++E){for(D=0,C=E*c,S=C+c;C<S;++C)D<m[C]&&(D=m[C]);for(C=E*c;C<S;++C)m[C]=D+v[E-1]}else if(s===AO){for(D=0,C=c;C<d;++C)D<m[C]&&(D=m[C]);for(C=c;C<d;++C)m[C]=D+y}else for(s=!1,E=1;E<f;++E)for(C=E*c,S=C+c;C<S;++C)m[C]+=v[E-1];for(N=0,C=0;C<d;++C)N=h[C]+(C%c?N:0),b[C]+=N-t[C].x;for(_=0;_<c;++_)for(O=0,C=_;C<d;C+=c)O+=m[C],x[C]+=O-t[C].y;if(o&&Pr(n.center,np)&&f>1)for(C=0;C<d;++C)A=o===AO?g:p[C%c],N=A-w[C].x2-t[C].x-b[C],N>0&&(b[C]+=N/2);if(s&&Pr(n.center,rp)&&c!==1)for(C=0;C<d;++C)A=s===AO?y:v[~~(C/c)],O=A-w[C].y2-t[C].y-x[C],O>0&&(x[C]+=O/2);for(C=0;C<d;++C)a.union(w[C].translate(b[C],x[C]));switch(N=Pr(n.anchor,bit),O=Pr(n.anchor,xit),Pr(n.anchor,np)){case wo:N-=a.width();break;case L6:N-=a.width()/2}switch(Pr(n.anchor,rp)){case wo:O-=a.height();break;case L6:O-=a.height()/2}for(N=Math.round(N),O=Math.round(O),a.clear(),C=0;C<d;++C)t[C].mark.bounds.clear();for(C=0;C<d;++C)k=t[C],k.x+=b[C]+=N,k.y+=x[C]+=O,a.union(k.mark.bounds.union(k.bounds.translate(b[C],x[C]))),r&&e.dirty(k);return a}function Lit(e,t,n){var r=Mit(t),i=r.marks,a=n.bounds===V6?Bit:zit,o=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,p,g,m;const v=ude(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=Pr(n.headerBand,rp,null),c=OO(e,r.rowheaders,i,s,u,-Pr(o,"rowHeader"),ade,0,a,"x1",0,s,1,g)),r.colheaders&&(g=Pr(n.headerBand,np,null),f=OO(e,r.colheaders,i,s,s,-Pr(o,"columnHeader"),ade,1,a,"y1",0,1,s,g)),r.rowfooters&&(g=Pr(n.footerBand,rp,null),d=OO(e,r.rowfooters,i,s,u,Pr(o,"rowFooter"),ode,0,a,"x2",s-1,s,1,g)),r.colfooters&&(g=Pr(n.footerBand,np,null),h=OO(e,r.colfooters,i,s,s,Pr(o,"columnFooter"),ode,1,a,"y2",l-s,1,s,g)),r.rowtitle&&(p=Pr(n.titleAnchor,rp),m=Pr(o,"rowTitle"),m=p===wo?d+m:c-m,g=Pr(n.titleBand,rp,.5),lde(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=Pr(n.titleAnchor,np),m=Pr(o,"columnTitle"),m=p===wo?h+m:f-m,g=Pr(n.titleBand,np,.5),lde(e,r.coltitle,m,1,v,g))}function Bit(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function zit(e,t){return e.bounds[t]}function OO(e,t,n,r,i,a,o,s,u,l,c,f,d,h){var p=n.length,g=0,m=0,v,y,b,x,w,S,C,_,E;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=o(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=a,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(S=t[y],w=S.mark.bounds,b=v;b>=0&&(C=n[b])==null;b-=d);s?(_=h==null?C.x:Math.round(C.bounds.x1+h*C.bounds.width()),E=g):(_=g,E=h==null?C.y:Math.round(C.bounds.y1+h*C.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),E-(S.y||0))),S.x=_,S.y=E,e.dirty(S),m=o(m,w[l])}return m}function lde(e,t,n,r,i,a){if(!!t){e.dirty(t);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}function jit(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Uit(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Wit(e,t,n,r,i,a,o){const s=jit(n,t),u=Uit(e,s("offset",0)),l=s("anchor",$6),c=l===wo?1:l===L6?.5:0,f={align:W6,bounds:s("bounds",V6),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case bl:f.anchor={x:Math.floor(r.x1)-u,column:wo,y:c*(o||r.height()+2*r.y1),row:l};break;case xl:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case Oy:f.anchor={y:Math.floor(i.y1)-u,row:wo,x:c*(a||i.width()+2*i.x1),column:l};break;case tp:f.anchor={y:Math.ceil(i.y2)+u,x:c*(a||i.width()+2*i.x1),column:l};break;case git:f.anchor={x:u,y:u};break;case mit:f.anchor={x:a-u,y:u,column:wo};break;case vit:f.anchor={x:u,y:o-u,row:wo};break;case yit:f.anchor={x:a-u,y:o-u,column:wo,row:wo};break}return f}function Vit(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),Hit(e,n,n.items[0].items[0]),a=qit(n,a),u=2*n.padding,l=2*n.padding,a.empty()||(u=Math.ceil(a.width()+u),l=Math.ceil(a.height()+l)),r.type===Eit&&Git(n.items[0].items[0].items[0].items),i!==U6&&(n.x=o=0,n.y=s=0),n.width=u,n.height=l,Jf(a.set(o,s,o+u,s+l),n),n.mark.bounds.clear().union(a),n}function qit(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Hit(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title)(i||a)&&v2(e,n,i,a);else{var o=t.items[1].items[0],s=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case bl:i+=Math.ceil(o.bounds.width())+u;break;case xl:case tp:break;default:a+=o.bounds.height()+u}switch((i||a)&&v2(e,n,i,a),o.orient){case bl:c+=Ny(t,n,o,s,1,1);break;case xl:l+=Ny(t,n,o,wo,0,0)+u,c+=Ny(t,n,o,s,1,1);break;case tp:l+=Ny(t,n,o,s,0,0),c+=Ny(t,n,o,wo,-1,0,1)+u;break;default:l+=Ny(t,n,o,s,0,0)}(l||c)&&v2(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(v2(e,n,-l,0),v2(e,o,-l,0))}}function Ny(e,t,n,r,i,a,o){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(a||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&a?c:0,d=u&&a?0:c,h=i<=0?0:g6(n);return Math.round(r===$6?f:r===wo?d-h:.5*(c-h))}function v2(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Git(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Kit(e,t,n,r,i){var a=t.items[0],o=a.frame,s=a.orient,u=a.anchor,l=a.offset,c=a.padding,f=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=s===bl||s===xl?r:n,p=0,g=0,m=0,v=0,y=0,b;if(o!==CO?s===bl?(p=i.y2,h=i.y1):s===xl?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):s===bl&&(p=r,h=0),b=u===$6?p:u===wo?h:(p+h)/2,d&&d.text){switch(s){case Oy:case tp:y=f.bounds.height()+c;break;case bl:v=f.bounds.width()+c;break;case xl:v=-f.bounds.width()-c;break}qa.clear().union(d.bounds),qa.translate(v-(d.x||0),y-(d.y||0)),Iy(d,"x",v)|Iy(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(qa),d.mark.bounds.clear().union(qa),e.dirty(d)),qa.clear().union(d.bounds)}else qa.clear();switch(qa.union(f.bounds),s){case Oy:g=b,m=i.y1-qa.height()-l;break;case bl:g=i.x1-qa.width()-l,m=b;break;case xl:g=i.x2+qa.width()+l,m=b;break;case tp:g=b,m=i.y2+l;break;default:g=a.x,m=a.y}return Iy(a,"x",g)|Iy(a,"y",m)&&(qa.translate(g,m),e.dirty(a),a.bounds.clear().union(qa),t.bounds.clear().union(qa),e.dirty(a)),a.bounds}function cde(e){_e.call(this,null,e)}Ge(cde,_e,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Lit(n,r,e.layout),Yit(n,r,e)}),Xit(e.mark.group)?t.reflow():t}});function Xit(e){return e&&e.mark.role!=="legend-entry"}function Yit(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=new Wi().set(0,0,i,a),s=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case B6:h=Dit(f)?s:u,h.union(Fit(e,f,i,a));break;case z6:c=f;break;case j6:l.push(Vit(e,f));break;case wit:case _it:case Ufe:case Wfe:case Vfe:case qfe:case Hfe:case Gfe:s.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{d=v.orient||xl,d!==U6&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];ude(e,y,Wit(y,v,n.legends,s,u,i,a))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&n.autosize.type===Kfe)switch(v.orient){case bl:case xl:o.add(y.x1,0).add(y.x2,0);break;case Oy:case tp:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(s).union(u),c&&o.union(Kit(e,c,i,a,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),Zit(e,t,o,n)}function Zit(e,t,n,r){const i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;let o=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Sit){const p=e.padding();o-=p.left+p.right,s-=p.top+p.bottom}a===U6?(l=0,f=0,u=o,c=s):a===Kfe?(u=Math.max(0,o-l-d),c=Math.max(0,s-f-h)):a===Cit?(u=Math.max(0,o-l-d),s=c+f+h):a===Ait?(o=u+l+d,c=Math.max(0,s-f-h)):a===kit&&(o=u+l+d,s=c+f+h),e._resizeView(o,s,u,c,[l,f],i.resize)}var Jit=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:Xfe,identifier:q6,mark:Zfe,overlap:Jfe,render:ide,viewlayout:cde});function fde(e){_e.call(this,null,e)}Ge(fde,_e,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,s=B5(a,o,e.minstep),u=e.format||dce(n,a,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?fce(a,e.values,s):z5(a,s);return i&&(r.rem=i),i=l.map((c,f)=>Yn({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(Yn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function dde(e){_e.call(this,null,e)}function Qit(){return Yn({})}function eat(e){const t=J0().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}Ge(dde,_e,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Qit,a=e.key||xt,o=this.value;return bt(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(a))&&Ie("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=eat(a)),t.visit(t.ADD,s=>{const u=a(s);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),o.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=a(s),l=o.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=a(s),l=o.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function hde(e){_e.call(this,null,e)}Ge(hde,_e,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,a=t.encode;if(bt(a))if(n.changed()||a.every(f=>i[f]))a=a[0],n.encode=null;else return t.StopPropagation;var o=a==="enter",s=i.update||Ch,u=i.enter||Ch,l=i.exit||Ch,c=(a&&!o?i[a]:s)||Ch;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Ch&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Ch&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Ch){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function pde(e){_e.call(this,[],e)}Ge(pde,_e,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||YT,o=e.scale,s=+e.limit,u=B5(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===YT,c=e.format||mce(n,o,u,a,e.formatSpecifier,e.formatType,l),f=e.values||gce(o,u),d,h,p,g,m;return i&&(r.rem=i),a===YT?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,nn(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=Ba(g=p||8),i=i.map((v,y)=>Yn({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(Yn({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):a===Ntt?(d=o.domain(),h=sce(o,d[0],An(d)),f.length<3&&!e.values&&d[0]!==An(d)&&(f=[d[0],An(d)]),i=f.map((v,y)=>Yn({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=Utt(o),i=f.map((v,y)=>Yn({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const tat=e=>e.source.x,nat=e=>e.source.y,rat=e=>e.target.x,iat=e=>e.target.y;function H6(e){_e.call(this,{},e)}H6.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Ge(H6,_e,{transform(e,t){var n=e.sourceX||tat,r=e.sourceY||nat,i=e.targetX||rat,a=e.targetY||iat,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=yde.get(u+"-"+s)||yde.get(u);return l||Ie("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),a(c))}),t.reflow(e.modified()).modifies(o)}});const gde=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,aat=(e,t,n,r)=>gde(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),mde=(e,t,n,r)=>{var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,s=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+s+" 0 1 "+n+","+r},oat=(e,t,n,r)=>mde(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),vde=(e,t,n,r)=>{const i=n-e,a=r-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},sat=(e,t,n,r)=>vde(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),uat=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,lat=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,cat=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+r*o+","+r*s},fat=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},dat=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},hat=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s},yde=J0({line:gde,"line-radial":aat,arc:mde,"arc-radial":oat,curve:vde,"curve-radial":sat,"orthogonal-horizontal":uat,"orthogonal-vertical":lat,"orthogonal-radial":cat,"diagonal-horizontal":fat,"diagonal-vertical":dat,"diagonal-radial":hat});function G6(e){_e.call(this,null,e)}G6.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Ge(G6,_e,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||Z0,o=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(a),c=l.length,f=o,d=(s-o)/noe(l),h=Ps(c),p,g,m;for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const pat=5;function gat(e){const t=e.type;return!e.bins&&(t===yy||t===Xw||t===Yw)}function bde(e){return M5(e)&&e!==Tc}const mat=hl(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function xde(e){_e.call(this,null,e),this.modified(!0)}Ge(xde,_e,{transform(e,t){var n=t.dataflow,r=this.value,i=vat(e);(!r||i!==r.type)&&(this.value=r=Wn(i)());for(i in e)if(!mat[i]){if(i==="padding"&&bde(r.type))continue;nn(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Sat(r,e,_at(r,e,bat(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function vat(e){var t=e.type,n="",r;return t===Tc?Tc+"-"+yy:(yat(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Tc+"-":r===3?by+"-":""),(n+t||yy).toLowerCase())}function yat(e){const t=e.type;return M5(t)&&t!==im&&t!==am&&(e.scheme||e.range&&e.range.length&&e.range.every(lr))}function bat(e,t,n){const r=xat(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===void 0&&gat(e),s,u;if(!i)return 0;if(bde(a)&&t.padding&&i[0]!==An(i)&&(i=wat(a,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(wde(a,i,n)),a===I5&&e.unknown(t.domainImplicit?Qz:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&B5(e,t.nice)||null),i.length}function xat(e,t,n){return t?(e.domain(wde(e.type,t,n)),t.length):-1}function wat(e,t,n,r,i,a){var o=Math.abs(An(n)-n[0]),s=o/(o-2*r),u=e===Yf?Z4(t,null,s):e===Yw?Kk(t,null,s,.5):e===Xw?Kk(t,null,s,i||1):e===qT?J4(t,null,s,a||1):Y4(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function wde(e,t,n){if(nce(e)){var r=Math.abs(t.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+At(t))}return t}function _at(e,t,n){let r=t.bins;if(r&&!bt(r)){const i=e.domain(),a=i[0],o=An(i),s=r.step;let u=r.start==null?a:r.start,l=r.stop==null?o:r.stop;s||Ie("Scale bins parameter missing step property."),u<a&&(u=s*Math.ceil(a/s)),l>o&&(l=s*Math.floor(o/s)),r=Ps(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===D5&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Sat(e,t,n){var r=e.type,i=t.round||!1,a=t.range;if(t.rangeStep!=null)a=Eat(r,t,n);else if(t.scheme&&(a=Cat(r,t,n),nn(a))){if(e.interpolator)return e.interpolator(a);Ie("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&rce(r))return e.interpolator(XT(K6(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate($5(t.interpolate,t.interpolateGamma)):nn(e.round)?e.round(i):nn(e.rangeRound)&&e.interpolate(i?Hw:Wh),a&&e.range(K6(a,t.reverse))}function Eat(e,t,n){e!==Jle&&e!==N5&&Ie("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===N5?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*O5(n,i,r)]}function Cat(e,t,n){var r=t.schemeExtent,i,a;return bt(t.scheme)?a=XT(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),a=L5(i),a||Ie("Unrecognized scheme name: ".concat(t.scheme))),n=e===GT?n+1:e===D5?n-1:e===xy||e===HT?+t.schemeCount||pat:n,rce(e)?_de(a,r,t.reverse):nn(a)?oce(_de(a,r),n):e===I5?a:a.slice(0,n)}function _de(e,t,n){return nn(e)&&(t||n)?ace(e,K6(t||[0,1],n)):e}function K6(e,t){return t?e.slice().reverse():e}function Sde(e){_e.call(this,null,e)}Ge(Sde,_e,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Yg(e.sort)),this.modified(n),t}});const Ede="zero",Cde="center",Ade="normalize",kde=["y0","y1"];function X6(e){_e.call(this,null,e)}X6.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Ede,values:[Ede,Cde,Ade]},{name:"as",type:"string",array:!0,length:2,default:kde}]},Ge(X6,_e,{transform(e,t){var n=e.as||kde,r=n[0],i=n[1],a=Yg(e.sort),o=e.field||Z0,s=e.offset===Cde?Aat:e.offset===Ade?kat:Tat,u,l,c,f;for(u=Oat(t.source,e.groupby,a,o),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function Aat(e,t,n,r,i){for(var a=(t-e.sum)/2,o=e.length,s=0,u;s<o;++s)u=e[s],u[r]=a,u[i]=a+=Math.abs(n(u))}function kat(e,t,n,r,i){for(var a=1/e.sum,o=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=o,c[i]=o=a*(l+=Math.abs(n(c)))}function Tat(e,t,n,r,i){for(var a=0,o=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=a,c[i]=a+=l)}function Oat(e,t,n,r){var i=[],a=g=>g(c),o,s,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(a),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}var Iat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:fde,datajoin:dde,encode:hde,legendentries:pde,linkpath:H6,pie:G6,scale:xde,sortitems:Sde,stack:X6}),kt=1e-6,IO=1e-12,dn=Math.PI,ii=dn/2,NO=dn/4,_o=dn*2,mi=180/dn,hn=dn/180,Rn=Math.abs,Dy=Math.atan,bu=Math.atan2,Ot=Math.cos,DO=Math.ceil,Tde=Math.exp,Y6=Math.hypot,RO=Math.log,Z6=Math.pow,wt=Math.sin,xu=Math.sign||function(e){return e>0?1:e<0?-1:0},So=Math.sqrt,J6=Math.tan;function Ode(e){return e>1?0:e<-1?dn:Math.acos(e)}function ts(e){return e>1?ii:e<-1?-ii:Math.asin(e)}function Ca(){}function FO(e,t){e&&Nde.hasOwnProperty(e.type)&&Nde[e.type](e,t)}var Ide={Feature:function(e,t){FO(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)FO(n[r].geometry,t)}},Nde={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Q6(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Q6(n[r],t,0)},Polygon:function(e,t){Dde(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Dde(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)FO(n[r],t)}};function Q6(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Dde(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Q6(e[n],t,1);t.polygonEnd()}function ed(e,t){e&&Ide.hasOwnProperty(e.type)?Ide[e.type](e,t):FO(e,t)}var MO=new bo,PO=new bo,Rde,Fde,ej,tj,nj,Fc={point:Ca,lineStart:Ca,lineEnd:Ca,polygonStart:function(){MO=new bo,Fc.lineStart=Nat,Fc.lineEnd=Dat},polygonEnd:function(){var e=+MO;PO.add(e<0?_o+e:e),this.lineStart=this.lineEnd=this.point=Ca},sphere:function(){PO.add(_o)}};function Nat(){Fc.point=Rat}function Dat(){Mde(Rde,Fde)}function Rat(e,t){Fc.point=Mde,Rde=e,Fde=t,e*=hn,t*=hn,ej=e,tj=Ot(t=t/2+NO),nj=wt(t)}function Mde(e,t){e*=hn,t*=hn,t=t/2+NO;var n=e-ej,r=n>=0?1:-1,i=r*n,a=Ot(t),o=wt(t),s=nj*o,u=tj*a+s*Ot(i),l=s*r*wt(i);MO.add(bu(l,u)),ej=e,tj=a,nj=o}function Fat(e){return PO=new bo,ed(e,Fc),PO*2}function $O(e){return[bu(e[1],e[0]),ts(e[2])]}function dm(e){var t=e[0],n=e[1],r=Ot(n);return[r*Ot(t),r*wt(t),wt(n)]}function LO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ry(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function rj(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function BO(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function zO(e){var t=So(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Hr,ns,ai,zs,hm,Pde,$de,Fy,y2,ip,td,nd={point:ij,lineStart:Bde,lineEnd:zde,polygonStart:function(){nd.point=jde,nd.lineStart=Mat,nd.lineEnd=Pat,y2=new bo,Fc.polygonStart()},polygonEnd:function(){Fc.polygonEnd(),nd.point=ij,nd.lineStart=Bde,nd.lineEnd=zde,MO<0?(Hr=-(ai=180),ns=-(zs=90)):y2>kt?zs=90:y2<-kt&&(ns=-90),td[0]=Hr,td[1]=ai},sphere:function(){Hr=-(ai=180),ns=-(zs=90)}};function ij(e,t){ip.push(td=[Hr=e,ai=e]),t<ns&&(ns=t),t>zs&&(zs=t)}function Lde(e,t){var n=dm([e*hn,t*hn]);if(Fy){var r=Ry(Fy,n),i=[r[1],-r[0],0],a=Ry(i,r);zO(a),a=$O(a);var o=e-hm,s=o>0?1:-1,u=a[0]*mi*s,l,c=Rn(o)>180;c^(s*hm<u&&u<s*e)?(l=a[1]*mi,l>zs&&(zs=l)):(u=(u+360)%360-180,c^(s*hm<u&&u<s*e)?(l=-a[1]*mi,l<ns&&(ns=l)):(t<ns&&(ns=t),t>zs&&(zs=t))),c?e<hm?js(Hr,e)>js(Hr,ai)&&(ai=e):js(e,ai)>js(Hr,ai)&&(Hr=e):ai>=Hr?(e<Hr&&(Hr=e),e>ai&&(ai=e)):e>hm?js(Hr,e)>js(Hr,ai)&&(ai=e):js(e,ai)>js(Hr,ai)&&(Hr=e)}else ip.push(td=[Hr=e,ai=e]);t<ns&&(ns=t),t>zs&&(zs=t),Fy=n,hm=e}function Bde(){nd.point=Lde}function zde(){td[0]=Hr,td[1]=ai,nd.point=ij,Fy=null}function jde(e,t){if(Fy){var n=e-hm;y2.add(Rn(n)>180?n+(n>0?360:-360):n)}else Pde=e,$de=t;Fc.point(e,t),Lde(e,t)}function Mat(){Fc.lineStart()}function Pat(){jde(Pde,$de),Fc.lineEnd(),Rn(y2)>kt&&(Hr=-(ai=180)),td[0]=Hr,td[1]=ai,Fy=null}function js(e,t){return(t-=e)<0?t+360:t}function $at(e,t){return e[0]-t[0]}function Ude(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Lat(e){var t,n,r,i,a,o,s;if(zs=ai=-(Hr=ns=1/0),ip=[],ed(e,nd),n=ip.length){for(ip.sort($at),t=1,r=ip[0],a=[r];t<n;++t)i=ip[t],Ude(r,i[0])||Ude(r,i[1])?(js(r[0],i[1])>js(r[0],r[1])&&(r[1]=i[1]),js(i[0],r[1])>js(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t)i=a[t],(s=js(r[1],i[0]))>o&&(o=s,Hr=i[0],ai=r[1])}return ip=td=null,Hr===1/0||ns===1/0?[[NaN,NaN],[NaN,NaN]]:[[Hr,ns],[ai,zs]]}var b2,jO,UO,WO,VO,qO,HO,GO,aj,oj,sj,Wde,Vde,Eo,Co,Ao,wl={sphere:Ca,point:uj,lineStart:qde,lineEnd:Hde,polygonStart:function(){wl.lineStart=jat,wl.lineEnd=Uat},polygonEnd:function(){wl.lineStart=qde,wl.lineEnd=Hde}};function uj(e,t){e*=hn,t*=hn;var n=Ot(t);x2(n*Ot(e),n*wt(e),wt(t))}function x2(e,t,n){++b2,UO+=(e-UO)/b2,WO+=(t-WO)/b2,VO+=(n-VO)/b2}function qde(){wl.point=Bat}function Bat(e,t){e*=hn,t*=hn;var n=Ot(t);Eo=n*Ot(e),Co=n*wt(e),Ao=wt(t),wl.point=zat,x2(Eo,Co,Ao)}function zat(e,t){e*=hn,t*=hn;var n=Ot(t),r=n*Ot(e),i=n*wt(e),a=wt(t),o=bu(So((o=Co*a-Ao*i)*o+(o=Ao*r-Eo*a)*o+(o=Eo*i-Co*r)*o),Eo*r+Co*i+Ao*a);jO+=o,qO+=o*(Eo+(Eo=r)),HO+=o*(Co+(Co=i)),GO+=o*(Ao+(Ao=a)),x2(Eo,Co,Ao)}function Hde(){wl.point=uj}function jat(){wl.point=Wat}function Uat(){Gde(Wde,Vde),wl.point=uj}function Wat(e,t){Wde=e,Vde=t,e*=hn,t*=hn,wl.point=Gde;var n=Ot(t);Eo=n*Ot(e),Co=n*wt(e),Ao=wt(t),x2(Eo,Co,Ao)}function Gde(e,t){e*=hn,t*=hn;var n=Ot(t),r=n*Ot(e),i=n*wt(e),a=wt(t),o=Co*a-Ao*i,s=Ao*r-Eo*a,u=Eo*i-Co*r,l=Y6(o,s,u),c=ts(l),f=l&&-c/l;aj.add(f*o),oj.add(f*s),sj.add(f*u),jO+=c,qO+=c*(Eo+(Eo=r)),HO+=c*(Co+(Co=i)),GO+=c*(Ao+(Ao=a)),x2(Eo,Co,Ao)}function Vat(e){b2=jO=UO=WO=VO=qO=HO=GO=0,aj=new bo,oj=new bo,sj=new bo,ed(e,wl);var t=+aj,n=+oj,r=+sj,i=Y6(t,n,r);return i<IO&&(t=qO,n=HO,r=GO,jO<kt&&(t=UO,n=WO,r=VO),i=Y6(t,n,r),i<IO)?[NaN,NaN]:[bu(n,t)*mi,ts(r/i)*mi]}function lj(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function cj(e,t){return[Rn(e)>dn?e+Math.round(-e/_o)*_o:e,t]}cj.invert=cj;function Kde(e,t,n){return(e%=_o)?t||n?lj(Yde(e),Zde(t,n)):Yde(e):t||n?Zde(t,n):cj}function Xde(e){return function(t,n){return t+=e,[t>dn?t-_o:t<-dn?t+_o:t,n]}}function Yde(e){var t=Xde(e);return t.invert=Xde(-e),t}function Zde(e,t){var n=Ot(e),r=wt(e),i=Ot(t),a=wt(t);function o(s,u){var l=Ot(u),c=Ot(s)*l,f=wt(s)*l,d=wt(u),h=d*n+c*r;return[bu(f*i-h*a,c*n-d*r),ts(h*i+f*a)]}return o.invert=function(s,u){var l=Ot(u),c=Ot(s)*l,f=wt(s)*l,d=wt(u),h=d*i-f*a;return[bu(f*i+d*a,c*n+h*r),ts(h*n-c*r)]},o}function qat(e){e=Kde(e[0]*hn,e[1]*hn,e.length>2?e[2]*hn:0);function t(n){return n=e(n[0]*hn,n[1]*hn),n[0]*=mi,n[1]*=mi,n}return t.invert=function(n){return n=e.invert(n[0]*hn,n[1]*hn),n[0]*=mi,n[1]*=mi,n},t}function Hat(e,t,n,r,i,a){if(!!n){var o=Ot(t),s=wt(t),u=r*n;i==null?(i=t+r*_o,a=t-u/2):(i=Jde(o,i),a=Jde(o,a),(r>0?i<a:i>a)&&(i+=r*_o));for(var l,c=i;r>0?c>a:c<a;c-=u)l=$O([o,-s*Ot(c),-s*wt(c)]),e.point(l[0],l[1])}}function Jde(e,t){t=dm(t),t[0]-=e,zO(t);var n=Ode(-t[1]);return((-t[2]<0?-n:n)+_o-kt)%_o}function Qde(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Ca,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function KO(e,t){return Rn(e[0]-t[0])<kt&&Rn(e[1]-t[1])<kt}function XO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ehe(e,t,n,r,i){var a=[],o=[],s,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(KO(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),s=0;s<g;++s)i.point((m=p[s])[0],m[1]);i.lineEnd();return}v[0]+=2*kt}a.push(y=new XO(m,p,null,!0)),o.push(y.o=new XO(m,null,y,!1)),a.push(y=new XO(v,p,null,!1)),o.push(y.o=new XO(v,null,y,!0))}}),!!a.length){for(o.sort(t),the(a),the(o),s=0,u=o.length;s<u;++s)o[s].e=n=!n;for(var l=a[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function the(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function fj(e){return Rn(e[0])<=dn?e[0]:xu(e[0])*((Rn(e[0])+dn)%_o-dn)}function Gat(e,t){var n=fj(t),r=t[1],i=wt(r),a=[wt(n),-Ot(n),0],o=0,s=0,u=new bo;i===1?r=ii+kt:i===-1&&(r=-ii-kt);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=fj(h),g=h[1]/2+NO,m=wt(g),v=Ot(g),y=0;y<d;++y,p=x,m=S,v=C,h=b){var b=f[y],x=fj(b),w=b[1]/2+NO,S=wt(w),C=Ot(w),_=x-p,E=_>=0?1:-1,A=E*_,k=A>dn,T=m*S;if(u.add(bu(T*E*wt(A),v*C+T*Ot(A))),o+=k?_+E*_o:_,k^p>=n^x>=n){var I=Ry(dm(h),dm(b));zO(I);var N=Ry(a,I);zO(N);var O=(k^_>=0?-1:1)*ts(N[2]);(r>O||r===O&&(I[0]||I[1]))&&(s+=k^_>=0?1:-1)}}return(o<-kt||o<kt&&u<-IO)^s&1}function nhe(e,t,n,r){return function(i){var a=t(i),o=Qde(),s=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=toe(c);var x=Gat(l,r);c.length?(u||(i.polygonStart(),u=!0),ehe(c,Xat,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){a.point(x,w)}function g(){d.point=p,a.lineStart()}function m(){d.point=h,a.lineEnd()}function v(x,w){f.push([x,w]),s.point(x,w)}function y(){s.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=o.result(),S,C=w.length,_,E,A;if(f.pop(),l.push(f),f=null,!!C){if(x&1){if(E=w[0],(_=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((A=E[S])[0],A[1]);i.lineEnd()}return}C>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Kat))}}return d}}function Kat(e){return e.length>1}function Xat(e,t){return((e=e.x)[0]<0?e[1]-ii-kt:ii-e[1])-((t=t.x)[0]<0?t[1]-ii-kt:ii-t[1])}var rhe=nhe(function(){return!0},Yat,Jat,[-dn,-ii]);function Yat(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?dn:-dn,u=Rn(a-t);Rn(u-dn)<kt?(e.point(t,n=(n+o)/2>0?ii:-ii),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&u>=dn&&(Rn(t-r)<kt&&(t-=r*kt),Rn(a-s)<kt&&(a-=s*kt),n=Zat(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Zat(e,t,n,r){var i,a,o=wt(e-n);return Rn(o)>kt?Dy((wt(t)*(a=Ot(r))*wt(n)-wt(r)*(i=Ot(t))*wt(e))/(i*a*o)):(t+r)/2}function Jat(e,t,n,r){var i;if(e==null)i=n*ii,r.point(-dn,i),r.point(0,i),r.point(dn,i),r.point(dn,0),r.point(dn,-i),r.point(0,-i),r.point(-dn,-i),r.point(-dn,0),r.point(-dn,i);else if(Rn(e[0]-t[0])>kt){var a=e[0]<t[0]?dn:-dn;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function Qat(e){var t=Ot(e),n=6*hn,r=t>0,i=Rn(t)>kt;function a(c,f,d,h){Hat(h,e,n,d,c,f)}function o(c,f){return Ot(c)*Ot(f)>t}function s(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var y=[m,v],b,x=o(m,v),w=r?x?0:l(m,v):x?l(m+(m<0?dn:-dn),v):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,y),(!b||KO(f,b)||KO(y,b))&&(y[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!KO(f,y))&&c.point(y[0],y[1]),f=y,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=dm(c),p=dm(f),g=[1,0,0],m=Ry(h,p),v=LO(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var x=t*v/b,w=-t*y/b,S=Ry(g,m),C=BO(g,x),_=BO(m,w);rj(C,_);var E=S,A=LO(C,E),k=LO(E,E),T=A*A-k*(LO(C,C)-1);if(!(T<0)){var I=So(T),N=BO(E,(-A-I)/k);if(rj(N,C),N=$O(N),!d)return N;var O=c[0],D=f[0],P=c[1],V=f[1],Y;D<O&&(Y=O,O=D,D=Y);var X=D-O,Q=Rn(X-dn)<kt,me=Q||X<kt;if(!Q&&V<P&&(Y=P,P=V,V=Y),me?Q?P+V>0^N[1]<(Rn(N[0]-O)<kt?P:V):P<=N[1]&&N[1]<=V:X>dn^(O<=N[0]&&N[0]<=D)){var ce=BO(E,(-A+I)/k);return rj(ce,C),[N,$O(ce)]}}}function l(c,f){var d=r?e:dn-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return nhe(o,s,a,r?[0,-e]:[-dn,e-dn])}function eot(e,t,n,r,i,a){var o=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-s,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=a-s,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=s+c*h),f<1&&(t[0]=o+f*d,t[1]=s+f*h),!0}}}}}var w2=1e9,YO=-w2;function ihe(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function a(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return Rn(l[0]-e)<kt?c>0?0:3:Rn(l[0]-n)<kt?c>0?2:1:Rn(l[1]-t)<kt?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=Qde(),d,h,p,g,m,v,y,b,x,w,S,C={point:_,lineStart:T,lineEnd:I,polygonStart:A,polygonEnd:k};function _(O,D){i(O,D)&&c.point(O,D)}function E(){for(var O=0,D=0,P=h.length;D<P;++D)for(var V=h[D],Y=1,X=V.length,Q=V[0],me,ce,Ne=Q[0],Oe=Q[1];Y<X;++Y)me=Ne,ce=Oe,Q=V[Y],Ne=Q[0],Oe=Q[1],ce<=r?Oe>r&&(Ne-me)*(r-ce)>(Oe-ce)*(e-me)&&++O:Oe<=r&&(Ne-me)*(r-ce)<(Oe-ce)*(e-me)&&--O;return O}function A(){c=f,d=[],h=[],S=!0}function k(){var O=E(),D=S&&O,P=(d=toe(d)).length;(D||P)&&(l.polygonStart(),D&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),P&&ehe(d,s,O,a,l),l.polygonEnd()),c=l,d=h=p=null}function T(){C.point=N,h&&h.push(p=[]),w=!0,x=!1,y=b=NaN}function I(){d&&(N(g,m),v&&x&&f.rejoin(),d.push(f.result())),C.point=_,x&&c.lineEnd()}function N(O,D){var P=i(O,D);if(h&&p.push([O,D]),w)g=O,m=D,v=P,w=!1,P&&(c.lineStart(),c.point(O,D));else if(P&&x)c.point(O,D);else{var V=[y=Math.max(YO,Math.min(w2,y)),b=Math.max(YO,Math.min(w2,b))],Y=[O=Math.max(YO,Math.min(w2,O)),D=Math.max(YO,Math.min(w2,D))];eot(V,Y,e,t,n,r)?(x||(c.lineStart(),c.point(V[0],V[1])),c.point(Y[0],Y[1]),P||c.lineEnd(),S=!1):P&&(c.lineStart(),c.point(O,D),S=!1)}y=O,b=D,x=P}return C}}function ahe(e,t,n){var r=Ps(e,t-kt,n).concat(t);return function(i){return r.map(function(a){return[i,a]})}}function ohe(e,t,n){var r=Ps(e,t-kt,n).concat(t);return function(i){return r.map(function(a){return[a,i]})}}function tot(){var e,t,n,r,i,a,o,s,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ps(DO(r/c)*c,n,c).map(p).concat(Ps(DO(s/f)*f,o,f).map(g)).concat(Ps(DO(t/u)*u,e,u).filter(function(b){return Rn(b%c)>kt}).map(d)).concat(Ps(DO(a/l)*l,i,l).filter(function(b){return Rn(b%f)>kt}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(s).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],o=+b[1][1],r>n&&(b=r,r=n,n=b),s>o&&(b=s,s=o,o=b),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],a=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),a>i&&(b=a,a=i,i=b),v.precision(m)):[[t,a],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=ahe(a,i,90),h=ohe(t,e,m),p=ahe(s,o,90),g=ohe(r,n,m),v):m},v.extentMajor([[-180,-90+kt],[180,90-kt]]).extentMinor([[-180,-80-kt],[180,80+kt]])}var _2=e=>e,dj=new bo,hj=new bo,she,uhe,pj,gj,ap={point:Ca,lineStart:Ca,lineEnd:Ca,polygonStart:function(){ap.lineStart=not,ap.lineEnd=iot},polygonEnd:function(){ap.lineStart=ap.lineEnd=ap.point=Ca,dj.add(Rn(hj)),hj=new bo},result:function(){var e=dj/2;return dj=new bo,e}};function not(){ap.point=rot}function rot(e,t){ap.point=lhe,she=pj=e,uhe=gj=t}function lhe(e,t){hj.add(gj*e-pj*t),pj=e,gj=t}function iot(){lhe(she,uhe)}var che=ap,My=1/0,ZO=My,S2=-My,JO=S2,aot={point:oot,lineStart:Ca,lineEnd:Ca,polygonStart:Ca,polygonEnd:Ca,result:function(){var e=[[My,ZO],[S2,JO]];return S2=JO=-(ZO=My=1/0),e}};function oot(e,t){e<My&&(My=e),e>S2&&(S2=e),t<ZO&&(ZO=t),t>JO&&(JO=t)}var QO=aot,mj=0,vj=0,E2=0,eI=0,tI=0,Py=0,yj=0,bj=0,C2=0,fhe,dhe,Mc,Pc,_l={point:pm,lineStart:hhe,lineEnd:phe,polygonStart:function(){_l.lineStart=lot,_l.lineEnd=cot},polygonEnd:function(){_l.point=pm,_l.lineStart=hhe,_l.lineEnd=phe},result:function(){var e=C2?[yj/C2,bj/C2]:Py?[eI/Py,tI/Py]:E2?[mj/E2,vj/E2]:[NaN,NaN];return mj=vj=E2=eI=tI=Py=yj=bj=C2=0,e}};function pm(e,t){mj+=e,vj+=t,++E2}function hhe(){_l.point=sot}function sot(e,t){_l.point=uot,pm(Mc=e,Pc=t)}function uot(e,t){var n=e-Mc,r=t-Pc,i=So(n*n+r*r);eI+=i*(Mc+e)/2,tI+=i*(Pc+t)/2,Py+=i,pm(Mc=e,Pc=t)}function phe(){_l.point=pm}function lot(){_l.point=fot}function cot(){ghe(fhe,dhe)}function fot(e,t){_l.point=ghe,pm(fhe=Mc=e,dhe=Pc=t)}function ghe(e,t){var n=e-Mc,r=t-Pc,i=So(n*n+r*r);eI+=i*(Mc+e)/2,tI+=i*(Pc+t)/2,Py+=i,i=Pc*e-Mc*t,yj+=i*(Mc+e),bj+=i*(Pc+t),C2+=i*3,pm(Mc=e,Pc=t)}var mhe=_l;function vhe(e){this._context=e}vhe.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,_o);break}}},result:Ca};var xj=new bo,wj,yhe,bhe,A2,k2,nI={point:Ca,lineStart:function(){nI.point=dot},lineEnd:function(){wj&&xhe(yhe,bhe),nI.point=Ca},polygonStart:function(){wj=!0},polygonEnd:function(){wj=null},result:function(){var e=+xj;return xj=new bo,e}};function dot(e,t){nI.point=xhe,yhe=A2=e,bhe=k2=t}function xhe(e,t){A2-=e,k2-=t,xj.add(So(A2*A2+k2*k2)),A2=e,k2=t}var whe=nI;function _he(){this._string=[]}_he.prototype={_radius:4.5,_circle:She(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=She(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function She(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Ehe(e,t){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),ed(o,r(i))),i.result()}return a.area=function(o){return ed(o,r(che)),che.result()},a.measure=function(o){return ed(o,r(whe)),whe.result()},a.bounds=function(o){return ed(o,r(QO)),QO.result()},a.centroid=function(o){return ed(o,r(mhe)),mhe.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,_2):(e=o).stream,a):e},a.context=function(o){return arguments.length?(i=o==null?(t=null,new _he):new vhe(t=o),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(e).context(t)}function rI(e){return function(t){var n=new _j;for(var r in e)n[r]=e[r];return n.stream=t,n}}function _j(){}_j.prototype={constructor:_j,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Sj(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),ed(n,e.stream(QO)),t(QO.result()),r!=null&&e.clipExtent(r),e}function iI(e,t,n){return Sj(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,u])},n)}function Ej(e,t,n){return iI(e,[[0,0],t],n)}function Cj(e,t,n){return Sj(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function Aj(e,t,n){return Sj(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var Che=16,hot=Ot(30*hn);function Ahe(e,t){return+t?got(e,t):pot(e)}function pot(e){return rI({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function got(e,t){function n(r,i,a,o,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=o+d,w=s+h,S=u+p,C=So(x*x+w*w+S*S),_=ts(S/=C),E=Rn(Rn(S)-1)<kt||Rn(a-f)<kt?(a+f)/2:bu(w,x),A=e(E,_),k=A[0],T=A[1],I=k-r,N=T-i,O=y*I-v*N;(O*O/b>t||Rn((v*I+y*N)/b-.5)>.3||o*d+s*h+u*p<hot)&&(n(r,i,a,o,s,u,k,T,E,x/=C,w/=C,S,g,m),m.point(k,T),n(k,T,E,x,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,a,o,s,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,E){_=e(_,E),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,E){var A=dm([_,E]),k=e(_,E);n(f,d,c,h,p,g,f=k[0],d=k[1],c=_,h=A[0],p=A[1],g=A[2],Che,r),r.point(f,d)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=S,m.lineEnd=C}function S(_,E){b(i=_,E),a=f,o=d,s=h,u=p,l=g,m.point=b}function C(){n(f,d,c,h,p,g,a,o,i,s,u,l,Che,r),m.lineEnd=x,x()}return m}}var mot=rI({point:function(e,t){this.stream.point(e*hn,t*hn)}});function vot(e){return rI({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function yot(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function khe(e,t,n,r,i,a){if(!a)return yot(e,t,n,r,i);var o=Ot(a),s=wt(a),u=o*e,l=s*e,c=o/e,f=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function $c(e){return The(function(){return e})()}function The(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=rhe,m=null,v,y,b,x=_2,w=.5,S,C,_,E,A;function k(O){return _(O[0]*hn,O[1]*hn)}function T(O){return O=_.invert(O[0],O[1]),O&&[O[0]*mi,O[1]*mi]}k.stream=function(O){return E&&A===O?E:E=mot(vot(c)(g(S(x(A=O)))))},k.preclip=function(O){return arguments.length?(g=O,p=void 0,N()):g},k.postclip=function(O){return arguments.length?(x=O,m=v=y=b=null,N()):x},k.clipAngle=function(O){return arguments.length?(g=+O?Qat(p=O*hn):(p=null,rhe),N()):p*mi},k.clipExtent=function(O){return arguments.length?(x=O==null?(m=v=y=b=null,_2):ihe(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),N()):m==null?null:[[m,v],[y,b]]},k.scale=function(O){return arguments.length?(n=+O,I()):n},k.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],I()):[r,i]},k.center=function(O){return arguments.length?(a=O[0]%360*hn,o=O[1]%360*hn,I()):[a*mi,o*mi]},k.rotate=function(O){return arguments.length?(s=O[0]%360*hn,u=O[1]%360*hn,l=O.length>2?O[2]%360*hn:0,I()):[s*mi,u*mi,l*mi]},k.angle=function(O){return arguments.length?(f=O%360*hn,I()):f*mi},k.reflectX=function(O){return arguments.length?(d=O?-1:1,I()):d<0},k.reflectY=function(O){return arguments.length?(h=O?-1:1,I()):h<0},k.precision=function(O){return arguments.length?(S=Ahe(C,w=O*O),N()):So(w)},k.fitExtent=function(O,D){return iI(k,O,D)},k.fitSize=function(O,D){return Ej(k,O,D)},k.fitWidth=function(O,D){return Cj(k,O,D)},k.fitHeight=function(O,D){return Aj(k,O,D)};function I(){var O=khe(n,0,0,d,h,f).apply(null,t(a,o)),D=khe(n,r-O[0],i-O[1],d,h,f);return c=Kde(s,u,l),C=lj(t,D),_=lj(c,C),S=Ahe(C,w),N()}function N(){return E=A=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&T,I()}}function kj(e){var t=0,n=dn/3,r=The(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*hn,n=a[1]*hn):[t*mi,n*mi]},i}function bot(e){var t=Ot(e);function n(r,i){return[r*t,wt(i)/t]}return n.invert=function(r,i){return[r/t,ts(i*t)]},n}function xot(e,t){var n=wt(e),r=(n+wt(t))/2;if(Rn(r)<kt)return bot(e);var i=1+n*(2*r-n),a=So(i)/r;function o(s,u){var l=So(i-2*r*wt(u))/r;return[l*wt(s*=r),a-l*Ot(s)]}return o.invert=function(s,u){var l=a-u,c=bu(s,Rn(l))*xu(l);return l*r<0&&(c-=dn*xu(s)*xu(l)),[c/r,ts((i-(s*s+l*l)*r*r)/(2*r))]},o}function aI(){return kj(xot).scale(155.424).center([0,33.6442])}function Ohe(){return aI().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function wot(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function _ot(){var e,t,n=Ohe(),r,i=aI().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=aI().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(a.point(h,p),u)||(s.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=wot([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),a=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+kt,g+.12*h+kt],[p-.214*h-kt,g+.234*h-kt]]).stream(l),s=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+kt,g+.166*h+kt],[p-.115*h-kt,g+.234*h-kt]]).stream(l),f()},c.fitExtent=function(d,h){return iI(c,d,h)},c.fitSize=function(d,h){return Ej(c,d,h)},c.fitWidth=function(d,h){return Cj(c,d,h)},c.fitHeight=function(d,h){return Aj(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Ihe(e){return function(t,n){var r=Ot(t),i=Ot(n),a=e(r*i);return a===1/0?[2,0]:[a*i*wt(t),a*wt(n)]}}function T2(e){return function(t,n){var r=So(t*t+n*n),i=e(r),a=wt(i),o=Ot(i);return[bu(t*a,r*o),ts(r&&n*a/r)]}}var Nhe=Ihe(function(e){return So(2/(1+e))});Nhe.invert=T2(function(e){return 2*ts(e/2)});function Sot(){return $c(Nhe).scale(124.75).clipAngle(180-.001)}var Dhe=Ihe(function(e){return(e=Ode(e))&&e/wt(e)});Dhe.invert=T2(function(e){return e});function Eot(){return $c(Dhe).scale(79.4188).clipAngle(180-.001)}function oI(e,t){return[e,RO(J6((ii+t)/2))]}oI.invert=function(e,t){return[e,2*Dy(Tde(t))-ii]};function Cot(){return Rhe(oI).scale(961/_o)}function Rhe(e){var t=$c(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=s=u=l=null:(o=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,s],[u,l]]};function c(){var f=dn*r(),d=t(qat(t.rotate()).invert([0,0]));return a(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===oI?[[Math.max(d[0]-f,o),s],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function sI(e){return J6((ii+e)/2)}function Aot(e,t){var n=Ot(e),r=e===t?wt(e):RO(n/Ot(t))/RO(sI(t)/sI(e)),i=n*Z6(sI(e),r)/r;if(!r)return oI;function a(o,s){i>0?s<-ii+kt&&(s=-ii+kt):s>ii-kt&&(s=ii-kt);var u=i/Z6(sI(s),r);return[u*wt(r*o),i-u*Ot(r*o)]}return a.invert=function(o,s){var u=i-s,l=xu(r)*So(o*o+u*u),c=bu(o,Rn(u))*xu(u);return u*r<0&&(c-=dn*xu(o)*xu(u)),[c/r,2*Dy(Z6(i/l,1/r))-ii]},a}function kot(){return kj(Aot).scale(109.5).parallels([30,30])}function uI(e,t){return[e,t]}uI.invert=uI;function Tot(){return $c(uI).scale(152.63)}function Oot(e,t){var n=Ot(e),r=e===t?wt(e):(n-Ot(t))/(t-e),i=n/r+e;if(Rn(r)<kt)return uI;function a(o,s){var u=i-s,l=r*o;return[u*wt(l),i-u*Ot(l)]}return a.invert=function(o,s){var u=i-s,l=bu(o,Rn(u))*xu(u);return u*r<0&&(l-=dn*xu(o)*xu(u)),[l/r,i-xu(r)*So(o*o+u*u)]},a}function Iot(){return kj(Oot).scale(131.154).center([0,13.9389])}var O2=1.340264,I2=-.081106,N2=893e-6,D2=.003796,lI=So(3)/2,Not=12;function Fhe(e,t){var n=ts(lI*wt(t)),r=n*n,i=r*r*r;return[e*Ot(n)/(lI*(O2+3*I2*r+i*(7*N2+9*D2*r))),n*(O2+I2*r+i*(N2+D2*r))]}Fhe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,u;a<Not&&(s=n*(O2+I2*r+i*(N2+D2*r))-t,u=O2+3*I2*r+i*(7*N2+9*D2*r),n-=o=s/u,r=n*n,i=r*r*r,!(Rn(o)<IO));++a);return[lI*e*(O2+3*I2*r+i*(7*N2+9*D2*r))/Ot(n),ts(wt(n)/lI)]};function Dot(){return $c(Fhe).scale(177.158)}function Mhe(e,t){var n=Ot(t),r=Ot(e)*n;return[n*wt(e)/r,wt(t)/r]}Mhe.invert=T2(Dy);function Rot(){return $c(Mhe).scale(144.049).clipAngle(60)}function Fot(){var e=1,t=0,n=0,r=1,i=1,a=0,o,s,u=null,l,c,f,d=1,h=1,p=rI({point:function(x,w){var S=b([x,w]);this.stream.point(S[0],S[1])}}),g=_2,m,v;function y(){return d=e*r,h=e*i,m=v=null,b}function b(x){var w=x[0]*d,S=x[1]*h;if(a){var C=S*o-w*s;w=w*o+S*s,S=C}return[w+t,S+n]}return b.invert=function(x){var w=x[0]-t,S=x[1]-n;if(a){var C=S*o+w*s;w=w*o-S*s,S=C}return[w/d,S/h]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,_2):ihe(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(a=x%360*hn,s=wt(a),o=Ot(a),y()):a*mi},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return iI(b,x,w)},b.fitSize=function(x,w){return Ej(b,x,w)},b.fitWidth=function(x,w){return Cj(b,x,w)},b.fitHeight=function(x,w){return Aj(b,x,w)},b}function Phe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Phe.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(Rn(i)>kt&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Mot(){return $c(Phe).scale(175.295)}function $he(e,t){return[Ot(t)*wt(e),wt(t)]}$he.invert=T2(ts);function Pot(){return $c($he).scale(249.5).clipAngle(90+kt)}function Lhe(e,t){var n=Ot(t),r=1+Ot(e)*n;return[n*wt(e)/r,wt(t)/r]}Lhe.invert=T2(function(e){return 2*Dy(e)});function $ot(){return $c(Lhe).scale(250).clipAngle(142)}function Bhe(e,t){return[RO(J6((ii+t)/2)),-e]}Bhe.invert=function(e,t){return[-t,2*Dy(Tde(e))-ii]};function Lot(){var e=Rhe(Bhe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Bot=Math.abs,Tj=Math.cos,cI=Math.sin,zot=1e-6,zhe=Math.PI,Oj=zhe/2,jhe=jot(2);function Uhe(e){return e>1?Oj:e<-1?-Oj:Math.asin(e)}function jot(e){return e>0?Math.sqrt(e):0}function Uot(e,t){var n=e*cI(t),r=30,i;do t-=i=(t+cI(t)-n)/(1+Tj(t));while(Bot(i)>zot&&--r>0);return t/2}function Wot(e,t,n){function r(i,a){return[e*i*Tj(a=Uot(n,a)),t*cI(a)]}return r.invert=function(i,a){return a=Uhe(a/t),[i/(e*Tj(a)),Uhe((2*a+cI(2*a))/n)]},r}var Vot=Wot(jhe/Oj,jhe,zhe);function qot(){return $c(Vot).scale(169.529)}const Hot=Ehe(),Ij=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Got(e,t){return function n(){const r=t();return r.type=e,r.path=Ehe().projection(r),r.copy=r.copy||function(){const i=n();return Ij.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function Nj(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(fI[e]=Got(e,t),this):fI[e]||null}function Whe(e){return e&&e.path||Hot}const fI={albers:Ohe,albersusa:_ot,azimuthalequalarea:Sot,azimuthalequidistant:Eot,conicconformal:kot,conicequalarea:aI,conicequidistant:Iot,equalEarth:Dot,equirectangular:Tot,gnomonic:Rot,identity:Fot,mercator:Cot,mollweide:qot,naturalEarth1:Mot,orthographic:Pot,stereographic:$ot,transversemercator:Lot};for(const e in fI)Nj(e,fI[e]);function Kot(){}const rd=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Vhe(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return a(u,l,d=>{n(d,u,l),Xot(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Yot((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function a(u,l,c){var f=new Array,d=new Array,h,p,g,m,v,y;for(h=p=-1,m=u[0]>=l,rd[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,rd[g|m<<1].forEach(b);for(rd[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,v=u[p*e]>=l,rd[m<<1|v<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,y=v,v=u[p*e+h+1]>=l,rd[g|m<<1|v<<2|y<<3].forEach(b);rd[m|v<<3].forEach(b)}for(h=-1,v=u[p*e]>=l,rd[v<<2].forEach(b);++h<e-1;)y=v,v=u[p*e+h+1]>=l,rd[v<<2|y<<3].forEach(b);rd[v<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],S=[x[1][0]+h,x[1][1]+p],C=o(w),_=o(S),E,A;(E=d[C])?(A=f[_])?(delete d[E.end],delete f[A.start],E===A?(E.ring.push(S),c(E.ring)):f[E.start]=d[A.end]={start:E.start,end:A.end,ring:E.ring.concat(A.ring)}):(delete d[E.end],E.ring.push(S),d[E.end=_]=E):(E=f[_])?(A=d[C])?(delete f[E.start],delete d[A.end],E===A?(E.ring.push(S),c(E.ring)):f[A.start]=d[E.end]={start:A.start,end:E.end,ring:A.ring.concat(E.ring)}):(delete f[E.start],E.ring.unshift(w),f[E.start=C]=E):f[C]=d[_]={start:C,end:_,ring:[w,S]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,v=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(v-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||Ie("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:Kot,r):n===s},r}function Xot(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Yot(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Zot(e,t[n]))return i;return 0}function Zot(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var u=e[a],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(Jot(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function Jot(e,t,n){var r;return Qot(e,t,n)&&est(e[r=+(e[0]===t[0])],n[r],t[r])}function Qot(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function est(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function qhe(e,t,n){return function(r){var i=xc(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=t?Oh(a,o,e):s/(e+1);return Ps(a+u,o,u)}}function Dj(e){_e.call(this,null,e)}Dj.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Ge(Dj,_e,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||yo,a=Vhe().smooth(e.smooth!==!1),o=e.thresholds||tst(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=a.size([c.width,c.height])(c.values,bt(o)?o:o(c.values));nst(f,c,l,e),f.forEach(d=>{u.push(cT(l,Yn(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function tst(e,t,n){const r=qhe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>qg(t(i).values)))}function nst(e,t,n,r){let i=r.scale||t.scale,a=r.translate||t.translate;if(nn(i)&&(i=i(n,r)),nn(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(kh(i)?i:i[0])||1,s=(kh(i)?i:i[1])||1,u=a&&a[0]||0,l=a&&a[1]||0;e.forEach(Hhe(t,o,s,u,l))}function Hhe(e,t,n,r,i){const a=e.x1||0,o=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-a)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function Ghe(e,t,n){const r=e>=0?e:tz(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Rj(e){return nn(e)?e:Ba(+e)}function Khe(){var e=u=>u[0],t=u=>u[1],n=Z0,r=[-1,-1],i=960,a=500,o=2;function s(u,l){const c=Ghe(r[0],u,e)>>o,f=Ghe(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),g=2*h+(a>>o),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(x=>{const w=d+(+e(x)>>o),S=h+(+t(x)>>o);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(x))}),c>0&&f>0?($y(p,g,m,v,c),Ly(p,g,v,m,f),$y(p,g,m,v,c),Ly(p,g,v,m,f),$y(p,g,m,v,c),Ly(p,g,v,m,f)):c>0?($y(p,g,m,v,c),$y(p,g,v,m,c),$y(p,g,m,v,c),y=v):f>0&&(Ly(p,g,m,v,f),Ly(p,g,v,m,f),Ly(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*o):1/noe(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(i>>o),y2:h+(a>>o)}}return s.x=function(u){return arguments.length?(e=Rj(u),s):e},s.y=function(u){return arguments.length?(t=Rj(u),s):t},s.weight=function(u){return arguments.length?(n=Rj(u),s):n},s.size=function(u){if(!arguments.length)return[i,a];var l=+u[0],c=+u[1];return l>=0&&c>=0||Ie("invalid size"),i=l,a=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||Ie("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),s):1<<o},s.bandwidth=function(u){return arguments.length?(u=Dt(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&Ie("invalid bandwidth"),r=u,s):r},s}function $y(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+o*e]),s>=i&&(s>=a&&(u-=n[s-a+o*e]),r[s-i+o*e]=u/Math.min(s+1,e-1+a-s,a))}function Ly(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[o+s*e]),s>=i&&(s>=a&&(u-=n[o+(s-a)*e]),r[o+(s-i)*e]=u/Math.min(s+1,t-1+a-s,a))}function Fj(e){_e.call(this,null,e)}Fj.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const rst=["x","y","weight","size","cellSize","bandwidth"];function Xhe(e,t){return rst.forEach(n=>t[n]!=null?e[n](t[n]):0),e}Ge(Fj,_e,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=ist(r,e.groupby),a=(e.groupby||[]).map(ri),o=Xhe(Khe(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<a.length;++d)c[a[d]]=f[d];return c}return u=i.map(c=>Yn(l({[s]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function ist(e,t){var n=[],r=c=>c(s),i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function Mj(e){_e.call(this,null,e)}Mj.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Ge(Mj,_e,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Vhe().smooth(e.smooth!==!1),i=e.values,a=e.thresholds||qhe(e.count||10,e.nice,!!i),o=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=Xhe(Khe(),e)(i,!0),u=Hhe(s,s.scale||1,s.scale||1,0,0),o=[s.width,s.height],i=s.values),a=bt(a)?a:a(i),i=r.size(o)(i,a),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Yn),n}});const Pj="Feature",$j="FeatureCollection",ast="MultiPoint";function Lj(e){_e.call(this,null,e)}Lj.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Ge(Lj,_e,{transform(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],s=e.geojson||!i&&yo,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified($a(s))||a&&t.modified($a(a))||o&&t.modified($a(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),a&&o&&(t.visit(u,c=>{var f=a(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:Pj,geometry:{type:ast,coordinates:r}})),this.value={type:$j,features:n}}});function Bj(e){_e.call(this,null,e)}Bj.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Ge(Bj,_e,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||yo,a=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=Whe(e.projection),n.materialize().reflow()):o=i===yo||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=ost(r,e.pointRadius);return n.visit(o,u=>u[a]=r(i(u))),r.pointRadius(s),n.modifies(a)}});function ost(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function zj(e){_e.call(this,null,e)}zj.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Ge(zj,_e,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],s=a[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[s]=f[1]):(c[o]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(a)}});function jj(e){_e.call(this,null,e)}jj.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Ge(jj,_e,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;return(!r||e.modified())&&(this.value=r=sst(Whe(e.projection),e.field||Xo("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function sst(e,t,n){const r=n==null?i=>e(t(i)):i=>{var a=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(a),o};return r.context=i=>(e.context(i),r),r}function Uj(e){_e.call(this,[],e),this.generator=tot()}Uj.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Ge(Uj,_e,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const a in e)nn(r[a])&&r[a](e[a]);return i=r(),n.length?t.mod.push(fse(n[0],i)):t.add.push(Yn(i)),n[0]=i,t}});function Wj(e){_e.call(this,null,e)}Wj.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Ge(Wj,_e,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||yo,a=lst(e.opacity,e),o=ust(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?qg(n.map(l=>qg(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Zt({},l,u);r||(f.$max=qg(c.values||[])),l[s]=cst(c,f,o.dep?o:Ba(o(f)),a.dep?a:Ba(a(f)))}),t.reflow(!0).modifies(s)}});function ust(e,t){let n;return nn(e)?(n=r=>Uh(e(r,t)),n.dep=Yhe(e)):n=Ba(Uh(e||"#888")),n}function lst(e,t){let n;return nn(e)?(n=r=>e(r,t),n.dep=Yhe(e)):e?n=Ba(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function Yhe(e){if(!nn(e))return!1;const t=hl($a(e));return t.$x||t.$y||t.$value||t.$max}function cst(e,t,n,r){const i=e.width,a=e.height,o=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||a,c=e.values,f=c?m=>c[m]:Eh,d=dy(u-o,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-s),g=p.data;for(let m=s,v=0;m<l;++m){t.$y=m-s;for(let y=o,b=m*i;y<u;++y,v+=4){t.$x=y-o,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function Zhe(e){_e.call(this,null,e),this.modified(!0)}Ge(Zhe,_e,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=dst(e.type),Ij.forEach(r=>{e[r]!=null&&Jhe(n,r,e[r])})):Ij.forEach(r=>{e.modified(r)&&Jhe(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&fst(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fst(e,t){const n=hst(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function dst(e){const t=Nj((e||"mercator").toLowerCase());return t||Ie("Unrecognized projection type: "+e),t()}function Jhe(e,t,n){nn(e[t])&&e[t](n)}function hst(e){return e=Dt(e),e.length===1?e[0]:{type:$j,features:e.reduce((t,n)=>t.concat(pst(n)),[])}}function pst(e){return e.type===$j?e.features:Dt(e).filter(t=>t!=null).map(t=>t.type===Pj?t:{type:Pj,geometry:t})}var gst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:Mj,geojson:Lj,geopath:Bj,geopoint:zj,geoshape:jj,graticule:Uj,heatmap:Wj,isocontour:Dj,kde2d:Fj,projection:Zhe});function mst(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,u=0,l=0;for(a=0;a<o;++a)s=n[a],u+=s.x,l+=s.y;for(u=(u/o-e)*r,l=(l/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=u,s.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function vst(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Qhe(this.cover(t,n),t,n,e)}function Qhe(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,v,y;if(!a)return e._root=o,e;for(;a.length;)if((g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,e;if(h=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===h&&n===p)return o.next=a,i?i[v]=o:e._root=o,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=a,i[v]=o,e}function yst(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>f&&(f=a));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)Qhe(this,o[n],s[n],e[n]);return this}function bst(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function xst(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function wst(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ko(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function _st(e,t,n){var r,i=this._x0,a=this._y0,o,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new ko(h,i,a,c,f)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(u=p.x1)<i||(l=p.y1)<a))if(h.length){var m=(o+u)/2,v=(s+l)/2;d.push(new ko(h[3],m,v,u,l),new ko(h[2],o,v,m,l),new ko(h[1],m,s,u,v),new ko(h[0],o,s,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,a=t-w,c=e+w,f=t+w,r=h.data}}return r}function Sst(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function Est(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Cst(){return this._root}function Ast(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function kst(e){var t=[],n,r=this._root,i,a,o,s,u;for(r&&t.push(new ko(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(a+s)/2,c=(o+u)/2;(i=r[3])&&t.push(new ko(i,l,c,s,u)),(i=r[2])&&t.push(new ko(i,a,c,l,u)),(i=r[1])&&t.push(new ko(i,l,o,s,c)),(i=r[0])&&t.push(new ko(i,a,o,l,c))}return this}function Tst(e){var t=[],n=[],r;for(this._root&&t.push(new ko(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(s+l)/2;(a=i[0])&&t.push(new ko(a,o,s,c,f)),(a=i[1])&&t.push(new ko(a,c,s,u,f)),(a=i[2])&&t.push(new ko(a,o,f,c,l)),(a=i[3])&&t.push(new ko(a,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Ost(e){return e[0]}function Ist(e){return arguments.length?(this._x=e,this):this._x}function Nst(e){return e[1]}function Dst(e){return arguments.length?(this._y=e,this):this._y}function Vj(e,t,n){var r=new qj(t??Ost,n??Nst,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function qj(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function epe(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var To=Vj.prototype=qj.prototype;To.copy=function(){var e=new qj(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=epe(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=epe(r));return e},To.add=vst,To.addAll=yst,To.cover=bst,To.data=xst,To.extent=wst,To.find=_st,To.remove=Sst,To.removeAll=Est,To.root=Cst,To.size=Ast,To.visit=kst,To.visitAfter=Tst,To.x=Ist,To.y=Dst;function Oo(e){return function(){return e}}function op(e){return(e()-.5)*1e-6}function Rst(e){return e.x+e.vx}function Fst(e){return e.y+e.vy}function Mst(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=Oo(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,v=0;v<a;++v)for(f=Vj(t,Rst,Fst).visitAfter(s),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,x,w,S,C){var _=b.data,E=b.r,A=g+E;if(_){if(_.index>d.index){var k=h-_.x-_.vx,T=p-_.y-_.vy,I=k*k+T*T;I<A*A&&(k===0&&(k=op(r),I+=k*k),T===0&&(T=op(r),I+=T*T),I=(A-(I=Math.sqrt(I)))/I*i,d.vx+=(k*=I)*(A=(E*=E)/(m+E)),d.vy+=(T*=I)*A,_.vx-=k*(A=1-A),_.vy-=T*A)}return}return x>h+A||S<h-A||w>p+A||C<p-A}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Oo(+l),u(),o):e},o}function Pst(e){return e.index}function tpe(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function $st(e){var t=Pst,n=f,r,i=Oo(30),a,o,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,S,C,_,E,A;b<y;++b)x=e[b],w=x.source,S=x.target,C=S.x+S.vx-w.x-w.vx||op(l),_=S.y+S.vy-w.y-w.vy||op(l),E=Math.sqrt(C*C+_*_),E=(E-a[b])/E*m*r[b],C*=E,_*=E,S.vx-=C*(A=u[b]),S.vy-=_*A,w.vx+=C*(A=1-A),w.vy+=_*A}function h(){if(!!o){var m,v=o.length,y=e.length,b=new Map(o.map((w,S)=>[t(w,S,o),w])),x;for(m=0,s=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=tpe(b,x.source)),typeof x.target!="object"&&(x.target=tpe(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(!!o)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!o)for(var m=0,v=e.length;m<v;++m)a[m]=+i(e[m],m,e)}return d.initialize=function(m,v){o=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Oo(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Oo(+m),g(),d):i},d}var Lst={value:()=>{}};function npe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new dI(n)}function dI(e){this._=e}function Bst(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}dI.prototype=npe.prototype={constructor:dI,on:function(e,t){var n=this._,r=Bst(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=zst(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=rpe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=rpe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new dI(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function zst(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function rpe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Lst,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var By=0,R2=0,F2=0,ipe=1e3,hI,M2,pI=0,gm=0,gI=0,P2=typeof performance=="object"&&performance.now?performance:Date,ape=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Hj(){return gm||(ape(jst),gm=P2.now()+gI)}function jst(){gm=0}function mI(){this._call=this._time=this._next=null}mI.prototype=ope.prototype={constructor:mI,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Hj():+n)+(t==null?0:+t),!this._next&&M2!==this&&(M2?M2._next=this:hI=this,M2=this),this._call=e,this._time=n,Gj()},stop:function(){this._call&&(this._call=null,this._time=1/0,Gj())}};function ope(e,t,n){var r=new mI;return r.restart(e,t,n),r}function Ust(){Hj(),++By;for(var e=hI,t;e;)(t=gm-e._time)>=0&&e._call.call(null,t),e=e._next;--By}function spe(){gm=(pI=P2.now())+gI,By=R2=0;try{Ust()}finally{By=0,Vst(),gm=0}}function Wst(){var e=P2.now(),t=e-pI;t>ipe&&(gI-=t,pI=e)}function Vst(){for(var e,t=hI,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:hI=n);M2=e,Gj(r)}function Gj(e){if(!By){R2&&(R2=clearTimeout(R2));var t=e-gm;t>24?(e<1/0&&(R2=setTimeout(spe,e-P2.now()-gI)),F2&&(F2=clearInterval(F2))):(F2||(pI=P2.now(),F2=setInterval(Wst,ipe)),By=1,ape(spe))}}function qst(e,t,n){var r=new mI,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(a,o,s){o=+o,s=s==null?Hj():+s,r._restart(function u(l){l+=i,r._restart(u,i+=o,s),a(l)},o,s)},r.restart(e,t,n),r)}const Hst=1664525,Gst=1013904223,upe=4294967296;function Kst(){let e=1;return()=>(e=(Hst*e+Gst)%upe)/upe}function Xst(e){return e.x}function Yst(e){return e.y}var Zst=10,Jst=Math.PI*(3-Math.sqrt(5));function Qst(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=ope(f),l=npe("tick","end"),c=Kst();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(a-n)*i,s.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=Zst*Math.sqrt(.5+g),b=g*Jst;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(a=+g,t):a},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,s.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?s.delete(g):s.set(g,p(m)),t):s.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,S,C,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)C=e[y],x=g-C.x,w=m-C.y,S=x*x+w*w,S<v&&(_=C,v=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function eut(){var e,t,n,r,i=Oo(-30),a,o=1,s=1/0,u=.81;function l(h){var p,g=e.length,m=Vj(e,Xst,Yst).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(a=new Array(p),h=0;h<p;++h)g=e[h],a[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,v=0,y,b,x;if(h.length){for(y=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,x=v*v+y*y;if(b*b/u<x)return x<s&&(v===0&&(v=op(n),x+=v*v),y===0&&(y=op(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)),t.vx+=v*h.value*r/x,t.vy+=y*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(v===0&&(v=op(n),x+=v*v),y===0&&(y=op(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=a[h.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Oo(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function tut(e){var t=Oo(.1),n,r,i;typeof e!="function"&&(e=Oo(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Oo(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Oo(+s),o(),a):e},a}function nut(e){var t=Oo(.1),n,r,i;typeof e!="function"&&(e=Oo(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:Oo(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:Oo(+s),o(),a):e},a}const lpe={center:mst,collide:Mst,nbody:eut,link:$st,x:tut,y:nut},$2="forces",Kj=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],rut=["static","iterations"],cpe=["x","y","vx","vy"];function Xj(e){_e.call(this,null,e)}Xj.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:cpe}]},Ge(Xj,_e,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(Kj),a=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&fpe(n,e,0,t)):(this.value=n=aut(t.source,e),n.on("tick",iut(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(rut)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==$2||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(cpe)}});function iut(e,t){return()=>e.touch(t).run()}function aut(e,t){const n=Qst(e),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),fpe(n,t,!0).on("end",()=>a=!0)}function fpe(e,t,n,r){var i=Dt(t.forces),a,o,s,u;for(a=0,o=Kj.length;a<o;++a)s=Kj[a],s!==$2&&t.modified(s)&&e[s](t[s]);for(a=0,o=i.length;a<o;++a)u=$2+a,s=n||t.modified($2,a)?sut(i[a]):r&&out(i[a],r)?e.force(u):null,s&&e.force(u,s);for(o=e.numForces||0;a<o;++a)e.force($2+a,null);return e.numForces=i.length,e}function out(e,t){var n,r;for(n in e)if(nn(r=e[n])&&t.modified($a(r)))return 1;return 0}function sut(e){var t,n;Rt(lpe,e.force)||Ie("Unrecognized force: "+e.force),t=lpe[e.force]();for(n in e)nn(t[n])&&uut(t[n],e[n],e);return t}function uut(e,t,n){e(nn(t)?r=>t(r,n):t)}var lut=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Xj});function cut(e,t){return e.parent===t.parent?1:2}function fut(e){return e.reduce(dut,0)/e.length}function dut(e,t){return e+t.x}function hut(e){return 1+e.reduce(put,0)}function put(e,t){return Math.max(e,t.y)}function gut(e){for(var t;t=e.children;)e=t[0];return e}function mut(e){for(var t;t=e.children;)e=t[t.length-1];return e}function vut(){var e=cut,t=1,n=1,r=!1;function i(a){var o,s=0;a.eachAfter(function(d){var h=d.children;h?(d.x=fut(h),d.y=hut(h)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var u=gut(a),l=mut(a),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return a.eachAfter(r?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],i):r?null:[t,n]},i.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],i):r?[t,n]:null},i}function yut(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function but(){return this.eachAfter(yut)}function xut(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function wut(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function _ut(e,t){for(var n=this,r=[n],i=[],a,o,s,u=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function Sut(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Eut(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Cut(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Aut(e){for(var t=this,n=kut(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function kut(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Tut(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Out(){return Array.from(this)}function Iut(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Nut(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Dut(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function Yj(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Mut)):t===void 0&&(t=Fut);for(var n=new zy(e),r,i=[n],a,o,s,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new zy(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(dpe)}function Rut(){return Yj(this).eachBefore(Put)}function Fut(e){return e.children}function Mut(e){return Array.isArray(e)?e[1]:null}function Put(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function dpe(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function zy(e){this.data=e,this.depth=this.height=0,this.parent=null}zy.prototype=Yj.prototype={constructor:zy,count:but,each:xut,eachAfter:_ut,eachBefore:wut,find:Sut,sum:Eut,sort:Cut,path:Aut,ancestors:Tut,descendants:Out,leaves:Iut,links:Nut,copy:Rut,[Symbol.iterator]:Dut};function $ut(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Lut(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function But(e){for(var t=0,n=(e=Lut(Array.from(e))).length,r=[],i,a;t<n;)i=e[t],a&&hpe(a,i)?++t:(a=jut(r=zut(r,i)),t=0);return a}function zut(e,t){var n,r;if(Zj(t,e))return[t];for(n=0;n<e.length;++n)if(vI(t,e[n])&&Zj(L2(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(vI(L2(e[n],e[r]),t)&&vI(L2(e[n],t),e[r])&&vI(L2(e[r],t),e[n])&&Zj(ppe(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function vI(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function hpe(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Zj(e,t){for(var n=0;n<t.length;++n)if(!hpe(e,t[n]))return!1;return!0}function jut(e){switch(e.length){case 1:return Uut(e[0]);case 2:return L2(e[0],e[1]);case 3:return ppe(e[0],e[1],e[2])}}function Uut(e){return{x:e.x,y:e.y,r:e.r}}function L2(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,u=a-n,l=o-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+a+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+s)/2}}function ppe(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-s,g=i-c,m=u-a,v=f-a,y=r*r+i*i-a*a,b=y-o*o-s*s+u*u,x=y-l*l-c*c+f*f,w=h*p-d*g,S=(p*x-g*b)/(w*2)-r,C=(g*m-p*v)/w,_=(h*b-d*x)/(w*2)-i,E=(d*v-h*m)/w,A=C*C+E*E-1,k=2*(a+S*C+_*E),T=S*S+_*_-a*a,I=-(A?(k+Math.sqrt(k*k-4*A*T))/(2*A):T/k);return{x:r+S+C*I,y:i+_+E*I,r:I}}function gpe(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,s,u,l=r*r+o*o;l?(a=t.r+n.r,a*=a,u=e.r+n.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*o,n.y=e.y-i*o+s*r):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x+i*r-s*o,n.y=t.y+i*o+s*r)):(n.x=t.x+n.r,n.y=t.y)}function mpe(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function vpe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function yI(e){this._=e,this.next=null,this.previous=null}function Wut(e){if(!(i=(e=$ut(e)).length))return 0;var t,n,r,i,a,o,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;gpe(n,t,r=e[2]),t=new yI(t),n=new yI(n),r=new yI(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){gpe(t._,n._,r=e[s]),r=new yI(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(mpe(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(mpe(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,a=vpe(t);(r=r.next)!==n;)(o=vpe(r))<a&&(t=r,a=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=But(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function Vut(e){return e==null?null:bI(e)}function bI(e){if(typeof e!="function")throw new Error;return e}function mm(){return 0}function jy(e){return function(){return e}}function qut(e){return Math.sqrt(e.value)}function Hut(){var e=null,t=1,n=1,r=mm;function i(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(ype(e)).eachAfter(Jj(r,.5)).eachBefore(bpe(1)):a.eachBefore(ype(qut)).eachAfter(Jj(mm,1)).eachAfter(Jj(r,a.r/Math.min(t,n))).eachBefore(bpe(Math.min(t,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=Vut(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],n=+a[1],i):[t,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:jy(+a),i):r},i}function ype(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Jj(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,s;if(o)for(i=0;i<a;++i)r[i].r+=o;if(s=Wut(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=s+o}}}function bpe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function xpe(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function B2(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)o=a[s],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function Gut(){var e=1,t=1,n=0,r=!1;function i(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),r&&o.eachBefore(xpe),o}function a(o,s){return function(u){u.children&&B2(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var Kut={depth:-1},wpe={};function Xut(e){return e.id}function Yut(e){return e.parentId}function _pe(){var e=Xut,t=Yut;function n(r){var i=Array.from(r),a=i.length,o,s,u,l,c,f,d,h=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new zy(o),(f=e(o,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?wpe:c)),(f=t(o,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===wpe)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=Kut,u.eachBefore(function(p){p.depth=p.parent.depth+1,--a}).eachBefore(dpe),u.parent=null,a>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=bI(r),n):e},n.parentId=function(r){return arguments.length?(t=bI(r),n):t},n}function Zut(e,t){return e.parent===t.parent?1:2}function Qj(e){var t=e.children;return t?t[0]:e.t}function e8(e){var t=e.children;return t?t[t.length-1]:e.t}function Jut(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Qut(e){for(var t=0,n=0,r=e.children,i=r.length,a;--i>=0;)a=r[i],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function elt(e,t,n){return e.a.parent===t.parent?e.a:n}function xI(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}xI.prototype=Object.create(zy.prototype);function tlt(e){for(var t=new xI(e,0),n,r=[t],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new xI(a[o],o)),i.parent=n;return(t.parent=new xI(null,0)).children=[t],t}function nlt(){var e=Zut,t=1,n=1,r=null;function i(l){var c=tlt(l);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function a(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Qut(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m,x;p=e8(p),d=Qj(d),p&&d;)g=Qj(g),h=e8(h),h.a=l,x=p.z+y-d.z-m+e(p._,d._),x>0&&(Jut(elt(p,l,f),l,x),m+=x,v+=x),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!e8(h)&&(h.t=p,h.m+=y-v),d&&!Qj(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function wI(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)o=a[s],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var Spe=(1+Math.sqrt(5))/2;function Epe(e,t,n,r,i,a){for(var o=[],s=t.children,u,l,c=0,f=0,d=s.length,h,p,g=t.value,m,v,y,b,x,w,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=y=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,x=Math.max(y/S,S/v);f<d;++f){if(m+=l=s[f].value,l<v&&(v=l),l>y&&(y=l),S=m*m*w,b=Math.max(y/S,S/v),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:s.slice(c,f)}),u.dice?B2(u,n,r,i,g?r+=p*m/g:a):wI(u,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}var Cpe=function e(t){function n(r,i,a,o,s){Epe(t,r,i,a,o,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Spe);function rlt(){var e=Cpe,t=!1,n=1,r=1,i=[0],a=mm,o=mm,s=mm,u=mm,l=mm;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(xpe),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=l(d)-h,g+=o(d)-h,m-=s(d)-h,v-=u(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=bI(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:jy(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:jy(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:jy(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:jy(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:jy(+d),c):l},c}function ilt(e,t,n,r,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,p,g,m,v){if(f>=d-1){var y=a[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=l[f],x=h/2+b,w=f+1,S=d-1;w<S;){var C=w+S>>>1;l[C]<x?w=C+1:S=C}x-l[w-1]<l[w]-x&&f+1<w&&--w;var _=l[w]-b,E=h-_;if(m-p>v-g){var A=h?(p*E+m*_)/h:m;c(f,w,_,p,g,A,v),c(w,d,E,A,g,m,v)}else{var k=h?(g*E+v*_)/h:v;c(f,w,_,p,g,m,k),c(w,d,E,p,k,m,v)}}}function alt(e,t,n,r,i){(e.depth&1?wI:B2)(e,t,n,r,i)}var olt=function e(t){function n(r,i,a,o,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?B2(l,i,a,o,g?a+=(s-a)*l.value/g:s):wI(l,i,a,g?i+=(o-i)*l.value/g:o,s),g-=l.value}else r._squarify=u=Epe(t,r,i,a,o,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Spe);function t8(e,t,n){const r={};return e.each(i=>{const a=i.data;n(a)&&(r[t(a)]=i)}),e.lookup=r,e}function n8(e){_e.call(this,null,e)}n8.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const slt=e=>e.values;Ge(n8,_e,{transform(e,t){t.source||Ie("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;return(!a||r||t.changed())&&(a&&a.each(o=>{o.children&&lT(o.data)&&i.rem.push(o.data)}),this.value=a=Yj({values:Dt(e.keys).reduce((o,s)=>(o.key(s),o),ult()).entries(i.source)},slt),n&&a.each(o=>{o.children&&(o=Yn(o.data),i.add.push(o),i.source.push(o))}),t8(a,xt,xt)),i.source.root=a,i}});function ult(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,a){if(a>=e.length)return i;const o=i.length,s=e[a++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],a);return l}function r(i,a){if(++a>e.length)return i;const o=[];for(const s in i)o.push({key:s,values:r(i[s],a)});return o}return t}function id(e){_e.call(this,null,e)}const llt=(e,t)=>e.parent===t.parent?1:2;Ge(id,_e,{transform(e,t){(!t.source||!t.source.root)&&Ie(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Yg(e.sort,o=>o.data)),clt(n,this.params,e),n.separation&&n.separation(e.separation!==!1?llt:Z0);try{this.value=n(i)}catch(o){Ie(o)}return i.each(o=>flt(o,r,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function clt(e,t,n){for(let r,i=0,a=t.length;i<a;++i)r=t[i],r in n&&e[r](n[r])}function flt(e,t,n){const r=e.data,i=t.length-1;for(let a=0;a<i;++a)r[n[a]]=e[t[a]];r[n[i]]=e.children?e.children.length:0}const r8=["x","y","r","depth","children"];function i8(e){id.call(this,e)}i8.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:r8.length,default:r8}]},Ge(i8,id,{layout:Hut,params:["radius","size","padding"],fields:r8});const a8=["x0","y0","x1","y1","depth","children"];function o8(e){id.call(this,e)}o8.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:a8.length,default:a8}]},Ge(o8,id,{layout:Gut,params:["size","round","padding"],fields:a8});function s8(e){_e.call(this,null,e)}s8.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Ge(s8,_e,{transform(e,t){t.source||Ie("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?t8(_pe().id(e.key).parentId(e.parentKey)(i.source),e.key,hu):t8(_pe()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Ape={tidy:nlt,cluster:vut},u8=["x","y","depth","children"];function l8(e){id.call(this,e)}l8.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:u8.length,default:u8}]},Ge(l8,id,{layout(e){const t=e||"tidy";if(Rt(Ape,t))return Ape[t]();Ie("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:u8});function c8(e){_e.call(this,[],e)}c8.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Ge(c8,_e,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return r||Ie("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>a[xt(o)]=1),r.each(o=>{const s=o.data,u=o.parent&&o.parent.data;u&&a[xt(s)]&&a[xt(u)]&&i.add.push(Yn({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>a[xt(o)]=1),n.forEach(o=>{(a[xt(o.source)]||a[xt(o.target)])&&i.mod.push(o)})),i}});const kpe={binary:ilt,dice:B2,slice:wI,slicedice:alt,squarify:Cpe,resquarify:olt},f8=["x0","y0","x1","y1","depth","children"];function d8(e){id.call(this,e)}d8.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:f8.length,default:f8}]},Ge(d8,id,{layout(){const e=rlt();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Rt(kpe,t)?e.tile(kpe[t]):Ie("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:f8});var dlt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:n8,pack:i8,partition:o8,stratify:s8,tree:l8,treelinks:c8,treemap:d8});const hlt=4278190080,plt=268435456,glt=.0625;function mlt(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function vlt(e,t,n,r){const i=e.width,a=e.height,o=n||r,s=dy(i,a).getContext("2d");t.forEach(m=>Tpe(s,m,o));const u=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,g;for(d=0;d<a;++d)for(f=0;f<i;++f)g=u[d*i+f]&hlt,g&&(h=e(f),p=e(d),r||l.set(h,p),o&&g^plt&&c.set(h,p));return[l,c]}function Tpe(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(a=>Tpe(e,a.items,n))}):Bs[r].draw(e,{items:n?t.map(ylt):t})}function ylt(e){const t=cT(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=glt,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const ad=5,Io=31,z2=32,sp=new Uint32Array(z2+1),Sl=new Uint32Array(z2+1);Sl[0]=0,sp[0]=~Sl[0];for(let e=1;e<=z2;++e)Sl[e]=Sl[e-1]<<1|1,sp[e]=~Sl[e];function blt(e,t){const n=new Uint32Array(~~((e*t+z2)/z2));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const s=o*e+a;return n[s>>>ad]&1<<(s&Io)},set:(a,o)=>{const s=o*e+a;r(s>>>ad,1<<(s&Io))},clear:(a,o)=>{const s=o*e+a;i(s>>>ad,~(1<<(s&Io)))},getRange:(a,o,s,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+a,f=l*e+s,d=c>>>ad,h=f>>>ad,d===h){if(n[d]&sp[c&Io]&Sl[(f&Io)+1])return!0}else{if(n[d]&sp[c&Io]||n[h]&Sl[(f&Io)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>ad,d=c>>>ad,f===d)r(f,sp[l&Io]&Sl[(c&Io)+1]);else for(r(f,sp[l&Io]),r(d,Sl[(c&Io)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>ad,d=c>>>ad,f===d)i(f,Sl[l&Io]|sp[(c&Io)+1]);else for(i(f,Sl[l&Io]),i(d,sp[(c&Io)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(a,o,s,u)=>a<0||o<0||u>=t||s>=e}}function xlt(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=s=>~~((s+n)/r);return o.invert=s=>s*r-n,o.bitmap=()=>blt(i,a),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function wlt(e,t,n,r){const i=e.width,a=e.height;return function(o){const s=o.datum.datum.items[r].items,u=s.length,l=o.datum.fontSize,c=Nc.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,v,y;for(let b=0;b<u;++b)d=s[b].x,p=s[b].y,h=s[b].x2===void 0?d:s[b].x2,g=s[b].y2===void 0?p:s[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=v);return m=c/2,v=l/2,d=o.x-m,h=o.x+m,p=o.y-v,g=o.y+v,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&g<=a?o.baseline="top":0<=p&&a<g&&(o.baseline="bottom"),!0}}function _I(e,t,n,r,i,a){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function up(e,t,n,r,i,a,o,s){const u=i*a/(r*2),l=e(t-u),c=e(t+u),f=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function _lt(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,v=a,y;if(!_I(p,g,d,h,i,a)&&!up(e,p,g,h,d,m,o,s)&&!up(e,p,g,h,d,h,o,null)){for(;v-m>=1;)y=(m+v)/2,up(e,p,g,h,d,y,o,s)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Nc.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,v=0,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,P,V;for(let Y=0;Y<f;++Y){for(y=c[Y].x,x=c[Y].y,b=c[Y].x2===void 0?y:c[Y].x2,w=c[Y].y2===void 0?x:c[Y].y2,y>b&&(V=y,y=b,b=V),x>w&&(V=x,x=w,w=V),A=e(y),T=e(b),k=~~((A+T)/2),I=e(x),O=e(w),N=~~((I+O)/2),_=k;_>=A;--_)for(E=N;E>=I;--E)P=u(_,E,p,h,d),P&&([l.x,l.y,p,g]=P);for(_=k;_<=T;++_)for(E=N;E<=O;++E)P=u(_,E,p,h,d),P&&([l.x,l.y,p,g]=P);!g&&!n&&(D=Math.abs(b-y+w-x),S=(y+b)/2,C=(x+w)/2,D>=v&&!_I(S,C,h,d,i,a)&&!up(e,S,C,d,h,d,o,null)&&(v=D,l.x=S,l.y=C,m=!0))}return g||m?(S=h/2,C=d/2,o.setRange(e(l.x-S),e(l.y-C),e(l.x+S),e(l.y+C)),l.align="center",l.baseline="middle",!0):!1}}const Slt=[-1,-1,1,1],Elt=[-1,1,-1,1];function Clt(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Nc.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,v=!1,y=0,b,x,w,S,C,_,E,A,k,T,I,N;for(let O=0;O<f;++O){for(b=c[O].x,w=c[O].y,x=c[O].x2===void 0?b:c[O].x2,S=c[O].y2===void 0?w:c[O].y2,p.push([e((b+x)/2),e((w+S)/2)]);p.length;)if([E,A]=p.pop(),!(o.get(E,A)||s.get(E,A)||u.get(E,A))){u.set(E,A);for(let D=0;D<4;++D)C=E+Slt[D],_=A+Elt[D],u.outOfBounds(C,_,C,_)||p.push([C,_]);if(C=e.invert(E),_=e.invert(A),k=g,T=a,!_I(C,_,h,d,i,a)&&!up(e,C,_,d,h,k,o,s)&&!up(e,C,_,d,h,d,o,null)){for(;T-k>=1;)I=(k+T)/2,up(e,C,_,d,h,I,o,s)?T=I:k=I;k>g&&(l.x=C,l.y=_,g=k,m=!0)}}!m&&!n&&(N=Math.abs(x-b+S-w),C=(b+x)/2,_=(w+S)/2,N>=y&&!_I(C,_,h,d,i,a)&&!up(e,C,_,d,h,d,o,null)&&(y=N,l.x=C,l.y=_,v=!0))}return m||v?(C=h/2,_=d/2,o.setRange(e(l.x-C),e(l.y-_),e(l.x+C),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Alt=["right","center","left"],klt=["bottom","middle","top"];function Tlt(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>a)return!1;let d=0,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k;for(let T=0;T<u;++T){if(h=(n[T]&3)-1,p=(n[T]>>>2&3)-1,g=h===0&&p===0||r[T]<0,m=h&&p?Math.SQRT1_2:1,v=r[T]<0?-1:1,y=c[1+h]+r[T]*h*m,C=c[4+p]+v*f*p/2+r[T]*p*m,x=C-f/2,w=C+f/2,_=e(y),A=e(x),k=e(w),!d)if(Ope(_,_,A,k,o,s,y,y,x,w,c,g))d=Nc.width(l.datum,l.datum.text);else continue;if(S=y+v*d*h/2,y=S-d/2,b=S+d/2,_=e(y),E=e(b),Ope(_,E,A,k,o,s,y,b,x,w,c,g))return l.x=h?h*v<0?b:y:S,l.y=p?p*v<0?w:x:C,l.align=Alt[h*v+1],l.baseline=klt[p*v+1],o.setRange(_,A,E,k),!0}return!1}}function Ope(e,t,n,r,i,a,o,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&a?a.getRange(e,n,t,r)||!Olt(o,u,s,l,c):i.getRange(e,n,t,r)))}function Olt(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const h8=0,p8=4,g8=8,m8=0,v8=1,y8=2,Ilt={"top-left":h8+m8,top:h8+v8,"top-right":h8+y8,left:p8+m8,middle:p8+v8,right:p8+y8,"bottom-left":g8+m8,bottom:g8+v8,"bottom-right":g8+y8},Nlt={naive:wlt,"reduced-search":_lt,floodfill:Clt};function Dlt(e,t,n,r,i,a,o,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=Rlt(r,f),h=Flt(i,f),p=Mlt(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",v=Plt(p,g,s,u),y=xlt(t[0],t[1],l),b=m&&c==="naive",x=e.map(C=>({datum:C,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(C)}));let w;if(!b){n&&x.sort((_,E)=>n(_.datum,E.datum));let C=!1;for(let _=0;_<h.length&&!C;++_)C=h[_]===5||d[_]<0;p&&(o||m)&&(a=[e.map(_=>_.datum)].concat(a)),w=a.length?vlt(y,a,C,m):mlt(y,o&&x)}const S=m?Nlt[c](y,w,o,u):Tlt(y,w,h,d);return x.forEach(C=>C.opacity=+S(C)),x}function Rlt(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Flt(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Ilt[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Mlt(e){return e&&e.mark&&e.mark.marktype}function Plt(e,t,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>i(a.datum):t==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const b8=["x","y","opacity","align","baseline"],Ipe=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function x8(e){_e.call(this,null,e)}x8.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Ipe},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:b8.length,default:b8}]},Ge(x8,_e,{transform(e,t){function n(a){const o=e[a];return nn(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Ie("Size parameter should be specified as a [width, height] array.");const i=e.as||b8;return Dlt(t.materialize(t.SOURCE).source,e.size,e.sort,Dt(e.offset||1),Dt(e.anchor||Ipe),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),t.reflow(r).modifies(i)}});var $lt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:x8});function Npe(e,t){var n=[],r=function(c){return c(s)},i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function w8(e){_e.call(this,null,e)}w8.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Ge(w8,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Npe(r,e.groupby),a=(e.groupby||[]).map(ri),o=a.length,s=e.as||[ri(e.x),ri(e.y)],u=[];i.forEach(l=>{$se(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[a[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Yn(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const _8={linear:hz,log:Nse,exp:Dse,pow:Rse,quad:pz,poly:Fse},Llt=(e,t)=>e==="poly"?t:e==="quad"?2:1;function S8(e){_e.call(this,null,e)}S8.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(_8)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Ge(S8,_e,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Npe(r,e.groupby),a=(e.groupby||[]).map(ri),o=e.method||"linear",s=e.order||3,u=Llt(o,s),l=e.as||[ri(e.x),ri(e.y)],c=_8[o],f=[];let d=e.extent;Rt(_8,o)||Ie("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,s);if(e.params){f.push(Yn({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||xc(h,e.x),v=y=>{const b={};for(let x=0;x<a.length;++x)b[a[x]]=h.dims[x];b[l[0]]=y[0],b[l[1]]=y[1],f.push(Yn(b))};o==="linear"?m.forEach(y=>v([y,g.predict(y)])):xT(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var Blt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:w8,regression:S8});const Dpe=Math.pow(2,-52),SI=new Uint32Array(512);class EI{static from(t,n=Vlt,r=qlt){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new EI(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let A=0;A<o;A++){const k=t[2*A],T=t[2*A+1];k<s&&(s=k),T<u&&(u=T),k>l&&(l=k),T>c&&(c=T),this._ids[A]=A}const f=(s+l)/2,d=(u+c)/2;let h=1/0,p,g,m;for(let A=0;A<o;A++){const k=E8(f,d,t[2*A],t[2*A+1]);k<h&&(p=A,h=k)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let A=0;A<o;A++){if(A===p)continue;const k=E8(v,y,t[2*A],t[2*A+1]);k<h&&k>0&&(g=A,h=k)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let A=0;A<o;A++){if(A===p||A===g)continue;const k=Ult(v,y,b,x,t[2*A],t[2*A+1]);k<w&&(m=A,w=k)}let S=t[2*m],C=t[2*m+1];if(w===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];Uy(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let k=0;for(let T=0,I=-1/0;T<o;T++){const N=this._ids[T];this._dists[N]>I&&(A[k++]=N,I=this._dists[N])}this.hull=A.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(CI(v,y,b,x,S,C)){const A=g,k=b,T=x;g=m,b=S,x=C,m=A,S=k,C=T}const _=Wlt(v,y,b,x,S,C);this._cx=_.x,this._cy=_.y;for(let A=0;A<o;A++)this._dists[A]=E8(t[2*A],t[2*A+1],_.x,_.y);Uy(this._ids,this._dists,0,o-1),this._hullStart=p;let E=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,a.fill(-1),a[this._hashKey(v,y)]=p,a[this._hashKey(b,x)]=g,a[this._hashKey(S,C)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let A=0,k,T;A<this._ids.length;A++){const I=this._ids[A],N=t[2*I],O=t[2*I+1];if(A>0&&Math.abs(N-k)<=Dpe&&Math.abs(O-T)<=Dpe||(k=N,T=O,I===p||I===g||I===m))continue;let D=0;for(let Q=0,me=this._hashKey(N,O);Q<this._hashSize&&(D=a[(me+Q)%this._hashSize],!(D!==-1&&D!==r[D]));Q++);D=n[D];let P=D,V;for(;V=r[P],!CI(N,O,t[2*P],t[2*P+1],t[2*V],t[2*V+1]);)if(P=V,P===D){P=-1;break}if(P===-1)continue;let Y=this._addTriangle(P,I,r[P],-1,-1,i[P]);i[I]=this._legalize(Y+2),i[P]=Y,E++;let X=r[P];for(;V=r[X],CI(N,O,t[2*X],t[2*X+1],t[2*V],t[2*V+1]);)Y=this._addTriangle(X,I,V,i[I],-1,i[X]),i[I]=this._legalize(Y+2),r[X]=X,E--,X=V;if(P===D)for(;V=n[P],CI(N,O,t[2*V],t[2*V+1],t[2*P],t[2*P+1]);)Y=this._addTriangle(V,I,P,-1,i[P],i[V]),this._legalize(Y+2),i[V]=Y,r[P]=P,E--,P=V;this._hullStart=n[I]=P,r[P]=n[X]=I,r[I]=X,a[this._hashKey(N,O)]=I,a[this._hashKey(t[2*P],t[2*P+1])]=P}this.hull=new Uint32Array(E);for(let A=0,k=this._hullStart;A<E;A++)this.hull[A]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(zlt(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const s=r[t],u=t-t%3;if(o=u+(t+2)%3,s===-1){if(a===0)break;t=SI[--a];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(jlt(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[s]=d;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(s,r[o]),this._link(o,f);const y=l+(s+1)%3;a<SI.length&&(SI[a++]=y)}else{if(a===0)break;t=SI[--a]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,a,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,a),this._link(s+2,o),this.trianglesLen+=3,s}}function zlt(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function E8(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function C8(e,t,n,r,i,a){const o=(r-t)*(i-e),s=(n-e)*(a-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function CI(e,t,n,r,i,a){return(C8(i,a,e,t,n,r)||C8(e,t,n,r,i,a)||C8(n,r,i,a,e,t))<0}function jlt(e,t,n,r,i,a,o,s){const u=e-o,l=t-s,c=n-o,f=r-s,d=i-o,h=a-s,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function Ult(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=(l*c-s*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function Wlt(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=e+(l*c-s*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function Uy(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=e[i],o=t[a];let s=i-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{const i=n+r>>1;let a=n+1,o=r;j2(e,i,a),t[e[n]]>t[e[r]]&&j2(e,n,r),t[e[a]]>t[e[r]]&&j2(e,a,r),t[e[n]]>t[e[a]]&&j2(e,n,a);const s=e[a],u=t[s];for(;;){do a++;while(t[e[a]]<u);do o--;while(t[e[o]]>u);if(o<a)break;j2(e,a,o)}e[n+1]=e[o],e[o]=s,r-a+1>=o-n?(Uy(e,t,a,r),Uy(e,t,n,o-1)):(Uy(e,t,n,o-1),Uy(e,t,a,r))}}function j2(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Vlt(e){return e[0]}function qlt(e){return e[1]}const Rpe=1e-6;class vm{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>Rpe||Math.abs(this._y1-a)>Rpe)&&(this._+="L"+i+","+a),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class A8{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class Hlt{constructor(t,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,g=r.length,m,v;h<g;h+=3,p+=2){const y=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[y],S=t[y+1],C=t[b],_=t[b+1],E=t[x],A=t[x+1],k=C-w,T=_-S,I=E-w,N=A-S,O=k*k+T*T,D=I*I+N*N,P=(k*N-T*I)*2;if(!P)m=(w+E)/2-1e8*N,v=(S+A)/2+1e8*I;else if(Math.abs(P)<1e-8)m=(w+E)/2,v=(S+A)/2;else{const V=1/P;m=w+(N*O-T*D)*V,v=S+(k*D-I*O)*V}a[p]=m,a[p+1]=v}let o=n[n.length-1],s,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],s=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new vm:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:s}=this;if(a.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],v=o[p],y=o[p+1];this._renderSegment(g,m,v,y,t)}let u,l=a[a.length-1];for(let c=0;c<a.length;++c){u=l,l=a[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,s[p+2],s[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new vm:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new vm:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new A8;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,a){let o;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(a.moveTo(t,n),a.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,s,u))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let a=0,o=n.length;a<o;a+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[a]==i[s]&&n[a+1]==i[s+1]&&n[(a+2)%o]==i[(s+u-2)%u]&&n[(a+3)%o]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[t];if(o===-1)return null;const s=[];let u=o;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,a[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,a,o,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(a=s,o=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let p,g,m,v,y;if(l===0){if((p=this._clipSegment(a,o,s,u,l,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(s,u,a,o,c,l))===null)continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,a,o){for(;;){if(a===0&&o===0)return[t,n,r,i];if(a&o)return null;let s,u,l=a||o;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),a?(t=s,n=u,a=this._regioncode(t,n)):(r=s,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,a,o){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],a,o))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,a){for(;n!==r;){let o,s;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,s=this.ymin;break}(i[a]!==o||i[a+1]!==s)&&this.contains(t,o,s)&&(i.splice(a,0,o,s),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const s=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[s]&&i[s]===i[u]||i[o+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),o-=2)}return a}_project(t,n,r,i){let a=1/0,o,s,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(u=this.ymin,s=t+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(u=this.ymax,s=t+(a=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<a&&(s=this.xmax,u=n+(a=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<a&&(s=this.xmin,u=n+(a=o)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Glt=2*Math.PI,Wy=Math.pow;function Klt(e){return e[0]}function Xlt(e){return e[1]}function Ylt(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function Zlt(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class k8{static from(t,n=Klt,r=Xlt,i){return new k8("length"in t?Jlt(t,n,r,i):Float64Array.from(Qlt(t,n,r,i)))}constructor(t){this._delaunator=new EI(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Ylt(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=Zlt(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new EI(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=a[u%3==2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new Hlt(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=a[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,t,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(t,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Wy(n-l[t*2],2)+Wy(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=Wy(n-l[p*2],2)+Wy(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=a[(o[t]+1)%a.length],h!==p&&Wy(n-l[h*2],2)+Wy(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new vm:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,s=i.length;o<s;++o){const u=i[o];if(u<o)continue;const l=a[o]*2,c=a[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new vm:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const s=i[a],u=i[a+1];t.moveTo(s+n,u),t.arc(s,u,n,0,Glt)}return r&&r.value()}renderHull(t){const n=t==null?t=new vm:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;t.moveTo(i[a],i[a+1]);for(let s=1;s<o;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new A8;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new vm:void 0,{points:i,triangles:a}=this,o=a[t*=3]*2,s=a[t+1]*2,u=a[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new A8;return this.renderTriangle(t,n),n.value()}}function Jlt(e,t,n,r){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const s=e[o];a[o*2]=t.call(r,s,o,e),a[o*2+1]=n.call(r,s,o,e)}return a}function*Qlt(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}function T8(e){_e.call(this,null,e)}T8.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const ect=[-1e5,-1e5,1e5,1e5];Ge(T8,_e,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:ect;const a=this.value=k8.from(r,e.x,e.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const u=a.cellPolygon(o);r[o][n]=u?tct(u):null}return t.reflow(e.modified()).modifies(n)}});function tct(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var nct=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:T8}),O8=Math.PI/180,U2=1<<11>>5,AI=1<<11;function rct(){var e=[256,256],t,n,r,i,a,o,s,u=Fpe,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(dy()),g=lct((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],x=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:a(S),rotate:o(S),size:~~(r(S)+1e-14),padding:s(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,C)=>C.size-S.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,ict(p,w,x,y),w.hasText&&h(g,w,m)&&(b.push(w),m?oct(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(U2<<5)/g,p.height=AI/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,C,_,E;(C=x(S+=w))&&(_=~~C[0],E=~~C[1],!(Math.min(Math.abs(_),Math.abs(E))>=b));)if(g.x=v+_,g.y=y+E,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!act(g,p,e[0]))&&(!m||sct(g,m))){for(var A=g.sprite,k=g.width>>5,T=e[0]>>5,I=g.x-(k<<4),N=I&127,O=32-N,D=g.y1-g.y0,P=(g.y+g.y0)*T+(I>>5),V,Y=0;Y<D;Y++){V=0;for(var X=0;X<=k;X++)p[P+X]|=V<<O|(X<k?(V=A[Y*k+X])>>>N:0);P+=T}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=ym(p),f):n},f.fontStyle=function(p){return arguments.length?(i=ym(p),f):i},f.fontWeight=function(p){return arguments.length?(a=ym(p),f):a},f.rotate=function(p){return arguments.length?(o=ym(p),f):o},f.text=function(p){return arguments.length?(t=ym(p),f):t},f.spiral=function(p){return arguments.length?(u=cct[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=ym(p),f):r},f.padding=function(p){return arguments.length?(s=ym(p),f):s},f.random=function(p){return arguments.length?(c=p,f):c},f}function ict(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(U2<<5)/a,AI/a);var o=0,s=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,c=i.measureText(t.text+"m").width*a,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*O8),m=Math.cos(t.rotate*O8),v=c*m,y=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=U2<<5&&(o=0,s+=u,u=0),s+d>=AI)break;i.translate((o+(c>>1))/a,(s+(d>>1))/a),t.rotate&&i.rotate(t.rotate*O8),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(U2<<5)/a,AI/a).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;s=t.yoff;var C=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),A=w[(s+p)*(U2<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=A,C|=A}C?_=p:(t.y0++,d--,p--,s++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function act(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function oct(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function sct(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Fpe(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function uct(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function lct(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function ym(e){return typeof e=="function"?e:function(){return e}}var cct={archimedean:Fpe,rectangular:uct};const Mpe=["x","y","font","fontSize","fontStyle","fontWeight","angle"],fct=["text","font","rotate","fontSize","fontStyle","fontWeight"];function I8(e){_e.call(this,rct(),e)}I8.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Mpe}]},Ge(I8,_e,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Ie("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return nn(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||fct.some(n)))return;const i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||Mpe;let s=e.fontSize||14,u;if(nn(s)?u=e.fontSizeRange:s=Ba(s),u){const p=s,g=Wn("sqrt")().domain(xc(i,p)).range(u);s=m=>g(p(m))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(mu).layout(),c=a.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(r).modifies(o)}});var dct=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:I8});const hct=e=>new Uint8Array(e),pct=e=>new Uint16Array(e),W2=e=>new Uint32Array(e);function gct(){let e=8,t=[],n=W2(0),r=kI(0,e),i=kI(0,e);return{data:()=>t,seen:()=>n=mct(n,t.length),add(a){for(let o=0,s=t.length,u=a.length,l;o<u;++o)l=a[o],l._index=s++,t.push(l)},remove(a,o){const s=t.length,u=Array(s-a),l=t;let c,f,d;for(f=0;!o[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const s=r.length;(a>s||o>e)&&(e=Math.max(o,e),r=kI(a,e,r),i=kI(a,e))}}}function mct(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function kI(e,t,n){const r=(t<257?hct:t<65537?pct:W2)(e);return n&&r.set(n),r}function Ppe(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,a){const o=this,s=o.bisect(o.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)a[u[d]]|=r;for(d=c;d<f;++d)a[u[d]]|=r;return o}}}function $pe(){let e=W2(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=W2(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=vct(h,d),c)p=t,g=e,t=Array(c+f),e=W2(c+f),yct(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function a(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function o(s,u){let l;return u?l=u.length:(u=t,l=n),[oYe(u,s[0],0,l),Qk(u,s[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>e,size:()=>n}}function vct(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],a=e[r];return i<a?-1:i>a?1:0}),lYe(e,t)}function yct(e,t,n,r,i,a,o,s,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}function N8(e){_e.call(this,gct(),e),this._indices=null,this._dims=null}N8.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Ge(N8,_e,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;let s=0,u,l;for(;s<o;++s)u=n[s].fname,l=i[u]||(i[u]=$pe()),a.push(Ppe(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,x,w,S,C;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,S=y.length;w<S;++w)x[y[w]._index]=1;for(w=0;w<h;++w)C=r[w],(!o[w]||e.modified("fields",w)||t.modified(C.fields))&&(v=C.fname,(g=p[v])||(a[v]=m=$pe(),p[v]=g=m.insert(C,t.source,0)),o[w]=Ppe(m,w,i[w]).onAdd(g,u));for(w=0,S=s.data().length;w<S;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,a=this._dims,o=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=a.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=s[h].fname,g=u[p]||(u[p]=o[p].insert(s[h],r,d)),a[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;let s,u,l;for(s=0,u=o.length;s<u;++s)l=o[s]._index,i[l]!==a&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const a=i.remove(t,n);for(const o in r)r[o].reindex(a)})},update(e,t,n){const r=this._dims,i=e.query,a=t.stamp,o=r.length;let s=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<o;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,a=i.curr(),o=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],a[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],a[m]^=h,r.push(m);e.range=t.slice()}});function D8(e){_e.call(this,null,e)}D8.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Ge(D8,_e,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const a=t.fork(t.ALL),o=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:o[c];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?o[c]:null}),a.filter(a.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(a.filter(a.ADD,l),a.filter(a.REM,c=>(s[c]&n)===i?o[c]:null)),a.filter(a.SOURCE,c=>l(c._index))}});var bct=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:N8,resolvefilter:D8});const xct="RawCode",bm="Literal",wct="Property",_ct="Identifier",Sct="ArrayExpression",Ect="BinaryExpression",Lpe="CallExpression",Cct="ConditionalExpression",Act="LogicalExpression",kct="MemberExpression",Tct="ObjectExpression",Oct="UnaryExpression";function El(e){this.type=e}El.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Ict(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Ict(e){switch(e.type){case Sct:return e.elements;case Ect:case Act:return[e.left,e.right];case Lpe:return[e.callee].concat(e.arguments);case Cct:return[e.test,e.consequent,e.alternate];case kct:return[e.object,e.property];case Tct:return e.properties;case wct:return[e.key,e.value];case Oct:return[e.argument];case _ct:case bm:case xct:default:return[]}}var Lc,gt,ke,Ha,cr,TI=1,V2=2,xm=3,lp=4,OI=5,wm=6,rs=7,q2=8,Nct=9;Lc={},Lc[TI]="Boolean",Lc[V2]="<end>",Lc[xm]="Identifier",Lc[lp]="Keyword",Lc[OI]="Null",Lc[wm]="Numeric",Lc[rs]="Punctuator",Lc[q2]="String",Lc[Nct]="RegularExpression";var Dct="ArrayExpression",Rct="BinaryExpression",Fct="CallExpression",Mct="ConditionalExpression",Bpe="Identifier",Pct="Literal",$ct="LogicalExpression",Lct="MemberExpression",Bct="ObjectExpression",zct="Property",jct="UnaryExpression",sa="Unexpected token %0",Uct="Unexpected number",Wct="Unexpected string",Vct="Unexpected identifier",qct="Unexpected reserved word",Hct="Unexpected end of input",R8="Invalid regular expression",F8="Invalid regular expression: missing /",zpe="Octal literals are not allowed in strict mode.",Gct="Duplicate data property in object literal not allowed in strict mode",Aa="ILLEGAL",H2="Disabled.",Kct=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Xct=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function II(e,t){if(!e)throw new Error("ASSERT: "+t)}function od(e){return e>=48&&e<=57}function M8(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function G2(e){return"01234567".indexOf(e)>=0}function Yct(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function K2(e){return e===10||e===13||e===8232||e===8233}function X2(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Kct.test(String.fromCharCode(e))}function NI(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Xct.test(String.fromCharCode(e))}const Zct={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jpe(){for(;ke<Ha;){const e=gt.charCodeAt(ke);if(Yct(e)||K2(e))++ke;else break}}function P8(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)ke<Ha&&M8(gt[ke])?(r=gt[ke++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Vn({},sa,Aa);return String.fromCharCode(i)}function Jct(){var e,t,n,r;for(e=gt[ke],t=0,e==="}"&&Vn({},sa,Aa);ke<Ha&&(e=gt[ke++],!!M8(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Vn({},sa,Aa),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Upe(){var e,t;for(e=gt.charCodeAt(ke++),t=String.fromCharCode(e),e===92&&(gt.charCodeAt(ke)!==117&&Vn({},sa,Aa),++ke,e=P8("u"),(!e||e==="\\"||!X2(e.charCodeAt(0)))&&Vn({},sa,Aa),t=e);ke<Ha&&(e=gt.charCodeAt(ke),!!NI(e));)++ke,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),gt.charCodeAt(ke)!==117&&Vn({},sa,Aa),++ke,e=P8("u"),(!e||e==="\\"||!NI(e.charCodeAt(0)))&&Vn({},sa,Aa),t+=e);return t}function Qct(){var e,t;for(e=ke++;ke<Ha;){if(t=gt.charCodeAt(ke),t===92)return ke=e,Upe();if(NI(t))++ke;else break}return gt.slice(e,ke)}function eft(){var e,t,n;return e=ke,t=gt.charCodeAt(ke)===92?Upe():Qct(),t.length===1?n=xm:Zct.hasOwnProperty(t)?n=lp:t==="null"?n=OI:t==="true"||t==="false"?n=TI:n=xm,{type:n,value:t,start:e,end:ke}}function $8(){var e=ke,t=gt.charCodeAt(ke),n,r=gt[ke],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ke,{type:rs,value:String.fromCharCode(t),start:e,end:ke};default:if(n=gt.charCodeAt(ke+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ke+=2,{type:rs,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ke};case 33:case 61:return ke+=2,gt.charCodeAt(ke)===61&&++ke,{type:rs,value:gt.slice(e,ke),start:e,end:ke}}}if(o=gt.substr(ke,4),o===">>>=")return ke+=4,{type:rs,value:o,start:e,end:ke};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return ke+=3,{type:rs,value:a,start:e,end:ke};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return ke+=2,{type:rs,value:i,start:e,end:ke};if(i==="//"&&Vn({},sa,Aa),"<>=!+-*%&|^/".indexOf(r)>=0)return++ke,{type:rs,value:r,start:e,end:ke};Vn({},sa,Aa)}function tft(e){let t="";for(;ke<Ha&&M8(gt[ke]);)t+=gt[ke++];return t.length===0&&Vn({},sa,Aa),X2(gt.charCodeAt(ke))&&Vn({},sa,Aa),{type:wm,value:parseInt("0x"+t,16),start:e,end:ke}}function nft(e){let t="0"+gt[ke++];for(;ke<Ha&&G2(gt[ke]);)t+=gt[ke++];return(X2(gt.charCodeAt(ke))||od(gt.charCodeAt(ke)))&&Vn({},sa,Aa),{type:wm,value:parseInt(t,8),octal:!0,start:e,end:ke}}function Wpe(){var e,t,n;if(n=gt[ke],II(od(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=ke,e="",n!=="."){if(e=gt[ke++],n=gt[ke],e==="0"){if(n==="x"||n==="X")return++ke,tft(t);if(G2(n))return nft(t);n&&od(n.charCodeAt(0))&&Vn({},sa,Aa)}for(;od(gt.charCodeAt(ke));)e+=gt[ke++];n=gt[ke]}if(n==="."){for(e+=gt[ke++];od(gt.charCodeAt(ke));)e+=gt[ke++];n=gt[ke]}if(n==="e"||n==="E")if(e+=gt[ke++],n=gt[ke],(n==="+"||n==="-")&&(e+=gt[ke++]),od(gt.charCodeAt(ke)))for(;od(gt.charCodeAt(ke));)e+=gt[ke++];else Vn({},sa,Aa);return X2(gt.charCodeAt(ke))&&Vn({},sa,Aa),{type:wm,value:parseFloat(e),start:t,end:ke}}function rft(){var e="",t,n,r,i,a=!1;for(t=gt[ke],II(t==="'"||t==='"',"String literal must starts with a quote"),n=ke,++ke;ke<Ha;)if(r=gt[ke++],r===t){t="";break}else if(r==="\\")if(r=gt[ke++],!r||!K2(r.charCodeAt(0)))switch(r){case"u":case"x":gt[ke]==="{"?(++ke,e+=Jct()):e+=P8(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:G2(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),ke<Ha&&G2(gt[ke])&&(a=!0,i=i*8+"01234567".indexOf(gt[ke++]),"0123".indexOf(r)>=0&&ke<Ha&&G2(gt[ke])&&(i=i*8+"01234567".indexOf(gt[ke++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&gt[ke]===`
`&&++ke;else{if(K2(r.charCodeAt(0)))break;e+=r}return t!==""&&Vn({},sa,Aa),{type:q2,value:e,octal:a,start:n,end:ke}}function ift(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Vn({},R8)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Vn({},R8)}try{return new RegExp(e,t)}catch(r){return null}}function aft(){var e,t,n,r,i;for(e=gt[ke],II(e==="/","Regular expression literal must start with a slash"),t=gt[ke++],n=!1,r=!1;ke<Ha;)if(e=gt[ke++],t+=e,e==="\\")e=gt[ke++],K2(e.charCodeAt(0))&&Vn({},F8),t+=e;else if(K2(e.charCodeAt(0)))Vn({},F8);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Vn({},F8),i=t.substr(1,t.length-2),{value:i,literal:t}}function oft(){var e,t,n;for(t="",n="";ke<Ha&&(e=gt[ke],!!NI(e.charCodeAt(0)));)++ke,e==="\\"&&ke<Ha?Vn({},sa,Aa):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Vn({},R8,n),{value:n,literal:t}}function sft(){var e,t,n,r;return cr=null,jpe(),e=ke,t=aft(),n=oft(),r=ift(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:ke}}function uft(e){return e.type===xm||e.type===lp||e.type===TI||e.type===OI}function Vpe(){if(jpe(),ke>=Ha)return{type:V2,start:ke,end:ke};const e=gt.charCodeAt(ke);return X2(e)?eft():e===40||e===41||e===59?$8():e===39||e===34?rft():e===46?od(gt.charCodeAt(ke+1))?Wpe():$8():od(e)?Wpe():$8()}function is(){const e=cr;return ke=e.end,cr=Vpe(),ke=e.end,e}function qpe(){const e=ke;cr=Vpe(),ke=e}function lft(e){const t=new El(Dct);return t.elements=e,t}function Hpe(e,t,n){const r=new El(e==="||"||e==="&&"?$ct:Rct);return r.operator=e,r.left=t,r.right=n,r}function cft(e,t){const n=new El(Fct);return n.callee=e,n.arguments=t,n}function fft(e,t,n){const r=new El(Mct);return r.test=e,r.consequent=t,r.alternate=n,r}function L8(e){const t=new El(Bpe);return t.name=e,t}function Y2(e){const t=new El(Pct);return t.value=e.value,t.raw=gt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Gpe(e,t,n){const r=new El(Lct);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function dft(e){const t=new El(Bct);return t.properties=e,t}function Kpe(e,t,n){const r=new El(zct);return r.key=t,r.value=n,r.kind=e,r}function hft(e,t){const n=new El(jct);return n.operator=e,n.argument=t,n.prefix=!0,n}function Vn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(a,o)=>(II(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=ke,n.description=i,n}function DI(e){e.type===V2&&Vn(e,Hct),e.type===wm&&Vn(e,Uct),e.type===q2&&Vn(e,Wct),e.type===xm&&Vn(e,Vct),e.type===lp&&Vn(e,qct),Vn(e,sa,e.value)}function Ga(e){const t=is();(t.type!==rs||t.value!==e)&&DI(t)}function Nr(e){return cr.type===rs&&cr.value===e}function B8(e){return cr.type===lp&&cr.value===e}function pft(){const e=[];for(ke=cr.start,Ga("[");!Nr("]");)Nr(",")?(is(),e.push(null)):(e.push(_m()),Nr("]")||Ga(","));return is(),lft(e)}function Xpe(){ke=cr.start;const e=is();return e.type===q2||e.type===wm?(e.octal&&Vn(e,zpe),Y2(e)):L8(e.value)}function gft(){var e,t,n,r;if(ke=cr.start,e=cr,e.type===xm)return n=Xpe(),Ga(":"),r=_m(),Kpe("init",n,r);if(e.type===V2||e.type===rs)DI(e);else return t=Xpe(),Ga(":"),r=_m(),Kpe("init",t,r)}function mft(){var e=[],t,n,r,i={},a=String;for(ke=cr.start,Ga("{");!Nr("}");)t=gft(),t.key.type===Bpe?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Vn({},Gct):i[r]=!0,e.push(t),Nr("}")||Ga(",");return Ga("}"),dft(e)}function vft(){Ga("(");const e=z8();return Ga(")"),e}const yft={if:1};function bft(){var e,t,n;if(Nr("("))return vft();if(Nr("["))return pft();if(Nr("{"))return mft();if(e=cr.type,ke=cr.start,e===xm||yft[cr.value])n=L8(is().value);else if(e===q2||e===wm)cr.octal&&Vn(cr,zpe),n=Y2(is());else{if(e===lp)throw new Error(H2);e===TI?(t=is(),t.value=t.value==="true",n=Y2(t)):e===OI?(t=is(),t.value=null,n=Y2(t)):Nr("/")||Nr("/=")?(n=Y2(sft()),qpe()):DI(is())}return n}function xft(){const e=[];if(Ga("("),!Nr(")"))for(;ke<Ha&&(e.push(_m()),!Nr(")"));)Ga(",");return Ga(")"),e}function wft(){ke=cr.start;const e=is();return uft(e)||DI(e),L8(e.value)}function _ft(){return Ga("."),wft()}function Sft(){Ga("[");const e=z8();return Ga("]"),e}function Eft(){var e,t,n;for(e=bft();;)if(Nr("."))n=_ft(),e=Gpe(".",e,n);else if(Nr("("))t=xft(),e=cft(e,t);else if(Nr("["))n=Sft(),e=Gpe("[",e,n);else break;return e}function Ype(){const e=Eft();if(cr.type===rs&&(Nr("++")||Nr("--")))throw new Error(H2);return e}function RI(){var e,t;if(cr.type!==rs&&cr.type!==lp)t=Ype();else{if(Nr("++")||Nr("--"))throw new Error(H2);if(Nr("+")||Nr("-")||Nr("~")||Nr("!"))e=is(),t=RI(),t=hft(e.value,t);else{if(B8("delete")||B8("void")||B8("typeof"))throw new Error(H2);t=Ype()}}return t}function Zpe(e){let t=0;if(e.type!==rs&&e.type!==lp)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Cft(){var e,t,n,r,i,a,o,s,u,l;if(e=cr,u=RI(),r=cr,i=Zpe(r),i===0)return u;for(r.prec=i,is(),t=[e,cr],o=RI(),a=[u,r,o];(i=Zpe(cr))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=Hpe(s,u,o),a.push(n);r=is(),r.prec=i,a.push(r),t.push(cr),n=RI(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=Hpe(a[l-1].value,a[l-2],n),l-=2;return n}function _m(){var e,t,n;return e=Cft(),Nr("?")&&(is(),t=_m(),Ga(":"),n=_m(),e=fft(e,t,n)),e}function z8(){const e=_m();if(Nr(","))throw new Error(H2);return e}function Jpe(e){gt=e,ke=0,Ha=gt.length,cr=null,qpe();const t=z8();if(cr.type!==V2)throw new Error("Unexpect token after expression.");return t}var Qpe={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function ege(e){function t(o,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(o,s,u){return l=>t(o,l,s,u)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Ie("Missing arguments to clamp function."),o.length>3&&Ie("Too many arguments to clamp function.");const s=o.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&Ie("Missing arguments to if function."),o.length>3&&Ie("Too many arguments to if function.");const s=o.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function Aft(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function tge(e){e=e||{};const t=e.allowed?hl(e.allowed):{},n=e.forbidden?hl(e.forbidden):{},r=e.constants||Qpe,i=(e.functions||ege)(f),a=e.globalvar,o=e.fieldvar,s=nn(a)?a:p=>"".concat(a,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(lr(p))return p;const g=d[p.type];return g==null&&Ie("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:Rt(n,g)?Ie("Illegal identifier: "+g):Rt(r,g)?r[g]:Rt(t,g)?g:(u[g]=1,s(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===o&&(l[Aft(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Ie("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=Rt(i,g)&&i[g];return v||Ie("Unrecognized function: "+g),nn(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function kft(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Tft(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=Oft(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function Oft(e){return(t,n)=>kft(e(t),n)}const j8="intersect",nge="union",Ift="vlMulti",Nft="vlPoint",rge="or",Dft="and",Rft="_vgsid_",Fft="E",Mft="R",Pft="R-E",$ft="R-LE",Lft="R-RE",FI="index:unit";function ige(e,t){for(var n=t.fields,r=t.values,i=n.length,a=0,o,s;a<i;++a)if(s=n[a],s.getter=Xo.getter||Xo(s.field),o=s.getter(e),Ah(o)&&(o=La(o)),Ah(r[a])&&(r[a]=La(r[a])),Ah(r[a][0])&&(r[a]=r[a].map(La)),s.type===Fft){if(bt(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(s.type===Mft){if(!Q0(o,r[a]))return!1}else if(s.type===Lft){if(!Q0(o,r[a],!0,!1))return!1}else if(s.type===Pft){if(!Q0(o,r[a],!1,!1))return!1}else if(s.type===$ft&&!Q0(o,r[a],!1,!0))return!1;return!0}function Bft(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],a=r?r[FI]&&r[FI].value:void 0,o=n===j8,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],a&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=ige(t,l),c[d]=h?-1:++f,h&&a.size===1)return!0;if(!h&&f===a.get(d).count)return!1}else if(h=ige(t,l),o^h)return h;return s&&o}const U8=Xo(Rft),age=Tft(U8),zft=age.left,jft=age.right;function Uft(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],a=r?r[FI]&&r[FI].value:void 0,o=n===j8,s=U8(t),u=zft(i,s);if(u===i.length||U8(i[u])!==s)return!1;if(a&&o){if(a.size===1)return!0;if(jft(i,s)-u<a.size)return!1}return!0}function Wft(e,t){return e.map(n=>Zt({values:t.fields.map(r=>(r.getter||(r.getter=Xo(r.field)))(n.datum))},t))}function Vft(e,t,n,r){for(var i=this.context.data[e],a=i?i.values.value:[],o={},s={},u={},l,c,f,d,h,p,g,m,v,y=a.length,b=0,x,w;b<y;++b){for(l=a[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],p=o[h.field]||(o[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),v=oge[m+"_union"],p[d]=v(g,Dt(f[x]));n&&(g=s[d]||(s[d]=[]),g.push(Dt(f).reduce((S,C,_)=>(S[c[_].field]=C,S),{})))}if(t=t||nge,Object.keys(o).forEach(S=>{o[S]=Object.keys(o[S]).map(C=>o[S][C]).reduce((C,_)=>C===void 0?_:oge[u[S]+"_"+t](C,_))}),a=Object.keys(s),n&&a.length){const S=r?Nft:Ift;o[S]=t===nge?{[rge]:a.reduce((C,_)=>(C.push(...s[_]),C),[])}:{[Dft]:a.map(C=>({[rge]:s[C]}))}}return o}var oge={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=La(t[0]),r=La(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=La(t[0]),r=La(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const qft=":",Hft="@";function W8(e,t,n,r){t[0].type!==bm&&Ie("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&An(t).value,o="unit",s=Hft+o,u=qft+i;a===j8&&!Rt(r,s)&&(r[s]=n.getData(i).indataRef(n,o)),Rt(r,u)||(r[u]=n.getData(i).tuplesRef())}function sge(e){const t=this.context.data[e];return t?t.values.value:[]}function Gft(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Kft(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(hu).insert(t)),1}function Xft(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Z2=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Yft=Z2("format"),uge=Z2("timeFormat"),Zft=Z2("utcFormat"),Jft=Z2("timeParse"),Qft=Z2("utcParse"),MI=new Date(2e3,0,1);function PI(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(MI.setYear(2e3),MI.setMonth(e),MI.setDate(t),uge.call(this,MI,n))}function edt(e){return PI.call(this,e,1,"%B")}function tdt(e){return PI.call(this,e,1,"%b")}function ndt(e){return PI.call(this,0,2+e,"%A")}function rdt(e){return PI.call(this,0,2+e,"%a")}const idt=":",adt="@",V8="%",lge="$";function q8(e,t,n,r){t[0].type!==bm&&Ie("First argument to data functions must be a string literal.");const i=t[0].value,a=idt+i;if(!Rt(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function odt(e,t,n,r){t[0].type!==bm&&Ie("First argument to indata must be a string literal."),t[1].type!==bm&&Ie("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=adt+a;Rt(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function as(e,t,n,r){if(t[0].type===bm)cge(n,r,t[0].value);else for(e in n.scales)cge(n,r,e)}function cge(e,t,n){const r=V8+n;if(!Rt(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function sd(e,t){let n;return nn(e)?e:lr(e)?(n=t.scales[e])&&n.value:void 0}function sdt(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=as,n._range=as,n._scale=as;const r=i=>"_["+(i.type===bm?At(V8+i.value):At(V8)+"+"+e(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(e(i[1]),")")}}function H8(e,t){return function(n,r,i){if(n){const a=sd(n,(i||this).context);return a&&a.path[e](r)}else return t(r)}}const udt=H8("area",Fat),ldt=H8("bounds",Lat),cdt=H8("centroid",Vat);function fdt(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function G8(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function ddt(){return G8(this.context.dataflow,"warn",arguments)}function hdt(){return G8(this.context.dataflow,"info",arguments)}function pdt(){return G8(this.context.dataflow,"debug",arguments)}function K8(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function X8(e){const t=Uh(e),n=K8(t.r),r=K8(t.g),i=K8(t.b);return .2126*n+.7152*r+.0722*i}function gdt(e,t){const n=X8(e),r=X8(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function mdt(){const e=[].slice.call(arguments);return e.unshift({}),Zt(...e)}function fge(e,t){return e===t||e!==e&&t!==t?!0:bt(e)?bt(t)&&e.length===t.length?vdt(e,t):!1:Xt(e)&&Xt(t)?dge(e,t):!1}function vdt(e,t){for(let n=0,r=e.length;n<r;++n)if(!fge(e[n],t[n]))return!1;return!0}function dge(e,t){for(const n in e)if(!fge(e[n],t[n]))return!1;return!0}function hge(e){return t=>dge(e,t)}function ydt(e,t,n,r,i,a){const o=this.context.dataflow,s=this.context.data[e],u=s.input,l=o.stamp();let c=s.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{s.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?hu:bt(n)||lT(n)?n:hge(n),c.remove(f)),t&&c.insert(t),r&&(f=hge(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in a)c.modify(i,d,a[d]);return 1}function bdt(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function xdt(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const pge={};function wdt(e,t){const n=pge[t]||(pge[t]=Xo(t));return bt(e)?e.map(n):n(e)}function Y8(e){return bt(e)||ArrayBuffer.isView(e)?e:null}function Z8(e){return Y8(e)||(lr(e)?e:null)}function _dt(e,...t){return Y8(e).join(...t)}function Sdt(e,...t){return Z8(e).indexOf(...t)}function Edt(e,...t){return Z8(e).lastIndexOf(...t)}function Cdt(e,...t){return Z8(e).slice(...t)}function Adt(e,t,n){return nn(n)&&Ie("Function argument passed to replace."),String(e).replace(t,n)}function kdt(e){return Y8(e).slice().reverse()}function Tdt(e,t,n){return O5(e||0,t||0,n||0)}function Odt(e,t){const n=sd(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Idt(e,t){const n=sd(e,(t||this).context);return n?n.copy():void 0}function Ndt(e,t){const n=sd(e,(t||this).context);return n?n.domain():[]}function Ddt(e,t,n){const r=sd(e,(n||this).context);return r?bt(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Rdt(e,t){const n=sd(e,(t||this).context);return n&&n.range?n.range():[]}function Fdt(e,t,n){const r=sd(e,(n||this).context);return r?r(t):void 0}function Mdt(e,t,n,r,i){e=sd(e,(i||this).context);const a=_ce(t,n);let o=e.domain(),s=o[0],u=An(o),l=yo;return u-s?l=sce(e,s,u):e=(e.interpolator?Wn("sequential")().interpolator(e.interpolator()):Wn("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(o=e.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==An(o)&&o.push(u)),o.forEach(c=>a.stop(l(c),e(c))),a}function Pdt(e,t,n){const r=sd(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function $dt(e){let t=null;return function(n){return n?e2(n,t=t||_y(e)):e}}const gge=e=>e.data;function mge(e,t){const n=sge.call(t,e);return n.root&&n.root.lookup||{}}function Ldt(e,t,n){const r=mge(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(gge):void 0}function Bdt(e,t){const n=mge(e,this)[t];return n?n.ancestors().map(gge):void 0}const vge=()=>typeof window!="undefined"&&window||null;function zdt(){const e=vge();return e?e.screen:{}}function jdt(){const e=vge();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Udt(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Wdt(e,t,n){if(!e)return[];const[r,i]=e,a=new Wi().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Pfe(o,a,Vdt(t))}function Vdt(e){let t=null;if(e){const n=Dt(e.marktype),r=Dt(e.markname);t=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return t}const J2={random(){return mu()},cumulativeNormal:vT,cumulativeLogNormal:sz,cumulativeUniform:fz,densityNormal:nz,densityLogNormal:oz,densityUniform:cz,quantileNormal:yT,quantileLogNormal:uz,quantileUniform:dz,sampleNormal:mT,sampleLogNormal:az,sampleUniform:lz,isArray:bt,isBoolean:tB,isDate:Ah,isDefined(e){return e!==void 0},isNumber:kh,isObject:Xt,isRegExp:Nae,isString:lr,isTuple:lT,isValid(e){return e!=null&&e===e},toBoolean:rB,toDate:iB,toNumber:La,toString:aB,indexof:Sdt,join:_dt,lastindexof:Edt,replace:Adt,reverse:kdt,slice:Cdt,flush:Oae,lerp:Dae,merge:mdt,pad:Mae,peek:An,pluck:wdt,span:dw,inrange:Q0,truncate:Pae,rgb:Uh,lab:RT,hcl:FT,hsl:NT,luminance:X8,contrast:gdt,sequence:Ps,format:Yft,utcFormat:Zft,utcParse:Qft,utcOffset:Toe,utcSequence:Noe,timeFormat:uge,timeParse:Jft,timeOffset:koe,timeSequence:Ioe,timeUnitSpecifier:moe,monthFormat:edt,monthAbbrevFormat:tdt,dayFormat:ndt,dayAbbrevFormat:rdt,quarter:Cae,utcquarter:Aae,week:yoe,utcweek:woe,dayofyear:voe,utcdayofyear:xoe,warn:ddt,info:hdt,debug:pdt,extent:xc,inScope:fdt,intersect:Wdt,clampRange:kae,pinchDistance:bdt,pinchAngle:xdt,screen:zdt,containerSize:Udt,windowSize:jdt,bandspace:Tdt,setdata:Kft,pathShape:$dt,panLinear:wae,panLog:_ae,panPow:Sae,panSymlog:Eae,zoomLinear:Y4,zoomLog:Z4,zoomPow:Kk,zoomSymlog:J4,encode:Xft,modify:ydt},qdt=["view","item","group","xy","x","y"],Hdt="event.vega.",yge="this.",J8={},bge={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(At(lge+e),"]"),functions:Gdt,constants:Qpe,visitors:J8},Q8=tge(bge);function Gdt(e){const t=ege(e);qdt.forEach(n=>t[n]=Hdt+n);for(const n in J2)t[n]=yge+n;return Zt(t,sdt(e,J2,J8)),t}function Ii(e,t,n){return arguments.length===1?J2[e]:(J2[e]=t,n&&(J8[e]=n),Q8&&(Q8.functions[e]=yge+e),this)}Ii("bandwidth",Odt,as),Ii("copy",Idt,as),Ii("domain",Ndt,as),Ii("range",Rdt,as),Ii("invert",Ddt,as),Ii("scale",Fdt,as),Ii("gradient",Mdt,as),Ii("geoArea",udt,as),Ii("geoBounds",ldt,as),Ii("geoCentroid",cdt,as),Ii("geoShape",Pdt,as),Ii("indata",Gft,odt),Ii("data",sge,q8),Ii("treePath",Ldt,q8),Ii("treeAncestors",Bdt,q8),Ii("vlSelectionTest",Bft,W8),Ii("vlSelectionIdTest",Uft,W8),Ii("vlSelectionResolve",Vft,W8),Ii("vlSelectionTuples",Wft);function Bc(e,t){const n={};let r;try{e=lr(e)?e:At(e)+"",r=Jpe(e)}catch(a){Ie("Expression parse error: "+e)}r.visit(a=>{if(a.type!==Lpe)return;const o=a.callee.name,s=bge.visitors[o];s&&s(o,a.arguments,t,n)});const i=Q8(r);return i.globals.forEach(a=>{const o=lge+a;!Rt(n,o)&&t.getSignal(a)&&(n[o]=t.signalRef(a))}),{$expr:Zt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function Kdt(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const Xdt=hl(["rule"]),xge=hl(["group","image","rect"]);function Ydt(e,t){let n="";return Xdt[t]||(e.x2&&(e.x?(xge[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(xge[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function e9(e){return(e+"").toLowerCase()}function Zdt(e){return e9(e)==="operator"}function Jdt(e){return e9(e)==="collect"}function Q2(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Qdt(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var eht={operator:(e,t)=>Q2(e,["_"],t.code),parameter:(e,t)=>Q2(e,["datum","_"],t.code),event:(e,t)=>Q2(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Q2(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+At(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=Ydt(r,n),i+="return m;",Q2(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(At).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(a,o)=>{const s=t[o];let u,l;return a.path?(u="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),Qdt(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function tht(e){const t=this;Zdt(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function nht(e){const t=this;if(e.params){const n=t.get(e.id);n||Ie("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function rht(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=bt(i)?i.map(a=>wge(a,n,t)):wge(i,n,t)}return t}function wge(e,t,n){if(!e||!Xt(e))return e;for(let r=0,i=_ge.length,a;r<i;++r)if(a=_ge[r],Rt(e,a.key))return a.parse(e,t,n);return e}var _ge=[{key:"$ref",parse:iht},{key:"$key",parse:oht},{key:"$expr",parse:aht},{key:"$field",parse:sht},{key:"$encode",parse:lht},{key:"$compare",parse:uht},{key:"$context",parse:cht},{key:"$subflow",parse:fht},{key:"$tupleid",parse:dht}];function iht(e,t){return t.get(e.$ref)||Ie("Operator not defined: "+e.$ref)}function aht(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=Ko(t.parameterExpression(e.$expr),e.$fields,e.$name))}function oht(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=nB(e.$key,e.$flat,t.expr.codegen))}function sht(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Xo(e.$field,e.$name,t.expr.codegen))}function uht(e,t){const n="c:"+e.$compare+"_"+e.$order,r=Dt(e.$compare).map(i=>i&&i.$tupleid?xt:i);return t.fn[n]||(t.fn[n]=Q4(r,e.$order,t.expr.codegen))}function lht(e,t){const n=e.$encode,r={};for(const i in n){const a=n[i];r[i]=Ko(t.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function cht(e,t){return t}function fht(e,t){const n=e.$subflow;return function(r,i,a){const o=t.fork().parse(n),s=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(a),s.detachSubflow=()=>t.detach(o),s}}function dht(){return xt}function hht(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(a=>t.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(a=>t.get(a)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Ie("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function pht(e){var t=this,n=Xt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=void 0;r||Ie("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(o=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,r,i,a,o)}const ght={skip:!0};function mht(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(a=>{const o=t.signals[a];e.signals(a,o)&&(r[a]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(a=>{const o=t.data[a];e.data(a,o)&&(i[a]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function vht(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(a=>{n.update(t.signals[a],i[a],ght)}),Object.keys(r||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(hu).insert(r[a]))}),(e.subcontext||[]).forEach((a,o)=>{const s=t.subcontext[o];s&&s.setState(a)})}function Sge(e,t,n,r){return new Ege(e,t,n,r)}function Ege(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||eht,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Cge(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Ege.prototype=Cge.prototype={fork(){const e=new Cge(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),Jdt(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(r.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),r.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const o=n.data[a]||(n.data[a]={});e.data[a].forEach(s=>o[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[e9(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Kdt,parseOperator:tht,parseOperatorParameters:nht,parseParameters:rht,parseStream:hht,parseUpdate:pht,getState:mht,setState:vht};function yht(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Age(t,e.description()))}function Age(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function bht(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const t9="default";function xht(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:t9,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,a=i?lr(i)?i:i.user:t9,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return lr(r)||(i=r.item,r=r.user),n9(e,r&&r!==t9?r:i||r),i},{cursor:t})}function n9(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function $I(e,t){var n=e._runtime.data;return Rt(n,t)||Ie("Unrecognized data set: "+t),n[t]}function wht(e,t){return arguments.length<2?$I(this,e).values.value:LI.call(this,e,Zg().remove(hu).insert(t))}function LI(e,t){dse(t)||Ie("Second argument to changes must be a changeset.");const n=$I(this,e);return n.modified=!0,this.pulse(n.input,t)}function _ht(e,t){return LI.call(this,e,Zg().insert(t))}function Sht(e,t){return LI.call(this,e,Zg().remove(t))}function kge(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Tge(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function BI(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Eht(e){var t=BI(e),n=kge(e),r=Tge(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){e.error(a)}})}function Cht(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,s;return i&&(s=BI(e),o=t.changedTouches?t.changedTouches[0]:t,a=gO(o,i),a[0]-=s[0],a[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Aht(e,n,a),t}function Aht(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var s=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function a(o){if(!o)return n;lr(o)&&(o=i(o));const s=n.slice();for(;o;)s[0]-=o.x||0,s[1]-=o.y||0,o=o.mark&&o.mark.group;return s}return{view:Ba(e),item:Ba(t||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const Oge="view",kht="timer",Tht="window",Oht={trap:!1};function Iht(e){const t=Zt({defaults:{}},e),n=(r,i)=>{i.forEach(a=>{bt(r[a])&&(r[a]=hl(r[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function Ige(e,t,n,r){e._eventListeners.push({type:n,sources:Dt(t),handler:r})}function Nht(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function zI(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Xt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Dht(e,t,n){var r=this,i=new hT(n),a=function(l,c){r.runAsync(null,()=>{e===Oge&&Nht(r,t)&&l.preventDefault(),i.receive(Cht(r,l,c))})},o;if(e===kht)zI(r,"timer",t)&&r.timer(a,t);else if(e===Oge)zI(r,"view",t)&&r.addEventListener(t,a,Oht);else if(e===Tht?zI(r,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&zI(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=o.length;s<u;++s)o[s].addEventListener(t,a);Ige(r,o,t,a)}return i}function Nge(e){return e.item}function Dge(e){return e.item.mark.source}function Rge(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Rht(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Nge),Dge,Rge(e)),this.on(this.events("view","mouseout",Nge),Dge,Rge(t)),this}function Fht(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return e&&e.call(this,this._handler,null,null,null),this}function Us(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Mht="vega-bind",Pht="vega-bind-name",$ht="vega-bind-radio";function Lht(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=eB(r.debounce,i.update))),(r.input==null&&r.element?Bht:jht)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Bht(e,t,n,r){const i=n.event||"input",a=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,a),Ige(r,t,i,a),e.set=o=>{t.value=o,t.dispatchEvent(zht(i))}}function zht(e){return typeof Event!="undefined"?new Event(e):{type:e}}function jht(e,t,n,r){const i=r.signal(n.signal),a=Us("div",{class:Mht}),o=n.input==="radio"?a:a.appendChild(Us("label"));o.appendChild(Us("span",{class:Pht},n.name||n.signal)),t.appendChild(a);let s=Uht;switch(n.input){case"checkbox":s=Wht;break;case"select":s=Vht;break;case"radio":s=qht;break;case"range":s=Hht;break}s(e,o,n,i)}function Uht(e,t,n,r){const i=Us("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=a=>i.value=a}function Wht(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Us("input",i);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=o=>a.checked=!!o||null}function Vht(e,t,n,r){const i=Us("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,s)=>{const u={value:o};jI(o,r)&&(u.selected=!0),i.appendChild(Us("option",u,(a[s]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let s=0,u=n.options.length;s<u;++s)if(jI(n.options[s],o)){i.selectedIndex=s;return}}}function qht(e,t,n,r){const i=Us("span",{class:$ht}),a=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,s)=>{const u={type:"radio",name:n.signal,value:o};jI(o,r)&&(u.checked=!0);const l=Us("input",u);l.addEventListener("change",()=>e.update(o));const c=Us("label",{},(a[s]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)jI(s[l].value,o)&&(s[l].checked=!0)}}function Hht(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||Oh(a,i,100),s=Us("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=Us("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function jI(e,t){return e===t||e+""==t+""}function Fge(e,t,n,r,i,a){return t=t||new r(e.loader()),t.initialize(n,kge(e),Tge(e),BI(e),i,a).background(e.background())}function r9(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Ght(e,t,n,r){const i=new r(e.loader(),r9(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,BI(e),e);return t&&t.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function Kht(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,a=EO(r);e=n._el=e?i9(n,e,!0):null,yht(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||p2,s=e?a.renderer:a.headless;return n._renderer=s?Fge(n,n._renderer,e,s):null,n._handler=Ght(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=i9(n,t,!0):e.appendChild(Us("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=i9(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Lht(n,u.element||t,u)})),n}function i9(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const e_=e=>+e||0,Xht=e=>({top:e,bottom:e,left:e,right:e});function Mge(e){return Xt(e)?{top:e_(e.top),bottom:e_(e.bottom),left:e_(e.left),right:e_(e.right)}:Xht(e_(e))}async function a9(e,t,n,r){const i=EO(t),a=i&&i.headless;return a||Ie("Unrecognized renderer type: "+t),await e.runAsync(),Fge(e,null,null,a,n,r).renderAsync(e._scenegraph.root)}async function Yht(e,t){e!==ep.Canvas&&e!==ep.SVG&&e!==ep.PNG&&Ie("Unrecognized image type: "+e);const n=await a9(this,e,t);return e===ep.SVG?Zht(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Zht(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Jht(e,t){return(await a9(this,ep.Canvas,e,t)).canvas()}async function Qht(e){return(await a9(this,ep.SVG,e)).svg()}function ept(e,t,n){return Sge(e,uy,J2,n).parse(t)}function tpt(e){var t=this._runtime.scales;return Rt(t,e)||Ie("Unrecognized scale or projection: "+e),t[e].value}var Pge="width",$ge="height",o9="padding",Lge={skip:!0};function Bge(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===o9?r.left+r.right:0)}function zge(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===o9?r.top+r.bottom:0)}function npt(e){var t=e._signals,n=t[Pge],r=t[$ge],i=t[o9];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=Bge(e,s.size),a()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=zge(e,s.size),a()},{size:r});const o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function rpt(e,t,n,r,i,a){this.runAfter(o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Pge,n,Lge),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal($ge,r,Lge),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(u=>u.resize())},!1,1)}function ipt(e){return this._runtime.getState(e||{data:apt,signals:opt,recurse:!0})}function apt(e,t){return t.modified&&bt(t.input.value)&&e.indexOf("_:vega:_")}function opt(e,t){return!(e==="parent"||t instanceof uy.proxy)}function spt(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function upt(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(qst(n,t))}function lpt(e,t,n,r){const i=e.element();i&&i.setAttribute("title",cpt(r))}function cpt(e){return e==null?"":bt(e)?jge(e):Xt(e)&&!Ah(e)?fpt(e):e+""}function fpt(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(bt(n)?jge(n):Uge(n))}).join(`
`)}function jge(e){return"["+e.map(Uge).join(", ")+"]"}function Uge(e){return bt(e)?"[\u2026]":Xt(e)&&!Ah(e)?"{\u2026}":e}function Wge(e,t){const n=this;if(t=t||{},sy.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Zt({},e.locale,t.locale);n.locale(sse(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||ep.Canvas,n._scenegraph=new b6;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||lpt,n._redraw=!0,n._handler=new p2().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Iht(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=ept(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Zt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Bge(n,n._width),n._viewHeight=zge(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,npt(n),bht(n),xht(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function UI(e,t){return Rt(e._signals,t)?e._signals[t]:Ie("Unrecognized signal name: "+At(t))}function Vge(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function qge(e,t,n,r){let i=Vge(n,r);return i||(i=r9(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function Hge(e,t,n){const r=Vge(t,n);return r&&t._targets.remove(r),e}Ge(Wge,sy,{async evaluate(e,t,n){if(await sy.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Eht(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&uT(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Age(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=UI(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Mge(e)):Mge(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(EO(e)||Ie("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(sy.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(UI(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:rpt,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=r9(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return qge(this,e,UI(this,e),t)},removeSignalListener(e,t){return Hge(this,UI(this,e),t)},addDataListener(e,t){return qge(this,e,$I(this,e).values,t)},removeDataListener(e,t){return Hge(this,$I(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=n9(this,null);this._globalCursor=!!e,t&&n9(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:upt,events:Dht,finalize:Fht,hover:Rht,data:wht,change:LI,insert:_ht,remove:Sht,scale:tpt,initialize:Kht,toImageURL:Yht,toCanvas:Jht,toSVG:Qht,getState:ipt,setState:spt});const dpt="view",WI="[",VI="]",Gge="{",Kge="}",hpt=":",Xge=",",ppt="@",gpt=">",mpt=/[[\]{}]/,vpt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Yge,Zge;function cp(e,t,n){return Yge=t||dpt,Zge=n||vpt,Jge(e.trim()).map(s9)}function ypt(e){return Zge[e]}function t_(e,t,n,r,i){const a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;i&&i.indexOf(s)>=0?--o:r&&r.indexOf(s)>=0&&++o}return t}function Jge(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=t_(e,i,Xge,WI+Gge,VI+Kge),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function s9(e){return e[0]==="["?bpt(e):xpt(e)}function bpt(e){const t=e.length;let n=1,r;if(n=t_(e,n,VI,WI,VI),n===t)throw"Empty between selector: "+e;if(r=Jge(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==gpt)throw"Expected '>' after between selector: "+e;r=r.map(s9);const i=s9(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function xpt(e){const t={source:Yge},n=[];let r=[0,0],i=0,a=0,o=e.length,s=0,u,l;if(e[o-1]===Kge){if(s=e.lastIndexOf(Gge),s>=0){try{r=wpt(e.substring(s+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),o=e.length}else throw"Unmatched right brace: "+e;s=0}if(!o)throw e;if(e[0]===ppt&&(i=++s),u=t_(e,s,hpt),u<o&&(n.push(e.substring(a,u).trim()),a=s=++u),s=t_(e,s,WI),s===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),l=[],a=++s,a===o)throw"Unmatched left bracket: "+e;for(;s<o;){if(s=t_(e,s,VI),s===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==WI)throw"Expected left bracket: "+e;a=++s}if(!(o=n.length)||mpt.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):ypt(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function wpt(e){const t=e.split(Xge);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function _pt(e){return Xt(e)?e:{type:e||"pad"}}const n_=e=>+e||0,Spt=e=>({top:e,bottom:e,left:e,right:e});function Ept(e){return Xt(e)?e.signal?e:{top:n_(e.top),bottom:n_(e.bottom),left:n_(e.left),right:n_(e.right)}:Spt(n_(e))}const ua=e=>Xt(e)&&!bt(e)?Zt({},e):{value:e};function Qge(e,t,n,r){return n!=null?(Xt(n)&&!bt(n)||bt(n)&&n.length&&Xt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function ka(e,t,n){for(const r in t)Qge(e,r,t[r]);for(const r in n)Qge(e,r,n[r],"update")}function Vy(e,t,n){for(const r in t)n&&Rt(n,r)||(e[r]=Zt(e[r]||{},t[r]));return e}function qy(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const u9="mark",l9="frame",c9="scope",Cpt="axis",Apt="axis-domain",kpt="axis-grid",Tpt="axis-label",Opt="axis-tick",Ipt="axis-title",Npt="legend",Dpt="legend-band",Rpt="legend-entry",Fpt="legend-gradient",eme="legend-label",Mpt="legend-symbol",Ppt="legend-title",$pt="title",Lpt="title-text",Bpt="title-subtitle";function zpt(e,t,n,r,i){const a={},o={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!qy(u,e)&&f9(a,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===l9?i.group:n===u9?Zt({},i.mark,i[t]):null;for(u in c)l=qy(u,e)||(u==="fill"||u==="stroke")&&(qy("fill",e)||qy("stroke",e)),l||f9(a,u,c[u]);Dt(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)qy(h,e)||f9(a,h,d[h])}),e=Zt({},e);for(u in a)c=a[u],c.signal?(s=s||{})[u]=c:o[u]=c;return e.enter=Zt(o,e.enter),s&&(e.update=Zt(s,e.update)),e}function f9(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const tme=e=>lr(e)?At(e):e.signal?"(".concat(e.signal,")"):nme(e);function qI(e){if(e.gradient!=null)return Upt(e);let t=e.signal?"(".concat(e.signal,")"):e.color?jpt(e.color):e.field!=null?nme(e.field):e.value!==void 0?At(e.value):void 0;return e.scale!=null&&(t=Wpt(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat(GI(e.exponent),")")),e.mult!=null&&(t+="*".concat(GI(e.mult))),e.offset!=null&&(t+="+".concat(GI(e.offset))),e.round&&(t="round(".concat(t,")")),t}const HI=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(qI).join(","),")+'')");function jpt(e){return e.c?HI("hcl",e.h,e.c,e.l):e.h||e.s?HI("hsl",e.h,e.s,e.l):e.l||e.a?HI("lab",e.l,e.a,e.b):e.r||e.g||e.b?HI("rgb",e.r,e.g,e.b):null}function Upt(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:At(n));for(;t.length&&An(t)==null;)t.pop();return t.unshift(tme(e.gradient)),"gradient(".concat(t.join(","),")")}function GI(e){return Xt(e)?"("+qI(e)+")":e}function nme(e){return rme(Xt(e)?e:{datum:e})}function rme(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Ie("Invalid field reference: "+At(e));return e.signal||(r=lr(r)?jk(r).map(At).join("]["):rme(r)),t+"["+r+"]"}function Wpt(e,t){const n=tme(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+GI(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function Vpt(e){let t="";return e.forEach(n=>{const r=qI(n);t+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),An(t)===":"&&(t+="null"),t}function ime(e,t,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},e=zpt(e,t,n,r,i.config);for(const s in e)o[s]=qpt(e[s],t,a,i);return a}function qpt(e,t,n,r){const i={},a={};for(const o in e)e[o]!=null&&(i[o]=Gpt(Hpt(e[o]),r,n,a));return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function Hpt(e){return bt(e)?Vpt(e):qI(e)}function Gpt(e,t,n,r){const i=Bc(e,t);return i.$fields.forEach(a=>r[a]=1),Zt(n,i.$params),i.$expr}const Kpt="outer",Xpt=["value","update","init","react","bind"];function ame(e,t){Ie(e+' for "outer" push: '+At(t))}function ome(e,t){const n=e.name;if(e.push===Kpt)t.signals[n]||ame("No prior signal definition",n),Xpt.forEach(r=>{e[r]!==void 0&&ame("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function d9(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function KI(e,t,n,r){return new d9(e,t,n,r)}function XI(e,t){return KI("operator",e,t)}function _t(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function r_(e,t){return t?{$field:e,$name:t}:{$field:e}}const h9=r_("key");function sme(e,t){return{$compare:e,$order:t}}function Ypt(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Zpt="ascending",Jpt="descending";function Qpt(e){return Xt(e)?(e.order===Jpt?"-":"+")+YI(e.op,e.field):""}function YI(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const p9="scope",g9="view";function qi(e){return e&&e.signal}function egt(e){return e&&e.expr}function ZI(e){if(qi(e))return!0;if(Xt(e)){for(const t in e)if(ZI(e[t]))return!0}return!1}function Cl(e,t){return e??t}function Sm(e){return e&&e.signal||e}const ume="timer";function i_(e,t){return(e.merge?ngt:e.stream?rgt:e.type?igt:Ie("Invalid stream specification: "+At(e)))(e,t)}function tgt(e){return e===p9?g9:e||g9}function ngt(e,t){const n=e.merge.map(i=>i_(i,t)),r=m9({merge:n},e,t);return t.addStream(r).id}function rgt(e,t){const n=i_(e.stream,t),r=m9({stream:n},e,t);return t.addStream(r).id}function igt(e,t){let n;e.type===ume?(n=t.event(ume,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(tgt(e.source),e.type);const r=m9({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function m9(e,t,n){let r=t.between;return r&&(r.length!==2&&Ie('Stream "between" parameter must have 2 entries: '+At(t)),e.between=[i_(r[0],n),i_(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(agt(t.marktype,t.markname,t.markrole)),t.source===p9&&r.push("inScope(event.item)"),r.length&&(e.filter=Bc("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function agt(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const ogt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function sgt(e,t,n){const r=e.encode,i={target:n};let a=e.events,o=e.update,s=[];a||Ie("Signal update missing events specification."),lr(a)&&(a=cp(a,t.isSubscope()?p9:g9)),a=Dt(a).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[lgt(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&Ie("Signal encode and update are mutually exclusive."),o="encode(item(),"+At(r)+")"),i.update=lr(o)?Bc(o,t):o.expr!=null?Bc(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:ogt,$params:{$value:t.signalRef(o.signal)}}:Ie("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(Zt(ugt(u,t),i)))}function ugt(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):i_(e,t)}}function lgt(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function cgt(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Ie("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Bc(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>sgt(i,t,n.id))}const hr=e=>(t,n,r)=>KI(e,n,t||void 0,r),lme=hr("aggregate"),fgt=hr("axisticks"),cme=hr("bound"),Al=hr("collect"),fme=hr("compare"),dgt=hr("datajoin"),dme=hr("encode"),hgt=hr("expression"),pgt=hr("facet"),ggt=hr("field"),mgt=hr("key"),vgt=hr("legendentries"),ygt=hr("load"),bgt=hr("mark"),xgt=hr("multiextent"),wgt=hr("multivalues"),_gt=hr("overlap"),Sgt=hr("params"),hme=hr("prefacet"),Egt=hr("projection"),Cgt=hr("proxy"),Agt=hr("relay"),pme=hr("render"),kgt=hr("scale"),Em=hr("sieve"),Tgt=hr("sortitems"),gme=hr("viewlayout"),Ogt=hr("values");let Igt=0;const mme={min:"min",max:"max",count:"sum"};function Ngt(e,t){const n=e.type||"linear";tce(n)||Ie("Unrecognized scale type: "+At(n)),t.addScale(e.name,{type:n,domain:void 0})}function Dgt(e,t){const n=t.getScale(e.name).params;let r;n.domain=vme(e.domain,e,t),e.range!=null&&(n.range=bme(e,t,n)),e.interpolate!=null&&Ugt(e.interpolate,n),e.nice!=null&&(n.nice=jgt(e.nice)),e.bins!=null&&(n.bins=zgt(e.bins,t));for(r in e)Rt(n,r)||r==="name"||(n[r]=wu(e[r],t))}function wu(e,t){return Xt(e)?e.signal?t.signalRef(e.signal):Ie("Unsupported object: "+At(e)):e}function JI(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>wu(n,t))}function QI(e){Ie("Can not find data set: "+At(e))}function vme(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Ie("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(bt(e)?Rgt:e.fields?Mgt:Fgt)(e,t,n)}function Rgt(e,t,n){return e.map(r=>wu(r,n))}function Fgt(e,t,n){const r=n.getData(e.data);return r||QI(e.data),wy(t.type)?r.valuesRef(n,e.field,yme(e.sort,!1)):ice(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Mgt(e,t,n){const r=e.data,i=e.fields.reduce((a,o)=>(o=lr(o)?{data:r,field:o}:bt(o)||o.signal?Pgt(o,n):o,a.push(o),a),[]);return(wy(t.type)?$gt:ice(t.type)?Lgt:Bgt)(e,n,i)}function Pgt(e,t){const n="_:vega:_"+Igt++,r=Al({});if(bt(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+At(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Em({})]),{data:n,field:"data"}}function $gt(e,t,n){const r=yme(e.sort,!0);let i,a;const o=n.map(l=>{const c=t.getData(l.data);return c||QI(l.data),c.countsRef(t,l.field,r)}),s={groupby:h9,pulse:o};r&&(i=r.op||"count",a=r.field?YI(i,r.field):"count",s.ops=[mme[i]],s.fields=[t.fieldRef(a)],s.as=[a]),i=t.add(lme(s));const u=t.add(Al({pulse:_t(i)}));return a=t.add(Ogt({field:h9,sort:t.sortRef(r),pulse:_t(u)})),_t(a)}function yme(e,t){return e&&(!e.field&&!e.op?Xt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Ie("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!mme[e.op]&&Ie("Multiple domain scales can not be sorted using "+e.op)),e}function Lgt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||QI(i.data),a.domainRef(t,i.field)});return _t(t.add(wgt({values:r})))}function Bgt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||QI(i.data),a.extentRef(t,i.field)});return _t(t.add(xgt({extents:r})))}function zgt(e,t){return e.signal||bt(e)?JI(e,t):t.objectProperty(e)}function jgt(e){return Xt(e)?{interval:wu(e.interval),step:wu(e.step)}:wu(e)}function Ugt(e,t){t.interpolate=wu(e.type||e),e.gamma!=null&&(t.interpolateGamma=wu(e.gamma))}function bme(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(lr(i)){if(r&&Rt(r,i))return e=Zt({},e,{range:r[i]}),bme(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=wy(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Ie("Unrecognized scale range value: "+At(i))}else if(i.scheme){n.scheme=bt(i.scheme)?JI(i.scheme,t):wu(i.scheme,t),i.extent&&(n.schemeExtent=JI(i.extent,t)),i.count&&(n.schemeCount=wu(i.count,t));return}else if(i.step){n.rangeStep=wu(i.step,t);return}else{if(wy(e.type)&&!bt(i))return vme(i,e,t);bt(i)||Ie("Unsupported range type: "+At(i))}return i.map(a=>(bt(a)?JI:wu)(a,t))}function Wgt(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=v9(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=v9(n[i],i,t));t.addProjection(e.name,r)}function v9(e,t,n){return bt(e)?e.map(r=>v9(r,t,n)):Xt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Ie("Unsupported parameter object: "+At(e)):e}const kl="top",Hy="left",Gy="right",fp="bottom",xme="center",Vgt="vertical",qgt="start",Hgt="middle",Ggt="end",y9="index",b9="label",Kgt="offset",Ky="perc",Xgt="perc2",_u="value",a_="guide-label",x9="guide-title",Ygt="group-title",Zgt="group-subtitle",wme="symbol",eN="gradient",w9="discrete",_9="size",Jgt="shape",Qgt="fill",emt="stroke",tmt="strokeWidth",nmt="strokeDash",rmt="opacity",S9=[_9,Jgt,Qgt,emt,tmt,nmt,rmt],o_={name:1,style:1,interactive:1},Fn={value:0},Su={value:1},tN="group",_me="rect",E9="rule",imt="symbol",Cm="text";function s_(e){return e.type=tN,e.interactive=e.interactive||!1,e}function os(e,t){const n=(r,i)=>Cl(e[r],Cl(t[r],i));return n.isVertical=r=>Vgt===Cl(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Cl(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Cl(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Cl(e.columns,Cl(t.columns,+n.isVertical(!0))),n}function Sme(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function amt(e,t,n){const r=t.config.style[n];return r&&r[e]}function nN(e,t,n){return"item.anchor === '".concat(qgt,"' ? ").concat(e," : item.anchor === '").concat(Ggt,"' ? ").concat(t," : ").concat(n)}const C9=nN(At(Hy),At(Gy),At(xme));function omt(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(t.signal,") === 'extent'")},Xt(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function Eme(e,t){return t?e?Xt(e)?Object.assign({},e,{offset:Eme(e.offset,t)}):{value:e,offset:t}:t:e}function Ws(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Vy(e.encode,t,o_)):e.interactive=!1,e}function smt(e,t,n,r){const i=os(e,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;a?(l=[0,1],c=[0,0],f=o,d=s):(l=[0,0],c=[1,0],f=s,d=o);const h={enter:u={opacity:Fn,x:Fn,y:Fn,width:ua(f),height:ua(d)},update:Zt({},u,{opacity:Su,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Fn}};return ka(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ws({type:_me,role:Fpt,encode:h},r)}function umt(e,t,n,r,i){const a=os(e,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:Fn,fill:{scale:t,field:_u}};p[l]={signal:h+"datum."+Ky,mult:u},p[c]=Fn,p[f]={signal:h+"datum."+Xgt,mult:u},p[d]=ua(s);const g={enter:p,update:Zt({},p,{opacity:Su}),exit:{opacity:Fn}};return ka(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Ws({type:_me,role:Dpt,key:_u,from:i,encode:g},r)}const lmt="datum.".concat(Ky,'<=0?"').concat(Hy,'":datum.').concat(Ky,'>=1?"').concat(Gy,'":"').concat(xme,'"'),cmt="datum.".concat(Ky,'<=0?"').concat(fp,'":datum.').concat(Ky,'>=1?"').concat(kl,'":"').concat(Hgt,'"');function Cme(e,t,n,r){const i=os(e,t),a=i.isVertical(),o=ua(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:Fn},update:c={opacity:Su,text:{field:b9}},exit:{opacity:Fn}};return ka(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Cl(e.labelLimit,t.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=c.baseline={signal:cmt},f="y",d="x",h="1-"):(l.align=c.align={signal:lmt},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+Ky,mult:s},l[d]=c[d]=o,o.offset=Cl(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+y9}:void 0,Ws({type:Cm,role:eme,style:a_,key:_u,from:r,encode:p,overlap:u},n)}function fmt(e,t,n,r,i){const a=os(e,t),o=n.entries,s=!!(o&&o.interactive),u=o?o.name:void 0,l=a("clipHeight"),c=a("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(Kgt," : datum.").concat(_9),h=l?ua(l):{field:_9},p="datum.".concat(y9),g="max(1, ".concat(i,")");let m,v,y,b,x;h.mult=.5,m={enter:v={opacity:Fn,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:Su,x:v.x,y:v.y},exit:{opacity:Fn}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),ka(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",S),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),S9.forEach(A=>{e[A]&&(y[A]=v[A]={scale:e[A],field:_u})});const C=Ws({type:imt,role:Mpt,key:_u,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=ua(c);_.offset=a("labelOffset"),m={enter:v={opacity:Fn,x:{signal:d,offset:_},y:h},update:y={opacity:Su,text:{field:b9},x:v.x,y:v.y},exit:{opacity:Fn}},ka(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const E=Ws({type:Cm,role:eme,style:a_,key:_u,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Fn,height:l?ua(l):Fn,opacity:Fn},exit:{opacity:Fn},update:y={opacity:Su,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),r={facet:{data:r,name:"value",groupby:y9}},s_({role:c9,from:r,encode:Vy(m,o,o_),marks:[C,E],name:u,interactive:s,sort:x})}function dmt(e,t){const n=os(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const A9='item.orient === "left"',k9='item.orient === "right"',rN="(".concat(A9," || ").concat(k9,")"),hmt="datum.vgrad && ".concat(rN),pmt=nN('"top"','"bottom"','"middle"'),gmt=nN('"right"','"left"','"center"'),mmt="datum.vgrad && ".concat(k9," ? (").concat(gmt,") : (").concat(rN," && !(datum.vgrad && ").concat(A9,')) ? "left" : ').concat(C9),vmt="item._anchor || (".concat(rN,' ? "middle" : "start")'),ymt="".concat(hmt," ? (").concat(A9," ? -90 : 90) : 0"),bmt="".concat(rN," ? (datum.vgrad ? (").concat(k9,' ? "bottom" : "top") : ').concat(pmt,') : "top"');function xmt(e,t,n,r){const i=os(e,t),a={enter:{opacity:Fn},update:{opacity:Su,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Fn}};return ka(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:vmt},angle:{signal:ymt},align:{signal:mmt},baseline:{signal:bmt},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ws({type:Cm,role:Ppt,style:x9,from:r,encode:a},n)}function wmt(e,t){let n;return Xt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Ame(e.path)+")":e.sphere&&(n="geoShape("+Ame(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Ame(e){return Xt(e)&&e.signal?e.signal:At(e)}function kme(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===tN?c9:t||u9}function _mt(e){return{marktype:e.type,name:e.name||void 0,role:e.role||kme(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Smt(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function T9(e,t){const n=wse(e.type);n||Ie("Unrecognized transform type: "+At(e.type));const r=KI(n.type.toLowerCase(),null,Tme(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function Tme(e,t,n){const r={},i=e.params.length;for(let a=0;a<i;++a){const o=e.params[a];r[o.name]=Emt(o,t,n)}return r}function Emt(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return Cmt(e,t,n);if(i===void 0){e.required&&Ie("Missing required "+At(t.type)+" parameter: "+At(e.name));return}else{if(r==="param")return Amt(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!qi(i)?i.map(a=>Ome(e,a,n)):Ome(e,i,n)}function Ome(e,t,n){const r=e.type;if(qi(t))return Nme(r)?Ie("Expression references can not be signals."):O9(r)?n.fieldRef(t):Dme(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||O9(r);return i&&kmt(t)?n.exprRef(t.expr,t.as):i&&Tmt(t)?r_(t.field,t.as):Nme(r)?Bc(t,n):Omt(r)?_t(n.getData(t).values):O9(r)?r_(t):Dme(r)?n.compareRef(t):t}}function Cmt(e,t,n){return lr(t.from)||Ie('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Amt(e,t,n){const r=t[e.name];return e.array?(bt(r)||Ie("Expected an array of sub-parameters. Instead: "+At(r)),r.map(i=>Ime(e,i,n))):Ime(e,r,n)}function Ime(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||Ie("Unsupported parameter: "+At(t));const a=Zt(Tme(i,t,n),i.key);return _t(n.add(Sgt(a)))}const kmt=e=>e&&e.expr,Tmt=e=>e&&e.field,Omt=e=>e==="data",Nme=e=>e==="expr",O9=e=>e==="field",Dme=e=>e==="compare";function Imt(e,t,n){let r,i,a,o,s;return e?(r=e.facet)&&(t||Ie("Only group marks can be faceted."),r.field!=null?o=s=iN(r,n):(e.data?s=_t(n.getData(e.data).aggregate):(a=T9(Zt({type:"aggregate",groupby:Dt(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=iN(r,n),o=s=_t(n.add(a))),i=n.keyRef(r.groupby,!0))):o=_t(n.add(Al(null,[{}]))),o||(o=iN(e,n)),{key:i,pulse:o,parent:s}}function iN(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:_t(t.getData(e.data).output)}function Am(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Am.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let a=t[0],o=null,s=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=_t(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(o=t[s]);return new Am(e,a,i,r,o)};function Rme(e){return lr(e)?e:null}function Fme(e,t,n){const r=YI(n.op,n.field);let i;if(t.ops){for(let a=0,o=t.as.length;a<o;++a)if(t.as[a]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function u_(e,t,n,r,i,a,o){const s=t[n]||(t[n]={}),u=Qpt(a);let l=Rme(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=a?{field:h9,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:_t(t.output)};u&&(d.sort=e.sortRef(a)),f=e.add(KI(r,void 0,d)),o&&(t.index[i]=f),c=_t(f),l!=null&&(s[l]=c)}return c}Am.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),a=Rme(t);let o,s,u;return a!=null&&(e=r.scope,o=i[a]),o?n&&n.field&&Fme(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:_t(r.output)},n&&n.field&&Fme(e,u,n),s=e.add(lme(u)),o=e.add(Al({pulse:_t(s)})),o={agg:s,ref:_t(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return _t(this.values)},extentRef(e,t){return u_(e,this,"extent","extent",t,!1)},domainRef(e,t){return u_(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return u_(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return u_(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return u_(e,this,"indata","tupleindex",t,!0,!0)}};function Nmt(e,t,n){const r=e.from.facet,i=r.name,a=iN(r,t);let o;r.name||Ie("Facet must have a name: "+At(r)),r.data||Ie("Facet must reference a data set: "+At(r)),r.field?o=t.add(hme({field:t.fieldRef(r.field),pulse:a})):r.groupby?o=t.add(pgt({key:t.keyRef(r.groupby),group:_t(t.proxy(n.parent)),pulse:a})):Ie("Facet must specify groupby or field: "+At(r));const s=t.fork(),u=s.add(Al()),l=s.add(Em({pulse:_t(u)}));s.addData(i,new Am(s,u,u,l)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(e).toRuntime()}}function Dmt(e,t,n){const r=t.add(hme({pulse:n.pulse})),i=t.fork();i.add(Em()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Mme(e,t,n){const r=e.remove,i=e.insert,a=e.toggle,o=e.modify,s=e.values,u=t.add(XI()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(f=>f??"null").join(",")+"),0)",c=Bc(l,t);u.update=c.$expr,u.params=c.$params}function aN(e,t){const n=kme(e),r=e.type===tN,i=e.from&&e.from.facet,a=e.overlap;let o=e.layout||n===c9||n===l9,s,u,l,c,f,d,h;const p=n===u9||o||i,g=Imt(e.from,r,t);u=t.add(dgt({key:g.key||(e.key?r_(e.key):void 0),pulse:g.pulse,clean:!r}));const m=_t(u);u=l=t.add(Al({pulse:m})),u=t.add(bgt({markdef:_mt(e),interactive:Smt(e.interactive,t),clip:wmt(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:_t(u)}));const v=_t(u);u=c=t.add(dme(ime(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const C=T9(S,t),_=C.metadata;(_.generates||_.changes)&&Ie("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),C.params.pulse=_t(u),t.add(u=C)}),e.sort&&(u=t.add(Tgt({sort:t.compareRef(e.sort),pulse:_t(u)})));const y=_t(u);(i||o)&&(o=t.add(gme({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=_t(o));const b=t.add(cme({mark:v,pulse:d||y}));h=_t(b),r&&(p&&(s=t.operators,s.pop(),o&&s.pop()),t.pushState(y,d||h,m),i?Nmt(e,t,g):p?Dmt(e,t,g):t.parse(e),t.popState(),p&&(o&&s.push(o),s.push(b))),a&&(h=Rmt(a,h,t));const x=t.add(pme({pulse:h})),w=t.add(Em({pulse:_t(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Am(t,l,x,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&Ie("Marks only support modify triggers."),Mme(S,t,f)}))}function Rmt(e,t,n){const r=e.method,i=e.bound,a=e.separation,o={separation:qi(a)?n.signalRef(a.signal):a,method:qi(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;o.boundTolerance=qi(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return _t(n.add(_gt(o)))}function Fmt(e,t){const n=t.config.legend,r=e.encode||{},i=os(e,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,l={};let c=0,f,d,h;S9.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||Ie("Missing valid scale for legend.");const p=Mmt(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=_t(t.add(Al(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=_t(t.add(vgt(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===eN?(h=[smt(e,c,n,r.gradient),Cme(e,n,r.labels,y)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(Sm(i.gradientLength()),")/100))"))):p===w9?h=[umt(e,c,n,r.gradient,y),Cme(e,n,r.labels,y)]:(f=dmt(e,n),h=[fmt(e,n,r,y,Sm(f.columns))],d.size=Lmt(e,t,h[0].marks)),h=[s_({role:Rpt,from:m,encode:v,marks:h,layout:f,interactive:s})],g.title&&h.push(xmt(e,n,r.title,m)),aN(s_({role:Npt,from:m,encode:Vy($mt(i,e,n),a,o_),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),t)}function Mmt(e,t){let n=e.type||wme;return!e.type&&Pmt(e)===1&&(e.fill||e.stroke)&&(n=M5(t)?eN:P5(t)?w9:wme),n!==eN?n:P5(t)?w9:eN}function Pmt(e){return S9.reduce((t,n)=>t+(e[n]?1:0),0)}function $mt(e,t,n){const r={enter:{},update:{}};return ka(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Lmt(e,t,n){const r=Sm(Pme("size",e,n)),i=Sm(Pme("strokeWidth",e,n)),a=Sm(Bmt(n[1].encode,t,a_));return Bc("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function Pme(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):Sme(e,n[0].encode)}function Bmt(e,t,n){return Sme("fontSize",e)||amt("fontSize",t,n)}const zmt='item.orient==="'.concat(Hy,'"?-90:item.orient==="').concat(Gy,'"?90:0');function jmt(e,t){e=lr(e)?{text:e}:e;const n=os(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],l={},c=_t(t.add(Al(null,[l])));return u.push(Vmt(e,n,Umt(e),c)),e.subtitle&&u.push(qmt(e,n,r.subtitle,c)),aN(s_({role:$pt,from:c,encode:Wmt(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),t)}function Umt(e){const t=e.encode;return t&&t.title||Zt({name:e.name,interactive:e.interactive,style:e.style},t)}function Wmt(e,t){const n={enter:{},update:{}};return ka(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:C9},angle:{signal:zmt},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Vy(n,t,o_)}function Vmt(e,t,n,r){const i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ka(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ws({type:Cm,role:Lpt,style:Ygt,from:r,encode:o},n)}function qmt(e,t,n,r){const i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ka(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ws({type:Cm,role:Bpt,style:Zgt,from:r,encode:o},n)}function Hmt(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(T9(r,t))}),e.on&&e.on.forEach(r=>{Mme(r,t,e.name)}),t.addDataPipeline(e.name,Gmt(e,t,n))}function Gmt(e,t,n){const r=[];let i=null,a=!1,o=!1,s,u,l,c,f;for(e.values?qi(e.values)||ZI(e.format)?(r.push($me(t,e)),r.push(i=km())):r.push(i=km({$ingest:e.values,$format:e.format})):e.url?ZI(e.url)||ZI(e.format)?(r.push($me(t,e)),r.push(i=km())):r.push(i=km({$request:e.url,$format:e.format})):e.source&&(i=s=Dt(e.source).map(d=>_t(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=km()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(a=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=Agt({derive:a,pulse:l?s:s[0]}),(a||l)&&r.splice(1,0,km())),i||r.push(km()),r.push(Em({})),r}function km(e){const t=Al({},e);return t.metadata={source:!0},t}function $me(e,t){return ygt({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Lme=e=>e===fp||e===kl,oN=(e,t,n)=>qi(e)?Zmt(e.signal,t,n):e===Hy||e===kl?t:n,la=(e,t,n)=>qi(e)?Xmt(e.signal,t,n):Lme(e)?t:n,Tl=(e,t,n)=>qi(e)?Ymt(e.signal,t,n):Lme(e)?n:t,Bme=(e,t,n)=>qi(e)?Jmt(e.signal,t,n):e===kl?{value:t}:{value:n},Kmt=(e,t,n)=>qi(e)?Qmt(e.signal,t,n):e===Gy?{value:t}:{value:n},Xmt=(e,t,n)=>zme("".concat(e," === '").concat(kl,"' || ").concat(e," === '").concat(fp,"'"),t,n),Ymt=(e,t,n)=>zme("".concat(e," !== '").concat(kl,"' && ").concat(e," !== '").concat(fp,"'"),t,n),Zmt=(e,t,n)=>I9("".concat(e," === '").concat(Hy,"' || ").concat(e," === '").concat(kl,"'"),t,n),Jmt=(e,t,n)=>I9("".concat(e," === '").concat(kl,"'"),t,n),Qmt=(e,t,n)=>I9("".concat(e," === '").concat(Gy,"'"),t,n),zme=(e,t,n)=>(t=t!=null?ua(t):t,n=n!=null?ua(n):n,jme(t)&&jme(n)?(t=t?t.signal||At(t.value):null,n=n?n.signal||At(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Zt({test:e},t)].concat(n||[])),jme=e=>e==null||Object.keys(e).length===1,I9=(e,t,n)=>({signal:"".concat(e," ? (").concat(Xy(t),") : (").concat(Xy(n),")")}),evt=(e,t,n,r,i)=>({signal:(r!=null?"".concat(e," === '").concat(Hy,"' ? (").concat(Xy(r),") : "):"")+(n!=null?"".concat(e," === '").concat(fp,"' ? (").concat(Xy(n),") : "):"")+(i!=null?"".concat(e," === '").concat(Gy,"' ? (").concat(Xy(i),") : "):"")+(t!=null?"".concat(e," === '").concat(kl,"' ? (").concat(Xy(t),") : "):"")+"(null)"}),Xy=e=>qi(e)?e.signal:e==null?null:At(e),tvt=(e,t)=>t===0?0:qi(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},Yy=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Zy(e,t,n,r){let i;if(t&&Rt(t,e))return t[e];if(Rt(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[x9][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[a_][i]}return null}function Ume(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function nvt(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,s,u,l;if(qi(o)){const f=Ume([n.axisX,n.axisY]),d=Ume([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=la(o,Zy(l,n.axisX,i,r),Zy(l,n.axisY,i,r));u={};for(l of d)u[l]=evt(o.signal,Zy(l,n.axisTop,i,r),Zy(l,n.axisBottom,i,r),Zy(l,n.axisLeft,i,r),Zy(l,n.axisRight,i,r))}else s=o===kl||o===fp?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return s||u||a?Zt({},i,s,u,a):i}function rvt(e,t,n,r){const i=os(e,t),a=e.orient;let o,s;const u={enter:o={opacity:Fn},update:s={opacity:Su},exit:{opacity:Fn}};ka(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=Wme(e,0),c=Wme(e,1);return o.x=s.x=la(a,l,Fn),o.x2=s.x2=la(a,c),o.y=s.y=Tl(a,l,Fn),o.y2=s.y2=Tl(a,c),Ws({type:E9,role:Apt,from:r,encode:u},n)}function Wme(e,t){return{scale:e.scale,range:t}}function ivt(e,t,n,r,i){const a=os(e,t),o=e.orient,s=e.gridScale,u=oN(o,1,-1),l=avt(e.offset,u);let c,f,d;const h={enter:c={opacity:Fn},update:d={opacity:Su},exit:f={opacity:Fn}};ka(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:e.scale,field:_u,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=la(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},v=s?{scale:s,range:1,mult:u,offset:l}:Zt(g,{mult:u,offset:l});return c.x=d.x=la(o,p,m),c.y=d.y=Tl(o,p,m),c.x2=d.x2=Tl(o,v),c.y2=d.y2=la(o,v),f.x=la(o,p),f.y=Tl(o,p),Ws({type:E9,role:kpt,key:_u,from:r,encode:h},n)}function avt(e,t){if(t!==1)if(!Xt(e))e=qi(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=Zt({},e);for(;n.mult!=null;)if(Xt(n.mult))n=n.mult=Zt({},n.mult);else return n.mult=qi(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function ovt(e,t,n,r,i,a){const o=os(e,t),s=e.orient,u=oN(s,-1,1);let l,c,f;const d={enter:l={opacity:Fn},update:f={opacity:Su},exit:c={opacity:Fn}};ka(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=ua(i);h.mult=u;const p={scale:e.scale,field:_u,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return f.y=l.y=la(s,Fn,p),f.y2=l.y2=la(s,h),c.x=la(s,p),f.x=l.x=Tl(s,Fn,p),f.x2=l.x2=Tl(s,h),c.y=Tl(s,p),Ws({type:E9,role:Opt,key:_u,from:r,encode:d},n)}function N9(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function svt(e,t,n,r,i,a){const o=os(e,t),s=e.orient,u=e.scale,l=oN(s,-1,1),c=Sm(o("labelFlush")),f=Sm(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=ua(i);m.mult=l,m.offset=ua(o("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:_u,band:.5,offset:Eme(a.offset,o("labelOffset"))},y=la(s,p?N9(u,c,'"left"','"right"','"center"'):{value:"center"},Kmt(s,"left","right")),b=la(s,Bme(s,"bottom","top"),p?N9(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=N9(u,c,"-(".concat(f,")"),f,0);p=p&&f;const w={opacity:Fn,x:la(s,v,m),y:Tl(s,v,m)},S={enter:w,update:g={opacity:Su,text:{field:b9},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:Fn,x:w.x,y:w.y}};ka(S,{dx:!d&&p?la(s,x):null,dy:!h&&p?Tl(s,x):null}),ka(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const C=o("labelBound");let _=o("labelOverlap");return _=_||C?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:C?{scale:u,orient:s,tolerance:C}:null}:void 0,g.align!==y&&(g.align=Yy(g.align,y)),g.baseline!==b&&(g.baseline=Yy(g.baseline,b)),Ws({type:Cm,role:Tpt,style:a_,key:_u,from:r,encode:S,overlap:_},n)}function uvt(e,t,n,r){const i=os(e,t),a=e.orient,o=oN(a,-1,1);let s,u;const l={enter:s={opacity:Fn,anchor:ua(i("titleAnchor",null)),align:{signal:C9}},update:u=Zt({},s,{opacity:Su,text:ua(e.title)}),exit:{opacity:Fn}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(nN(0,1,.5),")")};return u.x=la(a,c),u.y=Tl(a,c),s.angle=la(a,Fn,tvt(o,90)),s.baseline=la(a,Bme(a,fp,kl),{value:fp}),u.angle=s.angle,u.baseline=s.baseline,ka(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),lvt(i,a,l,n),l.update.align=Yy(l.update.align,s.align),l.update.angle=Yy(l.update.angle,s.angle),l.update.baseline=Yy(l.update.baseline,s.baseline),Ws({type:Cm,role:Ipt,style:x9,from:r,encode:l},n)}function lvt(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=Yy(ua(s),n.update[u]),!1):!qy(u,r),a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?ua(o):la(t,ua(o),ua(a))}function cvt(e,t){const n=nvt(e,t),r=e.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=os(e,n),l=omt(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=_t(t.add(Al({},[c]))),d=_t(t.add(fgt({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(ivt(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(ovt(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(svt(e,n,r.labels,d,p,l))),c.domain&&h.push(rvt(e,n,r.domain,f)),c.title&&h.push(uvt(e,n,r.title,f)),aN(s_({role:Cpt,from:f,encode:Vy(fvt(u,e),i,o_),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),t)}function fvt(e,t){const n={enter:{},update:{}};return ka(n,{orient:e("orient"),offset:e("offset")||0,position:Cl(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Vme(e,t,n){const r=Dt(e.signals),i=Dt(e.scales);return n||r.forEach(a=>ome(a,t)),Dt(e.projections).forEach(a=>Wgt(a,t)),i.forEach(a=>Ngt(a,t)),Dt(e.data).forEach(a=>Hmt(a,t)),i.forEach(a=>Dgt(a,t)),(n||r).forEach(a=>cgt(a,t)),Dt(e.axes).forEach(a=>cvt(a,t)),Dt(e.marks).forEach(a=>aN(a,t)),Dt(e.legends).forEach(a=>Fmt(a,t)),e.title&&jmt(e.title,t),t.parseLambdas(),t}const dvt=e=>Vy({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function hvt(e,t){const n=t.config,r=_t(t.root=t.add(XI())),i=pvt(e,n);i.forEach(l=>ome(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(Al()),o=t.add(dme(ime(dvt(e.encode),tN,l9,e.style,t,{pulse:_t(a)}))),s=t.add(gme({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:_t(o)}));t.operators.pop(),t.pushState(_t(o),_t(s),null),Vme(e,t,i),t.operators.push(s);let u=t.add(cme({mark:r,pulse:_t(s)}));return u=t.add(pme({pulse:_t(u)})),u=t.add(Em({pulse:_t(u)})),t.addData("root",new Am(t,a,a,u)),t}function l_(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function pvt(e,t){const n=o=>Cl(e[o],t[o]),r=[l_("background",n("background")),l_("autosize",_pt(n("autosize"))),l_("padding",Ept(n("padding"))),l_("width",n("width")||0),l_("height",n("height")||0)],i=r.reduce((o,s)=>(o[s.name]=s,o),{}),a={};return Dt(e.signals).forEach(o=>{Rt(i,o.name)?o=Zt(i[o.name],o):r.push(o),a[o.name]=o}),Dt(t.signals).forEach(o=>{!Rt(a,o.name)&&!Rt(i,o.name)&&r.push(o)}),r}function qme(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Hme(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}qme.prototype=Hme.prototype={parse(e){return Vme(e,this)},fork(){return new Hme(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof d9?_t(e):e;return this.add(Cgt({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,a){let o,s;r&&(o=r.data||(r.data={}),s=o[i]||(o[i]=[]),s.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(_t(this.add(Em({pulse:e})))),this._parent.push(t),this._lookup.push(n?_t(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return An(this._parent)},encode(){return An(this._encode)},lookup(){return An(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(lr(e))return r_(e,t);e.signal||Ie("Unsupported field reference: "+At(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=_t(this.add(ggt(i)))}return r},compareRef(e){let t=!1;const n=a=>qi(a)?(t=!0,this.signalRef(a.signal)):egt(a)?(t=!0,this.exprRef(a.expr)):a,r=Dt(e.field).map(n),i=Dt(e.order).map(n);return t?_t(this.add(fme({fields:r,orders:i}))):sme(r,i)},keyRef(e,t){let n=!1;const r=a=>qi(a)?(n=!0,_t(i[a.signal])):a,i=this.signals;return e=Dt(e).map(r),n?_t(this.add(mgt({fields:e,flat:t}))):Ypt(e,t)},sortRef(e){if(!e)return e;const t=YI(e.op,e.field),n=e.order||Zpt;return n.signal?_t(this.add(fme({fields:t,orders:this.signalRef(n.signal)}))):sme(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Rt(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Ie("Duplicate signal name: "+At(e));const n=t instanceof d9?t:this.add(XI(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Ie("Unrecognized signal name: "+At(e)),this.signals[e]},signalRef(e){return this.signals[e]?_t(this.signals[e]):(Rt(this.lambdas,e)||(this.lambdas[e]=this.add(XI(null))),_t(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Bc(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Xt(e)?e:this.signalRef(e.signal||D9(e))},exprRef(e,t){const n={expr:Bc(e,this)};return t&&(n.expr.$name=t),_t(this.add(hgt(n)))},addBinding(e,t){this.bindings||Ie("Nested signals do not support binding: "+At(e)),this.bindings.push(Zt({signal:e},t))},addScaleProj(e,t){Rt(this.scales,e)&&Ie("Duplicate scale or projection name: "+At(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,kgt(t))},addProjection(e,t){this.addScaleProj(e,Egt(t))},getScale(e){return this.scales[e]||Ie("Unrecognized scale name: "+At(e)),this.scales[e]},scaleRef(e){return _t(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Rt(this.data,e)&&Ie("Duplicate data set name: "+At(e)),this.data[e]=t},getData(e){return this.data[e]||Ie("Undefined data set name: "+At(e)),this.data[e]},addDataPipeline(e,t){return Rt(this.data,e)&&Ie("Duplicate data set name: "+At(e)),this.addData(e,Am.fromEntries(this,t))}};function D9(e){return(bt(e)?gvt:mvt)(e)}function gvt(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Xt(i)?i.signal||D9(i):At(i))}return n+"]"}function mvt(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+At(r)+":"+(Xt(i)?i.signal||D9(i):At(i));return t+"}"}function vvt(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function yvt(e,t,n){return Xt(e)||Ie("Input Vega specification must be an object."),t=Wk(vvt(),t,e.config),hvt(e,new qme(t,n)).toRuntime()}var bvt="vega",xvt="5.20.0",wvt="The Vega visualization grammar.",_vt=["vega","visualization","interaction","dataflow","library","data","d3"],Svt="BSD-3-Clause",Evt="UW Interactive Data Lab (http://idl.cs.washington.edu)",Cvt="build/vega-node.js",Avt="build/vega.module.js",kvt="build/vega.min.js",Tvt="build/vega.min.js",Ovt="index.d.ts",Ivt="vega/vega",Nvt={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Dvt={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Rvt={"vega-schema":"*"},Fvt="f262105e75449760b0f35fda70e6b576a31d68a4",Mvt={name:bvt,version:xvt,description:wvt,keywords:_vt,license:Svt,author:Evt,main:Cvt,module:Avt,unpkg:kvt,jsdelivr:Tvt,types:Ovt,repository:Ivt,scripts:Nvt,dependencies:Dvt,devDependencies:Rvt,gitHead:Fvt};Zt(uy,NQe,Jit,Iat,gst,lut,$lt,dlt,Blt,nct,dct,bct);const Pvt=Mvt.version;var $vt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Pvt,Dataflow:sy,EventStream:hT,MultiPulse:ZB,Operator:xr,Parameters:dT,Pulse:$h,Transform:_e,changeset:Zg,definition:wse,ingest:Yn,isTuple:lT,transform:_se,transforms:uy,tupleid:xt,interpolate:$5,interpolateColors:XT,interpolateRange:ace,quantizeInterpolator:oce,scale:Wn,scheme:L5,projection:Nj,View:Wge,defaultLocale:KB,formatLocale:aT,locale:sse,resetDefaultLocale:YZe,timeFormatLocale:Rw,expressionFunction:Ii,parse:yvt,runtimeContext:Sge,codegenExpression:tge,parseExpression:Jpe,parseSelector:cp,Debug:pae,Error:X4,Info:hae,None:fae,Warn:dae,accessor:Ko,accessorFields:$a,accessorName:ri,array:Dt,ascending:Xk,clampRange:kae,compare:Q4,constant:Ba,debounce:eB,error:Ie,extend:Zt,extent:xc,extentIndex:Tae,falsy:Ch,fastmap:J0,field:Xo,flush:Oae,hasOwnProperty:Rt,id:cw,identity:yo,inherits:Ge,inrange:Q0,isArray:bt,isBoolean:tB,isDate:Ah,isFunction:nn,isIterable:Iae,isNumber:kh,isObject:Xt,isRegExp:Nae,isString:lr,key:nB,lerp:Dae,logger:gae,lruCache:Rae,merge:Fae,mergeConfig:Wk,one:Z0,pad:Mae,panLinear:wae,panLog:_ae,panPow:Sae,panSymlog:Eae,peek:An,quarter:Cae,repeat:fw,span:dw,splitAccessPath:jk,stringValue:At,toBoolean:rB,toDate:iB,toNumber:La,toSet:hl,toString:aB,truncate:Pae,truthy:hu,utcquarter:Aae,visitArray:Th,writeConfig:Vk,zero:Eh,zoomLinear:Y4,zoomLog:Z4,zoomPow:Kk,zoomSymlog:J4,bandwidthNRD:tz,bin:Ese,bootstrapCI:Cse,cumulativeLogNormal:sz,cumulativeNormal:vT,cumulativeUniform:fz,densityLogNormal:oz,densityNormal:nz,densityUniform:cz,dotbin:Ase,quantileLogNormal:uz,quantileNormal:yT,quantileUniform:dz,quantiles:QB,quartiles:ez,get random(){return mu},randomInteger:PJe,randomKDE:iz,randomLCG:MJe,randomLogNormal:Tse,randomMixture:Ose,randomNormal:rz,randomUniform:Ise,regressionExp:Dse,regressionLinear:hz,regressionLoess:$se,regressionLog:Nse,regressionPoly:Fse,regressionPow:Rse,regressionQuad:pz,sampleCurve:xT,sampleLogNormal:az,sampleNormal:mT,sampleUniform:lz,setRandom:RJe,DATE:Jo,DAY:ja,DAYOFYEAR:wc,HOURS:$s,MILLISECONDS:pl,MINUTES:Ls,MONTH:za,QUARTER:Zo,SECONDS:gu,TIME_UNITS:DB,WEEK:ji,YEAR:_a,dayofyear:voe,timeBin:Poe,timeFloor:Eoe,timeInterval:ry,timeOffset:koe,timeSequence:Ioe,timeUnitSpecifier:moe,timeUnits:FB,utcFloor:Coe,utcInterval:iy,utcOffset:Toe,utcSequence:Noe,utcdayofyear:xoe,utcweek:woe,week:yoe,read:use,inferType:Bae,inferTypes:zae,typeParsers:oB,format:Jk,formats:dB,responseType:Kae,loader:oT,Bounds:Wi,CanvasHandler:p2,CanvasRenderer:_O,Gradient:_ce,GroupItem:tO,Handler:Jh,Item:eO,Marks:Bs,RenderType:ep,Renderer:Rc,ResourceLoader:X5,SVGHandler:E6,SVGRenderer:N6,SVGStringRenderer:F6,Scenegraph:b6,boundClip:zfe,boundContext:a2,boundItem:y6,boundMark:tfe,boundStroke:Jf,domChild:es,domClear:yl,domCreate:Zh,domFind:x6,font:hO,fontFamily:c2,fontSize:Dc,intersect:Pfe,intersectBoxLine:Cy,intersectPath:n6,intersectPoint:r6,intersectRule:zce,lineHeight:Xh,markup:I6,multiLineOffset:g6,pathCurves:W5,pathEqual:jfe,pathParse:_y,pathRectangle:Oce,pathRender:e2,pathSymbols:Tce,pathTrail:Ice,point:gO,renderModule:EO,resetSVGClipId:Dce,resetSVGDefIds:pit,sceneEqual:P6,sceneFromJSON:rfe,scenePickVisit:uO,sceneToJSON:nfe,sceneVisit:vl,sceneZOrder:i6,serializeXML:Cfe,textMetrics:Nc});const Lvt="vega-lite",Bvt='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',zvt="4.13.1",jvt=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Uvt="https://vega.github.io/vega-lite/",Wvt="Vega-Lite is a concise high-level language for interactive visualization.",Vvt="build/vega-lite.js",qvt="build/vega-lite.min.js",Hvt="build/vega-lite.min.js",Gvt="build/src/index",Kvt="build/src/index.d.ts",Xvt={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Yvt={test:"test"},Zvt={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},Jvt={type:"git",url:"https://github.com/vega/vega-lite.git"},Qvt="BSD-3-Clause",e0t={url:"https://github.com/vega/vega-lite/issues"},t0t={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},n0t={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},r0t={vega:"^5.12.1"},i0t={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1};var a0t={name:Lvt,author:Bvt,version:zvt,collaborators:jvt,homepage:Uvt,description:Wvt,main:Vvt,unpkg:qvt,jsdelivr:Hvt,module:Gvt,types:Kvt,bin:Xvt,directories:Yvt,scripts:Zvt,repository:Jvt,license:Qvt,bugs:e0t,devDependencies:t0t,dependencies:n0t,peerDependencies:r0t,jest:i0t};function Jy(e,t,n){return e.fields=t||[],e.fname=n,e}function o0t(e){return e.length===1?s0t(e[0]):u0t(e)}const s0t=e=>function(t){return t[e]},u0t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function R9(e){throw Error(e)}function Tm(e){var t=[],n=null,r=0,i=e.length,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<i;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=s+1,n=u):u==="."&&!r?s>o?l():o=s+1:u==="["?(s>o&&l(),r=o=s+1):u==="]"&&(r||R9("Access path missing open bracket: "+e),r>0&&l(),r=0,o=s+1)}return r&&R9("Access path missing closing bracket: "+e),n&&R9("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function l0t(e,t,n){const r=Tm(e);return e=r.length===1?r[0]:e,Jy((n&&n.get||o0t)(r),[e],t||e)}var c_=[];l0t("id");var c0t=Jy(function(e){return e},c_,"identity");Jy(function(){return 0},c_,"zero"),Jy(function(){return 1},c_,"one"),Jy(function(){return!0},c_,"true"),Jy(function(){return!1},c_,"false");function sN(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var f0t=0,d0t=1,Gme=2,h0t=3,p0t=4;function g0t(e,t){var n=e||f0t;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=d0t&&sN(t||"error","ERROR",arguments),this},warn:function(){return n>=Gme&&sN(t||"warn","WARN",arguments),this},info:function(){return n>=h0t&&sN(t||"log","INFO",arguments),this},debug:function(){return n>=p0t&&sN(t||"log","DEBUG",arguments),this}}}var Tt=Array.isArray;function ca(e){return e===Object(e)}const Kme=e=>e!=="__proto__";function Xme(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=m0t(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;F9(t,r,n[r],i)}return t},{})}function F9(e,t,n,r){if(!!Kme(t)){var i,a;if(ca(n)&&!Tt(n)){a=ca(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?F9(a,i,n[i]):Kme(i)&&(a[i]=n[i])}else e[t]=n}}function m0t(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function vi(e){return e!=null?Tt(e)?e:[e]:[]}function v0t(e){return typeof e=="function"}const y0t=Object.prototype.hasOwnProperty;function Om(e,t){return y0t.call(e,t)}function f_(e){return typeof e=="boolean"}function Ni(e){return typeof e=="number"}function pn(e){return typeof e=="string"}function Mn(e){return Tt(e)?"["+e.map(Mn)+"]":ca(e)||pn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Im(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function St(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Yme={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var a;try{a=Promise}catch(d){a=function(){}}function o(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var v=[],y=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var C,_;if(typeof w!="object")return w;if(n(w,r))C=new r;else if(n(w,i))C=new i;else if(n(w,a))C=new a(function(P,V){w.then(function(Y){P(x(Y,S-1))},function(Y){V(x(Y,S-1))})});else if(o.__isArray(w))C=[];else if(o.__isRegExp(w))C=new RegExp(w.source,f(w)),w.lastIndex&&(C.lastIndex=w.lastIndex);else if(o.__isDate(w))C=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(w.length):C=new Buffer(w.length),w.copy(C),C;n(w,Error)?C=Object.create(w):typeof g=="undefined"?(_=Object.getPrototypeOf(w),C=Object.create(_)):(C=Object.create(g),_=g)}if(h){var E=v.indexOf(w);if(E!=-1)return y[E];v.push(w),y.push(C)}n(w,r)&&w.forEach(function(P,V){var Y=x(V,S-1),X=x(P,S-1);C.set(Y,X)}),n(w,i)&&w.forEach(function(P){var V=x(P,S-1);C.add(V)});for(var A in w){var k;_&&(k=Object.getOwnPropertyDescriptor(_,A)),!(k&&k.set==null)&&(C[A]=x(w[A],S-1))}if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(w),A=0;A<T.length;A++){var I=T[A],N=Object.getOwnPropertyDescriptor(w,I);N&&!N.enumerable&&!m||(C[I]=x(w[I],S-1),N.enumerable||Object.defineProperty(C,I,{enumerable:!1}))}if(m)for(var O=Object.getOwnPropertyNames(w),A=0;A<O.length;A++){var D=O[A],N=Object.getOwnPropertyDescriptor(w,D);N&&N.enumerable||(C[D]=x(w[D],S-1),Object.defineProperty(C,D,{enumerable:!1}))}return C}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function s(d){return Object.prototype.toString.call(d)}o.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(Yme);var b0t=Yme.exports,x0t=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!=0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},d_=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(a){return function(o){return function(s,u){var l={key:s,value:o[s]},c={key:u,value:o[u]};return a(l,c)}}}(t.cmp),i=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var s,u;if(Array.isArray(o)){for(u="[",s=0;s<o.length;s++)s&&(u+=","),u+=a(o[s])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",s=0;s<c.length;s++){var f=c[s],d=a(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function M9(e){return!!e.or}function P9(e){return!!e.and}function $9(e){return!!e.not}function uN(e,t){if($9(e))uN(e.not,t);else if(P9(e))for(const n of e.and)uN(n,t);else if(M9(e))for(const n of e.or)uN(n,t);else t(e)}function lN(e,t){return $9(e)?{not:lN(e.not,t)}:P9(e)?{and:e.and.map(n=>lN(n,t))}:M9(e)?{or:e.or.map(n=>lN(n,t))}:t(e)}const h_=x0t,gn=b0t;function p_(e,t){const n={};for(const r of t)Om(e,r)&&(n[r]=e[r]);return n}function ud(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>d_(e)).join(",")})`};const $r=d_;function $n(e){if(Ni(e))return e;const t=pn(e)?e:d_(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function Zme(e){return e===!1||e===null}function It(e,t){return e.indexOf(t)>-1}function g_(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function Jme(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function w0t(e,...t){for(const n of t)_0t(e,n??{});return e}function _0t(e,t){for(const n of Xe(t))F9(e,n,t[n],!0)}function dp(e,t){const n=[],r={};let i;for(const a of e)i=t(a),!(i in r)&&(r[i]=1,n.push(a));return n}function S0t(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Qme(e,t){for(const n of e)if(t.has(n))return!0;return!1}function eve(e){const t=new Set;for(const n of e){const i=Tm(n).map((o,s)=>s===0?o:`[${o}]`),a=i.map((o,s)=>i.slice(0,s+1).join(""));for(const o of a)t.add(o)}return t}function tve(e,t){return e===void 0||t===void 0?!0:Qme(eve(e),eve(t))}function wr(e){return Xe(e).length===0}const Xe=Object.keys,hp=Object.values;function nve(e){const t=[];for(const n in e)Om(e,n)&&t.push({key:n,value:e[n]});return t}function cN(e){return e===!0||e===!1}function Lr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function m_(e,t){return $9(e)?"!("+m_(e.not,t)+")":P9(e)?"("+e.and.map(n=>m_(n,t)).join(") && (")+")":M9(e)?"("+e.or.map(n=>m_(n,t)).join(") || (")+")":t(e)}function L9(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&L9(e[n],t)&&delete e[n],wr(e)}function fN(e){return e.charAt(0).toUpperCase()+e.substr(1)}function rve(e,t="datum"){const n=Tm(e),r=[];for(let i=1;i<=n.length;i++){const a=`[${n.slice(0,i).map(Mn).join("][")}]`;r.push(`${t}${a}`)}return r.join(" && ")}function E0t(e,t="datum"){return`${t}[${Mn(Tm(e).join("."))}]`}function C0t(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function pp(e){return`${Tm(e).map(C0t).join("\\.")}`}function Qy(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function ive(e){return`${Tm(e).join(".")}`}function v_(e){return e?Tm(e).length:0}function Di(...e){for(const t of e)if(t!==void 0)return t}let A0t=42;function k0t(e){const t=++A0t;return e?String(e)+t:t}function T0t(e){return O0t(e)?e:`__${e}`}function O0t(e){return e.indexOf("__")===0}function dN(e){if(e!==void 0)return(e%360+360)%360}function B9(e){return Ni(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const ave={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function z9(e){return e&&e.condition}const ove=["domain","grid","labels","ticks","title"],I0t={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},sve={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},N0t=Object.assign(Object.assign({},sve),{style:1,labelExpr:1,encoding:1});function uve(e){return!!N0t[e]}const No={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},lve=No.arc,hN=No.area,pN=No.bar,D0t=No.image,gN=No.line,mN=No.point,R0t=No.rect,vN=No.rule,cve=No.text,j9=No.tick,F0t=No.trail,U9=No.circle,W9=No.square,fve=No.geoshape;function Nm(e){return It(["line","area","trail"],e)}function dve(e){return It(["rect","bar","image","arc"],e)}const hve=Xe(No);function zc(e){return e.type}Im(hve);const M0t=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],P0t=["fill","fillOpacity"],$0t=[...M0t,...P0t],L0t={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},pve=Xe(L0t),B0t={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},z0t={color:"#4c78a8",invalid:"filter",timeUnitBand:1},j0t={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},gve=5,U0t={binSpacing:1,continuousBandSize:gve,timeUnitBandPosition:.5},W0t={binSpacing:0,continuousBandSize:gve,timeUnitBandPosition:.5},V0t={thickness:1};function q0t(e){return zc(e)?e.type:e}function ld(e){return"mark"in e}class yN{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return ld(t)?q0t(t.mark)===this.name:!1}}const H0t={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},G0t={count:1,min:1,max:1};function gp(e){return!!e&&!!e.argmin}function Dm(e){return!!e&&!!e.argmax}function V9(e){return pn(e)&&!!H0t[e]}const K0t=["count","valid","missing","distinct"];function mve(e){return pn(e)&&It(K0t,e)}function X0t(e){return pn(e)&&It(["min","max"],e)}const Y0t=["count","sum","distinct","valid","missing"],Z0t=["mean","average","median","q1","q3","min","max"],J0t=Im(Z0t),cd="row",fd="column",bN="facet",Gr="x",Hi="y",Ol="x2",jc="y2",Uc="radius",dd="radius2",Il="theta",hd="theta2",Wc="latitude",Vc="longitude",Nl="latitude2",Eu="longitude2",ss="color",qc="fill",Hc="stroke",us="shape",pd="size",Rm="angle",gd="opacity",mp="fillOpacity",vp="strokeOpacity",yp="strokeWidth",bp="strokeDash",y_="text",b_="order",x_="detail",xN="key",Fm="tooltip",wN="href",_N="url",SN="description",Q0t={x:1,y:1,x2:1,y2:1},vve={theta:1,theta2:1,radius:1,radius2:1};function yve(e){return e in vve}const q9={longitude:1,longitude2:1,latitude:1,latitude2:1};function eyt(e){switch(e){case Wc:return"y";case Nl:return"y2";case Vc:return"x";case Eu:return"x2"}}function tyt(e){return e in q9}const nyt=Xe(q9),bve=Object.assign(Object.assign(Object.assign(Object.assign({},Q0t),vve),q9),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function eb(e){return e===ss||e===qc||e===Hc}const xve={row:1,column:1,facet:1},Cu=Xe(xve),H9=Object.assign(Object.assign({},bve),xve),wve=Xe(H9),ryt=St(H9,["order","detail","tooltip"]),iyt=St(ryt,["row","column","facet"]);function ayt(e){return!!iyt[e]}function _ve(e){return!!H9[e]}const oyt=[Ol,jc,Nl,Eu,hd,dd];function Sve(e){return Mm(e)!==e}function Mm(e){switch(e){case Ol:return Gr;case jc:return Hi;case Nl:return Wc;case Eu:return Vc;case hd:return Il;case dd:return Uc}return e}function xp(e){if(yve(e))switch(e){case Il:return"startAngle";case hd:return"endAngle";case Uc:return"outerRadius";case dd:return"innerRadius"}return e}function Gc(e){switch(e){case Gr:return Ol;case Hi:return jc;case Wc:return Nl;case Vc:return Eu;case Il:return hd;case Uc:return dd}}function Kc(e){switch(e){case Gr:case Ol:return"width";case Hi:case jc:return"height"}}function syt(e){switch(e){case Gr:return"xOffset";case Hi:return"yOffset";case Ol:return"x2Offset";case jc:return"y2Offset";case Il:return"thetaOffset";case Uc:return"radiusOffset";case hd:return"theta2Offset";case dd:return"radius2Offset"}}const G9=St(bve,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),uyt=Xe(G9),wp={x:1,y:1},Au=Xe(wp);function Xc(e){return e in wp}const K9={theta:1,radius:1},lyt=Xe(K9);function EN(e){return e==="width"?Gr:Hi}const Eve=St(G9,["text","tooltip","href","url","description","detail","key","order"]),cyt=Xe(Eve);function fyt(e){return!!G9[e]}function dyt(e){switch(e){case ss:case qc:case Hc:case pd:case us:case gd:case yp:case bp:return!0;case mp:case vp:case Rm:return!1}}const Cve=Object.assign(Object.assign(Object.assign({},wp),K9),Eve),CN=Xe(Cve);function _p(e){return!!Cve[e]}function hyt(e,t){return gyt(e)[t]}const Ave={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},pyt=St(Ave,["geoshape"]);function gyt(e){switch(e){case ss:case qc:case Hc:case SN:case x_:case xN:case Fm:case wN:case b_:case gd:case mp:case vp:case yp:case bN:case cd:case fd:return Ave;case Gr:case Hi:case Wc:case Vc:return pyt;case Ol:case jc:case Nl:case Eu:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case pd:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case bp:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case us:return{point:"always",geoshape:"always"};case y_:return{text:"always"};case Rm:return{point:"always",square:"always",text:"always"};case _N:return{image:"always"};case Il:return{text:"always",arc:"always"};case Uc:return{text:"always",arc:"always"};case hd:case dd:return{arc:"always"}}}function AN(e){switch(e){case Gr:case Hi:case Il:case Uc:case pd:case Rm:case yp:case gd:case mp:case vp:case Ol:case jc:case hd:case dd:return;case bN:case cd:case fd:case us:case bp:case y_:case Fm:case wN:case _N:case SN:return"discrete";case ss:case qc:case Hc:return"flexible";case Wc:case Vc:case Nl:case Eu:case x_:case xN:case b_:return}}function kve(e){return f_(e)&&(e=LN(e,void 0)),"bin"+Xe(e).map(t=>kN(e[t])?Lr(`_${t}_${Object.entries(e[t])}`):Lr(`_${t}_${e[t]}`)).join("")}function Ar(e){return e===!0||w_(e)&&!e.binned}function Do(e){return e==="binned"||w_(e)&&e.binned===!0}function w_(e){return ca(e)}function kN(e){return e==null?void 0:e.selection}function Tve(e){switch(e){case cd:case fd:case pd:case ss:case qc:case Hc:case yp:case gd:case mp:case vp:case us:return 6;case bp:return 4;default:return 10}}function X9(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const myt='Autosize "fit" only works for single views and layered views.';function Ove(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function Ive(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Nve(e){return e?`Dropping "fit-${e}" because spec has discrete ${Kc(e)}.`:'Dropping "fit" because spec has discrete size.'}function Dve(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function vyt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function yyt(e){return`The "nearest" transform is not supported for ${e} marks.`}function Rve(e){return`Selection not supported for ${e} yet.`}function byt(e){return`Cannot find a selection named "${e}".`}const xyt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",wyt="Legend bindings are only supported for selections over an individual field or encoding channel.";function _yt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function Syt(e){return`Unknown repeated value "${e}".`}function Fve(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Eyt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Cyt(e){return`Unrecognized parse "${e}".`}function Mve(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function Ayt(e){return`Ignoring an invalid transform: ${$r(e)}.`}const kyt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Pve(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Tyt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function Oyt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${$r(t)} is overridden by a child projection ${$r(n)}.`}const Iyt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Nyt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${$r(n)}}.`}function $ve(e){return`Invalid field type "${e}".`}function Dyt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Ryt(e){return`Invalid aggregation operator "${e}".`}function Fyt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function Lve(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Y9(e,t){return`Dropping ${$r(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Myt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function TN(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Pyt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function $yt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Lyt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Z9(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Byt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function zyt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const jyt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function Uyt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Wyt(e){return`Using unaggregated domain with raw field has no effect (${$r(e)}).`}function Vyt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function qyt(e){return`Unaggregated domain is currently unsupported for log scale (${$r(e)}).`}function Hyt(e){return`Cannot apply size to non-oriented mark "${e}".`}function Gyt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Kyt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Bve(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function zve(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Xyt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${$r(n)} and ${$r(r)}). Using ${$r(n)}.`}function Yyt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${$r(n)} and ${$r(r)}). Using the union of the two domains.`}function Zyt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Jyt(e){return`Dropping sort property ${$r(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const jve="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Qyt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",ebt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",tbt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function nbt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function rbt(e){return`Cannot stack non-linear scale (${e}).`}function ibt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function ON(e,t){return`Invalid ${e}: ${$r(t)}.`}function abt(e){return`Dropping day from datetime ${$r(e)} as day cannot be combined with other units.`}function obt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function sbt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function ubt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function lbt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function Uve(e){return`1D error band does not support ${e}.`}function Wve(e){return`Channel ${e} is required for "binned" bin.`}function cbt(e){return`Domain for ${e} is required for threshold scale.`}const Vve=g0t(Gme);let tb=Vve;function fbt(e){return tb=e,tb}function dbt(){return tb=Vve,tb}function He(...e){tb.warn(...e)}function hbt(...e){tb.debug(...e)}function nb(e){if(e&&ca(e)){for(const t of Q9)if(t in e)return!0}return!1}const qve=["january","february","march","april","may","june","july","august","september","october","november","december"],pbt=qve.map(e=>e.substr(0,3)),Hve=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],gbt=Hve.map(e=>e.substr(0,3));function mbt(e){if(B9(e)&&(e=+e),Ni(e))return e>4&&He(ON("quarter",e)),e-1;throw new Error(ON("quarter",e))}function vbt(e){if(B9(e)&&(e=+e),Ni(e))return e-1;{const t=e.toLowerCase(),n=qve.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=pbt.indexOf(r);if(i!==-1)return i;throw new Error(ON("month",e))}}function ybt(e){if(B9(e)&&(e=+e),Ni(e))return e%7;{const t=e.toLowerCase(),n=Hve.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=gbt.indexOf(r);if(i!==-1)return i;throw new Error(ON("day",e))}}function J9(e,t){const n=[];if(t&&e.day!==void 0&&Xe(e).length>1&&(He(abt(e)),e=gn(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?vbt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?mbt(e.quarter):e.quarter;n.push(Ni(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?ybt(e.day):e.day;n.push(Ni(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function __(e){const n=J9(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function bbt(e){const n=J9(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function xbt(e){const t=J9(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const Gve={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Q9=Xe(Gve);function wbt(e){return!!Gve[e]}function eU(e){return e.startsWith("utc")}function _bt(e){return e.substr(3)}const Sbt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function tU(e){const t=[];for(const n of Q9)Kve(e,n)&&t.push(n);return t}function Kve(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Ebt(e,t,{end:n}={end:!1}){const r=rve(t),i=eU(e)?"utc":"";function a(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const s={};for(const u of Q9)Kve(e,u)&&(s[u]=a(u),o=u);return n&&(s[o]+="+1"),bbt(s)}function Xve(e){if(!e)return;const t=tU(e);return`timeUnitSpecifier(${d_(t)}, ${d_(Sbt)})`}function Cbt(e,t,n){if(!e)return;const r=Xve(e);return`${n||eU(e)?"utc":"time"}Format(${t}, ${r})`}function Ro(e){if(!e)return;let t;return pn(e)?t={unit:e}:ca(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),eU(t.unit)&&(t.utc=!0,t.unit=_bt(t.unit)),t}function Abt(e){const t=Ro(e),{utc:n}=t,r=St(t,["utc"]);return r.unit?(n?"utc":"")+Xe(r).map(i=>Lr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Xe(r).map(i=>Lr(`_${i}_${r[i]}`)).join("")}function Bt(e){return e&&!!e.signal}function Sp(e){return!!e.step}function kbt(e){return Tt(e)?!1:"fields"in e&&!("data"in e)}function Tbt(e){return Tt(e)?!1:"fields"in e&&"data"in e}function Ep(e){return Tt(e)?!1:"field"in e&&"data"in e}const Obt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},Ibt=Xe(Obt),Nbt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},nU=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Dbt(e){return e==null?void 0:e.selection}function rU(e){return e&&!!e.field&&e.equal!==void 0}function Yve(e){return e&&!!e.field&&e.lt!==void 0}function Zve(e){return e&&!!e.field&&e.lte!==void 0}function Jve(e){return e&&!!e.field&&e.gt!==void 0}function Qve(e){return e&&!!e.field&&e.gte!==void 0}function iU(e){if(e&&e.field){if(Tt(e.range)&&e.range.length===2)return!0;if(Bt(e.range))return!0}return!1}function aU(e){return e&&!!e.field&&(Tt(e.oneOf)||Tt(e.in))}function Rbt(e){return e&&!!e.field&&e.valid!==void 0}function e0e(e){return aU(e)||rU(e)||iU(e)||Yve(e)||Jve(e)||Zve(e)||Qve(e)}function Yc(e,t){return SU(e,{timeUnit:t,wrapTime:!0})}function Fbt(e,t){return e.map(n=>Yc(n,t))}function t0e(e,t=!0){var n;const{field:r}=e,i=(n=Ro(e.timeUnit))===null||n===void 0?void 0:n.unit,a=i?"time("+Ebt(i,r)+")":Ye(e,{expr:"datum"});if(rU(e))return a+"==="+Yc(e.equal,i);if(Yve(e)){const o=e.lt;return`${a}<${Yc(o,i)}`}else if(Jve(e)){const o=e.gt;return`${a}>${Yc(o,i)}`}else if(Zve(e)){const o=e.lte;return`${a}<=${Yc(o,i)}`}else if(Qve(e)){const o=e.gte;return`${a}>=${Yc(o,i)}`}else{if(aU(e))return`indexof([${Fbt(e.oneOf,i).join(",")}], ${a}) !== -1`;if(Rbt(e))return oU(a,e.valid);if(iU(e)){const{range:o}=e,s=Bt(o)?{signal:`${o.signal}[0]`}:o[0],u=Bt(o)?{signal:`${o.signal}[1]`}:o[1];if(s!==null&&u!==null&&t)return"inrange("+a+", ["+Yc(s,i)+", "+Yc(u,i)+"])";const l=[];return s!==null&&l.push(`${a} >= ${Yc(s,i)}`),u!==null&&l.push(`${a} <= ${Yc(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function oU(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Mbt(e){var t;return e0e(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Ro(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const rb={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Pm=rb.quantitative,sU=rb.ordinal,ib=rb.temporal,uU=rb.nominal,ab=rb.geojson,Pbt=Xe(rb);function $bt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Pm:return"quantitative";case"t":case ib:return"temporal";case"o":case sU:return"ordinal";case"n":case uU:return"nominal";case ab:return"geojson"}}const Ri={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},lU={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},Lbt=Xe(lU);function Bbt(e,t){const n=lU[e],r=lU[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const zbt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function n0e(e){return zbt[e]}const r0e=["linear","log","pow","sqrt","symlog","time","utc"],jbt=Im(r0e),Ubt=["linear","log","pow","sqrt","symlog"],Wbt=Im(Ubt);function Vbt(e){return e in Wbt}const qbt=["quantile","quantize","threshold"],Hbt=Im(qbt),Gbt=r0e.concat(["quantile","quantize","threshold","sequential","identity"]),Kbt=Im(Gbt),Xbt=["ordinal","bin-ordinal","point","band"],Ybt=Im(Xbt);function ls(e){return e in Ybt}function ku(e){return e in Kbt}function Dl(e){return e in jbt}function IN(e){return e in Hbt}const Zbt={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function Jbt(e){return!pn(e)&&!!e.name}function i0e(e){return e==null?void 0:e.selection}function Qbt(e){return e&&e.unionWith}const e1t={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},t1t=St(e1t,["type","domain","range","scheme"]),n1t=Xe(t1t);r1t();function a0e(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!It(["point","band","identity"],e);case"bins":return!It(["point","band","identity","ordinal"],e);case"round":return Dl(e)||e==="band"||e==="point";case"padding":return Dl(e)||It(["point","band"],e);case"paddingOuter":case"align":return It(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Dl(e);case"nice":return Dl(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ku(e)&&!It(["log","time","utc","threshold","quantile"],e)}}function o0e(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return eb(e)?void 0:Uyt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function s0e(e,t){return It([sU,uU],t)?e===void 0||ls(e):t===ib?It([Ri.TIME,Ri.UTC,void 0],e):t===Pm?It([Ri.LOG,Ri.POW,Ri.SQRT,Ri.SYMLOG,Ri.QUANTILE,Ri.QUANTIZE,Ri.THRESHOLD,Ri.LINEAR,void 0],e):!0}function u0e(e,t){if(!_p(e))return!1;switch(e){case Gr:case Hi:case Il:case Uc:return Dl(t)||It(["band","point"],t);case pd:case yp:case gd:case mp:case vp:case Rm:return Dl(t)||IN(t)||It(["band","point","ordinal"],t);case ss:case qc:case Hc:return t!=="band";case bp:return t==="ordinal"||IN(t);case us:return t==="ordinal"}}function r1t(){var e;const t={};for(const n of wve)for(const r of Pbt)for(const i of Lbt){const a=i1t(n,r);u0e(n,i)&&s0e(i,r)&&(t[a]=(e=t[a])!==null&&e!==void 0?e:[],t[a].push(i))}return t}function i1t(e,t){return e+"_"+t}function cU(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:a}=e,o=c0e(e);return Qe(n)&&!mve(n.aggregate)&&i&&Dl(i.get("type"))&&i.get("zero")===!1?l0e({fieldDef:n,channel:t,markDef:r,ref:o,config:a}):o}function l0e({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Nm(n.type)||tr("invalid",n,i)===null?r:[a1t(e,t),r]}function a1t(e,t){const n=fU(e,!0),i=Mm(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function fU(e,t=!0){return oU(pn(e)?e:Ye(e,{expr:"datum"}),!t)}function o1t(e){const{datum:t}=e;return nb(t)?__(t):`${JSON.stringify(t)}`}function $m(e,t,n,r){const i={};if(t&&(i.scale=t),Ap(e)){const{datum:a}=e;nb(a)?i.signal=__(a):Bt(a)?i.signal=a.signal:i.value=a}else i.field=Ye(e,n);if(r){const{offset:a,band:o}=r;a&&(i.offset=a),o&&(i.band=o)}return i}function NN({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=Ye(t,{expr:o,suffix:i}),u=n!==void 0?Ye(n,{expr:o}):Ye(t,{suffix:"end",expr:o}),l={};if(a===0||a===1){l.scale=e;const c=a===0?s:u;l.field=c}else{const c=`${a} * ${s} + ${1-a} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function c0e({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l,band:c}){var f;if(t){if(Kt(t)){if(Vs(t)){c=c??C_({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:g}=t;if(Ar(h)||c&&p&&g===ib)return s&&s.impute?$m(t,a,{binSuffix:"mid"},{offset:u}):c?NN({scaleName:a,fieldOrDatumDef:t,band:c,offset:u}):$m(t,a,A_(t,e)?{binSuffix:"range"}:{},{offset:u});if(Do(h)){if(Qe(n))return NN({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});He(Wve(e===Gr?Ol:jc))}}const d=o==null?void 0:o.get("type");return $m(t,a,ls(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(md(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},S_(e,d)),h)}}return v0t(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function S_(e,t){return It(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:It(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:yi(t)}function Lm(e){return e&&e!=="number"&&e!=="time"}function f0e(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const s1t=" \u2013 ";function dU({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(Lm(n))return hU({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:a});const u=d0e(e,r,i);if(BN(e)){const l=l1t(u,Qe(e)?(o=Ro(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,a.timeFormat,bU(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===Ri.UTC);return l?{signal:l}:void 0}if(t=g0e(Cp(e),t,a),Qe(e)&&Ar(e.bin)){const l=Ye(e,{expr:r,binSuffix:"end"});return{signal:DN(u,l,t,n,a)}}else return t||Cp(e)==="quantitative"?{signal:`${m0e(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function d0e(e,t,n){return Qe(e)?n?`${Ye(e,{expr:t,suffix:"end"})}-${Ye(e,{expr:t,suffix:"start"})}`:Ye(e,{expr:t}):o1t(e)}function hU({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=o??d0e(e,r,i),Qe(e)&&Ar(e.bin)){const s=Ye(e,{expr:r,binSuffix:"end"});return{signal:DN(o,s,t,n,a)}}return{signal:f0e(n,o,t)}}function h0e(e,t,n,r,i,a){var o;if(!Lm(r)){if(BN(e)){const s=Qe(e)?(o=Ro(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return u1t(n,s,i,a)}return g0e(t,n,i)}}function p0e(e,t,n){if(e&&(Bt(e)||e==="number"||e==="time"))return e;if(BN(t)&&n!=="time"&&n!=="utc")return"time"}function g0e(e,t,n){if(pn(t))return t;if(e===Pm)return n.numberFormat}function u1t(e,t,n,r){return e||(t?{signal:Xve(t)}:r?void 0:n.timeFormat)}function m0e(e,t){return`format(${e}, "${t||""}")`}function v0e(e,t,n,r){var i;return Lm(n)?f0e(n,e,t):m0e(e,(i=pn(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function DN(e,t,n,r,i){const a=v0e(e,n,r,i),o=v0e(t,n,r,i);return`${oU(e,!1)} ? "null" : ${a} + "${s1t}" + ${o}`}function l1t(e,t,n,r,i){return!t||n?(n=pn(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):Cbt(t,e,i)}const RN="min",c1t={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function y0e(e){return e in c1t}function b0e(e){return!!e&&!!e.encoding}function Zc(e){return!!e&&(e.op==="count"||!!e.field)}function x0e(e){return!!e&&Tt(e)}function E_(e){return"row"in e||"column"in e}function pU(e){return!!e&&"header"in e}function FN(e){return"facet"in e}function f1t(e){return e.selection}function d1t(e){return e&&!pn(e)&&"repeat"in e}function w0e(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function _0e(e){return Vs(e)&&"sort"in e}function C_({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(Kt(t)&&t.band!==void 0)return t.band;if(Qe(t)){const{timeUnit:s,bin:u}=t;if(s&&!n)return o?jm("timeUnitBandPosition",r,a):dve(r.type)?jm("timeUnitBand",r,a):0;if(Ar(u))return dve(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function gU(e,t,n,r,i,a){return Ar(t.bin)||t.timeUnit&&Vs(t)&&t.type==="temporal"?!!C_({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a}):!1}function mU(e){return!!e&&"condition"in e}function MN(e){const t=e&&e.condition;return!!t&&!Tt(t)&&Qe(t)}function vU(e){const t=e&&e.condition;return!!t&&!Tt(t)&&Kt(t)}function h1t(e){const t=e&&e.condition;return!!t&&(Tt(t)||md(t))}function Qe(e){return!!e&&(!!e.field||e.aggregate==="count")}function Cp(e){return e&&e.type}function Ap(e){return!!e&&"datum"in e}function Jc(e){return Vs(e)&&A0e(e)||yU(e)}function yU(e){return Ap(e)&&Ni(e.datum)}function Kt(e){return Qe(e)||Ap(e)}function Vs(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function md(e){return e&&"value"in e&&"value"in e}function bU(e){return!!e&&("scale"in e||"sort"in e)}function xU(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function S0e(e){return!!e&&"legend"in e}function E0e(e){return!!e&&("format"in e||"formatType"in e)}function p1t(e){return"op"in e}function Ye(e,t={}){var n,r,i;let a=e.field;const o=t.prefix;let s=t.suffix,u="";if(g1t(e))a=T0t("count");else{let l;if(!t.nofn)if(p1t(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Ar(c)?(l=kve(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Dm(f)?(u=`["${a}"]`,a=`argmax_${f.argmax}`):gp(f)?(u=`["${a}"]`,a=`argmin_${f.argmin}`):l=String(f):d&&(l=Abt(d),s=(!It(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(a=a?`${l}_${a}`:l)}return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),t.forAs?ive(a):t.expr?E0t(a,t.expr)+u:pp(a)+u}function C0e(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Qe(e)&&!!e.bin;case"temporal":return!1}throw new Error($ve(e.type))}function A0e(e){return!C0e(e)}function g1t(e){return e.aggregate==="count"}function m1t(e,t){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ar(i))return`${r} (binned)`;if(a){const s=(n=Ro(a))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${tU(s).join("-")})`}else if(o)return Dm(o)?`${r} for max ${o.argmax}`:gp(o)?`${r} for min ${o.argmin}`:`${fN(o)} of ${r}`;return r}function v1t(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Dm(t))return`${i} for argmax(${t.argmax})`;if(gp(t))return`${i} for argmin(${t.argmin})`;const a=Ro(r),o=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||Ar(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const k0e=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return v1t(e);default:return m1t(e,t)}};let T0e=k0e;function O0e(e){T0e=e}function y1t(){O0e(k0e)}function Bm(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,a;const s=((i=wU(e))!==null&&i!==void 0?i:{}).title;if(!Qe(e))return s;const u=e,l=r?I0e(u,t):void 0;return n?Di(s,u.title,l):(a=s??u.title)!==null&&a!==void 0?a:l}function wU(e){if(xU(e)&&e.axis)return e.axis;if(S0e(e)&&e.legend)return e.legend;if(pU(e)&&e.header)return e.header}function I0e(e,t){return T0e(e,t)}function PN(e){var t;if(E0e(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=wU(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function b1t(e,t){if(e.timeUnit)return"temporal";if(Ar(e.bin))return"quantitative";switch(AN(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Qc(e){if(Qe(e))return e;if(MN(e))return e.condition}function Gi(e){if(Kt(e))return e;if(vU(e))return e.condition}function _U(e,t,n){if(pn(e)||Ni(e)||f_(e)){const r=pn(e)?"string":Ni(e)?"number":"boolean";return He(Nyt(t,r,e)),{value:e}}return Kt(e)?$N(e,t,n):vU(e)?Object.assign(Object.assign({},e),{condition:$N(e.condition,t,n)}):e}function $N(e,t,n){if(E0e(e)){const{format:r,formatType:i}=e,a=St(e,["format","formatType"]);if(Lm(i)&&!n.customFormatTypes)return He(Pve(t)),$N(a,t,n)}else{const r=xU(e)?"axis":S0e(e)?"legend":pU(e)?"header":null;if(r&&e[r]){const i=e[r],{format:a,formatType:o}=i,s=St(i,["format","formatType"]);if(Lm(o)&&!n.customFormatTypes)return He(Pve(t)),$N(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return Qe(e)?N0e(e,t):x1t(e)}function x1t(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Ni(n)?"quantitative":pn(n)?"nominal":nb(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function N0e(e,t){const{aggregate:n,timeUnit:r,bin:i,field:a}=e,o=Object.assign({},e);if(n&&!V9(n)&&!Dm(n)&&!gp(n)&&(He(Ryt(n)),delete o.aggregate),r&&(o.timeUnit=Ro(r)),a&&(o.field=`${a}`),Ar(i)&&(o.bin=LN(i,t)),Do(i)&&!Xc(t)&&He(`Channel ${t} should not be used with "binned" bin.`),Vs(o)){const{type:s}=o,u=$bt(s);s!==u&&(o.type=u),s!=="quantitative"&&mve(n)&&(He(Dyt(s,n)),o.type="quantitative")}else if(!Sve(t)){const s=b1t(o,t);He(Fyt(t,s)),o.type=s}if(Vs(o)){const{compatible:s,warning:u}=w1t(o,t);s||He(u)}if(_0e(o)&&pn(o.sort)){const{sort:s}=o;if(y0e(s))return Object.assign(Object.assign({},o),{sort:{encoding:s}});const u=s.substr(1);if(s.charAt(0)==="-"&&y0e(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(pU(o)){const{header:s}=o,{orient:u}=s,l=St(s,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:s.labelOrient||u,titleOrient:s.titleOrient||u})})}return o}function LN(e,t){return f_(e)?{maxbins:Tve(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:Tve(t)}):e}const zm={compatible:!0};function w1t(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case cd:case fd:case bN:return A0e(e)?{compatible:!1,warning:$yt(t)}:zm;case Gr:case Hi:case ss:case qc:case Hc:case y_:case x_:case xN:case Fm:case wN:case _N:case Rm:case Il:case Uc:case SN:return zm;case Vc:case Eu:case Wc:case Nl:return n!==Pm?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:zm;case gd:case mp:case vp:case yp:case pd:case hd:case dd:case Ol:case jc:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:zm;case bp:return It(["ordinal","nominal"],e.type)?zm:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case us:return It(["ordinal","nominal","geojson"],e.type)?zm:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case b_:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:zm}}function BN(e){const{formatType:t}=PN(e);return t==="time"||!t&&_1t(e)}function _1t(e){return e&&(e.type==="temporal"||Qe(e)&&!!e.timeUnit)}function SU(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=t&&((a=Ro(t))===null||a===void 0?void 0:a.unit);let s=o||n==="temporal",u;return Bt(e)?u=e.signal:nb(e)?(s=!0,u=__(e)):(pn(e)||Ni(e))&&s&&(u=`datetime(${JSON.stringify(e)})`,wbt(o)&&(Ni(e)&&e<1e4||pn(e)&&isNaN(Date.parse(e)))&&(u=__({[o]:e}))),u?r&&s?`time(${u})`:u:i?void 0:JSON.stringify(e)}function D0e(e,t){const{type:n}=e;return t.map(r=>{const i=SU(r,{timeUnit:Qe(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function A_(e,t){return Ar(e.bin)?_p(t)&&It(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function R0e(e){const{anchor:t,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=St(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),v=p_(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function kp(e){return pn(e)||Tt(e)&&pn(e[0])}function yi(e){return Bt(e)?e:e!==void 0?{value:e}:void 0}function F0e(e){return Bt(e)?e.signal:Mn(e.value)}function k_(e){return Bt(e)?e.signal:e==null?null:Mn(e)}function S1t(e,t,n){for(const r of n){const i=jm(r,t.markDef,t.config);i!==void 0&&(e[r]=yi(i))}return e}function M0e(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function tr(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:a&&(!i||i===e)?void 0:jm(e,t,n,r)}function jm(e,t,n,{vgChannel:r}={}){return Di(r?zN(e,t,n.style):void 0,zN(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function zN(e,t,n){return P0e(e,M0e(t),n)}function P0e(e,t,n){t=vi(t);let r;for(const i of t){const a=n[i];a&&a[e]!==void 0&&(r=a[e])}return r}function $0e(e,t){return vi(e).reduce((n,r)=>{var i;return n.field.push(Ye(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function L0e(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(h_(i,r))return;n.push(r)}),n}function B0e(e,t){return h_(e,t)||!t?e:e?[...vi(e),...vi(t)].join(", "):t}function z0e(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((kp(n)||Bt(n))&&(kp(r)||Bt(r)))return{explicit:e.explicit,value:B0e(n,r)};if(kp(n)||Bt(n))return{explicit:e.explicit,value:n};if(kp(r)||Bt(r))return{explicit:e.explicit,value:r};if(!kp(n)&&!Bt(n)&&!kp(r)&&!Bt(r))return{explicit:e.explicit,value:L0e(n,r)};throw new Error("It should never reach here")}function Um(e,t){const n=e&&e[t];return n?Tt(n)?g_(n,r=>!!r.field):Qe(n)||MN(n):!1}function EU(e){return g_(wve,t=>{if(Um(e,t)){const n=e[t];if(Tt(n))return g_(n,r=>!!r.aggregate);{const r=Qc(n);return r&&!!r.aggregate}}return!1})}function CU(e,t){const n=[],r=[],i=[],a=[],o={};return AU(e,(s,u)=>{if(Qe(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=St(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=wU(s),g=p&&p.title;let m=Ye(s,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:Bm(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Dm(c)?(y="argmax",m=Ye({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):gp(c)?(y="argmin",m=Ye({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),a.push(b)}}else if(n.push(m),Vs(s)&&Ar(f)){if(r.push({bin:f,field:l,as:m}),n.push(Ye(s,{binSuffix:"end"})),A_(s,u)&&n.push(Ye(s,{binSuffix:"range"})),Xc(u)){const y={field:m+"_end"};o[u+"2"]=y}v.bin="binned",Sve(u)||(v.type=Pm)}else if(d){i.push({timeUnit:d,field:l,as:m});const y=Vs(s)&&s.type!==ib&&"time";y&&(u===y_||u===Fm?v.formatType=y:fyt(u)?v.legend=Object.assign({formatType:y},v.legend):Xc(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}o[u]=v}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function E1t(e,t,n){const r=hyt(t,n);if(r){if(r==="binned"){const i=e[t===Ol?Gr:Hi];return!!(Qe(i)&&Qe(e[t])&&Do(i.bin))}}else return!1;return!0}function C1t(e,t,n){const r=t.type;return Xe(e).reduce((i,a)=>{if(!_ve(a))return He(Pyt(a)),i;const o=e[a];if(a==="angle"&&r==="arc"&&!e.theta&&(He(Iyt),a=Il),!E1t(e,a,r))return He(TN(a,r)),i;if(a===pd&&r==="line"){const s=Qc(e[a]);if(s==null?void 0:s.aggregate)return He(Myt),i}if(a===ss&&(t.filled?"fill"in e:"stroke"in e))return He(Lve("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(a===x_||a===b_&&!Tt(o)&&!md(o)||a===Fm&&Tt(o))o&&(i[a]=vi(o).reduce((s,u)=>(Qe(u)?s.push(N0e(u,a)):He(Y9(u,a)),s),[]));else{if(a===Fm&&o===null)i[a]=null;else if(!Qe(o)&&!Ap(o)&&!md(o)&&!mU(o)&&!Bt(o))return He(Y9(o,a)),i;i[a]=_U(o,a,n)}return i},{})}function A1t(e){const t=[];for(const n of Xe(e))if(Um(e,n)){const r=e[n],i=vi(r);for(const a of i)Qe(a)?t.push(a):MN(a)&&t.push(a.condition)}return t}function AU(e,t,n){if(!!e)for(const r of Xe(e)){const i=e[r];if(Tt(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function j0e(e,t,n,r){return e?Xe(e).reduce((i,a)=>{const o=e[a];return Tt(o)?o.reduce((s,u)=>t.call(r,s,u,a),i):t.call(r,i,o,a)},n):n}function U0e(e,t){return Xe(t).reduce((n,r)=>{switch(r){case Gr:case Hi:case wN:case SN:case _N:case Ol:case jc:case Il:case hd:case Uc:case dd:case Wc:case Vc:case Nl:case Eu:case y_:case us:case Rm:case Fm:return n;case b_:if(e==="line"||e==="trail")return n;case x_:case xN:{const i=t[r];if(Tt(i)||Qe(i))for(const a of vi(i))a.aggregate||n.push(Ye(a,{}));return n}case pd:if(e==="trail")return n;case ss:case qc:case Hc:case gd:case mp:case vp:case bp:case yp:{const i=Qc(t[r]);return i&&!i.aggregate&&n.push(Ye(i,{})),n}}},[])}function k1t(e){const{tooltip:t}=e,n=St(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(Tt(t)){for(const a of t)a.aggregate?(r||(r=[]),r.push(a)):(i||(i=[]),i.push(a));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return Tt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function kU(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:a,titlePrefix:o})=>{const s=r?` of ${t.field}`:"";return{field:a+t.field,type:t.type,title:Bt(o)?{signal:o+`"${escape(s)}"`}:o+s}}),...A1t(n)]}}function W0e(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:Di(n,r)}function TU(e,t,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=W0e(n);return V0e(e,s,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),a!==void 0?{scale:a}:{}),o!==void 0?{axis:o}:{})},pn(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function V0e(e,t,n,r,i){const{clip:a,color:o,opacity:s}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),zc(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),f_(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function q0e(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:jN(a,n),continuousAxisChannelDef2:jN(o,n),continuousAxisChannelDefError:jN(s,n),continuousAxisChannelDefError2:jN(u,n),continuousAxis:i}}function jN(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=St(e,["aggregate"]);return n!==t&&He(ubt(n,t)),r}else return e}function H0e(e,t){const{mark:n,encoding:r}=e,{x:i,y:a}=r;if(Jc(i)){if(Jc(a)){const o=Qe(i)&&i.aggregate,s=Qe(a)&&a.aggregate;if(!o&&s===t)return"vertical";if(!s&&o===t)return"horizontal";if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");return zc(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Jc(a))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const UN="boxplot",T1t=["box","median","outliers","rule","ticks"],O1t=new yN(UN,K0e);function G0e(e){return Ni(e)?"tukey":e}function K0e(e,{config:t}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=St(e,["mark","encoding","selection","projection"]),l=zc(i)?i:{type:i};o&&He(Rve("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=tr("size",l,t),d=G0e(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=I1t(e,c,t),{color:S,size:C}=y,_=St(y,["color","size"]),E=Y=>TU(l,g,p,Y,t.boxplot),A=E(_),k=E(y),T=E(Object.assign(Object.assign({},_),C?{size:C}:{})),I=kU([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),N={type:"tick",color:"black",opacity:1,orient:b,invalid:null},O=d==="min-max"?I:kU([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),D=[...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],P=[...d!=="tukey"?D:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:I}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ca(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:I})];let V;if(d!=="min-max"){const Y=`datum["lower_box_${p.field}"]`,X=`datum["upper_box_${p.field}"]`,Q=`(${X} - ${Y})`,me=`${Y} - ${c} * ${Q}`,ce=`${X} + ${c} * ${Q}`,Ne=`datum["${p.field}"]`,Oe={joinaggregate:X0e(p.field),groupby:m};let $e;d==="tukey"&&($e={transform:[{filter:`(${me} <= ${Ne}) && (${Ne} <= ${ce})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:D});const ve=St(_,["tooltip"]),{scale:$,axis:F}=p,q=W0e(p),ue=V0e(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Ne} < ${me}) || (${Ne} > ${ce})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},q!==void 0?{title:q}:{}),$!==void 0?{scale:$}:{}),F!==void 0?{axis:F}:{})},ve),w?{tooltip:w}:{})})[0];ue&&$e?V={transform:[Oe],layer:[ue,$e]}:ue?(V=ue,V.transform.unshift(Oe)):$e&&(V=$e,V.transform.unshift(Oe))}return V?Object.assign(Object.assign({},u),{layer:[V,{transform:h,layer:P}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:P})}function X0e(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function I1t(e,t,n){const r=H0e(e,UN),{continuousAxisChannelDef:i,continuousAxis:a}=q0e(e,r,UN),o=i.field,s=G0e(t),u=[...X0e(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(s==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(s==="min-max"?"upper_whisker_":"max_")+o}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=a;c[f];const d=St(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=k1t(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=CU(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...u],groupby:y},...l],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const OU="errorbar",N1t=["ticks","rule"],D1t=new yN(OU,Y0e);function Y0e(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:l}=Z0e(e,OU,t),c=TU(s,i,r,a,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function R1t(e,t){const{encoding:n}=e;if(F1t(n))return{orient:H0e(e,t),inputType:"raw"};const r=M1t(n),i=P1t(n),a=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(Kt(s)&&Kt(u))throw new Error(`${t} cannot have both x2 and y2`);if(Kt(s)){if(Jc(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(Kt(u)){if(Jc(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(Kt(u)&&!Kt(s))throw new Error(`${t} cannot have xError2 without xError`);if(Kt(c)&&!Kt(l))throw new Error(`${t} cannot have yError2 without yError`);if(Kt(s)&&Kt(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Kt(s)){if(Jc(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(Kt(l)){if(Jc(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function F1t(e){return(Kt(e.x)||Kt(e.y))&&!Kt(e.x2)&&!Kt(e.y2)&&!Kt(e.xError)&&!Kt(e.xError2)&&!Kt(e.yError)&&!Kt(e.yError2)}function M1t(e){return Kt(e.x2)||Kt(e.y2)}function P1t(e){return Kt(e.xError)||Kt(e.xError2)||Kt(e.yError)||Kt(e.yError2)}function Z0e(e,t,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=St(e,["mark","encoding","selection","projection"]),l=zc(i)?i:{type:i};o&&He(Rve(t));const{orient:c,inputType:f}=R1t(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=q0e(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=$1t(l,d,h,p,g,f,t,n),w=a,S=m;w[S];const C=m==="x"?"x2":"y2";w[C];const _=m==="x"?"xError":"yError";w[_];const E=m==="x"?"xError2":"yError2";w[E];const A=St(w,[typeof S=="symbol"?S:S+"",typeof C=="symbol"?C:C+"",typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+""]),{bins:k,timeUnits:T,aggregate:I,groupby:N,encoding:O}=CU(A,n),D=[...I,...v],P=f!=="raw"?[]:N,V=kU(b,d,O,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...k,...T,...D.length===0?[]:[{aggregate:D,groupby:P}],...y],groupby:P,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:V}}function $1t(e,t,n,r,i,a,o,s){let u=[],l=[];const c=t.field;let f,d=!1;if(a==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&He(sbt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:fN(h)},{fieldPrefix:"upper_",titlePrefix:J0e(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:J0e(h,p,"-")}],d=!0;else{e.center&&e.extent&&He(lbt(e.extent,o));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:Bm({field:c,aggregate:v,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Bm({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Bm({field:c,aggregate:g,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&He(obt(e.center,e.extent)),a==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):a==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Qy(Qy(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function J0e(e,t,n){return fN(e)+" "+n+" "+t}const IU="errorband",L1t=["band","borders"],B1t=new yN(IU,Q0e);function Q0e(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=Z0e(e,IU,t),l=o,c=TU(l,i,r,a,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?He(Uve("interpolate")):l.tension&&He(Uve("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const eye={};function NU(e,t,n){const r=new yN(e,t);eye[e]={normalizer:r,parts:n}}function z1t(){return Xe(eye)}NU(UN,K0e,T1t),NU(OU,Y0e,N1t),NU(IU,Q0e,L1t);const j1t=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],tye=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],U1t={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},W1t={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},V1t={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},ob="_vgsid_",q1t={single:{on:"click",fields:[ob],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[ob],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function DU(e){return!!e&&(e==="legend"||!!e.legend)}function RU(e){return DU(e)&&ca(e)}function H1t(e){return WN(e)||MU(e)||FU(e)}function FU(e){return"concat"in e}function WN(e){return"vconcat"in e}function MU(e){return"hconcat"in e}function ef(e){return ca(e)&&e.step!==void 0}function nye(e){return e.view||e.width||e.height}const rye=20,G1t={align:1,bounds:1,center:1,columns:1,spacing:1},K1t=Xe(G1t);function X1t(e,t,n){var r,i;const a=n[t],o={},{spacing:s,columns:u}=a;s!==void 0&&(o.spacing=s),u!==void 0&&(FN(e)&&!E_(e.facet)||FU(e))&&(o.columns=u),WN(e)&&(o.columns=1);for(const l of K1t)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Ni(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else o[l]=e[l];return o}function PU(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function VN(e,t){const n=T_(e,t);return ef(n)?n.step:$U}function T_(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Di(r,{step:e.step})}const $U=20,Y1t={continuousWidth:200,continuousHeight:200,step:$U},Z1t={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Y1t,mark:z0t,arc:{},area:{},bar:U0t,circle:{},geoshape:{},image:{},line:{},point:{},rect:W0t,rule:{color:"black"},square:{},text:{color:"black"},tick:V0t,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Zbt,projection:{},legend:W1t,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:q1t,style:{},title:{},facet:{spacing:rye},concat:{spacing:rye}},vd=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],iye={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},aye={blue:vd[0],orange:vd[1],red:vd[2],teal:vd[3],green:vd[4],yellow:vd[5],purple:vd[6],pink:vd[7],brown:vd[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function J1t(e={}){return{signals:[{name:"color",value:ca(e)?Object.assign(Object.assign({},aye),e):aye}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Q1t(e){return{signals:[{name:"fontSize",value:ca(e)?Object.assign(Object.assign({},iye),e):iye}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function ext(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function oye(e={}){const{color:t,font:n,fontSize:r}=e,i=St(e,["color","font","fontSize"]);return Xme({},Z1t,n?ext(n):{},t?J1t(t):{},r?Q1t(r):{},i||{})}const txt=["view",...hve],nxt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],rxt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},B0t);function ixt(e){e=gn(e);for(const t of nxt)delete e[t];if(e.axis)for(const t in e.axis)z9(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of j1t)delete e.legend[t];if(e.mark){for(const t of pve)delete e.mark[t];e.mark.tooltip&&ca(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of txt){for(const r of pve)delete e[t][r];const n=rxt[t];if(n)for(const r of n)delete e[t][r];oxt(e,t)}for(const t of z1t())delete e[t];axt(e);for(const t in e)ca(e[t])&&wr(e[t])&&delete e[t];return wr(e)?void 0:e}function axt(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=R0e(e.title);wr(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),wr(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),wr(r)?delete e.title:e.title=r}function oxt(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const a=Object.assign(Object.assign({},i),e.style[n??t]);wr(a)||(e.style[n??t]=a),r||delete e[t]}function qN(e){return"layer"in e}function sxt(e){return"repeat"in e}function uxt(e){return!Tt(e.repeat)&&e.repeat.layer}class sye{map(t,n){return FN(t)?this.mapFacet(t,n):sxt(t)?this.mapRepeat(t,n):MU(t)?this.mapHConcat(t,n):WN(t)?this.mapVConcat(t,n):FU(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(qN(t))return this.mapLayer(t,n);if(ld(t))return this.mapUnit(t,n);throw new Error(X9(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=St(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(a=>this.map(a,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const lxt={zero:1,center:1,normalize:1};function cxt(e){return e in lxt}const fxt=new Set([lve,pN,hN,vN,mN,U9,W9,gN,cve,j9]),dxt=new Set([pN,hN,lve]);function uye(e,t){var n,r;const i=t==="x"?"y":"radius",a=e[t],o=e[i];if(Qe(a)&&Qe(o))if(Cp(a)==="quantitative"&&Cp(o)==="quantitative"){if(a.stack)return t;if(o.stack)return i;const s=Qe(a)&&!!a.aggregate,u=Qe(o)&&!!o.aggregate;if(s!==u)return s?t:i;{const l=(n=a.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Cp(a)==="quantitative")return t;if(Cp(o)==="quantitative")return i}else{if(Cp(a)==="quantitative")return t;if(Cp(o)==="quantitative")return i}}function hxt(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function lye(e,t,n={}){const r=zc(e)?e.type:e;if(!fxt.has(r))return null;const i=uye(t,"x")||uye(t,"theta");if(!i)return null;const a=t[i],o=Qe(a)?Ye(a,{}):void 0;let s=hxt(i),u=t[s],l=Qe(u)?Ye(u,{}):void 0;l===o&&(l=void 0,u=void 0,s=void 0);const c=uyt.reduce((d,h)=>{if(h!=="tooltip"&&Um(t,h)){const p=t[h];for(const g of vi(p)){const m=Qc(g);if(m.aggregate)continue;const v=Ye(m,{});(!v||v!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(a.stack!==void 0?f_(a.stack)?f=a.stack?"zero":null:f=a.stack:c.length>0&&dxt.has(r)&&(f="zero"),!f||!cxt(f)||EU(t)&&c.length===0)return null;if(a.scale&&a.scale.type&&a.scale.type!==Ri.LINEAR){if(n.disallowNonLinearStack)return null;He(rbt(a.scale.type))}return Kt(t[Gc(i)])?(a.stack!==void 0&&He(nbt(i)),null):(Qe(a)&&a.aggregate&&!It(Y0t,a.aggregate)&&He(ibt(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:a.impute===null?!1:Nm(r),stackBy:c,offset:f})}function pxt(e){const t=St(e,["point","line"]);return Xe(t).length>1?t:t.type}function gxt(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:ud(e[t],["point","line"])}));return e}function LU(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ca(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ca(t.point)?t.point:{}:void 0}function cye(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class mxt{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(ld(t)){const{mark:r,encoding:i}=t,a=zc(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!LU(a,n[a.type],i);case"area":return!!LU(a,n[a.type],i)||!!cye(a,n[a.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:a,projection:o,encoding:s,mark:u}=t,l=St(t,["selection","projection","encoding","mark"]),c=zc(u)?u:{type:u},f=LU(c,i[c.type],s),d=c.type==="area"&&cye(c,i[c.type]),h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:pxt(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:ud(s,["shape"])})],p=lye(c,s);let g=s;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},s),{[m]:Object.assign(Object.assign({},s[m]),v?{stack:v}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},p_(c,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},p_(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:gxt(i)}))}}class vxt{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(ld(t)&&t.encoding)for(const r of Au){const i=t.encoding[r];if(i&&Kt(i)&&((n=i==null?void 0:i.scale)===null||n===void 0?void 0:n.rangeStep))return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const a of Au){const o=Kc(a),s=i[a];if(s&&Kt(s)&&((n=s==null?void 0:s.scale)===null||n===void 0?void 0:n.rangeStep)){const{scale:u}=s,l=St(s,["scale"]),c=u,f=St(c,["rangeStep"]);r[o]={step:u.rangeStep},He(jyt),i=Object.assign(Object.assign({},i),{[a]:Object.assign(Object.assign({},l),wr(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function yxt(e,t){return t?E_(e)?pye(e,t):fye(e,t):e}function BU(e,t){return t?pye(e,t):e}function zU(e,t,n){const r=t[e];if(d1t(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});He(Syt(r.repeat));return}return t}function fye(e,t){if(e=zU("field",e,t),e!==void 0){if(e===null)return null;if(_0e(e)&&Zc(e.sort)){const n=zU("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function dye(e,t){if(Qe(e))return fye(e,t);{const n=zU("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function hye(e,t){if(Kt(e)){const n=dye(e,t);if(n)return n;if(mU(e))return{condition:e.condition}}else{if(vU(e)){const n=dye(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):St(e,["condition"])}return e}}function pye(e,t){const n={};for(const r in e)if(Om(e,r)){const i=e[r];if(Tt(i))n[r]=i.map(a=>hye(a,t)).filter(a=>a);else{const a=hye(i,t);a!==void 0&&(n[r]=a)}}return n}class bxt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ld(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of oyt){const a=Mm(i),o=n[a];if(n[i]&&(Qe(o)&&!Do(o.bin)||Ap(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return He(Byt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class xxt extends sye{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[O1t,D1t,B1t,new mxt,new bxt,new vxt]}map(t,n){if(ld(t)){const r=Um(t.encoding,cd),i=Um(t.encoding,fd),a=Um(t.encoding,bN);if(r||i||a)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,a=Object.assign(Object.assign({},t),{encoding:BU(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,n.config))return s.run(a,n,o);return a}mapRepeat(t,n){return uxt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,a=St(t,["repeat","spec"]),{row:o,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},a),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${Lr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:a,data:o}=t,s=St(t,["repeat","spec","data"]);!Tt(i)&&t.columns&&(t=ud(t,["columns"]),He(Fve("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!Tt(i)&&i.row||[l?l.row:null],d=!Tt(i)&&i.column||[l?l.column:null],h=Tt(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(a.name||"")+c+"child__"+(Tt(i)?`${Lr(g)}`:(i.row?`row_${Lr(m)}`:"")+(i.column?`column_${Lr(v)}`:"")),x=this.map(a,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,u.push(ud(x,["data"]))}const p=Tt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=a.data)!==null&&r!==void 0?r:o,align:"all"},s),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return E_(r)&&t.columns&&(t=ud(t,["columns"]),He(Fve("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:a,parentProjection:o,config:s}=n,u=mye({parentProjection:o,projection:i}),l=gye({parentEncoding:a,encoding:BU(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:a,facet:o}=r,s=St(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,g=St(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:a,facet:o},n),y=BU(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:a,facet:o}=t;if(i||a){o&&He(Lyt([...i?[cd]:[],...a?[fd]:[]]));const s={},u={};for(const l of[cd,fd]){const c=t[l];if(c){const f=St(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=o,f=St(o,["align","center","spacing","columns"]);return{facetMapping:yxt(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,a=St(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,u=St(t,["encoding","projection"]),l=Object.assign(Object.assign({},a),{parentEncoding:gye({parentEncoding:r,encoding:o}),parentProjection:mye({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function gye(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Xe(t).reduce((a,o)=>(n[o]&&a.push(o),a),[]);i.length>0&&He(Tyt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return wr(r)?void 0:r}function mye(e){const{parentProjection:t,projection:n}=e;return t&&n&&He(Oyt({parentProjection:t,projection:n})),n??t}function vye(e,t){t===void 0&&(t=oye(e.config));const n=_xt(e,t),{width:r,height:i}=e,a=Sxt(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const wxt=new xxt;function _xt(e,t={}){return wxt.map(e,{config:t})}function yye(e){return pn(e)?{type:e}:e??{}}function Sxt(e,t,n){let{width:r,height:i}=t;const a=ld(e)||qN(e),o={};a?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(He(Ove("width")),r=void 0),i=="container"&&(He(Ove("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?yye(n.autosize):{}),yye(e.autosize));if(s.type==="fit"&&!a&&(He(myt),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&He(Ive("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&He(Ive("height")),!h_(s,{type:"pad"}))return s}function Ext(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Cxt(e){return e?`fit-${EN(e)}`:"fit"}const Axt=["background","padding"];function bye(e){return Axt.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class yd{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new yd(gn(this.explicit),gn(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Di(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Xe(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function Wm(e){return{explicit:!0,value:e}}function qs(e){return{explicit:!1,value:e}}function xye(e){return(t,n,r,i)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:HN(t,n,r,i)}}function HN(e,t,n,r){return e.explicit&&t.explicit&&He(Xyt(n,r,e.value,t.value)),e}function Tp(e,t,n,r,i=HN){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:h_(e.value,t.value)?e:i(e,t,n,r)}class kxt extends yd{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function O_(e){return"url"in e}function GN(e){return"values"in e}function wye(e){return"name"in e&&!O_(e)&&!GN(e)&&!Vm(e)}function Vm(e){return e&&(_ye(e)||Sye(e)||jU(e))}function _ye(e){return"sequence"in e}function Sye(e){return"sphere"in e}function jU(e){return"graticule"in e}const Ka="main",KN="raw";function Eye(e){return"filter"in e}function Txt(e){return(e==null?void 0:e.stop)!==void 0}function Oxt(e){return"lookup"in e}function Ixt(e){return"data"in e}function Nxt(e){return"selection"in e}function Dxt(e){return"pivot"in e}function Rxt(e){return"density"in e}function Fxt(e){return"quantile"in e}function Mxt(e){return"regression"in e}function Pxt(e){return"loess"in e}function $xt(e){return"sample"in e}function Lxt(e){return"window"in e}function Bxt(e){return"joinaggregate"in e}function zxt(e){return"flatten"in e}function jxt(e){return"calculate"in e}function Uxt(e){return"bin"in e}function Wxt(e){return"impute"in e}function Vxt(e){return"timeUnit"in e}function qxt(e){return"aggregate"in e}function Hxt(e){return"stack"in e}function Gxt(e){return"fold"in e}function Kxt(e){return e.map(t=>Eye(t)?{filter:lN(t.filter,Mbt)}:t)}function I_(e,t,n,r){const i=mU(t)&&t.condition,a=r(t);if(i){const s=vi(i).map(u=>{const l=r(u),c=f1t(u)?lbe(e,u.selection):oD(e,u.test);return Object.assign({test:c},l)});return{[n]:[...s,...a!==void 0?[a]:[]]}}else return a!==void 0?{[n]:a}:{}}function UU(e,t="text"){const n=e.encoding[t];return I_(e,n,t,r=>XN(r,e.config))}function XN(e,t,n="datum"){if(e){if(md(e))return yi(e.value);if(Kt(e)){const{format:r,formatType:i}=PN(e);return dU({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Cye(e,t={}){const{encoding:n,markDef:r,config:i,stack:a}=e,o=n.tooltip;if(Tt(o))return{tooltip:kye({tooltip:o},a,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return I_(e,o,"tooltip",u=>{const l=XN(u,i,s);if(l)return l;if(u===null)return;let c=tr("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),pn(c))return{value:c};if(ca(c))return c.content==="encoding"?kye(n,a,i,t):{signal:s}})}}function Aye(e,t,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(l,c){const f=Mm(c),d=Vs(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=vi(Bm(d,n,{allowDisabling:!1})).join(", ");let p;if(Xc(c)){const g=c==="x"?"x2":"y2",m=Qc(e[g]);if(Do(d.bin)&&m){const v=Ye(d,{expr:a}),y=Ye(m,{expr:a}),{format:b,formatType:x}=PN(d);p=DN(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=PN(d);p=dU({fieldOrDatumDef:d,format:v,formatType:y,expr:a,config:n,normalizeStack:!0}).signal}}p=p??XN(d,n,a).signal,o.push({channel:c,key:h,value:p})}AU(e,(l,c)=>{Qe(l)?s(l,c):MN(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[Mn(c)]=f);return u}function kye(e,t,n,{reactiveGeom:r}={}){const i=Aye(e,t,n,{reactiveGeom:r}),a=nve(i).map(({key:o,value:s})=>`${o}: ${s}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function Xxt(e){const{markDef:t,config:n}=e,r=tr("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),Yxt(e)),Zxt(e))}function Yxt(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=tr("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Nbt?{}:{ariaRoleDescription:{value:t}}}function Zxt(e){const{encoding:t,markDef:n,config:r,stack:i}=e,a=t.description;if(a)return I_(e,a,"description",u=>XN(u,e.config));const o=tr("description",n,r);if(o!=null)return{description:yi(o)};if(r.aria===!1)return{};const s=Aye(t,i,r);if(!wr(s))return{description:{signal:nve(s).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function fa(e,t,n={}){const{markDef:r,encoding:i,config:a}=t,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u=u??tr(e,r,a,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(s=yi(u)));const l=i[e];return I_(t,l,o??e,c=>c0e({channel:e,channelDef:c,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function Tye(e,t={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:tr("filled",o,u),f=It(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=tr(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(a=tr(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&a!==void 0?a:u.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:yi(d)}:{}),h?{stroke:yi(h)}:{});return o.color&&(c?o.fill:o.stroke)&&He(Lve("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),fa("color",e,{vgChannel:p,defaultValue:c?d:h})),fa("fill",e,{defaultValue:s.fill?d:void 0})),fa("stroke",e,{defaultValue:s.stroke?h:void 0}))}function N_(e,t){const n=syt(e),r=t[n];if(r)return r}function Xa(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=t,l=a[e],c=a[Gc(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=N_(e,o),p=WU({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!l&&Xc(e)&&(a.latitude||a.longitude)?{field:t.getName(e)}:Jxt({channel:e,channelDef:l,channel2Def:c,markDef:o,config:s,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[r||e]:g}:void 0}function Jxt(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=e;if(Kt(n)&&a&&t===a.fieldChannel){if(Qe(n)){const l=C_({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(l!==void 0)return NN({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return $m(n,i,{suffix:"end"},{offset:o})}return cU(e)}function WU({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=e;return()=>{const s=Mm(n),u=xp(n),l=tr(n,a,o,{vgChannel:u});if(l!==void 0)return S_(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!It([Ri.LOG,Ri.TIME,Ri.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Kc(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const Qxt={left:"x",center:"xc",right:"x2"},ewt={top:"y",middle:"yc",bottom:"y2"};function Oye(e,t,n,r="middle"){if(e==="radius"||e==="theta")return xp(e);const a=tr(e==="x"?"align":"baseline",t,n);return e==="x"?Qxt[a||(r==="top"?"left":"center")]:ewt[a||r]}function YN(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?Iye(e,t,{defaultPos:n,defaultPos2:r}):Xa(e,t,{defaultPos:n})}function Iye(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=t,o=Gc(e),s=Kc(e),u=twt(t,r,o),l=u[s]?Oye(e,i,a):xp(e);return Object.assign(Object.assign({},Xa(e,t,{defaultPos:n,vgChannel:l})),u)}function twt(e,t,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=e,u=Mm(n),l=Kc(n),c=xp(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in a?N_(n,e.markDef):N_(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=nwt({channel:n,channelDef:f,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:ZN(n,a)||ZN(n,{[n]:zN(n,a,s.style),[l]:zN(l,a,s.style)})||ZN(n,s[i])||ZN(n,s.mark)||{[c]:WU({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function nwt({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l}){return Kt(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?$m(t,a,{suffix:"start"},{offset:u}):cU({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function ZN(e,t){const n=Kc(e),r=xp(e);if(t[r]!==void 0)return{[r]:S_(e,t[r])};if(t[e]!==void 0)return{[r]:S_(e,t[e])};if(t[n])return{[n]:S_(e,t[n])}}function Op(e,t,n){var r,i,a,o;const{config:s,encoding:u,markDef:l,stack:c}=e,f=Gc(t),d=Kc(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=l.orient,b=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:tr("size",l,s,{vgChannel:d}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Qe(h)&&(Ar(h.bin)||Do(h.bin)||h.timeUnit&&!p)&&!b&&!ls(m)){const w=C_({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),S=(a=e.component.axes[t])===null||a===void 0?void 0:a[0],C=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return awt({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:v,band:w,axisTranslate:C,spacing:Xc(t)?tr("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(Kt(h)&&ls(m)||x)&&!p?iwt(n,h,t,e):Iye(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function rwt(e,t,n,r,i,a){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===Ri.POINT){const l=r.get("range");return Sp(l)&&Ni(l.step)?{value:l.step-2}:{value:$U-2}}else return{scale:n,band:a}}else return{value:i[e].continuousBandSize}}const o=VN(i.view,t),s=Di(i[e].discreteBandSize,o-2);return s!==void 0?{value:s}:void 0}function iwt(e,t,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,l=a.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=Kc(n),h=Gc(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",g=tr(p?"size":d,a,s,{vgChannel:d});let m;(o.size||g!==void 0)&&(p?m=fa("size",r,{vgChannel:d,defaultValue:g}):He(Hyt(a.type)));const v=(i=Kt(t)?C_({channel:n,fieldDef:t,markDef:a,stack:u,config:s}):void 0)!==null&&i!==void 0?i:1;m=m||{[d]:rwt(e,d,c,f,s,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),b=Oye(n,a,s,y?"middle":"top"),x=N_(n,a),w=cU({channel:n,channelDef:t,markDef:a,config:s,scaleName:c,scale:f,stack:u,offset:x,defaultRef:WU({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const S=xp(h),C=m[d],_=x?Object.assign(Object.assign({},C),{offset:x}):C;return{[b]:w,[S]:Tt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function D_(e,t,n,r,i){if(yve(e))return 0;const a=e==="x"||e==="y2"?-t/2:t/2;if(Bt(n)){const o=k_(i);return{signal:`${n.signal} ? ${r-a}${o?"-"+o:""} : ${r+a}${o?"+"+o:""}`}}else{if(Bt(i)){const o=r+(n?-a:a);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}}function awt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:l}){const c=Gc(n),f=xp(n),d=xp(c),h=N_(n,a);if(Ar(e.bin)||e.timeUnit)return{[d]:Nye({channel:n,fieldDef:e,scaleName:i,markDef:a,band:(1-r)/2,offset:D_(c,o,u,s,h),config:l}),[f]:Nye({channel:n,fieldDef:e,scaleName:i,markDef:a,band:1-(1-r)/2,offset:D_(n,o,u,s,h),config:l})};if(Do(e.bin)){const p=$m(e,i,{},{offset:D_(c,o,u,s,h)});if(Qe(t))return{[d]:p,[f]:$m(t,i,{},{offset:D_(n,o,u,s,h)})};if(w_(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Ye(e,{expr:"datum"})} + ${e.bin.step})`,offset:D_(n,o,u,s,h)}}}He(Wve(c))}function Nye({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:a,config:o}){const s=NN({scaleName:n,fieldOrDatumDef:t,band:i,offset:a});return l0e({fieldDef:t,channel:e,markDef:r,ref:s,config:o})}const owt=new Set(["aria"]);function Tu(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Tye(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},swt(e.markDef,t)),Dye(e,"fill",n)),Dye(e,"stroke",r)),fa("opacity",e)),fa("fillOpacity",e)),fa("strokeOpacity",e)),fa("strokeWidth",e)),fa("strokeDash",e)),Cye(e)),UU(e,"href")),Xxt(e))}function Dye(e,t,n){const{config:r,mark:i,markDef:a}=e;if(tr("invalid",a,r)==="hide"&&n&&!Nm(i)){const s=uwt(e,{invalid:!0,channels:CN});if(s)return{[t]:[{test:s,value:null},...vi(n)]}}return n?{[t]:n}:{}}function swt(e,t){return Ibt.reduce((n,r)=>(!owt.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=yi(e[r])),n),{})}function uwt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&ku(u)&&(a[l]=!0)}return a},{}),i=Xe(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>fU(o,t)).join(` ${a} `)}}function VU(e){const{config:t,markDef:n}=e;if(tr("invalid",n,t)){const i=lwt(e,{channels:Au});if(i)return{defined:{signal:i}}}return{}}function lwt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&ku(u)&&(a[l]=!0)}return a},{}),i=Xe(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>fU(o,t)).join(` ${a} `)}}function Rye(e,t){if(t!==void 0)return{[e]:yi(t)}}const qU="voronoi",Fye={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(qU)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,a=e.mark;if(Nm(a))return He(yyt(a)),n;const o={name:e.getName(qU),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Cye(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(qU)>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class pr{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class Fo extends pr{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${k0t()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class tf extends pr{constructor(t,n){super(t);this.formula=n}clone(){return new tf(null,gn(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{const{field:s,timeUnit:u}=a,l=oi(n)?n.encoding[Gc(o)]:void 0,c=oi(n)&&gU(o,a,l,n.stack,n.markDef,n.config);if(u){const f=Ye(a,{forAs:!0});i[$n({as:f,field:s,timeUnit:u})]=Object.assign({as:f,field:s,timeUnit:u},c?{band:!0}:{})}return i},{});return wr(r)?null:new tf(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,a=St(r,["timeUnit"]),o=Ro(i),s=Object.assign(Object.assign({},a),{timeUnit:o});return new tf(t,{[$n(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(hp(this.formula).map(t=>t.as))}dependentFields(){return new Set(hp(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${$n(this.formula)}`}assemble(){const t=[];for(const n of hp(this.formula)){const{field:r,as:i,timeUnit:a}=n,o=Ro(a),{unit:s,utc:u}=o,l=St(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:pp(r),type:"timeunit"},s?{units:tU(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const R_="_tuple_fields";class cwt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const fwt={has:()=>!0,parse:(e,t,n)=>{var r,i,a;const o=t.name,s=(r=t.project)!==null&&r!==void 0?r:t.project=new cwt,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let g=Lr(`${o}_${p}`);for(let m=1;c.has(g);m++)g=Lr(`${o}_${p}_${m}`);return c.add(g),{[h]:g}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of vi(n.init))for(const p of Xe(h))ayt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(He('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),s.items.push(h),s.hasField[d]=h}for(const d of(a=n.encodings)!==null&&a!==void 0?a:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){He(vyt(d,h.aggregate));continue}else if(!p){He(Dve(d));continue}if(h.timeUnit){p=e.vgField(d);const g={timeUnit:h.timeUnit,as:p,field:h.field};l[$n(g)]=g}if(!u[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(d).get("type");ku(v)&&(g="R")}else h.bin&&(g="R-RE");const m={field:p,channel:d,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),s.items.push(u[p]=m),s.hasField[p]=s.hasChannel[d]=u[p]}}else He(Dve(d))}if(n.init){const d=h=>s.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=vi(n.init);t.init=h.map(d)}}wr(l)||(s.timeUnit=new tf(null,l))},signals:(e,t,n)=>{const r=t.name+R_;return n.filter(a=>a.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(a=>{const o=St(a,["signals","hasLegend"]);return o.field=pp(o.field),o})})}},Mye={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!DU(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],s=Fye.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=Lr(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:sb(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${Mn(u.field)}] : null`}]:[],bind:(f=(c=a[u.field])!==null&&c!==void 0?c:a[u.channel])!==null&&f!==void 0?f:a}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.filter(l=>l.name===r+nf)[0],o=r+R_,s=i.items.map(l=>Lr(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}},JN="_toggle",Pye={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+JN,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+nf,r=t.name+JN;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${bd(e)}}, `)+`${r} ? ${n} : null`}},dwt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=pn(n.clear)?cp(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Mye.has(t))for(const r of t.project.items){const i=n.findIndex(a=>a.name===Lr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,a){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const i of t.project.items){const a=n.findIndex(o=>o.name===i.signals.visual);if(r(a,"[0, 0]"),a===-1){const o=n.findIndex(s=>s.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(a=>a.name===t.name+nf);r(i,"null"),Pye.has(t)&&(i=n.findIndex(a=>a.name===t.name+JN),r(i,"false"))}return n}},Ip={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!_p(i))continue;const a=e.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!ku(o)){He(xyt);continue}const s={selection:t.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(s=>s.name===o.signals.data).length===0);if(!e.parent||GU(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let a=i.update;if(a.indexOf(Gye)>=0)i.update=`{${r.map(o=>`${Mn(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const s=`${Mn(o.field)}: ${o.signals.data}`;a.indexOf(s)<0&&(a=`${a.substring(0,a.length-1)}, ${s}}`)}i.update=a}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!GU(e))for(const r of t.scales){const i=n.filter(a=>a.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function HU(e,t){return`domain(${Mn(e.scaleName(t))})`}function GU(e){var t;return e.parent&&mb(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:GU(e.parent.parent))}const $ye={has:e=>{const t=e.resolve==="global"&&e.bind&&DU(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==ob;return t&&!n&&He(wyt),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=vi((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(s)<0&&u.filter.push(s)}const a=RU(t.bind)?t.bind.legend:"click",o=pn(a)?cp(a,"view"):vi(a);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=RU(t.bind)&&t.bind.legend,a=o=>s=>{const u=gn(s);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${Lr(o.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(a(`${s}_symbols`)).concat(i.merge.map(a(`${s}_labels`))).concat(i.merge.map(a(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.find(d=>d.name===r+nf),o=r+R_,s=i.items.filter(d=>d.hasLegend).map(d=>Lr(`${r}_${Lr(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?a.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(a.update=l,delete a.value,delete a.on);const c=n.find(d=>d.name===r+JN),f=RU(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function hwt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;Hm(e,a=>{var o,s;const u=(o=a.project.hasField[i])!==null&&o!==void 0?o:a.project.hasChannel[t];if(u&&$ye.has(a)){const l=(s=n.get("selections"))!==null&&s!==void 0?s:[];l.push(a.name),n.set("selections",l,!1),u.hasLegend=!0}})}const Lye="_translate_anchor",Bye="_translate_delta",pwt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Ip.has(t),a=r+Lye,{x:o,y:s}=t.project.hasChannel;let u=cp(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+F_,l))),n.push({name:a,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?HU(e,Gr):`slice(${o.signals.visual})`):"")+(s!==void 0?", extent_y: "+(i?HU(e,Hi):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+Bye,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),o!==void 0&&zye(e,t,o,"width",n),s!==void 0&&zye(e,t,s,"height",n),n}};function zye(e,t,n,r,i){var a;const o=t.name,s=o+Lye,u=o+Bye,l=n.channel,c=Ip.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),g=c&&l===Gr?"-":"",m=`${s}.extent_${l}`,v=`${g}${u}.${l} / `+(c?`${d}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(a=h.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";f.on.push({events:{signal:u},update:c?b:`clampRange(${b}, 0, ${d})`})}const jye="_zoom_anchor",Uye="_zoom_delta",gwt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Ip.has(t),a=r+Uye,{x:o,y:s}=t.project.hasChannel,u=Mn(e.scaleName(Gr)),l=Mn(e.scaleName(Hi));let c=cp(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+F_,f))),n.push({name:r+jye,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&Wye(e,t,o,"width",n),s!==void 0&&Wye(e,t,s,"height",n),n}};function Wye(e,t,n,r,i){var a;const o=t.name,s=n.channel,u=Ip.has(t),l=i.filter(y=>y.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?HU(e,s):l.name,p=o+Uye,g=`${o}${jye}.${s}`,v=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${g}, ${p}`+(u&&d==="pow"?`, ${(a=f.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";l.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${c})`})}const mwt=[fwt,Pye,Ip,$ye,pwt,gwt,Mye,Fye,dwt];function QN(e,t){for(const n of mwt)n.has(e)&&t(n)}function sb(e,t=!0,n=c0t){if(Tt(e)){const r=e.map(i=>sb(i,t,n));return t?`[${r.join(", ")}]`:r}else if(nb(e))return n(t?__(e):xbt(e));return t?n(JSON.stringify(e)):e}function vwt(e,t){return Hm(e,(n,r)=>{const i=n.name;let a=r.modifyExpr(e,n);t.push(...r.signals(e,n)),QN(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(a=o.modifyExpr(e,n,a))}),t.push({name:i+kwt,on:[{events:{signal:n.name+nf},update:`modify(${Mn(n.name+qm)}, ${a})`}]})}),KU(t)}function ywt(e,t){if(e.component.selection&&Xe(e.component.selection).length){const n=Mn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:cp("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return KU(t)}function bwt(e,t){let n=!1;return Hm(e,(r,i)=>{const a=r.name,o=Mn(a+qm);if(t.filter(u=>u.name===a).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${Gye}(${o}, ${Mn(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),QN(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),KU(t)}function xwt(e,t){const n=[...t];return Hm(e,r=>{const i={name:r.name+qm};if(r.init){const o=r.project.items.map(u=>St(u,["signals"])),s=r.init.map(u=>sb(u,!1));i.values=r.type==="interval"?[{unit:bd(e,{escape:!1}),fields:o,values:s}]:s.map(u=>({unit:bd(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+qm).length||n.push(i)}),n}function Vye(e,t){return Hm(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,QN(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function wwt(e,t){for(const n of e.children)oi(n)&&(t=Vye(n,t));return t}function _wt(e,t){const n=t.selection,r=e.getSelectionComponent(n,Lr(n));return{signal:cbe(r,t)}}function KU(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const F_="_brush",XU="_scale_trigger",Swt={signals:(e,t)=>{const n=t.name,r=n+R_,i=Ip.has(t),a=[],o=[],s=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${Mn(n+F_)}`;qye(t,(f,d)=>{var h;const p=vi((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==Gr&&d!==Hi){He("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=Ewt(e,t,c,h),g=c.signals.data,m=c.signals.visual,v=Mn(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),b=ku(y)?"+":"";a.push(...p),o.push(g),s.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||a.push({name:n+XU,value:{},on:[{events:s.map(c=>({scale:c.scaleName})),update:s.map(c=>c.expr).join(" && ")+` ? ${n+XU} : {}`}]});const u=t.init,l=`unit: ${bd(e)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+nf},u?{init:`{${l}: ${sb(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+nf+", "+(t.resolve==="global"?"true":`{unit: ${bd(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:a}=t.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${Mn(t.name+qm)})`;if(Ip.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:a!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Xe(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${bd(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=St(c,["fill","fillOpacity","cursor"]),g=Xe(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,a!==void 0&&`${s}[0] !== ${s}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+F_+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+F_,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function Ewt(e,t,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=Ip.has(t),u=Mn(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===Gr?"width":"height").signal,h=`${i}(unit)`,p=qye(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${a}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+XU},update:ku(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:sb(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:sb(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}function qye(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(He(`${r} is not an ordered event stream for interval selections.`),n),[])}function Hye(e,t){const n=t.name,r=n+R_,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${a}[${Mn(e.vgField(l.channel,{}))}], ${a}[${Mn(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${a}[${Mn(l.field)}]`}).join(", "),s=`unit: ${bd(e)}, fields: ${r}, values`,u=t.events;return[{name:n+nf,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const Cwt={signals:Hye,modifyExpr:(e,t)=>t.name+nf+", "+(t.resolve==="global"?"null":`{unit: ${bd(e)}}`)},Awt={signals:Hye,modifyExpr:(e,t)=>t.name+nf+", "+(t.resolve==="global"?"true":`{unit: ${bd(e)}}`)},qm="_store",nf="_tuple",kwt="_modify",Gye="vlSelectionResolve",Twt={single:Awt,multi:Cwt,interval:Swt};function Hm(e,t){const n=e.component.selection;if(n){for(const r of hp(n))if(t(r,Twt[r.type])===!0)break}}function Owt(e){let t=e.parent;for(;t&&!Pl(t);)t=t.parent;return t}function bd(e,{escape:t}={escape:!0}){let n=t?Mn(e.name):e.name;const r=Owt(e);if(r){const{facet:i}=r;for(const a of Cu)i[a]&&(n+=` + '__facet_${a}_' + (facet[${Mn(r.vgField(a))}])`)}return n}function YU(e){let t=!1;return Hm(e,n=>{t=t||n.project.items.some(r=>r.field===ob)}),t}const Iwt="RawCode",Nwt="Literal",Dwt="Property",Rwt="Identifier",Fwt="ArrayExpression",Mwt="BinaryExpression",Pwt="CallExpression",$wt="ConditionalExpression",Lwt="LogicalExpression",Bwt="MemberExpression",zwt="ObjectExpression",jwt="UnaryExpression";function Rl(e){this.type=e}Rl.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Uwt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Uwt(e){switch(e.type){case Fwt:return e.elements;case Mwt:case Lwt:return[e.left,e.right];case Pwt:return[e.callee].concat(e.arguments);case $wt:return[e.test,e.consequent,e.alternate];case Bwt:return[e.object,e.property];case zwt:return e.properties;case Dwt:return[e.key,e.value];case jwt:return[e.argument];case Rwt:case Nwt:case Iwt:default:return[]}}var rf,mt,Te,Ya,fr,eD=1,M_=2,Gm=3,Np=4,tD=5,Km=6,cs=7,P_=8,Wwt=9;rf={},rf[eD]="Boolean",rf[M_]="<end>",rf[Gm]="Identifier",rf[Np]="Keyword",rf[tD]="Null",rf[Km]="Numeric",rf[cs]="Punctuator",rf[P_]="String",rf[Wwt]="RegularExpression";var Vwt="ArrayExpression",qwt="BinaryExpression",Hwt="CallExpression",Gwt="ConditionalExpression",Kye="Identifier",Kwt="Literal",Xwt="LogicalExpression",Ywt="MemberExpression",Zwt="ObjectExpression",Jwt="Property",Qwt="UnaryExpression",Ta="Unexpected token %0",e2t="Unexpected number",t2t="Unexpected string",n2t="Unexpected identifier",r2t="Unexpected reserved word",i2t="Unexpected end of input",ZU="Invalid regular expression",JU="Invalid regular expression: missing /",Xye="Octal literals are not allowed in strict mode.",a2t="Duplicate data property in object literal not allowed in strict mode",Za="ILLEGAL",$_="Disabled.",o2t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),s2t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function nD(e,t){if(!e)throw new Error("ASSERT: "+t)}function xd(e){return e>=48&&e<=57}function QU(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function L_(e){return"01234567".indexOf(e)>=0}function u2t(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function B_(e){return e===10||e===13||e===8232||e===8233}function z_(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&o2t.test(String.fromCharCode(e))}function rD(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&s2t.test(String.fromCharCode(e))}var l2t={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Yye(){for(var e;Te<Ya&&(e=mt.charCodeAt(Te),u2t(e)||B_(e));)++Te}function e7(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)Te<Ya&&QU(mt[Te])?(r=mt[Te++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Zn({},Ta,Za);return String.fromCharCode(i)}function c2t(){var e,t,n,r;for(e=mt[Te],t=0,e==="}"&&Zn({},Ta,Za);Te<Ya&&(e=mt[Te++],!!QU(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Zn({},Ta,Za),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Zye(){var e,t;for(e=mt.charCodeAt(Te++),t=String.fromCharCode(e),e===92&&(mt.charCodeAt(Te)!==117&&Zn({},Ta,Za),++Te,e=e7("u"),(!e||e==="\\"||!z_(e.charCodeAt(0)))&&Zn({},Ta,Za),t=e);Te<Ya&&(e=mt.charCodeAt(Te),!!rD(e));)++Te,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),mt.charCodeAt(Te)!==117&&Zn({},Ta,Za),++Te,e=e7("u"),(!e||e==="\\"||!rD(e.charCodeAt(0)))&&Zn({},Ta,Za),t+=e);return t}function f2t(){var e,t;for(e=Te++;Te<Ya;){if(t=mt.charCodeAt(Te),t===92)return Te=e,Zye();if(rD(t))++Te;else break}return mt.slice(e,Te)}function d2t(){var e,t,n;return e=Te,t=mt.charCodeAt(Te)===92?Zye():f2t(),t.length===1?n=Gm:l2t.hasOwnProperty(t)?n=Np:t==="null"?n=tD:t==="true"||t==="false"?n=eD:n=Gm,{type:n,value:t,start:e,end:Te}}function t7(){var e=Te,t=mt.charCodeAt(Te),n,r=mt[Te],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Te,{type:cs,value:String.fromCharCode(t),start:e,end:Te};default:if(n=mt.charCodeAt(Te+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Te+=2,{type:cs,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Te};case 33:case 61:return Te+=2,mt.charCodeAt(Te)===61&&++Te,{type:cs,value:mt.slice(e,Te),start:e,end:Te}}}if(o=mt.substr(Te,4),o===">>>=")return Te+=4,{type:cs,value:o,start:e,end:Te};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return Te+=3,{type:cs,value:a,start:e,end:Te};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return Te+=2,{type:cs,value:i,start:e,end:Te};if("<>=!+-*%&|^/".indexOf(r)>=0)return++Te,{type:cs,value:r,start:e,end:Te};Zn({},Ta,Za)}function h2t(e){for(var t="";Te<Ya&&QU(mt[Te]);)t+=mt[Te++];return t.length===0&&Zn({},Ta,Za),z_(mt.charCodeAt(Te))&&Zn({},Ta,Za),{type:Km,value:parseInt("0x"+t,16),start:e,end:Te}}function p2t(e){for(var t="0"+mt[Te++];Te<Ya&&L_(mt[Te]);)t+=mt[Te++];return(z_(mt.charCodeAt(Te))||xd(mt.charCodeAt(Te)))&&Zn({},Ta,Za),{type:Km,value:parseInt(t,8),octal:!0,start:e,end:Te}}function Jye(){var e,t,n;if(n=mt[Te],nD(xd(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=Te,e="",n!=="."){if(e=mt[Te++],n=mt[Te],e==="0"){if(n==="x"||n==="X")return++Te,h2t(t);if(L_(n))return p2t(t);n&&xd(n.charCodeAt(0))&&Zn({},Ta,Za)}for(;xd(mt.charCodeAt(Te));)e+=mt[Te++];n=mt[Te]}if(n==="."){for(e+=mt[Te++];xd(mt.charCodeAt(Te));)e+=mt[Te++];n=mt[Te]}if(n==="e"||n==="E")if(e+=mt[Te++],n=mt[Te],(n==="+"||n==="-")&&(e+=mt[Te++]),xd(mt.charCodeAt(Te)))for(;xd(mt.charCodeAt(Te));)e+=mt[Te++];else Zn({},Ta,Za);return z_(mt.charCodeAt(Te))&&Zn({},Ta,Za),{type:Km,value:parseFloat(e),start:t,end:Te}}function g2t(){var e="",t,n,r,i,a=!1;for(t=mt[Te],nD(t==="'"||t==='"',"String literal must starts with a quote"),n=Te,++Te;Te<Ya;)if(r=mt[Te++],r===t){t="";break}else if(r==="\\")if(r=mt[Te++],!r||!B_(r.charCodeAt(0)))switch(r){case"u":case"x":mt[Te]==="{"?(++Te,e+=c2t()):e+=e7(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:L_(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),Te<Ya&&L_(mt[Te])&&(a=!0,i=i*8+"01234567".indexOf(mt[Te++]),"0123".indexOf(r)>=0&&Te<Ya&&L_(mt[Te])&&(i=i*8+"01234567".indexOf(mt[Te++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&mt[Te]===`
`&&++Te;else{if(B_(r.charCodeAt(0)))break;e+=r}return t!==""&&Zn({},Ta,Za),{type:P_,value:e,octal:a,start:n,end:Te}}function m2t(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";Zn({},ZU)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Zn({},ZU)}try{return new RegExp(e,t)}catch(r){return null}}function v2t(){var e,t,n,r,i;for(e=mt[Te],nD(e==="/","Regular expression literal must start with a slash"),t=mt[Te++],n=!1,r=!1;Te<Ya;)if(e=mt[Te++],t+=e,e==="\\")e=mt[Te++],B_(e.charCodeAt(0))&&Zn({},JU),t+=e;else if(B_(e.charCodeAt(0)))Zn({},JU);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Zn({},JU),i=t.substr(1,t.length-2),{value:i,literal:t}}function y2t(){var e,t,n;for(t="",n="";Te<Ya&&(e=mt[Te],!!rD(e.charCodeAt(0)));)++Te,e==="\\"&&Te<Ya?Zn({},Ta,Za):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Zn({},ZU,n),{value:n,literal:t}}function b2t(){var e,t,n,r;return fr=null,Yye(),e=Te,t=v2t(),n=y2t(),r=m2t(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Te}}function x2t(e){return e.type===Gm||e.type===Np||e.type===eD||e.type===tD}function Qye(){var e;return Yye(),Te>=Ya?{type:M_,start:Te,end:Te}:(e=mt.charCodeAt(Te),z_(e)?d2t():e===40||e===41||e===59?t7():e===39||e===34?g2t():e===46?xd(mt.charCodeAt(Te+1))?Jye():t7():xd(e)?Jye():t7())}function fs(){var e;return e=fr,Te=e.end,fr=Qye(),Te=e.end,e}function ebe(){var e;e=Te,fr=Qye(),Te=e}function w2t(e){var t=new Rl(Vwt);return t.elements=e,t}function tbe(e,t,n){var r=new Rl(e==="||"||e==="&&"?Xwt:qwt);return r.operator=e,r.left=t,r.right=n,r}function _2t(e,t){var n=new Rl(Hwt);return n.callee=e,n.arguments=t,n}function S2t(e,t,n){var r=new Rl(Gwt);return r.test=e,r.consequent=t,r.alternate=n,r}function n7(e){var t=new Rl(Kye);return t.name=e,t}function j_(e){var t=new Rl(Kwt);return t.value=e.value,t.raw=mt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function nbe(e,t,n){var r=new Rl(Ywt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function E2t(e){var t=new Rl(Zwt);return t.properties=e,t}function rbe(e,t,n){var r=new Rl(Jwt);return r.key=t,r.value=n,r.kind=e,r}function C2t(e,t){var n=new Rl(Qwt);return n.operator=e,n.argument=t,n.prefix=!0,n}function Zn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(a,o){return nD(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=Te,n.description=i,n}function iD(e){e.type===M_&&Zn(e,i2t),e.type===Km&&Zn(e,e2t),e.type===P_&&Zn(e,t2t),e.type===Gm&&Zn(e,n2t),e.type===Np&&Zn(e,r2t),Zn(e,Ta,e.value)}function Ja(e){var t=fs();(t.type!==cs||t.value!==e)&&iD(t)}function Dr(e){return fr.type===cs&&fr.value===e}function r7(e){return fr.type===Np&&fr.value===e}function A2t(){var e=[];for(Te=fr.start,Ja("[");!Dr("]");)Dr(",")?(fs(),e.push(null)):(e.push(Xm()),Dr("]")||Ja(","));return fs(),w2t(e)}function ibe(){var e;return Te=fr.start,e=fs(),e.type===P_||e.type===Km?(e.octal&&Zn(e,Xye),j_(e)):n7(e.value)}function k2t(){var e,t,n,r;if(Te=fr.start,e=fr,e.type===Gm)return n=ibe(),Ja(":"),r=Xm(),rbe("init",n,r);if(e.type===M_||e.type===cs)iD(e);else return t=ibe(),Ja(":"),r=Xm(),rbe("init",t,r)}function T2t(){var e=[],t,n,r,i={},a=String;for(Te=fr.start,Ja("{");!Dr("}");)t=k2t(),t.key.type===Kye?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Zn({},a2t):i[r]=!0,e.push(t),Dr("}")||Ja(",");return Ja("}"),E2t(e)}function O2t(){var e;return Ja("("),e=i7(),Ja(")"),e}var I2t={if:1};function N2t(){var e,t,n;if(Dr("("))return O2t();if(Dr("["))return A2t();if(Dr("{"))return T2t();if(e=fr.type,Te=fr.start,e===Gm||I2t[fr.value])n=n7(fs().value);else if(e===P_||e===Km)fr.octal&&Zn(fr,Xye),n=j_(fs());else{if(e===Np)throw new Error($_);e===eD?(t=fs(),t.value=t.value==="true",n=j_(t)):e===tD?(t=fs(),t.value=null,n=j_(t)):Dr("/")||Dr("/=")?(n=j_(b2t()),ebe()):iD(fs())}return n}function D2t(){var e=[];if(Ja("("),!Dr(")"))for(;Te<Ya&&(e.push(Xm()),!Dr(")"));)Ja(",");return Ja(")"),e}function R2t(){var e;return Te=fr.start,e=fs(),x2t(e)||iD(e),n7(e.value)}function F2t(){return Ja("."),R2t()}function M2t(){var e;return Ja("["),e=i7(),Ja("]"),e}function P2t(){var e,t,n;for(e=N2t();;)if(Dr("."))n=F2t(),e=nbe(".",e,n);else if(Dr("("))t=D2t(),e=_2t(e,t);else if(Dr("["))n=M2t(),e=nbe("[",e,n);else break;return e}function abe(){var e=P2t();if(fr.type===cs&&(Dr("++")||Dr("--")))throw new Error($_);return e}function aD(){var e,t;if(fr.type!==cs&&fr.type!==Np)t=abe();else{if(Dr("++")||Dr("--"))throw new Error($_);if(Dr("+")||Dr("-")||Dr("~")||Dr("!"))e=fs(),t=aD(),t=C2t(e.value,t);else{if(r7("delete")||r7("void")||r7("typeof"))throw new Error($_);t=abe()}}return t}function obe(e){var t=0;if(e.type!==cs&&e.type!==Np)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function $2t(){var e,t,n,r,i,a,o,s,u,l;if(e=fr,u=aD(),r=fr,i=obe(r),i===0)return u;for(r.prec=i,fs(),t=[e,fr],o=aD(),a=[u,r,o];(i=obe(fr))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=tbe(s,u,o),a.push(n);r=fs(),r.prec=i,a.push(r),t.push(fr),n=aD(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=tbe(a[l-1].value,a[l-2],n),l-=2;return n}function Xm(){var e,t,n;return e=$2t(),Dr("?")&&(fs(),t=Xm(),Ja(":"),n=Xm(),e=S2t(e,t,n)),e}function i7(){var e=Xm();if(Dr(","))throw new Error($_);return e}function L2t(e){mt=e,Te=0,Ya=mt.length,fr=null,ebe();var t=i7();if(fr.type!==M_)throw new Error("Unexpect token after expression.");return t}function ub(e,t,n){return e.fields=t||[],e.fname=n,e}function B2t(e){return e.length===1?z2t(e[0]):j2t(e)}const z2t=e=>function(t){return t[e]},j2t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function a7(e){throw Error(e)}function U2t(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||a7("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&a7("Access path missing closing bracket: "+e),r&&a7("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function W2t(e,t,n){const r=U2t(e);return e=r.length===1?r[0]:e,ub((n&&n.get||B2t)(r),[e],t||e)}W2t("id"),ub(e=>e,[],"identity"),ub(()=>0,[],"zero"),ub(()=>1,[],"one"),ub(()=>!0,[],"true"),ub(()=>!1,[],"false");function o7(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...o7(e.object)),t.push(...o7(e.property))),t)}function sbe(e){return e.object.type==="MemberExpression"?sbe(e.object):e.object.name==="datum"}function ube(e){const t=L2t(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&sbe(r)&&n.add(o7(r).slice(1).join("."))}),n}class lb extends pr{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=oD(this.model,this.filter,this),this._dependentFields=ube(this.expr)}clone(){return new lb(null,this.model,gn(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function V2t(e,t){var n;const r={},i=e.config.selection;for(const a of Xe(t??{})){const o=gn(t[a]),s=i[o.type],u=St(s,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=Lr(a),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:pn(o.on)?cp(o.on,"scope"):gn(o.on)});QN(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[a])})}return r}function lbe(e,t,n,r="datum"){const i=[];function a(s){const u=Lr(s),l=e.getSelectionComponent(u,s),c=Mn(u+qm);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${Mn(l.resolve)})`)}const o=m_(t,a);return(i.length?"!("+i.map(s=>`length(data(${s}))`).join(" || ")+") || ":"")+`(${o})`}function cbe(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&He(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Mn(r)}.`);else if(n&&!r){const i=e.project.items.filter(a=>a.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,He((i.length?"Multiple ":"No ")+`matching ${Mn(n)} encoding found for selection ${Mn(t.selection)}. Using "field": ${Mn(r)}.`)):r=i[0].field}return`${e.name}[${Mn(r)}]`}function q2t(e,t){Hm(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new Fo(new lb(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function oD(e,t,n){return m_(t,r=>pn(r)?r:Dbt(r)?lbe(e,r.selection,n):t0e(r))}function H2t(e,t){if(!!e)return Tt(e)&&!kp(e)?e.map(n=>I0e(n,t)).join(", "):e}function s7(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function U_(e,t,n,r={header:!1}){var i,a;const o=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=St(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const p in h){const g=I0t[p],m=h[p];if(g&&g!==t&&g!=="both")delete h[p];else if(z9(m)){const{condition:v}=m,y=St(m,["condition"]),b=vi(v),x=ave[p];if(x){const{vgProp:w,part:S}=x,C=[...b.map(_=>{const{test:E}=_,A=St(_,["test"]);return Object.assign({test:oD(null,E)},A)}),y];s7(h,S,w,C),delete h[p]}else if(x===null){const w={signal:b.map(S=>{const{test:C}=S,_=St(S,["test"]);return`${oD(null,C)} ? ${F0e(_)} : `}).join("")+F0e(y)};h[p]=w}}else if(Bt(m)){const v=ave[p];if(v){const{vgProp:y,part:b}=v;s7(h,b,y,m),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),wr(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Di(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&Bt(h.encode.labels.update.text)&&(g=Qy(c,"datum.label",h.encode.labels.update.text.signal)),s7(h,"labels","text",{signal:g})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const g of ove)e.hasAxisPart(g)||delete h.encode[g];wr(h.encode)&&delete h.encode}const p=H2t(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:Di(d,0)})}}}function fbe(e){const{axes:t}=e.component,n=[];for(const r of Au)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const a=r==="x"?"height":"width",o=e.getSizeSignalRef(a).signal;a!==o&&n.push({name:a,update:o})}}return n}function G2t(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>U_(i,"grid",t)),...r.map(i=>U_(i,"grid",t)),...n.map(i=>U_(i,"main",t)),...r.map(i=>U_(i,"main",t))].filter(i=>i)}const dbe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},hbe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},K2t=Xe(dbe),X2t=Xe(hbe);function pbe(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const a=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Xe(o),...Xe(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${a}" ? ${k_(o[c])} : ${k_(s[c])}`};return l}return t[i]})])}function Y2t(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Vbt(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",o=Bt(n)?"axisOrient":"axis"+fN(n),s=[...i,...i.map(l=>a+l.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:pbe(s,r,e,n),vgAxisConfig:pbe(u,r,e,n),axisConfigStyle:Z2t([...u,...s],r)}}function Z2t(e,t){var n;const r=[{}];for(const i of e){let a=(n=t[i])===null||n===void 0?void 0:n.style;if(a){a=vi(a);for(const o of a)r.push(t.style[o])}}return Object.assign.apply(null,r)}function u7(e,t,n,r={}){var i;const a=P0e(e,n,t.style);if(a!==void 0)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const gbe={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return h0e(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return p0e(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return Qe(e)&&Do(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:J2t(n,e)},gridScale:({model:e,channel:t})=>Q2t(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||vbe(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||mbe(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:t_t(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:n_t(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!==null&&a!==void 0?a:i_t({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=ybe(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),a=n==="x"?"x2":"y2",o=t.fieldDef(a);return L0e(i?[w0e(i)]:[],Qe(o)?[w0e(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>a_t(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:o_t(n,t)}};function J2t(e,t){return!ls(e)&&Qe(t)&&!Ar(t==null?void 0:t.bin)}function Q2t(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function e_t(e,t,n,r,i){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Bt(a)?a:dN(a);{const{configValue:o}=u7("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?dN(o):n===Gr&&It([uU,sU],r.type)?270:void 0}}function l7(e){return`(((${e.signal} % 360) + 360) % 360)`}function mbe(e,t,n,r){if(e!==void 0)if(n==="x"){if(Bt(e)){const i=l7(e),a=Bt(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Bt(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Bt(e)){const i=l7(e),a=Bt(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Bt(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function vbe(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,a=r?"bottom":"left";if(Bt(e)){const o=l7(e),s=Bt(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(Bt(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${a}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===a)?"left":"right"}function t_t(e,t){if(t==="x"&&It(["quantitative","temporal"],e))return!0}function n_t(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function r_t(e){return e==="x"?"bottom":"left"}function i_t({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!ls(t)&&t!=="log"){if(Qe(e)){if(Ar(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&It(["month","hours","day","quarter"],(i=Ro(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function ybe(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;if(a&&o)return B0e(a,o);if(a)return a;if(o)return o;if(a!==void 0)return a;if(o!==void 0)return o}function a_t(e,t){const n=e.values;if(Tt(n))return D0e(t,n);if(Bt(n))return n}function o_t(e,t){return e==="rect"&&C0e(t)?1:0}class cb extends pr{constructor(t,n){super(t);this.transform=n,this._dependentFields=ube(this.transform.calculate)}clone(){return new cb(null,gn(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!bU(r)&&x0e(r.sort)){const{field:a,timeUnit:o}=r,s=r.sort,u=s.map((l,c)=>`${t0e({field:a,timeUnit:o,equal:l})} ? ${c} : `).join("")+s.length;t=new cb(t,{calculate:u,as:fb(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${$n(this.transform)}`}}function fb(e,t,n){return Ye(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function sD(e,t){return It(["top","bottom"],t)?"column":It(["left","right"],t)||e==="row"?"row":"column"}function db(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Di(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function uD(e,t,n,r){const i={};for(const a of e){const o=db(a,t,n,r);o!==void 0&&(i[a]=o)}return i}const c7=["row","column"],f7=["header","footer"];function s_t(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=uD(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=sD(t,s),l=dN(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),xbe(l,u)),bbe(u,l,a)),wbe(r,i,t,K2t,dbe))}}function bbe(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=vbe(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function xbe(e,t){const n=mbe(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function u_t(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of f7)if(n[i])for(const a of n[i]){const o=c_t(e,t,i,n,a);o!=null&&r.push(o)}return r}function l_t(e,t){var n;const{sort:r}=e;return Zc(r)?{field:Ye(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:Tt(r)?{field:fb(e,t,{expr:"datum"}),order:"ascending"}:{field:Ye(e,{expr:"datum"}),order:r??"ascending"}}function d7(e,t,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=uD(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=dU({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=sD(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Qy(Qy(u,"datum.label",l),"datum.value",Ye(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),xbe(a,c)),bbe(c,a,o)),wbe(n,e,t,X2t,hbe))}function c_t(e,t,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=uD(["labelOrient"],o,s,t);(t==="row"&&!It(["top","bottom"],f)||t==="column"&&!It(["left","right"],f))&&(a=d7(o,t,s))}const u=Pl(e)&&!E_(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(a||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:l_t(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const f_t={column:{start:0,end:1},row:{start:1,end:0}};function d_t(e,t){return f_t[t][e]}function h_t(e,t){const n={};for(const r of Cu){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:a,titleOrient:o}=uD(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),s=sD(r,o),u=d_t(a,s);u!==void 0&&(n[s]=u)}}return wr(n)?void 0:n}function wbe(e,t,n,r,i){const a={};for(const o of r){if(!i[o])continue;const s=db(o,t,e,n);s!==void 0&&(a[i[o]]=s)}return a}function h7(e){return[...lD(e,"width"),...lD(e,"height"),...lD(e,"childWidth"),...lD(e,"childHeight")]}function lD(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const a=e.getScaleComponent(n);if(a){const o=a.get("type"),s=a.get("range");if(ls(o)&&Sp(s)){const u=e.scaleName(n);return Pl(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[_be(u,s)]:[_be(u,s),{name:i,update:Sbe(u,a,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const a=i.endsWith("width"),o=a?"containerSize()[0]":"containerSize()[1]",s=PU(e.config.view,a?"width":"height"),u=`isFinite(${o}) ? ${o} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function _be(e,t){return{name:e+"_step",value:t.step}}function Sbe(e,t,n){const r=t.get("type"),i=t.get("padding"),a=Di(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${e}_step`}function Ebe(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function Cbe(e,t){return Xe(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),I_(t,i,r,a=>Bt(a)?a:{value:a.value}))},{})}function p_t(e,t){if(mb(t)||Pl(t))return"shared";if(A7(t))return Xc(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function p7(e,t){const n=e.scale[t],r=Xc(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&He(Zyt(t)),"independent"):e[r][t]||"shared"}const g_t=Object.assign(Object.assign({},V1t),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Abe=Xe(g_t);class m_t extends yd{}const kbe={symbols:v_t,gradient:y_t,labels:b_t,entries:x_t};function v_t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,l,c;if(a!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},S1t({},n,$0t)),Tye(n,{filled:g}));const v=(o=Tbe(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(r==="fill"||g&&r===ss)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=yi((s=h.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black"),m.fillOpacity=yi(v??1));else if(Tt(m.fill)){const y=(c=(l=g7((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=yi(y))}}if(m.stroke){if(r==="stroke"||!g&&r===ss)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(Tt(m.stroke)){const y=Di(g7(d.stroke||d.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==gd){const y=Qe(t)&&Ibe(n,i,t);y?m.opacity=[Object.assign({test:y},yi(v??1)),yi(h.legend.unselectedOpacity)]:v&&(m.opacity=yi(v))}return m=Object.assign(Object.assign({},m),e),wr(m)?void 0:m}function y_t(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=Tbe(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=yi(i)),r=Object.assign(Object.assign({},r),e),wr(r)?void 0:r}function b_t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=Qe(t)?Ibe(n,i,t):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=a,f=Lm(c)?hU({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return wr(d)?void 0:d}function x_t(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function Tbe(e){return Obe(e,(t,n)=>Math.max(t,n.value))}function g7(e){return Obe(e,(t,n)=>Di(t,n.value))}function Obe(e,t){if(h1t(e))return vi(e.condition).reduce(t,e.value);if(md(e))return e.value}function Ibe(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=Mn(n.field);return r.map(a=>`(!length(data(${Mn(Lr(a)+qm)})) || (${a}[${i}] && indexof(${a}[${i}], datum.value) >= 0))`).join(" || ")}const Nbe={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return h0e(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return p0e(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:k_t(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:T_t(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:__t(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Bm(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(eb(n)&&Dl(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>w_t(t,e)};function w_t(e,t){const n=e.values;if(Tt(n))return D0e(t,n);if(Bt(n))return n}function __t(e,t,n,r){var i;if(t!=="shape"){const a=(i=g7(n))!==null&&i!==void 0?i:r;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function S_t(e){const{legend:t}=e;return Di(t.type,E_t(e))}function E_t({channel:e,timeUnit:t,scaleType:n}){if(eb(e)){if(It(["quarter","month","day"],t))return"symbol";if(Dl(n))return"gradient"}return"symbol"}function C_t({legendConfig:e,legendType:t,orient:n,legend:r}){var i,a;return(a=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&a!==void 0?a:A_t(n,t)}function A_t(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function k_t({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(Dl(i))return n==="horizontal"?r==="top"||r==="bottom"?Dbe(t,"width",o,a):o:Dbe(t,"height",u,s)}function Dbe(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function T_t(e){if(It(["quantile","threshold","log"],e))return"greedy"}function Rbe(e){const t=oi(e)?O_t(e):R_t(e);return e.component.legends=t,t}function O_t(e){const{encoding:t}=e,n={};for(const r of[ss,...tye]){const i=Gi(t[r]);!i||!e.getScaleComponent(r)||r===us&&Qe(i)&&i.type===ab||(n[r]=D_t(e,r))}return n}function I_t(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function N_t(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function D_t(e,t){var n,r,i;let a=e.legend(t);const{markDef:o,encoding:s,config:u}=e,l=u.legend,c=new m_t({},I_t(e,t));hwt(e,t,c);const f=a!==void 0?!a:l.disable;if(c.set("disable",f,a!==void 0),f)return c;a=a||{};const d=e.getScaleComponent(t).get("type"),h=Gi(s[t]),p=Qe(h)?(n=Ro(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",m=S_t({legend:a,channel:t,timeUnit:p,scaleType:d}),v=C_t({legend:a,legendType:m,orient:g,legendConfig:l}),y={legend:a,channel:t,model:e,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const C of Abe){const _=C in Nbe?Nbe[C](y):a[C];if(_!==void 0){const E=N_t(_,C,a,e.fieldDef(t));(E||u.legend[C]===void 0)&&c.set(C,_,E)}}const b=(r=a==null?void 0:a.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},S={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const C of["labels","legend","title","symbols","gradient","entries"]){const _=Cbe((i=b[C])!==null&&i!==void 0?i:{},e),E=C in kbe?kbe[C](_,S):_;E!==void 0&&!wr(E)&&(w[C]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&Qe(h)?{name:`${Lr(h.field)}_legend_${C}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:E}))}return wr(w)||c.set("encode",w,!!(a==null?void 0:a.encoding)),c}function R_t(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){Rbe(r);for(const i of Xe(r.component.legends))n.legend[i]=p7(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=Fbe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Xe(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function Fbe(e,t){var n,r,i,a;if(!e)return t.clone();const o=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const l of Abe){const c=Tp(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return F_t(f,d);case"title":return z0e(f,d);case"type":return u=!0,qs("symbol")}return HN(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&L9(e.implicit,["encode","gradient"]),((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient)&&L9(e.explicit,["encode","gradient"])),e}function F_t(e,t){return t.value==="circle"?t:e}function Mbe(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function Pbe(e){const t=e.component.legends,n={};for(const i of Xe(t)){const a=e.getScaleComponent(i),o=$r(a.get("domains"));if(n[o])for(const s of n[o])Fbe(s,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return hp(n).flat().map(i=>M_t(i,e.config)).filter(i=>i!==void 0)}function M_t(e,t){var n,r,i;const a=e.combine(),{disable:o,labelExpr:s,selections:u}=a,l=St(a,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of tye)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&Bt(l.encode.labels.update.text)&&(c=Qy(s,"datum.label",l.encode.labels.update.text.signal)),Mbe(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(Bt(f)){const d=U1t[c];if(d){const{vgProp:h,part:p}=d;Mbe(l,p,h,f),delete l[c]}}}return l}}function P_t(e){return mb(e)||A7(e)?$_t(e):$be(e)}function $_t(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),$be(e))}function $be(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},a=t.data.reduce((o,s)=>{const u=Bt(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return It(o,u)||o.push(u),o},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const L_t=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Lbe extends yd{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function Bbe(e){e.component.projection=oi(e)?B_t(e):U_t(e)}function B_t(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,a=r?z_t(e):void 0;return new Lbe(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,a)}}function z_t(e){const t=[],{encoding:n}=e;for(const r of[[Vc,Wc],[Eu,Nl]])(Gi(n[r[0]])||Gi(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(us)&&e.typedFieldDef(us).type===ab&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ka)),t}function j_t(e,t){const n=Jme(L_t,i=>!!(!Om(e.explicit,i)&&!Om(t.explicit,i)||Om(e.explicit,i)&&Om(t.explicit,i)&&$r(e.get(i))===$r(t.get(i))));if($r(e.size)===$r(t.size)){if(n)return e;if($r(e.explicit)===$r({}))return t;if($r(t.explicit)===$r({}))return e}return null}function U_t(e){if(e.children.length===0)return;let t;for(const r of e.children)Bbe(r);const n=Jme(e.children,r=>{const i=r.component.projection;if(i)if(t){const a=j_t(t,i);return a&&(t=a),!!a}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new Lbe(r,t.specifiedProjection,t.size,gn(t.data));for(const a of e.children){const o=a.component.projection;o&&(o.isFit&&i.data.push(...a.component.projection.data),a.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function W_t(e,t,n,r){var i,a;if(A_(t,n)){const o=oi(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{},s=Ye(t,{expr:"datum"}),u=Ye(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ye(t,{binSuffix:"range",forAs:!0}),formula:DN(s,u,o.format,o.formatType,r)}}return{}}function zbe(e,t){return`${kve(e)}_${t}`}function V_t(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function m7(e,t,n){var r;const i=(r=LN(n,void 0))!==null&&r!==void 0?r:{},a=zbe(i,t);return e.getName(`${a}_bins`)}function q_t(e){return"as"in e}function jbe(e,t,n){let r,i;q_t(e)?r=pn(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ye(e,{forAs:!0}),Ye(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},LN(t,void 0)),o=zbe(a,e.field),{signal:s,extentSignal:u}=V_t(n,o);if(kN(a.extent)){const c=a.extent,f=c.selection;i=cbe(n.getSelectionComponent(Lr(f),f),c),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class af extends pr{constructor(t,n){super(t);this.bins=n}clone(){return new af(null,gn(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{if(Vs(a)&&Ar(a.bin)){const{key:s,binComponent:u}=jbe(a,a.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),W_t(n,a,o,n.config))}return i},{});return wr(r)?null:new af(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:a}=jbe(n,n.bin,r);return new af(t,{[i]:a})}merge(t,n){for(const r of Xe(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=dp([...this.bins[r].as,...t.bins[r].as],$n)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(hp(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(hp(this.bins).map(t=>t.field))}hash(){return`Bin ${$n(this.bins)}`}assemble(){return hp(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,a=t.bin,{extent:o}=a,s=St(a,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:pp(t.field),as:r,signal:t.signal},kN(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:pp(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ye({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class hb extends pr{constructor(t){super(null);t=t??{name:"source"};let n;if(Vm(t)||(n=t.format?Object.assign({},ud(t.format,["parse"])):{}),GN(t))this._data={values:t.values};else if(O_(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];It(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Sye(t)?this._data={values:[{type:"Sphere"}]}:(wye(t)||Vm(t))&&(this._data={});this._generator=Vm(t),t.name&&(this._name=t.name),n&&!wr(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function v7(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!v7(t.children))return!1}return!0}class W_ extends pr{constructor(t,n){super(t);this.params=n}clone(){return new W_(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${$n(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class V_ extends pr{constructor(t,n){super(t);this.params=n}clone(){return new V_(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${$n(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function cD(e){return e instanceof hb||e instanceof W_||e instanceof V_}class Ube{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class wd extends Ube{constructor(){super();this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(cD(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class y7 extends Ube{}function H_t(e,t,n,r){const i=oi(r)?r.encoding[Gc(t)]:void 0;if(Vs(n)&&oi(r)&&gU(t,n,i,r.stack,r.markDef,r.config))e.add(Ye(n,{})),e.add(Ye(n,{suffix:"end"})),n.bin&&A_(n,t)&&e.add(Ye(n,{binSuffix:"range"}));else if(tyt(t)){const a=eyt(t);e.add(r.getName(a))}else e.add(Ye(n));return e}function G_t(e,t){var n;for(const r of Xe(t)){const i=t[r];for(const a of Xe(i))r in e?e[r][a]=new Set([...(n=e[r][a])!==null&&n!==void 0?n:[],...i[a]]):e[r]={[a]:i[a]}}}class Fl extends pr{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new Fl(null,new Set(this.dimensions),gn(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},a=new Set;return!r||(n.forEachFieldDef((o,s)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Ye(o,{forAs:!0})]);else{if(gp(d)||Dm(d)){const p=gp(d)?"argmin":"argmax",g=d[p];i[g]=(l=i[g])!==null&&l!==void 0?l:{},i[g][p]=new Set([Ye({op:p,field:g},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Ye(o,{forAs:!0})]);_p(s)&&n.scaleDomain(s)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Ye({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Ye({field:h,aggregate:"max"},{forAs:!0})]))}else H_t(a,s,o,n)}),a.size+Xe(i).length===0)?null:new Fl(t,a,i)}static makeFromTransform(t,n){var r,i,a;const o=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(s["*"]=(r=s["*"])!==null&&r!==void 0?r:{},s["*"].count=new Set([f||Ye(u,{forAs:!0})])):(s[c]=(i=s[c])!==null&&i!==void 0?i:{},s[c][l]=new Set([f||Ye(u,{forAs:!0})])))}for(const u of(a=n.groupby)!==null&&a!==void 0?a:[])o.add(u);return o.size+Xe(s).length===0?null:new Fl(t,o,s)}merge(t){return S0t(this.dimensions,t.dimensions)?(G_t(this.measures,t.measures),!0):(hbt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Xe(this.measures)])}producedFields(){const t=new Set;for(const n of Xe(this.measures))for(const r of Xe(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${$n({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const a of Xe(this.measures))for(const o of Xe(this.measures[a]))for(const s of this.measures[a][o])r.push(s),t.push(o),n.push(a==="*"?null:pp(a));return{type:"aggregate",groupby:[...this.dimensions].map(pp),ops:t,fields:n,as:r}}}class pb extends pr{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const a of Cu){const o=n.facet[a];if(o){const{bin:s,sort:u}=o;this[a]=Object.assign({name:n.getName(`${a}_domain`),fields:[Ye(o),...Ar(s)?[Ye(o,{binSuffix:"end"})]:[]]},Zc(u)?{sortField:u}:Tt(u)?{sortIndexField:fb(o,a)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Cu)this[n]&&(t+=` ${n.charAt(0)}:${$n(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Cu)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Cu)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Au){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),a=r.get("range");if(ls(i)&&Sp(a)){const o=dD(this.childModel,n),s=E7(o);s?t[n]=s:He(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],a=[],o=[],s=[];r&&r[i]&&(n?(a.push(`distinct_${r[i]}`),o.push("max")):(a.push(r[i]),o.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=RN,field:f}=u;a.push(f),o.push(c),s.push(Ye(u,{forAs:!0}))}else l&&(a.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},a.length?{fields:a,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:a}=this.model.component,o=[],s={};for(const c of c7){for(const f of f7){const d=(n=a[c]&&a[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const a=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:u}=this;if(o&&s&&(a.x||a.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=a.x)!==null&&t!==void 0?t:[],(n=a.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[fd,cd])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,a));if(u){const l=this.assembleFacetHeaderData(a);l&&r.push(...l)}return r}}function Wbe(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function K_t(e,t){const n=rve(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=Wbe(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=Wbe(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return He(Cyt(t)),null}function X_t(e){const t={};return uN(e.filter,n=>{var r;if(e0e(n)){let i=null;rU(n)?i=n.equal:iU(n)?i=n.range[0]:aU(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(nb(i)?t[n.field]="date":Ni(i)?t[n.field]="number":pn(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function Y_t(e){const t={};function n(r){BN(r)?t[r.field]="date":r.type==="quantitative"&&X0t(r.aggregate)?t[r.field]="number":v_(r.field)>1?r.field in t||(t[r.field]="flatten"):bU(r)&&Zc(r.sort)&&v_(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((oi(e)||Pl(e))&&e.forEachFieldDef((r,i)=>{if(Vs(r))n(r);else{const a=Mm(i),o=e.fieldDef(a);n(Object.assign(Object.assign({},r),{type:o.type}))}}),oi(e)){const{mark:r,markDef:i,encoding:a}=e;if(Nm(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",s=a[o];Qe(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function Z_t(e){const t={};if(oi(e)&&e.component.selection)for(const n of Xe(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&v_(i.field)>1&&(t[i.field]="flatten")}return t}class Qa extends pr{constructor(t,n){super(t);this._parse=n}clone(){return new Qa(null,gn(this._parse))}hash(){return`Parse ${$n(this._parse)}`}static makeExplicit(t,n,r){let i={};const a=n.data;return!Vm(a)&&a&&a.format&&a.format.parse&&(i=a.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const s of Xe(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:He(Mve(s,r[s],u.value)))}for(const s of Xe(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:He(Mve(s,n[s],u)))}const a=new yd(n,r);i.copyAll(a);const o={};for(const s of Xe(a.combine())){const u=a.get(s);u!==null&&(o[s]=u)}return Xe(o).length===0||i.parseNothing?null:new Qa(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Xe(this._parse)){const r=this._parse[n];v_(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Xe(this._parse))}dependentFields(){return new Set(Xe(this._parse))}assembleTransforms(t=!1){return Xe(this._parse).filter(n=>t?v_(n)>1:!0).map(n=>{const r=K_t(n,this._parse[n]);return r?{type:"formula",expr:r,as:ive(n)}:null}).filter(n=>n!==null)}}class Dp extends pr{clone(){return new Dp(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([ob])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:ob}}}class Ym extends pr{constructor(t,n){super(t);this.transform=n}clone(){return new Ym(null,gn(this.transform))}addDimensions(t){this.transform.groupby=dp(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ye(t)}hash(){return`JoinAggregateTransform ${$n(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const a of this.transform.joinaggregate)n.push(a.op),r.push(this.getDefaultName(a)),t.push(a.field===void 0?null:a.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function J_t(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Ye(r);return i&&t.push(i),t},[])}function Q_t(e){return Tt(e)&&e.every(t=>pn(t))&&e.length>1}class _d extends pr{constructor(t,n){super(t);this._stack=n}clone(){return new _d(null,gn(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:a,offset:o="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(Di(f.order,"ascending"));const l={field:s,order:u};let c;return Q_t(a)?c=a:pn(a)?c=[a,a+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new _d(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:a,fieldChannel:o,offset:s,impute:u}=r;let l;if(a){const h=i[a];l=Qc(h)}const c=J_t(n),f=n.encoding.order;let d;return Tt(f)||Qe(f)?d=$0e(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new _d(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${$n(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ye(t,{binSuffix:"mid"})]:[Ye(t,{}),Ye(t,{binSuffix:"end"})]:[Ye(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:a,sort:o,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ye(r,{expr:"datum"})+`+${1-c}*`+Ye(r,{expr:"datum",binSuffix:"end"}),as:Ye(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...a,...n],key:Ye(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:s}),t}}class gb extends pr{constructor(t,n){super(t);this.transform=n}clone(){return new gb(null,gn(this.transform))}addDimensions(t){this.transform.groupby=dp(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ye(t)}hash(){return`WindowTransform ${$n(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],a=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),a.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>V9(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}class eSt extends wd{run(t){const n=t.parent;if(t instanceof Qa){if(cD(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof Qa)this.setMutated(),n.merge(t);else{if(tve(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class tSt extends y7{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Xe(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class nSt extends wd{run(t){return t instanceof Fo||t.numChildren()>0||t instanceof pb?this.flags:(this.setMutated(),t.remove(),this.flags)}}class rSt extends wd{constructor(){super(...arguments);this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof tf){const n=t.producedFields();Qme(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class iSt extends wd{run(t){this.setContinue();const r=t.parent.children.filter(a=>a instanceof tf),i=r.pop();for(const a of r)this.setMutated(),i.merge(a);return this.flags}}function aSt(e){function t(n){if(!(n instanceof pb)){const r=n.clone();if(r instanceof Fo){const i=x7+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Fl||r instanceof _d||r instanceof gb||r instanceof Ym)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function b7(e){if(e instanceof pb)if(e.numChildren()===1&&!(e.children[0]instanceof Fo)){const t=e.children[0];(t instanceof Fl||t instanceof _d||t instanceof gb||t instanceof Ym)&&t.addDimensions(e.fields),t.swapWithParent(),b7(e)}else{const t=e.model.component.data.main;Vbe(t);const n=aSt(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(b7)}function Vbe(e){if(e instanceof Fo&&e.type===Ka&&e.numChildren()===1){const t=e.children[0];t instanceof pb||(t.swapWithParent(),Vbe(e))}}class oSt extends y7{constructor(){super()}run(t){t instanceof Fo&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class sSt extends y7{constructor(t){super();this.requiresSelectionId=t&&YU(t)}run(t){t instanceof Dp&&(this.requiresSelectionId&&(cD(t.parent)||t.parent instanceof Fl||t.parent instanceof Qa)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class uSt extends wd{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(a=>a instanceof Qa);if(n.numChildren()>1&&i.length>=1){const a={},o=new Set;for(const s of i){const u=s.parse;for(const l of Xe(u))l in a?a[l]!==u[l]&&o.add(l):a[l]=u[l]}for(const s of o)delete a[s];if(!wr(a)){this.setMutated();const s=new Qa(n,a);for(const u of r){if(u instanceof Qa)for(const l of Xe(a))delete u.parse[l];n.removeChild(u),u.parent=s,u instanceof Qa&&Xe(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class lSt extends wd{run(t){const n=t.parent,r=n.children.filter(a=>a instanceof Fl),i={};for(const a of r){const o=$n(a.groupBy);o in i||(i[o]=[]),i[o].push(a)}for(const a of Xe(i)){const o=i[a];if(o.length>1){const s=o.pop();for(const u of o)s.merge(u)&&(n.removeChild(u),u.parent=s,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class cSt extends wd{constructor(t){super();this.model=t}run(t){const n=t.parent,r=!(cD(n)||n instanceof lb||n instanceof Qa||n instanceof Dp),i=[],a=[];for(const o of n.children)o instanceof af&&(r&&!tve(n.producedFields(),o.dependentFields())?i.push(o):a.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof af?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(a.length>1){const o=a.pop();for(const s of a)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class fSt extends wd{run(t){const n=t.parent,r=[...n.children];if(!g_(r,s=>s instanceof Fo)||n.numChildren()<=1)return this.setContinue(),this.flags;const a=[];let o;for(const s of r)if(s instanceof Fo){let u=s;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof Fo)u=l;else break}a.push(...u.children),o?(n.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else a.push(s);if(a.length){this.setMutated();for(const s of a)s.parent.removeChild(s),s.parent=o}return this.setContinue(),this.flags}}const x7="scale_",fD=5;function Rp(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function dSt(e){return e}function Ml(e,t){return t.map(r=>{if(e instanceof wd){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(dSt)}function qbe(e,t){let n=e.sources;const r=new Set;return r.add(Ml(new oSt,n)),r.add(Ml(new sSt(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(Ml(new nSt,Rp(n))),n=n.filter(i=>i.numChildren()>0),r.add(Ml(new eSt,Rp(n))),r.add(Ml(new cSt(t),Rp(n))),r.add(Ml(new rSt,Rp(n))),r.add(Ml(new uSt,Rp(n))),r.add(Ml(new lSt,Rp(n))),r.add(Ml(new iSt,Rp(n))),r.add(Ml(new tSt,n)),r.add(Ml(new fSt,Rp(n))),e.sources=n,r.has(!0)}function hSt(e,t){v7(e.sources);let n=0,r=0;for(let i=0;i<fD&&qbe(e,t);i++)n++;e.sources.map(b7);for(let i=0;i<fD&&qbe(e,t);i++)r++;v7(e.sources),Math.max(n,r)===fD&&He(`Maximum optimization runs(${fD}) reached.`)}class Hs{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Hs(()=>t(n))}}function Hbe(e){oi(e)?pSt(e):gSt(e)}function pSt(e){const t=e.component.scales;for(const n of Xe(t)){const r=vSt(e,n);if(t[n].setWithExplicit("domains",r),bSt(e,n),e.component.data.isFaceted){let a=e;for(;!Pl(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const s of r.value)Ep(s)&&(s.data=x7+s.data.replace(x7,""))}}}function gSt(e){for(const n of e.children)Hbe(n);const t=e.component.scales;for(const n of Xe(t)){let r,i=null;for(const a of e.children){const o=a.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=Tp(r,o.getWithExplicit("domains"),"domains","scale",S7);const s=o.get("selectionExtent");i&&s&&i.selection!==s.selection&&He("The same selection must be used to override scale domains in a layered view."),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function mSt(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:a}=Gbe(t,n);if(!i){He(a);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=Gbe(t,n);if(i)return"unaggregated"}return e}function vSt(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=mSt(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Gi(r.x2)?Gi(r.x)?Tp(Fp(n,i,e,"x"),Fp(n,i,e,"x2"),"domain","scale",S7):Fp(n,i,e,"x2"):t==="y"&&Gi(r.y2)?Gi(r.y)?Tp(Fp(n,i,e,"y"),Fp(n,i,e,"y2"),"domain","scale",S7):Fp(n,i,e,"y2"):Fp(n,i,e,t)}function ySt(e,t,n){return e.map(r=>({signal:`{data: ${SU(r,{timeUnit:n,type:t})}}`}))}function w7(e,t,n){var r;const i=(r=Ro(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?ySt(e,t,i):[e]}function Fp(e,t,n,r){const{encoding:i}=n,a=Gi(i[r]),{type:o}=a,s=a.timeUnit;if(Qbt(t)){const f=Fp(e,void 0,n,r),d=w7(t.unionWith,o,s);return Wm([...f.value,...d])}else{if(Bt(t))return Wm([t]);if(t&&t!=="unaggregated"&&!i0e(t))return Wm(w7(t,o,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return qs([[0,1]]);const f=n.requestDataName(Ka);return qs([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=_p(r)&&Qe(a)?xSt(n,r,e):void 0;if(Ap(a)){const f=w7([a.datum],o,s);return qs(f)}const c=a;if(t==="unaggregated"){const f=n.requestDataName(Ka),{field:d}=a;return qs([{data:f,field:Ye({field:d,aggregate:"min"})},{data:f,field:Ye({field:d,aggregate:"max"})}])}else if(Ar(c.bin)){if(ls(e))return qs(e==="bin-ordinal"?[]:[{data:cN(l)?n.requestDataName(Ka):n.requestDataName(KN),field:n.vgField(r,A_(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!ca(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Ar(f)){const d=m7(n,c.field,f);return qs([new Hs(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return qs([{data:n.requestDataName(Ka),field:n.vgField(r,{})}])}}else if(c.timeUnit&&It(["time","utc"],e)&&gU(r,c,oi(n)?n.encoding[Gc(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(Ka);return qs([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return qs(l?[{data:cN(l)?n.requestDataName(Ka):n.requestDataName(KN),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(Ka),field:n.vgField(r)}])}function _7(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":RN)},r?{field:pp(r)}:{}),i?{order:i}:{})}function bSt(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=i0e(i)&&i,s=w_(a)&&kN(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",o??s,!0)}function xSt(e,t,n){if(!ls(n))return;const r=e.fieldDef(t),i=r.sort;if(x0e(i))return{op:"min",field:fb(r,t),order:"ascending"};const{stack:a}=e,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Zc(i)){const s=a&&!It(o,i.field);return _7(i,s)}else if(b0e(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=a&&!It(o,f);if(gp(c)||Dm(c))return _7({field:Ye(l),order:u},d);if(V9(c)||!c)return _7({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(It(["ascending",void 0],i))return!0}}function Gbe(e,t){const{aggregate:n,type:r}=e;return n?pn(n)&&!J0t[n]?{valid:!1,reason:Vyt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:qyt(e)}:{valid:!0}:{valid:!1,reason:Wyt(e)}}function S7(e,t,n,r){return e.explicit&&t.explicit&&He(Yyt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function wSt(e){const t=dp(e.map(o=>Ep(o)?St(o,["sort"]):o),$n),n=dp(e.map(o=>{if(Ep(o)){const s=o.sort;return s!==void 0&&!cN(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(o=>o!==void 0),$n);if(t.length===0)return;if(t.length===1){const o=e[0];if(Ep(o)&&n.length>0){let s=n[0];if(n.length>1)He(jve),s=!0;else if(ca(s)&&"field"in s){const u=s.field;o.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},o),{sort:s})}return o}const r=dp(n.map(o=>cN(o)||!("op"in o)||o.op in G0t?o:(He(Jyt(o)),!0)),$n);let i;r.length===1?i=r[0]:r.length>1&&(He(jve),i=!0);const a=dp(e.map(o=>Ep(o)?o.data:null),o=>o);return a.length===1&&a[0]!==null?Object.assign({data:a[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function E7(e){if(Ep(e)&&pn(e.field))return e.field;if(kbt(e)){let t;for(const n of e.fields)if(Ep(n)&&pn(n.field)){if(!t)t=n.field;else if(t!==n.field)return He(Qyt),t}return He(ebt),t}else if(Tbt(e)){He(tbt);const t=e.fields[0];return pn(t)?t:void 0}}function dD(e,t){const r=e.component.scales[t].get("domains").map(i=>(Ep(i)&&(i.data=e.lookupDataSource(i.data)),i));return wSt(r)}function Kbe(e){return mb(e)||A7(e)?e.children.reduce((t,n)=>t.concat(Kbe(n)),Xbe(e)):Xbe(e)}function Xbe(e){return Xe(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=St(i,["name","type","selectionExtent","domains","range","reverse"]),d=_St(i.range,a,n);let h;s&&(h=_wt(e,s));const p=dD(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function _St(e,t,n){return Xc(n)&&Sp(e)?{step:{signal:t+"_step"}}:e}class Ybe extends yd{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:g_(this.get("domains"),t=>Tt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const SSt=["range","scheme"];function Zbe(e){return e==="x"?"width":e==="y"?"height":void 0}function ESt(e){const t=e.component.scales;for(const n of CN){const r=t[n];if(!r)continue;const i=CSt(n,e);r.setWithExplicit("range",i)}}function Jbe(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Ar(n.bin)){const r=m7(e,n.field,n.bin),i=Zbe(t),a=e.getName(i);return new Hs(()=>{const o=e.getSignalName(r),s=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(a)} / (${s})`})}}function CSt(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e).get("type");for(const o of SSt)if(n[o]!==void 0){const s=a0e(a,o),u=o0e(e,o);if(!s)He(Bve(a,o,e));else if(u)He(u);else switch(o){case"range":return Tt(n.range)&&Xc(e)?Wm(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return Hs.fromName(f,c)}return l})):Wm(n.range);case"scheme":return Wm(ASt(n[o]))}}if(e===Gr||e===Hi){const o=e===Gr?"width":"height",s=r[o];if(ef(s)){if(ls(a))return Wm({step:s.step});He(zve(o))}}return qs(kSt(e,t))}function ASt(e){return Jbt(e)?Object.assign({scheme:e.name},ud(e,["name"])):{scheme:e}}function kSt(e,t){const{size:n,config:r,mark:i,encoding:a}=t,o=t.getSignalName.bind(t),{type:s}=Gi(a[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Gr:case Hi:{if(It(["point","band"],l)){if(e===Gr&&!n.width){const p=T_(r.view,"width");if(ef(p))return p}else if(e===Hi&&!n.height){const p=T_(r.view,"height");if(ef(p))return p}}const d=Zbe(e),h=t.getName(d);return e===Hi&&ku(l)?[Hs.fromName(o,h),0]:[0,Hs.fromName(o,h)]}case pd:{const d=t.component.scales[e].get("zero"),h=Qbe(i,d,r),p=ISt(i,n,t,r);return IN(l)?OSt(h,p,TSt(l,r,c,e)):[h,p]}case Il:return[0,Math.PI*2];case Rm:return[0,360];case Uc:return[0,new Hs(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case yp:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case bp:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case us:return"symbol";case ss:case qc:case Hc:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case gd:case mp:case vp:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function TSt(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Tt(n)?n.length+1:(He(cbt(r)),3)}}function OSt(e,t,n){const r=()=>{const i=k_(t),a=k_(e),o=`(${i} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${i} + ${o}, ${o})`};return Bt(t)?new Hs(r):{signal:r()}}function Qbe(e,t,n){if(t)return Bt(t)?{signal:`${t.signal} ? 0 : ${Qbe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(TN("size",e))}const e1e=.95;function ISt(e,t,n,r){const i={x:Jbe(n,"x"),y:Jbe(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const a=t1e(t,i,r.view);return Ni(a)?a-1:new Hs(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const a=t1e(t,i,r.view);return Ni(a)?Math.pow(e1e*a,2):new Hs(()=>`pow(${e1e} * ${a.signal}, 2)`)}}throw new Error(TN("size",e))}function t1e(e,t,n){const r=ef(e.width)?e.width.step:VN(n,"width"),i=ef(e.height)?e.height.step:VN(n,"height");return t.x||t.y?new Hs(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function n1e(e,t){oi(e)?NSt(e,t):a1e(e,t)}function NSt(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=e;for(const s of Xe(n)){const u=o[s],l=n[s],c=e.getScaleComponent(s),f=Gi(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=a0e(h,t),v=o0e(s,t);if(d!==void 0&&(m?v&&He(v):He(Bve(h,t,s))),m&&v===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const y=t in r1e?r1e[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:a,config:r}):r.scale[t];y!==void 0&&l.set(t,y,!1)}}}const r1e={bins:({model:e,fieldOrDatumDef:t})=>Qe(t)?DSt(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>RSt(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>FSt(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>MSt(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>PSt(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>$St(e,t,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=Qe(e)?e.sort:void 0;return LSt(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>BSt(e,t,n,r,i)};function i1e(e){oi(e)?ESt(e):a1e(e,"range")}function a1e(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?i1e(r):n1e(r,t);for(const r of Xe(n)){let i;for(const a of e.children){const o=a.component.scales[r];if(o){const s=o.getWithExplicit(t);i=Tp(i,s,t,"scale",xye((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function DSt(e,t){const n=t.bin;if(Ar(n)){const r=m7(e,t.field,n);return new Hs(()=>e.getSignalName(r))}else if(Do(n)&&w_(n)&&n.step!==void 0)return{step:n.step}}function RSt(e,t){if(It([ss,qc,Hc],e)&&t!=="nominal")return"hcl"}function FSt(e,t,n){var r;if(!(((r=Qc(n))===null||r===void 0?void 0:r.bin)||It([Ri.TIME,Ri.UTC],e)))return t in wp?!0:void 0}function MSt(e,t,n,r,i,a){if(e in wp){if(Dl(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:s}=i;if(o==="bar"&&!(Qe(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===Ri.POINT)return n.pointPadding}}function PSt(e,t,n,r){if(e===void 0&&t in wp){const{bandPaddingInner:i,barBandPaddingInner:a,rectBandPaddingInner:o}=r;return Di(i,n==="bar"?a:o)}}function $St(e,t,n,r,i,a){if(e===void 0&&t in wp&&n===Ri.BAND){const{bandPaddingOuter:o}=a;return Di(o,Bt(i)?{signal:`${i.signal}/2`}:i/2)}}function LSt(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return ku(e)&&t==="descending"?Bt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(ku(e)&&t==="descending")return!0}function BSt(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&ku(i)){if(Tt(n)){const o=n[0],s=n[n.length-1];if(o<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!IN(i))return!0;if(!(Qe(t)&&t.bin)&&It([...Au,...lyt],e)){const{orient:o,type:s}=r;return!(It(["bar","area","line","trail"],s)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function zSt(e,t,n,r){const i=jSt(t,n,r),{type:a}=e;return _p(t)?a!==void 0?u0e(t,a)?Qe(n)&&!s0e(a,n.type)?(He(Kyt(a,i)),i):a:(He(Gyt(t,a,i)),i):i:null}function jSt(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(eb(e)||AN(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&He(Z9(e,"ordinal")),"ordinal";if(e in wp){if(It(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in K9)return"band";return t.band!==void 0||xU(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return eb(e)?"time":AN(e)==="discrete"?(He(Z9(e,"temporal")),"ordinal"):Qe(t)&&t.timeUnit&&Ro(t.timeUnit).utc?"utc":"time";case"quantitative":return eb(e)?Qe(t)&&Ar(t.bin)?"bin-ordinal":"linear":AN(e)==="discrete"?(He(Z9(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error($ve(t.type))}function USt(e,{ignoreRange:t}={}){o1e(e),Hbe(e);for(const n of n1t)n1e(e,n);t||i1e(e)}function o1e(e){oi(e)?e.component.scales=WSt(e):e.component.scales=qSt(e)}function WSt(e){const{encoding:t,mark:n}=e;return CN.reduce((r,i)=>{const a=Gi(t[i]);if(a&&n===fve&&i===us&&a.type===ab)return r;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o=o??{};const s=zSt(o,i,a,n);r[i]=new Ybe(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}const VSt=xye((e,t)=>n0e(e)-n0e(t));function qSt(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const a of e.children){o1e(a);for(const o of Xe(a.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:p_t(o,e),i.scale[o]==="shared"){const s=r[o],u=a.component.scales[o].getWithExplicit("type");s?Bbt(s.value,u.value)?r[o]=Tp(s,u,"type","scale",VSt):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const a of Xe(r)){const o=e.scaleName(a,!0),s=r[a];n[a]=new Ybe(o,s);for(const u of e.children){const l=u.component.scales[a];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class C7{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function oi(e){return(e==null?void 0:e.type)==="unit"}function Pl(e){return(e==null?void 0:e.type)==="facet"}function A7(e){return(e==null?void 0:e.type)==="concat"}function mb(e){return(e==null?void 0:e.type)==="layer"}class k7{constructor(t,n,r,i,a,o,s){var u,l;this.type=n,this.parent=r,this.config=a,this.view=s,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=a,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=kp(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new C7,this.projectionNameMap=r?r.projectionNameMap:new C7,this.signalNameMap=r?r.signalNameMap:new C7,this.data=t.data,this.description=t.description,this.transforms=Kxt((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:X1t(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:FN(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new yd,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?gn(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){USt(this)}parseProjection(){Bbe(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Rbe(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=St(t,["style"]),r={};for(const i of Xe(n)){const a=n[i];a!==void 0&&(r[i]=yi(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=yi(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):wr(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=St(t,["spacing"]),{component:i,config:a}=this,o=h_t(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Cu)t[r].title&&n.push(s_t(this,r));for(const r of c7)n=n.concat(u_t(this,r));return n}assembleAxes(){return G2t(this.component.axes,this.config)}assembleLegends(){return Pbe(this)}assembleProjections(){return P_t(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:a}=i,o=St(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},R0e(this.config.title).nonMark),o),a?{encode:{update:a}}:{});if(s.text)return It(["unit","layer"],this.type)?It(["middle",void 0],s.anchor)&&(s.frame=(n=s.frame)!==null&&n!==void 0?n:"group"):s.anchor=(r=s.anchor)!==null&&r!==void 0?r:"start",wr(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Pl(this.parent)?Kbe(this):[];i.length>0&&(n.scales=i);const a=this.assembleAxes();a.length>0&&(n.axes=a);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Lr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Pl(this.parent)){const n=Ebe(t),r=EN(n),i=this.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(ls(a)&&Sp(o)){const s=i.get("name"),u=dD(this,r),l=E7(u);if(l){const c=Ye({aggregate:"distinct",field:l},{expr:"datum"});return{signal:Sbe(s,i,c)}}else return He(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(_ve(t)&&_p(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(byt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class s1e extends k7{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Ye(r,n)}reduceFieldDef(t,n){return j0e(this.getMapping(),(r,i,a)=>{const o=Qc(i);return o?t(r,o,a):r},n)}forEachFieldDef(t,n){AU(this.getMapping(),(r,i)=>{const a=Qc(r);a&&t(a,i)},n)}}class hD extends pr{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=gn(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(a=o[1])!==null&&a!==void 0?a:"density"]}clone(){return new hD(null,gn(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${$n(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=St(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class q_ extends pr{constructor(t,n){super(t);this.filter=n}clone(){return new q_(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:a}=n;if(tr("invalid",a,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=_p(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");ku(d)&&l.aggregate!=="count"&&!Nm(i)&&(u[l.field]=l)}return u},{});return Xe(s).length?new q_(t,s):null}dependentFields(){return new Set(Xe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${$n(this.filter)}`}assemble(){const t=Xe(this.filter).reduce((n,r)=>{const i=this.filter[r],a=Ye(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${a}) || (isValid(${a}) && isFinite(+${a})))`):i.type==="quantitative"&&(n.push(`isValid(${a})`),n.push(`isFinite(+${a})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class pD extends pr{constructor(t,n){super(t);this.transform=n,this.transform=gn(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((a,o)=>{var s;return(s=i[o])!==null&&s!==void 0?s:a})}clone(){return new pD(this.parent,gn(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${$n(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class gD extends pr{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=gn(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new gD(null,gn(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${$n(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class vb extends pr{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new vb(null,gn(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Vc,Wc],[Eu,Nl]]){const a=i.map(o=>{const s=Gi(n.encoding[o]);return Qe(s)?s.field:Ap(s)?{expr:`${s.datum}`}:md(s)?{expr:`${s.value}`}:void 0});(a[0]||a[1])&&(t=new vb(t,a,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(us)){const i=n.typedFieldDef(us);i.type===ab&&(t=new vb(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(pn);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${$n(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class H_ extends pr{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new H_(null,this.projection,gn(this.fields),gn(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Vc,Wc],[Eu,Nl]]){const i=r.map(o=>{const s=Gi(n.encoding[o]);return Qe(s)?s.field:Ap(s)?{expr:`${s.datum}`}:md(s)?{expr:`${s.value}`}:void 0}),a=r[0]===Eu?"2":"";(i[0]||i[1])&&(t=new H_(t,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}return t}dependentFields(){return new Set(this.fields.filter(pn))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${$n(this.fields)} ${$n(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Zm extends pr{constructor(t,n){super(t);this.transform=n}clone(){return new Zm(null,gn(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Zm(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,a=r.y;if(Qe(i)&&Qe(a)){const o=i.impute?i:a.impute?a:void 0;if(o===void 0)return;const s=i.impute?a:a.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=U0e(n.mark,r);return new Zm(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${$n(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:a,value:o,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:Txt(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},a?{groupby:a}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class mD extends pr{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=gn(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.loess]}clone(){return new mD(null,gn(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${$n(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=St(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class G_ extends pr{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new G_(null,gn(this.transform),this.secondary)}static make(t,n,r,i){const a=n.component.data.sources,{from:o}=r;let s=null;if(Ixt(o)){let u=f1e(o.data,a);u||(u=new hb(o.data),a.push(u));const l=n.getName(`lookup_${i}`);s=new Fo(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(Nxt(o)){const u=o.selection;if(r=Object.assign({as:u},r),s=n.getSelectionComponent(Lr(u),u).materialized,!s)throw new Error(_yt(u))}return new G_(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?vi(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${$n({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:vi(this.transform.as)}:{});else{let n=this.transform.as;pn(n)||(He(kyt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class vD extends pr{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=gn(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new vD(null,gn(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${$n(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=St(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class yD extends pr{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=gn(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.regression]}clone(){return new yD(null,gn(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${$n(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=St(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class bD extends pr{constructor(t,n){super(t);this.transform=n}clone(){return new bD(null,gn(this.transform))}addDimensions(t){var n;this.transform.groupby=dp(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${$n(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:a}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),a!==void 0?{op:a}:{}),r!==void 0?{groupby:r}:{})}}class xD extends pr{constructor(t,n){super(t);this.transform=n}clone(){return new xD(null,gn(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${$n(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function u1e(e){let t=0;function n(r,i){var a;if(r instanceof hb&&!r.isGenerator&&!O_(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof Qa&&(r.parent instanceof hb&&!i.source?(i.format=Object.assign(Object.assign({},(a=i.format)!==null&&a!==void 0?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof pb){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof W_||r instanceof V_||r instanceof q_||r instanceof lb||r instanceof cb||r instanceof H_||r instanceof vb||r instanceof Fl||r instanceof G_||r instanceof gb||r instanceof Ym||r instanceof gD||r instanceof pD||r instanceof hD||r instanceof mD||r instanceof vD||r instanceof yD||r instanceof Dp||r instanceof xD||r instanceof bD)&&i.transform.push(r.assemble()),(r instanceof af||r instanceof tf||r instanceof Zm||r instanceof _d)&&i.transform.push(...r.assemble()),r instanceof Fo&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Fo?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Fo&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function HSt(e){const t=[],n=u1e(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function GSt(e,t){var n,r;const i=[],a=u1e(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();a(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function KSt(e){return e==="top"||e==="left"||Bt(e)?"header":"footer"}function XSt(e){for(const t of Cu)YSt(e,t);c1e(e,"x"),c1e(e,"y")}function YSt(e,t){var n;const{facet:r,config:i,child:a,component:o}=e;if(e.channelHasField(t)){const s=r[t],u=db("title",null,i,t);let l=Bm(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});a.component.layoutHeaders[t].title&&(l=Tt(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const c=db("labelOrient",s,i,t),f=(n=s.header)!==null&&n!==void 0?n:{},d=Di(f.labels,i.header.labels,!0),h=It(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:s,[h]:t==="facet"?[]:[l1e(e,t,d)]}}}function l1e(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function c1e(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:a}=e.component;if(a.axis[t]=p7(a,t),a.axis[t]==="shared"){const o=t==="x"?"column":"row",s=i[o];for(const u of r.component.axes[t]){const l=KSt(u.get("orient"));s[l]=(n=s[l])!==null&&n!==void 0?n:[l1e(e,o,!1)];const c=U_(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function ZSt(e){T7(e),wD(e,"width"),wD(e,"height")}function JSt(e){T7(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";wD(e,t),wD(e,n)}function T7(e){for(const t of e.children)t.parseLayoutSize()}function wD(e,t){const n=Ebe(t),r=EN(n),i=e.component.resolve,a=e.component.layoutSize;let o;for(const s of e.children){const u=s.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=Tp(o,u,n,"")}else o=u}if(o){for(const s of e.children)e.renameSignal(s.getName(n),e.getName(t)),s.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function QSt(e){const{size:t,component:n}=e;for(const r of Au){const i=Kc(r);if(t[i]){const a=t[i];n.layoutSize.set(i,ef(a)?"step":a,!0)}else{const a=eEt(e,i);n.layoutSize.set(i,a,!1)}}}function eEt(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const a=i.get("type"),o=i.get("range");if(ls(a)){const s=T_(r.view,t);return Sp(o)||ef(s)?"step":s}else return PU(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return PU(r.view,t);{const a=T_(r.view,t);return ef(a)?a.step:a}}}function O7(e,t,n){return Ye(t,Object.assign({suffix:`by_${Ye(e)}`},n??{}))}class K_ extends s1e{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=R7(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return E_(t)?j0e(t,(r,i,a)=>It([cd,fd],a)?i.field===void 0?(He(Y9(i,a)),r):(r[a]=_U(i,a,n),r):(He(TN(a,"facet")),r),{}):{facet:_U(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=_D(this),this.child.parseData()}parseLayoutSize(){T7(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),XSt(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const a of Cu)for(const o of f7){const s=this.component.layoutHeaders[a],u=s[o],{facetFieldDef:l}=s;if(l){const c=db("titleOrient",l,this.config,a);if(It(["right","bottom"],c)){const f=sD(a,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=a==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";a!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][a]=.5),s.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[a==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof K_))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof K_?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ye(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof K_){if(this.child.channelHasField("column")){const i=Ye(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Au){const a=this.child.component.scales[i];if(a&&!a.merged){const o=a.get("type"),s=a.get("range");if(ls(o)&&Sp(s)){const u=dD(this.child,i),l=E7(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):He(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:a,ops:o,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Cu){const f=this.facet[c];if(f){u.push(Ye(f));const{bin:d,sort:h}=f;if(Ar(d)&&u.push(Ye(f,{binSuffix:"end"})),Zc(h)){const{field:p,op:g=RN}=h,m=O7(f,h);r&&i?(a.push(m),o.push("max"),s.push(m)):(a.push(p),o.push(g),s.push(m))}else if(Tt(h)){const p=fb(f,c);a.push(p),o.push("max"),s.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||a.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),a.length?{fields:a,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Zc(r.sort)?[O7(r,r.sort,{expr:"datum"})]:Tt(r.sort)?[fb(r,t,{expr:"datum"})]:[Ye(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Zc(i)?i.order:!Tt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return d7(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of c7)if(t[i]){const a=db("labelOrient",t[i],n,i);if(It(r[i],a))return d7(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=HSt(n),i=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Cu.map(u=>this.facetSortFields(u)).flat(),order:Cu.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(ywt(this,[])))]}getMapping(){return this.facet}}function tEt(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const a of[n,r])if(Zc(a.sort)){const{field:o,op:s=RN}=a.sort;e=i=new Ym(e,{joinaggregate:[{op:s,field:o,as:O7(a,a.sort,{forAs:!0})}],groupby:[Ye(a)]})}return i}return null}function f1e(e,t){var n,r,i,a,o,s,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=h.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((a=h.format)===null||a===void 0?void 0:a.feature))&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((s=h.format)===null||s===void 0?void 0:s.feature))&&!((((u=e.format)===null||u===void 0?void 0:u.mesh)||((l=h.format)===null||l===void 0?void 0:l.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(GN(e)&&GN(h)){if(h_(e.values,h.values))return d}else if(O_(e)&&O_(h)){if(e.url===h.url)return d}else if(wye(e)&&e.name===d.dataName)return d}}return null}function nEt(e,t){if(e.data||!e.parent){if(e.data===null){const r=new hb({values:[]});return t.push(r),r}const n=f1e(e.data,t);if(n)return Vm(e.data)||(n.data.format=w0t({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new hb(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function rEt(e,t,n){var r,i;let a=0;for(const o of t.transforms){let s,u;if(jxt(o))u=e=new cb(e,o),s="derived";else if(Eye(o)){const l=X_t(o);u=e=(r=Qa.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new lb(e,t,o.filter)}else if(Uxt(o))u=e=af.makeFromTransform(e,o,t),s="number";else if(Vxt(o))s="date",n.getWithExplicit(o.field).value===void 0&&(e=new Qa(e,{[o.field]:s}),n.set(o.field,s,!1)),u=e=tf.makeFromTransform(e,o);else if(qxt(o))u=e=Fl.makeFromTransform(e,o),s="number",YU(t)&&(e=new Dp(e));else if(Oxt(o))u=e=G_.make(e,t,o,a++),s="derived";else if(Lxt(o))u=e=new gb(e,o),s="number";else if(Bxt(o))u=e=new Ym(e,o),s="number";else if(Hxt(o))u=e=_d.makeFromTransform(e,o),s="derived";else if(Gxt(o))u=e=new gD(e,o),s="derived";else if(zxt(o))u=e=new pD(e,o),s="derived";else if(Dxt(o))u=e=new bD(e,o),s="derived";else if($xt(o))e=new xD(e,o);else if(Wxt(o))u=e=Zm.makeFromTransform(e,o),s="derived";else if(Rxt(o))u=e=new hD(e,o),s="derived";else if(Fxt(o))u=e=new vD(e,o),s="derived";else if(Mxt(o))u=e=new yD(e,o),s="derived";else if(Pxt(o))u=e=new mD(e,o),s="derived";else{He(Ayt(o));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function _D(e){var t,n,r,i,a,o,s,u,l,c;let f=nEt(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new kxt,g=e.data;Vm(g)?(_ye(g)?f=new V_(f,g.sequence):jU(g)&&(f=new W_(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=Qa.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new Dp(f);const m=e.parent&&mb(e.parent);(oi(e)||Pl(e))&&m&&(f=(r=af.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=rEt(f,e,p));const v=Z_t(e),y=Y_t(e);f=(i=Qa.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,oi(e)&&(f=vb.parseAll(f,e),f=H_.parseAll(f,e)),(oi(e)||Pl(e))&&(m||(f=(a=af.makeFromEncoding(f,e))!==null&&a!==void 0?a:f),f=(o=tf.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=cb.parseAllForSortIndex(f,e));const b=e.getName(KN),x=new Fo(f,b,KN,h);if(d[b]=x,f=x,oi(e)){const _=Fl.makeFromEncoding(f,e);_&&(f=_,YU(e)&&(f=new Dp(f))),f=(s=Zm.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=_d.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}oi(e)&&(f=(l=q_.make(f,e))!==null&&l!==void 0?l:f);const w=e.getName(Ka),S=new Fo(f,w,Ka,h);d[w]=S,f=S,oi(e)&&q2t(e,S);let C=null;if(Pl(e)){const _=e.getName("facet");f=(c=tEt(f,e.facet))!==null&&c!==void 0?c:f,C=new pb(f,e,_,S.getSource()),d[_]=C}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:S,facetRoot:C,ancestorParse:p})}class iEt extends k7{constructor(t,n,r,i){var a,o,s,u;super(t,"concat",n,r,i,t.resolve);(((o=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&He(Eyt),this.children=this.getChildren(t).map((l,c)=>R7(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=_D(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Xe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return WN(t)?t.vconcat:MU(t)?t.hconcat:t.concat}parseLayoutSize(){JSt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=h7(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function aEt(e){return e===!1||e===null}const oEt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},sve),{labelExpr:1,encode:1}),d1e=Xe(oEt);class I7 extends yd{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new I7(gn(this.explicit),gn(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!aEt(this.get(t))}hasOrientSignalRef(){return Bt(this.explicit.orient)}}function sEt(e,t,n){var r;const{encoding:i,config:a}=e,o=(r=Gi(i[t]))!==null&&r!==void 0?r:Gi(i[Gc(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return Lm(l)?Object.assign({text:hU({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:a})},n):n}function uEt(e){return Au.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[gEt(n,e)]),t),{})}const lEt={bottom:"top",top:"bottom",left:"right",right:"left"};function cEt(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const o of Xe(a.component.axes))r.axis[o]=p7(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=fEt(n[o],a.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const a of Au){for(const o of e.children)if(!!o.component.axes[a]){if(r.axis[a]==="independent"){n[a]=((t=n[a])!==null&&t!==void 0?t:[]).concat(o.component.axes[a]);for(const s of o.component.axes[a]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!Bt(u)){if(i[u]>0&&!l){const c=lEt[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete o.component.axes[a]}if(r.axis[a]==="independent"&&n[a]&&n[a].length>1)for(const o of n[a])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function fEt(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){const o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=dEt(i,a)}}}else return t.map(n=>n.clone());return e}function dEt(e,t){for(const n of d1e){const r=Tp(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,a)=>{switch(n){case"title":return z0e(i,a);case"gridScale":return{explicit:i.explicit,value:Di(i.value,a.value)}}return HN(i,a,n,"axis")});e.setWithExplicit(n,r)}return e}function hEt(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Bt(n.labelAngle)?n.labelAngle:dN(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===ybe(r,i))return!0}return e===n[t]}const pEt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function gEt(e,t){var n,r,i;let a=t.axis(e);const o=new I7,s=Gi(t.encoding[e]),{mark:u,config:l}=t,c=(a==null?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||r_t(e),f=t.getScaleComponent(e).get("type"),d=Y2t(e,f,c,t.config),h=a!==void 0?!a:u7("disable",l,a==null?void 0:a.style,d).configValue;if(o.set("disable",h,a!==void 0),h)return o;a=a||{};const p=e_t(t,a,e,s,d),g={fieldOrDatumDef:s,axis:a,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of d1e){const b=y in gbe?gbe[y](g):uve(y)?a[y]:void 0,x=b!==void 0,w=hEt(b,y,a,t,e);if(x&&w)o.set(y,b,w);else{const{configValue:S=void 0,configFrom:C=void 0}=uve(y)&&y!=="values"?u7(y,t.config,a.style,d):{},_=S!==void 0;x&&!_?o.set(y,b,w):(C!=="vgAxisConfig"||pEt.has(y)&&_||z9(S)||Bt(S))&&o.set(y,S,!1)}}const m=(i=a.encoding)!==null&&i!==void 0?i:{},v=ove.reduce((y,b)=>{var x;if(!o.hasAxisPart(b))return y;const w=Cbe((x=m[b])!==null&&x!==void 0?x:{},t),S=b==="labels"?sEt(t,e,w):w;return S!==void 0&&!wr(S)&&(y[b]={update:S}),y},{});return wr(v)||o.set("encode",v,!!a.encoding||a.labelAngle!==void 0),o}function mEt({encoding:e,size:t}){for(const n of Au){const r=Kc(n);ef(t[r])&&Jc(e[n])&&(delete t[r],He(zve(r)))}return t}function vEt(e,t,n,{graticule:r}){const i=zc(e)?Object.assign({},e):{type:e},a=tr("orient",i,n);if(i.orient=wEt(i.type,t,a),a!==void 0&&a!==i.orient&&He(zyt(i.orient,a)),i.type==="bar"&&i.orient){const l=tr("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:j0t[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return tr("opacity",i,n)===void 0&&(i.opacity=bEt(i.type,t)),i.filled===void 0&&(i.filled=r?!1:xEt(i,n)),tr("cursor",i,n)===void 0&&(i.cursor=yEt(i,t,n)),i}function yEt(e,t,n){return t.href||e.href||tr("href",e,n)?"pointer":e.cursor}function bEt(e,t){if(It([mN,j9,U9,W9],e)&&!EU(t))return .7}function xEt(e,t){const n=jm("filled",e,t),r=e.type;return Di(n,r!==mN&&r!==gN&&r!==vN)}function wEt(e,t,n){switch(e){case mN:case U9:case W9:case cve:case R0t:case D0t:return}const{x:r,y:i,x2:a,y2:o}=t;switch(e){case pN:if(Qe(r)&&(Do(r.bin)||Qe(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Qe(i)&&(Do(i.bin)||Qe(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(Qe(r)&&r.type===Pm&&!Ar(r.bin)||yU(r)))return"horizontal";if(!o&&(Qe(i)&&i.type===Pm&&!Ar(i.bin)||yU(i)))return"vertical"}case vN:if(a&&!(Qe(r)&&Do(r.bin))&&o&&!(Qe(i)&&Do(i.bin)))return;case hN:if(o)return Qe(i)&&Do(i.bin)?"horizontal":"vertical";if(a)return Qe(r)&&Do(r.bin)?"vertical":"horizontal";if(e===vN){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case gN:case j9:{const s=Jc(r),u=Jc(i);if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===ib,d=c.type===ib;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const _Et={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Xa("x",e,{defaultPos:"mid"})),Xa("y",e,{defaultPos:"mid"})),Op(e,"radius","arc")),Op(e,"theta","arc"))},SEt={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),YN("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),YN("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),VU(e))},EEt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Op(e,"x","bar")),Op(e,"y","bar"))},CEt={vgMark:"shape",encodeEntry:e=>Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Qe(n)&&n.type===ab?{field:Ye(n,{expr:"datum"})}:{})]}},AEt={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Op(e,"x","image")),Op(e,"y","image")),UU(e,"url"))},kEt={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Xa("x",e,{defaultPos:"mid"})),Xa("y",e,{defaultPos:"mid"})),fa("size",e,{vgChannel:"strokeWidth"})),VU(e))},TEt={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Xa("x",e,{defaultPos:"mid"})),Xa("y",e,{defaultPos:"mid"})),fa("size",e)),VU(e))};function N7(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Xa("x",e,{defaultPos:"mid"})),Xa("y",e,{defaultPos:"mid"})),fa("size",e)),fa("angle",e)),OEt(e,n,t))}function OEt(e,t,n){return n?{shape:{value:n}}:fa("shape",e)}const IEt={vgMark:"symbol",encodeEntry:e=>N7(e)},NEt={vgMark:"symbol",encodeEntry:e=>N7(e,"circle")},DEt={vgMark:"symbol",encodeEntry:e=>N7(e,"square")},REt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Op(e,"x","rect")),Op(e,"y","rect"))},FEt={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),YN("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),YN("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),fa("size",e,{vgChannel:"strokeWidth"}))}},MEt={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Xa("x",e,{defaultPos:"mid"})),Xa("y",e,{defaultPos:"mid"})),UU(e)),fa("size",e,{vgChannel:"fontSize"})),fa("angle",e)),Rye("align",PEt(e.markDef,n,t))),Rye("baseline",$Et(e.markDef,n,t))),Xa("radius",e,{defaultPos:null,isMidPoint:!0})),Xa("theta",e,{defaultPos:null,isMidPoint:!0}))}};function PEt(e,t,n){if(tr("align",e,n)===void 0)return"center"}function $Et(e,t,n){if(tr("baseline",e,n)===void 0)return"middle"}const LEt={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",a=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Xa("x",e,{defaultPos:"mid",vgChannel:"xc"})),Xa("y",e,{defaultPos:"mid",vgChannel:"yc"})),fa("size",e,{defaultValue:BEt(e),vgChannel:i})),{[a]:yi(tr("thickness",n,t))})}};function BEt(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,a=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=tr("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&Sp(u)&&Ni(u.step)?u.step*3/4:VN(n.view,a)*3/4}}const SD={arc:_Et,area:SEt,bar:EEt,circle:NEt,geoshape:CEt,image:AEt,line:kEt,point:IEt,rect:REt,rule:FEt,square:DEt,text:MEt,tick:LEt,trail:TEt};function zEt(e){return It([gN,hN,F0t],e.mark)?jEt(e):It([pN],e.mark)?UEt(e):ED(e)}const h1e="faceted_path_";function jEt(e){const t=U0e(e.mark,e.encoding),n=ED(e,{fromPrefix:t.length>0?h1e:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:h1e+e.requestDataName(Ka),data:e.requestDataName(Ka),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const p1e="stack_group_";function UEt(e){const t=nU.some(n=>tr(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=ED(e,{fromPrefix:p1e}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),a=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},p_(n.encode.update,["y","yc","y2","height",...nU])),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},ud(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},p_(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},ud(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of nU){const d=jm(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=yi(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Ye(u)?[Ye(u)]:[];return((u==null?void 0:u.bin)||(u==null?void 0:u.timeUnit))&&l.push(Ye(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=jm(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:yi(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ka),name:p1e+e.requestDataName(Ka),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}else return ED(e)}function WEt(e){const{encoding:t,stack:n,mark:r,markDef:i,config:a}=e,o=t.order;if(!(!Tt(o)&&md(o)&&Zme(o.value)||!o&&Zme(tr("order",i,a)))){if((Tt(o)||Qe(o))&&!n)return $0e(o,{expr:"datum"});if(Nm(r)){const s=i.orient==="horizontal"?"y":"x",u=t[s];if(Qe(u)){const l=u.sort;if(Tt(l))return{field:Ye(u,{prefix:s,suffix:"sort_index",expr:"datum"})};if(Zc(l))return{field:Ye({aggregate:EU(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(b0e(l)){const c=e.fieldDef(l.encoding);return{field:Ye(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Ye(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function ED(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,a=Di(r.clip,VEt(e),qEt(e)),o=M0e(r),s=e.encoding.key,u=WEt(e),l=HEt(e),c=tr("aria",r,i),f=SD[n].postEncodingTransform?SD[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:SD[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ka)},encode:{update:SD[n].encodeEntry(e)}}),f?{transform:f}:{})]}function VEt(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function qEt(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function HEt(e){if(!e.component.selection)return null;const t=Xe(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Xe(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class g1e extends s1e{constructor(t,n,r,i={},a){var o,s;super(t,"unit",n,r,a,void 0,nye(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=zc(t.mark)?t.mark.type:t.mark;this.markDef=vEt(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},a,{graticule:t.data&&jU(t.data)});const l=this.encoding=C1t((s=t.encoding)!==null&&s!==void 0?s:{},this.markDef,a);this.size=mEt({encoding:l,size:nye(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=lye(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===fve,r=t&&nyt.some(i=>Kt(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return CN.reduce((r,i)=>{var a;const o=Gi(n[i]);return o&&(r[i]=(a=o.scale)!==null&&a!==void 0?a:{}),r},{})}initAxes(t){return Au.reduce((n,r)=>{const i=t[r];if(Kt(i)||r===Gr&&Kt(t.x2)||r===Hi&&Kt(t.y2)){const a=Kt(i)?i.axis:void 0;n[r]=a&&Object.assign({},a)}return n},{})}initLegend(t){return cyt.reduce((n,r)=>{const i=Gi(t[r]);if(i&&dyt(r)){const a=i.legend;n[r]=a&&Object.assign({},a)}return n},{})}parseData(){this.component.data=_D(this)}parseLayoutSize(){QSt(this)}parseSelections(){this.component.selection=V2t(this,this.selection)}parseMarkGroup(){this.component.mark=zEt(this)}parseAxesAndHeaders(){this.component.axes=uEt(this)}assembleSelectionTopLevelSignals(t){return bwt(this,t)}assembleSignals(){return[...fbe(this),...vwt(this,[])]}assembleSelectionData(t){return xwt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return h7(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!mb(this.parent))&&(n=Vye(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Um(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Qc(n)}typedFieldDef(t){const n=this.fieldDef(t);return Vs(n)?n:null}}class D7 extends k7{constructor(t,n,r,i,a){super(t,"layer",n,r,a,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(qN(s))return new D7(s,this,this.getName("layer_"+u),o,a);if(ld(s))return new g1e(s,this,this.getName("layer_"+u),o,a);throw new Error(X9(s))})}parseData(){this.component.data=_D(this);for(const t of this.children)t.parseData()}parseLayoutSize(){ZSt(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Xe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){cEt(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),fbe(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),h7(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return wwt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),Pbe(this))}}function R7(e,t,n,r,i){if(FN(e))return new K_(e,t,n,i);if(qN(e))return new D7(e,t,n,r,i);if(ld(e))return new g1e(e,t,n,r,i);if(H1t(e))return new iEt(e,t,n,i);throw new Error(X9(e))}function GEt(e,t={}){t.logger&&fbt(t.logger),t.fieldTitle&&O0e(t.fieldTitle);try{const n=oye(Xme(t.config,e.config)),r=vye(e,n),i=R7(r,null,"",void 0,n);return i.parse(),hSt(i.component.data,i),{spec:XEt(i,KEt(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&dbt(),t.fieldTitle&&y1t()}}function KEt(e,t,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):pn(t)&&(t={type:t}),i&&a&&Ext(t.type)){if(i==="step"&&a==="step")He(Nve()),t.type="pad";else if(i==="step"||a==="step"){const o=i==="step"?"width":"height";He(Nve(EN(o)));const s=o==="width"?"height":"width";t.type=Cxt(s)}}return Object.assign(Object.assign(Object.assign({},Xe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),bye(n)),bye(e))}function XEt(e,t,n={},r){const i=e.config?ixt(e.config):void 0,a=[].concat(e.assembleSelectionData([]),GSt(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class YEt extends sye{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:a,timeUnits:o,aggregate:s,groupby:u,encoding:l}=CU(r,n),c=[...i||[],...a,...o,...s.length===0?[]:[{aggregate:s,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const ZEt=new YEt;function JEt(e,t){return ZEt.map(e,{config:t})}const QEt=a0t.version;var eCt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",normalize:vye,version:QEt,compile:GEt,extractTransforms:JEt});function m1e(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var tCt="vega-themes",nCt="2.10.0",rCt="Themes for stylized Vega and Vega-Lite visualizations.",iCt=["vega","vega-lite","themes","style"],aCt="BSD-3-Clause",oCt={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},sCt=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],uCt="build/vega-themes.js",lCt="build/vega-themes.module.js",cCt="build/vega-themes.min.js",fCt="build/vega-themes.min.js",dCt="build/vega-themes.module.d.ts",hCt={type:"git",url:"https://github.com/vega/vega-themes.git"},pCt=["src","build"],gCt={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},mCt={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},vCt={vega:"*","vega-lite":"*"},yCt={name:tCt,version:nCt,description:rCt,keywords:iCt,license:aCt,author:oCt,contributors:sCt,main:uCt,module:lCt,unpkg:cCt,jsdelivr:fCt,types:dCt,repository:hCt,files:pCt,scripts:gCt,devDependencies:mCt,peerDependencies:vCt};const yb="#fff",bCt="#888",xCt={background:"#333",title:{color:yb,subtitleColor:yb},style:{"guide-label":{fill:yb},"guide-title":{fill:yb}},axis:{domainColor:yb,gridColor:bCt,tickColor:yb}},Jm="#4572a7",wCt={background:"#fff",arc:{fill:Jm},area:{fill:Jm},line:{stroke:Jm,strokeWidth:2},path:{stroke:Jm},rect:{fill:Jm},shape:{stroke:Jm},symbol:{fill:Jm,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Qm="#30a2da",F7="#cbcbcb",_Ct="#999",SCt="#333",v1e="#f0f0f0",y1e="#333",ECt={arc:{fill:Qm},area:{fill:Qm},axis:{domainColor:F7,grid:!0,gridColor:F7,gridWidth:1,labelColor:_Ct,labelFontSize:10,titleColor:SCt,tickColor:F7,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:v1e,group:{fill:v1e},legend:{labelColor:y1e,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:y1e,titleFontSize:14,titlePadding:10},line:{stroke:Qm,strokeWidth:2},path:{stroke:Qm,strokeWidth:.5},rect:{fill:Qm},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Qm},bar:{binSpacing:2,fill:Qm,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ev="#000",CCt={group:{fill:"#e5e5e5"},arc:{fill:ev},area:{fill:ev},line:{stroke:ev},path:{stroke:ev},rect:{fill:ev},shape:{stroke:ev},symbol:{fill:ev,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},ACt=22,kCt="normal",b1e="Benton Gothic, sans-serif",x1e=11.5,TCt="normal",tv="#82c6df",M7="Benton Gothic Bold, sans-serif",w1e="normal",_1e=13,X_={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},OCt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:M7,fontSize:ACt,fontWeight:kCt},arc:{fill:tv},area:{fill:tv},line:{stroke:tv,strokeWidth:2},path:{stroke:tv},rect:{fill:tv},shape:{stroke:tv},symbol:{fill:tv,size:30},axis:{labelFont:b1e,labelFontSize:x1e,labelFontWeight:TCt,titleFont:M7,titleFontSize:_1e,titleFontWeight:w1e},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:b1e,labelFontSize:x1e,symbolType:"square",titleFont:M7,titleFontSize:_1e,titleFontWeight:w1e},range:{category:X_["category-6"],diverging:X_["fireandice-6"],heatmap:X_["fire-7"],ordinal:X_["fire-7"],ramp:X_["fire-7"]}},nv="#ab5787",CD="#979797",ICt={background:"#f9f9f9",arc:{fill:nv},area:{fill:nv},line:{stroke:nv},path:{stroke:nv},rect:{fill:nv},shape:{stroke:nv},symbol:{fill:nv,size:30},axis:{domainColor:CD,domainWidth:.5,gridWidth:.2,labelColor:CD,tickColor:CD,tickWidth:.2,titleColor:CD},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},rv="#3e5c69",NCt={background:"#fff",arc:{fill:rv},area:{fill:rv},line:{stroke:rv},path:{stroke:rv},rect:{fill:rv},shape:{stroke:rv},symbol:{fill:rv},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ou="#1696d2",S1e="#000000",DCt="#FFFFFF",AD="Lato",P7="Lato",RCt="Lato",FCt="#DEDDDD",MCt=18,Y_={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},PCt={background:DCt,title:{anchor:"start",fontSize:MCt,font:AD},axisX:{domain:!0,domainColor:S1e,domainWidth:1,grid:!1,labelFontSize:12,labelFont:P7,labelAngle:0,tickColor:S1e,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:AD},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:FCt,gridWidth:1,labelFontSize:12,labelFont:P7,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:AD,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:P7,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:AD,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Y_["six-groups-cat-1"],diverging:Y_["diverging-colors"],heatmap:Y_["diverging-colors"],ordinal:Y_["six-groups-seq"],ramp:Y_["shades-blue"]},area:{fill:Ou},rect:{fill:Ou},line:{color:Ou,stroke:Ou,strokeWidth:5},trail:{color:Ou,stroke:Ou,strokeWidth:0,size:1},path:{stroke:Ou,strokeWidth:.5},point:{filled:!0},text:{font:RCt,color:Ou,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ou,stroke:null}},arc:{fill:Ou},shape:{stroke:Ou},symbol:{fill:Ou,size:30}},iv="#3366CC",E1e="#ccc",kD="Arial, sans-serif",$Ct={arc:{fill:iv},area:{fill:iv},path:{stroke:iv},rect:{fill:iv},shape:{stroke:iv},symbol:{stroke:iv},circle:{fill:iv},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:kD,fontSize:12},"guide-title":{font:kD,fontSize:12},"group-title":{font:kD,fontSize:12}},title:{font:kD,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:E1e,tickColor:E1e,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},LCt=yCt.version;var BCt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:xCt,excel:wCt,fivethirtyeight:ECt,ggplot2:CCt,googlecharts:$Ct,latimes:OCt,quartz:ICt,urbaninstitute:PCt,version:LCt,vox:NCt}),zCt=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const C1e="vg-tooltip-element",jCt={offsetX:10,offsetY:10,id:C1e,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:UCt,maxDepth:2};function UCt(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function WCt(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return zCt.toString().replace(C1e,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function VCt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function qCt(e,t,n){if(bt(e))return`[${e.map(r=>t(lr(r)?r:A1e(r,n))).join(", ")}]`;if(Xt(e)){let r="";const i=e,{title:a,image:o}=i,s=VCt(i,["title","image"]);a&&(r+=`<h2>${t(a)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Xt(c)&&(c=A1e(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function HCt(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function A1e(e,t){return JSON.stringify(e,HCt(t))}function GCt(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}class KCt{constructor(t){this.options=Object.assign(Object.assign({},jCt),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=WCt(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=qCt(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=GCt(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function TD(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function XCt(e,t,n){const r=e.open(t),i=1e4,a=250,{origin:o}=new URL(t);let s=~~(i/a);function u(c){c.source===r&&(s=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){s<=0||(r.postMessage(n,o),setTimeout(l,a),s-=1)}setTimeout(l,a)}var YCt=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function k1e(e,...t){for(const n of t)ZCt(e,n);return e}function ZCt(e,t){for(const n of Object.keys(t))Vk(e,n,t[n],!0)}var $7;const Sd=$vt;let bb=eCt;const OD=typeof window!="undefined"?window:void 0;bb===void 0&&(($7=OD==null?void 0:OD.vl)===null||$7===void 0?void 0:$7.compile)&&(bb=OD.vl);const T1e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},JCt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Z_={vega:"Vega","vega-lite":"Vega-Lite"},ID={vega:Sd.version,"vega-lite":bb?bb.version:"not available"},QCt={vega:e=>e,"vega-lite":(e,t)=>bb.compile(e,{config:t}).spec},eAt=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,tAt="chart-wrapper";function nAt(e){return typeof e=="function"}function O1e(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+a),o.document.title=`${Z_[r]} JSON Source`}function I1e(e,t){var n;if(e.$schema){const r=m1e(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${Z_[r.library]}, but mode argument sets ${(n=Z_[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return lae.satisfies(ID[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${Z_[i]} ${r.version}, but the current version of ${Z_[i]} is v${ID[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function rAt(e){return!!(e&&"load"in e)}function N1e(e){return rAt(e)?e:Sd.loader(e)}function D1e(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function iAt(e,t,n={}){var r,i,a;return TD(this,void 0,void 0,function*(){let o,s;lr(t)?(s=N1e(n.loader),o=JSON.parse(yield s.load(t))):o=t;const u=D1e(o).loader;(!s||u)&&(s=N1e((r=n.loader)!==null&&r!==void 0?r:u));const l=yield R1e(D1e(o),s),c=yield R1e(n,s),f=Object.assign(Object.assign({},k1e(c,l)),{config:Wk((i=c.config)!==null&&i!==void 0?i:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield oAt(e,o,f,s)})}function R1e(e,t){var n;return TD(this,void 0,void 0,function*(){const r=lr(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=lr(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function aAt(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function oAt(e,t,n={},r){var i,a,o,s,u,l;return TD(this,void 0,void 0,function*(){const c=n.theme?Wk(BCt[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=tB(n.actions)?n.actions:k1e({},T1e,(a=n.actions)!==null&&a!==void 0?a:{}),d=Object.assign(Object.assign({},JCt),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(s=n.logLevel)!==null&&s!==void 0?s:Sd.Warn,g=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:T,rootContainer:I}=aAt(m);if(!T.getElementById(k)){const N=document.createElement("style");N.id=k,N.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?YCt.toString():n.defaultStyle,I.appendChild(N)}}const v=I1e(t,n.mode);let y=QCt[v](t,c);if(v==="vega-lite"&&y.$schema){const k=m1e(y.$schema);lae.satisfies(ID.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${ID.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const k=document.createElement("div");k.classList.add(tAt),m.appendChild(k),b=k}const x=n.patch;x&&(x instanceof Function?y=x(y):y=Ak(y,x,!0,!1).newDocument),n.formatLocale&&Sd.formatLocale(n.formatLocale),n.timeFormatLocale&&Sd.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,S=Sd.parse(y,v==="vega-lite"?{}:c,{ast:w}),C=new(n.viewClass||Sd.View)(S,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:Sd.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;nAt(n.tooltip)?k=n.tooltip:k=new KCt(n.tooltip===!0?{}:n.tooltip).call,C.tooltip(k)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:k,updateSet:T}=typeof _=="boolean"?{}:_;C.hover(k,T)}n&&(n.width!=null&&C.width(n.width),n.height!=null&&C.height(n.height),n.padding!=null&&C.padding(n.padding)),yield C.initialize(b,n.bind).runAsync();let E;if(f!==!1){let k=m;if(n.defaultStyle!==!1){const I=document.createElement("details");I.title=d.CLICK_TO_VIEW_ACTIONS,m.append(I),k=I;const N=document.createElement("summary");N.innerHTML=eAt,I.append(N),E=O=>{I.contains(O.target)||I.removeAttribute("open")},document.addEventListener("click",E)}const T=document.createElement("div");if(k.append(T),T.classList.add("vega-actions"),f===!0||f.export!==!1){for(const I of["svg","png"])if(f===!0||f.export===!0||f.export[I]){const N=d[`${I.toUpperCase()}_ACTION`],O=document.createElement("a");O.text=N,O.href="#",O.target="_blank",O.download=`${g}.${I}`,O.addEventListener("mousedown",function(D){return TD(this,void 0,void 0,function*(){D.preventDefault();const P=yield C.toImageURL(I,n.scaleFactor);this.href=P})}),T.append(O)}}if(f===!0||f.source!==!1){const I=document.createElement("a");I.text=d.SOURCE_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;O1e(D4(t),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"",v),N.preventDefault()}),T.append(I)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const I=document.createElement("a");I.text=d.COMPILED_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;O1e(D4(y),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"","vega"),N.preventDefault()}),T.append(I)}if(f===!0||f.editor!==!1){const I=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",N=document.createElement("a");N.text=d.EDITOR_ACTION,N.href="#",N.addEventListener("click",function(O){XCt(window,I,{config:c,mode:v,renderer:h,spec:D4(t)}),O.preventDefault()}),T.append(N)}}function A(){E&&document.removeEventListener("click",E),C.finalize()}return{view:C,spec:t,vgSpec:y,finalize:A}})}var sAt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:iAt,DEFAULT_ACTIONS:T1e,guessMode:I1e,vega:Sd,get vegaLite(){return bb}}),xb=bf(sAt),Iu={},Ke={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var F1e=Object.getOwnPropertySymbols,uAt=Object.prototype.hasOwnProperty,lAt=Object.prototype.propertyIsEnumerable;function cAt(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function fAt(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(a){return!1}}var L7=fAt()?Object.assign:function(e,t){for(var n,r=cAt(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)uAt.call(n,o)&&(r[o]=n[o]);if(F1e){i=F1e(n);for(var s=0;s<i.length;s++)lAt.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},B7={};Object.defineProperty(B7,"__esModule",{value:!0}),B7.StyleSheet=$1e;var dAt=L7,hAt=pAt(dAt);function pAt(e){return e&&e.__esModule?e:{default:e}}function gAt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function z7(e){return e[e.length-1]}function M1e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var av=typeof window!="undefined",mAt=!1,vAt=function(){if(av){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function P1e(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function $1e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!mAt:t,r=e.maxLength,i=r===void 0?av&&vAt?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,hAt.default)($1e.prototype,{getSheet:function(){return M1e(z7(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");av?this.tags[0]=P1e():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch(r){}},insert:function(t){if(av)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=z7(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else z7(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,av&&this.ctr%this.maxLength==0&&this.tags.push(P1e()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){av?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!av)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(gAt(Array.from(M1e(n).cssRules))))}),t}});var wb={},yAt=/-(.)/g;function bAt(e){return e.replace(yAt,function(t,n){return n.toUpperCase()})}var xAt=bAt,wAt=xAt,_At=/^-ms-/;function SAt(e){return wAt(e.replace(_At,"ms-"))}var EAt=SAt,j7={},U7={};Object.defineProperty(U7,"__esModule",{value:!0});var ND={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function CAt(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var AAt=["Webkit","ms","Moz","O"];Object.keys(ND).forEach(function(e){AAt.forEach(function(t){ND[CAt(t,e)]=ND[e]})});var kAt={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},TAt={isUnitlessNumber:ND,shorthandPropertyExpansions:kAt};U7.default=TAt;function DD(e){return function(){return e}}var ov=function(){};ov.thatReturns=DD,ov.thatReturnsFalse=DD(!1),ov.thatReturnsTrue=DD(!0),ov.thatReturnsNull=DD(null),ov.thatReturnsThis=function(){return this},ov.thatReturnsArgument=function(e){return e};var OAt=ov,IAt=OAt,NAt=IAt,L1e=NAt;Object.defineProperty(j7,"__esModule",{value:!0});var DAt=U7,RAt=B1e(DAt),FAt=L1e;B1e(FAt);function B1e(e){return e&&e.__esModule?e:{default:e}}var z1e=RAt.default.isUnitlessNumber;function MAt(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||z1e.hasOwnProperty(e)&&z1e[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}j7.default=MAt;var PAt=/([A-Z])/g;function $At(e){return e.replace(PAt,"-$1").toLowerCase()}var LAt=$At,BAt=LAt,zAt=/^ms-/;function jAt(e){return BAt(e).replace(zAt,"-ms-")}var UAt=jAt;function WAt(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var VAt=WAt;Object.defineProperty(wb,"__esModule",{value:!0}),wb.processStyleName=void 0,wb.createMarkupForStyles=ekt;var qAt=EAt;J_(qAt);var HAt=j7,GAt=J_(HAt),KAt=UAt,XAt=J_(KAt),YAt=VAt,ZAt=J_(YAt),JAt=L1e;J_(JAt);function J_(e){return e&&e.__esModule?e:{default:e}}var QAt=wb.processStyleName=(0,ZAt.default)(XAt.default);function ekt(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var a=e[r];a!=null&&(i?n+=r+":"+a+";":(n+=QAt(r)+":",n+=(0,GAt.default)(r,a,t)+";"))}}return n||null}var W7={};Object.defineProperty(W7,"__esModule",{value:!0});var j1e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};W7.default=V7;function tkt(e){return e==null||e===!1||(typeof e=="undefined"?"undefined":j1e(e))==="object"&&Object.keys(e).length===0}function nkt(e){if(tkt(e))return null;if((typeof e=="undefined"?"undefined":j1e(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var a=e[n[i]],o=V7(a);(o===null||o!==a)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function rkt(e){var t=!1,n=[];return e.forEach(function(r){var i=V7(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function V7(e){return Array.isArray(e)?rkt(e):nkt(e)}var _b={},q7={},H7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(H7,H7.exports);var G7={exports:{}},RD={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(RD,RD.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=RD.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u){if(o.hasOwnProperty(s))for(var l=o[s],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(s)]=u[s]}e.exports=t.default}(G7,G7.exports);var K7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,a,o,s){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,a,o,s);if(c)return c}}e.exports=t.default})(K7,K7.exports);var X7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(a,o){if(a==="cursor"&&r.hasOwnProperty(o))return n.map(function(s){return s+o})}e.exports=t.default})(X7,X7.exports);var Y7={exports:{}},sv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(sv,sv.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=sv.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return a.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(Y7,Y7.exports);var Z7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=sv.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return a.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(Z7,Z7.exports);var J7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,a){if(i==="display"&&n.hasOwnProperty(a))return n[a]}e.exports=t.default})(J7,J7.exports);var Q7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(a,o,s){a==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?s.WebkitBoxOrient="vertical":s.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?s.WebkitBoxDirection="reverse":s.WebkitBoxDirection="normal"),r.hasOwnProperty(a)&&(s[r[a]]=n[o]||o)}e.exports=t.default})(Q7,Q7.exports);var eW={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=sv.exports,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var a=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function s(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return a.map(function(c){return c+l})}e.exports=t.default})(eW,eW.exports);var tW={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=sv.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return a.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(tW,tW.exports);var nW={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(nW,nW.exports);var rW={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function a(o,s){if(r.hasOwnProperty(o)&&i.hasOwnProperty(s))return n.map(function(u){return u+s})}e.exports=t.default})(rW,rW.exports);var iW={exports:{}},aW={exports:{}},ikt=/[A-Z]/g,akt=/^ms-/,oW={};function okt(e){return"-"+e.toLowerCase()}function skt(e){if(oW.hasOwnProperty(e))return oW[e];var t=e.replace(ikt,okt);return oW[e]=akt.test(t)?"-"+t:t}var ukt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:skt}),lkt=bf(ukt);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=lkt,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return(0,r.default)(o)}e.exports=t.default})(aW,aW.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=aW.exports,r=u(n),i=sv.exports,a=u(i),o=RD.exports,s=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,a.default)(h))return h;for(var g=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var S=p[x],C=0,_=S.length;C<_;++C)b.unshift(y.replace(w,c[S[C]]+w))}g[m]=b.join(",")}return g.join(",")}function d(h,p,g,m){if(typeof p=="string"&&l.hasOwnProperty(h)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?b:(g["Webkit"+(0,s.default)(h)]=y,g["Moz"+(0,s.default)(h)]=b,v)}}e.exports=t.default}(iW,iW.exports),Object.defineProperty(q7,"__esModule",{value:!0}),q7.default=$kt;var ckt=H7.exports,fkt=Gs(ckt),dkt=G7.exports,hkt=Gs(dkt),pkt=K7.exports,gkt=Gs(pkt),mkt=X7.exports,vkt=Gs(mkt),ykt=Y7.exports,bkt=Gs(ykt),xkt=Z7.exports,wkt=Gs(xkt),_kt=J7.exports,Skt=Gs(_kt),Ekt=Q7.exports,Ckt=Gs(Ekt),Akt=eW.exports,kkt=Gs(Akt),Tkt=tW.exports,Okt=Gs(Tkt),Ikt=nW.exports,Nkt=Gs(Ikt),Dkt=rW.exports,Rkt=Gs(Dkt),Fkt=iW.exports,Mkt=Gs(Fkt);function Gs(e){return e&&e.__esModule?e:{default:e}}var Pkt=[bkt.default,vkt.default,wkt.default,Ckt.default,kkt.default,Okt.default,Nkt.default,Rkt.default,Mkt.default,Skt.default],U1e=fkt.default.prefixMap;function $kt(e){for(var t in e){var n=e[t],r=(0,gkt.default)(Pkt,t,n,e,U1e);r&&(e[t]=r),(0,hkt.default)(U1e,t,e)}return e}Object.defineProperty(_b,"__esModule",{value:!0});var sW=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};_b.PluginSet=V1e,_b.fallbacks=Wkt,_b.contentWrap=qkt,_b.prefixes=Hkt;var Lkt=L7,uW=W1e(Lkt),Bkt=wb,zkt=q7,jkt=W1e(zkt);function W1e(e){return e&&e.__esModule?e:{default:e}}var Ukt=function(e){return e==="development"||!e}("production");function V1e(e){this.fns=e||[]}(0,uW.default)(V1e.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(a){t.fns.indexOf(a)>=0?Ukt&&console.warn("adding the same plugin again, ignoring"):t.fns=[a].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function Wkt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,a){return i[a]=Array.isArray(n[a])?n[a].join("; "+(0,Bkt.processStyleName)(a)+": "):n[a],i},{});return(0,uW.default)({},e,{style:r})}return e}var Vkt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function qkt(e){if(e.style.content){var t=e.style.content;return Vkt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:sW({},e,{style:sW({},e.style,{content:'"'+t+'"'})})}return e}function Hkt(e){return(0,uW.default)({},e,{style:(0,jkt.default)(sW({},e.style))})}var lW={};Object.defineProperty(lW,"__esModule",{value:!0}),lW.default=Gkt;function Gkt(e,t){for(var n=1540483477,r=24,i=t^e.length,a=e.length,o=0;a>=4;){var s=Kkt(e,o);s=uv(s,n),s^=s>>>r,s=uv(s,n),i=uv(i,n),i^=s,o+=4,a-=4}switch(a){case 3:i^=q1e(e,o),i^=e.charCodeAt(o+2)<<16,i=uv(i,n);break;case 2:i^=q1e(e,o),i=uv(i,n);break;case 1:i^=e.charCodeAt(o),i=uv(i,n);break}return i^=i>>>13,i=uv(i,n),i^=i>>>15,i>>>0}function Kkt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function q1e(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function uv(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.compose=Ke.merge=Ke.$=Ke.style=Ke.presets=Ke.keyframes=Ke.fontFace=Ke.insertGlobal=Ke.insertRule=Ke.plugins=Ke.styleSheet=void 0,Ke.speedy=tTt,Ke.simulations=nTt,Ke.simulate=rTt,Ke.cssLabels=iTt,Ke.isLikeRule=pW,Ke.idFor=gW,Ke.css=da,Ke.rehydrate=yTt,Ke.flush=bTt,Ke.select=yW,Ke.parent=wTt,Ke.media=_Tt,Ke.pseudo=Ut,Ke.active=STt,Ke.any=ETt,Ke.checked=CTt,Ke.disabled=ATt,Ke.empty=kTt,Ke.enabled=TTt,Ke._default=OTt,Ke.first=ITt,Ke.firstChild=NTt,Ke.firstOfType=DTt,Ke.fullscreen=RTt,Ke.focus=FTt,Ke.hover=MTt,Ke.indeterminate=PTt,Ke.inRange=$Tt,Ke.invalid=LTt,Ke.lastChild=BTt,Ke.lastOfType=zTt,Ke.left=jTt,Ke.link=UTt,Ke.onlyChild=WTt,Ke.onlyOfType=VTt,Ke.optional=qTt,Ke.outOfRange=HTt,Ke.readOnly=GTt,Ke.readWrite=KTt,Ke.required=XTt,Ke.right=YTt,Ke.root=ZTt,Ke.scope=JTt,Ke.target=QTt,Ke.valid=eOt,Ke.visited=tOt,Ke.dir=nOt,Ke.lang=rOt,Ke.not=iOt,Ke.nthChild=aOt,Ke.nthLastChild=oOt,Ke.nthLastOfType=sOt,Ke.nthOfType=uOt,Ke.after=lOt,Ke.before=cOt,Ke.firstLetter=fOt,Ke.firstLine=dOt,Ke.selection=hOt,Ke.backdrop=pOt,Ke.placeholder=gOt,Ke.cssFor=mOt,Ke.attribsFor=vOt;var Xkt=L7,Ykt=fW(Xkt),Zkt=B7,cW=wb,Jkt=W7,Mp=fW(Jkt),Ed=_b,Qkt=lW,eTt=fW(Qkt);function fW(e){return e&&e.__esModule?e:{default:e}}function Q_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ks=Ke.styleSheet=new Zkt.StyleSheet;Ks.inject();function tTt(e){return Ks.speedy(e)}var eS=Ke.plugins=Ks.plugins=new Ed.PluginSet([Ed.prefixes,Ed.contentWrap,Ed.fallbacks]);eS.media=new Ed.PluginSet,eS.fontFace=new Ed.PluginSet,eS.keyframes=new Ed.PluginSet([Ed.prefixes,Ed.fallbacks]);var dW=!1,FD=typeof window!="undefined",hW=dW,H1e=!1,G1e=!1;function nTt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;hW=!!e}function rTt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,Mp.default)(t),t?hW?t.reduce(function(r,i){return r["data-simulate-"+MD(i)]="",r},{}):(H1e||(console.warn("can't simulate without once calling simulations(true)"),H1e=!0),G1e||(console.warn("don't use simulation outside dev"),G1e=!0),{}):{}}var tS=dW;function iTt(e){tS=!!e}function MD(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function nS(e){var t=JSON.stringify(e),n=(0,eTt.default)(t).toString(36);return e.label&&e.label.length>0&&dW?MD(e.label.join("."),"-")+"-"+n:n}function pW(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function gW(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var aTt=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function mW(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=aTt.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function K1e(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=mW(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return hW&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+MD(t)+"],[data-css-"+e+"][data-simulate-"+MD(t)+"]"),n}function vW(e){var t=e.selector,n=e.style,r=eS.transform({selector:t,style:n});return r.selector+"{"+(0,cW.createMarkupForStyles)(r.style)+"}"}function PD(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(a){a.indexOf("&")>=0?(n=n||{},n[a]=e[a]):a.indexOf("@media")===0?(r=r||{},r[a]=PD(e[a])):a.indexOf("@supports")===0?(i=i||{},i[a]=PD(e[a])):a==="label"?e.label.length>0&&(t=t||{},t.label=tS?e.label.join("."):""):(t=t||{},t[a]=e[a])}),{plain:t,selects:n,medias:r,supports:i}}function $D(e,t){var n=[],r=t.plain,i=t.selects,a=t.medias,o=t.supports;return r&&n.push(vW({style:r,selector:K1e(e)})),i&&Object.keys(i).forEach(function(s){return n.push(vW({style:i[s],selector:K1e(e,s)}))}),a&&Object.keys(a).forEach(function(s){return n.push(s+"{"+$D(e,a[s]).join("")+"}")}),o&&Object.keys(o).forEach(function(s){return n.push(s+"{"+$D(e,o[s]).join("")+"}")}),n}var $l=Ks.inserted={};function oTt(e){if(!$l[e.id]){$l[e.id]=!0;var t=PD(e.style),n=$D(e.id,t);$l[e.id]=FD?!0:n,n.forEach(function(r){return Ks.insert(r)})}}var rS=Ks.registered={};function LD(e){rS[e.id]||(rS[e.id]=e)}function sTt(e){if(pW(e)){var t=rS[gW(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var BD={};function uTt(e){if(LD(e),oTt(e),BD[e.id])return BD[e.id];var t=Q_({},"data-css-"+e.id,tS&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),BD[e.id]=t,t}function lTt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function X1e(e,t){var n=mW(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=mW(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,a){return i.concat(n.map(function(o){return a.replace(/\&/g,o)}))},[]).join(",")}function cTt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function fTt(e){return e.indexOf("@media")===0}function dTt(e){return e.indexOf("@supports")===0}function hTt(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function Y1e(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(Y1e(e[n])):t=t.concat(e[n]);return t}var Z1e={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function lv(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,a=i===void 0?"":i,o=t.supp,s=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=Y1e(l),l.forEach(function(c){if(pW(c)){var f=sTt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,Mp.default)(c),c&&c.composes&&lv(e,{selector:r,mq:a,supp:s,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(lTt(d))Z1e[d]&&Z1e[d].forEach(function(p){return lv(e,{selector:X1e(r,p),mq:a,supp:s,src:c[d]})}),lv(e,{selector:X1e(r,d),mq:a,supp:s,src:c[d]});else if(fTt(d))lv(e,{selector:r,mq:cTt(a,d),supp:s,src:c[d]});else if(dTt(d))lv(e,{selector:r,mq:a,supp:hTt(s,d),src:c[d]});else if(d!=="composes"){var h=e;s&&(h[s]=h[s]||{},h=h[s]),a&&(h[a]=h[a]||{},h=h[a]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?tS&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function J1e(e){var t={label:[]};lv(t,{src:e});var n={id:nS(t),style:t,label:tS?t.label.join("."):"",type:"css"};return uTt(n)}var zD={};Object.defineProperty(zD,"toString",{enumerable:!1,value:function(){return"css-nil"}});var jD=typeof WeakMap!="undefined"?[zD,new WeakMap,new WeakMap,new WeakMap]:[zD];function pTt(e){return function(t){if(jD[t.length]){for(var n=jD[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(rS[i.toString().substring(4)])return i}}var a=e(t);if(jD[t.length]){for(var o=0,s=jD[t.length];o<t.length-1;)s=s.get(t[o]),o++;try{s.set(t[o],a)}catch(u){}}return a}}var gTt=typeof WeakMap!="undefined"?pTt(J1e):J1e;function da(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,Mp.default)(t),t?gTt(t):zD}da.insert=function(e){var t={id:nS(e),css:e,type:"raw"};LD(t),$l[t.id]||(Ks.insert(t.css),$l[t.id]=FD?!0:[t.css])},Ke.insertRule=da.insert,da.global=function(e,t){if(t=(0,Mp.default)(t),t)return da.insert(vW({selector:e,style:t}))},Ke.insertGlobal=da.global;function mTt(e){if(!$l[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=eS.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,cW.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Ks.insert(r)}),$l[e.id]=FD?!0:n}}da.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,Mp.default)(t)||{};var n={id:nS({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return LD(n),mTt(n),e+"_"+n.id},da.fontFace=function(e){e=(0,Mp.default)(e);var t={id:nS(e),type:"font-face",font:e};return LD(t),vTt(t),e.fontFamily},Ke.fontFace=da.fontFace,Ke.keyframes=da.keyframes;function vTt(e){if(!$l[e.id]){var t="@font-face{"+(0,cW.createMarkupForStyles)(e.font)+"}";Ks.insert(t),$l[e.id]=FD?!0:[t]}}function yTt(e){(0,Ykt.default)($l,e.reduce(function(t,n){return t[n]=!0,t},{}))}function bTt(){$l=Ks.inserted={},rS=Ks.registered={},BD={},Ks.flush(),Ks.inject()}Ke.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var xTt=Ke.style=da;function yW(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?da(Q_({},e,n)):xTt(n)}Ke.$=yW;function wTt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return da(Q_({},e+" &",n))}Ke.merge=da,Ke.compose=da;function _Tt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return da(Q_({},"@media "+e,n))}function Ut(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return da(Q_({},e,n))}function STt(e){return Ut(":active",e)}function ETt(e){return Ut(":any",e)}function CTt(e){return Ut(":checked",e)}function ATt(e){return Ut(":disabled",e)}function kTt(e){return Ut(":empty",e)}function TTt(e){return Ut(":enabled",e)}function OTt(e){return Ut(":default",e)}function ITt(e){return Ut(":first",e)}function NTt(e){return Ut(":first-child",e)}function DTt(e){return Ut(":first-of-type",e)}function RTt(e){return Ut(":fullscreen",e)}function FTt(e){return Ut(":focus",e)}function MTt(e){return Ut(":hover",e)}function PTt(e){return Ut(":indeterminate",e)}function $Tt(e){return Ut(":in-range",e)}function LTt(e){return Ut(":invalid",e)}function BTt(e){return Ut(":last-child",e)}function zTt(e){return Ut(":last-of-type",e)}function jTt(e){return Ut(":left",e)}function UTt(e){return Ut(":link",e)}function WTt(e){return Ut(":only-child",e)}function VTt(e){return Ut(":only-of-type",e)}function qTt(e){return Ut(":optional",e)}function HTt(e){return Ut(":out-of-range",e)}function GTt(e){return Ut(":read-only",e)}function KTt(e){return Ut(":read-write",e)}function XTt(e){return Ut(":required",e)}function YTt(e){return Ut(":right",e)}function ZTt(e){return Ut(":root",e)}function JTt(e){return Ut(":scope",e)}function QTt(e){return Ut(":target",e)}function eOt(e){return Ut(":valid",e)}function tOt(e){return Ut(":visited",e)}function nOt(e,t){return Ut(":dir("+e+")",t)}function rOt(e,t){return Ut(":lang("+e+")",t)}function iOt(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?Ut(":not("+e+")",t):yW(n.join(""),t)}function aOt(e,t){return Ut(":nth-child("+e+")",t)}function oOt(e,t){return Ut(":nth-last-child("+e+")",t)}function sOt(e,t){return Ut(":nth-last-of-type("+e+")",t)}function uOt(e,t){return Ut(":nth-of-type("+e+")",t)}function lOt(e){return Ut("::after",e)}function cOt(e){return Ut("::before",e)}function fOt(e){return Ut("::first-letter",e)}function dOt(e){return Ut("::first-line",e)}function hOt(e){return Ut("::selection",e)}function pOt(e){return Ut("::backdrop",e)}function gOt(e){return da({"::placeholder":e})}function mOt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,Mp.default)(t),t?t.map(function(r){var i={label:[]};return lv(i,{src:r}),$D(nS(i),PD(i)).join("")}).join(""):""}function vOt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,Mp.default)(t);var r=t?t.map(function(i){gW(i);var a=Object.keys(i)[0],o=i[a];return a+'="'+(o||"")+'"'}).join(" "):"";return r}var Mo={},iS={};Object.defineProperty(iS,"__esModule",{value:!0});function yOt(e){return e.name!=null}iS.isSurfaceInfo=yOt;function bOt(e){return e.drawArea instanceof HTMLElement}iS.isSurface=bOt;var aS={},bW={};function xOt(){}var ds={},Sb=[],Q1e=[];function oS(e,t){var n=Q1e,r,i,a,o;for(o=arguments.length;o-- >2;)Sb.push(arguments[o]);for(t&&t.children!=null&&(Sb.length||Sb.push(t.children),delete t.children);Sb.length;)if((i=Sb.pop())&&i.pop!==void 0)for(o=i.length;o--;)Sb.push(i[o]);else typeof i=="boolean"&&(i=null),(a=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(a=!1)),a&&r?n[n.length-1]+=i:n===Q1e?n=[i]:n.push(i),r=a;var s=new xOt;return s.nodeName=e,s.children=n,s.attributes=t??void 0,s.key=t==null?void 0:t.key,ds.vnode!==void 0&&ds.vnode(s),s}function Pp(e,t){for(var n in t)e[n]=t[n];return e}var wOt=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function exe(e,t){return oS(e.nodeName,Pp(Pp({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var _Ot=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,xW=[];function txe(e){!e._dirty&&(e._dirty=!0)&&xW.push(e)==1&&(ds.debounceRendering||wOt)(wW)}function wW(){var e,t=xW;for(xW=[];e=t.pop();)e._dirty&&VD(e)}function SOt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&nxe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function nxe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function rxe(e){var t=Pp({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function EOt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function _W(e){var t=e.parentNode;t&&t.removeChild(e)}function ixe(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]=typeof r[a]=="number"&&_Ot.test(a)===!1?r[a]+"px":r[a]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,axe,o):e.removeEventListener(t,axe,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)COt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function COt(e,t,n){try{e[t]=n}catch(r){}}function axe(e){return this._listeners[e.type](ds.event&&ds.event(e)||e)}var oxe=[],SW=0,$p=!1,UD=!1;function sxe(){for(var e;e=oxe.pop();)ds.afterMount&&ds.afterMount(e),e.componentDidMount&&e.componentDidMount()}function uxe(e,t,n,r,i,a){SW++||($p=i!=null&&i.ownerSVGElement!==void 0,UD=e!=null&&!("__preactattr_"in e));var o=lxe(e,t,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--SW||(UD=!1,a||sxe()),o}function lxe(e,t,n,r,i){var a=e,o=$p;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),cv(e,!0))),a.__preactattr_=!0,a;var s=t.nodeName;if(typeof s=="function")return IOt(e,t,n,r);if($p=s==="svg"?!0:s==="foreignObject"?!1:$p,s=String(s),(!e||!nxe(e,s))&&(a=EOt(s,$p),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),cv(e,!0)}var u=a.firstChild,l=a.__preactattr_,c=t.children;if(l==null){l=a.__preactattr_={};for(var f=a.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!UD&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&AOt(a,c,n,r,UD||l.dangerouslySetInnerHTML!=null),kOt(a,t.attributes,l),$p=o,a}function AOt(e,t,n,r,i){var a=e.childNodes,o=[],s={},u=0,l=0,c=a.length,f=0,d=t?t.length:0,h,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=a[y],x=b.__preactattr_,w=d&&x?b._component?b._component.__key:x.key:null;w!=null?(u++,s[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(o[f++]=b)}if(d!==0)for(var y=0;y<d;y++){m=t[y],v=null;var w=m.key;if(w!=null)u&&s[w]!==void 0&&(v=s[w],s[w]=void 0,u--);else if(!v&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&SOt(p=o[h],m,i)){v=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}v=lxe(v,m,n,r),g=a[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?_W(g):e.insertBefore(v,g))}if(u)for(var y in s)s[y]!==void 0&&cv(s[y],!1);for(;l<=f;)(v=o[f--])!==void 0&&cv(v,!1)}function cv(e,t){var n=e._component;n?qD(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&_W(e),cxe(e))}function cxe(e){for(e=e.lastChild;e;){var t=e.previousSibling;cv(e,!0),e=t}}function kOt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&ixe(e,r,n[r],n[r]=void 0,$p);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&ixe(e,r,n[r],n[r]=t[r],$p)}var EW={};function TOt(e){var t=e.constructor.name;(EW[t]||(EW[t]=[])).push(e)}function fxe(e,t,n){var r=EW[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),sS.call(i,t,n)):(i=new sS(t,n),i.constructor=e,i.render=OOt),r){for(var a=r.length;a--;)if(r[a].constructor===e){i.nextBase=r[a].nextBase,r.splice(a,1);break}}return i}function OOt(e,t,n){return this.constructor(e,n)}function WD(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||ds.syncComponentUpdates!==!1||!e.base?VD(e,1,i):txe(e)),e.__ref&&e.__ref(e))}function VD(e,t,n,r){if(!e._disable){var i=e.props,a=e.state,o=e.context,s=e.prevProps||i,u=e.prevState||a,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,g,m,v;if(c&&(e.props=s,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,a,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,a,o),e.props=i,e.state=a,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,a,o),e.getChildContext&&(o=Pp(Pp({},o),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=rxe(g);m=h,m&&m.constructor===y&&w.key==m.__key?WD(m,w,1,o,!1):(b=m,e._component=m=fxe(y,w,o),m.nextBase=m.nextBase||f,m._parentComponent=e,WD(m,w,0,o,!1),VD(m,1,n,!0)),x=m.base}else v=d,b=h,b&&(v=e._component=null),(d||t===1)&&(v&&(v._component=null),x=uxe(v,g,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&m!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),b||(d._component=null,cv(d,!1)))}if(b&&qD(b),e.base=x,x&&!r){for(var C=e,_=e;_=_._parentComponent;)(C=_).base=x;x._component=C,x._componentConstructor=C.constructor}}if(!c||n?oxe.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(s,u,l),ds.afterUpdate&&ds.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!SW&&!r&&sxe()}}function IOt(e,t,n,r){for(var i=e&&e._component,a=i,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=rxe(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(WD(i,l,3,n,r),e=i.base):(a&&!s&&(qD(a),e=o=null),i=fxe(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),WD(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,cv(o,!1))),e}function qD(e){ds.beforeUnmount&&ds.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?qD(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,_W(t),TOt(e),cxe(t)),e.__ref&&e.__ref(null)}function sS(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}Pp(sS.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=Pp({},r)),Pp(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),txe(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),VD(this,2)},render:function(){}});function dxe(e,t,n){return uxe(n,e,{},!1,t,!1)}var NOt={h:oS,createElement:oS,cloneElement:exe,Component:sS,render:dxe,rerender:wW,options:ds},DOt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:NOt,h:oS,createElement:oS,cloneElement:exe,Component:sS,render:dxe,rerender:wW,options:ds}),CW=bf(DOt),AW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(AW,"__esModule",{value:!0});const HD=CW,kW=Ke;class Eb extends HD.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},Eb.defaultStyles,r),{width:a,height:o}=i;let{maxHeight:s,maxWidth:u}=i;s=o===Eb.defaultStyles.height?s:o,u=a===Eb.defaultStyles.width?u:a;const l=kW.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:a,maxHeight:s,maxWidth:u,overflow:"auto"}),c=kW.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=kW.css({boxSizing:"border-box"});return HD.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},HD.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),HD.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}Eb.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},AW.SurfaceComponent=Eb;var TW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(TW,"__esModule",{value:!0});const uS=CW,hxe=Ke;class ROt extends uS.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>uS.h(FOt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,a=hxe.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return uS.h("div",{className:`${a} visor-tabs`},i)}}TW.Tabs=ROt;class FOt extends uS.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,a=hxe.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return uS.h("a",{className:`${a} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(bW,"__esModule",{value:!0});const Ll=CW,fv=Ke,MOt=AW,POt=TW;class OW extends Ll.Component{static render(t,n,r){return Ll.render(Ll.h(OW,Object.assign({},r)),t,n)}constructor(t){super(t);this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(a=>a.tab),r=this.state.tabs;let i;for(const a of n)r.has(a)||(r.add(a),i=a);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){const n=192;t.keyCode===n&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,a=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=fv.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=fv.css({right:"0"}),f=fv.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=fv.css({});return Ll.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},Ll.h($Ot,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),Ll.h(POt.Tabs,{tabNames:a,activeTab:r,handleClick:this.setActiveTab.bind(this)}),Ll.h("div",{className:`${h} visor-surfaces`},i.map(p=>Ll.h(MOt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}bW.VisorComponent=OW;function $Ot(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=fv.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),a=fv.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=fv.css({marginLeft:"auto"});return Ll.h("div",{className:`${i} visor-controls`},Ll.h("button",{className:`${a}`,onClick:n},t?"Minimize":"Maximize"),Ll.h("button",{className:`${a} ${o}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(aS,"__esModule",{value:!0});const LOt=bW;let GD;const BOt="Visor",IW="tfjs-visor-container";function zOt(){if(typeof document=="undefined")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(IW)&&GD!=null)return GD;let e=document.getElementById(IW);e==null&&(e=document.createElement("div"),e.id=IW,document.body.appendChild(e));let t;function n(a,o){let s=null;return t=LOt.VisorComponent.render(a,t,{ref:u=>s=u,surfaceList:Array.from(o.values())}),s}const r=new Map,i=n(e,r);return GD=new pxe(i,e,r,n),GD}aS.visor=zOt;class pxe{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?BOt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),a=`${n}-${r}`;return this.surfaceList.has(a)||this.surfaceList.set(a,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}aS.Visor=pxe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jOt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Mo,"__esModule",{value:!0});const gxe=iS,UOt=aS;function WOt(e){if(e instanceof HTMLElement)return e;if(gxe.isSurface(e))return e.drawArea;if(gxe.isSurfaceInfo(e))return UOt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Mo.getDrawArea=WOt;function VOt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a])return!1}return!0}Mo.shallowEquals=VOt;function qOt(){return jOt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Mo.nextFrame=qOt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Iu,"__esModule",{value:!0});const mxe=Ke,HOt=Mo,GOt={prepend:!1};function KOt(e,t,n={}){const r=HOt.getDrawArea(e),i=mxe.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),a=mxe.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},GOt,n);let s=r.querySelector(`div[data-name=${t}]`);if(!s){if(s=document.createElement("div"),s.setAttribute("class",`${i}`),s.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${a}`),u.innerText=o.title,s.appendChild(u)}o.prepend?r.insertBefore(s,r.firstChild):r.appendChild(s)}return s}Iu.subSurface=KOt;function XOt(e){const t=50;let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=t;return r.clientWidth-n}Iu.getDefaultWidth=XOt;function YOt(e){return e.clientHeight===0?200:e.clientHeight}Iu.getDefaultHeight=YOt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ZOt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},JOt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(E4,"__esModule",{value:!0});const QOt=JOt(xb),vxe=Iu,KD=Mo;function eIt(e,t,n={}){return ZOt(this,void 0,void 0,function*(){const r=KD.getDrawArea(e),i=t,a=Object.assign({},tIt,n);if(NW.has(r)){const m=NW.get(r);if(KD.shallowEquals(a,m.lastOptions)){yield KD.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:o,yLabel:s,xType:u,yType:l}=a;let c=null;o!=null&&(c={title:o});let f=null;s!=null&&(f={title:s});const d={actions:!1,mode:"vega-lite",defaultStyle:!1};let h;a.color!=null?Array.isArray(a.color)?h={field:"index",type:"nominal",scale:{range:a.color}}:h={value:a.color}:h={value:"#4C78A0"};const p={width:a.width||vxe.getDefaultWidth(r),height:a.height||vxe.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f},color:h}};yield KD.nextFrame();const g=yield QOt.default(r,p,d);NW.set(r,{view:g.view,lastOptions:a})})}E4.barchart=eIt;const tIt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},NW=new Map;var DW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nIt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},rIt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(DW,"__esModule",{value:!0});const iIt=rIt(xb),yxe=Iu,aIt=Mo;function oIt(e,t,n={}){return nIt(this,void 0,void 0,function*(){const r=Object.assign({},sIt,n),i=aIt.getDrawArea(e),a=[],o=t.values,s=t.tickLabels||[],u=s.length===0;let l=!0;for(let h=0;h<o.length;h++){const p=u?`Class ${h}`:s[h];u&&s.push(p);for(let g=0;g<o[h].length;g++){const m=u?`Class ${g}`:s[g],v=o[h][g];h===g&&!r.shadeDiagonal?a.push({label:p,prediction:m,count:v,noFill:!0}):(a.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const h of a)h.noFill===!0&&(h.noFill=!1,h.scaleCount=h.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||yxe.getDefaultWidth(i),height:r.height||yxe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:a},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:s}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:s}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield iIt.default(i,f,c)})}DW.confusionMatrix=oIt;const sIt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var RW={},Cd={};Object.defineProperty(Cd,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}Cd.assert=bxe;function uIt(e,t,n=""){bxe(xxe(e,t),n+` Shapes ${e} and ${t} must match`)}Cd.assertShapesMatch=uIt;function xxe(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Cd.arraysEqual=xxe,Cd.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wxe=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},lIt=lt&&lt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},cIt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(RW,"__esModule",{value:!0});const lS=lIt(Bre),fIt=cIt(xb),_xe=Iu,cS=Cd,dIt=Mo;function hIt(e,t,n={}){return wxe(this,void 0,void 0,function*(){const r=Object.assign({},gIt,n),i=dIt.getDrawArea(e);let a=t.values;r.rowMajor&&(a=yield pIt(t.values));const{xTickLabels:o,yTickLabels:s}=t;o!=null&&Sxe(a,o,0),s!=null&&Sxe(a,s,1);const u="@tfidx@",l=[];if(a instanceof lS.Tensor){cS.assert(a.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield a.data(),[m,v]=a.shape;for(let y=0;y<m;y++){const b=o?`${o[y]}${u}${y}`:y;for(let x=0;x<v;x++){const w=s?`${s[x]}${u}${x}`:x,S=y*v+x,C=g[S];l.push({x:b,y:w,value:C})}}}else{const g=a;for(let m=0;m<g.length;m++){const v=o?`${o[m]}${u}${m}`:m;for(let y=0;y<g[m].length;y++){const b=s?`${s[y]}${u}${y}`:y,x=g[m][y];l.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||_xe.getDefaultWidth(i),height:r.height||_xe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:l},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${u}\\d+$`,h=new RegExp(d);o&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),s&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(o||s)&&(c.tooltip={sanitize:g=>String(g).replace(h,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield fIt.default(i,f,c)})}RW.heatmap=hIt;function pIt(e){return wxe(this,void 0,void 0,function*(){let t,n;e instanceof lS.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=lS.tidy(()=>lS.tensor2d(e).transpose())),cS.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return cS.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function Sxe(e,t,n){const r=e instanceof lS.Tensor?e.shape:[e.length,e[0].length];n===0?cS.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&cS.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const gIt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var fS={},Exe=bf(ntt),of={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var XD=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(of,"__esModule",{value:!0});const dv=Bre,Lp=Cd;function mIt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?a+=1:isFinite(l)||(o+=1)}const s={numVals:t,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s}of.arrayStats=mIt;function vIt(e){return XD(this,void 0,void 0,function*(){const[t,n,r]=dv.tidy(()=>{const i=dv.scalar(0,e.dtype),a=e.min(),o=e.max(),s=e.equal(i).sum();return[a,o,s]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,a,o,s])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const g=i[p];isNaN(g)?l+=1:isFinite(g)||(c+=1)}let f=a[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:s[0],numNans:l,min:f,max:d,numInfs:c}})})}of.tensorStats=vIt;function yIt(e,t,n,r){return XD(this,void 0,void 0,function*(){Lp.assert(e.rank===1,"labels must be a 1D tensor"),Lp.assert(t.rank===1,"predictions must be a 1D tensor"),Lp.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&Lp.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),a=t.cast("int32");n==null&&(n=dv.tidy(()=>dv.maximum(i.max(),a.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),a.data(),o]).then(([s,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<s.length;f++){const d=s[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}of.confusionMatrix=yIt;function bIt(e,t){return XD(this,void 0,void 0,function*(){Lp.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return dv.dispose([n,r]),i})}of.accuracy=bIt;function xIt(e,t,n){return XD(this,void 0,void 0,function*(){return Lp.assert(e.rank===1,"labels must be a 1D tensor"),Lp.assert(t.rank===1,"predictions must be a 1D tensor"),Lp.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=dv.tidy(()=>dv.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const a=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];a[l]+=1,l===c&&(o[l]+=1)}const s=[];for(let u=0;u<a.length;u++)s.push({count:a[u],accuracy:a[u]===0?0:o[u]/a[u]});return s})})}of.perClassAccuracy=xIt;var Cb={},FW="http://www.w3.org/1999/xhtml",MW={svg:"http://www.w3.org/2000/svg",xhtml:FW,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function PW(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),MW.hasOwnProperty(t)?{space:MW[t],local:e}:e}function wIt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===FW&&t.documentElement.namespaceURI===FW?t.createElement(e):t.createElementNS(n,e)}}function _It(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function YD(e){var t=PW(e);return(t.local?_It:wIt)(t)}function SIt(){}function $W(e){return e==null?SIt:function(){return this.querySelector(e)}}function EIt(e){typeof e!="function"&&(e=$W(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=e.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new Po(r,this._parents)}function CIt(){return[]}function Cxe(e){return e==null?CIt:function(){return this.querySelectorAll(e)}}function AIt(e){typeof e!="function"&&(e=Cxe(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Po(r,i)}var Axe=function(e){return function(){return this.matches(e)}};if(typeof document!="undefined"){var dS=document.documentElement;if(!dS.matches){var kIt=dS.webkitMatchesSelector||dS.msMatchesSelector||dS.mozMatchesSelector||dS.oMatchesSelector;Axe=function(e){return function(){return kIt.call(this,e)}}}}var kxe=Axe;function TIt(e){typeof e!="function"&&(e=kxe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&e.call(u,u.__data__,l,a)&&s.push(u);return new Po(r,this._parents)}function Txe(e){return new Array(e.length)}function OIt(){return new Po(this._enter||this._groups.map(Txe),this._parents)}function ZD(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ZD.prototype={constructor:ZD,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function IIt(e){return function(){return e}}var Oxe="$";function NIt(e,t,n,r,i,a){for(var o=0,s,u=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new ZD(e,a[o]);for(;o<u;++o)(s=t[o])&&(i[o]=s)}function DIt(e,t,n,r,i,a,o){var s,u,l={},c=t.length,f=a.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=Oxe+o.call(u,u.__data__,s,t),h in l?i[s]=u:l[h]=u);for(s=0;s<f;++s)h=Oxe+o.call(e,a[s],s,a),(u=l[h])?(r[s]=u,u.__data__=a[s],l[h]=null):n[s]=new ZD(e,a[s]);for(s=0;s<c;++s)(u=t[s])&&l[d[s]]===u&&(i[s]=u)}function RIt(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?DIt:NIt,r=this._parents,i=this._groups;typeof e!="function"&&(e=IIt(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=o[l]=new Array(p),v=u[l]=new Array(d);n(c,f,g,m,v,h,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return o=new Po(o,r),o._enter=s,o._exit=u,o}function FIt(){return new Po(this._exit||this._groups.map(Txe),this._parents)}function MIt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=t[s],l=n[s],c=u.length,f=o[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)o[s]=t[s];return new Po(o,this._parents)}function PIt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&a!==o.nextSibling&&a.parentNode.insertBefore(o,a),a=o);return this}function $It(e){e||(e=LIt);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Po(i,this._parents).order()}function LIt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function BIt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function zIt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function jIt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function UIt(){var e=0;return this.each(function(){++e}),e}function WIt(){return!this.node()}function VIt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function qIt(e){return function(){this.removeAttribute(e)}}function HIt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function GIt(e,t){return function(){this.setAttribute(e,t)}}function KIt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function XIt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YIt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ZIt(e,t){var n=PW(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?HIt:qIt:typeof t=="function"?n.local?YIt:XIt:n.local?KIt:GIt)(n,t))}function LW(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function JIt(e){return function(){this.style.removeProperty(e)}}function QIt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function eNt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function tNt(e,t,n){return arguments.length>1?this.each((t==null?JIt:typeof t=="function"?eNt:QIt)(e,t,n??"")):Ixe(this.node(),e)}function Ixe(e,t){return e.style.getPropertyValue(t)||LW(e).getComputedStyle(e,null).getPropertyValue(t)}function nNt(e){return function(){delete this[e]}}function rNt(e,t){return function(){this[e]=t}}function iNt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function aNt(e,t){return arguments.length>1?this.each((t==null?nNt:typeof t=="function"?iNt:rNt)(e,t)):this.node()[e]}function Nxe(e){return e.trim().split(/^|\s+/)}function BW(e){return e.classList||new Dxe(e)}function Dxe(e){this._node=e,this._names=Nxe(e.getAttribute("class")||"")}Dxe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Rxe(e,t){for(var n=BW(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Fxe(e,t){for(var n=BW(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function oNt(e){return function(){Rxe(this,e)}}function sNt(e){return function(){Fxe(this,e)}}function uNt(e,t){return function(){(t.apply(this,arguments)?Rxe:Fxe)(this,e)}}function lNt(e,t){var n=Nxe(e+"");if(arguments.length<2){for(var r=BW(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?uNt:t?oNt:sNt)(n,t))}function cNt(){this.textContent=""}function fNt(e){return function(){this.textContent=e}}function dNt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function hNt(e){return arguments.length?this.each(e==null?cNt:(typeof e=="function"?dNt:fNt)(e)):this.node().textContent}function pNt(){this.innerHTML=""}function gNt(e){return function(){this.innerHTML=e}}function mNt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function vNt(e){return arguments.length?this.each(e==null?pNt:(typeof e=="function"?mNt:gNt)(e)):this.node().innerHTML}function yNt(){this.nextSibling&&this.parentNode.appendChild(this)}function bNt(){return this.each(yNt)}function xNt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wNt(){return this.each(xNt)}function _Nt(e){var t=typeof e=="function"?e:YD(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function SNt(){return null}function ENt(e,t){var n=typeof e=="function"?e:YD(e),r=t==null?SNt:typeof t=="function"?t:$W(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function CNt(){var e=this.parentNode;e&&e.removeChild(this)}function ANt(){return this.each(CNt)}function kNt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function TNt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function ONt(e){return this.select(e?TNt:kNt)}function INt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var Mxe={},Ad=null;if(typeof document!="undefined"){var NNt=document.documentElement;"onmouseenter"in NNt||(Mxe={mouseenter:"mouseover",mouseleave:"mouseout"})}function DNt(e,t,n){return e=Pxe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function Pxe(e,t,n){return function(r){var i=Ad;Ad=r;try{e.call(this,this.__data__,t,n)}finally{Ad=i}}}function RNt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function FNt(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function MNt(e,t,n){var r=Mxe.hasOwnProperty(e.type)?DNt:Pxe;return function(i,a,o){var s=this.__on,u,l=r(t,a,o);if(s){for(var c=0,f=s.length;c<f;++c)if((u=s[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},s?s.push(u):this.__on=[u]}}function PNt(e,t,n){var r=RNt(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?MNt:FNt,n==null&&(n=!1),i=0;i<a;++i)this.each(s(r[i],t,n));return this}function $Nt(e,t,n,r){var i=Ad;e.sourceEvent=Ad,Ad=e;try{return t.apply(n,r)}finally{Ad=i}}function $xe(e,t,n){var r=LW(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function LNt(e,t){return function(){return $xe(this,e,t)}}function BNt(e,t){return function(){return $xe(this,e,t.apply(this,arguments))}}function zNt(e,t){return this.each((typeof t=="function"?BNt:LNt)(e,t))}var zW=[null];function Po(e,t){this._groups=e,this._parents=t}function Lxe(){return new Po([[document.documentElement]],zW)}Po.prototype=Lxe.prototype={constructor:Po,select:EIt,selectAll:AIt,filter:TIt,data:RIt,enter:OIt,exit:FIt,merge:MIt,order:PIt,sort:$It,call:BIt,nodes:zIt,node:jIt,size:UIt,empty:WIt,each:VIt,attr:ZIt,style:tNt,property:aNt,classed:lNt,text:hNt,html:vNt,raise:bNt,lower:wNt,append:_Nt,insert:ENt,remove:ANt,clone:ONt,datum:INt,on:PNt,dispatch:zNt};function Bxe(e){return typeof e=="string"?new Po([[document.querySelector(e)]],[document.documentElement]):new Po([[e]],zW)}function jNt(e){return Bxe(YD(e).call(document.documentElement))}var UNt=0;function zxe(){return new jW}function jW(){this._="@"+(++UNt).toString(36)}jW.prototype=zxe.prototype={constructor:jW,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function UW(){for(var e=Ad,t;t=e.sourceEvent;)e=t;return e}function JD(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function WNt(e){var t=UW();return t.changedTouches&&(t=t.changedTouches[0]),JD(e,t)}function VNt(e){return typeof e=="string"?new Po([document.querySelectorAll(e)],[document.documentElement]):new Po([e??[]],zW)}function qNt(e,t,n){arguments.length<3&&(n=t,t=UW().changedTouches);for(var r=0,i=t?t.length:0,a;r<i;++r)if((a=t[r]).identifier===n)return JD(e,a);return null}function HNt(e,t){t==null&&(t=UW().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=JD(e,t[n]);return i}var GNt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:jNt,creator:YD,local:zxe,matcher:kxe,mouse:WNt,namespace:PW,namespaces:MW,clientPoint:JD,select:Bxe,selectAll:VNt,selection:Lxe,selector:$W,selectorAll:Cxe,style:Ixe,touch:qNt,touches:HNt,window:LW,get event(){return Ad},customEvent:$Nt}),KNt=bf(GNt);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Cb,"__esModule",{value:!0});const XNt=Exe,jxe=KNt,WW=Ke,YNt=Mo;function ZNt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=YNt.getDrawArea(e),i=Object.assign({},JNt,n);let a=jxe.select(r).select("table.tf-table");const o=WW.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(a.size()===0&&(a=jxe.select(r).append("table"),a.attr("class",` ${o} tf-table`),a.append("thead").append("tr"),a.append("tbody")),a.size()!==1)throw new Error("Error inserting table");const s=WW.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),u=a.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${s}`);u.merge(l).html(m=>m),u.exit().remove();const c=XNt.format(",.4~f"),f=a.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=WW.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(d).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${h}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}Cb.table=ZNt;const JNt={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var QNt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},eDt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fS,"__esModule",{value:!0});const Uxe=Exe,tDt=eDt(xb),QD=Iu,nDt=of,rDt=Cb,iDt={maxBins:12,fontSize:11};function aDt(e,t,n={}){return QNt(this,void 0,void 0,function*(){const r=sDt(t),i=Object.assign({},iDt,n),a={actions:!1,mode:"vega-lite",defaultStyle:!1},o=QD.subSurface(e,"histogram");if(n.stats!==!1){const l=QD.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=nDt.arrayStats(r.map(f=>f.value)),oDt(c,l,{fontSize:i.fontSize})}if(r.length===0)return;const s=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&s.push(r[l])}const u={width:i.width||QD.getDefaultWidth(o),height:i.height||QD.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:s},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return tDt.default(o,u,a)})}fS.histogram=aDt;function oDt(e,t,n){const r=Uxe.format(",.4~f"),i=Uxe.format(".4~p"),a=[],o=[];if(e.numVals!=null&&(a.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(a.push("Min"),o.push(r(e.min))),e.max!=null&&(a.push("Max"),o.push(r(e.max))),e.numZeros!=null){a.push("# Zeros");let s="";e.numVals&&(s=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${s}`)}if(e.numNans!=null){a.push("# NaNs");let s="";e.numVals&&(s=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${s}`)}if(e.numInfs!=null){a.push("# Infinity");let s="";e.numVals&&(s=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${s}`)}rDt.table(t,{headers:a,values:[o]},n)}function sDt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var eR={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var uDt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},lDt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(eR,"__esModule",{value:!0});const cDt=lDt(xb),Wxe=Iu,Vxe=Cd,fDt=Mo;function dDt(e,t,n={}){return uDt(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,a=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);Vxe.assert(a.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&Vxe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=[];for(let g=0;g<i;g++){const m={x:g};a.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),o.push(m)}const s=Object.assign({},hDt,n),u=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},l={x:{field:"x",type:s.xType,title:s.xLabel},tooltip:[{field:"x",type:"quantitative"},...a.map(g=>({field:g,type:"quantitative"}))]},c=a.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:s.yType,title:s.yLabel,scale:u()},color:{field:`${g}-name`,type:"nominal",legend:{values:a,title:null},scale:{range:s.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=fDt.getDrawArea(e),h={width:s.width||Wxe.getDefaultWidth(d),height:s.height||Wxe.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:o},encoding:l,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield cDt.default(d,h,p),Promise.resolve()})}eR.linechart=dDt;const hDt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var VW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pDt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},gDt=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(VW,"__esModule",{value:!0});const mDt=gDt(xb),qxe=Iu,vDt=Cd,yDt=Mo;function bDt(e,t,n={}){return pDt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const a=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,g=d.map(m=>Object.assign({},m,{series:p}));a.push(...g)}),n.seriesColors!=null&&vDt.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=yDt.getDrawArea(e),s=Object.assign({},xDt,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(s.zoomToFit)return{zero:!1};if(s.xAxisDomain!=null)return{domain:s.xAxisDomain}},c=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},f={width:s.width||qxe.getDefaultWidth(o),height:s.height||qxe.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:a},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:s.xType,title:s.xLabel,scale:l()},y:{field:"y",type:s.yType,title:s.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:s.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield mDt.default(o,f,u),Promise.resolve()})}VW.scatterplot=bDt;const xDt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var tR={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hxe=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(tR,"__esModule",{value:!0});const wDt=eR,qW=Mo,Gxe=Iu;function Kxe(e,t,n,r={}){return Hxe(this,void 0,void 0,function*(){const i=qW.getDrawArea(e),a={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");Xxe(a,c);const f=Yxe(t,l,n.indexOf(l));a[c].series.push(l),a[c].values.push(f)}else{const c=Yxe(t,l,n.indexOf(l));Xxe(a,l),a[l].series.push(l),a[l].values.push(c)}const o=Object.keys(a),s=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=Gxe.subSurface(i,l),f=a[l].series,d=a[l].values;f.every(p=>Boolean(p.match("acc")))&&(s.zoomToFitAccuracy?s.zoomToFit=!0:(s.yAxisDomain=[0,1],delete s.zoomToFit));const h=wDt.linechart(c,{values:d,series:f},s);u.push(h)}yield Promise.all(u)})}tR.history=Kxe;function Xxe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function Yxe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let a=0;a<r.length;a++){const o=r[a];i.push({x:a,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function _Dt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],a=qW.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function s(l){return(c,f)=>Hxe(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const g of t)if(f[g]!=null){h.push(g);const m=SDt(r,l,g);m.push({[g]:f[g]}),d.push(m)}const p=Gxe.subSurface(a,l,{title:l});Kxe(p,d,h,o),yield qW.nextFrame()})}const u={};return i.forEach(l=>{u[l]=s(l)}),u}tR.fitCallbacks=_Dt;function SDt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var nR={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var rR=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(nR,"__esModule",{value:!0});const EDt=fS,Zxe=Mo,Jxe=Cb,HW=Iu,CDt=of;function ADt(e,t){return rR(this,void 0,void 0,function*(){const n=Zxe.getDrawArea(e),r=TDt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],a=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);Jxe.table(n,{headers:i,values:a})})}nR.modelSummary=ADt;function kDt(e,t){return rR(this,void 0,void 0,function*(){const n=Zxe.getDrawArea(e),r=yield IDt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],a=HW.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);Jxe.table(a,{headers:i,values:o});const s=HW.subSurface(n,"select-layer"),u=HW.subSurface(n,"param-distribution"),l=c=>rR(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();EDt.histogram(u,d,{height:150,width:460,stats:!1})});NDt(r.map(c=>c.name),s,l)})}nR.layer=kDt;function TDt(e){return{layers:e.layers.map(ODt)}}function ODt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>GW(r)).join(", ")}]`:t=GW(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function IDt(e){return rR(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(CDt.tensorStats),i=yield Promise.all(r),a=t.map(o=>o.shape);return t.map((o,s)=>({name:n[s].name,stats:i[s],shape:GW(a[s]),weight:o}))})}function GW(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function NDt(e,t,n){const a=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=a;const o=t.querySelector("button"),s=t.querySelector("select");o.addEventListener("click",()=>{n(s.selectedOptions[0].label)})}var KW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DDt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(KW,"__esModule",{value:!0});const RDt=Mo,FDt=Cb;function MDt(e,t,n){return DDt(this,void 0,void 0,function*(){const r=RDt.getDrawArea(e),i=["Class","Accuracy","# Samples"],a=[];for(let o=0;o<t.length;o++){const s=n?n[o]:o.toString(),u=t[o];a.push([s,u.accuracy,u.count])}return FDt.table(r,{headers:i,values:a})})}KW.perClassAccuracy=MDt;var XW={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var PDt=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(XW,"__esModule",{value:!0});const $Dt=fS,LDt=Mo,BDt=of;function zDt(e,t){return PDt(this,void 0,void 0,function*(){const n=LDt.getDrawArea(e),r=yield BDt.tensorStats(t),i=yield t.data();$Dt.histogram(n,i,{height:150,stats:r})})}XW.valuesDistribution=zDt;var YW={};/** @license See the LICENSE file. */Object.defineProperty(YW,"__esModule",{value:!0});const jDt="1.5.1";YW.version=jDt,function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=E4,r=DW,i=RW,a=fS,o=eR,s=VW,u=Cb,l=tR,c=nR,f=KW,d=XW,h=of,p=YW;e.version_vis=p.version;const g={barchart:n.barchart,table:u.table,histogram:a.histogram,linechart:o.linechart,scatterplot:s.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=aS;e.visor=y.visor,t(iS)}(Lre);var Qxe={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof $d=="function"&&$d;if(!c&&f)return f(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var g=r[l][1][p];return o(g||p)},h,h.exports,n,r,i,a)}return i[l].exports}for(var s=typeof $d=="function"&&$d,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,s;if(o){var u=0,l=new o(p),c=a.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var f=new a.MessageChannel;f.port1.onmessage=p,s=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?s=function(){var m=a.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:s=function(){setTimeout(p,0)};var d,h=[];function p(){d=!0;for(var m,v,y=h.length;y;){for(v=h,h=[],m=-1;++m<y;)v[m]();y=h.length}d=!1}r.exports=g;function g(m){h.push(m)===1&&!d&&s()}}).call(this,typeof lt!="undefined"?lt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=f;function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,S){if(typeof w!="function"&&this.state===l||typeof S!="function"&&this.state===u)return this;var C=new this.constructor(o);if(this.state!==c){var _=this.state===l?w:S;h(C,_,this.outcome)}else this.queue.push(new d(C,w,S));return C};function d(w,S,C){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){s.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){s.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)};function h(w,S,C){a(function(){var _;try{_=S(C)}catch(E){return s.reject(w,E)}_===w?s.reject(w,new TypeError("Cannot resolve promise with itself")):s.resolve(w,_)})}s.resolve=function(w,S){var C=m(p,S);if(C.status==="error")return s.reject(w,C.value);var _=C.value;if(_)g(w,_);else{w.state=l,w.outcome=S;for(var E=-1,A=w.queue.length;++E<A;)w.queue[E].callFulfilled(S)}return w},s.reject=function(w,S){w.state=u,w.outcome=S;for(var C=-1,_=w.queue.length;++C<_;)w.queue[C].callRejected(S);return w};function p(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var C=!1;function _(T){C||(C=!0,s.reject(w,T))}function E(T){C||(C=!0,s.resolve(w,T))}function A(){S(E,_)}var k=m(A);k.status==="error"&&_(k.value)}function m(w,S){var C={};try{C.value=w(S),C.status="success"}catch(_){C.status="error",C.value=_}return C}f.resolve=v;function v(w){return w instanceof this?w:s.resolve(new this(o),w)}f.reject=y;function y(w){var S=new this(o);return s.reject(S,w)}f.all=b;function b(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=new Array(C),A=0,k=-1,T=new this(o);++k<C;)I(w[k],k);return T;function I(N,O){S.resolve(N).then(D,function(P){_||(_=!0,s.reject(T,P))});function D(P){E[O]=P,++A===C&&!_&&(_=!0,s.resolve(T,E))}}}f.race=x;function x(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=-1,A=new this(o);++E<C;)k(w[E]);return A;function k(T){S.resolve(T).then(function(I){_||(_=!0,s.resolve(A,I))},function(I){_||(_=!0,s.reject(A,I))})}}},{"1":1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof lt!="undefined"?lt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j};function o(j,ee){if(!(j instanceof ee))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(j){return}}var u=s();function l(){try{if(!u||!u.open)return!1;var j=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ee=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!j||ee)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(G){return!1}}function c(j,ee){j=j||[],ee=ee||{};try{return new Blob(j,ee)}catch(ae){if(ae.name!=="TypeError")throw ae;for(var G=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,se=new G,fe=0;fe<j.length;fe+=1)se.append(j[fe]);return se.getBlob(ee.type)}}typeof Promise=="undefined"&&n(3);var f=Promise;function d(j,ee){ee&&j.then(function(G){ee(null,G)},function(G){ee(G)})}function h(j,ee,G){typeof ee=="function"&&j.then(ee),typeof G=="function"&&j.catch(G)}function p(j){return typeof j!="string"&&(console.warn(j+" used as a key, but it is not a string."),j=String(j)),j}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",v=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function S(j){for(var ee=j.length,G=new ArrayBuffer(ee),se=new Uint8Array(G),fe=0;fe<ee;fe++)se[fe]=j.charCodeAt(fe);return G}function C(j){return new f(function(ee){var G=j.transaction(m,w),se=c([""]);G.objectStore(m).put(se,"key"),G.onabort=function(fe){fe.preventDefault(),fe.stopPropagation(),ee(!1)},G.oncomplete=function(){var fe=navigator.userAgent.match(/Chrome\/(\d+)/),ae=navigator.userAgent.match(/Edge\//);ee(ae||!fe||parseInt(fe[1],10)>=43)}}).catch(function(){return!1})}function _(j){return typeof v=="boolean"?f.resolve(v):C(j).then(function(ee){return v=ee,v})}function E(j){var ee=y[j.name],G={};G.promise=new f(function(se,fe){G.resolve=se,G.reject=fe}),ee.deferredOperations.push(G),ee.dbReady?ee.dbReady=ee.dbReady.then(function(){return G.promise}):ee.dbReady=G.promise}function A(j){var ee=y[j.name],G=ee.deferredOperations.pop();if(G)return G.resolve(),G.promise}function k(j,ee){var G=y[j.name],se=G.deferredOperations.pop();if(se)return se.reject(ee),se.promise}function T(j,ee){return new f(function(G,se){if(y[j.name]=y[j.name]||me(),j.db)if(ee)E(j),j.db.close();else return G(j.db);var fe=[j.name];ee&&fe.push(j.version);var ae=u.open.apply(u,fe);ee&&(ae.onupgradeneeded=function(De){var Ue=ae.result;try{Ue.createObjectStore(j.storeName),De.oldVersion<=1&&Ue.createObjectStore(m)}catch(We){if(We.name==="ConstraintError")console.warn('The database "'+j.name+'" has been upgraded from version '+De.oldVersion+" to version "+De.newVersion+', but the storage "'+j.storeName+'" already exists.');else throw We}}),ae.onerror=function(De){De.preventDefault(),se(ae.error)},ae.onsuccess=function(){G(ae.result),A(j)}})}function I(j){return T(j,!1)}function N(j){return T(j,!0)}function O(j,ee){if(!j.db)return!0;var G=!j.db.objectStoreNames.contains(j.storeName),se=j.version<j.db.version,fe=j.version>j.db.version;if(se&&(j.version!==ee&&console.warn('The database "'+j.name+`" can't be downgraded from version `+j.db.version+" to version "+j.version+"."),j.version=j.db.version),fe||G){if(G){var ae=j.db.version+1;ae>j.version&&(j.version=ae)}return!0}return!1}function D(j){return new f(function(ee,G){var se=new FileReader;se.onerror=G,se.onloadend=function(fe){var ae=btoa(fe.target.result||"");ee({__local_forage_encoded_blob:!0,data:ae,type:j.type})},se.readAsBinaryString(j)})}function P(j){var ee=S(atob(j.data));return c([ee],{type:j.type})}function V(j){return j&&j.__local_forage_encoded_blob}function Y(j){var ee=this,G=ee._initReady().then(function(){var se=y[ee._dbInfo.name];if(se&&se.dbReady)return se.dbReady});return h(G,j,j),G}function X(j){E(j);for(var ee=y[j.name],G=ee.forages,se=0;se<G.length;se++){var fe=G[se];fe._dbInfo.db&&(fe._dbInfo.db.close(),fe._dbInfo.db=null)}return j.db=null,I(j).then(function(ae){return j.db=ae,O(j)?N(j):ae}).then(function(ae){j.db=ee.db=ae;for(var De=0;De<G.length;De++)G[De]._dbInfo.db=ae}).catch(function(ae){throw k(j,ae),ae})}function Q(j,ee,G,se){se===void 0&&(se=1);try{var fe=j.db.transaction(j.storeName,ee);G(null,fe)}catch(ae){if(se>0&&(!j.db||ae.name==="InvalidStateError"||ae.name==="NotFoundError"))return f.resolve().then(function(){if(!j.db||ae.name==="NotFoundError"&&!j.db.objectStoreNames.contains(j.storeName)&&j.version<=j.db.version)return j.db&&(j.version=j.db.version+1),N(j)}).then(function(){return X(j).then(function(){Q(j,ee,G,se-1)})}).catch(G);G(ae)}}function me(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ce(j){var ee=this,G={db:null};if(j)for(var se in j)G[se]=j[se];var fe=y[G.name];fe||(fe=me(),y[G.name]=fe),fe.forages.push(ee),ee._initReady||(ee._initReady=ee.ready,ee.ready=Y);var ae=[];function De(){return f.resolve()}for(var Ue=0;Ue<fe.forages.length;Ue++){var We=fe.forages[Ue];We!==ee&&ae.push(We._initReady().catch(De))}var Fe=fe.forages.slice(0);return f.all(ae).then(function(){return G.db=fe.db,I(G)}).then(function(Le){return G.db=Le,O(G,ee._defaultConfig.version)?N(G):Le}).then(function(Le){G.db=fe.db=Le,ee._dbInfo=G;for(var at=0;at<Fe.length;at++){var yt=Fe[at];yt!==ee&&(yt._dbInfo.db=G.db,yt._dbInfo.version=G.version)}})}function Ne(j,ee){var G=this;j=p(j);var se=new f(function(fe,ae){G.ready().then(function(){Q(G._dbInfo,x,function(De,Ue){if(De)return ae(De);try{var We=Ue.objectStore(G._dbInfo.storeName),Fe=We.get(j);Fe.onsuccess=function(){var Le=Fe.result;Le===void 0&&(Le=null),V(Le)&&(Le=P(Le)),fe(Le)},Fe.onerror=function(){ae(Fe.error)}}catch(Le){ae(Le)}})}).catch(ae)});return d(se,ee),se}function Oe(j,ee){var G=this,se=new f(function(fe,ae){G.ready().then(function(){Q(G._dbInfo,x,function(De,Ue){if(De)return ae(De);try{var We=Ue.objectStore(G._dbInfo.storeName),Fe=We.openCursor(),Le=1;Fe.onsuccess=function(){var at=Fe.result;if(at){var yt=at.value;V(yt)&&(yt=P(yt));var Mt=j(yt,at.key,Le++);Mt!==void 0?fe(Mt):at.continue()}else fe()},Fe.onerror=function(){ae(Fe.error)}}catch(at){ae(at)}})}).catch(ae)});return d(se,ee),se}function $e(j,ee,G){var se=this;j=p(j);var fe=new f(function(ae,De){var Ue;se.ready().then(function(){return Ue=se._dbInfo,b.call(ee)==="[object Blob]"?_(Ue.db).then(function(We){return We?ee:D(ee)}):ee}).then(function(We){Q(se._dbInfo,w,function(Fe,Le){if(Fe)return De(Fe);try{var at=Le.objectStore(se._dbInfo.storeName);We===null&&(We=void 0);var yt=at.put(We,j);Le.oncomplete=function(){We===void 0&&(We=null),ae(We)},Le.onabort=Le.onerror=function(){var Mt=yt.error?yt.error:yt.transaction.error;De(Mt)}}catch(Mt){De(Mt)}})}).catch(De)});return d(fe,G),fe}function ve(j,ee){var G=this;j=p(j);var se=new f(function(fe,ae){G.ready().then(function(){Q(G._dbInfo,w,function(De,Ue){if(De)return ae(De);try{var We=Ue.objectStore(G._dbInfo.storeName),Fe=We.delete(j);Ue.oncomplete=function(){fe()},Ue.onerror=function(){ae(Fe.error)},Ue.onabort=function(){var Le=Fe.error?Fe.error:Fe.transaction.error;ae(Le)}}catch(Le){ae(Le)}})}).catch(ae)});return d(se,ee),se}function $(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){Q(ee._dbInfo,w,function(ae,De){if(ae)return fe(ae);try{var Ue=De.objectStore(ee._dbInfo.storeName),We=Ue.clear();De.oncomplete=function(){se()},De.onabort=De.onerror=function(){var Fe=We.error?We.error:We.transaction.error;fe(Fe)}}catch(Fe){fe(Fe)}})}).catch(fe)});return d(G,j),G}function F(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){Q(ee._dbInfo,x,function(ae,De){if(ae)return fe(ae);try{var Ue=De.objectStore(ee._dbInfo.storeName),We=Ue.count();We.onsuccess=function(){se(We.result)},We.onerror=function(){fe(We.error)}}catch(Fe){fe(Fe)}})}).catch(fe)});return d(G,j),G}function q(j,ee){var G=this,se=new f(function(fe,ae){if(j<0){fe(null);return}G.ready().then(function(){Q(G._dbInfo,x,function(De,Ue){if(De)return ae(De);try{var We=Ue.objectStore(G._dbInfo.storeName),Fe=!1,Le=We.openKeyCursor();Le.onsuccess=function(){var at=Le.result;if(!at){fe(null);return}j===0||Fe?fe(at.key):(Fe=!0,at.advance(j))},Le.onerror=function(){ae(Le.error)}}catch(at){ae(at)}})}).catch(ae)});return d(se,ee),se}function ue(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){Q(ee._dbInfo,x,function(ae,De){if(ae)return fe(ae);try{var Ue=De.objectStore(ee._dbInfo.storeName),We=Ue.openKeyCursor(),Fe=[];We.onsuccess=function(){var Le=We.result;if(!Le){se(Fe);return}Fe.push(Le.key),Le.continue()},We.onerror=function(){fe(We.error)}}catch(Le){fe(Le)}})}).catch(fe)});return d(G,j),G}function J(j,ee){ee=g.apply(this,arguments);var G=this.config();j=typeof j!="function"&&j||{},j.name||(j.name=j.name||G.name,j.storeName=j.storeName||G.storeName);var se=this,fe;if(!j.name)fe=f.reject("Invalid arguments");else{var ae=j.name===G.name&&se._dbInfo.db,De=ae?f.resolve(se._dbInfo.db):I(j).then(function(Ue){var We=y[j.name],Fe=We.forages;We.db=Ue;for(var Le=0;Le<Fe.length;Le++)Fe[Le]._dbInfo.db=Ue;return Ue});j.storeName?fe=De.then(function(Ue){if(!!Ue.objectStoreNames.contains(j.storeName)){var We=Ue.version+1;E(j);var Fe=y[j.name],Le=Fe.forages;Ue.close();for(var at=0;at<Le.length;at++){var yt=Le[at];yt._dbInfo.db=null,yt._dbInfo.version=We}var Mt=new f(function($t,Tn){var rr=u.open(j.name,We);rr.onerror=function(Xr){var df=rr.result;df.close(),Tn(Xr)},rr.onupgradeneeded=function(){var Xr=rr.result;Xr.deleteObjectStore(j.storeName)},rr.onsuccess=function(){var Xr=rr.result;Xr.close(),$t(Xr)}});return Mt.then(function($t){Fe.db=$t;for(var Tn=0;Tn<Le.length;Tn++){var rr=Le[Tn];rr._dbInfo.db=$t,A(rr._dbInfo)}}).catch(function($t){throw(k(j,$t)||f.resolve()).catch(function(){}),$t})}}):fe=De.then(function(Ue){E(j);var We=y[j.name],Fe=We.forages;Ue.close();for(var Le=0;Le<Fe.length;Le++){var at=Fe[Le];at._dbInfo.db=null}var yt=new f(function(Mt,$t){var Tn=u.deleteDatabase(j.name);Tn.onerror=Tn.onblocked=function(rr){var Xr=Tn.result;Xr&&Xr.close(),$t(rr)},Tn.onsuccess=function(){var rr=Tn.result;rr&&rr.close(),Mt(rr)}});return yt.then(function(Mt){We.db=Mt;for(var $t=0;$t<Fe.length;$t++){var Tn=Fe[$t];A(Tn._dbInfo)}}).catch(function(Mt){throw(k(j,Mt)||f.resolve()).catch(function(){}),Mt})})}return d(fe,ee),fe}var L={_driver:"asyncStorage",_initStorage:ce,_support:l(),iterate:Oe,getItem:Ne,setItem:$e,removeItem:ve,clear:$,length:F,key:q,keys:ue,dropInstance:J};function z(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z="~~local_forage_type~",xe=/^~~local_forage_type~([^~]+)~/,Ee="__lfsc__:",Me=Ee.length,Ve="arbf",Je="blob",Ft="si08",et="ui08",Gt="uic8",rn="si16",kn="si32",Br="ur16",Jn="ui32",_n="fl32",Xi="fl64",kr=Me+Ve.length,ms=Object.prototype.toString;function $o(j){var ee=j.length*.75,G=j.length,se,fe=0,ae,De,Ue,We;j[j.length-1]==="="&&(ee--,j[j.length-2]==="="&&ee--);var Fe=new ArrayBuffer(ee),Le=new Uint8Array(Fe);for(se=0;se<G;se+=4)ae=R.indexOf(j[se]),De=R.indexOf(j[se+1]),Ue=R.indexOf(j[se+2]),We=R.indexOf(j[se+3]),Le[fe++]=ae<<2|De>>4,Le[fe++]=(De&15)<<4|Ue>>2,Le[fe++]=(Ue&3)<<6|We&63;return Fe}function vs(j){var ee=new Uint8Array(j),G="",se;for(se=0;se<ee.length;se+=3)G+=R[ee[se]>>2],G+=R[(ee[se]&3)<<4|ee[se+1]>>4],G+=R[(ee[se+1]&15)<<2|ee[se+2]>>6],G+=R[ee[se+2]&63];return ee.length%3==2?G=G.substring(0,G.length-1)+"=":ee.length%3==1&&(G=G.substring(0,G.length-2)+"=="),G}function Ru(j,ee){var G="";if(j&&(G=ms.call(j)),j&&(G==="[object ArrayBuffer]"||j.buffer&&ms.call(j.buffer)==="[object ArrayBuffer]")){var se,fe=Ee;j instanceof ArrayBuffer?(se=j,fe+=Ve):(se=j.buffer,G==="[object Int8Array]"?fe+=Ft:G==="[object Uint8Array]"?fe+=et:G==="[object Uint8ClampedArray]"?fe+=Gt:G==="[object Int16Array]"?fe+=rn:G==="[object Uint16Array]"?fe+=Br:G==="[object Int32Array]"?fe+=kn:G==="[object Uint32Array]"?fe+=Jn:G==="[object Float32Array]"?fe+=_n:G==="[object Float64Array]"?fe+=Xi:ee(new Error("Failed to get type for BinaryArray"))),ee(fe+vs(se))}else if(G==="[object Blob]"){var ae=new FileReader;ae.onload=function(){var De=Z+j.type+"~"+vs(this.result);ee(Ee+Je+De)},ae.readAsArrayBuffer(j)}else try{ee(JSON.stringify(j))}catch(De){console.error("Couldn't convert value into a JSON string: ",j),ee(null,De)}}function Fu(j){if(j.substring(0,Me)!==Ee)return JSON.parse(j);var ee=j.substring(kr),G=j.substring(Me,kr),se;if(G===Je&&xe.test(ee)){var fe=ee.match(xe);se=fe[1],ee=ee.substring(fe[0].length)}var ae=$o(ee);switch(G){case Ve:return ae;case Je:return c([ae],{type:se});case Ft:return new Int8Array(ae);case et:return new Uint8Array(ae);case Gt:return new Uint8ClampedArray(ae);case rn:return new Int16Array(ae);case Br:return new Uint16Array(ae);case kn:return new Int32Array(ae);case Jn:return new Uint32Array(ae);case _n:return new Float32Array(ae);case Xi:return new Float64Array(ae);default:throw new Error("Unkown type: "+G)}}var jl={serialize:Ru,deserialize:Fu,stringToBuffer:$o,bufferToString:vs};function vv(j,ee,G,se){j.executeSql("CREATE TABLE IF NOT EXISTS "+ee.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],G,se)}function Wt(j){var ee=this,G={db:null};if(j)for(var se in j)G[se]=typeof j[se]!="string"?j[se].toString():j[se];var fe=new f(function(ae,De){try{G.db=openDatabase(G.name,String(G.version),G.description,G.size)}catch(Ue){return De(Ue)}G.db.transaction(function(Ue){vv(Ue,G,function(){ee._dbInfo=G,ae()},function(We,Fe){De(Fe)})},De)});return G.serializer=jl,fe}function to(j,ee,G,se,fe,ae){j.executeSql(G,se,fe,function(De,Ue){Ue.code===Ue.SYNTAX_ERR?De.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ee.storeName],function(We,Fe){Fe.rows.length?ae(We,Ue):vv(We,ee,function(){We.executeSql(G,se,fe,ae)},ae)},ae):ae(De,Ue)},ae)}function sf(j,ee){var G=this;j=p(j);var se=new f(function(fe,ae){G.ready().then(function(){var De=G._dbInfo;De.db.transaction(function(Ue){to(Ue,De,"SELECT * FROM "+De.storeName+" WHERE key = ? LIMIT 1",[j],function(We,Fe){var Le=Fe.rows.length?Fe.rows.item(0).value:null;Le&&(Le=De.serializer.deserialize(Le)),fe(Le)},function(We,Fe){ae(Fe)})})}).catch(ae)});return d(se,ee),se}function si(j,ee){var G=this,se=new f(function(fe,ae){G.ready().then(function(){var De=G._dbInfo;De.db.transaction(function(Ue){to(Ue,De,"SELECT * FROM "+De.storeName,[],function(We,Fe){for(var Le=Fe.rows,at=Le.length,yt=0;yt<at;yt++){var Mt=Le.item(yt),$t=Mt.value;if($t&&($t=De.serializer.deserialize($t)),$t=j($t,Mt.key,yt+1),$t!==void 0){fe($t);return}}fe()},function(We,Fe){ae(Fe)})})}).catch(ae)});return d(se,ee),se}function yv(j,ee,G,se){var fe=this;j=p(j);var ae=new f(function(De,Ue){fe.ready().then(function(){ee===void 0&&(ee=null);var We=ee,Fe=fe._dbInfo;Fe.serializer.serialize(ee,function(Le,at){at?Ue(at):Fe.db.transaction(function(yt){to(yt,Fe,"INSERT OR REPLACE INTO "+Fe.storeName+" (key, value) VALUES (?, ?)",[j,Le],function(){De(We)},function(Mt,$t){Ue($t)})},function(yt){if(yt.code===yt.QUOTA_ERR){if(se>0){De(yv.apply(fe,[j,We,G,se-1]));return}Ue(yt)}})})}).catch(Ue)});return d(ae,G),ae}function Zs(j,ee,G){return yv.apply(this,[j,ee,G,1])}function Mb(j,ee){var G=this;j=p(j);var se=new f(function(fe,ae){G.ready().then(function(){var De=G._dbInfo;De.db.transaction(function(Ue){to(Ue,De,"DELETE FROM "+De.storeName+" WHERE key = ?",[j],function(){fe()},function(We,Fe){ae(Fe)})})}).catch(ae)});return d(se,ee),se}function Pb(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){var ae=ee._dbInfo;ae.db.transaction(function(De){to(De,ae,"DELETE FROM "+ae.storeName,[],function(){se()},function(Ue,We){fe(We)})})}).catch(fe)});return d(G,j),G}function Mu(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){var ae=ee._dbInfo;ae.db.transaction(function(De){to(De,ae,"SELECT COUNT(key) as c FROM "+ae.storeName,[],function(Ue,We){var Fe=We.rows.item(0).c;se(Fe)},function(Ue,We){fe(We)})})}).catch(fe)});return d(G,j),G}function $b(j,ee){var G=this,se=new f(function(fe,ae){G.ready().then(function(){var De=G._dbInfo;De.db.transaction(function(Ue){to(Ue,De,"SELECT key FROM "+De.storeName+" WHERE id = ? LIMIT 1",[j+1],function(We,Fe){var Le=Fe.rows.length?Fe.rows.item(0).key:null;fe(Le)},function(We,Fe){ae(Fe)})})}).catch(ae)});return d(se,ee),se}function uf(j){var ee=this,G=new f(function(se,fe){ee.ready().then(function(){var ae=ee._dbInfo;ae.db.transaction(function(De){to(De,ae,"SELECT key FROM "+ae.storeName,[],function(Ue,We){for(var Fe=[],Le=0;Le<We.rows.length;Le++)Fe.push(We.rows.item(Le).key);se(Fe)},function(Ue,We){fe(We)})})}).catch(fe)});return d(G,j),G}function Lo(j){return new f(function(ee,G){j.transaction(function(se){se.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(fe,ae){for(var De=[],Ue=0;Ue<ae.rows.length;Ue++)De.push(ae.rows.item(Ue).name);ee({db:j,storeNames:De})},function(fe,ae){G(ae)})},function(se){G(se)})})}function Js(j,ee){ee=g.apply(this,arguments);var G=this.config();j=typeof j!="function"&&j||{},j.name||(j.name=j.name||G.name,j.storeName=j.storeName||G.storeName);var se=this,fe;return j.name?fe=new f(function(ae){var De;j.name===G.name?De=se._dbInfo.db:De=openDatabase(j.name,"","",0),j.storeName?ae({db:De,storeNames:[j.storeName]}):ae(Lo(De))}).then(function(ae){return new f(function(De,Ue){ae.db.transaction(function(We){function Fe(Mt){return new f(function($t,Tn){We.executeSql("DROP TABLE IF EXISTS "+Mt,[],function(){$t()},function(rr,Xr){Tn(Xr)})})}for(var Le=[],at=0,yt=ae.storeNames.length;at<yt;at++)Le.push(Fe(ae.storeNames[at]));f.all(Le).then(function(){De()}).catch(function(Mt){Ue(Mt)})},function(We){Ue(We)})})}):fe=f.reject("Invalid arguments"),d(fe,ee),fe}var Yi={_driver:"webSQLStorage",_initStorage:Wt,_support:z(),iterate:si,getItem:sf,setItem:Zs,removeItem:Mb,clear:Pb,length:Mu,key:$b,keys:uf,dropInstance:Js};function ui(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(j){return!1}}function Kr(j,ee){var G=j.name+"/";return j.storeName!==ee.storeName&&(G+=j.storeName+"/"),G}function Td(){var j="_localforage_support_test";try{return localStorage.setItem(j,!0),localStorage.removeItem(j),!1}catch(ee){return!0}}function li(){return!Td()||localStorage.length>0}function Od(j){var ee=this,G={};if(j)for(var se in j)G[se]=j[se];return G.keyPrefix=Kr(j,ee._defaultConfig),li()?(ee._dbInfo=G,G.serializer=jl,f.resolve()):f.reject()}function bv(j){var ee=this,G=ee.ready().then(function(){for(var se=ee._dbInfo.keyPrefix,fe=localStorage.length-1;fe>=0;fe--){var ae=localStorage.key(fe);ae.indexOf(se)===0&&localStorage.removeItem(ae)}});return d(G,j),G}function Up(j,ee){var G=this;j=p(j);var se=G.ready().then(function(){var fe=G._dbInfo,ae=localStorage.getItem(fe.keyPrefix+j);return ae&&(ae=fe.serializer.deserialize(ae)),ae});return d(se,ee),se}function xv(j,ee){var G=this,se=G.ready().then(function(){for(var fe=G._dbInfo,ae=fe.keyPrefix,De=ae.length,Ue=localStorage.length,We=1,Fe=0;Fe<Ue;Fe++){var Le=localStorage.key(Fe);if(Le.indexOf(ae)===0){var at=localStorage.getItem(Le);if(at&&(at=fe.serializer.deserialize(at)),at=j(at,Le.substring(De),We++),at!==void 0)return at}}});return d(se,ee),se}function Lb(j,ee){var G=this,se=G.ready().then(function(){var fe=G._dbInfo,ae;try{ae=localStorage.key(j)}catch(De){ae=null}return ae&&(ae=ae.substring(fe.keyPrefix.length)),ae});return d(se,ee),se}function Ul(j){var ee=this,G=ee.ready().then(function(){for(var se=ee._dbInfo,fe=localStorage.length,ae=[],De=0;De<fe;De++){var Ue=localStorage.key(De);Ue.indexOf(se.keyPrefix)===0&&ae.push(Ue.substring(se.keyPrefix.length))}return ae});return d(G,j),G}function Bb(j){var ee=this,G=ee.keys().then(function(se){return se.length});return d(G,j),G}function wv(j,ee){var G=this;j=p(j);var se=G.ready().then(function(){var fe=G._dbInfo;localStorage.removeItem(fe.keyPrefix+j)});return d(se,ee),se}function _v(j,ee,G){var se=this;j=p(j);var fe=se.ready().then(function(){ee===void 0&&(ee=null);var ae=ee;return new f(function(De,Ue){var We=se._dbInfo;We.serializer.serialize(ee,function(Fe,Le){if(Le)Ue(Le);else try{localStorage.setItem(We.keyPrefix+j,Fe),De(ae)}catch(at){(at.name==="QuotaExceededError"||at.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Ue(at),Ue(at)}})})});return d(fe,G),fe}function zb(j,ee){if(ee=g.apply(this,arguments),j=typeof j!="function"&&j||{},!j.name){var G=this.config();j.name=j.name||G.name,j.storeName=j.storeName||G.storeName}var se=this,fe;return j.name?fe=new f(function(ae){j.storeName?ae(Kr(j,se._defaultConfig)):ae(j.name+"/")}).then(function(ae){for(var De=localStorage.length-1;De>=0;De--){var Ue=localStorage.key(De);Ue.indexOf(ae)===0&&localStorage.removeItem(Ue)}}):fe=f.reject("Invalid arguments"),d(fe,ee),fe}var Sv={_driver:"localStorageWrapper",_initStorage:Od,_support:ui(),iterate:xv,getItem:Up,setItem:_v,removeItem:wv,clear:bv,length:Bb,key:Lb,keys:Ul,dropInstance:zb},Wp=function(ee,G){return ee===G||typeof ee=="number"&&typeof G=="number"&&isNaN(ee)&&isNaN(G)},Wl=function(ee,G){for(var se=ee.length,fe=0;fe<se;){if(Wp(ee[fe],G))return!0;fe++}return!1},lf=Array.isArray||function(j){return Object.prototype.toString.call(j)==="[object Array]"},Qs={},cf={},Vl={INDEXEDDB:L,WEBSQL:Yi,LOCALSTORAGE:Sv},Id=[Vl.INDEXEDDB._driver,Vl.WEBSQL._driver,Vl.LOCALSTORAGE._driver],ff=["dropInstance"],Pu=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ff),Vp={description:"",driver:Id.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function $u(j,ee){j[ee]=function(){var G=arguments;return j.ready().then(function(){return j[ee].apply(j,G)})}}function Nd(){for(var j=1;j<arguments.length;j++){var ee=arguments[j];if(ee)for(var G in ee)ee.hasOwnProperty(G)&&(lf(ee[G])?arguments[0][G]=ee[G].slice():arguments[0][G]=ee[G])}return arguments[0]}var qp=function(){function j(ee){o(this,j);for(var G in Vl)if(Vl.hasOwnProperty(G)){var se=Vl[G],fe=se._driver;this[G]=fe,Qs[fe]||this.defineDriver(se)}this._defaultConfig=Nd({},Vp),this._config=Nd({},this._defaultConfig,ee),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return j.prototype.config=function(G){if((typeof G=="undefined"?"undefined":a(G))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var se in G){if(se==="storeName"&&(G[se]=G[se].replace(/\W/g,"_")),se==="version"&&typeof G[se]!="number")return new Error("Database version must be a number.");this._config[se]=G[se]}return"driver"in G&&G.driver?this.setDriver(this._config.driver):!0}else return typeof G=="string"?this._config[G]:this._config},j.prototype.defineDriver=function(G,se,fe){var ae=new f(function(De,Ue){try{var We=G._driver,Fe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!G._driver){Ue(Fe);return}for(var Le=Pu.concat("_initStorage"),at=0,yt=Le.length;at<yt;at++){var Mt=Le[at],$t=!Wl(ff,Mt);if(($t||G[Mt])&&typeof G[Mt]!="function"){Ue(Fe);return}}var Tn=function(){for(var df=function(jb){return function(){var Dd=new Error("Method "+jb+" is not implemented by the current driver"),tu=f.reject(Dd);return d(tu,arguments[arguments.length-1]),tu}},eu=0,Ia=ff.length;eu<Ia;eu++){var Gp=ff[eu];G[Gp]||(G[Gp]=df(Gp))}};Tn();var rr=function(df){Qs[We]&&console.info("Redefining LocalForage driver: "+We),Qs[We]=G,cf[We]=df,De()};"_support"in G?G._support&&typeof G._support=="function"?G._support().then(rr,Ue):rr(!!G._support):rr(!0)}catch(Xr){Ue(Xr)}});return h(ae,se,fe),ae},j.prototype.driver=function(){return this._driver||null},j.prototype.getDriver=function(G,se,fe){var ae=Qs[G]?f.resolve(Qs[G]):f.reject(new Error("Driver not found."));return h(ae,se,fe),ae},j.prototype.getSerializer=function(G){var se=f.resolve(jl);return h(se,G),se},j.prototype.ready=function(G){var se=this,fe=se._driverSet.then(function(){return se._ready===null&&(se._ready=se._initDriver()),se._ready});return h(fe,G,G),fe},j.prototype.setDriver=function(G,se,fe){var ae=this;lf(G)||(G=[G]);var De=this._getSupportedDrivers(G);function Ue(){ae._config.driver=ae.driver()}function We(at){return ae._extend(at),Ue(),ae._ready=ae._initStorage(ae._config),ae._ready}function Fe(at){return function(){var yt=0;function Mt(){for(;yt<at.length;){var $t=at[yt];return yt++,ae._dbInfo=null,ae._ready=null,ae.getDriver($t).then(We).catch(Mt)}Ue();var Tn=new Error("No available storage method found.");return ae._driverSet=f.reject(Tn),ae._driverSet}return Mt()}}var Le=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=Le.then(function(){var at=De[0];return ae._dbInfo=null,ae._ready=null,ae.getDriver(at).then(function(yt){ae._driver=yt._driver,Ue(),ae._wrapLibraryMethodsWithReady(),ae._initDriver=Fe(De)})}).catch(function(){Ue();var at=new Error("No available storage method found.");return ae._driverSet=f.reject(at),ae._driverSet}),h(this._driverSet,se,fe),this._driverSet},j.prototype.supports=function(G){return!!cf[G]},j.prototype._extend=function(G){Nd(this,G)},j.prototype._getSupportedDrivers=function(G){for(var se=[],fe=0,ae=G.length;fe<ae;fe++){var De=G[fe];this.supports(De)&&se.push(De)}return se},j.prototype._wrapLibraryMethodsWithReady=function(){for(var G=0,se=Pu.length;G<se;G++)$u(this,Pu[G])},j.prototype.createInstance=function(G){return new j(G)},j}(),Hp=new qp;r.exports=Hp},{"3":3}]},{},[4])(4)})})(Qxe);var UDt=Qxe.exports,ewe={exports:{}},WDt=bf(N2e);const VDt=!0;function hv(e,t,n,r){let i;n=n||0,r=r||t.length-1;let a=r<=2147483647;for(;r-n>1;)i=a?n+r>>1:Bl((n+r)/2),t[i]<e?n=i:r=i;return e-t[n]<=t[r]-e?n:r}function Bp(e,t,n,r){for(let i=r==1?t:n;i>=t&&i<=n;i+=r)if(e[i]!=null)return i;return-1}function qDt(e,t,n,r){let i=Ln,a=-Ln;if(r==1)i=e[t],a=e[n];else if(r==-1)i=e[n],a=e[t];else for(let o=t;o<=n;o++)e[o]!=null&&(i=Ys(i,e[o]),a=Nu(a,e[o]));return[i,a]}function HDt(e,t,n){let r=Ln,i=-Ln;for(let a=t;a<=n;a++)e[a]>0&&(r=Ys(r,e[a]),i=Nu(i,e[a]));return[r==Ln?1:r,i==-Ln?10:i]}const ZW=[0,0];function twe(e,t,n,r){return ZW[0]=n<0?Rr(e,-n):e,ZW[1]=r<0?Rr(t,-r):t,ZW}function iR(e,t,n,r){let i=KDt(e),a=n==10?Ab:iwe;e==t&&(i==-1?(e*=n,t/=n):(e/=n,t*=n));let o,s,u;return r?(o=Bl(a(e)),s=tV(a(t)),u=twe(zp(n,o),zp(n,s),o,s),e=u[0],t=u[1]):(o=Bl(a(hs(e))),s=Bl(a(hs(t))),u=twe(zp(n,o),zp(n,s),o,s),e=lwe(e,u[0]),t=pv(t,u[1])),[e,t]}function JW(e,t,n,r){let i=iR(e,t,n,r);return e==0&&(i[0]=0),t==0&&(i[1]=0),i}const QW=.1,nwe={mode:3,pad:QW},hS={pad:0,soft:null,mode:0},GDt={min:hS,max:hS};function aR(e,t,n,r){return lR(n)?rwe(e,t,n):(hS.pad=n,hS.soft=r?0:null,hS.mode=r?3:0,rwe(e,t,GDt))}function Oa(e,t){return e??t}function rwe(e,t,n){let r=n.min,i=n.max,a=Oa(r.pad,0),o=Oa(i.pad,0),s=Oa(r.hard,-Ln),u=Oa(i.hard,Ln),l=Oa(r.soft,Ln),c=Oa(i.soft,-Ln),f=Oa(r.mode,0),d=Oa(i.mode,0),h=t-e;h<1e-9&&(h=0,(e==0||t==0)&&(h=1e-9,f==2&&l!=Ln&&(a=0),d==2&&c!=-Ln&&(o=0)));let p=h||hs(t)||1e3,g=Ab(p),m=zp(10,Bl(g)),v=p*(h==0?e==0?.1:1:a),y=Rr(lwe(e-v,m/10),9),b=e>=l&&(f==1||f==3&&y<=l||f==2&&y>=l)?l:Ln,x=Nu(s,y<b&&e>=b?b:Ys(b,y)),w=p*(h==0?t==0?.1:1:o),S=Rr(pv(t+w,m/10),9),C=t<=c&&(d==1||d==3&&S>=c||d==2&&S<=c)?c:-Ln,_=Ys(u,S>C&&t<=C?C:Nu(C,S));return x==_&&x==0&&(_=100),[x,_]}const eV=new Intl.NumberFormat(navigator.language).format,Xs=Math,oR=Xs.PI,hs=Xs.abs,Bl=Xs.floor,ha=Xs.round,tV=Xs.ceil,Ys=Xs.min,Nu=Xs.max,zp=Xs.pow,KDt=Xs.sign,Ab=Xs.log10,iwe=Xs.log2,XDt=(e,t=1)=>Xs.sinh(e/t),nV=(e,t=1)=>Xs.asinh(e/t),Ln=1/0;function ps(e,t){return ha(e/t)*t}function awe(e,t,n){return Ys(Nu(e,t),n)}function Bn(e){return typeof e=="function"?e:()=>e}const YDt=e=>e,owe=(e,t)=>t,ZDt=e=>null,swe=e=>!0,uwe=(e,t)=>e==t;function pv(e,t){return tV(e/t)*t}function lwe(e,t){return Bl(e/t)*t}function Rr(e,t){return ha(e*(t=10**t))/t}const sR=new Map;function JDt(e){return((""+e).split(".")[1]||"").length}function pS(e,t,n,r){let i=[],a=r.map(JDt);for(let o=t;o<n;o++){let s=hs(o),u=Rr(zp(e,o),s);for(let l=0;l<r.length;l++){let c=r[l]*u,f=(c>=0&&o>=0?0:s)+(o>=a[l]?0:a[l]),d=Rr(c,f);i.push(d),sR.set(d,f)}}return i}const uR={},kb=[null,null],gS=Array.isArray;function cwe(e){return typeof e=="string"}function lR(e){let t=!1;if(e!=null){let n=e.constructor;t=n==null||n==Object}return t}function QDt(e){return e!=null&&typeof e=="object"}function Tb(e,t){t=t||lR;let n;if(gS(e))n=e.map(i=>Tb(i,t));else if(t(e)){n={};for(var r in e)n[r]=Tb(e[r],t)}else n=e;return n}function eo(e){let t=arguments;for(let n=1;n<t.length;n++){let r=t[n];for(let i in r)lR(e[i])?eo(e[i],Tb(r[i])):e[i]=Tb(r[i])}return e}const eRt=0,tRt=1,nRt=2;function rRt(e,t,n){for(let r=0,i,a=-1;r<t.length;r++){let o=t[r];if(o>a){for(i=o-1;i>=0&&e[i]==null;)e[i--]=null;for(i=o+1;i<n&&e[i]==null;)e[a=i++]=null}}}function iRt(e,t){let n=new Set;for(let o=0;o<e.length;o++){let u=e[o][0],l=u.length;for(let c=0;c<l;c++)n.add(u[c])}let r=[Array.from(n).sort((o,s)=>o-s)],i=r[0].length,a=new Map;for(let o=0;o<i;o++)a.set(r[0][o],o);for(let o=0;o<e.length;o++){let s=e[o],u=s[0];for(let l=1;l<s.length;l++){let c=s[l],f=Array(i).fill(void 0),d=t?t[o][l]:tRt,h=[];for(let p=0;p<c.length;p++){let g=c[p],m=a.get(u[p]);g===null?d!=eRt&&(f[m]=g,d==nRt&&h.push(m)):f[m]=g}rRt(f,h,i),r.push(f)}}return r}const aRt=typeof queueMicrotask=="undefined"?e=>Promise.resolve().then(e):queueMicrotask,mS="width",vS="height",yS="top",fwe="bottom",Ob="left",rV="right",iV="#000",dwe=iV+"0",hwe="mousemove",pwe="mousedown",aV="mouseup",gwe="mouseenter",mwe="mouseleave",vwe="dblclick",oRt="resize",sRt="scroll",ywe="change",oV="dppxchange",Ki="u-",uRt="uplot",lRt=Ki+"hz",cRt=Ki+"vt",fRt=Ki+"title",dRt=Ki+"wrap",hRt=Ki+"under",pRt=Ki+"over",bS=Ki+"off",gRt=Ki+"select",mRt=Ki+"cursor-x",vRt=Ki+"cursor-y",yRt=Ki+"cursor-pt",bRt=Ki+"legend",xRt=Ki+"live",wRt=Ki+"inline",_Rt=Ki+"thead",SRt=Ki+"series",ERt=Ki+"marker",bwe=Ki+"label",CRt=Ki+"value",sV=document,xS=window;let gr,cR;function uV(){gr=devicePixelRatio,cR&&cV(ywe,cR,uV),cR=matchMedia(`screen and (min-resolution: ${gr-.001}dppx) and (max-resolution: ${gr+.001}dppx)`),Nb(ywe,cR,uV),xS.dispatchEvent(new CustomEvent(oV))}function Du(e,t){if(t!=null){let n=e.classList;!n.contains(t)&&n.add(t)}}function xwe(e,t){let n=e.classList;n.contains(t)&&n.remove(t)}function Fi(e,t,n){e.style[t]=n+"px"}function kd(e,t,n,r){let i=sV.createElement(e);return t!=null&&Du(i,t),n!=null&&n.insertBefore(i,r),i}function zl(e,t){return kd("div",e,t)}const wwe=new WeakMap;function Ib(e,t,n,r,i){let a="translate("+t+"px,"+n+"px)",o=wwe.get(e);a!=o&&(e.style.transform=a,wwe.set(e,a),t<0||n<0||t>r||n>i?Du(e,bS):xwe(e,bS))}const _we=new WeakMap;function ARt(e,t,n){let r=t+n,i=_we.get(e);r!=i&&(_we.set(e,r),e.style.background=t,e.style.borderColor=n)}const lV={passive:!0},Swe=eo({capture:!0},lV);function Nb(e,t,n,r){t.addEventListener(e,n,r?Swe:lV)}function cV(e,t,n,r){t.removeEventListener(e,n,r?Swe:lV)}uV();const Ewe=["January","February","March","April","May","June","July","August","September","October","November","December"],Cwe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Awe(e){return e.slice(0,3)}const kRt=Cwe.map(Awe),TRt=Ewe.map(Awe),ORt={MMMM:Ewe,MMM:TRt,WWWW:Cwe,WWW:kRt};function wS(e){return(e<10?"0":"")+e}function IRt(e){return(e<10?"00":e<100?"0":"")+e}const NRt={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>wS(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>wS(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>wS(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return t==0?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>wS(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>wS(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>IRt(e.getMilliseconds())};function fV(e,t){t=t||ORt;let n=[],r=/\{([a-z]+)\}|[^{]+/gi,i;for(;i=r.exec(e);)n.push(i[0][0]=="{"?NRt[i[1]]:i[0]);return a=>{let o="";for(let s=0;s<n.length;s++)o+=typeof n[s]=="string"?n[s]:n[s](a,t);return o}}const DRt=new Intl.DateTimeFormat().resolvedOptions().timeZone;function RRt(e,t){let n;return t=="UTC"||t=="Etc/UTC"?n=new Date(+e+e.getTimezoneOffset()*6e4):t==DRt?n=e:(n=new Date(e.toLocaleString("en-US",{timeZone:t})),n.setMilliseconds(e.getMilliseconds())),n}const kwe=e=>e%1==0,fR=[1,2,2.5,5],FRt=pS(10,-16,0,fR),Twe=pS(10,0,16,fR),MRt=Twe.filter(kwe),PRt=FRt.concat(Twe),dV=`
`,Owe="{YYYY}",Iwe=dV+Owe,Nwe="{M}/{D}",_S=dV+Nwe,dR=_S+"/{YY}",Dwe="{aa}",$Rt="{h}:{mm}",Db=$Rt+Dwe,Rwe=dV+Db,Fwe=":{ss}",nr=null;function Mwe(e){let t=e*1e3,n=t*60,r=n*60,i=r*24,a=i*30,o=i*365,u=(e==1?pS(10,0,3,fR).filter(kwe):pS(10,-3,0,fR)).concat([t,t*5,t*10,t*15,t*30,n,n*5,n*10,n*15,n*30,r,r*2,r*3,r*4,r*6,r*8,r*12,i,i*2,i*3,i*4,i*5,i*6,i*7,i*8,i*9,i*10,i*15,a,a*2,a*3,a*4,a*6,o,o*2,o*5,o*10,o*25,o*50,o*100]);const l=[[o,Owe,nr,nr,nr,nr,nr,nr,1],[i*28,"{MMM}",Iwe,nr,nr,nr,nr,nr,1],[i,Nwe,Iwe,nr,nr,nr,nr,nr,1],[r,"{h}"+Dwe,dR,nr,_S,nr,nr,nr,1],[n,Db,dR,nr,_S,nr,nr,nr,1],[t,Fwe,dR+" "+Db,nr,_S+" "+Db,nr,Rwe,nr,1],[e,Fwe+".{fff}",dR+" "+Db,nr,_S+" "+Db,nr,Rwe,nr,1]];function c(f){return(d,h,p,g,m,v)=>{let y=[],b=m>=o,x=m>=a&&m<o,w=f(p),S=Rr(w*e,3),C=hV(w.getFullYear(),b?0:w.getMonth(),x||b?1:w.getDate()),_=Rr(C*e,3);if(x||b){let E=x?m/a:0,A=b?m/o:0,k=S==_?S:Rr(hV(C.getFullYear()+A,C.getMonth()+E,1)*e,3),T=new Date(ha(k/e)),I=T.getFullYear(),N=T.getMonth();for(let O=0;k<=g;O++){let D=hV(I+A*O,N+E*O,1),P=D-f(Rr(D*e,3));k=Rr((+D+P)*e,3),k<=g&&y.push(k)}}else{let E=m>=i?i:m,A=Bl(p)-Bl(S),k=_+A+pv(S-_,E);y.push(k);let T=f(k),I=T.getHours()+T.getMinutes()/n+T.getSeconds()/r,N=m/r,O=d.axes[h]._space,D=v/O;for(;k=Rr(k+m,e==1?0:3),!(k>g);)if(N>1){let P=Bl(Rr(I+N,6))%24,X=f(k).getHours()-P;X>1&&(X=-1),k-=X*r,I=(I+N)%24;let Q=y[y.length-1];Rr((k-Q)/m,3)*D>=.7&&y.push(k)}else y.push(k)}return y}}return[u,l,c]}const[LRt,BRt,zRt]=Mwe(1),[jRt,URt,WRt]=Mwe(.001);pS(2,-53,53,[1]);function Pwe(e,t){return e.map(n=>n.map((r,i)=>i==0||i==8||r==null?r:t(i==1||n[8]==0?r:n[1]+r)))}function $we(e,t){return(n,r,i,a,o)=>{let s=t.find(p=>o>=p[0])||t[t.length-1],u,l,c,f,d,h;return r.map(p=>{let g=e(p),m=g.getFullYear(),v=g.getMonth(),y=g.getDate(),b=g.getHours(),x=g.getMinutes(),w=g.getSeconds(),S=m!=u&&s[2]||v!=l&&s[3]||y!=c&&s[4]||b!=f&&s[5]||x!=d&&s[6]||w!=h&&s[7]||s[1];return u=m,l=v,c=y,f=b,d=x,h=w,S(g)})}}function VRt(e,t){let n=fV(t);return(r,i,a,o,s)=>i.map(u=>n(e(u)))}function hV(e,t,n){return new Date(e,t,n)}function Lwe(e,t){return t(e)}const qRt="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function Bwe(e,t){return(n,r)=>t(e(r))}function HRt(e,t){let n=e.series[t];return n.width?n.stroke(e,t):n.points.width?n.points.stroke(e,t):null}function GRt(e,t){return e.series[t].fill(e,t)}const KRt={show:!0,live:!0,isolate:!1,markers:{show:!0,width:2,stroke:HRt,fill:GRt,dash:"solid"},idx:null,idxs:null,values:[]};function XRt(e,t){let n=e.cursor.points,r=zl(),i=n.size(e,t);Fi(r,mS,i),Fi(r,vS,i);let a=i/-2;Fi(r,"marginLeft",a),Fi(r,"marginTop",a);let o=n.width(e,t,i);return o&&Fi(r,"borderWidth",o),r}function YRt(e,t){let n=e.series[t].points;return n._fill||n._stroke}function ZRt(e,t){let n=e.series[t].points;return n._stroke||n._fill}function JRt(e,t){let n=e.series[t].points;return qwe(n.width,1)}function QRt(e,t,n){return n}const pV=[0,0];function eFt(e,t,n){return pV[0]=t,pV[1]=n,pV}function hR(e,t,n){return r=>{r.button==0&&n(r)}}function gV(e,t,n){return n}const tFt={show:!0,x:!0,y:!0,lock:!1,move:eFt,points:{show:XRt,size:JRt,width:0,stroke:ZRt,fill:YRt},bind:{mousedown:hR,mouseup:hR,click:hR,dblclick:hR,mousemove:gV,mouseleave:gV,mouseenter:gV},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,_x:!1,_y:!1},focus:{prox:-1},left:-10,top:-10,idx:null,dataIdx:QRt,idxs:null},mV={show:!0,stroke:"rgba(0,0,0,0.07)",width:2,filter:owe},zwe=eo({},mV,{size:10}),vV='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',jwe="bold "+vV,nFt=1.5,Uwe={show:!0,scale:"x",stroke:iV,space:50,gap:5,size:50,labelGap:0,labelSize:30,labelFont:jwe,side:2,grid:mV,ticks:zwe,font:vV,rotate:0},rFt="Value",iFt="Time",Wwe={show:!0,scale:"x",auto:!1,sorted:1,min:Ln,max:-Ln,idxs:[]};function aFt(e,t,n,r,i){return t.map(a=>a==null?"":eV(a))}function oFt(e,t,n,r,i,a,o){let s=[],u=sR.get(i)||0;n=o?n:Rr(pv(n,i),u);for(let l=n;l<=r;l=Rr(l+i,u))s.push(Object.is(l,-0)?0:l);return s}function yV(e,t,n,r,i,a,o){const s=[],u=e.scales[e.axes[t].scale].log,l=u==10?Ab:iwe,c=Bl(l(n));i=zp(u,c),c<0&&(i=Rr(i,-c));let f=n;do s.push(f),f=Rr(f+i,sR.get(i)),f>=i*u&&(i=f);while(f<=r);return s}function sFt(e,t,n,r,i,a,o){let u=e.scales[e.axes[t].scale].asinh,l=r>u?yV(e,t,Nu(u,n),r,i):[u],c=r>=0&&n<=0?[0]:[];return(n<-u?yV(e,t,Nu(u,-r),-n,i):[u]).reverse().map(d=>-d).concat(c,l)}const uFt=/./,lFt=/[12357]/,cFt=/[125]/,fFt=/1/;function dFt(e,t,n,r,i){let a=e.axes[n],o=a.scale,s=e.scales[o];if(s.distr==3&&s.log==2)return t;let u=e.valToPos,l=a._space,c=u(10,o),f=u(9,o)-c>=l?uFt:u(7,o)-c>=l?lFt:u(5,o)-c>=l?cFt:fFt;return t.map(d=>s.distr==4&&d==0||f.test(d)?d:null)}function hFt(e,t){return t==null?"":eV(t)}const Vwe={show:!0,scale:"y",stroke:iV,space:30,gap:5,size:50,labelGap:0,labelSize:30,labelFont:jwe,side:3,grid:mV,ticks:zwe,font:vV,rotate:0};function qwe(e,t){let n=3+(e||1)*2;return Rr(n*t,3)}function pFt(e,t){let{scale:n,idxs:r}=e.series[0],i=e._data[0],a=e.valToPos(i[r[0]],n,!0),o=e.valToPos(i[r[1]],n,!0),s=hs(o-a),u=e.series[t],l=s/(u.points.space*gr);return r[1]-r[0]<=l}function gFt(e,t,n,r){let i=e.scales[e.series[t].scale],a=e.bands&&e.bands.some(o=>o.series[0]==t);return i.distr==3||a?i.min:0}const Hwe={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:(e,t,n,r,i)=>i,alpha:1,points:{show:pFt,filter:null},values:null,min:Ln,max:-Ln,idxs:[],path:null,clip:null};function mFt(e,t,n,r,i){return n/10}const Gwe={time:VDt,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},vFt=eo({},Gwe,{time:!1,ori:1}),Kwe={};function Xwe(e,t){let n=Kwe[e];return n||(n={key:e,plots:[],sub(r){n.plots.push(r)},unsub(r){n.plots=n.plots.filter(i=>i!=r)},pub(r,i,a,o,s,u,l){for(let c=0;c<n.plots.length;c++)n.plots[c]!=i&&n.plots[c].pub(r,i,a,o,s,u,l)}},e!=null&&(Kwe[e]=n)),n}const gv=1<<0,pR=1<<1;function mv(e,t,n){const r=e.series[t],i=e.scales,a=e.bbox,o=i[e.series[0].scale];let s=e._data[0],u=e._data[t],l=o,c=i[r.scale],f=a.left,d=a.top,h=a.width,p=a.height,g=e.valToPosH,m=e.valToPosV;return l.ori==0?n(r,s,u,l,c,g,m,f,d,h,p,xV,Rb,mR,Zwe,Qwe):n(r,s,u,l,c,m,g,d,f,p,h,wV,Fb,_V,Jwe,e2e)}function bV(e,t,n,r,i){return mv(e,t,(a,o,s,u,l,c,f,d,h,p,g)=>{const m=u.dir*(u.ori==0?1:-1),v=u.ori==0?Rb:Fb;let y,b;m==1?(y=n,b=r):(y=r,b=n);let x=ps(c(o[y],u,p,d),.5),w=ps(f(s[y],l,g,h),.5),S=ps(c(o[b],u,p,d),.5),C=ps(f(l.max,l,g,h),.5),_=new Path2D(i);return v(_,S,C),v(_,x,C),v(_,x,w),_})}function gR(e,t,n,r,i,a){let o=null;if(e.length>0){o=new Path2D;const s=t==0?mR:_V;let u=n;for(let l=0;l<e.length;l++){let c=e[l];c[1]>c[0]&&(s(o,u,r,c[0]-u,r+a),u=c[1])}s(o,u,r,n+i-u,r+a)}return o}function jp(e,t,n){let r=e[e.length-1];r&&r[0]==t?r[1]=n:e.push([t,n])}function Ywe(e){return e==0?YDt:e==1?ha:t=>ps(t,e)}function xV(e,t,n){e.moveTo(t,n)}function wV(e,t,n){e.moveTo(n,t)}function Rb(e,t,n){e.lineTo(t,n)}function Fb(e,t,n){e.lineTo(n,t)}function mR(e,t,n,r,i){e.rect(t,n,r,i)}function _V(e,t,n,r,i){e.rect(n,t,i,r)}function Zwe(e,t,n,r,i,a){e.arc(t,n,r,i,a)}function Jwe(e,t,n,r,i,a){e.arc(n,t,r,i,a)}function Qwe(e,t,n,r,i,a,o){e.bezierCurveTo(t,n,r,i,a,o)}function e2e(e,t,n,r,i,a,o){e.bezierCurveTo(n,t,i,r,o,a)}function t2e(e){return(t,n,r,i,a)=>mv(t,n,(o,s,u,l,c,f,d,h,p,g,m)=>{let{pxRound:v,points:y}=o,b,x;l.ori==0?(b=xV,x=Zwe):(b=wV,x=Jwe);const w=Rr(y.width*gr,3);let S=(y.size-y.width)/2*gr,C=Rr(S*2,3),_=new Path2D,E=new Path2D,{left:A,top:k,width:T,height:I}=t.bbox;mR(E,A-C,k-C,T+C*2,I+C*2);const N=O=>{if(u[O]!=null){let D=v(f(s[O],l,g,h)),P=v(d(u[O],c,m,p));b(_,D+S,P),x(_,D,P,S,0,oR*2)}};if(a)a.forEach(N);else for(let O=r;O<=i;O++)N(O);return{stroke:w>0?_:null,fill:_,clip:E,flags:gv|pR}})}function n2e(e){return(t,n,r,i,a,o)=>{r!=i&&(a!=r&&o!=r&&e(t,n,r),a!=i&&o!=i&&e(t,n,i),e(t,n,o))}}const yFt=n2e(Rb),bFt=n2e(Fb);function r2e(){return(e,t,n,r)=>mv(e,t,(i,a,o,s,u,l,c,f,d,h,p)=>{let g=i.pxRound,m,v;s.ori==0?(m=Rb,v=yFt):(m=Fb,v=bFt);const y=s.dir*(s.ori==0?1:-1),b={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:gv},x=b.stroke;let w=Ln,S=-Ln,C,_,E,A,k=[],T=g(l(a[y==1?n:r],s,h,f)),I=!1,N=!1,O=Bp(o,n,r,1*y),D=Bp(o,n,r,-1*y),P=ps(l(a[O],s,h,f),.5),V=ps(l(a[D],s,h,f),.5);P>f&&jp(k,f,P);for(let Y=y==1?n:r;Y>=n&&Y<=r;Y+=y){let X=g(l(a[Y],s,h,f));if(X==T)o[Y]!=null?(_=g(c(o[Y],u,p,d)),w==Ln&&(m(x,X,_),C=_),w=Ys(_,w),S=Nu(_,S)):o[Y]===null&&(I=N=!0);else{let Q=!1;w!=Ln?(v(x,T,w,S,C,_),E=A=T):I&&(Q=!0,I=!1),o[Y]!=null?(_=g(c(o[Y],u,p,d)),m(x,X,_),w=S=C=_,N&&X-T>1&&(Q=!0),N=!1):(w=Ln,S=-Ln,o[Y]===null&&(I=!0,X-T>1&&(Q=!0))),Q&&jp(k,E,X),T=X}}if(w!=Ln&&w!=S&&A!=T&&v(x,T,w,S,C,_),V<f+h&&jp(k,V,f+h),i.fill!=null){let Y=b.fill=new Path2D(x),X=g(c(i.fillTo(e,t,i.min,i.max),u,p,d));m(Y,V,X),m(Y,P,X)}return b.gaps=k=i.gaps(e,t,n,r,k),i.spanGaps||(b.clip=gR(k,s.ori,f,d,h,p)),e.bands.length>0&&(b.band=bV(e,t,n,r,x)),b})}function xFt(e){const t=Oa(e.align,1),n=Oa(e.ascDesc,!1);return(r,i,a,o)=>mv(r,i,(s,u,l,c,f,d,h,p,g,m,v)=>{let y=s.pxRound,b=c.ori==0?Rb:Fb;const x={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:gv},w=x.stroke,S=1*c.dir*(c.ori==0?1:-1);a=Bp(l,a,o,1),o=Bp(l,a,o,-1);let C=[],_=!1,E=y(h(l[S==1?a:o],f,v,g)),A=y(d(u[S==1?a:o],c,m,p)),k=A;b(w,A,E);for(let T=S==1?a:o;T>=a&&T<=o;T+=S){let I=l[T],N=y(d(u[T],c,m,p));if(I==null){I===null&&(jp(C,k,N),_=!0);continue}let O=y(h(I,f,v,g));if(_){if(jp(C,k,N),E!=O){let D=s.width*gr/2,P=C[C.length-1];P[0]+=n||t==1?D:-D,P[1]-=n||t==-1?D:-D}_=!1}t==1?b(w,N,E):b(w,k,O),b(w,N,O),E=O,k=N}if(s.fill!=null){let T=x.fill=new Path2D(w),I=s.fillTo(r,i,s.min,s.max),N=y(h(I,f,v,g));b(T,k,N),b(T,A,N)}return x.gaps=C=s.gaps(r,i,a,o,C),s.spanGaps||(x.clip=gR(C,c.ori,p,g,m,v)),r.bands.length>0&&(x.band=bV(r,i,a,o,w)),x})}function wFt(e){e=e||uR;const t=Oa(e.size,[.6,Ln,1]),n=e.align||0,r=(e.gap||0)*gr,i=1-t[0],a=Oa(t[1],Ln)*gr,o=Oa(t[2],1)*gr,s=e.disp,u=Oa(e.each,l=>{});return(l,c,f,d)=>mv(l,c,(h,p,g,m,v,y,b,x,w,S,C)=>{let _=h.pxRound;const E=m.dir*(m.ori==0?1:-1),A=v.dir*(v.ori==1?1:-1);let k=m.ori==0?mR:_V,T=m.ori==0?u:(ce,Ne,Oe,$e,ve,$,F)=>{u(ce,Ne,Oe,ve,$e,F,$)},I=h.fillTo(l,c,h.min,h.max),N=b(I,v,C,w),O,D,P=_(h.width*gr);if(s!=null){p=s.x0.values(l,c,f,d),s.x0.unit==2&&(p=p.map(Ne=>l.posToVal(x+Ne*S,m.key,!0)));let ce=s.size.values(l,c,f,d);s.size.unit==2?D=ce[0]*S:D=y(ce[0],m,S,x)-y(0,m,S,x),D=_(D-P),O=E==1?-P/2:D+P/2}else{let ce=S;if(p.length>1)for(let Oe=1,$e=1/0;Oe<p.length;Oe++){let ve=hs(p[Oe]-p[Oe-1]);ve<$e&&($e=ve,ce=hs(y(p[Oe],m,S,x)-y(p[Oe-1],m,S,x)))}let Ne=ce*i;D=_(Ys(a,Nu(o,ce-Ne))-P-r),O=(n==0?D/2:n==E?0:D)-n*E*r/2}const V={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:gv|pR},Y=l.bands.length>0;let X;Y&&(V.band=new Path2D,X=ps(b(v.max,v,C,w),.5));const Q=V.stroke,me=V.band;for(let ce=E==1?f:d;ce>=f&&ce<=d;ce+=E){let Ne=g[ce];if(Ne==null)if(Y){let J=Bp(g,E==1?f:d,ce,-E),L=Bp(g,ce,E==1?d:f,E),z=g[J],R=g[L];Ne=z+(ce-J)/(L-J)*(R-z)}else continue;let Oe=m.distr!=2||s!=null?p[ce]:ce,$e=y(Oe,m,S,x),ve=b(Ne,v,C,w),$=_($e-O),F=_(Nu(ve,N)),q=_(Ys(ve,N)),ue=F-q;g[ce]!=null&&(k(Q,$,q,D,ue),T(l,c,ce,$-P/2,q-P/2,D+P,ue+P)),Y&&(A==1?(F=q,q=X):(q=F,F=X),ue=F-q,k(me,$-P/2,q+P/2,D+P,ue-P))}return h.fill!=null&&(V.fill=new Path2D(Q)),V})}function _Ft(e,t){return(n,r,i,a)=>mv(n,r,(o,s,u,l,c,f,d,h,p,g,m)=>{let v=o.pxRound,y,b,x;l.ori==0?(y=xV,x=Rb,b=Qwe):(y=wV,x=Fb,b=e2e);const w=1*l.dir*(l.ori==0?1:-1);i=Bp(u,i,a,1),a=Bp(u,i,a,-1);let S=[],C=!1,_=v(f(s[w==1?i:a],l,g,h)),E=_,A=[],k=[];for(let N=w==1?i:a;N>=i&&N<=a;N+=w){let O=u[N],D=s[N],P=f(D,l,g,h);if(O==null){O===null&&(jp(S,E,P),C=!0);continue}else C&&(jp(S,E,P),C=!1),A.push(E=P),k.push(d(u[N],c,m,p))}const T={stroke:e(A,k,y,x,b,v),fill:null,clip:null,band:null,gaps:null,flags:gv},I=T.stroke;if(o.fill!=null&&I!=null){let N=T.fill=new Path2D(I),O=o.fillTo(n,r,o.min,o.max),D=v(d(O,c,m,p));x(N,E,D),x(N,_,D)}return T.gaps=S=o.gaps(n,r,i,a,S),o.spanGaps||(T.clip=gR(S,l.ori,h,p,g,m)),n.bands.length>0&&(T.band=bV(n,r,i,a,I)),T})}function SFt(e){return _Ft(EFt)}function EFt(e,t,n,r,i,a){const o=e.length;if(o<2)return null;const s=new Path2D;if(n(s,e[0],t[0]),o==2)r(s,e[1],t[1]);else{let u=Array(o),l=Array(o-1),c=Array(o-1),f=Array(o-1);for(let d=0;d<o-1;d++)c[d]=t[d+1]-t[d],f[d]=e[d+1]-e[d],l[d]=c[d]/f[d];u[0]=l[0];for(let d=1;d<o-1;d++)l[d]===0||l[d-1]===0||l[d-1]>0!=l[d]>0?u[d]=0:(u[d]=3*(f[d-1]+f[d])/((2*f[d]+f[d-1])/l[d-1]+(f[d]+2*f[d-1])/l[d]),isFinite(u[d])||(u[d]=0));u[o-1]=l[o-2];for(let d=0;d<o-1;d++)i(s,e[d]+f[d]/3,t[d]+u[d]*f[d]/3,e[d+1]-f[d]/3,t[d+1]-u[d+1]*f[d]/3,e[d+1],t[d+1])}return s}const SV=new Set;function i2e(){SV.forEach(e=>{e.syncRect(!0)})}Nb(oRt,xS,i2e),Nb(sRt,xS,i2e,!0);const CFt=r2e(),AFt=t2e();function a2e(e,t,n,r){return(r?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((a,o)=>o2e(a,o,t,n))}function o2e(e,t,n,r){return eo({},t==0?n:r,e)}function s2e(e,t,n){return t==null?kb:[t,n]}const kFt=s2e;function TFt(e,t,n){return t==null?kb:aR(t,n,QW,!0)}function u2e(e,t,n,r){return t==null?kb:iR(t,n,e.scales[r].log,!1)}const OFt=u2e;function l2e(e,t,n,r){return t==null?kb:JW(t,n,e.scales[r].log,!1)}const IFt=l2e;function NFt(e,t,n,r,i){let a=r/(t-e),o=(""+Bl(e)).length;for(var s=0;s<n.length;s++){let u=n[s]*a,l=n[s]<10?sR.get(n[s]):0;if(u>=i&&o+l<17)return[n[s],u]}return[0,0]}function c2e(e){let t,n;return e=e.replace(/(\d+)px/,(r,i)=>(t=ha((n=+i)*gr))+"px"),[e,t,n]}function DFt(e){e.show&&[e.font,e.labelFont].forEach(t=>{let n=Rr(t[2]*gr,1);t[0]=t[0].replace(/[0-9.]+px/,n+"px"),t[1]=n})}function gs(e,t,n){const r={};function i(M,W){return((W.distr==3?Ab(M>0?M:W.clamp(r,M,W.min,W.max,W.key)):W.distr==4?nV(M,W.asinh):M)-W._min)/(W._max-W._min)}function a(M,W,re,ie){let he=i(M,W);return ie+re*(W.dir==-1?1-he:he)}function o(M,W,re,ie){let he=i(M,W);return ie+re*(W.dir==-1?he:1-he)}function s(M,W,re,ie){return W.ori==0?a(M,W,re,ie):o(M,W,re,ie)}r.valToPosH=a,r.valToPosV=o;let u=!1;r.status=0;const l=r.root=zl(uRt);if(e.id!=null&&(l.id=e.id),Du(l,e.class),e.title){let M=zl(fRt,l);M.textContent=e.title}const c=kd("canvas"),f=r.ctx=c.getContext("2d"),d=zl(dRt,l),h=r.under=zl(hRt,d);d.appendChild(c);const p=r.over=zl(pRt,d);e=Tb(e);const g=+Oa(e.pxAlign,1),m=Ywe(g);(e.plugins||[]).forEach(M=>{M.opts&&(e=M.opts(r,e)||e)});const v=e.ms||.001,y=r.series=a2e(e.series||[],Wwe,Hwe,!1),b=r.axes=a2e(e.axes||[],Uwe,Vwe,!0),x=r.scales={},w=r.bands=e.bands||[];w.forEach(M=>{M.fill=Bn(M.fill||null)});const S=y[0].scale,C={axes:ff,series:Bb},_=(e.drawOrder||["axes","series"]).map(M=>C[M]);function E(M){let W=x[M];if(W==null){let re=(e.scales||uR)[M]||uR;if(re.from!=null)E(re.from),x[M]=eo({},x[re.from],re);else{W=x[M]=eo({},M==S?Gwe:vFt,re),W.key=M;let ie=W.time,he=W.range,Se=gS(he);if(M!=S&&(Se&&(he[0]==null||he[1]==null)&&(he={min:he[0]==null?nwe:{mode:1,hard:he[0],soft:he[0]},max:he[1]==null?nwe:{mode:1,hard:he[1],soft:he[1]}},Se=!1),!Se&&lR(he))){let qe=he;he=(Ze,ut,Lt)=>ut==null?kb:aR(ut,Lt,qe)}W.range=Bn(he||(ie?kFt:M==S?W.distr==3?OFt:W.distr==4?IFt:s2e:W.distr==3?u2e:W.distr==4?l2e:TFt)),W.auto=Bn(Se?!1:W.auto),W.clamp=Bn(W.clamp||mFt),W._min=W._max=null}}}E("x"),E("y"),y.forEach(M=>{E(M.scale)}),b.forEach(M=>{E(M.scale)});for(let M in e.scales)E(M);const A=x[S],k=A.distr;let T,I;A.ori==0?(Du(l,lRt),T=a,I=o):(Du(l,cRt),T=o,I=a);const N={};for(let M in x){let W=x[M];(W.min!=null||W.max!=null)&&(N[M]={min:W.min,max:W.max},W.min=W.max=null)}const O=e.tzDate||(M=>new Date(ha(M/v))),D=e.fmtDate||fV,P=v==1?zRt(O):WRt(O),V=$we(O,Pwe(v==1?BRt:URt,D)),Y=Bwe(O,Lwe(qRt,D)),X=[],Q=r.legend=eo({},KRt,e.legend),me=Q.show,ce=Q.markers;Q.idxs=X,ce.width=Bn(ce.width),ce.dash=Bn(ce.dash),ce.stroke=Bn(ce.stroke),ce.fill=Bn(ce.fill);let Ne,Oe=[],$e=[],ve,$=!1,F={};if(Q.live){const M=y[1]?y[1].values:null;$=M!=null,ve=$?M(r,1,0):{_:0};for(let W in ve)F[W]="--"}if(me)if(Ne=kd("table",bRt,l),$){let M=kd("tr",_Rt,Ne);kd("th",null,M);for(var q in ve)kd("th",bwe,M).textContent=q}else Du(Ne,wRt),Q.live&&Du(Ne,xRt);const ue={show:!0},J={show:!1};function L(M,W){if(W==0&&($||!Q.live))return kb;let re=[],ie=kd("tr",SRt,Ne,Ne.childNodes[W]);Du(ie,M.class),M.show||Du(ie,bS);let he=kd("th",null,ie);if(ce.show){let Ze=zl(ERt,he);if(W>0){let ut=ce.width(r,W);ut&&(Ze.style.border=ut+"px "+ce.dash(r,W)+" "+ce.stroke(r,W)),Ze.style.background=ce.fill(r,W)}}let Se=zl(bwe,he);Se.textContent=M.label,W>0&&(ce.show||(Se.style.color=M.width>0?ce.stroke(r,W):ce.fill(r,W)),R("click",he,Ze=>{if(Wt._lock)return;let ut=y.indexOf(M);if(Ze.ctrlKey!=Q.isolate){let Lt=y.some((tt,Vt)=>Vt>0&&Vt!=ut&&tt.show);y.forEach((tt,Vt)=>{Vt>0&&Ia(Vt,Lt?Vt==ut?ue:J:ue,ci.setSeries)})}else Ia(ut,{show:!M.show},ci.setSeries)}),sf&&R(gwe,he,Ze=>{Wt._lock||Ia(y.indexOf(M),Kp,ci.setSeries)}));for(var qe in ve){let Ze=kd("td",CRt,ie);Ze.textContent="--",re.push(Ze)}return[ie,re]}const z=new Map;function R(M,W,re){const ie=z.get(W)||{},he=Wt.bind[M](r,W,re);he&&(Nb(M,W,ie[M]=he),z.set(W,ie))}function Z(M,W,re){const ie=z.get(W)||{};for(let he in ie)(M==null||he==M)&&(cV(he,W,ie[he]),delete ie[he]);M==null&&z.delete(W)}let xe=0,Ee=0,Me=0,Ve=0,Je=0,Ft=0,et=0,Gt=0,rn=0,kn=0;r.bbox={};let Br=!1,Jn=!1,_n=!1,Xi=!1,kr=!1;function ms(M,W,re){(re||M!=r.width||W!=r.height)&&$o(M,W),Pu(!1),_n=!0,Jn=!0,Xi=kr=Wt.left>=0,$u()}function $o(M,W){r.width=xe=Me=M,r.height=Ee=Ve=W,Je=Ft=0,jl(),vv();let re=r.bbox;et=re.left=ps(Je*gr,.5),Gt=re.top=ps(Ft*gr,.5),rn=re.width=ps(Me*gr,.5),kn=re.height=ps(Ve*gr,.5)}const vs=3;function Ru(){let M=!1,W=0;for(;!M;){W++;let re=Vl(W),ie=Id(W);M=W==vs||re&&ie,M||($o(r.width,r.height),Jn=!0)}}function Fu({width:M,height:W}){ms(M,W)}r.setSize=Fu;function jl(){let M=!1,W=!1,re=!1,ie=!1;b.forEach((he,Se)=>{if(he.show&&he._show){let{side:qe,_size:Ze}=he,ut=qe%2,Lt=he.labelSize=he.label!=null?he.labelSize||30:0,tt=Ze+Lt;tt>0&&(ut?(Me-=tt,qe==3?(Je+=tt,ie=!0):re=!0):(Ve-=tt,qe==0?(Ft+=tt,M=!0):W=!0))}}),Mu[0]=M,Mu[1]=re,Mu[2]=W,Mu[3]=ie,Me-=Js[1]+Js[3],Je+=Js[3],Ve-=Js[2]+Js[0],Ft+=Js[0]}function vv(){let M=Je+Me,W=Ft+Ve,re=Je,ie=Ft;function he(Se,qe){switch(Se){case 1:return M+=qe,M-qe;case 2:return W+=qe,W-qe;case 3:return re-=qe,re+qe;case 0:return ie-=qe,ie+qe}}b.forEach((Se,qe)=>{if(Se.show&&Se._show){let Ze=Se.side;Se._pos=he(Ze,Se._size),Se.label!=null&&(Se._lpos=he(Ze,Se.labelSize))}})}const Wt=r.cursor=eo({},tFt,e.cursor);{Wt.idxs=X,Wt._lock=!1;let M=Wt.points;M.show=Bn(M.show),M.size=Bn(M.size),M.stroke=Bn(M.stroke),M.width=Bn(M.width),M.fill=Bn(M.fill)}const to=r.focus=eo({},e.focus||{alpha:.3},Wt.focus),sf=to.prox>=0;let si=[null];function yv(M,W){if(W>0){let re=Wt.points.show(r,W);if(re)return Du(re,yRt),Du(re,M.class),Ib(re,-10,-10,Me,Ve),p.insertBefore(re,si[W]),re}}function Zs(M,W){let re=x[M.scale].time,ie=M.value;if(M.value=re?cwe(ie)?Bwe(O,Lwe(ie,D)):ie||Y:ie||hFt,M.label=M.label||(re?iFt:rFt),W>0){M.width=M.width==null?1:M.width,M.paths=M.paths||CFt||ZDt,M.fillTo=Bn(M.fillTo||gFt),M.pxAlign=+Oa(M.pxAlign,g),M.pxRound=Ywe(M.pxAlign),M.stroke=Bn(M.stroke||null),M.fill=Bn(M.fill||null),M._stroke=M._fill=M._paths=M._focus=null;let he=qwe(M.width,1),Se=M.points=eo({},{size:he,width:Nu(1,he*.2),stroke:M.stroke,space:he*2,paths:AFt,_stroke:null,_fill:null},M.points);Se.show=Bn(Se.show),Se.filter=Bn(Se.filter),Se.fill=Bn(Se.fill),Se.stroke=Bn(Se.stroke),Se.paths=Bn(Se.paths),Se.pxAlign=M.pxAlign}if(me){let he=L(M,W);Oe.splice(W,0,he[0]),$e.splice(W,0,he[1]),Q.values.push(null)}if(Wt.show){X.splice(W,0,null);let he=yv(M,W);he&&si.splice(W,0,he)}}function Mb(M,W){W=W??y.length,M=o2e(M,W,Wwe,Hwe),y.splice(W,0,M),Zs(y[W],W)}r.addSeries=Mb;function Pb(M){if(y.splice(M,1),me){Q.values.splice(M,1),$e.splice(M,1);let W=Oe.splice(M,1)[0];Z(null,W.firstChild),W.remove()}Wt.show&&(X.splice(M,1),si.length>1&&si.splice(M,1)[0].remove())}r.delSeries=Pb;const Mu=[!1,!1,!1,!1];function $b(M,W){if(M._show=M.show,M.show){let re=M.side%2,ie=x[M.scale];ie==null&&(M.scale=re?y[1].scale:S,ie=x[M.scale]);let he=ie.time;M.size=Bn(M.size),M.space=Bn(M.space),M.rotate=Bn(M.rotate),M.incrs=Bn(M.incrs||(ie.distr==2?MRt:he?v==1?LRt:jRt:PRt)),M.splits=Bn(M.splits||(he&&ie.distr==1?P:ie.distr==3?yV:ie.distr==4?sFt:oFt)),M.stroke=Bn(M.stroke),M.grid.stroke=Bn(M.grid.stroke),M.ticks.stroke=Bn(M.ticks.stroke);let Se=M.values;M.values=gS(Se)&&!gS(Se[0])?Bn(Se):he?gS(Se)?$we(O,Pwe(Se,D)):cwe(Se)?VRt(O,Se):Se||V:Se||aFt,M.filter=Bn(M.filter||(ie.distr>=3?dFt:owe)),M.font=c2e(M.font),M.labelFont=c2e(M.labelFont),M._size=M.size(r,null,W,0),M._space=M._rotate=M._incrs=M._found=M._splits=M._values=null,M._size>0&&(Mu[W]=!0)}}function uf(M,W,re,ie){let[he,Se,qe,Ze]=re,ut=W%2,Lt=0;return ut==0&&(Ze||Se)&&(Lt=W==0&&!he||W==2&&!qe?ha(Uwe.size/3):0),ut==1&&(he||qe)&&(Lt=W==1&&!Se||W==3&&!Ze?ha(Vwe.size/2):0),Lt}const Lo=r.padding=(e.padding||[uf,uf,uf,uf]).map(M=>Bn(Oa(M,uf))),Js=r._padding=Lo.map((M,W)=>M(r,W,Mu,0));let Yi,ui=null,Kr=null;const Td=y[0].idxs;let li=null,Od=!1;function bv(M,W){if(t=(M||[]).slice(),t[0]=t[0]||[],r.data=t.slice(),li=t[0],Yi=li.length,k==2&&(t[0]=li.map((re,ie)=>ie)),r._data=t,Pu(!0),Mi("setData"),W!==!1){let re=A;re.auto(r,Od)?Up():eu(S,re.min,re.max),Xi=Wt.left>=0,kr=!0,$u()}}r.setData=bv;function Up(){Od=!0;let M,W;Yi>0?(ui=Td[0]=0,Kr=Td[1]=Yi-1,M=t[0][ui],W=t[0][Kr],k==2?(M=ui,W=Kr):Yi==1&&(k==3?[M,W]=iR(M,M,A.log,!1):k==4?[M,W]=JW(M,M,A.log,!1):A.time?W=M+ha(86400/v):[M,W]=aR(M,W,QW,!0))):(ui=Td[0]=M=null,Kr=Td[1]=W=null),eu(S,M,W)}function xv(M,W,re,ie,he){f.strokeStyle=M||dwe,f.lineWidth=W,f.lineJoin="round",f.lineCap=ie||"butt",f.setLineDash(re||[]),f.fillStyle=he||dwe}function Lb(){let M=Tb(x,QDt);for(let ie in M){let he=M[ie],Se=N[ie];if(Se!=null&&Se.min!=null)eo(he,Se),ie==S&&Pu(!0);else if(ie!=S)if(Yi==0&&he.from==null){let qe=he.range(r,null,null,ie);he.min=qe[0],he.max=qe[1]}else he.min=Ln,he.max=-Ln}if(Yi>0){y.forEach((ie,he)=>{let Se=ie.scale,qe=M[Se],Ze=N[Se];if(he==0){let ut=qe.range(r,qe.min,qe.max,Se);qe.min=ut[0],qe.max=ut[1],ui=hv(qe.min,t[0]),Kr=hv(qe.max,t[0]),t[0][ui]<qe.min&&ui++,t[0][Kr]>qe.max&&Kr--,ie.min=li[ui],ie.max=li[Kr]}else if(ie.show&&ie.auto&&qe.auto(r,Od)&&(Ze==null||Ze.min==null)){let ut=ie.min==null?qe.distr==3?HDt(t[he],ui,Kr):qDt(t[he],ui,Kr,ie.sorted):[ie.min,ie.max];qe.min=Ys(qe.min,ie.min=ut[0]),qe.max=Nu(qe.max,ie.max=ut[1])}ie.idxs[0]=ui,ie.idxs[1]=Kr});for(let ie in M){let he=M[ie],Se=N[ie];if(he.from==null&&(Se==null||Se.min==null)){let qe=he.range(r,he.min==Ln?null:he.min,he.max==-Ln?null:he.max,ie);he.min=qe[0],he.max=qe[1]}}}for(let ie in M){let he=M[ie];if(he.from!=null){let Se=M[he.from],qe=he.range(r,Se.min,Se.max,ie);he.min=qe[0],he.max=qe[1]}}let W={},re=!1;for(let ie in M){let he=M[ie],Se=x[ie];if(Se.min!=he.min||Se.max!=he.max){Se.min=he.min,Se.max=he.max;let qe=Se.distr;Se._min=qe==3?Ab(Se.min):qe==4?nV(Se.min,Se.asinh):Se.min,Se._max=qe==3?Ab(Se.max):qe==4?nV(Se.max,Se.asinh):Se.max,W[ie]=re=!0}}if(re){y.forEach(ie=>{W[ie.scale]&&(ie._paths=null)});for(let ie in W)_n=!0,Mi("setScale",ie);Wt.show&&(Xi=kr=Wt.left>=0)}for(let ie in N)N[ie]=null}function Ul(M){let W=awe(ui-1,0,Yi-1),re=awe(Kr+1,0,Yi-1);for(;M[W]==null&&W>0;)W--;for(;M[re]==null&&re<Yi-1;)re++;return[W,re]}function Bb(){Yi>0&&(y.forEach((M,W)=>{if(W>0&&M.show&&M._paths==null){let re=Ul(t[W]);M._paths=M.paths(r,W,re[0],re[1])}}),y.forEach((M,W)=>{if(W>0&&M.show){wv(W,!1),M._paths&&_v(W,!1);{wv(W,!0);let re=M.points.show(r,W,ui,Kr),ie=M.points.filter(r,W,re,M._paths?M._paths.gaps:null);(re||ie)&&(M.points._paths=M.points.paths(r,W,ui,Kr,ie),_v(W,!0))}Mi("drawSeries",W)}}))}function wv(M,W){let re=W?y[M].points:y[M];re._stroke=re.stroke(r,M),re._fill=re.fill(r,M)}function _v(M,W){let re=W?y[M].points:y[M],ie=re._stroke,he=re._fill,{stroke:Se,fill:qe,clip:Ze,flags:ut}=re._paths,Lt=Rr(re.width*gr,3),tt=Lt%2/2;W&&he==null&&(he=Lt>0?"#fff":ie),f.globalAlpha=re.alpha;let Vt=re.pxAlign==1;if(Vt&&f.translate(tt,tt),f.save(),!W){let mn=et,_r=Gt,qn=rn,Sr=kn,yr=Lt*gr/2;re.min==0&&(Sr+=yr),re.max==0&&(_r-=yr,Sr+=yr),f.beginPath(),f.rect(mn,_r,qn,Sr),f.clip()}Ze&&f.clip(Ze),W?Wp(ie,Lt,re.dash,re.cap,he,Se,qe,null,ut):zb(M,ie,Lt,re.dash,re.cap,he,Se,qe,ut),f.restore(),Vt&&f.translate(-tt,-tt),f.globalAlpha=1}function zb(M,W,re,ie,he,Se,qe,Ze,ut){let Lt=!1;w.forEach((tt,Vt)=>{if(tt.series[0]==M){let mn=y[tt.series[1]],_r=(mn._paths||uR).band;f.save();let qn=null;mn.show&&_r?qn=tt.fill(r,Vt)||Se:_r=null,Wp(W,re,ie,he,qn,qe,Ze,_r,ut),f.restore(),Lt=!0}}),Lt||Wp(W,re,ie,he,Se,qe,Ze,null,ut)}const Sv=gv|pR;function Wp(M,W,re,ie,he,Se,qe,Ze,ut){xv(M,W,re,ie,he),Ze?(ut&Sv)==Sv?(f.clip(Ze),lf(he,qe),Wl(M,Se,W)):ut&pR?(lf(he,qe),f.clip(Ze),Wl(M,Se,W)):ut&gv&&(f.save(),f.clip(Ze),lf(he,qe),f.restore(),Wl(M,Se,W)):(lf(he,qe),Wl(M,Se,W))}function Wl(M,W,re){M&&W&&re&&f.stroke(W)}function lf(M,W){M&&W&&f.fill(W)}function Qs(M,W,re,ie){let he=b[M],Se;if(ie<=0)Se=[0,0];else{let qe=he._space=he.space(r,M,W,re,ie),Ze=he._incrs=he.incrs(r,M,W,re,ie,qe);Se=he._found=NFt(W,re,Ze,ie,qe)}return Se}function cf(M,W,re,ie,he,Se,qe,Ze,ut,Lt){let tt=qe%2/2;g==1&&f.translate(tt,tt),xv(Ze,qe,ut,Lt),f.beginPath();let Vt,mn,_r,qn,Sr=he+(ie==0||ie==3?-Se:Se);re==0?(mn=he,qn=Sr):(Vt=he,_r=Sr),M.forEach((yr,Fr)=>{W[Fr]!=null&&(re==0?Vt=_r=yr:mn=qn=yr,f.moveTo(Vt,mn),f.lineTo(_r,qn))}),f.stroke(),g==1&&f.translate(-tt,-tt)}function Vl(M){let W=!0;return b.forEach((re,ie)=>{if(!re.show)return;let he=x[re.scale];if(he.min==null){re._show&&(W=!1,re._show=!1,Pu(!1));return}else re._show||(W=!1,re._show=!0,Pu(!1));let Se=re.side,qe=Se%2,{min:Ze,max:ut}=he,[Lt,tt]=Qs(ie,Ze,ut,qe==0?Me:Ve);if(tt==0)return;let Vt=he.distr==2,mn=re._splits=re.splits(r,ie,Ze,ut,Lt,tt,Vt),_r=he.distr==2?mn.map(Fr=>li[Fr]):mn,qn=he.distr==2?li[mn[1]]-li[mn[0]]:Lt,Sr=re._values=re.values(r,re.filter(r,_r,ie,tt,qn),ie,tt,qn);re._rotate=Se==2?re.rotate(r,Sr,ie,tt):0;let yr=re._size;re._size=tV(re.size(r,Sr,ie,M)),yr!=null&&re._size!=yr&&(W=!1)}),W}function Id(M){let W=!0;return Lo.forEach((re,ie)=>{let he=re(r,ie,Mu,M);he!=Js[ie]&&(W=!1),Js[ie]=he}),W}function ff(){b.forEach((M,W)=>{if(!M.show||!M._show)return;let re=M.side,ie=re%2,he,Se,qe=M.stroke(r,W),Ze=re==0||re==3?-1:1;if(M.label){let Uu=M.labelGap*Ze,Gb=ha((M._lpos+Uu)*gr);f.save(),ie==1?(he=Se=0,f.translate(Gb,ha(Gt+kn/2)),f.rotate((re==3?-oR:oR)/2)):(he=ha(et+rn/2),Se=Gb),f.font=M.labelFont[0],f.fillStyle=qe,f.textAlign="center",f.textBaseline=re==2?yS:fwe,f.fillText(M.label,he,Se),f.restore()}let[ut,Lt]=M._found;if(Lt==0)return;let tt=x[M.scale],Vt=ie==0?rn:kn,mn=ie==0?et:Gt,_r=ha(M.gap*gr),qn=M._splits,Sr=tt.distr==2?qn.map(Uu=>li[Uu]):qn,yr=tt.distr==2?li[qn[1]]-li[qn[0]]:ut,Fr=M.ticks,ys=Fr.show?ha(Fr.size*gr):0,bs=M._rotate*-oR/180,Bo=m(M._pos*gr),Hl=(ys+_r)*Ze,Bu=Bo+Hl;Se=ie==0?Bu:0,he=ie==1?Bu:0,f.font=M.font[0],f.fillStyle=qe,f.textAlign=M.align==1?Ob:M.align==2?rV:bs>0?Ob:bs<0?rV:ie==0?"center":re==3?rV:Ob,f.textBaseline=bs||ie==1?"middle":re==2?yS:fwe;let zu=M.font[1]*nFt,xs=qn.map(Uu=>m(s(Uu,tt,Vt,mn)));M._values.forEach((Uu,Gb)=>{Uu!=null&&(ie==0?he=xs[Gb]:Se=xs[Gb],(""+Uu).split(/\n/gm).forEach((EV,CV)=>{bs?(f.save(),f.translate(he,Se+CV*zu),f.rotate(bs),f.fillText(EV,0,0),f.restore()):f.fillText(EV,he,Se+CV*zu)}))}),Fr.show&&cf(xs,Fr.filter(r,Sr,W,Lt,yr),ie,re,Bo,ys,Rr(Fr.width*gr,3),Fr.stroke(r,W),Fr.dash,Fr.cap);let ju=M.grid;ju.show&&cf(xs,ju.filter(r,Sr,W,Lt,yr),ie,ie==0?2:1,ie==0?Gt:et,ie==0?kn:rn,Rr(ju.width*gr,3),ju.stroke(r,W),ju.dash,ju.cap)}),Mi("drawAxes")}function Pu(M){y.forEach((W,re)=>{re>0&&(W._paths=null,M&&(W.min=null,W.max=null))})}let Vp=!1;function $u(){Vp||(aRt(Nd),Vp=!0)}function Nd(){Br&&(Lb(),Br=!1),_n&&(Ru(),_n=!1),Jn&&(Fi(h,Ob,Je),Fi(h,yS,Ft),Fi(h,mS,Me),Fi(h,vS,Ve),Fi(p,Ob,Je),Fi(p,yS,Ft),Fi(p,mS,Me),Fi(p,vS,Ve),Fi(d,mS,xe),Fi(d,vS,Ee),c.width=ha(xe*gr),c.height=ha(Ee*gr),oe(!1),Mi("setSize"),Jn=!1),xe>0&&Ee>0&&(f.clearRect(0,0,c.width,c.height),Mi("drawClear"),_.forEach(M=>M()),Mi("draw")),Wt.show&&Xi&&(Lu(),Xi=!1),u||(u=!0,r.status=1,Mi("ready")),Od=!1,Vp=!1}r.redraw=(M,W)=>{_n=W||!1,M!==!1?eu(S,A.min,A.max):$u()};function qp(M,W){let re=x[M];if(re.from==null){if(Yi==0){let ie=re.range(r,W.min,W.max,M);W.min=ie[0],W.max=ie[1]}if(W.min>W.max){let ie=W.min;W.min=W.max,W.max=ie}if(Yi>1&&W.min!=null&&W.max!=null&&W.max-W.min<1e-16)return;M==S&&re.distr==2&&Yi>0&&(W.min=hv(W.min,t[0]),W.max=hv(W.max,t[0])),N[M]=W,Br=!0,$u()}}r.setScale=qp;let Hp,j,ee,G,se,fe,ae,De,Ue,We,Fe,Le,at=!1;const yt=Wt.drag;let Mt=yt.x,$t=yt.y;Wt.show&&(Wt.x&&(Hp=zl(mRt,p)),Wt.y&&(j=zl(vRt,p)),A.ori==0?(ee=Hp,G=j):(ee=j,G=Hp),Fe=Wt.left,Le=Wt.top);const Tn=r.select=eo({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),rr=Tn.show?zl(gRt,Tn.over?p:h):null;function Xr(M,W){if(Tn.show){for(let re in M)Fi(rr,re,Tn[re]=M[re]);W!==!1&&Mi("setSelect")}}r.setSelect=Xr;function df(M,W){let re=y[M],ie=me?Oe[M]:null;re.show?ie&&xwe(ie,bS):(ie&&Du(ie,bS),si.length>1&&Ib(si[M],-10,-10,Me,Ve))}function eu(M,W,re){qp(M,{min:W,max:re})}function Ia(M,W,re){let ie=y[M];W.focus!=null&&Ub(M),W.show!=null&&(ie.show=W.show,df(M,W.show),eu(ie.scale,null,null),$u()),Mi("setSeries",M,W),re&&Hb("setSeries",r,M,W)}r.setSeries=Ia;function Gp(M,W){eo(w[M],W)}function SS(M,W){M.fill=Bn(M.fill||null),W=W??w.length,w.splice(W,0,M)}function jb(M){M==null?w.length=0:w.splice(M,1)}r.addBand=SS,r.setBand=Gp,r.delBand=jb;function Dd(M,W){y[M].alpha=W,Wt.show&&si[M]&&(si[M].style.opacity=W),me&&Oe[M]&&(Oe[M].style.opacity=W)}let tu,Rd,Fd;const Kp={focus:!0},ES={focus:!1};function Ub(M){if(M!=Fd){let W=M==null,re=to.alpha!=1;y.forEach((ie,he)=>{let Se=W||he==0||he==M;ie._focus=W?null:Se,re&&Dd(he,Se?1:to.alpha)}),Fd=M,re&&$u()}}me&&sf&&Nb(mwe,Ne,M=>{Wt._lock||(Ia(null,ES,ci.setSeries),Lu())});function nu(M,W,re){let ie=x[W];re&&(M=M/gr-(ie.ori==1?Ft:Je));let he=Me;ie.ori==1&&(he=Ve,M=he-M),ie.dir==-1&&(M=he-M);let Se=ie._min,qe=ie._max,Ze=M/he,ut=Se+(qe-Se)*Ze,Lt=ie.distr;return Lt==3?zp(10,ut):Lt==4?XDt(ut,ie.asinh):ut}function hf(M,W){let re=nu(M,S,W);return hv(re,t[0],ui,Kr)}r.valToIdx=M=>hv(M,t[0]),r.posToIdx=hf,r.posToVal=nu,r.valToPos=(M,W,re)=>x[W].ori==0?a(M,x[W],re?rn:Me,re?et:0):o(M,x[W],re?kn:Ve,re?Gt:0);function Xp(M){M(r),$u()}r.batch=Xp,r.setCursor=(M,W)=>{Fe=M.left,Le=M.top,Lu(null,null,W)};function CS(M,W){Fi(rr,Ob,Tn.left=M),Fi(rr,mS,Tn.width=W)}function Wb(M,W){Fi(rr,yS,Tn.top=M),Fi(rr,vS,Tn.height=W)}let Md=A.ori==0?CS:Wb,pf=A.ori==1?CS:Wb;function vR(){if(me&&Q.live)for(let M=0;M<y.length;M++){if(M==0&&$)continue;let W=Q.values[M],re=0;for(let ie in W)$e[M][re++].firstChild.nodeValue=W[ie]}}function AS(M,W){if(M!=null){let re=M.idx;Q.idx=re,y.forEach((ie,he)=>{(he>0||!$)&&Vb(he,re)})}me&&Q.live&&vR(),kr=!1,W!==!1&&Mi("setLegend")}r.setLegend=AS;function Vb(M,W){let re;if(W==null)re=F;else{let ie=y[M],he=M==0&&k==2?li:t[M];re=$?ie.values(r,M,W):{_:ie.value(r,he[W],M,W)}}Q.values[M]=re}function Lu(M,W,re){Ue=Fe,We=Le,[Fe,Le]=Wt.move(r,Fe,Le),Wt.show&&(ee&&Ib(ee,ha(Fe),0,Me,Ve),G&&Ib(G,0,ha(Le),Me,Ve));let ie,he=ui>Kr;tu=Ln;let Se=A.ori==0?Me:Ve,qe=A.ori==1?Me:Ve;if(Fe<0||Yi==0||he){ie=null;for(let Ze=0;Ze<y.length;Ze++)Ze>0&&si.length>1&&Ib(si[Ze],-10,-10,Me,Ve);if(sf&&Ia(null,Kp,ci.setSeries),Q.live){X.fill(null),kr=!0;for(let Ze=0;Ze<y.length;Ze++)Q.values[Ze]=F}}else{let Ze=A.ori==0?Fe:Le,ut=nu(Ze,S);ie=hv(ut,t[0],ui,Kr);let Lt=pv(T(t[0][ie],A,Se,0),.5);for(let tt=0;tt<y.length;tt++){let Vt=y[tt],mn=Wt.dataIdx(r,tt,ie,ut),_r=t[tt][mn];kr=kr||_r!=t[tt][X[tt]],X[tt]=mn;let qn=mn==ie?Lt:pv(T(t[0][mn],A,Se,0),.5);if(tt>0&&Vt.show){let Sr=_r==null?-10:pv(I(_r,x[Vt.scale],qe,0),.5);if(Sr>0){let ys=hs(Sr-Le);ys<=tu&&(tu=ys,Rd=tt)}let yr,Fr;A.ori==0?(yr=qn,Fr=Sr):(yr=Sr,Fr=qn),kr&&si.length>1&&(Ib(si[tt],yr,Fr,Me,Ve),ARt(si[tt],Wt.points.fill(r,tt),Wt.points.stroke(r,tt)))}if(Q.live){if(!kr||tt==0&&$)continue;Vb(tt,mn)}}}if(kr&&(Q.idx=ie,AS()),Tn.show&&at)if(W!=null){let[Ze,ut]=ci.scales,[Lt,tt]=ci.match,[Vt,mn]=W.cursor.sync.scales,_r=W.cursor.drag;Mt=_r._x,$t=_r._y;let{left:qn,top:Sr,width:yr,height:Fr}=W.select,ys=W.scales[Ze].ori,bs=W.posToVal,Bo,Hl,Bu,zu,xs,ju=Ze!=null&&Lt(Ze,Vt),Uu=ut!=null&&tt(ut,mn);ju&&(ys==0?(Bo=qn,Hl=yr):(Bo=Sr,Hl=Fr),Mt?(Bu=x[Ze],zu=T(bs(Bo,Vt),Bu,Se,0),xs=T(bs(Bo+Hl,Vt),Bu,Se,0),Md(Ys(zu,xs),hs(xs-zu))):Md(0,Se),Uu||pf(0,qe)),Uu&&(ys==1?(Bo=qn,Hl=yr):(Bo=Sr,Hl=Fr),$t?(Bu=x[ut],zu=I(bs(Bo,mn),Bu,qe,0),xs=I(bs(Bo+Hl,mn),Bu,qe,0),pf(Ys(zu,xs),hs(xs-zu))):pf(0,qe),ju||Md(0,Se))}else{let Ze=hs(Ue-se),ut=hs(We-fe);if(A.ori==1){let mn=Ze;Ze=ut,ut=mn}Mt=yt.x&&Ze>=yt.dist,$t=yt.y&&ut>=yt.dist;let Lt=yt.uni;Lt!=null?Mt&&$t&&(Mt=Ze>=Lt,$t=ut>=Lt,!Mt&&!$t&&(ut>Ze?$t=!0:Mt=!0)):yt.x&&yt.y&&(Mt||$t)&&(Mt=$t=!0);let tt,Vt;Mt&&(A.ori==0?(tt=ae,Vt=Fe):(tt=De,Vt=Le),Md(Ys(tt,Vt),hs(Vt-tt)),$t||pf(0,qe)),$t&&(A.ori==1?(tt=ae,Vt=Fe):(tt=De,Vt=Le),pf(Ys(tt,Vt),hs(Vt-tt)),Mt||Md(0,Se)),!Mt&&!$t&&(Md(0,0),pf(0,0))}if(Wt.idx=ie,Wt.left=Fe,Wt.top=Le,yt._x=Mt,yt._y=$t,M!=null){if(qb!=null){let[Ze,ut]=ci.scales;ci.values[0]=Ze!=null?nu(A.ori==0?Fe:Le,Ze):null,ci.values[1]=ut!=null?nu(A.ori==1?Fe:Le,ut):null}if(Hb(hwe,r,Fe,Le,Me,Ve,ie),sf){let Ze=ci.setSeries,ut=to.prox;Fd==null?tu<=ut&&Ia(Rd,Kp,Ze):tu>ut?Ia(null,Kp,Ze):Rd!=Fd&&Ia(Rd,Kp,Ze)}}u&&re!==!1&&Mi("setCursor")}let K=null;function oe(M){M===!0?K=null:(K=p.getBoundingClientRect(),Mi("syncRect",K))}function be(M,W,re,ie,he,Se,qe){Wt._lock||(nt(M,W,re,ie,he,Se,qe,!1,M!=null),M!=null?Lu(1):Lu(null,W))}function nt(M,W,re,ie,he,Se,qe,Ze,ut){if(K==null&&oe(!1),M!=null)re=M.clientX-K.left,ie=M.clientY-K.top;else{if(re<0||ie<0){Fe=-10,Le=-10;return}let[Lt,tt]=ci.scales,Vt=W.cursor.sync,[mn,_r]=Vt.values,[qn,Sr]=Vt.scales,[yr,Fr]=ci.match,ys=W.scales[qn].ori==1,bs=A.ori==0?Me:Ve,Bo=A.ori==1?Me:Ve,Hl=ys?Se:he,Bu=ys?he:Se,zu=ys?ie:re,xs=ys?re:ie;if(qn!=null?re=yr(Lt,qn)?s(mn,x[Lt],bs,0):-10:re=bs*(zu/Hl),Sr!=null?ie=Fr(tt,Sr)?s(_r,x[tt],Bo,0):-10:ie=Bo*(xs/Bu),A.ori==1){let ju=re;re=ie,ie=ju}}ut&&((re<=1||re>=Me-1)&&(re=ps(re,Me)),(ie<=1||ie>=Ve-1)&&(ie=ps(ie,Ve))),Ze?(se=re,fe=ie,[ae,De]=Wt.move(r,re,ie)):(Fe=re,Le=ie)}function yn(){Xr({width:0,height:0},!1)}function Qn(M,W,re,ie,he,Se,qe){at=!0,Mt=$t=yt._x=yt._y=!1,nt(M,W,re,ie,he,Se,qe,!0,!1),M!=null&&(R(aV,sV,mr),Hb(pwe,r,ae,De,Me,Ve,null))}function mr(M,W,re,ie,he,Se,qe){at=yt._x=yt._y=!1,nt(M,W,re,ie,he,Se,qe,!1,!0);let{left:Ze,top:ut,width:Lt,height:tt}=Tn,Vt=Lt>0||tt>0;if(Vt&&Xr(Tn),yt.setScale&&Vt){let mn=Ze,_r=Lt,qn=ut,Sr=tt;if(A.ori==1&&(mn=ut,_r=tt,qn=Ze,Sr=Lt),Mt&&eu(S,nu(mn,S),nu(mn+_r,S)),$t)for(let yr in x){let Fr=x[yr];yr!=S&&Fr.from==null&&Fr.min!=Ln&&eu(yr,nu(qn+Sr,yr),nu(qn,yr))}yn()}else Wt.lock&&(Wt._lock=!Wt._lock,Wt._lock||Lu());M!=null&&(Z(aV,sV),Hb(aV,r,Fe,Le,Me,Ve,null))}function bn(M,W,re,ie,he,Se,qe){if(!Wt._lock){let Ze=at;if(at){let ut=!0,Lt=!0,tt=10,Vt,mn;A.ori==0?(Vt=Mt,mn=$t):(Vt=$t,mn=Mt),Vt&&mn&&(ut=Fe<=tt||Fe>=Me-tt,Lt=Le<=tt||Le>=Ve-tt),Vt&&ut&&(Fe=Fe<ae?0:Me),mn&&Lt&&(Le=Le<De?0:Ve),Lu(1),at=!1}Fe=-10,Le=-10,Lu(1),Ze&&(at=Ze)}}function vr(M,W,re,ie,he,Se,qe){Up(),yn(),M!=null&&Hb(vwe,r,Fe,Le,Me,Ve,null)}function no(){b.forEach(DFt),ms(r.width,r.height,!0)}Nb(oV,xS,no);const bi={};bi.mousedown=Qn,bi.mousemove=be,bi.mouseup=mr,bi.dblclick=vr,bi.setSeries=(M,W,re,ie)=>{Ia(re,ie)},Wt.show&&(R(pwe,p,Qn),R(hwe,p,be),R(gwe,p,oe),R(mwe,p,bn),R(vwe,p,vr),SV.add(r),r.syncRect=oe);const ql=r.hooks=e.hooks||{};function Mi(M,W,re){M in ql&&ql[M].forEach(ie=>{ie.call(null,r,W,re)})}(e.plugins||[]).forEach(M=>{for(let W in M.hooks)ql[W]=(ql[W]||[]).concat(M.hooks[W])});const ci=eo({key:null,setSeries:!1,filters:{pub:swe,sub:swe},scales:[S,y[1]?y[1].scale:null],match:[uwe,uwe],values:[null,null]},Wt.sync);Wt.sync=ci;const qb=ci.key,yR=Xwe(qb);function Hb(M,W,re,ie,he,Se,qe){ci.filters.pub(M,W,re,ie,he,Se,qe)&&yR.pub(M,W,re,ie,he,Se,qe)}yR.sub(r);function f2e(M,W,re,ie,he,Se,qe){ci.filters.sub(M,W,re,ie,he,Se,qe)&&bi[M](null,W,re,ie,he,Se,qe)}r.pub=f2e;function d2e(){yR.unsub(r),SV.delete(r),z.clear(),cV(oV,xS,no),l.remove(),Mi("destroy")}r.destroy=d2e;function bR(){Mi("init",e,t),bv(t||e.data,!1),N[S]?qp(S,N[S]):Up(),ms(e.width,e.height),Lu(),Xr(Tn,!1)}return y.forEach(Zs),b.forEach($b),n?n instanceof HTMLElement?(n.appendChild(l),bR()):n(r,bR):bR(),r}gs.assign=eo,gs.fmtNum=eV,gs.rangeNum=aR,gs.rangeLog=iR,gs.rangeAsinh=JW,gs.orient=mv,gs.join=iRt,gs.fmtDate=fV,gs.tzDate=RRt,gs.sync=Xwe;{gs.addGap=jp,gs.clipGaps=gR;let e=gs.paths={points:t2e};e.linear=r2e,e.stepped=xFt,e.bars=wFt,e.spline=SFt}var RFt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:gs}),FFt=bf(RFt);(function(e,t){(function(r,i){e.exports=i(WDt,FFt)})(window,function(n,r){return function(i){var a={};function o(s){if(a[s])return a[s].exports;var u=a[s]={i:s,l:!1,exports:{}};return i[s].call(u.exports,u,u.exports,o),u.l=!0,u.exports}return o.m=i,o.c=a,o.d=function(s,u,l){o.o(s,u)||Object.defineProperty(s,u,{enumerable:!0,get:l})},o.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},o.t=function(s,u){if(u&1&&(s=o(s)),u&8||u&4&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),u&2&&typeof s!="string")for(var c in s)o.d(l,c,function(f){return s[f]}.bind(null,c));return l},o.n=function(s){var u=s&&s.__esModule?function(){return s.default}:function(){return s};return o.d(u,"a",u),u},o.o=function(s,u){return Object.prototype.hasOwnProperty.call(s,u)},o.p="",o(o.s="./react/uplot-react.tsx")}({"./common/index.ts":function(i,a,o){o.r(a),o.d(a,"optionsUpdateState",function(){return l}),o.d(a,"dataMatch",function(){return c});var s=function(f,d){var h={};for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&d.indexOf(p)<0&&(h[p]=f[p]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,p=Object.getOwnPropertySymbols(f);g<p.length;g++)d.indexOf(p[g])<0&&Object.prototype.propertyIsEnumerable.call(f,p[g])&&(h[p[g]]=f[p[g]]);return h},u=function(d){return JSON.stringify(d,function(h,p){return typeof p=="function"?p.toString():p})},l=function(d,h){var p=d.width,g=d.height,m=s(d,["width","height"]),v=h.width,y=h.height,b=s(h,["width","height"]),x="keep";if((g!==y||p!==v)&&(x="update"),Object.keys(m).length!==Object.keys(b).length)return"create";for(var w=0,S=Object.keys(m);w<S.length;w++){var C=S[w];if(u(m[C])!==u(b[C])){x="create";break}}return x},c=function(d,h){return d.length!==h.length?!1:d.every(function(p,g){var m=h[g];return p.length!==m.length?!1:p.every(function(v,y){return v===m[y]})})}},"./react/uplot-react.tsx":function(i,a,o){o.r(a),o.d(a,"default",function(){return d});var s=o("react"),u=o.n(s),l=o("uplot"),c=o.n(l),f=o("./common/index.ts");function d(h){var p=h.options,g=h.data,m=h.target,v=h.onDelete,y=v===void 0?function(){}:v,b=h.onCreate,x=b===void 0?function(){}:b,w=Object(s.useRef)(null),S=Object(s.useRef)(null);function C(A){A&&(y(A),A.destroy(),w.current=null)}function _(){var A=new c.a(p,g,m||S.current);w.current=A,x(A)}Object(s.useEffect)(function(){return _(),function(){C(w.current)}},[]);var E=Object(s.useRef)({options:p,data:g,target:m}).current;return Object(s.useEffect)(function(){var A=w.current;if(E.options!==p){var k=Object(f.optionsUpdateState)(E.options,p);!A||k==="create"?(C(A),_()):k==="update"&&A.setSize({width:p.width,height:p.height})}return E.data!==g&&(A?Object(f.dataMatch)(E.data,g)||A.setData(g):_()),E.target!==m&&(C(A),_()),function(){E.options=p,E.data=g,E.target=m}},[p,g,m]),m?null:u.a.createElement("div",{ref:S})}},react:function(i,a){i.exports=n},uplot:function(i,a){i.exports=r}}).default})})(ewe);var MFt=F2e(ewe.exports);export{DMe as $,vt as A,lo as B,lMe as C,JY as D,dMe as E,cMe as F,fMe as G,MFt as H,nC as I,hLe as J,dLe as K,MMe as L,KY as M,fLe as N,yLe as O,PC as P,vLe as Q,cLe as R,lY as S,XMe as T,FMe as U,lLe as V,IMe as W,SEe as X,R2e as Y,ge as Z,TMe as _,U$e as a,gLe as a0,jMe as a1,$Me as a2,iC as a3,UDt as a4,Cv as a5,T_e as a6,kNe as a7,XY as b,ZY as c,Zi as d,XUe as e,JX as f,sc as g,eje as h,O_e as i,F8e as j,Lre as k,xn as l,k_e as m,D2e as n,wLe as o,tje as p,YMe as q,gh as r,Ct as s,QMe as t,wq as u,pe as v,JMe as w,ZMe as x,an as y,ePe as z};
//# sourceMappingURL=vendor.9b98ab22.js.map
