var Y0,ht,kU,Z0,TU,OU,IU,S2={},NU=[],u1e=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Hl(e,t){for(var n in t)e[n]=t[n];return e}function DU(e){var t=e.parentNode;t&&t.removeChild(e)}function le(e,t,n){var r,i,a,o={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?Y0.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return J0(e,o,r,i,null)}function J0(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++kU};return ht.vnode!=null&&ht.vnode(a),a}function l1e(){return{current:null}}function Vi(e){return e.children}function Ds(e,t){this.props=e,this.context=t}function jg(e,t){if(t==null)return e.__?jg(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?jg(e):null}function RU(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return RU(e)}}function FN(e){(!e.__d&&(e.__d=!0)&&Z0.push(e)&&!E2.__r++||OU!==ht.debounceRendering)&&((OU=ht.debounceRendering)||TU)(E2)}function E2(){for(var e;E2.__r=Z0.length;)e=Z0.sort(function(t,n){return t.__v.__b-n.__v.__b}),Z0=[],e.some(function(t){var n,r,i,a,o,s;t.__d&&(o=(a=(n=t).__v).__e,(s=n.__P)&&(r=[],(i=Hl({},a)).__v=a.__v+1,MN(s,a,i,n.__n,s.ownerSVGElement!==void 0,a.__h!=null?[o]:null,r,o??jg(a),a.__h),zU(r,a),a.__e!=o&&RU(a)))})}function FU(e,t,n,r,i,a,o,s,u,l){var c,f,d,h,p,g,m,v=r&&r.__k||NU,y=v.length;for(n.__k=[],c=0;c<t.length;c++)if((h=n.__k[c]=(h=t[c])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?J0(null,h,null,null,h):Array.isArray(h)?J0(Vi,{children:h},null,null,null):h.__b>0?J0(h.type,h.props,h.key,null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(d=v[c])===null||d&&h.key==d.key&&h.type===d.type)v[c]=void 0;else for(f=0;f<y;f++){if((d=v[f])&&h.key==d.key&&h.type===d.type){v[f]=void 0;break}d=null}MN(e,h,d=d||S2,i,a,o,s,u,l),p=h.__e,(f=h.ref)&&d.ref!=f&&(m||(m=[]),d.ref&&m.push(d.ref,null,h),m.push(f,h.__c||p,h)),p!=null?(g==null&&(g=p),typeof h.type=="function"&&h.__k!=null&&h.__k===d.__k?h.__d=u=MU(h,u,e):u=PU(e,h,d,v,p,u),l||n.type!=="option"?typeof n.type=="function"&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=jg(d))}for(n.__e=g,c=y;c--;)v[c]!=null&&(typeof n.type=="function"&&v[c].__e!=null&&v[c].__e==n.__d&&(n.__d=jg(r,c+1)),UU(v[c],v[c]));if(m)for(c=0;c<m.length;c++)jU(m[c],m[++c],m[++c])}function MU(e,t,n){var r,i;for(r=0;r<e.__k.length;r++)(i=e.__k[r])&&(i.__=e,t=typeof i.type=="function"?MU(i,t,n):PU(n,i,i,e.__k,i.__e,t));return t}function Gl(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){Gl(n,t)}):t.push(e)),t}function PU(e,t,n,r,i,a){var o,s,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break e;e.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function c1e(e,t,n,r,i){var a;for(a in n)a==="children"||a==="key"||a in t||A2(e,a,null,n[a],r);for(a in t)i&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||A2(e,a,t[a],n[a],r)}function $U(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||u1e.test(t)?n:n+"px"}function A2(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||$U(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||$U(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?BU:LU,a):e.removeEventListener(t,a?BU:LU,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch(o){}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function LU(e){this.l[e.type+!1](ht.event?ht.event(e):e)}function BU(e){this.l[e.type+!0](ht.event?ht.event(e):e)}function MN(e,t,n,r,i,a,o,s,u){var l,c,f,d,h,p,g,m,v,y,b,x=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,s=t.__e=n.__e,t.__h=null,a=[s]),(l=ht.__b)&&l(t);try{e:if(typeof x=="function"){if(m=t.props,v=(l=x.contextType)&&r[l.__c],y=l?v?v.props.value:l.__:r,n.__c?g=(c=t.__c=n.__c).__=c.__E:("prototype"in x&&x.prototype.render?t.__c=c=new x(m,y):(t.__c=c=new Ds(m,y),c.constructor=x,c.render=d1e),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,f=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=Hl({},c.__s)),Hl(c.__s,x.getDerivedStateFromProps(m,c.__s))),d=c.props,h=c.state,f)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&m!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(m,y),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(m,c.__s,y)===!1||t.__v===n.__v){c.props=m,c.state=c.__s,t.__v!==n.__v&&(c.__d=!1),c.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(w){w&&(w.__=t)}),c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(m,c.__s,y),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,h,p)})}c.context=y,c.props=m,c.state=c.__s,(l=ht.__r)&&l(t),c.__d=!1,c.__v=t,c.__P=e,l=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(r=Hl(Hl({},r),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(p=c.getSnapshotBeforeUpdate(d,h)),b=l!=null&&l.type===Vi&&l.key==null?l.props.children:l,FU(e,Array.isArray(b)?b:[b],t,n,r,i,a,o,s,u),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=f1e(n.__e,t,n,r,i,a,o,u);(l=ht.diffed)&&l(t)}catch(w){t.__v=null,(u||a!=null)&&(t.__e=s,t.__h=!!u,a[a.indexOf(s)]=null),ht.__e(w,t,n)}}function zU(e,t){ht.__c&&ht.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){ht.__e(r,n.__v)}})}function f1e(e,t,n,r,i,a,o,s){var u,l,c,f=n.props,d=t.props,h=t.type,p=0;if(h==="svg"&&(i=!0),a!=null){for(;p<a.length;p++)if((u=a[p])&&(u===e||(h?u.localName==h:u.nodeType==3))){e=u,a[p]=null;break}}if(e==null){if(h===null)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,d.is&&d),a=null,s=!1}if(h===null)f===d||s&&e.data===d||(e.data=d);else{if(a=a&&Y0.call(e.childNodes),l=(f=n.props||S2).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(a!=null)for(f={},p=0;p<e.attributes.length;p++)f[e.attributes[p].name]=e.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(c1e(e,d,f,i,s),c)t.__k=[];else if(p=t.props.children,FU(e,Array.isArray(p)?p:[p],t,n,r,i&&h!=="foreignObject",a,o,a?a[0]:n.__k&&jg(n,0),s),a!=null)for(p=a.length;p--;)a[p]!=null&&DU(a[p]);s||("value"in d&&(p=d.value)!==void 0&&(p!==e.value||h==="progress"&&!p)&&A2(e,"value",p,f.value,!1),"checked"in d&&(p=d.checked)!==void 0&&p!==e.checked&&A2(e,"checked",p,f.checked,!1))}return e}function jU(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){ht.__e(r,n)}}function UU(e,t,n){var r,i;if(ht.unmount&&ht.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||jU(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ht.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&UU(r[i],t,typeof e.type!="function");n||e.__e==null||DU(e.__e),e.__e=e.__d=void 0}function d1e(e,t,n){return this.constructor(e,n)}function Ug(e,t,n){var r,i,a;ht.__&&ht.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],MN(t,e=(!r&&n||t).__k=le(Vi,null,[e]),i||S2,S2,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?Y0.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r),zU(a,e)}function WU(e,t){Ug(e,t,WU)}function h1e(e,t,n){var r,i,a,o=Hl({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?Y0.call(arguments,2):n),J0(e.type,o,r||e.key,i||e.ref,null)}function ha(e,t){var n={__c:t="__cC"+IU++,__:e,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,a;return this.getChildContext||(i=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(FN)},this.sub=function(o){i.push(o);var s=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),s&&s.call(o)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}Y0=NU.slice,ht={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(a){e=a}throw e}},kU=0,Ds.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Hl({},this.state),typeof e=="function"&&(e=e(Hl({},n),this.props)),e&&Hl(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),FN(this))},Ds.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),FN(this))},Ds.prototype.render=Vi,Z0=[],TU=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,E2.__r=0,IU=0;var Wg,pa,VU,Vg=0,PN=[],qU=ht.__b,HU=ht.__r,GU=ht.diffed,KU=ht.__c,XU=ht.unmount;function Q0(e,t){ht.__h&&ht.__h(pa,e,Vg||t),Vg=0;var n=pa.__H||(pa.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function an(e){return Vg=1,$N(ZU,e)}function $N(e,t,n){var r=Q0(Wg++,2);return r.t=e,r.__c||(r.__=[n?n(t):ZU(void 0,t),function(i){var a=r.t(r.__[0],i);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=pa),r.__}function Vt(e,t){var n=Q0(Wg++,3);!ht.__s&&BN(n.__H,t)&&(n.__=e,n.__H=t,pa.__H.__h.push(n))}function uf(e,t){var n=Q0(Wg++,4);!ht.__s&&BN(n.__H,t)&&(n.__=e,n.__H=t,pa.__h.push(n))}function Jt(e){return Vg=5,gr(function(){return{current:e}},[])}function p1e(e,t,n){Vg=6,uf(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function gr(e,t){var n=Q0(Wg++,7);return BN(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function st(e,t){return Vg=8,gr(function(){return e},t)}function Un(e){var t=pa.context[e.__c],n=Q0(Wg++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(pa)),t.props.value):e.__}function g1e(e,t){ht.useDebugValue&&ht.useDebugValue(t?t(e):e)}function m1e(){PN.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(C2),e.__H.__h.forEach(LN),e.__H.__h=[]}catch(t){e.__H.__h=[],ht.__e(t,e.__v)}}),PN=[]}ht.__b=function(e){pa=null,qU&&qU(e)},ht.__r=function(e){HU&&HU(e),Wg=0;var t=(pa=e.__c).__H;t&&(t.__h.forEach(C2),t.__h.forEach(LN),t.__h=[])},ht.diffed=function(e){GU&&GU(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(PN.push(t)!==1&&VU===ht.requestAnimationFrame||((VU=ht.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),YU&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);YU&&(r=requestAnimationFrame(i))})(m1e)),pa=void 0},ht.__c=function(e,t){t.some(function(n){try{n.__h.forEach(C2),n.__h=n.__h.filter(function(r){return!r.__||LN(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],ht.__e(r,n.__v)}}),KU&&KU(e,t)},ht.unmount=function(e){XU&&XU(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(C2)}catch(n){ht.__e(n,t.__v)}};var YU=typeof requestAnimationFrame=="function";function C2(e){var t=pa;typeof e.__c=="function"&&e.__c(),pa=t}function LN(e){var t=pa;e.__c=e.__(),pa=t}function BN(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function ZU(e,t){return typeof t=="function"?t(e):t}function JU(e,t){for(var n in t)e[n]=t[n];return e}function zN(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function k2(e){this.props=e}function QU(e,t){function n(i){var a=this.props.ref,o=a==i.ref;return!o&&a&&(a.call?a(null):a.current=null),t?!t(this.props,i)||!o:zN(this.props,i)}function r(i){return this.shouldComponentUpdate=n,le(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(k2.prototype=new Ds).isPureReactComponent=!0,k2.prototype.shouldComponentUpdate=function(e,t){return zN(this.props,e)||zN(this.state,t)};var eW=ht.__b;ht.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),eW&&eW(e)};var v1e=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Kl(e){function t(n,r){var i=JU({},n);return delete i.ref,e(i,(r=n.ref||r)&&(typeof r!="object"||"current"in r)?r:null)}return t.$$typeof=v1e,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var tW=function(e,t){return e==null?null:Gl(Gl(e).map(t))},T2={map:tW,forEach:tW,count:function(e){return e?Gl(e).length:0},only:function(e){var t=Gl(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Gl},y1e=ht.__e;ht.__e=function(e,t,n){if(e.then){for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}y1e(e,t,n)};var nW=ht.unmount;function O2(){this.__u=0,this.t=null,this.__b=null}function rW(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function b1e(e){var t,n,r;function i(a){if(t||(t=e()).then(function(o){n=o.default||o},function(o){r=o}),r)throw r;if(!n)throw t;return le(n,a)}return i.displayName="Lazy",i.__f=!0,i}function ey(){this.u=null,this.o=null}ht.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),nW&&nW(e)},(O2.prototype=new Ds).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var i=rW(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__e){var l=r.state.__e;r.__v.__k[0]=function f(d,h,p){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(g){return f(g,h,p)}),d.__c&&d.__c.__P===h&&(d.__e&&p.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=p)),d}(l,l.__c.__P,l.__c.__O)}var c;for(r.setState({__e:r.__b=null});c=r.t.pop();)c.forceUpdate()}},u=t.__h===!0;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},O2.prototype.componentWillUnmount=function(){this.t=[]},O2.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(o,s,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),o.__c.__H=null),(o=JU({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=s),o.__c=null),o.__k=o.__k&&o.__k.map(function(l){return a(l,s,u)})),o}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&le(Vi,null,e.fallback);return i&&(i.__h=null),[le(Vi,null,t.__e?null:e.children),i]};var iW=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function x1e(e){return this.getChildContext=function(){return e.context},e.children}function w1e(e){var t=this,n=e.i;t.componentWillUnmount=function(){Ug(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Ug(le(x1e,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function jN(e,t){return le(w1e,{__v:e,i:t})}(ey.prototype=new Ds).__e=function(e){var t=this,n=rW(t.__v),r=t.o.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),iW(t,e,r)):i()};n?n(a):a()}},ey.prototype.render=function(e){this.u=null,this.o=new Map;var t=Gl(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},ey.prototype.componentDidUpdate=ey.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){iW(e,n,t)})};var aW=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,_1e=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,S1e=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function E1e(e,t,n){return t.__k==null&&(t.textContent=""),Ug(e,t),typeof n=="function"&&n(),e?e.__c:null}function A1e(e,t,n){return WU(e,t),typeof n=="function"&&n(),e?e.__c:null}Ds.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Ds.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var oW=ht.event;function C1e(){}function k1e(){return this.cancelBubble}function T1e(){return this.defaultPrevented}ht.event=function(e){return oW&&(e=oW(e)),e.persist=C1e,e.isPropagationStopped=k1e,e.isDefaultPrevented=T1e,e.nativeEvent=e};var sW,uW={configurable:!0,get:function(){return this.class}},lW=ht.vnode;ht.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){for(var i in r={},n){var a=n[i];i==="value"&&"defaultValue"in n&&a==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&a===!0?a="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!S1e(n.type)?i="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(i)?i=i.toLowerCase():_1e.test(i)?i=i.replace(/[A-Z0-9]/,"-$&").toLowerCase():a===null&&(a=void 0),r[i]=a)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Gl(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=Gl(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),e.props=r}t&&n.class!=n.className&&(uW.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",uW)),e.$$typeof=aW,lW&&lW(e)};var cW=ht.__r;ht.__r=function(e){cW&&cW(e),sW=e.__c};var O1e={ReactCurrentDispatcher:{current:{readContext:function(e){return sW.__n[e.__c].props.value}}}};function I1e(e){return le.bind(null,e)}function mh(e){return!!e&&e.$$typeof===aW}function lf(e){return mh(e)?h1e.apply(null,arguments):e}function N1e(e){return!!e.__k&&(Ug(null,e),!0)}function D1e(e){return e&&(e.base||e.nodeType===1&&e)||null}var R1e=function(e,t){return e(t)},F1e=function(e,t){return e(t)},Bt={useState:an,useReducer:$N,useEffect:Vt,useLayoutEffect:uf,useRef:Jt,useImperativeHandle:p1e,useMemo:gr,useCallback:st,useContext:Un,useDebugValue:g1e,version:"17.0.2",Children:T2,render:E1e,hydrate:A1e,unmountComponentAtNode:N1e,createPortal:jN,createElement:le,createContext:ha,createFactory:I1e,cloneElement:lf,createRef:l1e,Fragment:Vi,isValidElement:mh,findDOMNode:D1e,Component:Ds,PureComponent:k2,memo:QU,forwardRef:Kl,flushSync:F1e,unstable_batchedUpdates:R1e,StrictMode:Vi,Suspense:O2,SuspenseList:ey,lazy:b1e,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:O1e};const UN=(e,t)=>{const[n,r]=an(WN()[1][e]||t);Vt(()=>{const a=o=>{const s=WN()[1];r(s[e])};return window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const i=st((a,o)=>{const s=WN()[1];let u=!1;if(s.hasOwnProperty(e)&&a===null||a===void 0?(delete s[e],u=!0):s[e]!==a&&(s[e]=a,u=!0),!u)return[];const l=Object.keys(s);l.sort();const c=l.map((g,m)=>`${g}=${s[g]}`).join("&");let f=window.location.hash.substr(1);const d=f.indexOf("?");let h="";d>-1&&(h=f.substr(0,d));const p=new URL(window.location.href);p.hash=`${h}?${c}`,(o==null?void 0:o.modifyHistory)?window.location.hash=`${h}?${c}`:(window.history.replaceState(null,document.title,`${p.pathname}${p.search}${p.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},[]);return[n,i]},WN=()=>{let e=window.location.hash.substr(1);const t=e.indexOf("?");if(t===-1)return[e,{}];const n=e.substr(0,t);e=e.substr(t+1);const r=Object.fromEntries(e.split("&").filter(i=>i.length>0).map(i=>i.split("=")));return[n,r]},M1e=(e,t)=>{const[n,r]=UN(e,t?`${t}`:void 0),[i,a]=an(n==="true");Vt(()=>{a(n==="true")},[e,n,a]);const o=st((s,u)=>{s==null||s===!1?r(void 0,u):r("true",u)},[r]);return[i,o]},P1e=(e,t)=>{const[n,r]=UN(e,t?t.toString():void 0),[i,a]=an(n?parseInt(n):void 0);Vt(()=>{a(n?parseInt(n):void 0)},[e,n,a]);const o=st((s,u)=>{r(s?s.toString():void 0,u)},[r]);return[i,o]},fW=(e,t)=>{const[n,r]=UN(e,t?dW(t):void 0),[i,a]=an(hW(n));Vt(()=>{a(hW(n))},[e,n,a]);const o=st((s,u)=>{if(s==null)r(void 0,u);else{const l=dW(s);r(l,u)}},[r]);return[i,o]},dW=e=>btoa(JSON.stringify(e)),hW=e=>{if(e&&e.length>0)try{return JSON.parse(atob(e))}catch(t){console.error(t)}};var Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function vh(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}function cf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $1e={},L1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:$1e}),B1e=vh(L1e),z1e=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r],r);j1e(i)?n.push.apply(n,i):n.push(i)}return n},j1e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},U1e=pW;function pW(e,t,n){e instanceof RegExp&&(e=gW(e,n)),t instanceof RegExp&&(t=gW(t,n));var r=mW(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function gW(e,t){var n=t.match(e);return n?n[0]:null}pW.range=mW;function mW(e,t,n){var r,i,a,o,s,u=n.indexOf(e),l=n.indexOf(t,u+1),c=u;if(u>=0&&l>0){if(e===t)return[u,l];for(r=[],a=n.length;c>=0&&!s;)c==u?(r.push(c),u=n.indexOf(e,c+1)):r.length==1?s=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,o=l),l=n.indexOf(t,c+1)),c=u<l&&u>=0?u:l;r.length&&(s=[a,o])}return s}var W1e=z1e,vW=U1e,V1e=G1e,yW="\0SLASH"+Math.random()+"\0",bW="\0OPEN"+Math.random()+"\0",VN="\0CLOSE"+Math.random()+"\0",xW="\0COMMA"+Math.random()+"\0",wW="\0PERIOD"+Math.random()+"\0";function qN(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function q1e(e){return e.split("\\\\").join(yW).split("\\{").join(bW).split("\\}").join(VN).split("\\,").join(xW).split("\\.").join(wW)}function H1e(e){return e.split(yW).join("\\").split(bW).join("{").split(VN).join("}").split(xW).join(",").split(wW).join(".")}function _W(e){if(!e)return[""];var t=[],n=vW("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=_W(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function G1e(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),qg(q1e(e),!0).map(H1e)):[]}function K1e(e){return"{"+e+"}"}function X1e(e){return/^-?0\d/.test(e)}function Y1e(e,t){return e<=t}function Z1e(e,t){return e>=t}function qg(e,t){var n=[],r=vW("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||a,s=r.body.indexOf(",")>=0;if(!o&&!s)return r.post.match(/,.*\}/)?(e=r.pre+"{"+r.body+VN+r.post,qg(e)):[e];var u;if(o)u=r.body.split(/\.\./);else if(u=_W(r.body),u.length===1&&(u=qg(u[0],!1).map(K1e),u.length===1)){var c=r.post.length?qg(r.post,!1):[""];return c.map(function(k){return r.pre+u[0]+k})}var l=r.pre,c=r.post.length?qg(r.post,!1):[""],f;if(o){var d=qN(u[0]),h=qN(u[1]),p=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(qN(u[2])):1,m=Y1e,v=h<d;v&&(g*=-1,m=Z1e);var y=u.some(X1e);f=[];for(var b=d;m(b,h);b+=g){var x;if(a)x=String.fromCharCode(b),x==="\\"&&(x="");else if(x=String(b),y){var w=p-x.length;if(w>0){var S=new Array(w+1).join("0");b<0?x="-"+S+x.slice(1):x=S+x}}f.push(x)}}else f=W1e(u,function(C){return qg(C,!1)});for(var A=0;A<f.length;A++)for(var _=0;_<c.length;_++){var E=l+f[A]+c[_];(!t||o||E)&&n.push(E)}return n}var J1e=ts;ts.Minimatch=gi;var ty={sep:"/"};try{ty=B1e}catch(e){}var HN=ts.GLOBSTAR=gi.GLOBSTAR={},Q1e=V1e,SW={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},GN="[^/]",KN=GN+"*?",exe="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",txe="(?:(?!(?:\\/|^)\\.).)*?",EW=nxe("().*{}+?[]^$\\!");function nxe(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var AW=/\/+/;ts.filter=rxe;function rxe(e,t){return t=t||{},function(n,r,i){return ts(n,e,t)}}function CW(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(r){n[r]=t[r]}),Object.keys(e).forEach(function(r){n[r]=e[r]}),n}ts.defaults=function(e){if(!e||!Object.keys(e).length)return ts;var t=ts,n=function(i,a,o){return t.minimatch(i,a,CW(e,o))};return n.Minimatch=function(i,a){return new t.Minimatch(i,CW(e,a))},n},gi.defaults=function(e){return!e||!Object.keys(e).length?gi:ts.defaults(e).Minimatch};function ts(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new gi(t,n).match(e)}function gi(e,t){if(!(this instanceof gi))return new gi(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),ty.sep!=="/"&&(e=e.split(ty.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}gi.prototype.debug=function(){},gi.prototype.make=ixe;function ixe(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(r){return r.split(AW)}),this.debug(this.pattern,n),n=n.map(function(r,i,a){return r.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}gi.prototype.parseNegate=axe;function axe(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,a=e.length;i<a&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}ts.braceExpand=function(e,t){return kW(e,t)},gi.prototype.braceExpand=kW;function kW(e,t){if(t||(this instanceof gi?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:Q1e(e)}gi.prototype.parse=oxe;var I2={};function oxe(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return HN;if(e==="")return"";var r="",i=!!n.nocase,a=!1,o=[],s=[],u,l=!1,c=-1,f=-1,d=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function p(){if(u){switch(u){case"*":r+=KN,i=!0;break;case"?":r+=GN,i=!0;break;default:r+="\\"+u;break}h.debug("clearStateChar %j %j",u,r),u=!1}}for(var g=0,m=e.length,v;g<m&&(v=e.charAt(g));g++){if(this.debug("%s	%s %s %j",e,g,r,v),a&&EW[v]){r+="\\"+v,a=!1;continue}switch(v){case"/":return!1;case"\\":p(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,g,r,v),l){this.debug("  in class"),v==="!"&&g===f+1&&(v="^"),r+=v;continue}h.debug("call clearStateChar %j",u),p(),u=v,n.noext&&p();continue;case"(":if(l){r+="(";continue}if(!u){r+="\\(";continue}o.push({type:u,start:g-1,reStart:r.length,open:SW[u].open,close:SW[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(l||!o.length){r+="\\)";continue}p(),i=!0;var y=o.pop();r+=y.close,y.type==="!"&&s.push(y),y.reEnd=r.length;continue;case"|":if(l||!o.length||a){r+="\\|",a=!1;continue}p(),r+="|";continue;case"[":if(p(),l){r+="\\"+v;continue}l=!0,f=g,c=r.length,r+=v;continue;case"]":if(g===f+1||!l){r+="\\"+v,a=!1;continue}if(l){var b=e.substring(f+1,g);try{RegExp("["+b+"]")}catch(K){var x=this.parse(b,I2);r=r.substr(0,c)+"\\["+x[0]+"\\]",i=i||x[1],l=!1;continue}}i=!0,l=!1,r+=v;continue;default:p(),a?a=!1:EW[v]&&!(v==="^"&&l)&&(r+="\\"),r+=v}}for(l&&(b=e.substr(f+1),x=this.parse(b,I2),r=r.substr(0,c)+"\\["+x[0],i=i||x[1]),y=o.pop();y;y=o.pop()){var w=r.slice(y.reStart+y.open.length);this.debug("setting tail",r,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(K,ee,ce){return ce||(ce="\\"),ee+ee+ce+"|"}),this.debug(`tail=%j
   %s`,w,w,y,r);var S=y.type==="*"?KN:y.type==="?"?GN:"\\"+y.type;i=!0,r=r.slice(0,y.reStart)+S+"\\("+w}p(),a&&(r+="\\\\");var A=!1;switch(r.charAt(0)){case".":case"[":case"(":A=!0}for(var _=s.length-1;_>-1;_--){var E=s[_],C=r.slice(0,E.reStart),k=r.slice(E.reStart,E.reEnd-8),T=r.slice(E.reEnd-8,E.reEnd),I=r.slice(E.reEnd);T+=I;var N=C.split("(").length-1,O=I;for(g=0;g<N;g++)O=O.replace(/\)[+*?]?/,"");I=O;var D="";I===""&&t!==I2&&(D="$");var L=C+k+I+D+T;r=L}if(r!==""&&i&&(r="(?=.)"+r),A&&(r=d+r),t===I2)return[r,i];if(!i)return lxe(e);var W=n.nocase?"i":"";try{var G=new RegExp("^"+r+"$",W)}catch(K){return new RegExp("$.")}return G._glob=e,G._src=r,G}ts.makeRe=function(e,t){return new gi(e,t||{}).makeRe()},gi.prototype.makeRe=sxe;function sxe(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?KN:t.dot?exe:txe,r=t.nocase?"i":"",i=e.map(function(a){return a.map(function(o){return o===HN?n:typeof o=="string"?cxe(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(a){this.regexp=!1}return this.regexp}ts.match=function(e,t,n){n=n||{};var r=new gi(t,n);return e=e.filter(function(i){return r.match(i)}),r.options.nonull&&!e.length&&e.push(t),e},gi.prototype.match=uxe;function uxe(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;ty.sep!=="/"&&(e=e.split(ty.sep).join("/")),e=e.split(AW),this.debug(this.pattern,"split",e);var r=this.set;this.debug(this.pattern,"set",r);var i,a;for(a=e.length-1;a>=0&&(i=e[a],!i);a--);for(a=0;a<r.length;a++){var o=r[a],s=e;n.matchBase&&o.length===1&&(s=[i]);var u=this.matchOne(s,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}gi.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,a=0,o=e.length,s=t.length;i<o&&a<s;i++,a++){this.debug("matchOne loop");var u=t[a],l=e[i];if(this.debug(t,u,l),u===!1)return!1;if(u===HN){this.debug("GLOBSTAR",[t,u,l]);var c=i,f=a+1;if(f===s){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}for(;c<o;){var d=e[c];if(this.debug(`
globstar while`,e,c,t,f,d),this.matchOne(e.slice(c),t.slice(f),n))return this.debug("globstar found match!",c,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,c,t,f);break}this.debug("globstar swallow a segment, and continue"),c++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,c,t,f),c===o))}var h;if(typeof u=="string"?(r.nocase?h=l.toLowerCase()===u.toLowerCase():h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===o&&a===s)return!0;if(i===o)return n;if(a===s){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function lxe(e){return e.replace(/\\(.)/g,"$1")}function cxe(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var N2;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(N2||(N2={}));var Rs;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(Rs||(Rs={}));const TW=Object.keys(N2);N2.V0_4;const OW=Object.keys(Rs),D2=Rs.V0_3;var zt;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(zt||(zt={}));var ga;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(ga||(ga={}));var Xl;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(Xl||(Xl={}));var XN;(function(e){e.State="metapage/state"})(XN||(XN={}));const Du="metapage/definition",ff="metapage/state",IW=OW[OW.length-1],fxe=TW[TW.length-1];var ny={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ye,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function r(f,d){return f.indexOf(d)===-1?f.length:f.indexOf(d)}function i(f){var d=f.replace(/^v/,"").replace(/\+.*$/,""),h=r(d,"-"),p=d.substring(0,h).split(".");return p.push(d.substring(h+1)),p}function a(f){return isNaN(Number(f))?f:Number(f)}function o(f){if(typeof f!="string")throw new TypeError("Invalid argument expected string");if(!n.test(f))throw new Error("Invalid argument not valid semver ('"+f+"' received)")}function s(f,d){[f,d].forEach(o);for(var h=i(f),p=i(d),g=0;g<Math.max(h.length-1,p.length-1);g++){var m=parseInt(h[g]||0,10),v=parseInt(p[g]||0,10);if(m>v)return 1;if(v>m)return-1}var y=h[h.length-1],b=p[p.length-1];if(y&&b){var x=y.split(".").map(a),w=b.split(".").map(a);for(g=0;g<Math.max(x.length,w.length);g++){if(x[g]===void 0||typeof w[g]=="string"&&typeof x[g]=="number")return-1;if(w[g]===void 0||typeof x[g]=="string"&&typeof w[g]=="number"||x[g]>w[g])return 1;if(w[g]>x[g])return-1}}else if(y||b)return y?-1:1;return 0}var u=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function c(f){if(typeof f!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof f);if(u.indexOf(f)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return s.validate=function(f){return typeof f=="string"&&n.test(f)},s.compare=function(f,d,h){c(h);var p=s(f,d);return l[h].indexOf(p)>-1},s})})(ny);var R2={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,f||u,d),p=n?n+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount==0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},s.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,d,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,d),!0;case 5:return m.fn.call(m.context,c,f,d,h),!0;case 6:return m.fn.call(m.context,c,f,d,h,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var x=m.length,w;for(b=0;b<x;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,f);break;case 4:m[b].fn.call(m[b].context,c,f,d);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];m[b].fn.apply(m[b].context,y)}}return!0},s.prototype.on=function(l,c,f){return a(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return a(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,d){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!d||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||f&&p[g].context!==f)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(R2);var F2;(function(e){e.mp_debug="mp_debug"})(F2||(F2={}));const dxe=()=>{try{return window!==window.top}catch(e){return!1}};class hxe extends R2.exports.EventEmitter{constructor(){super();this._definition={version:Rs.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var pxe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};const NW=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch(n){throw`Cannot parse into JSON:
${e}`}let t;switch(mxe(e.version)){case Rs.V0_2:{t=NW(gxe(e));break}case Rs.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${D2}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},gxe=e=>(e.version=Rs.V0_3,e),M2=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(r=>{n=!0,t[r]===void 0?delete e[r]:e[r]=t[r]}),n},mxe=e=>{if(e=="latest")return D2;if(ny.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return ny.exports.compare(e,"0.2",">=")&&ny.exports.compare(e,Rs.V0_3,"<")?Rs.V0_2:ny.exports.compare(e,"0.3",">=")?Rs.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${D2}`),D2)},YN=()=>{const e=new URLSearchParams(window.location.search).get(F2.mp_debug);return e==="true"||e==="1"},vxe=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,yxe=(e=8)=>bxe(e),DW="abcdefghijklmnopqrstuvwxyz0123456789",bxe=(e=8)=>{for(var t="",n=DW.length,r=0;r<e;r++)t+=DW.charAt(Math.floor(Math.random()*n));return t},ZN=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let r;if(typeof e=="string"?r=e:typeof e=="number"?r=e+"":r=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var i=`color: #${t}`;n&&(i=`${i}; background: #${n}`),r=`%c${r}`,window.console.log(r,i)}else window.console.log(r)},RW=e=>wxe(xxe(e)),xxe=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},wxe=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},JN=()=>document.readyState=="complete"||document.readyState=="interactive",QN=()=>pxe(void 0,void 0,void 0,function*(){return JN()?Promise.resolve():new Promise(e=>{if(JN()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&JN()&&(t=!0,e())},200)})});var FW=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};class MW extends R2.exports.EventEmitter{constructor(t,n,r,i,a,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var s=new URL(this.url);o&&s.searchParams.set(F2.mp_debug,"true"),this.url=s.href,this.id=r,this._debug=o,this._parentId=i,this._color=RW(this.id),this._consoleBackgroundColor=a,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(l=>{QN().then(()=>FW(this,void 0,void 0,function*(){if(u._iframe){const c=yield u.getDefinition();if(!u._iframe)return;(c==null?void 0:c.allow)&&(u._iframe.allow=c.allow),u._iframe.src=this.url,l(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[ff]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Du]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return FW(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const r=yield n.json();return this._definition=r,this._definition}else this.emit(zt.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(zt.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var r={};r[t]=n,this.setInputs(r)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!M2(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(zt.Inputs,this.inputs),this._metapage.listenerCount(zt.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(zt.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){if(!!M2(this.outputs,t)&&(this.emit(zt.Outputs,t),this._metapage.listenerCount(zt.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(zt.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(zt.Inputs,t)}onInput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(zt.Inputs,r)}onOutputs(t){return this.addListenerReturnDisposer(zt.Outputs,t)}onOutput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(zt.Outputs,r)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:IW};this.sendRpcInternal(Xl.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(Xl.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const r=this;this._onLoaded.push(()=>{r.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(Xl.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),ZN(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const r={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(r):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(r).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(r=>n._iframe.contentWindow.postMessage(r,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var _xe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},PW;(function(e){e.all="all",e.delta="delta"})(PW||(PW={}));const $W=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),Sxe="bcbcbc";class Fs extends hxe{constructor(t){super();this._state=$W(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=YN(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:yxe(),this._consoleBackgroundColor=t&&t.color?t.color:Sxe,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),QN().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch(i){throw"Cannot parse into JSON:\n${metaPageDef}"}var r=new Fs;return r.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=vxe(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(zt.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const r=NW(t);return r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(r.plugins&&r.plugins.includes(i))throw this.emitErrorMessage(`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var a=r.metaframes[i];if(typeof a!="object")throw this.emitErrorMessage(`Metaframe "${i}" is not an object`),`Metaframe "${i}" is not an object`;if(!a.url)throw this.emitErrorMessage(`Metaframe "${i}" missing field: url`),`Metaframe "${i}" missing field: url`}),this._definition=r,Object.keys(this._metaframes).forEach(i=>{(!r.metaframes||!r.metaframes[i])&&this.removeMetaframe(i)}),Object.keys(this._plugins).forEach(i=>{r.plugins&&!r.plugins.includes(i)&&this.removePlugin(i)}),this._pluginOrder=r.plugins?r.plugins:[],n&&(this._state=n),r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(!this._metaframes.hasOwnProperty(i)){const a=r.metaframes[i];this.addMetaframe(i,a)}}),r.plugins&&r.plugins.forEach(i=>{this._plugins.hasOwnProperty(i)||this.addPlugin(i)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(zt.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(zt.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var r;const i=this._inputMap[n];let a=0;for(;a<=i.length;)((r=i[a])===null||r===void 0?void 0:r.metaframe)===t?i.splice(a,1):a++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=$W(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var r=new MW(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=r,r.addListener(zt.Error,i=>{this.emit(zt.Error,{metaframeId:r.id,metaframeUrl:r.url,error:i})}),n.inputs&&n.inputs.forEach(i=>this.addPipe(t,i)),r.setInputs(this._state.metaframes.inputs[t]),r}addPlugin(t){if(!t)throw"Plugin missing url";const n=new MW(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return Exe(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,r){!this.debug||this.logInternal(t,n,r)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(zt.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var r=[];this._cachedInputLookupMap[t][n]=r,Object.keys(this._inputMap).forEach(i=>{i!==t&&this._inputMap[i].forEach(a=>{if(a.metaframe==t&&J1e(n,a.source)){var o=a.target;(!a.target||a.target.startsWith("*")||a.target==="")&&(o=n),r.push({metaframe:i,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case ga.SetupIframeClientRequest:return!0;default:var r=t.iframeId;return!(r&&!(t.parentId===this._id&&(this._metaframes[r]||this._plugins[r])))}}setInput(t,n,r){this.setInputStateOnly(t,n,r),this.setMetaframeClientInputAndSentClientEvent(t,n,r),this.emit(zt.State,this._state),this.emit(zt.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,r){if(typeof t=="object"){if(n||r)throw"bad arguments, see API docs";const i=t;Object.keys(i).forEach(a=>{var o=a,s=i[o];if(typeof s!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(s):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const i=this._metaframes[t];if(i==null&&this.error(`No iframe id=${t}`),typeof n=="string")i.setInput(n,r);else if(typeof n=="object")i.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,r){this.setInput(t,n,r)}setOutputStateOnly(t,n,r){this._setStateOnly(!1,t,n,r)}setInputStateOnly(t,n,r){this._setStateOnly(!0,t,n,r)}_setStateOnly(t,n,r,i){if(typeof n=="object"){if(r||i)throw"If first argument is an object, subsequent args should be undefined";const a=n;Object.keys(a).forEach(o=>{var s=a[o];if(typeof s!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const l=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;l[o]=l[o]?l[o]:{},Object.keys(s).forEach(c=>{s[c]===void 0?delete l[o][c]:l[o][c]=s[c]})})}else if(typeof n=="string"){const a=n,o=this._metaframes.hasOwnProperty(a);if(!o&&!this._plugins.hasOwnProperty(a))throw`No metaframe or plugin: ${a}`;const s=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof r=="string"){s[a]=s[a]?s[a]:{};const u=r;i===void 0?delete s[a][u]:s[a][u]=i}else if(typeof r=="object"){s[a]=s[a]?s[a]:{};const u=r;Object.keys(u).forEach(l=>{u[l]===void 0?delete s[a][l]:s[a][l]=u[l]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const s=o.iframeId;if(!s)return;const u=this.getMetaframeOrPlugin(s),l=this._plugins[s];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case ga.SetupIframeClientRequest:u&&u.register();break;case ga.SetupIframeServerResponseAck:if(u){const f=o.params;u.registered(f.version)}break;case ga.OutputsUpdate:const c=o.params;if(this._metaframes[s]){var r=this._metaframes[s];this.setOutputStateOnly(s,c),r.setOutputs(c),this.emit(zt.State,this._state);var i=!1;const f=Object.keys(c),d={};f.forEach((h,p)=>{const g=this.getInputsFromOutput(s,h);g.length>0&&g.forEach(m=>{d[m.metaframe]||(d[m.metaframe]={}),d[m.metaframe][m.pipe]=c[h],this.setInputStateOnly(m.metaframe,m.pipe,c[h]),i=!0})}),Object.keys(d).forEach(h=>{this._metaframes[h].setInputs(d[h])}),i&&this.emit(zt.State,this._state),this.debug&&r.ack({jsonrpc:o,state:this._state})}else if(this._plugins[s]){const f=!c[ff]&&!c[Du];f&&this.setOutputStateOnly(s,c),this._plugins[s].setOutputs(c),f&&this.emit(zt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case ga.InputsUpdate:var a=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(a)} from ${s}`),this._metaframes[s])this.setInputStateOnly(s,a),this._metaframes[s].setInputs(a),this.emit(zt.State,this._state),this.debug&&this._metaframes[s].ack({jsonrpc:o,state:this._state});else if(this._plugins[s]){const f=!a[ff]&&!a[Du];f&&this.setInputStateOnly(s,a),this._plugins[s].setInputs(a),f&&this.emit(zt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`);break;case ga.PluginRequest:l&&u&&u.hasPermissionsState()&&(u.setInput(ff,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case ga.HashParamsUpdate:if(!l&&u){const f=o.params,d=new URL(u.url);d.hash=f.hash,u.url=d.href,this._definition.metaframes[f.metaframe].url=d.href,this.emit(zt.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(zt.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&Axe(t)})}logInternal(t,n,r){r=r||this._consoleBackgroundColor;let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),i=this._id?`Metapage[${this._id}] ${i}`:i,ZN(i,n,r)}}Fs.version=IW,Fs.DEFINITION=zt.Definition,Fs.DEFINITION_UPDATE_REQUEST=zt.DefinitionUpdateRequest,Fs.ERROR=zt.Error,Fs.INPUTS=zt.Inputs,Fs.MESSAGE=zt.Message,Fs.OUTPUTS=zt.Outputs,Fs.STATE=zt.State,Fs.URL_HASH_UPDATE=zt.UrlHashUpdate;const Exe=(e,t)=>_xe(void 0,void 0,void 0,function*(){try{const i=yield t.getDefinition();if(!i)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(zt.Definition,a=>{t.setInput(Du,a.definition)});t._disposables.push(n);var r=e.getDefinition();if(r&&(t.setInput(Du,r),i.outputs)){var n=t.onOutput(Du,o=>{e.emit(zt.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&i.outputs){var n=t.onOutput(ff,o=>{e.setState(o)});t._disposables.push(n)}}catch(i){console.error(i),e.emit(zt.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${i}`)}}),Axe=e=>{const t=e._metapage.getDefinition();e.setInput(Du,t)};var Cxe=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},df;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(df||(df={}));var mi;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(mi||(mi={}));class Ms extends R2.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=df.WaitingForPageLoad,this._messageSendCount=0,this.debug=YN(),this.id=window.name,this.debug=YN(),this._isIframe=dxe(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;QN().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(ga.SetupIframeClientRequest,{version:Ms.version}),n._state=df.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===df.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=RW(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=df.Ready,this.sendRpc(ga.SetupIframeServerResponseAck,{version:Ms.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(mi.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(mi.Input,n,this._inputPipeValues[n]))),this.emit(mi.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new kxe(this)),this.emit(mi.Connected))}connected(){return Cxe(this,void 0,void 0,function*(){if(this._state!==df.Ready)return new Promise((t,n)=>{let r;r=this.addListenerReturnDisposer(mi.Connected,()=>{t(),r()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,r){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,r){let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),n=n&&n+"",i=(this.id?`Metaframe[${this.id}] `:"")+`${i}`,ZN(i,n,r)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===mi.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(mi.Input,(r,i)=>{t===r&&n(i)})}onInputs(t){return this.addListenerReturnDisposer(mi.Inputs,t)}setInput(t,n){var r={};r[t]=n,this.setInputs(r)}setInputs(t){this.sendRpc(ga.InputsUpdate,t)}setInternalInputsAndNotify(t){!M2(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(mi.Input,n,t[n])),this.emit(mi.Inputs,t))}getInput(t){return console.assert(t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(t),this._outputPipeValues[t]}setOutput(t,n){console.assert(t),console.assert(n);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){!M2(this._outputPipeValues,t)||this.sendRpc(ga.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(ga.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const r={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(r,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let r=t.data;if(r.jsonrpc==="2.0"){var n=r.method;if(!(n==Xl.SetupIframeServerResponse||r.parentId==this._parentId&&r.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${r.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${r.iframeId} id=${this.id}`);return}switch(n){case Xl.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(r.params);break;case Xl.InputsUpdate:if(this._state!==df.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(r.params.inputs);break;case Xl.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(r)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(r)}`);break}this.emit(mi.Message,r)}}}}Ms.version=fxe,Ms.ERROR=mi.Error,Ms.CONNECTED=mi.Connected,Ms.INPUT=mi.Input,Ms.INPUTS=mi.Inputs,Ms.MESSAGE=mi.Message;class kxe{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:XN.State};this._metaframe.sendRpc(ga.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(ff,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(ff)}setState(t){this._metaframe.setOutput(ff,t)}onDefinition(t){var n=this._metaframe.onInput(Du,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(Du,t)}getDefinition(){return this._metaframe.getInput(Du)}}const Txe={inputs:{}},LW=ha(Txe),Oxe=()=>Un(LW),Ixe=e=>{const[t,n]=an({inputs:{}}),[r,i]=an(void 0),[a,o]=an(t.inputs);return Vt(()=>{const s=new Ms,u=l=>{o(l)};return s.onInputs(u),i(s),()=>{s.removeListener(Ms.INPUTS,u),s.dispose()}},[i,o]),Vt(()=>{a&&r&&n({metaframe:r,inputs:a,setOutputs:r.setOutputs})},[a,r]),Bt.createElement(LW.Provider,{value:t},e.children)},Nxe=()=>{try{return window!==window.top}catch(e){return!1}};function Dxe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function Rxe(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var BW=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?a=r.prepend?r.container.firstChild:r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(Rxe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=Dxe(i);try{a.insertRule(r,a.cssRules.length)}catch(o){}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),qi="-ms-",P2="-moz-",Cn="-webkit-",zW="comm",eD="rule",tD="decl",Fxe="@import",Mxe="@keyframes",Pxe=Math.abs,$2=String.fromCharCode;function $xe(e,t){return(((t<<2^Ya(e,0))<<2^Ya(e,1))<<2^Ya(e,2))<<2^Ya(e,3)}function jW(e){return e.trim()}function Lxe(e,t){return(e=t.exec(e))?e[0]:e}function Mn(e,t,n){return e.replace(t,n)}function UW(e,t){return e.indexOf(t)}function Ya(e,t){return e.charCodeAt(t)|0}function ry(e,t,n){return e.slice(t,n)}function Ru(e){return e.length}function nD(e){return e.length}function L2(e,t){return t.push(e),e}function Bxe(e,t){return e.map(t).join("")}var B2=1,Hg=1,WW=0,Ao=0,Ur=0,Gg="";function z2(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:B2,column:Hg,length:o,return:""}}function iy(e,t,n){return z2(e,t.root,t.parent,n,t.props,t.children,0)}function zxe(){return Ur}function jxe(){return Ur=Ao>0?Ya(Gg,--Ao):0,Hg--,Ur===10&&(Hg=1,B2--),Ur}function ns(){return Ur=Ao<WW?Ya(Gg,Ao++):0,Hg++,Ur===10&&(Hg=1,B2++),Ur}function Yl(){return Ya(Gg,Ao)}function j2(){return Ao}function U2(e,t){return ry(Gg,e,t)}function W2(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function VW(e){return B2=Hg=1,WW=Ru(Gg=e),Ao=0,[]}function qW(e){return Gg="",e}function rD(e){return jW(U2(Ao-1,iD(e===91?e+2:e===40?e+1:e)))}function Uxe(e){for(;(Ur=Yl())&&Ur<33;)ns();return W2(e)>2||W2(Ur)>3?"":" "}function Wxe(e,t){for(;--t&&ns()&&!(Ur<48||Ur>102||Ur>57&&Ur<65||Ur>70&&Ur<97););return U2(e,j2()+(t<6&&Yl()==32&&ns()==32))}function iD(e){for(;ns();)switch(Ur){case e:return Ao;case 34:case 39:return iD(e===34||e===39?e:Ur);case 40:e===41&&iD(e);break;case 92:ns();break}return Ao}function Vxe(e,t){for(;ns()&&e+Ur!==47+10;)if(e+Ur===42+42&&Yl()===47)break;return"/*"+U2(t,Ao-1)+"*"+$2(e===47?e:ns())}function HW(e){for(;!W2(Yl());)ns();return U2(e,Ao)}function qxe(e){return qW(V2("",null,null,null,[""],e=VW(e),0,[0],e))}function V2(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,f=o,d=0,h=0,p=0,g=1,m=1,v=1,y=0,b="",x=i,w=a,S=r,A=b;m;)switch(p=y,y=ns()){case 34:case 39:case 91:case 40:A+=rD(y);break;case 9:case 10:case 13:case 32:A+=Uxe(p);break;case 92:A+=Wxe(j2()-1,7);continue;case 47:switch(Yl()){case 42:case 47:L2(Hxe(Vxe(ns(),j2()),t,n),u);break;default:A+="/"}break;case 123*g:s[l++]=Ru(A)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:h>0&&Ru(A)-f&&L2(h>32?KW(A+";",r,n,f-1):KW(Mn(A," ","")+";",r,n,f-2),u);break;case 59:A+=";";default:if(L2(S=GW(A,t,n,l,c,i,s,b,x=[],w=[],f),a),y===123)if(c===0)V2(A,t,S,S,x,a,f,s,w);else switch(d){case 100:case 109:case 115:V2(e,S,S,r&&L2(GW(e,S,S,0,0,i,s,b,i,x=[],f),w),i,w,f,s,r?x:w);break;default:V2(A,S,S,S,[""],w,f,s,w)}}l=c=h=0,g=v=1,b=A="",f=o;break;case 58:f=1+Ru(A),h=p;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&jxe()==125)continue}switch(A+=$2(y),y*g){case 38:v=c>0?1:(A+="\f",-1);break;case 44:s[l++]=(Ru(A)-1)*v,v=1;break;case 64:Yl()===45&&(A+=rD(ns())),d=Yl(),c=Ru(b=A+=HW(j2())),y++;break;case 45:p===45&&Ru(A)==2&&(g=0)}}return a}function GW(e,t,n,r,i,a,o,s,u,l,c){for(var f=i-1,d=i===0?a:[""],h=nD(d),p=0,g=0,m=0;p<r;++p)for(var v=0,y=ry(e,f+1,f=Pxe(g=o[p])),b=e;v<h;++v)(b=jW(g>0?d[v]+" "+y:Mn(y,/&\f/g,d[v])))&&(u[m++]=b);return z2(e,t,n,i===0?eD:s,u,l,c)}function Hxe(e,t,n){return z2(e,t,n,zW,$2(zxe()),ry(e,2,-2),0)}function KW(e,t,n,r){return z2(e,t,n,tD,ry(e,0,r),ry(e,r+1,-1),r)}function XW(e,t){switch($xe(e,t)){case 5103:return Cn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Cn+e+P2+e+qi+e+e;case 6828:case 4268:return Cn+e+qi+e+e;case 6165:return Cn+e+qi+"flex-"+e+e;case 5187:return Cn+e+Mn(e,/(\w+).+(:[^]+)/,Cn+"box-$1$2"+qi+"flex-$1$2")+e;case 5443:return Cn+e+qi+"flex-item-"+Mn(e,/flex-|-self/,"")+e;case 4675:return Cn+e+qi+"flex-line-pack"+Mn(e,/align-content|flex-|-self/,"")+e;case 5548:return Cn+e+qi+Mn(e,"shrink","negative")+e;case 5292:return Cn+e+qi+Mn(e,"basis","preferred-size")+e;case 6060:return Cn+"box-"+Mn(e,"-grow","")+Cn+e+qi+Mn(e,"grow","positive")+e;case 4554:return Cn+Mn(e,/([^-])(transform)/g,"$1"+Cn+"$2")+e;case 6187:return Mn(Mn(Mn(e,/(zoom-|grab)/,Cn+"$1"),/(image-set)/,Cn+"$1"),e,"")+e;case 5495:case 3959:return Mn(e,/(image-set\([^]*)/,Cn+"$1$`$1");case 4968:return Mn(Mn(e,/(.+:)(flex-)?(.*)/,Cn+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cn+e+e;case 4095:case 3583:case 4068:case 2532:return Mn(e,/(.+)-inline(.+)/,Cn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ru(e)-1-t>6)switch(Ya(e,t+1)){case 109:if(Ya(e,t+4)!==45)break;case 102:return Mn(e,/(.+:)(.+)-([^]+)/,"$1"+Cn+"$2-$3$1"+P2+(Ya(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~UW(e,"stretch")?XW(Mn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Ya(e,t+1)!==115)break;case 6444:switch(Ya(e,Ru(e)-3-(~UW(e,"!important")&&10))){case 107:return Mn(e,":",":"+Cn)+e;case 101:return Mn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cn+(Ya(e,14)===45?"inline-":"")+"box$3$1"+Cn+"$2$3$1"+qi+"$2box$3")+e}break;case 5936:switch(Ya(e,t+11)){case 114:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Cn+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Cn+e+qi+e+e}return e}function ay(e,t){for(var n="",r=nD(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function Gxe(e,t,n,r){switch(e.type){case Fxe:case tD:return e.return=e.return||e.value;case zW:return"";case eD:e.value=e.props.join(",")}return Ru(n=ay(e.children,r))?e.return=e.value+"{"+n+"}":""}function Kxe(e){var t=nD(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}function Xxe(e){return function(t){t.root||(t=t.return)&&e(t)}}function Yxe(e,t,n,r){if(!e.return)switch(e.type){case tD:e.return=XW(e.value,e.length);break;case Mxe:return ay([iy(Mn(e.value,"@","@"+Cn),e,"")],r);case eD:if(e.length)return Bxe(e.props,function(i){switch(Lxe(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ay([iy(Mn(i,/:(read-\w+)/,":"+P2+"$1"),e,"")],r);case"::placeholder":return ay([iy(Mn(i,/:(plac\w+)/,":"+Cn+"input-$1"),e,""),iy(Mn(i,/:(plac\w+)/,":"+P2+"$1"),e,""),iy(Mn(i,/:(plac\w+)/,qi+"input-$1"),e,"")],r)}return""})}}var YW=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function ZW(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var Zxe=function(t,n){var r=-1,i=44;do switch(W2(i)){case 0:i===38&&Yl()===12&&(n[r]=1),t[r]+=HW(Ao-1);break;case 2:t[r]+=rD(i);break;case 4:if(i===44){t[++r]=Yl()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=$2(i)}while(i=ns());return t},Jxe=function(t,n){return qW(Zxe(VW(t),n))},JW=new WeakMap,Qxe=function(t){if(!(t.type!=="rule"||!t.parent||!t.length)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!JW.get(r))&&!i){JW.set(t,!0);for(var a=[],o=Jxe(n,a),s=r.props,u=0,l=0;u<o.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=a[u]?o[u].replace(/&\f/g,s[c]):s[c]+" "+o[u]}}},ewe=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}},twe=[Yxe],nwe=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||twe,a={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),v=1;v<m.length;v++)a[m[v]]=!0;s.push(g)});var u,l=[Qxe,ewe];{var c,f=[Gxe,Xxe(function(g){c.insert(g)})],d=Kxe(l.concat(i,f)),h=function(m){return ay(qxe(m),d)};u=function(m,v,y,b){c=y,h(m?m+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new BW({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:a,registered:{},insert:u};return p.sheet.hydrate(s),p};function yh(){return yh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yh.apply(this,arguments)}var QW={exports:{}},Pn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vi=typeof Symbol=="function"&&Symbol.for,aD=vi?Symbol.for("react.element"):60103,oD=vi?Symbol.for("react.portal"):60106,q2=vi?Symbol.for("react.fragment"):60107,H2=vi?Symbol.for("react.strict_mode"):60108,G2=vi?Symbol.for("react.profiler"):60114,K2=vi?Symbol.for("react.provider"):60109,X2=vi?Symbol.for("react.context"):60110,sD=vi?Symbol.for("react.async_mode"):60111,Y2=vi?Symbol.for("react.concurrent_mode"):60111,Z2=vi?Symbol.for("react.forward_ref"):60112,J2=vi?Symbol.for("react.suspense"):60113,rwe=vi?Symbol.for("react.suspense_list"):60120,Q2=vi?Symbol.for("react.memo"):60115,e_=vi?Symbol.for("react.lazy"):60116,iwe=vi?Symbol.for("react.block"):60121,awe=vi?Symbol.for("react.fundamental"):60117,owe=vi?Symbol.for("react.responder"):60118,swe=vi?Symbol.for("react.scope"):60119;function Co(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case aD:switch(e=e.type,e){case sD:case Y2:case q2:case G2:case H2:case J2:return e;default:switch(e=e&&e.$$typeof,e){case X2:case Z2:case e_:case Q2:case K2:return e;default:return t}}case oD:return t}}}function eV(e){return Co(e)===Y2}Pn.AsyncMode=sD,Pn.ConcurrentMode=Y2,Pn.ContextConsumer=X2,Pn.ContextProvider=K2,Pn.Element=aD,Pn.ForwardRef=Z2,Pn.Fragment=q2,Pn.Lazy=e_,Pn.Memo=Q2,Pn.Portal=oD,Pn.Profiler=G2,Pn.StrictMode=H2,Pn.Suspense=J2,Pn.isAsyncMode=function(e){return eV(e)||Co(e)===sD},Pn.isConcurrentMode=eV,Pn.isContextConsumer=function(e){return Co(e)===X2},Pn.isContextProvider=function(e){return Co(e)===K2},Pn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===aD},Pn.isForwardRef=function(e){return Co(e)===Z2},Pn.isFragment=function(e){return Co(e)===q2},Pn.isLazy=function(e){return Co(e)===e_},Pn.isMemo=function(e){return Co(e)===Q2},Pn.isPortal=function(e){return Co(e)===oD},Pn.isProfiler=function(e){return Co(e)===G2},Pn.isStrictMode=function(e){return Co(e)===H2},Pn.isSuspense=function(e){return Co(e)===J2},Pn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===q2||e===Y2||e===G2||e===H2||e===J2||e===rwe||typeof e=="object"&&e!==null&&(e.$$typeof===e_||e.$$typeof===Q2||e.$$typeof===K2||e.$$typeof===X2||e.$$typeof===Z2||e.$$typeof===awe||e.$$typeof===owe||e.$$typeof===swe||e.$$typeof===iwe)},Pn.typeOf=Co,QW.exports=Pn;var tV=QW.exports,uwe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},lwe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},nV={};nV[tV.ForwardRef]=uwe,nV[tV.Memo]=lwe;var cwe=!0;function fwe(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var rV=function(t,n,r){var i=t.key+"-"+n.name;if((r===!1||cwe===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles),t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function dwe(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var hwe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pwe=/[A-Z]|^ms/g,gwe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,iV=function(t){return t.charCodeAt(1)===45},aV=function(t){return t!=null&&typeof t!="boolean"},uD=ZW(function(e){return iV(e)?e:e.replace(pwe,"-$&").toLowerCase()}),oV=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(gwe,function(r,i,a){return Fu={name:i,styles:a,next:Fu},i})}return hwe[t]!==1&&!iV(t)&&typeof n=="number"&&n!==0?n+"px":n};function oy(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Fu={name:n.name,styles:n.styles,next:Fu},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Fu={name:r.name,styles:r.styles,next:Fu},r=r.next;var i=n.styles+";";return i}return mwe(e,t,n)}case"function":{if(e!==void 0){var a=Fu,o=n(e);return Fu=a,oy(e,t,o)}break}}if(t==null)return n;var s=t[n];return s!==void 0?s:n}function mwe(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=oy(e,t,n[i])+";";else for(var a in n){var o=n[a];if(typeof o!="object")t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":aV(o)&&(r+=uD(a)+":"+oV(a,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var s=0;s<o.length;s++)aV(o[s])&&(r+=uD(a)+":"+oV(a,o[s])+";");else{var u=oy(e,t,o);switch(a){case"animation":case"animationName":{r+=uD(a)+":"+u+";";break}default:r+=a+"{"+u+"}"}}}return r}var sV=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Fu,lD=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";Fu=void 0;var o=t[0];o==null||o.raw===void 0?(i=!1,a+=oy(r,n,o)):a+=o[0];for(var s=1;s<t.length;s++)a+=oy(r,n,t[s]),i&&(a+=o[s]);sV.lastIndex=0;for(var u="",l;(l=sV.exec(a))!==null;)u+="-"+l[1];var c=dwe(a)+u;return{name:c,styles:a,next:Fu}},uV=ha(typeof HTMLElement!="undefined"?nwe({key:"css"}):null);uV.Provider;var lV=function(t){return Kl(function(n,r){var i=Un(uV);return t(n,i,r)})},sy=ha({}),vwe=function(t,n){if(typeof n=="function"){var r=n(t);return r}return yh({},t,n)},ywe=YW(function(e){return YW(function(t){return vwe(e,t)})}),bwe=function(t){var n=Un(sy);return t.theme!==n&&(n=ywe(n)(t.theme)),le(sy.Provider,{value:n},t.children)},cD=lV(function(e,t){var n=e.styles,r=lD([n],void 0,Un(sy)),i=Jt();return uf(function(){var a=t.key+"-global",o=new BW({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",a),o.hydrate([u])),i.current=[o,s],function(){o.flush()}},[t]),uf(function(){var a=i.current,o=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&rV(t,r.next,!0),o.tags.length){var u=o.tags[o.tags.length-1].nextElementSibling;o.before=u,o.flush()}t.insert("",r,o,!1)},[t,r.name]),null});function xwe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lD(t)}var cV=function(){var t=xwe.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},wwe=()=>le(cD,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;      
        -moz-osx-font-smoothing: grayscale; 
        touch-action: manipulation; 
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
        vertical-align: middle;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }
    `}),_we=wwe;function Swe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function hf(e){return typeof e=="number"}function fD(e){return Array.isArray(e)}function fV(e){return typeof e=="function"}function Ps(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")&&!fD(e)}function Ewe(e){return Ps(e)&&Object.keys(e).length===0}function dV(e){return e==null}function dD(e){return Object.prototype.toString.call(e)==="[object String]"}function hV(e){return/^var\(--.+\)$/.test(e)}var t_=!1,hD={exports:{}};(function(e,t){var n=200,r="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",y="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",A="[object Undefined]",_="[object WeakMap]",E="[object ArrayBuffer]",C="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",I="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",D="[object Uint8Array]",L="[object Uint8ClampedArray]",W="[object Uint16Array]",G="[object Uint32Array]",K=/[\\^$.*+?()[\]{}|]/g,ee=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,he={};he[k]=he[T]=he[I]=he[N]=he[O]=he[D]=he[L]=he[W]=he[G]=!0,he[s]=he[u]=he[E]=he[c]=he[C]=he[f]=he[d]=he[h]=he[g]=he[m]=he[y]=he[x]=he[w]=he[S]=he[_]=!1;var Oe=typeof Ye=="object"&&Ye&&Ye.Object===Object&&Ye,Te=typeof self=="object"&&self&&self.Object===Object&&self,Re=Oe||Te||Function("return this")(),me=t&&!t.nodeType&&t,P=me&&!0&&e&&!e.nodeType&&e,F=P&&P.exports===me,V=F&&Oe.process,ae=function(){try{var H=P&&P.require&&P.require("util").types;return H||V&&V.binding&&V.binding("util")}catch(ne){}}(),Y=ae&&ae.isTypedArray;function M(H,ne,de){switch(de.length){case 0:return H.call(ne);case 1:return H.call(ne,de[0]);case 2:return H.call(ne,de[0],de[1]);case 3:return H.call(ne,de[0],de[1],de[2])}return H.apply(ne,de)}function B(H,ne){for(var de=-1,Xe=Array(H);++de<H;)Xe[de]=ne(de);return Xe}function R(H){return function(ne){return H(ne)}}function X(H,ne){return H==null?void 0:H[ne]}function ge(H,ne){return function(de){return H(ne(de))}}var xe=Array.prototype,ze=Function.prototype,Ke=Object.prototype,Ze=Re["__core-js_shared__"],Lt=ze.toString,Je=Ke.hasOwnProperty,Zt=function(){var H=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return H?"Symbol(src)_1."+H:""}(),mn=Ke.toString,qn=Lt.call(Object),ni=RegExp("^"+Lt.call(Je).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tr=F?Re.Buffer:void 0,Dn=Re.Symbol,Qo=Re.Uint8Array,Ka=tr?tr.allocUnsafe:void 0,Ul=ge(Object.getPrototypeOf,Object),Os=Object.create,Is=Ke.propertyIsEnumerable,Wl=xe.splice,Vl=Dn?Dn.toStringTag:void 0,rf=function(){try{var H=Pe(Object,"defineProperty");return H({},"",{}),H}catch(ne){}}(),v2=tr?tr.isBuffer:void 0,y2=Math.max,Iu=Date.now,b2=Pe(Re,"Map"),dh=Pe(Object,"create"),x2=function(){function H(){}return function(ne){if(!gh(ne))return{};if(Os)return Os(ne);H.prototype=ne;var de=new H;return H.prototype=void 0,de}}();function ql(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function iN(){this.__data__=dh?dh(null):{},this.size=0}function aN(H){var ne=this.has(H)&&delete this.__data__[H];return this.size-=ne?1:0,ne}function oN(H){var ne=this.__data__;if(dh){var de=ne[H];return de===r?void 0:de}return Je.call(ne,H)?ne[H]:void 0}function sN(H){var ne=this.__data__;return dh?ne[H]!==void 0:Je.call(ne,H)}function uN(H,ne){var de=this.__data__;return this.size+=this.has(H)?0:1,de[H]=dh&&ne===void 0?r:ne,this}ql.prototype.clear=iN,ql.prototype.delete=aN,ql.prototype.get=oN,ql.prototype.has=sN,ql.prototype.set=uN;function Ns(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function lN(){this.__data__=[],this.size=0}function cN(H){var ne=this.__data__,de=Nu(ne,H);if(de<0)return!1;var Xe=ne.length-1;return de==Xe?ne.pop():Wl.call(ne,de,1),--this.size,!0}function fN(H){var ne=this.__data__,de=Nu(ne,H);return de<0?void 0:ne[de][1]}function w2(H){return Nu(this.__data__,H)>-1}function dN(H,ne){var de=this.__data__,Xe=Nu(de,H);return Xe<0?(++this.size,de.push([H,ne])):de[Xe][1]=ne,this}Ns.prototype.clear=lN,Ns.prototype.delete=cN,Ns.prototype.get=fN,Ns.prototype.has=w2,Ns.prototype.set=dN;function af(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function hN(){this.size=0,this.__data__={hash:new ql,map:new(b2||Ns),string:new ql}}function pN(H){var ne=Fe(this,H).delete(H);return this.size-=ne?1:0,ne}function gN(H){return Fe(this,H).get(H)}function mN(H){return Fe(this,H).has(H)}function vN(H,ne){var de=Fe(this,H),Xe=de.size;return de.set(H,ne),this.size+=de.size==Xe?0:1,this}af.prototype.clear=hN,af.prototype.delete=pN,af.prototype.get=gN,af.prototype.has=mN,af.prototype.set=vN;function of(H){var ne=this.__data__=new Ns(H);this.size=ne.size}function yN(){this.__data__=new Ns,this.size=0}function bN(H){var ne=this.__data__,de=ne.delete(H);return this.size=ne.size,de}function xN(H){return this.__data__.get(H)}function wN(H){return this.__data__.has(H)}function _N(H,ne){var de=this.__data__;if(de instanceof Ns){var Xe=de.__data__;if(!b2||Xe.length<n-1)return Xe.push([H,ne]),this.size=++de.size,this;de=this.__data__=new af(Xe)}return de.set(H,ne),this.size=de.size,this}of.prototype.clear=yN,of.prototype.delete=bN,of.prototype.get=xN,of.prototype.has=wN,of.prototype.set=_N;function SN(H,ne){var de=ON(H),Xe=!de&&zg(H),un=!de&&!Xe&&wU(H),Hn=!de&&!Xe&&!un&&SU(H),ur=de||Xe||un||Hn,rn=ur?B(H.length,String):[],lr=rn.length;for(var es in H)(ne||Je.call(H,es))&&!(ur&&(es=="length"||un&&(es=="offset"||es=="parent")||Hn&&(es=="buffer"||es=="byteLength"||es=="byteOffset")||Ft(es,lr)))&&rn.push(es);return rn}function W0(H,ne,de){(de!==void 0&&!Bg(H[ne],de)||de===void 0&&!(ne in H))&&Pg(H,ne,de)}function _2(H,ne,de){var Xe=H[ne];(!(Je.call(H,ne)&&Bg(Xe,de))||de===void 0&&!(ne in H))&&Pg(H,ne,de)}function Nu(H,ne){for(var de=H.length;de--;)if(Bg(H[de][0],ne))return de;return-1}function Pg(H,ne,de){ne=="__proto__"&&rf?rf(H,ne,{configurable:!0,enumerable:!0,value:de,writable:!0}):H[ne]=de}var sf=De();function $g(H){return H==null?H===void 0?A:v:Vl&&Vl in Object(H)?je(H):ph(H)}function hh(H){return K0(H)&&$g(H)==s}function V0(H){if(!gh(H)||_r(H))return!1;var ne=NN(H)?ni:ee;return ne.test(TN(H))}function EN(H){return K0(H)&&_U(H.length)&&!!he[$g(H)]}function AN(H){if(!gh(H))return Xa(H);var ne=sr(H),de=[];for(var Xe in H)Xe=="constructor"&&(ne||!Je.call(H,Xe))||de.push(Xe);return de}function Lg(H,ne,de,Xe,un){H!==ne&&sf(ne,function(Hn,ur){if(un||(un=new of),gh(Hn))CN(H,ne,ur,de,Lg,Xe,un);else{var rn=Xe?Xe(H0(H,ur),Hn,ur+"",H,ne,un):void 0;rn===void 0&&(rn=Hn),W0(H,ur,rn)}},EU)}function CN(H,ne,de,Xe,un,Hn,ur){var rn=H0(H,de),lr=H0(ne,de),es=ur.get(lr);if(es){W0(H,de,es);return}var Eo=Hn?Hn(rn,lr,de+"",H,ne,ur):void 0,X0=Eo===void 0;if(X0){var DN=ON(lr),RN=!DN&&wU(lr),CU=!DN&&!RN&&SU(lr);Eo=lr,DN||RN||CU?ON(rn)?Eo=rn:n1e(rn)?Eo=oe(rn):RN?(X0=!1,Eo=Z(lr,!0)):CU?(X0=!1,Eo=re(lr,!0)):Eo=[]:r1e(lr)||zg(lr)?(Eo=rn,zg(rn)?Eo=i1e(rn):(!gh(rn)||NN(rn))&&(Eo=it(lr))):X0=!1}X0&&(ur.set(lr,Eo),un(Eo,lr,Xe,Hn,ur),ur.delete(lr)),W0(H,de,Eo)}function kN(H,ne){return G0(q0(H,ne,AU),H+"")}var z=rf?function(H,ne){return rf(H,"toString",{configurable:!0,enumerable:!1,value:o1e(ne),writable:!0})}:AU;function Z(H,ne){if(ne)return H.slice();var de=H.length,Xe=Ka?Ka(de):new H.constructor(de);return H.copy(Xe),Xe}function q(H){var ne=new H.constructor(H.byteLength);return new Qo(ne).set(new Qo(H)),ne}function re(H,ne){var de=ne?q(H.buffer):H.buffer;return new H.constructor(de,H.byteOffset,H.length)}function oe(H,ne){var de=-1,Xe=H.length;for(ne||(ne=Array(Xe));++de<Xe;)ne[de]=H[de];return ne}function te(H,ne,de,Xe){var un=!de;de||(de={});for(var Hn=-1,ur=ne.length;++Hn<ur;){var rn=ne[Hn],lr=Xe?Xe(de[rn],H[rn],rn,de,H):void 0;lr===void 0&&(lr=H[rn]),un?Pg(de,rn,lr):_2(de,rn,lr)}return de}function Ae(H){return kN(function(ne,de){var Xe=-1,un=de.length,Hn=un>1?de[un-1]:void 0,ur=un>2?de[2]:void 0;for(Hn=H.length>3&&typeof Hn=="function"?(un--,Hn):void 0,ur&&bn(de[0],de[1],ur)&&(Hn=un<3?void 0:Hn,un=1),ne=Object(ne);++Xe<un;){var rn=de[Xe];rn&&H(ne,rn,Xe,Hn)}return ne})}function De(H){return function(ne,de,Xe){for(var un=-1,Hn=Object(ne),ur=Xe(ne),rn=ur.length;rn--;){var lr=ur[H?rn:++un];if(de(Hn[lr],lr,Hn)===!1)break}return ne}}function Fe(H,ne){var de=H.__data__;return An(ne)?de[typeof ne=="string"?"string":"hash"]:de.map}function Pe(H,ne){var de=X(H,ne);return V0(de)?de:void 0}function je(H){var ne=Je.call(H,Vl),de=H[Vl];try{H[Vl]=void 0;var Xe=!0}catch(Hn){}var un=mn.call(H);return Xe&&(ne?H[Vl]=de:delete H[Vl]),un}function it(H){return typeof H.constructor=="function"&&!sr(H)?x2(Ul(H)):{}}function Ft(H,ne){var de=typeof H;return ne=ne??o,!!ne&&(de=="number"||de!="symbol"&&ce.test(H))&&H>-1&&H%1==0&&H<ne}function bn(H,ne,de){if(!gh(de))return!1;var Xe=typeof ne;return(Xe=="number"?IN(de)&&Ft(ne,de.length):Xe=="string"&&ne in de)?Bg(de[ne],H):!1}function An(H){var ne=typeof H;return ne=="string"||ne=="number"||ne=="symbol"||ne=="boolean"?H!=="__proto__":H===null}function _r(H){return!!Zt&&Zt in H}function sr(H){var ne=H&&H.constructor,de=typeof ne=="function"&&ne.prototype||Ke;return H===de}function Xa(H){var ne=[];if(H!=null)for(var de in Object(H))ne.push(de);return ne}function ph(H){return mn.call(H)}function q0(H,ne,de){return ne=y2(ne===void 0?H.length-1:ne,0),function(){for(var Xe=arguments,un=-1,Hn=y2(Xe.length-ne,0),ur=Array(Hn);++un<Hn;)ur[un]=Xe[ne+un];un=-1;for(var rn=Array(ne+1);++un<ne;)rn[un]=Xe[un];return rn[ne]=de(ur),M(H,this,rn)}}function H0(H,ne){if(!(ne==="constructor"&&typeof H[ne]=="function")&&ne!="__proto__")return H[ne]}var G0=xU(z);function xU(H){var ne=0,de=0;return function(){var Xe=Iu(),un=a-(Xe-de);if(de=Xe,un>0){if(++ne>=i)return arguments[0]}else ne=0;return H.apply(void 0,arguments)}}function TN(H){if(H!=null){try{return Lt.call(H)}catch(ne){}try{return H+""}catch(ne){}}return""}function Bg(H,ne){return H===ne||H!==H&&ne!==ne}var zg=hh(function(){return arguments}())?hh:function(H){return K0(H)&&Je.call(H,"callee")&&!Is.call(H,"callee")},ON=Array.isArray;function IN(H){return H!=null&&_U(H.length)&&!NN(H)}function n1e(H){return K0(H)&&IN(H)}var wU=v2||s1e;function NN(H){if(!gh(H))return!1;var ne=$g(H);return ne==h||ne==p||ne==l||ne==b}function _U(H){return typeof H=="number"&&H>-1&&H%1==0&&H<=o}function gh(H){var ne=typeof H;return H!=null&&(ne=="object"||ne=="function")}function K0(H){return H!=null&&typeof H=="object"}function r1e(H){if(!K0(H)||$g(H)!=y)return!1;var ne=Ul(H);if(ne===null)return!0;var de=Je.call(ne,"constructor")&&ne.constructor;return typeof de=="function"&&de instanceof de&&Lt.call(de)==qn}var SU=Y?R(Y):EN;function i1e(H){return te(H,EU(H))}function EU(H){return IN(H)?SN(H,!0):AN(H)}var a1e=Ae(function(H,ne,de,Xe){Lg(H,ne,de,Xe)});function o1e(H){return function(){return H}}function AU(H){return H}function s1e(){return!1}e.exports=a1e})(hD,hD.exports);var Zl=hD.exports;function pD(e,t){var n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n}function Awe(e,t){var n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n}function Cwe(e,t){var n={},r={};return Object.keys(e).forEach(i=>{t.includes(i)?n[i]=e[i]:r[i]=e[i]}),[n,r]}function kwe(e,t,n,r){var i=typeof t=="string"?t.split("."):[t];for(r=0;r<i.length&&e;r+=1)e=e[i[r]];return e===void 0?n:e}var Twe=e=>{var t=new WeakMap,n=(r,i,a,o)=>{if(typeof r=="undefined")return e(r,i,a);t.has(r)||t.set(r,new Map);var s=t.get(r);if(s.has(i))return s.get(i);var u=e(r,i,a,o);return s.set(i,u),u};return n},n_=Twe(kwe);function pV(e,t){var n={};return Object.keys(e).forEach(r=>{var i=e[r],a=t(i,r,e);a&&(n[r]=i)}),n}var r_=e=>pV(e,t=>t!=null),i_=e=>Object.keys(e),Owe=e=>e.reduce((t,n)=>{var[r,i]=n;return t[r]=i,t},{});function Iwe(e){var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}}function gD(e){if(e==null)return e;var{unitless:t}=Iwe(e);return t||hf(e)?e+"px":e}var gV=(e,t)=>parseInt(e[1],10)>parseInt(t[1],10)?1:-1,mD=e=>Owe(Object.entries(e).sort(gV));function mV(e){var t=mD(e);return Object.assign(Object.values(t),t)}function Nwe(e){var t=Object.keys(mD(e));return new Set(t)}function Dwe(e){var t;if(!e)return e;e=(t=gD(e))!=null?t:e;var n=e.endsWith("px")?-1:-.0635;return hf(e)?""+(e+n):e.replace(/([0-9]+\.?[0-9]*)/,r=>""+(parseFloat(r)+n))}function a_(e,t){var n=[];return e&&n.push("@media screen and (min-width: "+gD(e)+")"),n.length>0&&t&&n.push("and"),t&&n.push("@media screen and (max-width: "+gD(t)+")"),n.join(" ")}function Rwe(e){var t;if(!e)return null;e.base=(t=e.base)!=null?t:"0px";var n=mV(e),r=Object.entries(e).sort(gV).map((o,s,u)=>{var l,[c,f]=o,[,d]=(l=u[s+1])!=null?l:[];return d=parseFloat(d)>0?Dwe(d):void 0,{breakpoint:c,minW:f,maxW:d,maxWQuery:a_(null,d),minWQuery:a_(f),minMaxQuery:a_(f,d)}}),i=Nwe(e),a=Array.from(i.values());return{keys:i,normalized:n,isResponsive(o){var s=Object.keys(o);return s.length>0&&s.every(u=>i.has(u))},asObject:mD(e),asArray:mV(e),details:r,media:[null,...n.map(o=>a_(o)).slice(1)],toArrayValue(o){if(!Ps(o))throw new Error("toArrayValue: value must be an object");for(var s=a.map(u=>{var l;return(l=o[u])!=null?l:null});Swe(s)===null;)s.pop();return s},toObjectValue(o){if(!Array.isArray(o))throw new Error("toObjectValue: value must be an array");return o.reduce((s,u,l)=>{var c=a[l];return c!=null&&u!=null&&(s[c]=u),s},{})}}}function vV(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function vD(e){var t;if(!vV(e))return!1;var n=(t=e.ownerDocument.defaultView)!=null?t:window;return e instanceof n.HTMLElement}function yV(e){var t;return vV(e)&&(t=e.ownerDocument)!=null?t:document}function Fwe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var Kg=Fwe(),Oi=e=>e?"":void 0,yD=e=>e?!0:void 0,Gn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter(Boolean).join(" ")};function Mwe(e){var{key:t,keyCode:n}=e,r=n>=37&&n<=40&&t.indexOf("Arrow")!==0,i=r?"Arrow"+t:t;return i}function bV(e){return e.button!==0}var Pwe=e=>e.hasAttribute("tabindex");function $we(e){return Boolean(e.getAttribute("disabled"))===!0||Boolean(e.getAttribute("aria-disabled"))===!0}function Lwe(e){return vD(e)&&e.tagName.toLowerCase()==="input"&&"select"in e}function Bwe(e){var t=vD(e)?yV(e):document;return t.activeElement===e}function xV(e){return e.parentElement&&xV(e.parentElement)?!0:e.hidden}function zwe(e){var t=e.getAttribute("contenteditable");return t!=="false"&&t!=null}function jwe(e){if(!vD(e)||xV(e)||$we(e))return!1;var{localName:t}=e,n=["input","select","textarea","button"];if(n.indexOf(t)>=0)return!0;var r={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in r?r[t]():zwe(e)?!0:Pwe(e)}var Uwe=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","embed","iframe","object","a[href]","area[href]","button:not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],Wwe=Uwe.join();function Vwe(e){var t=Array.from(e.querySelectorAll(Wwe));return t.unshift(e),t.filter(jwe).filter(n=>window.getComputedStyle(n).display!=="none")}function $s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return fV(e)?e(...n):e}function Fr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){t.some(a=>(a==null||a(i),i==null?void 0:i.defaultPrevented))}}function qwe(e){var t;return function(){if(e){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=e.apply(this,i),e=null}return t}}var uy=()=>{},bD=qwe(e=>()=>{var{condition:t,message:n}=e;t&&t_&&console.warn(n)});function Xg(e,t){t===void 0&&(t={});var{isActive:n=Bwe,nextTick:r,preventScroll:i=!0,selectTextIfInput:a=!0}=t;if(!e||n(e))return-1;function o(){if(!e){bD({condition:!0,message:"[chakra-ui]: can't call focus() on `null` or `undefined` element"});return}if(Hwe())e.focus({preventScroll:i});else if(e.focus(),i){var s=Gwe(e);Kwe(s)}Lwe(e)&&a&&e.select()}return r?requestAnimationFrame(o):(o(),-1)}var o_=null;function Hwe(){if(o_==null){o_=!1;try{var e=document.createElement("div");e.focus({get preventScroll(){return o_=!0,!0}})}catch(t){}}return o_}function Gwe(e){for(var t,n=yV(e),r=(t=n.defaultView)!=null?t:window,i=e.parentNode,a=[],o=n.scrollingElement||n.documentElement;i instanceof r.HTMLElement&&i!==o;)(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth)&&a.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),i=i.parentNode;return o instanceof r.HTMLElement&&a.push({element:o,scrollTop:o.scrollTop,scrollLeft:o.scrollLeft}),a}function Kwe(e){for(var{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function Xwe(e){var{hasBeenSelected:t,isLazy:n,isSelected:r,lazyBehavior:i="unmount"}=e;return!!(!n||r||i==="keepMounted"&&t)}var wV=1/60*1e3,Ywe=typeof performance!="undefined"?function(){return performance.now()}:function(){return Date.now()},_V=typeof window!="undefined"?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(Ywe())},wV)};function Zwe(e){var t=[],n=[],r=0,i=!1,a=new WeakSet,o={schedule:function(s,u,l){u===void 0&&(u=!1),l===void 0&&(l=!1);var c=l&&i,f=c?t:n;return u&&a.add(s),f.indexOf(s)===-1&&(f.push(s),c&&i&&(r=t.length)),s},cancel:function(s){var u=n.indexOf(s);u!==-1&&n.splice(u,1),a.delete(s)},process:function(s){var u;if(i=!0,u=[n,t],t=u[0],n=u[1],n.length=0,r=t.length,r)for(var l=0;l<r;l++){var c=t[l];c(s),a.has(c)&&(o.schedule(c),e())}i=!1}};return o}var Jwe=40,xD=!0,ly=!1,wD=!1,Yg={delta:0,timestamp:0},cy=["read","update","preRender","render","postRender"],s_=cy.reduce(function(e,t){return e[t]=Zwe(function(){return ly=!0}),e},{}),Mu=cy.reduce(function(e,t){var n=s_[t];return e[t]=function(r,i,a){return i===void 0&&(i=!1),a===void 0&&(a=!1),ly||e2e(),n.schedule(r,i,a)},e},{}),fy=cy.reduce(function(e,t){return e[t]=s_[t].cancel,e},{}),Zg=cy.reduce(function(e,t){return e[t]=function(){return s_[t].process(Yg)},e},{}),Qwe=function(e){return s_[e].process(Yg)},SV=function(e){ly=!1,Yg.delta=xD?wV:Math.max(Math.min(e-Yg.timestamp,Jwe),1),Yg.timestamp=e,wD=!0,cy.forEach(Qwe),wD=!1,ly&&(xD=!1,_V(SV))},e2e=function(){ly=!0,xD=!0,wD||_V(SV)},u_=function(){return Yg};Object.freeze(["base","sm","md","lg","xl","2xl"]);function dy(e,t){return fD(e)?e.map(n=>n===null?null:t(n)):Ps(e)?i_(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):e!=null?t(e):null}function t2e(e,t){function n(r,i){return i===void 0&&(i=[]),fD(r)?r.map((a,o)=>n(a,[...i,String(o)])):Ps(r)?Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,n(s,[...i,o])]})):t(r,i)}return n(e)}function n2e(e,t){if(e!=null){if(fV(e)){e(t);return}try{e.current=t}catch(n){throw new Error("Cannot assign value '"+t+"' to ref '"+e+"'")}}}function pf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=>{t.forEach(i=>n2e(i,r))}}function Pu(e){e===void 0&&(e={});var{strict:t=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=e,i=ha(void 0);i.displayName=r;function a(){var o=Un(i);if(!o&&t){var s=new Error(n);throw s.name="ContextError",Error.captureStackTrace==null||Error.captureStackTrace(s,a),s}return o}return[i.Provider,a,i]}function _D(e){return T2.toArray(e).filter(t=>mh(t))}var[r2e,i2e]=Pu({strict:!1,name:"PortalManagerContext"});function EV(e){var{children:t,zIndex:n}=e;return le(r2e,{value:{zIndex:n}},t)}t_&&(EV.displayName="PortalManager");function SD(e){e===void 0&&(e=!1);var[t,n]=an(e),r=st(()=>{n(!0)},[]),i=st(()=>{n(!1)},[]),a=st(()=>{n(o=>!o)},[]);return[t,{on:r,off:i,toggle:a}]}var Jg=Kg?uf:Vt;function hy(e,t){t===void 0&&(t=[]);var n=Jt(e);return Jg(()=>{n.current=e}),st(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.current==null?void 0:n.current(...i)},t)}function a2e(e,t){var n=e!==void 0,r=n&&typeof e!="undefined"?e:t;return[n,r]}function o2e(e){var{value:t,defaultValue:n,onChange:r,shouldUpdate:i=(d,h)=>d!==h}=e,a=hy(r),o=hy(i),[s,u]=an(n),l=t!==void 0,c=l?t:s,f=st(d=>{var h=$s(d,c);!o(c,h)||(l||u(h),a(h))},[l,a,c,o]);return[c,f]}var AV={prefix:Math.round(Math.random()*1e10),current:0},ED=ha(AV),s2e=QU(e=>{var{children:t}=e,n=Un(ED),r=n===AV,i=gr(()=>({prefix:r?0:++n.prefix,current:0}),[r,n]);return le(ED.Provider,{value:i},t)});function CV(e,t){var n=Un(ED);return gr(()=>e||[t,n.prefix,++n.current].filter(Boolean).join("-"),[e,t])}function u2e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=CV(e);return gr(()=>n.map(a=>a+"-"+i),[i,n])}function l2e(e,t){return t===void 0&&(t=[]),Vt(()=>()=>e(),t)}function kV(){var e=Jt(!1),[t,n]=an(0);return l2e(()=>{e.current=!0}),st(()=>{e.current||n(t+1)},[t])}function AD(){return AD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AD.apply(this,arguments)}function c2e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[TV,f2e]=Pu({strict:!1,name:"PortalContext"}),CD="chakra-portal",d2e=".chakra-portal",h2e=e=>le("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0}},e.children),p2e=e=>{var{appendToParentPortal:t,children:n}=e,r=Jt(null),i=Jt(null),a=kV(),o=f2e(),s=i2e();Jg(()=>{if(!!r.current){var l=r.current.ownerDocument,c=t?o??l.body:l.body;if(!!c){i.current=l.createElement("div"),i.current.className=CD,c.appendChild(i.current),a();var f=i.current;return()=>{c.contains(f)&&c.removeChild(f)}}}},[]);var u=s!=null&&s.zIndex?le(h2e,{zIndex:s==null?void 0:s.zIndex},n):n;return i.current?jN(le(TV,{value:i.current},u),i.current):le("span",{ref:r})},g2e=e=>{var{children:t,containerRef:n,appendToParentPortal:r}=e,i=n.current,a=i??(Kg?document.body:void 0),o=gr(()=>{var u=i==null?void 0:i.ownerDocument.createElement("div");return u&&(u.className=CD),u},[i]),s=kV();return Jg(()=>{s()},[]),Jg(()=>{if(!(!o||!a))return a.appendChild(o),()=>{a.removeChild(o)}},[o,a]),a&&o?jN(le(TV,{value:r?o:null},t),o):null};function l_(e){var{containerRef:t}=e,n=c2e(e,["containerRef"]);return t?le(g2e,AD({containerRef:t},n)):le(p2e,n)}l_.defaultProps={appendToParentPortal:!0},l_.className=CD,l_.selector=d2e;var c_={light:"chakra-ui-light",dark:"chakra-ui-dark"},m2e={classList:{add:uy,remove:uy}},v2e=()=>Kg?document.body:m2e;function y2e(e){var t=v2e();t.classList.add(e?c_.dark:c_.light),t.classList.remove(e?c_.light:c_.dark)}function b2e(e){var t=window.matchMedia==null?void 0:window.matchMedia(e);if(!!t)return!!t.media===t.matches}var OV={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"};function x2e(e){var t,n=(t=b2e(OV.dark))!=null?t:e==="dark";return n?"dark":"light"}function w2e(e){if(!("matchMedia"in window))return uy;var t=window.matchMedia(OV.dark),n=()=>{e(t.matches?"dark":"light")};return n(),t.addListener(n),()=>{t.removeListener(n)}}var IV={get:()=>document.documentElement.style.getPropertyValue("--chakra-ui-color-mode"),set:e=>{Kg&&document.documentElement.style.setProperty("--chakra-ui-color-mode",e)}},NV=()=>typeof Storage!="undefined",DV="chakra-ui-color-mode",_2e={get(e){if(!NV())return e;try{var t=localStorage.getItem(DV);return t??e}catch(n){return e}},set(e){if(!!NV())try{localStorage.setItem(DV,e)}catch(t){}},type:"localStorage"},kD=ha({});t_&&(kD.displayName="ColorModeContext");var TD=()=>{var e=Un(kD);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e};function RV(e){var{value:t,children:n,options:{useSystemColorMode:r,initialColorMode:i},colorModeManager:a=_2e}=e,[o,s]=an(a.type==="cookie"?a.get(i):i);Vt(()=>{if(Kg&&a.type==="localStorage"){var f=r?x2e(i):IV.get()||a.get();f&&s(f)}},[a,r,i]),Vt(()=>{var f=o==="dark";y2e(f),IV.set(f?"dark":"light")},[o]);var u=st(f=>{a.set(f),s(f)},[a]),l=st(()=>{u(o==="light"?"dark":"light")},[o,u]);Vt(()=>{var f;return r&&(f=w2e(u)),()=>{f&&r&&f()}},[u,r]);var c=gr(()=>({colorMode:t??o,toggleColorMode:t?uy:l,setColorMode:t?uy:u}),[o,u,l,t]);return le(kD.Provider,{value:c},n)}t_&&(RV.displayName="ColorModeProvider");function S2e(e,t){var{colorMode:n}=TD();return n==="dark"?t:e}var E2e=(e,t)=>n=>{var r=String(t),i=e?e+"."+r:r;return Ps(n.__cssMap)&&i in n.__cssMap?n.__cssMap[i].varRef:t};function py(e){var{scale:t,transform:n,compose:r}=e,i=(a,o)=>{var s,u=E2e(t,a)(o),l=(s=n==null?void 0:n(u,o))!=null?s:u;return r&&(l=r(l,o)),l};return i}function Ls(e,t){return n=>{var r={property:n,scale:e};return r.transform=py({scale:e,transform:t}),r}}var A2e=e=>{var{rtl:t,ltr:n}=e;return r=>r.direction==="rtl"?t:n};function C2e(e){var{property:t,scale:n,transform:r}=e;return{scale:n,property:A2e(t),transform:n?py({scale:n,compose:r}):r}}var FV=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function k2e(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...FV].join(" ")}function T2e(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...FV].join(" ")}var O2e={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},I2e={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function N2e(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var D2e={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},MV="& > :not(style) ~ :not(style)",R2e={[MV]:{marginInlineStart:"calc(var(--chakra-space-x) * calc(1 - var(--chakra-space-x-reverse)))",marginInlineEnd:"calc(var(--chakra-space-x) * var(--chakra-space-x-reverse))"}},F2e={[MV]:{marginTop:"calc(var(--chakra-space-y) * calc(1 - var(--chakra-space-y-reverse)))",marginBottom:"calc(var(--chakra-space-y) * var(--chakra-space-y-reverse))"}};function OD(e,t){OD=function(u,l){return new a(u,void 0,l)};var n=ID(RegExp),r=RegExp.prototype,i=new WeakMap;function a(s,u,l){var c=n.call(this,s,u);return i.set(c,l||i.get(s)),c}M2e(a,n),a.prototype.exec=function(s){var u=r.exec.call(this,s);return u&&(u.groups=o(u,this)),u},a.prototype[Symbol.replace]=function(s,u){if(typeof u=="string"){var l=i.get(this);return r[Symbol.replace].call(this,s,u.replace(/\$<([^>]+)>/g,function(f,d){return"$"+l[d]}))}else if(typeof u=="function"){var c=this;return r[Symbol.replace].call(this,s,function(){var f=[];return f.push.apply(f,arguments),typeof f[f.length-1]!="object"&&f.push(o(f,c)),u.apply(this,f)})}else return r[Symbol.replace].call(this,s,u)};function o(s,u){var l=i.get(u);return Object.keys(l).reduce(function(c,f){return c[f]=s[l[f]],c},Object.create(null))}return OD.apply(this,arguments)}function M2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gy(e,t)}function ID(e){var t=typeof Map=="function"?new Map:void 0;return ID=function(r){if(r===null||!$2e(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return f_(r,arguments,ND(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),gy(i,r)},ID(e)}function f_(e,t,n){return P2e()?f_=Reflect.construct:f_=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&gy(l,o.prototype),l},f_.apply(null,arguments)}function P2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function $2e(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function gy(e,t){return gy=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},gy(e,t)}function ND(e){return ND=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},ND(e)}var DD={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},L2e=new Set(Object.values(DD)),PV=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),B2e=e=>e.trim();function z2e(e,t){var n,r;if(e==null||PV.has(e))return e;var i=OD(/(^[\x2DA-Za-z]+)\(((.*))\)/g,{type:1,values:2}),{type:a,values:o}=(n=(r=i.exec(e))==null?void 0:r.groups)!=null?n:{};if(!a||!o)return e;var s=a.includes("-gradient")?a:a+"-gradient",[u,...l]=o.split(",").map(B2e).filter(Boolean);if((l==null?void 0:l.length)===0)return e;var c=u in DD?DD[u]:u;l.unshift(c);var f=l.map(d=>{if(L2e.has(d))return d;var h=d.indexOf(" "),[p,g]=h!==-1?[d.substr(0,h),d.substr(h+1)]:[d],m=$V(g)?g:g&&g.split(" "),v="colors."+p,y=v in t.__cssMap?t.__cssMap[v].varRef:p;return m?[y,m].join(" "):y});return s+"("+f.join(", ")+")"}var $V=e=>dD(e)&&e.includes("(")&&e.includes(")"),j2e=(e,t)=>z2e(e,t??{}),U2e=e=>{var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}},$u=e=>t=>e+"("+t+")",$n={filter(e){return e!=="auto"?e:O2e},backdropFilter(e){return e!=="auto"?e:I2e},ring(e){return N2e($n.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?k2e():e==="auto-gpu"?T2e():e},px(e){if(e==null)return e;var{unitless:t}=U2e(e);return t||hf(e)?e+"px":e},fraction(e){return!hf(e)||e>1?e:e*100+"%"},float(e,t){var n={left:"right",right:"left"};return t.direction==="rtl"?n[e]:e},degree(e){if(hV(e)||e==null)return e;var t=dD(e)&&!e.endsWith("deg");return hf(e)||t?e+"deg":e},gradient:j2e,blur:$u("blur"),opacity:$u("opacity"),brightness:$u("brightness"),contrast:$u("contrast"),dropShadow:$u("drop-shadow"),grayscale:$u("grayscale"),hueRotate:$u("hue-rotate"),invert:$u("invert"),saturate:$u("saturate"),sepia:$u("sepia"),bgImage(e){if(e==null)return e;var t=$V(e)||PV.has(e);return t?e:"url("+e+")"},outline(e){var t=String(e)==="0"||String(e)==="none";return e!==null&&t?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var t,{space:n,divide:r}=(t=D2e[e])!=null?t:{},i={flexDirection:e};return n&&(i[n]=1),r&&(i[r]=1),i}};function RD(){return RD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RD.apply(this,arguments)}var se={borderWidths:Ls("borderWidths"),borderStyles:Ls("borderStyles"),colors:Ls("colors"),borders:Ls("borders"),radii:Ls("radii",$n.px),space:Ls("space",$n.px),spaceT:Ls("space",$n.px),degreeT(e){return{property:e,transform:$n.degree}},prop(e,t,n){return RD({property:e,scale:t},t&&{transform:py({scale:t,transform:n})})},propT(e,t){return{property:e,transform:t}},sizes:Ls("sizes",$n.px),sizesT:Ls("sizes",$n.fraction),shadows:Ls("shadows"),logical:C2e,blur:Ls("blur",$n.blur)},d_={background:se.colors("background"),backgroundColor:se.colors("backgroundColor"),backgroundImage:se.propT("backgroundImage",$n.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:$n.bgClip},bgSize:se.prop("backgroundSize"),bgPosition:se.prop("backgroundPosition"),bg:se.colors("background"),bgColor:se.colors("backgroundColor"),bgPos:se.prop("backgroundPosition"),bgRepeat:se.prop("backgroundRepeat"),bgAttachment:se.prop("backgroundAttachment"),bgGradient:se.propT("backgroundImage",$n.gradient),bgClip:{transform:$n.bgClip}};Object.assign(d_,{bgImage:d_.backgroundImage,bgImg:d_.backgroundImage});var kn={border:se.borders("border"),borderWidth:se.borderWidths("borderWidth"),borderStyle:se.borderStyles("borderStyle"),borderColor:se.colors("borderColor"),borderRadius:se.radii("borderRadius"),borderTop:se.borders("borderTop"),borderBlockStart:se.borders("borderBlockStart"),borderTopLeftRadius:se.radii("borderTopLeftRadius"),borderStartStartRadius:se.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:se.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:se.radii("borderTopRightRadius"),borderStartEndRadius:se.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:se.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:se.borders("borderRight"),borderInlineEnd:se.borders("borderInlineEnd"),borderBottom:se.borders("borderBottom"),borderBlockEnd:se.borders("borderBlockEnd"),borderBottomLeftRadius:se.radii("borderBottomLeftRadius"),borderBottomRightRadius:se.radii("borderBottomRightRadius"),borderLeft:se.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:se.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:se.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:se.borders(["borderLeft","borderRight"]),borderInline:se.borders("borderInline"),borderY:se.borders(["borderTop","borderBottom"]),borderBlock:se.borders("borderBlock"),borderTopWidth:se.borderWidths("borderTopWidth"),borderBlockStartWidth:se.borderWidths("borderBlockStartWidth"),borderTopColor:se.colors("borderTopColor"),borderBlockStartColor:se.colors("borderBlockStartColor"),borderTopStyle:se.borderStyles("borderTopStyle"),borderBlockStartStyle:se.borderStyles("borderBlockStartStyle"),borderBottomWidth:se.borderWidths("borderBottomWidth"),borderBlockEndWidth:se.borderWidths("borderBlockEndWidth"),borderBottomColor:se.colors("borderBottomColor"),borderBlockEndColor:se.colors("borderBlockEndColor"),borderBottomStyle:se.borderStyles("borderBottomStyle"),borderBlockEndStyle:se.borderStyles("borderBlockEndStyle"),borderLeftWidth:se.borderWidths("borderLeftWidth"),borderInlineStartWidth:se.borderWidths("borderInlineStartWidth"),borderLeftColor:se.colors("borderLeftColor"),borderInlineStartColor:se.colors("borderInlineStartColor"),borderLeftStyle:se.borderStyles("borderLeftStyle"),borderInlineStartStyle:se.borderStyles("borderInlineStartStyle"),borderRightWidth:se.borderWidths("borderRightWidth"),borderInlineEndWidth:se.borderWidths("borderInlineEndWidth"),borderRightColor:se.colors("borderRightColor"),borderInlineEndColor:se.colors("borderInlineEndColor"),borderRightStyle:se.borderStyles("borderRightStyle"),borderInlineEndStyle:se.borderStyles("borderInlineEndStyle"),borderTopRadius:se.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:se.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:se.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:se.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(kn,{rounded:kn.borderRadius,roundedTop:kn.borderTopRadius,roundedTopLeft:kn.borderTopLeftRadius,roundedTopRight:kn.borderTopRightRadius,roundedTopStart:kn.borderStartStartRadius,roundedTopEnd:kn.borderStartEndRadius,roundedBottom:kn.borderBottomRadius,roundedBottomLeft:kn.borderBottomLeftRadius,roundedBottomRight:kn.borderBottomRightRadius,roundedBottomStart:kn.borderEndStartRadius,roundedBottomEnd:kn.borderEndEndRadius,roundedLeft:kn.borderLeftRadius,roundedRight:kn.borderRightRadius,roundedStart:kn.borderInlineStartRadius,roundedEnd:kn.borderInlineEndRadius,borderStart:kn.borderInlineStart,borderEnd:kn.borderInlineEnd,borderTopStartRadius:kn.borderStartStartRadius,borderTopEndRadius:kn.borderStartEndRadius,borderBottomStartRadius:kn.borderEndStartRadius,borderBottomEndRadius:kn.borderEndEndRadius,borderStartRadius:kn.borderInlineStartRadius,borderEndRadius:kn.borderInlineEndRadius,borderStartWidth:kn.borderInlineStartWidth,borderEndWidth:kn.borderInlineEndWidth,borderStartColor:kn.borderInlineStartColor,borderEndColor:kn.borderInlineEndColor,borderStartStyle:kn.borderInlineStartStyle,borderEndStyle:kn.borderInlineEndStyle});var W2e={color:se.colors("color"),textColor:se.colors("color"),fill:se.colors("fill"),stroke:se.colors("stroke")},FD={boxShadow:se.shadows("boxShadow"),mixBlendMode:!0,blendMode:se.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:se.prop("backgroundBlendMode"),opacity:!0};Object.assign(FD,{shadow:FD.boxShadow});var V2e={filter:{transform:$n.filter},blur:se.blur("--chakra-blur"),brightness:se.propT("--chakra-brightness",$n.brightness),contrast:se.propT("--chakra-contrast",$n.contrast),hueRotate:se.degreeT("--chakra-hue-rotate"),invert:se.propT("--chakra-invert",$n.invert),saturate:se.propT("--chakra-saturate",$n.saturate),dropShadow:se.propT("--chakra-drop-shadow",$n.dropShadow),backdropFilter:{transform:$n.backdropFilter},backdropBlur:se.blur("--chakra-backdrop-blur"),backdropBrightness:se.propT("--chakra-backdrop-brightness",$n.brightness),backdropContrast:se.propT("--chakra-backdrop-contrast",$n.contrast),backdropHueRotate:se.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:se.propT("--chakra-backdrop-invert",$n.invert),backdropSaturate:se.propT("--chakra-backdrop-saturate",$n.saturate)},h_={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:$n.flexDirection},experimental_spaceX:{static:R2e,transform:py({scale:"space",transform:e=>e!==null?{"--chakra-space-x":e}:null})},experimental_spaceY:{static:F2e,transform:py({scale:"space",transform:e=>e!=null?{"--chakra-space-y":e}:null})},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:se.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0};Object.assign(h_,{flexDir:h_.flexDirection});var LV={gridGap:se.space("gridGap"),gridColumnGap:se.space("gridColumnGap"),gridRowGap:se.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},q2e={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:$n.outline},outlineOffset:!0,outlineColor:se.colors("outlineColor")},rs={width:se.sizesT("width"),inlineSize:se.sizesT("inlineSize"),height:se.sizes("height"),blockSize:se.sizes("blockSize"),boxSize:se.sizes(["width","height"]),minWidth:se.sizes("minWidth"),minInlineSize:se.sizes("minInlineSize"),minHeight:se.sizes("minHeight"),minBlockSize:se.sizes("minBlockSize"),maxWidth:se.sizes("maxWidth"),maxInlineSize:se.sizes("maxInlineSize"),maxHeight:se.sizes("maxHeight"),maxBlockSize:se.sizes("maxBlockSize"),d:se.prop("display"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:se.propT("float",$n.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(rs,{w:rs.width,h:rs.height,minW:rs.minWidth,maxW:rs.maxWidth,minH:rs.minHeight,maxH:rs.maxHeight,overscroll:rs.overscrollBehavior,overscrollX:rs.overscrollBehaviorX,overscrollY:rs.overscrollBehaviorY});var H2e={listStyleType:!0,listStylePosition:!0,listStylePos:se.prop("listStylePosition"),listStyleImage:!0,listStyleImg:se.prop("listStyleImage")},G2e={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},K2e={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},MD=(e,t,n)=>{var r={},i=n_(e,t,{});for(var a in i){var o=a in n&&n[a]!=null;o||(r[a]=i[a])}return r},X2e={srOnly:{transform(e){return e===!0?G2e:e==="focusable"?K2e:{}}},layerStyle:{processResult:!0,transform:(e,t,n)=>MD(t,"layerStyles."+e,n)},textStyle:{processResult:!0,transform:(e,t,n)=>MD(t,"textStyles."+e,n)},apply:{processResult:!0,transform:(e,t,n)=>MD(t,e,n)}},my={position:!0,pos:se.prop("position"),zIndex:se.prop("zIndex","zIndices"),inset:se.spaceT(["top","right","bottom","left"]),insetX:se.spaceT(["left","right"]),insetInline:se.spaceT("insetInline"),insetY:se.spaceT(["top","bottom"]),insetBlock:se.spaceT("insetBlock"),top:se.spaceT("top"),insetBlockStart:se.spaceT("insetBlockStart"),bottom:se.spaceT("bottom"),insetBlockEnd:se.spaceT("insetBlockEnd"),left:se.spaceT("left"),insetInlineStart:se.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:se.spaceT("right"),insetInlineEnd:se.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(my,{insetStart:my.insetInlineStart,insetEnd:my.insetInlineEnd});var Y2e={ring:{transform:$n.ring},ringColor:se.colors("--chakra-ring-color"),ringOffset:se.prop("--chakra-ring-offset-width"),ringOffsetColor:se.colors("--chakra-ring-offset-color"),ringInset:se.prop("--chakra-ring-inset")},nr={margin:se.spaceT("margin"),marginTop:se.spaceT("marginTop"),marginBlockStart:se.spaceT("marginBlockStart"),marginRight:se.spaceT("marginRight"),marginInlineEnd:se.spaceT("marginInlineEnd"),marginBottom:se.spaceT("marginBottom"),marginBlockEnd:se.spaceT("marginBlockEnd"),marginLeft:se.spaceT("marginLeft"),marginInlineStart:se.spaceT("marginInlineStart"),marginX:se.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:se.spaceT("marginInline"),marginY:se.spaceT(["marginTop","marginBottom"]),marginBlock:se.spaceT("marginBlock"),padding:se.space("padding"),paddingTop:se.space("paddingTop"),paddingBlockStart:se.space("paddingBlockStart"),paddingRight:se.space("paddingRight"),paddingBottom:se.space("paddingBottom"),paddingBlockEnd:se.space("paddingBlockEnd"),paddingLeft:se.space("paddingLeft"),paddingInlineStart:se.space("paddingInlineStart"),paddingInlineEnd:se.space("paddingInlineEnd"),paddingX:se.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:se.space("paddingInline"),paddingY:se.space(["paddingTop","paddingBottom"]),paddingBlock:se.space("paddingBlock")};Object.assign(nr,{m:nr.margin,mt:nr.marginTop,mr:nr.marginRight,me:nr.marginInlineEnd,marginEnd:nr.marginInlineEnd,mb:nr.marginBottom,ml:nr.marginLeft,ms:nr.marginInlineStart,marginStart:nr.marginInlineStart,mx:nr.marginX,my:nr.marginY,p:nr.padding,pt:nr.paddingTop,py:nr.paddingY,px:nr.paddingX,pb:nr.paddingBottom,pl:nr.paddingLeft,ps:nr.paddingInlineStart,paddingStart:nr.paddingInlineStart,pr:nr.paddingRight,pe:nr.paddingInlineEnd,paddingEnd:nr.paddingInlineEnd});var Z2e={textDecorationColor:se.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:se.shadows("textShadow")},J2e={clipPath:!0,transform:se.propT("transform",$n.transform),transformOrigin:!0,translateX:se.spaceT("--chakra-translate-x"),translateY:se.spaceT("--chakra-translate-y"),skewX:se.degreeT("--chakra-skew-x"),skewY:se.degreeT("--chakra-skew-y"),scaleX:se.prop("--chakra-scale-x"),scaleY:se.prop("--chakra-scale-y"),scale:se.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:se.degreeT("--chakra-rotate")},Q2e={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:se.prop("transitionDuration","transition.duration"),transitionProperty:se.prop("transitionProperty","transition.property"),transitionTimingFunction:se.prop("transitionTimingFunction","transition.easing")},e_e={fontFamily:se.prop("fontFamily","fonts"),fontSize:se.prop("fontSize","fontSizes",$n.px),fontWeight:se.prop("fontWeight","fontWeights"),lineHeight:se.prop("lineHeight","lineHeights"),letterSpacing:se.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"},isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}},Qg={hover:e=>e+":hover &, "+e+"[data-hover] &",focus:e=>e+":focus &, "+e+"[data-focus] &",active:e=>e+":active &, "+e+"[data-active] &",disabled:e=>e+":disabled &, "+e+"[data-disabled] &",invalid:e=>e+":invalid &, "+e+"[data-invalid] &",checked:e=>e+":checked &, "+e+"[data-checked] &",indeterminate:e=>e+":indeterminate &, "+e+"[aria-checked=mixed] &, "+e+"[data-indeterminate] &",readOnly:e=>e+":read-only &, "+e+"[readonly] &, "+e+"[data-read-only] &",expanded:e=>e+":read-only &, "+e+"[aria-expanded=true] &, "+e+"[data-expanded] &"},em=e=>t_e(e,"[role=group]","[data-group]",".group"),t_e=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(t).join(", ")},PD={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible",_disabled:"&[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:em(Qg.hover),_groupFocus:em(Qg.focus),_groupActive:em(Qg.active),_groupDisabled:em(Qg.disabled),_groupInvalid:em(Qg.invalid),_groupChecked:em(Qg.checked),_placeholder:"&::placeholder",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &",_mediaDark:"@media (prefers-color-scheme: dark)",_dark:".chakra-ui-dark &, [data-theme=dark] &, &[data-theme=dark]",_light:".chakra-ui-light &, [data-theme=light] &, &[data-theme=light]"},n_e=i_(PD);function $D(){return $D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$D.apply(this,arguments)}var LD=Zl({},d_,kn,W2e,h_,rs,V2e,Y2e,q2e,LV,X2e,my,FD,nr,e_e,Z2e,J2e,H2e,Q2e),r_e=Object.assign({},nr,rs,h_,LV,my),i_e=i_(r_e),a_e=[...i_(LD),...n_e],o_e=$D({},LD,PD),s_e=e=>e in o_e,u_e=e=>t=>{if(!t.__breakpoints)return e;var{isResponsive:n,toArrayValue:r,media:i}=t.__breakpoints,a={};for(var o in e){var s=$s(e[o],t);if(s!=null){if(s=Ps(s)&&n(s)?r(s):s,!Array.isArray(s)){a[o]=s;continue}for(var u=s.slice(0,i.length).length,l=0;l<u;l+=1){var c=i==null?void 0:i[l];if(!c){a[o]=s[l];continue}a[c]=a[c]||{},s[l]!=null&&(a[c][o]=s[l])}}}return a},l_e=(e,t)=>e.startsWith("--")&&dD(t)&&!hV(t),c_e=(e,t)=>{var n,r;if(t==null)return t;var i=l=>{var c,f;return(c=e.__cssMap)==null||(f=c[l])==null?void 0:f.varRef},a=l=>{var c;return(c=i(l))!=null?c:l},o=t.split(",").map(l=>l.trim()),[s,u]=o;return t=(n=(r=i(s))!=null?r:a(u))!=null?n:a(t),t};function f_e(e){var{configs:t={},pseudos:n={},theme:r}=e,i=function a(o,s){s===void 0&&(s=!1);var u=$s(o,r),l=u_e(u)(r),c={};for(var f in l){var d,h,p,g,m,v=l[f],y=$s(v,r);f in n&&(f=n[f]),l_e(f,y)&&(y=c_e(r,y));var b=t[f];if(b===!0&&(b={property:f}),Ps(y)){var x;c[f]=(x=c[f])!=null?x:{},c[f]=Zl({},c[f],a(y,!0));continue}var w=(d=(h=b)==null||h.transform==null?void 0:h.transform(y,r,u))!=null?d:y;w=(p=b)!=null&&p.processResult?a(w,!0):w;var S=$s((g=b)==null?void 0:g.property,r);if(!s&&(m=b)!=null&&m.static){var A=$s(b.static,r);c=Zl({},c,A)}if(S&&Array.isArray(S)){for(var _ of S)c[_]=w;continue}if(S){S==="&"&&Ps(w)?c=Zl({},c,w):c[S]=w;continue}if(Ps(w)){c=Zl({},c,w);continue}c[f]=w}return c};return i}var BV=e=>t=>{var n=f_e({theme:t,pseudos:PD,configs:LD});return n(e)};function zV(e){return Ps(e)&&e.reference?e.reference:String(e)}var p_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(zV).join(" "+t+" ").replace(/calc/g,"")},jV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+p_("+",...n)+")"},UV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+p_("-",...n)+")"},BD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+p_("*",...n)+")"},WV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+p_("/",...n)+")"},VV=e=>{var t=zV(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:BD(t,-1)},bh=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(jV(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(UV(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(BD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bh(WV(e,...r))},negate:()=>bh(VV(e)),toString:()=>e.toString()}),{add:jV,subtract:UV,multiply:BD,divide:WV,negate:VV});function d_e(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function qV(e){var t=d_e(e.toString());if(t.includes("\\."))return e;var n=!Number.isInteger(parseFloat(e.toString()));return n?t.replace(".","\\."):e}function h_e(e,t){return t===void 0&&(t=""),[t,qV(e)].filter(Boolean).join("-")}function p_e(e,t){return"var("+qV(e)+(t?", "+t:"")+")"}function g_e(e,t){return t===void 0&&(t=""),"--"+h_e(e,t)}function HV(e,t,n){var r=g_e(e,n);return{variable:r,reference:p_e(r,t)}}function zD(){return zD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zD.apply(this,arguments)}function m_e(e,t){var n={cssMap:{},cssVars:{}};return t2e(e,(r,i)=>{var a,[o]=i,s=(a=jD[o])!=null?a:jD.defaultHandler,{cssVars:u,cssMap:l}=s(i,r,t);Object.assign(n.cssVars,u),Object.assign(n.cssMap,l)}),n}var jD={space:(e,t,n)=>{var r=jD.defaultHandler(e,t,n),[i,...a]=e,o=i+".-"+a.join("."),s=e.join("-"),{variable:u,reference:l}=HV(s,void 0,n.cssVarPrefix),c=bh.negate(t),f=bh.negate(l);return{cssVars:r.cssVars,cssMap:zD({},r.cssMap,{[o]:{value:""+c,var:""+u,varRef:f}})}},defaultHandler:(e,t,n)=>{var r=e.join("."),i=e.join("-"),{variable:a,reference:o}=HV(i,void 0,n.cssVarPrefix);return{cssVars:{[a]:t},cssMap:{[r]:{value:t,var:a,varRef:o}}}}};function v_e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var y_e=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur"];function b_e(e){var t=y_e;return Awe(e,t)}function x_e(e){var t=v_e(e,["__cssMap","__cssVars","__breakpoints"]);return t}function UD(){return UD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UD.apply(this,arguments)}function w_e(e){var t,n=x_e(e),r=b_e(n),i=(t=n.config)==null?void 0:t.cssVarPrefix,{cssMap:a,cssVars:o}=m_e(r,{cssVarPrefix:i}),s={"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"};return Object.assign(n,{__cssVars:UD({},s,o),__cssMap:a,__breakpoints:Rwe(n.breakpoints)}),n}var __e=typeof Element!="undefined",S_e=typeof Map=="function",E_e=typeof Set=="function",A_e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function g_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(!g_(e[r],t[r]))return!1;return!0}var a;if(S_e&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;for(a=e.entries();!(r=a.next()).done;)if(!g_(r.value[1],t.get(r.value[0])))return!1;return!0}if(E_e&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(A_e&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(__e&&e instanceof Element)return!1;for(r=n;r--!=0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!g_(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var C_e=function(t,n){try{return g_(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},k_e=e=>{var{cssVarsRoot:t=":host, :root",theme:n,children:r}=e,i=gr(()=>w_e(n),[n]);return le(bwe,{theme:i},le(cD,{styles:a=>({[t]:a.__cssVars})}),r)};function GV(){var e=Un(sy);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var[vy,Ii]=Pu({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "}),T_e=()=>{var{colorMode:e}=TD();return le(cD,{styles:t=>{var n=n_(t,"styles.global"),r=$s(n,{theme:t,colorMode:e});if(!!r){var i=BV(r)(t);return i}}})},O_e=["a","b","article","aside","blockquote","button","caption","cite","circle","code","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","img","input","kbd","label","li","main","mark","nav","ol","p","path","pre","q","rect","s","svg","section","select","strong","small","span","sub","sup","table","tbody","td","textarea","tfoot","th","thead","tr","ul"];function is(e){return pD(e,["styleConfig","size","variant","colorScheme"])}function WD(){return WD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WD.apply(this,arguments)}function I_e(){var e=TD(),t=GV();return WD({},e,{theme:t})}var N_e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,D_e=ZW(function(e){return N_e.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),R_e=D_e,F_e=function(t){return t!=="theme"},KV=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?R_e:F_e},XV=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},M_e=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,o;n!==void 0&&(a=n.label,o=n.target);var s=XV(t,n,r),u=s||KV(i),l=!u("as");return function(){var c=arguments,f=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),c[0]==null||c[0].raw===void 0)f.push.apply(f,c);else{f.push(c[0][0]);for(var d=c.length,h=1;h<d;h++)f.push(c[h],c[0][h])}var p=lV(function(g,m,v){var y=l&&g.as||i,b="",x=[],w=g;if(g.theme==null){w={};for(var S in g)w[S]=g[S];w.theme=Un(sy)}typeof g.className=="string"?b=fwe(m.registered,x,g.className):g.className!=null&&(b=g.className+" ");var A=lD(f.concat(x),m.registered,w);rV(m,A,typeof y=="string"),b+=m.key+"-"+A.name,o!==void 0&&(b+=" "+o);var _=l&&s===void 0?KV(y):u,E={};for(var C in g)l&&C==="as"||_(C)&&(E[C]=g[C]);E.className=b,E.ref=v;var k=le(y,E);return k});return p.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=i,p.__emotion_styles=f,p.__emotion_forwardProp=s,Object.defineProperty(p,"toString",{value:function(){return"."+o}}),p.withComponent=function(g,m){return e(g,yh({},n,m,{shouldForwardProp:XV(p,m,!0)})).apply(void 0,f)},p}},P_e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],VD=M_e.bind();P_e.forEach(function(e){VD[e]=VD(e)});var $_e=new Set([...a_e,"textStyle","layerStyle","apply","isTruncated","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),L_e=new Set(["htmlWidth","htmlHeight","htmlSize"]),B_e=e=>L_e.has(e)||!$_e.has(e);function YV(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var z_e=e=>{var{baseStyle:t}=e;return n=>{var{css:r,__css:i,sx:a}=n,o=YV(n,["theme","css","__css","sx"]),s=pV(o,(f,d)=>s_e(d)),u=$s(t,n),l=Object.assign({},i,u,r_(s),a),c=BV(l)(n.theme);return r?[c,r]:c}};function j_e(e,t){var n=t??{},{baseStyle:r}=n,i=YV(n,["baseStyle"]);i.shouldForwardProp||(i.shouldForwardProp=B_e);var a=z_e({baseStyle:r});return VD(e,i)(a)}var wt=j_e;O_e.forEach(e=>{wt[e]=wt(e)});function qt(e){return Kl(e)}function U_e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function tm(e,t,n){var r;t===void 0&&(t={}),n===void 0&&(n={});var{styleConfig:i}=t,a=U_e(t,["styleConfig"]),{theme:o,colorMode:s}=I_e(),u=n_(o,"components."+e),l=i||u,c=Zl({theme:o,colorMode:s},(r=l==null?void 0:l.defaultProps)!=null?r:{},r_(pD(a,["children"]))),f=Jt({});if(l){var d,h,p,g,m,v,y=$s((d=l.baseStyle)!=null?d:{},c),b=$s((h=(p=l.variants)==null?void 0:p[c.variant])!=null?h:{},c),x=$s((g=(m=l.sizes)==null?void 0:m[c.size])!=null?g:{},c),w=Zl({},y,x,b);(v=n)!=null&&v.isMultiPart&&l.parts&&l.parts.forEach(A=>{var _;w[A]=(_=w[A])!=null?_:{}});var S=C_e(f.current,w);S||(f.current=w)}return f.current}function gf(e,t){return tm(e,t,{isMultiPart:!0})}var W_e={body:{classList:{add(){},remove(){}}},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}}},ZV=W_e,nm=()=>{},V_e={document:ZV,navigator:{userAgent:""},CustomEvent:function(){return this},addEventListener:nm,removeEventListener:nm,getComputedStyle(){return{getPropertyValue(){return""}}},matchMedia(){return{matches:!1,addListener:nm,removeListener:nm}},requestAnimationFrame(e){return typeof setTimeout=="undefined"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout!="undefined"&&clearTimeout(e)},setTimeout:()=>0,clearTimeout:nm,setInterval:()=>0,clearInterval:nm},q_e=V_e,H_e={window:q_e,document:ZV},JV=Kg?{window,document}:H_e,G_e=ha(JV);function K_e(e){var{children:t,environment:n}=e,[r,i]=an(null),a=gr(()=>{var s,u=r==null?void 0:r.ownerDocument,l=r==null?void 0:r.ownerDocument.defaultView,c=u?{document:u,window:l}:void 0,f=(s=n??c)!=null?s:JV;return f},[r,n]),o=!r&&!n;return Bt.createElement(G_e.Provider,{value:a},t,o&&Bt.createElement("span",{ref:s=>{s&&i(s)}}))}var X_e=e=>{var{children:t,colorModeManager:n,portalZIndex:r,resetCSS:i=!0,theme:a={},environment:o,cssVarsRoot:s}=e,u=le(K_e,{environment:o},t);return le(s2e,null,le(k_e,{theme:a,cssVarsRoot:s},le(RV,{colorModeManager:n,options:a.config},i&&le(_we,null),le(T_e,null),r?le(EV,{zIndex:r},u):u)))},QV={exports:{}};(function(e){(function(t){var n=/^\s+/,r=/\s+$/,i=0,a=t.round,o=t.min,s=t.max,u=t.random;function l(M,B){if(M=M||"",B=B||{},M instanceof l)return M;if(!(this instanceof l))return new l(M,B);var R=c(M);this._originalInput=M,this._r=R.r,this._g=R.g,this._b=R.b,this._a=R.a,this._roundA=a(100*this._a)/100,this._format=B.format||R.format,this._gradientType=B.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=R.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var M=this.toRgb();return(M.r*299+M.g*587+M.b*114)/1e3},getLuminance:function(){var M=this.toRgb(),B,R,X,ge,xe,ze;return B=M.r/255,R=M.g/255,X=M.b/255,B<=.03928?ge=B/12.92:ge=t.pow((B+.055)/1.055,2.4),R<=.03928?xe=R/12.92:xe=t.pow((R+.055)/1.055,2.4),X<=.03928?ze=X/12.92:ze=t.pow((X+.055)/1.055,2.4),.2126*ge+.7152*xe+.0722*ze},setAlpha:function(M){return this._a=G(M),this._roundA=a(100*this._a)/100,this},toHsv:function(){var M=p(this._r,this._g,this._b);return{h:M.h*360,s:M.s,v:M.v,a:this._a}},toHsvString:function(){var M=p(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.v*100);return this._a==1?"hsv("+B+", "+R+"%, "+X+"%)":"hsva("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHsl:function(){var M=d(this._r,this._g,this._b);return{h:M.h*360,s:M.s,l:M.l,a:this._a}},toHslString:function(){var M=d(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.l*100);return this._a==1?"hsl("+B+", "+R+"%, "+X+"%)":"hsla("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHex:function(M){return m(this._r,this._g,this._b,M)},toHexString:function(M){return"#"+this.toHex(M)},toHex8:function(M){return v(this._r,this._g,this._b,this._a,M)},toHex8String:function(M){return"#"+this.toHex8(M)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(K(this._r,255)*100)+"%",g:a(K(this._g,255)*100)+"%",b:a(K(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%)":"rgba("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:L[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(M){var B="#"+y(this._r,this._g,this._b,this._a),R=B,X=this._gradientType?"GradientType = 1, ":"";if(M){var ge=l(M);R="#"+y(ge._r,ge._g,ge._b,ge._a)}return"progid:DXImageTransform.Microsoft.gradient("+X+"startColorstr="+B+",endColorstr="+R+")"},toString:function(M){var B=!!M;M=M||this._format;var R=!1,X=this._a<1&&this._a>=0,ge=!B&&X&&(M==="hex"||M==="hex6"||M==="hex3"||M==="hex4"||M==="hex8"||M==="name");return ge?M==="name"&&this._a===0?this.toName():this.toRgbString():(M==="rgb"&&(R=this.toRgbString()),M==="prgb"&&(R=this.toPercentageRgbString()),(M==="hex"||M==="hex6")&&(R=this.toHexString()),M==="hex3"&&(R=this.toHexString(!0)),M==="hex4"&&(R=this.toHex8String(!0)),M==="hex8"&&(R=this.toHex8String()),M==="name"&&(R=this.toName()),M==="hsl"&&(R=this.toHslString()),M==="hsv"&&(R=this.toHsvString()),R||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(M,B){var R=M.apply(null,[this].concat([].slice.call(B)));return this._r=R._r,this._g=R._g,this._b=R._b,this.setAlpha(R._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(A,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(M,B){return M.apply(null,[this].concat([].slice.call(B)))},analogous:function(){return this._applyCombination(N,arguments)},complement:function(){return this._applyCombination(C,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},l.fromRatio=function(M,B){if(typeof M=="object"){var R={};for(var X in M)M.hasOwnProperty(X)&&(X==="a"?R[X]=M[X]:R[X]=Re(M[X]));M=R}return l(M,B)};function c(M){var B={r:0,g:0,b:0},R=1,X=null,ge=null,xe=null,ze=!1,Ke=!1;return typeof M=="string"&&(M=ae(M)),typeof M=="object"&&(V(M.r)&&V(M.g)&&V(M.b)?(B=f(M.r,M.g,M.b),ze=!0,Ke=String(M.r).substr(-1)==="%"?"prgb":"rgb"):V(M.h)&&V(M.s)&&V(M.v)?(X=Re(M.s),ge=Re(M.v),B=g(M.h,X,ge),ze=!0,Ke="hsv"):V(M.h)&&V(M.s)&&V(M.l)&&(X=Re(M.s),xe=Re(M.l),B=h(M.h,X,xe),ze=!0,Ke="hsl"),M.hasOwnProperty("a")&&(R=M.a)),R=G(R),{ok:ze,format:M.format||Ke,r:o(255,s(B.r,0)),g:o(255,s(B.g,0)),b:o(255,s(B.b,0)),a:R}}function f(M,B,R){return{r:K(M,255)*255,g:K(B,255)*255,b:K(R,255)*255}}function d(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=(X+ge)/2;if(X==ge)xe=ze=0;else{var Ze=X-ge;switch(ze=Ke>.5?Ze/(2-X-ge):Ze/(X+ge),X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,l:Ke}}function h(M,B,R){var X,ge,xe;M=K(M,360),B=K(B,100),R=K(R,100);function ze(Lt,Je,Zt){return Zt<0&&(Zt+=1),Zt>1&&(Zt-=1),Zt<1/6?Lt+(Je-Lt)*6*Zt:Zt<1/2?Je:Zt<2/3?Lt+(Je-Lt)*(2/3-Zt)*6:Lt}if(B===0)X=ge=xe=R;else{var Ke=R<.5?R*(1+B):R+B-R*B,Ze=2*R-Ke;X=ze(Ze,Ke,M+1/3),ge=ze(Ze,Ke,M),xe=ze(Ze,Ke,M-1/3)}return{r:X*255,g:ge*255,b:xe*255}}function p(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=X,Ze=X-ge;if(ze=X===0?0:Ze/X,X==ge)xe=0;else{switch(X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,v:Ke}}function g(M,B,R){M=K(M,360)*6,B=K(B,100),R=K(R,100);var X=t.floor(M),ge=M-X,xe=R*(1-B),ze=R*(1-ge*B),Ke=R*(1-(1-ge)*B),Ze=X%6,Lt=[R,ze,xe,xe,Ke,R][Ze],Je=[Ke,R,R,ze,xe,xe][Ze],Zt=[xe,xe,Ke,R,R,ze][Ze];return{r:Lt*255,g:Je*255,b:Zt*255}}function m(M,B,R,X){var ge=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return X&&ge[0].charAt(0)==ge[0].charAt(1)&&ge[1].charAt(0)==ge[1].charAt(1)&&ge[2].charAt(0)==ge[2].charAt(1)?ge[0].charAt(0)+ge[1].charAt(0)+ge[2].charAt(0):ge.join("")}function v(M,B,R,X,ge){var xe=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16)),Te(me(X))];return ge&&xe[0].charAt(0)==xe[0].charAt(1)&&xe[1].charAt(0)==xe[1].charAt(1)&&xe[2].charAt(0)==xe[2].charAt(1)&&xe[3].charAt(0)==xe[3].charAt(1)?xe[0].charAt(0)+xe[1].charAt(0)+xe[2].charAt(0)+xe[3].charAt(0):xe.join("")}function y(M,B,R,X){var ge=[Te(me(X)),Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return ge.join("")}l.equals=function(M,B){return!M||!B?!1:l(M).toRgbString()==l(B).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s-=B/100,R.s=ee(R.s),l(R)}function x(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s+=B/100,R.s=ee(R.s),l(R)}function w(M){return l(M).desaturate(100)}function S(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l+=B/100,R.l=ee(R.l),l(R)}function A(M,B){B=B===0?0:B||10;var R=l(M).toRgb();return R.r=s(0,o(255,R.r-a(255*-(B/100)))),R.g=s(0,o(255,R.g-a(255*-(B/100)))),R.b=s(0,o(255,R.b-a(255*-(B/100)))),l(R)}function _(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l-=B/100,R.l=ee(R.l),l(R)}function E(M,B){var R=l(M).toHsl(),X=(R.h+B)%360;return R.h=X<0?360+X:X,l(R)}function C(M){var B=l(M).toHsl();return B.h=(B.h+180)%360,l(B)}function k(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+120)%360,s:B.s,l:B.l}),l({h:(R+240)%360,s:B.s,l:B.l})]}function T(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+90)%360,s:B.s,l:B.l}),l({h:(R+180)%360,s:B.s,l:B.l}),l({h:(R+270)%360,s:B.s,l:B.l})]}function I(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+72)%360,s:B.s,l:B.l}),l({h:(R+216)%360,s:B.s,l:B.l})]}function N(M,B,R){B=B||6,R=R||30;var X=l(M).toHsl(),ge=360/R,xe=[l(M)];for(X.h=(X.h-(ge*B>>1)+720)%360;--B;)X.h=(X.h+ge)%360,xe.push(l(X));return xe}function O(M,B){B=B||6;for(var R=l(M).toHsv(),X=R.h,ge=R.s,xe=R.v,ze=[],Ke=1/B;B--;)ze.push(l({h:X,s:ge,v:xe})),xe=(xe+Ke)%1;return ze}l.mix=function(M,B,R){R=R===0?0:R||50;var X=l(M).toRgb(),ge=l(B).toRgb(),xe=R/100,ze={r:(ge.r-X.r)*xe+X.r,g:(ge.g-X.g)*xe+X.g,b:(ge.b-X.b)*xe+X.b,a:(ge.a-X.a)*xe+X.a};return l(ze)},l.readability=function(M,B){var R=l(M),X=l(B);return(t.max(R.getLuminance(),X.getLuminance())+.05)/(t.min(R.getLuminance(),X.getLuminance())+.05)},l.isReadable=function(M,B,R){var X=l.readability(M,B),ge,xe;switch(xe=!1,ge=Y(R),ge.level+ge.size){case"AAsmall":case"AAAlarge":xe=X>=4.5;break;case"AAlarge":xe=X>=3;break;case"AAAsmall":xe=X>=7;break}return xe},l.mostReadable=function(M,B,R){var X=null,ge=0,xe,ze,Ke,Ze;R=R||{},ze=R.includeFallbackColors,Ke=R.level,Ze=R.size;for(var Lt=0;Lt<B.length;Lt++)xe=l.readability(M,B[Lt]),xe>ge&&(ge=xe,X=l(B[Lt]));return l.isReadable(M,X,{level:Ke,size:Ze})||!ze?X:(R.includeFallbackColors=!1,l.mostReadable(M,["#fff","#000"],R))};var D=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=l.hexNames=W(D);function W(M){var B={};for(var R in M)M.hasOwnProperty(R)&&(B[M[R]]=R);return B}function G(M){return M=parseFloat(M),(isNaN(M)||M<0||M>1)&&(M=1),M}function K(M,B){he(M)&&(M="100%");var R=Oe(M);return M=o(B,s(0,parseFloat(M))),R&&(M=parseInt(M*B,10)/100),t.abs(M-B)<1e-6?1:M%B/parseFloat(B)}function ee(M){return o(1,s(0,M))}function ce(M){return parseInt(M,16)}function he(M){return typeof M=="string"&&M.indexOf(".")!=-1&&parseFloat(M)===1}function Oe(M){return typeof M=="string"&&M.indexOf("%")!=-1}function Te(M){return M.length==1?"0"+M:""+M}function Re(M){return M<=1&&(M=M*100+"%"),M}function me(M){return t.round(parseFloat(M)*255).toString(16)}function P(M){return ce(M)/255}var F=function(){var M="[-\\+]?\\d+%?",B="[-\\+]?\\d*\\.\\d+%?",R="(?:"+B+")|(?:"+M+")",X="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",ge="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";return{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+X),rgba:new RegExp("rgba"+ge),hsl:new RegExp("hsl"+X),hsla:new RegExp("hsla"+ge),hsv:new RegExp("hsv"+X),hsva:new RegExp("hsva"+ge),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function V(M){return!!F.CSS_UNIT.exec(M)}function ae(M){M=M.replace(n,"").replace(r,"").toLowerCase();var B=!1;if(D[M])M=D[M],B=!0;else if(M=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var R;return(R=F.rgb.exec(M))?{r:R[1],g:R[2],b:R[3]}:(R=F.rgba.exec(M))?{r:R[1],g:R[2],b:R[3],a:R[4]}:(R=F.hsl.exec(M))?{h:R[1],s:R[2],l:R[3]}:(R=F.hsla.exec(M))?{h:R[1],s:R[2],l:R[3],a:R[4]}:(R=F.hsv.exec(M))?{h:R[1],s:R[2],v:R[3]}:(R=F.hsva.exec(M))?{h:R[1],s:R[2],v:R[3],a:R[4]}:(R=F.hex8.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),a:P(R[4]),format:B?"name":"hex8"}:(R=F.hex6.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),format:B?"name":"hex"}:(R=F.hex4.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),a:P(R[4]+""+R[4]),format:B?"name":"hex8"}:(R=F.hex3.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),format:B?"name":"hex"}:!1}function Y(M){var B,R;return M=M||{level:"AA",size:"small"},B=(M.level||"AA").toUpperCase(),R=(M.size||"small").toLowerCase(),B!=="AA"&&B!=="AAA"&&(B="AA"),R!=="small"&&R!=="large"&&(R="small"),{level:B,size:R}}e.exports?e.exports=l:window.tinycolor=l})(Math)})(QV);var m_=QV.exports,ri=(e,t,n)=>{var r=n_(e,"colors."+t,t),i=m_(r).isValid();return i?r:n},Y_e=e=>t=>{var n=ri(t,e),r=m_(n).isDark();return r?"dark":"light"},Z_e=e=>t=>Y_e(e)(t)==="dark",rm=(e,t)=>n=>{var r=ri(n,e);return m_(r).setAlpha(t).toRgbString()};function eq(e,t){return e===void 0&&(e="1rem"),t===void 0&&(t="rgba(255, 255, 255, 0.15)"),{backgroundImage:`linear-gradient(
    45deg,
    `+t+` 25%,
    transparent 25%,
    transparent 50%,
    `+t+` 50%,
    `+t+` 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:e+" "+e}}function J_e(e){var t=m_.random().toHexString();return!e||Ewe(e)?t:e.string&&e.colors?eSe(e.string,e.colors):e.string&&!e.colors?Q_e(e.string):e.colors&&!e.string?tSe(e.colors):t}function Q_e(e){var t=0;if(e.length===0)return t.toString();for(var n=0;n<e.length;n+=1)t=e.charCodeAt(n)+((t<<5)-t),t=t&t;for(var r="#",i=0;i<3;i+=1){var a=t>>i*8&255;r+=("00"+a.toString(16)).substr(-2)}return r}function eSe(e,t){var n=0;if(e.length===0)return t[0];for(var r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]}function tSe(e){return e[Math.floor(Math.random()*e.length)]}function Ce(e,t){return n=>n.colorMode==="dark"?t:e}function yy(e){var{orientation:t,vertical:n,horizontal:r}=e;return t?t==="vertical"?n:r:{}}function qD(){return qD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qD.apply(this,arguments)}var nSe=e=>(bD({condition:!0,message:["[chakra-ui]: createBreakpoints(...) will be deprecated pretty soon","simply pass the breakpoints as an object. Remove the createBreakpoint(..) call"].join("")}),qD({base:"0em"},e));function xh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rSe{constructor(t){var n=this;this.name=t,xh(this,"map",{}),xh(this,"called",!1),xh(this,"assert",()=>{if(!this.called){this.called=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}),xh(this,"parts",function(){n.assert();for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o of i)n.map[o]=n.toPart(o);return n}),xh(this,"extend",function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o of i)o in n.map||(n.map[o]=n.toPart(o));return n}),xh(this,"toPart",r=>{var i=["container","root"].includes(r??"")?[this.name]:[this.name,r],a=i.filter(Boolean).join("__"),o="chakra-"+a,s={className:o,selector:"."+o,toString:()=>r};return s}),xh(this,"__type",{})}get selectors(){var t=Object.fromEntries(Object.entries(this.map).map(n=>{var[r,i]=n;return[r,i.selector]}));return t}get classNames(){var t=Object.fromEntries(Object.entries(this.map).map(n=>{var[r,i]=n;return[r,i.className]}));return t}get keys(){return Object.keys(this.map)}}function Kn(e){return new rSe(e)}function tq(e){return Ps(e)&&e.reference?e.reference:String(e)}var v_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(tq).join(" "+t+" ").replace(/calc/g,"")},nq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("+",...n)+")"},rq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("-",...n)+")"},HD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("*",...n)+")"},iq=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+v_("/",...n)+")"},aq=e=>{var t=tq(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:HD(t,-1)},Jl=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(nq(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(rq(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(HD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jl(iq(e,...r))},negate:()=>Jl(aq(e)),toString:()=>e.toString()}),{add:nq,subtract:rq,multiply:HD,divide:iq,negate:aq});function iSe(e){return!Number.isInteger(parseFloat(e.toString()))}function aSe(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function oq(e){var t=aSe(e.toString());return t.includes("\\.")?e:iSe(e)?t.replace(".","\\."):e}function oSe(e,t){return t===void 0&&(t=""),[t,oq(e)].filter(Boolean).join("-")}function sSe(e,t){return"var("+oq(e)+(t?", "+t:"")+")"}function uSe(e,t){return t===void 0&&(t=""),"--"+oSe(e,t)}function ko(e,t){var n=uSe(e,t==null?void 0:t.prefix);return{variable:n,reference:sSe(n,lSe(t==null?void 0:t.fallback))}}function lSe(e){return typeof e=="string"?e:e==null?void 0:e.reference}var cSe=Kn("accordion").parts("container","item","button","panel").extend("icon"),fSe=Kn("alert").parts("title","description","container").extend("icon"),dSe=Kn("avatar").parts("label","badge","container").extend("excessLabel","group"),hSe=Kn("breadcrumb").parts("link","item").extend("separator");Kn("button").parts();var pSe=Kn("checkbox").parts("control","icon").extend("label");Kn("progress").parts("track","filledTrack").extend("label");var gSe=Kn("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),mSe=Kn("editable").parts("preview","input"),vSe=Kn("form").parts("container","requiredIndicator","helperText"),ySe=Kn("formError").parts("text","icon"),bSe=Kn("input").parts("addon","field","element"),xSe=Kn("list").parts("container","item","icon"),wSe=Kn("menu").parts("button","list","item").extend("groupTitle","command","divider"),_Se=Kn("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),SSe=Kn("numberinput").parts("root","field","stepperGroup","stepper");Kn("pininput").parts("field");var ESe=Kn("popover").parts("content","header","body","footer").extend("popper","arrow"),ASe=Kn("progress").parts("label","filledTrack","track"),CSe=Kn("radio").parts("container","control","label"),kSe=Kn("select").parts("field","icon"),TSe=Kn("slider").parts("container","track","thumb","filledTrack"),OSe=Kn("stat").parts("container","label","helpText","number","icon"),ISe=Kn("switch").parts("container","track","thumb"),NSe=Kn("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),DSe=Kn("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),RSe=Kn("tag").parts("container","label","closeButton"),FSe={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},MSe={transitionProperty:"common",transitionDuration:"normal",fontSize:"1rem",_focus:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:4,py:2},PSe={pt:2,px:4,pb:5},$Se={fontSize:"1.25em"},LSe={container:FSe,button:MSe,panel:PSe,icon:$Se},BSe={parts:cSe.keys,baseStyle:LSe},zSe={container:{px:4,py:3},title:{fontWeight:"bold",lineHeight:6,marginEnd:2},description:{lineHeight:6},icon:{flexShrink:0,marginEnd:3,w:5,h:6}};function GD(e){var{theme:t,colorScheme:n}=e,r=ri(t,n+".100",n),i=rm(n+".200",.16)(t);return Ce(r,i)(e)}var jSe=e=>{var{colorScheme:t}=e;return{container:{bg:GD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},USe=e=>{var{colorScheme:t}=e;return{container:{paddingStart:3,borderStartWidth:"4px",borderStartColor:Ce(t+".500",t+".200")(e),bg:GD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},WSe=e=>{var{colorScheme:t}=e;return{container:{pt:2,borderTopWidth:"4px",borderTopColor:Ce(t+".500",t+".200")(e),bg:GD(e)},icon:{color:Ce(t+".500",t+".200")(e)}}},VSe=e=>{var{colorScheme:t}=e;return{container:{bg:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e)}}},qSe={subtle:jSe,"left-accent":USe,"top-accent":WSe,solid:VSe},HSe={variant:"subtle",colorScheme:"blue"},GSe={parts:fSe.keys,baseStyle:zSe,variants:qSe,defaultProps:HSe},sq={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"};function KD(){return KD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KD.apply(this,arguments)}var KSe={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem"},XSe={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},YSe=KD({},sq,KSe,{container:XSe}),uq=YSe,ZSe=e=>({transform:"translate(25%, 25%)",borderRadius:"full",border:"0.2em solid",borderColor:Ce("white","gray.800")(e)}),JSe=e=>({bg:Ce("gray.200","whiteAlpha.400")(e)}),QSe=e=>{var{name:t,theme:n}=e,r=t?J_e({string:t}):"gray.400",i=Z_e(r)(n),a="white";i||(a="gray.800");var o=Ce("white","gray.800")(e);return{bg:r,color:a,borderColor:o,verticalAlign:"top"}},eEe=e=>({badge:ZSe(e),excessLabel:JSe(e),container:QSe(e)});function mf(e){var t=uq[e];return{container:{width:e,height:e,fontSize:"calc("+(t??e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(t??e)+" / 2.5)",lineHeight:e!=="100%"?t??e:void 0}}}var tEe={"2xs":mf("4"),xs:mf("6"),sm:mf("8"),md:mf("12"),lg:mf("16"),xl:mf("24"),"2xl":mf("32"),full:mf("100%")},nEe={size:"md"},rEe={parts:dSe.keys,baseStyle:eEe,sizes:tEe,defaultProps:nEe},iEe={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"},aEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".500",.6)(n);return{bg:Ce(t+".500",r)(e),color:Ce("white","whiteAlpha.800")(e)}},oEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".200",.16)(n);return{bg:Ce(t+".100",r)(e),color:Ce(t+".800",t+".200")(e)}},sEe=e=>{var{colorScheme:t,theme:n}=e,r=rm(t+".200",.8)(n),i=ri(n,t+".500"),a=Ce(i,r)(e);return{color:a,boxShadow:"inset 0 0 0px 1px "+a}},uEe={solid:aEe,subtle:oEe,outline:sEe},lEe={variant:"subtle",colorScheme:"gray"},by={baseStyle:iEe,variants:uEe,defaultProps:lEe},cEe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},fEe={link:cEe},dEe={parts:hSe.keys,baseStyle:fEe};function XD(){return XD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XD.apply(this,arguments)}var hEe={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},lq=e=>{var{colorScheme:t,theme:n}=e;if(t==="gray")return{color:Ce("inherit","whiteAlpha.900")(e),_hover:{bg:Ce("gray.100","whiteAlpha.200")(e)},_active:{bg:Ce("gray.200","whiteAlpha.300")(e)}};var r=rm(t+".200",.12)(n),i=rm(t+".200",.24)(n);return{color:Ce(t+".600",t+".200")(e),bg:"transparent",_hover:{bg:Ce(t+".50",r)(e)},_active:{bg:Ce(t+".100",i)(e)}}},pEe=e=>{var{colorScheme:t}=e,n=Ce("gray.200","whiteAlpha.300")(e);return XD({border:"1px solid",borderColor:t==="gray"?n:"currentColor"},lq(e))},gEe={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},mEe=e=>{var t,{colorScheme:n}=e;if(n==="gray"){var r=Ce("gray.100","whiteAlpha.200")(e);return{bg:r,_hover:{bg:Ce("gray.200","whiteAlpha.300")(e),_disabled:{bg:r}},_active:{bg:Ce("gray.300","whiteAlpha.400")(e)}}}var{bg:i=n+".500",color:a="white",hoverBg:o=n+".600",activeBg:s=n+".700"}=(t=gEe[n])!=null?t:{},u=Ce(i,n+".200")(e);return{bg:u,color:Ce(a,"gray.800")(e),_hover:{bg:Ce(o,n+".300")(e),_disabled:{bg:u}},_active:{bg:Ce(s,n+".400")(e)}}},vEe=e=>{var{colorScheme:t}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Ce(t+".500",t+".200")(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Ce(t+".700",t+".500")(e)}}},yEe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0},bEe={ghost:lq,outline:pEe,solid:mEe,link:vEe,unstyled:yEe},xEe={lg:{h:12,minW:12,fontSize:"lg",px:6},md:{h:10,minW:10,fontSize:"md",px:4},sm:{h:8,minW:8,fontSize:"sm",px:3},xs:{h:6,minW:6,fontSize:"xs",px:2}},wEe={variant:"solid",size:"md",colorScheme:"gray"},_Ee={baseStyle:hEe,variants:bEe,sizes:xEe,defaultProps:wEe},SEe=e=>{var{colorScheme:t}=e;return{w:"100%",transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Ce(t+".500",t+".200")(e),borderColor:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e),_hover:{bg:Ce(t+".600",t+".300")(e),borderColor:Ce(t+".600",t+".300")(e)},_disabled:{borderColor:Ce("gray.200","transparent")(e),bg:Ce("gray.200","whiteAlpha.300")(e),color:Ce("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Ce(t+".500",t+".200")(e),borderColor:Ce(t+".500",t+".200")(e),color:Ce("white","gray.900")(e)},_disabled:{bg:Ce("gray.100","whiteAlpha.100")(e),borderColor:Ce("gray.100","transparent")(e)},_focus:{boxShadow:"outline"},_invalid:{borderColor:Ce("red.500","red.300")(e)}}},EEe={userSelect:"none",_disabled:{opacity:.4}},AEe={transitionProperty:"transform",transitionDuration:"normal"},CEe=e=>({icon:AEe,control:SEe(e),label:EEe}),kEe={sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45rem"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625rem"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625rem"}}},TEe={size:"md",colorScheme:"blue"},YD={parts:pSe.keys,baseStyle:CEe,sizes:kEe,defaultProps:TEe},xy=ko("close-button-size"),OEe=e=>{var t=Ce("blackAlpha.100","whiteAlpha.100")(e),n=Ce("blackAlpha.200","whiteAlpha.200")(e);return{w:[xy.reference],h:[xy.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{bg:t},_active:{bg:n},_focus:{boxShadow:"outline"}}},IEe={lg:{[xy.variable]:"40px",fontSize:"16px"},md:{[xy.variable]:"32px",fontSize:"12px"},sm:{[xy.variable]:"24px",fontSize:"10px"}},NEe={size:"md"},DEe={baseStyle:OEe,sizes:IEe,defaultProps:NEe},{variants:REe,defaultProps:FEe}=by,MEe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},PEe={baseStyle:MEe,variants:REe,defaultProps:FEe},$Ee={w:"100%",mx:"auto",maxW:"60ch",px:"1rem"},LEe={baseStyle:$Ee},BEe={opacity:.6,borderColor:"inherit"},zEe={borderStyle:"solid"},jEe={borderStyle:"dashed"},UEe={solid:zEe,dashed:jEe},WEe={variant:"solid"},VEe={baseStyle:BEe,variants:UEe,defaultProps:WEe};function ZD(){return ZD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZD.apply(this,arguments)}function im(e){return e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}}}var qEe={bg:"blackAlpha.600",zIndex:"overlay"},HEe={display:"flex",zIndex:"modal",justifyContent:"center"},GEe=e=>{var{isFullHeight:t}=e;return ZD({},t&&{height:"100vh"},{zIndex:"modal",maxH:"100vh",bg:Ce("white","gray.700")(e),color:"inherit",boxShadow:Ce("lg","dark-lg")(e)})},KEe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},XEe={position:"absolute",top:2,insetEnd:3},YEe={px:6,py:2,flex:1,overflow:"auto"},ZEe={px:6,py:4},JEe=e=>({overlay:qEe,dialogContainer:HEe,dialog:GEe(e),header:KEe,closeButton:XEe,body:YEe,footer:ZEe}),QEe={xs:im("xs"),sm:im("md"),md:im("lg"),lg:im("2xl"),xl:im("4xl"),full:im("full")},eAe={size:"xs"},tAe={parts:gSe.keys,baseStyle:JEe,sizes:QEe,defaultProps:eAe},nAe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal"},rAe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal",width:"full",_focus:{boxShadow:"outline"},_placeholder:{opacity:.6}},iAe={preview:nAe,input:rAe},aAe={parts:mSe.keys,baseStyle:iAe},oAe=e=>({marginStart:1,color:Ce("red.500","red.300")(e)}),sAe=e=>({mt:2,color:Ce("gray.500","whiteAlpha.600")(e),lineHeight:"normal",fontSize:"sm"}),uAe=e=>({container:{width:"100%",position:"relative"},requiredIndicator:oAe(e),helperText:sAe(e)}),lAe={parts:vSe.keys,baseStyle:uAe},cAe={fontSize:"md",marginEnd:3,mb:2,fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},fAe={baseStyle:cAe},dAe={fontFamily:"heading",fontWeight:"bold"},hAe={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},pAe={size:"xl"},gAe={baseStyle:dAe,sizes:hAe,defaultProps:pAe},mAe={field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal"}},vf={lg:{fontSize:"lg",px:4,h:12,borderRadius:"md"},md:{fontSize:"md",px:4,h:10,borderRadius:"md"},sm:{fontSize:"sm",px:3,h:8,borderRadius:"sm"},xs:{fontSize:"xs",px:2,h:6,borderRadius:"sm"}},vAe={lg:{field:vf.lg,addon:vf.lg},md:{field:vf.md,addon:vf.md},sm:{field:vf.sm,addon:vf.sm},xs:{field:vf.xs,addon:vf.xs}};function JD(e){var{focusBorderColor:t,errorBorderColor:n}=e;return{focusBorderColor:t||Ce("blue.500","blue.300")(e),errorBorderColor:n||Ce("red.500","red.300")(e)}}var yAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=JD(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Ce("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ri(t,r),boxShadow:"0 0 0 1px "+ri(t,r)},_focus:{zIndex:1,borderColor:ri(t,n),boxShadow:"0 0 0 1px "+ri(t,n)}},addon:{border:"1px solid",borderColor:Ce("inherit","whiteAlpha.50")(e),bg:Ce("gray.100","whiteAlpha.300")(e)}}},bAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=JD(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Ce("gray.100","whiteAlpha.50")(e),_hover:{bg:Ce("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ri(t,r)},_focus:{bg:"transparent",borderColor:ri(t,n)}},addon:{border:"2px solid",borderColor:"transparent",bg:Ce("gray.100","whiteAlpha.50")(e)}}},xAe=e=>{var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=JD(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:ri(t,r),boxShadow:"0px 1px 0px 0px "+ri(t,r)},_focus:{borderColor:ri(t,n),boxShadow:"0px 1px 0px 0px "+ri(t,n)}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent"}}},wAe={field:{bg:"transparent",px:0,height:"auto"},addon:{bg:"transparent",px:0,height:"auto"}},_Ae={outline:yAe,filled:bAe,flushed:xAe,unstyled:wAe},SAe={size:"md",variant:"outline"},cr={parts:bSe.keys,baseStyle:mAe,sizes:vAe,variants:_Ae,defaultProps:SAe},EAe=e=>({bg:Ce("gray.100","whiteAlpha")(e),borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"}),AAe={baseStyle:EAe},CAe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},kAe={baseStyle:CAe},TAe={marginEnd:"0.5rem",display:"inline",verticalAlign:"text-bottom"},OAe={container:{},item:{},icon:TAe},IAe={parts:xSe.keys,baseStyle:OAe},NAe=e=>({bg:Ce("#fff","gray.700")(e),boxShadow:Ce("sm","dark-lg")(e),color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px"}),DAe=e=>({py:"0.4rem",px:"0.8rem",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:Ce("gray.100","whiteAlpha.100")(e)},_active:{bg:Ce("gray.200","whiteAlpha.200")(e)},_expanded:{bg:Ce("gray.100","whiteAlpha.100")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}),RAe={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},FAe={opacity:.6},MAe={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"0.5rem",opacity:.6},PAe={transitionProperty:"common",transitionDuration:"normal"},$Ae=e=>({button:PAe,list:NAe(e),item:DAe(e),groupTitle:RAe,command:FAe,divider:MAe}),LAe={parts:wSe.keys,baseStyle:$Ae},BAe={bg:"blackAlpha.600",zIndex:"modal"},zAe=e=>{var{isCentered:t,scrollBehavior:n}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:t?"center":"flex-start",overflow:n==="inside"?"hidden":"auto"}},jAe=e=>{var{scrollBehavior:t}=e;return{borderRadius:"md",bg:Ce("white","gray.700")(e),color:"inherit",my:"3.75rem",zIndex:"modal",maxH:t==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:Ce("lg","dark-lg")(e)}},UAe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},WAe={position:"absolute",top:2,insetEnd:3},VAe=e=>{var{scrollBehavior:t}=e;return{px:6,py:2,flex:1,overflow:t==="inside"?"auto":void 0}},qAe={px:6,py:4},HAe=e=>({overlay:BAe,dialogContainer:zAe(e),dialog:jAe(e),header:UAe,closeButton:WAe,body:VAe(e),footer:qAe});function Bs(e){return e==="full"?{dialog:{maxW:"100vw",minH:"100vh",my:0}}:{dialog:{maxW:e}}}var GAe={xs:Bs("xs"),sm:Bs("sm"),md:Bs("md"),lg:Bs("lg"),xl:Bs("xl"),"2xl":Bs("2xl"),"3xl":Bs("3xl"),"4xl":Bs("4xl"),"5xl":Bs("5xl"),"6xl":Bs("6xl"),full:Bs("full")},KAe={size:"md"},XAe={parts:_Se.keys,baseStyle:HAe,sizes:GAe,defaultProps:KAe},YAe={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2","3":".75rem","4":"1rem","5":"1.25rem","6":"1.5rem","7":"1.75rem","8":"2rem","9":"2.25rem","10":"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},cq=YAe,fq,dq;function QD(){return QD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},QD.apply(this,arguments)}var{variants:ZAe,defaultProps:JAe}=cr,eR=ko("number-input-stepper-width"),hq=ko("number-input-input-padding"),QAe=Jl(eR).add("0.5rem").toString(),eCe={[eR.variable]:"24px",[hq.variable]:QAe},tCe=(fq=(dq=cr.baseStyle)==null?void 0:dq.field)!=null?fq:{},nCe={width:[eR.reference]},rCe=e=>({borderStart:"1px solid",borderStartColor:Ce("inherit","whiteAlpha.300")(e),color:Ce("inherit","whiteAlpha.800")(e),_active:{bg:Ce("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}),iCe=e=>({root:eCe,field:tCe,stepperGroup:nCe,stepper:rCe(e)});function y_(e){var t,n,r=cr.sizes[e],i={lg:"md",md:"md",sm:"sm",xs:"sm"},a=(t=(n=r.field)==null?void 0:n.fontSize)!=null?t:"md",o=cq.fontSizes[a.toString()];return{field:QD({},r.field,{paddingInlineEnd:hq.reference,verticalAlign:"top"}),stepper:{fontSize:Jl(o).multiply(.75).toString(),_first:{borderTopEndRadius:i[e]},_last:{borderBottomEndRadius:i[e],mt:"-1px",borderTopWidth:1}}}}var aCe={xs:y_("xs"),sm:y_("sm"),md:y_("md"),lg:y_("lg")},oCe={parts:SSe.keys,baseStyle:iCe,sizes:aCe,variants:ZAe,defaultProps:JAe},pq;function tR(){return tR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tR.apply(this,arguments)}var sCe=tR({},cr.baseStyle.field,{textAlign:"center"}),uCe={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},lCe={outline:e=>{var t;return(t=cr.variants.outline(e).field)!=null?t:{}},flushed:e=>{var t;return(t=cr.variants.flushed(e).field)!=null?t:{}},filled:e=>{var t;return(t=cr.variants.filled(e).field)!=null?t:{}},unstyled:(pq=cr.variants.unstyled.field)!=null?pq:{}},cCe=cr.defaultProps,fCe={baseStyle:sCe,sizes:uCe,variants:lCe,defaultProps:cCe},nR=ko("popper-bg"),dCe=ko("popper-arrow-bg"),hCe=ko("popper-arrow-shadow-color"),pCe={zIndex:10},gCe=e=>{var t=Ce("white","gray.700")(e),n=Ce("gray.200","whiteAlpha.300")(e);return{[nR.variable]:"colors."+t,bg:nR.reference,[dCe.variable]:nR.reference,[hCe.variable]:"colors."+n,width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focus:{outline:0,boxShadow:"outline"}}},mCe={px:3,py:2,borderBottomWidth:"1px"},vCe={px:3,py:2},yCe={px:3,py:2,borderTopWidth:"1px"},bCe=e=>({popper:pCe,content:gCe(e),header:mCe,body:vCe,footer:yCe,arrow:{}}),xCe={parts:ESe.keys,baseStyle:bCe};function b_(){return b_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b_.apply(this,arguments)}function wCe(e){var{colorScheme:t,theme:n,isIndeterminate:r,hasStripe:i}=e,a=Ce(eq(),eq("1rem","rgba(0,0,0,0.1)"))(e),o=Ce(t+".500",t+".200")(e),s=`linear-gradient(
    to right,
    transparent 0%,
    `+ri(n,o)+` 50%,
    transparent 100%
  )`,u=!r&&i;return b_({},u&&a,r?{bgImage:s}:{bgColor:o})}var _Ce={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},SCe=e=>({bg:Ce("gray.100","whiteAlpha.300")(e)}),ECe=e=>b_({transitionProperty:"common",transitionDuration:"slow"},wCe(e)),ACe=e=>({label:_Ce,filledTrack:ECe(e),track:SCe(e)}),CCe={xs:{track:{h:"0.25rem"}},sm:{track:{h:"0.5rem"}},md:{track:{h:"0.75rem"}},lg:{track:{h:"1rem"}}},kCe={size:"md",colorScheme:"blue"},TCe={parts:ASe.keys,sizes:CCe,baseStyle:ACe,defaultProps:kCe};function x_(){return x_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x_.apply(this,arguments)}var OCe=e=>{var{control:t={}}=YD.baseStyle(e);return x_({},t,{borderRadius:"full",_checked:x_({},t._checked,{_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}})})},ICe=e=>({label:YD.baseStyle(e).label,control:OCe(e)}),NCe={md:{control:{w:4,h:4},label:{fontSize:"md"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"}},sm:{control:{width:3,height:3},label:{fontSize:"sm"}}},DCe={size:"md",colorScheme:"blue"},RCe={parts:CSe.keys,baseStyle:ICe,sizes:NCe,defaultProps:DCe};function wy(){return wy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wy.apply(this,arguments)}var FCe=e=>wy({},cr.baseStyle.field,{bg:Ce("white","gray.700")(e),appearance:"none",paddingBottom:"1px",lineHeight:"normal","> option, > optgroup":{bg:Ce("white","gray.700")(e)}}),MCe={width:"1.5rem",height:"100%",insetEnd:"0.5rem",position:"relative",color:"currentColor",fontSize:"1.25rem",_disabled:{opacity:.5}},PCe=e=>({field:FCe(e),icon:MCe}),$Ce=wy({},cr.sizes,{xs:wy({},cr.sizes.xs,{icon:{insetEnd:"0.25rem"}})}),LCe={parts:kSe.keys,baseStyle:PCe,sizes:$Ce,variants:cr.variants,defaultProps:cr.defaultProps},BCe=(e,t)=>cV({from:{borderColor:e,background:e},to:{borderColor:t,background:t}}),zCe=e=>{var t=Ce("gray.100","gray.800")(e),n=Ce("gray.400","gray.600")(e),{startColor:r=t,endColor:i=n,speed:a,theme:o}=e,s=ri(o,r),u=ri(o,i);return{opacity:.7,borderRadius:"2px",borderColor:s,background:u,animation:a+"s linear infinite alternate "+BCe(s,u)}},jCe={baseStyle:zCe},UCe=e=>({borderRadius:"md",fontWeight:"semibold",_focus:{boxShadow:"outline",padding:"1rem",position:"fixed",top:"1.5rem",insetStart:"1.5rem",bg:Ce("white","gray.700")(e)}}),WCe={baseStyle:UCe};function w_(){return w_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w_.apply(this,arguments)}function VCe(e){return yy({orientation:e.orientation,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})}var qCe=e=>{var{orientation:t}=e;return w_({_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"}},yy({orientation:t,vertical:{h:"100%"},horizontal:{w:"100%"}}))},HCe=e=>({borderRadius:"sm",bg:Ce("gray.200","whiteAlpha.200")(e),_disabled:{bg:Ce("gray.300","whiteAlpha.300")(e)}}),GCe=e=>w_({zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{bg:"gray.300"}},VCe(e)),KCe=e=>{var{colorScheme:t}=e;return{bg:Ce(t+".500",t+".200")(e)}},XCe=e=>({container:qCe(e),track:HCe(e),thumb:GCe(e),filledTrack:KCe(e)}),YCe=e=>({thumb:{w:"16px",h:"16px"},track:yy({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}),ZCe=e=>({thumb:{w:"14px",h:"14px"},track:yy({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}),JCe=e=>({thumb:{w:"10px",h:"10px"},track:yy({orientation:e.orientation,horizontal:{h:"2px"},vertical:{w:"2px"}})}),QCe={lg:YCe,md:ZCe,sm:JCe},eke={size:"md",colorScheme:"blue"},tke={parts:TSe.keys,sizes:QCe,baseStyle:XCe,defaultProps:eke},wh=ko("spinner-size"),nke={width:[wh.reference],height:[wh.reference]},rke={xs:{[wh.variable]:"0.75rem"},sm:{[wh.variable]:"1rem"},md:{[wh.variable]:"1.5rem"},lg:{[wh.variable]:"2rem"},xl:{[wh.variable]:"3rem"}},ike={size:"md"},ake={baseStyle:nke,sizes:rke,defaultProps:ike},oke={fontWeight:"medium"},ske={opacity:.8,marginBottom:2},uke={verticalAlign:"baseline",fontWeight:"semibold"},lke={marginEnd:1,w:"14px",h:"14px",verticalAlign:"middle"},cke={container:{},label:oke,helpText:ske,number:uke,icon:lke},fke={md:{label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}}},dke={size:"md"},hke={parts:OSe.keys,baseStyle:cke,sizes:fke,defaultProps:dke},_y=ko("switch-track-width"),_h=ko("switch-track-height"),rR=ko("switch-track-diff"),pke=Jl.subtract(_y,_h),iR=ko("switch-thumb-x"),gke=e=>{var{colorScheme:t}=e;return{borderRadius:"full",p:"2px",width:[_y.reference],height:[_h.reference],transitionProperty:"common",transitionDuration:"fast",bg:Ce("gray.300","whiteAlpha.400")(e),_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{bg:Ce(t+".500",t+".200")(e)}}},mke={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[_h.reference],height:[_h.reference],_checked:{transform:"translateX("+iR.reference+")"}},vke=e=>({container:{[rR.variable]:pke,[iR.variable]:rR.reference,_rtl:{[iR.variable]:Jl(rR).negate().toString()}},track:gke(e),thumb:mke}),yke={sm:{container:{[_y.variable]:"1.375rem",[_h.variable]:"0.75rem"}},md:{container:{[_y.variable]:"1.875rem",[_h.variable]:"1rem"}},lg:{container:{[_y.variable]:"2.875rem",[_h.variable]:"1.5rem"}}},bke={size:"md",colorScheme:"blue"},xke={parts:ISe.keys,baseStyle:vke,sizes:yke,defaultProps:bke};function am(){return am=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},am.apply(this,arguments)}var wke={table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}},__={"&[data-is-numeric=true]":{textAlign:"end"}},_ke=e=>{var{colorScheme:t}=e;return{th:am({color:Ce("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},__),td:am({borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},__),caption:{color:Ce("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},Ske=e=>{var{colorScheme:t}=e;return{th:am({color:Ce("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},__),td:am({borderBottom:"1px",borderColor:Ce(t+".100",t+".700")(e)},__),caption:{color:Ce("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Ce(t+".100",t+".700")(e)},td:{background:Ce(t+".100",t+".700")(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},Eke={simple:_ke,striped:Ske,unstyled:{}},Ake={sm:{th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}},md:{th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}},lg:{th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}}},Cke={variant:"simple",size:"md",colorScheme:"gray"},kke={parts:NSe.keys,baseStyle:wke,variants:Eke,sizes:Ake,defaultProps:Cke},Tke=e=>{var{orientation:t}=e;return{display:t==="vertical"?"flex":"block"}},Oke=e=>{var{isFitted:t}=e;return{flex:t?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focus:{zIndex:1,boxShadow:"outline"}}},Ike=e=>{var{align:t="start",orientation:n}=e,r={end:"flex-end",center:"center",start:"flex-start"};return{justifyContent:r[t],flexDirection:n==="vertical"?"column":"row"}},Nke={p:4},Dke=e=>({root:Tke(e),tab:Oke(e),tablist:Ike(e),tabpanel:Nke}),Rke={sm:{tab:{py:1,px:4,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:4}}},Fke=e=>{var{colorScheme:t,orientation:n}=e,r=n==="vertical",i=n==="vertical"?"borderStart":"borderBottom",a=r?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[a]:"-2px",_selected:{color:Ce(t+".600",t+".300")(e),borderColor:"currentColor"},_active:{bg:Ce("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}},Mke=e=>{var{colorScheme:t}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",_selected:{color:Ce(t+".600",t+".300")(e),borderColor:"inherit",borderBottomColor:Ce("white","gray.800")(e)}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}},Pke=e=>{var{colorScheme:t}=e;return{tab:{border:"1px solid",borderColor:"inherit",bg:Ce("gray.50","whiteAlpha.50")(e),mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{bg:Ce("#fff","gray.800")(e),color:Ce(t+".600",t+".300")(e),borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}},$ke=e=>{var{colorScheme:t,theme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:ri(n,t+".700"),bg:ri(n,t+".100")}}}},Lke=e=>{var{colorScheme:t}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:Ce("gray.600","inherit")(e),_selected:{color:Ce("#fff","gray.800")(e),bg:Ce(t+".600",t+".300")(e)}}}},Bke={},zke={line:Fke,enclosed:Mke,"enclosed-colored":Pke,"soft-rounded":$ke,"solid-rounded":Lke,unstyled:Bke},jke={size:"md",variant:"line",colorScheme:"blue"},Uke={parts:DSe.keys,baseStyle:Dke,sizes:Rke,variants:zke,defaultProps:jke},Wke={fontWeight:"medium",lineHeight:1.2,outline:0,_focus:{boxShadow:"outline"}},Vke={lineHeight:1.2,overflow:"visible"},qke={fontSize:"18px",w:"1.25rem",h:"1.25rem",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"0.375rem",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focus:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},Hke={container:Wke,label:Vke,closeButton:qke},Gke={sm:{container:{minH:"1.25rem",minW:"1.25rem",fontSize:"xs",px:2,borderRadius:"md"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}},md:{container:{minH:"1.5rem",minW:"1.5rem",fontSize:"sm",borderRadius:"md",px:2}},lg:{container:{minH:8,minW:8,fontSize:"md",borderRadius:"md",px:3}}},Kke={subtle:e=>({container:by.variants.subtle(e)}),solid:e=>({container:by.variants.solid(e)}),outline:e=>({container:by.variants.outline(e)})},Xke={size:"md",variant:"subtle",colorScheme:"gray"},Yke={parts:RSe.keys,variants:Kke,baseStyle:Hke,sizes:Gke,defaultProps:Xke},gq,mq,vq,yq,bq;function aR(){return aR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aR.apply(this,arguments)}var Zke=aR({},cr.baseStyle.field,{paddingY:"8px",minHeight:"80px",lineHeight:"short",verticalAlign:"top"}),Jke={outline:e=>{var t;return(t=cr.variants.outline(e).field)!=null?t:{}},flushed:e=>{var t;return(t=cr.variants.flushed(e).field)!=null?t:{}},filled:e=>{var t;return(t=cr.variants.filled(e).field)!=null?t:{}},unstyled:(gq=cr.variants.unstyled.field)!=null?gq:{}},Qke={xs:(mq=cr.sizes.xs.field)!=null?mq:{},sm:(vq=cr.sizes.sm.field)!=null?vq:{},md:(yq=cr.sizes.md.field)!=null?yq:{},lg:(bq=cr.sizes.lg.field)!=null?bq:{}},eTe={size:"md",variant:"outline"},tTe={baseStyle:Zke,sizes:Qke,variants:Jke,defaultProps:eTe},oR=ko("tooltip-bg"),nTe=ko("popper-arrow-bg"),rTe=e=>{var t=Ce("gray.700","gray.300")(e);return{[oR.variable]:"colors."+t,px:"8px",py:"2px",bg:[oR.reference],[nTe.variable]:[oR.reference],color:Ce("whiteAlpha.900","gray.900")(e),borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"320px",zIndex:"tooltip"}},iTe={baseStyle:rTe},aTe=e=>({color:Ce("red.500","red.300")(e),mt:2,fontSize:"sm"}),oTe=e=>({marginEnd:"0.5em",color:Ce("red.500","red.300")(e)}),sTe=e=>({text:aTe(e),icon:oTe(e)}),uTe={parts:ySe.keys,baseStyle:sTe},lTe={Accordion:BSe,Alert:GSe,Avatar:rEe,Badge:by,Breadcrumb:dEe,Button:_Ee,Checkbox:YD,CloseButton:DEe,Code:PEe,Container:LEe,Divider:VEe,Drawer:tAe,Editable:aAe,Form:lAe,FormLabel:fAe,Heading:gAe,Input:cr,Kbd:AAe,Link:kAe,List:IAe,Menu:LAe,Modal:XAe,NumberInput:oCe,PinInput:fCe,Popover:xCe,Progress:TCe,Radio:RCe,Select:LCe,Skeleton:jCe,SkipLink:WCe,Slider:tke,Spinner:ake,Stat:hke,Switch:xke,Table:kke,Tabs:Uke,Tag:Yke,Textarea:tTe,Tooltip:iTe,FormError:uTe},cTe={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},fTe=cTe,dTe=nSe({sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"}),hTe=dTe,pTe={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},gTe=pTe,mTe={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},vTe=mTe,yTe={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},bTe=yTe,xTe={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},wTe={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},_Te={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},STe={property:xTe,easing:wTe,duration:_Te},ETe=STe,ATe={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},CTe=ATe,kTe={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},TTe=kTe;function sR(){return sR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sR.apply(this,arguments)}var OTe=sR({breakpoints:hTe,zIndices:CTe,radii:vTe,blur:TTe,colors:gTe},cq,{sizes:uq,shadows:bTe,space:sq,borders:fTe,transition:ETe}),ITe=OTe,NTe={global:e=>({body:{fontFamily:"body",color:Ce("gray.800","whiteAlpha.900")(e),bg:Ce("white","gray.800")(e),transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:Ce("gray.400","whiteAlpha.400")(e)},"*, *::before, &::after":{borderColor:Ce("gray.200","whiteAlpha.300")(e),wordWrap:"break-word"}})},DTe=NTe;function uR(){return uR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uR.apply(this,arguments)}var RTe="ltr",FTe={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},MTe=uR({direction:RTe},ITe,{components:lTe,styles:DTe,config:FTe}),PTe=MTe,xq=X_e;xq.defaultProps={theme:PTe};function Sy(){return Sy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sy.apply(this,arguments)}function $Te(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var wq={path:le("g",{stroke:"currentColor",strokeWidth:"1.5"},le("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),le("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),le("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})),viewBox:"0 0 24 24"},S_=qt((e,t)=>{var{as:n,viewBox:r,color:i="currentColor",focusable:a=!1,children:o,className:s,__css:u}=e,l=$Te(e,["as","viewBox","color","focusable","children","className","__css"]),c=Gn("chakra-icon",s),f=Sy({w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i},u),d={ref:t,focusable:a,className:c,__css:f},h=r??wq.viewBox;if(n&&typeof n!="string")return le(wt.svg,Sy({as:n},d,l));var p=o??wq.path;return le(wt.svg,Sy({verticalAlign:"middle",viewBox:h},d,l),p)});function lR(){return lR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lR.apply(this,arguments)}function E_(e){var{viewBox:t="0 0 24 24",d:n,path:r,displayName:i,defaultProps:a={}}=e,o=qt((s,u)=>le(S_,lR({ref:u,viewBox:t},a,s),r??le("path",{fill:"currentColor",d:n})));return o}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cR=function(e,t){return cR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},cR(e,t)};function _q(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");cR(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ie=function(){return Ie=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ie.apply(this,arguments)};function To(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function mr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function ma(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var Ql=function(e){return{isEnabled:function(t){return e.some(function(n){return!!t[n]})}}},fR={measureLayout:Ql(["layout","layoutId","drag","_layoutResetTransform"]),animation:Ql(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag"]),exit:Ql(["exit"]),drag:Ql(["drag","dragControls"]),focus:Ql(["whileFocus"]),hover:Ql(["whileHover","onHoverStart","onHoverEnd"]),tap:Ql(["whileTap","onTap","onTapStart","onTapCancel"]),pan:Ql(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),layoutAnimation:Ql(["layout","layoutId"])};function LTe(e){for(var t in e){var n=e[t];n!==null&&(fR[t].Component=n)}}var Ey=function(){},Sq=ha({strict:!1}),Eq=Object.keys(fR),BTe=Eq.length;function zTe(e,t,n){var r=[];if(Un(Sq),!t)return null;for(var i=0;i<BTe;i++){var a=Eq[i],o=fR[a],s=o.isEnabled,u=o.Component;s(e)&&u&&r.push(le(u,Ie({key:a},e,{visualElement:t})))}return r}var A_=ha({transformPagePoint:function(e){return e},isStatic:!1}),C_=ha({});function jTe(){return Un(C_).visualElement}var Ay=ha(null);function Cy(e){var t=Jt(null);return t.current===null&&(t.current=e()),t.current}function dR(){var e=Un(Ay);if(e===null)return[!0,null];var t=e.isPresent,n=e.onExitComplete,r=e.register,i=qTe();Vt(function(){return r(i)},[]);var a=function(){return n==null?void 0:n(i)};return!t&&n?[!1,a]:[!0]}function UTe(e){return e===null?!0:e.isPresent}var WTe=0,VTe=function(){return WTe++},qTe=function(){return Cy(VTe)},HTe=ha(null),ky=typeof window!="undefined",Aq=ky?uf:Vt;function GTe(e){var t=e.layoutId,n=Un(HTe);return n&&t!==void 0?n+"-"+t:t}function KTe(e,t,n,r){var i=Un(A_),a=Un(Sq),o=jTe(),s=Un(Ay),u=GTe(n),l=Jt(void 0);r||(r=a.renderer),!l.current&&r&&(l.current=r(e,{visualState:t,parent:o,props:Ie(Ie({},n),{layoutId:u}),presenceId:s==null?void 0:s.id,blockInitialAnimation:(s==null?void 0:s.initial)===!1}));var c=l.current;return Aq(function(){!c||(c.setProps(Ie(Ie(Ie({},i),n),{layoutId:u})),c.isPresent=UTe(s),c.isPresenceRoot=!o||o.presenceId!==(s==null?void 0:s.id),c.syncRender())}),Vt(function(){var f;!c||(f=c.animationState)===null||f===void 0||f.animateChanges()}),Aq(function(){return function(){return c==null?void 0:c.notifyUnmount()}},[]),c}function hR(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function XTe(e,t,n){return st(function(r){var i;r&&((i=e.mount)===null||i===void 0||i.call(e,r)),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):hR(n)&&(n.current=r))},[t])}function Cq(e){return Array.isArray(e)}function zs(e){return typeof e=="string"||Cq(e)}function YTe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.get()}),t}function ZTe(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.getVelocity()}),t}function kq(e,t,n,r,i){var a;return r===void 0&&(r={}),i===void 0&&(i={}),typeof t=="string"&&(t=(a=e.variants)===null||a===void 0?void 0:a[t]),typeof t=="function"?t(n??e.custom,r,i):t}function k_(e,t,n){var r=e.getProps();return kq(r,t,n??r.custom,YTe(e),ZTe(e))}function T_(e){var t;return typeof((t=e.animate)===null||t===void 0?void 0:t.start)=="function"||zs(e.initial)||zs(e.animate)||zs(e.whileHover)||zs(e.whileDrag)||zs(e.whileTap)||zs(e.whileFocus)||zs(e.exit)}function Tq(e){return Boolean(T_(e)||e.variants)}function JTe(e,t){if(T_(e)){var n=e.initial,r=e.animate;return{initial:n===!1||zs(n)?n:void 0,animate:zs(r)?r:void 0}}return e.inherit!==!1?t:{}}function QTe(e,t){var n=JTe(e,Un(C_)),r=n.initial,i=n.animate;return gr(function(){return{initial:r,animate:i}},t?[Oq(r),Oq(i)]:[])}function Oq(e){return Array.isArray(e)?e.join(" "):e}function eOe(e){var t=e.preloadedFeatures,n=e.createVisualElement,r=e.useRender,i=e.useVisualState,a=e.Component;t&&LTe(t);function o(s,u){var l=Un(A_).isStatic,c=null,f=QTe(s,l),d=i(s,l);return!l&&ky&&(f.visualElement=KTe(a,d,s,n),c=zTe(s,f.visualElement)),le(Vi,null,le(C_.Provider,{value:f},r(a,s,XTe(d,f.visualElement,u),d,l)),c)}return Kl(o)}function tOe(e){function t(r,i){return i===void 0&&(i={}),eOe(e(r,i))}var n=new Map;return new Proxy(t,{get:function(r,i){return n.has(i)||n.set(i,t(i)),n.get(i)}})}var nOe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function pR(e){return typeof e!="string"||e.includes("-")?!1:!!(nOe.indexOf(e)>-1||/[A-Z]/.test(e))}var Ty={};function rOe(e){for(var t in e)Ty[t]=e[t]}var iOe=["","X","Y","Z"],aOe=["translate","scale","rotate","skew"],Oy=["transformPerspective","x","y","z"];aOe.forEach(function(e){return iOe.forEach(function(t){return Oy.push(e+t)})});function oOe(e,t){return Oy.indexOf(e)-Oy.indexOf(t)}var sOe=new Set(Oy);function O_(e){return sOe.has(e)}var uOe=new Set(["originX","originY","originZ"]);function Iq(e){return uOe.has(e)}function Nq(e,t){var n=t.layout,r=t.layoutId;return O_(e)||Iq(e)||(n||r!==void 0)&&(!!Ty[e]||e==="opacity")}var yf=function(e){return e!==null&&typeof e=="object"&&e.getVelocity},lOe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function cOe(e,t,n,r){var i=e.transform,a=e.transformKeys,o=t.enableHardwareAcceleration,s=o===void 0?!0:o,u=t.allowTransformNone,l=u===void 0?!0:u,c="";a.sort(oOe);for(var f=!1,d=a.length,h=0;h<d;h++){var p=a[h];c+=(lOe[p]||p)+"("+i[p]+") ",p==="z"&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(i,n?"":c):l&&n&&(c="none"),c}function fOe(e){var t=e.originX,n=t===void 0?"50%":t,r=e.originY,i=r===void 0?"50%":r,a=e.originZ,o=a===void 0?0:a;return n+" "+i+" "+o}function Dq(e){return e.startsWith("--")}var dOe=function(e,t){return t&&typeof e=="number"?t.transform(e):e},Rq=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},Iy=function(e){return e%1?Number(e.toFixed(5)):e},Ny=/(-)?([\d]*\.?[\d])+/g,gR=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,hOe=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function Dy(e){return typeof e=="string"}var Sh={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},Ry=Ie(Ie({},Sh),{transform:Rq(0,1)}),I_=Ie(Ie({},Sh),{default:1}),Fy=function(e){return{test:function(t){return Dy(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},bf=Fy("deg"),om=Fy("%"),Tt=Fy("px"),pOe=Fy("vh"),gOe=Fy("vw"),Fq=Ie(Ie({},om),{parse:function(e){return om.parse(e)/100},transform:function(e){return om.transform(e*100)}}),mR=function(e,t){return function(n){return Boolean(Dy(n)&&hOe.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},Mq=function(e,t,n){return function(r){var i;if(!Dy(r))return r;var a=r.match(Ny),o=a[0],s=a[1],u=a[2],l=a[3];return i={},i[e]=parseFloat(o),i[t]=parseFloat(s),i[n]=parseFloat(u),i.alpha=l!==void 0?parseFloat(l):1,i}},sm={test:mR("hsl","hue"),parse:Mq("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,i=e.alpha,a=i===void 0?1:i;return"hsla("+Math.round(t)+", "+om.transform(Iy(n))+", "+om.transform(Iy(r))+", "+Iy(Ry.transform(a))+")"}},mOe=Rq(0,255),vR=Ie(Ie({},Sh),{transform:function(e){return Math.round(mOe(e))}}),um={test:mR("rgb","red"),parse:Mq("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,i=e.alpha,a=i===void 0?1:i;return"rgba("+vR.transform(t)+", "+vR.transform(n)+", "+vR.transform(r)+", "+Iy(Ry.transform(a))+")"}};function vOe(e){var t="",n="",r="",i="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),i=e.substr(4,1),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var yR={test:mR("#"),parse:vOe,transform:um.transform},va={test:function(e){return um.test(e)||yR.test(e)||sm.test(e)},parse:function(e){return um.test(e)?um.parse(e):sm.test(e)?sm.parse(e):yR.parse(e)},transform:function(e){return Dy(e)?e:e.hasOwnProperty("red")?um.transform(e):sm.transform(e)}},Pq="${c}",$q="${n}";function yOe(e){var t,n,r,i;return isNaN(e)&&Dy(e)&&((n=(t=e.match(Ny))===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+((i=(r=e.match(gR))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0}function Lq(e){var t=[],n=0,r=e.match(gR);r&&(n=r.length,e=e.replace(gR,Pq),t.push.apply(t,r.map(va.parse)));var i=e.match(Ny);return i&&(e=e.replace(Ny,$q),t.push.apply(t,i.map(Sh.parse))),{values:t,numColors:n,tokenised:e}}function Bq(e){return Lq(e).values}function zq(e){var t=Lq(e),n=t.values,r=t.numColors,i=t.tokenised,a=n.length;return function(o){for(var s=i,u=0;u<a;u++)s=s.replace(u<r?Pq:$q,u<r?va.transform(o[u]):Iy(o[u]));return s}}var bOe=function(e){return typeof e=="number"?0:e};function xOe(e){var t=Bq(e),n=zq(e);return n(t.map(bOe))}var ec={test:yOe,parse:Bq,createTransformer:zq,getAnimatableNone:xOe},wOe=new Set(["brightness","contrast","saturate","opacity"]);function _Oe(e){var t=e.slice(0,-1).split("("),n=t[0],r=t[1];if(n==="drop-shadow")return e;var i=(r.match(Ny)||[])[0];if(!i)return e;var a=r.replace(i,""),o=wOe.has(n)?1:0;return i!==r&&(o*=100),n+"("+o+a+")"}var SOe=/([a-z-]*)\(.*?\)/g,bR=Ie(Ie({},ec),{getAnimatableNone:function(e){var t=e.match(SOe);return t?t.map(_Oe).join(" "):e}}),jq=Ie(Ie({},Sh),{transform:Math.round}),Uq={borderWidth:Tt,borderTopWidth:Tt,borderRightWidth:Tt,borderBottomWidth:Tt,borderLeftWidth:Tt,borderRadius:Tt,radius:Tt,borderTopLeftRadius:Tt,borderTopRightRadius:Tt,borderBottomRightRadius:Tt,borderBottomLeftRadius:Tt,width:Tt,maxWidth:Tt,height:Tt,maxHeight:Tt,size:Tt,top:Tt,right:Tt,bottom:Tt,left:Tt,padding:Tt,paddingTop:Tt,paddingRight:Tt,paddingBottom:Tt,paddingLeft:Tt,margin:Tt,marginTop:Tt,marginRight:Tt,marginBottom:Tt,marginLeft:Tt,rotate:bf,rotateX:bf,rotateY:bf,rotateZ:bf,scale:I_,scaleX:I_,scaleY:I_,scaleZ:I_,skew:bf,skewX:bf,skewY:bf,distance:Tt,translateX:Tt,translateY:Tt,translateZ:Tt,x:Tt,y:Tt,z:Tt,perspective:Tt,transformPerspective:Tt,opacity:Ry,originX:Fq,originY:Fq,originZ:Tt,zIndex:jq,fillOpacity:Ry,strokeOpacity:Ry,numOctaves:jq};function xR(e,t,n,r,i,a,o,s){var u,l=e.style,c=e.vars,f=e.transform,d=e.transformKeys,h=e.transformOrigin;d.length=0;var p=!1,g=!1,m=!0;for(var v in t){var y=t[v];if(Dq(v)){c[v]=y;continue}var b=Uq[v],x=dOe(y,b);if(O_(v)){if(p=!0,f[v]=x,d.push(v),!m)continue;y!==((u=b.default)!==null&&u!==void 0?u:0)&&(m=!1)}else if(Iq(v))h[v]=x,g=!0;else if((n==null?void 0:n.isHydrated)&&(r==null?void 0:r.isHydrated)&&Ty[v]){var w=Ty[v].process(y,r,n),S=Ty[v].applyTo;if(S)for(var A=S.length,_=0;_<A;_++)l[S[_]]=w;else l[v]=w}else l[v]=x}r&&n&&o&&s?(l.transform=o(r.deltaFinal,r.treeScale,p?f:void 0),a&&(l.transform=a(f,l.transform)),l.transformOrigin=s(r)):(p&&(l.transform=cOe(e,i,m,a)),g&&(l.transformOrigin=fOe(h)))}var wR=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function Wq(e,t,n){for(var r in t)!yf(t[r])&&!Nq(r,n)&&(e[r]=t[r])}function EOe(e,t,n){var r=e.transformTemplate;return gr(function(){var i=wR();xR(i,t,void 0,void 0,{enableHardwareAcceleration:!n},r);var a=i.vars,o=i.style;return Ie(Ie({},a),o)},[t])}function AOe(e,t,n){var r=e.style||{},i={};return Wq(i,r,e),Object.assign(i,EOe(e,t,n)),e.transformValues&&(i=e.transformValues(i)),i}function COe(e,t,n){var r={},i=AOe(e,t,n);return Boolean(e.drag)&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":"pan-"+(e.drag==="x"?"y":"x")),r.style=i,r}var kOe=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","_layoutResetTransform","onLayoutAnimationComplete","onViewportBoxUpdate","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover"]);function N_(e){return kOe.has(e)}var Vq=function(e){return!N_(e)};try{var TOe=require("@emotion/is-prop-valid").default;Vq=function(e){return e.startsWith("on")?!N_(e):TOe(e)}}catch(e){}function OOe(e,t,n){var r={};for(var i in e)(Vq(i)||n===!0&&N_(i)||!t&&!N_(i))&&(r[i]=e[i]);return r}function qq(e,t,n){return typeof e=="string"?e:Tt.transform(t+n*e)}function IOe(e,t,n){var r=qq(t,e.x,e.width),i=qq(n,e.y,e.height);return r+" "+i}var _R=function(e,t){return Tt.transform(e*t)},NOe={offset:"stroke-dashoffset",array:"stroke-dasharray"},DOe={offset:"strokeDashoffset",array:"strokeDasharray"};function ROe(e,t,n,r,i,a){r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=!0);var o=a?NOe:DOe;e[o.offset]=_R(-i,t);var s=_R(n,t),u=_R(r,t);e[o.array]=s+" "+u}function SR(e,t,n,r,i,a,o,s){var u=t.attrX,l=t.attrY,c=t.originX,f=t.originY,d=t.pathLength,h=t.pathSpacing,p=h===void 0?1:h,g=t.pathOffset,m=g===void 0?0:g,v=To(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);xR(e,v,n,r,i,a,o,s),e.attrs=e.style,e.style={};var y=e.attrs,b=e.style,x=e.dimensions,w=e.totalPathLength;y.transform&&(x&&(b.transform=y.transform),delete y.transform),x&&(c!==void 0||f!==void 0||b.transform)&&(b.transformOrigin=IOe(x,c!==void 0?c:.5,f!==void 0?f:.5)),u!==void 0&&(y.x=u),l!==void 0&&(y.y=l),w!==void 0&&d!==void 0&&ROe(y,w,d,p,m,!1)}var Hq=function(){return Ie(Ie({},wR()),{attrs:{}})};function FOe(e,t){var n=gr(function(){var i=Hq();return SR(i,t,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Ie(Ie({},i.attrs),{style:Ie({},i.style)})},[t]);if(e.style){var r={};Wq(r,e.style,e),n.style=Ie(Ie({},r),n.style)}return n}function MOe(e){e===void 0&&(e=!1);var t=function(n,r,i,a,o){var s=a.latestValues,u=pR(n)?FOe:COe,l=u(r,s,o),c=OOe(r,typeof n=="string",e),f=Ie(Ie(Ie({},c),l),{ref:i});return le(n,f)};return t}var POe=/([a-z])([A-Z])/g,$Oe="$1-$2",Gq=function(e){return e.replace(POe,$Oe).toLowerCase()};function Kq(e,t){var n=t.style,r=t.vars;Object.assign(e.style,n);for(var i in r)e.style.setProperty(i,r[i])}var Xq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform"]);function Yq(e,t){Kq(e,t);for(var n in t.attrs)e.setAttribute(Xq.has(n)?n:Gq(n),t.attrs[n])}function ER(e){var t=e.style,n={};for(var r in t)(yf(t[r])||Nq(r,e))&&(n[r]=t[r]);return n}function Zq(e){var t=ER(e);for(var n in e)if(yf(e[n])){var r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;t[r]=e[n]}return t}function AR(e){return typeof e=="object"&&typeof e.start=="function"}var My=function(e){return Array.isArray(e)},LOe=function(e){return Boolean(e&&typeof e=="object"&&e.mix&&e.toValue)},BOe=function(e){return My(e)?e[e.length-1]||0:e};function zOe(e){var t=yf(e)?e.get():e;return LOe(t)?t.toValue():t}function Jq(e,t,n,r){var i=e.scrapeMotionValuesFromProps,a=e.createRenderState,o=e.onMount,s={latestValues:jOe(t,n,r,i),renderState:a()};return o&&(s.mount=function(u){return o(t,u,s)}),s}var Qq=function(e){return function(t,n){var r=Un(C_),i=Un(Ay);return n?Jq(e,t,r,i):Cy(function(){return Jq(e,t,r,i)})}};function jOe(e,t,n,r){var i={},a=(n==null?void 0:n.initial)===!1,o=r(e);for(var s in o)i[s]=zOe(o[s]);var u=e.initial,l=e.animate,c=T_(e),f=Tq(e);t&&f&&!c&&e.inherit!==!1&&(u??(u=t.initial),l??(l=t.animate));var d=a||u===!1?l:u;if(d&&typeof d!="boolean"&&!AR(d)){var h=Array.isArray(d)?d:[d];h.forEach(function(p){var g=kq(e,p);if(!!g){var m=g.transitionEnd;g.transition;var v=To(g,["transitionEnd","transition"]);for(var y in v)i[y]=v[y];for(var y in m)i[y]=m[y]}})}return i}var UOe={useVisualState:Qq({scrapeMotionValuesFromProps:Zq,createRenderState:Hq,onMount:function(e,t,n){var r=n.renderState,i=n.latestValues;try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch(a){r.dimensions={x:0,y:0,width:0,height:0}}WOe(t)&&(r.totalPathLength=t.getTotalLength()),SR(r,i,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Yq(t,r)}})};function WOe(e){return e.tagName==="path"}var VOe={useVisualState:Qq({scrapeMotionValuesFromProps:ER,createRenderState:wR})};function qOe(e,t,n,r){var i=t.forwardMotionProps,a=i===void 0?!1:i,o=pR(e)?UOe:VOe;return Ie(Ie({},o),{preloadedFeatures:n,useRender:MOe(a),createVisualElement:r,Component:e})}var Sr;(function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.Exit="exit"})(Sr||(Sr={}));function CR(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function kR(e,t,n,r){Vt(function(){var i=e.current;if(n&&i)return CR(i,t,n,r)},[e,t,n,r])}function HOe(e){var t=e.whileFocus,n=e.visualElement,r=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Sr.Focus,!0)},i=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(Sr.Focus,!1)};kR(n,"focus",t?r:void 0),kR(n,"blur",t?i:void 0)}function eH(e){return typeof PointerEvent!="undefined"&&e instanceof PointerEvent?e.pointerType==="mouse":e instanceof MouseEvent}function tH(e){var t=!!e.touches;return t}function GOe(e){return function(t){var n=t instanceof MouseEvent,r=!n||n&&t.button===0;r&&e(t)}}var KOe={pageX:0,pageY:0};function XOe(e,t){t===void 0&&(t="page");var n=e.touches[0]||e.changedTouches[0],r=n||KOe;return{x:r[t+"X"],y:r[t+"Y"]}}function YOe(e,t){return t===void 0&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function TR(e,t){return t===void 0&&(t="page"),{point:tH(e)?XOe(e,t):YOe(e,t)}}function ZOe(e){return TR(e,"client")}var nH=function(e,t){t===void 0&&(t=!1);var n=function(r){return e(r,TR(r))};return t?GOe(n):n},JOe=function(){return ky&&window.onpointerdown===null},QOe=function(){return ky&&window.ontouchstart===null},eIe=function(){return ky&&window.onmousedown===null},tIe={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},nIe={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function rH(e){return JOe()?e:QOe()?nIe[e]:eIe()?tIe[e]:e}function lm(e,t,n,r){return CR(e,rH(t),nH(n,t==="pointerdown"),r)}function D_(e,t,n,r){return kR(e,rH(t),n&&nH(n,t==="pointerdown"),r)}function iH(e){var t=null;return function(){var n=function(){t=null};return t===null?(t=e,n):!1}}var aH=iH("dragHorizontal"),oH=iH("dragVertical");function sH(e){var t=!1;if(e==="y")t=oH();else if(e==="x")t=aH();else{var n=aH(),r=oH();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function uH(){var e=sH(!0);return e?(e(),!1):!0}function lH(e,t,n){return function(r,i){var a;!eH(r)||uH()||(n==null||n(r,i),(a=e.animationState)===null||a===void 0||a.setActive(Sr.Hover,t))}}function rIe(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,i=e.visualElement;D_(i,"pointerenter",t||r?lH(i,!0,t):void 0),D_(i,"pointerleave",n||r?lH(i,!1,n):void 0)}var cH=function(e,t){return t?e===t?!0:cH(e,t.parentElement):!1};function OR(e){return Vt(function(){return function(){return e()}},[])}var R_=function(e,t,n){return Math.min(Math.max(n,e),t)},IR=.001,iIe=.01,aIe=10,oIe=.05,sIe=1;function uIe(e){var t=e.duration,n=t===void 0?800:t,r=e.bounce,i=r===void 0?.25:r,a=e.velocity,o=a===void 0?0:a,s=e.mass,u=s===void 0?1:s,l,c,f=1-i;f=R_(oIe,sIe,f),n=R_(iIe,aIe,n/1e3),f<1?(l=function(g){var m=g*f,v=m*n,y=m-o,b=NR(g,f),x=Math.exp(-v);return IR-y/b*x},c=function(g){var m=g*f,v=m*n,y=v*o+o,b=Math.pow(f,2)*Math.pow(g,2)*n,x=Math.exp(-v),w=NR(Math.pow(g,2),f),S=-l(g)+IR>0?-1:1;return S*((y-b)*x)/w}):(l=function(g){var m=Math.exp(-g*n),v=(g-o)*n+1;return-IR+m*v},c=function(g){var m=Math.exp(-g*n),v=(o-g)*(n*n);return m*v});var d=5/n,h=cIe(l,c,d);if(n=n*1e3,isNaN(h))return{stiffness:100,damping:10,duration:n};var p=Math.pow(h,2)*u;return{stiffness:p,damping:f*2*Math.sqrt(u*p),duration:n}}var lIe=12;function cIe(e,t,n){for(var r=n,i=1;i<lIe;i++)r=r-e(r)/t(r);return r}function NR(e,t){return e*Math.sqrt(1-t*t)}var fIe=["duration","bounce"],dIe=["stiffness","damping","mass"];function fH(e,t){return t.some(function(n){return e[n]!==void 0})}function hIe(e){var t=Ie({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!fH(e,dIe)&&fH(e,fIe)){var n=uIe(e);t=Ie(Ie(Ie({},t),n),{velocity:0,mass:1}),t.isResolvedFromDuration=!0}return t}function DR(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.restSpeed,o=a===void 0?2:a,s=e.restDelta,u=To(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=hIe(u),f=c.stiffness,d=c.damping,h=c.mass,p=c.velocity,g=c.duration,m=c.isResolvedFromDuration,v=dH,y=dH;function b(){var x=p?-(p/1e3):0,w=i-n,S=d/(2*Math.sqrt(f*h)),A=Math.sqrt(f/h)/1e3;if(s??(s=Math.abs(i-n)<=1?.01:.4),S<1){var _=NR(A,S);v=function(C){var k=Math.exp(-S*A*C);return i-k*((x+S*A*w)/_*Math.sin(_*C)+w*Math.cos(_*C))},y=function(C){var k=Math.exp(-S*A*C);return S*A*k*(Math.sin(_*C)*(x+S*A*w)/_+w*Math.cos(_*C))-k*(Math.cos(_*C)*(x+S*A*w)-_*w*Math.sin(_*C))}}else if(S===1)v=function(C){return i-Math.exp(-A*C)*(w+(x+A*w)*C)};else{var E=A*Math.sqrt(S*S-1);v=function(C){var k=Math.exp(-S*A*C),T=Math.min(E*C,300);return i-k*((x+S*A*w)*Math.sinh(T)+E*w*Math.cosh(T))/E}}}return b(),{next:function(x){var w=v(x);if(m)l.done=x>=g;else{var S=y(x)*1e3,A=Math.abs(S)<=o,_=Math.abs(i-w)<=s;l.done=A&&_}return l.value=l.done?i:w,l},flipTarget:function(){var x;p=-p,x=[i,n],n=x[0],i=x[1],b()}}}DR.needsInterpolation=function(e,t){return typeof e=="string"||typeof t=="string"};var dH=function(e){return 0},Py=function(e,t,n){var r=t-e;return r===0?1:(n-e)/r},Za=function(e,t,n){return-n*e+n*t+e},pIe=function(e,t,n){var r=e*e,i=t*t;return Math.sqrt(Math.max(0,n*(i-r)+r))},gIe=[yR,um,sm],hH=function(e){return gIe.find(function(t){return t.test(e)})},pH=function(e,t){var n=hH(e),r=hH(t);Ey(n.transform===r.transform);var i=n.parse(e),a=r.parse(t),o=Ie({},i),s=n===sm?Za:pIe;return function(u){for(var l in o)l!=="alpha"&&(o[l]=s(i[l],a[l],u));return o.alpha=Za(i.alpha,a.alpha,u),n.transform(o)}},RR=function(e){return typeof e=="number"},mIe=function(e,t){return function(n){return t(e(n))}},$y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(mIe)};function gH(e,t){return RR(e)?function(n){return Za(e,t,n)}:va.test(e)?pH(e,t):yH(e,t)}var mH=function(e,t){var n=ma([],e),r=n.length,i=e.map(function(a,o){return gH(a,t[o])});return function(a){for(var o=0;o<r;o++)n[o]=i[o](a);return n}},vIe=function(e,t){var n=Ie(Ie({},e),t),r={};for(var i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=gH(e[i],t[i]));return function(a){for(var o in r)n[o]=r[o](a);return n}};function vH(e){for(var t=ec.parse(e),n=t.length,r=0,i=0,a=0,o=0;o<n;o++)r||typeof t[o]=="number"?r++:t[o].hue!==void 0?a++:i++;return{parsed:t,numNumbers:r,numRGB:i,numHSL:a}}var yH=function(e,t){var n=ec.createTransformer(t),r=vH(e),i=vH(t);return $y(mH(r.parsed,i.parsed),n)},yIe=function(e,t){return function(n){return Za(e,t,n)}};function bIe(e){if(typeof e=="number")return yIe;if(typeof e=="string")return va.test(e)?pH:yH;if(Array.isArray(e))return mH;if(typeof e=="object")return vIe}function xIe(e,t,n){for(var r=[],i=n||bIe(e[0]),a=e.length-1,o=0;o<a;o++){var s=i(e[o],e[o+1]);if(t){var u=Array.isArray(t)?t[o]:t;s=$y(u,s)}r.push(s)}return r}function wIe(e,t){var n=e[0],r=e[1],i=t[0];return function(a){return i(Py(n,r,a))}}function _Ie(e,t){var n=e.length,r=n-1;return function(i){var a=0,o=!1;if(i<=e[0]?o=!0:i>=e[r]&&(a=r-1,o=!0),!o){for(var s=1;s<n&&!(e[s]>i||s===r);s++);a=s-1}var u=Py(e[a],e[a+1],i);return t[a](u)}}function bH(e,t,n){var r=n===void 0?{}:n,i=r.clamp,a=i===void 0?!0:i,o=r.ease,s=r.mixer,u=e.length;Ey(u===t.length),Ey(!o||!Array.isArray(o)||o.length===u-1),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var l=xIe(t,o,s),c=u===2?wIe(e,l):_Ie(e,l);return a?function(f){return c(R_(e[0],e[u-1],f))}:c}var F_=function(e){return function(t){return 1-e(1-t)}},FR=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},SIe=function(e){return function(t){return Math.pow(t,e)}},xH=function(e){return function(t){return t*t*((e+1)*t-e)}},EIe=function(e){var t=xH(e);return function(n){return(n*=2)<1?.5*t(n):.5*(2-Math.pow(2,-10*(n-1)))}},wH=1.525,AIe=4/11,CIe=8/11,kIe=9/10,_H=function(e){return e},MR=SIe(2),TIe=F_(MR),SH=FR(MR),EH=function(e){return 1-Math.sin(Math.acos(e))},AH=F_(EH),OIe=FR(AH),PR=xH(wH),IIe=F_(PR),NIe=FR(PR),DIe=EIe(wH),RIe=4356/361,FIe=35442/1805,MIe=16061/1805,M_=function(e){if(e===1||e===0)return e;var t=e*e;return e<AIe?7.5625*t:e<CIe?9.075*t-9.9*e+3.4:e<kIe?RIe*t-FIe*e+MIe:10.8*e*e-20.52*e+10.72},PIe=F_(M_),$Ie=function(e){return e<.5?.5*(1-M_(1-e*2)):.5*M_(e*2-1)+.5};function LIe(e,t){return e.map(function(){return t||SH}).splice(0,e.length-1)}function BIe(e){var t=e.length;return e.map(function(n,r){return r!==0?r/(t-1):0})}function zIe(e,t){return e.map(function(n){return n*t})}function P_(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.ease,o=e.offset,s=e.duration,u=s===void 0?300:s,l={done:!1,value:n},c=Array.isArray(i)?i:[n,i],f=zIe(o&&o.length===c.length?o:BIe(c),u);function d(){return bH(f,c,{ease:Array.isArray(a)?a:LIe(c,a)})}var h=d();return{next:function(p){return l.value=h(p),l.done=p>=u,l},flipTarget:function(){c.reverse(),h=d()}}}function jIe(e){var t=e.velocity,n=t===void 0?0:t,r=e.from,i=r===void 0?0:r,a=e.power,o=a===void 0?.8:a,s=e.timeConstant,u=s===void 0?350:s,l=e.restDelta,c=l===void 0?.5:l,f=e.modifyTarget,d={done:!1,value:i},h=o*n,p=i+h,g=f===void 0?p:f(p);return g!==p&&(h=g-i),{next:function(m){var v=-h*Math.exp(-m/u);return d.done=!(v>c||v<-c),d.value=d.done?g:g+v,d},flipTarget:function(){}}}var CH={keyframes:P_,spring:DR,decay:jIe};function UIe(e){if(Array.isArray(e.to))return P_;if(CH[e.type])return CH[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?P_:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?DR:P_}function kH(e,t,n){return n===void 0&&(n=0),e-t-n}function WIe(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=!0),r?kH(t+-e,t,n):t-(e-t)+n}function VIe(e,t,n,r){return r?e>=t+n:e<=-n}var qIe=function(e){var t=function(n){var r=n.delta;return e(r)};return{start:function(){return Mu.update(t,!0)},stop:function(){return fy.update(t)}}};function TH(e){var t,n,r=e.from,i=e.autoplay,a=i===void 0?!0:i,o=e.driver,s=o===void 0?qIe:o,u=e.elapsed,l=u===void 0?0:u,c=e.repeat,f=c===void 0?0:c,d=e.repeatType,h=d===void 0?"loop":d,p=e.repeatDelay,g=p===void 0?0:p,m=e.onPlay,v=e.onStop,y=e.onComplete,b=e.onRepeat,x=e.onUpdate,w=To(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),S=w.to,A,_=0,E=w.duration,C,k=!1,T=!0,I,N=UIe(w);((n=(t=N).needsInterpolation)===null||n===void 0?void 0:n.call(t,r,S))&&(I=bH([0,100],[r,S],{clamp:!1}),r=0,S=100);var O=N(Ie(Ie({},w),{from:r,to:S}));function D(){_++,h==="reverse"?(T=_%2==0,l=WIe(l,E,g,T)):(l=kH(l,E,g),h==="mirror"&&O.flipTarget()),k=!1,b&&b()}function L(){A.stop(),y&&y()}function W(K){if(T||(K=-K),l+=K,!k){var ee=O.next(Math.max(0,l));C=ee.value,I&&(C=I(C)),k=T?ee.done:l<=0}x==null||x(C),k&&(_===0&&(E??(E=l)),_<f?VIe(l,E,g,T)&&D():L())}function G(){m==null||m(),A=s(W),A.start()}return a&&G(),{stop:function(){v==null||v(),A.stop()}}}function OH(e,t){return t?e*(1e3/t):0}function HIe(e){var t=e.from,n=t===void 0?0:t,r=e.velocity,i=r===void 0?0:r,a=e.min,o=e.max,s=e.power,u=s===void 0?.8:s,l=e.timeConstant,c=l===void 0?750:l,f=e.bounceStiffness,d=f===void 0?500:f,h=e.bounceDamping,p=h===void 0?10:h,g=e.restDelta,m=g===void 0?1:g,v=e.modifyTarget,y=e.driver,b=e.onUpdate,x=e.onComplete,w;function S(D){return a!==void 0&&D<a||o!==void 0&&D>o}function A(D){return a===void 0?o:o===void 0||Math.abs(a-D)<Math.abs(o-D)?a:o}function _(D){w==null||w.stop(),w=TH(Ie(Ie({},D),{driver:y,onUpdate:function(L){var W;b==null||b(L),(W=D.onUpdate)===null||W===void 0||W.call(D,L)},onComplete:x}))}function E(D){_(Ie({type:"spring",stiffness:d,damping:p,restDelta:m},D))}if(S(n))E({from:n,velocity:i,to:A(n)});else{var C=u*i+n;typeof v!="undefined"&&(C=v(C));var k=A(C),T=k===a?-1:1,I,N,O=function(D){I=N,N=D,i=OH(D-I,u_().delta),(T===1&&D>k||T===-1&&D<k)&&E({from:D,to:k,velocity:i})};_({type:"decay",from:n,velocity:i,timeConstant:c,power:u,restDelta:m,modifyTarget:v,onUpdate:S(C)?O:void 0})}return{stop:function(){return w==null?void 0:w.stop()}}}var $R=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},IH=function(e){return $R(e)&&e.hasOwnProperty("z")},$_=function(e,t){return Math.abs(e-t)};function NH(e,t){if(RR(e)&&RR(t))return $_(e,t);if($R(e)&&$R(t)){var n=$_(e.x,t.x),r=$_(e.y,t.y),i=IH(e)&&IH(t)?$_(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}}var DH=function(e,t){return 1-3*t+3*e},RH=function(e,t){return 3*t-6*e},FH=function(e){return 3*e},L_=function(e,t,n){return((DH(t,n)*e+RH(t,n))*e+FH(t))*e},MH=function(e,t,n){return 3*DH(t,n)*e*e+2*RH(t,n)*e+FH(t)},GIe=1e-7,KIe=10;function XIe(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=L_(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>GIe&&++s<KIe);return o}var YIe=8,ZIe=.001;function JIe(e,t,n,r){for(var i=0;i<YIe;++i){var a=MH(t,n,r);if(a===0)return t;var o=L_(t,n,r)-e;t-=o/a}return t}var B_=11,z_=1/(B_-1);function QIe(e,t,n,r){if(e===t&&n===r)return _H;for(var i=new Float32Array(B_),a=0;a<B_;++a)i[a]=L_(a*z_,e,n);function o(s){for(var u=0,l=1,c=B_-1;l!==c&&i[l]<=s;++l)u+=z_;--l;var f=(s-i[l])/(i[l+1]-i[l]),d=u+f*z_,h=MH(d,e,n);return h>=ZIe?JIe(s,d,e,n):h===0?d:XIe(s,u,u+z_,e,n)}return function(s){return s===0||s===1?s:L_(o(s),t,r)}}function eNe(e){var t=e.onTap,n=e.onTapStart,r=e.onTapCancel,i=e.whileTap,a=e.visualElement,o=t||n||r||i,s=Jt(!1),u=Jt(null);function l(){var p;(p=u.current)===null||p===void 0||p.call(u),u.current=null}function c(){var p;return l(),s.current=!1,(p=a.animationState)===null||p===void 0||p.setActive(Sr.Tap,!1),!uH()}function f(p,g){!c()||(cH(a.getInstance(),p.target)?t==null||t(p,g):r==null||r(p,g))}function d(p,g){!c()||r==null||r(p,g)}function h(p,g){var m;l(),!s.current&&(s.current=!0,u.current=$y(lm(window,"pointerup",f),lm(window,"pointercancel",d)),n==null||n(p,g),(m=a.animationState)===null||m===void 0||m.setActive(Sr.Tap,!0))}D_(a,"pointerdown",o?h:void 0),OR(l)}var Eh=function(e){return function(t){return e(t),null}},tNe={tap:Eh(eNe),focus:Eh(HOe),hover:Eh(rIe)};function PH(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var j_=function(e){return e*1e3},nNe={linear:_H,easeIn:MR,easeInOut:SH,easeOut:TIe,circIn:EH,circInOut:OIe,circOut:AH,backIn:PR,backInOut:NIe,backOut:IIe,anticipate:DIe,bounceIn:PIe,bounceInOut:$Ie,bounceOut:M_},$H=function(e){if(Array.isArray(e)){Ey(e.length===4);var t=mr(e,4),n=t[0],r=t[1],i=t[2],a=t[3];return QIe(n,r,i,a)}else if(typeof e=="string")return nNe[e];return e},rNe=function(e){return Array.isArray(e)&&typeof e[0]!="number"},LH=function(e,t){return e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&ec.test(t)&&!t.startsWith("url("))},Ah=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},U_=function(e){return{type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restDelta:.01,restSpeed:10}},LR=function(){return{type:"keyframes",ease:"linear",duration:.3}},iNe=function(e){return{type:"keyframes",duration:.8,values:e}},BH={x:Ah,y:Ah,z:Ah,rotate:Ah,rotateX:Ah,rotateY:Ah,rotateZ:Ah,scaleX:U_,scaleY:U_,scale:U_,opacity:LR,backgroundColor:LR,color:LR,default:U_},aNe=function(e,t){var n;return My(t)?n=iNe:n=BH[e]||BH.default,Ie({to:t},n(t))},oNe=Ie(Ie({},Uq),{color:va,backgroundColor:va,outlineColor:va,fill:va,stroke:va,borderColor:va,borderTopColor:va,borderRightColor:va,borderBottomColor:va,borderLeftColor:va,filter:bR,WebkitFilter:bR}),BR=function(e){return oNe[e]};function zR(e,t){var n,r=BR(e);return r!==bR&&(r=ec),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,t)}function sNe(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=To(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}function uNe(e){var t=e.ease,n=e.times,r=e.yoyo,i=e.flip,a=e.loop,o=To(e,["ease","times","yoyo","flip","loop"]),s=Ie({},o);return n&&(s.offset=n),o.duration&&(s.duration=j_(o.duration)),o.repeatDelay&&(s.repeatDelay=j_(o.repeatDelay)),t&&(s.ease=rNe(t)?t.map($H):$H(t)),o.type==="tween"&&(s.type="keyframes"),(r||a||i)&&(r?s.repeatType="reverse":a?s.repeatType="loop":i&&(s.repeatType="mirror"),s.repeat=a||r||i||o.repeat),o.type!=="spring"&&(s.type="keyframes"),s}function lNe(e,t){var n,r=jR(e,t)||{};return(n=r.delay)!==null&&n!==void 0?n:0}function cNe(e){return Array.isArray(e.to)&&e.to[0]===null&&(e.to=ma([],mr(e.to)),e.to[0]=e.from),e}function fNe(e,t,n){var r;return Array.isArray(t.to)&&((r=e.duration)!==null&&r!==void 0||(e.duration=.8)),cNe(t),sNe(e)||(e=Ie(Ie({},e),aNe(n,t.to))),Ie(Ie({},t),uNe(e))}function dNe(e,t,n,r,i){var a,o=jR(r,e),s=(a=o.from)!==null&&a!==void 0?a:t.get(),u=LH(e,n);s==="none"&&u&&typeof n=="string"?s=zR(e,n):zH(s)&&typeof n=="string"?s=jH(n):!Array.isArray(n)&&zH(n)&&typeof s=="string"&&(n=jH(s));var l=LH(e,s);function c(){var d={from:s,to:n,velocity:t.getVelocity(),onComplete:i,onUpdate:function(h){return t.set(h)}};return o.type==="inertia"||o.type==="decay"?HIe(Ie(Ie({},d),o)):TH(Ie(Ie({},fNe(o,d,e)),{onUpdate:function(h){var p;d.onUpdate(h),(p=o.onUpdate)===null||p===void 0||p.call(o,h)},onComplete:function(){var h;d.onComplete(),(h=o.onComplete)===null||h===void 0||h.call(o)}}))}function f(){var d;return t.set(n),i(),(d=o==null?void 0:o.onComplete)===null||d===void 0||d.call(o),{stop:function(){}}}return!l||!u||o.type===!1?f:c}function zH(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function jH(e){return typeof e=="number"?0:zR("",e)}function jR(e,t){return e[t]||e.default||e}function W_(e,t,n,r){return r===void 0&&(r={}),t.start(function(i){var a,o,s=dNe(e,t,n,r,i),u=lNe(r,e),l=function(){return o=s()};return u?a=setTimeout(l,j_(u)):l(),function(){clearTimeout(a),o==null||o.stop()}})}var hNe=function(e){return/^\-?\d*\.?\d+$/.test(e)};function UH(e,t){e.indexOf(t)===-1&&e.push(t)}function WH(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var V_=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(t){var n=this;return UH(this.subscriptions,t),function(){return WH(n.subscriptions,t)}},e.prototype.notify=function(t,n,r){var i=this.subscriptions.length;if(!!i)if(i===1)this.subscriptions[0](t,n,r);else for(var a=0;a<i;a++){var o=this.subscriptions[a];o&&o(t,n,r)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),pNe=function(e){return!isNaN(parseFloat(e))},gNe=function(){function e(t){var n=this;this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new V_,this.velocityUpdateSubscribers=new V_,this.renderSubscribers=new V_,this.canTrackVelocity=!1,this.updateAndNotify=function(r,i){i===void 0&&(i=!0),n.prev=n.current,n.current=r;var a=u_(),o=a.delta,s=a.timestamp;n.lastUpdated!==s&&(n.timeDelta=o,n.lastUpdated=s,Mu.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),i&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Mu.postRender(n.velocityCheck)},this.velocityCheck=function(r){var i=r.timestamp;i!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=pNe(this.current)}return e.prototype.onChange=function(t){return this.updateSubscribers.add(t)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(t){return t(this.get()),this.renderSubscribers.add(t)},e.prototype.attach=function(t){this.passiveEffect=t},e.prototype.set=function(t,n){n===void 0&&(n=!0),!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?OH(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(t){var n=this;return this.stop(),new Promise(function(r){n.hasAnimated=!0,n.stopAnimation=t(r)}).then(function(){return n.clearAnimation()})},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function Ch(e){return new gNe(e)}var VH=function(e){return function(t){return t.test(e)}},mNe={test:function(e){return e==="auto"},parse:function(e){return e}},qH=[Sh,Tt,om,bf,gOe,pOe,mNe],q_=function(e){return qH.find(VH(e))},vNe=ma(ma([],mr(qH)),[va,ec]),yNe=function(e){return vNe.find(VH(e))};function bNe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Ch(n))}function xNe(e,t){var n=k_(e,t),r=n?e.makeTargetAnimatable(n,!1):{},i=r.transitionEnd,a=i===void 0?{}:i;r.transition;var o=To(r,["transitionEnd","transition"]);o=Ie(Ie({},o),a);for(var s in o){var u=BOe(o[s]);bNe(e,s,u)}}function wNe(e,t,n){var r,i,a,o,s=Object.keys(t).filter(function(h){return!e.hasValue(h)}),u=s.length;if(!!u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),d===null&&(d=(i=(r=n[c])!==null&&r!==void 0?r:e.readValue(c))!==null&&i!==void 0?i:t[c]),d!=null&&(typeof d=="string"&&hNe(d)?d=parseFloat(d):!yNe(d)&&ec.test(f)&&(d=zR(c,f)),e.addValue(c,Ch(d)),(a=(o=n)[c])!==null&&a!==void 0||(o[c]=d),e.setBaseTarget(c,d))}}function _Ne(e,t){if(!!t){var n=t[e]||t.default||t;return n.from}}function SNe(e,t,n){var r,i,a={};for(var o in e)a[o]=(r=_Ne(o,t))!==null&&r!==void 0?r:(i=n.getValue(o))===null||i===void 0?void 0:i.get();return a}function ENe(e,t,n){n===void 0&&(n={}),e.notifyAnimationStart();var r;if(Array.isArray(t)){var i=t.map(function(o){return UR(e,o,n)});r=Promise.all(i)}else if(typeof t=="string")r=UR(e,t,n);else{var a=typeof t=="function"?k_(e,t,n.custom):t;r=HH(e,a,n)}return r.then(function(){return e.notifyAnimationComplete(t)})}function UR(e,t,n){var r;n===void 0&&(n={});var i=k_(e,t,n.custom),a=(i||{}).transition,o=a===void 0?e.getDefaultTransition()||{}:a;n.transitionOverride&&(o=n.transitionOverride);var s=i?function(){return HH(e,i,n)}:function(){return Promise.resolve()},u=((r=e.variantChildren)===null||r===void 0?void 0:r.size)?function(h){h===void 0&&(h=0);var p=o.delayChildren,g=p===void 0?0:p,m=o.staggerChildren,v=o.staggerDirection;return ANe(e,t,g+h,m,v,n)}:function(){return Promise.resolve()},l=o.when;if(l){var c=mr(l==="beforeChildren"?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}else return Promise.all([s(),u(n.delay)])}function HH(e,t,n){var r,i=n===void 0?{}:n,a=i.delay,o=a===void 0?0:a,s=i.transitionOverride,u=i.type,l=e.makeTargetAnimatable(t),c=l.transition,f=c===void 0?e.getDefaultTransition():c,d=l.transitionEnd,h=To(l,["transition","transitionEnd"]);s&&(f=s);var p=[],g=u&&((r=e.animationState)===null||r===void 0?void 0:r.getState()[u]);for(var m in h){var v=e.getValue(m),y=h[m];if(!(!v||y===void 0||g&&kNe(g,m))){var b=W_(m,v,y,Ie({delay:o},f));p.push(b)}}return Promise.all(p).then(function(){d&&xNe(e,d)})}function ANe(e,t,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1);var o=[],s=(e.variantChildren.size-1)*r,u=i===1?function(l){return l===void 0&&(l=0),l*r}:function(l){return l===void 0&&(l=0),s-l*r};return Array.from(e.variantChildren).sort(CNe).forEach(function(l,c){o.push(UR(l,t,Ie(Ie({},a),{delay:n+u(c)})).then(function(){return l.notifyAnimationComplete(t)}))}),Promise.all(o)}function CNe(e,t){return e.sortNodePosition(t)}function kNe(e,t){var n=e.protectedKeys,r=e.needsAnimating,i=n.hasOwnProperty(t)&&r[t]!==!0;return r[t]=!1,i}var WR=[Sr.Animate,Sr.Hover,Sr.Tap,Sr.Drag,Sr.Focus,Sr.Exit],TNe=ma([],mr(WR)).reverse(),ONe=WR.length;function INe(e){return function(t){return Promise.all(t.map(function(n){var r=n.animation,i=n.options;return ENe(e,r,i)}))}}function NNe(e){var t=INe(e),n=RNe(),r={},i=!0,a=function(c,f){var d=k_(e,f);if(d){d.transition;var h=d.transitionEnd,p=To(d,["transition","transitionEnd"]);c=Ie(Ie(Ie({},c),p),h)}return c};function o(c){return r[c]!==void 0}function s(c){t=c(e)}function u(c,f){for(var d,h=e.getProps(),p=e.getVariantContext(!0)||{},g=[],m=new Set,v={},y=1/0,b=function(A){var _=TNe[A],E=n[_],C=(d=h[_])!==null&&d!==void 0?d:p[_],k=zs(C),T=_===f?E.isActive:null;T===!1&&(y=A);var I=C===p[_]&&C!==h[_]&&k;if(I&&i&&e.manuallyAnimateOnMount&&(I=!1),E.protectedKeys=Ie({},v),!E.isActive&&T===null||!C&&!E.prevProp||AR(C)||typeof C=="boolean")return"continue";var N=DNe(E.prevProp,C)||_===f&&E.isActive&&!I&&k||A>y&&k,O=Array.isArray(C)?C:[C],D=O.reduce(a,{});T===!1&&(D={});var L=E.prevResolvedValues,W=L===void 0?{}:L,G=Ie(Ie({},W),D),K=function(Oe){N=!0,m.delete(Oe),E.needsAnimating[Oe]=!0};for(var ee in G){var ce=D[ee],he=W[ee];v.hasOwnProperty(ee)||(ce!==he?My(ce)&&My(he)?PH(ce,he)?E.protectedKeys[ee]=!0:K(ee):ce!==void 0?K(ee):m.add(ee):ce!==void 0&&m.has(ee)?K(ee):E.protectedKeys[ee]=!0)}E.prevProp=C,E.prevResolvedValues=D,E.isActive&&(v=Ie(Ie({},v),D)),i&&e.blockInitialAnimation&&(N=!1),N&&!I&&g.push.apply(g,ma([],mr(O.map(function(Oe){return{animation:Oe,options:Ie({type:_},c)}}))))},x=0;x<ONe;x++)b(x);if(r=Ie({},v),m.size){var w={};m.forEach(function(A){var _=e.getBaseTarget(A);_!==void 0&&(w[A]=_)}),g.push({animation:w})}var S=Boolean(g.length);return i&&h.initial===!1&&!e.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function l(c,f,d){var h;return n[c].isActive===f?Promise.resolve():((h=e.variantChildren)===null||h===void 0||h.forEach(function(p){var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(c,f)}),n[c].isActive=f,u(d,c))}return{isAnimated:o,animateChanges:u,setActive:l,setAnimateFunction:s,getState:function(){return n}}}function DNe(e,t){return typeof t=="string"?t!==e:Cq(t)?!PH(t,e):!1}function cm(e){return e===void 0&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function RNe(){var e;return e={},e[Sr.Animate]=cm(!0),e[Sr.Hover]=cm(),e[Sr.Tap]=cm(),e[Sr.Drag]=cm(),e[Sr.Focus]=cm(),e[Sr.Exit]=cm(),e}var FNe={animation:Eh(function(e){var t=e.visualElement,n=e.animate;t.animationState||(t.animationState=NNe(t)),AR(n)&&Vt(function(){return n.subscribe(t)},[n])}),exit:Eh(function(e){var t=e.custom,n=e.visualElement,r=mr(dR(),2),i=r[0],a=r[1],o=Un(Ay);Vt(function(){var s,u,l=(s=n.animationState)===null||s===void 0?void 0:s.setActive(Sr.Exit,!i,{custom:(u=o==null?void 0:o.custom)!==null&&u!==void 0?u:t});!i&&(l==null||l.then(a))},[i])})},GH=function(){function e(t,n,r){var i=this,a=r===void 0?{}:r,o=a.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(!!(i.lastMoveEvent&&i.lastMoveEventInfo)){var d=qR(i.lastMoveEventInfo,i.history),h=i.startEvent!==null,p=NH(d.offset,{x:0,y:0})>=3;if(!(!h&&!p)){var g=d.point,m=u_().timestamp;i.history.push(Ie(Ie({},g),{timestamp:m}));var v=i.handlers,y=v.onStart,b=v.onMove;h||(y&&y(i.lastMoveEvent,d),i.startEvent=i.lastMoveEvent),b&&b(i.lastMoveEvent,d)}}},this.handlePointerMove=function(d,h){if(i.lastMoveEvent=d,i.lastMoveEventInfo=VR(h,i.transformPagePoint),eH(d)&&d.buttons===0){i.handlePointerUp(d,h);return}Mu.update(i.updatePoint,!0)},this.handlePointerUp=function(d,h){i.end();var p=i.handlers,g=p.onEnd,m=p.onSessionEnd,v=qR(VR(h,i.transformPagePoint),i.history);i.startEvent&&g&&g(d,v),m&&m(d,v)},!(tH(t)&&t.touches.length>1)){this.handlers=n,this.transformPagePoint=o;var s=TR(t),u=VR(s,this.transformPagePoint),l=u.point,c=u_().timestamp;this.history=[Ie(Ie({},l),{timestamp:c})];var f=n.onSessionStart;f&&f(t,qR(u,this.history)),this.removeListeners=$y(lm(window,"pointermove",this.handlePointerMove),lm(window,"pointerup",this.handlePointerUp),lm(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(t){this.handlers=t},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),fy.update(this.updatePoint)},e}();function VR(e,t){return t?{point:t(e.point)}:e}function KH(e,t){return{x:e.x-t.x,y:e.y-t.y}}function qR(e,t){var n=e.point;return{point:n,delta:KH(n,XH(t)),offset:KH(n,MNe(t)),velocity:PNe(t,.1)}}function MNe(e){return e[0]}function XH(e){return e[e.length-1]}function PNe(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,i=XH(e);n>=0&&(r=e[n],!(i.timestamp-r.timestamp>j_(t)));)n--;if(!r)return{x:0,y:0};var a=(i.timestamp-r.timestamp)/1e3;if(a===0)return{x:0,y:0};var o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function $Ne(e){return e}function YH(e){var t=e.top,n=e.left,r=e.right,i=e.bottom;return{x:{min:n,max:r},y:{min:t,max:i}}}function LNe(e){var t=e.x,n=e.y;return{top:n.min,bottom:n.max,left:t.min,right:t.max}}function BNe(e,t){var n=e.top,r=e.left,i=e.bottom,a=e.right;t===void 0&&(t=$Ne);var o=t({x:r,y:n}),s=t({x:a,y:i});return{top:o.y,left:o.x,bottom:s.y,right:s.x}}function xf(){return{x:{min:0,max:1},y:{min:0,max:1}}}function zNe(e){return{x:Ie({},e.x),y:Ie({},e.y)}}var ZH={translate:0,scale:1,origin:0,originPoint:0};function JH(){return{x:Ie({},ZH),y:Ie({},ZH)}}function Ja(e){return[e("x"),e("y")]}function QH(e,t,n){var r=t.min,i=t.max;return r!==void 0&&e<r?e=n?Za(r,e,n.min):Math.max(e,r):i!==void 0&&e>i&&(e=n?Za(i,e,n.max):Math.min(e,i)),e}function jNe(e,t,n,r,i){var a=e-t*n;return r?QH(a,r,i):a}function eG(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function UNe(e,t){var n=t.top,r=t.left,i=t.bottom,a=t.right;return{x:eG(e.x,r,a),y:eG(e.y,n,i)}}function tG(e,t){var n,r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&(n=mr([i,r],2),r=n[0],i=n[1]),{min:e.min+r,max:e.min+i}}function WNe(e,t){return{x:tG(e.x,t.x),y:tG(e.y,t.y)}}function VNe(e,t,n){var r=e.max-e.min,i=Za(t.min,t.max-r,n);return{min:i,max:i+r}}function qNe(e,t){var n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var nG=.35;function HNe(e){return e===!1?e=0:e===!0&&(e=nG),{x:rG(e,"left","right"),y:rG(e,"top","bottom")}}function rG(e,t,n){return{min:iG(e,t),max:iG(e,n)}}function iG(e,t){var n;return typeof e=="number"?e:(n=e[t])!==null&&n!==void 0?n:0}function aG(e,t){var n=e.getBoundingClientRect();return YH(BNe(n,t))}var GNe=function(e){return R_(0,1,e)};function oG(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=.01),NH(e,t)<n}function Ly(e){return e.max-e.min}function KNe(e,t){var n=.5,r=Ly(e),i=Ly(t);return i>r?n=Py(t.min,t.max-r,e.min):r>i&&(n=Py(e.min,e.max-i,t.min)),GNe(n)}function sG(e,t,n,r){r===void 0&&(r=.5),e.origin=r,e.originPoint=Za(t.min,t.max,e.origin),e.scale=Ly(n)/Ly(t),oG(e.scale,1,1e-4)&&(e.scale=1),e.translate=Za(n.min,n.max,e.origin)-e.originPoint,oG(e.translate)&&(e.translate=0)}function uG(e,t,n,r){sG(e.x,t.x,n.x,lG(r.originX)),sG(e.y,t.y,n.y,lG(r.originY))}function lG(e){return typeof e=="number"?e:.5}function cG(e,t,n){e.min=n.min+t.min,e.max=e.min+Ly(t)}function XNe(e,t){cG(e.target.x,e.relativeTarget.x,t.target.x),cG(e.target.y,e.relativeTarget.y,t.target.y)}var HR=function(e,t){return e.depth-t.depth};function fG(e){var t=e.projection.isEnabled;return t||e.shouldResetTransform()}function H_(e,t){t===void 0&&(t=[]);var n=e.parent;return n&&H_(n,t),fG(e)&&t.push(e),t}function YNe(e){var t=[],n=function(r){fG(r)&&t.push(r),r.children.forEach(n)};return e.children.forEach(n),t.sort(HR)}function G_(e){if(!e.shouldResetTransform()){var t=e.getLayoutState();e.notifyBeforeLayoutMeasure(t.layout),t.isHydrated=!0,t.layout=e.measureViewportBox(),t.layoutCorrected=zNe(t.layout),e.notifyLayoutMeasure(t.layout,e.prevViewportBox||t.layout),Mu.update(function(){return e.rebaseProjectionTarget()})}}function ZNe(e){e.shouldResetTransform()||(e.prevViewportBox=e.measureViewportBox(!1),e.rebaseProjectionTarget(!1,e.prevViewportBox))}function JNe(e,t,n,r){e.min=Za(t.min,n.min,r),e.max=Za(t.max,n.max,r)}function dG(e,t){return{min:t.min-e.min,max:t.max-e.min}}function fm(e,t){return{x:dG(e.x,t.x),y:dG(e.y,t.y)}}function QNe(e,t){var n=e.getLayoutId(),r=t.getLayoutId();return n!==r||r===void 0&&e!==t}function hG(e){var t=e.getProps(),n=t.drag,r=t._dragX;return n&&!r}function pG(e,t){e.min=t.min,e.max=t.max}function eDe(e,t){pG(e.x,t.x),pG(e.y,t.y)}function K_(e,t,n){var r=e-n,i=t*r;return n+i}function gG(e,t,n,r,i){return i!==void 0&&(e=K_(e,i,r)),K_(e,n,r)+t}function GR(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),e.min=gG(e.min,t,n,r,i),e.max=gG(e.max,t,n,r,i)}function tDe(e,t){var n=t.x,r=t.y;GR(e.x,n.translate,n.scale,n.originPoint),GR(e.y,r.translate,r.scale,r.originPoint)}function mG(e,t,n,r){var i=mr(r,3),a=i[0],o=i[1],s=i[2];e.min=t.min,e.max=t.max;var u=n[s]!==void 0?n[s]:.5,l=Za(t.min,t.max,u);GR(e,n[a],n[o],l,n.scale)}var vG=["x","scaleX","originX"],yG=["y","scaleY","originY"];function KR(e,t,n){mG(e.x,t.x,n,vG),mG(e.y,t.y,n,yG)}function bG(e,t,n,r,i){return e-=t,e=K_(e,1/n,r),i!==void 0&&(e=K_(e,1/i,r)),e}function nDe(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=.5);var a=Za(e.min,e.max,r)-t;e.min=bG(e.min,t,n,a,i),e.max=bG(e.max,t,n,a,i)}function xG(e,t,n){var r=mr(n,3),i=r[0],a=r[1],o=r[2];nDe(e,t[i],t[a],t[o],t.scale)}function wG(e,t){xG(e.x,t,vG),xG(e.y,t,yG)}function rDe(e,t,n){var r=n.length;if(!!r){t.x=t.y=1;for(var i,a,o=0;o<r;o++)i=n[o],a=i.getLayoutState().delta,t.x*=a.x.scale,t.y*=a.y.scale,tDe(e,a),hG(i)&&KR(e,e,i.getLatestValues())}}function iDe(e,t){t===void 0&&(t=!0);var n=e.getProjectionParent();if(!n)return!1;var r;return t?(r=fm(n.projection.target,e.projection.target),wG(r,n.getLatestValues())):r=fm(n.getLayoutState().layout,e.getLayoutState().layout),Ja(function(i){return e.setProjectionTargetAxis(i,r[i].min,r[i].max,!0)}),!0}var By=new Set;function _G(e,t,n){e[n]||(e[n]=[]),e[n].push(t)}function XR(e){return By.add(e),function(){return By.delete(e)}}function YR(){if(!!By.size){var e=0,t=[[]],n=[],r=function(s){return _G(t,s,e)},i=function(s){_G(n,s,e),e++};By.forEach(function(s){s(r,i),e=0}),By.clear();for(var a=n.length,o=0;o<=a;o++)t[o]&&t[o].forEach(SG),n[o]&&n[o].forEach(SG)}}var SG=function(e){return e()},aDe=new WeakMap,EG,oDe=function(){function e(t){var n=t.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=xf(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=n,this.visualElement.enableLayoutProjection(),aDe.set(n,this)}return e.prototype.start=function(t,n){var r=this,i=n===void 0?{}:n,a=i.snapToCursor,o=a===void 0?!1:a,s=i.cursorProgress,u=function(h){var p;r.stopMotion();var g=ZOe(h).point;(p=r.cancelLayout)===null||p===void 0||p.call(r),r.cancelLayout=XR(function(m,v){var y=H_(r.visualElement),b=YNe(r.visualElement),x=ma(ma([],mr(y)),mr(b)),w=!1;r.isLayoutDrag()&&r.visualElement.lockProjectionTarget(),v(function(){x.forEach(function(S){return S.resetTransform()})}),m(function(){G_(r.visualElement),b.forEach(G_)}),v(function(){x.forEach(function(S){return S.restoreTransform()}),o&&(w=r.snapToCursor(g))}),m(function(){var S=Boolean(r.getAxisMotionValue("x")&&!r.isExternalDrag());S||r.visualElement.rebaseProjectionTarget(!0,r.visualElement.measureViewportBox(!1)),r.visualElement.scheduleUpdateLayoutProjection();var A=r.visualElement.projection;Ja(function(_){if(!w){var E=A.target[_],C=E.min,k=E.max;r.cursorProgress[_]=s?s[_]:Py(C,k,g[_])}var T=r.getAxisMotionValue(_);T&&(r.originPoint[_]=T.get())})}),v(function(){Zg.update(),Zg.preRender(),Zg.render(),Zg.postRender()}),m(function(){return r.resolveDragConstraints()})})},l=function(h,p){var g,m,v,y=r.props,b=y.drag,x=y.dragPropagation;b&&!x&&(r.openGlobalLock&&r.openGlobalLock(),r.openGlobalLock=sH(b),!r.openGlobalLock)||(YR(),r.isDragging=!0,r.currentDirection=null,(m=(g=r.props).onDragStart)===null||m===void 0||m.call(g,h,p),(v=r.visualElement.animationState)===null||v===void 0||v.setActive(Sr.Drag,!0))},c=function(h,p){var g,m,v,y,b=r.props,x=b.dragPropagation,w=b.dragDirectionLock;if(!(!x&&!r.openGlobalLock)){var S=p.offset;if(w&&r.currentDirection===null){r.currentDirection=sDe(S),r.currentDirection!==null&&((m=(g=r.props).onDirectionLock)===null||m===void 0||m.call(g,r.currentDirection));return}r.updateAxis("x",p.point,S),r.updateAxis("y",p.point,S),(y=(v=r.props).onDrag)===null||y===void 0||y.call(v,h,p),EG=h}},f=function(h,p){return r.stop(h,p)},d=this.props.transformPagePoint;this.panSession=new GH(t,{onSessionStart:u,onStart:l,onMove:c,onSessionEnd:f},{transformPagePoint:d})},e.prototype.resolveDragConstraints=function(){var t=this,n=this.props,r=n.dragConstraints,i=n.dragElastic,a=this.visualElement.getLayoutState().layoutCorrected;r?this.constraints=hR(r)?this.resolveRefConstraints(a,r):UNe(a,r):this.constraints=!1,this.elastic=HNe(i),this.constraints&&!this.hasMutatedConstraints&&Ja(function(o){t.getAxisMotionValue(o)&&(t.constraints[o]=qNe(a[o],t.constraints[o]))})},e.prototype.resolveRefConstraints=function(t,n){var r=this.props,i=r.onMeasureDragConstraints,a=r.transformPagePoint,o=n.current;this.constraintsBox=aG(o,a);var s=WNe(t,this.constraintsBox);if(i){var u=i(LNe(s));this.hasMutatedConstraints=!!u,u&&(s=YH(u))}return s},e.prototype.cancelDrag=function(){var t,n;this.visualElement.unlockProjectionTarget(),(t=this.cancelLayout)===null||t===void 0||t.call(this),this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(Sr.Drag,!1)},e.prototype.stop=function(t,n){var r,i,a;(r=this.panSession)===null||r===void 0||r.end(),this.panSession=null;var o=this.isDragging;if(this.cancelDrag(),!!o){var s=n.velocity;this.animateDragEnd(s),(a=(i=this.props).onDragEnd)===null||a===void 0||a.call(i,t,n)}},e.prototype.snapToCursor=function(t){var n=this;return Ja(function(r){var i=n.props.drag;if(!!X_(r,i,n.currentDirection)){var a=n.getAxisMotionValue(r);if(a){var o=n.visualElement.getLayoutState().layout,s=o[r].max-o[r].min,u=o[r].min+s/2,l=t[r]-u;n.originPoint[r]=t[r],a.set(l)}else return n.cursorProgress[r]=.5,!0}}).includes(!0)},e.prototype.updateAxis=function(t,n,r){var i=this.props.drag;if(!!X_(t,i,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,r):this.updateVisualElementAxis(t,n)},e.prototype.updateAxisMotionValue=function(t,n){var r=this.getAxisMotionValue(t);if(!(!n||!r)){var i=this.originPoint[t]+n[t],a=this.constraints?QH(i,this.constraints[t],this.elastic[t]):i;r.set(a)}},e.prototype.updateVisualElementAxis=function(t,n){var r,i=this.visualElement.getLayoutState().layout[t],a=i.max-i.min,o=this.cursorProgress[t],s=jNe(n[t],a,o,(r=this.constraints)===null||r===void 0?void 0:r[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,s,s+a)},e.prototype.setProps=function(t){var n=t.drag,r=n===void 0?!1:n,i=t.dragDirectionLock,a=i===void 0?!1:i,o=t.dragPropagation,s=o===void 0?!1:o,u=t.dragConstraints,l=u===void 0?!1:u,c=t.dragElastic,f=c===void 0?nG:c,d=t.dragMomentum,h=d===void 0?!0:d,p=To(t,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=Ie({drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:l,dragElastic:f,dragMomentum:h},p)},e.prototype.getAxisMotionValue=function(t){var n=this.props,r=n.layout,i=n.layoutId,a="_drag"+t.toUpperCase();if(this.props[a])return this.props[a];if(!r&&i===void 0)return this.visualElement.getValue(t,0)},e.prototype.isLayoutDrag=function(){return!this.getAxisMotionValue("x")},e.prototype.isExternalDrag=function(){var t=this.props,n=t._dragX,r=t._dragY;return n||r},e.prototype.animateDragEnd=function(t){var n=this,r=this.props,i=r.drag,a=r.dragMomentum,o=r.dragElastic,s=r.dragTransition,u=iDe(this.visualElement,this.isLayoutDrag()&&!this.isExternalDrag()),l=this.constraints||{};if(u&&Object.keys(l).length&&this.isLayoutDrag()){var c=this.visualElement.getProjectionParent();if(c){var f=fm(c.projection.targetFinal,l);Ja(function(h){var p=f[h],g=p.min,m=p.max;l[h]={min:isNaN(g)?void 0:g,max:isNaN(m)?void 0:m}})}}var d=Ja(function(h){var p;if(!!X_(h,i,n.currentDirection)){var g=(p=l==null?void 0:l[h])!==null&&p!==void 0?p:{},m=o?200:1e6,v=o?40:1e7,y=Ie(Ie({type:"inertia",velocity:a?t[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10},s),g);return n.getAxisMotionValue(h)?n.startAxisValueAnimation(h,y):n.visualElement.startLayoutAnimation(h,y,u)}});return Promise.all(d).then(function(){var h,p;(p=(h=n.props).onDragTransitionEnd)===null||p===void 0||p.call(h)})},e.prototype.stopMotion=function(){var t=this;Ja(function(n){var r=t.getAxisMotionValue(n);r?r.stop():t.visualElement.stopLayoutAnimation()})},e.prototype.startAxisValueAnimation=function(t,n){var r=this.getAxisMotionValue(t);if(!!r){var i=r.get();return r.set(i),r.set(i),W_(t,r,0,n)}},e.prototype.scalePoint=function(){var t=this,n=this.props,r=n.drag,i=n.dragConstraints;if(!(!hR(i)||!this.constraintsBox)){this.stopMotion();var a={x:0,y:0};Ja(function(o){a[o]=KNe(t.visualElement.projection.target[o],t.constraintsBox[o])}),this.updateConstraints(function(){Ja(function(o){if(!!X_(o,r,null)){var s=VNe(t.visualElement.projection.target[o],t.constraintsBox[o],a[o]),u=s.min,l=s.max;t.visualElement.setProjectionTargetAxis(o,u,l)}})}),setTimeout(YR,1)}},e.prototype.updateConstraints=function(t){var n=this;this.cancelLayout=XR(function(r,i){var a=H_(n.visualElement);i(function(){return a.forEach(function(o){return o.resetTransform()})}),r(function(){return G_(n.visualElement)}),i(function(){return a.forEach(function(o){return o.restoreTransform()})}),r(function(){n.resolveDragConstraints()}),t&&i(t)})},e.prototype.mount=function(t){var n=this,r=t.getInstance(),i=lm(r,"pointerdown",function(u){var l=n.props,c=l.drag,f=l.dragListener,d=f===void 0?!0:f;c&&d&&n.start(u)}),a=CR(window,"resize",function(){n.scalePoint()}),o=t.onLayoutUpdate(function(){n.isDragging&&n.resolveDragConstraints()}),s=t.prevDragCursor;return s&&this.start(EG,{cursorProgress:s}),function(){i==null||i(),a==null||a(),o==null||o(),n.cancelDrag()}},e}();function X_(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function sDe(e,t){t===void 0&&(t=10);var n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}function uDe(e){var t=e.dragControls,n=e.visualElement,r=Un(A_).transformPagePoint,i=Cy(function(){return new oDe({visualElement:n})});i.setProps(Ie(Ie({},e),{transformPagePoint:r})),Vt(function(){return t&&t.subscribe(i)},[i]),Vt(function(){return i.mount(n)},[])}function lDe(e){var t=e.onPan,n=e.onPanStart,r=e.onPanEnd,i=e.onPanSessionStart,a=e.visualElement,o=t||n||r||i,s=Jt(null),u=Un(A_).transformPagePoint,l={onSessionStart:i,onStart:n,onMove:t,onEnd:function(f,d){s.current=null,r&&r(f,d)}};Vt(function(){s.current!==null&&s.current.updateHandlers(l)});function c(f){s.current=new GH(f,l,{transformPagePoint:u})}D_(a,"pointerdown",o&&c),OR(function(){return s.current&&s.current.end()})}var cDe={pan:Eh(lDe),drag:Eh(uDe)},zy;(function(e){e[e.Entering=0]="Entering",e[e.Present=1]="Present",e[e.Exiting=2]="Exiting"})(zy||(zy={}));var ZR;(function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"})(ZR||(ZR={}));function JR(e){return typeof e=="string"&&e.startsWith("var(--")}var AG=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function fDe(e){var t=AG.exec(e);if(!t)return[,];var n=mr(t,3),r=n[1],i=n[2];return[r,i]}function QR(e,t,n){var r=mr(fDe(e),2),i=r[0],a=r[1];if(!!i){var o=window.getComputedStyle(t).getPropertyValue(i);return o?o.trim():JR(a)?QR(a,t):a}}function dDe(e,t,n){var r,i=To(t,[]),a=e.getInstance();if(!(a instanceof HTMLElement))return{target:i,transitionEnd:n};n&&(n=Ie({},n)),e.forEachValue(function(l){var c=l.get();if(!!JR(c)){var f=QR(c,a);f&&l.set(f)}});for(var o in i){var s=i[o];if(!!JR(s)){var u=QR(s,a);!u||(i[o]=u,n&&((r=n[o])!==null&&r!==void 0||(n[o]=s)))}}return{target:i,transitionEnd:n}}function CG(e,t){return e/(t.max-t.min)*100}function hDe(e,t,n){var r=n.target;if(typeof e=="string")if(Tt.test(e))e=parseFloat(e);else return e;var i=CG(e,r.x),a=CG(e,r.y);return i+"% "+a+"%"}var kG="_$css";function pDe(e,t){var n=t.delta,r=t.treeScale,i=e,a=e.includes("var("),o=[];a&&(e=e.replace(AG,function(g){return o.push(g),kG}));var s=ec.parse(e);if(s.length>5)return i;var u=ec.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*r.x,f=n.y.scale*r.y;s[0+l]/=c,s[1+l]/=f;var d=Za(c,f,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);var h=u(s);if(a){var p=0;h=h.replace(kG,function(){var g=o[p];return p++,g})}return h}var jy={process:hDe},gDe={borderRadius:Ie(Ie({},jy),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:jy,borderTopRightRadius:jy,borderBottomLeftRadius:jy,borderBottomRightRadius:jy,boxShadow:{process:pDe}},TG=1e3,mDe=function(e){_q(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.frameTarget=xf(),n.currentAnimationTarget=xf(),n.isAnimating={x:!1,y:!1},n.stopAxisAnimation={x:void 0,y:void 0},n.isAnimatingTree=!1,n.animate=function(r,i,a){a===void 0&&(a={});var o=a.originBox,s=a.targetBox,u=a.visibilityAction,l=a.shouldStackAnimate,c=a.onComplete,f=a.prevParent,d=To(a,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete","prevParent"]),h=n.props,p=h.visualElement,g=h.layout;if(l===!1)return n.isAnimatingTree=!1,n.safeToRemove();if(!(n.isAnimatingTree&&l!==!0)){l&&(n.isAnimatingTree=!0),i=o||i,r=s||r;var m=!1,v=p.getProjectionParent();if(v){var y=v.prevViewportBox,b=v.getLayoutState().layout;f&&(s&&(b=f.getLayoutState().layout),o&&!QNe(f,v)&&f.prevViewportBox&&(y=f.prevViewportBox)),y&&xDe(f,o,s)&&(m=!0,i=fm(y,i),r=fm(b,r))}var x=yDe(i,r),w=Ja(function(S){var A,_;if(g==="position"){var E=r[S].max-r[S].min;i[S].max=i[S].min+E}if(!p.projection.isTargetLocked)if(u!==void 0)p.setVisibility(u===ZR.Show);else return x?n.animateAxis(S,r[S],i[S],Ie(Ie({},d),{isRelative:m})):((_=(A=n.stopAxisAnimation)[S])===null||_===void 0||_.call(A),p.setProjectionTargetAxis(S,r[S].min,r[S].max,m))});return p.syncRender(),Promise.all(w).then(function(){n.isAnimatingTree=!1,c&&c(),p.notifyLayoutAnimationComplete()})}},n}return t.prototype.componentDidMount=function(){var n=this,r=this.props.visualElement;r.animateMotionValue=W_,r.enableLayoutProjection(),this.unsubLayoutReady=r.onLayoutUpdate(this.animate),r.layoutSafeToRemove=function(){return n.safeToRemove()},rOe(gDe)},t.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),Ja(function(r){var i,a;return(a=(i=n.stopAxisAnimation)[r])===null||a===void 0?void 0:a.call(i)})},t.prototype.animateAxis=function(n,r,i,a){var o=this,s,u,l=a===void 0?{}:a,c=l.transition,f=l.isRelative;if(!(this.isAnimating[n]&&Uy(r,this.currentAnimationTarget[n]))){(u=(s=this.stopAxisAnimation)[n])===null||u===void 0||u.call(s),this.isAnimating[n]=!0;var d=this.props.visualElement,h=this.frameTarget[n],p=d.getProjectionAnimationProgress()[n];p.clearListeners(),p.set(0),p.set(0);var g=function(){var b=p.get()/TG;JNe(h,i,r,b),d.setProjectionTargetAxis(n,h.min,h.max,f)};g();var m=p.onChange(g);this.stopAxisAnimation[n]=function(){o.isAnimating[n]=!1,p.stop(),m()},this.currentAnimationTarget[n]=r;var v=c||d.getDefaultTransition()||bDe,y=W_(n==="x"?"layoutX":"layoutY",p,TG,v&&jR(v,"layout")).then(this.stopAxisAnimation[n]);return y}},t.prototype.safeToRemove=function(){var n,r;(r=(n=this.props).safeToRemove)===null||r===void 0||r.call(n)},t.prototype.render=function(){return null},t}(Ds);function vDe(e){var t=mr(dR(),2),n=t[1];return le(mDe,Ie({},e,{safeToRemove:n}))}function yDe(e,t){return!IG(e)&&!IG(t)&&(!Uy(e.x,t.x)||!Uy(e.y,t.y))}var OG={min:0,max:0};function IG(e){return Uy(e.x,OG)&&Uy(e.y,OG)}function Uy(e,t){return e.min===t.min&&e.max===t.max}var bDe={duration:.45,ease:[.4,0,.1,1]};function xDe(e,t,n){return e||!e&&!(t||n)}var wDe={layoutReady:function(e){return e.notifyLayoutReady()}};function NG(){var e=new Set;return{add:function(t){return e.add(t)},flush:function(t){var n=t===void 0?wDe:t,r=n.layoutReady,i=n.parent;XR(function(a,o){var s=Array.from(e).sort(HR),u=i?H_(i):[];o(function(){var l=ma(ma([],mr(u)),mr(s));l.forEach(function(c){return c.resetTransform()})}),a(function(){s.forEach(G_)}),o(function(){u.forEach(function(l){return l.restoreTransform()}),s.forEach(r)}),a(function(){s.forEach(function(l){l.isPresent&&(l.presence=zy.Present)})}),o(function(){Zg.preRender(),Zg.render()}),a(function(){Mu.postRender(function(){return s.forEach(_De)}),e.clear()})}),YR()}}}function _De(e){e.prevViewportBox=e.projection.target}var DG=ha(NG()),SDe=ha(NG());function kh(e){return!!e.forceUpdate}var EDe=function(e){_q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){var n=this.props,r=n.syncLayout,i=n.framerSyncLayout,a=n.visualElement;kh(r)&&r.register(a),kh(i)&&i.register(a),a.onUnmount(function(){kh(r)&&r.remove(a),kh(i)&&i.remove(a)})},t.prototype.getSnapshotBeforeUpdate=function(){var n=this.props,r=n.syncLayout,i=n.visualElement;return kh(r)?r.syncUpdate():(ZNe(i),r.add(i)),null},t.prototype.componentDidUpdate=function(){var n=this.props.syncLayout;kh(n)||n.flush()},t.prototype.render=function(){return null},t}(Bt.Component);function ADe(e){var t=Un(DG),n=Un(SDe);return Bt.createElement(EDe,Ie({},e,{syncLayout:t,framerSyncLayout:n}))}var CDe={measureLayout:ADe,layoutAnimation:vDe},kDe=function(){return{isEnabled:!1,isHydrated:!1,isTargetLocked:!1,target:xf(),targetFinal:xf()}};function RG(){return{isHydrated:!1,layout:xf(),layoutCorrected:xf(),treeScale:{x:1,y:1},delta:JH(),deltaFinal:JH(),deltaTransform:""}}var FG=RG();function Y_(e,t,n){var r=e.x,i=e.y,a=r.translate/t.x,o=i.translate/t.y,s="translate3d("+a+"px, "+o+"px, 0) ";if(n){var u=n.rotate,l=n.rotateX,c=n.rotateY;u&&(s+="rotate("+u+") "),l&&(s+="rotateX("+l+") "),c&&(s+="rotateY("+c+") ")}return s+="scale("+r.scale+", "+i.scale+")",!n&&s===TDe?"":s}function MG(e){var t=e.deltaFinal;return t.x.origin*100+"% "+t.y.origin*100+"% 0"}var TDe=Y_(FG.delta,FG.treeScale,{x:1,y:1}),Z_=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","SetAxisTarget","Unmount"];function ODe(){var e=Z_.map(function(){return new V_}),t={},n={clearAllListeners:function(){return e.forEach(function(r){return r.clear()})},updatePropListeners:function(r){return Z_.forEach(function(i){var a;(a=t[i])===null||a===void 0||a.call(t);var o="on"+i,s=r[o];s&&(t[i]=n[o](s))})}};return e.forEach(function(r,i){n["on"+Z_[i]]=function(a){return r.add(a)},n["notify"+Z_[i]]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.notify.apply(r,ma([],mr(a)))}}),n}function IDe(e,t,n){var r;for(var i in t){var a=t[i],o=n[i];if(yf(a))e.addValue(i,a);else if(yf(o))e.addValue(i,Ch(a));else if(o!==a)if(e.hasValue(i)){var s=e.getValue(i);!s.hasAnimated&&s.set(a)}else e.addValue(i,Ch((r=e.getStaticValue(i))!==null&&r!==void 0?r:a))}for(var i in n)t[i]===void 0&&e.removeValue(i);return t}function NDe(e,t,n,r){var i=e.delta,a=e.layout,o=e.layoutCorrected,s=e.treeScale,u=t.target;eDe(o,a),rDe(o,s,n),uG(i,o,u,r)}var DDe=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(t){UH(this.children,t),this.isDirty=!0},e.prototype.remove=function(t){WH(this.children,t),this.isDirty=!0},e.prototype.forEach=function(t){this.isDirty&&this.children.sort(HR),this.isDirty=!1,this.children.forEach(t)},e}();function RDe(e){var t=e.getProjectionParent();if(!t){e.rebaseProjectionTarget();return}var n=fm(t.getLayoutState().layout,e.getLayoutState().layout);Ja(function(r){e.setProjectionTargetAxis(r,n[r].min,n[r].max,!0)})}var PG=function(e){var t=e.treeType,n=t===void 0?"":t,r=e.build,i=e.getBaseTarget,a=e.makeTargetAnimatable,o=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.resetTransform,c=e.restoreTransform,f=e.removeValueFromRenderState,d=e.sortNodePosition,h=e.scrapeMotionValuesFromProps;return function(p,g){var m=p.parent,v=p.props,y=p.presenceId,b=p.blockInitialAnimation,x=p.visualState;g===void 0&&(g={});var w=x.latestValues,S=x.renderState,A,_=ODe(),E=kDe(),C,k=E,T=w,I,N=RG(),O,D=!1,L=new Map,W=new Map,G={},K,ee=Ie({},w),ce;function he(){!A||(B.isProjectionReady()&&(KR(k.targetFinal,k.target,T),uG(N.deltaFinal,N.layoutCorrected,k.targetFinal,w)),Oe(),s(A,S))}function Oe(){var R=w;if(O&&O.isActive()){var X=O.getCrossfadeState(B);X&&(R=X)}r(B,S,R,k,N,g,v)}function Te(){_.notifyUpdate(w)}function Re(){if(!!B.isProjectionReady()){var R=N.delta,X=N.treeScale,ge=X.x,xe=X.y,ze=N.deltaTransform;NDe(N,k,B.path,w),D&&B.notifyViewportBoxUpdate(k.target,R),D=!1;var Ke=Y_(R,X);(Ke!==ze||ge!==X.x||xe!==X.y)&&B.scheduleRender(),N.deltaTransform=Ke}}function me(){B.layoutTree.forEach(MDe)}function P(R,X){var ge=X.onChange(function(ze){w[R]=ze,v.onUpdate&&Mu.update(Te,!1,!0)}),xe=X.onRenderRequest(B.scheduleRender);W.set(R,function(){ge(),xe()})}var F=h(v);for(var V in F){var ae=F[V];w[V]!==void 0&&yf(ae)&&ae.set(w[V],!1)}var Y=T_(v),M=Tq(v),B=Ie(Ie({treeType:n,current:null,depth:m?m.depth+1:0,parent:m,children:new Set,path:m?ma(ma([],mr(m.path)),[m]):[],layoutTree:m?m.layoutTree:new DDe,presenceId:y,projection:E,variantChildren:M?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(m==null?void 0:m.isMounted()),blockInitialAnimation:b,isMounted:function(){return Boolean(A)},mount:function(R){A=B.current=R,B.pointTo(B),M&&m&&!Y&&(ce=m==null?void 0:m.addVariantChild(B)),m==null||m.children.add(B)},unmount:function(){fy.update(Te),fy.render(he),fy.preRender(B.updateLayoutProjection),W.forEach(function(R){return R()}),B.stopLayoutAnimation(),B.layoutTree.remove(B),ce==null||ce(),m==null||m.children.delete(B),I==null||I(),_.clearAllListeners()},addVariantChild:function(R){var X,ge=B.getClosestVariantNode();if(ge)return(X=ge.variantChildren)===null||X===void 0||X.add(R),function(){return ge.variantChildren.delete(R)}},sortNodePosition:function(R){return!d||n!==R.treeType?0:d(B.getInstance(),R.getInstance())},getClosestVariantNode:function(){return M?B:m==null?void 0:m.getClosestVariantNode()},scheduleUpdateLayoutProjection:m?m.scheduleUpdateLayoutProjection:function(){return Mu.preRender(B.updateTreeLayoutProjection,!1,!0)},getLayoutId:function(){return v.layoutId},getInstance:function(){return A},getStaticValue:function(R){return w[R]},setStaticValue:function(R,X){return w[R]=X},getLatestValues:function(){return w},setVisibility:function(R){B.isVisible!==R&&(B.isVisible=R,B.scheduleRender())},makeTargetAnimatable:function(R,X){return X===void 0&&(X=!0),a(B,R,v,X)},addValue:function(R,X){B.hasValue(R)&&B.removeValue(R),L.set(R,X),w[R]=X.get(),P(R,X)},removeValue:function(R){var X;L.delete(R),(X=W.get(R))===null||X===void 0||X(),W.delete(R),delete w[R],f(R,S)},hasValue:function(R){return L.has(R)},getValue:function(R,X){var ge=L.get(R);return ge===void 0&&X!==void 0&&(ge=Ch(X),B.addValue(R,ge)),ge},forEachValue:function(R){return L.forEach(R)},readValue:function(R){var X;return(X=w[R])!==null&&X!==void 0?X:u(A,R,g)},setBaseTarget:function(R,X){ee[R]=X},getBaseTarget:function(R){if(i){var X=i(v,R);if(X!==void 0&&!yf(X))return X}return ee[R]}},_),{build:function(){return Oe(),S},scheduleRender:function(){Mu.render(he,!1,!0)},syncRender:he,setProps:function(R){v=R,_.updatePropListeners(R),G=IDe(B,h(v),G)},getProps:function(){return v},getVariant:function(R){var X;return(X=v.variants)===null||X===void 0?void 0:X[R]},getDefaultTransition:function(){return v.transition},getVariantContext:function(R){if(R===void 0&&(R=!1),R)return m==null?void 0:m.getVariantContext();if(!Y){var X=(m==null?void 0:m.getVariantContext())||{};return v.initial!==void 0&&(X.initial=v.initial),X}for(var ge={},xe=0;xe<PDe;xe++){var ze=$G[xe],Ke=v[ze];(zs(Ke)||Ke===!1)&&(ge[ze]=Ke)}return ge},enableLayoutProjection:function(){E.isEnabled=!0,B.layoutTree.add(B)},lockProjectionTarget:function(){E.isTargetLocked=!0},unlockProjectionTarget:function(){B.stopLayoutAnimation(),E.isTargetLocked=!1},getLayoutState:function(){return N},setCrossfader:function(R){O=R},isProjectionReady:function(){return E.isEnabled&&E.isHydrated&&N.isHydrated},startLayoutAnimation:function(R,X,ge){ge===void 0&&(ge=!1);var xe=B.getProjectionAnimationProgress()[R],ze=ge?E.relativeTarget[R]:E.target[R],Ke=ze.min,Ze=ze.max,Lt=Ze-Ke;return xe.clearListeners(),xe.set(Ke),xe.set(Ke),xe.onChange(function(Je){B.setProjectionTargetAxis(R,Je,Je+Lt,ge)}),B.animateMotionValue(R,xe,0,X)},stopLayoutAnimation:function(){Ja(function(R){return B.getProjectionAnimationProgress()[R].stop()})},measureViewportBox:function(R){R===void 0&&(R=!0);var X=o(A,g);return R||wG(X,w),X},getProjectionAnimationProgress:function(){return K||(K={x:Ch(0),y:Ch(0)}),K},setProjectionTargetAxis:function(R,X,ge,xe){xe===void 0&&(xe=!1);var ze;xe?(E.relativeTarget||(E.relativeTarget=xf()),ze=E.relativeTarget[R]):(E.relativeTarget=void 0,ze=E.target[R]),E.isHydrated=!0,ze.min=X,ze.max=ge,D=!0,_.notifySetAxisTarget()},rebaseProjectionTarget:function(R,X){X===void 0&&(X=N.layout);var ge=B.getProjectionAnimationProgress(),xe=ge.x,ze=ge.y,Ke=!E.relativeTarget&&!E.isTargetLocked&&!xe.isAnimating()&&!ze.isAnimating();(R||Ke)&&Ja(function(Ze){var Lt=X[Ze],Je=Lt.min,Zt=Lt.max;B.setProjectionTargetAxis(Ze,Je,Zt)})},notifyLayoutReady:function(R){RDe(B),B.notifyLayoutUpdate(N.layout,B.prevViewportBox||N.layout,R)},resetTransform:function(){return l(B,A,v)},restoreTransform:function(){return c(A,S)},updateLayoutProjection:Re,updateTreeLayoutProjection:function(){B.layoutTree.forEach(FDe),Mu.preRender(me,!1,!0)},getProjectionParent:function(){if(C===void 0){for(var R=!1,X=B.path.length-1;X>=0;X--){var ge=B.path[X];if(ge.projection.isEnabled){R=ge;break}}C=R}return C},resolveRelativeTargetBox:function(){var R=B.getProjectionParent();if(!(!E.relativeTarget||!R)&&(XNe(E,R.projection),hG(R))){var X=E.target;KR(X,X,R.getLatestValues())}},shouldResetTransform:function(){return Boolean(v._layoutResetTransform)},pointTo:function(R){k=R.projection,T=R.getLatestValues(),I==null||I(),I=$y(R.onSetAxisTarget(B.scheduleUpdateLayoutProjection),R.onLayoutAnimationComplete(function(){var X;B.isPresent?B.presence=zy.Present:(X=B.layoutSafeToRemove)===null||X===void 0||X.call(B)}))},isPresent:!0,presence:zy.Entering});return B}};function FDe(e){e.resolveRelativeTargetBox()}function MDe(e){e.updateLayoutProjection()}var $G=ma(["initial"],mr(WR)),PDe=$G.length,$De=new Set(["width","height","top","left","right","bottom","x","y"]),LG=function(e){return $De.has(e)},LDe=function(e){return Object.keys(e).some(LG)},BG=function(e,t){e.set(t,!1),e.set(t)},zG=function(e){return e===Sh||e===Tt},jG;(function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"})(jG||(jG={}));var UG=function(e,t){return parseFloat(e.split(", ")[t])},WG=function(e,t){return function(n,r){var i=r.transform;if(i==="none"||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return UG(a[1],t);var o=i.match(/^matrix\((.+)\)$/);return o?UG(o[1],e):0}},BDe=new Set(["x","y","z"]),zDe=Oy.filter(function(e){return!BDe.has(e)});function jDe(e){var t=[];return zDe.forEach(function(n){var r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.syncRender(),t}var VG={width:function(e){var t=e.x;return t.max-t.min},height:function(e){var t=e.y;return t.max-t.min},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:WG(4,13),y:WG(5,14)},UDe=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),o=a.display,s=a.top,u=a.left,l=a.bottom,c=a.right,f=a.transform,d={top:s,left:u,bottom:l,right:c,transform:f};o==="none"&&t.setStaticValue("display",e.display||"block"),t.syncRender();var h=t.measureViewportBox();return n.forEach(function(p){var g=t.getValue(p);BG(g,VG[p](r,d)),e[p]=VG[p](h,a)}),e},WDe=function(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),t=Ie({},t),r=Ie({},r);var i=Object.keys(t).filter(LG),a=[],o=!1,s=[];if(i.forEach(function(l){var c=e.getValue(l);if(!!e.hasValue(l)){var f=n[l],d=t[l],h=q_(f),p;if(My(d))for(var g=d.length,m=d[0]===null?1:0;m<g;m++)p?Ey(q_(d[m])===p):p=q_(d[m]);else p=q_(d);if(h!==p)if(zG(h)&&zG(p)){var v=c.get();typeof v=="string"&&c.set(parseFloat(v)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===Tt&&(t[l]=d.map(parseFloat))}else(h==null?void 0:h.transform)&&(p==null?void 0:p.transform)&&(f===0||d===0)?f===0?c.set(p.transform(f)):t[l]=h.transform(d):(o||(a=jDe(e),o=!0),s.push(l),r[l]=r[l]!==void 0?r[l]:t[l],BG(c,d))}}),s.length){var u=UDe(t,e,s);return a.length&&a.forEach(function(l){var c=mr(l,2),f=c[0],d=c[1];e.getValue(f).set(d)}),e.syncRender(),{target:u,transitionEnd:r}}else return{target:t,transitionEnd:r}};function VDe(e,t,n,r){return LDe(t)?WDe(e,t,n,r):{target:t,transitionEnd:r}}var qDe=function(e,t,n,r){var i=dDe(e,t,r);return t=i.target,r=i.transitionEnd,VDe(e,t,n,r)};function HDe(e){return window.getComputedStyle(e)}var qG={treeType:"dom",readValueFromInstance:function(e,t){if(O_(t)){var n=BR(t);return n&&n.default||0}else{var r=HDe(e);return(Dq(t)?r.getPropertyValue(t):r[t])||0}},sortNodePosition:function(e,t){return e.compareDocumentPosition(t)&2?1:-1},getBaseTarget:function(e,t){var n;return(n=e.style)===null||n===void 0?void 0:n[t]},measureViewportBox:function(e,t){var n=t.transformPagePoint;return aG(e,n)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var i=n.transformValues;r===void 0&&(r=!0);var a=t.transition,o=t.transitionEnd,s=To(t,["transition","transitionEnd"]),u=SNe(s,a||{},e);if(i&&(o&&(o=i(o)),s&&(s=i(s)),u&&(u=i(u))),r){wNe(e,s,u);var l=qDe(e,s,u,o);o=l.transitionEnd,s=l.target}return Ie({transition:a,transitionEnd:o},s)},scrapeMotionValuesFromProps:ER,build:function(e,t,n,r,i,a,o){e.isVisible!==void 0&&(t.style.visibility=e.isVisible?"visible":"hidden");var s=r.isEnabled&&i.isHydrated;xR(t,n,r,i,a,o.transformTemplate,s?Y_:void 0,s?MG:void 0)},render:Kq},GDe=PG(qG),KDe=PG(Ie(Ie({},qG),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return O_(t)?((n=BR(t))===null||n===void 0?void 0:n.default)||0:(t=Xq.has(t)?t:Gq(t),e.getAttribute(t))},scrapeMotionValuesFromProps:Zq,build:function(e,t,n,r,i,a,o){var s=r.isEnabled&&i.isHydrated;SR(t,n,r,i,a,o.transformTemplate,s?Y_:void 0,s?MG:void 0)},render:Yq})),XDe=function(e,t){return pR(e)?KDe(t,{enableHardwareAcceleration:!1}):GDe(t,{enableHardwareAcceleration:!0})},YDe=Ie(Ie(Ie(Ie({},FNe),tNe),cDe),CDe),HG=tOe(function(e,t){return qOe(e,t,YDe,XDe)});function ZDe(){var e=Jt(!1),t=mr(an(0),2),n=t[0],r=t[1];return OR(function(){return e.current=!0}),st(function(){!e.current&&r(n+1)},[n])}var GG=0;function JDe(){var e=GG;return GG++,e}var eF=function(e){var t=e.children,n=e.initial,r=e.isPresent,i=e.onExitComplete,a=e.custom,o=e.presenceAffectsLayout,s=Cy(QDe),u=Cy(JDe),l=gr(function(){return{id:u,initial:n,isPresent:r,custom:a,onExitComplete:function(c){s.set(c,!0);var f=!0;s.forEach(function(d){d||(f=!1)}),f&&(i==null||i())},register:function(c){return s.set(c,!1),function(){return s.delete(c)}}}},o?void 0:[r]);return gr(function(){s.forEach(function(c,f){return s.set(f,!1)})},[r]),Vt(function(){!r&&!s.size&&(i==null||i())},[r]),le(Ay.Provider,{value:l},t)};function QDe(){return new Map}function dm(e){return e.key||""}function eRe(e,t){e.forEach(function(n){var r=dm(n);t.set(r,n)})}function tRe(e){var t=[];return T2.forEach(e,function(n){mh(n)&&t.push(n)}),t}var KG=function(e){var t=e.children,n=e.custom,r=e.initial,i=r===void 0?!0:r,a=e.onExitComplete,o=e.exitBeforeEnter,s=e.presenceAffectsLayout,u=s===void 0?!0:s,l=ZDe(),c=Un(DG);kh(c)&&(l=c.forceUpdate);var f=Jt(!0),d=tRe(t),h=Jt(d),p=Jt(new Map).current,g=Jt(new Set).current;if(eRe(d,p),f.current)return f.current=!1,le(Vi,null,d.map(function(S){return le(eF,{key:dm(S),isPresent:!0,initial:i?void 0:!1,presenceAffectsLayout:u},S)}));for(var m=ma([],mr(d)),v=h.current.map(dm),y=d.map(dm),b=v.length,x=0;x<b;x++){var w=v[x];y.indexOf(w)===-1?g.add(w):g.delete(w)}return o&&g.size&&(m=[]),g.forEach(function(S){if(y.indexOf(S)===-1){var A=p.get(S);if(!!A){var _=v.indexOf(S),E=function(){p.delete(S),g.delete(S);var C=h.current.findIndex(function(k){return k.key===S});h.current.splice(C,1),g.size||(h.current=d,l(),a&&a())};m.splice(_,0,le(eF,{key:dm(A),isPresent:!1,onExitComplete:E,custom:n,presenceAffectsLayout:u},A))}}}),m=m.map(function(S){var A=S.key;return g.has(A)?S:le(eF,{key:dm(S),isPresent:!0,presenceAffectsLayout:u},S)}),h.current=m,le(Vi,null,g.size?m:m.map(function(S){return lf(S)}))};function J_(){return J_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J_.apply(this,arguments)}var tF={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},Wy={scale:{enter:{scale:1},exit:{scale:.95}},fade:{enter:{opacity:1},exit:{opacity:0}},pushLeft:{enter:{x:"100%"},exit:{x:"-30%"}},pushRight:{enter:{x:"-100%"},exit:{x:"30%"}},pushUp:{enter:{y:"100%"},exit:{y:"-30%"}},pushDown:{enter:{y:"-100%"},exit:{y:"30%"}},slideLeft:{position:{left:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"-100%"}},slideRight:{position:{right:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"100%"}},slideUp:{position:{top:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"-100%"}},slideDown:{position:{bottom:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"100%"}}};function nF(e){var t,n=(t=e==null?void 0:e.direction)!=null?t:"right";switch(n){case"right":return Wy.slideRight;case"left":return Wy.slideLeft;case"bottom":return Wy.slideDown;case"top":return Wy.slideUp;default:return Wy.slideRight}}var XG={enter:{duration:.2,ease:tF.easeOut},exit:{duration:.1,ease:tF.easeIn}},Q_={enter:(e,t)=>J_({},e,{delay:hf(t)?t:t==null?void 0:t.enter}),exit:(e,t)=>J_({},e,{delay:hf(t)?t:t==null?void 0:t.exit})},nRe={enter:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:1,transition:(n=r==null?void 0:r.enter)!=null?n:Q_.enter(XG.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:0,transition:(n=r==null?void 0:r.exit)!=null?n:Q_.exit(XG.exit,a),transitionEnd:i==null?void 0:i.exit}}},rRe={initial:"exit",animate:"enter",exit:"exit",variants:nRe};function iRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Vy(){return Vy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vy.apply(this,arguments)}var YG={exit:{duration:.15,ease:tF.easeInOut},enter:{type:"spring",damping:25,stiffness:180}},aRe={exit:e=>{var t,{direction:n,transition:r,transitionEnd:i,delay:a}=e,{exit:o}=nF({direction:n});return Vy({},o,{transition:(t=r==null?void 0:r.exit)!=null?t:Q_.exit(YG.exit,a),transitionEnd:i==null?void 0:i.exit})},enter:e=>{var t,{direction:n,transitionEnd:r,transition:i,delay:a}=e,{enter:o}=nF({direction:n});return Vy({},o,{transition:(t=i==null?void 0:i.enter)!=null?t:Q_.enter(YG.enter,a),transitionEnd:r==null?void 0:r.enter})}},oRe=Kl((e,t)=>{var{direction:n="right",style:r,unmountOnExit:i,in:a,className:o,transition:s,transitionEnd:u,delay:l}=e,c=iRe(e,["direction","style","unmountOnExit","in","className","transition","transitionEnd","delay"]),f=nF({direction:n}),d=Object.assign({position:"fixed"},f.position,r),h=i?a&&i:!0,p=a||i?"enter":"exit",g={transitionEnd:u,transition:s,direction:n,delay:l};return le(KG,{custom:g},h&&le(HG.div,Vy({ref:t,initial:"exit",className:Gn("chakra-slide",o),animate:p,exit:"exit",custom:g,variants:aRe,style:d},c)))});function ZG(e){return e.sort((t,n)=>{var r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var sRe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function JG(e,t,n){var r=e+1;return n&&r>=t&&(r=0),r}function QG(e,t,n){var r=e-1;return n&&r<0&&(r=t),r}var rF=typeof window!="undefined"?uf:Vt,eS=e=>e;function iF(){return iF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iF.apply(this,arguments)}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uRe{constructor(){var t=this;Er(this,"descendants",new Map),Er(this,"register",n=>{if(n!=null)return sRe(n)?this.registerNode(n):r=>{this.registerNode(r,n)}}),Er(this,"unregister",n=>{this.descendants.delete(n);var r=ZG(Array.from(this.descendants.keys()));this.assignIndex(r)}),Er(this,"destroy",()=>{this.descendants.clear()}),Er(this,"assignIndex",n=>{this.descendants.forEach(r=>{var i=n.indexOf(r.node);r.index=i,r.node.dataset.index=r.index.toString()})}),Er(this,"count",()=>this.descendants.size),Er(this,"enabledCount",()=>this.enabledValues().length),Er(this,"values",()=>{var n=Array.from(this.descendants.values());return n.sort((r,i)=>r.index-i.index)}),Er(this,"enabledValues",()=>this.values().filter(n=>!n.disabled)),Er(this,"item",n=>{if(this.count()!==0)return this.values()[n]}),Er(this,"enabledItem",n=>{if(this.enabledCount()!==0)return this.enabledValues()[n]}),Er(this,"first",()=>this.item(0)),Er(this,"firstEnabled",()=>this.enabledItem(0)),Er(this,"last",()=>this.item(this.descendants.size-1)),Er(this,"lastEnabled",()=>{var n=this.enabledValues().length-1;return this.enabledItem(n)}),Er(this,"indexOf",n=>{var r,i;return n&&(r=(i=this.descendants.get(n))==null?void 0:i.index)!=null?r:-1}),Er(this,"enabledIndexOf",n=>n==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(n))),Er(this,"next",function(n,r){r===void 0&&(r=!0);var i=JG(n,t.count(),r);return t.item(i)}),Er(this,"nextEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=JG(a,t.enabledCount(),r);return t.enabledItem(o)}}),Er(this,"prev",function(n,r){r===void 0&&(r=!0);var i=QG(n,t.count()-1,r);return t.item(i)}),Er(this,"prevEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=QG(a,t.enabledCount()-1,r);return t.enabledItem(o)}}),Er(this,"registerNode",(n,r)=>{if(!(!n||this.descendants.has(n))){var i=Array.from(this.descendants.keys()).concat(n),a=ZG(i);r!=null&&r.disabled&&(r.disabled=!!r.disabled);var o=iF({node:n,index:-1},r);this.descendants.set(n,o),this.assignIndex(a)}})}}function lRe(){var[e]=an(()=>new uRe);return rF(()=>()=>e.destroy()),e}var[cRe,eK]=Pu({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function fRe(e){var t=eK(),[n,r]=an(-1),i=Jt(null);rF(()=>()=>{!i.current||t.unregister(i.current)},[]),rF(()=>{if(!!i.current){var o=Number(i.current.dataset.index);n!=o&&!Number.isNaN(o)&&r(o)}});var a=eS(e?t.register(e):t.register);return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(i.current),register:pf(a,i)}}function dRe(){var e=eS(cRe),t=()=>eS(eK()),n=i=>fRe(i),r=()=>lRe();return[e,t,r,n]}function qy(){return qy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qy.apply(this,arguments)}var hRe=e=>le(S_,qy({viewBox:"0 0 24 24"},e),le("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})),pRe=e=>le(S_,qy({viewBox:"0 0 24 24"},e),le("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})),tK=e=>le(S_,qy({viewBox:"0 0 24 24"},e),le("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"}));function tc(){return tc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tc.apply(this,arguments)}function gRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var nK={info:{icon:pRe,colorScheme:"blue"},warning:{icon:tK,colorScheme:"orange"},success:{icon:hRe,colorScheme:"green"},error:{icon:tK,colorScheme:"red"}},[mRe,vRe]=Pu({name:"AlertContext",errorMessage:"useAlertContext: `context` is undefined. Seems you forgot to wrap alert components in `<Alert />`"}),yRe=qt((e,t)=>{var n,r=is(e),{status:i="info"}=r,a=gRe(r,["status"]),o=(n=e.colorScheme)!=null?n:nK[i].colorScheme,s=gf("Alert",tc({},e,{colorScheme:o})),u=tc({width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden"},s.container);return le(mRe,{value:{status:i}},le(vy,{value:s},le(wt.div,tc({role:"alert",ref:t},a,{className:Gn("chakra-alert",e.className),__css:u}))))}),bRe=qt((e,t)=>{var n=Ii();return le(wt.div,tc({ref:t},e,{className:Gn("chakra-alert__title",e.className),__css:n.title}))}),xRe=qt((e,t)=>{var n=Ii(),r=tc({display:"inline"},n.description);return le(wt.div,tc({ref:t},e,{className:Gn("chakra-alert__desc",e.className),__css:r}))}),wRe=e=>{var{status:t}=vRe(),{icon:n}=nK[t],r=Ii();return le(wt.span,tc({display:"inherit"},e,{className:Gn("chakra-alert__icon",e.className),__css:r.icon}),le(n,{w:"100%",h:"100%"}))},[nIt,_Re]=Pu({strict:!1,name:"ButtonGroupContext"}),aF={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},SRe=wt("span",{baseStyle:aF});wt("input",{baseStyle:aF});function tS(){return tS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tS.apply(this,arguments)}function ERe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var ARe=cV({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),CRe=qt((e,t)=>{var n=tm("Spinner",e),r=is(e),{label:i="Loading...",thickness:a="2px",speed:o="0.45s",emptyColor:s="transparent",className:u}=r,l=ERe(r,["label","thickness","speed","emptyColor","className"]),c=Gn("chakra-spinner",u),f=tS({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:a,borderBottomColor:s,borderLeftColor:s,animation:ARe+" "+o+" linear infinite"},n);return le(wt.div,tS({ref:t,__css:f,className:c},l),i&&le(SRe,null,i))});function nS(){return nS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nS.apply(this,arguments)}function kRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var rK=e=>{var{label:t,placement:n,children:r=le(CRe,{color:"currentColor",width:"1em",height:"1em"}),className:i,__css:a}=e,o=kRe(e,["label","placement","spacing","children","className","__css"]),s=Gn("chakra-button__spinner",i),u=n==="start"?"marginEnd":"marginStart",l=gr(()=>nS({display:"flex",alignItems:"center",position:t?"relative":"absolute",[u]:t?"0.5rem":0,fontSize:"1em",lineHeight:"normal"},a),[a,t,u]);return le(wt.div,nS({className:s},o,{__css:l}),r)};function oF(){return oF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oF.apply(this,arguments)}function TRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iK=e=>{var{children:t,className:n}=e,r=TRe(e,["children","className"]),i=mh(t)?lf(t,{"aria-hidden":!0,focusable:!1}):t,a=Gn("chakra-button__icon",n);return le(wt.span,oF({display:"inline-flex",alignSelf:"center",flexShrink:0},r,{className:a}),i)};function ORe(e){var[t,n]=an(!e),r=st(a=>{!a||n(a.tagName==="BUTTON")},[]),i=t?"button":void 0;return{ref:r,type:i}}function IRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Hy(){return Hy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hy.apply(this,arguments)}var aK=qt((e,t)=>{var n=_Re(),r=tm("Button",Hy({},n,e)),i=is(e),{isDisabled:a=n==null?void 0:n.isDisabled,isLoading:o,isActive:s,isFullWidth:u,children:l,leftIcon:c,rightIcon:f,loadingText:d,iconSpacing:h="0.5rem",type:p,spinner:g,spinnerPlacement:m="start",className:v,as:y}=i,b=IRe(i,["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"]),x=gr(()=>{var _,E=Zl({},(_=r==null?void 0:r._focus)!=null?_:{},{zIndex:1});return Hy({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:u?"100%":"auto"},r,!!n&&{_focus:E})},[r,n,u]),{ref:w,type:S}=ORe(y),A={rightIcon:f,leftIcon:c,iconSpacing:h,children:l};return le(wt.button,Hy({disabled:a||o,ref:pf(t,w),as:y,type:p??S,"data-active":Oi(s),"data-loading":Oi(o),__css:x,className:Gn("chakra-button",v)},b),o&&m==="start"&&le(rK,{className:"chakra-button__spinner--start",label:d,placement:"start"},g),o?d||le(wt.span,{opacity:0},le(oK,A)):le(oK,A),o&&m==="end"&&le(rK,{className:"chakra-button__spinner--end",label:d,placement:"end"},g))});function oK(e){var{leftIcon:t,rightIcon:n,children:r,iconSpacing:i}=e;return le(Vi,null,t&&le(iK,{marginEnd:i},t),r,n&&le(iK,{marginStart:i},n))}function sF(){return sF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sF.apply(this,arguments)}function NRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var uF=qt((e,t)=>{var{icon:n,children:r,isRound:i,"aria-label":a}=e,o=NRe(e,["icon","children","isRound","aria-label"]),s=n||r,u=mh(s)?lf(s,{"aria-hidden":!0,focusable:!1}):null;return le(aK,sF({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":a},o),u)});function hm(){return hm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hm.apply(this,arguments)}function DRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function RRe(e){e===void 0&&(e={});var{defaultIsChecked:t,defaultChecked:n=t,isChecked:r,isFocusable:i,isDisabled:a,isReadOnly:o,isRequired:s,onChange:u,isIndeterminate:l,isInvalid:c,name:f,value:d,id:h,onBlur:p,onFocus:g,"aria-label":m,"aria-labelledby":v,"aria-invalid":y,"aria-describedby":b}=e,x=DRe(e,["defaultIsChecked","defaultChecked","isChecked","isFocusable","isDisabled","isReadOnly","isRequired","onChange","isIndeterminate","isInvalid","name","value","id","onBlur","onFocus","aria-label","aria-labelledby","aria-invalid","aria-describedby"]),w=hy(u),S=hy(p),A=hy(g),[_,E]=SD(),[C,k]=SD(),[T,I]=SD(),N=Jt(null),[O,D]=an(!0),[L,W]=an(!!n),[G,K]=a2e(r,L);bD({condition:!!t,message:'The "defaultIsChecked" prop has been deprecated and will be removed in a future version. Please use the "defaultChecked" prop instead, which mirrors default React checkbox behavior.'});var ee=st(F=>{if(o||a){F.preventDefault();return}G||W(K?F.target.checked:l?!0:F.target.checked),w==null||w(F)},[o,a,K,G,l,w]);Jg(()=>{N.current&&(N.current.indeterminate=Boolean(l))},[l]);var ce=a&&!i,he=st(F=>{F.key===" "&&I.on()},[I]),Oe=st(F=>{F.key===" "&&I.off()},[I]);Jg(()=>{if(!!N.current){var F=N.current.checked!==K;F&&W(N.current.checked)}},[N.current]);var Te=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=Y=>{Y.preventDefault(),I.on()};return hm({},F,{ref:V,"data-active":Oi(T),"data-hover":Oi(C),"data-checked":Oi(K),"data-focus":Oi(_),"data-indeterminate":Oi(l),"data-disabled":Oi(a),"data-invalid":Oi(c),"data-readonly":Oi(o),"aria-hidden":!0,onMouseDown:Fr(F.onMouseDown,ae),onMouseUp:Fr(F.onMouseUp,I.off),onMouseEnter:Fr(F.onMouseEnter,k.on),onMouseLeave:Fr(F.onMouseLeave,k.off)})},[T,K,a,_,C,l,c,o,I,k.off,k.on]),Re=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},x,F,{ref:pf(V,ae=>{!ae||D(ae.tagName==="LABEL")}),onClick:Fr(F.onClick,()=>{if(!O){var ae;(ae=N.current)==null||ae.click(),Xg(N.current,{nextTick:!0})}}),"data-disabled":Oi(a)})},[x,a,O]),me=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},F,{ref:pf(N,V),type:"checkbox",name:f,value:d,id:h,onChange:Fr(F.onChange,ee),onBlur:Fr(F.onBlur,S,E.off),onFocus:Fr(F.onFocus,A,E.on),onKeyDown:Fr(F.onKeyDown,he),onKeyUp:Fr(F.onKeyUp,Oe),required:s,checked:K,disabled:ce,readOnly:o,"aria-label":m,"aria-labelledby":v,"aria-invalid":y?Boolean(y):c,"aria-describedby":b,"aria-disabled":a,style:aF})},[f,d,h,ee,E.off,E.on,S,A,he,Oe,s,K,ce,o,m,v,y,c,b,a]),P=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),hm({},F,{ref:V,onMouseDown:Fr(F.onMouseDown,sK),onTouchStart:Fr(F.onTouchStart,sK),"data-disabled":Oi(a),"data-checked":Oi(K),"data-invalid":Oi(c)})},[K,a,c]);return{state:{isInvalid:c,isFocused:_,isChecked:K,isActive:T,isHovered:C,isIndeterminate:l,isDisabled:a,isReadOnly:o,isRequired:s},getRootProps:Re,getCheckboxProps:Te,getInputProps:me,getLabelProps:P,htmlProps:x}}function sK(e){e.preventDefault(),e.stopPropagation()}var[rIt,FRe]=Pu({strict:!1,name:"FormControlContext"});function rS(){return rS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rS.apply(this,arguments)}function uK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function lK(e){var t=MRe(e),{isDisabled:n,isInvalid:r,isReadOnly:i,isRequired:a}=t,o=uK(t,["isDisabled","isInvalid","isReadOnly","isRequired"]);return rS({},o,{disabled:n,readOnly:i,required:a,"aria-invalid":yD(r),"aria-required":yD(a),"aria-readonly":yD(i)})}function MRe(e){var t,n,r,i=FRe(),{id:a,disabled:o,readOnly:s,required:u,isRequired:l,isInvalid:c,isReadOnly:f,isDisabled:d,onFocus:h,onBlur:p}=e,g=uK(e,["id","disabled","readOnly","required","isRequired","isInvalid","isReadOnly","isDisabled","onFocus","onBlur"]),m=e["aria-describedby"]?[e["aria-describedby"]]:[];return i!=null&&i.hasFeedbackText&&i!=null&&i.isInvalid&&m.push(i.feedbackId),i!=null&&i.hasHelpText&&m.push(i.helpTextId),rS({},g,{"aria-describedby":m.join(" ")||void 0,id:a??(i==null?void 0:i.id),isDisabled:(t=o??d)!=null?t:i==null?void 0:i.isDisabled,isReadOnly:(n=s??f)!=null?n:i==null?void 0:i.isReadOnly,isRequired:(r=u??l)!=null?r:i==null?void 0:i.isRequired,isInvalid:c??(i==null?void 0:i.isInvalid),onFocus:Fr(i==null?void 0:i.onFocus,h),onBlur:Fr(i==null?void 0:i.onBlur,p)})}function lF(){return lF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lF.apply(this,arguments)}var cK=qt((e,t)=>{var n=gf("Input",e),r=is(e),i=lK(r),a=Gn("chakra-input",e.className);return le(wt.input,lF({},i,{__css:n.field,ref:t,className:a}))});cK.id="Input";var iS=wt("div");function cF(){return cF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cF.apply(this,arguments)}function PRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var $Re=qt((e,t)=>{var{direction:n,align:r,justify:i,wrap:a,basis:o,grow:s,shrink:u}=e,l=PRe(e,["direction","align","justify","wrap","basis","grow","shrink"]),c={display:"flex",flexDirection:n,alignItems:r,justifyContent:i,flexWrap:a,flexBasis:o,flexGrow:s,flexShrink:u};return le(wt.div,cF({ref:t,__css:c},l))});function aS(){return aS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aS.apply(this,arguments)}function fK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var dK=qt((e,t)=>{var{area:n,templateAreas:r,gap:i,rowGap:a,columnGap:o,column:s,row:u,autoFlow:l,autoRows:c,templateRows:f,autoColumns:d,templateColumns:h}=e,p=fK(e,["area","templateAreas","gap","rowGap","columnGap","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns"]),g={display:"grid",gridArea:n,gridTemplateAreas:r,gridGap:i,gridRowGap:a,gridColumnGap:o,gridAutoColumns:d,gridColumn:s,gridRow:u,gridAutoFlow:l,gridAutoRows:c,gridTemplateRows:f,gridTemplateColumns:h};return le(wt.div,aS({ref:t,__css:g},p))});function hK(e){return dy(e,t=>t==="auto"?"auto":"span "+t+"/span "+t)}var Th=qt((e,t)=>{var{colSpan:n,colStart:r,colEnd:i,rowEnd:a,rowSpan:o,rowStart:s}=e,u=fK(e,["colSpan","colStart","colEnd","rowEnd","rowSpan","rowStart"]),l=r_({gridColumn:hK(n),gridRow:hK(o),gridColumnStart:r,gridColumnEnd:i,gridRowStart:s,gridRowEnd:a});return le(wt.div,aS({ref:t,__css:l},u))});function fF(){return fF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fF.apply(this,arguments)}function LRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var BRe=qt((e,t)=>{var n=tm("Heading",e),r=is(e),i=LRe(r,["className"]);return le(wt.h2,fF({ref:t,className:Gn("chakra-heading",e.className)},i,{__css:n}))});function dF(){return dF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dF.apply(this,arguments)}function zRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var jRe=qt((e,t)=>{var n=tm("Link",e),r=is(e),{className:i,isExternal:a}=r,o=zRe(r,["className","isExternal"]);return le(wt.a,dF({target:a?"_blank":void 0,rel:a?"noopener noreferrer":void 0,ref:t,className:Gn("chakra-link",i)},o,{__css:n}))});function pm(){return pm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pm.apply(this,arguments)}function pK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var URe=qt((e,t)=>{var n=gf("List",e),r=is(e),{children:i,styleType:a="none",stylePosition:o,spacing:s}=r,u=pK(r,["children","styleType","stylePosition","spacing"]),l=_D(i),c="& > *:not(style) ~ *:not(style)",f=s?{[c]:{mt:s}}:{};return le(vy,{value:n},le(wt.ul,pm({ref:t,listStyleType:a,listStylePosition:o,role:"list",__css:pm({},n.container,f)},u),l))}),WRe=qt((e,t)=>{var n=pK(e,["as"]);return le(URe,pm({ref:t,as:"ul",styleType:"initial",marginStart:"1em"},n))}),VRe=qt((e,t)=>{var n=Ii();return le(wt.li,pm({ref:t},e,{__css:n.item}))});function hF(){return hF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hF.apply(this,arguments)}function qRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var HRe=qt((e,t)=>{var{columns:n,spacingX:r,spacingY:i,spacing:a,minChildWidth:o}=e,s=qRe(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),u=o?KRe(o):XRe(n);return le(dK,hF({ref:t,gap:a,columnGap:r,rowGap:i,templateColumns:u},s))});function GRe(e){return hf(e)?e+"px":e}function KRe(e){return dy(e,t=>dV(t)?null:"repeat(auto-fit, minmax("+GRe(t)+", 1fr))")}function XRe(e){return dy(e,t=>dV(t)?null:"repeat("+t+", minmax(0, 1fr))")}var YRe=wt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}}),pF="& > *:not(style) ~ *:not(style)";function ZRe(e){var{spacing:t,direction:n}=e,r={column:{marginTop:t,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:t},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:t,marginStart:0},"row-reverse":{marginTop:0,marginEnd:t,marginBottom:0,marginStart:0}};return{flexDirection:n,[pF]:dy(n,i=>r[i])}}function JRe(e){var{spacing:t,direction:n}=e,r={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":dy(n,i=>r[i])}}function QRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function gm(){return gm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gm.apply(this,arguments)}var eFe=e=>le(wt.div,gm({className:"chakra-stack__item"},e,{__css:gm({display:"inline-block",flex:"0 0 auto",minWidth:0},e.__css)})),gK=qt((e,t)=>{var{isInline:n,direction:r,align:i,justify:a,spacing:o="0.5rem",wrap:s,children:u,divider:l,className:c,shouldWrapChildren:f}=e,d=QRe(e,["isInline","direction","align","justify","spacing","wrap","children","divider","className","shouldWrapChildren"]),h=n?"row":r??"column",p=gr(()=>ZRe({direction:h,spacing:o}),[h,o]),g=gr(()=>JRe({spacing:o,direction:h}),[o,h]),m=!!l,v=!f&&!m,y=_D(u),b=v?y:y.map((w,S)=>{var A=typeof w.key!="undefined"?w.key:S,_=S+1===y.length,E=le(eFe,{key:A},w),C=f?E:w;if(!m)return C;var k=lf(l,{__css:g}),T=_?null:k;return le(Vi,{key:A},C,T)}),x=Gn("chakra-stack",c);return le(wt.div,gm({ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:p.flexDirection,flexWrap:s,className:x,__css:m?{}:{[pF]:p[pF]}},d),b)}),tFe=qt((e,t)=>le(gK,gm({align:"center"},e,{direction:"row",ref:t})));function gF(){return gF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gF.apply(this,arguments)}function nFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var rFe=qt((e,t)=>{var n=tm("Text",e),r=is(e),i=nFe(r,["className","align","decoration","casing"]),a=r_({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return le(wt.p,gF({ref:t,className:Gn("chakra-text",e.className)},a,i,{__css:n}))});function wf(){return wf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wf.apply(this,arguments)}function mF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iFe=qt((e,t)=>{var n=gf("Table",e),r=is(e),{className:i}=r,a=mF(r,["className"]);return le(vy,{value:n},le(wt.table,wf({role:"table",ref:t,__css:n.table,className:Gn("chakra-table",i)},a)))}),aFe=qt((e,t)=>{var n=Ii();return le(wt.thead,wf({},e,{ref:t,__css:n.thead}))}),oFe=qt((e,t)=>{var n=Ii();return le(wt.tbody,wf({},e,{ref:t,__css:n.tbody}))}),sFe=qt((e,t)=>{var{isNumeric:n}=e,r=mF(e,["isNumeric"]),i=Ii();return le(wt.th,wf({},r,{ref:t,__css:i.th,"data-is-numeric":n}))}),uFe=qt((e,t)=>{var n=Ii();return le(wt.tr,wf({role:"row"},e,{ref:t,__css:n.tr}))}),lFe=qt((e,t)=>{var{isNumeric:n}=e,r=mF(e,["isNumeric"]),i=Ii();return le(wt.td,wf({role:"gridcell"},r,{ref:t,__css:i.td,"data-is-numeric":n}))});function cFe(){var e=Jt(new Map),t=e.current,n=st((i,a,o,s)=>{e.current.set(o,{type:a,el:i,options:s}),i.addEventListener(a,o,s)},[]),r=st((i,a,o,s)=>{i.removeEventListener(a,o,s),e.current.delete(o)},[]);return Vt(()=>()=>{t.forEach((i,a)=>{r(i.el,i.type,a,i.options)})},[r,t]),{add:n,remove:r}}function oS(){return oS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oS.apply(this,arguments)}function fFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function vF(e){var t=e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function dFe(e){e===void 0&&(e={});var{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:i=!0,clickOnSpace:a=!0,onMouseDown:o,onMouseUp:s,onClick:u,onKeyDown:l,onKeyUp:c,tabIndex:f,onMouseOver:d,onMouseLeave:h}=e,p=fFe(e,["ref","isDisabled","isFocusable","clickOnEnter","clickOnSpace","onMouseDown","onMouseUp","onClick","onKeyDown","onKeyUp","tabIndex","onMouseOver","onMouseLeave"]),[g,m]=an(!0),[v,y]=an(!1),b=cFe(),x=L=>{!L||L.tagName!=="BUTTON"&&m(!1)},w=g?f:f||0,S=n&&!r,A=st(L=>{if(n){L.stopPropagation(),L.preventDefault();return}var W=L.currentTarget;W.focus(),u==null||u(L)},[n,u]),_=st(L=>{v&&vF(L)&&(L.preventDefault(),L.stopPropagation(),y(!1),b.remove(document,"keyup",_,!1))},[v,b]),E=st(L=>{if(l==null||l(L),!(n||L.defaultPrevented||L.metaKey)&&!(!vF(L.nativeEvent)||g)){var W=i&&L.key==="Enter",G=a&&L.key===" ";if(G&&(L.preventDefault(),y(!0)),W){L.preventDefault();var K=L.currentTarget;K.click()}b.add(document,"keyup",_,!1)}},[n,g,l,i,a,b,_]),C=st(L=>{if(c==null||c(L),!(n||L.defaultPrevented||L.metaKey)&&!(!vF(L.nativeEvent)||g)){var W=a&&L.key===" ";if(W){L.preventDefault(),y(!1);var G=L.currentTarget;G.click()}}},[a,g,n,c]),k=st(L=>{L.button===0&&(y(!1),b.remove(document,"mouseup",k,!1))},[b]),T=st(L=>{if(!bV(L)){if(n){L.stopPropagation(),L.preventDefault();return}g||y(!0);var W=L.currentTarget;W.focus({preventScroll:!0}),b.add(document,"mouseup",k,!1),o==null||o(L)}},[n,g,o,b,k]),I=st(L=>{bV(L)||(g||y(!1),s==null||s(L))},[s,g]),N=st(L=>{if(n){L.preventDefault();return}d==null||d(L)},[n,d]),O=st(L=>{v&&(L.preventDefault(),y(!1)),h==null||h(L)},[v,h]),D=pf(t,x);return g?oS({},p,{ref:D,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:A,onMouseDown:o,onMouseUp:s,onKeyUp:c,onKeyDown:l,onMouseOver:d,onMouseLeave:h}):oS({},p,{ref:D,role:"button","data-active":Oi(v),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:w,onClick:A,onMouseDown:T,onMouseUp:I,onKeyUp:C,onKeyDown:E,onMouseOver:N,onMouseLeave:O})}function hFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var pFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",gFe=pFe,mFe=gFe;function mK(){}function vK(){}vK.resetWarningCache=mK;var vFe=function(){function e(r,i,a,o,s,u){if(u!==mFe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:vK,resetWarningCache:mK};return n.PropTypes=n,n};vFe();var yF="data-focus-lock",yK="data-focus-lock-disabled",yFe="data-no-focus-lock",bFe="data-autofocus-inside";function xFe(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function wFe(e,t){var n=an(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function bK(e,t){return wFe(t,function(n){return e.forEach(function(r){return xFe(r,n)})})}var bF={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sS=function(){return sS=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},sS.apply(this,arguments)};function _Fe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function xK(e){return e}function wK(e,t){t===void 0&&(t=xK);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=t(a,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(r=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(a),o=n}var u=function(){var c=o;o=[],c.forEach(a)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){o.push(c),l()},filter:function(c){return o=o.filter(c),n}}}};return i}function xF(e,t){return t===void 0&&(t=xK),wK(e,t)}function _K(e){e===void 0&&(e={});var t=wK(null);return t.options=sS({async:!0,ssr:!1},e),t}var SK=function(e){var t=e.sideCar,n=_Fe(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return le(r,sS({},n))};SK.isSideCarExport=!0;function SFe(e,t){return e.useMedium(t),SK}var EK=xF({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),AK=xF(),EFe=xF(),AFe=_K({async:!0}),CFe=[],wF=Kl(function(t,n){var r,i=an(),a=i[0],o=i[1],s=Jt(),u=Jt(!1),l=Jt(null),c=t.children,f=t.disabled,d=t.noFocusGuards,h=t.persistentFocus,p=t.crossFrame,g=t.autoFocus;t.allowTextSelection;var m=t.group,v=t.className,y=t.whiteList,b=t.shards,x=b===void 0?CFe:b,w=t.as,S=w===void 0?"div":w,A=t.lockProps,_=A===void 0?{}:A,E=t.sideCar,C=t.returnFocus,k=t.onActivation,T=t.onDeactivation,I=an({}),N=I[0],O=st(function(){l.current=l.current||document&&document.activeElement,s.current&&k&&k(s.current),u.current=!0},[k]),D=st(function(){u.current=!1,T&&T(s.current)},[T]),L=st(function(Te){var Re=l.current;if(Boolean(C)&&Re&&Re.focus){var me=typeof C=="object"?C:void 0;l.current=null,Te?Promise.resolve().then(function(){return Re.focus(me)}):Re.focus(me)}},[C]),W=st(function(Te){u.current&&EK.useMedium(Te)},[]),G=AK.useMedium,K=st(function(Te){s.current!==Te&&(s.current=Te,o(Te))},[]),ee=yh((r={},r[yK]=f&&"disabled",r[yF]=m,r),_),ce=d!==!0,he=ce&&d!=="tail",Oe=bK([n,K]);return le(Vi,null,ce&&[le("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:bF}),le("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:bF})],!f&&le(E,{id:N,sideCar:AFe,observed:a,disabled:f,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:y,shards:x,onActivation:O,onDeactivation:D,returnFocus:L}),le(S,yh({ref:Oe},ee,{className:v,onBlur:G,onFocus:W}),c),he&&le("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:bF}))});wF.propTypes={},wF.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var CK=wF;function _F(e,t){return _F=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},_F(e,t)}function kFe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_F(e,t)}function TFe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OFe(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var a=[],o;function s(){o=e(a.map(function(l){return l.props})),t(o)}var u=function(l){kFe(c,l);function c(){return l.apply(this,arguments)||this}c.peek=function(){return o};var f=c.prototype;return f.componentDidMount=function(){a.push(this),s()},f.componentDidUpdate=function(){s()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),s()},f.render=function(){return Bt.createElement(i,this.props)},c}(k2);return TFe(u,"displayName","SideEffect("+n(i)+")"),u}}var _f=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},SF=function(e){return Array.isArray(e)?e:[e]},IFe=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var a=e[r].compareDocumentPosition(e[i]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,s){return!t.has(s)})},kK=function(e){return e.parentNode?kK(e.parentNode):e},EF=function(e){var t=SF(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(yF);return n.push.apply(n,i?IFe(_f(kK(r).querySelectorAll("["+yF+'="'+i+'"]:not(['+yK+'="disabled"])'))):[r]),n},[])},NFe=function(e){return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},TK=function(e){return!e||e===document||e&&e.nodeType===Node.DOCUMENT_NODE||!NFe(window.getComputedStyle(e,null))&&TK(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode)},DFe=function(e){return!((e.tagName==="INPUT"||e.tagName==="BUTTON")&&(e.type==="hidden"||e.disabled))},AF=function(e){return Boolean(e&&e.dataset&&e.dataset.focusGuard)},uS=function(e){return!AF(e)},RFe=function(e){return Boolean(e)},FFe=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},OK=function(e,t,n){return _f(e).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!t||r.tabIndex>=0}).sort(FFe)},MFe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],CF=MFe.join(","),PFe=CF+", [data-focus-guard]",kF=function(e,t){return e.reduce(function(n,r){return n.concat(_f(r.querySelectorAll(t?PFe:CF)),r.parentNode?_f(r.parentNode.querySelectorAll(CF)).filter(function(i){return i===r}):[])},[])},$Fe=function(e){var t=e.querySelectorAll("["+bFe+"]");return _f(t).map(function(n){return kF([n])}).reduce(function(n,r){return n.concat(r)},[])},TF=function(e){return _f(e).filter(function(t){return TK(t)}).filter(function(t){return DFe(t)})},OF=function(e,t){return OK(TF(kF(e,t)),!0,t)},IK=function(e){return OK(TF(kF(e)),!1)},LFe=function(e){return TF($Fe(e))},IF=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&IF(e.parentNode,t),t},NF=function(e,t){for(var n=IF(e),r=IF(t),i=0;i<n.length;i+=1){var a=n[i];if(r.indexOf(a)>=0)return a}return!1},NK=function(e,t,n){var r=SF(e),i=SF(t),a=r[0],o=!1;return i.filter(Boolean).forEach(function(s){o=NF(o||s,s)||o,n.filter(Boolean).forEach(function(u){var l=NF(a,u);l&&(!o||l.contains(o)?o=l:o=NF(l,o))})}),o},BFe=function(e){return e.reduce(function(t,n){return t.concat(LFe(n))},[])},zFe=function(e){var t=EF(e).filter(uS),n=NK(e,e,t),r=OF([n],!0),i=OF(t).filter(function(a){var o=a.node;return uS(o)}).map(function(a){var o=a.node;return o});return r.map(function(a){var o=a.node,s=a.index;return{node:o,index:s,lockItem:i.indexOf(o)>=0,guard:AF(o)}})},jFe=function(e){return e===document.activeElement},UFe=function(e){return Boolean(_f(e.querySelectorAll("iframe")).some(function(t){return jFe(t)}))},DK=function(e){var t=document&&document.activeElement;return!t||t.dataset&&t.dataset.focusGuard?!1:EF(e).reduce(function(n,r){return n||r.contains(t)||UFe(r)},!1)},WFe=function(){return document&&_f(document.querySelectorAll("["+yFe+"]")).some(function(e){return e.contains(document.activeElement)})},RK=function(e){return e.tagName==="INPUT"&&e.type==="radio"},VFe=function(e,t){return t.filter(RK).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},DF=function(e,t){return RK(e)&&e.name?VFe(e,t):e},qFe=function(e){var t=new Set;return e.forEach(function(n){return t.add(DF(n,e))}),e.filter(function(n){return t.has(n)})},FK=function(e){return e[0]&&e.length>1?DF(e[0],e):e[0]},MK=function(e,t){return e.length>1?e.indexOf(DF(e[t],e)):t},PK="NEW_FOCUS",HFe=function(e,t,n,r){var i=e.length,a=e[0],o=e[i-1],s=AF(n);if(!(e.indexOf(n)>=0)){var u=t.indexOf(n),l=r?t.indexOf(r):u,c=r?e.indexOf(r):-1,f=u-l,d=t.indexOf(a),h=t.indexOf(o),p=qFe(t),g=p.indexOf(n)-(r?p.indexOf(r):u),m=MK(e,0),v=MK(e,i-1);if(u===-1||c===-1)return PK;if(!f&&c>=0)return c;if(u<=d&&s&&Math.abs(f)>1)return v;if(u>=h&&s&&Math.abs(f)>1)return m;if(f&&Math.abs(g)>1)return c;if(u<=d)return v;if(u>h)return m;if(f)return Math.abs(f)>1?c:(i+c+f)%i}},GFe=function(e){return function(t){return t.autofocus||t.dataset&&!!t.dataset.autofocus||e.indexOf(t)>=0}},KFe=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(RFe)},XFe=function(e,t){var n=document&&document.activeElement,r=EF(e).filter(uS),i=NK(n||e,e,r),a=IK(r),o=OF(r).filter(function(d){var h=d.node;return uS(h)});if(!(!o[0]&&(o=a,!o[0]))){var s=IK([i]).map(function(d){var h=d.node;return h}),u=KFe(s,o),l=u.map(function(d){var h=d.node;return h}),c=HFe(l,s,n,t);if(c===PK){var f=a.map(function(d){var h=d.node;return h}).filter(GFe(BFe(r)));return{node:f&&f.length?FK(f):FK(l)}}return c===void 0?c:u[c]}},YFe=function(e){e.focus(),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},RF=0,FF=!1,ZFe=function(e,t){var n=XFe(e,t);if(!FF&&n){if(RF>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),FF=!0,setTimeout(function(){FF=!1},1);return}RF++,YFe(n.node),RF--}},$K=ZFe;function LK(e){var t=window,n=t.setImmediate;typeof n!="undefined"?n(e):setTimeout(e,1)}var JFe=function(){return document&&document.activeElement===document.body},QFe=function(){return JFe()||WFe()},mm=null,vm=null,ym=null,Gy=!1,e3e=function(){return!0},t3e=function(t){return(mm.whiteList||e3e)(t)},n3e=function(t,n){ym={observerNode:t,portaledElement:n}},r3e=function(t){return ym&&ym.portaledElement===t};function BK(e,t,n,r){var i=null,a=e;do{var o=r[a];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(a!==e)return;i=null}else break}while((a+=n)!==t);i&&(i.node.tabIndex=0)}var i3e=function(t){return t&&"current"in t?t.current:t},a3e=function(t){return t?Boolean(Gy):Gy==="meanwhile"},lS=function(){var t=!1;if(mm){var n=mm,r=n.observed,i=n.persistentFocus,a=n.autoFocus,o=n.shards,s=n.crossFrame,u=r||ym&&ym.portaledElement,l=document&&document.activeElement;if(u){var c=[u].concat(o.map(i3e).filter(Boolean));if((!l||t3e(l))&&(i||a3e(s)||!QFe()||!vm&&a)&&(u&&!(DK(c)||r3e(l))&&(document&&!vm&&l&&!a?(l.blur&&l.blur(),document.body.focus()):(t=$K(c,vm),ym={})),Gy=!1,vm=document&&document.activeElement),document){var f=document&&document.activeElement,d=zFe(c),h=d.map(function(p){var g=p.node;return g}).indexOf(f);h>-1&&(d.filter(function(p){var g=p.guard,m=p.node;return g&&m.dataset.focusAutoGuard}).forEach(function(p){var g=p.node;return g.removeAttribute("tabIndex")}),BK(h,d.length,1,d),BK(h,-1,-1,d))}}}return t},zK=function(t){lS()&&t&&(t.stopPropagation(),t.preventDefault())},MF=function(){return LK(lS)},o3e=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||n3e(r,n)},s3e=function(){return null},jK=function(){Gy="just",setTimeout(function(){Gy="meanwhile"},0)},u3e=function(){document.addEventListener("focusin",zK,!0),document.addEventListener("focusout",MF),window.addEventListener("blur",jK)},l3e=function(){document.removeEventListener("focusin",zK,!0),document.removeEventListener("focusout",MF),window.removeEventListener("blur",jK)};function c3e(e){return e.filter(function(t){var n=t.disabled;return!n})}function f3e(e){var t=e.slice(-1)[0];t&&!mm&&u3e();var n=mm,r=n&&t&&t.id===n.id;mm=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var a=i.id;return a===n.id}).length||n.returnFocus(!t)),t?(vm=null,(!r||n.observed!==t.observed)&&t.onActivation(),lS(),LK(lS)):(l3e(),vm=null)}EK.assignSyncMedium(o3e),AK.assignMedium(MF),EFe.assignMedium(function(e){return e({moveFocusInside:$K,focusInside:DK})});var d3e=OFe(c3e,f3e)(s3e),UK=Kl(function(t,n){return le(CK,yh({sideCar:d3e,ref:n},t))}),WK=CK.propTypes||{};WK.sideCar,hFe(WK,["sideCar"]),UK.propTypes={};var h3e=UK,p3e=e=>{var{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:i,children:a,isDisabled:o,autoFocus:s,persistentFocus:u,lockFocusAcrossFrames:l}=e,c=st(()=>{if(t!=null&&t.current)t.current.focus();else if(r!=null&&r.current){var h=Vwe(r.current);h.length===0&&Xg(r.current,{nextTick:!0})}},[t,r]),f=st(()=>{var h;n==null||(h=n.current)==null||h.focus()},[n]),d=i&&!n;return le(h3e,{crossFrame:l,persistentFocus:u,autoFocus:s,disabled:o,onActivation:c,onDeactivation:f,returnFocus:d},a)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bm=function(){return bm=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},bm.apply(this,arguments)};function g3e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var cS="right-scroll-bar-position",fS="width-before-scroll-bar",m3e="with-scroll-bars-hidden",v3e="--removed-body-scroll-bar-size",VK=_K(),PF=function(){},dS=Kl(function(e,t){var n=Jt(null),r=an({onScrollCapture:PF,onWheelCapture:PF,onTouchMoveCapture:PF}),i=r[0],a=r[1],o=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,f=e.shards,d=e.sideCar,h=e.noIsolation,p=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,y=g3e(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=d,x=bK([n,t]),w=bm({},y,i);return le(Vi,null,c&&le(b,{sideCar:VK,removeScrollBar:l,shards:f,noIsolation:h,inert:p,setCallbacks:a,allowPinchZoom:!!g,lockRef:n}),o?lf(T2.only(s),bm({},w,{ref:x})):le(v,bm({},w,{className:u,ref:x}),s))});dS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},dS.classNames={fullWidth:fS,zeroRight:cS};var y3e=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function b3e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=y3e();return t&&e.setAttribute("nonce",t),e}function x3e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function w3e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var _3e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=b3e())&&(x3e(t,n),w3e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},S3e=function(){var e=_3e();return function(t){Vt(function(){return e.add(t),function(){e.remove()}},[])}},qK=function(){var e=S3e(),t=function(n){var r=n.styles;return e(r),null};return t},E3e={left:0,top:0,right:0,gap:0},$F=function(e){return parseInt(e||"",10)||0},A3e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[$F(n),$F(r),$F(i)]},HK=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return E3e;var t=A3e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},C3e=qK(),k3e=function(e,t,n,r){var i=e.left,a=e.top,o=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`+m3e+` {
   overflow: hidden `+r+`;
   padding-right: `+s+"px "+r+`;
  }
  body {
    overflow: hidden `+r+`;
    `+[t&&"position: relative "+r+";",n==="margin"&&`
    padding-left: `+i+`px;
    padding-top: `+a+`px;
    padding-right: `+o+`px;
    margin-left:0;
    margin-top:0;
    margin-right: `+s+"px "+r+`;
    `,n==="padding"&&"padding-right: "+s+"px "+r+";"].filter(Boolean).join("")+`
  }
  
  .`+cS+` {
    right: `+s+"px "+r+`;
  }
  
  .`+fS+` {
    margin-right: `+s+"px "+r+`;
  }
  
  .`+cS+" ."+cS+` {
    right: 0 `+r+`;
  }
  
  .`+fS+" ."+fS+` {
    margin-right: 0 `+r+`;
  }
  
  body {
    `+v3e+": "+s+`px;
  }
`},T3e=function(e){var t=an(HK(e.gapMode)),n=t[0],r=t[1];Vt(function(){r(HK(e.gapMode))},[e.gapMode]);var i=e.noRelative,a=e.noImportant,o=e.gapMode,s=o===void 0?"margin":o;return le(C3e,{styles:k3e(n,!i,s,a?"":"!important")})},O3e=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},I3e=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},GK=function(e,t){var n=t;do{var r=KK(e,n);if(r){var i=XK(e,n),a=i[1],o=i[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},N3e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},D3e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},KK=function(e,t){return e==="v"?O3e(t):I3e(t)},XK=function(e,t){return e==="v"?N3e(t):D3e(t)},R3e=function(e,t,n,r,i){var a=r,o=n.target,s=t.contains(o),u=!1,l=a>0,c=0,f=0;do{var d=XK(e,o),h=d[0],p=d[1],g=d[2],m=p-g-h;(h||m)&&KK(e,o)&&(c+=m,f+=h),o=o.parentNode}while(!s&&o!==document.body||s&&(t.contains(o)||t===o));return(l&&(i&&c===0||!i&&a>c)||!l&&(i&&f===0||!i&&-a>f))&&(u=!0),u},LF=!1;if(typeof window!="undefined")try{var hS=Object.defineProperty({},"passive",{get:function(){return LF=!0,!0}});window.addEventListener("test",hS,hS),window.removeEventListener("test",hS,hS)}catch(e){LF=!1}var xm=LF?{passive:!1}:!1,pS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},YK=function(e){return[e.deltaX,e.deltaY]},ZK=function(e){return e&&"current"in e?e.current:e},F3e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},M3e=function(e){return`
  .block-interactivity-`+e+` {pointer-events: none;}
  .allow-interactivity-`+e+` {pointer-events: all;}
`},P3e=0,wm=[];function $3e(e){var t=Jt([]),n=Jt([0,0]),r=Jt(),i=an(P3e++)[0],a=an(function(){return qK()})[0],o=Jt(e);Vt(function(){o.current=e},[e]),Vt(function(){if(e.inert){document.body.classList.add("block-interactivity-"+i);var g=[e.lockRef.current].concat((e.shards||[]).map(ZK)).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-"+i)}),function(){document.body.classList.remove("block-interactivity-"+i),g.forEach(function(m){return m.classList.remove("allow-interactivity-"+i)})}}},[e.inert,e.lockRef.current,e.shards]);var s=st(function(g,m){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var v=pS(g),y=n.current,b="deltaX"in g?g.deltaX:y[0]-v[0],x="deltaY"in g?g.deltaY:y[1]-v[1],w,S=g.target,A=Math.abs(b)>Math.abs(x)?"h":"v",_=GK(A,S);if(!_)return!0;if(_?w=A:(w=A==="v"?"h":"v",_=GK(A,S)),!_)return!1;if(!r.current&&"changedTouches"in g&&(b||x)&&(r.current=w),!w)return!0;var E=r.current||w;return R3e(E,m,g,E==="h"?b:x,!0)},[]),u=st(function(g){var m=g;if(!(!wm.length||wm[wm.length-1]!==a)){var v="deltaY"in m?YK(m):pS(m),y=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&F3e(w.delta,v)})[0];if(y&&y.should){m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(ZK).filter(Boolean).filter(function(w){return w.contains(m.target)}),x=b.length>0?s(m,b[0]):!o.current.noIsolation;x&&m.preventDefault()}}},[]),l=st(function(g,m,v,y){var b={name:g,delta:m,target:v,should:y};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(x){return x!==b})},1)},[]),c=st(function(g){n.current=pS(g),r.current=void 0},[]),f=st(function(g){l(g.type,YK(g),g.target,s(g,e.lockRef.current))},[]),d=st(function(g){l(g.type,pS(g),g.target,s(g,e.lockRef.current))},[]);Vt(function(){return wm.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",u,xm),document.addEventListener("touchmove",u,xm),document.addEventListener("touchstart",c,xm),function(){wm=wm.filter(function(g){return g!==a}),document.removeEventListener("wheel",u,xm),document.removeEventListener("touchmove",u,xm),document.removeEventListener("touchstart",c,xm)}},[]);var h=e.removeScrollBar,p=e.inert;return le(Vi,null,p?le(a,{styles:M3e(i)}):null,h?le(T3e,{gapMode:"margin"}):null)}var L3e=SFe(VK,$3e),JK=Kl(function(e,t){return le(dS,bm({},e,{ref:t,sideCar:L3e}))});JK.classNames=dS.classNames;var B3e=JK,z3e=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},_m=new WeakMap,gS=new WeakMap,mS={},BF=0,j3e=function(e,t,n){t===void 0&&(t=z3e(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];mS[n]||(mS[n]=new WeakMap);var i=mS[n],a=[],o=new Set,s=function(l){!l||o.has(l)||(o.add(l),s(l.parentNode))};r.forEach(s);var u=function(l){!l||r.indexOf(l)>=0||Array.prototype.forEach.call(l.children,function(c){if(o.has(c))u(c);else{var f=c.getAttribute("aria-hidden"),d=f!==null&&f!=="false",h=(_m.get(c)||0)+1,p=(i.get(c)||0)+1;_m.set(c,h),i.set(c,p),a.push(c),h===1&&d&&gS.set(c,!0),p===1&&c.setAttribute(n,"true"),d||c.setAttribute("aria-hidden","true")}})};return u(t),o.clear(),BF++,function(){a.forEach(function(l){var c=_m.get(l)-1,f=i.get(l)-1;_m.set(l,c),i.set(l,f),c||(gS.has(l)||l.removeAttribute("aria-hidden"),gS.delete(l)),f||l.removeAttribute(n)}),BF--,BF||(_m=new WeakMap,_m=new WeakMap,gS=new WeakMap,mS={})}};function U3e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class W3e{constructor(){U3e(this,"modals",void 0),this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(n=>n!==t)}isTopModal(t){var n=this.modals[this.modals.length-1];return n===t}}var zF=new W3e;function V3e(e,t){Vt(()=>(t&&zF.add(e),()=>{zF.remove(e)}),[t,e])}function vS(){return vS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vS.apply(this,arguments)}function q3e(e){var{isOpen:t,onClose:n,id:r,closeOnOverlayClick:i=!0,closeOnEsc:a=!0,useInert:o=!0,onOverlayClick:s,onEsc:u}=e,l=Jt(null),c=Jt(null),[f,d,h]=u2e(r,"chakra-modal","chakra-modal--header","chakra-modal--body");H3e(l,t&&o),V3e(l,t);var p=Jt(null),g=st(_=>{p.current=_.target},[]),m=st(_=>{_.key==="Escape"&&(_.stopPropagation(),a&&(n==null||n()),u==null||u())},[a,n,u]),[v,y]=an(!1),[b,x]=an(!1),w=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),vS({role:"dialog"},_,{ref:pf(E,l),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":v?d:void 0,"aria-describedby":b?h:void 0,onClick:Fr(_.onClick,C=>C.stopPropagation())})},[h,b,f,d,v]),S=st(_=>{_.stopPropagation(),p.current===_.target&&(!zF.isTopModal(l)||(i&&(n==null||n()),s==null||s()))},[n,i,s]),A=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),vS({},_,{ref:pf(E,c),onClick:Fr(_.onClick,S),onKeyDown:Fr(_.onKeyDown,m),onMouseDown:Fr(_.onMouseDown,g)})},[m,g,S]);return{isOpen:t,onClose:n,headerId:d,bodyId:h,setBodyMounted:x,setHeaderMounted:y,dialogRef:l,overlayRef:c,getDialogProps:w,getDialogContainerProps:A}}function H3e(e,t){Vt(()=>{if(!!e.current){var n=null;return t&&e.current&&(n=j3e(e.current)),()=>{t&&(n==null||n())}}},[t,e])}function jF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Sf(){return Sf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sf.apply(this,arguments)}var[G3e,Ky]=Pu({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),QK=e=>{var{portalProps:t,children:n,autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d}=e,h=gf("Modal",e),p=q3e(e),g=Sf({},p,{autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d});return le(G3e,{value:g},le(vy,{value:h},le(KG,null,g.isOpen&&le(l_,t,n))))};QK.defaultProps={lockFocusAcrossFrames:!0,returnFocusOnClose:!0,scrollBehavior:"outside",trapFocus:!0,autoFocus:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale"};var K3e=wt(HG.div);function X3e(e){var{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:i,blockScrollOnMount:a,allowPinchZoom:o,finalFocusRef:s,returnFocusOnClose:u,preserveScrollBarGap:l,lockFocusAcrossFrames:c}=Ky(),[f,d]=dR();return Vt(()=>{!f&&d&&setTimeout(d)},[f,d]),le(p3e,{autoFocus:t,isDisabled:!n,initialFocusRef:i,finalFocusRef:s,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:c},le(B3e,{removeScrollBar:!l,allowPinchZoom:o,enabled:a,forwardProps:!0},e.children))}var Y3e=qt((e,t)=>{var{className:n}=e,r=jF(e,["className","transition"]),i=Gn("chakra-modal__overlay",n),a=Ii(),o=Sf({pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh"},a.overlay),{motionPreset:s}=Ky(),u=s==="none"?{}:rRe;return le(K3e,Sf({},u,{__css:o,ref:t,className:i},r))}),Z3e=qt((e,t)=>{var{className:n}=e,r=jF(e,["className"]),{headerId:i,setHeaderMounted:a}=Ky();Vt(()=>(a(!0),()=>a(!1)),[a]);var o=Gn("chakra-modal__header",n),s=Ii(),u=Sf({flex:0},s.header);return le(wt.header,Sf({ref:t,className:o,id:i},r,{__css:u}))}),J3e=qt((e,t)=>{var{className:n}=e,r=jF(e,["className"]),{bodyId:i,setBodyMounted:a}=Ky();Vt(()=>(a(!0),()=>a(!1)),[a]);var o=Gn("chakra-modal__body",n),s=Ii();return le(wt.div,Sf({ref:t,className:o,id:i},r,{__css:s.body}))});function Oh(){return Oh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oh.apply(this,arguments)}function eX(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[Q3e,eMe]=Pu();function tMe(e){var t,{isOpen:n,onClose:r,placement:i="right",children:a}=e,o=eX(e,["isOpen","onClose","placement","children"]),s=GV(),u=(t=s.components)==null?void 0:t.Drawer;return le(Q3e,{value:{placement:i}},le(QK,Oh({isOpen:n,onClose:r,styleConfig:u},o),a))}var nMe=wt(oRe),rMe=qt((e,t)=>{var{className:n,children:r}=e,i=eX(e,["className","children"]),{getDialogProps:a,getDialogContainerProps:o,isOpen:s}=Ky(),u=a(i,t),l=o(),c=Gn("chakra-modal__content",n),f=Ii(),d=Oh({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0},f.dialog),h=Oh({display:"flex",width:"100vw",height:"100vh",position:"fixed",left:0,top:0},f.dialogContainer),{placement:p}=eMe();return le(wt.div,Oh({},l,{className:"chakra-modal__content-container",__css:h}),le(X3e,null,le(nMe,Oh({direction:p,in:s,className:c},u,{__css:d}),r)))});function Ef(){return Ef=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ef.apply(this,arguments)}function UF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var iMe=qt((e,t)=>{var{children:n,placeholder:r,className:i}=e,a=UF(e,["children","placeholder","className"]),o=lK(a);return le(wt.select,Ef({},o,{ref:t,className:Gn("chakra-select",i)}),r&&le("option",{value:""},r),n)}),aMe=qt((e,t)=>{var n=gf("Select",e),r=is(e),{rootProps:i,placeholder:a,icon:o,color:s,height:u,h:l,minH:c,minHeight:f,iconColor:d,iconSize:h}=r,p=UF(r,["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"]),[g,m]=Cwe(p,i_e),v={width:"100%",height:"fit-content",position:"relative",color:s},y=Zl({},n.field,{paddingEnd:"2rem",_focus:{zIndex:"unset"}});return le(wt.div,Ef({className:"chakra-select__wrapper",__css:v},g,i),le(iMe,Ef({ref:t,height:l??u,minH:c??f,placeholder:a},m,{__css:y}),e.children),le(uMe,Ef({"data-disabled":e.isDisabled},(d||s)&&{color:d||s},{__css:n.icon},h&&{fontSize:h}),o))}),oMe=e=>le("svg",Ef({viewBox:"0 0 24 24"},e),le("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})),sMe=wt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),uMe=e=>{var{children:t=le(oMe,null)}=e,n=UF(e,["children"]),r=lf(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return le(sMe,Ef({},n,{className:"chakra-select__icon-wrapper"}),mh(t)?r:null)};function nc(){return nc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nc.apply(this,arguments)}function lMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var cMe=qt((e,t)=>{var n=gf("Switch",e),r=is(e),{spacing:i="0.5rem",children:a}=r,o=lMe(r,["spacing","children"]),{state:s,getInputProps:u,getCheckboxProps:l,getRootProps:c,getLabelProps:f}=RRe(o),d=gr(()=>nc({display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},n.container),[n.container]),h=gr(()=>nc({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer"},n.track),[n.track]),p=gr(()=>nc({userSelect:"none",marginStart:i},n.label),[i,n.label]);return le(wt.label,nc({},c(),{className:Gn("chakra-switch",e.className),__css:d}),le("input",nc({className:"chakra-switch__input"},u({},t))),le(wt.span,nc({},l(),{className:"chakra-switch__track",__css:h}),le(wt.span,{__css:n.thumb,className:"chakra-switch__thumb","data-checked":Oi(s.isChecked),"data-hover":Oi(s.isHovered)})),a&&le(wt.span,nc({className:"chakra-switch__label"},f(),{__css:p}),a))});function Ih(){return Ih=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ih.apply(this,arguments)}function WF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[fMe,dMe,hMe,pMe]=dRe();function gMe(e){var{defaultIndex:t,onChange:n,index:r,isManual:i,isLazy:a,lazyBehavior:o="unmount",orientation:s="horizontal",direction:u="ltr"}=e,l=WF(e,["defaultIndex","onChange","index","isManual","isLazy","lazyBehavior","orientation","direction"]),[c,f]=an(t??0),[d,h]=o2e({defaultValue:t??0,value:r,onChange:n});Vt(()=>{r!=null&&f(r)},[r]);var p=hMe(),g=CV(e.id,"tabs");return{id:g,selectedIndex:d,focusedIndex:c,setSelectedIndex:h,setFocusedIndex:f,isManual:i,isLazy:a,lazyBehavior:o,orientation:s,descendants:p,direction:u,htmlProps:l}}var[mMe,yS]=Pu({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function vMe(e){var{focusedIndex:t,orientation:n,direction:r}=yS(),i=dMe(),a=st(o=>{var s=()=>{var y=i.nextEnabled(t);y&&Xg(y.node)},u=()=>{var y=i.prevEnabled(t);y&&Xg(y.node)},l=()=>{var y=i.firstEnabled();y&&Xg(y.node)},c=()=>{var y=i.lastEnabled();y&&Xg(y.node)},f=n==="horizontal",d=n==="vertical",h=Mwe(o),p=r==="ltr"?"ArrowLeft":"ArrowRight",g=r==="ltr"?"ArrowRight":"ArrowLeft",m={[p]:()=>f&&u(),[g]:()=>f&&s(),ArrowDown:()=>d&&s(),ArrowUp:()=>d&&u(),Home:l,End:c},v=m[h];v&&(o.preventDefault(),v(o))},[i,t,n,r]);return Ih({},e,{role:"tablist","aria-orientation":n,onKeyDown:Fr(e.onKeyDown,a)})}function yMe(e){var{isDisabled:t,isFocusable:n}=e,r=WF(e,["isDisabled","isFocusable"]),{setSelectedIndex:i,isManual:a,id:o,setFocusedIndex:s,selectedIndex:u}=yS(),{index:l,register:c}=pMe({disabled:t&&!n}),f=l===u,d=()=>{i(l)},h=()=>{s(l);var m=t&&n,v=!a&&!m;v&&i(l)},p=dFe(Ih({},r,{ref:pf(c,e.ref),isDisabled:t,isFocusable:n,onClick:Fr(e.onClick,d)})),g="button";return Ih({},p,{id:tX(o,l),role:"tab",tabIndex:f?0:-1,type:g,"aria-selected":f,"aria-controls":nX(o,l),onFocus:t?void 0:Fr(e.onFocus,h)})}function bMe(e){var t=yS(),{id:n,selectedIndex:r}=t,i=_D(e.children),a=i.map((o,s)=>lf(o,{isSelected:s===r,id:nX(n,s),"aria-labelledby":tX(n,s)}));return Ih({},e,{children:a})}function xMe(e){var{isSelected:t,id:n,children:r}=e,i=WF(e,["isSelected","id","children"]),{isLazy:a,lazyBehavior:o}=yS(),s=Jt(!1);t&&(s.current=!0);var u=Xwe({hasBeenSelected:s.current,isSelected:t,isLazy:a,lazyBehavior:o});return Ih({tabIndex:0},i,{children:u?r:null,role:"tabpanel",hidden:!t,id:n})}function tX(e,t){return e+"--tab-"+t}function nX(e,t){return e+"--tabpanel-"+t}function as(){return as=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},as.apply(this,arguments)}function rX(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var wMe=qt((e,t)=>{var n=gf("Tabs",e),r=is(e),{children:i,className:a}=r,o=rX(r,["children","className"]),s=gMe(o),{htmlProps:u,descendants:l}=s,c=rX(s,["htmlProps","descendants"]),f=gr(()=>c,[c]),d=pD(u,["isFitted"]);return le(fMe,{value:l},le(mMe,{value:f},le(vy,{value:n},le(wt.div,as({className:Gn("chakra-tabs",a),ref:t},d,{__css:n.root}),i))))}),_Me=qt((e,t)=>{var n=Ii(),r=yMe(as({},e,{ref:t})),i=as({outline:"0",display:"flex",alignItems:"center",justifyContent:"center"},n.tab);return le(wt.button,as({},r,{className:Gn("chakra-tabs__tab",e.className),__css:i}))}),SMe=qt((e,t)=>{var n=vMe(as({},e,{ref:t})),r=Ii(),i=as({display:"flex"},r.tablist);return le(wt.div,as({},n,{className:Gn("chakra-tabs__tablist",e.className),__css:i}))}),EMe=qt((e,t)=>{var n=xMe(as({},e,{ref:t})),r=Ii();return le(wt.div,as({outline:"0"},n,{className:Gn("chakra-tabs__tab-panel",e.className),__css:r.tabpanel}))}),AMe=qt((e,t)=>{var n=bMe(e),r=Ii();return le(wt.div,as({},n,{width:"100%",ref:t,className:Gn("chakra-tabs__tab-panels",e.className),__css:r.tabpanels}))}),CMe=E_({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),kMe=E_({displayName:"ExternalLinkIcon",path:le("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},le("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),le("path",{d:"M15 3h6v6"}),le("path",{d:"M10 14L21 3"}))}),TMe=E_({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),iX=E_({viewBox:"0 0 14 14",path:le("g",{fill:"currentColor"},le("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"}))});const OMe=({options:e})=>{const[t,n]=an(!1),r=st(()=>{n(!t)},[t]);return Bt.createElement(Bt.Fragment,null,Bt.createElement(uF,{verticalAlign:"top","aria-label":"Metaframe settings",icon:Bt.createElement(CMe,null),size:"lg",onClick:r}),Bt.createElement(IMe,{isOpen:t,setOpen:n,options:e}))},IMe=({isOpen:e,setOpen:t,options:n})=>{const[r,i]=fW("options",Object.fromEntries(n.filter(d=>d.default).map(d=>[d.name,d.default]))),[a,o]=an(r||{}),[s,u]=an(void 0),l=st(d=>{const{name:h,value:p}=d.target,g=n.find(m=>m.name===h);if(!g){console.error(`No option found for name=${h}`);return}g.type==="boolean"?o(Object.assign(Object.assign({},a),{[h]:p==="1"})):o(Object.assign(Object.assign({},a),{[h]:p}))},[a,o,n]),c=st(()=>{t(!e)},[t,e]),f=st(()=>{const d={};if(Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);if(g&&g.validator&&g.type!=="boolean"){const m=g.validator(a[p]);m&&(d[p]=m)}}),Object.keys(d).length>0){u(d);return}u(void 0);const h={};Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);g?g.map?h[p]=g.map(a[p]):g.type==="boolean"?h[p]=a[p]===!0||a[p]==="1"||a[p]==="true":h[p]=a[p]:h[p]=a[p]}),t(!e),i(h)},[t,e,n,a,i,u]);return Vt(()=>{const d=h=>{h.key==="Enter"&&e&&f()};return window.addEventListener("keyup",d),()=>{window.removeEventListener("keyup",d)}},[f,e]),Bt.createElement(tMe,{placement:"top",onClose:f,isOpen:e},Bt.createElement(Y3e,null,Bt.createElement(rMe,null,Bt.createElement(Z3e,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),Bt.createElement(J3e,null,Bt.createElement(iS,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},Bt.createElement(dK,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(d=>Bt.createElement(Bt.Fragment,null,Bt.createElement(Th,{rowSpan:1,colSpan:4},Bt.createElement(iS,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},Bt.createElement(rFe,{textAlign:"right",verticalAlign:"bottom"},d.displayName||d.name,":"))),Bt.createElement(Th,{rowSpan:1,colSpan:8}," ",NMe(d,a[d.name],l)))),Bt.createElement(Th,{rowSpan:1,colSpan:12}),Bt.createElement(Th,{rowSpan:1,colSpan:12}),Bt.createElement(Th,{rowSpan:1,colSpan:12}),Bt.createElement(Th,{rowSpan:1,colSpan:10}),Bt.createElement(Th,{rowSpan:0,colSpan:2},Bt.createElement(tFe,{spacing:2,justify:"flex-end",direction:"row"},Bt.createElement(uF,{size:"lg",color:"red",icon:Bt.createElement(TMe,null),onClick:c}),Bt.createElement(uF,{size:"lg",color:"green",icon:Bt.createElement(iX,null),onClick:f})))))))))},NMe=(e,t,n)=>{switch(e.type){case"option":return Bt.createElement(aMe,{name:e.name,value:t,onChange:n,placeholder:"Select option"},e.options.map(r=>Bt.createElement("option",{value:r},r)));case"boolean":return Bt.createElement(cMe,{name:e.name,rightIcon:Bt.createElement(iX,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return Bt.createElement(iS,{w:"100%",h:"10"},Bt.createElement(cK,{name:e.name,type:"text",placeholder:"",value:t,onInput:n}))}};var aX={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof cf=="function"&&cf;if(!c&&f)return f(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+l+"'")}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(h){var p=r[l][1][h];return o(p||h)},d,d.exports,n,r,i,a)}return i[l].exports}for(var s=typeof cf=="function"&&cf,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("crypto");function g(S,A){return function(_,E){var C;if(C=E.algorithm!=="passthrough"?p.createHash(E.algorithm):new w,C.write===void 0&&(C.write=C.update,C.end=C.update),x(E,C).dispatch(_),C.update||C.end(""),C.digest)return C.digest(E.encoding==="buffer"?void 0:E.encoding);var k=C.read();return E.encoding!=="buffer"?k.toString(E.encoding):k}(S,A=y(S,A))}(i=r.exports=g).sha1=function(S){return g(S)},i.keys=function(S){return g(S,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(S){return g(S,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(S){return g(S,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"];m.push("passthrough");var v=["buffer","hex","binary","base64"];function y(S,A){A=A||{};var _={};if(_.algorithm=A.algorithm||"sha1",_.encoding=A.encoding||"hex",_.excludeValues=!!A.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=A.ignoreUnknown===!0,_.respectType=A.respectType!==!1,_.respectFunctionNames=A.respectFunctionNames!==!1,_.respectFunctionProperties=A.respectFunctionProperties!==!1,_.unorderedArrays=A.unorderedArrays===!0,_.unorderedSets=A.unorderedSets!==!1,_.unorderedObjects=A.unorderedObjects!==!1,_.replacer=A.replacer||void 0,_.excludeKeys=A.excludeKeys||void 0,S===void 0)throw new Error("Object argument required.");for(var E=0;E<m.length;++E)m[E].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=m[E]);if(m.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+m.join(", "));if(v.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+v.join(", "));return _}function b(S){if(typeof S=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(S))!=null}function x(S,A,_){_=_||[];function E(C){return A.update?A.update(C,"utf8"):A.write(C,"utf8")}return{dispatch:function(C){return S.replacer&&(C=S.replacer(C)),this["_"+(C===null?"null":typeof C)](C)},_object:function(C){var k=Object.prototype.toString.call(C),T=/\[object (.*)\]/i.exec(k);T=(T=T?T[1]:"unknown:["+k+"]").toLowerCase();var I;if(0<=(I=_.indexOf(C)))return this.dispatch("[CIRCULAR:"+I+"]");if(_.push(C),s!==void 0&&s.isBuffer&&s.isBuffer(C))return E("buffer:"),E(C);if(T==="object"||T==="function"||T==="asyncfunction"){var N=Object.keys(C);S.unorderedObjects&&(N=N.sort()),S.respectType===!1||b(C)||N.splice(0,0,"prototype","__proto__","constructor"),S.excludeKeys&&(N=N.filter(function(D){return!S.excludeKeys(D)})),E("object:"+N.length+":");var O=this;return N.forEach(function(D){O.dispatch(D),E(":"),S.excludeValues||O.dispatch(C[D]),E(",")})}if(!this["_"+T]){if(S.ignoreUnknown)return E("["+T+"]");throw new Error('Unknown object type "'+T+'"')}this["_"+T](C)},_array:function(C,k){k=k!==void 0?k:S.unorderedArrays!==!1;var T=this;if(E("array:"+C.length+":"),!k||C.length<=1)return C.forEach(function(O){return T.dispatch(O)});var I=[],N=C.map(function(O){var D=new w,L=_.slice();return x(S,D,L).dispatch(O),I=I.concat(L.slice(_.length)),D.read().toString()});return _=_.concat(I),N.sort(),this._array(N,!1)},_date:function(C){return E("date:"+C.toJSON())},_symbol:function(C){return E("symbol:"+C.toString())},_error:function(C){return E("error:"+C.toString())},_boolean:function(C){return E("bool:"+C.toString())},_string:function(C){E("string:"+C.length+":"),E(C.toString())},_function:function(C){E("fn:"),b(C)?this.dispatch("[native]"):this.dispatch(C.toString()),S.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(C.name)),S.respectFunctionProperties&&this._object(C)},_number:function(C){return E("number:"+C.toString())},_xml:function(C){return E("xml:"+C.toString())},_null:function(){return E("Null")},_undefined:function(){return E("Undefined")},_regexp:function(C){return E("regex:"+C.toString())},_uint8array:function(C){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint8clampedarray:function(C){return E("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(C))},_int8array:function(C){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint16array:function(C){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(C))},_int16array:function(C){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(C))},_uint32array:function(C){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(C))},_int32array:function(C){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(C))},_float32array:function(C){return E("float32array:"),this.dispatch(Array.prototype.slice.call(C))},_float64array:function(C){return E("float64array:"),this.dispatch(Array.prototype.slice.call(C))},_arraybuffer:function(C){return E("arraybuffer:"),this.dispatch(new Uint8Array(C))},_url:function(C){return E("url:"+C.toString())},_map:function(C){E("map:");var k=Array.from(C);return this._array(k,S.unorderedSets!==!1)},_set:function(C){E("set:");var k=Array.from(C);return this._array(k,S.unorderedSets!==!1)},_file:function(C){return E("file:"),this.dispatch([C.name,C.size,C.type,C.lastModfied])},_blob:function(){if(S.ignoreUnknown)return E("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return E("domwindow")},_bigint:function(C){return E("bigint:"+C.toString())},_process:function(){return E("process")},_timer:function(){return E("timer")},_pipe:function(){return E("pipe")},_tcp:function(){return E("tcp")},_udp:function(){return E("udp")},_tty:function(){return E("tty")},_statwatcher:function(){return E("statwatcher")},_securecontext:function(){return E("securecontext")},_connection:function(){return E("connection")},_zlib:function(){return E("zlib")},_context:function(){return E("context")},_nodescript:function(){return E("nodescript")},_httpparser:function(){return E("httpparser")},_dataview:function(){return E("dataview")},_signal:function(){return E("signal")},_fsevent:function(){return E("fsevent")},_tlswrap:function(){return E("tlswrap")}}}function w(){return{buf:"",write:function(S){this.buf+=S},end:function(S){this.buf+=S},read:function(){return this.buf}}}i.writeToStream=function(S,A,_){return _===void 0&&(_=A,A={}),x(A=y(S,A),_).dispatch(S)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){(function(p){var g=typeof Uint8Array!="undefined"?Uint8Array:Array,m="+".charCodeAt(0),v="/".charCodeAt(0),y="0".charCodeAt(0),b="a".charCodeAt(0),x="A".charCodeAt(0),w="-".charCodeAt(0),S="_".charCodeAt(0);function A(_){var E=_.charCodeAt(0);return E===m||E===w?62:E===v||E===S?63:E<y?-1:E<y+10?E-y+26+26:E<x+26?E-x:E<b+26?E-b+26:void 0}p.toByteArray=function(_){var E,C;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var k=_.length,T=_.charAt(k-2)==="="?2:_.charAt(k-1)==="="?1:0,I=new g(3*_.length/4-T),N=0<T?_.length-4:_.length,O=0;function D(L){I[O++]=L}for(E=0;E<N;E+=4,0)D((16711680&(C=A(_.charAt(E))<<18|A(_.charAt(E+1))<<12|A(_.charAt(E+2))<<6|A(_.charAt(E+3))))>>16),D((65280&C)>>8),D(255&C);return T==2?D(255&(C=A(_.charAt(E))<<2|A(_.charAt(E+1))>>4)):T==1&&(D((C=A(_.charAt(E))<<10|A(_.charAt(E+1))<<4|A(_.charAt(E+2))>>2)>>8&255),D(255&C)),I},p.fromByteArray=function(_){var E,C,k,T,I=_.length%3,N="";function O(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(E=0,k=_.length-I;E<k;E+=3)C=(_[E]<<16)+(_[E+1]<<8)+_[E+2],N+=O((T=C)>>18&63)+O(T>>12&63)+O(T>>6&63)+O(63&T);switch(I){case 1:N+=O((C=_[_.length-1])>>2),N+=O(C<<4&63),N+="==";break;case 2:N+=O((C=(_[_.length-2]<<8)+_[_.length-1])>>10),N+=O(C>>4&63),N+=O(C<<2&63),N+="="}return N}})(i===void 0?this.base64js={}:i)}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("base64-js"),g=n("ieee754");function s(P,F,V){if(!(this instanceof s))return new s(P,F,V);var ae,Y,M,B,R,X=typeof P;if(F==="base64"&&X=="string")for(P=(ae=P).trim?ae.trim():ae.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(X=="number")Y=L(P);else if(X=="string")Y=s.byteLength(P,F);else{if(X!="object")throw new Error("First argument needs to be a number, array or string.");Y=L(P.length)}if(s._useTypedArrays?M=s._augment(new Uint8Array(Y)):((M=this).length=Y,M._isBuffer=!0),s._useTypedArrays&&typeof P.byteLength=="number")M._set(P);else if(W(R=P)||s.isBuffer(R)||R&&typeof R=="object"&&typeof R.length=="number")for(B=0;B<Y;B++)s.isBuffer(P)?M[B]=P.readUInt8(B):M[B]=P[B];else if(X=="string")M.write(P,0,F);else if(X=="number"&&!s._useTypedArrays&&!V)for(B=0;B<Y;B++)M[B]=0;return M}function m(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M=[],B=0;B<Y.length;B++)M.push(255&Y.charCodeAt(B));return M}(F),P,V,ae)}function v(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M,B,R,X=[],ge=0;ge<Y.length;ge++)M=Y.charCodeAt(ge),B=M>>8,R=M%256,X.push(R),X.push(B);return X}(F),P,V,ae)}function y(P,F,V){var ae="";V=Math.min(P.length,V);for(var Y=F;Y<V;Y++)ae+=String.fromCharCode(P[Y]);return ae}function b(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(Y=P[F],F+1<M&&(Y|=P[F+1]<<8)):(Y=P[F]<<8,F+1<M&&(Y|=P[F+1])),Y}function x(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(F+2<M&&(Y=P[F+2]<<16),F+1<M&&(Y|=P[F+1]<<8),Y|=P[F],F+3<M&&(Y+=P[F+3]<<24>>>0)):(F+1<M&&(Y=P[F+1]<<16),F+2<M&&(Y|=P[F+2]<<8),F+3<M&&(Y|=P[F+3]),Y+=P[F]<<24>>>0),Y}function w(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=b(P,F,V,!0);return 32768&Y?-1*(65535-Y+1):Y}}function S(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=x(P,F,V,!0);return 2147483648&Y?-1*(4294967295-Y+1):Y}}function A(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+3<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,23,4)}function _(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+7<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,52,8)}function E(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"trying to write beyond buffer length"),Oe(F,65535));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,2);B<R;B++)P[V+B]=(F&255<<8*(ae?B:1-B))>>>8*(ae?B:1-B)}function C(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"trying to write beyond buffer length"),Oe(F,4294967295));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,4);B<R;B++)P[V+B]=F>>>8*(ae?B:3-B)&255}function k(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"Trying to write beyond buffer length"),Te(F,32767,-32768)),P.length<=V||E(P,0<=F?F:65535+F+1,V,ae,Y)}function T(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Te(F,2147483647,-2147483648)),P.length<=V||C(P,0<=F?F:4294967295+F+1,V,ae,Y)}function I(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Re(F,34028234663852886e22,-34028234663852886e22)),P.length<=V||g.write(P,F,V,ae,23,4)}function N(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+7<P.length,"Trying to write beyond buffer length"),Re(F,17976931348623157e292,-17976931348623157e292)),P.length<=V||g.write(P,F,V,ae,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var P=new ArrayBuffer(0),F=new Uint8Array(P);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(V){return!1}}(),s.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(P){return!(P==null||!P._isBuffer)},s.byteLength=function(P,F){var V;switch(P+="",F||"utf8"){case"hex":V=P.length/2;break;case"utf8":case"utf-8":V=K(P).length;break;case"ascii":case"binary":case"raw":V=P.length;break;case"base64":V=ee(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=2*P.length;break;default:throw new Error("Unknown encoding")}return V},s.concat=function(P,F){if(me(W(P),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),P.length===0)return new s(0);if(P.length===1)return P[0];if(typeof F!="number")for(Y=F=0;Y<P.length;Y++)F+=P[Y].length;for(var V=new s(F),ae=0,Y=0;Y<P.length;Y++){var M=P[Y];M.copy(V,ae),ae+=M.length}return V},s.prototype.write=function(P,F,V,ae){var Y;isFinite(F)?isFinite(V)||(ae=V,V=void 0):(Y=ae,ae=F,F=V,V=Y),F=Number(F)||0;var M,B,R,X,ge,xe,ze,Ke,Ze,Lt=this.length-F;switch((!V||Lt<(V=Number(V)))&&(V=Lt),ae=String(ae||"utf8").toLowerCase()){case"hex":M=function(Je,Zt,mn,qn){mn=Number(mn)||0;var ni=Je.length-mn;(!qn||ni<(qn=Number(qn)))&&(qn=ni);var tr=Zt.length;me(tr%2==0,"Invalid hex string"),tr/2<qn&&(qn=tr/2);for(var Dn=0;Dn<qn;Dn++){var Qo=parseInt(Zt.substr(2*Dn,2),16);me(!isNaN(Qo),"Invalid hex string"),Je[mn+Dn]=Qo}return s._charsWritten=2*Dn,Dn}(this,P,F,V);break;case"utf8":case"utf-8":xe=this,ze=P,Ke=F,Ze=V,M=s._charsWritten=ce(K(ze),xe,Ke,Ze);break;case"ascii":case"binary":M=m(this,P,F,V);break;case"base64":B=this,R=P,X=F,ge=V,M=s._charsWritten=ce(ee(R),B,X,ge);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":M=v(this,P,F,V);break;default:throw new Error("Unknown encoding")}return M},s.prototype.toString=function(P,F,V){var ae,Y,M,B,R=this;if(P=String(P||"utf8").toLowerCase(),F=Number(F)||0,(V=V!==void 0?Number(V):V=R.length)===F)return"";switch(P){case"hex":ae=function(X,ge,xe){var ze=X.length;(!ge||ge<0)&&(ge=0),(!xe||xe<0||ze<xe)&&(xe=ze);for(var Ke="",Ze=ge;Ze<xe;Ze++)Ke+=G(X[Ze]);return Ke}(R,F,V);break;case"utf8":case"utf-8":ae=function(X,ge,xe){var ze="",Ke="";xe=Math.min(X.length,xe);for(var Ze=ge;Ze<xe;Ze++)X[Ze]<=127?(ze+=he(Ke)+String.fromCharCode(X[Ze]),Ke=""):Ke+="%"+X[Ze].toString(16);return ze+he(Ke)}(R,F,V);break;case"ascii":case"binary":ae=y(R,F,V);break;case"base64":Y=R,B=V,ae=(M=F)===0&&B===Y.length?p.fromByteArray(Y):p.fromByteArray(Y.slice(M,B));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ae=function(X,ge,xe){for(var ze=X.slice(ge,xe),Ke="",Ze=0;Ze<ze.length;Ze+=2)Ke+=String.fromCharCode(ze[Ze]+256*ze[Ze+1]);return Ke}(R,F,V);break;default:throw new Error("Unknown encoding")}return ae},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(P,F,V,ae){if(V=V||0,ae||ae===0||(ae=this.length),F=F||0,ae!==V&&P.length!==0&&this.length!==0){me(V<=ae,"sourceEnd < sourceStart"),me(0<=F&&F<P.length,"targetStart out of bounds"),me(0<=V&&V<this.length,"sourceStart out of bounds"),me(0<=ae&&ae<=this.length,"sourceEnd out of bounds"),ae>this.length&&(ae=this.length),P.length-F<ae-V&&(ae=P.length-F+V);var Y=ae-V;if(Y<100||!s._useTypedArrays)for(var M=0;M<Y;M++)P[M+F]=this[M+V];else P._set(this.subarray(V,V+Y),F)}},s.prototype.slice=function(P,F){var V=this.length;if(P=D(P,V,0),F=D(F,V,V),s._useTypedArrays)return s._augment(this.subarray(P,F));for(var ae=F-P,Y=new s(ae,void 0,!0),M=0;M<ae;M++)Y[M]=this[M+P];return Y},s.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},s.prototype.set=function(P,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,F)},s.prototype.readUInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},s.prototype.readUInt16LE=function(P,F){return b(this,P,!0,F)},s.prototype.readUInt16BE=function(P,F){return b(this,P,!1,F)},s.prototype.readUInt32LE=function(P,F){return x(this,P,!0,F)},s.prototype.readUInt32BE=function(P,F){return x(this,P,!1,F)},s.prototype.readInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},s.prototype.readInt16LE=function(P,F){return w(this,P,!0,F)},s.prototype.readInt16BE=function(P,F){return w(this,P,!1,F)},s.prototype.readInt32LE=function(P,F){return S(this,P,!0,F)},s.prototype.readInt32BE=function(P,F){return S(this,P,!1,F)},s.prototype.readFloatLE=function(P,F){return A(this,P,!0,F)},s.prototype.readFloatBE=function(P,F){return A(this,P,!1,F)},s.prototype.readDoubleLE=function(P,F){return _(this,P,!0,F)},s.prototype.readDoubleBE=function(P,F){return _(this,P,!1,F)},s.prototype.writeUInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"trying to write beyond buffer length"),Oe(P,255)),F>=this.length||(this[F]=P)},s.prototype.writeUInt16LE=function(P,F,V){E(this,P,F,!0,V)},s.prototype.writeUInt16BE=function(P,F,V){E(this,P,F,!1,V)},s.prototype.writeUInt32LE=function(P,F,V){C(this,P,F,!0,V)},s.prototype.writeUInt32BE=function(P,F,V){C(this,P,F,!1,V)},s.prototype.writeInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"Trying to write beyond buffer length"),Te(P,127,-128)),F>=this.length||(0<=P?this.writeUInt8(P,F,V):this.writeUInt8(255+P+1,F,V))},s.prototype.writeInt16LE=function(P,F,V){k(this,P,F,!0,V)},s.prototype.writeInt16BE=function(P,F,V){k(this,P,F,!1,V)},s.prototype.writeInt32LE=function(P,F,V){T(this,P,F,!0,V)},s.prototype.writeInt32BE=function(P,F,V){T(this,P,F,!1,V)},s.prototype.writeFloatLE=function(P,F,V){I(this,P,F,!0,V)},s.prototype.writeFloatBE=function(P,F,V){I(this,P,F,!1,V)},s.prototype.writeDoubleLE=function(P,F,V){N(this,P,F,!0,V)},s.prototype.writeDoubleBE=function(P,F,V){N(this,P,F,!1,V)},s.prototype.fill=function(P,F,V){if(P=P||0,F=F||0,V=V||this.length,typeof P=="string"&&(P=P.charCodeAt(0)),me(typeof P=="number"&&!isNaN(P),"value is not a number"),me(F<=V,"end < start"),V!==F&&this.length!==0){me(0<=F&&F<this.length,"start out of bounds"),me(0<=V&&V<=this.length,"end out of bounds");for(var ae=F;ae<V;ae++)this[ae]=P}},s.prototype.inspect=function(){for(var P=[],F=this.length,V=0;V<F;V++)if(P[V]=G(this[V]),V===i.INSPECT_MAX_BYTES){P[V+1]="...";break}return"<Buffer "+P.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var P=new Uint8Array(this.length),F=0,V=P.length;F<V;F+=1)P[F]=this[F];return P.buffer};var O=s.prototype;function D(P,F,V){return typeof P!="number"?V:F<=(P=~~P)?F:0<=P||0<=(P+=F)?P:0}function L(P){return(P=~~Math.ceil(+P))<0?0:P}function W(P){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(P)}function G(P){return P<16?"0"+P.toString(16):P.toString(16)}function K(P){for(var F=[],V=0;V<P.length;V++){var ae=P.charCodeAt(V);if(ae<=127)F.push(P.charCodeAt(V));else{var Y=V;55296<=ae&&ae<=57343&&V++;for(var M=encodeURIComponent(P.slice(Y,V+1)).substr(1).split("%"),B=0;B<M.length;B++)F.push(parseInt(M[B],16))}}return F}function ee(P){return p.toByteArray(P)}function ce(P,F,V,ae){for(var Y=0;Y<ae&&!(Y+V>=F.length||Y>=P.length);Y++)F[Y+V]=P[Y];return Y}function he(P){try{return decodeURIComponent(P)}catch(F){return String.fromCharCode(65533)}}function Oe(P,F){me(typeof P=="number","cannot write a non-number as a number"),me(0<=P,"specified a negative value for writing an unsigned value"),me(P<=F,"value is larger than maximum value for type"),me(Math.floor(P)===P,"value has a fractional component")}function Te(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value"),me(Math.floor(P)===P,"value has a fractional component")}function Re(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value")}function me(P,F){if(!P)throw new Error(F||"Failed assertion")}s._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=O.get,P.set=O.set,P.write=O.write,P.toString=O.toString,P.toLocaleString=O.toString,P.toJSON=O.toJSON,P.copy=O.copy,P.slice=O.slice,P.readUInt8=O.readUInt8,P.readUInt16LE=O.readUInt16LE,P.readUInt16BE=O.readUInt16BE,P.readUInt32LE=O.readUInt32LE,P.readUInt32BE=O.readUInt32BE,P.readInt8=O.readInt8,P.readInt16LE=O.readInt16LE,P.readInt16BE=O.readInt16BE,P.readInt32LE=O.readInt32LE,P.readInt32BE=O.readInt32BE,P.readFloatLE=O.readFloatLE,P.readFloatBE=O.readFloatBE,P.readDoubleLE=O.readDoubleLE,P.readDoubleBE=O.readDoubleBE,P.writeUInt8=O.writeUInt8,P.writeUInt16LE=O.writeUInt16LE,P.writeUInt16BE=O.writeUInt16BE,P.writeUInt32LE=O.writeUInt32LE,P.writeUInt32BE=O.writeUInt32BE,P.writeInt8=O.writeInt8,P.writeInt16LE=O.writeInt16LE,P.writeInt16BE=O.writeInt16BE,P.writeInt32LE=O.writeInt32LE,P.writeInt32BE=O.writeInt32BE,P.writeFloatLE=O.writeFloatLE,P.writeFloatBE=O.writeFloatBE,P.writeDoubleLE=O.writeDoubleLE,P.writeDoubleBE=O.writeDoubleBE,P.fill=O.fill,P.inspect=O.inspect,P.toArrayBuffer=O.toArrayBuffer,P}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=4,g=new s(p);g.fill(0),r.exports={hash:function(m,v,y,b){return s.isBuffer(m)||(m=new s(m)),function(x,w,S){for(var A=new s(w),_=S?A.writeInt32BE:A.writeInt32LE,E=0;E<x.length;E++)_.call(A,x[E],4*E,!0);return A}(v(function(x,w){var S;x.length%p!=0&&(S=x.length+(p-x.length%p),x=s.concat([x,g],S));for(var A=[],_=w?x.readInt32BE:x.readInt32LE,E=0;E<x.length;E+=p)A.push(_.call(x,E));return A}(m,b),8*m.length),y,b)}}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=n("./sha"),g=n("./sha256"),m=n("./rng"),v={sha1:p,sha256:g,md5:n("./md5")},y=64,b=new s(y);function x(S,A){var _=v[S=S||"sha1"],E=[];return _||w("algorithm:",S,"is not yet supported"),{update:function(C){return s.isBuffer(C)||(C=new s(C)),E.push(C),C.length,this},digest:function(C){var k=s.concat(E),T=A?function(I,N,O){s.isBuffer(N)||(N=new s(N)),s.isBuffer(O)||(O=new s(O)),N.length>y?N=I(N):N.length<y&&(N=s.concat([N,b],y));for(var D=new s(y),L=new s(y),W=0;W<y;W++)D[W]=54^N[W],L[W]=92^N[W];var G=I(s.concat([D,O]));return I(s.concat([L,G]))}(_,A,k):_(k);return E=null,C?T.toString(C):T}}}function w(){var S=[].slice.call(arguments).join(" ");throw new Error([S,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}b.fill(0),i.createHash=function(S){return x(S)},i.createHmac=x,i.randomBytes=function(S,A){if(!A||!A.call)return new s(m(S));try{A.call(this,void 0,new s(m(S)))}catch(_){A(_)}},function(S,A){for(var _ in S)A(S[_],_)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(S){i[S]=function(){w("sorry,",S,"is not implemented yet")}})}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(S,A){S[A>>5]|=128<<A%32,S[14+(A+64>>>9<<4)]=A;for(var _=1732584193,E=-271733879,C=-1732584194,k=271733878,T=0;T<S.length;T+=16){var I=_,N=E,O=C,D=k,_=v(_,E,C,k,S[T+0],7,-680876936),k=v(k,_,E,C,S[T+1],12,-389564586),C=v(C,k,_,E,S[T+2],17,606105819),E=v(E,C,k,_,S[T+3],22,-1044525330);_=v(_,E,C,k,S[T+4],7,-176418897),k=v(k,_,E,C,S[T+5],12,1200080426),C=v(C,k,_,E,S[T+6],17,-1473231341),E=v(E,C,k,_,S[T+7],22,-45705983),_=v(_,E,C,k,S[T+8],7,1770035416),k=v(k,_,E,C,S[T+9],12,-1958414417),C=v(C,k,_,E,S[T+10],17,-42063),E=v(E,C,k,_,S[T+11],22,-1990404162),_=v(_,E,C,k,S[T+12],7,1804603682),k=v(k,_,E,C,S[T+13],12,-40341101),C=v(C,k,_,E,S[T+14],17,-1502002290),_=y(_,E=v(E,C,k,_,S[T+15],22,1236535329),C,k,S[T+1],5,-165796510),k=y(k,_,E,C,S[T+6],9,-1069501632),C=y(C,k,_,E,S[T+11],14,643717713),E=y(E,C,k,_,S[T+0],20,-373897302),_=y(_,E,C,k,S[T+5],5,-701558691),k=y(k,_,E,C,S[T+10],9,38016083),C=y(C,k,_,E,S[T+15],14,-660478335),E=y(E,C,k,_,S[T+4],20,-405537848),_=y(_,E,C,k,S[T+9],5,568446438),k=y(k,_,E,C,S[T+14],9,-1019803690),C=y(C,k,_,E,S[T+3],14,-187363961),E=y(E,C,k,_,S[T+8],20,1163531501),_=y(_,E,C,k,S[T+13],5,-1444681467),k=y(k,_,E,C,S[T+2],9,-51403784),C=y(C,k,_,E,S[T+7],14,1735328473),_=b(_,E=y(E,C,k,_,S[T+12],20,-1926607734),C,k,S[T+5],4,-378558),k=b(k,_,E,C,S[T+8],11,-2022574463),C=b(C,k,_,E,S[T+11],16,1839030562),E=b(E,C,k,_,S[T+14],23,-35309556),_=b(_,E,C,k,S[T+1],4,-1530992060),k=b(k,_,E,C,S[T+4],11,1272893353),C=b(C,k,_,E,S[T+7],16,-155497632),E=b(E,C,k,_,S[T+10],23,-1094730640),_=b(_,E,C,k,S[T+13],4,681279174),k=b(k,_,E,C,S[T+0],11,-358537222),C=b(C,k,_,E,S[T+3],16,-722521979),E=b(E,C,k,_,S[T+6],23,76029189),_=b(_,E,C,k,S[T+9],4,-640364487),k=b(k,_,E,C,S[T+12],11,-421815835),C=b(C,k,_,E,S[T+15],16,530742520),_=x(_,E=b(E,C,k,_,S[T+2],23,-995338651),C,k,S[T+0],6,-198630844),k=x(k,_,E,C,S[T+7],10,1126891415),C=x(C,k,_,E,S[T+14],15,-1416354905),E=x(E,C,k,_,S[T+5],21,-57434055),_=x(_,E,C,k,S[T+12],6,1700485571),k=x(k,_,E,C,S[T+3],10,-1894986606),C=x(C,k,_,E,S[T+10],15,-1051523),E=x(E,C,k,_,S[T+1],21,-2054922799),_=x(_,E,C,k,S[T+8],6,1873313359),k=x(k,_,E,C,S[T+15],10,-30611744),C=x(C,k,_,E,S[T+6],15,-1560198380),E=x(E,C,k,_,S[T+13],21,1309151649),_=x(_,E,C,k,S[T+4],6,-145523070),k=x(k,_,E,C,S[T+11],10,-1120210379),C=x(C,k,_,E,S[T+2],15,718787259),E=x(E,C,k,_,S[T+9],21,-343485551),_=w(_,I),E=w(E,N),C=w(C,O),k=w(k,D)}return Array(_,E,C,k)}function m(S,A,_,E,C,k){return w((T=w(w(A,S),w(E,k)))<<(I=C)|T>>>32-I,_);var T,I}function v(S,A,_,E,C,k,T){return m(A&_|~A&E,S,A,C,k,T)}function y(S,A,_,E,C,k,T){return m(A&E|_&~E,S,A,C,k,T)}function b(S,A,_,E,C,k,T){return m(A^_^E,S,A,C,k,T)}function x(S,A,_,E,C,k,T){return m(_^(A|~E),S,A,C,k,T)}function w(S,A){var _=(65535&S)+(65535&A);return(S>>16)+(A>>16)+(_>>16)<<16|65535&_}r.exports=function(S){return p.hash(S,g,16)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p;p=function(g){for(var m,v=new Array(g),y=0;y<g;y++)(3&y)==0&&(m=4294967296*Math.random()),v[y]=m>>>((3&y)<<3)&255;return v},r.exports=p}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(y,b){y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var x,w,S,A,_,E=Array(80),C=1732584193,k=-271733879,T=-1732584194,I=271733878,N=-1009589776,O=0;O<y.length;O+=16){for(var D=C,L=k,W=T,G=I,K=N,ee=0;ee<80;ee++){E[ee]=ee<16?y[O+ee]:v(E[ee-3]^E[ee-8]^E[ee-14]^E[ee-16],1);var ce=m(m(v(C,5),(S=k,A=T,_=I,(w=ee)<20?S&A|~S&_:!(w<40)&&w<60?S&A|S&_|A&_:S^A^_)),m(m(N,E[ee]),(x=ee)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),N=I,I=T,T=v(k,30),k=C,C=ce}C=m(C,D),k=m(k,L),T=m(T,W),I=m(I,G),N=m(N,K)}return Array(C,k,T,I,N)}function m(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function v(y,b){return y<<b|y>>>32-b}r.exports=function(y){return p.hash(y,g,20,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function g(y,b){return y>>>b|y<<32-b}function m(y,b){var x,w,S,A,_,E,C,k,T,I,N=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64);y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var L,W,G,K,ee,ce,he,Oe,Te=0;Te<y.length;Te+=16){x=O[0],w=O[1],S=O[2],A=O[3],_=O[4],E=O[5],C=O[6],k=O[7];for(var Re=0;Re<64;Re++)D[Re]=Re<16?y[Re+Te]:p(p(p((Oe=D[Re-2],g(Oe,17)^g(Oe,19)^Oe>>>10),D[Re-7]),(he=D[Re-15],g(he,7)^g(he,18)^he>>>3)),D[Re-16]),T=p(p(p(p(k,g(ce=_,6)^g(ce,11)^g(ce,25)),(ee=_)&E^~ee&C),N[Re]),D[Re]),I=p(g(K=x,2)^g(K,13)^g(K,22),(L=x)&(W=w)^L&(G=S)^W&G),k=C,C=E,E=_,_=p(A,T),A=S,S=w,w=x,x=p(T,I);O[0]=p(x,O[0]),O[1]=p(w,O[1]),O[2]=p(S,O[2]),O[3]=p(A,O[3]),O[4]=p(_,O[4]),O[5]=p(E,O[5]),O[6]=p(C,O[6]),O[7]=p(k,O[7])}return O}var v=n("./helpers");r.exports=function(y){return v.hash(y,m,32,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(){}(a=r.exports={}).nextTick=function(){var g=typeof window!="undefined"&&window.setImmediate,m=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(g)return function(y){return window.setImmediate(y)};if(m){var v=[];return window.addEventListener("message",function(y){var b=y.source;b!==window&&b!==null||y.data!=="process-tick"||(y.stopPropagation(),0<v.length&&v.shift()())},!0),function(y){v.push(y),window.postMessage("process-tick","*")}}return function(y){setTimeout(y,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){i.read=function(p,g,m,v,y){var b,x,w=8*y-v-1,S=(1<<w)-1,A=S>>1,_=-7,E=m?y-1:0,C=m?-1:1,k=p[g+E];for(E+=C,b=k&(1<<-_)-1,k>>=-_,_+=w;0<_;b=256*b+p[g+E],E+=C,_-=8);for(x=b&(1<<-_)-1,b>>=-_,_+=v;0<_;x=256*x+p[g+E],E+=C,_-=8);if(b===0)b=1-A;else{if(b===S)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,v),b-=A}return(k?-1:1)*x*Math.pow(2,b-v)},i.write=function(p,g,m,v,y,b){var x,w,S,A=8*b-y-1,_=(1<<A)-1,E=_>>1,C=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=v?0:b-1,T=v?1:-1,I=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,x=_):(x=Math.floor(Math.log(g)/Math.LN2),g*(S=Math.pow(2,-x))<1&&(x--,S*=2),2<=(g+=1<=x+E?C/S:C*Math.pow(2,1-E))*S&&(x++,S/=2),_<=x+E?(w=0,x=_):1<=x+E?(w=(g*S-1)*Math.pow(2,y),x+=E):(w=g*Math.pow(2,E-1)*Math.pow(2,y),x=0));8<=y;p[m+k]=255&w,k+=T,w/=256,y-=8);for(x=x<<y|w,A+=y;0<A;p[m+k]=255&x,k+=T,x/=256,A-=8);p[m+k-T]|=128*I}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)})})(aX);var DMe=aX.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oX=function(e,t){return(oX=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function js(e,t){function n(){this.constructor=e}oX(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function tt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function nt(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var sX=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return RMe(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(a){var o=a.split(":"),s=o[0],u=o[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function RMe(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function pe(){return VF}var VF=null,Sm=new Map,Xy=new Map;function qF(e,t){var n=XF(e,t);return Sm.get(n)}function HF(e){return Xy.get(e)}function GF(e){for(var t=Sm.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===e&&n.push(s)}return n}function KF(e){var t=e.kernelName,n=e.backendName,r=XF(t,n);if(Sm.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Sm.set(r,e)}function uX(e){var t=e.kernelName;Xy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Xy.set(t,e)}function FMe(e,t){var n=XF(e,t);if(!Sm.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");Sm.delete(n)}function MMe(e){if(!Xy.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Xy.delete(e)}function XF(e,t){return t+"_"+e}function lX(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function bS(e,t,n){return Math.max(e,Math.min(t,n))}function YF(e){return e%2==0?e:e+1}function cX(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function U(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function ln(e,t,n){n===void 0&&(n=""),U(Wr(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Nh(e){U(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function rc(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Ni(e)&&!n)for(var r=0;r<e.length;++r)rc(e[r],t,n);else t.push(e);return t}function et(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Wr(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function vr(e){return e%1==0}function fX(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function xS(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Dh(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function ZF(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?i():setTimeout(o,s)}};o()})}function dX(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function Vr(e,t){var n=t.length;return U((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),U(e.every(function(r){return vr(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Af(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Vr(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Rh(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Yy(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function hX(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function pX(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function gX(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Ni(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function JF(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function mX(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Cf(e){return typeof e=="string"||e instanceof String}function vX(e){return typeof e=="boolean"}function yX(e){return typeof e=="number"}function Em(e){return Array.isArray(e)?Em(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":yX(e)?"float32":Cf(e)?"string":vX(e)?"bool":"float32"}function kf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function wS(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Qa(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function QF(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=rc(e)),n&&hX(e,t),function(a,o){return a instanceof Float32Array&&o==="float32"||a instanceof Int32Array&&o==="int32"||a instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function e3(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,a,o){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=o[i+l];else{u=a[0];var c=a.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(i+l*f,c,o)}return s}(0,e,t)}function t3(e,t){for(var n=Am(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Am(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Us(){return pe().platform.now()}function n3(e){e.forEach(function(t){U(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function bX(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.encode(e,t)}function Zy(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.decode(e,t)}function _S(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function r3(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var pt=Object.freeze({shuffle:lX,clamp:bS,nearestLargerEven:YF,sum:cX,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:U,assertShapesMatch:ln,assertNonNull:Nh,flatten:rc,sizeFromShape:et,isScalarShape:function(e){return e.length===0},arraysEqual:Wr,isInt:vr,tanh:fX,sizeToSquarishShape:xS,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return lX(t),t},rightPad:Dh,repeatedTry:ZF,inferFromImplicitShape:dX,parseAxisParam:Vr,squeezeShape:Af,getTypedArrayFromDType:Rh,getArrayFromDType:Yy,checkConversionForErrors:hX,isValidDtype:pX,hasEncodingLoss:gX,isTypedArray:Ni,bytesPerElement:JF,bytesFromStringArray:mX,isString:Cf,isBoolean:vX,isNumber:yX,inferDtype:Em,isFunction:kf,nearestDivisor:wS,computeStrides:Qa,toTypedArray:QF,toNestedArray:e3,makeOnesTypedArray:t3,makeZerosTypedArray:Am,now:Us,assertNonNegativeIntegerDimensions:n3,fetch:function(e,t){return pe().platform.fetch(e,t)},encodeString:bX,decodeString:Zy,locToIndex:_S,indexToLoc:r3}),PMe=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new $Me)}return e.prototype.profileKernel=function(t,n,r){var i,a=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),o.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),i},e}(),$Me=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?Dh(i+"ms",9):i.error,u=Dh(t,25),l=n.rank,c=n.size,f=Dh(n.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||n.shape,g=p.length;d+=h+": "+g+"D "+(g>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),xX=20,Jy=3,i3=7;function LMe(e,t,n,r){var i=Qa(t),a=function(l,c,f,d){var h=et(c),p=d[d.length-1],g=new Array(p).fill(0),m=c.length,v=f==="complex64"?eb(l):l;if(m>1)for(var y=0;y<h/p;y++)for(var b=y*p,x=0;x<p;x++)g[x]=Math.max(g[x],Qy(v[b+x],0,f).length);return g}(e,t,n,i),o=t.length,s=function l(c,f,d,h,p,g){g===void 0&&(g=!0);var m=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[Qy(eb(c)[0],0,d)]:d==="bool"?[wX(c[0])]:[c[0].toString()];if(y===1){if(v>xX){var b=Jy*m,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-Jy)*m,v*m));return d==="complex64"&&(x=eb(x),w=eb(w)),["["+x.map(function(O,D){return Qy(O,p[D],d)}).join(", ")+", ..., "+w.map(function(O,D){return Qy(O,p[v-Jy+D],d)}).join(", ")+"]"]}return["["+(d==="complex64"?eb(c):Array.from(c)).map(function(O,D){return Qy(O,p[D],d)}).join(", ")+"]"]}var S=f.slice(1),A=h.slice(1),_=h[0]*m,E=[];if(v>xX){for(var C=0;C<Jy;C++){var k=(T=C*_)+_;E.push.apply(E,l(c.slice(T,k),S,d,A,p,!1))}for(E.push("..."),C=v-Jy;C<v;C++)k=(T=C*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,A,p,C===v-1))}else for(C=0;C<v;C++){var T;k=(T=C*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,A,p,C===v-1))}var I=y===2?",":"";for(E[0]="["+E[0]+I,C=1;C<E.length-1;C++)E[C]=" "+E[C]+I;var N=`,
`;for(C=2;C<y;C++)N+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(g?"":N),E}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Qy(e,t,n){return Dh(Array.isArray(e)?parseFloat(e[0].toFixed(i3))+" + "+parseFloat(e[1].toFixed(i3))+"j":Cf(e)?"'"+e+"'":n==="bool"?wX(e):parseFloat(e.toFixed(i3)).toString(),t)}function wX(e){return e===0?"false":"true"}function eb(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Cm=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=et(t),r!=null){var a=r.length;U(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Yy(n,this.size),this.strides=Qa(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),U(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Lu().makeTensor(this.values,this.shape,this.dtype)},e}(),Lu=null,ye=null,_X=null,Ht=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=et(t),this.strides=Qa(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),ye.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,ye.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ye.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,e3(this.shape,t)]}})})},e.prototype.arraySync=function(){return e3(this.shape,this.dataSync())},e.prototype.data=function(){return tt(this,void 0,void 0,function(){var t,n;return nt(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Lu().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return Zy(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Lu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Zy(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Lu().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Lu().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ye.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ye.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ye.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),ye.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ye.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ye.clone(this)},e.prototype.toString=function(t){return t===void 0&&(t=!1),LMe(this.dataSync(),this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ye.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),ye.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),ye.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),ye.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ye.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ye.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),ye.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ye.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),_X("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ye.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ye.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ye.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ye.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ye.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ye.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ye.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ye.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ye.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ye.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ye.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ye.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ye.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ye.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ye.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ye.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ye.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ye.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ye.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ye.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ye.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ye.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ye.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ye.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ye.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ye.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ye.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ye.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ye.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ye.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ye.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ye.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ye.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ye.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),ye.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),ye.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ye.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ye.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ye.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ye.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ye.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ye.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ye.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ye.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ye.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ye.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ye.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ye.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ye.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ye.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ye.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ye.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),ye.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ye.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ye.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ye.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ye.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ye.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ye.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ye.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ye.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ye.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ye.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ye.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ye.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ye.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ye.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ye.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ye.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ye.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ye.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ye.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ye.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ye.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ye.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ye.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ye.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ye.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),ye.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),ye.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),ye.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),ye.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),ye.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),ye.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),ye.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Lu().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ye.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),ye.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),ye.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),ye.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ye.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),ye.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),ye.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ye.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ye.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ye.spectral.irfft(this)},e}();Object.defineProperty(Ht,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var a3,o3,s3,u3,l3,tb=function(e){function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return js(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Wr(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Lu().disposeTensor(this),this.dataId=n.dataId,Lu().incRef(this,null)},t.prototype.dispose=function(){Lu().disposeVariable(this),this.isDisposedInternal=!0},t}(Ht);Object.defineProperty(tb,Symbol.hasInstance,{value:function(e){return e instanceof Ht&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(a3||(a3={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(o3||(o3={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(s3||(s3={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(u3||(u3={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(l3||(l3={}));var BMe={float32:u3,int32:o3,bool:s3,complex64:l3};function yi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return BMe[e][t]}function SS(e){return yi(e,"int32")}function fr(e,t){if(e.dtype===t.dtype)return[e,t];var n=yi(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function SX(e,t){U(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function c3(e){var t=[];return function n(r,i,a){if(r!=null){if(r instanceof Ht)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,i,a))}}}}(e,t,new Set),t}var f3,Bu=Object.freeze({makeTypesMatch:fr,assertTypesMatch:SX,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:c3}),EX=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),zMe=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new EX}return e.prototype.ready=function(){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=a.sent(),[3,3];case 2:i=r,a.label=3;case 3:if(!i)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new PMe(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;GF(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;GF(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var a=++this.pendingBackendInitId,o=i.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),a=i.success,o=i.asyncInit;if(o||a)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return i.startScope(a)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[],{}),n},e.prototype.runKernel=function(t,n,r,i,a){return this.runKernelFunc(null,n,null,t,r,i,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-a-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,a,o,s){var u,l=this,c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=qF(i,this.backendName);if(m!=null)d=function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:a,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b);var x=b.map(function(A){var _=A.dataId,E=A.shape,C=A.dtype;return l.makeTensorFromDataId(_,E,C)});if(f){var w=l.getTensorsForGradient(i,n,x);if(w==null){s==null&&(s=[]);var S=x.filter(function(A,_){return s[_]});w=(o||[]).slice().concat(S)}c=l.saveTensorsForBackwardMode(w)}return x};else{var v=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))};d=function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,v)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b),b}}return this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,n,function(){return d()}):d()}),f&&this.addTapeNode(i,n,u,r,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.saveTensorsForBackwardMode=function(t){var n=this;return t.map(function(r){return n.keep(n.clone(r))})},e.prototype.getTensorsForGradient=function(t,n,r){var i=HF(t);if(i!=null){var a=i.inputsToSave||[],o=i.outputsToSave||[],s=void 0;i.saveAllInputs?(U(Array.isArray(n),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(n).map(function(l){return n[l]})):s=a.map(function(l){return n[l]});var u=r.filter(function(l,c){return o[c]});return s.concat(u)}return null},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var a=t;r==="string"&&Cf(t[0])&&(a=t.map(function(c){return bX(c)}));var o=i.write(a,n,r),s=new Ht(n,r,o,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(o),l=mX(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var a=new Ht(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,i),a},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var a=new tb(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*JF(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof tb||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,a,o){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=HF(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=function(c){return c=c.map(function(f,d){if(f==null){var h=r[d],p=Am(h.size,h.dtype);return s.makeTensor(p,h.shape,h.dtype)}return f}),i(c.length>1?c:c[0],a,o)}),this.state.activeTape.push(u)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=c3(t),i=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||i.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var a=this;if(i===void 0&&(i=!1),U(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});U(o instanceof Ht,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var g in p){for(var m=p[g],v=!1,y=0;y<l.length;y++)if(f[m.id]){S.outputs.forEach(function(C){return f[C.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var g in p)b[p[g].id]=!0,x[S.id]=!0;break}var w=[];for(h=0;h<u.length;h++){var S;if(d[(S=u[h]).id]&&x[S.id]){var A={};for(var g in S.inputs){var _=S.inputs[g];f[_.id]&&(A[g]=_)}var E=Object.assign({},S);E.inputs=A,E.outputs=S.outputs,w.push(E)}}return w}(this.state.activeTape,n,o);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[o.id]=r??(u=o.shape,l=t3(et(u),"float32"),J.makeTensor(l,u,"float32")),function(d,h,p){for(var g=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(A){var _=d[A.id];_!=null?b.push(_):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(A){if(!(A in x))throw new Error("Cannot backprop through input "+A+". Available gradients found: "+Object.keys(x)+".");var _=p(function(){return x[A]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+A+" must have 'float32' dtype, but has '"+_.dtype+"'");var E=y.inputs[A];if(!Wr(_.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+A+"' has shape '"+_.shape+"', which does not match the shape of the input '"+E.shape+"'");if(d[E.id]==null)d[E.id]=_;else{var C=d[E.id];d[E.id]=C.add(_),C.dispose()}};for(var S in y.inputs)w(S)},m=h.length-1;m>=0;m--)g(m)}(c,s,function(d){return a.tidy(d)});var f=n.map(function(d){return c[d.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:o,grads:f}})},e.prototype.customGrad=function(t){var n=this;return U(kf(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];U(i.every(function(s){return s instanceof Ht}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(s,u){o[u]=s}),n.runKernelFunc(function(s,u){return U((r=t.apply(void 0,i.concat([u]))).value instanceof Ht,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),U(kf(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];U(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),U(c.every(function(d){return d instanceof Ht}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){switch(i.label){case 0:return n=Us(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=Us()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new EX,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),J=function(){var e=function(){if(f3==null){var n=void 0;if(typeof window!="undefined")n=window;else if(typeof global!="undefined")n=global;else if(typeof process!="undefined")n=process;else{if(typeof self=="undefined")throw new Error("Could not find a global object");n=self}f3=n}return f3}();if(e._tfengine==null){var t=new sX(e);e._tfengine=new zMe(t)}return function(n){VF=n}(e._tfengine.ENV),Lu=function(){return e._tfengine},e._tfengine}();function AX(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var ic=pe();ic.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ic.registerFlag("IS_BROWSER",function(){return AX()}),ic.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&process.versions!==void 0&&process.versions.node!==void 0}),ic.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ic.registerFlag("PROD",function(){return!1}),ic.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ic.getBool("DEBUG")}),ic.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ic.registerFlag("IS_TEST",function(){return!1});var nb,Oo,Io,Fh={},d3={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function CX(e,t){Fh[e]=t}function zu(e){e in Fh||(Fh[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Fh[n]},!1),n===1?r.getContext("webgl",d3)||r.getContext("experimental-webgl",d3):r.getContext("webgl2",d3)}(e));var t=Fh[e];return t.isContextLost()?(delete Fh[e],zu(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Fh[e])}function ES(e,t){return[t,e]}function rb(e){var t=et(e);return xS(Math.ceil(t/4))}function ib(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function h3(e,t){var n,r,i,a,o,s,u,l,c,f=e;return pe().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,i=f.RGBA16F,a=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=f.RGBA,o=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function Qe(e,t,n){var r=n();return t&&function(i){var a=i.getError();if(a!==i.NO_ERROR)throw new Error("WebGL Error: "+TX(i,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(nb||(nb={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Oo||(Oo={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Io||(Io={}));var jMe=596e-10,UMe=65504;function kX(e){return!!(pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||jMe<Math.abs(e)&&Math.abs(e)<UMe)}function TX(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function ab(e,t,n){return ac(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function OX(e,t,n){var r=ac(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function IX(e,t,n){var r=ac(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,a){var o=WMe.exec(a);if(o==null)return console.log("Couldn't parse line number in error: "+a),void console.log(i);for(var s=+o[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,v){return Dh((v+1).toString(),l)+m}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+Dh(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var AS,CS,WMe=/ERROR: [0-9]+:([0-9]+):/g;function NX(e,t){return ac(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function DX(e,t,n){if(Qe(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function kS(e,t,n){if(Qe(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function RX(e,t,n){var r=ac(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function FX(e,t,n){var r=ac(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function MX(e,t){return ac(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function PX(e,t){var n=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function $X(e,t){return ac(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function p3(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return u!==-1&&(Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),Qe(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)}),Qe(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function LX(e,t,n,r){WX(e,r),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function BX(e,t,n,r){return ac(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function zX(e,t,n){return e.getUniformLocation(t,n)}function jX(e,t,n,r,i,a){Qe(e,t,function(){return LX(e,t,r,a)}),Qe(e,t,function(){return e.uniform1i(i,a)})}function TS(e,t,n,r){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function g3(e,t,n){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function ob(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+UX(e,t))}function UX(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function ac(e,t,n,r){var i=Qe(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function WX(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function sb(e,t){return t===void 0&&(t=2),et(e.slice(0,e.length-t))}function ub(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function OS(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[sb(e)].concat(ub(e))),t}function VX(e,t){var n;t===void 0&&(t=!1);var r=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?YF(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=Af(e);e=i.newShape}var a=et(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=sb(e),s=2,u=2;return e.length&&(s=(n=ub(e))[0],u=n[1]),xS(a=o*(s/2)*(u/2)).map(function(l){return 2*l})}return xS(a)}function IS(e){return e%2==0}function lb(e,t){if(Wr(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||IS(n)&&IS(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&IS(e[0])&&IS(t[0])}function qX(e){if(AS==null){var t=zu(e);AS=t.getParameter(t.MAX_TEXTURE_SIZE)}return AS}function HX(e){if(CS==null){var t=zu(e);CS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,CS)}function GX(e){if(e===0)return 0;var t=zu(e);return No(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:No(t,"EXT_disjoint_timer_query")?1:0}function No(e,t){return e.getExtension(t)!=null}function m3(e){try{if(zu(e)!=null)return!0}catch(t){return!1}return!1}function KX(e){if(e===0)return!1;var t=zu(e);if(e===1){if(!No(t,"OES_texture_float"))return!1}else if(!No(t,"EXT_color_buffer_float"))return!1;return v3(t)}function XX(e){if(e===0)return!1;var t=zu(e);if(e!==1){if(No(t,"EXT_color_buffer_float"))return v3(t);if(No(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var a=h3(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!No(t,"OES_texture_float")&&!!No(t,"WEBGL_color_buffer_float")&&v3(t)}function v3(e){var t=h3(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function YX(e){return e===2&&zu(e).fenceSync!=null}var VMe=Object.freeze({callAndCheck:Qe,canBeRepresented:kX,getWebGLErrorMessage:TX,getExtensionOrThrow:ab,createVertexShader:OX,createFragmentShader:IX,createProgram:NX,linkProgram:DX,validateProgram:kS,createStaticVertexBuffer:RX,createStaticIndexBuffer:FX,getNumChannels:function(){return pe().getNumber("WEBGL_VERSION")===2?1:4},createTexture:MX,validateTextureSize:PX,createFramebuffer:$X,bindVertexBufferToProgramAttribute:p3,bindTextureUnit:LX,unbindTextureUnit:function(e,t,n){WX(e,n),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:BX,getProgramUniformLocation:zX,bindTextureToProgramUniformSampler:jX,bindCanvasToFramebuffer:function(e,t){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Qe(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),Qe(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:TS,unbindColorTextureFromFramebuffer:g3,validateFramebuffer:ob,getFramebufferErrorMessage:UX,getBatchDim:sb,getRowsCols:ub,getShapeAs3D:OS,getTextureShapeFromLogicalShape:VX,isReshapeFree:lb,getWebGLMaxTextureSize:qX,resetMaxTextureSize:function(){AS=null},resetMaxTexturesInShader:function(){CS=null},getMaxTexturesInShader:HX,getWebGLDisjointQueryTimerVersion:GX,hasExtension:No,isWebGLVersionEnabled:m3,isCapableOfRenderingToFloatTexture:KX,isDownloadFloatTextureEnabled:XX,isWebGLFenceEnabled:YX}),At=pe();function qMe(){pe().set("PROD",!0)}function HMe(){pe().set("DEBUG",!0)}function GMe(){pe().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function NS(e){pe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function KMe(){J.disposeVariables()}function XMe(){return J}function DS(){return J.memory()}function YMe(e){return J.profile(e)}function ue(e,t){return J.tidy(e,t)}function jt(e){c3(e).forEach(function(t){return t.dispose()})}function ju(e){return J.keep(e)}function ZMe(e){return J.time(e)}function JMe(e){return J.setBackend(e)}function QMe(){return J.ready()}function ePe(){return J.backendName}function tPe(e){J.removeBackend(e)}function nPe(e){return J.findBackend(e)}function rPe(e){return J.findBackendFactory(e)}function iPe(e,t,n){return n===void 0&&(n=1),J.registerBackend(e,t,n)}function ZX(){return J.backend}function aPe(e,t){pe().setPlatform(e,t)}function RS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pe().getBool("IS_TEST")||console.warn.apply(console,e)}function Uu(e,t){var n=e;if(Ni(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Ni(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&pe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(a,o,s){if(s=s||[],!Array.isArray(a)&&!Ni(a))return void U(o.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});U(o.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),U(a.length===o[0],function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+a.length+" elements"});for(var u=o.slice(1),l=0;l<a.length;++l)i(a[l],u,s.concat(l))}(e,r,[]),r}function JX(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function j(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Ht)return JX(r,e.dtype,t,n),e;var i=Em(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),JX(r,i,t,n),e==null||!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=Uu(e,i);Ni(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?QF(e,i,pe().getBool("DEBUG")):rc(e,[],!0);return J.makeTensor(s,o,i)}function cb(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,a){return j(i,t+"["+a+"]",n)},r)}function y3(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function QX(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function Di(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(a){return e[a]})]}function ya(e,t){return QX(e,t.map(function(n){return 1}),t)}function eo(e,t,n){U(y3(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Ws(e,t){if(y3(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function FS(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Vs(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function eY(e,t){var n=e[0].length;e.forEach(function(i,a){U(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),U(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)U(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function Mh(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Q(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];J.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),J.endScope(s),s}catch(u){throw J.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}At.registerFlag("HAS_WEBGL",function(){return At.getNumber("WEBGL_VERSION")>0}),At.registerFlag("WEBGL_VERSION",function(){return m3(2)?2:m3(1)?1:0}),At.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return At.get("WEBGL_VERSION")===2}),At.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),At.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),At.registerFlag("WEBGL_PACK",function(){return At.getBool("HAS_WEBGL")}),At.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_CLIP",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),At.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_PACK_REDUCE",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_LAZILY_UNPACK",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_CONV_IM2COL",function(){return At.getBool("WEBGL_PACK")}),At.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return qX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return HX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=At.getNumber("WEBGL_VERSION");return e===0?0:GX(e)}),At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return At.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),At.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return KX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!At.getBool("WEBGL_FORCE_F16_TEXTURES")&&At.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),At.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return XX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return YX(At.getNumber("WEBGL_VERSION"))}),At.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return At.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),_X=NS;var ii=Q({complex_:function(e,t){var n=j(e,"real","complex"),r=j(t,"imag","complex");return ln(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),J.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),to=Q({real_:function(e){var t=j(e,"input","real");return J.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),os=Q({imag_:function(e){var t=j(e,"input","imag");return J.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Mr(e,t,n){return Tf(e,t,Uu(e,n),n)}function Tf(e,t,n,r){if(r==null&&(r=Em(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){n3(t);var i=et(t),a=et(n);U(i===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a});for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==et(t.slice(o));U(n[o]===t[o]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Ni(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?QF(e,r,pe().getBool("DEBUG")):rc(e,[],!0),J.makeTensor(e,t,r)}function Ve(e,t){if((Ni(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ni(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Tf(e,[],[],t)}function ba(e,t){Nh(e);var n=Uu(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Tf(e,null,n,t)}function Wu(e,t,n){if(Nh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Uu(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Tf(e,t,r,n)}function MS(e,t,n){if(Nh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Uu(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function Of(e,t,n){if(Nh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Uu(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function tY(e,t,n){if(Nh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Uu(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Tf(e,t,r,n)}function nY(e,t,n){if(Nh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Uu(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Tf(e,t=t||r,r,n)}function b3(e,t,n,r){return t===void 0&&(t=!0),J.makeVariable(e,t,n,r)}function Vu(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Vu(e,"float32"),r=Tn(e,"float32");return ii(n,r)}var i=t3(et(e),t);return J.makeTensor(i,e,t)}function Tn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Tn(e,"float32"),r=Tn(e,"float32");return ii(n,r)}var i=Am(et(e),t);return J.makeTensor(i,e,t)}function km(e,t,n){return J.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function x3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return J.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Tm(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Tn([0],r);var i=Am(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return ba(i,r)}var Do=Q({onesLike_:function(e){var t=j(e,"x","onesLike");if(t.dtype==="complex64"){var n=Do(to(t)),r=en(os(t));return ii(n,r)}return J.runKernelFunc(function(i){return i.onesLike(t)},{x:t},function(i,a){return{x:function(){return en(i)}}},"OnesLike")}}),en=Q({zerosLike_:function(e){var t=j(e,"x","zerosLike");return J.runKernelFunc(function(n){return n.zerosLike(t)},{x:t},function(n,r){return{x:function(){return en(n)}}},"ZerosLike")}}),Hi=Q({concat_:function(e,t){t===void 0&&(t=0),U(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=cb(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Vr(t,n[0].shape)[0];var r=Mh(n.map(function(s){return s.shape}),t);if(et(r)===0)return Mr([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});eY(i,t);var a=n,o={axis:t};return J.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=i.map(function(l){return l[t]});return oc(s,u,t).map(function(l){return function(){return l}})},"Concat",o)}}),w3=Q({concat1d_:function(e){return Hi(e,0)}}),_3=Q({concat2d_:function(e,t){return Hi(e,t)}}),S3=Q({concat3d_:function(e,t){return Hi(e,t)}}),E3=Q({concat4d_:function(e,t){return Hi(e,t)}}),oc=Q({split_:function(e,t,n){n===void 0&&(n=0);var r,i=j(e,"x","split");return n=Vr(n,i.shape)[0],typeof t=="number"?(U(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(U(i.shape[n]===t.reduce(function(a,o){return a+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),J.runKernelFunc(function(a){return a.split(i,r,n)},{$x:i},function(a){return{$x:function(){return Hi(a,n)}}})}});function Ot(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",n3(e),new Cm(e,t,n)}function rY(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var PS=Q({batchToSpaceND_:function(e,t,n){var r=j(e,"x","batchToSpaceND"),i=t.reduce(function(a,o){return a*o});return U(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),U(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),U(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),J.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),$S=Q({cast_:function(e,t){var n=j(e,"x","cast");if(!pX(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return J.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),iY=Q({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=j(e,"x","cumsum"),a=Ws([t|=0],i.rank),o=i;a!=null&&(o=i.transpose(a));var s=Vs(1,i.rank)[0],u=J.runKernelFunc(function(l){return l.cumsum(o,s,n,r)},{permutedX:o},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),A3=Q({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=j(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return U(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),U(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),U(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),J.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Ro=Q({expandDims_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","expandDims",null);U(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(U(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),qs(n,r)}}),qs=Q({reshape_:function(e,t){var n=j(e,"x","reshape",null);t=dX(t,n.size),U(n.size===et(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return J.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),LS=Q({spaceToBatchND_:function(e,t,n){var r=j(e,"x","spaceToBatchND");return U(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),U(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),U(r.shape.reduce(function(i,a,o){return o>0&&o<=t.length?i&&(a+n[o-1][0]+n[o-1][1])%t[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),J.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),fb=Q({squeeze_:function(e,t){var n=j(e,"x","squeeze");return qs(n,Af(n.shape,t).newShape)}}),ss=Q({stack_:function(e,t){t===void 0&&(t=0);var n=cb(e,"tensors","stack");if(U(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;U(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){ln(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){U(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(s){return s.expandDims(t)});return Hi(o,t)}}),If=Q({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=j(e,"x","unstack");U(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return J.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return ss(i,t)}}},"Unpack",r)}}),C3=function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return n=j(e,"x","setdiff1d"),r=j(t,"y","setdiff1d"),U(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),U(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),U(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(a=d.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(u=new Cm([s],n.dtype),l=new Cm([s],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function BS(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function zS(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function jS(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function aY(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function oY(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var k3="Add",oPe="AddN",db="Div",sPe="FusedBatchNorm",hb="SquaredDifference",uPe="Square",lPe="Transpose",cPe="NonMaxSuppressionV5",T3="BroadcastTo",O3="OneHot",I3="Identity",N3="Tile",D3="PadV2",fPe="FromPixels",dPe="MaxPoolWithArgmax",Ut=Q({add_:function(e,t){var n,r=j(e,"a","add"),i=j(t,"b","add");n=fr(r,i),r=n[0],i=n[1];var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.add(r,i);return s([r,i]),u},a,null,k3)}});function sc(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function qr(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function Qt(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}var Nf=Q({abs_:function(e){var t=j(e,"x","abs");return t.dtype==="complex64"?J.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):J.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),R3=Q({acos_:function(e){var t=j(e,"x","acos");return J.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),F3=Q({acosh_:function(e){var t=j(e,"x","acosh");return J.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),M3=Q({asin_:function(e){var t=j(e,"x","asin");return J.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt())}}})}}),P3=Q({asinh_:function(e){var t=j(e,"x","asinh");return J.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).add(i.toFloat().square()).sqrt())}}})}}),$3=Q({atan_:function(e){var t=j(e,"x","atan");return J.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),L3=Q({atanh_:function(e){var t=j(e,"x","atanh");return J.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(Ve(1).sub(i.toFloat().square()))}}})}}),B3=Q({ceil_:function(e){var t=j(e,"x","ceil");return J.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),xa=Q({clipByValue_:function(e,t,n){var r=j(e,"x","clipByValue");U(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],a={min:t,max:n};return J.runKernelFunc(function(o,s){var u=o.clip(r,t,n);return s([r]),u},{x:r},function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),en(o))}}},"ClipByValue",a,i)}}),z3=Q({cos_:function(e){var t=j(e,"x","cos"),n=[t];return J.runKernelFunc(function(r,i){var a=r.cos(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),j3=Q({cosh_:function(e){var t=j(e,"x","cosh");return J.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),U3=Q({erf_:function(e){var t=j(e,"x","erf");return U(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),J.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),W3=Q({exp_:function(e){var t=j(e,"x","exp");return J.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),V3=Q({expm1_:function(e){var t=j(e,"x","expm1");return J.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),US=Q({floor_:function(e){var t=j(e,"x","floor");return J.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),uc=Q({log_:function(e){var t=j(e,"x","log"),n=[t];return J.runKernelFunc(function(r,i){var a=r.log(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),q3=Q({log1p_:function(e){var t=j(e,"x","log1p");return J.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),sY=Q({logSigmoid_:function(e){var t=j(e,"x","logSigmoid");return J.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),Df=Q({neg_:function(e){var t=j(e,"x","neg"),n=[t];return J.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),H3=Q({reciprocal_:function(e){var t=j(e,"x","reciprocal");return J.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),G3=Q({round_:function(e){var t=j(e,"x","round");return J.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),WS=Q({rsqrt_:function(e){var t=j(e,"x","rsqrt"),n=[t];return J.runKernelFunc(function(r,i){var a=r.rsqrt(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),VS=Q({sigmoid_:function(e){var t=j(e,"x","sigmoid");return J.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(Ve(1).sub(i)))}}},"Sigmoid")}}),K3=Q({sign_:function(e){var t=j(e,"x","sign");return J.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),uY=Q({isNaN_:function(e){var t=j(e,"x","isNaN");return J.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),lY=Q({isInf_:function(e){var t=j(e,"x","isInf");return J.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),cY=Q({isFinite_:function(e){var t=j(e,"x","isFinite");return J.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),X3=Q({sin_:function(e){var t=j(e,"x","sin"),n=[t];return J.runKernelFunc(function(r,i){var a=r.sin(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),Y3=Q({sinh_:function(e){var t=j(e,"x","sinh");return J.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),pb=Q({softplus_:function(e){var t=j(e,"x","softplus");return J.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),gb=Q({sqrt_:function(e){var t=j(e,"x","sqrt");return J.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),fY=Q({step_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","step");return J.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return en(r)}}})}}),Z3=Q({tan_:function(e){var t=j(e,"x","tan");return J.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),qS=Q({tanh_:function(e){var t=j(e,"x","tanh");return J.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return Ve(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}}),dY=Q({addStrict_:function(e,t){var n=j(e,"a","addStrict"),r=j(t,"b","addStrict");return ln(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),J3=Q({atan2_:function(e,t){var n,r=j(e,"a","atan2"),i=j(t,"b","atan2");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Ut(u.square(),l.square()),f=o.mul(l.div(c)),d=qr(u.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Ut(u.square(),l.square()),f=Df(o.mul(u.div(c))),d=qr(l.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),hY=Q({divStrict_:function(e,t){var n=j(e,"a","div"),r=j(t,"b","div");return ln(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),HS=Q({floorDiv_:function(e,t){var n,r=j(e,"a","floorDiv"),i=j(t,"b","floorDiv");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.div(l.toFloat()),f=qr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=qr(l.shape,a);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),qu=Q({maximum_:function(e,t){var n,r=j(e,"a","maximum"),i=j(t,"b","maximum");return n=fr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.maximum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),pY=Q({maximumStrict_:function(e,t){var n=j(e,"a","maximumStrict"),r=j(t,"b","maximumStrict");return ln(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Om=Q({minimum_:function(e,t){var n,r=j(e,"a","minimum"),i=j(t,"b","minimum");return n=fr(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.minimum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),gY=Q({minimumStrict_:function(e,t){var n=j(e,"a","minimumStrict"),r=j(t,"b","minimumStrict");return ln(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Q3=Q({mod_:function(e,t){var n,r=j(e,"a","mod"),i=j(t,"b","mod");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=qr(u.shape,a);return c.length>0?o.sum(c).reshape(u.shape):o},$b:function(){var c=o.mul(u.div(l).floor().neg()),f=qr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),mY=Q({modStrict_:function(e,t){var n=j(e,"a","modStrict"),r=j(t,"b","modStrict");return ln(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),rt=Q({mul_:function(e,t){var n,r=j(e,"a","mul"),i=j(t,"b","mul");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.mul(l.toFloat()),f=qr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=qr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),GS=Q({mulStrict_:function(e,t){var n=j(e,"a","mul"),r=j(t,"b","mul");return ln(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Im=Q({pow_:function(e,t){var n,r=j(e,"base","pow"),i=j(t,"exp","pow");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape),o=[r,i];return J.runKernelFunc(function(s,u){var l=s.pow(r,i);return u([r,i,l]),l},{a:r,b:i},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(Ve(1))))),p=qr(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,en(l)),p=s.mul(f.mul(h)),g=qr(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),vY=Q({powStrict_:function(e,t){return ln(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),yY=Q({squaredDifferenceStrict_:function(e,t){var n=j(e,"a","squaredDifferenceStrict"),r=j(t,"b","squaredDifferenceStrict");return ln(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ar=Q({sub_:function(e,t){var n,r=j(e,"a","sub"),i=j(t,"b","sub");n=fr(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var s=o,u=qr(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=o,u=qr(i.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),bY=Q({subStrict_:function(e,t){var n=j(e,"a","subStrict"),r=j(t,"b","subStrict");return ln(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Cr=Q({div_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");if(n=fr(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return HS(r,i);var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.realDivide(r,i);return s([r,i]),u},a,null,db,{})}});function eM(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var l=Qa(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var hPe=Object.freeze({prepareAndValidate:eM}),tM=30;function KS(e){return e<=tM?e:wS(e,Math.floor(Math.sqrt(e)))}function xY(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}function wY(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}xY(n,t,e)}function mb(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:et(t.shape)/u,sliceSize:o,strides:Qa(n.slice(0,i)).concat([1]),outputSize:et(n)}}var pPe=Object.freeze({validateUpdateShape:xY,validateInput:wY,calculateShapes:mb});function _Y(e,t,n){U(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),U(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){U(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},i=0;i<e.rank;++i)r(i)}function nM(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function XS(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function SY(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=bS(0,a,s-1)}function EY(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?bS(0,a,s):bS(-1,a,s-1)}function rM(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function iM(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}var gPe=Object.freeze({assertParamsValid:_Y,maskToAxes:nM,computeOutShape:XS,startForAxis:SY,stopForAxis:EY,isSliceContinous:rM,computeFlatOffset:iM});function mPe(e){return U(kf(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var r=j(t,"x","tf.grad",null),i=n!=null?j(n,"dy","tf.grad"):null;return J.tidy(function(){var a=J.gradients(function(){return e(r)},[r],i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),YS(s),s[0]})}}function vPe(e){return U(kf(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){U(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=cb(t,"args","tf.grads",null),i=n!=null?j(n,"dy","tf.grads"):null;return J.tidy(function(){var a=J.gradients(function(){return e.apply(void 0,r)},r,i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),YS(s),s})}}function yPe(e){return U(kf(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){U(t instanceof Ht,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=J.gradients(function(){return e(t)},[t],n),i=r.grads,a=r.value;return YS(i),{grad:i[0],value:a}}}function bPe(e){return U(kf(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){U(Array.isArray(t)&&t.every(function(i){return i instanceof Ht}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=J.gradients(function(){return e.apply(void 0,t)},t,n);return n!=null&&ln(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),YS(r.grads),r}}function AY(e,t){U(kf(e),function(){return"The f passed in variableGrads(f) must be a function"}),U(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof tb}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],J.registeredVariables)t.push(J.registeredVariables[r]);var i=n?t.filter(function(c){return!c.trainable}):null,a=t.length;U((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var o=J.gradients(e,t,null,!0),s=o.value,u=o.grads;U(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),U(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function vb(e){return J.customGrad(e)}function YS(e){if(e.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Ph=Q({softmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return J.runKernelFunc(function(r,i){var a=r.softmax(n,t);return i([a]),a},{logits:n},function(r,i){var a=i[0],o=r.mul(a);return{logits:function(){return o.sub(o.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),ZS=Q({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return vb(function(r,i){var a=r.max(t,!0),o=r.sub(a),s=o.toFloat().sub(o.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),cn=Q({transpose_:function(e,t){var n=j(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){U(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return J.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}}),aM=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),oM=function(){function e(){}return e.prototype.time=function(t){return fe("time")},e.prototype.read=function(t){return fe("read")},e.prototype.readSync=function(t){return fe("readSync")},e.prototype.numDataIds=function(){return fe("numDataIds")},e.prototype.disposeData=function(t){return fe("disposeData")},e.prototype.write=function(t,n,r){return fe("write")},e.prototype.move=function(t,n,r,i){return fe("move")},e.prototype.memory=function(){return fe("memory")},e.prototype.floatPrecision=function(){return fe("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return fe("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,fe("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return fe("slice")},e.prototype.stridedSlice=function(t,n,r,i){return fe("stridedSlice")},e.prototype.unstack=function(t,n){return fe("unstack")},e.prototype.reverse=function(t,n){return fe("reverse")},e.prototype.concat=function(t,n){return fe("concat")},e.prototype.neg=function(t){return fe("neg")},e.prototype.add=function(t,n){return fe("add")},e.prototype.addN=function(t){return fe("addN")},e.prototype.subtract=function(t,n){return fe("subtract")},e.prototype.multiply=function(t,n){return fe("multiply")},e.prototype.realDivide=function(t,n){return fe("realDivide")},e.prototype.floorDiv=function(t,n){return fe("floorDiv")},e.prototype.sum=function(t,n){return fe("sum")},e.prototype.prod=function(t,n){return fe("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return fe("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return fe("argMin")},e.prototype.argMax=function(t,n){return fe("argMax")},e.prototype.equal=function(t,n){return fe("equal")},e.prototype.notEqual=function(t,n){return fe("notEqual")},e.prototype.less=function(t,n){return fe("less")},e.prototype.lessEqual=function(t,n){return fe("lessEqual")},e.prototype.greater=function(t,n){return fe("greater")},e.prototype.greaterEqual=function(t,n){return fe("greaterEqual")},e.prototype.logicalNot=function(t){return fe("logicalNot")},e.prototype.logicalAnd=function(t,n){return fe("logicalAnd")},e.prototype.logicalOr=function(t,n){return fe("logicalOr")},e.prototype.where=function(t){return fe("where")},e.prototype.select=function(t,n,r){return fe("select")},e.prototype.topk=function(t,n,r){return fe("topk")},e.prototype.min=function(t,n){return fe("min")},e.prototype.minimum=function(t,n){return fe("minimum")},e.prototype.mod=function(t,n){return fe("mod")},e.prototype.max=function(t,n){return fe("max")},e.prototype.maximum=function(t,n){return fe("maximum")},e.prototype.all=function(t,n){return fe("all")},e.prototype.any=function(t,n){return fe("any")},e.prototype.squaredDifference=function(t,n){return fe("squaredDifference")},e.prototype.ceil=function(t){return fe("ceil")},e.prototype.floor=function(t){return fe("floor")},e.prototype.round=function(t){return fe("round")},e.prototype.sign=function(t){return fe("sign")},e.prototype.isNaN=function(t){return fe("isNaN")},e.prototype.isInf=function(t){return fe("isInf")},e.prototype.isFinite=function(t){return fe("isFinite")},e.prototype.pow=function(t,n){return fe("pow")},e.prototype.exp=function(t){return fe("exp")},e.prototype.expm1=function(t){return fe("expm1")},e.prototype.softmax=function(t,n){return fe("softmax")},e.prototype.log=function(t){return fe("log")},e.prototype.log1p=function(t){return fe("log1p")},e.prototype.sqrt=function(t){return fe("sqrt")},e.prototype.rsqrt=function(t){return fe("rsqrt")},e.prototype.square=function(t){return fe("square")},e.prototype.reciprocal=function(t){return fe("reciprocal")},e.prototype.relu=function(t){return fe("relu")},e.prototype.relu6=function(t){return fe("relu6")},e.prototype.prelu=function(t,n){return fe("prelu")},e.prototype.elu=function(t){return fe("elu")},e.prototype.eluDer=function(t,n){return fe("eluDer")},e.prototype.selu=function(t){return fe("selu")},e.prototype.int=function(t){return fe("int")},e.prototype.clip=function(t,n,r){return fe("clip")},e.prototype.abs=function(t){return fe("abs")},e.prototype.complexAbs=function(t){return fe("complexAbs")},e.prototype.sigmoid=function(t){return fe("sigmoid")},e.prototype.softplus=function(t){return fe("softplus")},e.prototype.sin=function(t){return fe("sin")},e.prototype.cos=function(t){return fe("cos")},e.prototype.tan=function(t){return fe("tan")},e.prototype.asin=function(t){return fe("asin")},e.prototype.acos=function(t){return fe("acos")},e.prototype.atan=function(t){return fe("atan")},e.prototype.atan2=function(t,n){return fe("atan2")},e.prototype.sinh=function(t){return fe("sinh")},e.prototype.cosh=function(t){return fe("cosh")},e.prototype.tanh=function(t){return fe("tanh")},e.prototype.asinh=function(t){return fe("asinh")},e.prototype.acosh=function(t){return fe("acosh")},e.prototype.atanh=function(t){return fe("atanh")},e.prototype.erf=function(t){return fe("erf")},e.prototype.step=function(t,n){return fe("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return fe("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return fe("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return fe("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return fe("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return fe("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return fe("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return fe("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return fe("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return fe("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return fe("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return fe("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return fe("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return fe("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return fe("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return fe("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return fe("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return fe("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return fe("reshape")},e.prototype.cast=function(t,n){return fe("cast")},e.prototype.tile=function(t,n){return fe("tile")},e.prototype.pad=function(t,n,r){return fe("pad")},e.prototype.transpose=function(t,n){return fe("transpose")},e.prototype.gather=function(t,n,r){return fe("gather")},e.prototype.gatherND=function(t,n){return fe("gatherND")},e.prototype.scatterND=function(t,n,r){return fe("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return fe("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return fe("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return fe("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return fe("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return fe("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return fe("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,a,o){return fe("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,a){return fe("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,a,o,s){return fe("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return fe("multinomial")},e.prototype.oneHot=function(t,n,r,i){return fe("oneHot")},e.prototype.cumsum=function(t,n,r,i){return fe("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,a){return fe("nonMaxSuppression")},e.prototype.fft=function(t){return fe("fft")},e.prototype.ifft=function(t){return fe("ifft")},e.prototype.complex=function(t,n){return fe("complex")},e.prototype.real=function(t){return fe("real")},e.prototype.imag=function(t){return fe("imag")},e.prototype.cropAndResize=function(t,n,r,i,a,o){return fe("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return fe("depthToSpace")},e.prototype.split=function(t,n,r){return fe("split")},e.prototype.sparseToDense=function(t,n,r,i){return fe("sparseToDense")},e.prototype.diag=function(t){return fe("diag")},e.prototype.fill=function(t,n,r){return fe("fill")},e.prototype.onesLike=function(t){return fe("onesLike")},e.prototype.zerosLike=function(t){return fe("zerosLike")},e.prototype.linspace=function(t,n,r){return fe("linspace")},e.prototype.dispose=function(){return fe("dispose")},e}();function fe(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Rf(e,t,n,r,i,a,o){o===void 0&&(o="channelsLast");var s,u=JS(t),l=u[0],c=u[1];if(o==="channelsLast")s=[l,c,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,c,e[1],e[1]]}return Ff(e,s,n,r,i,a,!1,o)}function yb(e,t,n,r,i,a,o){o===void 0&&(o="NDHWC");var s,u,l=uM(t),c=l[0],f=l[1],d=l[2];if(o==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return bb(e,s,n,r,i,!1,u,a)}function Ff(e,t,n,r,i,a,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],g=t[1],m=t[3],v=JS(n),y=v[0],b=v[1],x=JS(r),w=x[0],S=x[1],A=Nm(p,w),_=Nm(g,S),E=function(N,O,D,L,W,G,K,ee){var ce,he,Oe;if(typeof N=="number"){ce={top:N,bottom:N,left:N,right:N,type:N===0?"VALID":"NUMBER"};var Te=function(ae,Y,M,B,R){B==null&&(B=sM(ae,Y,M));var X=ae[0],ge=ae[1],xe=xb((X-Y+2*B)/M+1,R);U(vr(xe),function(){return"The output # of rows ("+xe+") must be an integer. Change the stride and/or zero pad parameters"});var ze=xb((ge-Y+2*B)/M+1,R);return U(vr(ze),function(){return"The output # of columns ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}),[xe,ze]}([O,D],G,L,N,ee);he=Te[0],Oe=Te[1]}else if(N==="same"){he=Math.ceil(O/L),Oe=Math.ceil(D/W);var Re=Math.max(0,(he-1)*L+G-O),me=Math.max(0,(Oe-1)*W+K-D),P=Math.floor(Re/2),F=Re-P,V=Math.floor(me/2);ce={top:P,bottom:F,left:V,right:me-V,type:"SAME"}}else{if(N!=="valid")throw Error("Unknown padding parameter: "+N);ce={top:0,bottom:0,left:0,right:0,type:"VALID"},he=Math.ceil((O-G+1)/L),Oe=Math.ceil((D-K+1)/W)}return{padInfo:ce,outHeight:he,outWidth:Oe}}(i,c,f,y,b,A,_,a),C=E.padInfo,k=E.outHeight,T=E.outWidth,I=o?m*d:m;return s==="channelsFirst"?h=[l,I,k,T]:s==="channelsLast"&&(h=[l,k,T,I]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:k,outWidth:T,outChannels:I,padInfo:C,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:A,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function bb(e,t,n,r,i,a,o,s){a===void 0&&(a=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(o==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],y=t[4],b=uM(n),x=b[0],w=b[1],S=b[2],A=uM(r),_=A[0],E=A[1],C=A[2],k=Nm(g,_),T=Nm(m,E),I=Nm(v,C),N=function(K,ee,ce,he,Oe,Te,Re,me,P,F,V){var ae,Y,M,B;if(typeof K=="number"){ae={top:K,bottom:K,left:K,right:K,front:K,back:K,type:K===0?"VALID":"NUMBER"};var R=function(Zt,mn,qn,ni,tr,Dn){tr==null&&(tr=sM(Zt,mn,ni));var Qo=Zt[0],Ka=Zt[1],Ul=Zt[2],Os=xb((Qo-mn+2*tr)/ni+1,Dn);U(vr(Os),function(){return"The output # of depths ("+Os+") must be an integer. Change the stride and/or zero pad parameters"});var Is=xb((Ka-mn+2*tr)/ni+1,Dn);U(vr(Is),function(){return"The output # of rows ("+Is+") must be an integer. Change the stride and/or zero pad parameters"});var Wl=xb((Ul-mn+2*tr)/ni+1,Dn);return U(vr(Wl),function(){return"The output # of columns ("+Wl+") must be an integer. Change the stride and/or zero pad parameters"}),[Os,Is,Wl,qn]}([ee,ce,he,1],me,1,Oe,K,V);Y=R[0],M=R[1],B=R[2]}else if(K==="same"){Y=Math.ceil(ee/Oe),M=Math.ceil(ce/Te),B=Math.ceil(he/Re);var X=(Y-1)*Oe+me-ee,ge=(M-1)*Te+P-ce,xe=(B-1)*Re+F-he,ze=Math.floor(X/2),Ke=X-ze,Ze=Math.floor(ge/2),Lt=ge-Ze,Je=Math.floor(xe/2);ae={top:Ze,bottom:Lt,left:Je,right:xe-Je,front:ze,back:Ke,type:"SAME"}}else{if(K!=="valid")throw Error("Unknown padding parameter: "+K);ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Y=Math.ceil((ee-me+1)/Oe),M=Math.ceil((ce-P+1)/Te),B=Math.ceil((he-F+1)/Re)}return{padInfo:ae,outDepth:Y,outHeight:M,outWidth:B}}(i,c,f,d,x,w,S,k,T,I,s),O=N.padInfo,D=N.outDepth,L=N.outHeight,W=N.outWidth,G=a?y*h:y;return o==="channelsFirst"?p=[l,G,D,L,W]:o==="channelsLast"&&(p=[l,D,L,W,G]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:D,outHeight:L,outWidth:W,outChannels:G,padInfo:O,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:_,dilationHeight:E,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function sM(e,t,n,r){r===void 0&&(r=1);var i=Nm(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function JS(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function uM(e){return typeof e=="number"?[e,e,e]:e}function Nm(e,t){return t<=1?e:e+(e-1)*(t-1)}function xb(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function $h(e){var t=JS(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Gi(e,t){return $h(e)||$h(t)}function QS(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function lM(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Tn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!gX(e.dtype,t))return J.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=Ve(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function eE(e,t){return J.makeTensorFromDataId(e.dataId,t,e.dtype)}function cM(e,t,n){var r=(t-e)/(n-1),i=Am(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return ba(i,"float32")}var xPe=Object.freeze({castTensor:lM,reshapeTensor:eE,linspaceImpl:cM,upcastType:yi,axesAreInnerMostDims:y3,combineLocations:QX,computeOutAndReduceShapes:Di,expandShapeToKeepDim:ya,assertAxesAreInnerMostDims:eo,getAxesPermutation:Ws,getUndoAxesPermutation:FS,getInnerMostAxes:Vs,getBroadcastDims:sc,getReductionAxes:qr,assertAndGetBroadcastShape:Qt,assertParamsConsistent:eY,computeOutShape:Mh,computePool2DInfo:Rf,computePool3DInfo:yb,computeConv2DInfo:Ff,computeConv3DInfo:bb,computeDefaultPad:sM,tupleValuesAreOne:$h,eitherStridesOrDilationsAreOne:Gi,convertConv2DDataFormat:QS,PARALLELIZE_THRESHOLD:tM,computeOptimalWindowSize:KS});function fM(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function CY(e,t){return{real:e[2*t],imag:e[2*t+1]}}function wPe(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function _Pe(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function SPe(e,t,n){var r=function(a,o,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var g=c(l,u[h=f+(d-f>>>1)]);g>0?f=h+1:(d=h,p=!g)}return p?f:-f-1}(a,o,s||EPe)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function EPe(e,t){return e>t?1:e<t?-1:0}function dM(e,t,n,r,i){return kY(e,t,n,r,i,0).selectedIndices}function hM(e,t,n,r,i,a){var o=kY(e,t,n,r,i,a);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function kY(e,t,n,r,i,a,o,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>i}).sort(TY),l=a>0?-.5/a:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(h<i)break;for(var m=!1,v=c.length-1;v>=g;--v){var y=APe(e,p,c[v]);if(y>=r){m=!0;break}if(d.score=d.score*CPe(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,m||(d.score===h?(c.push(p),f.push(d.score)):d.score>i&&SPe(u,d,TY))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:ba(c,"int32"),selectedScores:ba(f,"float32"),numValidOutputs:Ve(b,"int32")}}function APe(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var g=Math.max(a,l),m=Math.max(o,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(h+p-b)}function CPe(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function TY(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function OY(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(a){i[n]=a;var o=e.slice(r,i);return r[n]+=a,o})}function IY(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=Ot(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function NY(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],l=Rh(n,s*r),c=Rh("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort(function(x,w){return w.value-x.value});var m=f*r,v=l.subarray(m,m+r),y=c.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,y[g]=p[g].index}var b=t.slice();return b[b.length-1]=r,[Mr(l,b,n),Mr(c,b,"int32")]}function pM(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=Ot(e,"int32"),a=Ot([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var kPe=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},TPe=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},OPe=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function DY(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function no(e,t){return t===1?[e]:DY(e,t)}function Ki(){var e,t,n,r,i,a,o,s,u,l;return pe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Lh(e,t,n){n===void 0&&(n="index");var r=Qa(t);return r.map(function(i,a){return"int "+e[a]+" = "+n+" / "+i+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+i:"index -= "+e[a]+" * "+i)+";"}).join("")}function gM(e){var t=Qa(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var RY=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function IPe(e,t,n,r){var i=[];e.forEach(function(h){var p=et(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var a,o,s=i.join(`
`),u=e.map(function(h){return function(p,g,m){m===void 0&&(m=!1);var v="";v+=m?FY(p):Dm(p);var y=p.shapeInfo.logicalShape,b=g.logicalShape;return y.length<=b.length&&(v+=m?function(x,w){var S,A=x.name,_=A.charAt(0).toUpperCase()+A.slice(1),E="get"+_+"AtOutCoords",C=x.shapeInfo.logicalShape.length,k=w.logicalShape.length,T=sc(x.shapeInfo.logicalShape,w.logicalShape),I=Jn(k),N=k-C,O=["x","y","z","w","u","v"];S=C===0?"":k<2&&T.length>=1?"coords = 0;":T.map(function(ce){return"coords."+O[ce+N]+" = 0;"}).join(`
`);var D="";D=k<2&&C>0?"coords":x.shapeInfo.logicalShape.map(function(ce,he){return"coords."+O[he+N]}).join(", ");var L="return outputValue;",W=et(x.shapeInfo.logicalShape)===1,G=et(w.logicalShape)===1;if(C!==1||W||G){if(W&&!G)L=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var K=C-2,ee=C-1;T.indexOf(K)>-1&&T.indexOf(ee)>-1?L="return vec4(outputValue.x);":T.indexOf(K)>-1?L="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(ee)>-1&&(L="return vec4(outputValue.xx, outputValue.zz);")}}else L=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+I+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+_+"("+D+`);
      `+L+`
    }
  `}(p,g):function(x,w){var S=x.name,A=S.charAt(0).toUpperCase()+S.slice(1),_="get"+A+"AtOutCoords",E=w.texShape,C=x.shapeInfo.texShape,k=x.shapeInfo.logicalShape.length,T=w.logicalShape.length;if(!x.shapeInfo.isUniform&&k===T&&x.shapeInfo.flatOffset==null&&Wr(C,E))return`
      float `+_+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var I,N=Jn(T),O=sc(x.shapeInfo.logicalShape,w.logicalShape),D=T-k,L=["x","y","z","w","u","v"];I=k===0?"":T<2&&O.length>=1?"coords = 0;":O.map(function(G){return"coords."+L[G+D]+" = 0;"}).join(`
`);var W="";return W=T<2&&k>0?"coords":x.shapeInfo.logicalShape.map(function(G,K){return"coords."+L[K+D]}).join(", "),`
    float `+_+`() {
      `+N+` coords = getOutputCoords();
      `+I+`
      return get`+A+"("+W+`);
    }
  `}(p,g)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Ki(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+NPe+`
    `+DPe+`
    `+RPe+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(Wr(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var A=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+A+`);
      int c = imod(index, `+A+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=h,m=p,v=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(g[2]/2),b=y*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],A=Math.ceil(x[x.length-1]/2),_=A*Math.ceil(x[x.length-2]/2),E=_,C="",k="b, r, c",T=2;T<x.length-1;T++)E*=x[x.length-T-1],C=`
      int b`+T+" = index / "+E+`;
      index -= b`+T+" * "+E+`;
    `+C,k="b"+T+", "+k;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+C+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+A+`);
      int c = imod(index, `+A+`) * 2;

      return ivec`+x.length+"("+k+`);
    }
  `}(h,p)}var g,m,v,y,b}(t.logicalShape,l),o=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return Wr(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=p,m=Lh(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=Lh(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=Lh(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=Lh(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,m}(t.logicalShape,l),o=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=FPe),[d,f,o,s,a,u,n].join(`
`)}function Dm(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(o===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=Bh(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Rm(n)+`
      }
    `;var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(s===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Bh(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Wr(r,o)){var s=o[0],u=o[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Af(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=Fm(n,d);return`
      `+Dm(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+Mm(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Rm(n)+`
      }
    `;var p=o[0],g=o[1],m=Bh(i);return g===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+p+", "+g+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],s=r[2],u=Af(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=Fm(n,f);return`
        `+Dm(d)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+Mm(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+Rm(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],g=h[1],m=n.shapeInfo.flatOffset;if(g===o&&m==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(g===s&&m==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=Bh(i);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+g+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],s=r[2]*o,u=r[1]*s,l=Af(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=Fm(n,c);return`
      `+Dm(d)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+Mm(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+Rm(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=Bh(i);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+m+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],s=r[3]*o,u=r[2]*s,l=r[1]*u,c=Af(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=Fm(n,f);return`
      `+Dm(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+Mm(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+Rm(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],v=g[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===o&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=Bh(i);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Af(r),s=o.newShape,u=o.keptDims;if(s.length<r.length){var l=Fm(n,s);return`
      `+Dm(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+Mm(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Rm(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],y=m[1];if(y===p&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=Bh(i);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function FY(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ki(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var a=i.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Ki();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],f=Ki();if(u!=null&&Wr(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),f=Fm(i,c);return`
        `+FY(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Mm(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(a[2]/2),g=p*Math.ceil(a[1]/2),m=Ki();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+g+", "+p+`, b, row, col);
      return `+m.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(i){for(var a=i.shapeInfo.logicalShape,o=a.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),g="int b, int row, int col",m="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<o-1;v++)g="int b"+v+", "+g,p*=a[o-v-1],m="b"+v+" * "+p+" + "+m;var y=Ki();return`
    vec4 `+u+"("+g+`) {
      int index = `+m+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var NPe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,DPe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,RPe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,FPe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Bh(e){return"offset"+e}function Rm(e){var t=e.name,n=et(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Jn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Fm(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Mm(e,t){return t.map(function(n){return e[n]}).join(", ")}var MPe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,c=Jn(l),f=no("coords",l);if(a===1){var d=Jn(s=l+1);o=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,o=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],g=h.map(function(_){return"int "+_}),m=no("sourceLocR",s-1).concat("inIdx.r"),v=no("sourceLocG",s-1).concat("inIdx.g"),y=no("sourceLocB",s-1).concat("inIdx.b"),b=no("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",A=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+A+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},PPe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},$Pe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+g+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},LPe=function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="0.0";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},BPe=function(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="vec4(0.0)";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},zPe="return areal * breal - aimag * bimag;",jPe="return areal * bimag + aimag * breal;",MY=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},mM="return a + b;",vM="return a - b;",PY="return a * b;",UPe=`
if (a == b) {
  return 1.0;
};
return a / b;`,$Y="return (a < 0.) ? b * a : a;",kr=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},WPe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,LY=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Hu=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qt(t,n);var i=this.outputShape.length,a="";if(r)if(i===0||et(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+Jn(i)+` coords = getOutputCoords();
        `,i===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=no("coords",i);a+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},VPe=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),qPe=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),HPe=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},GPe=function(e){this.outputShape=[],this.outputShape=Mh(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},KPe=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Mh(e,t);var n=this.outputShape,r=n.length,i=Jn(r),a=no("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(m,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=o[t],c=o.slice(-2),f=o.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+tE(o,l,h)+`),
            vec2(`+tE(c,l,h)+`));
        }`}var p=s.length,g=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+tE(o,l,g)+`),
          vec2(`+tE(c,l,g)+"));",this.userCode=`
      float getValue(`+o.map(function(m){return"int "+m})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function tE(e,t,n){var r=e.indexOf(t);return e.map(function(i,a){return a===r?i+" - "+n:i}).join()}var XPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},YPe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},ZPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},JPe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},QPe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},e$e=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},BY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,m=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},t$e=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+a+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},zY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+m+`
        setOutput(result);
      }
    `},jY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<h;v++)g+=`
          vec4 xTexelR`+m+"C"+2*v+` = vec4(0.);
          vec4 wR`+m+"C"+v+` = vec4(0.);
          vec4 xR`+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<p;y++){if(g+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+m+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+`.xy);
                } else {
                  xR`+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xR`+m+"C"+v+" = xTexelR"+m+"C"+v+`;
              `,v+1<h)){var b=s%2==0?YF(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+`;
                `}}else v<h&&(g+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
              `,v+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+`.xy);
              `,v+1<h&&(g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
                `)),g+="}");v<h&&(g+=`
            vec4 wTexelR`+m+"C"+v+" = getW("+m+", "+v+`, d1, q);
            wR`+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+`.xz);
          `,v+1<h&&(g+=`
              vec4 wTexelR`+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+`, d1, q);
              wR`+m+"C"+(v+1)+` =
                vec4(wTexelR`+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<h;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},n$e=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[o-1+".0",s-1+".0"],p=h[0],g=h[1],m=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=x[0],S=x[1],A=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+A+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},r$e=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Jn(r)+` coords = getOutputCoords();
        int end = `+UY(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+UY(r,"coords")+` = idx;
          val += getX(`+function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function UY(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var i$e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=nb.DENSE;var t=rb(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Lh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},a$e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=nb.DENSE;var t=rb(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Lh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},o$e=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),s$e=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},u$e=function(e){this.variableNames=["A"],this.outTexUsage=Oo.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+RY+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},l$e=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Oo.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+RY+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},c$e=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+gM(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},f$e=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+gM(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+s+`;
      }
    `},d$e="return real * expR - imag * expI;",h$e="return real * expI + imag * expR;",WY=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},p$e=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),g$e=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Jn(this.rank),a=function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},m$e=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Jn(t.length),i=Jn(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function VY(e,t){var n=Ki();return OX(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function qY(e,t){return RX(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function HY(e,t){return FX(e,t,new Uint16Array([0,1,2,2,1,3]))}function wb(e,t,n,r,i,a,o){PX(n,r);var s=MX(e,t),u=e.TEXTURE_2D;return Qe(e,t,function(){return e.bindTexture(u,s)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function GY(e,t,n,r,i){var a=ES(n,r);return wb(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function KY(e,t,n,r,i){var a=ES(n,r);return wb(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function XY(e,t,n,r,i){var a=ES(n,r);return wb(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function YY(e,t,n,r,i){var a=ib(n,r);return wb(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function ZY(e,t,n,r,i){var a=ib(n,r);return wb(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function JY(e,t,n,r){return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),p3(e,t,n,"clipSpacePos",r,3,20,0)&&p3(e,t,n,"uv",r,2,20,12)}function QY(e,t,n,r,i,a,o){var s,u,l;Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=o.internalFormatPackedFloat),s.set(a),Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function eZ(e,t,n,r){Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function tZ(e,t,n,r,i){var a=e.createBuffer();Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var o=16*n*r;return Qe(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function nZ(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function rZ(e,t,n,r,i){var a=ES(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function iZ(e,t,n,r,i,a,o,s){var u=e,l=new Float32Array(function(c,f){var d=ib(c,f);return d[0]*d[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function aZ(e,t,n,r){var i=new Float32Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var v$e=Object.freeze({createVertexShader:VY,createVertexBuffer:qY,createIndexBuffer:HY,createFloat32MatrixTexture:GY,createFloat16MatrixTexture:KY,createUnsignedBytesMatrixTexture:XY,createPackedMatrixTexture:YY,createFloat16PackedMatrixTexture:ZY,bindVertexProgramAttributeStreams:JY,uploadDenseMatrixToTexture:QY,uploadPixelDataToTexture:eZ,createBufferFromOutputTexture:tZ,downloadFloat32MatrixFromBuffer:nZ,downloadByteEncodedFloatMatrixFromOutputTexture:rZ,downloadPackedMatrixFromBuffer:iZ,downloadMatrixFromPackedOutputTexture:aZ}),oZ=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=pe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,CX(n,t)):this.gl=zu(n);var r="WEBGL_color_buffer_float";if(pe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=ab(this.gl,this.debug,"OES_texture_float"),No(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ab(this.gl,this.debug,"OES_texture_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),No(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ab(this.gl,this.debug,"EXT_color_buffer_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",No(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!No(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=qY(this.gl,this.debug),this.indexBuffer=HY(this.gl,this.debug),this.framebuffer=$X(this.gl,this.debug),this.textureConfig=h3(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return pe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;Qe(n,this.debug,function(){return n.finish()}),Qe(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),Qe(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),GY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),KY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),XY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),eZ(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),QY(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),ZY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),YY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(g3(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Qe(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return rZ(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,a,o){return iZ(this.gl,t,0,0,0,a,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return nZ(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=tZ(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(pe().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(o,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=o}else pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return aZ(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=IX(n,this.debug,t),i=VY(n,this.debug),a=NX(n,this.debug);return Qe(n,this.debug,function(){return n.attachShader(a,i)}),Qe(n,this.debug,function(){return n.attachShader(a,r)}),DX(n,this.debug,a),this.debug&&kS(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=JY(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Qe(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&kS(this.gl,this.debug,this.program),Qe(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?BX(this.gl,this.debug,t,n):zX(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),jX(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=ib(n,r),a=i[0],o=i[1];this.setOutputMatrixTextureDriver(t,a,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&kS(this.gl,this.debug,this.program),ob(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Qe(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=ab(this.gl,this.debug,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){switch(r.label){case 0:return[4,ZF(function(){return n.disposed||n.isQueryAvailable(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||ZF(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),TS(this.gl,this.debug,t,this.framebuffer),this.debug&&ob(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(TS(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ob(this.gl)):g3(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;TS(i,this.debug,t,this.framebuffer),this.debug&&ob(i),this.outputTexture=t,Qe(i,this.debug,function(){return i.viewport(0,0,n,r)}),Qe(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var a=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function sZ(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,a=t[r],o=a.shape;if(!Wr(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!Wr(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var y$e=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=i*r,g=Ki(),m=f==="channelsLast",v=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},b$e=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},x$e=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},w$e=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},_$e=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},S$e=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},yM=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),a===void 0&&(a=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+p+`

        setOutput(result);
      }
    `},E$e=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),A$e=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},C$e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=no("rc",t),r=Jn(t),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var g=0;g<=1;g++){for(var m=(p===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<f;v++)m=d[d.length-1-v]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},k$e=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,i=Jn(r),a=t.map(function(u){return u[0]}).join(","),o=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+a+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},T$e=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(m,v){return m[0]+e[v]+m[1]});for(var r=e.length,i=Jn(r),a=t.map(function(m){return m[0]}).join(","),o=t.map(function(m,v){return m[0]+e[v]}).join(","),s=no("rc",r),u=no("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,g=r===1?2:4;p<g;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+a+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},_b=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",g="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",v="0.0";if(p||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+s+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(r?i?g:m:"wR * "+f+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(a/4),x=a%4,w=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+w+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+w+`
          }
        }
        setOutput(`+y+`);
      }
    `}},bM=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+s+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = `+(r?i?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+h+" * "+p+` +
                      wR * `+p+" + wC")+`;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var w=4*Math.floor(a/4),S=a%4,A=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+s+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},O$e=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",s="min"):t==="max"&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},I$e=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Lh(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+gM(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},N$e=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},D$e=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},R$e=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},F$e=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},M$e=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},P$e=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,o){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(o)}).join(","),i=Jn(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},$$e=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=no("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Jn(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},uZ=function(e,t,n,r,i,a,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Jn(i.length),u=Jn(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},L$e=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},B$e=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var l=Jn(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},z$e=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Jn(this.rank),i="uniform int start["+this.rank+"];",a=function(o){if(o===1)return"sourceLoc";if(o<=6)return xM.slice(0,o).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,s){return"sourceLoc."+xM[s]+" = start["+s+"] + coords."+xM[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),xM=["x","y","z","w","u","v"],j$e=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Jn(this.rank),r=no("coords",this.rank),i=no("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+a+")",s=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),U$e=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Jn(n.length),a=Jn(n.length),o="";if(r===1)o="coords * strides + begin";else{var s=0;o=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},W$e=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,a=lZ(n,r),o=cZ(t,a,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),a===Io.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===Io.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===Io.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===Io.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===Io.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var a=cZ(n,lZ(r,i),i);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[a],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function lZ(e,t){if(e===Oo.UPLOAD)return Io.PACKED_2X2_FLOAT32;if(e===Oo.RENDER||e==null)return function(n){return pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Io.PACKED_2X2_FLOAT32:Io.UNPACKED_FLOAT32:n?Io.PACKED_2X2_FLOAT16:Io.UNPACKED_FLOAT16}(t);if(e===Oo.DOWNLOAD||e===Oo.PIXELS)return Io.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function cZ(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var V$e=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Jn(this.rank),a=function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<o.length;c++)l.push("imod("+u[c]+", "+o[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},wM=1.7580993408473768,_M=1.0507009873554805,Mt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Hs="if (isnan(x)) return x;",q$e="return x;",fZ="return abs(x);",dZ=Hs+`
  return (x < 0.0) ? 0.0 : x;
`,hZ=Hs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,pZ="return (x >= 0.0) ? x : (exp(x) - 1.0);",H$e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+wM+`;
  float scale = `+_M+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,gZ="return -x;",mZ="return ceil(x);",vZ="return floor(x);",yZ="return exp(x);",bZ="return exp(x) - 1.0;",G$e=Hs+`
  return sin(x);
`,K$e=Hs+`
  return cos(x);
`,X$e=Hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Y$e=Hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Z$e=Hs+`
  return atan(x);
`,J$e=Hs+"return log(x + sqrt(x * x + 1.0));",Q$e=Hs+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,eLe=Hs+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,nE="return x;",tLe="return x;",xZ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wZ=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_Z=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Sb=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},nLe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=no("rc",t),r=Jn(t),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},rE={};function iE(e,t){if(t===void 0&&(t=!1),e==="linear")return t?tLe:q$e;if(e==="relu")return t?xZ:dZ;if(e==="elu")return t?_Z:pZ;if(e==="relu6")return t?wZ:hZ;if(e==="prelu")return t?LY:$Y;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var rLe=600,SZ=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!pe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=zu(pe().getNumber("WEBGL_VERSION"));i.binaryCache=((r=pe().getNumber("WEBGL_VERSION"))in rE||(rE[r]={}),rE[r]),i.gpgpu=new oZ(a),i.canvas=a.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new W$e(i.gpgpu),i.numMBBeforeWarning=pe().global.screen==null?1024:pe().global.screen.height*pe().global.screen.width*window.devicePixelRatio*rLe/1024/1024,i.texData=new aM(i,J),i}return js(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:i,values:n,usage:Oo.UPLOAD}),a},t.prototype.move=function(n,r,i,a){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:a,values:r,usage:Oo.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,a=r.dtype,o=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Sb(u,nE):new Mt(u,nE);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return i;var h,p,g=this.activeTimers!=null;return g&&(h=Us()),a==="complex64"?p=fM(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=Us()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_;return nt(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(C){return r.push(C)})];if(i=this.texData.get(n),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return f=void 0,f=c?new Sb(o,nE):new Mt(o,nE),d=this.runWebGLProgram(f,[{dataId:n,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&pe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&pe().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),m=this.texData.get(g.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(rb(o)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=E.sent(),b=y[0],x=y[1],v=fM(b,x),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(w=et(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),E.label=5;case 5:return g!=null&&this.disposeData(g.dataId),S=this.convertAndCacheOnCPU(n,v),A=this.pendingRead.get(n),this.pendingRead.delete(n),A.forEach(function(C){return C(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!kX(i))throw pe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.isPacked,u=et(a);if(pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(rb(a))).subarray(0,u);return this.disposeData(l.dataId),f}var d=pe().getBool("WEBGL_PACK")&&s===!0,h=d?OS(a):a,p=d?new l$e(h):new u$e(h),g=this.runWebGLProgram(p,[{shape:h,dtype:o,dataId:n}],"float32"),m=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l;return nt(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],a=!1,this.programTimersStack==null?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,n(),o=rc(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=rc(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=c.sent(),u.kernelMs=cX(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Us(),endMs:null}},t.prototype.endTimer=function(n){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Us(),n)},t.prototype.getQueryTime=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,a=r.dtype,o=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,a),this.textureManager.releaseTexture(i,o,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return pe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=J.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return i.texData.get(a.dataId).texture==null&&et(a.shape)<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(et(i)===0)return Mr([],i,n.dtype);var a=this.texData.get(n.dataId).isPacked,o=rM(n.shape,r,i);if(a||!o){var s=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new j$e(i):new z$e(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var a=this.texData.get(n.dataId),o=this.makeOutput(i,n.dtype),s=this.texData.get(o.dataId);Object.assign(s,a),s.shape=i,s.dtype=n.dtype;var u=iM(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},t.prototype.stridedSlice=function(n,r,i,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,a);var o=XS(r,i,a);if(o.some(function(u){return u===0}))return Mr([],o);var s=new U$e(r,a,o);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $$e(n.shape,r):new P$e(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return to(h)}),a=n.map(function(h){return os(h)});return ii(this.concat(i,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>pe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),s=this.concat(n.slice(0,o),r),u=this.concat(n.slice(o),r);return this.concat([s,u],r)}if(pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new KPe(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Mh(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,et(h.shape.slice(r)))}),d=new GPe(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,gZ,n.dtype);var r=new Mt(n.shape,gZ);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,a){var o=i?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],l=n.shape[0];if((o===1||s===1)&&u>1e3){i&&(n=cn(n,[0,2,1])),a&&(r=cn(r,[0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=yi(n.dtype,r.dtype),p=new yM(n.shape,[l,o,s],i,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],d=r.shape[0],h=yi(r.dtype,i.dtype),p=s!=null,g=l!=null,m=u?iE(u,!0):null,v=new yM(r.shape,[d,c,f],a,o,p,m,g),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),a=this.texData.get(r.dataId),o=new MY(zPe,n.shape,r.shape),s=new MY(jPe,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(o,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,PY,n.dtype);var d=new kr(PY,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){var u=[n,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(o!=null&&(c=o.shape,u.push(o)),pe().getBool("WEBGL_PACK_NORMALIZATION")){var f=new BPe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(f,u)}var d=new LPe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){var s=pe().getBool("WEBGL_PACK_NORMALIZATION")?new w$e(n.shape,r,i,a,o):new b$e(n.shape,r,i,a,o);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){var l=new x$e(r.shape,a,o,s,u);return this.compileAndRun(l,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(o){return Zy(o)});return IY(Ot(n.shape,n.dtype,i),r)}var a=new V$e(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,i){var a=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new T$e(n.shape,r,i):new k$e(n.shape,r,i);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var a=new g$e(n.shape,r.size,i);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){U(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,d){return f*d}),o=BS(n.shape,r,a),s=zS(o.length,r.length),u=jS(n.shape,r,a),l=aY(i,r.length),c=oY(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){U(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=BS(u.shape,r,a,!1),c=zS(l.length,r.length,!1),f=jS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.reduce=function(n,r,i){var a=n.shape[0],o=n.shape[1],s=KS(o),u=new O$e({windowSize:s,inSize:o,batchSize:a},r),l=this.compileAndRun(u,[n],i);return l.shape[1]===1?l:this.reduce(l,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var a=n.shape[0],o=n.shape[1];i!=null&&(a=i.shape[0],o=i.shape[1]);var s=KS(o),u=new OPe({windowSize:s,inSize:o,batchSize:a},r,i==null),l=[n];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var a=i!=null?i.shape:n.shape,o=KS(a[a.length-1]),s=new MPe(a,o,r,i==null),u=i==null?[n]:[n,i],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){eo("sum",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=SS(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=SS(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,i){var a=0,o=Ws([a],n.rank),s=n;o!=null&&(s=cn(n,o),a=Vs(1,n.rank)[0]);var u=function(h,p,g){for(var m=[],v=h.length,y=0;y<v;y++)y!==p?m.push(h[y]):m.push(g);return m}(s.shape,a,i),l=et([s.shape[a]]),c=s.as2D(-1,l),f=SS(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(u);return o!=null&&(d=cn(d,FS(o))),d},t.prototype.segOpCompute=function(n,r,i,a,o){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,g=!1;for(d<=tM?(p=d,g=!0):p=wS(d,Math.floor(Math.sqrt(d)));!g;)p>h||p===d?g=!0:p=wS(d,p+1);return p}(u,o),c=new L$e({windowSize:l,inSize:u,batchSize:s,numSegments:o},r),f=this.compileAndRun(c,[n,i],a);return f.shape[1]===o?f:(i=Tm(0,o).tile([u/l]),this.segOpCompute(f,r,i,a,o))},t.prototype.argMinMaxReduce=function(n,r,i){var a=[r];if(eo("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,n.rank),!pe().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=Di(n.shape,a),s=o[0],u=et(o[1]),l=n.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new r$e(n.shape,i,a);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new kr("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new kr("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new kr("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new kr("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new kr("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new kr("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Mt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new kr("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new kr("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var a=new B$e(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,i],yi(r.dtype,i.dtype))},t.prototype.where=function(n){RS("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return pM(n.shape,r)},t.prototype.topk=function(n,r,i){return NY(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){eo("min",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new kr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new kr(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);eo("max",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new kr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){eo("all",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){eo("any",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.floorDiv=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new kr(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,mM);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,mM,i);var a=new kr(mM,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var a=new Sb(n.shape,r);return this.compileAndRun(a,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,a,o){o===void 0&&(o=!1);var s=new Hu(i,n.shape,r.shape,o);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var a=this,o=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],g=a.makeComplexComponentTensorInfo(n,h),m=a.makeComplexComponentTensorInfo(r,p),v=new kr(i,n.shape,r.shape);return a.compileAndRun(v,[g,m],yi(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>pe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([i,a])}var o=n.map(function(l){return l.dtype}).reduce(function(l,c){return yi(l,c)}),s=n.map(function(l){return l.shape}),u=pe().getBool("WEBGL_PACK")?new TPe(n[0].shape,s):new kPe(n[0].shape,s);return this.compileAndRun(u,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,vM);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,vM,n.dtype);var a=new kr(vM,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.pow=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new kr(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=yi(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,mZ,n.dtype);var r=new Mt(n.shape,mZ);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,vZ,n.dtype);var r=new Mt(n.shape,vZ);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Mt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Mt(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Mt(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Mt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Mt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,yZ,n.dtype);var r=new Mt(n.shape,yZ);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,bZ,n.dtype);var r=new Mt(n.shape,bZ);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=Vr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Mt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Mt(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Mt(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Mt(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Mt(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new Sb(n.shape,xZ):new Mt(n.shape,dZ),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new Sb(n.shape,wZ):new Mt(n.shape,hZ),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(LY,n.shape,r.shape):new kr($Y,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,_Z,n.dtype);var r=new Mt(n.shape,pZ);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new kr("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new Mt(n.shape,H$e);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Mt(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var a,o=(a=pe().getBool("WEBGL_PACK_CLIP")?new qPe(n.shape):new VPe(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(a,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,fZ,n.dtype);var r=new Mt(n.shape,fZ);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new HPe(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,a)},t.prototype.sigmoid=function(n){var r=new Mt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Mt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Mt(n.shape,G$e);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Mt(n.shape,K$e);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Mt(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Mt(n.shape,X$e);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Mt(n.shape,Y$e);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Mt(n.shape,Z$e);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new kr(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new Mt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Mt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Mt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Mt(n.shape,J$e);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Mt(n.shape,Q$e);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Mt(n.shape,eLe);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Mt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new Mt(n.shape,function(a){return a===void 0&&(a=0),Hs+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,a,o,s){var u=n.shape,l=this.texData.get(n.dataId),c=i.inChannels,f=u[0]*u[1]*u[2],d=i.outChannels,h=i.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(p||!pe().getBool("WEBGL_LAZILY_UNPACK")||!pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,m,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(lb(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,i.inChannels,i.outChannels]),A=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),_=this.texData.get(A.dataId);return U(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,_.shape=i.outShape,J.makeTensorFromDataId(A.dataId,i.outShape,A.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,a,o,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,f=i.outWidth,d=i.outHeight,h=i.dataFormat==="channelsLast",p=u*l*c,g=d*f,m=[p,g],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new y$e(m,v.shape,i),x=this.compileAndRun(b,[v]).reshape([1,m[0],m[1]]),w=a!=null,S=s!=null,A=o?iE(o,!0):null,_=new yM(x.shape,[1,g,i.outChannels],!0,!1,w,A,S),E=[x,y];a&&E.push(a),S&&E.push(s);var C=this.compileAndRun(_,E);return h?C.reshape([1,d,f,i.outChannels]):C.reshape([1,i.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,a,o,s,u);if(pe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,a,o,s,u);var l=o!=null,c=u!=null,f=s?iE(s,!1):null,d=new BY(a,l,f,c),h=[r,i];return o&&h.push(o),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(pe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var a=new BY(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var a=new YPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var a=new XPe(i);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,a=n.filter,o=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=u?iE(u,c):null,d=[i,a],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new jY(o,h,f,p),this.compileAndRun(r,d)):(r=new zY(o,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,i){var a;return pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(a=new jY(i),this.compileAndRun(a,[n,r])):(a=new zY(i),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var a=new e$e(i);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var a=new QPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,i){var a=new t$e(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var a=new JPe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var a=new ZPe(i);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var i=new _b(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new _b(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,a){var o=new _b(a,"max",!0),s=this.compileAndRun(o,[r]),u=new _$e(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,i){var a=new PPe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return lM(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var i=new bM(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var a=new $Pe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new bM(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,a){var o=new bM(a,"max",!0),s=this.compileAndRun(o,[r]),u=new S$e(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!lb(n.shape,r)&&(i.texture===null||!lb(i.shape,r))){var a=this.packedReshape(n,r);return J.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return eE(n,r)},t.prototype.resizeBilinear=function(n,r,i,a){var o=pe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new R$e(n.shape,r,i,a):new D$e(n.shape,r,i,a);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var a=new N$e(n,r,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,a){var o=new M$e(n.shape,r,i,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var a=new F$e(n,r,i);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,i,a){var o=r?n:Ph(n),s=o.shape[0],u=o.shape[1],l=new E$e(s,u,i),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[o],"int32",c)},t.prototype.oneHot=function(n,r,i,a){var o=new A$e(n.size,r,i,a);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new s$e(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return RS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),dM(n.dataSync(),r.dataSync(),i,a,o)},t.prototype.cropAndResize=function(n,r,i,a,o,s){var u=new n$e(n.shape,r.shape,a,o,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],o=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],l=o*r,c=s*r,f=u/(r*r),d=new o$e(i==="NHWC"?[a,l,c,f]:[a,f,l,c],r,i);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,i){return OY(n,r,i)},t.prototype.scatterND=function(n,r,i){var a=mb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=[c/u,u],d=n.reshape([s,o]),h=r.reshape([s,u]);if(c===0)return eE(Mr([]),i);var p=Ve(0),g=new uZ(s,o,d.rank,h.rank,l,f);return this.compileAndRun(g,[h,d,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,a){var o=mb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.strides,c=o.outputSize,f=new uZ(u,s,n.rank,r.rank,l,[c,1],!1);return this.compileAndRun(f,[r,n,a]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),a=new WY(d$e,n.shape,r),o=new WY(h$e,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(o,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=eM(n,r),s=o[0],u=o[1],l=o[2],c=o[3],f=r.reshape([u,a]),d=n.reshape([n.size/l,l]),h=new m$e(a,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||Em(r))==="string"){var a=Yy(i,et(n));return a.fill(r),J.makeTensor(a,n,i,this)}var o=new p$e(n,r),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return cM(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return J.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new nLe(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new C$e(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[sb(n.shape)].concat(ub(n.shape)),a={dtype:n.dtype,shape:i,dataId:n.dataId},o=[sb(r)].concat(ub(r)),s=new I$e(o,i),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),a=i.isPacked,o=i.shape,s=i.dtype,u=OS(o);return r=a?new a$e(u):new i$e(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,a,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(n.outputShape,i),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===nb.DENSE){var c=rb(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),et(u.shape)===0)return l.values=Rh(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&et(b.shape)<=pe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!lb(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},g=function(b,x,w){var S="";x.concat(w).forEach(function(E){var C=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,k=E.isUniform?"uniform":E.texData.texShape;S+=E.shape+"_"+k+"_"+C});var A=b.userCode,_=b.constructor.name;return _+="_"+S+"_"+A}(n,d,p),m=this.getAndSaveBinary(g,function(){return function(b,x,w,S){var A=x.userCode,_=w.map(function(W,G){var K={logicalShape:W.shape,texShape:W.isUniform?null:W.texData.texShape,isUniform:W.isUniform,isPacked:!W.isUniform&&W.texData.isPacked,flatOffset:null};return W.texData!=null&&W.texData.slice!=null&&W.texData.slice.flatOffset>0&&(K.flatOffset=W.texData.slice.flatOffset),{name:x.variableNames[G],shapeInfo:K}}),E=_.map(function(W){return W.shapeInfo}),C={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},k=IPe(_,C,A,x.packedInputs),T=b.createProgram(k),I=null,N=b.getUniformLocation(T,"NAN",!1);pe().getNumber("WEBGL_VERSION")===1&&(I=b.getUniformLocation(T,"INFINITY",!1));for(var O={},D=0;D<x.variableNames.length;D++){var L=x.variableNames[D];O[L]=b.getUniformLocation(T,L,!1),O["offset"+L]=b.getUniformLocation(T,"offset"+L,!1)}return{program:x,source:k,webGLProgram:T,uniformLocations:O,inShapeInfos:E,outShapeInfo:C,infLoc:I,nanLoc:N}}(s.gpgpu,n,d,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,x,w,S,A){sZ(x.inShapeInfos,w),sZ([x.outShapeInfo],[S]);var _=S.texData.texture,E=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(_,E[0],E[1]):b.setOutputMatrixTexture(_,E[0],E[1]),b.setProgram(x.webGLProgram),pe().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(C,k){var T=x.program.variableNames[k],I=x.uniformLocations[T],N=x.uniformLocations["offset"+T];if(I!=null)if(C.isUniform)if(et(C.shape)<2)b.gl.uniform1f(I,C.uniformValues[0]);else{var O=C.uniformValues;O instanceof Float32Array||(O=new Float32Array(O)),b.gl.uniform1fv(I,O)}else C.texData.slice!=null&&N!=null&&b.gl.uniform1i(N,C.texData.slice.flatOffset),b.setInputMatrixTexture(C.texData.texture,I,k)}),A!=null&&A(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,m,d,p,a),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!pe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,a,o){o===void 0&&(o=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,a,o);return J.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(pe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ue(function(){if(!pe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=pe().getBool("DEBUG");pe().set("DEBUG",!1);var i=n.abs(Ve(1e-8)).dataSync()[0];if(pe().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=Us());var h=i.texShape;if(h==null&&(h=VX(a,c),i.texShape=h),s!=null){var p=OS(a),g=void 0,m=h[1],v=h[0],y=s instanceof Uint8Array;c?(m=(r=ib(h[0],h[1]))[0],v=r[1],g=new f$e(p,[v,m],y)):g=new c$e(p,[v,m],y);var b=this.makeTensorInfo([v,m],o);this.texData.get(b.dataId).usage=y?Oo.PIXELS:Oo.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,v,s);var x=this.runWebGLProgram(g,[b],o,null,!0),w=this.texData.get(x.dataId);i.texture=w.texture,i.texShape=w.texShape,i.isPacked=w.isPacked,i.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),i.values=null,d&&(this.uploadWaitMs+=Us()-f)}else{var S=this.acquireTexture(h,l,o,c);i.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),a=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),i.values},t.prototype.acquireTexture=function(n,r,i,a){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*JF(r)},t}(oM);AX()&&J.registerBackend("webgl",function(){return new SZ},2);function zh(e,t){return e(t={exports:{}},t.exports),t.exports}var iLe=zh(function(e){(function(t,n,r){function i(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new i(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,e,!1)}),aLe=zh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,e,!1)}),oLe=zh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,e,!1)}),sLe=zh(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,e,!1)}),uLe=zh(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,g,m=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(g=g+1640531527|0,h=(f=m[127&p]^=d+g)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=m[h+34&127],f=m[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,m[h]=d^f;l.w=g,l.X=m,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,e,!1)}),lLe=zh(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,e,!1)}),jh=zh(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(v,y,b){var x=[],w=g(function _(E,C){var k,T=[],I=typeof E;if(C&&I=="object")for(k in E)try{T.push(_(E[k],C-1))}catch(N){}return T.length?T:I=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,m(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(_)),m(_)}catch(k){var E=i.navigator,C=E&&E.plugins;return[+new Date,i,C,i.screen,m(t)]}}(),3),x),S=new h(x),A=function(){for(var _=S.g(o),E=u,C=0;_<l;)_=(_+C)*a,E*=a,C=S.g(1);for(;_>=c;)_/=2,E/=2,C>>>=1;return(_+C)/E};return A.int32=function(){return 0|S.g(4)},A.quick=function(){return S.g(4)/4294967296},A.double=A,g(m(S.S),t),(y.pass||b||function(_,E,C,k){return k&&(k.S&&p(k,S),_.state=function(){return p(S,{})}),C?(n[s]=_,E):_})(A,w,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,A=x.S=[];for(b||(v=[b++]);w<a;)A[w]=w++;for(w=0;w<a;w++)A[w]=A[S=f&S+v[w%b]+(y=A[w])],A[S]=y;(x.g=function(_){for(var E,C=0,k=x.i,T=x.j,I=x.S;_--;)E=I[k=f&k+1],C=C*a+I[f&(I[k]=I[T=f&T+E])+(I[T]=E)];return x.i=k,x.j=T,C})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function g(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return m(y)}function m(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,g(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(v){}}})([],Math)});jh.alea=iLe,jh.xor128=aLe,jh.xorwow=oLe,jh.xorshift7=sLe,jh.xor4096=uLe,jh.tychei=lLe;var aE=jh.alea,SM=Q({addN_:function(e){U(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),U(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,a){return j(i,"tensors"+a,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!Wr(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return J.runKernelFunc(function(i,a){return i.addN(t)},r,null,"AddN")}});function oE(){NS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function EZ(e){return e.rank===0||e.rank===1?e.as4D(1,1,1,e.size):e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function AZ(e,t,n,r,i,a){a==null&&(a=.001);var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(l.rank===c.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),U(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),U(o==null||l.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f={x:u,scale:o,offset:s,mean:l,variance:c},d={varianceEpsilon:a};return J.runKernelFunc(function(h,p){var g=EZ(u),m=h.batchNormalization(g,sE(l),sE(c),a,sE(o),sE(s));return p([u,l,c,o]),m},f,null,"FusedBatchNorm",d).reshape(u.shape)}function sE(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var CZ=Q({batchNormalization_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),oE(),AZ(e,t,n,a,i,r)}}),Uh=Q({batchNorm_:AZ});function kZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),U(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Uh(u,l,c,s,o,a)}var TZ=Q({batchNormalization2d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),oE(),kZ(e,t,n,a,i,r)}}),EM=Q({batchNorm2d_:kZ});function OZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),U(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Uh(u,l,c,s,o,a)}var IZ=Q({batchNormalization3d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),oE(),OZ(e,t,n,a,i,r)}}),AM=Q({batchNorm3d_:OZ});function NZ(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),U(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),U(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Uh(u,l,c,s,o,a)}var DZ=Q({batchNormalization4d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),oE(),NZ(e,t,n,a,i,r)}}),CM=Q({batchNorm4d_:NZ}),kM=Q({broadcastTo_:function(e,t){var n=j(e,"broadcastTo","x"),r=n.shape;if(t.some(function(f){return!(f>0)||f%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(f,d){return f>1?d:-1}).filter(function(f){return f>=0});if(u.length===0)return n.clone();var l={x:n},c={shape:t,inputShape:a};return J.runKernelFunc(function(f){return f.tile(n,o)},l,function(f){return{x:function(){return f.sum(u,!0)}}},T3,c)}}),RZ=Q({clone_:function(e){var t=j(e,"x","clone",null);return J.runKernelFunc(function(){return J.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{x:t},null,I3)}}),Gu=Q({logicalAnd_:function(e,t){var n=j(e,"a","logicalAnd","bool"),r=j(t,"b","logicalAnd","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),TM=Q({logicalNot_:function(e){var t=j(e,"x","logicalNot","bool");return J.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),uE=Q({logicalOr_:function(e,t){var n=j(e,"a","logicalOr","bool"),r=j(t,"b","logicalOr","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),FZ=Q({logicalXor_:function(e,t){var n=j(e,"a","logicalXor","bool"),r=j(t,"b","logicalXor","bool");return Qt(n.shape,r.shape),uE(e,t).logicalAnd(Gu(e,t).logicalNot())}}),Gs=Q({where_:function(e,t,n){var r=j(t,"a","where"),i=j(n,"b","where"),a=j(e,"condition","where","bool");return ln(r.shape,i.shape,"Error in where: "),a.rank===1?U(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ln(a.shape,i.shape,"Error in where: "),J.runKernelFunc(function(o,s){var u=o.select(a,r,i);return s([a]),u},{$condition:a,$a:r,$b:i},function(o,s){var u=s[0];return{$condition:function(){return en(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}})}}),lE=function(e){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:return[4,(t=j(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=pM(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},cE=Q({divNoNan_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");r=(n=fr(r,i))[0],i=n[1];var a=Cr(r,i),o=en(a),s=i.equal(o);return Gs(s,o,a)}}),lc=Q({tile_:function(e,t){var n=j(e,"x","tile",null);U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={x:n},a={reps:t};return J.runKernelFunc(function(o,s){var u=o.tile(n,t);return s([n]),u},i,null,N3,a,r)}}),fE=Q({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=Ot([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return lc(Ro(s,0),[n[0],1,1]);if(n.length===2)return lc(Ro(Ro(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return lc(Ro(Ro(Ro(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),OM=Q({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=j(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=o===1?i.as2D(1,-1):i,u=J.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return o===1?u.as1D():u}}),Wh=Q({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=j(e,"indices","oneHot","int32"),a=i.shape.concat([t]),o={indices:i=i.flatten()},s={depth:t,onValue:n,offValue:r};return J.runKernelFunc(function(u,l){return l([i]),u.oneHot(i,t,n,r)},o,null,O3,s).reshape(a)}}),Ku=Q({pad_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n},a={x:r};return J.runKernelFunc(function(o,s){return s([r]),o.pad(r,t,n)},a,null,D3,i)}}),MZ=Q({pad1d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Ku(e,[t],n)}}),PZ=Q({pad2d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),$Z=Q({pad3d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),LZ=Q({pad4d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ku(e,t,n)}}),BZ=Q({rand_:function(e,t,n){var r=et(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return J.makeTensor(i,e,n)}}),cLe=.001,zZ=.1;function IM(){return J.backend.floatPrecision()===32?cLe:zZ}function NM(e,t,n){var r=!0;if((Ni(e)||Ni(t))&&(r=!1),Ni(e)&&Ni(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=Uu(e),s=Uu(t);if(!Wr(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=Ni(e)?e:rc(e),l=Ni(t)?t:rc(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function DM(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var fLe=Object.freeze({TEST_EPSILON_FLOAT16:zZ,expectArraysClose:function(e,t,n){return n==null&&(n=IM()),NM(e,t,function(r,i){return DM(r,i,n)})},testEpsilon:IM,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Cf(e)||Cf(e[0])||Cf(t)||Cf(t[0])?NM(e,n,function(r,i){return r==i}):NM(e,t,function(r,i){return DM(r,i,0)})},expectNumbersClose:function(e,t,n){if(n==null&&(n=IM()),!DM(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),RM=function(){function e(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=aE(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var a=void 0,o=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),dLe=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=aE(a.toString()),this.randn=new RM(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,a,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),hLe=function(){function e(t,n,r,i){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=aE(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),jZ=Q({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new dLe(t,n,r,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),FM=Q({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new RM(t,n,r,!1,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Vh=Q({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Ot(e,r),o=new hLe(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),dE=Q({square_:function(e){var t=j(e,"x","square"),n=[t];return J.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),hE=Q({squaredDifference_:function(e,t){var n,r=j(e,"a","squaredDifference"),i=j(t,"b","squaredDifference");n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return J.runKernelFunc(function(s,u){var l=s.squaredDifference(r,i);return u([r,i]),l},a,function(s,u){var l=u[0],c=u[1],f=Ve(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},hb,{},o,[])}}),Eb=Q({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new RM(t,n,r,!0,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),qh=Q({equal_:function(e,t){var n,r=j(e,"a","equal"),i=j(t,"b","equal");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.equal(r,i)},{$a:r,$b:i})}}),UZ=Q({equalStrict_:function(e,t){var n=j(e,"a","equalStrict"),r=j(t,"b","equalStrict");return ln(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Pm=Q({greater_:function(e,t){var n,r=j(e,"a","greater"),i=j(t,"b","greater");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.greater(r,i)},{a:r,b:i},null,"Greater")}}),Ab=Q({greaterEqual_:function(e,t){var n,r=j(e,"a","greaterEqual"),i=j(t,"b","greaterEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.greaterEqual(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return en(s)},b:function(){return en(u)}}},"GreaterEqual")}}),WZ=Q({greaterEqualStrict_:function(e,t){var n=j(e,"a","greaterEqualStrict"),r=j(t,"b","greaterEqualStrict");return ln(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),VZ=Q({greaterStrict_:function(e,t){var n=j(e,"a","greaterStrict"),r=j(t,"b","greaterStrict");return ln(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),MM=Q({less_:function(e,t){var n,r=j(e,"a","less"),i=j(t,"b","less");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.less(r,i)},{a:r,b:i},null,"Less")}}),PM=Q({lessEqual_:function(e,t){var n,r=j(e,"a","lessEqual"),i=j(t,"b","lessEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.lessEqual(r,i);return o([r,i]),s},{a:r,b:i},null,"LessEqual")}}),qZ=Q({lessEqualStrict_:function(e,t){var n=j(e,"a","lessEqualStrict"),r=j(t,"b","lessEqualStrict");return ln(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),HZ=Q({lessStrict_:function(e,t){var n=j(e,"a","lessStrict"),r=j(t,"b","lessStrict");return ln(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),$m=Q({notEqual_:function(e,t){var n,r=j(e,"a","notEqual"),i=j(t,"b","notEqual");return n=fr(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),GZ=Q({notEqualStrict_:function(e,t){var n=j(e,"a","notEqualStrict"),r=j(t,"b","notEqualStrict");return ln(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function KZ(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function XZ(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Lm=Q({gather_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","gather"),i=j(t,"indices","gather","int32");n=Vr(n,r.shape)[0];var a=function(o,s,u){for(var l=o.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(o.shape[h]),f*=o.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<o.rank;h++)c.push(o.shape[h]),d*=o.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,i,n);return J.runKernelFunc(function(o,s){var u=o.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(o,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,g=KZ(0,d),m=KZ(d+1,d+1+p),v=XZ([f,[c],h]),y=o.reshape(v),b=u.reshape([c]),x=XZ([[d],g,m]),w=y.transpose(x),S=$M(w,b,r.shape[n]),A=FS(x);return S=S.transpose(A)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),$M=Q({unsortedSegmentSum_:function(e,t,n){var r=j(e,"x","unsortedSegmentSum"),i=j(t,"segmentIds","unsortedSegmentSum","int32");return U(vr(n),function(){return"numSegments must be of dtype int"}),J.runKernelFunc(function(a,o){var s=a.unsortedSegmentSum(r,i,n);return o([i]),s},{$x:r},function(a,o){var s=o[0];return{$x:function(){return function(u,l){for(var c=qu(l,en(l)),f=Lm(u,c),d=Ab(l,Ve(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Ro(d,p+1);d=Gu(d,Vu(f.shape,"bool"));var g=en(f);return Gs(d,f,g)}(a,s)}}})}}),YZ=function(e,t,n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g;return nt(this,function(m){switch(m.label){case 0:for(r=j(e,"tensor","boolMask"),i=j(t,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,U(o>0,function(){return"mask cannot be scalar"}),ln(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+o)),f=r.reshape(c),d=i.reshape([-1]),[4,lE(d)];case 1:return h=m.sent(),p=h.squeeze([1]),g=Lm(f,p,a),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,g]}})})};function ZZ(e,t,n,r,i,a,o){a===void 0&&(a="NHWC"),U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),U(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),U(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),U(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],f=a==="NHWC"?u.shape[3]:u.shape[1];U(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),U(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&U(vr(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=QS(a),h=Ff(s,n.shape,r,1,i,o,!1,d),p=J.runKernelFunc(function(g,m){var v=g.conv2dDerInput(u,n,h);return m([n,u]),v},{dy4D:u,filter:n},function(g,m){var v=m[0],y=m[1];return{dy4D:function(){return Hh(g,v,r,i,a,1,o)},filter:function(){return BM(g,y,v.shape,r,i,a,o)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function LM(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function JZ(e,t,n,r,i){U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,o=t,s=!1;t.rank===4&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=o.shape[4];U(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),U(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),U(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),U(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),U(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=bb(a,n.shape,r,1,i),f=J.runKernelFunc(function(d){return d.conv3dDerInput(o,n,c)},{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var pE=Q({conv1d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NWC"),a===void 0&&(a=1);var s=j(e,"x","conv1d"),u=j(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),U(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),o!=null&&U(vr(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),U(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),U(Gi(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),U(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Hh(d,f,[1,n],r,"NHWC",[1,a],o);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Hh=Q({conv2d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]);var s=j(e,"x","conv2d"),u=j(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),o!=null&&U(vr(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),U(Gi(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var d=QS(i),h=Ff(l.shape,u.shape,n,a,r,o,!1,d),p=[u,l],g=J.runKernelFunc(function(m,v){var y=m.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(m,v){var y=v,b=y[0],x=y[1];return U($h(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return QZ(x.shape,m,b,n,r,i)},filter:function(){return BM(x,m,b.shape,n,r,i)}}},"Conv2D",h,p);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),gE=Q({conv3d_:function(e,t,n,r,i,a){i===void 0&&(i="NDHWC"),a===void 0&&(a=[1,1,1]);var o=j(e,"x","conv3d"),s=j(t,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),U(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),U(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),U(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),U(function(d,h){return LM(d)||LM(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),U(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=bb(u.shape,s.shape,n,a,r),f=J.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){U(LM(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],g=h[1];return{x:function(){return JZ(p.shape,d,g,n,r)},$filter:function(){return function(m,v,y,b,x){var w=m;m.rank===4&&(w=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),U(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),U(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),U(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),U(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),U(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var A=bb(w.shape,y,b,1,x);return J.runKernelFunc(function(_){return _.conv3dDerFilter(w,S,A)},{x5D:w,dy5D:S})}(p,d,g.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),BM=Q({conv2dDerFilter_:function(e,t,n,r,i,a,o){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),U(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),U(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),U(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];U(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),U(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),o!=null&&U(vr(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=QS(a),d=Ff(s.shape,n,r,1,i,o,!1,f);return J.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),QZ=Q({conv2dDerInput_:ZZ}),Bm=Q({depthwiseConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]);var s=j(e,"x","depthwiseConv2d"),u=j(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),U(Gi(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&U(vr(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=Ff(l.shape,u.shape,n,a,r,o,!0),d=[l,u],h=J.runKernelFunc(function(p,g){var m=p.depthwiseConv2D(l,u,f);return g([l,u]),m},{x:l,filter:u},function(p,g){U($h(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var m=g[0],v=g[1];return{x:function(){return eJ(m.shape,p,v,f)},filter:function(){return tJ(m,p,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),eJ=Q({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;t.rank===3&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=J.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),tJ=Q({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,a,r)},{x4D:i,dy4D:a})}}),zM=Q({separableConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC");var s=j(e,"x","separableConv2d"),u=j(t,"depthwiseFilter","separableConv2d"),l=j(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),U(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),U(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];U(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=Bm(c,u,r,i,o,a),g=Hh(p,l,1,"valid",o);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),mE=Q({conv2dTranspose_:function(e,t,n,r,i,a){return ZZ(n,j(e,"x","conv2dTranspose"),j(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),nJ=Q({conv3dTranspose_:function(e,t,n,r,i){return JZ(n,j(e,"x","conv3dTranspose"),j(t,"filter","conv3dTranspose"),r,i)}}),vE=Q({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=j(e,"a","matMul"),o=j(t,"b","matMul");i=fr(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=et(f),p=et(d);U(a.rank>=2&&o.rank>=2&&a.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."}),U(Wr(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."}),U(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=a.shape.slice(0,-2).concat([l,c]),m=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?o.as3D(p,c,u):o.as3D(p,u,c),y={transposeA:n,transposeB:r};return J.runKernelFunc(function(b,x){var w=b.batchMatMul(m,v,n,r);return x([m,v]),w},{a:m,b:v},function(b,x){var w=x,S=w[0],A=w[1];return n||r?!n&&r?{a:function(){return b.matMul(A,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return A.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return A.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(A,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(g)}}),rJ=Q({dot_:function(e,t){var n=j(e,"t1","dot"),r=j(t,"t2","dot");U(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return U(i===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),iJ=Q({outerProduct_:function(e,t){var n=j(e,"v1","outerProduct"),r=j(t,"v2","outerProduct");return U(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Xu=Q({reverse_:function(e,t){var n=j(e,"x","reverse");if(n.rank===0)return n.clone();var r=Vr(t,n.shape);return J.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),aJ=Q({reverse1d_:function(e){var t=j(e,"x","reverse");return U(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Xu(t,0)}}),oJ=Q({reverse2d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Xu(n,t)}}),sJ=Q({reverse3d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Xu(n,t)}}),uJ=Q({reverse4d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Xu(n,t)}});function lJ(e,t,n,r,i,a){var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),r==null&&(r=[1,1]),U(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),U(Gi(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&U(vr(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Rf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Wr(l.inShape,l.outShape))return o.clone();var c=[s],f=J.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,A){var _=j(m,"dy","maxPoolBackprop"),E=j(v,"input","maxPoolBackprop"),C=j(y,"output","maxPoolBackprop");U(E.rank===_.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+_.rank+")"}),w==null&&(w=[1,1]),U(Gi(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),U(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),U(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."}),A!=null&&U(vr(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+S+"."});var k=Rf(E.shape,b,x,w,S,A);return J.runKernelFunc(function(T){return T.maxPoolBackprop(_,E,C,k)},{$dy:_,$input:E})}(d,p,g,t,n,r,i)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function cJ(e,t,n,r,i,a){var o=j(e,"x","avgPool","float32");r==null&&(r=[1,1]),U(Gi(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&U(vr(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Rf(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Wr(l.inShape,l.outShape))return o.clone();var c=J.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,g,m,v){var y=j(d,"dy","avgPoolBackprop"),b=j(h,"input","avgPoolBackprop");U(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),m==null&&(m=[1,1]),U(Gi(g,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),U(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),U(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var A=Rf(x.shape,p,g,m,v),_=J.runKernelFunc(function(E){return E.avgPoolBackprop(w,x,A)},{dy4D:w,input4D:x});return S?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var yE=Q({maxPool_:function(e,t,n,r,i){return lJ(e,t,n,1,r,i)}}),bE=Q({avgPool_:function(e,t,n,r,i){return cJ(e,t,n,1,r,i)}}),fJ=Q({pool_:function(e,t,n,r,i,a){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(Gi(a,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"});var l,c=Rf(s.shape,t,a,i,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(E,C){return E+(E-1)*(w[C]-1)}).map(function(E){return E-1}),A=S.map(function(E){return Math.floor(E/2)}),_=S.map(function(E,C){return E-A[C]});return S.map(function(E,C){return[A[C],_[C]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(x,w,S){var A=S.map(function(N){return N[0]}),_=S.map(function(N){return N[1]}),E=x.concat(A,_),C=w.map(function(N,O){return(N-E[O]%N)%N}),k=_.map(function(N,O){return N+C[O]}),T=w.map(function(N,O){return[A[O],k[O]]}),I=w.map(function(N,O){return[0,C[O]]});return[T,I]}([c.inHeight,c.inWidth],f,l),p=h[0],g=h[1],m=d?r:"valid",v=d?s:LS(s,f,p),y=(n==="avg"?function(){return cJ(v,t,a,1,m)}:function(){return lJ(v,t,a,1,m)})(),b=d?y:PS(y,f,g);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),xE=Q({maxPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(vr(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=yb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,A){var _=j(m,"dy","maxPool3dBackprop"),E=j(v,"input","maxPool3dBackprop"),C=j(y,"output","maxPool3dBackprop"),k=_,T=E,I=C,N=!1;E.rank===4&&(N=!0,k=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),I=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3])),U(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),U(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),U(I.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+I.rank+"."}),w==null&&(w=[1,1,1]),U(Gi(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),A!=null&&U(vr(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+S+"."});var O=yb(T.shape,b,x,w,S,A),D=J.runKernelFunc(function(L){return L.maxPool3dBackprop(k,T,I,O)},{dy5D:k,input5D:T});return N?D.as4D(D.shape[1],D.shape[2],D.shape[3],D.shape[4]):D}(d,p,g,t,n,o,r,i)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),wE=Q({avgPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(vr(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=yb(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,g,m,v,y,b){var x=j(h,"dy","avgPool3dBackprop"),w=j(p,"input","avgPool3dBackprop"),S=x,A=w,_=!1;w.rank===4&&(_=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),A=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),U(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),U(A.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+A.rank+"."}),v==null&&(v=[1,1,1]),U(Gi(m,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"}),b!=null&&U(vr(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=yb(A.shape,g,m,v,y,b),C=J.runKernelFunc(function(k){return k.avgPool3dBackprop(S,A,E)},{dy5D:S,input5D:A});return _?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}(d,u,t,n,o,r,i)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),jM=Q({maxPoolWithArgmax_:function(e,t,n,r,i){i===void 0&&(i=!1);var a=j(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=J.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Fo=Q({slice_:function(e,t,n){var r,i,a=j(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){U(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(U(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),_Y(a,r,i);var o=a.shape,s={begin:r,size:i};return J.runKernelFunc(function(u){return u.slice(a,r,i)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return Ku(u,l)}}},"Slice",s)}}),Cb=Q({slice1d_:function(e,t,n){var r=j(e,"x","slice1d");return U(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Fo(r,[t],[n])}}),_E=Q({slice2d_:function(e,t,n){var r=j(e,"x","slice2d");return U(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Fo(r,t,n)}}),kb=Q({slice3d_:function(e,t,n){var r=j(e,"x","slice3d");return U(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Fo(r,t,n)}}),zm=Q({slice4d_:function(e,t,n){var r=j(e,"x","slice4d");return U(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Fo(r,t,n)}});function dJ(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(ya(t.shape,r))),e.rank<n.rank&&(e=e.reshape(ya(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return i==null?a:a.transpose(i)}}}var SE=Q({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","all","bool"),i=Vr(t,r.shape),a=i,o=Ws(a,r.rank);o!=null&&(r=r.transpose(o),a=Vs(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Tb=Q({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","any","bool"),i=Vr(t,r.shape),a=i,o=Ws(a,r.rank);o!=null&&(r=r.transpose(o),a=Vs(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Ob=Q({argMax_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMax");t==null&&(t=0);var r=Vr(t,n.shape),i=Ws(r,n.rank);i!=null&&(n=n.transpose(i),r=Vs(r.length,n.rank));var a={axis:r[0]},o=[n];return J.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return en(l)}}},"ArgMax",a,o)}}),UM=Q({argMin_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMin");t==null&&(t=0);var r=Vr(t,n.shape),i=Ws(r,n.rank);return i!=null&&(n=n.transpose(i),r=Vs(r.length,n.rank)),J.runKernelFunc(function(a,o){var s=a.argMin(n,r[0]);return o([n]),s},{$x:n},function(a,o){var s=o[0];return{$x:function(){return en(s)}}})}}),hJ=Q({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","logSumExp"),i=Vr(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Mf=Q({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","max"),i=r,a=Vr(t,r.shape),o=a,s=Ws(o,r.rank);s!=null&&(r=r.transpose(s),o=Vs(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.max(r,o);return d([i,h]),h},{x:r},function(f,d){return dJ(f,d[1],d[0],a,s)},"Max",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Pr=Q({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","mean"),i=Vr(t,r.shape),a=et(Di(r.shape,i)[1]);return vb(function(o){var s=Ve(a);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=o.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(Vu(o.shape,"float32")).div(a)}}})(r)}}),EE=Q({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","min"),i=r,a=Vr(t,r.shape),o=a,s=Ws(o,r.rank);s!=null&&(r=r.transpose(s),o=Vs(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.min(r,o);return d([i,h]),h},{x:r},function(f,d){return dJ(f,d[1],d[0],a,s)},"Min",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Ib=Q({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Vr(t,(e=j(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=ya(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),Hr=Q({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Vr(t,r.shape);return vb(function(a){var o=Ws(i,a.rank),s=i,u=a;o!=null&&(u=a.transpose(o),s=Vs(s.length,a.rank));var l=function(h){var p=a.shape.slice();return i.forEach(function(g){p[g]=1}),h.reshape(p).mul(Vu(a.shape,"float32"))},c={axes:s},f=J.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=ya(f.shape,i);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),AE=Q({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Vr(t,r.shape),a=Ws(i,r.rank),o=i,s=r;a!=null&&(s=r.transpose(a),o=Vs(o.length,r.rank));var u=J.runKernelFunc(function(c){return c.prod(s,o)},{permutedX:s});if(n){var l=ya(u.shape,i);u=u.reshape(l)}return u}}),jm=Q({elu_:function(e){var t=j(e,"x","elu");return J.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return J.runKernelFunc(function(a){return a.eluDer(n,i)},{dy:n,y:i})}}})}}),CE=Q({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=j(e,"x","leakyRelu");return qu(Ve(t).mul(n),n)}}),Nb=Q({prelu_:function(e,t){var n=j(e,"x","prelu"),r=j(t,"alpha","prelu");return J.runKernelFunc(function(i,a){var o=i.prelu(n,r);return a([n,r]),o},{x:n,alpha:r},function(i,a){var o=a[0],s=a[1],u=o.greater(0);return{x:function(){return Gs(u,i,i.mul(s))},alpha:function(){var l=Gs(u,en(i),i.mul(o)),c=qr(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Pf=Q({relu_:function(e){var t=j(e,"x","relu");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),WM=Q({relu6_:function(e){var t=j(e,"x","relu6");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],a=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),kE=Q({selu_:function(e){var t=j(e,"x","selu");return J.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var a=i.greater(Ve(0)),o=Ve(wM),s=Ve(_M),u=n.mul(s),l=n.mul(o).mul(i.toFloat().exp());return Gs(a,u,l)}}})}}),VM=Q({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var a=j(e,"x","localResponseNormalization");U(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),U(vr(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=a,s=!1;a.rank===3&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=J.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(o,t,n,r,i);return c([o,f]),f},{x4D:o},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return J.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),qM=Q({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ve(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=j(e,"x","norm"),t,n),a=i.shape;if(r){var o=Vr(n,e.shape);a=ya(i.shape,o)}return i.reshape(a)}}),pJ=Q({basicLSTMCell_:function(e,t,n,r,i,a){var o=j(e,"forgetBias","basicLSTMCell"),s=j(t,"lstmKernel","basicLSTMCell"),u=j(n,"lstmBias","basicLSTMCell"),l=j(r,"data","basicLSTMCell"),c=j(i,"c","basicLSTMCell"),f=j(a,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,g=[h,p],m=d.slice([0,0],g),v=d.slice([0,p],g),y=d.slice([0,2*p],g),b=d.slice([0,3*p],g),x=m.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),gJ=Q({multiRNNCell_:function(e,t,n,r){for(var i=j(t,"data","multiRNNCell"),a=cb(n,"c","multiRNNCell"),o=cb(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),mJ=Q({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var a=j(e,"v","movingAverage"),o=j(t,"x","movingAverage"),s=j(n,"decay","movingAverage");SX(a,o),U(Wr(a.shape,o.shape),function(){return"Shape mismatch in v and x"});var u=Ve(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){U(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=j(r,"step","movingAverage");c=c.div(u.sub(Im(s,f)))}return a.add(c)}}),HM=Q({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=j(e,"x","stridedSlice"),c=nM(s),f=l.shape.slice();c.forEach(function(m){t[m]=0,n[m]=1,f.splice(m,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=SY(i,t,r,l.shape,d),n[d]=EY(a,n,r,l.shape,d),r[d]=r[d]||1;var h=nM(u);h.forEach(function(m){n[m]=t[m]+1,r[m]=1});var p=XS(t,n,r),g=p.filter(function(m,v){return h.indexOf(v)===-1});return r.every(function(m){return m===1})?Fo(l,t,p).reshape(g):J.runKernelFunc(function(m){return m.stridedSlice(l,t,n,r)},{$x:l}).reshape(g)}}),GM=Q({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=j(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=J.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),KM=Q({scatterND_:function(e,t,n){var r=j(e,"indices","scatterND","int32"),i=j(t,"updates","scatterND");return wY(i,r,n),J.runKernelFunc(function(a){return a.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Db=Q({fft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),Um=Q({ifft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),Rb=Q({rfft_:function(e,t){U(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),o=e.shape.map(function(v){return v});o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Tn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=ii(n,u).as2D(i,r),c=Db(l),f=Math.floor(r/2)+1,d=to(c),h=os(c),p=d.split([f,r-f],d.shape.length-1),g=h.split([f,r-f],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,ii(p[0],g[0]).reshape(m)}}),TE=Q({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=Um(r);return to(i)}var a=[n,2*(t-1)],o=to(e).as2D(n,t),s=os(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(Ve(-1)),c=o.concat(u,1),f=s.concat(l,1);return r=ii(c,f).as2D(a[0],a[1]),i=Um(r),to(i)}}),vJ=Object.freeze({fft:Db,ifft:Um,rfft:Rb,irfft:TE}),OE=Q({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=j(e,"sparseIndices","sparseToDense","int32"),a=j(t,"sparseValues","sparseToDense"),o=j(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),J.runKernelFunc(function(s){return s.sparseToDense(i,a,n,o)},{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),XM=Q({gatherND_:function(e,t){var n=j(t,"indices","gatherND","int32"),r=j(e,"x","gatherND");return J.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),yJ=Q({diag_:function(e){var t=j(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return J.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),YM=Q({dropout_:function(e,t,n,r){var i=j(e,"x","dropout");if(U(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),U(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Ht?i.clone():i;var a=function(u,l){if(l==null)return u.shape.slice();if(Wr(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(i,n),o=1-t,s=Vh(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function bJ(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return ba(i,"float32")}var IE=Q({hannWindow_:function(e){return bJ(e,.5,.5)}}),ZM=Q({hammingWindow_:function(e){return bJ(e,.54,.46)}}),NE=Q({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Fo(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Hi([Fo(e,a,t-s),km([s],i)]);o.push(u),a+=n}return o.length===0?Wu([],[0,t]):Hi(o).as2D(o.length,t)}}),JM=Q({stft_:function(e,t,n,r,i){var a;i===void 0&&(i=IE),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=NE(e,t,n),s=rt(o,i(t)),u=[],l=0;l<o.shape[0];l++)u.push(Rb(s.slice([l,0],[1,t]),r));return Hi(u)}}),xJ=Object.freeze({hannWindow:IE,hammingWindow:ZM,frame:NE,stft:JM}),Ri,wJ=function(e,t,n){return n===void 0&&(n=1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m;return nt(this,function(v){switch(v.label){case 0:return r=j(e,"predictions","inTopK"),i=j(t,"targets","inTopK"),U(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),U(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),ln(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],U(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[o.length/a,a],c=u[1],f=Rh("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=o.subarray(h,h+c),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(y,b){return b.value-y.value}),f[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Mr(f,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ri||(Ri={}));var pLe=Q({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","absoluteDifference"),a=j(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=j(n,"weights","absoluteDifference")),ln(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return cc(s,o,r)}}),cc=Q({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Ri.SUM_BY_NONZERO_WEIGHTS);var r=j(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=j(t,"weights","computeWeightedLoss"));var a=i==null?r:r.mul(i);if(n===Ri.NONE)return a;if(n===Ri.SUM)return a.sum();if(n===Ri.MEAN){if(i==null)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(Ve(o)):s}if(n===Ri.SUM_BY_NONZERO_WEIGHTS){if(i==null)return a.sum().div(Ve(r.size));var u=i.mul(Vu(r.shape)).notEqual(Ve(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),gLe=Q({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","cosineDistance"),o=j(t,"predictions","cosineDistance"),s=null;r!=null&&(s=j(r,"weights","cosineDistance")),ln(a.shape,o.shape,"Error in cosineDistance: ");var u=Ve(1).sub(a.mul(o).sum(n,!0));return cc(u,s,i)}}),mLe=Q({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","hingeLoss"),a=j(t,"predictions","hingeLoss"),o=null;n!=null&&(o=j(n,"weights","hingeLoss")),ln(i.shape,a.shape,"Error in hingeLoss: ");var s=Ve(1);i=Ve(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return cc(u,o,r)}}),vLe=Q({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","huberLoss"),o=j(t,"predictions","huberLoss"),s=null;n!=null&&(s=j(n,"weights","huberLoss")),ln(a.shape,o.shape,"Error in huberLoss: ");var u=Ve(r),l=o.sub(a).abs(),c=Om(l,u),f=l.sub(c),d=Ve(.5).mul(c.square()).add(u.mul(f));return cc(d,s,i)}}),yLe=Q({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","logLoss"),o=j(t,"predictions","logLoss"),s=null;n!=null&&(s=j(n,"weights","logLoss")),ln(a.shape,o.shape,"Error in logLoss: ");var u=Ve(1),l=Ve(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return cc(c,s,i)}}),bLe=Q({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","meanSquaredError"),a=j(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=j(n,"weights","meanSquaredError")),ln(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return cc(s,o,r)}}),xLe=Q({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"multiClassLabels","sigmoidCrossEntropy"),o=j(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","sigmoidCrossEntropy")),ln(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=j(d,"labels","sigmoidCrossEntropyWithLogits"),g=j(h,"logits","sigmoidCrossEntropyWithLogits");ln(p.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=g.relu(),v=g.mul(p),y=g.abs().neg().exp().log1p();return m.sub(v).add(y)}(a,o);return cc(f,s,i)}}),wLe=Q({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"onehotLabels","softmaxCrossEntropy"),o=j(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","softmaxCrossEntropy")),ln(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return vb(function(g,m,v){var y=m.logSumExp([p],!0),b=m.toFloat().sub(y);return v([g,b]),{value:b.mul(g).neg().sum([p]),gradFunc:function(x,w){var S=w[0],A=w[1],_=ya(x.shape,[p]);return[x.reshape(_).mul(S.toFloat().sub(A.exp())),x.reshape(_).mul(A.exp().sub(S.toFloat()))]}}})(d,h)}(a,o);return cc(f,s,i)}}),_J=Object.freeze({get Reduction(){return Ri},absoluteDifference:pLe,computeWeightedLoss:cc,cosineDistance:gLe,hingeLoss:mLe,huberLoss:vLe,logLoss:yLe,meanSquaredError:bLe,sigmoidCrossEntropy:xLe,softmaxCrossEntropy:wLe});function SJ(e,t){return t===void 0&&(t=!1),J.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=fE(n),a=e.clone(),o=Wu([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(f){var d,h=a,p=s,g=i;d=J.tidy(function(){var m=a.slice([f,f],[n-f,1]),v=m.norm(),y=a.slice([f,f],[1,1]),b=Wu([[-1]]).where(y.greater(0),Wu([[1]])),x=y.sub(b.mul(v)),w=m.div(x);s=w.shape[0]===1?o.clone():o.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),A=a.slice([f,0],[n-f,r]),_=S.mul(s),E=s.transpose();if(f===0)a=A.sub(_.matMul(E.matMul(A)));else{var C=A.sub(_.matMul(E.matMul(A)));a=a.slice([0,0],[f,r]).concat(C,0)}var k=_.transpose(),T=i.slice([0,f],[n,i.shape[1]-f]);if(f===0)i=T.sub(T.matMul(s).matMul(k));else{var I=T.sub(T.matMul(s).matMul(k));i=i.slice([0,0],[n,f]).concat(I,1)}return[s,a,i]}),s=d[0],a=d[1],i=d[2],jt([h,p,g])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}var _Le=Q({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=j(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=Tm(0,o,1,"int32").reshape([-1,1]),l=Tm(0,s,1,"int32"),c=Ar(u,l),f=Gu(c.lessEqual(Ve(+t,"int32")),c.greaterEqual(Ve(-n,"int32"))),d=Tn([o,s],r.dtype);return ss(If(r.reshape([-1,o,s])).map(function(h){return Gs(f,h,d)})).reshape(i)}}),SLe=Q({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,U(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){U(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=oc(e,e.shape[0],0).map(function(u){return fb(u,[0])});U(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],o=e,s=function(u){a.push(J.tidy(function(){var l=o[u];if(u>0)for(var c=0;c<u;++c){var f=Hr(a[c].mulStrict(l)).mul(a[c]);l=l.sub(f)}return l.div(qM(l,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?ss(a,0):a}}),ELe=Q({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return SJ(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,s){return o*s}),r=If(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(function(o){var s=SJ(o,t),u=s[0],l=s[1];i.push(u),a.push(l)}),[ss(i,0).reshape(e.shape),ss(a,0).reshape(e.shape)]}}),QM=Object.freeze({bandPart:_Le,gramSchmidt:SLe,qr:ELe});function DE(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);var o=e.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),U(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),U(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),U(t.rank===1,function(){return"scores must be a 1D tensor"}),U(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),U(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var ALe=Q({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeBilinear");U(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,o,s,n)},{x:i},function(l,c){return{x:function(){return J.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),CLe=Q({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeNearestNeighbor");U(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),U(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,o,s,n)},{batchImages:i},function(l,c){return{batchImages:function(){return J.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),kLe=Q({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var a=j(e,"boxes","nonMaxSuppression"),o=j(t,"scores","nonMaxSuppression"),s=DE(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return J.runKernelFunc(function(l){return l.nonMaxSuppression(a,o,n,r,i)},{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),TLe=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),tt(this,void 0,void 0,function(){var a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return a=j(e,"boxes","nonMaxSuppressionAsync"),o=j(t,"scores","nonMaxSuppressionAsync"),s=DE(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=dM(l,c,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,f]}})})},OLe=Q({nonMaxSuppressionWithScore_:function(e,t,n,r,i,a){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var o=j(e,"boxes","nonMaxSuppression"),s=j(t,"scores","nonMaxSuppression"),u=DE(o,s,n,r,i,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=J.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),ILe=function(e,t,n,r,i,a){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),tt(this,void 0,void 0,function(){var o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return o=j(e,"boxes","nonMaxSuppressionAsync"),s=j(t,"scores","nonMaxSuppressionAsync"),u=DE(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=hM(c,f,n,r,i,a),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},NLe=Q({cropAndResize_:function(e,t,n,r,i,a){var o=j(e,"image","cropAndResize"),s=j(t,"boxes","cropAndResize","float32"),u=j(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return U(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),U(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),U(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),U(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),U(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),U(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),J.runKernelFunc(function(c,f){return c.cropAndResize(o,s,u,r,i,a)},{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),$f=Object.freeze({resizeBilinear:ALe,resizeNearestNeighbor:CLe,nonMaxSuppression:kLe,nonMaxSuppressionAsync:TLe,nonMaxSuppressionWithScore:OLe,nonMaxSuppressionWithScoreAsync:ILe,cropAndResize:NLe}),eP=function(e,t){return!(e>0)||t==="linear"},tP=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},nP=function(e,t){var n=t,r=qr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},rP=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Pf(e);if(t==="elu")return jm(e);if(t==="relu6")return WM(e);if(t==="prelu")return Nb(e,n);throw new Error("Unknown fused activation "+t+".")},DLe=Q({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=i!==void 0&&i,o=e.transposeB,s=o!==void 0&&o,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(eP(J.state.gradientDepth,c)===!1){var d=vE(n,r,a,s);return u!=null&&(d=Ut(d,u)),rP(d,c,f)}var h=j(n,"a","fused matMul"),p=j(r,"b","fused matMul");t=fr(h,p),h=t[0],p=t[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),w=et(b),S=et(x);U(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),U(Wr(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),U(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var A,_,E=h.shape.slice(0,-2).concat([v,y]),C=a?h.as3D(w,g,v):h.as3D(w,v,g),k=s?p.as3D(S,y,m):p.as3D(S,m,y);u!=null&&Qt(E,(A=fr(A=j(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=j(f,"prelu weights","fused matMul"));var T={a:C,b:k};u!=null&&(T.bias=A),f!=null&&(T.preluActivationWeights=_);var I=[C,k];return J.runKernelFunc(function(N,O){var D=N.fusedBatchMatMul({a:C,b:k,transposeA:a,transposeB:s,bias:A,activation:c,preluActivationWeights:_});return O([C,k,D]),D},T,function(N,O){var D=O[0],L=O[1],W=O[2],G=tP(N,W,c),K={};return u!=null&&(K={bias:function(){return nP(A,G)}}),Object.assign(a||s?!a&&s?{a:function(){return G.matMul(L,!1,!1)},b:function(){return G.matMul(D,!0,!1)}}:a&&!s?{a:function(){return L.matMul(G,!1,!0)},b:function(){return D.matMul(G,!1,!1)}}:{a:function(){return L.matMul(G,!0,!0)},b:function(){return G.matMul(D,!0,!0)}}:{a:function(){return G.matMul(L,!1,!0)},b:function(){return D.matMul(G,!0,!1)}},K)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},I,[!0]).reshape(E)}}),RLe=Q({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",eP(J.state.gradientDepth,d)===!1){var p=Hh(t,n,r,i,o,u,l);return c!=null&&(p=Ut(p,c)),rP(p,d,h)}var g=j(t,"x","conv2d"),m=j(n,"filter","conv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&U(vr(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),U(Gi(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),U(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,w=Ff(v.shape,m.shape,r,u,i,l);c!=null&&(b=fr(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused conv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var A=[m,v],_=J.runKernelFunc(function(E,C){var k=E.fusedConv2d({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return C([m,v,k]),k},S,function(E,C){var k=C,T=k[0],I=k[1],N=k[2],O=tP(E,N,d);U($h(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var D={};return c!=null&&(D={bias:function(){return nP(b,O)}}),Object.assign({x:function(){return QZ(I.shape,O,T,r,i)},filter:function(){return BM(I,O,T.shape,r,i)}},D)},"FusedConv2D",{convInfo:w,activation:d},A,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),FLe=Q({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(eP(J.state.gradientDepth,d)===!1){var p=Bm(t,n,r,i,o,u,l);return c!=null&&(p=Ut(p,c)),rP(p,d,h)}var g=j(t,"x","depthwiseConv2d"),m=j(n,"filter","depthwiseConv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),U(Gi(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&U(vr(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=Ff(v.shape,m.shape,r,u,i,l,!0);c!=null&&(b=fr(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var A=[m,v],_=J.runKernelFunc(function(E,C){var k=E.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return C([m,v,k]),k},S,function(E,C){U($h(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=C[0],T=C[1],I=C[2],N=tP(E,I,d),O={};return c!=null&&(O={bias:function(){return nP(b,N)}}),Object.assign({x:function(){return eJ(T.shape,N,k,w)},filter:function(){return tJ(T,N,k.shape,w)}},O)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},A,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Lf=Object.freeze({matMul:DLe,conv2d:RLe,depthwiseConv2d:FLe}),MLe=Object.freeze({image:$f,linalg:QM,losses:_J,spectral:vJ,fused:Lf,signal:xJ,add:Ut,addN:SM,batchNorm:Uh,batchNormalization:CZ,batchNorm2d:EM,batchNormalization2d:TZ,batchNorm3d:AM,batchNormalization3d:IZ,batchNorm4d:CM,batchNormalization4d:DZ,broadcastTo:kM,clone:RZ,div:Cr,divNoNan:cE,eye:fE,multinomial:OM,oneHot:Wh,pad:Ku,pad1d:MZ,pad2d:PZ,pad3d:$Z,pad4d:LZ,rand:BZ,randomGamma:jZ,randomNormal:FM,randomUniform:Vh,square:dE,squaredDifference:hE,tile:lc,truncatedNormal:Eb,conv1d:pE,conv2d:Hh,conv3d:gE,depthwiseConv2d:Bm,separableConv2d:zM,conv2dTranspose:mE,conv3dTranspose:nJ,op:Q,booleanMaskAsync:YZ,complex:ii,real:to,imag:os,concat:Hi,concat1d:w3,concat2d:_3,concat3d:S3,concat4d:E3,split:oc,matMul:vE,dot:rJ,outerProduct:iJ,reverse:Xu,reverse1d:aJ,reverse2d:oJ,reverse3d:sJ,reverse4d:uJ,maxPool:yE,avgPool:bE,pool:fJ,maxPool3d:xE,avgPool3d:wE,maxPoolWithArgmax:jM,slice:Fo,slice1d:Cb,slice2d:_E,slice3d:kb,slice4d:zm,abs:Nf,acos:R3,acosh:F3,asin:M3,asinh:P3,atan:$3,atanh:L3,ceil:B3,clipByValue:xa,cos:z3,cosh:j3,erf:U3,exp:W3,expm1:V3,floor:US,log:uc,log1p:q3,logSigmoid:sY,neg:Df,reciprocal:H3,round:G3,rsqrt:WS,sigmoid:VS,sign:K3,isNaN:uY,isInf:lY,isFinite:cY,sin:X3,sinh:Y3,softplus:pb,sqrt:gb,step:fY,tan:Z3,tanh:qS,all:SE,any:Tb,argMax:Ob,argMin:UM,logSumExp:hJ,max:Mf,mean:Pr,min:EE,moments:Ib,sum:Hr,prod:AE,equal:qh,equalStrict:UZ,greater:Pm,greaterEqual:Ab,greaterEqualStrict:WZ,greaterStrict:VZ,less:MM,lessEqual:PM,lessEqualStrict:qZ,lessStrict:HZ,notEqual:$m,notEqualStrict:GZ,addStrict:dY,atan2:J3,divStrict:hY,floorDiv:HS,maximum:qu,maximumStrict:pY,minimum:Om,minimumStrict:gY,mod:Q3,modStrict:mY,mul:rt,mulStrict:GS,pow:Im,powStrict:vY,squaredDifferenceStrict:yY,sub:Ar,subStrict:bY,elu:jm,leakyRelu:CE,prelu:Nb,relu:Pf,relu6:WM,selu:kE,logicalAnd:Gu,logicalNot:TM,logicalOr:uE,logicalXor:FZ,where:Gs,whereAsync:lE,buffer:Ot,print:rY,batchToSpaceND:PS,cast:$S,cumsum:iY,depthToSpace:A3,expandDims:Ro,reshape:qs,spaceToBatchND:LS,squeeze:fb,stack:ss,unstack:If,setdiff1dAsync:C3,fill:km,linspace:x3,ones:Vu,range:Tm,scalar:Ve,tensor:Mr,tensor1d:ba,tensor2d:Wu,tensor3d:MS,tensor4d:Of,tensor5d:tY,tensor6d:nY,variable:b3,zeros:Tn,onesLike:Do,zerosLike:en,transpose:cn,softmax:Ph,logSoftmax:ZS,localResponseNormalization:VM,norm:qM,gather:Lm,unsortedSegmentSum:$M,basicLSTMCell:pJ,multiRNNCell:gJ,movingAverage:mJ,stridedSlice:HM,topk:GM,scatterND:KM,fft:Db,ifft:Um,rfft:Rb,irfft:TE,sparseToDense:OE,gatherND:XM,diag:yJ,dropout:YM,hannWindow:IE,hammingWindow:ZM,frame:NE,stft:JM,inTopKAsync:wJ});function ke(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&U(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function iP(e,t,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ot(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],x=0;x<i.batchSize;++x)for(var w=x*v,S=x*r[0],A=0;A<i.inChannels;++A)for(var _=0;_<i.outHeight;++_)for(var E=_*o-d,C=Math.max(0,E),k=Math.min(i.inHeight,c+E),T=w+_*y,I=0;I<i.outWidth;++I){for(var N=I*s-h,O=Math.max(0,N),D=Math.min(i.inWidth,f+N),L=p,W=0,G=0,K=C;K<k;K+=u){for(var ee=S+K*r[1],ce=O;ce<D;ce+=l){var he=e[ee+ce*r[2]+A];a==="max"&&he>L?L=he:a==="avg"&&(W+=he,G++)}if(isNaN(L))break}m[T+I*b+A]=a==="avg"?W/G:L}return g}function EJ(e,t,n,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);for(var o=Ot(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Ot(t,n,e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=l;for(var w=Math.min(r.inHeight,f+b),S=0;S<r.outWidth;++S){for(var A=S*u-p,_=A;_<0;)_+=c;for(var E=Math.min(r.inWidth,d+A),C=Number.NEGATIVE_INFINITY,k=-1,T=x;T<w;T+=l)for(var I=T-b,N=_;N<E;N+=c){var O=N-A,D=g.get(m,T,N,v);D>C&&(C=D,k=i?a?((m*r.inHeight+T)*r.inWidth+N)*r.inChannels+v:(T*r.inWidth+N)*r.inChannels+v:I*d+O)}o.set(k,m,y,S,v)}}return o}function aP(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var PLe=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new aM(n,J),n}return js(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,pe().get("IS_NODE")&&RS(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:i}),a},t.prototype.move=function(n,r,i,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,a=r.complexTensors;return i==="complex64"?fM(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(a){return Zy(a)})}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ot(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var a=this.write(n,r,i);return J.makeTensorFromDataId(a,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return r=Us(),n(),[2,{kernelMs:Us()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(ke(n,"slice"),rM(n.shape,r,i)){var a=iM(r,n.strides),o=et(i);return Mr(this.readSync(n.dataId).subarray(a,a+o),i,n.dtype)}for(var s=Ot(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,a){ke(n,"stridedSlice");var o=XS(r,i,a);if(o.some(function(h){return h===0}))return Mr([],o);for(var s=Ot(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*a[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=Ot([n.size,n.size],n.dtype),a=i.values,o=0;o<r.length;o++)a[o*n.size+o]=r[o];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){ke(n,"reverse");for(var i=Ot(n.shape,n.dtype),a=this.bufferSync(n),o=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),i.set.apply(i,[a.get.apply(a,c)].concat(l))},s=0;s<i.size;s++)o(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return to(h)}),o=n.map(function(h){return os(h)});return ii(this.concat(a,r),this.concat(o,r))}var s=n.map(function(h){var p=et(h.shape.slice(r));return h.as2D(-1,p)}),u=Mh(s.map(function(h){return h.shape}),1),l=Ot(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(i.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),g=0,m=0;m<h.shape[0];++m)for(var v=m*u[1]+f,y=0;y<h.shape[1];++y)l[v+y]=p[g++];f+=h.shape[1]})}var d=Mh(n.map(function(h){return h.shape}),r);return Mr(l,d,n[0].dtype)},t.prototype.neg=function(n){return ke(n,"neg"),this.multiply(Ve(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i+o,imag:a+s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i+a})},t.prototype.addN=function(n){var r=this;ke(n,"addN");for(var i=n.map(function(c){return r.readSync(c.dataId)}),a=Ot(n[0].shape,n[0].dtype),o=a.values,s=0;s<n.length;s++)for(var u=i[s],l=0;l<o.length;l++)o[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var i=Vr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i-o,imag:a-s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i-a})},t.prototype.pow=function(n,r){return ke([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.pow(i,a)})},t.prototype.batchMatMul=function(n,r,i,a){ke([n,r],"matMul");for(var o=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],g=d[2],m=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=m[0],y=m[1],b=m[2],x=s*u,w=Ot([l,s,u],n.dtype),S=w.values,A=this.blockSize,_=0;_<l;_++)for(var E=0;E<s;E+=A)for(var C=0;C<u;C+=A)for(var k=0;k<o;k+=A)for(var T=Math.min(E+A,s),I=Math.min(C+A,u),N=Math.min(k+A,o),O=E;O<T;O++)for(var D=C;D<I;D++){for(var L=0,W=k;W<N;W++)L+=c[_*h+O*p+W*g]*f[W*v+D*y+_*b];S[_*x+(O*u+D)]+=L}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,i,a,o);return s&&(c=this.add(c,s)),u&&(c=aP(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i*o-a*s,imag:i*s+a*o}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i*a})},t.prototype.floorDiv=function(n,r){return ke([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,a){return Math.floor(i/a)})},t.prototype.sum=function(n,r){ke(n,"sum"),eo("sum",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){ke(n,"sum");for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){ke(n,"unsortedSegmentSum");for(var a=[],o=n.rank-r.rank,s=0;s<o;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ve(s,"int32"),l=qh(u,r).asType("float32").mul(n).sum(0);a.push(l)}return ss(a)},t.prototype.argMin=function(n,r){ke(n,"argMin");var i=[r];eo("argMin",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v<p&&(p=v,g=m)}c[d]=g}return u},t.prototype.argMax=function(n,r){ke(n,"argMax");var i=[r];eo("argMax",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v>p&&(p=v,g=m)}c[d]=g}return u},t.prototype.cumsum=function(n,r,i,a){if(ke(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=yi(n.dtype,"int32"),s=Tn(n.shape,o),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=a?function(m,v){return m+c-v-1}:function(m,v){return m+v},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=i?0:l[p];else{var g=f(d,h-1);u[p]=i?l[g]+u[g]:l[p]+u[g]}}return s},t.prototype.equal=function(n,r){return ke([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i===a?1:0})},t.prototype.notEqual=function(n,r){return ke([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i!==a?1:0})},t.prototype.less=function(n,r){return ke([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<a?1:0})},t.prototype.lessEqual=function(n,r){return ke([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<=a?1:0})},t.prototype.greater=function(n,r){return ke([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>a?1:0})},t.prototype.greaterEqual=function(n,r){return ke([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>=a?1:0})},t.prototype.logicalNot=function(n){ke(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)i[a]=r[a]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return ke([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i&&a})},t.prototype.logicalOr=function(n,r){return ke([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i||a})},t.prototype.select=function(n,r,i){ke([n,r,i],"select");for(var a=this.readSync(n.dataId),o=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Tn(r.shape,yi(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:et(r.shape.slice(1)),d=0;d<a.length;d++)for(var h=0;h<f;h++)a[d]===1?l[c++]=o[d]:l[c++]=s[d];return u},t.prototype.where=function(n){ke([n],"where");var r=this.readSync(n.dataId);return pM(n.shape,r)},t.prototype.topk=function(n,r,i){return ke(n,"topk"),NY(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){ke(n,"min"),eo("min",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g<h&&(h=g)}l[f]=h}return s},t.prototype.minimum=function(n,r){return ke([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.min(i,a)})},t.prototype.mod=function(n,r){return ke([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i%a;return i<0&&a<0||i>=0&&a>=0?o:(o+a)%a})},t.prototype.max=function(n,r){ke(n,"max"),eo("max",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g>h&&(h=g)}l[f]=h}return s},t.prototype.maximum=function(n,r){return ke([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.max(i,a)})},t.prototype.all=function(n,r){ke(n,"all"),eo("all",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h&&g}l[f]=h}return s},t.prototype.any=function(n,r){ke(n,"any"),eo("any",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h||g}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return ke([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i-a;return o*o})},t.prototype.ceil=function(n){ke(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.ceil(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){ke(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.floor(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?i[a]=-1:r[a]>0?i[a]=1:i[a]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){ke(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=Math.floor(r[a]);r[a]-o<.5?i[a]=Math.floor(r[a]):r[a]-o>.5?i[a]=Math.ceil(r[a]):i[a]=o%2==0?o:o+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){ke(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.exp(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){ke(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.expm1(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){ke(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){ke(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log1p(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){ke(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){ke(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=1/Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){ke(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=1/r[a];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.max(0,a[o]);return r},t.prototype.relu6=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.min(Math.max(0,a[o]),6);return r},t.prototype.prelu=function(n,r){return ke([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return i<0?a*i:i})},t.prototype.elu=function(n){ke(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){ke([n,r],"eluDer");for(var i=new Float32Array(r.size),a=this.readSync(r.dataId),o=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){ke(n,"selu");for(var r=wM,i=_M,a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,i){ke(n,"clip");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>i?i:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.abs(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<n.size;++a){var o=i[2*a],s=i[2*a+1];r[a]=Math.hypot(o,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){ke(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=i[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){ke(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=1/(1+Math.exp(-i[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){ke(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o]>-r,u=a[o]<r,l=Math.exp(a[o]),c=void 0;c=u?l:s?a[o]:Math.log(1+l),i[o]=c}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){ke(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){ke(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){ke(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.tan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){ke(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){ke(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){ke(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return ke([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.atan2(i,a)})},t.prototype.sinh=function(n){ke(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){ke(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){ke(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=fX(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){ke(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){ke(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){ke(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atanh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){ke(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=Math.sign(i[a]),s=Math.abs(i[a]),u=1/(1+.3275911*s);r[a]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),ke(n,"step");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o];isNaN(s)?i[o]=NaN:i[o]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,i,a);return o&&(l=this.add(l,o)),s&&(l=aP(this,l,s,u)),l},t.prototype.conv2d=function(n,r,i){ke([n,r],"conv2d");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",d=Ot(i.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],g=f?n.strides[2]:1,m=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),A=d.values,_=0;_<i.batchSize;++_)for(var E=_*h,C=_*v,k=0;k<i.outHeight;++k)for(var T=C+k*y,I=k*i.strideHeight-c,N=0;N<a;N++){var O=I+N*s;if(!(O<0||O>=i.inHeight))for(var D=N*r.strides[0],L=E+O*p,W=0;W<i.outWidth;++W)for(var G=T+W*b,K=W*i.strideWidth-l,ee=0;ee<o;ee++){var ce=K+ee*u;if(!(ce<0||ce>=i.inWidth))for(var he=L+ce*g,Oe=D+ee*r.strides[1],Te=0;Te<i.inChannels;++Te){for(var Re=w[he+Te*m],me=0;me<i.outChannels;++me)A[G+me*x]+=Re*S[Oe+me];Oe+=i.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,i){for(var a=i.filterDepth,o=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,d=i.padInfo.left,h=i.padInfo.top,p=Ot(i.outShape,n.dtype),g=this.readSync(n.dataId),m=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],x=y*p.strides[0],w=0;w<i.outDepth;++w)for(var S=x+w*p.strides[1],A=w*i.strideDepth-f,_=0;_<a;_++){var E=A+_*u;if(!(E<0||E>=i.inDepth))for(var C=_*r.strides[0],k=b+E*n.strides[1],T=0;T<i.outHeight;++T)for(var I=S+T*p.strides[2],N=T*i.strideHeight-h,O=0;O<o;O++){var D=N+O*l;if(!(D<0||D>=i.inHeight))for(var L=C+O*r.strides[1],W=k+D*n.strides[2],G=0;G<i.outWidth;++G)for(var K=I+G*i.outChannels,ee=G*i.strideWidth-d,ce=0;ce<s;ce++){var he=ee+ce*c;if(!(he<0||he>=i.inWidth))for(var Oe=L+ce*r.strides[2],Te=W+he*i.inChannels,Re=Oe,me=0;me<i.inChannels;++me){for(var P=g[Te+me],F=0;F<i.outChannels;++F)v[K+F]+=P*m[Re+F];Re+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){ke([n,r],"conv2dDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=i.batchSize,p=i.filterHeight,g=i.filterWidth,m=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,x=i.outHeight,w=i.outWidth,S=i.strideHeight,A=i.strideWidth,_=i.dataFormat,E=p-1-i.padInfo.top,C=g-1-i.padInfo.left,k=_==="channelsLast",T=a.strides[0],I=k?a.strides[1]:a.strides[2],N=k?a.strides[2]:1,O=k?1:a.strides[1],D=n.strides[0],L=k?n.strides[1]:n.strides[2],W=k?n.strides[2]:1,G=k?1:n.strides[1],K=0;K<h;++K)for(var ee=0;ee<m;++ee)for(var ce=0;ce<v;++ce)for(var he=ce-E,Oe=Math.max(0,Math.ceil(he/S)),Te=Math.min(x,(p+he)/S),Re=0;Re<y;++Re){for(var me=Re-C,P=Math.max(0,Math.ceil(me/A)),F=Math.min(w,(g+me)/A),V=0,ae=Oe;ae<Te;++ae)for(var Y=ae*S-he,M=P;M<F;++M)for(var B=D*K+L*ae+W*M,R=c*(p-1-Y)+f*(g-1-(M*A-me))+d*ee,X=0;X<b;++X)V+=s[B+G*X]*u[R+X];o[T*K+I*ce+N*Re+O*ee]=V}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],A=b[3],_=i.batchSize,E=i.filterDepth,C=i.filterHeight,k=i.filterWidth,T=i.inChannels,I=i.inDepth,N=i.inHeight,O=i.inWidth,D=i.outChannels,L=i.outDepth,W=i.outHeight,G=i.outWidth,K=i.strideDepth,ee=i.strideHeight,ce=i.strideWidth,he=E-1-i.padInfo.front,Oe=C-1-i.padInfo.top,Te=k-1-i.padInfo.left,Re=0;Re<_;++Re)for(var me=0;me<T;++me)for(var P=0;P<I;++P)for(var F=P-he,V=Math.max(0,Math.ceil(F/K)),ae=Math.min(L,(E+F)/K),Y=0;Y<N;++Y)for(var M=Y-Oe,B=Math.max(0,Math.ceil(M/ee)),R=Math.min(W,(C+M)/ee),X=0;X<O;++X){for(var ge=X-Te,xe=Math.max(0,Math.ceil(ge/ce)),ze=Math.min(G,(k+ge)/ce),Ke=0,Ze=V;Ze<ae;++Ze)for(var Lt=Ze*K-F,Je=B;Je<R;++Je)for(var Zt=Je*ee-M,mn=xe;mn<ze;++mn)for(var qn=p*Re+g*Ze+m*Je+v*mn,ni=x*(E-1-Lt)+w*(C-1-Zt)+S*(k-1-(mn*ce-ge))+A*me,tr=0;tr<D;++tr)Ke+=d[qn+tr]*y[ni+tr];o[u*Re+l*P+c*Y+f*X+me]=Ke}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){ke([n,r],"conv2dDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=Ot(i.filterShape,"float32"),f=i.padInfo.left,d=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((d-g)/a)),v=Math.min(i.outHeight,(i.inHeight+d-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/o)),x=Math.min(i.outWidth,(i.inWidth+f-y)/o),w=0;w<i.inChannels;++w)for(var S=0;S<i.outChannels;++S){for(var A=0,_=0;_<i.batchSize;++_)for(var E=m;E<v;++E)for(var C=g+E*a-d,k=b;k<x;++k){var T=y+k*o-f;A+=l?h.get(_,C,T,w)*p.get(_,E,k,S):h.get(_,w,C,T)*p.get(_,S,E,k)}c.set(A,g,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=Ot(i.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],A=b[3],_=this.readSync(n.dataId),E=n.strides,C=E[0],k=E[1],T=E[2],I=E[3],N=i.padInfo.front,O=i.padInfo.left,D=i.padInfo.top,L=0;L<u;++L)for(var W=Math.max(0,Math.ceil((N-L)/a)),G=Math.min(i.outDepth,(i.inDepth+N-L)/a),K=L*p,ee=0;ee<l;++ee)for(var ce=Math.max(0,Math.ceil((D-ee)/o)),he=Math.min(i.outHeight,(i.inHeight+D-ee)/o),Oe=ee*g+K,Te=0;Te<c;++Te)for(var Re=Math.max(0,Math.ceil((O-Te)/s)),me=Math.min(i.outWidth,(i.inWidth+O-Te)/s),P=Te*m+Oe,F=0;F<i.inChannels;++F)for(var V=F*v+P,ae=0;ae<i.outChannels;++ae){for(var Y=0,M=0;M<i.batchSize;++M)for(var B=M*C,R=M*x,X=W;X<G;++X)for(var ge=(L+X*a-N)*k+B,xe=X*w+R,ze=ce;ze<he;++ze)for(var Ke=(ee+ze*o-D)*T+ge,Ze=ze*S+xe,Lt=Re;Lt<me;++Lt){var Je=Lt*A+Ze;Y+=_[(Te+Lt*s-O)*I+Ke+F]*y[Je+ae]}d[V+ae]=Y}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,i,a);return o&&(l=this.add(l,o)),s&&(l=aP(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,i){ke([n,r],"depthwiseConv2D");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,d=Ot(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),g=d.values,m=0;m<i.batchSize;++m)for(var v=m*n.strides[0],y=m*d.strides[0],b=0;b<i.outHeight;++b)for(var x=y+b*d.strides[1],w=b*i.strideHeight-l,S=0;S<a;++S){var A=w+S*s;if(!(A<0||A>=i.inHeight))for(var _=S*r.strides[0],E=v+A*n.strides[1],C=0;C<i.outWidth;++C)for(var k=x+C*d.strides[2],T=C*i.strideWidth-c,I=0;I<o;++I){var N=T+I*u;if(!(N<0||N>=i.inWidth))for(var O=_+I*r.strides[1],D=E+N*i.inChannels,L=k,W=O,G=0;G<i.inChannels;++G){for(var K=h[D+G],ee=0;ee<f;++ee)g[L+ee]+=K*p[W+ee];L+=f,W+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){ke([n,r],"depthwiseConv2DDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],g=d[2],m=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=i.batchSize,S=i.filterHeight,A=i.filterWidth,_=i.inChannels,E=i.inHeight,C=i.inWidth,k=i.outChannels,T=i.outHeight,I=i.outWidth,N=i.strideHeight,O=i.strideWidth,D=S-1-i.padInfo.top,L=A-1-i.padInfo.left,W=k/_,G=0;G<w;++G)for(var K=0;K<_;++K)for(var ee=0;ee<E;++ee)for(var ce=ee-D,he=Math.max(0,Math.ceil(ce/N)),Oe=Math.min(T,(S+ce)/N),Te=0;Te<C;++Te){for(var Re=Te-L,me=Math.max(0,Math.ceil(Re/O)),P=Math.min(I,(A+Re)/O),F=0,V=he;V<Oe;++V)for(var ae=V*N-ce,Y=me;Y<P;++Y)for(var M=h*G+p*V+g*Y,B=y*(S-1-ae)+b*(A-1-(Y*O-Re))+x*K,R=0;R<W;++R)F+=f[M+(K*W+R)]*m[B+R];o[u*G+l*ee+c*Te+K]=F}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){ke([n,r],"depthwiseConv2DDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=Ot(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,d=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((f-g)/a)),v=Math.min(i.outHeight,(i.inHeight+f-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/o)),x=Math.min(i.outWidth,(i.inWidth+c-y)/o),w=0;w<i.outChannels;++w){for(var S=Math.trunc(w/d),A=w%d,_=0,E=0;E<i.batchSize;++E)for(var C=m;C<v;++C)for(var k=g+C*a-f,T=b;T<x;++T){var I=y+T*o-c;_+=h.get(E,k,I,S)*p.get(E,C,T,w)}l.set(_,g,y,S,A)}return l.toTensor()},t.prototype.tile=function(n,r){return ke(n,"tile"),IY(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){ke(n,"pad");var a=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),o=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ot(a,n.dtype);i!==0&&u.values.fill(i);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+o[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.gather=function(n,r,i){ke([n,r],"gather");var a=n.shape.slice(),o=this.readSync(r.dataId);a[i]=o.length;for(var s=Ot(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[i]=o[c[i]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){ke([n],"batchToSpaceND");var a=r.reduce(function(f,d){return f*d}),o=BS(n.shape,r,a),s=zS(o.length,r.length),u=jS(n.shape,r,a),l=aY(i,r.length),c=oY(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){ke([n],"spaceToBatchND");var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=BS(u.shape,r,a,!1),c=zS(l.length,r.length,!1),f=jS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.maxPool=function(n,r){return ke(n,"maxPool"),iP(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"max").toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,a){ke([r,i],"maxPoolBackprop");for(var o=this.readSync(r.dataId),s=Ot(a.outShape,r.dtype,EJ(o,r.shape,r.dtype,a).values),u=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=h-1-a.padInfo.left,g=d-1-a.padInfo.top,m=Ot(r.shape,"float32"),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var x=0;x<a.inHeight;++x)for(var w=0;w<a.inWidth;++w){for(var S=x-g,A=w-p,_=0,E=0;E<d;E+=c){var C=(S+E)/u;if(!(C<0||C>=a.outHeight||Math.floor(C)!==C))for(var k=0;k<h;k+=f){var T=(A+k)/l;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var I=d*h-1-s.get(y,C,T,b)===E*h+k?1:0;I!==0&&(_+=v.get(y,C,T,b)*I)}}}m.set(_,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){ke([n,r],"avgPoolBackprop");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,g=Ot(r.shape,"float32"),m=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-p,A=w-h,_=0,E=0;E<f;E+=l){var C=(S+E)/a;if(!(C<0||C>=i.outHeight||Math.floor(C)!==C))for(var k=0;k<d;k+=c){var T=(A+k)/o;T<0||T>=i.outWidth||Math.floor(T)!==T||(_+=v.get(y,C,T,b))}}g.set(_*m,y,x,w,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,i){ke(n,"pool3d");for(var a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Ot(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[3]*r.outShape[4],_=r.outShape[4],E=0;E<r.batchSize;++E)for(var C=E*w,k=E*n.strides[0],T=0;T<r.inChannels;++T)for(var I=0;I<r.outDepth;++I){for(var N=I*a-p,O=N;O<0;)O+=u;for(var D=Math.min(r.inDepth,f+N),L=C+I*S,W=0;W<r.outHeight;++W){for(var G=W*o-g,K=G;K<0;)K+=l;for(var ee=Math.min(r.inHeight,d+G),ce=L+W*A,he=0;he<r.outWidth;++he){for(var Oe=he*s-m,Te=Oe;Te<0;)Te+=c;for(var Re=Math.min(r.inWidth,h+Oe),me=ce+he*_,P=v,F=0,V=0,ae=O;ae<D;ae+=u){for(var Y=k+ae*n.strides[1],M=K;M<ee;M+=l){for(var B=Y+M*n.strides[2],R=Te;R<Re;R+=c){var X=y[B+R*n.strides[3]+T];if(i==="max"&&X>P?P=X:i==="avg"&&(F+=X,V++),isNaN(P))break}if(isNaN(P))break}if(isNaN(P))break}x[me+T]=i==="avg"?F/V:P}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return ke(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){ke([n,r],"avgPool3dBackprop");for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=m-1-i.padInfo.left,b=g-1-i.padInfo.top,x=Ot(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),A=0;A<i.batchSize;++A)for(var _=0;_<i.inChannels;++_)for(var E=0;E<i.inDepth;++E)for(var C=0;C<i.inHeight;++C)for(var k=0;k<i.inWidth;++k){for(var T=E-v,I=C-b,N=k-y,O=0,D=0;D<p;D+=f){var L=(T+D)/a;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var W=0;W<g;W+=d){var G=(I+W)/o;if(!(G<0||G>=i.outHeight||Math.floor(G)!==G))for(var K=0;K<m;K+=h){var ee=(N+K)/s;ee<0||ee>=i.outWidth||Math.floor(ee)!==ee||(O+=S.get(A,L,G,ee,_))}}}x.set(O*w,A,E,C,k,_)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return ke(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=Ot(r.outShape,"int32"),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*a-p,S=w;S<0;)S+=u;for(var A=Math.min(r.inDepth,f+w),_=0;_<r.outHeight;++_){for(var E=_*o-g,C=E;C<0;)C+=l;for(var k=Math.min(r.inHeight,d+E),T=0;T<r.outWidth;++T){for(var I=T*s-m,N=I;N<0;)N+=c;for(var O=Math.min(r.inWidth,h+I),D=Number.NEGATIVE_INFINITY,L=-1,W=S;W<A;W+=u)for(var G=W-w,K=C;K<k;K+=l)for(var ee=K-E,ce=N;ce<O;ce+=c){var he=ce-I,Oe=v.get(y,W,K,ce,b);Oe>=D&&(D=Oe,L=G*d*h+ee*d+he)}i.set(L,y,x,_,T,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,a){ke([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=h-1-a.padInfo.front,v=g-1-a.padInfo.left,y=p-1-a.padInfo.top,b=Ot(r.shape,"float32"),x=this.bufferSync(o),w=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var A=0;A<a.inChannels;++A)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var C=0;C<a.inWidth;++C){for(var k=_-m,T=E-y,I=C-v,N=0,O=0;O<h;O+=c){var D=(k+O)/s;if(!(D<0||D>=a.outDepth||Math.floor(D)!==D))for(var L=0;L<p;L+=f){var W=(T+L)/u;if(!(W<0||W>=a.outHeight||Math.floor(W)!==W))for(var G=0;G<g;G+=d){var K=(I+G)/l;if(!(K<0||K>=a.outWidth||Math.floor(K)!==K)){var ee=h*p*g-1-x.get(S,D,W,K,A)===O*p*g+L*g+G?1:0;ee!==0&&(N+=w.get(S,D,W,K,A)*ee)}}}}b.set(N,S,_,E,C,A)}return b.toTensor()},t.prototype.cast=function(n,r){return lM(n,r,this)},t.prototype.reshape=function(n,r){return eE(n,r)},t.prototype.avgPool=function(n,r){return ke(n,"avgPool"),ke(n,"maxPool"),iP(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(n,r,i,a){ke(n,"resizeBilinear");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(et([s,r,i,c])),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=0,m=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=m*b,w=Math.floor(x),S=x-w,A=Math.min(u-1,Math.ceil(x)),_=y*n.strides[0]+w*n.strides[1],E=y*n.strides[0]+A*n.strides[1],C=0;C<i;C++)for(var k=v*C,T=Math.floor(k),I=k-T,N=Math.min(l-1,Math.ceil(k)),O=_+T*n.strides[2],D=E+T*n.strides[2],L=_+N*n.strides[2],W=E+N*n.strides[2],G=0;G<c;G++){var K=f[O+G],ee=f[D+G],ce=K+(f[L+G]-K)*I,he=ce+(ee+(f[W+G]-ee)*I-ce)*S;d[g++]=he}return Mr(d,[s,r,i,c])},t.prototype.resizeBilinearBackprop=function(n,r,i){ke([n,r],"resizeBilinearBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=[i&&f>1?s-1:s,i&&d>1?u-1:u],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],m=p[0]/g[0],v=p[1]/g[1],y=this.readSync(n.dataId),b=0,x=0;x<o;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var A=S*m,_=Math.floor(A),E=Math.min(Math.ceil(A),s-1),C=w+_*r.strides[1],k=w+E*r.strides[1],T=A-_,I=1-T,N=0;N<d;N++)for(var O=N*v,D=Math.floor(O),L=Math.min(Math.ceil(O),u-1),W=O-D,G=1-W,K=C+D*r.strides[2],ee=C+L*r.strides[2],ce=k+D*r.strides[2],he=k+L*r.strides[2],Oe=I*G,Te=I*W,Re=T*G,me=T*W,P=0;P<l;P++){var F=y[b++];h[K+P]+=F*Oe,h[ee+P]+=F*Te,h[ce+P]+=F*Re,h[he+P]+=F*me}return Of(h,[o,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,a){ke(n,"resizeNearestNeighbor");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*i*c),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=h[0]/p[0],m=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=g*x,S=b+Math.min(u-1,a?Math.round(w):Math.floor(w))*n.strides[1],A=0;A<i;A++)for(var _=m*A,E=S+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],C=0;C<c;C++){var k=f[E+C];d[v++]=k}return Mr(d,[s,r,i,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){ke([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=this.readSync(n.dataId),g=[i&&f>1?s-1:s,i&&d>1?u-1:u],m=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,A=0;A<o;A++)for(var _=A*r.strides[0],E=0;E<s;E++)for(var C=_+E*r.strides[1],k=Math.floor(E*b),T=Math.floor(k-w/2),I=0;I<u;I++)for(var N=C+I*r.strides[2],O=Math.floor(I*x),D=Math.floor(O-S/2),L=0;L<l;L++){for(var W=0,G=0;G<w;G++){var K=G+T;if(!(K<0||K>=f)){var ee=_+K*n.strides[1],ce=K*v;if(E===Math.min(s-1,i?Math.round(ce):Math.floor(ce)))for(var he=0;he<S;he++){var Oe=he+D;if(!(Oe<0||Oe>=d)){var Te=ee+Oe*n.strides[2],Re=Oe*y;I===Math.min(u-1,i?Math.round(Re):Math.floor(Re))&&(W+=p[Te+L])}}}}h[N+L]=W}return Of(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){ke([n,r,i,o,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,g=f.length,m=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)h[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+a),y>=p&&(y=0),b>=v&&(b=0),x>=g&&(x=0),w>=m&&(w=0);return Of(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){ke(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(m){for(var v=m%s,y=m-v+Math.max(0,v-r),b=m-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var h=0;h<c;h++){var p=d(h),g=l[h]*Math.pow(i+a*p,-o);f[h]=g}return Of(f,n.shape)},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){ke(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,g=0;g<p;g++){for(var m=g%l,v=g-m+Math.max(0,m-a),y=g-m+Math.min(l,m+a+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+o,x=v;x<y;x++){var w=-2*s*u*f[x]*d[g]/b;g===x&&(w+=Math.pow(b,-u)),w*=c[g],h[x]+=w}}return Of(h,n.shape)},t.prototype.multinomial=function(n,r,i,a){ke(n,"multinomial");for(var o=r?n:Ph(n),s=o.shape[0],u=o.shape[1],l=Tn([s,i],"int32"),c=this.readSync(l.dataId),f=this.readSync(o.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var g=1;g<p.length;++g)p[g]=p[g-1]+f[h+g];for(var m=aE(a.toString()),v=d*i,y=0;y<i;++y){var b=m();c[v+y]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,i,a){ke(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(o[u*r+s[u]]=i);return Wu(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return ke(n,"nonMaxSuppression"),dM(this.readSync(n.dataId),this.readSync(r.dataId),i,a,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],a=n.shape[1],o=Ot(n.shape,"float32"),s=Ot(n.shape,"float32"),u=to(n).as2D(i,a),l=os(n).as2D(i,a),c=0;c<i;c++)for(var f=u.slice([c,0],[1,a]),d=l.slice([c,0],[1,a]),h=ii(f,d),p=this.readSync(this.fftImpl(h,r).dataId),g=0;g<a;g++){var m=CY(p,g);o.values[c*a+g]=m.real,s.values[c*a+g]=m.imag}return ii(o.toTensor(),s.toTensor()).as2D(i,a)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),a=i.size;if(this.isExponentOf2(a)){var o=this.fftRadix2(i,a,r).as2D(n.shape[0],n.shape[1]);return r&&(o=ii(to(o).div(Ve(a)),os(o).div(Ve(a)))),o}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,a,r));return ii(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var a=this.readSync(n.dataId),o=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),u=ii(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),c=ii(l.real,l.imag).as1D();u=this.fftRadix2(u,o,i),c=this.fftRadix2(c,o,i);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,i),d=ii(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),g=to(h).concat(to(p)),m=os(h).concat(os(p));return ii(g,m).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var a=new Float32Array(2*r),o=0;o<r;o++){for(var s=0,u=0,l=0;l<r;l++){var c=_Pe(o*l,r,i),f=CY(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}i&&(s/=r,u/=r),wPe(a,s,u,o)}return a},t.prototype.depthToSpace=function(n,r,i){U(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],o=n.shape[1],s=n.shape[2],u=n.shape[3],l=o*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(a*l*c*f),p=0,g=0;g<a;++g)for(var m=0;m<l;++m)for(var v=Math.floor(m/r),y=m%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var A=S+w+u*(x+s*(v+o*g));h[p++]=d[A]}return Of(h,[a,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,i,a){var o=Qt(n.shape,r.shape),s=Ot(o,i),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=sc(n.shape,o),f=sc(r.shape,o),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),g=this.bufferSync(r),m=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(A){return b[A]=0});var x=p.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(A){return w[A]=0});var S=g.locToIndex(w);d[v]=a(u[x],l[S])};for(h=0;h<d.length;++h)m(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var a=Qt(n.shape,r.shape),o=Ot(a,"float32"),s=Ot(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=sc(n.shape,a),f=sc(r.shape,a),d=o.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var g=p%u.length,m=p%l.length,v=i(u[2*g],u[2*g+1],l[2*m],l[2*m+1]);d[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=o.indexToLoc(w),A=S.slice(-n.rank);c.forEach(function(T){return A[T]=0});var _=y.locToIndex(A),E=S.slice(-r.rank);f.forEach(function(T){return E[T]=0});var C=b.locToIndex(E),k=i(u[2*_],u[2*_+1],l[2*C],l[2*C+1]);d[w]=k.real,h[w]=k.imag};for(p=0;p<d.length;p++)x(p)}return this.complex(o.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return OY(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,a,o,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=a[0],g=a[1],m=Ot([h,p,g,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),x=n.strides,w=m.strides,S=0;S<h;S++){var A=4*S,_=v[A],E=v[A+1],C=v[A+2],k=v[A+3],T=y[S];if(!(T>=l))for(var I=p>1?(C-_)*(c-1)/(p-1):0,N=g>1?(k-E)*(f-1)/(g-1):0,O=0;O<p;O++){var D=p>1?_*(c-1)+O*I:.5*(_+C)*(c-1);if(D<0||D>c-1)for(var L=0;L<g;L++)for(var W=0;W<d;W++){var G=W+L*w[2]+O*w[1]+S*w[0];m.values[G]=s}else if(o==="bilinear"){var K=Math.floor(D),ee=Math.ceil(D),ce=D-K;for(L=0;L<g;L++)if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var he=Math.floor(ae),Oe=Math.ceil(ae),Te=ae-he;for(W=0;W<d;W++){var Re=b[G=W+he*x[2]+K*x[1]+T*x[0]],me=b[G=W+Oe*x[2]+K*x[1]+T*x[0]],P=b[G=W+he*x[2]+ee*x[1]+T*x[0]],F=Re+(me-Re)*Te,V=P+(b[G=W+Oe*x[2]+ee*x[1]+T*x[0]]-P)*Te;G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=F+(V-F)*ce}}}else for(L=0;L<g;++L){var ae;if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var Y=Math.round(ae),M=Math.round(D);for(W=0;W<d;W++){var B=W+Y*x[2]+M*x[1]+T*x[0],R=W+L*w[2]+O*w[1]+S*w[0];m.values[R]=b[B]}}}}}return m.toTensor()},t.prototype.sparseToDense=function(n,r,i,a){var o=mb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(n,r,i,f,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=eM(n,r),s=o[0],u=o[1],l=o[2],c=o[3];if(u===0)return Mr([],s,n.dtype);for(var f=new Cm([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var g=[],m=0,v=0;v<a;v++){var y=d[p*a+v];m+=y*c[v],g.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[p*l+b]=h[m*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var a=mb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=Ve(0);return this.scatter(n,r,i,c,u,s,o,l,f,!0)},t.prototype.fill=function(n,r,i){var a=Yy(i=i||Em(r),et(n));return a.fill(r),J.makeTensor(a,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Yy(n.dtype,et(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return cM(n,r,i)},t.prototype.scatter=function(n,r,i,a,o,s,u,l,c,f){var d=[a/o,o],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return Mr([],i,r.dtype);var g=new Cm(d,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var v=[],y=0,b=0;b<u;b++){var x=h[m*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=a/o)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var w=0;w<o;w++)f?g.values[y*o+w]+=p[m*o+w]:g.values[y*o+w]=r.rank===0?p[0]:p[m*o+w]}return g.toTensor().reshape(i)},t}(oM);function AJ(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;ke([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,f=t(o.shape,s.shape,l,c,o.dtype),d=f[0],h=f[1];return{dataId:u.write(d,h,o.dtype),shape:h,dtype:o.dtype}}}}function CJ(e){return function(t,n,r,i,a){var o=Qt(t,n),s=o.length,u=Qa(o),l=Rh(a,et(o)),c=t.length,f=n.length,d=Qa(t),h=Qa(n),p=sc(t,o),g=sc(n,o);if(p.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],i[m%i.length]);else{var v=function(y){var b=r3(y,s,u),x=b.slice(-c);p.forEach(function(_){return x[_]=0});var w=_S(x,c,d),S=b.slice(-f);g.forEach(function(_){return S[_]=0});var A=_S(S,f,h);l[y]=e(r[w],i[A])};for(m=0;m<l.length;++m)v(m)}return[l,o]}}J.registerBackend("cpu",function(){return new PLe},1);var $Le=CJ(function(e,t){return e/t}),LLe=AJ(db,$Le),BLe={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;ke(i,"MaxPoolWithArgmax");var f=c.data.get(i.dataId).values,d=Rf(i.shape,o,s,[1,1],u),h=function(y,b,x,w,S){var A=iP(y,0,x,Qa(b),S,"max"),_=EJ(y,b,x,S,!0,w);return[A.values,_.values]}(f,i.shape,i.dtype,l,d),p=h[0],g=h[1],m=c.write(p,d.outShape,i.dtype),v=c.write(g,d.outShape,i.dtype);return[{dataId:m,shape:d.outShape,dtype:i.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}},zLe={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;ke(a,"NonMaxSuppressionWithScore");var h=hM(d.data.get(a.dataId).values,d.data.get(o.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},jLe={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;ke(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},ULe=CJ(function(e,t){var n=e-t;return n*n});function kJ(e,t,n,r,i){for(var a=et(t),o=t.length,s=Qa(t),u=Qa(i),l=Rh(n,et(i)),c=0;c<a;++c){for(var f=r3(c,o,s),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];l[_S(d,o,u)]=e[c]}return l}for(var oP=0,TJ=[zLe,jLe,AJ(hb,ULe),LLe,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n.perm,o=r;ke(i,"transpose");for(var s=i.shape.length,u=new Array(s),l=0;l<u.length;l++)u[l]=i.shape[a[l]];var c=kJ(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(c,u,i.dtype),shape:u,dtype:i.dtype}}},BLe];oP<TJ.length;oP++)KF(TJ[oP]);for(var Wm,WLe=function(e){this.variableNames=["A"];var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},VLe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `},qLe=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Jn(this.rank),a=function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<o.length;c++)l[o[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},HLe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Jn(this.rank),a=DY("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},sP=0,OJ=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,a=r.numChannels,o=typeof HTMLVideoElement!="undefined"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],f=[c,l],d=[c,l,a];(s||o)&&(Wm==null&&(Wm=document.createElement("canvas").getContext("2d")),Wm.canvas.width=l,Wm.canvas.height=c,Wm.drawImage(i,0,0,l,c),i=Wm.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=Oo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=pe().getBool("WEBGL_PACK")?new VLe(d):new WLe(d),g=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:db,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(i,a,o){var s=new kr(UPe,i.shape,a.shape);return pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(s=new Hu(WPe,i.shape,a.shape,!0)),o.runWebGLProgram(s,[i,a],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;RS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=hM(d.readSync(a.dataId),d.readSync(o.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,a=new Mt(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:hb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,a=r.b,o=n,s=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Hu("return (a - b) * (a - b);",i.shape,a.shape):new kr("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,i=e.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=a.shape[o[c]];if(s.shouldExecuteOnCPU([a])){var f=kJ(s.texData.get(a.dataId).values,a.shape,a.dtype,o,l);t=s.makeTensorInfo(l,a.dtype),s.texData.get(t.dataId).values=f}else t=function(d,h,p){var g=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HLe(d.shape,h):new qLe(d.shape,h);return p.runWebGLProgram(g,[d],d.dtype)}(a,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;U(i.shape.length===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."});var f=[1,1];U(Gi(s,f),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"});var d=Rf(i.shape,o,s,f,u),h=function(p,g,m,v){var y=new _b(m,"max",!1),b=v.runWebGLProgram(y,[p],"float32");return y=new _b(m,"max",!0,!0,g),[b,v.runWebGLProgram(y,[p],"float32")]}(i,l,d,c);return[h[0],h[1]]}}];sP<OJ.length;sP++)KF(OJ[sP]);for(var uP=0,IJ=[{kernelName:k3,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=e,o=qr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var a=e,o=qr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach(function(r,i){n[i]=function(){return e.clone()}}),n}},{kernelName:T3,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(i[s]!==1)throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:db,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=Cr(e,r.toFloat()),o=qr(n.shape,i);return o.length>0?Hr(a,o).reshape(n.shape):a},b:function(){var a=e.mul(n.toFloat()),o=qr(r.shape,i);o.length>0&&(a=Hr(a,o).reshape(r.shape));var s=dE(r);return Df(Cr(a,s.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,i=t[0],a=t[1],o=t[2],s=t[3],u=EZ(i),l=s??Ve(1),c=qr(a.shape,u.shape),f=[];if(a.rank===1){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var h=Ar(i,a),p=rt(e,l),g=WS(Ut(o,Ve(r))),m=rt(rt(rt(g,g),g),Ve(-.5));return{x:function(){return a.rank===1?qs(rt(rt(e,lc(g.as4D(1,1,1,a.shape[0]),f)),l),i.shape):qs(rt(rt(e,g),l),i.shape)},mean:function(){var v=rt(rt(g,Ve(-1)),p);return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)},variance:function(){var v=rt(rt(m,h),p);return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)},scale:function(){var v=rt(h,g),y=rt(e,v);return a.rank===1&&(y=Hr(y,c)),qs(y,a.shape)},offset:function(){var v=e;return a.rank===1&&(v=Hr(v,c)),qs(v,a.shape)}}}},{kernelName:I3,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:O3,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Tn(n.shape,"float32")}}}},{kernelName:D3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map(function(a){return a[0]});return{x:function(){return e.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:hb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Ve(2);return{a:function(){return rt(e,rt(i,Ar(n,r)))},b:function(){return rt(e,rt(i,Ar(r,n)))}}}},{kernelName:N3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.reps;return{x:function(){var a=en(r);if(r.rank===1)for(var o=0;o<i[0];++o)a=a.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(o=0;o<i[0];++o)for(var s=0;s<i[1];++s)a=a.add(e.slice([o*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(var u=0;u<i[2];++u)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(r.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(u=0;u<i[2];++u)for(var l=0;l<i[3];++l)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2],l*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return a}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=FS(n.perm);return{x:function(){return cn(e,r)}}}}];uP<IJ.length;uP++)uX(IJ[uP]);var GLe=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();pe().get("IS_BROWSER")&&pe().setPlatform("browser",new GLe);var lP,KLe=function(){return require("node-fetch")},XLe=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return pe().global.fetch!=null?pe().global.fetch(t,n):(lP==null&&(lP=KLe()),lP(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();pe().get("IS_NODE")&&pe().setPlatform("node",new XLe);var cP={float32:4,int32:4,uint16:2,uint8:1,bool:1},RE=4;function NJ(e,t){for(var n={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,f=et(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=cP[h.dtype],g=e.slice(r,r+f*p),m=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")d=Float32Array.from(m,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(m,function(S){return Math.round(S*h.scale+h.min)})}r+=f*p}else if(l==="string"){var v=et(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+RE))[0];r+=RE;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=cP[l];if(g=e.slice(r,r+f*w),l==="float32")d=new Float32Array(g);else if(l==="int32")d=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(g)}r+=f*w}n[u]=Mr(d,c,l)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function YLe(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var fP=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function DJ(e){return fP?Buffer.byteLength(e):new Blob([e]).size}function dP(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function RJ(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Fb(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:DJ(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:DJ(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Mo=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var o=a(t,r);o!==null&&i.push(o)}),i},e}(),Vm="://",Bf=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){U(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Vm)&&(t=t.slice(0,t.indexOf(Vm))),U(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();U(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function FE(e){if(e.indexOf(Vm)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Bf.getSchemes().join(","));return{scheme:e.split(Vm)[0],path:e.split(Vm)[1]}}function FJ(e,t,n){return n===void 0&&(n=!1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return U(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),U((r=Mo.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),U(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],U((a=Mo.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),U(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=a[0],s=FE(e).scheme,u=FE(e).path,l=s===FE(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,Bf.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,Bf.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Gh="models_store",zf="model_info_store";function MJ(){if(!pe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function hP(e){var t=e.result;t.createObjectStore(Gh,{keyPath:"modelPath"}),t.createObjectStore(zf,{keyPath:"modelPath"})}var qm=function(){function e(t){if(this.indexedDB=MJ(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,a){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return hP(o)},o.onsuccess=function(){var s=o.result;if(n==null){var u=s.transaction(Gh,"readonly"),l=u.objectStore(Gh).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=Fb(n),d=s.transaction(zf,"readwrite"),h=d.objectStore(zf),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var g=(c=s.transaction(Gh,"readwrite")).objectStore(Gh).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});g.onsuccess=function(){return i({modelArtifactsInfo:f})},g.onerror=function(m){var v=(h=d.objectStore(zf)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(g.error)},v.onerror=function(y){return s.close(),a(g.error)}}},p.onerror=function(g){return s.close(),a(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return a(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),PJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(qm.URL_SCHEME)?(t=e.slice(qm.URL_SCHEME.length),new qm(t)):null;var t};Mo.registerSaveRouter(PJ),Mo.registerLoadRouter(PJ);var ZLe=function(){function e(){this.indexedDB=MJ()}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t=this;return nt(this,function(n){return[2,new Promise(function(r,i){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return hP(a)},a.onsuccess=function(){var o=a.result,s=o.transaction(zf,"readonly"),u=s.objectStore(zf).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return o.close(),i(u.error)},s.oncomplete=function(){return o.close()}},a.onerror=function(o){return i(a.error)}})]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){var i;return t=(i=t).startsWith(qm.URL_SCHEME)?i.slice(qm.URL_SCHEME.length):i,[2,new Promise(function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return hP(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(zf,"readwrite"),f=c.objectStore(zf),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var g=(u=l.transaction(Gh,"readwrite")).objectStore(Gh).delete(t);g.onsuccess=function(){return a(d.result.modelArtifactsInfo)},g.onerror=function(m){return o(d.error)}};h.onsuccess=p,h.onerror=function(g){return p(),l.close(),o(d.error)}},d.onerror=function(h){return l.close(),o(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}})]})})},e}();if(pe().getBool("IS_BROWSER"))try{Bf.registerManager(qm.URL_SCHEME,new ZLe)}catch(e){}var fc="/",Hm="tensorflowjs_models",$J="info",JLe="model_topology",QLe="weight_specs",e4e="weight_data",t4e="model_metadata";function LJ(e){return{info:[Hm,e,$J].join(fc),topology:[Hm,e,JLe].join(fc),weightSpecs:[Hm,e,QLe].join(fc),weightData:[Hm,e,e4e].join(fc),modelMetadata:[Hm,e,t4e].join(fc)}}function n4e(e){var t=e.split(fc);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(fc)}var Gm=function(){function e(t){if(!pe().getBool("IS_BROWSER")||typeof window=="undefined"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=LJ(this.modelPath)}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Fb(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(fP)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return nt(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(fP){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),BJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Gm.URL_SCHEME)?(t=e.slice(Gm.URL_SCHEME.length),new Gm(t)):null;var t};Mo.registerSaveRouter(BJ),Mo.registerLoadRouter(BJ);var r4e=function(){function e(){U(pe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),U(typeof window=="undefined"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o;return nt(this,function(s){for(t={},n=Hm+fc,r=fc+$J,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(o=n4e(a),t[o]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){var a;if(t=(a=t).startsWith(Gm.URL_SCHEME)?a.slice(Gm.URL_SCHEME.length):a,n=LJ(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(pe().getBool("IS_BROWSER"))try{Bf.registerManager(Gm.URL_SCHEME,new r4e)}catch(e){}var i4e="model",a4e=".json",o4e=".weights.bin";function zJ(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var pP=function(){function e(t){if(!pe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=i4e),this.modelTopologyFileName=t+a4e,this.weightDataFileName=t+o4e}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s;return nt(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=a,[4,zJ(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,zJ(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Fb(t)}]}})})},e.URL_SCHEME="downloads://",e}(),s4e=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r=this;return nt(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(m){return void o(m)}var h=[],p=[],g=[];f.forEach(function(m){m.paths.forEach(function(v){p.push(v),g.push(null)}),h.push.apply(h,m.weights)}),f.forEach(function(m){m.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=p.indexOf(v);g[w]=x,g.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:dP(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return RJ(u.name)}),a={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(u){var l=RJ(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[i.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function jJ(e,t,n,r){(function(a){U(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,o){U(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),U(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),U(o>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+o})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(a){return a.then(function(o){var s=n+ ++i/e.length*(r-n);return t(s),o}),a}))}function UJ(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return nt(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?pe().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),i=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,jJ(r,t.onProgress,i,a)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,jJ(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function WJ(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),tt(t,void 0,void 0,function(){var a,o,s,u,l,c,f,d,h,p;return nt(this,function(g){switch(g.label){case 0:if(a=n.map(function(){return!1}),o={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(m,v){var y=0;m.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=cP[x]*et(b.shape),S=function(){a[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};i!=null?i.forEach(function(A,_){A===b.name&&(S(),s[_]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(m){return m}))throw l=i.filter(function(m,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(m,v,y){return v&&m.push(y),m},[]),f=[],c.forEach(function(m){n[m].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=g.sent(),h={},p=0,c.forEach(function(m){for(var v=n[m].paths.length,y=0,b=0;b<v;b++)y+=d[p+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,A=0;A<v;A++){var _=new Uint8Array(d[p+A]);w.set(_,S),S+=_.byteLength}o[m].forEach(function(E){var C=NJ(x.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var k in C)h[k]=C[k]}),p+=v}),[2,h]}})})}}Mo.registerSaveRouter(function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(pP.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new pP(t)}(e.slice(pP.URL_SCHEME.length)):null});var VJ=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=pe().platform.fetch,U(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&U(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a;return nt(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:Fb(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,i==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var g=p.lastIndexOf("/"),m=p.lastIndexOf("?"),v=p.substring(0,g),y=m>g?p.substring(m):"";return[v+"/",y]}(n),i=r[0],a=r[1],o=this.weightPathPrefix||i,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(g){f.push(o+g+a)})}),[4,UJ(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,dP(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function gP(e){return e.match(VJ.URL_SCHEME_REGEX)!=null}var qJ=function(e,t){return typeof fetch=="undefined"?null:(Array.isArray(e)?e.every(function(n){return gP(n)}):gP(e))?mP(e,{onProgress:t}):null};function mP(e,t){return new VJ(e,t)}Mo.registerSaveRouter(qJ),Mo.registerLoadRouter(qJ);var vP=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.modelArtifacts]})})},e}(),u4e=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,this.saveHandler(t)]})})},e}(),wa=Object.freeze({browserFiles:function(e){return new s4e(e)},browserHTTPRequest:function(e,t){return mP(e,t)},concatenateArrayBuffers:dP,decodeWeights:NJ,encodeWeights:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s=this;return nt(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=i[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return tt(s,void 0,void 0,function(){var g,m,v,y,b,x,w;return nt(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(g=S.sent(),m=g.reduce(function(A,_){return A+_.length},0)+RE*g.length,v=new Uint8Array(m),y=0,b=0;b<g.length;b++)x=g[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=RE,v.set(x,y),y+=x.length;return p(v),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:YLe(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new vP(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vP({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vP({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Mo.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Fb,getSaveHandlers:function(e){return Mo.getSaveHandlers(e)},http:mP,isHTTPScheme:gP,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),tt(this,void 0,void 0,function(){return nt(this,function(i){return[2,WJ(function(a){return UJ(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Mo.registerLoadRouter(e)},registerSaveRouter:function(e){return Mo.registerSaveRouter(e)},weightsLoaderFactory:WJ,withSaveHandler:function(e){return new u4e(e)},copyModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,FJ(e,t,!1)]})})},listModels:function(){return tt(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return nt(this,function(s){switch(s.label){case 0:e=Bf.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,Bf.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+Vm+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,FJ(e,t,!0)]})})},removeModel:function(e){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){return t=FE(e),[2,Bf.getManager(t.scheme).removeModel(t.path)]})})}}),Km,l4e=Q({confusionMatrix_:function(e,t,n){var r=j(e,"labels","confusionMatrix"),i=j(t,"predictions","confusionMatrix");U(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),U(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),U(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),U(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),U(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=Wh(r.asType("int32"),n),o=Wh(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),c4e=Object.freeze({confusionMatrix:l4e}),f4e=Q({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement!="undefined"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(qF("FromPixels",J.backendName)!=null)return J.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(o?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(a||i)&&(Km==null&&(Km=document.createElement("canvas").getContext("2d")),Km.canvas.width=c,Km.canvas.height=f,Km.drawImage(e,0,0,c,f),s=Km.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return MS(u,[f,c,t],"int32")}}),HJ=Object.freeze({toPixels:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_;return nt(this,function(E){switch(E.label){case 0:if(n=j(e,"img","toPixels"),e instanceof Ht||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=E.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=E.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(g=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(a*i*4),v=0;v<i*a;++v)y=void 0,b=void 0,x=void 0,w=void 0,o===1?(y=s[v]*g,b=s[v]*g,x=s[v]*g,w=255):o===3?(y=s[3*v]*g,b=s[3*v+1]*g,x=s[3*v+2]*g,w=255):o===4&&(y=s[4*v]*g,b=s[4*v+1]*g,x=s[4*v+2]*g,w=s[4*v+3]*g),m[(S=4*v)+0]=Math.round(y),m[S+1]=Math.round(b),m[S+2]=Math.round(x),m[S+3]=Math.round(w);return t!=null&&(t.width=a,t.height=i,A=t.getContext("2d"),_=new ImageData(m,a,i),A.putImageData(_,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:f4e}),GJ=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),KJ=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function jf(e){U(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),U(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),U(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),KJ.register(e)}var Ne=Object.freeze({Serializable:GJ,SerializationMap:KJ,registerClass:jf}),d4e="1.7.4",h4e=Object.freeze({gpgpu_util:v$e,webgl_util:VMe,forceHalfFloat:function(){pe().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:SZ,setWebGLContext:CX,GPGPUContext:oZ}),dc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return js(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var a=this.computeGradients(n,i),o=a.value,s=a.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return jt(s),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return AY(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&jt(this.iterations_)},t.prototype.saveIterations=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ve(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(GJ);Object.defineProperty(dc,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var yP=function(e){function t(n,r,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],i==null&&(a.epsilon=J.backend.epsilon()),a}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accum_grad",variable:ue(function(){return en(o).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:i+"/accum_var",variable:ue(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;ue(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(o);o.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(jt(this.accumulatedGrads.map(function(n){return n.variable})),jt(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(dc);jf(yP);var bP=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accumulator",variable:ue(function(){return km(o.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable;ue(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(J.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&jt(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(dc);jf(bP);var xP=function(e){function t(n,r,i,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=i,o.epsilon=a,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],ue(function(){o.accBeta1=Ve(r).variable(),o.accBeta2=Ve(i).variable()}),a==null&&(o.epsilon=J.backend.epsilon()),o}return js(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ue(function(){var a=Ar(1,r.accBeta1),o=Ar(1,r.accBeta2);i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ue(function(){return en(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ue(function(){return en(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(a),m=p.div(o);f.assign(h),d.assign(p);var v=g.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&jt(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&jt(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r,i=this;return nt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),ue(function(){i.accBeta1.assign(Im(i.beta1,i.iterations_+1)),i.accBeta2.assign(Im(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(dc);jf(xP);var wP=function(e){function t(n,r,i,a,o){a===void 0&&(a=null),o===void 0&&(o=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=a,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ue(function(){s.iteration=Ve(0).variable(),s.accBeta1=Ve(r).variable()}),a==null&&(s.epsilon=J.backend.epsilon()),s}return js(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);ue(function(){var a=Ar(1,r.accBeta1),o=Cr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:en(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:en(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),g=c.abs(),m=p.maximum(g);f.assign(h),d.assign(m);var v=o.div(a).mul(h.div(m.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&jt(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&jt(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(dc);jf(wP);var ME=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=Array.isArray(n)?n[a].tensor:n[i];if(o!=null){var s=J.registeredVariables[i];ue(function(){var u=r.c.mul(o).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=ju(Ve(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(dc);jf(ME);var _P=function(e){function t(n,r,i){i===void 0&&(i=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Ve(a.momentum),a}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulations[a]==null&&(r.accumulations[a]={originalName:i+"/momentum",variable:ue(function(){return en(o).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[i];u!=null&&ue(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),s.assign(c),o.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&jt(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(ME);jf(_P);var SP=function(e){function t(n,r,i,a,o){r===void 0&&(r=.9),i===void 0&&(i=0),a===void 0&&(a=null),o===void 0&&(o=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,a==null&&(s.epsilon=J.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return js(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:i+"/rms",variable:ue(function(){return en(o).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:i+"/momentum",variable:ue(function(){return en(o).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:i+"/mg",variable:ue(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;ue(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[a].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=o.sub(h);o.assign(p)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(h),p=o.sub(h),o.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&jt(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&jt(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&jt(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(dc);jf(SP);var Kh=function(){function e(){}return e.sgd=function(t){return new ME(t)},e.momentum=function(t,n,r){return r===void 0&&(r=!1),new _P(t,n,r)},e.rmsprop=function(t,n,r,i,a){return n===void 0&&(n=.9),r===void 0&&(r=0),i===void 0&&(i=null),a===void 0&&(a=!1),new SP(t,n,r,i,a)},e.adam=function(t,n,r,i){return t===void 0&&(t=.001),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new xP(t,n,r,i)},e.adadelta=function(t,n,r){return t===void 0&&(t=.001),n===void 0&&(n=.95),r===void 0&&(r=null),new yP(t,n,r)},e.adamax=function(t,n,r,i,a){return t===void 0&&(t=.002),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),a===void 0&&(a=0),new wP(t,n,r,i,a)},e.adagrad=function(t,n){return n===void 0&&(n=.1),new bP(t,n)},e}(),Uf={sgd:Kh.sgd,momentum:Kh.momentum,adadelta:Kh.adadelta,adagrad:Kh.adagrad,rmsprop:Kh.rmsprop,adamax:Kh.adamax,adam:Kh.adam},p4e=typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(e){return e()};function PE(){return new Promise(function(e){return p4e(function(){return e()})})}Ht.prototype.add=function(e){return Ut(this,e)},Ht.prototype.broadcastTo=function(e){return kM(this,e)},Ht.prototype.div=function(e){return Cr(this,e)},Ht.prototype.divNoNan=function(e){return cE(this,e)},Ht.prototype.squaredDifference=function(e){return hE(this,e)},Ht.prototype.tile=function(e){return lc(this,e)},Ht.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),Wh(this,e,t,n)},Ht.prototype.transpose=function(e){return cn(this,e)},Ht.prototype.pad=function(e,t){return Ku(this,e,t)},Ht.prototype.batchNorm=function(e,t,n,r,i){return Uh(this,e,t,n,r,i)},ye=MLe;var g4e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:yP,AdagradOptimizer:bP,AdamOptimizer:xP,AdamaxOptimizer:wP,Add:k3,AddN:oPe,BroadcastTo:T3,DataStorage:aM,Div:db,get ENV(){return VF},Environment:sX,FromPixels:fPe,FusedBatchNorm:sPe,Identity:I3,KernelBackend:oM,MaxPoolWithArgmax:dPe,MomentumOptimizer:_P,NonMaxSuppressionV5:cPe,OneHot:O3,Optimizer:dc,PadV2:D3,RMSPropOptimizer:SP,get Rank(){return a3},get Reduction(){return Ri},SGDOptimizer:ME,Square:uPe,SquaredDifference:hb,Tensor:Ht,TensorBuffer:Cm,Tile:N3,Transpose:lPe,Variable:tb,abs:Nf,acos:R3,acosh:F3,add:Ut,addN:SM,addStrict:dY,all:SE,any:Tb,argMax:Ob,argMin:UM,asin:M3,asinh:P3,atan:$3,atan2:J3,atanh:L3,avgPool:bE,avgPool3d:wE,backend:ZX,backend_util:xPe,basicLSTMCell:pJ,batchNorm:Uh,batchNorm2d:EM,batchNorm3d:AM,batchNorm4d:CM,batchNormalization:CZ,batchNormalization2d:TZ,batchNormalization3d:IZ,batchNormalization4d:DZ,batchToSpaceND:PS,booleanMaskAsync:YZ,broadcastTo:kM,browser:HJ,buffer:Ot,cast:$S,ceil:B3,clipByValue:xa,clone:RZ,complex:ii,concat:Hi,concat1d:w3,concat2d:_3,concat3d:S3,concat4d:E3,conv1d:pE,conv2d:Hh,conv2dTranspose:mE,conv3d:gE,conv3dTranspose:nJ,cos:z3,cosh:j3,cumsum:iY,customGrad:vb,deprecationWarn:NS,depthToSpace:A3,depthwiseConv2d:Bm,diag:yJ,disableDeprecationWarnings:GMe,dispose:jt,disposeVariables:KMe,div:Cr,divNoNan:cE,divStrict:hY,dot:rJ,dropout:YM,elu:jm,enableDebugMode:HMe,enableProdMode:qMe,engine:XMe,env:pe,equal:qh,equalStrict:UZ,erf:U3,exp:W3,expandDims:Ro,expm1:V3,eye:fE,fft:Db,fill:km,findBackend:nPe,findBackendFactory:rPe,floor:US,floorDiv:HS,frame:NE,fused:Lf,gather:Lm,gatherND:XM,gather_util:hPe,getBackend:ePe,getGradient:HF,getKernel:qF,getKernelsForBackend:GF,grad:mPe,grads:vPe,greater:Pm,greaterEqual:Ab,greaterEqualStrict:WZ,greaterStrict:VZ,hammingWindow:ZM,hannWindow:IE,ifft:Um,imag:os,image:$f,inTopKAsync:wJ,io:wa,irfft:TE,isFinite:cY,isInf:lY,isNaN:uY,keep:ju,leakyRelu:CE,less:MM,lessEqual:PM,lessEqualStrict:qZ,lessStrict:HZ,linalg:QM,linspace:x3,localResponseNormalization:VM,log:uc,log1p:q3,logSigmoid:sY,logSoftmax:ZS,logSumExp:hJ,logicalAnd:Gu,logicalNot:TM,logicalOr:uE,logicalXor:FZ,losses:_J,matMul:vE,math:c4e,max:Mf,maxPool:yE,maxPool3d:xE,maxPoolWithArgmax:jM,maximum:qu,maximumStrict:pY,mean:Pr,memory:DS,min:EE,minimum:Om,minimumStrict:gY,mod:Q3,modStrict:mY,moments:Ib,movingAverage:mJ,mul:rt,mulStrict:GS,multiRNNCell:gJ,multinomial:OM,neg:Df,nextFrame:PE,norm:qM,notEqual:$m,notEqualStrict:GZ,oneHot:Wh,ones:Vu,onesLike:Do,op:Q,outerProduct:iJ,pad:Ku,pad1d:MZ,pad2d:PZ,pad3d:$Z,pad4d:LZ,pool:fJ,pow:Im,powStrict:vY,prelu:Nb,print:rY,prod:AE,profile:YMe,rand:BZ,randomGamma:jZ,randomNormal:FM,randomUniform:Vh,range:Tm,ready:QMe,real:to,reciprocal:H3,registerBackend:iPe,registerGradient:uX,registerKernel:KF,relu:Pf,relu6:WM,removeBackend:tPe,reshape:qs,reverse:Xu,reverse1d:aJ,reverse2d:oJ,reverse3d:sJ,reverse4d:uJ,rfft:Rb,round:G3,rsqrt:WS,scalar:Ve,scatterND:KM,scatter_util:pPe,selu:kE,separableConv2d:zM,serialization:Ne,setBackend:JMe,setPlatform:aPe,setdiff1dAsync:C3,sigmoid:VS,sign:K3,signal:xJ,sin:X3,sinh:Y3,slice:Fo,slice1d:Cb,slice2d:_E,slice3d:kb,slice4d:zm,slice_util:gPe,softmax:Ph,softplus:pb,spaceToBatchND:LS,sparseToDense:OE,spectral:vJ,split:oc,sqrt:gb,square:dE,squaredDifference:hE,squaredDifferenceStrict:yY,squeeze:fb,stack:ss,step:fY,stft:JM,stridedSlice:HM,sub:Ar,subStrict:bY,sum:Hr,sumOutType:SS,tan:Z3,tanh:qS,tensor:Mr,tensor1d:ba,tensor2d:Wu,tensor3d:MS,tensor4d:Of,tensor5d:tY,tensor6d:nY,tensor_util:Bu,test_util:fLe,tidy:ue,tile:lc,time:ZMe,topk:GM,train:Uf,transpose:cn,truncatedNormal:Eb,unregisterGradient:MMe,unregisterKernel:FMe,unsortedSegmentSum:$M,unstack:If,util:pt,valueAndGrad:yPe,valueAndGrads:bPe,variable:b3,variableGrads:AY,version_core:d4e,webgl:h4e,where:Gs,whereAsync:lE,zeros:Tn,zerosLike:en});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var XJ=function(e,t){return(XJ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ee(e,t){function n(){this.constructor=e}XJ(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var EP,Mb=function(){return(Mb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Ct(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function St(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Gr(){return EP==null&&(EP=ZX().epsilon()),EP}function Ks(){return"channelsLast"}var Xh=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),Yu=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),ie=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),Pt=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),m4e=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error);(function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t})(Error);function Yh(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function Zu(e,t){if(!e)throw new m4e(t)}function YJ(e,t){for(var n=0,r=0,i=e;r<i.length;r++)i[r]===t&&n++;return n}function _a(e){return e.length===1?e[0]:e}function Qn(e){return Array.isArray(e)?e:[e]}function hc(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Zh(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,function(t,n){return n.toUpperCase()})}var us={};function AP(e){if(e==null)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function CP(e){if(e!=null&&typeof e=="object")if(Array.isArray(e))e.forEach(function(a){return CP(a)});else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?CP(i):e[r]=i.value)}}function Pb(e,t,n,r,i){var a,o,s;if(t===void 0&&(t={}),n===void 0&&(n={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof e=="string"){var u=e,l=void 0;if(u in n)l=n[u];else if(u in us)l=us[u];else if((l=t[u])==null)throw new ie("Unknown "+r+": "+e+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=e;if(c.className==null||c.config==null)throw new ie(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var f=c.className,d=void 0,h=void 0;if(f in n?(d=(a=n[f])[0],h=a[1]):f in us?(d=(o=us.className)[0],h=o[1]):f in t&&(d=(s=t[f])[0],h=s[1]),d==null)throw new ie("Unknown "+r+": "+f+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(h!=null){for(var p={},g=0,m=Object.keys(us);g<m.length;g++)p[S=m[g]]=us[S];for(var v=0,y=Object.keys(n);v<y.length;v++)p[S=y[v]]=n[S];c.config.customObjects=p;for(var b=Mb({},us),x=0,w=Object.keys(n);x<w.length;x++){var S=w[x];us[S]=n[S]}CP(c.config);var A=h(d,c.config,n,i);return us=Mb({},b),A}b=Mb({},us);for(var _=0,E=Object.keys(n);_<E.length;_++)S=E[_],us[S]=n[S];return A=new d(c.config),us=Mb({},b),A}function v4e(e,t){return e<t?-1:e>t?1:0}function $E(e,t){return-1*v4e(e,t)}function Wf(e){if(e==null)return e;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)===-1&&t.push(i)}return t}function y4e(e){if(e==null)throw new ie("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Xm(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new ie(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function kP(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=1/0),Zu(n>=0),Zu(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(function(i){return typeof i===t})}function Sa(e,t){Array.isArray(e)?(pt.assert(e.length>0,function(){return t+" is unexpectedly an empty array."}),e.forEach(function(n,r){return Sa(n,"element "+(r+1)+" of "+t)})):pt.assert(Number.isInteger(e)&&e>0,function(){return"Expected "+t+" to be a positive integer, but got "+ZJ(e)+"."})}function ZJ(e){return e===null?"null":Array.isArray(e)?"["+e.map(function(t){return ZJ(t)}).join(",")+"]":typeof e=="string"?'"'+e+'"':""+e}function b4e(e,t){var n,r=pt.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=pt.now();return o-r<t?n:(r=o,n=e.apply(void 0,i))}}function JJ(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}function TP(e,t){return ue(function(){return gb(Hr(GS(e,e),t,!0))})}var $b=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),QJ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return ue(function(){var i=TP(n,r.axis),a=xa(i,0,r.maxValue);return rt(n,Cr(a,Ut(Gr(),i)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}($b);Ne.registerClass(QJ);var eQ=function(e){function t(n){var r=e.call(this)||this;return r.defaultAxis=0,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return ue(function(){return Cr(n,Ut(Gr(),TP(n,r.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}($b);Ne.registerClass(eQ);var tQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Pf(n)},t.className="NonNeg",t}($b);Ne.registerClass(tQ);var nQ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=n.minValue!=null?n.minValue:r.defaultMinValue,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.rate=n.rate!=null?n.rate:r.defaultRate,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return ue(function(){var i=TP(n,r.axis),a=Ut(rt(r.rate,xa(i,r.minValue,r.maxValue)),rt(1-r.rate,i));return rt(n,Cr(a,Ut(Gr(),i)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}($b);Ne.registerClass(nQ);var rQ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ln(e){return AP(e)}function iQ(e,t){return t===void 0&&(t={}),Pb(e,Ne.SerializationMap.getMap().classNameMap,t,"constraint")}function Kr(e){return e==null?null:typeof e=="string"?iQ({className:e in rQ?rQ[e]:e,config:{}}):e instanceof $b?e:iQ(e)}function x4e(e){return new QJ(e)}function w4e(e){return new eQ(e)}function _4e(){return new tQ}function S4e(e){return new nQ(e)}Object.freeze({maxNorm:x4e,unitNorm:w4e,nonNeg:_4e,minMaxNorm:S4e});var E4e=["channelsFirst","channelsLast"],A4e=["valid","same","causal"],C4e=["max","avg"],k4e=["sum","mul","concat","ave"],Ym=new Map;function Xr(e){Xm(E4e,"DataFormat",e)}function ls(e){Xm(A4e,"PaddingMode",e)}function aQ(e){Xm(C4e,"PoolMode",e)}var Lb=[],oQ="/";function Jh(e,t){Lb.push(e);try{var n=t();return Lb.pop(),n}catch(r){throw Lb.pop(),r}}function T4e(){return Lb.length===0?"":Lb.join(oQ)+oQ}function sQ(e){if(!lQ(e))throw new Error("Not a valid tensor name: '"+e+"'");return T4e()+e}function uQ(e){if(!lQ(e))throw new Error("Not a valid tensor name: '"+e+"'");Ym.has(e)||Ym.set(e,0);var t=Ym.get(e);if(Ym.set(e,Ym.get(e)+1),t>0){var n=e+"_"+t;return Ym.set(n,1),n}return e}var O4e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function lQ(e){return!!e.match(O4e)}function I4e(e){return e===parseInt(e.toString(),10)}function Vf(e,t,n){t==null&&(t=0),n==null&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r}function cQ(e){return e=Array.isArray(e)?new Float32Array(e):e,ba(e)}function Zm(e){return EE(cQ(e)).dataSync()[0]}function qf(e){return Mf(cQ(e)).dataSync()[0]}function Xs(e,t){if(t<e)throw new ie("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function Bb(e,t){return e.asType(t)}function zb(e,t){t===void 0&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function N4e(e,t){return ue(function(){if(e.shape.length!==2)throw new ie("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return IP(zb(e,1),[1,t,1])})}function D4e(e){var t=[Vf(e.shape)];return e.reshape(t)}function R4e(e){if(e.rank<=1)throw new ie("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],Vf(e.shape,1)];return e.reshape(t)}function Qh(e,t,n){return ue(function(){switch(e.rank){case 1:return Cb(e,t,n);case 2:return _E(e,[t,0],[n,e.shape[1]]);case 3:return kb(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return zm(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Fo(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Fo(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ie("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}})}function OP(e,t,n){return ue(function(){switch(e.rank){case 1:return Cb(e,t,n);case 2:return _E(e,[0,t],[e.shape[0],n]);case 3:return kb(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return zm(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function LE(e,t,n,r){return ue(function(){switch(e.rank){case 1:return Cb(e,t,n);case 2:switch(r){case 1:return Qh(e,t,n);case 2:return OP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return Qh(e,t,n);case 2:return kb(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return OP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return Qh(e,t,n);case 2:return zm(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return zm(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return OP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function fQ(e,t){var n;return t===void 0&&(t=-1),t<0&&(t=(n=e[0].rank)!==0?n:0),t===e[0].rank&&(t=-1),Hi(e,t)}function dQ(e,t){switch(e.rank){case 1:return w3([e,t]);case 2:return _3([e,t],0);case 3:return S3([e,t],0);case 4:return E3([e,t],0);default:throw new ie("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function IP(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ie("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return lc(e,t)}function BE(e,t,n,r,i){return t===void 0&&(t=0),n===void 0&&(n=1),FM(e,t,n,r,i)}function pc(e,t,n,r){if(e.rank<2||t.rank<2)throw new Pt("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&e.shape.slice(-1)[0]!==(c=t.shape.slice(-2)[0]))throw new Pt("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(e.rank===2&&t.rank===2){var i=!1,a=!1;return Lf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?NP(e.rank,r,Ks()):null,activation:n})}var o=e.shape.slice(),s=o.pop();e=e.reshape([-1,s]);var u=t.shape.slice(),l=u.pop(),c=u.pop(),f=u.concat([l]),d=Array.from({length:t.rank},function(p,g){return g===0?t.rank-2:g<=t.rank-2?g-1:g});t=t.transpose(d).reshape([c,-1]);var h=o.concat(f);return i=!1,a=!1,Lf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?NP(e.rank,r,Ks()):null,activation:n}).reshape(h)}function hQ(e,t,n){return ue(function(){return t=Array.isArray(t)?ba(t,"int32"):t.toInt(),Lm(e,t,n)})}function jb(e){return GS(e,e)}function NP(e,t,n){var r=t.shape;if(t.rank!==1&&t.rank!==e)throw new ie("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(e===5){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new ie("Unsupported input rank by biasAdd: "+t.rank)}function gc(e,t,n){return ue(function(){return n==null&&(n=Ks()),Xr(n),e.add(NP(e.rank,t,n))})}function F4e(e,t){if(t===void 0&&(t=1),t!==1)throw new Pt("Support for alpha values other than 1 ("+t+") is not implemented yet.");return jm(e)}function M4e(e){return ue(function(){return Cr(e,Nf(e).add(1))})}function pQ(e,t,n,r){return ue(function(){return YM(e,t,n,r)})}function P4e(e){return ue(function(){var t=Ut(.5,rt(.2,e));return xa(t,0,1)})}function Jm(e,t,n){return n===void 0&&(n=!1),n?e():t()}var $4e=["fanIn","fanOut","fanAvg"],L4e=["normal","uniform","truncatedNormal"];function B4e(e){Xm($4e,"FanMode",e)}function z4e(e){Xm(L4e,"Distribution",e)}var Ys=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),gQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Tn(n,r)},t.className="Zeros",t}(Ys);Ne.registerClass(gQ);var DP=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Vu(n,r)},t.className="Ones",t}(Ys);Ne.registerClass(DP);var mQ=function(e){function t(n){var r=e.call(this)||this;if(typeof n!="object")throw new ie("Expected argument of type ConstantConfig but got "+n);if(n.value===void 0)throw new ie("config must have value set but got "+n);return r.value=n.value,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return ue(function(){return rt(Ve(i.value),Vu(n,r))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(Ys);Ne.registerClass(mQ);var vQ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=n.minval||r.DEFAULT_MINVAL,r.maxval=n.maxval||r.DEFAULT_MAXVAL,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){return Vh(n,this.minval,this.maxval,r)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(Ys);Ne.registerClass(vQ);var yQ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new Pt("randomNormal does not support dType "+r+".");return BE(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(Ys);Ne.registerClass(yQ);var bQ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new Pt("truncatedNormal does not support dType "+r+".");return Eb(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(Ys);Ne.registerClass(bQ);var xQ=function(e){function t(n){var r=e.call(this)||this;return r.gain=n.gain!=null?n.gain:1,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return ue(function(){if(n.length!==2||n[0]!==n[1])throw new ie("Identity matrix initializer can only be used for 2D square matrices.");return rt(i.gain,fE(n[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(Ys);function j4e(e,t){var n,r;if(t===void 0&&(t="channelsLast"),Xr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1)if(t==="channelsFirst"){var i=Vf(e,2);n=e[1]*i,r=e[0]*i}else t==="channelsLast"&&(i=Vf(e,0,e.length-2),n=e[e.length-2]*i,r=e[e.length-1]*i);else{var a=Vf(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}Ne.registerClass(xQ);var ro=function(e){function t(n){var r=e.call(this)||this;if(n.scale<0)throw new ie("scale must be a positive float. Got: "+n.scale);return r.scale=n.scale==null?1:n.scale,r.mode=n.mode==null?"fanIn":n.mode,B4e(r.mode),r.distribution=n.distribution==null?"normal":n.distribution,z4e(r.distribution),r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=j4e(n),a=i[0],o=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,a):this.mode==="fanOut"?s/=Math.max(1,o):s/=Math.max(1,(a+o)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new Pt(this.getClassName()+" does not support dType "+r+".");return Eb(n,0,u,r,this.seed)}var l=Math.sqrt(3*s);return Vh(n,-l,l,r)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(Ys);Ne.registerClass(ro);var RP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="GlorotUniform",t}(ro);Ne.registerClass(RP);var FP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="GlorotNormal",t}(ro);Ne.registerClass(FP);var MP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="HeNormal",t}(ro);Ne.registerClass(MP);var PP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="HeUniform",t}(ro);Ne.registerClass(PP);var $P=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="LeCunNormal",t}(ro);Ne.registerClass($P);var LP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return ro.className},t.className="LeCunNormal",t}(ro);Ne.registerClass(LP);var wQ=function(e){function t(n){var r=e.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=n.gain==null?r.DEFAULT_GAIN:n.gain,r.seed=n.seed,r.seed!=null)throw new Pt("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return ue(function(){if(n.length!==2)throw new Pt("The Orthogonal Initializer does not support non-2D shapes yet.");n[0]*n[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+n[0]*n[1]+") elements: Slowness may result.");var a=BE(n[0]>n[1]?[n[1],n[0]]:n,0,1,"float32"),o=QM.gramSchmidt(a);return n[0]>n[1]&&(o=o.transpose()),rt(i.gain,o)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(Ys);Ne.registerClass(wQ);var _Q={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function SQ(e,t){return t===void 0&&(t={}),Pb(e,Ne.SerializationMap.getMap().classNameMap,t,"initializer")}function vn(e){return AP(e)}function rr(e){if(typeof e=="string"){var t=e in _Q?_Q[e]:e;if(t==="GlorotNormal")return new FP;if(t==="GlorotUniform")return new RP;if(t==="HeNormal")return new MP;if(t==="HeUniform")return new PP;if(t==="LeCunNormal")return new $P;if(t==="LeCunUniform")return new LP;var n={};return n.className=t,n.config={},SQ(n)}return e instanceof Ys?e:SQ(e)}function U4e(){return new gQ}function W4e(){return new DP}function V4e(e){return new mQ(e)}function q4e(e){return new vQ(e)}function H4e(e){return new yQ(e)}function G4e(e){return new bQ(e)}function K4e(e){return new xQ(e)}function X4e(e){return new ro(e)}function Y4e(e){return new RP(e)}function Z4e(e){return new FP(e)}function J4e(e){return new MP(e)}function Q4e(e){return new PP(e)}function eBe(e){return new $P(e)}function tBe(e){return new LP(e)}function nBe(e){return new wQ(e)}Object.freeze({zeros:U4e,ones:W4e,constant:V4e,randomUniform:q4e,randomNormal:H4e,truncatedNormal:G4e,identity:K4e,varianceScaling:X4e,glorotUniform:Y4e,glorotNormal:Z4e,heNormal:J4e,heUniform:Q4e,leCunNormal:eBe,leCunUniform:tBe,orthogonal:nBe});var rBe=0;function EQ(){return rBe++}var zE={};function jE(e){return e===void 0&&(e=""),e in zE||(zE[e]=0),zE[e]+=1,e+zE[e].toString()}function BP(e){return Array.isArray(e)&&Array.isArray(e[0])}function UE(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Dt(e){var t;if(Array.isArray(e)){if(e.length!==1)throw new ie("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function Xn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return(e=e)[0];throw new ie("Expected exactly 1 Shape; got "+e.length)}return e}function WE(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];i.shape.length===0?t+=1:t+=i.shape.reduce(function(a,o){return a*o})}return t}var AQ="Variable",iBe=function(){function e(t,n,r,i,a){n===void 0&&(n="float32"),r===void 0&&(r=AQ),i===void 0&&(i=!0),a===void 0&&(a=null),this.dtype=n??"float32",this.shape=t.shape,this.id=EQ(),r=r??AQ,this.originalName=sQ(r),this.name=uQ(this.originalName),this.trainable_=i,this.constraint=a,this.val=b3(t,this.trainable_,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(t){return this.assertNotDisposed(),aBe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),e}();function aBe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function zP(e){return e.map(function(t){return t.read()})}function jP(e){e.forEach(function(t){t[0].write(t[1])})}var Fi=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}(),Ju=function(){return function(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=EQ(),a!=null&&(this.originalName=sQ(a),this.name=uQ(this.originalName)),this.rank=t.length}}(),oBe=0,VE=function(){function e(t,n){this.callArgs=n,this.id=oBe++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var r=0,i=t.inboundLayers;r<i.length;r++){var a=i[r];a!=null&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var t=[],n=0,r=this.inboundLayers;n<r.length;n++){var i=r[n];i!=null?t.push(i.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),sBe=0,tn=function(e){function t(n){var r=e.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=sBe++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=n.name;if(!i){var a=r.getClassName();i=hc(a)+"_"+jE(a)}if(r.name=i,r.trainable_=n.trainable==null||n.trainable,n.inputShape!=null||n.batchInputShape!=null){var o=void 0;if(n.batchInputShape!=null)o=n.batchInputShape;else if(n.inputShape!=null){var s=null;n.batchSize!=null&&(s=n.batchSize),o=[s].concat(n.inputShape)}r.batchInputShape=o;var u=n.dtype;u==null&&(u=n.inputDType),u==null&&(u="float32"),r.dtype=u}return n.weights!=null?r.initialWeights=n.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return Ee(t,e),t.nodeKey=function(n,r){return n.name+"_ib-"+r.toString()},t.prototype.getNodeAtIndex=function(n,r){if(this.inboundNodes.length===0)throw new Yu("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=n)throw new ie("Asked to get "+r+" at node "+n+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[n]},t.prototype.getInputAt=function(n){return _a(this.getNodeAtIndex(n,"input").inputTensors)},t.prototype.getOutputAt=function(n){return _a(this.getNodeAtIndex(n,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Xh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Xh("Layer "+this.name+" is not connected, no input to return.");return _a(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Xh("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Xh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return _a(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(n){return n()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(n){this._built=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this._trainableWeights.forEach(function(r){return r.trainable=n}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(n){return n.trainable}):[]},set:function(n){this._trainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(n){return!n.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(n){this._nonTrainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(n){if(n=Qn(n),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Qn(this.inputSpec);if(n.length!==r.length)throw new ie("Layer "+this.name+" expects "+r.length+" inputs, but it received "+n.length+" input tensors. Input received: "+n);for(var i=0;i<n.length;i++){var a=n[i],o=r[i];if(o!=null){var s=a.rank;if(o.ndim!=null&&s!==o.ndim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+s);if(o.maxNDim!=null&&s>o.maxNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+s);if(o.minNDim!=null&&s<o.minNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+s+".");if(o.dtype!=null&&a.dtype!==o.dtype)throw new ie("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+a.dtype+".");if(o.axes){var u=a.shape;for(var l in o.axes){var c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+f+" but got shape "+u+".")}}if(o.shape!=null)for(var h=0;h<o.shape.length;++h){var p=o.shape[h],g=a.shape[h];if(p!=null&&g!=null&&p!==g)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape="+a.shape+".")}}}}},t.prototype.call=function(n,r){return n},t.prototype.invokeCallHook=function(n,r){this._callHook!=null&&this._callHook(n,r)},t.prototype.setCallHook=function(n){this._callHook=n},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(n,r){var i=this;r=r||{},this.assertNotDisposed();for(var a=Qn(n),o=!0,s=0,u=a;s<u.length;s++)if(!(u[s]instanceof Ju)){o=!1;break}for(var l=!0,c=0,f=a;c<f.length;c++)if(f[c]instanceof Ju){l=!1;break}if(o===l)throw new ie("Arguments to apply() must be all SymbolicTensors or all Tensors");return Jh(this.name,function(){if(!i.built){i.assertInputCompatibility(n);for(var d=[],h=0,p=Qn(n);h<p.length;h++){var g=p[h];d.push(g.shape)}i.build(_a(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(n),l){for(var m=[],v=0,y=Qn(S=i.call(n,r));v<y.length;v++){var b=y[v];a.indexOf(b)!==-1&&(b=b.clone()),m.push(b)}if(S=_a(m),i.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S}var x=uBe(n),w=i.computeOutputShape(x),S=void 0,A=lBe(n);if(i.warnOnIncompatibleInputShape(Array.isArray(n)?x[0]:x),S=w!=null&&w.length>0&&Array.isArray(w[0])?w.map(function(_,E){return new Ju(A,_,i,Qn(n),r,i.name,E)}):new Ju(A,w,i,Qn(n),r,i.name),i.addInboundNode(n,S,null,null,x,w,r),i._refCount++,i.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S})},t.prototype.warnOnIncompatibleInputShape=function(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(n)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,a){i!=null&&n[a]!=null&&n[a]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(n)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Xh("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var n=[],r=0,i=this.inboundNodes;r<i.length;r++){var a=i[r],o=JSON.stringify(a.outputShapes);n.indexOf(o)===-1&&n.push(o)}if(n.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new Xh("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new Yu("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return WE(this.weights)},t.prototype.build=function(n){this.built=!0},t.prototype.getWeights=function(n){return n===void 0&&(n=!1),zP(n?this.trainableWeights:this.weights)},t.prototype.setWeights=function(n){var r=this;ue(function(){var i=r.weights;if(i.length!==n.length)throw new ie('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+n.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+n+"...");if(i.length!==0){for(var a=[],o=zP(i),s=0;s<o.length;++s){var u=o[s],l=i[s],c=n[s];if(!pt.arraysEqual(u.shape,c.shape))throw new ie("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);a.push([l,c])}jP(a)}})},t.prototype.addWeight=function(n,r,i,a,o,s,u){if(this._addedWeightNames.indexOf(n)!==-1)throw new ie("Duplicate weight name "+n+" for layer "+this.name);this._addedWeightNames.push(n),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(a=rr("zeros"));var l=a.apply(r,i),c=new iBe(l,i,n,s,u);return l.dispose(),o!=null&&this.addLoss(function(){return o.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},t.prototype.setFastWeightInitDuringBuild=function(n){this.fastWeightInitDuringBuild=n},t.prototype.addLoss=function(n){var r;n==null||Array.isArray(n)&&n.length===0||(n=Qn(n),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,n))},t.prototype.computeOutputShape=function(n){return n},t.prototype.computeMask=function(n,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(a){if(a!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},t.prototype.addInboundNode=function(n,r,i,a,o,s,u){u===void 0&&(u=null);var l=Qn(n);r=Qn(r),i=Qn(i),a=Qn(a),o=UE(o),s=UE(s);for(var c=[],f=[],d=[],h=0,p=l;h<p.length;h++){var g=p[h];c.push(g.sourceLayer),f.push(g.nodeIndex),d.push(g.tensorIndex)}new VE({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:a,inputShapes:o,outputShapes:s},u);for(var m=0;m<r.length;m++)r[m].sourceLayer=this,r[m].nodeIndex=this.inboundNodes.length-1,r[m].tensorIndex=m},t.prototype.getConfig=function(){var n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n},t.prototype.disposeWeights=function(){return this.weights.forEach(function(n){return n.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var n=0;return--this._refCount==0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}},t}(Ne.Serializable);function uBe(e){for(var t=[],n=0,r=e=Qn(e);n<r.length;n++){var i=r[n];t.push(i.shape)}return _a(t)}function lBe(e){return"float32"}function CQ(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];var r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],a=0;a<r.inboundLayers.length;a++)for(var o=0,s=CQ(r.inputTensors[a],r.inboundLayers[a],r.nodeIndices[a]);o<s.length;o++){var u=s[o];i.indexOf(u)===-1&&i.push(u)}return i}var kQ,Ub=function(e){function t(n){var r=e.call(this,{dtype:n.dtype,name:n.name!=null?n.name:jE("input").toString()})||this;if(n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new ie("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=n.batchInputShape;if(i==null){if(n.inputShape==null)throw new ie("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new ie("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=n.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new Ju(r.dtype,r.batchInputShape,r,[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new VE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return Ee(t,e),t.prototype.apply=function(n,r){throw new ie("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(tn);function TQ(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new ie("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));var n=e.dtype;return n==null&&(n="float32"),new Ub({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function Hf(e){return Ct(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(e==null)return[2];for(i in t=[],n=[],r=[],e)typeof(a=e[i])!="number"&&(o=a,t.push(o.data()),n.push(i),r.push(o));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];jt(r),l.label=2;case 2:return[2]}})})}function OQ(e){if(e!=null)for(var t in e){var n=e[t];typeof n!="number"&&n.dispose()}}Ne.registerClass(Ub),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(kQ||(kQ={}));var cBe=125,Qm=function(){function e(){this.validationData=null}return e.prototype.setParams=function(t){this.params=t},e.prototype.onEpochBegin=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onEpochEnd=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchBegin=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchEnd=function(t,n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onTrainBegin=function(t){return Ct(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.onTrainEnd=function(t){return Ct(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.setModel=function(t){},e}(),fBe=function(){function e(t,n){n===void 0&&(n=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=n}return e.prototype.append=function(t){this.callbacks.push(t)},e.prototype.setParams=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setParams(t)},e.prototype.setModel=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setModel(t)},e.prototype.onEpochBegin=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return Ct(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(t){return Ct(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainBegin(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(t){return Ct(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainEnd(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e}(),dBe=function(e){function t(){return e.call(this)||this}return Ee(t,e),t.prototype.onEpochBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u=this;return St(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,a=function(c){var f=r[c];if(typeof f=="number")o.totals.hasOwnProperty(c)||(o.totals[c]=0),o.totals[c]=o.totals[c]+f*i;else{var d=void 0;c in o.totals?d=o.totals[c]:o.totals[c]=0;var h=ue(function(){return Ut(u.totals[c],rt(f,i))});o.totals[c]=h,d!=null&&d.dispose()}},o=this,r)a(s);return[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l=this;return St(this,function(c){if(r!=null)for(i=function(f){if(a.totals[f]==null)return"continue";typeof a.totals[f]=="number"?r[f]=a.totals[f]/a.seen:ue(function(){var d=rt(Cr(1,l.seen),l.totals[f]);r[f]=d,l.totals[f].dispose(),ju(r[f])})},a=this,o=0,s=this.params.metrics;o<s.length;o++)u=s[o],i(u);return[2]})})},t}(Qm),hBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){for(i in r==null&&(r={}),this.epoch.push(n),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},t.prototype.syncData=function(){return Ct(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return St(this,function(f){switch(f.label){case 0:for(a in n=[],r=[],i=[],this.history)for(o=this.history[a],s=0;s<o.length;++s)typeof o[s]!="number"&&(u=o[s],n.push(u.data()),r.push(a),i.push(s));return[4,Promise.all(n)];case 1:for(l=f.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},t}(Qm),pBe=function(e){function t(n,r){var i=e.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=cBe),i.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return pt.isNumber(i.yieldEvery)&&(i.maybeWait=b4e(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=n.onTrainBegin,i.trainEnd=n.onTrainEnd,i.epochBegin=n.onEpochBegin,i.epochEnd=n.onEpochEnd,i.batchBegin=n.onBatchBegin,i.batchEnd=n.onBatchEnd,i.yield=n.onYield,i}return Ee(t,e),t.prototype.maybeWait=function(n,r,i){return Ct(this,void 0,void 0,function(){var a;return St(this,function(o){switch(o.label){case 0:return a=[],this.yield==null?[3,2]:[4,Hf(i)];case 1:o.sent(),a.push(this.yield(n,r,i)),o.label=2;case 2:return a.push(PE()),[4,Promise.all(a)];case 3:return o.sent(),[2]}})})},t.prototype.onEpochBegin=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.currentEpoch=n,this.epochBegin==null?[3,3]:[4,Hf(r)];case 1:return i.sent(),[4,this.epochBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Hf(r)];case 1:a.sent(),i.push(this.epochEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(PE()),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onBatchBegin=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Hf(r)];case 1:return i.sent(),[4,this.batchBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Hf(r)];case 1:a.sent(),i.push(this.batchEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="batch"?i.push(PE()):pt.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,n,r)),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Hf(n)];case 1:return r.sent(),[4,this.trainBegin(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Hf(n)];case 1:return r.sent(),[4,this.trainEnd(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}(Qm);function IQ(e,t){return e==null&&(e={}),e instanceof Qm?[e]:Array.isArray(e)&&e[0]instanceof Qm?e:Qn(e).map(function(n){return new pBe(n,t)})}var gBe=function(){function e(){}return e.registerCallbackConstructor=function(t,n){pt.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),e.checkForDuplicate(n),e.constructors[t]==null&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach(function(r){if(r===t)throw new ie("Duplicate callback constructor.")})},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var i=+r;t>=i&&n.push.apply(n,e.constructors[i])}return n.map(function(a){return new a})},e.constructors={},e}();function NQ(e,t,n,r,i,a,o,s,u){var l=new hBe,c=[new dBe].concat(gBe.createCallbacks(t));e!=null&&c.push.apply(c,e),c.push(l);var f=new fBe(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:l}}function Zs(e,t,n){return t===void 0&&(t={}),n===void 0&&(n=!1),Pb(e,Ne.SerializationMap.getMap().classNameMap,t,"layer",n)}function qE(e,t){return ue(function(){e.dtype!=="float32"&&(e=e.asType("float32"));var n=Hr(jb(e),t,!0),r=km(n.shape,Gr()),i=gb(qu(n,r));return Cr(e,i)})}function ep(e,t){return ue(function(){return Pr(jb(Ar(t,e)),-1)})}function HE(e,t){return ue(function(){return Pr(Nf(Ar(t,e)),-1)})}function ev(e,t){return ue(function(){var n=Ar(e,t),r=xa(Nf(e),Gr(),Number.MAX_VALUE),i=Nf(Cr(n,r));return rt(100,Pr(i,-1))})}function mBe(e,t){return ue(function(){var n=xa(t,Gr(),Number.MAX_VALUE),r=uc(Ut(1,n)),i=xa(e,Gr(),Number.MAX_VALUE),a=uc(Ut(1,i));return Pr(jb(Ar(r,a)),-1)})}function vBe(e,t){return ue(function(){var n=qu(0,Ar(1,rt(e,t)));return Pr(jb(n),-1)})}function yBe(e,t){return ue(function(){var n=qu(0,Ar(1,rt(e,t)));return Pr(n,-1)})}function bBe(e,t){return ue(function(){var n=Hr(rt(e,t),-1),r=Mf(rt(Ar(1,e),t),-1);return qu(0,Ut(1,Ar(r,n)))})}function xBe(e,t){return ue(function(){var n=Math.log(2),r=Ar(t,e),i=Ar(Ut(r,pb(rt(-2,r))),n);return Pr(i,-1)})}function Wb(e,t,n){return n===void 0&&(n=!1),ue(function(){if(n)t=Ph(t);else{var r=Hr(t,t.shape.length-1,!0);t=Cr(t,r)}return t=xa(t,Gr(),1-Gr()),Df(Hr(rt(e.toFloat(),uc(t)),t.shape.length-1))})}function GE(e,t){return ue(function(){var n=US(D4e(e)).toInt(),r=(t=xa(t,Gr(),1-Gr())).shape;return Wb(Wh(n,r[r.length-1]).reshape(r),t,!1)})}function wBe(e,t){if(!pt.arraysEqual(e.shape,t.shape))throw new ie("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return ue(function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())})}function KE(e,t){return ue(function(){var n;return n=xa(t,Gr(),1-Gr()),n=uc(Cr(n,Ar(1,n))),Pr(wBe(e,n),-1)})}function _Be(e,t){return ue(function(){var n=xa(e,Gr(),1),r=xa(t,Gr(),1);return Hr(rt(e,uc(Cr(n,r))),-1)})}function SBe(e,t){return ue(function(){var n=uc(Ut(Gr(),t));return Pr(Ar(t,rt(e,n)),-1)})}function UP(e,t){return ue(function(){var n=qE(e,-1),r=qE(t,-1),i=rt(n,r);return Df(Hr(i,-1))})}var XE={meanSquaredError:ep,meanAbsoluteError:HE,meanAbsolutePercentageError:ev,meanSquaredLogarithmicError:mBe,squaredHinge:vBe,hinge:yBe,categoricalHinge:bBe,logcosh:xBe,categoricalCrossentropy:Wb,sparseCategoricalCrossentropy:GE,binaryCrossentropy:KE,kullbackLeiblerDivergence:_Be,poisson:SBe,cosineProximity:UP};function WP(e){if(typeof e=="string"){if(e in XE)return XE[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ie(t)}return e}function VP(e,t){return ue(function(){var n=rt(.5,Do(t)),r=Bb(Pm(t,n),e.dtype);return Pr(qh(e,r),-1)})}function qP(e,t){return ue(function(){return Bb(qh(Ob(e,-1),Ob(t,-1)),"float32")})}function DQ(e,t){return ue(function(){return Gu(e.equal(1),t.equal(1)).sum().cast("float32")})}function EBe(e,t){return ue(function(){return Gu(e.equal(1),t.equal(0)).sum().cast("float32")})}function ABe(e,t){return ue(function(){return Gu(e.equal(0),t.equal(1)).sum().cast("float32")})}function RQ(e,t){return ue(function(){var n=DQ(e,t),r=ABe(e,t),i=n.add(r);return Gs(Pm(i,0),n.div(i),0).cast("float32")})}function CBe(e,t){return ue(function(){var n=DQ(e,t),r=EBe(e,t),i=n.add(r);return Gs(Pm(i,0),n.div(i),0).cast("float32")})}function FQ(e,t){return KE(e,t)}function MQ(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),qh(e,t).asType("float32")}var kBe=ep,TBe=ep,OBe=HE,IBe=HE,NBe=ev,DBe=ev,HP=Wb,RBe=UP,PQ=GE,YE={binaryAccuracy:VP,categoricalAccuracy:qP,precision:RQ,categoricalCrossentropy:HP,sparseCategoricalCrossentropy:PQ,mse:kBe,MSE:TBe,mae:OBe,MAE:IBe,mape:NBe,MAPE:DBe,cosine:RBe};function FBe(e){if(typeof e=="string"&&e in YE)return YE[e];if(typeof e!="string"&&e!=null)return e;throw new ie("Unknown metric "+e)}function ZE(e){if(Zu(e!==null,"Unknown LossOrMetricFn "+e),typeof e=="string")return e;for(var t=void 0,n=0,r=Object.keys(XE);n<r.length;n++){var i=r[n];if(XE[i]===e){t=i;break}}if(t!==void 0)return t;for(var a=0,o=Object.keys(YE);a<o.length;a++)if(i=o[a],YE[i]===e){t=i;break}return t!==void 0?t:e.name}function MBe(e){var t={Adagrad:function(){return Uf.adagrad(.01)},Adadelta:function(){return Uf.adadelta(1,.95,Gr())},Adam:function(){return Uf.adam(.001,.9,.999,Gr())},Adamax:function(){return Uf.adamax(.002,.9,.999,Gr(),0)},RMSProp:function(){return Uf.rmsprop(.001,.9,0,Gr())},SGD:function(){return Uf.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ie("Unknown Optimizer "+e)}var $Q=1048576;function LQ(e,t,n){if(n===void 0&&(n=!1),e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!GP(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>$Q&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+$Q+".")}}function GP(e){if(e===null)return!0;if(typeof e=="object"){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(typeof r!="string"||!GP(e[r]))return!1}return!0}if(Array.isArray(e)){for(var i=0,a=e;i<a.length;i++)if(!GP(a[i]))return!1;return!0}return!1}var o=typeof e;return o==="string"||o==="number"||o==="boolean"}function PBe(e,t,n,r){r===void 0&&(r=console.log);var i,a=LBe(e),o=["Layer (type)","Output shape","Param #"];if(a?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(d){return Math.floor(t*d)})),!a)for(var s in o.push("Receives inputs"),i=[],e.nodesByDepth)i.push.apply(i,e.nodesByDepth[s]);r("_".repeat(t)),JE(o,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)a?BBe(u[l],n,r):zBe(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=$Be(e),f=WE(e.nonTrainableWeights);r("Total params: "+(c+f)),r("Trainable params: "+c),r("Non-trainable params: "+f),r("_".repeat(t))}function $Be(e){return e.collectedTrainableWeights!=null?WE(e.collectedTrainableWeights):WE(e.trainableWeights)}function LBe(e){var t=!0,n=[],r=[];for(var i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,f=0,d=l[u].inboundNodes;f<d.length;f++){var h=d[f];if(r.indexOf(h)!==-1){if(c){t=!1;break}c=!0}}if(!t)break}return t}function JE(e,t,n){n===void 0&&(n=console.log);for(var r="",i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[i]).slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function BBe(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(i){r="multiple"}JE([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function zBe(e,t,n,r){var i;try{i=JSON.stringify(e.outputShape)}catch(m){i="multiple"}for(var a=[],o=0,s=e.inboundNodes;o<s.length;o++){var u=s[o];if(!(n!=null&&n.length>0&&n.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,f=u.nodeIndices[l],d=u.tensorIndices[l];a.push(c+"["+f+"]["+d+"]")}}var h=e.name,p=e.getClassName(),g=a.length===0?"":a[0];for(JE([h+" ("+p+")",i,e.countParams().toString(),g],t,r),l=1;l<a.length;++l)JE(["","","",a[l]],t,r)}function BQ(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Vb(e,t){if(e===null)return null;if(typeof e=="string")return Zh(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];BQ(t,i,a)?n.push(a):n.push(Vb(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if(l==="name"&&typeof c=="string")o[l]=c;else{var f=Zh(l);o[f]=Vb(c,f)}}return o}function KP(e,t){if(e==null)return null;if(typeof e=="string")return hc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];BQ(t,i,a)?n.push(a):n.push(KP(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],f=hc(l);o[f]=l!=="name"&&l!=="className"||typeof c!="string"?KP(c,l):c}return o}var zQ="1.7.4";function jBe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return $S(t,e.dtype)}catch(n){throw new ie("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}var tv=function(){function e(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(var r=0,i=t;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return e.prototype.add=function(t,n,r){if(this.id2Value[t.id]!=null)throw new ie("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=jBe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r),this},e.prototype.addFeed=function(t){this.add(t.key,t.value)},e.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(t){if(t instanceof Ju){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Value[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[n]},e.prototype.getMask=function(t){if(t instanceof Ju){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[n]},e.prototype.disposeMasks=function(){this.id2Mask!=null&&jt(this.id2Mask)},e}(),XP={},jQ={};function qb(e,t,n,r){for(var i=n!=null&&n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(function(ee){return ee.name}),u=[],l=t.names(),c=0,f=s;c<f.length;c++){var d=f[c];l.indexOf(d)!==-1?u.push(t.getValue(d)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p,g=s.join(",")+"|"+t.names().join(",");if(XP[g]==null){var m=UBe(o,t);h=m.sorted,p=m.recipientCounts,XP[g]=h,jQ[g]=p}h=XP[g],p={},i||Object.assign(p,jQ[g]);for(var v=new tv(t),y=0;y<h.length;++y){if(r!=null){var b=DS().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=h[y],w=x.sourceLayer;if(!(w instanceof Ub)){for(var S=[],A=[],_=[],E=!1,C=0,k=x.inputs;C<k.length;C++){var T=k[C],I=v.getValue(T),N=v.getMask(T);S.push(I),A.push(N),N!=null&&(E=!0),i||(p[T.name]--,p[T.name]!==0||t.hasKey(T)||s.indexOf(T.name)!==-1||I.isDisposed||T.sourceLayer.stateful===!0||_.push(I))}E&&((n=n||{}).mask=A[0]);var O=Qn(w.apply(S,n)),D=null;w.supportsMasking&&(D=w.computeMask(S,A));for(var L=VBe(x),W=Array.isArray(L)?L:[L],G=0;G<W.length;++G){v.hasKey(W[G])||v.add(W[G],O[G],Array.isArray(D)?D[0]:D);var K=s.indexOf(W[G].name);K!==-1&&(u[K]=O[G])}i||jt(_)}}return v.disposeMasks(),a?u:u[0]}function UBe(e,t){pt.assert(e!=null&&e.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(e.length===1){var i=UQ(e[0],t);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=e;o<s.length;o++){for(var u=UQ(s[o],t),l=u.sorted,c=u.recipientMap,f=0,d=l;f<d.length;f++){var h=d[f];a.has(h.name)||(n.push(h),a.add(h.name))}var p=function(m){r[m]==null&&(r[m]=new Set),c[m].forEach(function(v){return r[m].add(v)})};for(var g in c)p(g)}return{sorted:n,recipientCounts:WBe(r)}}function WBe(e){var t={};for(var n in e)t[n]=e[n].size;return t}function UQ(e,t){for(var n=new Set,r=[],i={},a=0,o=t.names();a<o.length;a++){var s=o[a];n.add(s)}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(n.has(c.name))u.pop();else{var f=l[l.length-1]===u.length-1;if(c.inputs.length===0||f)u.pop(),r.push(c),n.add(c.name),f&&l.pop();else{l.push(u.length-1);for(var d=0,h=c.inputs;d<h.length;d++){var p=h[d];i[p.name]==null&&(i[p.name]=new Set),i[p.name].add(c.name),n.has(p.name)||u.push(p)}}}}return{sorted:r,recipientMap:i}}function VBe(e){var t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var i=0,a=e.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var qBe=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=jE(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],Wf(r.inputs).length!==r.inputs.length)throw new ie("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(Je){return Je.name}));Wf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(Je){return Je.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(C=o[a]).sourceLayer,u=C.nodeIndex,l=C.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,f=r.inputs;c<f.length;c++)s=(C=f[c]).sourceLayer,u=C.nodeIndex,l=C.tensorIndex,Zu(u===0,"input layer has >1 nodes"),Zu(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof Ub))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,p=r.outputLayers;h<p.length;h++)s=p[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(Je){return Je.shape}),r.internalOutputShapes=r.outputs.map(function(Je){return Je.shape});for(var g={},m={},v={},y={},b={},x=[],w=function(Je,Zt,mn,qn,ni,tr){qn!=null&&ni!=null&&tr!=null||(qn=Je.sourceLayer,ni=Je.nodeIndex,tr=Je.tensorIndex);var Dn=qn.inboundNodes[ni];if(mn.indexOf(Dn)!==-1)throw new Yu("The tensor "+Je.name+' at layer "'+qn.name+'" is part of a cycle.');if(Zt.indexOf(Dn)===-1){r.containerNodes.add(t.nodeKey(qn,ni)),qn.id in b||(b[qn.id]=Object.keys(b).length),mn.indexOf(Dn)===-1&&mn.push(Dn);for(var Qo=Dn.inboundLayers.length,Ka=0;Ka<Qo;Ka++){var Ul=Dn.inputTensors[Ka],Os=Dn.inboundLayers[Ka],Is=Dn.nodeIndices[Ka],Wl=Dn.tensorIndices[Ka];w(Ul,Zt,mn,Os,Is,Wl)}for(Zt.push(Dn);mn.indexOf(Dn)>=0;)mn.splice(mn.indexOf(Dn),1);x.push(Dn)}},S=[],A=[],_=0,E=r.outputs;_<E.length;_++){var C=E[_];w(C,S,A)}for(var k=0,T=x.slice().reverse();k<T.length;k++){m[(B=T[k]).id]=B,B.id in g||(g[B.id]=0);var I=g[B.id],N=v[B.outboundLayer.id]==null?0:v[B.outboundLayer.id];for(I=Math.max(I,N),v[B.outboundLayer.id]=I,y[B.outboundLayer.id]=B.outboundLayer,g[B.id]=I,d=0;d<B.inboundLayers.length;d++){var O=B.inboundLayers[d],D=(u=B.nodeIndices[d],O.inboundNodes[u]),L=g[D.id]==null?0:g[D.id];g[D.id]=Math.max(I+1,L),m[D.id]=D}}var W={};for(var G in g)(I=g[G])in W||(W[I]=[]),W[I].push(m[G]);var K={};for(var ee in v)(I=v[ee])in K||(K[I]=[]),K[I].push(y[ee]);var ce=Object.keys(K).map(function(Je){return parseInt(Je,10)}).sort($E);r.layers=[];for(var he=0,Oe=ce;he<Oe.length;he++){var Te=K[I=Oe[he]];Te.sort(function(Je,Zt){var mn=b[Je.id],qn=b[Zt.id];return mn<qn?-1:mn>qn?1:0});for(var Re=0,me=Te;Re<me.length;Re++)(s=me[Re])instanceof t&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=K,ce=Object.keys(W).map(function(Je){return parseInt(Je,10)}).sort($E);for(var P=r.inputs.slice(),F=[],V=0,ae=ce;V<ae.length;V++)for(var Y=0,M=W[I=ae[V]];Y<M.length;Y++){var B;if((s=(B=M[Y]).outboundLayer)!=null){for(var R=0,X=B.inputTensors;R<X.length;R++)if(C=X[R],P.indexOf(C)===-1)throw new Yu("Graph disconnected: cannot obtain value for tensor "+C+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+F);for(var ge=0,xe=B.outputTensors;ge<xe.length;ge++)C=xe[ge],P.push(C);F.push(s.name)}}r.nodesByDepth=W;for(var ze=r.layers.map(function(Je){return Je.name}),Ke=function(Je){var Zt=ze.filter(function(mn){return mn===Je}).length;if(Zt!==1)throw new Yu('The name "'+Je+'" is used '+Zt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(ze))},Ze=0,Lt=ze;Ze<Lt.length;Ze++)Ke(Lt[Ze]);return r.outboundNodes=[],r.inboundNodes=[],new VE({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(Je){return null}),outputMasks:r.outputs.map(function(Je){return null}),inputShapes:r.inputs.map(function(Je){return Je.shape}),outputShapes:r.outputs.map(function(Je){return Je.shape})}),r.built=!0,r._refCount=1,r}return Ee(t,e),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var a=i[r];n.numDisposedVariables+=a.dispose().numDisposedVariables}for(var o=0,s=this.internalContainerRefs;o<s.length;o++){var u=s[o];n.numDisposedVariables+=u.dispose().numDisposedVariables}}return n.refCountAfterDispose=this._refCount,n},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=n})}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ie("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n=n.concat(a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.layers;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(n,r){r===void 0&&(r=!0);for(var i={},a=0,o=0,s=this.layers;o<s.length;o++)for(var u=0,l=s[o].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new ie("Duplicate weight name: "+c.originalName);i[c.originalName]=c,a++}var f=[];for(var d in n){if(i[d]!=null)f.push([i[d],n[d]]);else if(r)throw new ie("Provided weight data has no target variable: "+d);delete i[d]}if(r){var h=[];for(var p in i)h.push(p);if(h.length>0)throw new ie(h.length+" of "+a+" weights are not set: "+h)}jP(f)},t.prototype.updatedConfig=function(){var n=this.getConfig(),r={};return r.className=this.getClassName(),r.config=n,r.kerasVersion="tfjs-layers "+zQ,r.backend="TensorFlow.js",r},t.prototype.toJSON=function(n,r){r===void 0&&(r=!0);var i=KP(this.updatedConfig());return r?JSON.stringify(i):i},t.prototype.call=function(n,r){var i=this;return ue(function(){n=Qn(n);for(var a=new tv,o=0;o<i.inputs.length;++o)a.add(i.inputs[o],n[o]);return qb(i.outputs,a,r)})},t.prototype.computeMask=function(n,r){var i=this;return ue(function(){var a;return n=Qn(n),a=r==null?Yh(null,n.length):Qn(r),i.runInternalGraph(n,a)[1]})},t.prototype.computeOutputShape=function(n){var r=UE(n);if(r.length!==this.inputLayers.length)throw new ie("Invalid inputShape argument "+n+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},a=0;a<r.length;a++){var o=this.inputLayers[a],s=r[a];i[E=o.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(k){return parseInt(k,10)}).sort($E);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){var p=h[d];if(o=p.outboundLayer,this.inputLayers.map(function(k){return k.id}).indexOf(o.id)===-1){for(var g=[],m=0;m<p.inboundLayers.length;m++){var v=p.inboundLayers[m],y=p.nodeIndices[m],b=p.tensorIndices[m],x=i[E=v.name+"_"+y+"_"+b];g.push(x)}var w=UE(o.computeOutputShape(_a(g))),S=o.inboundNodes.indexOf(p);for(m=0;m<w.length;m++)i[E=o.name+"_"+S+"_"+m]=w[m]}}var A=[],_=[];for(a=0;a<this.outputLayers.length;a++){o=this.outputLayers[a],S=this.outputLayersNodeIndices[a],b=this.outputLayersTensorIndices[a];var E=o.name+"_"+S+"_"+b;_.push(E)}for(a=0;a<_.length;a++){var C=_[a];Zu(C in i),A.push(i[C])}return _a(A)},t.prototype.runInternalGraph=function(n,r){r==null&&(r=Yh(null,n.length));for(var i={},a=0;a<this.inputs.length;++a){var o=this.inputs[a],s=n[a],u=r[a];i[o.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(K){return parseInt(K,10)}).sort($E);l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){for(var p=h[d],g=p.outboundLayer,m=p.inputTensors,v=p.outputTensors,y=new Array,b=0,x=m;b<x.length;b++)(o=x[b]).id in i&&y.push(i[o.id]);if(y.length===m.length){var w={},S=void 0,A=void 0,_=void 0,E=void 0;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){var C=y[0],k=C[0],T=C[1];w.mask==null&&(w.mask=T),_=Qn(g.call(k,w)),E=Qn(g.computeMask(k,T)),S=[k],A=[T]}else S=y.map(function(K){return K[0]}),A=y.map(function(K){return K[1]}),w.mask==null&&(w.mask=A),_=Qn(g.call(S,w)),E=Qn(g.computeMask(S,A));if(g.activityRegularizer)throw new Pt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<v.length;++a)o=v[a],s=_[a],u=E[a],i[o.id]=[s,u]}}for(var I=[],N=[],O=[],D=0,L=this.outputs;D<L.length;D++){Zu((o=L[D]).id in i,"Could not compute output "+o.name+" : "+o.id);var W=i[o.id],G=W[0];u=W[1],O.push(G.shape),I.push(G),N.push(u)}return[I,N,O]},t.prototype.buildNodeConversionMap=function(n){for(var r,i={},a=0,o=this.layers;a<o.length;a++){var s=o[a];r=s instanceof t?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=t.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},t.prototype.getLayer=function(n,r){if(r!=null){if(this.layers.length<=r)throw new ie("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(n==null)throw new ie("Provide either a layer name or layer index");for(var i=0,a=this.layers;i<a.length;i++){var o=a[i];if(o.name===n)return o}throw new ie("No such layer: "+n)},t.prototype.calculateLosses=function(){var n=this;return ue(function(){for(var r=[],i=0,a=n.layers;i<a.length;i++)for(var o=a[i],s=0;s<o.inboundNodes.length;++s){var u=t.nodeKey(o,s);n.containerNodes.has(u)&&r.push.apply(r,o.calculateLosses())}return r})},t.prototype.getConfig=function(){for(var n={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=0,o=this.layers;a<o.length;a++){for(var s=(w=o[a]).getClassName(),u=w.getConfig(),l=[],c=0;c<w.inboundNodes.length;c++){var f=w.inboundNodes[c],d=t.nodeKey(w,c),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(_){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+f.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],v=f.nodeIndices[g],y=f.tensorIndices[g];(A=r[t.nodeKey(m,v)])==null&&(A=0),p.push([m.name,A,y,h])}l.push(p)}}}var b={};b.name=w.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}n.layers=i;var x=[];for(g=0;g<this.inputLayers.length;g++){var w=this.inputLayers[g];v=this.inputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)&&((A=r[d])!==null&&A!==void 0||(A=0),y=this.inputLayersTensorIndices[g],x.push([w.name,A,y]))}n.inputLayers=x;var S=[];for(g=0;g<this.outputLayers.length;g++)if(w=this.outputLayers[g],v=this.outputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)){var A;(A=r[d])!==null&&A!==void 0||(A=0),y=this.outputLayersTensorIndices[g],S.push([w.name,A,y])}return n.outputLayers=S,n},t.fromConfig=function(n,r,i,a){a===void 0&&(a=!1);var o={},s={};function u(D,L){D.name in s?s[D.name].push(L):s[D.name]=[L]}function l(D,L){for(var W,G=[],K=0,ee=L;K<ee.length;K++){var ce=ee[K],he=ce[0],Oe=ce[1],Te=ce[2];if(W=ce[3]==null?{}:ce[3],!(he in o))return void u(D,L);var Re=o[he];if(Re.inboundNodes.length<=Oe)return void u(D,L);var me=Re.inboundNodes[Oe];G.push(me.outputTensors[Te])}G.length>0&&D.apply(_a(G),W)}function c(D){var L=D.name,W=Zs(D,r.customObjects!=null?r.customObjects:{});W.setFastWeightInitDuringBuild(a),o[L]=W,D.inboundNodes.forEach(function(G){if(!(G instanceof Array))throw new ie("Corrupted configuration, expected array for nodeData: "+G);u(W,G)})}for(var f=r.name,d=r.layers,h=0,p=d;h<p.length;h++)c(v=p[h]);for(;!y4e(s);)for(var g=0,m=d;g<m.length;g++){var v=m[g];if((O=o[v.name]).name in s){var y=s[O.name];delete s[O.name];for(var b=0,x=y;b<x.length;b++)l(O,x[b])}}for(var w=[],S=[],A=0,_=r.inputLayers;A<_.length;A++){var E=(v=_[A])[0],C=v[1],k=v[2];Zu(E in o);var T=(O=o[E]).inboundNodes[C].outputTensors;w.push(T[k])}for(var I=0,N=r.outputLayers;I<N.length;I++){E=(v=N[I])[0],C=v[1],k=v[2],Zu(E in o);var O;T=(O=o[E]).inboundNodes[C].outputTensors,S.push(T[k])}return new n({inputs:w,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new ie("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var n=0,r=this.layers;n<r.length;n++)if(r[n].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var n=this;ue(function(){n.layers.forEach(function(r){r.stateful&&r.resetStates()})})},t}(tn);function HBe(e,t,n){var r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(a){return null});if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided "+n+" is an array of "+e.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return e}if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){var i=[];return t.forEach(function(a){a in e?i.push(e[a]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+t+" keys. Provided "+n+" not understood: "+JSON.stringify(e))}function WQ(e,t){return HBe(e,t,"classWeight")}function VQ(e,t,n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return n==null?[3,2]:(i=ue(function(){if(e.shape.length===1)return e.clone();if(e.shape.length===2){if(e.shape[1]>1)return e.argMax(1);if(e.shape[1]===1)return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+e.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+e.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[l.sent()]),jt(i),u=[],a.forEach(function(c){if(n[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(n[c])}),[2,ba(u,"float32")];case 2:return[2,null]}})})}function GBe(e,t){return rt(e,t)}var KBe=32;function qQ(e,t){var n,r,i=t;n=i.xs,r=i.ys,pt.assert(n!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var a=HQ("input",e.inputNames,n),o=HQ("output",e.outputNames,r),s=a[0].shape[0];pt.assert(a.length===e.inputs.length,function(){return"LayersModel has "+e.inputs.length+" inputs, but the dataset provides "+a.length+" inputs.  (Expected input keys: "+JSON.stringify(e.inputNames)+")"}),pt.assert(o.length===e.outputs.length,function(){return"LayersModel has "+e.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(e.outputNames)+")"});for(var u=function(d){pt.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: input "+e.inputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},l=0;l<a.length;l++)u(l);for(var c=function(d){pt.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: output "+e.outputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},f=0;f<o.length;f++)c(f);return{xs:a,ys:o}}function HQ(e,t,n){if(n instanceof Ht)return[n];if(Array.isArray(n))return pt.assert(n.length===t.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+t.length+" to match the "+e+" keys "+t+"."}),n;for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i];if(n[o]==null)throw new ie("The feature data generated by the dataset lacks the required "+e+" key '"+o+"'.");r.push(n[o])}return r}function XBe(e){if(e.length===3)throw new Pt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function YBe(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W,G,K;return St(this,function(ee){switch(ee.label){case 0:if(r=n.batchesPerEpoch!=null,pt.assert(e.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),pt.assert(n!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),pt.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),pt.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),pt.assert(n.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,ee.label=1;case 1:return ee.trys.push([1,,26,27]),i=n.validationData!=null,a=void 0,o=void 0,i&&(GQ(n.validationData)?pt.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(s=XBe(n.validationData),a=s.xs,o=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(ce){return"val_"+ce})):l.slice(),f=IQ(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,h=NQ(f,d,n.epochs,null,null,ZBe(t,n),null,i,c),p=h.callbackList,g=h.history,p.setModel(e),e.history=g,[4,p.onTrainBegin()];case 2:return ee.sent(),e.stopTraining_=!1,m=n.initialEpoch==null?0:n.initialEpoch,[4,t.iterator()];case 3:v=ee.sent(),ee.label=4;case 4:return m<n.epochs?(y={},[4,p.onEpochBegin(m)]):[3,23];case 5:return ee.sent(),b=0,x=0,r?[3,7]:[4,t.iterator()];case 6:v=ee.sent(),ee.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,v.next()]:[3,21];case 8:return w=ee.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):w.value==null?[3,15]:(S=qQ(e,w.value),A=S.xs,_=S.ys,(E={}).batch=x,E.size=A[0].shape[0],[4,p.onBatchBegin(x,E)]);case 9:if(ee.sent(),C=[],n.classWeight==null)return[3,13];k=WQ(n.classWeight,e.outputNames),K=0,ee.label=10;case 10:return K<k.length?(I=(T=C).push,[4,VQ(_[K],null,k[K])]):[3,13];case 11:I.apply(T,[ee.sent()]),ee.label=12;case 12:return++K,[3,10];case 13:for(N=A.concat(_).concat(C),O=u(N),jt(N),K=0;K<l.length;++K)D=l[K],L=O[K],E[D]=L,ju(L);return[4,p.onBatchEnd(x,E)];case 14:ee.sent(),OQ(E),x++,b++,ee.label=15;case 15:return(r?b>=n.batchesPerEpoch:w.done)?i?(W=void 0,GQ(n.validationData)?(G=Qn,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return W=G.apply(void 0,[ee.sent()]),[3,18];case 17:W=Qn(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?KBe:n.validationBatchSize,verbose:0})),ee.label=18;case 18:for(K=0;K<e.metricsNames.length;++K)y["val_"+e.metricsNames[K]]=W[K];ee.label=19;case 19:return[3,21];case 20:return e.stopTraining_?[3,21]:[3,7];case 21:return[4,p.onEpochEnd(m,y)];case 22:return ee.sent(),m++,e.stopTraining_?[3,23]:[3,4];case 23:return[4,p.onTrainEnd()];case 24:return ee.sent(),[4,e.history.syncData()];case 25:return ee.sent(),[2,e.history];case 26:return e.isTraining=!1,[7];case 27:return[2]}})})}function ZBe(e,t){var n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function GQ(e){return typeof e.iterator=="function"}function JBe(e){return typeof e.next=="function"}function QBe(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:if(r=(n=n||{}).batches!=null,i=e.testFunction,a=[],n.verbose>0)throw new Pt("Verbose mode is not implemented yet.");return pt.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),JBe(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,l=0,c=function(){var p;return St(this,function(g){switch(g.label){case 0:return[4,o.next()];case 1:return p=g.sent(),a=ue(function(){if(p.value){var m=qQ(e,p.value),v=m.xs,y=m.ys,b=v.concat(y),x=ue(function(){return i(b)});if(jt(b),l===0)for(var w=0;w<x.length;++w)a.push(Ve(0));var S=b[0].shape[0],A=function(_){var E=x[_],C=a[_];a[_]=ue(function(){return Ut(a[_],rt(S,E))}),l>0&&jt(C)};for(w=0;w<x.length;++w)A(w);jt(x),u+=S,++l}return a}),p.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},h.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return h.sent()==="break"?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)d=a[f],a[f]=Cr(a[f],u),jt(d);return[2,_a(a)]}})})}function YP(e){pt.assert(e>0&&Number.isInteger(e),function(){return"batchSize is required to be a positive integer, but got "+e})}function Hb(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(function(r){return Qh(r,t,n-t)}):Qh(e,t,n-t)}function ZP(e,t){return ue(function(){return e==null?null:Array.isArray(e)?e.map(function(n){return ZP(n,t)}):hQ(e,t.dtype==="int32"?t:t.toInt())})}function JP(e,t){for(var n=[],r=0,i=null;r<e;)(i=r+t)>=e&&(i=e),n.push([r,i]),r=i;return n}function eze(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p){return Ct(this,void 0,void 0,function(){var g,m,v,y,b,x,w,S;return St(this,function(A){switch(A.label){case 0:if(i==null&&(i=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0),g=!1,u!=null&&l!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new ie("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(m=e.checkNumSamples(n,i,h,"steps_per_epoch"))!=null&&(v=Xs(0,m)),o==null&&(o=1),y=NQ(s,o,a,d,m,h,i,g,f),b=y.callbackList,x=y.history,b.setModel(e),e.history=x,[4,b.onTrainBegin()];case 1:A.sent(),e.stopTraining_=!1,w=function(_){var E,C,k,T,I;return St(this,function(N){switch(N.label){case 0:return[4,b.onEpochBegin(_)];case 1:if(N.sent(),E={},h==null)return[3,2];throw new Pt("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new Pt("batch shuffling is not implemneted yet");c&&pt.shuffle(v),C=ba(v),k=JP(m,i),T=function(O){var D;return St(this,function(L){switch(L.label){case 0:return D={},[4,b.onBatchBegin(O,D)];case 1:return L.sent(),ue(function(){var W=k[O][0],G=k[O][1],K=Qh(C,W,G-W);D.batch=O,D.size=G-W;for(var ee=ZP(n,K),ce=t(ee),he=0;he<r.length;++he){var Oe=r[he],Te=ce[he];D[Oe]=Te,ju(Te)}if(O===k.length-1&&g){var Re=e.testLoop(u,l,i);for(he=0;he<r.length;++he)Oe=r[he],Te=Re[he],ju(Te),E["val_"+Oe]=Te}}),[4,b.onBatchEnd(O,D)];case 2:return L.sent(),OQ(D),e.stopTraining_?[2,"break"]:[2]}})},I=0,N.label=3;case 3:return I<k.length?[5,T(I)]:[3,6];case 4:if(N.sent()==="break")return[3,6];N.label=5;case 5:return++I,[3,3];case 6:C.dispose(),N.label=7;case 7:return[4,b.onEpochEnd(_,E)];case 8:return N.sent(),e.stopTraining_?[2,"break"]:[2]}})},S=d,A.label=2;case 2:return S<a?[5,w(S)]:[3,5];case 3:if(A.sent()==="break")return[3,5];A.label=4;case 4:return++S,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return A.sent(),[4,e.history.syncData()];case 7:return A.sent(),[2,e.history]}})})}function tze(e,t,n,r){return r===void 0&&(r={}),Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E;return St(this,function(C){switch(C.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,C.label=1;case 1:return C.trys.push([1,,7,8]),YP(f=r.batchSize==null?32:r.batchSize),d=!1,[4,e.standardizeUserData(t,n,r.sampleWeight,r.classWeight,d,f)];case 2:if(h=C.sent(),i=h[0],a=h[1],c=h[2],p=!1,g=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(p=!0,r.validationData.length!==2)throw r.validationData.length===3?new Pt("validationData including sample weights is not supported yet."):new ie("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],m=!0,[4,e.standardizeUserData(o,s,null,null,m,f)];case 3:return v=C.sent(),u=v[0],l=v[1],g=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(p=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=Hb(i,y,b),i=Hb(i,0,y),l=Hb(a,y,b),a=Hb(a,0,y),g=u.concat(l)):r.validationSteps!=null&&(p=!0),C.label=5;case 5:return x=i.concat(a).concat(c),e.checkTrainableWeightsConsistency(),w=e.makeTrainFunction(),S=e.getDedupedMetricsNames(),A=void 0,_=void 0,p?(e.makeTestFunction(),A=e.testFunction,_=S.slice().concat(S.map(function(k){return"val_"+k}))):(A=null,g=[],_=S.slice()),E=IQ(r.callbacks,r.yieldEvery),[4,eze(e,w,x,S,f,r.epochs,r.verbose,E,A,g,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,C.sent()];case 7:return e.isTraining=!1,tp(i,t),tp(a,n),tp(u,o),tp(l,s),c!=null&&jt(c),[7];case 8:return[2]}})})}function KQ(e){var t=[];e instanceof Ht&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(r.rank===1)t.push(zb(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function tp(e,t){if(e!=null){var n=[];if(t instanceof Ht)n.push(t.id);else if(Array.isArray(t))t.forEach(function(u){return n.push(u.id)});else if(t!=null)for(var r in t){var i=t[r];n.push(i.id)}var a=[];if(e instanceof Ht)n.indexOf(e.id)===-1&&a.push(e);else if(Array.isArray(e))e.forEach(function(u){n.indexOf(u.id)===-1&&a.push(u)});else if(e!=null)for(var o in e){var s=e[o];n.indexOf(s.id)===-1&&a.push(s)}a.forEach(function(u){u.isDisposed||u.dispose()})}}function nze(e){return e instanceof Ht}function QP(e){return Array.isArray(e)}function XQ(e){return!nze(e)&&!QP(e)}function YQ(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),t==null||t.length===0){if(e!=null){var a=!1;if(QP(e)&&e.length>0)a=!0;else if(XQ(e)){for(var o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new ie("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(e==null)return t.map(function(m){return null});var s;if(XQ(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(e[c]==null)throw new ie('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(QP(e)){if((e=e).length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new ie("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=KQ(s),n!=null){for(var f=0;f<t.length;++f)if(n[f]!=null){var d=s[f];if(d.shape.length!==n[f].length)throw new ie("Error when checking "+i+": expected "+t[f]+" to have "+n[f].length+" dimension(s). but got array with shape "+d.shape);for(var h=0;h<n[f].length;++h)if(h!==0||r){var p=d.shape[h],g=n[f][h];if(g!=null&&g>=0&&p!==g)throw new ie("Error when checking "+i+": expected "+t[f]+" to have shape ["+n[f]+"], but got array with shape ["+d.shape+"].")}}}return s}function rze(e,t,n){var r=Wf(e.map(function(a){return a.shape[0]}));r.sort();var i=Wf(t.map(function(a){return a.shape[0]}));if(i.sort(),r.length>1)throw new ie("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(a){return a.shape})));if(i.length>1)throw new ie("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(a){return a.shape})));if(r.length>0&&i.length>0&&!pt.arraysEqual(r,i))throw new ie("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function ize(e,t,n){for(var r=[ep,KE,Wb],i=0;i<e.length;++i){var a=e[i],o=t[i],s=n[i];if(o!=null){if(o===Wb&&a.shape[a.shape.length-1]===1)throw new ie("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(o)!==-1)for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var f=u[c],d=l[c];if(d!=null&&f!==d)throw new ie("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function ZQ(e,t,n,r,i){var a;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(e)){if(e.length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(t.length>1)throw new ie("The model expects "+t.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(n!=null){for(var o=0;o<t.length;++o)if(n[o]!=null){var s=a[o];if(s.shape.length!==n[o].length)throw new ie("Error when checking "+i+": expected "+t[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(u!==0||r){var l=s.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new ie("Error when checking "+i+": expected "+t[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function aze(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(u){return[]});var n;if(typeof e=="string"||typeof e=="function")n=[e];else{if(!Array.isArray(e)&&typeof e!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map(function(u){return n});for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var oze="layers-model",Gb=function(e){function t(n){var r=e.call(this,n)||this;return r.isTraining=!1,r}return Ee(t,e),t.prototype.summary=function(n,r,i){if(i===void 0&&(i=console.log),!this.built)throw new ie("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");PBe(this,n,r,i)},t.prototype.compile=function(n){var r=this;if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=MBe(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof dc))throw new ie("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(n.loss)||typeof n.loss=="string"||typeof n.loss=="function")if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new ie("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+n.loss+".");var a=n.loss;i=a.map(function(m){return WP(m)})}else{var o=WP(n.loss);this.outputs.forEach(function(m){i.push(o)})}else{for(var s in n.loss=n.loss,n.loss)if(this.outputNames.indexOf(s)===-1)throw new ie('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];n.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(WP(n.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],h=this.outputNames[f];this.feedOutputNames.push(h),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var p=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Jh("loss",function(){for(var m=0;m<r.outputs.length;++m)if(p.indexOf(m)===-1){var v=r.lossFunctions[m];r.outputs.length>1&&(r.metricsTensors.push([v,m]),r.metricsNames.push(r.outputNames[m]+"_loss"))}});var g=aze(n.metrics,this.outputNames);Jh("metric",function(){for(var m=function(y){if(p.indexOf(y)!==-1)return"continue";(function(b){for(var x,w,S,A=function(C){if(typeof C=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(C)!==-1){var k=r.internalOutputShapes[y];k[k.length-1]===1||r.lossFunctions[y]===KE?["accuracy","acc"].indexOf(C)!==-1?w=VP:["crossentropy","ce"].indexOf(C)!==-1&&(w=FQ):r.lossFunctions[y]===GE?["accuracy","acc"].indexOf(C)!==-1?w=MQ:["crossentropy","ce"].indexOf(C)!==-1&&(w=PQ):["accuracy","acc"].indexOf(C)!==-1?w=qP:["crossentropy","ce"].indexOf(C)!==-1&&(w=HP);var T=void 0;["accuracy","acc"].indexOf(C)!==-1?T="acc":["crossentropy","ce"].indexOf(C)!==-1&&(T="ce"),S=w,x=""+T}else{var I=FBe(C);S=I,x=""+ZE(C)}var N;Jh(x,function(){N=S}),function(O,D,L){r.outputNames.length>1&&(D=r.outputNames[O]+"_"+D),r.metricsNames.push(D),r.metricsTensors.push([L,O])}(y,x,N)},_=0,E=b;_<E.length;_++)A(E[_])})(g[y])},v=0;v<r.outputs.length;++v)m(v)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(n,r,i){i===void 0&&(i={});var a=i.batchSize==null?32:i.batchSize;YP(a);var o=this.standardizeUserDataXY(n,r,!0,a);try{var s=o[0].concat(o[1]);this.makeTestFunction();var u=this.testFunction;return _a(this.testLoop(u,s,a,i.verbose,i.steps))}finally{tp(o[0],n),tp(o[1],r)}},t.prototype.evaluateDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return this.makeTestFunction(),[2,QBe(this,n,r)]})})},t.prototype.checkNumSamples=function(n,r,i,a){var o;if(a===void 0&&(a="steps"),i!=null){if(o=null,r!=null)throw new ie("If "+a+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(n==null)throw new ie("Either the input data should have a defined shape, or "+a+" shoud be specified.");o=Array.isArray(n)?n[0].shape[0]:n.shape[0]}return o},t.prototype.execute=function(n,r){if(Array.isArray(r)&&r.length===0)throw new ie("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),a=i?r:[r],o=this.retrieveSymbolicTensors(a),s=new tv;if(n instanceof Ht&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new ie("The number of inputs provided ("+n.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],n[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var f=c[l],d=n[f.name];if(d==null)throw new ie("No value is provided for the model's input "+f.name);s.add(f,d)}var h=qb(o,s);return i?h:h[0]},t.prototype.retrieveSymbolicTensors=function(n){for(var r=Yh(null,n.length),i=n.length,a=0,o=this.layers;a<o.length;a++){for(var s=o[a],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(h){return h.name}),c=0;c<n.length;++c){var f=l.indexOf(n[c]);if(f!==-1&&(r[c]=u[f],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(h,p){h==null&&d.push(n[p])}),new ie("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},t.prototype.predictLoop=function(n,r,i){var a=this;return r===void 0&&(r=32),i===void 0&&(i=!1),ue(function(){var o=a.checkNumSamples(n);if(i)throw new Pt("Verbose predictLoop() is not implemented yet.");for(var s=JP(o,r),u=a.outputs.map(function(f){return[]}),l=function(f){ue(function(){var d=s[f][0],h=s[f][1],p=Hb(n,d,h),g=[];if(Array.isArray(p))for(var m=0;m<p.length;++m)g.push({key:a.inputs[m],value:p[m]});else g.push({key:a.inputs[0],value:p});var v=new tv(g);return qb(a.outputs,v)}).forEach(function(d,h){return u[h].push(d)})},c=0;c<s.length;++c)l(c);return _a(u.map(function(f){return Hi(f,0)}))})},t.prototype.predict=function(n,r){r===void 0&&(r={});var i=KQ(n);ZQ(i,this.inputNames,this.feedInputShapes,!1);try{var a=r.batchSize==null?32:r.batchSize;return YP(a),this.predictLoop(i,a)}finally{tp(i,n)}},t.prototype.predictOnBatch=function(n){ZQ(n,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)},t.prototype.standardizeUserDataXY=function(n,r,i,a){if(this.optimizer_==null)throw new Yu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===GE?o.push(u.slice(0,u.length-1).concat([1])):o.push(u)}if(rze(n=YQ(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=YQ(r,this.feedOutputNames,o,!1,"target")),ize(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&n[0].shape[0]%a!=0)throw new ie("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+a+". Found: "+n[0].shape[0]+" sample(s).");return[n,r]},t.prototype.standardizeUserData=function(n,r,i,a,o,s){return o===void 0&&(o=!0),Ct(this,void 0,void 0,function(){var u,l,c,f,d,h,p,g;return St(this,function(m){switch(m.label){case 0:if(u=this.standardizeUserDataXY(n,r,o,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(f=null,a==null)return[3,4];d=WQ(a,this.outputNames),f=[],h=0,m.label=1;case 1:return h<d.length?(g=(p=f).push,[4,VQ(c[h],null,d[h])]):[3,4];case 2:g.apply(p,[m.sent()]),m.label=3;case 3:return++h,[3,1];case 4:return[2,[l,c,f]]}})})},t.prototype.testLoop=function(n,r,i,a,o){var s=this;return a===void 0&&(a=0),ue(function(){var u=s.checkNumSamples(r,i,o,"steps"),l=[];if(a>0)throw new Pt("Verbose mode is not implemented yet.");if(o!=null)throw new Pt("steps mode in testLoop() is not implemented yet");for(var c=JP(u,i),f=ba(Xs(0,u)),d=0;d<c.length;++d){var h=c[d][0],p=c[d][1],g=Qh(f,h,p-h),m=ZP(r,g),v=n(m);if(d===0)for(var y=0;y<v.length;++y)l.push(Ve(0));for(y=0;y<v.length;++y){var b=v[y];l[y]=Ut(l[y],rt(p-h,b))}}for(y=0;y<l.length;++y)l[y]=Cr(l[y],u);return l})},t.prototype.getDedupedMetricsNames=function(){for(var n=this.metricsNames,r=[],i=0;i<n.length;++i){var a=n[i],o=a;YJ(n,a)>1&&(o+="_"+YJ(n.slice(0,i),a)),r.push(o)}return r},t.prototype.makeTrainFunction=function(){var n=this;return function(r){var i=[],a=r.slice(0,n.inputs.length),o=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),s=r.slice(n.inputs.length+n.outputs.length,n.inputs.length+2*n.outputs.length),u=[],l=n.collectedTrainableWeights.map(function(c){return c.read()});return[n.optimizer_.minimize(function(){for(var c=[],f=0;f<n.inputs.length;++f)c.push({key:n.inputs[f],value:a[f]});var d,h=new tv(c),p=qb(n.outputs,h,{training:!0});for(f=0;f<n.lossFunctions.length;++f){var g=(0,n.lossFunctions[f])(o[f],p[f]);s[f]!=null&&(g=GBe(g,s[f]));var m=Pr(g);i.push(m),d=f===0?g:Ut(d,g)}for(f=0;f<n.metricsTensors.length;++f){var v=void 0;if(n.outputs.length>1&&f<n.outputs.length)v=i[f];else{var y=n.metricsTensors[f][0],b=n.metricsTensors[f][1];v=Pr(y(o[b],p[b]))}ju(v),u.push(v)}return d=Pr(d),n.calculateLosses().forEach(function(x){d=Ut(d,x)}),d},!0,l)].concat(u)}},t.prototype.makeTestFunction=function(){var n=this;this.testFunction=function(r){return ue(function(){for(var i,a=[],o=r.slice(0,n.inputs.length),s=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),u=[],l=0;l<n.inputs.length;++l)u.push({key:n.inputs[l],value:o[l]});var c=new tv(u),f=qb(n.outputs,c);for(l=0;l<n.lossFunctions.length;++l){var d=n.lossFunctions[l],h=Pr(d(s[l],f[l]));i=l===0?h:Ut(i,h),a.push(i)}for(l=0;l<n.metricsTensors.length;++l){var p=n.metricsTensors[l][0],g=n.metricsTensors[l][1],m=Pr(p(s[g],f[g]));a.push(m)}return a})}},t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),Ct(this,void 0,void 0,function(){return St(this,function(a){return[2,tze(this,n,r,i)]})})},t.prototype.fitDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return[2,YBe(this,n,r)]})})},t.prototype.trainOnBatch=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(n,r)];case 1:i=h.sent(),a=i[0],o=i[1],s=this.makeTrainFunction(),u=s(a.concat(o)),l=[],c=0,f=u,h.label=2;case 2:return c<f.length?[4,f[c].data()]:[3,5];case 3:d=h.sent(),l.push(d[0]),h.label=4;case 4:return c++,[3,2];case 5:return jt(u),[2,_a(l)]}})})},t.prototype.getNamedWeights=function(n){for(var r=[],i=n!=null&&n.trainableOnly,a=i?this.trainableWeights:this.weights,o=this.getWeights(i),s=0;s<a.length;++s)i&&!a[s].trainable||r.push({name:a[s].originalName,tensor:o[s]});return r},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(n){this.stopTraining_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=e.prototype.dispose.call(this);if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=DS().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-DS().numTensors}return n},t.prototype.getLossIdentifiers=function(){var n;if(typeof this.loss=="string")n=hc(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(function(c){return hc(c)})}else{var a=Object.keys(this.loss);n={};for(var o=this.loss,s=0,u=a;s<u.length;s++){var l=u[s];if(typeof o[l]!="string")throw new Error("Serialization of non-string loss is not supported.");n[l]=hc(o[l])}}return n},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[hc(ZE(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return hc(ZE(i))});var n={};for(var r in this.metrics)n[r]=hc(ZE(this.metrics[r]));return n},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,a=Zs(Vb(n.optimizer_config));if(typeof n.loss=="string")r=Zh(n.loss);else if(Array.isArray(n.loss))r=n.loss.map(function(s){return Zh(s)});else if(n.loss!=null)for(var o in r={},n.loss)r[o]=Zh(n.loss[o]);if(Array.isArray(n.metrics))i=n.metrics.map(function(s){return Zh(s)});else if(n.metrics!=null)for(var o in i={},n.metrics)i[o]=Zh(n.metrics[o]);this.compile({loss:r,metrics:i,optimizer:a})},t.prototype.save=function(n,r){return Ct(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v;return St(this,function(y){switch(y.label){case 0:if(typeof n=="string"){if((i=wa.getSaveHandlers(n)).length===0)throw new ie("Cannot find any save handlers for URL '"+n+"'");if(i.length>1)throw new ie("Found more than one ("+i.length+") save handlers for URL '"+n+"'");n=i[0]}if(n.save==null)throw new ie("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,wa.encodeWeights(this.getNamedWeights(r))];case 1:return a=y.sent(),o=!1,s=null,u=this.toJSON(s,o),l={modelTopology:u,format:oze,generatedBy:"TensorFlow.js tfjs-layers v"+zQ,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",g=(p=wa).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,g.apply(p,[y.sent(),c])];case 3:f=y.sent(),d=f.data,h=f.specs,(v=a.specs).push.apply(v,h),a.data=wa.concatenateArrayBuffers([a.data,d]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(m=!0,LQ(this.userDefinedMetadata,this.name,m),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=a.data,l.weightSpecs=a.specs,[2,n.save(l)]}})})},t.prototype.setUserDefinedMetadata=function(n){LQ(n,this.name),this.userDefinedMetadata=n},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(qBe);function sze(e,t){return Ct(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l;return St(this,function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),(n=(e=e).modelTopology).model_config!=null&&(n=n.model_config),r=Vb(n),i=Zs(r,t),e.weightsManifest==null?[3,2]:[4,wa.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(function(f){return f.originalName}))];case 1:for(a=c.sent(),o={},s=0,u=i.weights;s<u.length;s++)l=u[s],o[l.originalName]=a[l.originalName];i.loadWeights(o),jt(a),c.label=2;case 2:return[2,i]}})})}function uze(e,t){return Ct(this,void 0,void 0,function(){var n;return St(this,function(r){if(t==null&&(t={}),typeof e=="string"){if((n=wa.getLoadHandlers(e,t.onProgress)).length===0)n.push(wa.browserHTTPRequest(e,t));else if(n.length>1)throw new ie("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,lze(e,void 0,t)]})})}function lze(e,t,n){return Ct(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return St(this,function(d){switch(d.label){case 0:if(n==null&&(n={}),e.load==null)throw new ie("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),a=n.strict==null||n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=Zs(Vb(i),t,o),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new ie("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=cze(r.weightData,r.weightSpecs),c=l.modelWeights,f=l.optimizerWeights,s.loadWeights(c,a),s.optimizer!=null&&f.length>0?[4,s.optimizer.setWeights(f)]:[3,3];case 2:d.sent(),d.label=3;case 3:jt(c),jt(f.map(function(h){return h.tensor})),d.label=4;case 4:return[2,s]}})})}function cze(e,t){var n=wa.decodeWeights(e,t),r={},i=[];return t.forEach(function(a){a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}Ne.registerClass(Gb);var JQ=function(e){function t(n){var r=e.call(this,{inputs:[],outputs:[]})||this;if(n=n||{},r.trainable=!0,r.built=!1,r.name=n.name!=null?n.name:jE("sequential_"),n.layers!=null)for(var i=0,a=n.layers;i<a.length;i++){var o=a[i];r.add(o)}return r}return Ee(t,e),t.prototype.checkShape=function(n){if(n.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new ie("Negative dimension size caused by adding layer "+n.name+" with input shape ["+n.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(n){var r,i=n instanceof t||n instanceof Gb;if(i){if((r=n).outputs.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ie("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new ie("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=TQ({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(a)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(n.inboundNodes.length!==1)throw new ie("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+n.name+" which has "+n.inboundNodes.length+" pre-existing inbound connections.");if(n.inboundNodes[0].outputTensors.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=CQ(this.outputs[0])}this.inboundNodes=[],new VE({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Yh(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(n,r){return this.model==null&&this.build(),this.model.call(n,r)},t.prototype.build=function(n){if(Xn(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Gb({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(n,r,i){i===void 0&&(i=console.log),this.built||this.build(),e.prototype.summary.call(this,n,r,i)},t.prototype.setWeights=function(n){this.model==null&&this.build(),this.model.setWeights(n)},t.prototype.evaluate=function(n,r,i){if(i===void 0&&(i={}),!this.built)throw new Yu("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)},t.prototype.evaluateDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(n,r)]})})},t.prototype.predict=function(n,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(n,r)},t.prototype.predictOnBatch=function(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)},t.prototype.compile=function(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(n){this.model.optimizer=n},enumerable:!0,configurable:!0}),t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),Ct(this,void 0,void 0,function(){return St(this,function(a){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.fit(n,r,i)]})})},t.prototype.fitDataset=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Yu("The model needs to be compiled before being used.");return[2,this.model.fitDataset(n,r)]})})},t.prototype.trainOnBatch=function(n,r){return Ct(this,void 0,void 0,function(){return St(this,function(i){return[2,this.model.trainOnBatch(n,r)]})})},t.fromConfig=function(n,r,i,a){var o;a===void 0&&(a=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new ie("Legacy serialization format not supported yet.");o=r}else pt.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=r.layers,delete r.layers,s=r;var u=new n(s);if(!(u instanceof t))throw new Pt("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=o;l<c.length;l++){var f=Zs(c[l],void 0,a);a&&f.setFastWeightInitDuringBuild(!0),u.add(f)}return u},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ie("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(n){if(this.model==null)throw new ie("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r],o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}return{name:this.name,layers:n}},t.className="Sequential",t}(Gb);function fze(e){return new JQ(e)}function dze(e,t){return t==null&&(t={}),uze(e,t)}function hze(e){return TQ(e)}Ne.registerClass(JQ);var Po=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),pze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=1),F4e(n,r)},t.className="elu",t}(Po);Ne.registerClass(pze);var gze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return kE(n)},t.className="selu",t}(Po);Ne.registerClass(gze);var mze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return Pf(n)},t.className="relu",t}(Po);Ne.registerClass(mze);var vze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return ue(function(){return Om(6,Pf(n))})},t.className="relu6",t}(Po);Ne.registerClass(vze);var yze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return n},t.className="linear",t}(Po);Ne.registerClass(yze);var bze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return VS(n)},t.className="sigmoid",t}(Po);Ne.registerClass(bze);var xze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return P4e(n)},t.className="hardSigmoid",t}(Po);Ne.registerClass(xze);var wze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return pb(n)},t.className="softplus",t}(Po);Ne.registerClass(wze);var _ze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return M4e(n)},t.className="softsign",t}(Po);Ne.registerClass(_ze);var Sze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return qS(n)},t.className="tanh",t}(Po);Ne.registerClass(Sze);var QQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),Ph(n,r)},t.className="softmax",t}(Po);Ne.registerClass(QQ);var Eze=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),ZS(n,r)},t.className="logSoftmax",t}(Po);function $o(e){return e.getClassName()}function e$(e,t){return t===void 0&&(t={}),Pb(e,Ne.SerializationMap.getMap().classNameMap,t,"activation")}function Gf(e){var t;return e==null?e$(t={className:"linear",config:{}}):typeof e=="string"?((t={}).className=e,t.config={},e$(t)):e instanceof Po?e:e$(e)}function t$(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}Ne.registerClass(Eze);var eee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(Ne.Serializable),QE=function(e){function t(n){var r=e.call(this)||this;return t$(n),r.l1=n==null||n.l1==null?.01:n.l1,r.l2=n==null||n.l2==null?.01:n.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return ue(function(){var i=Tn([1]);return r.hasL1&&(i=Ut(i,Hr(rt(r.l1,Nf(n))))),r.hasL2&&(i=Ut(i,Hr(rt(r.l2,jb(n))))),i.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(n,r){return new n({l1:r.l1,l2:r.l2})},t.className="L1L2",t}(eee);function Aze(e){return t$(e),new QE({l1:e!=null?e.l1:null,l2:0})}function Cze(e){return t$(e),new QE({l2:e!=null?e.l2:null,l1:0})}Ne.registerClass(QE);var tee={l1l2:"L1L2"};function Wt(e){return AP(e)}function nee(e,t){return t===void 0&&(t={}),Pb(e,Ne.SerializationMap.getMap().classNameMap,t,"regularizer")}function ir(e){return e==null?null:typeof e=="string"?nee({className:e in tee?tee[e]:e,config:{}}):e instanceof eee?e:nee(e)}var ree=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,n!=null&&(r.maxValue=n.maxValue),r}return Ee(t,e),t.prototype.call=function(n,r){n=Dt(n);var i=Pf(n);return this.maxValue!=null&&(i=xa(i,0,this.maxValue)),i},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={maxValue:this.maxValue},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ReLU",t}(tn);Ne.registerClass(ree);var iee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_ALPHA=.3,n==null&&(n={}),r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return CE(i,this.alpha)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LeakyReLU",t}(tn);Ne.registerClass(iee);var aee=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),r.supportsMasking=!0,r.alphaInitializer=rr(n.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=ir(n.alphaRegularizer),r.alphaConstraint=Kr(n.alphaConstraint),n.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(n.sharedAxes))r.sharedAxes=n.sharedAxes;else{if(typeof n.sharedAxes!="number")throw new ie("Expected sharedAxes to be a number or an array of numbers, but got "+n.sharedAxes);r.sharedAxes=[n.sharedAxes]}return r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n)).slice(1);if(this.sharedAxes!=null)for(var i=0,a=this.sharedAxes;i<a.length;i++)r[(s=a[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(this.sharedAxes!=null)for(var s=1;s<n.length;++s)o[s]=n[s];this.inputSpec=[new Fi({ndim:n.length,axes:o})],this.built=!0},t.prototype.call=function(n,r){return n=Dt(n),Nb(n,this.alpha.read())},t.prototype.getConfig=function(){var n={alphaInitializer:vn(this.alphaInitializer),alphaRegularizer:Wt(this.alphaRegularizer),alphaConstraint:Ln(this.alphaConstraint),sharedAxes:this.sharedAxes},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="PReLU",t}(tn);Ne.registerClass(aee);var oee=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==r.DEFAULT_ALPHA)throw new Pt("Non-default alpha value ("+n.alpha+") is not supported by the ELU layer yet.");return r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return jm(i)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ELU",t}(tn);Ne.registerClass(oee);var see=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_THETA=1,n==null&&(n={}),r.theta=n.theta==null?r.DEFAULT_THETA:n.theta,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return i.mul(Bb(i.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={theta:this.theta},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ThresholdedReLU",t}(tn);Ne.registerClass(see);var uee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_AXIS=1,n==null&&(n={}),r.softmax=new QQ().apply,r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return this.softmax(i,this.axis)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Softmax",t}(tn);function n$(e,t,n){if(typeof e=="number")return Yh(e,t);if(e.length!==t)throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var i=e[r];if(!I4e(i))throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+i)}return e}function mc(e,t,n,r,i){return i===void 0&&(i=1),e==null?e:(a=n==="same"?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function eA(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+qf([n-t,0]);else{if(r!=="same")throw new ie("Unsupport padding mode: "+r+".");e*=t}return e}function r$(e,t){return ue(function(){return Xr(t),t==="channelsFirst"?cn(e,[0,2,3,1]):e})}function lee(e,t){return ue(function(){return Xr(t),t==="channelsFirst"?cn(e,[0,2,3,4,1]):e})}function kze(e,t,n,r,i,a,o){return r===void 0&&(r=1),i===void 0&&(i="valid"),o===void 0&&(o=1),ue(function(){if(a==null&&(a=Ks()),Xr(a),e.shape.length!==3)throw new ie("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(t.shape.length!==3)throw new ie("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(n!=null&&n.shape.length!==1)throw new ie("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(a==="channelsFirst"&&(e=cn(e,[0,2,1])),i==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=pE(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(s=gc(s,n)),s})}function cee(e,t,n,r,i,a,o,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),ue(function(){if(a==null&&(a=Ks()),Xr(a),e.rank!==3&&e.rank!==4)throw new ie("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+e.rank+".");if(t.rank!==3&&t.rank!==4)throw new ie("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+e.rank+".");var u=r$(e,a);if(i==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Lf.conv2d({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),a==="channelsFirst"&&(u=cn(u,[0,3,1,2])),u})}function Tze(e,t,n,r,i,a,o){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),ue(function(){if(a==null&&(a=Ks()),Xr(a),e.rank!==4&&e.rank!==5)throw new ie("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(t.rank!==4&&t.rank!==5)throw new ie("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=lee(e,a);if(i==="causal")throw new Pt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=gE(s,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(s=gc(s,n)),a==="channelsFirst"&&(s=cn(s,[0,4,1,2,3])),s})}Ne.registerClass(uee);var fee=function(e){function t(n,r){var i=e.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(r),i.rank=n,Sa(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new Pt("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=n$(r.kernelSize,n,"kernelSize"),i.strides=n$(r.strides==null?1:r.strides,n,"strides"),i.padding=r.padding==null?"valid":r.padding,ls(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Xr(i.dataFormat),i.activation=Gf(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=rr(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Kr(r.biasConstraint),i.biasRegularizer=ir(r.biasRegularizer),i.activityRegularizer=ir(r.activityRegularizer),i.dilationRate=n$(r.dilationRate==null?1:r.dilationRate,n,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new ie("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new ie("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new ie("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return Ee(t,e),t.verifyArgs=function(n){if(Zu("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!kP(n.kernelSize,"number",1,3))throw new ie("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(n.kernelSize)+".")},t.prototype.getConfig=function(){var n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:$o(this.activation),useBias:this.useBias,biasInitializer:vn(this.biasInitializer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),tA=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.kernel=null,t.verifyArgs(r),i.filters=r.filters,Sa(i.filters,"filters"),i.kernelInitializer=rr(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Kr(r.kernelConstraint),i.kernelRegularizer=ir(r.kernelRegularizer),i}return Ee(t,e),t.prototype.build=function(n){var r;n=Xn(n);var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the input should be defined. Found "+n[i]);var a=n[i],o=this.kernelSize.concat([a,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=a,r)}],this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a;n=Dt(n);var o=i.bias==null?null:i.bias.read(),s=JJ(i.activation.getClassName());if(s!=null&&i.rank===2)a=cee(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)a=kze(n,i.kernel.read(),o,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)a=cee(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new Pt("convolutions greater than 3D are not implemented yet.");a=Tze(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(a=i.activation.apply(a))}return a})},t.prototype.computeOutputShape=function(n){n=Xn(n);for(var r=[],i=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2),a=0;a<i.length;++a){var o=mc(i[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);r.push(o)}var s=[n[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},t.prototype.getConfig=function(){var n={filters:this.filters,kernelInitializer:vn(this.kernelInitializer),kernelRegularizer:Wt(this.kernelRegularizer),kernelConstraint:Ln(this.kernelConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.verifyArgs=function(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new ie("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(n.filters))},t}(fee),i$=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!kP(n.kernelSize,"number",1,2))throw new ie("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv2D",t}(tA);Ne.registerClass(i$);var dee=function(e){function t(n){var r=e.call(this,3,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&(!Array.isArray(n.kernelSize)||n.kernelSize.length!==1&&n.kernelSize.length!==3))throw new ie("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv3D",t}(tA);Ne.registerClass(dee);var hee=function(e){function t(n){var r=e.call(this,n)||this;if(r.inputSpec=[new Fi({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new ie("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Xn(n)).length!==4)throw new ie("Input should have rank 4; Received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the inputs should be defined. Found `None`.");var a=n[i],o=this.kernelSize.concat([this.filters,a]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fi({ndim:4,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=Dt(n);if(a.shape.length!==4)throw new ie("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+a.shape.length);var o,s,u=a.shape,l=u[0];i.dataFormat==="channelsFirst"?(o=2,s=3):(o=1,s=2);var c=u[o],f=u[s],d=i.kernelSize[0],h=i.kernelSize[1],p=i.strides[0],g=i.strides[1],m=[l,eA(c,p,d,i.padding),eA(f,g,h,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(a=cn(a,[0,2,3,1]));var v=mE(a,i.kernel.read(),m,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(v=cn(v,[0,3,1,2])),i.bias!=null&&(v=gc(v,i.bias.read(),i.dataFormat)),i.activation!=null&&(v=i.activation.apply(v)),v})},t.prototype.computeOutputShape=function(n){var r,i,a,o=(n=Xn(n)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[r]=this.filters,o[i]=eA(o[i],l,s,this.padding),o[a]=eA(o[a],c,u,this.padding),o},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.dilationRate,n},t.className="Conv2DTranspose",t}(i$);Ne.registerClass(hee);var Oze=function(e){function t(n,r){var i=e.call(this,n,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new ie("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new ie("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new ie("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=rr(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=ir(r.depthwiseRegularizer),i.depthwiseConstraint=Kr(r.depthwiseConstraint),i.pointwiseInitializer=rr(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=ir(r.pointwiseRegularizer),i.pointwiseConstraint=Kr(r.pointwiseConstraint),i}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Xn(n)).length<this.rank+2)throw new ie("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null||n[i]<0)throw new ie("The channel dimension of the inputs should be defined, but found "+JSON.stringify(n[i]));for(var a=n[i],o=this.kernelSize.concat([a,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(a*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fi({ndim:this.rank+2,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a;if(n=Dt(n),i.rank===1)throw new Pt("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(n=cn(n,[0,2,3,1])),a=zM(n,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(a=gc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),i.dataFormat==="channelsFirst"&&(a=cn(a,[0,3,1,2])),a})},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.pointwiseInitializer=vn(this.pointwiseInitializer),n.depthwiseRegularizer=Wt(this.depthwiseRegularizer),n.pointwiseRegularizer=Wt(this.pointwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseConstraint),n.pointwiseConstraint=Ln(this.pointwiseConstraint),n},t.className="SeparableConv",t}(tA),pee=function(e){function t(n){return e.call(this,2,n)||this}return Ee(t,e),t.className="SeparableConv2D",t}(Oze);Ne.registerClass(pee);var gee=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.dataFormat,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!kP(n.kernelSize,"number",1,1))throw new ie("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv1D",t}(tA);Ne.registerClass(gee);var mee=function(e){function t(n){var r=e.call(this,n)||this;return typeof n.cropping=="number"?r.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?r.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:r.cropping=n.cropping,r.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,r.inputSpec=[{ndim:4}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]},t.prototype.call=function(n,r){var i=this;return ue(function(){return n=Dt(n),i.dataFormat==="channelsLast"?LE(LE(n,i.cropping[0][0],n.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],n.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):LE(LE(n,i.cropping[0][0],n.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],n.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},t.prototype.getConfig=function(){var n={cropping:this.cropping,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Cropping2D",t}(tn);Ne.registerClass(mee);var vee=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=n.size==null?r.DEFAULT_SIZE:n.size,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){if(this.dataFormat==="channelsFirst"){var r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}return r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2],[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=Dt(n),o=a.shape;if(i.dataFormat==="channelsFirst"){a=cn(a,[0,2,3,1]);var s=i.size[0]*o[2],u=i.size[1]*o[3],l=a.resizeNearestNeighbor([s,u]);return cn(l,[0,3,1,2])}return s=i.size[0]*o[1],u=i.size[1]*o[2],a.resizeNearestNeighbor([s,u])})},t.prototype.getConfig=function(){var n={size:this.size,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="UpSampling2D",t}(tn);function Ize(e,t,n,r,i,a){return n===void 0&&(n=[1,1]),r===void 0&&(r="valid"),ue(function(){i==null&&(i=Ks()),Xr(i);var o=r$(e,i);if(e.rank!==4)throw new ie("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(t.rank!==4)throw new ie("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=Bm(o,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}Ne.registerClass(vee);var yee=function(e){function t(n){var r=e.call(this,2,n)||this;return r.depthwiseKernel=null,r.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,r.depthwiseInitializer=rr(n.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Kr(n.depthwiseConstraint),r.depthwiseRegularizer=ir(n.depthwiseRegularizer),r}return Ee(t,e),t.prototype.build=function(n){if((n=Xn(n)).length<4)throw new ie("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(n)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new ie("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+n[r]+").");var i=n[r],a=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=Ize(n=Dt(n),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(a=gc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),a})},t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,o=mc(r,this.kernelSize[0],this.padding,this.strides[0]),s=mc(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],a,o,s]:[n[0],o,s,a]},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.depthwiseRegularizer=Wt(this.depthwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseRegularizer),n},t.className="DepthwiseConv2D",t}(fee);Ne.registerClass(yee);var a$=function(e){function t(n){var r=e.call(this,n)||this;return r.rate=Math.max(Math.min(n.rate,1),0),r.noiseShape=n.noiseShape,r.seed=n.seed,r.supportsMasking=!0,r}return Ee(t,e),t.prototype.getNoiseShape=function(n){if(this.noiseShape==null)return this.noiseShape;for(var r=n.shape,i=[],a=0;a<this.noiseShape.length;++a)i.push(this.noiseShape[a]==null?r[a]:this.noiseShape[a]);return i},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);if(0<i.rate&&i.rate<1){var o=r.training!=null&&r.training,s=i.getNoiseShape(a);return Jm(function(){return pQ(a,i.rate,s,i.seed)},function(){return a},o)}return n})},t.prototype.getConfig=function(){var n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.dispose=function(){return e.prototype.dispose.call(this)},t.className="Dropout",t}(tn);Ne.registerClass(a$);var bee=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getNoiseShape=function(n){var r=n.shape;return[r[0],1,r[2]]},t.className="SpatialDropout1D",t}(a$);Ne.registerClass(bee);var xee=function(e){function t(n){var r=e.call(this,n)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){var i=null;n.batchSize!=null&&(i=n.batchSize),r.batchInputShape=[i,n.inputDim]}return r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation),n.useBias!=null&&(r.useBias=n.useBias),r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Kr(n.kernelConstraint),r.biasConstraint=Kr(n.biasConstraint),r.kernelRegularizer=ir(n.kernelRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.activityRegularizer=ir(n.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Ee(t,e),t.prototype.build=function(n){var r,i=(n=Xn(n))[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},t.prototype.computeOutputShape=function(n){var r=(n=Xn(n)).slice();return r[r.length-1]=this.units,r},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a,o=Dt(n),s=JJ(i.activation.getClassName());return s!=null?a=pc(o,i.kernel.read(),s,i.bias?i.bias.read():null):(a=pc(o,i.kernel.read()),i.bias!=null&&(a=gc(a,i.bias.read())),i.activation!=null&&(a=i.activation.apply(a))),a})},t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Wt(this.kernelRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dense",t}(tn);Ne.registerClass(xee);var wee=function(e){function t(n){var r=this;return n=n||{},(r=e.call(this,n)||this).inputSpec=[{minNDim:3}],r.dataFormat=n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){for(var r=0,i=(n=Xn(n)).slice(1);r<i.length;r++)if(i[r]==null)throw new ie('The shape of the input to "Flatten" is not fully defined (got '+n.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[n[0],Vf(n,1)]},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);if(i.dataFormat==="channelsFirst"&&a.rank>1){for(var o=[0],s=2;s<a.rank;++s)o.push(s);o.push(1),a=a.transpose(o)}return R4e(a)})},t.prototype.getConfig=function(){var n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);var r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Flatten",t}(tn);Ne.registerClass(wee);var _ee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.activation=Gf(n.activation),r}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.activation.apply(a)})},t.prototype.getConfig=function(){var n={activation:$o(this.activation)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Activation",t}(tn);Ne.registerClass(_ee);var See=function(e){function t(n){var r=e.call(this,n)||this;return r.n=n.n,r.inputSpec=[{ndim:2}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],this.n,n[1]]},t.prototype.call=function(n,r){var i=this;return ue(function(){return N4e(n=Dt(n),i.n)})},t.prototype.getConfig=function(){var n={n:this.n},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="RepeatVector",t}(tn);Ne.registerClass(See);var Eee=function(e){function t(n){var r=e.call(this,n)||this;r.targetShape=n.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return Ee(t,e),t.prototype.isUnknown=function(n){return n<0||n==null},t.prototype.fixUnknownDimension=function(n,r){for(var i="Total size of new array must be unchanged.",a=r.slice(),o=1,s=null,u=0;u<a.length;++u){var l=a[u];if(this.isUnknown(l)){if(s!==null)throw new ie("Can only specifiy one unknown dimension.");s=u}else o*=l}var c=Vf(n);if(s!==null){if(o===0||c%o!=0)throw new ie(i);a[s]=c/o}else if(c!==o)throw new ie(i);return a},t.prototype.computeOutputShape=function(n){for(var r=!1,i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n),o=a.shape,s=o.slice(0,1).concat(i.fixUnknownDimension(o.slice(1),i.targetShape));return a.reshape(s)})},t.prototype.getConfig=function(){var n={targetShape:this.targetShape},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Reshape",t}(tn);Ne.registerClass(Eee);var Aee=function(e){function t(n){var r=e.call(this,n)||this;if(n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+n.dims+" instead.");var i=Xs(1,n.dims.length+1);if(!pt.arraysEqual(n.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=n.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Fi({ndim:r.dims.length+1})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=(n=Xn(n)).slice();return this.dims.forEach(function(i,a){r[a+1]=n[i]}),r},t.prototype.call=function(n,r){return cn(Dt(n),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var n={dims:this.dims},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Permute",t}(tn);Ne.registerClass(Aee);var Cee=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,r.maskValue=n!=null?n.maskValue==null?0:n.maskValue:0,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,n),r},t.prototype.computeMask=function(n,r){var i=Dt(n);return Tb($m(i,this.maskValue),-1)},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n),o=Tb($m(a,i.maskValue),-1,!0);return a.mul(o.asType(a.dtype))})},t.className="Masking",t}(tn);Ne.registerClass(Cee);var kee=function(e){function t(n){var r=e.call(this,n)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){var i=null;n.batchSize!=null&&(i=n.batchSize),n.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Qn(n.inputLength))}return r.inputDim=n.inputDim,Sa(r.inputDim,"inputDim"),r.outputDim=n.outputDim,Sa(r.outputDim,"outputDim"),r.embeddingsInitializer=rr(n.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=ir(n.embeddingsRegularizer),r.activityRegularizer=ir(n.activityRegularizer),r.embeddingsConstraint=Kr(n.embeddingsConstraint),r.maskZero=n.maskZero,r.supportsMasking=n.maskZero,r.inputLength=n.inputLength,r}return Ee(t,e),t.prototype.build=function(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(n){},t.prototype.computeMask=function(n,r){var i=this;return ue(function(){return i.maskZero?(n=Dt(n),$m(n,en(n))):null})},t.prototype.computeOutputShape=function(n){if(n=Xn(n),this.inputLength==null)return n.concat([this.outputDim]);var r=Qn(this.inputLength);if(r.length!==n.length-1)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);for(var i=0,a=0;a<r.length;++a){var o=r[a],s=n[a+1];if(o!=null&&s!=null&&o!==s)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);o==null&&(r[i]=s),i++}return[n[0]].concat(r,[this.outputDim])},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);return a.dtype!=="int32"&&(a=Bb(a,"int32")),hQ(i.embeddings.read(),a.as1D()).reshape(Xn(i.computeOutputShape(a.shape)))})},t.prototype.getConfig=function(){var n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vn(this.embeddingsInitializer),embeddingsRegularizer:Wt(this.embeddingsRegularizer),activityRegularizer:Wt(this.activityRegularizer),embeddingsConstraint:Ln(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Embedding",t}(tn);Ne.registerClass(kee);var np=function(e){function t(n){var r=e.call(this,n||{})||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.mergeFunction=function(n){throw new Pt},t.prototype.computeElementwiseOpOutputShape=function(n,r){if(n==null||r==null)return null;if(n.length<r.length)return this.computeElementwiseOpOutputShape(r,n);if(r.length===0)return n;for(var i=n.slice(0,n.length-r.length),a=0;a<r.length;++a){var o=n[n.length-r.length+a],s=r[a];if(o==null||s==null||o<0||s<0)i.push(null);else if(o===1)i.push(s);else if(s===1)i.push(o);else{if(o!==s)throw new ie("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(r));i.push(o)}}return i},t.prototype.build=function(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Xn(n)]),(n=n).length<2)throw new ie("A merge layer should be called on an Array of at least 2 inputs. Got "+n.length+" input(s).");for(var r=[],i=0,a=n;i<a.length;i++)(u=a[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=Wf(r)).length>1)throw new ie("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(n)+".");for(var o=n[0]==null?null:n[0].slice(1),s=1;s<n.length;++s){var u=n[s]==null?null:n[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var l=n.map(function(c){return c.length});n.indexOf(null)===-1&&Wf(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){if(n=n,i.reshapeRequired){var a=[],o=n.map(function(_){return _.rank});if(o.indexOf(null)===-1){for(var s=qf(o),u=0,l=n;u<l.length;u++){for(var c=(g=l[u]).rank,f=0;f<s-c;++f)g=zb(g,1);a.push(g)}return i.mergeFunction(a)}for(var d=!1,h=0,p=n;h<p.length;h++){var g;if((c=(g=p[h]).rank)==null){var m=g.shape,v=m[0],y=m.slice(1).concat([v]),b=g.reshape([v].concat(Vf(m.slice(1))));b=(b=cn(b,[1,0])).reshape(y),a.push(b),d=!0}else if(c>1){var x=Xs(1,c).concat([0]);a.push(cn(g,x)),d=!0}else a.push(g)}var w=i.mergeFunction(a),S=w.rank;if(d)if(S==null){var A=w.shape;y=[v=A[A.length-1]].concat(A.slice(0,A.length-1)),w=cn(w.reshape([-1,v]),[1,0]).reshape(y)}else S>1&&(x=[S-1].concat(Xs(0,S-1)),w=cn(w,x));return w}return i.mergeFunction(n)})},t.prototype.computeOutputShape=function(n){var r;r=(n=n)[0]==null?null:n[0].slice(1);for(var i=1;i<n.length;++i){var a=n[i]==null?null:n[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}for(var o=[],s=0,u=n;s<u.length;s++)(a=u[s])!=null&&a[0]!==null&&o.push(a[0]);return r=(o=Wf(o)).length===1?o.concat(r):[null].concat(r)},t.prototype.computeMask=function(n,r){return ue(function(){if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an Array");if(!Array.isArray(n))throw new ie("`inputs` should be an Array");if(r.length!==n.length)throw new ie("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+n.length+" vs "+r.length+")");if(r.every(function(o){return o==null}))return null;for(var i=(r=r.map(function(o){return o==null?o:Ro(o,0)}))[0],a=1;a<r.length-1;++a)i=Gu(i,r[a]);return i})},t}(tn),Tee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return ue(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Ut(r,n[i]);return r})},t.className="Add",t}(np);Ne.registerClass(Tee);var Oee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return ue(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=rt(r,n[i]);return r})},t.className="Multiply",t}(np);Ne.registerClass(Oee);var Iee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return ue(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Ut(r,n[i]);return rt(1/n.length,r)})},t.className="Average",t}(np);Ne.registerClass(Iee);var Nee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return ue(function(){for(var r=n[0],i=1;i<n.length;++i)r=qu(r,n[i]);return r})},t.className="Maximum",t}(np);Ne.registerClass(Nee);var Dee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return ue(function(){for(var r=n[0],i=1;i<n.length;++i)r=Om(r,n[i]);return r})},t.className="Minimum",t}(np);Ne.registerClass(Dee);var Ree=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_AXIS=-1,n==null&&(n={}),r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){if(!Array.isArray(n)||!Array.isArray(n[0])||n.length===1)throw new ie("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,a=n=n;i<a.length;i++)if((d=a[i])!=null){r=!1;break}if(!r){for(var o=[],s=0;s<n.length;++s){var u=n[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,f=o;c<f.length;c++){var d=f[c];if(pt.arraysEqual(d,u)){l=!0;break}}l||o.push(u)}if(o.length>1)throw new ie("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}},t.prototype.mergeFunction=function(n){var r=this;return ue(function(){return fQ(n,r.axis)})},t.prototype.computeOutputShape=function(n){if(!Array.isArray(n)||!Array.isArray(n[0]))throw new ie("A `Concatenate` layer should be called on a list of inputs.");for(var r=n,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis,o=0,s=r.slice(1);o<s.length;o++){var u=s[o];if(i[a]==null||u[a]==null){i[a]=null;break}i[a]+=u[a]}return i},t.prototype.computeMask=function(n,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new ie("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new ie("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+n.length+")");return ue(function(){var a=!0;if(r.forEach(function(l){l==null||(a=!1)}),a)return null;for(var o=[],s=0;s<n.length;++s)r[s]==null?o.push(Do(n[s]).asType("bool")):r[s].rank<n[s].rank?o.push(Ro(r[s],-1)):o.push(r[s]);var u=Hi(o,i.axis);return SE(u,-1,!1)})},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Concatenate",t}(np);function Kb(e,t){for(;e<0;)e+=t;return e}function Nze(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Pt("batchDot is not implemented for tensors of 4D or higher rank yet");if(pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length}),pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Pt("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);var a=n;return ue(function(){var o,s;if(r>i){o=r-i;for(var u=[],l=0;l<o;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){for(o=i-r,u=[],l=0;l<o;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else o=0;if(e.shape.length===2&&t.shape.length===2)s=a[0]===a[1]?e.mulStrict(t).sum(a[0]):e.transpose([1,0]).mulStrict(t).sum(a[1]);else{var c=a[0]!==e.shape.length-1,f=a[1]===t.shape.length-1;s=e.matMul(t,c,f)}if(o>0){var d=void 0,h=[];for(l=d=r>i?r+i-3:r-1;l<d+o;++l)h.push(l);s=s.squeeze(h)}return s.shape.length===1&&(s=s.expandDims(1)),s})}Ne.registerClass(Ree);var Fee=function(e){function t(n){var r=e.call(this,n)||this;return r.axes=n.axes,r.normalize=n.normalize!=null&&n.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0],i=n[1];if(r.length>3||i.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);if(r[a[0]]!==i[a[1]])throw new ie("Dimension incompatibility: "+r[a[0]]+" !== "+i[a[1]])},t.prototype.mergeFunction=function(n){if(n.length!==2)throw new ie("A `Dot` layer must be called on exactly 2 inputs, but received "+n.length+" input(s).");var r,i=n[0],a=n[1];return r=Array.isArray(this.axes)?this.axes.map(function(o,s){return Kb(o,n[s].shape.length)}):[Kb(this.axes,i.shape.length),Kb(this.axes,a.shape.length)],this.normalize&&(i=qE(i,r[0]),a=qE(a,r[1])),Nze(i,a,r)},t.prototype.interpretAxes=function(n,r){return Array.isArray(this.axes)?this.axes:[Kb(this.axes,n.length),Kb(this.axes,r.length)]},t.prototype.computeOutputShape=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);r.splice(a[0],1),i.splice(a[1],1),i.splice(0,1);var o=r.concat(i);return o.length===1&&o.push(1),o},t.prototype.computeMask=function(n,r){return null},t.prototype.getConfig=function(){var n={axes:this.axes,normalize:this.normalize},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dot",t}(np);Ne.registerClass(Fee);var Mee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.stddev=n.stddev,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);return Jm(function(){return BE(a.shape,0,i.stddev).add(a)},function(){return a},r.training||!1)})},t.className="GaussianNoise",t}(tn);Ne.registerClass(Mee);var Pee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.rate>0&&i.rate<1?Jm(function(){var o=Math.sqrt(i.rate/(1-i.rate));return a.mul(BE(a.shape,1,o))},function(){return a},r.training||!1):a})},t.className="GaussianDropout",t}(tn);Ne.registerClass(Pee);var $ee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r.noiseShape=n.noiseShape,r}return Ee(t,e),t.prototype._getNoiseShape=function(n){return this.noiseShape||Dt(n).shape},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return ue(function(){if(i.rate<1&&i.rate>0){var a=i._getNoiseShape(n);return Jm(function(){var o=Dt(n),s=-1.7580993408473766,u=Ab(Vh(a),i.rate);u=Bb(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return o.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Dt(n)},r.training||!1)}return n})},t.className="AlphaDropout",t}(tn);function Xb(e,t,n,r,i,a){var o;if(a===void 0&&(a=.001),e.rank===2)o=EM(e,t,n,r,i,a);else if(e.rank===3)o=AM(e,t,n,r,i,a);else{if(e.rank!==4)throw new Pt("batchNormalization is not implemented for array of rank "+e.rank+" yet");o=CM(e,t,n,r,i,a)}return o}function Dze(e,t,n,r,i){return i===void 0&&(i=.001),ue(function(){var a=Ib(e,r),o=a.mean,s=a.variance;return[Xb(e,o,s,n,t,i),o,s]})}function Rze(e,t,n,r,i){return i===void 0&&(i=.001),ue(function(){for(var a=Ib(e,r),o=a.mean,s=a.variance,u=[],l=0,c=Xs(0,e.rank);l<c.length;l++){var f=c[l];r.indexOf(f)!==-1?u.push(1):u.push(e.shape[f])}var d=o.reshape(u),h=s.reshape(u),p=t==null?null:t.reshape(u),g=n==null?null:n.reshape(u);return[Xb(e,d,h,g,p,i),o,s]})}function Fze(e,t,n,r,i){return i===void 0&&(i=.001),pt.arraysEqual(r.slice().sort(),Xs(0,e.rank-1))?Dze(e,t,n,r,i):Rze(e,t,n,r,i)}Ne.registerClass($ee);var Lee=function(e){function t(n){var r=this;return n==null&&(n={}),(r=e.call(this,n)||this).supportsMasking=!0,r.axis=n.axis==null?-1:n.axis,r.momentum=n.momentum==null?.99:n.momentum,r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=rr(n.betaInitializer||"zeros"),r.gammaInitializer=rr(n.gammaInitializer||"ones"),r.movingMeanInitializer=rr(n.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=rr(n.movingVarianceInitializer||"ones"),r.betaConstraint=Kr(n.betaConstraint),r.gammaConstraint=Kr(n.gammaConstraint),r.betaRegularizer=ir(n.betaRegularizer),r.gammaRegularizer=ir(n.gammaRegularizer),r}return Ee(t,e),t.prototype.build=function(n){var r;n=Xn(n);var i=this.axis>=0?this.axis:this.axis+n.length,a=n[i];if(a==null)throw new ie("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(n)+".");this.inputSpec=[new Fi({ndim:n.length,axes:(r={},r[i]=a,r)})];var o=[a];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=r.training!=null&&r.training,o=Dt(n),s=o.shape,u=s.length,l=Xs(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var f=Yh(1,u);f[c]=s[c];var d=l.slice();d.sort();var h=!pt.arraysEqual(d,Xs(0,u).slice(0,u-1));if(!a)return function(){if(h){var b=i.movingMean.read().reshape(f),x=i.movingVariance.read().reshape(f),w=i.center?i.beta.read().reshape(f):null,S=i.scale?i.gamma.read().reshape(f):null;return Xb(o,b,x,w,S,i.epsilon)}return Xb(o,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var p=Fze(o,i.gamma.read(),i.beta.read(),l,i.epsilon),g=p[0],m=p[1],v=p[2],y=function(b,x,w){ue(function(){var S=1-w,A=b.read(),_=A.sub(x).mul(S);b.write(A.sub(_))})};return y(i.movingMean,m,i.momentum),y(i.movingVariance,v,i.momentum),g})},t.prototype.getConfig=function(){var n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),movingMeanInitializer:vn(this.movingMeanInitializer),movingVarianceInitializer:vn(this.movingVarianceInitializer),betaRegularizer:Wt(this.betaRegularizer),gammaRegularizer:Wt(this.gammaRegularizer),betaConstraint:Ln(this.betaConstraint),gammaConstraint:Ln(this.gammaConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="BatchNormalization",t}(tn);Ne.registerClass(Lee);var Bee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).axis=n.axis==null?-1:n.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,a=r.axis;i<a.length;i++){var o=a[i];if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=rr(n.betaInitializer||"zeros"),r.gammaInitializer=rr(n.gammaInitializer||"ones"),r.betaRegularizer=ir(n.betaRegularizer),r.gammaRegularizer=ir(n.gammaRegularizer),r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var a=0,o=this.axis;a<o.length;a++){var s=o[a];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==Wf(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return n[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(n,r){var i=this,a=Dt(n),o=a.shape,s=o.length;return ue(function(){for(var u=Ib(a,i.axis,!0),l=u.mean,c=u.variance,f=Yh(1,s),d=0,h=i.axis;d<h.length;d++){var p=h[d];f[p]=o[p]}for(var g=function(w){return w!=null&&w.shape.length!==s&&i.axis!==[s-1]?w.reshape(f):w},m=g(i.gamma.read()),v=g(i.beta.read()),y=[],b=[],x=0;x<s;++x)i.axis.indexOf(x)!==-1?(y.push(o[x]),b.push(1)):(y.push(1),b.push(o[x]));return l=l.tile(y),c=c.tile(y),m=m.tile(b),v=v.tile(b),Xb(a,l,c,v,m,i.epsilon)})},t.prototype.getConfig=function(){var n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),betaRegularizer:Wt(this.betaRegularizer),gammaRegularizer:Wt(this.gammaRegularizer)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LayerNormalization",t}(tn);function Mze(e,t,n){return ue(function(){if(e.rank!==4)throw new ie("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ie("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ks()),n!=="channelsLast"&&n!=="channelsFirst")throw new ie("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=n==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Ku(e,r)})}Ne.registerClass(Bee);var zee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).dataFormat=n.dataFormat==null?Ks():n.dataFormat,n.padding==null)r.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")r.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new ie("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+n.padding.length+" array.");var i=void 0,a=void 0;if(typeof n.padding[0]=="number")i=[n.padding[0],n.padding[0]],a=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new ie("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+n.padding[0].length+" array.");if(i=n.padding[0],n.padding[1].length!==2)throw new ie("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+n.padding[1].length+" array.");a=n.padding[1]}r.padding=[i,a]}return r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r,i;return n=Xn(n),this.dataFormat==="channelsFirst"?(r=n[2]!=null&&n[2]>=0?n[2]+this.padding[0][0]+this.padding[0][1]:null,i=n[3]!=null&&n[3]>=0?n[3]+this.padding[1][0]+this.padding[1][1]:null,[n[0],n[1],r,i]):(r=n[1]!=null&&n[1]>=0?n[1]+this.padding[0][0]+this.padding[0][1]:null,i=n[2]!=null&&n[2]>=0?n[2]+this.padding[1][0]+this.padding[1][1]:null,[n[0],r,i,n[3]])},t.prototype.call=function(n,r){var i=this;return ue(function(){return Mze(Dt(n),i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={padding:this.padding,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ZeroPadding2D",t}(tn);function nA(e,t,n,r,i,a){return ue(function(){var o;Xr(i),aQ(a),ls(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Ks()),a==null&&(a="max"),e=r$(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?yE(e,t,n,s):bE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}function jee(e,t,n,r,i,a){return ue(function(){var o;Xr(i),aQ(a),ls(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Ks()),a==null&&(a="max"),e=lee(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?xE(e,t,n,s):wE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,4,1,2,3])),o})}Ne.registerClass(zee);var Uee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=2),r=e.call(this,n)||this,typeof n.poolSize=="number")r.poolSize=[n.poolSize];else{if(!Array.isArray(n.poolSize)||n.poolSize.length!==1||typeof n.poolSize[0]!="number")throw new ie("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.poolSize));r.poolSize=n.poolSize}if(Sa(r.poolSize,"poolSize"),n.strides==null)r.strides=r.poolSize;else if(typeof n.strides=="number")r.strides=[n.strides];else{if(!Array.isArray(n.strides)||n.strides.length!==1||typeof n.strides[0]!="number")throw new ie("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.strides));r.strides=n.strides}return Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,ls(r.padding),r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=mc((n=Xn(n))[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],r,n[2]]},t.prototype.call=function(n,r){var i=this;return ue(function(){i.invokeCallHook(n,r),n=zb(Dt(n),2);var a=i.poolingFunction(Dt(n),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return fb(a,[2])})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Wee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),nA(n,r,i,a,o,"max")},t.className="MaxPooling1D",t}(Uee);Ne.registerClass(Wee);var Vee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),nA(n,r,i,a,o,"avg")},t.className="AveragePooling1D",t}(Uee);Ne.registerClass(Vee);var qee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new ie("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),ls(r.padding),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2];return r=mc(r,this.poolSize[0],this.padding,this.strides[0]),i=mc(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i]:[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return ue(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Hee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),nA(n,r,i,a,o,"max")},t.className="MaxPooling2D",t}(qee);Ne.registerClass(Hee);var Gee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),nA(n,r,i,a,o,"avg")},t.className="AveragePooling2D",t}(qee);Ne.registerClass(Gee);var Kee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new ie("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),ls(r.padding),r.inputSpec=[new Fi({ndim:5})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Xn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[4]:n[3];return r=mc(r,this.poolSize[0],this.padding,this.strides[0]),i=mc(i,this.poolSize[1],this.padding,this.strides[1]),a=mc(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i,a]:[n[0],r,i,a,n[4]]},t.prototype.call=function(n,r){var i=this;return ue(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),Xee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),jee(n,r,i,a,o,"max")},t.className="MaxPooling3D",t}(Kee);Ne.registerClass(Xee);var Yee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Xr(o),ls(a),jee(n,r,i,a,o,"avg")},t.className="AveragePooling3D",t}(Kee);Ne.registerClass(Yee);var Zee=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],n[2]]},t.prototype.call=function(n,r){throw new Pt},t}(tn),Jee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return ue(function(){var i=Dt(n);return Pr(i,1)})},t.className="GlobalAveragePooling1D",t}(Zee);Ne.registerClass(Jee);var Qee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return ue(function(){var i=Dt(n);return Mf(i,1)})},t.className="GlobalMaxPooling1D",t}(Zee);Ne.registerClass(Qee);var ete=function(e){function t(n){var r=e.call(this,n)||this;return r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Xr(r.dataFormat),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]},t.prototype.call=function(n,r){throw new Pt},t.prototype.getConfig=function(){var n={dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),tte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Pr(a,[1,2]):Pr(a,[2,3])})},t.className="GlobalAveragePooling2D",t}(ete);Ne.registerClass(tte);var nte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Mf(a,[1,2]):Mf(a,[2,3])})},t.className="GlobalMaxPooling2D",t}(ete);function rte(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new ie("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function ite(e,t,n,r,i,a,o,s){return r===void 0&&(r=!1),o===void 0&&(o=!1),s===void 0&&(s=!1),ue(function(){var u=t.shape.length;if(u<3)throw new ie("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Xs(2,u));if(t=cn(t,l),a!=null)throw new Pt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Ro(i,-1)),i=cn(i,l)),r&&(t=Xu(t,0),i!=null&&(i=Xu(i,0)));var c,f,d=[],h=n,p=t.shape[0],g=If(t);i!=null&&(f=If(i));for(var m,v=function(b){var x=g[b],w=ue(function(){return e(x,h)});if(i==null)c=w[0],h=w[1];else{var S=ue(function(){var A=f[b],_=Do(A).sub(A);return{output:w[0].mul(A).addStrict(h[0].mul(_)),newStates:h.map(function(E,C){return w[1][C].mul(A).addStrict(E.mul(_))})}});c=S.output,h=S.newStates}s&&d.push(c)},y=0;y<p;++y)v(y);return s&&(m=ss(d,1)),[c,m,h]})}Ne.registerClass(nte);var nv=function(e){function t(n){var r,i=e.call(this,n)||this;if(n.cell==null)throw new ie("cell property is missing for the constructor of RNN.");if((r=Array.isArray(n.cell)?new l$({cells:n.cell}):n.cell).stateSize==null)throw new ie("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=n.returnSequences!=null&&n.returnSequences,i.returnState=n.returnState!=null&&n.returnState,i.goBackwards=n.goBackwards!=null&&n.goBackwards,i._stateful=n.stateful!=null&&n.stateful,i.unroll=n.unroll!=null&&n.unroll,i.supportsMasking=!0,i.inputSpec=[new Fi({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return Ee(t,e),t.prototype.getStates=function(){return this.states_==null?Xs(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(n){return null}):this.states_},t.prototype.setStates=function(n){this.states_=n},t.prototype.computeOutputShape=function(n){BP(n)&&(n=n[0]),n=n;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[n[0],n[1],a]:[n[0],a],this.returnState){for(var o=[],s=0,u=r;s<u.length;s++){var l=u[s];o.push([n[0],l])}return[i].concat(o)}return i},t.prototype.computeMask=function(n,r){var i=this;return ue(function(){Array.isArray(r)&&(r=r[0]);var a=i.returnSequences?r:null;if(i.returnState){var o=i.states.map(function(s){return null});return[a].concat(o)}return a})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<n;++i)r.push(null);return r}return this.states_},set:function(n){this.states_=n},enumerable:!0,configurable:!0}),t.prototype.build=function(n){if(this.numConstants!=null)throw new Pt("Constants support is not implemented in RNN yet.");BP(n)&&(n=n[0]),n=n;var r=this.stateful?n[0]:null,i=n[n.length-1];this.inputSpec[0]=new Fi({shape:[r,null,i]});var a,o=[n[0]].concat(n.slice(2));if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!pt.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),a))throw new ie("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map(function(s){return new Fi({shape:[null,s]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(n,r){var i=this;r===void 0&&(r=!1),ue(function(){if(!i.stateful)throw new Xh("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=i.inputSpec[0].shape[0];if(a==null)throw new ie("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_=[Tn([a,i.cell.stateSize])];else if(n==null)jt(i.states_),i.keptStates!=null&&(jt(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_[0]=Tn([a,i.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==i.states_.length)throw new ie("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+n.length+" state value(s). Input received: "+n);r===!0?i.keptStates.push(i.states_.slice()):jt(i.states_);for(var o=0;o<i.states_.length;++o){var s=n[o],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[o]:i.cell.stateSize,l=[a,u];if(!pt.arraysEqual(s.shape,l))throw new ie("State "+o+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[o]=s}}i.states_=i.states_.map(function(c){return ju(c.clone())})})},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=rte(n,i,a,this.numConstants);n=o.inputs,i=o.initialState,a=o.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var f=c[l];this.stateSpec.push(new Fi({shape:f.shape}))}u=u.concat(this.stateSpec)}if(a!=null&&(r.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof Ju){var d=[n].concat(s),h=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=h;var g=e.prototype.apply.call(this,d,r);return this.inputSpec=p,g}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=Dt(n),s==null&&(s=i.stateful?i.states_:i.getInitialState(n));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new ie("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:o},c=ite(function(g,m){var v=i.cell.call([g].concat(m),l);return[v[0],v.slice(1)]},n,s,i.goBackwards,a,null,i.unroll,i.returnSequences),f=c[0],d=c[1],h=c[2];i.stateful&&i.resetStates(h,o);var p=i.returnSequences?d:f;return i.returnState?[p].concat(h):p})},t.prototype.getInitialState=function(n){var r=this;return ue(function(){var i=Tn(n.shape);return i=zb(i=Hr(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(a){return a>1?IP(i,[1,a]):i}):r.cell.stateSize>1?[IP(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);var r=this.cell.getConfig();n.cell={className:this.cell.getClassName(),config:r};var i=e.prototype.getConfig.call(this);return Object.assign(n,i),n},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Zs(r.cell,i);return new n(Object.assign(r,{cell:a}))},t.className="RNN",t}(tn);Ne.registerClass(nv);var Yb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(tn),o$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation==null?r.DEFAULT_ACTIVATION:n.activation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Zm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Zm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){n=Xn(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){if((n=n).length!==2)throw new ie("SimpleRNNCell expects 2 input Tensors, got "+n.length+".");var a=n[1];n=n[0];var o,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=rv(function(){return Do(n)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=rv(function(){return Do(a)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;o=pc(u!=null?rt(n,u):n,i.kernel.read()),i.bias!=null&&(o=gc(o,i.bias.read())),l!=null&&(a=rt(a,l));var c=Ut(o,pc(a,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="SimpleRNNCell",t}(Yb);Ne.registerClass(o$);var ate=function(e){function t(n){return n.cell=new o$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){i.cell.dropoutMask!=null&&(jt(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(jt(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return new n(r)},t.className="SimpleRNN",t}(nv);Ne.registerClass(ate);var s$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Gf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Zm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Zm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Xn(n))[n.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){if((n=n).length!==2)throw new ie("GRUCell expects 2 input Tensors (inputs, h, c), got "+n.length+".");var a=r.training!=null&&r.training,o=n[1];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=rv(function(){return Do(n)},i.dropout,a,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=rv(function(){return Do(o)},i.recurrentDropout,a,3));var s,u,l,c=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,c[0]));var d=pc(n,i.kernel.read());i.useBias&&(d=gc(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,f[0]));var h=i.recurrentKernel.read(),p=oc(h,[2*i.units,i.units],h.rank-1),g=p[0],m=p[1],v=pc(o,g),y=oc(d,3,d.rank-1),b=y[0],x=y[1],w=y[2],S=oc(v,2,v.rank-1),A=S[0],_=S[1];s=i.recurrentActivation.apply(Ut(b,A)),u=i.recurrentActivation.apply(Ut(x,_));var E=pc(rt(u,o),m);l=i.activation.apply(Ut(w,E));var C=Ut(rt(s,o),rt(Ut(1,Df(s)),l));return[C,C]})},t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),recurrentActivation:$o(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="GRUCell",t}(Yb);Ne.registerClass(s$);var ote=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new s$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){i.cell.dropoutMask!=null&&(jt(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(jt(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),recurrentActivation:$o(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="GRU",t}(nv);Ne.registerClass(ote);var u$=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Gf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Gf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=rr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=rr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=rr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=n.unitForgetBias,r.kernelRegularizer=ir(n.kernelRegularizer),r.recurrentRegularizer=ir(n.recurrentRegularizer),r.biasRegularizer=ir(n.biasRegularizer),r.kernelConstraint=Kr(n.kernelConstraint),r.recurrentConstraint=Kr(n.recurrentConstraint),r.biasConstraint=Kr(n.biasConstraint),r.dropout=Zm([1,qf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Zm([1,qf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r,i,a=(n=Xn(n))[n.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return Ee(l,u),l.prototype.apply=function(c,f){var d=o.apply([s]),h=new DP().apply([s]),p=o.apply([2*s]);return dQ(dQ(d,h),p)},l}(Ys)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(n,r){var i=this;return ue(function(){var a=r.training!=null&&r.training;if((n=n).length!==3)throw new ie("LSTMCell expects 3 input Tensors (inputs, h, c), got "+n.length+".");var o=n[1],s=n[2];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=rv(function(){return Do(n)},i.dropout,a,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=rv(function(){return Do(o)},i.recurrentDropout,a,4));var u,l,c,f,d=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,d[0]));var p=pc(n,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,h[0])),p=Ut(p,pc(o,i.recurrentKernel.read())),i.useBias&&(p=gc(p,i.bias.read()));var g=oc(p,4,p.rank-1),m=g[0],v=g[1],y=g[2],b=g[3];u=i.recurrentActivation.apply(m),l=i.recurrentActivation.apply(v),c=Ut(rt(l,s),rt(u,i.activation.apply(y))),f=i.recurrentActivation.apply(b);var x=rt(f,i.activation.apply(c));return[x,x,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),recurrentActivation:$o(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LSTMCell",t}(Yb);Ne.registerClass(u$);var ste=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new u$(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return ue(function(){i.cell.dropoutMask!=null&&(jt(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(jt(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:$o(this.activation),recurrentActivation:$o(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Wt(this.kernelRegularizer),recurrentRegularizer:Wt(this.recurrentRegularizer),biasRegularizer:Wt(this.biasRegularizer),activityRegularizer:Wt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="LSTM",t}(nv);Ne.registerClass(ste);var l$=function(e){function t(n){var r=e.call(this,n)||this;return r.cells=n.cells,r}return Ee(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var n=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var a=i[r];Array.isArray(a.stateSize)?n.push.apply(n,a.stateSize):n.push(a.stateSize)}return n},enumerable:!0,configurable:!0}),t.prototype.call=function(n,r){var i=this;return ue(function(){for(var a=(n=n).slice(1),o=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?o.push(a.splice(0,l.stateSize.length)):o.push(a.splice(0,1))}o.reverse();for(var c,f=[],d=0;d<i.cells.length;++d)l=i.cells[d],a=o[d],c=d===0?[n[0]].concat(a):[c[0]].concat(a),c=l.call(c,r),f.push(c.slice(1));a=[];for(var h=0,p=f.slice().reverse();h<p.length;h++){var g=p[h];a.push.apply(a,g)}return[c[0]].concat(a)})},t.prototype.build=function(n){var r;BP(n)&&(n=n[0]),n=n,this.cells.forEach(function(i,a){Jh("RNNCell_"+a,function(){i.build(n),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,n=[n[0],r]})}),this.built=!0},t.prototype.getConfig=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push({className:a.getClassName(),config:a.getConfig()})}var o={cells:n},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(n,r,i){i===void 0&&(i={});for(var a=[],o=0,s=r.cells;o<s.length;o++){var u=s[o];a.push(Zs(u,i))}return new n({cells:a})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.cells;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.weights)}return zP(n)},t.prototype.setWeights=function(n){for(var r=[],i=0,a=this.cells;i<a.length;i++)for(var o=a[i],s=o.weights.length,u=n.splice(s),l=0;l<o.weights.length;++l)r.push([o.weights[l],u[l]]);jP(r)},t.className="StackedRNNCells",t}(Yb);function rv(e,t,n,r){function i(){return pQ(e(),t)}if(n===void 0&&(n=null),r===void 0&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(Jm(i,e,n));return a.map(function(s){return ju(s.clone())})}return ju(Jm(i,e,n).clone())}Ne.registerClass(l$);var ute=function(e){function t(n){var r=e.call(this,n)||this;return r.layer=n.layer,r}return Ee(t,e),t.prototype.build=function(n){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(n){this.layer!=null&&(this.layer.trainable=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(n){this.layer.setWeights(n)},t.prototype.getConfig=function(){var n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Zs(r.layer,i);delete r.layer;var o={layer:a};return Object.assign(o,r),new n(o)},t}(tn),lte=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){if((n=Xn(n)).length<3)throw new ie("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(n));this.inputSpec=[{shape:n}];var r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),e.prototype.build.call(this,n)},t.prototype.computeOutputShape=function(n){var r=[(n=Xn(n))[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),a=n[1];return[i[0],a].concat(i.slice(1))},t.prototype.call=function(n,r){var i=this;return ue(function(){return ite(function(a,o){return[Dt(i.layer.call(a,r)),[]]},n=Dt(n),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(ute);function Pze(e){Xm(k4e,"BidirectionalMergeMode",e)}Ne.registerClass(lte);var $ze="concat",cte=function(e){function t(n){var r=e.call(this,n)||this,i=n.layer.getConfig(),a={};a.className=n.layer.getClassName(),a.config=i,r.forwardLayer=Zs(a),i.goBackwards=i.goBackwards!==!0;var o={};if(o.className=n.layer.getClassName(),o.config=i,r.backwardLayer=Zs(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=n.mergeMode===void 0?$ze:n.mergeMode,Pze(r.mergeMode),n.weights)throw new Pt("weights support is not implemented for Bidirectional layer yet.");return r._stateful=n.layer.stateful,r.returnSequences=n.layer.returnSequences,r.returnState=n.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=n.layer.inputSpec,r.numConstants=null,r}return Ee(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(n){var r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))},t.prototype.computeOutputShape=function(n){var r,i,a,o=this.forwardLayer.computeOutputShape(n);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState&&(a=o.slice(1)),r=o[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):_a(i)},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=rte(n,i,a,this.numConstants);if(n=o.inputs,i=o.initialState,a=o.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&a==null)return e.prototype.apply.call(this,n,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new ie("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new Fi({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(a!=null)throw new Pt("Support for constants in Bidirectional layers is not implemented yet.");for(var f=s[0]instanceof Ju,d=0,h=s;d<h.length;d++)if(h[d]instanceof Ju!==f)throw new ie("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(f){var p=[n].concat(s),g=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,r);return this.inputSpec=m,v}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return ue(function(){var a,o,s,u,l=r.initialState;if(l==null)a=i.forwardLayer.call(n,r),o=i.backwardLayer.call(n,r);else{var c=l.slice(0,l.length/2),f=l.slice(l.length/2);a=i.forwardLayer.call(n,Object.assign(r,{initialState:c})),o=i.backwardLayer.call(n,Object.assign(r,{initialState:f}))}return i.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),i.returnSequences&&(o=Xu(o,1)),i.mergeMode==="concat"?u=fQ([a,o]):i.mergeMode==="sum"?u=Ut(a,o):i.mergeMode==="ave"?u=rt(.5,Ut(a,o)):i.mergeMode==="mul"?u=rt(a,o):i.mergeMode==null&&(u=[a,o]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},t.prototype.resetStates=function(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(n){var r=this;Jh(this.forwardLayer.name,function(){r.forwardLayer.build(n)}),Jh(this.backwardLayer.name,function(){r.backwardLayer.build(n)}),this.built=!0},t.prototype.computeMask=function(n,r){var i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?this.mergeMode==null?[r,r]:r:this.mergeMode==null?[null,null]:null,this.returnState){var a=this.forwardLayer.states.map(function(o){return null});return Array.isArray(i)?i.concat(a).concat(a):[i].concat(a).concat(a)}return i},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={mergeMode:this.mergeMode},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.fromConfig=function(n,r){var i=Zs(r.layer);if(delete r.layer,r.numConstants!=null)throw new Pt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=r;return a.layer=i,new n(a)},t.className="Bidirectional",t}(ute);function Lze(e){return new Ub(e)}function Bze(e){return new oee(e)}function zze(e){return new ree(e)}function jze(e){return new iee(e)}function Uze(e){return new aee(e)}function Wze(e){return new uee(e)}function Vze(e){return new see(e)}function qze(e){return new gee(e)}function Hze(e){return new i$(e)}function Gze(e){return new hee(e)}function Kze(e){return new dee(e)}function Xze(e){return new pee(e)}function Yze(e){return new mee(e)}function Zze(e){return new vee(e)}function Jze(e){return new yee(e)}function Qze(e){return new _ee(e)}function e5e(e){return new xee(e)}function t5e(e){return new a$(e)}function n5e(e){return new bee(e)}function r5e(e){return new wee(e)}function i5e(e){return new See(e)}function a5e(e){return new Eee(e)}function o5e(e){return new Aee(e)}function s5e(e){return new kee(e)}function u5e(e){return new Tee(e)}function l5e(e){return new Iee(e)}function c5e(e){return new Ree(e)}function f5e(e){return new Nee(e)}function d5e(e){return new Dee(e)}function h5e(e){return new Oee(e)}function p5e(e){return new Fee(e)}function g5e(e){return new Lee(e)}function m5e(e){return new Bee(e)}function v5e(e){return new zee(e)}function c$(e){return new Vee(e)}function y5e(e){return c$(e)}function b5e(e){return c$(e)}function f$(e){return new Gee(e)}function x5e(e){return f$(e)}function w5e(e){return f$(e)}function d$(e){return new Yee(e)}function _5e(e){return d$(e)}function S5e(e){return d$(e)}function E5e(e){return new Jee(e)}function A5e(e){return new tte(e)}function fte(e){return new Qee(e)}function dte(e){return new nte(e)}function hte(e){return new Wee(e)}function pte(e){return new Hee(e)}function C5e(e){return new Xee(e)}function k5e(e){return new ote(e)}function T5e(e){return new s$(e)}function O5e(e){return new ste(e)}function I5e(e){return new u$(e)}function N5e(e){return new ate(e)}function D5e(e){return new o$(e)}function R5e(e){return new nv(e)}function F5e(e){return new l$(e)}function M5e(e){return new cte(e)}function P5e(e){return new lte(e)}Ne.registerClass(cte);var $5e=fte,L5e=dte,B5e=hte,z5e=pte;function j5e(e){return new Mee(e)}function U5e(e){return new Pee(e)}function W5e(e){return new $ee(e)}function V5e(e){return new Cee(e)}var q5e=Object.freeze({inputLayer:Lze,elu:Bze,reLU:zze,leakyReLU:jze,prelu:Uze,softmax:Wze,thresholdedReLU:Vze,conv1d:qze,conv2d:Hze,conv2dTranspose:Gze,conv3d:Kze,separableConv2d:Xze,cropping2D:Yze,upSampling2d:Zze,depthwiseConv2d:Jze,activation:Qze,dense:e5e,dropout:t5e,spatialDropout1d:n5e,flatten:r5e,repeatVector:i5e,reshape:a5e,permute:o5e,embedding:s5e,add:u5e,average:l5e,concatenate:c5e,maximum:f5e,minimum:d5e,multiply:h5e,dot:p5e,batchNormalization:g5e,layerNormalization:m5e,zeroPadding2d:v5e,averagePooling1d:c$,avgPool1d:y5e,avgPooling1d:b5e,averagePooling2d:f$,avgPool2d:x5e,avgPooling2d:w5e,averagePooling3d:d$,avgPool3d:_5e,avgPooling3d:S5e,globalAveragePooling1d:E5e,globalAveragePooling2d:A5e,globalMaxPooling1d:fte,globalMaxPooling2d:dte,maxPooling1d:hte,maxPooling2d:pte,maxPooling3d:C5e,gru:k5e,gruCell:T5e,lstm:O5e,lstmCell:I5e,simpleRNN:N5e,simpleRNNCell:D5e,rnn:R5e,stackedRNNCells:F5e,bidirectional:M5e,timeDistributed:P5e,globalMaxPool1d:$5e,globalMaxPool2d:L5e,maxPool1d:B5e,maxPool2d:z5e,Layer:tn,RNN:nv,RNNCell:Yb,input:hze,gaussianNoise:j5e,gaussianDropout:U5e,alphaDropout:W5e,masking:V5e});function H5e(e,t){return VP(e,t)}function G5e(e,t){return FQ(e,t)}function K5e(e,t){return MQ(e,t)}function X5e(e,t){return qP(e,t)}function Y5e(e,t){return HP(e,t)}function Z5e(e,t){return RQ(e,t)}function J5e(e,t){return CBe(e,t)}function Q5e(e,t){return UP(e,t)}function e6e(e,t){return HE(e,t)}function t6e(e,t){return ev(e,t)}function n6e(e,t){return ev(e,t)}function r6e(e,t){return ev(e,t)}function i6e(e,t){return ep(e,t)}function a6e(e,t){return ep(e,t)}function o6e(e,t){return ep(e,t)}Object.freeze({binaryAccuracy:H5e,binaryCrossentropy:G5e,sparseCategoricalAccuracy:K5e,categoricalAccuracy:X5e,categoricalCrossentropy:Y5e,precision:Z5e,recall:J5e,cosineProximity:Q5e,meanAbsoluteError:e6e,meanAbsolutePercentageError:t6e,MAPE:n6e,mape:r6e,meanSquaredError:i6e,MSE:a6e,mse:o6e}),Object.freeze({modelFromJSON:sze});function s6e(e){return new QE(e)}function u6e(e){return Aze(e)}function l6e(e){return Cze(e)}Object.freeze({l1l2:s6e,l1:u6e,l2:l6e});var c6e=function(e){function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.model=null,n}return Ee(t,e),t.prototype.setModel=function(n){if(!(n instanceof Gb))throw new Error("model must be a LayersModel, not some other Container");this.model=n},t}(Qm);function rA(e,t){return e<t}function gte(e,t){return e>t}(function(e){function t(n){var r=e.call(this)||this;if(n==null&&(n={}),n.restoreBestWeights)throw new Pt("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=n.monitor||"val_loss",r.minDelta=Math.abs(n.minDelta||0),r.patience=n.patience||0,r.verbose=n.verbose||0,r.mode=n.mode||"auto",r.baseline=n.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=rA:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=gte:r.monitorFunc=rA,r.monitorFunc===rA&&(r.minDelta*=-1),r}return Ee(t,e),t.prototype.onTrainBegin=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===rA?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(n,r){return Ct(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return[4,Hf(r)];case 1:return a.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=n,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(n){return Ct(this,void 0,void 0,function(){return St(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(n){n==null&&(n={});var r=n[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(n)),r},t})(c6e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Js,mte,h$=function(){return(h$=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function rp(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function ip(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Js||(Js={})),function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(mte||(mte={}));var f6e={};function vte(e){return f6e[e]}function $(e,t,n,r){var i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){var a=i.inputIndexStart,o=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return Ea(t.inputNames[i.inputIndexStart],n,r);if(i.type==="tensors")return t.inputNames.slice(a,o).map(function(l){return Ea(l,n,r)});var s=Array.prototype.slice.call(Ea(t.inputNames.slice(a)[0],n,r).dataSync());return i.type==="number"?s[0]:s}var u=t.attrParams[e];return u&&u.value}function Ea(e,t,n){var r=Lo(e),i=r[0],a=r[1],o=n.currentContextIds.find(function(s){return!!t[iA(i,s)]});return o!==void 0?t[iA(i,o)][a]:void 0}function d6e(e,t,n){return t[iA(e,n.currentContextId)]}function iv(e,t){var n=Lo(e),r=n[0],i=n[1];return[iA(r,t&&t.currentContextId),i]}function iA(e,t){return t?e+"-"+t:e}function Lo(e){var t=e.lastIndexOf(":");return t===-1?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function p$(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var h6e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],p6e=Object.freeze({json:h6e}),g6e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],m6e=Object.freeze({json:g6e}),v6e=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],y6e=Object.freeze({json:v6e}),b6e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],x6e=Object.freeze({json:b6e}),w6e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],_6e=Object.freeze({json:w6e}),S6e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],E6e=Object.freeze({json:S6e}),A6e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],C6e=Object.freeze({json:A6e}),k6e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],T6e=Object.freeze({json:k6e}),O6e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],I6e=Object.freeze({json:O6e}),N6e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],D6e=Object.freeze({json:N6e}),R6e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],F6e=Object.freeze({json:R6e}),M6e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],P6e=Object.freeze({json:M6e}),$6e=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],L6e=Object.freeze({json:$6e}),B6e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],z6e=Object.freeze({json:B6e}),j6e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],U6e=Object.freeze({json:j6e}),W6e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],V6e=Object.freeze({json:W6e}),q6e=function(){function e(){var t=[p6e,m6e,y6e,x6e,_6e,E6e,C6e,D6e,I6e,T6e,F6e,P6e,L6e,z6e,U6e,V6e],n=[].concat.apply([],t.map(function(r){return r.json}));this.opMappers=n.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(t,n){var r=this;n===void 0&&(n={});var i=[],a=[],o=t.node.reduce(function(d,h){return d[h.name]=r.mapNode(h),h.op.startsWith("Placeholder")&&i.push(d[h.name]),h.op==="Const"&&a.push(d[h.name]),d},{}),s=[],u=[],l={},c={};n!=null&&(l=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var f=Object.keys(o);return f.forEach(function(d){var h=o[d];h.inputNames.forEach(function(p){var g=iv(p)[0];h.inputs.push(o[g]),o[g].children.push(h)})}),Object.keys(c).length===0?f.forEach(function(d){var h=o[d];h.children.length===0&&u.push(h)}):Object.keys(c).forEach(function(d){var h=iv(d)[0],p=o[h];p!=null&&(p.signatureKey=c[d],u.push(p))}),Object.keys(l).length>0?Object.keys(l).forEach(function(d){var h=iv(d)[0],p=o[h];p&&(p.signatureKey=l[d],s.push(p))}):s=i,{nodes:o,inputs:s,outputs:u,weights:a,placeholders:i,signature:n}},e.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce(function(n,r){return n[t[r].name]=r,n},{})},e.prototype.mapNode=function(t){var n=vte(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(r.inputParams=n.inputs.reduce(function(i,a){return i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i},{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce(function(i,a){var o=a.type,s=void 0;switch(a.type){case"string":(s=g$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=g$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":(s=_$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=_$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":(s=v$(t.attr,a.tfName,a.defaultValue||0))===void 0&&a.tfDeprecatedName&&(s=v$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":(s=w$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=w$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":(s=m$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=m$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":(s=E$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=E$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":(s=x$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=x$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":(s=S$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=S$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":(s=y$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=y$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":(s=b$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=b$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+t.op)}return i[a.name]={value:s,type:o},i},{})),r},e}();function H6e(e){var t=pe().global;if(t.atob!==void 0)return t.atob(e);if(typeof Buffer!="undefined")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function yte(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):H6e(e);return t?n:n.toLowerCase()}function g$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i!=null?yte(i.s,r):n}function m$(e,t,n){var r=e[t];return r?r.b:n}function v$(e,t,n){var r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function bte(e){switch(typeof e=="string"&&(e=Js[e]),e){case Js.DT_FLOAT:return"float32";case Js.DT_INT32:case Js.DT_INT64:case Js.DT_INT8:case Js.DT_UINT8:return"int32";case Js.DT_BOOL:return"bool";case Js.DT_DOUBLE:return"float32";case Js.DT_STRING:return"string";default:return null}}function y$(e,t,n){var r=e[t];return r&&r.type?bte(r.type):n}function b$(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map(function(i){return bte(i)}):n}function xte(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function x$(e,t,n){var r=e[t];return r&&r.shape?xte(r.shape):n}function w$(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):n}function _$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i&&i.list&&i.list.s?i.list.s.map(function(a){return yte(a,r)}):n}function S$(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return xte(i)}):n}function E$(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var G6e=function(){function e(t,n,r){var i=this;this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(a){return i.getInput(a)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(a,o){return a[o]=i.getAttr(o),a},{}))}return e.prototype.getInput=function(t){return Ea(t,this.tensorMap,this.context)},e.prototype.getAttr=function(t,n){var r=this.node.rawAttrs[t];if(r.tensor!=null)return Ea(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return v$(this.node.rawAttrs,t,n);if(r.s!=null)return g$(this.node.rawAttrs,t,n);if(r.b!=null)return m$(this.node.rawAttrs,t,n);if(r.shape!=null)return x$(this.node.rawAttrs,t,n);if(r.type!=null)return y$(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return w$(this.node.rawAttrs,t,n);if(r.list.s!=null)return _$(this.node.rawAttrs,t,n);if(r.list.shape!=null)return S$(this.node.rawAttrs,t,n);if(r.list.b!=null)return E$(this.node.rawAttrs,t,n);if(r.list.type!=null)return b$(this.node.rawAttrs,t,n)}return n},e}(),K6e=function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Ut($("a",e,t,n),$("b",e,t,n))];case"AddN":return[SM($("tensors",e,t,n))];case"FloorMod":case"Mod":return[Q3($("a",e,t,n),$("b",e,t,n))];case"Mul":return[rt($("a",e,t,n),$("b",e,t,n))];case"RealDiv":case"Div":return[Cr($("a",e,t,n),$("b",e,t,n))];case"DivNoNan":return[cE($("a",e,t,n),$("b",e,t,n))];case"FloorDiv":return[HS($("a",e,t,n),$("b",e,t,n))];case"Sub":return[Ar($("a",e,t,n),$("b",e,t,n))];case"Minimum":return[Om($("a",e,t,n),$("b",e,t,n))];case"Maximum":return[qu($("a",e,t,n),$("b",e,t,n))];case"Pow":return[Im($("a",e,t,n),$("b",e,t,n))];case"SquaredDifference":return[hE($("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},X6e=function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Nf($("x",e,t,n))];case"Acos":return[R3($("x",e,t,n))];case"Acosh":return[F3($("x",e,t,n))];case"Asin":return[M3($("x",e,t,n))];case"Asinh":return[P3($("x",e,t,n))];case"Atan":return[$3($("x",e,t,n))];case"Atan2":return[J3($("x",e,t,n),$("y",e,t,n))];case"Atanh":return[L3($("x",e,t,n))];case"Ceil":return[B3($("x",e,t,n))];case"Complex":return[ii($("real",e,t,n),$("imag",e,t,n))];case"Cos":return[z3($("x",e,t,n))];case"Cosh":return[j3($("x",e,t,n))];case"Elu":return[jm($("x",e,t,n))];case"Erf":return[U3($("x",e,t,n))];case"Exp":return[W3($("x",e,t,n))];case"Expm1":return[V3($("x",e,t,n))];case"Floor":return[US($("x",e,t,n))];case"Log":return[uc($("x",e,t,n))];case"Log1p":return[q3($("x",e,t,n))];case"Imag":return[os($("x",e,t,n))];case"Neg":return[Df($("x",e,t,n))];case"Reciprocal":return[H3($("x",e,t,n))];case"Real":return[to($("x",e,t,n))];case"Relu":return[Pf($("x",e,t,n))];case"Round":return[G3($("x",e,t,n))];case"Selu":return[kE($("x",e,t,n))];case"Sigmoid":return[VS($("x",e,t,n))];case"Sin":return[X3($("x",e,t,n))];case"Sign":return[K3($("x",e,t,n))];case"Sinh":return[Y3($("x",e,t,n))];case"Softplus":return[pb($("x",e,t,n))];case"Sqrt":return[gb($("x",e,t,n))];case"Square":return[dE($("x",e,t,n))];case"Tanh":return[qS($("x",e,t,n))];case"Tan":return[Z3($("x",e,t,n))];case"Relu6":case"ClipByValue":return[xa($("x",e,t,n),$("clipValueMin",e,t,n),$("clipValueMax",e,t,n))];case"Rsqrt":return[WS(Ea(e.inputNames[0],t,n))];case"Prod":return[AE($("x",e,t,n),$("axes",e,t,n))];case"LeakyRelu":return[CE($("x",e,t,n),$("alpha",e,t,n))];case"Prelu":return[Nb($("x",e,t,n),$("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},Y6e=function(){function e(t,n,r,i,a,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var n=this.tensors[t];if(n.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor},e.prototype.readMany=function(t){var n=this;return t.map(function(r){return n.read(r)})},e.prototype.write=function(t,n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+n.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=n.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,n.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");r.tensor=n,r.written=!0,this.tensors[t]=r},e.prototype.writeMany=function(t,n){var r=this;if(t.length!==n.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+n.length+".");t.forEach(function(i,a){return r.write(i,n[a])})},e.prototype.gather=function(t,n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+n);if(!t){t=[];for(var r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Mr([],[0].concat(this.elementShape));var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),ss(i,0)},e.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return Mr([],[0].concat(this.elementShape));for(var n=[],r=0;r<this.size();r++)n.push(r);var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),Hi(i,0)},e.prototype.scatter=function(t,n){if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);if(t.length!==n.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+n.shape[0]);var r=Math.max.apply(Math,t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(t,If(n,0))},e.prototype.split=function(t,n){var r=this;if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);var i=0,a=t.map(function(c){return i+=c});if(i!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+n.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=i===0?0:n.size/i,s=[];ue(function(){n=n.reshape([1,i,o]);for(var c=0;c<t.length;++c){var f=[0,c===0?0:a[c-1],0],d=[1,t[c],o];s[c]=Fo(n,f,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},e.prototype.assertShapesMatchAllowUndefinedSize=function(t,n,r){r===void 0&&(r=""),pt.assert(this.shapesEqualAllowUndefinedSize(t,n),function(){return r+" Shapes "+t+" and "+n+" must match"})},e.prototype.shapesEqualAllowUndefinedSize=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==-1&&n[r]!==-1&&t[r]!==n[r])return!1;return!0},e.nextId=0,e}(),Z6e=void 0,J6e=function(e,t,n){return rp(Z6e,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W,G,K,ee;return ip(this,function(ce){switch(ce.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[$("pred",e,t,n).clone()]];case 2:return r=$("pred",e,t,n),i=$("data",e,t,n),[4,r.data()];case 3:return[2,ce.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=e.inputNames.find(function(he){return Ea(he,t,n)!==void 0}))?[Ea(a,t,n).clone()]:void 0];case 5:return o=$("frameName",e,t,n),s=$("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=$("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=$("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=$("size",e,t,n),f=$("dtype",e,t,n),d=$("elementShape",e,t,n),h=$("dynamicSize",e,t,n),p=$("clearAfterRead",e,t,n),g=$("identicalElementShapes",e,t,n),m=$("name",e,t,n),v=new Y6e(m,f,c,d,g,h,p),n.addTensorArray(v),[2,[Ve(v.id),Ve(1)]];case 9:return y=$("tensorArrayId",e,t,n),b=$("index",e,t,n),x=$("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[Ve(1)]];case 10:return w=$("tensorArrayId",e,t,n),S=$("index",e,t,n),[2,[n.getTensorArray(w).read(S)]];case 11:return A=$("tensorArrayId",e,t,n),_=$("indices",e,t,n),E=$("dtype",e,t,n),[2,[n.getTensorArray(A).gather(_,E)]];case 12:return C=$("tensorArrayId",e,t,n),k=$("indices",e,t,n),T=$("tensor",e,t,n),n.getTensorArray(C).scatter(k,T),[2,[Ve(1)]];case 13:return I=$("tensorArrayId",e,t,n),N=n.getTensorArray(I),O=$("dtype",e,t,n),[2,[N.concat(O)]];case 14:return D=$("tensorArrayId",e,t,n),L=$("tensor",e,t,n),W=$("lengths",e,t,n),n.getTensorArray(D).split(W,L),[2,[Ve(1)]];case 15:return G=$("tensorArrayId",e,t,n),K=n.getTensorArray(G),[2,[Ve(K.size(),"int32")]];case 16:return ee=$("tensorArrayId",e,t,n),n.getTensorArray(ee).clearAndClose(),[2,[Ve(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}})})},Q6e=function(e,t,n){switch(e.op){case"Conv1D":var r=$("stride",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),o=$("dilation",e,t,n);return[pE($("x",e,t,n),$("filter",e,t,n),r,i,a,o)];case"Conv2D":r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase();var s=$("dilations",e,t,n);return[Hh($("x",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=$("fusedOps",e,t,n),l=u[0],c=u[1],f=l==="biasadd",d=c==="prelu",h=l==="fusedbatchnorm",p=$("numArgs",e,t,n);if(f){if(d&&p!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&p!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n);var g=$("args",e,t,n),m=g[0],v=g[1];return[(e.op==="_FusedConv2D"?Lf.conv2d:Lf.depthwiseConv2d)({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:m,activation:c,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=$("outputShape",e,t,n);return r=$("strides",e,t,n),i=$("pad",e,t,n),[mE($("x",e,t,n),$("filter",e,t,n),y,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=$("strides",e,t,n),i=$("pad",e,t,n),s=$("dilations",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),[Bm($("input",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n),[gE($("x",e,t,n),$("filter",e,t,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=$("strides",e,t,n),i=$("pad",e,t,n);var b=$("kernelSize",e,t,n);return[bE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[yE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n);var x=$("includeBatchInIndex",e,t,n),w=jM($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i,x);return[w.result,w.indexes];case"AvgPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[wE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[xE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},eje=function(e,t,n){switch(e.op){case"Fill":var r=$("shape",e,t,n),i=$("dtype",e,t,n),a=$("value",e,t,n);return[km(r,a,i)];case"LinSpace":var o=$("start",e,t,n),s=$("stop",e,t,n),u=$("num",e,t,n);return[x3(o,s,u)];case"Multinomial":var l=$("logits",e,t,n),c=$("numSamples",e,t,n),f=$("seed",e,t,n);return[OM(l,c,f)];case"OneHot":var d=$("indices",e,t,n),h=$("depth",e,t,n),p=$("onValue",e,t,n),g=$("offValue",e,t,n);return[Wh(d,h,p,g)];case"Ones":return[Vu($("shape",e,t,n),$("dtype",e,t,n))];case"OnesLike":return[Do($("x",e,t,n))];case"RandomUniform":return[Vh($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("dtype",e,t,n))];case"Range":o=$("start",e,t,n);var m=$("stop",e,t,n),v=$("step",e,t,n);return[Tm(o,m,v,$("dtype",e,t,n))];case"TruncatedNormal":r=$("shape",e,t,n);var y=$("mean",e,t,n),b=$("stdDev",e,t,n);return f=$("seed",e,t,n),[Eb(r,y,b,$("dtype",e,t,n),f)];case"Zeros":return[Tn($("shape",e,t,n),$("dtype",e,t,n))];case"ZerosLike":return[en($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},tje=void 0,nje=function(e,t,n){return rp(tje,void 0,void 0,function(){var r,i,a,o,s,u,l,c;return ip(this,function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=$("boxes",e,t,n),i=$("scores",e,t,n),a=$("maxOutputSize",e,t,n),o=$("iouThreshold",e,t,n),s=$("scoreThreshold",e,t,n),e.op!=="NonMaxSuppressionV5"?[3,3]:(u=$("softNmsSigma",e,t,n),[4,$f.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u)]);case 2:return[2,[(c=f.sent()).selectedIndices,c.selectedScores]];case 3:return[4,$f.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[f.sent()]];case 5:return l=$("condition",e,t,n).asType("bool"),[4,lE(l)];case 6:return c=[f.sent()],l.dispose(),[2,c];case 7:return[2,C3($("x",e,t,n),$("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}})})},rje=function(e,t,n){switch(e.op){case"TopKV2":var r=$("x",e,t,n),i=$("k",e,t,n),a=$("sorted",e,t,n),o=GM(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},ije=function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=$("default",e,t,n);return[Ea(e.name,t,n)||r];case"Placeholder":return[Ea(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[$("x",e,t,n).clone()];case"IdentityN":return $("x",e,t,n).map(function(l){return l.clone()});case"Snapshot":return[$("x",e,t,n).clone()];case"Shape":return[ba($("x",e,t,n).shape,"int32")];case"ShapeN":return $("x",e,t,n).map(function(l){return ba(l.shape)});case"Size":return[Ve($("x",e,t,n).size,"int32")];case"Rank":return[Ve($("x",e,t,n).rank,"int32")];case"NoOp":return[Ve(1)];case"Print":var i=$("x",e,t,n),a=$("data",e,t,n),o=$("message",e,t,n),s=$("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+e.op+" is not implemented")}},aje=function(e,t,n){switch(e.op){case"ResizeBilinear":var r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n);return[$f.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n),[$f.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=$("image",e,t,n),s=$("boxes",e,t,n),u=$("boxInd",e,t,n),l=$("cropSize",e,t,n),c=$("method",e,t,n),f=$("extrapolationValue",e,t,n);return[$f.cropAndResize(o,s,u,l,c,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},oje=function(e,t,n){switch(e.op){case"Equal":return[qh($("a",e,t,n),$("b",e,t,n))];case"NotEqual":return[$m($("a",e,t,n),$("b",e,t,n))];case"Greater":return[Pm($("a",e,t,n),$("b",e,t,n))];case"GreaterEqual":return[Ab($("a",e,t,n),$("b",e,t,n))];case"Less":return[MM($("a",e,t,n),$("b",e,t,n))];case"LessEqual":return[PM($("a",e,t,n),$("b",e,t,n))];case"LogicalAnd":return[Gu($("a",e,t,n),$("b",e,t,n))];case"LogicalNot":return[TM($("a",e,t,n))];case"LogicalOr":return[uE($("a",e,t,n),$("b",e,t,n))];case"Select":case"SelectV2":return[Gs($("condition",e,t,n),$("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},sje=function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[vE($("a",e,t,n),$("b",e,t,n),$("transposeA",e,t,n),$("transposeB",e,t,n))];case"Transpose":return[cn($("x",e,t,n),$("perm",e,t,n))];case"_FusedMatMul":var r=$("fusedOps",e,t,n),i=r[0],a=r[1],o=i==="biasadd",s=a==="prelu",u=$("numArgs",e,t,n);if(o){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=$("args",e,t,n),c=l[0],f=l[1];return[Lf.matMul({a:$("a",e,t,n),b:$("b",e,t,n),transposeA:$("transposeA",e,t,n),transposeB:$("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}},uje=function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Uh($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"LRN":return[VM($("x",e,t,n),$("radius",e,t,n),$("bias",e,t,n),$("alpha",e,t,n),$("beta",e,t,n))];case"Softmax":return[Ph($("x",e,t,n))];case"LogSoftmax":return[ZS($("x",e,t,n))];case"SparseToDense":return[OE($("sparseIndices",e,t,n),$("outputShape",e,t,n),$("sparseValues",e,t,n),$("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},lje=function(e,t,n){switch(e.op){case"Max":var r=$("axis",e,t,n),i=$("keepDims",e,t,n);return[Mf($("x",e,t,n),r,i)];case"Mean":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Pr($("x",e,t,n),r,i)];case"Min":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[EE($("x",e,t,n),r,i)];case"Sum":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Hr($("x",e,t,n),r,i)];case"All":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[SE($("x",e,t,n),r,i)];case"Any":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Tb($("x",e,t,n),r,i)];case"ArgMax":return r=$("axis",e,t,n),[Ob($("x",e,t,n),r)];case"ArgMin":return r=$("axis",e,t,n),[UM($("x",e,t,n),r)];case"Prod":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[AE($("x",e,t,n),r,i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},cje=function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=$("n",e,t,n),i=$("axis",e,t,n),a=$("tensors",e,t,n);return a=a.slice(0,r),[Hi(a,i)];case"GatherV2":case"Gather":i=$("axis",e,t,n);var o=$("x",e,t,n),s=$("indices",e,t,n);return[Lm(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=$("axis",e,t,n),o=$("x",e,t,n),[Xu(o,i)];case"Slice":var u=$("begin",e,t,n),l=$("size",e,t,n);return[Fo($("x",e,t,n),u,l)];case"StridedSlice":u=$("begin",e,t,n);var c=$("end",e,t,n),f=$("strides",e,t,n),d=$("beginMask",e,t,n),h=$("endMask",e,t,n),p=$("ellipsisMask",e,t,n),g=$("newAxisMask",e,t,n),m=$("shrinkAxisMask",e,t,n),v=$("x",e,t,n);if(u.length===1&&v.shape.length>1)for(var y=1;y<v.shape.length;y++)u.push(0),c.push(v.shape[y]),f.push(f[0]);return[HM(v,u,c,f,d,h,p,g,m)];case"Pack":return ue(function(){var C=$("axis",e,t,n),k=$("tensors",e,t,n),T=k[0].shape,I=k[0].squeeze().shape,N=k.map(function(O){var D=pt.arraysEqual(O.shape,T);if(!D&&!pt.arraysEqual(O.squeeze().shape,I))throw new Error("the input tensors shape does not match");return D?O:O.reshape(T)});return[ss(N,C)]});case"Unpack":return ue(function(){var C=$("axis",e,t,n),k=$("tensor",e,t,n);return If(k,C)});case"Tile":var b=$("reps",e,t,n);return[lc($("x",e,t,n),b)];case"Split":case"SplitV":i=$("axis",e,t,n);var x=$("numOrSizeSplits",e,t,n);return oc($("x",e,t,n),x,i);case"ScatterNd":s=$("indices",e,t,n);var w=$("values",e,t,n),S=$("shape",e,t,n);return[KM(s,w,S)];case"GatherNd":var A=$("x",e,t,n);return s=$("indices",e,t,n),[XM(A,s)];case"SparseToDense":s=$("sparseIndices",e,t,n),S=$("outputShape",e,t,n);var _=$("sparseValues",e,t,n),E=$("defaultValue",e,t,n);return[OE(s,_,S,_.dtype===E.dtype?E:E.asType(_.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}},fje=function(e,t,n){switch(e.op){case"FFT":return[Db($("x",e,t,n))];case"IFFT":return[Um($("x",e,t,n))];case"RFFT":return[Rb($("x",e,t,n))];case"IRFFT":return[TE($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},dje=function(e,t,n){switch(e.op){case"Cast":return[$S($("x",e,t,n),$("dtype",e,t,n))];case"ExpandDims":var r=$("axis",e,t,n);return[Ro($("x",e,t,n),r)];case"Squeeze":return r=$("axis",e,t,n),[fb($("x",e,t,n),r)];case"Reshape":return[qs($("x",e,t,n),$("shape",e,t,n))];case"PadV2":case"Pad":return[Ku($("x",e,t,n),p$($("padding",e,t,n),2),$("constantValue",e,t,n))];case"SpaceToBatchND":var i=$("blockShape",e,t,n),a=p$($("paddings",e,t,n),2);return[LS($("x",e,t,n),i,a)];case"BatchToSpaceND":i=$("blockShape",e,t,n);var o=p$($("crops",e,t,n),2);return[PS($("x",e,t,n),i,o)];case"DepthToSpace":var s=$("blockSize",e,t,n),u=$("dataFormat",e,t,n).toUpperCase();return[A3($("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function wte(e,t,n){var r=function(i,a,o){switch(i.category){case"arithmetic":return ue(function(){return K6e(i,a,o)});case"basic_math":return ue(function(){return X6e(i,a,o)});case"control":return J6e(i,a,o);case"convolution":return ue(function(){return Q6e(i,a,o)});case"creation":return ue(function(){return eje(i,a,o)});case"dynamic":return nje(i,a,o);case"evaluation":return ue(function(){return rje(i,a,o)});case"image":return ue(function(){return aje(i,a,o)});case"graph":return ue(function(){return ije(i,a,o)});case"logical":return ue(function(){return oje(i,a,o)});case"matrices":return ue(function(){return sje(i,a,o)});case"normalization":return ue(function(){return uje(i,a,o)});case"reduction":return ue(function(){return lje(i,a,o)});case"slice_join":return ue(function(){return cje(i,a,o)});case"spectral":return ue(function(){return fje(i,a,o)});case"transformation":return ue(function(){return dje(i,a,o)});case"custom":var s=vte(i.op);if(s&&s.customExecutor)return s.customExecutor(new G6e(i,a,o));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var _te=function(){function e(t,n){this.weightMap=t,this.tensorArrayMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(t,n){return{id:t,frameName:n,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var t=[],n=0;n<this.contexts.length-1;n++){var r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t},e.prototype.contextIdforContexts=function(t){return t?t.map(function(n){return n.id===0&&n.iterationId===0?"":n.frameName+"-"+n.iterationId}).join("/"):""},e.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(t){return this.weightMap[t]},e.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},e.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},e}();function Ste(e,t,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(e).map(function(f){return Lo(f)[0]}),l=t.slice();l.length>0;){var c=l.pop();(Ete(c)||mje(c))&&a==null&&(o=(a=c).children.map(function(f){return f.name}).filter(function(f){return r.has(f)})),r.add(c.name),n[c.name]==null&&u.indexOf(c.name)===-1&&(c.inputs.length!==0?c.inputs.forEach(function(f){s.has(f.name)||(s.add(f.name),l.push(f))}):i.push(c.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function hje(e,t,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map(function(l){return Lo(l)[0]}).map(function(l){return e.nodes[l]}).forEach(function(l){r.has(l.name)&&a.push(l)}),e.weights.forEach(function(l){r.has(l.name)&&a.push(l)});for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach(function(l){!o.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return o.has(c.name)})&&a.push(l)})}return s}var pje=["Switch","Merge","Enter","Exit","NextIteration"],gje=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Ete(e){return pje.indexOf(e.op)>=0}function mje(e){return gje.indexOf(e.op)>=0}var vje=function(){function e(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var n=Object.keys(t).map(function(r){return t[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],n),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(t,n){var r=t.map(function(a){return a.name}).sort(),i=n.map(function(a){return a.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},e.prototype.compile=function(t,n){var r=Ste(t,n,this.weightMap),i=r.missingInputs,a=r.dynamicNode,o=r.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+o+"]");if(i.length>0){var s=n.map(function(l){return l.name}),u=Object.keys(t);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return hje(this.graph,this.weightMap,r)},e.prototype.execute=function(t,n){var r=this;t=this.mapInputs(t);var i=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);var a=i.map(function(c){return r.graph.nodes[Lo(c)[0]]}),o=n.map(function(c){return r.graph.nodes[Lo(c)[0]]}),s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);u==null&&(u=this.compile(t,o),this.compiledMap.set(s,u));var l={};return ue(function(){var c=new _te(r._weightMap,l),f=h$({},r.weightMap);Object.keys(t).forEach(function(v){var y=Lo(v),b=y[0],x=[];x[y[1]]=t[v],f[b]=x});for(var d=r.getFrozenTensorIds(f),h={},p=0;p<u.length;p++){var g=u[p];if(!f[g.name]){var m=wte(g,f,c);if(m instanceof Promise)throw new Error("The execution of the op '"+g.op+"' returned a promise. Please use model.executeAsync() instead.");f[g.name]=m,r.checkTensorForDisposal(g.name,g,f,c,d,n,h)}}return n.map(function(v){return Ea(v,f,c)})})},e.prototype.getFrozenTensorIds=function(t){var n=[].concat.apply([],Object.keys(t).map(function(r){return t[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(n)},e.prototype.checkTensorForDisposal=function(t,n,r,i,a,o,s){n.category!=="control"&&o.indexOf(t)===-1&&(r[t].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+n.children.length)}),n.inputs.forEach(function(u){if(u.category!=="control"){var l=d6e(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!a.has(c.id)){var f=s[c.id];f===1?(c.dispose(),delete s[c.id]):f!=null&&s[c.id]--}})}}))},e.prototype.executeAsync=function(t,n){return rp(this,void 0,void 0,function(){var r,i,a,o,s,u,l=this;return ip(this,function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),r={},i=new _te(this._weightMap,r),[4,this.executeWithControlFlow(t,i,n)];case 1:return a=c.sent(),o=n.map(function(f){return Ea(f,a,i)}),s=new Set(o.map(function(f){return f.id})),u=new Set(Object.keys(t).map(function(f){return t[f].id})),Object.keys(a).forEach(function(f){a[f].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,o]}})})},e.prototype.executeWithControlFlow=function(t,n,r){return rp(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x=this;return ip(this,function(w){switch(w.label){case 0:i=Object.keys(t),a=i.map(function(S){return x.graph.nodes[Lo(S)[0]]}),o=r.map(function(S){return x.graph.nodes[Lo(S)[0]]}),s=Ste(t,o,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,f=s.syncInputs,d=a.concat(this.graph.weights).map(function(S){return{node:S,contexts:n.currentContext}}),h=h$({},this.weightMap),Object.keys(t).forEach(function(S){var A=Lo(S),_=A[0],E=[];E[A[1]]=t[S],h[_]=E}),p={},g=this.getFrozenTensorIds(h),m={},w.label=1;case 1:return d.length>0?(v=this.processStack(a,d,n,h,m,g,r,p,u),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(S){return!Ete(S)&&!Ea(S.name,h,n)}).map(function(S){return S.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+f+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,h]}})})},e.prototype.processStack=function(t,n,r,i,a,o,s,u,l){for(var c=this,f=[],d=function(){var p=n.pop();r.currentContext=p.contexts;var g="";if(p.node.op==="Enter"&&$("isConstant",p.node,i,r)&&(g=iv(p.node.name,r)[0]),t.indexOf(p.node)===-1){var m=wte(p.node,i,r);g||(g=iv(p.node.name,r)[0]);var v=r.currentContext;m instanceof Promise?f.push(m.then(function(y){return i[g]=y,r.currentContext=v,c.checkTensorForDisposal(g,p.node,i,r,o,s,u),c.processChildNodes(p.node,n,r,i,a,l),y})):(i[g]=m,h.checkTensorForDisposal(g,p.node,i,r,o,s,u),h.processChildNodes(p.node,n,r,i,a,l))}else h.processChildNodes(p.node,n,r,i,a,l)},h=this;n.length>0;)d();return f},e.prototype.processChildNodes=function(t,n,r,i,a,o){t.children.forEach(function(s){var u=iv(s.name,r)[0];!a[u]&&o.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})))})},e.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(n){return t.weightMap[n].forEach(function(r){return r.dispose()})})},e.prototype.checkInputShapeAndType=function(t){var n=this;Object.keys(t).forEach(function(r){var i=t[r],a=Lo(r)[0],o=n.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===i.shape.length&&i.shape.every(function(l,c){return s[c]===-1||s[c]===l});pt.assert(u,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&pt.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},e.prototype.mapInputs=function(t){var n={};for(var r in t)this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null?n[this._signature.inputs[r].name]=t[r]:n[r]=t[r];return n},e.prototype.checkInputs=function(t){var n=this,r=Object.keys(t).filter(function(i){var a=Lo(i)[0];return n.graph.nodes[a]==null});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},e.prototype.mapOutputs=function(t){var n=this;return t.map(function(r){return n._signature!=null&&n._signature.outputs!=null&&n._signature.outputs[r]!=null?n._signature.outputs[r].name:r},{})},e.prototype.checkOutputs=function(t){var n=this;t.forEach(function(r){var i=Lo(r)[0];if(!n.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},e}();(function(){function e(t,n){n===void 0&&(n={}),this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=wa.browserHTTPRequest(t,this.loadOptions);else{var n=wa.getLoadHandlers(t,this.loadOptions.onProgress);if(n.length===0)n.push(wa.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error("Found more than one ("+n.length+") load handlers for URL '"+[t]+"'");this.handler=n[0]}},e.prototype.load=function(){return rp(this,void 0,void 0,function(){var t,n,r,i;return ip(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),n=this.artifacts.modelTopology,r={},this.artifacts.userDefinedMetadata!=null&&(r=this.artifacts.userDefinedMetadata.signature),this.version=n.versions.producer+"."+n.versions.minConsumer,i=wa.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new vje(q6e.Instance.transformGraph(n,r)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),[2,!0]}})})},e.prototype.save=function(t,n){return rp(this,void 0,void 0,function(){var r;return ip(this,function(i){if(typeof t=="string"){if((r=wa.getSaveHandlers(t)).length===0)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new Error("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]})})},e.prototype.predict=function(t,n){return this.execute(t,this.outputNodes)},e.prototype.normalizeInputs=function(t){if(!(t instanceof Ht||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(n,r,i){return n[r]=t[i],n},{})},e.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},e.prototype.execute=function(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);var r=this.executor.execute(t,n);return r.length>1?r:r[0]},e.prototype.executeAsync=function(t,n){return rp(this,void 0,void 0,function(){var r;return ip(this,function(i){switch(i.label){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),[4,this.executor.executeAsync(t,n)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},e.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=[t[r]],n},{})},e.prototype.dispose=function(){this.executor.dispose()},e})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ate=function(e,t){return(Ate=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function On(e,t){function n(){this.constructor=e}Ate(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function He(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Ge(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function ap(e,t){return e(t={exports:{}},t.exports),t.exports}var yje=ap(function(e){(function(t,n,r){function i(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}function a(o,s){var u=new function(f){var d,h=this,p=(d=4022871197,function(g){g=g.toString();for(var m=0;m<g.length;m++){var v=.02519603282416938*(d+=g.charCodeAt(m));v-=d=v>>>0,d=(v*=d)>>>0,d+=4294967296*(v-=d)}return 23283064365386963e-26*(d>>>0)});h.next=function(){var g=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=g-(h.c=0|g)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(f),h.s0<0&&(h.s0+=1),h.s1-=p(f),h.s1<0&&(h.s1+=1),h.s2-=p(f),h.s2<0&&(h.s2+=1),p=null}(o),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),bje=ap(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s}function a(o,s){var u=new function(f){var d=this,h="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var g=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^g^g>>>8},f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),xje=ap(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s.v=o.v,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^g^g<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),p==h.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),wje=ap(function(e){(function(t,n,r){function i(o,s){return s.x=o.x.slice(),s.i=o.i,s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.x,m=d.i;return h=g[m],p=(h^=h>>>7)^h<<24,p^=(h=g[m+1&7])^h>>>10,p^=(h=g[m+3&7])^h>>>3,p^=(h=g[m+4&7])^h<<7,h=g[m+7&7],p^=(h^=h<<13)^h<<9,g[m]=p,d.i=m+1&7,p},function(h,p){var g,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,g=0;g<p.length;++g)m[7&g]=m[7&g]<<15^p.charCodeAt(g)+m[g+1&7]<<13;for(;m.length<8;)m.push(0);for(g=0;g<8&&m[g]===0;++g);for(g==8?m[7]=-1:m[g],h.x=m,h.i=0,g=256;g>0;--g)h.next()}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),_je=ap(function(e){(function(t,n,r){function i(o,s){return s.i=o.i,s.w=o.w,s.X=o.X.slice(),s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.w,m=d.X,v=d.i;return d.w=g=g+1640531527|0,p=m[v+34&127],h=m[v=v+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[v]=p^h,d.i=v,p+(g^g>>>16)|0},function(h,p){var g,m,v,y,b,x=[],w=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,w=Math.max(w,p.length)),v=0,y=-32;y<w;++y)p&&(m^=p.charCodeAt((y+32)%p.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,v=(g=x[127&y]^=m+b)==0?v+1:0);for(v>=128&&(x[127&(p&&p.length||0)]=-1),v=127,y=512;y>0;--y)m=x[v+34&127],g=x[v=v+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,x[v]=m^g;h.w=b,h.X=x,h.i=v}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),Sje=ap(function(e){(function(t,n,r){function i(o,s){return s.a=o.a,s.b=o.b,s.c=o.c,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.b,m=d.c,v=d.d,y=d.a;return g=g<<25^g>>>7^m,m=m-v|0,v=v<<24^v>>>8^y,y=y-g|0,d.b=g=g<<20^g>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^y,d.a=y-g|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,f===Math.floor(f)?(d.a=f/4294967296|0,d.b=0|f):h+=f;for(var p=0;p<h.length+20;p++)d.b^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),op=ap(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(m,v,y){var b=[],x=p(function A(_,E){var C,k=[],T=typeof _;if(E&&T=="object")for(C in _)try{k.push(A(_[C],E-1))}catch(I){}return k.length?k:T=="string"?_:_+"\0"}((v=v==1?{entropy:!0}:v||{}).entropy?[m,g(t)]:m??function(){try{var A;return r&&(A=r.randomBytes)?A=A(a):(A=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(A)),g(A)}catch(C){var _=i.navigator,E=_&&_.plugins;return[+new Date,i,E,i.screen,g(t)]}}(),3),b),w=new function(A){var _,E=A.length,C=this,k=0,T=C.i=C.j=0,I=C.S=[];for(E||(A=[E++]);k<a;)I[k]=k++;for(k=0;k<a;k++)I[k]=I[T=f&T+A[k%E]+(_=I[k])],I[T]=_;(C.g=function(N){for(var O,D=0,L=C.i,W=C.j,G=C.S;N--;)O=G[L=f&L+1],D=D*a+G[f&(G[L]=G[W=f&W+O])+(G[W]=O)];return C.i=L,C.j=W,D})(a)}(b),S=function(){for(var A=w.g(o),_=u,E=0;A<l;)A=(A+E)*a,_*=a,E=w.g(1);for(;A>=c;)A/=2,_/=2,E>>>=1;return(A+E)/_};return S.int32=function(){return 0|w.g(4)},S.quick=function(){return w.g(4)/4294967296},S.double=S,p(g(w.S),t),(v.pass||y||function(A,_,E,C){return C&&(C.S&&h(C,w),A.state=function(){return h(w,{})}),E?(n[s]=A,_):A})(S,x,"global"in v?v.global:this==n,v.state)}function h(m,v){return v.i=m.i,v.j=m.j,v.S=m.S.slice(),v}function p(m,v){for(var y,b=m+"",x=0;x<b.length;)v[f&x]=f&(y^=19*v[f&x])+b.charCodeAt(x++);return g(v)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,p(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(m){}}})([],Math)});op.alea=yje,op.xor128=bje,op.xorwow=xje,op.xorshift7=wje,op.xor4096=_je,op.tychei=Sje;var Eje=op,Cte=Eje.alea;function Aje(e,t){return aA(e,t)}function aA(e,t,n,r){if(n===void 0&&(n=new Map),r===void 0&&(r=new Set),e==null)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(oA(e)){var a=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=aA(e[o],t,n,r);a[o]=s}return r.delete(e),a}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,i.value),i.value}function Cje(e,t){return t===void 0&&(t=Tte),kte(e,t)}function kte(e,t,n){n===void 0&&(n=new Set);var r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(oA(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(u){var l=kte(e.map(function(c){return c[u]}),t,n);a[u]=l};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function Tte(e){return e===null?null:oA(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function kje(e,t){return He(this,void 0,void 0,function(){var n,r,i,a,o,s;return Ge(this,function(u){switch(u.label){case 0:n=new Map,aA(e,t,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=i[r],(o=n.get(a))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(a,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,aA(e,t,n)]}})})}function oA(e){return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ht))}function Tje(e){return e==null||Oje(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ht||pt.isTypedArray(e)}function Oje(e){return e===null||typeof e!="object"&&typeof e!="function"}function Ije(e){return Aje(e,Nje)}function Nje(e){return e instanceof Ht?{value:e.clone(),recurse:!1}:oA(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Ote=function(){function e(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return e.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},e.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},e.prototype.set=function(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n},e.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return this.length()===0},e.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.push(i)}},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},e.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},e.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r},e}(),Dje=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return On(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,n)},t.prototype.unshift=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,n)},t.prototype.expand=function(){for(var n=2*this.capacity,r=new Array(n),i=this.length(),a=0;a<i;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=n,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},t.INITIAL_CAPACITY=32,t}(Ote);function Rje(e){return new Pje(e)}function Fje(e){return new $je(e)}function Mje(e,t){return new Nte(e,t)}var av,ai=function(){function e(){}return e.prototype.toArray=function(){return He(this,void 0,void 0,function(){var t,n;return Ge(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,this.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,t]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){var t,n,r;return Ge(this,function(i){switch(i.label){case 0:return t=this.prefetch(100),n=[],[4,t.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(n.push(r.value),[4,t.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,n]}})})},e.prototype.resolveFully=function(){return He(this,void 0,void 0,function(){var t;return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=n.sent(),[3,2];case 4:return[2]}})})},e.prototype.resolveWhile=function(t){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:n=i.sent(),r=t(n.value),i.label=2;case 2:return n.done||!r?[3,4]:[4,this.next()];case 3:return n=i.sent(),r=t(n.value),[3,2];case 4:return[2]}})})},e.prototype.handleErrors=function(t){return new Vje(this,t)},e.prototype.filter=function(t){return new Uje(this,t)},e.prototype.map=function(t){return new Wje(this,t)},e.prototype.mapAsync=function(t){return new Ite(this,t)},e.prototype.serialMapAsync=function(t){return new Ite(this,t).serial()},e.prototype.flatmap=function(t){return new qje(this,t)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.map(t).resolveFully()]})})},e.prototype.serialForEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.serialMapAsync(t).resolveWhile(function(r){return r===!0})]})})},e.prototype.rowMajorBatch=function(t,n){return n===void 0&&(n=!0),new jje(this,t,n)},e.prototype.columnMajorBatch=function(t,n,r){return n===void 0&&(n=!0),r===void 0&&(r=Tte),this.rowMajorBatch(t,n).map(function(i){return Cje(i,r)})},e.prototype.concatenate=function(t,n){return new Nte(Rje([this,t]),n)},e.prototype.take=function(t){return t<0||t==null?this:new zje(this,t)},e.prototype.skip=function(t){return t<0||t==null?this:new Bje(this,t)},e.prototype.prefetch=function(t){return new Dte(this,t)},e.prototype.shuffle=function(t,n){return new Hje(this,t,n)},e.prototype.serial=function(){return new Lje(this)},e}(),Pje=function(e){function t(n){var r=e.call(this)||this;return r.items=n,r.trav=0,r}return On(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(n=this.items[this.trav],this.trav++,[2,{value:Ije(n),done:!1}])})})},t}(ai),$je=function(e){function t(n){var r=e.call(this)||this;return r.nextFn=n,r}return On(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},t}(ai),Lje=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.upstream.next()]})})},t}(ai),Bje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(n=r.sent()).done?[2,n]:(jt(n.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(ai),zje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(ai),jje=function(e){function t(n,r,i){i===void 0&&(i=!0);var a=e.call(this)||this;return a.upstream=n,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:n=[],i.label=1;case 1:return n.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&n.length>0?[2,{value:n,done:!1}]:[2,{value:null,done:!0}]:(n.push(r.value),[3,1]);case 3:return[2,{value:n,done:!1}]}})})},t}(ai),Uje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(n=r.sent()).done||this.predicate(n.value)?[2,n]:(jt(n.value),[3,0]);case 2:return[2]}})})},t}(ai),Wje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,{value:null,done:!0}];for(r=Bu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Bu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ai),Vje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handler(n)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(ai),Ite=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(n=l.sent()).done?[2,{value:null,done:!0}]:(r=Bu.getTensorsInContainer(n.value),[4,this.transform(n.value)]);case 2:for(i=l.sent(),a=Bu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ai),A$=function(e){function t(){var n=e.call(this)||this;return n.outputQueue=new Dje,n.lastRead=Promise.resolve({value:null,done:!1}),n}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return n.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(ai),qje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,!1];for(r=Bu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Bu.getTensorsInContainer(i),this.outputQueue.pushAll(i),o=0,s=r;o<s.length;o++)u=s[o],Bu.isTensorInList(u,a)||u.dispose();return[2,!0]}})})},t}(A$),Nte=function(e){function t(n,r){var i=e.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=n,i}return On(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(n){return He(this,void 0,void 0,function(){var r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,n];case 1:return a.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=a.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),a.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=a.sent()).done?(this.iterator=null,[2,this.readFromChain(n)]):[2,i]}})})},t}(ai);(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(av||(av={})),function(e){function t(n,r){r===void 0&&(r=av.FAIL);var i=e.call(this)||this;return i.iterators=n,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return On(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(n){return He(this,void 0,void 0,function(){function r(s){return s instanceof ai?{value:s.next().then(function(u){return i++,u.done&&a++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,n];case 1:return s.sent(),i=0,a=0,[4,kje(this.iterators,r)];case 2:if(o=s.sent(),i===a)return[2,{value:null,done:!0}];if(a>0)switch(this.mismatchMode){case av.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case av.SHORTEST:return[2,{value:null,done:!0}];case av.LONGEST:}return this.count++,[2,{value:o,done:!1}]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(ai);var Dte=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.bufferSize=r,i.buffer=new Ote(r),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var n=this.upstream.next();this.buffer.push(n)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(ai),Hje=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.upstream=n,a.windowSize=r,a.upstreamExhausted=!1,a.random=Cte(i||pt.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(n){return Math.floor(this.random()*n)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(n=this.chooseIndex(),[4,this.buffer.shuffleExcise(n)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},t}(Dte),C$=function(){function e(){this.size=null}return e.prototype.batch=function(t,n){var r=this;n===void 0&&(n=!0);var i=this;return pt.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),Qu(function(){return He(r,void 0,void 0,function(){return Ge(this,function(a){switch(a.label){case 0:return[4,i.iterator()];case 1:return[2,a.sent().columnMajorBatch(t,n,Gje)]}})})},this.size===1/0||this.size==null?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t))},e.prototype.concatenate=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){var i,a;return Ge(this,function(o){switch(o.label){case 0:return[4,r.iterator()];case 1:return a=(i=o.sent()).concatenate,[4,t.iterator()];case 2:return[2,a.apply(i,[o.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},e.prototype.filter=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(a){return ue(function(){return t(a)})})]}})})},this.size===1/0?1/0:null)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.iterator()];case 1:return[2,n.sent().forEachAsync(t)]}})})},e.prototype.forEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return NS("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},e.prototype.map=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(a){return ue(function(){return t(a)})})]}})})},this.size)},e.prototype.mapAsync=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(t)]}})})},this.size)},e.prototype.prefetch=function(t){var n=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(t)]}})})},this.size)},e.prototype.repeat=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){var i=this;return Ge(this,function(a){return[2,Mje(Fje(function(){return He(i,void 0,void 0,function(){var o;return Ge(this,function(s){switch(s.label){case 0:return o={},[4,r.iterator()];case 1:return[2,(o.value=s.sent(),o.done=!1,o)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},e.prototype.skip=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},e.prototype.shuffle=function(t,n,r){var i=this;if(r===void 0&&(r=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,o=Cte(n||pt.now().toString());return Qu(function(){return He(i,void 0,void 0,function(){var s;return Ge(this,function(u){switch(u.label){case 0:return s=o.int32(),r&&(s+=o.int32()),[4,a.iterator()];case 1:return[2,u.sent().shuffle(t,s.toString())]}})})},this.size)},e.prototype.take=function(t){var n=this,r=this;return Qu(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},e.prototype.toArray=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},e.MAX_BUFFER_SIZE=1e4,e}();function Qu(e,t){return t===void 0&&(t=null),new(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.size=t,i}return On(r,n),r.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(i){return[2,e()]})})},r}(C$))}function Gje(e){return e===null?null:Tje(e[0])?{value:Kje(e),recurse:!1}:{value:null,recurse:!0}}function Kje(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ht?ss(e):Mr(e)}var Xje=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return n=i.sent(),r=n.decodeUTF8(),[2,r.split(`
`).map(function(a){return a.endsWith("\r")&&(a=a.slice(0,-1)),a})]}})})},t}(C$),sA='"',Zb=Symbol("out"),Rte=Symbol("field"),uA=Symbol("quote"),k$=Symbol("quoteafterquote"),Fte=Symbol("quoteinquote");(function(e){function t(n,r){var i=e.call(this)||this;return i.input=n,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new Xje(n),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(pt.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return On(t,e),t.prototype.columnNames=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u=this;return Ge(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(n=l.sent(),!this.fullColumnNames&&!n)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&n&&pt.assert(n.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+n.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=n),r=this.fullColumnNames.reduce(function(c,f){return c[f]=c[f]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),pt.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(a=0,o=Object.keys(this.columnConfigs);a<o.length;a++)if(s=o[a],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((n=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=n.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r=this;return Ge(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return n=i.sent(),this.hasHeader&&(n=n.skip(1)),[2,n.map(function(a){return r.makeDataElement(a)})]}})})},t.prototype.makeDataElement=function(n){for(var r=this.parseRow(n),i={},a={},o=0;o<this.fullColumnNames.length;o++){var s=this.fullColumnNames[o],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[o],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+n);c=void 0}else{var f=Number(l);if(isNaN(f))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}else c=f}u&&u.isLabel?a[s]=c:i[s]=c}}return Object.keys(a).length===0?i:{xs:i,ys:a}},t.prototype.getBoolean=function(n){return n==="1"||n.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(n,r){r===void 0&&(r=!0);for(var i=[],a=0,o=n.length,s=Zb,u=0;u<o;u++)switch(s){case Zb:switch(n.charAt(u)){case sA:a=u+1,s=uA;break;case this.delimiter:if(a=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=Zb;break;default:s=Rte,a=u}break;case Rte:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u)),s=Zb,a=u+1}break;case uA:switch(n.charAt(u)){case sA:s=k$}break;case k$:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u-1)),s=Zb,a=u+1;break;case sA:s=uA;break;default:s=Fte}break;case Fte:switch(n.charAt(u)){case sA:s=uA}}if(s===k$?i.push(n.substring(a,o-1)):i.push(n.substring(a)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},t})(C$),function(e){function t(n){var r=e.call(this)||this;r.microphoneConfig=n,r.isClosed=!1,r.fftSize=n.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=n.numFramesPerSpectrogram||43,r.sampleRateHz=n.sampleRateHz,r.columnTruncateLength=n.columnTruncateLength||r.fftSize,r.audioTrackConstraints=n.audioTrackConstraints,r.smoothingTimeConstant=n.smoothingTimeConstant||0,r.includeSpectrogram=n.includeSpectrogram!==!1,r.includeWaveform=n.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return On(t,e),t.prototype.summary=function(){return"microphone"},t.create=function(n){return n===void 0&&(n={}),He(this,void 0,void 0,function(){var r;return Ge(this,function(i){switch(i.label){case 0:if(pe().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new t(n)).start()];case 1:return i.sent(),[2,r]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i,a;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return n.stream=o.sent(),[3,3];case 2:throw r=o.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return a=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,a.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(a=this.flattenQueue(i.freqDataQueue),n=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(o=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:n,waveform:r},done:!1}]}})})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.getAudioData=function(){return He(this,void 0,void 0,function(){var n,r,i,a=this;return Ge(this,function(o){return n=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){a.includeSpectrogram&&(a.analyser.getFloatFrequencyData(a.freqData),a.freqData[0]===-1/0&&s({freqDataQueue:n,timeDataQueue:r}),n.push(a.freqData.slice(0,a.columnTruncateLength))),a.includeWaveform&&(a.analyser.getFloatTimeDomainData(a.timeData),r.push(a.timeData.slice())),++i===a.numFrames&&(clearInterval(u),s({freqDataQueue:n,timeDataQueue:r}))},a.fftSize/a.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(n){var r=n[0].length,i=new Float32Array(n.length*r);return n.forEach(function(a,o){return i.set(a,o*r)}),i},t.prototype.getTensorFromAudioDataArray=function(n,r){var i=new Float32Array(pt.sizeFromShape(r));return i.set(n,i.length-n.length),Mr(i,r)},t}(ai),function(e){function t(n,r){var i=e.call(this)||this;if(i.webcamVideoElement=n,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=ba([0],"int32"),i.webcamConfig.centerCrop){var a=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,o=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,l=s+a,c=o+u;i.cropBox=Wu([u,s,c,l],[1,4])}else i.cropBox=Wu([0,0,1,1],[1,4]);return i}return On(t,e),t.prototype.summary=function(){return"webcam"},t.create=function(n,r){return r===void 0&&(r={}),He(this,void 0,void 0,function(){var i;return Ge(this,function(a){switch(a.label){case 0:if(pe().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!n){if(n=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");n.width=r.resizeWidth,n.height=r.resizeHeight}return[4,(i=new t(n,r)).start()];case 1:return a.sent(),[2,i]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:this.webcamConfig.facingMode&&pt.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),a.label=1;case 1:return a.trys.push([1,3,,4]),n=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return n.stream=a.sent(),[3,4];case 3:throw(r=a.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(o){console.log(o),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(o){i.webcamVideoElement.onloadedmetadata=function(){o()}})]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{n=HJ.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:n,done:!1}];try{return[2,{value:this.cropAndResizeFrame(n),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{n.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(n){var r=this;return ue(function(){var i,a=n.toFloat().expandDims(0),o=(i=$f.cropAndResize(a,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(o.slice(1))})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(n){return n.stop()});try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(ai);var Mte=function(){return function(){}}(),Pte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.split=function(n){return new Yje(this,n)},t}(ai),Yje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.impl=new Zje(n,r),i}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(Pte),Zje=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.separator=r,i.carryover="",i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((n=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=n.value.split(this.separator))[0]=this.carryover+r[0],i=0,a=r.slice(0,-1);i<a.length;i++)o=a[i],this.outputQueue.push(o);return this.carryover=r[r.length-1],[2,!0]}})})},t}(A$),Jje=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.decodeUTF8=function(){return new Qje(this)},t}(ai),Qje=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.impl=new e8e(n),r}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(Pte),e8e=function(e){function t(n){var r=e.call(this)||this;if(r.upstream=n,pe().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(n=a.sent()).done?[2,!1]:(r=n.value,i=pe().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},t}(A$),$te=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.file=n,i.options=r,pt.assert(n instanceof Uint8Array||!!pe().get("IS_BROWSER")&&(n instanceof File||n instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return On(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(n=new Promise(function(o,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)o(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(f){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));o(d)},l.onabort=function(f){return s(new Error("Aborted"))},l.onerror=function(f){return s(new Error(f.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,n]);case 1:return[2,(r.value=a.sent(),r.done=!1,r)]}})})},t}(Jje);function t8e(e,t){return t===void 0&&(t={}),He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return typeof e=="string"?n=e:(n=e.url,r=n8e(e)),[4,pt.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new $te(a,t)];case 3:throw new Error(i.statusText)}})})}var n8e=function(e){return{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity}};function Lte(e){return typeof e=="string"&&e.substr(0,7)==="file://"}var r8e=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.input=n,i.options=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return Lte(this.input)&&pe().get("IS_NODE")&&(n=require("fs"),this.input=n.readFileSync(this.input.substr(7))),[2,new $te(this.input,this.options)]})})},t}(Mte);(function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.url=n,i.fileOptions=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return Lte(this.url)?[2,new r8e(this.url,this.fileOptions).iterator()]:[2,t8e(this.url,this.fileOptions)]})})},t})(Mte);function i8e(e){let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(f!==t){const d=t;t=c?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a=(l,c=i,f=Object.is)=>{let d=c(t);function h(){const p=c(t);if(!f(d,p)){const g=d;l(d=p,g)}}return n.add(h),()=>n.delete(h)},u={setState:r,getState:i,subscribe:(l,c,f)=>c||f?a(l,c,f):(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,i,u),u}const a8e=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Bte=a8e?Vt:uf;function o8e(e){const t=typeof e=="function"?i8e(e):e,n=(r=t.getState,i=Object.is)=>{const[,a]=$N(g=>g+1,0),o=t.getState(),s=Jt(o),u=Jt(r),l=Jt(i),c=Jt(!1),f=Jt();f.current===void 0&&(f.current=r(o));let d,h=!1;(s.current!==o||u.current!==r||l.current!==i||c.current)&&(d=r(o),h=!i(f.current,d)),Bte(()=>{h&&(f.current=d),s.current=o,u.current=r,l.current=i,c.current=!1});const p=Jt(o);return Bte(()=>{const g=()=>{try{const v=t.getState(),y=u.current(v);l.current(f.current,y)||(s.current=v,f.current=y,a())}catch(v){c.current=!0,a()}},m=t.subscribe(g);return t.getState()!==p.current&&g(),m},[]),h?d:f.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var zte={},jte=vh(g4e),s8e={},u8e={},lA={},Yr={},ov={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t="tfjsflags",n=function(){function u(l){this.global=l,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return u.prototype.setPlatform=function(l,c){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+c+".")),this.platformName=l,this.platform=c},u.prototype.registerFlag=function(l,c,f){if(this.flagRegistry[l]={evaluationFn:c,setHook:f},this.urlFlags[l]!=null){var d=this.urlFlags[l];console.warn("Setting feature override from URL "+l+": "+d+"."),this.set(l,d)}},u.prototype.get=function(l){return l in this.flags?this.flags[l]:(this.flags[l]=this.evaluateFlag(l),this.flags[l])},u.prototype.getNumber=function(l){return this.get(l)},u.prototype.getBool=function(l){return this.get(l)},u.prototype.getFlags=function(){return this.flags},Object.defineProperty(u.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),u.prototype.set=function(l,c){if(this.flagRegistry[l]==null)throw new Error("Cannot set flag "+l+" as it has not been registered.");this.flags[l]=c,this.flagRegistry[l].setHook!=null&&this.flagRegistry[l].setHook(c)},u.prototype.evaluateFlag=function(l){if(this.flagRegistry[l]==null)throw new Error("Cannot evaluate flag '"+l+"': no evaluation function found.");return this.flagRegistry[l].evaluationFn()},u.prototype.setFlags=function(l){this.flags=Object.assign({},l)},u.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},u.prototype.populateURLFlags=function(){var l=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var c=r(this.global.location.search);if(t in c){var f=c[t].split(",");f.forEach(function(d){var h=d.split(":"),p=h[0],g=h[1];l.urlFlags[p]=a(p,g)})}}},u}();e.Environment=n;function r(u){var l={};return u.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(c){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];return i(l,f[0],f[1]),f.join("=")}),l}e.getQueryParams=r;function i(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}function a(u,l){if(l=l.toLowerCase(),l==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+u+".")}function o(){return e.ENV}e.env=o,e.ENV=null;function s(u){e.ENV=u}e.setEnvironmentGlobal=s})(ov);var vc={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(vc,"__esModule",{value:!0});var sv=new Map,Jb=new Map;function l8e(e,t){var n=T$(e,t);return sv.get(n)}vc.getKernel=l8e;function c8e(e){return Jb.get(e)}vc.getGradient=c8e;function f8e(e){for(var t=sv.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1],u=o.split("_")[0];u===e&&n.push(s)}return n}vc.getKernelsForBackend=f8e;function d8e(e){var t=e.kernelName,n=e.backendName,r=T$(t,n);if(sv.has(r))throw new Error("The kernel '"+t+"' for backend "+("'"+n+"' is already registered"));sv.set(r,e)}vc.registerKernel=d8e;function h8e(e){var t=e.kernelName;Jb.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Jb.set(t,e)}vc.registerGradient=h8e;function p8e(e,t){var n=T$(e,t);if(!sv.has(n))throw new Error("The kernel '"+e+"' for backend "+("'"+t+"' is not registered"));sv.delete(n)}vc.unregisterKernel=p8e;function g8e(e){if(!Jb.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Jb.delete(e)}vc.unregisterGradient=g8e;function T$(e,t){return t+"_"+e}var Qb={},qe={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(qe,"__esModule",{value:!0});var cA=ov;function Ute(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,t--,n=e[t],e[t]=e[r],e[r]=n}qe.shuffle=Ute;function m8e(e,t,n){return Math.max(e,Math.min(t,n))}qe.clamp=m8e;function v8e(e){return e%2==0?e:e+1}qe.nearestLargerEven=v8e;function y8e(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}qe.sum=y8e;function b8e(e,t){var n=Math.random();return t*n+(1-n)*e}qe.randUniform=b8e;function x8e(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n}qe.distSquared=x8e;function uv(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}qe.assert=uv;function w8e(e,t,n){n===void 0&&(n=""),uv(Wte(e,t),function(){return n+(" Shapes "+e+" and "+t+" must match")})}qe.assertShapesMatch=w8e;function _8e(e){uv(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}qe.assertNonNull=_8e;function O$(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Gte(e)&&!n)for(var r=0;r<e.length;++r)O$(e[r],t,n);else t.push(e);return t}qe.flatten=O$;function S8e(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}qe.sizeFromShape=S8e;function E8e(e){return e.length===0}qe.isScalarShape=E8e;function Wte(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}qe.arraysEqual=Wte;function Vte(e){return e%1==0}qe.isInt=Vte;function A8e(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}qe.tanh=A8e;function C8e(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}qe.sizeToSquarishShape=C8e;function k8e(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return Ute(t),t}qe.createShuffledIndices=k8e;function T8e(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}qe.rightPad=T8e;function O8e(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e()){r();return}a++;var s=t(a);if(n!=null&&a>=n){i();return}setTimeout(o,s)};o()})}qe.repeatedTry=O8e;function I8e(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+r+" and dim "+i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+t+" / "+n));var a=e.slice();return a[r]=t/n,a}qe.inferFromImplicitShape=I8e;function qte(e,t){var n=t.length;return e=e==null?t.map(function(r,i){return i}):[].concat(e),uv(e.every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but "+("got axis "+e)}),uv(e.every(function(r){return Vte(r)}),function(){return"All values in axis param must be integers but "+("got axis "+e)}),e.map(function(r){return r<0?n+r:r})}qe.parseAxisParam=qte;function N8e(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:qte(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}qe.squeezeShape=N8e;function D8e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else throw new Error("Unknown data type "+e);return n}qe.getTypedArrayFromDType=D8e;function R8e(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type "+e);return n}qe.getArrayFromDType=R8e;function Hte(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}qe.checkConversionForErrors=Hte;function F8e(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}qe.isValidDtype=F8e;function M8e(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}qe.hasEncodingLoss=M8e;function Gte(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}qe.isTypedArray=Gte;function P8e(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}qe.bytesPerElement=P8e;function $8e(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}qe.bytesFromStringArray=$8e;function Kte(e){return typeof e=="string"||e instanceof String}qe.isString=Kte;function Xte(e){return typeof e=="boolean"}qe.isBoolean=Xte;function Yte(e){return typeof e=="number"}qe.isNumber=Yte;function Zte(e){return Array.isArray(e)?Zte(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":Yte(e)?"float32":Kte(e)?"string":Xte(e)?"bool":"float32"}qe.inferDtype=Zte;function L8e(e){return!!(e&&e.constructor&&e.call&&e.apply)}qe.isFunction=L8e;function B8e(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}qe.nearestDivisor=B8e;function z8e(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}qe.computeStrides=z8e;function j8e(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=O$(e)),n&&Hte(e,t),W8e(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}else throw new Error("Unknown data type "+t)}qe.toTypedArray=j8e;function Jte(e,t,n){var r=new Array;if(t.length===1)for(var i=t[0],a=0;a<i;a++)r[a]=n[e+a];else for(var i=t[0],o=t.slice(1),s=o.reduce(function(l,c){return l*c}),a=0;a<i;a++)r[a]=Jte(e+a*s,o,n);return r}function U8e(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return Jte(0,e,t)}qe.toNestedArray=U8e;function W8e(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function V8e(e,t){for(var n=Qte(e,t),r=0;r<n.length;r++)n[r]=1;return n}qe.makeOnesTypedArray=V8e;function Qte(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}qe.makeZerosTypedArray=Qte;function q8e(){return cA.env().platform.now()}qe.now=q8e;function H8e(e){e.forEach(function(t){uv(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+e+"].")})})}qe.assertNonNegativeIntegerDimensions=H8e;function G8e(e,t){return cA.env().platform.fetch(e,t)}qe.fetch=G8e;function K8e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",cA.env().platform.encode(e,t)}qe.encodeString=K8e;function X8e(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",cA.env().platform.decode(e,t)}qe.decodeString=X8e;function Y8e(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}qe.locToIndex=Y8e;function Z8e(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}qe.indexToLoc=Z8e;/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Qb,"__esModule",{value:!0});var I$=qe,J8e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new tne)}return e.prototype.profileKernel=function(t,n,r){var i=this,a,o=function(){a=r()},s=this.backendTimer.time(o);return a.forEach(function(u){u.data().then(function(l){ene(l,u.dtype,t),s.then(function(c){var f="";c.getExtraProfileInfo!=null&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,u,l,c.kernelMs,n,f)})})}),a},e}();Qb.Profiler=J8e;function ene(e,t,n){if(t!=="float32")return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}return!1}Qb.checkComputationForErrors=ene;var tne=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?I$.rightPad(i+"ms",9):i.error,u=I$.rightPad(t,25),l=n.rank,c=n.size,f=I$.rightPad(n.shape.toString(),14),d="";for(var h in a){var p=a[h],g=p.shape||n.shape,m=g.length;d+=h+": "+m+"D "+(m>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();Qb.Logger=tne;var fA={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(fA,"__esModule",{value:!0});var Q8e=qe;function e9e(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(var a=0;a<e.length;a++){var o=e[a],s=o.inputs;for(var u in s){for(var l=s[u],c=!1,f=0;f<t.length;f++)if(r[l.id]){o.outputs.forEach(function(b){return r[b.id]=!0}),c=!0,i[o.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;for(var h={},a=e.length-1;a>=0;a--)for(var o=e[a],s=o.inputs,f=0;f<o.outputs.length;f++)if(d[o.outputs[f].id]){for(var u in s)d[s[u].id]=!0,h[o.id]=!0;break}for(var p=[],a=0;a<e.length;a++){var o=e[a];if(i[o.id]&&h[o.id]){var g={};for(var u in o.inputs){var m=o.inputs[u];r[m.id]&&(g[u]=m)}var v=Object.assign({},o);v.inputs=g,v.outputs=o.outputs,p.push(v)}}return p}fA.getFilteredNodesXToY=e9e;function t9e(e,t,n){for(var r=function(a){var o=t[a],s=[];if(o.outputs.forEach(function(f){var d=e[f.id];d!=null?s.push(d):s.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+o.kernelName+"."));var u=o.gradient(s),l=function(f){if(!(f in u))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(u)+"."));var d=n(function(){return u[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var h=o.inputs[f];if(!Q8e.arraysEqual(d.shape,h.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+h.shape+"'"));if(e[h.id]==null)e[h.id]=d;else{var p=e[h.id];e[h.id]=p.add(d),p.dispose()}};for(var c in o.inputs)l(c)},i=t.length-1;i>=0;i--)r(i)}fA.backpropagateGradients=t9e;var Tr={},N$={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(N$,"__esModule",{value:!0});var dA=qe,nne=20,e1=3,D$=7;function n9e(e,t,n,r){var i=dA.computeStrides(t),a=r9e(e,t,n,i),o=t.length,s=hA(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}N$.tensorToString=n9e;function r9e(e,t,n,r){var i=dA.sizeFromShape(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u=n==="complex64"?n1(e):e;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,f=0;f<a;f++)o[f]=Math.max(o[f],t1(u[c+f],0,n).length);return o}function t1(e,t,n){var r;return Array.isArray(e)?r=parseFloat(e[0].toFixed(D$))+" + "+(parseFloat(e[1].toFixed(D$))+"j"):dA.isString(e)?r="'"+e+"'":n==="bool"?r=rne(e):r=parseFloat(e.toFixed(D$)).toString(),dA.rightPad(r,t)}function rne(e){return e===0?"false":"true"}function hA(e,t,n,r,i,a){a===void 0&&(a=!0);var o=n==="complex64"?2:1,s=t[0],u=t.length;if(u===0){if(n==="complex64"){var l=n1(e);return[t1(l[0],0,n)]}return n==="bool"?[rne(e[0])]:[e[0].toString()]}if(u===1){if(s>nne){var c=e1*o,f=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-e1)*o,s*o));return n==="complex64"&&(f=n1(f),d=n1(d)),["["+f.map(function(A,_){return t1(A,i[_],n)}).join(", ")+", ..., "+d.map(function(A,_){return t1(A,i[s-e1+_],n)}).join(", ")+"]"]}var h=n==="complex64"?n1(e):Array.from(e);return["["+h.map(function(A,_){return t1(A,i[_],n)}).join(", ")+"]"]}var p=t.slice(1),g=r.slice(1),m=r[0]*o,v=[];if(s>nne){for(var y=0;y<e1;y++){var b=y*m,x=b+m;v.push.apply(v,hA(e.slice(b,x),p,n,g,i,!1))}v.push("...");for(var y=s-e1;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,hA(e.slice(b,x),p,n,g,i,y===s-1))}}else for(var y=0;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,hA(e.slice(b,x),p,n,g,i,y===s-1))}var w=u===2?",":"";v[0]="["+v[0]+w;for(var y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;for(var S=`,
`,y=2;y<u;y++)S+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":S),v}function n1(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var i9e=Ye&&Ye.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),pA=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},gA=Ye&&Ye.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Tr,"__esModule",{value:!0});var a9e=N$,yc=qe,mA=qe,o9e=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=yc.sizeFromShape(t),r!=null){var a=r.length;yc.assert(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+i.size+"'.")})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||yc.getArrayFromDType(n,this.size),this.strides=mA.computeStrides(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),yc.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must "+("match the rank ("+n.rank+")")});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+". "+("  Buffer shape="+this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return el().makeTensor(this.values,this.shape,this.dtype)},e}();Tr.TensorBuffer=o9e;var el=null,be=null,ine=null;function s9e(e){el=e}Tr.setTensorTracker=s9e;function u9e(e){be=e}Tr.setOpHandler=u9e;function l9e(e){ine=e}Tr.setDeprecationWarningFn=l9e;var vA=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=yc.sizeFromShape(t),this.strides=mA.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),yc.assert(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),be.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return pA(this,void 0,void 0,function(){var t;return gA(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,be.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return be.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return pA(this,void 0,void 0,function(){var t;return gA(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,mA.toNestedArray(this.shape,t)]}})})},e.prototype.arraySync=function(){return mA.toNestedArray(this.shape,this.dataSync())},e.prototype.data=function(){return pA(this,void 0,void 0,function(){var t,n;return gA(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=el().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return yc.decodeString(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=el().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return yc.decodeString(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return pA(this,void 0,void 0,function(){var t;return gA(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,el().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(el().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),be.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),be.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),be.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),be.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),be.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),be.clone(this)},e.prototype.toString=function(t){t===void 0&&(t=!1);var n=this.dataSync();return a9e.tensorToString(n,this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),be.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),be.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),be.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),be.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),be.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),be.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),be.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),be.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),ine("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),be.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),be.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),be.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),be.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),be.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),be.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),be.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),be.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),be.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),be.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),be.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),be.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),be.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),be.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),be.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),be.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),be.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),be.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),be.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),be.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),be.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),be.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),be.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),be.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),be.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),be.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),be.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),be.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),be.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),be.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),be.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),be.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),be.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),be.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),be.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),be.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),be.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),be.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),be.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),be.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),be.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),be.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),be.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),be.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),be.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),be.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),be.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),be.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),be.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),be.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),be.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),be.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),be.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),be.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),be.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),be.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),be.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),be.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),be.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),be.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),be.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),be.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),be.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),be.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),be.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),be.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),be.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),be.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),be.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),be.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),be.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),be.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),be.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),be.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),be.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),be.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),be.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),be.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),be.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),be.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),be.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),be.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),be.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),be.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),be.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),el().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),be.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),be.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),be.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),be.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),be.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),be.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),be.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),be.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),be.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),be.spectral.irfft(this)},e}();Tr.Tensor=vA,Object.defineProperty(vA,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var ane=function(e){i9e(t,e);function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!yc.arraysEqual(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and "+("previous value ("+this.shape+") must match"));el().disposeTensor(this),this.dataId=n.dataId,el().incRef(this,null)},t.prototype.dispose=function(){el().disposeVariable(this),this.isDisposedInternal=!0},t}(vA);Tr.Variable=ane,Object.defineProperty(ane,Symbol.hasInstance,{value:function(e){return e instanceof vA&&e.assign!=null&&e.assign instanceof Function}});var cs={},one={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),function(u){u.R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6"}(e.Rank||(e.Rank={}));var t;(function(u){u.float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64"})(t||(t={}));var n;(function(u){u.float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64"})(n||(n={}));var r;(function(u){u.float32="float32",u.int32="float32",u.bool="float32",u.complex64="complex64"})(r||(r={}));var i;(function(u){u.float32="complex64",u.int32="complex64",u.bool="complex64",u.complex64="complex64"})(i||(i={}));var a={float32:r,int32:t,bool:n,complex64:i};function o(u,l){if(u==="string"||l==="string"){if(u==="string"&&l==="string")return"string";throw new Error("Can not upcast "+u+" with "+l)}return a[u][l]}e.upcastType=o;function s(u){return o(u,"int32")}e.sumOutType=s})(one);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(cs,"__esModule",{value:!0});var c9e=Tr,f9e=one,d9e=qe;function h9e(e,t){if(e.dtype===t.dtype)return[e,t];var n=f9e.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}cs.makeTypesMatch=h9e;function p9e(e,t){d9e.assert(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and"+(" second("+t.dtype+") input must match")})}cs.assertTypesMatch=p9e;function g9e(e,t){return t.some(function(n){return n.id===e.id})}cs.isTensorInList=g9e;function m9e(e){var t=[],n=new Set;return sne(e,t,n),t}cs.getTensorsInContainer=m9e;function sne(e,t,n){if(e!=null){if(e instanceof c9e.Tensor){t.push(e);return}if(!!v9e(e)){var r=e;for(var i in r){var a=r[i];n.has(a)||(n.add(a),sne(a,t,n))}}}}function v9e(e){return Array.isArray(e)||typeof e=="object"}(function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(v,y,b,x){return new(b||(b=Promise))(function(w,S){function A(C){try{E(x.next(C))}catch(k){S(k)}}function _(C){try{E(x.throw(C))}catch(k){S(k)}}function E(C){C.done?w(C.value):new b(function(k){k(C.value)}).then(A,_)}E((x=x.apply(v,y||[])).next())})},n=Ye&&Ye.__generator||function(v,y){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},x,w,S,A;return A={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function _(C){return function(k){return E([C,k])}}function E(C){if(x)throw new TypeError("Generator is already executing.");for(;b;)try{if(x=1,w&&(S=C[0]&2?w.return:C[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,C[1])).done)return S;switch(w=0,S&&(C=[C[0]&2,S.value]),C[0]){case 0:case 1:S=C;break;case 4:return b.label++,{value:C[1],done:!1};case 5:b.label++,w=C[1],C=[0];continue;case 7:C=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(C[0]===6||C[0]===2)){b=0;continue}if(C[0]===3&&(!S||C[1]>S[0]&&C[1]<S[3])){b.label=C[1];break}if(C[0]===6&&b.label<S[1]){b.label=S[1],S=C;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(C);break}S[2]&&b.ops.pop(),b.trys.pop();continue}C=y.call(v,b)}catch(k){C=[6,k],w=0}finally{x=S=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=ov,i=vc,a=Qb,o=fA,s=Tr,u=cs,l=qe,c=qe,f=function(){function v(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return v.prototype.dispose=function(){for(var y in this.registeredVariables)this.registeredVariables[y].dispose()},v}(),d=function(){function v(y){this.ENV=y,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new f}return v.prototype.ready=function(){return t(this,void 0,void 0,function(){var y,b,x,w;return n(this,function(S){switch(S.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];y=this.getSortedBackends(),b=0,S.label=1;case 1:return b<y.length?(x=y[b],[4,this.initializeBackend(x).success]):[3,5];case 2:return w=S.sent(),w?[4,this.setBackend(x)]:[3,4];case 3:return S.sent(),[2];case 4:return b++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(v.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var y=this.initializeBackendsAndReturnBest(),b=y.name,x=y.asyncInit;if(x)throw new Error("The highest priority backend '"+b+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(b)}return this.backendInstance},enumerable:!0,configurable:!0}),v.prototype.backendNames=function(){return Object.keys(this.registryFactory)},v.prototype.findBackend=function(y){if(!(y in this.registry))if(y in this.registryFactory){var b=this.initializeBackend(y).asyncInit;if(b)return null}else return null;return this.registry[y]},v.prototype.findBackendFactory=function(y){return y in this.registryFactory?this.registryFactory[y].factory:null},v.prototype.registerBackend=function(y,b,x){return x===void 0&&(x=1),y in this.registryFactory?(console.warn(y+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[y]={factory:b,priority:x},!0)},v.prototype.setBackend=function(y){return t(this,void 0,void 0,function(){var b,x,w,S,A;return n(this,function(_){switch(_.label){case 0:if(this.registryFactory[y]==null)throw new Error("Backend name '"+y+"' not found in registry");return this.backendName=y,this.registry[y]!=null?[3,4]:(this.backendInstance=null,b=this.initializeBackend(y),x=b.success,w=b.asyncInit,w?[4,x]:[3,2]);case 1:return A=_.sent(),[3,3];case 2:A=x,_.label=3;case 3:if(S=A,!S)return[2,!1];_.label=4;case 4:return this.backendInstance=this.registry[y],this.setupRegisteredKernels(),this.profiler=new a.Profiler(this.backendInstance),[2,!0]}})})},v.prototype.setupRegisteredKernels=function(){var y=this,b=i.getKernelsForBackend(this.backendName);b.forEach(function(x){x.setupFunc!=null&&x.setupFunc(y.backendInstance)})},v.prototype.disposeRegisteredKernels=function(y){var b=this,x=i.getKernelsForBackend(y);x.forEach(function(w){w.disposeFunc!=null&&w.disposeFunc(b.registry[y])})},v.prototype.initializeBackend=function(y){var b=this,x=this.registryFactory[y];if(x==null)throw new Error("Cannot initialize backend "+y+", no registration found.");try{var w=x.factory();if(Promise.resolve(w)===w){var S=++this.pendingBackendInitId,A=w.then(function(_){return S<b.pendingBackendInitId?!1:(b.registry[y]=_,b.pendingBackendInit=null,!0)}).catch(function(_){return S<b.pendingBackendInitId||(b.pendingBackendInit=null,console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message)),!1});return this.pendingBackendInit=A,{success:A,asyncInit:!0}}else return this.registry[y]=w,{success:!0,asyncInit:!1}}catch(_){return console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message),{success:!1,asyncInit:!1}}},v.prototype.removeBackend=function(y){if(!(y in this.registryFactory))throw new Error(y+" backend not found in registry");this.backendName===y&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,y in this.registry&&(this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y]),delete this.registryFactory[y],this.backendName===y&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},v.prototype.getSortedBackends=function(){var y=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(b,x){return y.registryFactory[x].priority-y.registryFactory[b].priority})},v.prototype.initializeBackendsAndReturnBest=function(){for(var y=this.getSortedBackends(),b=0;b<y.length;b++){var x=y[b],w=this.initializeBackend(x),S=w.success,A=w.asyncInit;if(A||S)return{name:x,asyncInit:A}}throw new Error("Could not initialize any backends, all backend initializations failed.")},v.prototype.moveData=function(y,b){var x=this.state.tensorInfo.get(b),w=x.backend,S=this.readSync(b);w.disposeData(b),x.backend=y,y.move(b,S,x.shape,x.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},v.prototype.tidy=function(y,b){var x=this,w=null;if(b==null){if(typeof y!="function")throw new Error("Please provide a function to tidy()");b=y}else{if(typeof y!="string"&&!(y instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");w=y}var S;return this.scopedRun(function(){return x.startScope(w)},function(){return x.endScope(S)},function(){return S=b(),S instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),S})},v.prototype.scopedRun=function(y,b,x){y();try{var w=x();return b(),w}catch(S){throw b(),S}},v.prototype.nextTensorId=function(){return v.nextTensorId++},v.prototype.nextVariableId=function(){return v.nextVariableId++},v.prototype.clone=function(y){var b=this.makeTensorFromDataId(y.dataId,y.shape,y.dtype),x={x:y},w=function(A){return{x:function(){return A.toFloat()}}},S=[];return this.addTapeNode(this.state.activeScope.name,x,[b],w,S,{}),b},v.prototype.runKernel=function(y,b,x,w,S){var A=null,_=null;return this.runKernelFunc(A,b,_,y,x,w,S)},v.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},v.prototype.checkKernelForMemLeak=function(y,b,x){var w=this.backend.numDataIds(),S=0;x.forEach(function(E){S+=E.dtype==="complex64"?3:1});var A=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],_=w-b-S-A;if(_>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+_+" data ids) after running '"+y+"'"))},v.prototype.runKernelFunc=function(y,b,x,w,S,A,_){var E=this,C,k=[],T=this.isTapeOn();w==null&&(w=this.state.activeScope!=null?this.state.activeScope.name:"");var I=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var O,D=i.getKernel(w,this.backendName),L;if(D!=null)O=function(){var G=E.backend.numDataIds();L=D.kernelFunc({inputs:b,attrs:S,backend:E.backend});var K=Array.isArray(L)?L:[L];E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K);var ee=K.map(function(Oe){var Te=Oe.dataId,Re=Oe.shape,me=Oe.dtype;return E.makeTensorFromDataId(Te,Re,me)});if(T){var ce=E.getTensorsForGradient(w,b,ee);if(ce==null){_==null&&(_=[]);var he=ee.filter(function(Oe,Te){return _[Te]});ce=(A||[]).slice().concat(he)}k=E.saveTensorsForBackwardMode(ce)}return ee};else{var W=function(G){!T||(k=G.map(function(K){return E.keep(E.clone(K))}))};O=function(){var G=E.backend.numDataIds();L=E.tidy(function(){return y(E.backend,W)});var K=Array.isArray(L)?L:[L];return E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K),K}}return this.scopedRun(function(){return E.state.kernelDepth++},function(){return E.state.kernelDepth--},function(){E.ENV.getBool("DEBUG")?C=E.profiler.profileKernel(w,b,function(){return O()}):C=O()}),T&&this.addTapeNode(w,b,C,x,k,S),this.state.profiling&&this.state.activeProfile.kernels.push({name:w,bytesAdded:this.state.numBytes-I,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map(function(G){return b[G].shape}),outputShapes:C.map(function(G){return G.shape})}),Array.isArray(L)?C:C[0]},v.prototype.saveTensorsForBackwardMode=function(y){var b=this,x=y.map(function(w){return b.keep(b.clone(w))});return x},v.prototype.getTensorsForGradient=function(y,b,x){var w=i.getGradient(y);if(w!=null){var S=w.inputsToSave||[],A=w.outputsToSave||[],_=void 0;w.saveAllInputs?(l.assert(Array.isArray(b),function(){return"saveAllInputs is true, expected inputs to be an array."}),_=Object.keys(b).map(function(C){return b[C]})):_=S.map(function(C){return b[C]});var E=x.filter(function(C,k){return A[k]});return _.concat(E)}return null},v.prototype.makeTensor=function(y,b,x,w){if(y==null)throw new Error("Values passed to engine.makeTensor() are null");x=x||"float32",w=w||this.backend;var S=y;x==="string"&&l.isString(y[0])&&(S=y.map(function(k){return l.encodeString(k)}));var A=w.write(S,b,x),_=new s.Tensor(b,x,A,this.nextTensorId());if(this.incRef(_,w),x==="string"){var E=this.state.tensorInfo.get(A),C=c.bytesFromStringArray(S);this.state.numBytes+=C-E.bytes,E.bytes=C}return _},v.prototype.makeTensorFromDataId=function(y,b,x,w){x=x||"float32";var S=new s.Tensor(b,x,y,this.nextTensorId());return this.incRef(S,w),S},v.prototype.makeVariable=function(y,b,x,w){b===void 0&&(b=!0),x=x||this.nextVariableId().toString(),w!=null&&w!==y.dtype&&(y=y.asType(w));var S=new s.Variable(y,b,x,this.nextTensorId());if(this.state.registeredVariables[S.name]!=null)throw new Error("Variable with name "+S.name+" was already registered");return this.state.registeredVariables[S.name]=S,this.incRef(S,this.backend),S},v.prototype.incRef=function(y,b){var x=this.state.tensorInfo.has(y.dataId)?this.state.tensorInfo.get(y.dataId).refCount:0;if(this.state.numTensors++,y.dtype==="string"&&this.state.numStringTensors++,x===0){this.state.numDataBuffers++;var w=0;y.dtype!=="complex64"&&y.dtype!=="string"&&(w=y.size*l.bytesPerElement(y.dtype)),this.state.tensorInfo.set(y.dataId,{backend:b||this.backend,dtype:y.dtype,shape:y.shape,bytes:w,refCount:0}),this.state.numBytes+=w}this.state.tensorInfo.get(y.dataId).refCount++,y instanceof s.Variable||this.track(y)},v.prototype.disposeTensor=function(y){if(!!this.state.tensorInfo.has(y.dataId)){this.state.numTensors--,y.dtype==="string"&&this.state.numStringTensors--;var b=this.state.tensorInfo.get(y.dataId),x=b.refCount;x<=1?(y.dtype!=="complex64"&&(this.state.numBytes-=b.bytes),this.state.numDataBuffers--,b.backend.disposeData(y.dataId),this.state.tensorInfo.delete(y.dataId)):this.state.tensorInfo.get(y.dataId).refCount--}},v.prototype.disposeVariables=function(){for(var y in this.state.registeredVariables){var b=this.state.registeredVariables[y];this.disposeVariable(b)}},v.prototype.disposeVariable=function(y){this.disposeTensor(y),this.state.registeredVariables[y.name]!=null&&delete this.state.registeredVariables[y.name]},v.prototype.memory=function(){var y=this.backend.memory();return y.numTensors=this.state.numTensors,y.numDataBuffers=this.state.numDataBuffers,y.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(y.unreliable=!0,y.reasons==null&&(y.reasons=[]),y.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),y},v.prototype.profile=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){return this.state.profiling=!0,b=this.state.numBytes,x=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=y(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(S){return S.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-x,[2,this.state.activeProfile]})})},v.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},v.prototype.addTapeNode=function(y,b,x,w,S,A){var _=this,E={id:this.state.nextTapeNodeId++,kernelName:y,inputs:b,outputs:x,saved:S},C=i.getGradient(y);C!=null&&(w=C.gradFunc),w!=null&&(E.gradient=function(k){return k=k.map(function(T,I){if(T==null){var N=x[I],O=l.makeZerosTypedArray(N.size,N.dtype);return _.makeTensor(O,N.shape,N.dtype)}return T}),w(k.length>1?k:k[0],S,A)}),this.state.activeTape.push(E)},v.prototype.keep=function(y){return y.kept=!0,y},v.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},v.prototype.endTape=function(){this.state.gradientDepth--},v.prototype.startScope=function(y){var b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};y&&(b.name=y),this.state.scopeStack.push(b),this.state.activeScope=b},v.prototype.endScope=function(y){for(var b=this,x=u.getTensorsInContainer(y),w=new Set(x.map(function(E){return E.id})),S=0;S<this.state.activeScope.track.length;S++){var A=this.state.activeScope.track[S];!A.kept&&!w.has(A.id)&&A.dispose()}var _=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],x.forEach(function(E){!E.kept&&E.scopeId===_.id&&b.track(E)})},v.prototype.gradients=function(y,b,x,w){var S=this;if(w===void 0&&(w=!1),l.assert(b.length>0,function(){return"gradients() received an empty list of xs."}),x!=null&&x.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+x.dtype+"'");var A=this.scopedRun(function(){return S.startTape()},function(){return S.endTape()},function(){return S.tidy("forward",y)});l.assert(A instanceof s.Tensor,function(){return"The result y returned by f() must be a tensor."});var _=o.getFilteredNodesXToY(this.state.activeTape,b,A);if(!w&&_.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var E={};E[A.id]=x??h(A.shape),o.backpropagateGradients(E,_,function(k){return S.tidy(k)});var C=b.map(function(k){return E[k.id]});return S.state.gradientDepth===0&&(S.state.activeTape.forEach(function(k){for(var T=0,I=k.saved;T<I.length;T++){var N=I[T];N.dispose()}}),S.state.activeTape=null),{value:A,grads:C}})},v.prototype.customGrad=function(y){var b=this;return l.assert(l.isFunction(y),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];l.assert(x.every(function(_){return _ instanceof s.Tensor}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var S,A={};return x.forEach(function(_,E){A[E]=_}),b.runKernelFunc(function(_,E){return S=y.apply(void 0,x.concat([E])),l.assert(S.value instanceof s.Tensor,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),l.assert(l.isFunction(S.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),S.value},A,function(_,E){var C=S.gradFunc(_,E),k=Array.isArray(C)?C:[C];l.assert(k.length===x.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),l.assert(k.every(function(I){return I instanceof s.Tensor}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var T={};return k.forEach(function(I,N){T[N]=function(){return I}}),T})}},v.prototype.readSync=function(y){var b=this.state.tensorInfo.get(y);return b.backend.readSync(y)},v.prototype.read=function(y){var b=this.state.tensorInfo.get(y);return b.backend.read(y)},v.prototype.time=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){switch(w.label){case 0:return b=c.now(),[4,this.backend.time(y)];case 1:return x=w.sent(),x.wallMs=c.now()-b,[2,x]}})})},v.prototype.track=function(y){return this.state.activeScope!=null&&(y.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(y)),y},Object.defineProperty(v.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),v.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new f;for(var y in this.registry)this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},v.nextTensorId=0,v.nextVariableId=0,v}();e.Engine=d;function h(v){var y=c.makeOnesTypedArray(c.sizeFromShape(v),"float32");return e.ENGINE.makeTensor(y,v,"float32")}var p;function g(){if(p==null){var v=void 0;if(typeof window!="undefined")v=window;else if(typeof Ye!="undefined")v=Ye;else if(typeof process!="undefined")v=process;else if(typeof self!="undefined")v=self;else throw new Error("Could not find a global object");p=v}return p}function m(){var v=g();if(v._tfengine==null){var y=new r.Environment(v);v._tfengine=new d(y)}return r.setEnvironmentGlobal(v._tfengine.ENV),s.setTensorTracker(function(){return v._tfengine}),v._tfengine}e.ENGINE=m()})(Yr);var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),yr.Add="Add",yr.AddN="AddN",yr.Div="Div",yr.FusedBatchNorm="FusedBatchNorm",yr.SquaredDifference="SquaredDifference",yr.Square="Square",yr.Transpose="Transpose",yr.NonMaxSuppressionV5="NonMaxSuppressionV5",yr.BroadcastTo="BroadcastTo",yr.OneHot="OneHot",yr.Identity="Identity",yr.Tile="Tile",yr.PadV2="PadV2",yr.FromPixels="FromPixels",yr.MaxPoolWithArgmax="MaxPoolWithArgmax";var $r={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty($r,"__esModule",{value:!0});var y9e=Yr,une=ov,b9e=Tr,Qs=qe;function lne(e,t){var n=e;if(Qs.isTypedArray(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Qs.isTypedArray(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&une.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&cne(e,r,[]),r}$r.inferShape=lne;function cne(e,t,n){if(n=n||[],!Array.isArray(e)&&!Qs.isTypedArray(e)){Qs.assert(t.length===0,function(){return"Element arr["+n.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+t[0]+" elements")});return}Qs.assert(t.length>0,function(){return"Element arr["+n.join("][")+"] should be a primitive, "+("but is an array of "+e.length+" elements")}),Qs.assert(e.length===t[0],function(){return"Element arr["+n.join("][")+"] should have "+t[0]+" "+("elements, but has "+e.length+" elements")});for(var r=t.slice(1),i=0;i<e.length;++i)cne(e[i],r,n.concat(i))}function fne(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must "+("be "+e+" tensor, but got "+t+" tensor"))}function dne(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof b9e.Tensor)return fne(r,e.dtype,t,n),e;var i=Qs.inferDtype(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),fne(r,i,t,n),e==null||!Qs.isTypedArray(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var o=lne(e,i);!Qs.isTypedArray(e)&&!Array.isArray(e)&&(e=[e]);var s=!0,u=i!=="string"?Qs.toTypedArray(e,i,une.env().getBool("DEBUG")):Qs.flatten(e,[],s);return y9e.ENGINE.makeTensor(u,o,i)}$r.convertToTensor=dne;function x9e(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");var i=e;return i.map(function(a,o){return dne(a,t+"["+o+"]",n)},r)}$r.convertToTensorArray=x9e;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var R$=Yr;function w9e(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(t.length+" keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];R$.ENGINE.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),R$.ENGINE.endScope(s),s}catch(u){throw R$.ENGINE.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}oi.op=w9e,Object.defineProperty(lA,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _9e=Yr,S9e=yr,E9e=cs,hne=$r,A9e=oi;function C9e(e,t){var n,r=hne.convertToTensor(e,"a","add"),i=hne.convertToTensor(t,"b","add");n=E9e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=function(s,u){var l=s.add(r,i);return u([r,i]),l},o={a:r,b:i};return _9e.ENGINE.runKernelFunc(a,o,null,S9e.Add)}lA.add=A9e.op({add_:C9e}),Object.defineProperty(u8e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var k9e=lA,T9e=Tr;T9e.Tensor.prototype.add=function(e){return k9e.add(this,e)};var O9e={},F$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(F$,"__esModule",{value:!0});var I9e=Yr,N9e=yr,D9e=$r,R9e=oi;function F9e(e,t){var n=D9e.convertToTensor(e,"broadcastTo","x"),r=n.shape;if(t.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(p,g){return p>1?g:-1}).filter(function(p){return p>=0});if(u.length===0)return n.clone();var l=function(p){return p.tile(n,o)},c=!0,f=function(p){return{x:function(){return p.sum(u,c)}}},d={x:n},h={shape:t,inputShape:a};return I9e.ENGINE.runKernelFunc(l,d,f,N9e.BroadcastTo,h)}F$.broadcastTo=R9e.op({broadcastTo_:F9e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(O9e,"__esModule",{value:!0});var M9e=F$,P9e=Tr;P9e.Tensor.prototype.broadcastTo=function(e){return M9e.broadcastTo(this,e)};var $9e={},yA={},si={},sp={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(sp,"__esModule",{value:!0});function L9e(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1,s=t[t.length-1-i]||1;s>1&&o===1&&r.unshift(a)}return r}sp.getBroadcastDims=L9e;function B9e(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}sp.getReductionAxes=B9e;function z9e(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){var s="Operands could not be broadcast together with shapes "+(e+" and "+t+".");throw Error(s)}else n.unshift(a)}return n}sp.assertAndGetBroadcastShape=z9e;var up={},r1={};Object.defineProperty(r1,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var M$=Yr,bA=$r,j9e=qe,P$=oi;function U9e(e,t){var n=bA.convertToTensor(e,"real","complex"),r=bA.convertToTensor(t,"imag","complex");return j9e.assertShapesMatch(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),M$.ENGINE.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}function W9e(e){var t=bA.convertToTensor(e,"input","real");return M$.ENGINE.runKernelFunc(function(n){return n.real(t)},{$input:t})}function V9e(e){var t=bA.convertToTensor(e,"input","imag");return M$.ENGINE.runKernelFunc(function(n){return n.imag(t)},{$input:t})}r1.complex=P$.op({complex_:U9e}),r1.real=P$.op({real_:W9e}),r1.imag=P$.op({imag_:V9e}),function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Yr,n=ov,r=$r,i=qe,a=r1,o=oi;function s(_,E,C){var k=r.inferShape(_,C);return u(_,E,k,C)}e.tensor=s;function u(_,E,C,k){if(k==null&&(k=i.inferDtype(_)),k==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!i.isTypedArray(_)&&!Array.isArray(_)&&typeof _!="number"&&typeof _!="boolean"&&typeof _!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(E!=null){i.assertNonNegativeIntegerDimensions(E);var T=i.sizeFromShape(E),I=i.sizeFromShape(C);i.assert(T===I,function(){return"Based on the provided shape, ["+E+"], the tensor should have "+(T+" values but has "+I)});for(var N=0;N<C.length;++N){var O=C[N],D=N===C.length-1?O!==i.sizeFromShape(E.slice(N)):!0;i.assert(C[N]===E[N]||!D,function(){return"Error creating a new Tensor. Inferred shape "+("("+C+") does not match the provided ")+("shape ("+E+"). ")})}}return!i.isTypedArray(_)&&!Array.isArray(_)&&(_=[_]),E=E||C,_=k!=="string"?i.toTypedArray(_,k,n.env().getBool("DEBUG")):i.flatten(_,[],!0),t.ENGINE.makeTensor(_,E,k)}function l(_,E){if((i.isTypedArray(_)&&E!=="string"||Array.isArray(_))&&E!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(E==="string"&&i.isTypedArray(_)&&!(_ instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var C=[],k=[];return u(_,C,k,E)}e.scalar=l;function c(_,E){i.assertNonNull(_);var C=r.inferShape(_,E);if(C.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var k=null;return u(_,k,C,E)}e.tensor1d=c;function f(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var k=r.inferShape(_,C);if(k.length!==2&&k.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u(_,E,k,C)}e.tensor2d=f;function d(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var k=r.inferShape(_,C);if(k.length!==3&&k.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor3d=d;function h(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var k=r.inferShape(_,C);if(k.length!==4&&k.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor4d=h;function p(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var k=r.inferShape(_,C);if(k.length!==5&&k.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return u(_,E,k,C)}e.tensor5d=p;function g(_,E,C){if(i.assertNonNull(_),E!=null&&E.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var k=r.inferShape(_,C);if(k.length!==6&&k.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return E=E||k,u(_,E,k,C)}e.tensor6d=g;function m(_,E,C,k){return E===void 0&&(E=!0),t.ENGINE.makeVariable(_,E,C,k)}e.variable=m;function v(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var C=v(_,"float32"),k=y(_,"float32");return a.complex(C,k)}var T=i.makeOnesTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.ones=v;function y(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var C=y(_,"float32"),k=y(_,"float32");return a.complex(C,k)}var T=i.makeZerosTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.zeros=y;function b(_,E,C){return t.ENGINE.runKernelFunc(function(k){return k.fill(_,E,C)},{})}e.fill=b;function x(_){var E=r.convertToTensor(_,"x","onesLike");if(E.dtype==="complex64"){var C=e.onesLike(a.real(E)),k=e.zerosLike(a.imag(E));return a.complex(C,k)}var T=function(I,N){return{x:function(){return e.zerosLike(I)}}};return t.ENGINE.runKernelFunc(function(I){return I.onesLike(E)},{x:E},T,"OnesLike")}function w(_){var E=r.convertToTensor(_,"x","zerosLike"),C=function(k,T){return{x:function(){return e.zerosLike(k)}}};return t.ENGINE.runKernelFunc(function(k){return k.zerosLike(E)},{x:E},C,"ZerosLike")}function S(_,E,C){if(C<=0)throw new Error("The number of values should be positive.");return t.ENGINE.runKernelFunc(function(k){return k.linspace(_,E,C)},{})}e.linspace=S;function A(_,E,C,k){if(C===void 0&&(C=1),k===void 0&&(k="float32"),C===0)throw new Error("Cannot have a step of zero");var T=_===E,I=_<E&&C<0,N=E<_&&C>1;if(T||I||N)return y([0],k);var O=Math.abs(Math.ceil((E-_)/C)),D=i.makeZerosTypedArray(O,k);E<_&&C===1&&(C=-1),D[0]=_;for(var L=1;L<D.length;L++)D[L]=D[L-1]+C;return c(D,k)}e.range=A,e.onesLike=o.op({onesLike_:x}),e.zerosLike=o.op({zerosLike_:w})}(up);var nn={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(nn,"__esModule",{value:!0});var on=Yr,fn=$r,pne=qe,dn=oi,Aa=up;function q9e(e){var t=fn.convertToTensor(e,"x","neg"),n=function(a){return{x:function(){return a.neg()}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a){return a.neg(t)},{x:t},n,"Neg",r,i)}function H9e(e){var t=fn.convertToTensor(e,"x","ceil"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.ceil(t)},{$x:t},n)}function G9e(e){var t=fn.convertToTensor(e,"x","floor"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.floor(t)},{$x:t},n)}function K9e(e){var t=fn.convertToTensor(e,"x","sign"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.sign(t)},{$x:t},n)}function X9e(e){var t=fn.convertToTensor(e,"x","isNaN"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},n)}function Y9e(e){var t=fn.convertToTensor(e,"x","isInf"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isInf(t)},{$x:t},n)}function Z9e(e){var t=fn.convertToTensor(e,"x","isFinite"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},n)}function J9e(e){var t=fn.convertToTensor(e,"x","round"),n=function(r){return{$x:function(){return Aa.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.round(t)},{$x:t},n)}function Q9e(e){var t=fn.convertToTensor(e,"x","exp"),n=function(o,s){return{x:function(){return o.mulStrict(s[0])}}},r={},i=[],a=[!0];return on.ENGINE.runKernelFunc(function(o,s){var u=o.exp(t);return s([u]),u},{x:t},n,"Exp",r,i,a)}function e7e(e){var t=fn.convertToTensor(e,"x","expm1"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.exp())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.expm1(t);return i([t]),a},{$x:t},n)}function t7e(e){var t=fn.convertToTensor(e,"x","log"),n=function(a,o){var s=o[0];return{x:function(){return a.div(s.toFloat())}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a,o){var s=a.log(t);return o([t]),s},{x:t},n,"Log",r,i)}function n7e(e){var t=fn.convertToTensor(e,"x","log1p"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.log1p(t);return i([t]),a},{$x:t},n)}function r7e(e){var t=fn.convertToTensor(e,"x","sqrt"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sqrt(t);return i([t]),a},{$x:t},n)}function i7e(e){var t=fn.convertToTensor(e,"x","rsqrt"),n=function(i,a){var o=a[0];return{x:function(){return i.div(o.pow(1.5).mul(2)).neg()}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.rsqrt(t);return a([t]),o},{x:t},n,"Rsqrt",{},r)}function a7e(e){var t=fn.convertToTensor(e,"x","reciprocal"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.square().neg())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.reciprocal(t);return i([t]),a},{$x:t},n)}function o7e(e){var t=fn.convertToTensor(e,"x","abs");if(t.dtype==="complex64")return on.ENGINE.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t});var n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.abs(t);return i([t]),a},{x:t},n,"Abs")}function s7e(e,t,n){var r=fn.convertToTensor(e,"x","clipByValue");pne.assert(t<=n,function(){return"Error in clip: min ("+t+") must be "+("less than or equal to max ("+n+").")});var i=function(s,u){var l=u[0];return{x:function(){return s.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Aa.zerosLike(s))}}},a=[r],o={min:t,max:n};return on.ENGINE.runKernelFunc(function(s,u){var l=s.clip(r,t,n);return u([r]),l},{x:r},i,"ClipByValue",o,a)}function u7e(e){var t=fn.convertToTensor(e,"x","sigmoid"),n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.mul(Aa.scalar(1).sub(a)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sigmoid(t);return i([a]),a},{x:t},n,"Sigmoid")}function l7e(e){var t=fn.convertToTensor(e,"x","logSigmoid"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t.neg()).neg();return i([t]),a},{$x:t},n)}function c7e(e){var t=fn.convertToTensor(e,"x","softplus"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t);return i([t]),a},{$x:t},n)}function f7e(e){var t=fn.convertToTensor(e,"x","sin"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.sin(t);return a([t]),o},{x:t},n,"Sin",{},r)}function d7e(e){var t=fn.convertToTensor(e,"x","cos"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.cos(t);return a([t]),o},{x:t},n,"Cos",{},r)}function h7e(e){var t=fn.convertToTensor(e,"x","tan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.cos().square())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.tan(t);return i([t]),a},{$x:t},n)}function p7e(e){var t=fn.convertToTensor(e,"x","asin"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).sub(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asin(t);return i([t]),a},{$x:t},n)}function g7e(e){var t=fn.convertToTensor(e,"x","acos"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).sub(a.toFloat().square()).sqrt()).neg()}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acos(t);return i([t]),a},{$x:t},n)}function m7e(e){var t=fn.convertToTensor(e,"x","atan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atan(t);return i([t]),a},{$x:t},n)}function v7e(e){var t=fn.convertToTensor(e,"x","sinh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sinh(t);return i([t]),a},{$x:t},n)}function y7e(e){var t=fn.convertToTensor(e,"x","cosh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.cosh(t);return i([t]),a},{$x:t},n)}function b7e(e){var t=fn.convertToTensor(e,"x","tanh"),n=function(i,a){var o=a[0];return{x:function(){return Aa.scalar(1).sub(o.square()).mulStrict(i)}}},r=[!0];return on.ENGINE.runKernelFunc(function(i,a){var o=i.tanh(t);return a([o]),o},{x:t},n,"Tanh",{},null,r)}function x7e(e){var t=fn.convertToTensor(e,"x","asinh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Aa.scalar(1).add(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asinh(t);return i([t]),a},{$x:t},n)}function w7e(e){var t=fn.convertToTensor(e,"x","acosh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acosh(t);return i([t]),a},{$x:t},n)}function _7e(e){var t=fn.convertToTensor(e,"x","atanh"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(Aa.scalar(1).sub(a.toFloat().square()))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atanh(t);return i([t]),a},{$x:t},n)}function S7e(e){var t=fn.convertToTensor(e,"x","erf");pne.assert(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat());var n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.erf(t);return i([t]),a},{$x:t},n)}function E7e(e,t){t===void 0&&(t=0);var n=fn.convertToTensor(e,"x","step"),r=function(i){return{$x:function(){return Aa.zerosLike(i)}}};return on.ENGINE.runKernelFunc(function(i){return i.step(n,t)},{$x:n},r)}nn.abs=dn.op({abs_:o7e}),nn.acos=dn.op({acos_:g7e}),nn.acosh=dn.op({acosh_:w7e}),nn.asin=dn.op({asin_:p7e}),nn.asinh=dn.op({asinh_:x7e}),nn.atan=dn.op({atan_:m7e}),nn.atanh=dn.op({atanh_:_7e}),nn.ceil=dn.op({ceil_:H9e}),nn.clipByValue=dn.op({clipByValue_:s7e}),nn.cos=dn.op({cos_:d7e}),nn.cosh=dn.op({cosh_:y7e}),nn.erf=dn.op({erf_:S7e}),nn.exp=dn.op({exp_:Q9e}),nn.expm1=dn.op({expm1_:e7e}),nn.floor=dn.op({floor_:G9e}),nn.log=dn.op({log_:t7e}),nn.log1p=dn.op({log1p_:n7e}),nn.logSigmoid=dn.op({logSigmoid_:l7e}),nn.neg=dn.op({neg_:q9e}),nn.reciprocal=dn.op({reciprocal_:a7e}),nn.round=dn.op({round_:J9e}),nn.rsqrt=dn.op({rsqrt_:i7e}),nn.sigmoid=dn.op({sigmoid_:u7e}),nn.sign=dn.op({sign_:K9e}),nn.isNaN=dn.op({isNaN_:X9e}),nn.isInf=dn.op({isInf_:Y9e}),nn.isFinite=dn.op({isFinite_:Z9e}),nn.sin=dn.op({sin_:f7e}),nn.sinh=dn.op({sinh_:v7e}),nn.softplus=dn.op({softplus_:c7e}),nn.sqrt=dn.op({sqrt_:r7e}),nn.step=dn.op({step_:E7e}),nn.tan=dn.op({tan_:h7e}),nn.tanh=dn.op({tanh_:b7e});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(si,"__esModule",{value:!0});var Kf=Yr,Xf=cs,xn=$r,bc=qe,gne=lA,Zr=sp,Mi=oi,mne=up,A7e=nn;function C7e(e,t){var n=xn.convertToTensor(e,"a","addStrict"),r=xn.convertToTensor(t,"b","addStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in addStrict: "),n.add(r)}function k7e(e,t){var n,r=xn.convertToTensor(e,"a","sub"),i=xn.convertToTensor(t,"b","sub");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s){var u=function(){var c=s,f=Zr.getReductionAxes(r.shape,a);return f.length>0&&(c=c.sum(f)),c.reshape(r.shape)},l=function(){var c=s,f=Zr.getReductionAxes(i.shape,a);return f.length>0&&(c=c.sum(f)),c.neg().reshape(i.shape)};return{a:u,b:l}};return Kf.ENGINE.runKernelFunc(function(s){return s.subtract(r,i)},{a:r,b:i},o,"Sub")}function T7e(e,t){var n=xn.convertToTensor(e,"a","subStrict"),r=xn.convertToTensor(t,"b","subStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}function O7e(e,t){var n,r=xn.convertToTensor(e,"base","pow"),i=xn.convertToTensor(t,"exp","pow");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(c,f){var d=f[0],h=f[1],p=f[2],g=function(){var v=h.toFloat(),y=c.mul(v.mul(d.pow(v.sub(mne.scalar(1))))),b=Zr.getReductionAxes(d.shape,a);return b.length>0&&(y=y.sum(b)),y.reshape(d.shape)},m=function(){var v=d.greater(0),y=d.log().where(v,mne.zerosLike(d)),b=c.mul(p.mul(y)),x=Zr.getReductionAxes(h.shape,a);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)};return{a:g,b:m}},s={},u=[r,i],l=[!0];return Kf.ENGINE.runKernelFunc(function(c,f){var d=c.pow(r,i);return f([r,i,d]),d},{a:r,b:i},o,"Pow",s,u,l)}function I7e(e,t){return bc.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}function N7e(e,t){var n,r=xn.convertToTensor(e,"a","mul"),i=xn.convertToTensor(t,"b","mul");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.mul(c.toFloat()),p=Zr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Zr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{a:f,b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.multiply(r,i);return u([r,i]),l},{a:r,b:i},o,"Mul")}function D7e(e,t){var n=xn.convertToTensor(e,"a","mul"),r=xn.convertToTensor(t,"b","mul");return bc.assertShapesMatch(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}function R7e(e,t){var n,r=xn.convertToTensor(e,"a","floorDiv"),i=xn.convertToTensor(t,"b","floorDiv");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.div(c.toFloat()),p=Zr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Zr.getReductionAxes(c.shape,a);p.length>0&&(h=h.sum(p).reshape(c.shape));var g=c.square();return h.div(g.toFloat()).neg()};return{a:f,b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.floorDiv(r,i);return u([r,i]),l},{a:r,b:i},o,"FloorDiv")}function F7e(e,t){var n=xn.convertToTensor(e,"a","div"),r=xn.convertToTensor(t,"b","div");return bc.assertShapesMatch(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}function M7e(e,t){var n,r=xn.convertToTensor(e,"a","mod"),i=xn.convertToTensor(t,"b","mod");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Zr.getReductionAxes(l.shape,a);return h.length>0?s.sum(h).reshape(l.shape):s},d=function(){var h=s.mul(l.div(c).floor().neg()),p=Zr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{$a:f,$b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.mod(r,i);return u([r,i]),l},{$a:r,$b:i},o)}function P7e(e,t){var n=xn.convertToTensor(e,"a","modStrict"),r=xn.convertToTensor(t,"b","modStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}function $7e(e,t){var n,r=xn.convertToTensor(e,"a","minimum"),i=xn.convertToTensor(t,"b","minimum");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Zr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.lessEqual(l).toFloat())},f=function(){return o.mul(u.greater(l).toFloat())};return{a:c,b:f}};return Kf.ENGINE.runKernelFunc(function(o,s){var u=o.minimum(r,i);return s([r,i]),u},{a:r,b:i},a,"Minimum")}function L7e(e,t){var n=xn.convertToTensor(e,"a","minimumStrict"),r=xn.convertToTensor(t,"b","minimumStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}function B7e(e,t){var n,r=xn.convertToTensor(e,"a","maximum"),i=xn.convertToTensor(t,"b","maximum");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Zr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.greaterEqual(l).toFloat())},f=function(){return o.mul(u.less(l).toFloat())};return{a:c,b:f}};return Kf.ENGINE.runKernelFunc(function(o,s){var u=o.maximum(r,i);return s([r,i]),u},{a:r,b:i},a,"Maximum")}function z7e(e,t){var n=xn.convertToTensor(e,"a","maximumStrict"),r=xn.convertToTensor(t,"b","maximumStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}function j7e(e,t){var n=xn.convertToTensor(e,"a","squaredDifferenceStrict"),r=xn.convertToTensor(t,"b","squaredDifferenceStrict");return bc.assertShapesMatch(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}function U7e(e,t){var n,r=xn.convertToTensor(e,"a","atan2"),i=xn.convertToTensor(t,"b","atan2");n=Xf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Zr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=gne.add(l.square(),c.square()),p=s.mul(c.div(h)),g=Zr.getReductionAxes(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},d=function(){var h=gne.add(l.square(),c.square()),p=A7e.neg(s.mul(l.div(h))),g=Zr.getReductionAxes(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)};return{$a:f,$b:d}};return Kf.ENGINE.runKernelFunc(function(s,u){var l=s.atan2(r,i);return u([r,i]),l},{$a:r,$b:i},o)}si.addStrict=Mi.op({addStrict_:C7e}),si.atan2=Mi.op({atan2_:U7e}),si.divStrict=Mi.op({divStrict_:F7e}),si.floorDiv=Mi.op({floorDiv_:R7e}),si.maximum=Mi.op({maximum_:B7e}),si.maximumStrict=Mi.op({maximumStrict_:z7e}),si.minimum=Mi.op({minimum_:$7e}),si.minimumStrict=Mi.op({minimumStrict_:L7e}),si.mod=Mi.op({mod_:M7e}),si.modStrict=Mi.op({modStrict_:P7e}),si.mul=Mi.op({mul_:N7e}),si.mulStrict=Mi.op({mulStrict_:D7e}),si.pow=Mi.op({pow_:O7e}),si.powStrict=Mi.op({powStrict_:I7e}),si.squaredDifferenceStrict=Mi.op({squaredDifferenceStrict_:j7e}),si.sub=Mi.op({sub_:k7e}),si.subStrict=Mi.op({subStrict_:T7e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(yA,"__esModule",{value:!0});var W7e=Yr,V7e=yr,q7e=cs,vne=$r,H7e=si,G7e=oi;function K7e(e,t){var n,r=vne.convertToTensor(e,"a","div"),i=vne.convertToTensor(t,"b","div");if(n=q7e.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return H7e.floorDiv(r,i);var a=function(u,l){var c=u.realDivide(r,i);return l([r,i]),c},o={a:r,b:i},s={};return W7e.ENGINE.runKernelFunc(a,o,null,V7e.Div,s)}yA.div=G7e.op({div_:K7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty($9e,"__esModule",{value:!0});var X7e=yA,Y7e=Tr;Y7e.Tensor.prototype.div=function(e){return X7e.div(this,e)};var Z7e={},$$={},yne={},L$={},bne={},tl={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(tl,"__esModule",{value:!0});var J7e=qe;function B$(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}tl.axesAreInnerMostDims=B$;function xne(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}tl.combineLocations=xne;function Q7e(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);var a=t.map(function(o){return e[o]});return[n,a]}tl.computeOutAndReduceShapes=Q7e;function eUe(e,t){var n=t.map(function(r){return 1});return xne(e,n,t)}tl.expandShapeToKeepDim=eUe;function tUe(e,t,n){J7e.assert(B$(t,n),function(){return e+" supports only inner-most axes for now. "+("Got axes "+t+" and rank-"+n+" input.")})}tl.assertAxesAreInnerMostDims=tUe;function nUe(e,t){if(B$(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}tl.getAxesPermutation=nUe;function rUe(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}tl.getUndoAxesPermutation=rUe;function iUe(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}tl.getInnerMostAxes=iUe;var wne={},xA={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(xA,"__esModule",{value:!0});var z$=qe;function aUe(e,t){var n=e[0].length;e.forEach(function(i,a){z$.assert(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+n+")")})}),z$.assert(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)z$.assert(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") "+("does not match the shape of the rest ("+r+") ")+("along the non-concatenated axis "+a+".")})})}xA.assertParamsConsistent=aUe;function oUe(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}xA.computeOutShape=oUe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Yr,n=$r,r=qe,i=qe,a=xA,o=oi,s=up;function u(p){return e.concat(p,0)}function l(p,g){return e.concat(p,g)}function c(p,g){return e.concat(p,g)}function f(p,g){return e.concat(p,g)}function d(p,g){g===void 0&&(g=0),r.assert(p.length>=1,function(){return"Pass at least one tensor to concat"});var m=n.convertToTensorArray(p,"tensors","concat");m[0].dtype==="complex64"&&m.forEach(function(S){if(S.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+S.dtype+". ")}),g=i.parseAxisParam(g,m[0].shape)[0];var v=a.computeOutShape(m.map(function(S){return S.shape}),g);if(r.sizeFromShape(v)===0)return s.tensor([],v);if(m=m.filter(function(S){return S.size>0}),m.length===1)return m[0];var y=m.map(function(S){return S.shape});a.assertParamsConsistent(y,g);var b=function(S){var A=y.map(function(E){return E[g]}),_=e.split(S,A,g);return _.map(function(E){return function(){return E}})},x=m,w={axis:g};return t.ENGINE.runKernelFunc(function(S){return S.concat(m,g)},x,b,"Concat",w)}function h(p,g,m){m===void 0&&(m=0);var v=n.convertToTensor(p,"x","split");m=i.parseAxisParam(m,v.shape)[0];var y;typeof g=="number"?(r.assert(v.shape[m]%g==0,function(){return"Number of splits must evenly divide the axis."}),y=new Array(g).fill(v.shape[m]/g)):(r.assert(v.shape[m]===g.reduce(function(x,w){return x+w}),function(){return"The sum of sizes must match the size of the axis dimension."}),y=g);var b=function(x){return{$x:function(){return e.concat(x,m)}}};return t.ENGINE.runKernelFunc(function(x){return x.split(v,y,m)},{$x:v},b)}e.concat=o.op({concat_:d}),e.concat1d=o.op({concat1d_:u}),e.concat2d=o.op({concat2d_:l}),e.concat3d=o.op({concat3d_:c}),e.concat4d=o.op({concat4d_:f}),e.split=o.op({split_:h})}(wne),function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(A,_,E,C){return new(E||(E=Promise))(function(k,T){function I(D){try{O(C.next(D))}catch(L){T(L)}}function N(D){try{O(C.throw(D))}catch(L){T(L)}}function O(D){D.done?k(D.value):new E(function(L){L(D.value)}).then(I,N)}O((C=C.apply(A,_||[])).next())})},n=Ye&&Ye.__generator||function(A,_){var E={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},C,k,T,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(D){return function(L){return O([D,L])}}function O(D){if(C)throw new TypeError("Generator is already executing.");for(;E;)try{if(C=1,k&&(T=D[0]&2?k.return:D[0]?k.throw||((T=k.return)&&T.call(k),0):k.next)&&!(T=T.call(k,D[1])).done)return T;switch(k=0,T&&(D=[D[0]&2,T.value]),D[0]){case 0:case 1:T=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,k=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(T=E.trys,!(T=T.length>0&&T[T.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!T||D[1]>T[0]&&D[1]<T[3])){E.label=D[1];break}if(D[0]===6&&E.label<T[1]){E.label=T[1],T=D;break}if(T&&E.label<T[2]){E.label=T[2],E.ops.push(D);break}T[2]&&E.ops.pop(),E.trys.pop();continue}D=_.call(A,E)}catch(L){D=[6,L],k=0}finally{C=T=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=Yr,i=Tr,a=$r,o=qe,s=tl,u=wne,l=oi;function c(A,_){var E=a.convertToTensor(A,"x","reshape",null);_=o.inferFromImplicitShape(_,E.size),o.assert(E.size===o.sizeFromShape(_),function(){return"new shape and old shape must have the same number of elements."});var C=function(T){return{x:function(){return T.reshape(E.shape)}}},k={shape:_};return r.ENGINE.runKernelFunc(function(T){return T.reshape(E,_)},{x:E},C,"Reshape",k)}function f(A,_){var E=a.convertToTensor(A,"x","squeeze");return e.reshape(E,o.squeezeShape(E.shape,_).newShape)}function d(A,_){var E=a.convertToTensor(A,"x","cast");if(!o.isValidDtype(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&E.dtype!=="string"||_!=="string"&&E.dtype==="string")throw new Error("Only strings can be casted to strings");var C=function(T){return{x:function(){return T.clone()}}},k={dtype:_};return r.ENGINE.runKernelFunc(function(T){return T.cast(E,_)},{x:E},C,"Cast",k)}function h(A,_){_===void 0&&(_=0);var E=a.convertToTensorArray(A,"tensors","stack");if(o.assert(E.length>=1,function(){return"Pass at least one tensor to tf.stack"}),E.length===1)return E[0].expandDims(_);var C=E[0].rank,k=E[0].shape,T=E[0].dtype;o.assert(_<=C,function(){return"Axis must be <= rank of the tensor"}),E.forEach(function(N){o.assertShapesMatch(k,N.shape,"All tensors passed to stack must have matching shapes")}),E.forEach(function(N){o.assert(T===N.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var I=E.map(function(N){return N.expandDims(_)});return u.concat(I,_)}function p(A,_,E){var C=a.convertToTensor(A,"x","batchToSpaceND"),k=_.reduce(function(I,N){return I*N});o.assert(C.rank>=1+_.length,function(){return"input rank is "+C.rank+" but should be > than blockShape.length "+_.length}),o.assert(E.length===_.length,function(){return"crops.length is "+E.length+" but should be equal to blockShape.length  "+_.length}),o.assert(C.shape[0]%k==0,function(){return"input tensor batch is "+C.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+_.join(" * ")+" === "+k)});var T=function(I){return{$x:function(){return I.spaceToBatchND(_,E)}}};return r.ENGINE.runKernelFunc(function(I){return I.batchToSpaceND(C,_,E)},{$x:C},T)}function g(A,_,E){var C=a.convertToTensor(A,"x","spaceToBatchND");o.assert(C.rank>=1+_.length,function(){return"input rank "+C.rank+" should be > than [blockShape] "+_.length}),o.assert(E.length===_.length,function(){return"paddings.shape[0] "+E.length+" must be equal to [blockShape] "+_.length}),o.assert(C.shape.reduce(function(T,I,N){return N>0&&N<=_.length?T&&(I+E[N-1][0]+E[N-1][1])%_[N-1]==0:T},!0),function(){return"input spatial dimensions "+C.shape.slice(1)+" with paddings "+E.toString()+" must be divisible by blockShapes "+_.toString()});var k=function(T){return{$x:function(){return T.batchToSpaceND(_,E)}}};return r.ENGINE.runKernelFunc(function(T){return T.spaceToBatchND(C,_,E)},{$x:C},k)}function m(A,_){_===void 0&&(_=0),_=_||0;var E=a.convertToTensor(A,"x","unstack");o.assert(_>=-E.shape.length&&_<E.shape.length,function(){return"Axis = "+_+" is not in [-"+E.shape.length+", "+E.shape.length+")"}),_<0&&(_+=E.shape.length);var C=function(T){return{x:function(){return e.stack(T,_)}}},k={axis:_};return r.ENGINE.runKernelFunc(function(T){return T.unstack(E,_)},{x:E},C,"Unpack",k)}function v(A,_,E,C){_===void 0&&(_=0),E===void 0&&(E=!1),C===void 0&&(C=!1);var k=a.convertToTensor(A,"x","cumsum");_=_|0;var T=s.getAxesPermutation([_],k.rank),I=k;T!=null&&(I=k.transpose(T));var N=s.getInnerMostAxes(1,k.rank)[0],O=function(L){return{permutedX:function(){return L.cumsum(_,E,!C)}}},D=r.ENGINE.runKernelFunc(function(L){return L.cumsum(I,N,E,C)},{permutedX:I},O);return T!=null&&(D=D.transpose(T)),D}function y(A,_){_===void 0&&(_=0);var E=null,C=a.convertToTensor(A,"x","expandDims",E);o.assert(_<=C.rank,function(){return"Axis must be <= rank of the tensor"});var k=C.shape.slice();return _<0&&(o.assert(-(C.rank+1)<=_,function(){return"Axis must be in the interval ["+-(C.rank+1)+", "+C.rank+"]"}),_=C.rank+_+1),k.splice(_,0,1),e.reshape(C,k)}function b(A,_,E){E===void 0&&(E="NHWC");var C=a.convertToTensor(A,"x","depthToSpace"),k=E==="NHWC"?C.shape[1]:C.shape[2],T=E==="NHWC"?C.shape[2]:C.shape[3],I=E==="NHWC"?C.shape[3]:C.shape[1];return o.assert(k*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+k+" and "+_+`  for depthToSpace with input shape
      `+C.shape}),o.assert(T*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+T+" and "+_+` for depthToSpace with input shape
          `+C.shape}),o.assert(I%(_*_)==0,function(){return"Dimension size must be evenly divisible by "+_*_+" but is "+I+" for depthToSpace with input shape "+C.shape}),r.ENGINE.runKernelFunc(function(N){return N.depthToSpace(C,_,E)},{$x:C})}function x(A,_){return t(this,void 0,void 0,function(){var E,C,k,T,I,N,O,D,L,O,W;return n(this,function(G){switch(G.label){case 0:return E=a.convertToTensor(A,"x","setdiff1d"),C=a.convertToTensor(_,"y","setdiff1d"),o.assert(E.dtype===C.dtype,function(){return"x and y should have the same dtype, but got x ("+E.dtype+") and y ("+C.dtype+")."}),o.assert(E.rank===1,function(){return"x should be 1D tensor, but got x ("+E.shape+")."}),o.assert(C.rank===1,function(){return"y should be 1D tensor, but got y ("+C.shape+")."}),[4,E.data()];case 1:return k=G.sent(),[4,C.data()];case 2:for(T=G.sent(),I=new Set(T),N=0,O=0;O<k.length;O++)I.has(k[O])||N++;for(D=new i.TensorBuffer([N],E.dtype),L=new i.TensorBuffer([N],"int32"),O=0,W=0;O<k.length;O++)I.has(k[O])||(D.values[W]=k[O],L.values[W]=O,W++);return[2,[D.toTensor(),L.toTensor()]]}})})}function w(A,_,E){return _===void 0&&(_="float32"),_=_||"float32",o.assertNonNegativeIntegerDimensions(A),new i.TensorBuffer(A,_,E)}e.buffer=w;function S(A,_){_===void 0&&(_=!1),console.log(A.toString(_))}e.print=S,e.batchToSpaceND=l.op({batchToSpaceND_:p}),e.cast=l.op({cast_:d}),e.cumsum=l.op({cumsum_:v}),e.depthToSpace=l.op({depthToSpace_:b}),e.expandDims=l.op({expandDims_:y}),e.reshape=l.op({reshape_:c}),e.spaceToBatchND=l.op({spaceToBatchND_:g}),e.squeeze=l.op({squeeze_:f}),e.stack=l.op({stack_:h}),e.unstack=l.op({unstack_:m}),e.setdiff1dAsync=x}(bne);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(L$,"__esModule",{value:!0});var _ne=bne;function sUe(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var i=_ne.buffer(e,"int32"),a=_ne.buffer([n.length,e.length],"int32"),r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}L$.whereImpl=sUe,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(m,v,y,b){return new(y||(y=Promise))(function(x,w){function S(E){try{_(b.next(E))}catch(C){w(C)}}function A(E){try{_(b.throw(E))}catch(C){w(C)}}function _(E){E.done?x(E.value):new y(function(C){C(E.value)}).then(S,A)}_((b=b.apply(m,v||[])).next())})},n=Ye&&Ye.__generator||function(m,v){var y={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},b,x,w,S;return S={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function A(E){return function(C){return _([E,C])}}function _(E){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,x&&(w=E[0]&2?x.return:E[0]?x.throw||((w=x.return)&&w.call(x),0):x.next)&&!(w=w.call(x,E[1])).done)return w;switch(x=0,w&&(E=[E[0]&2,w.value]),E[0]){case 0:case 1:w=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,x=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(w=y.trys,!(w=w.length>0&&w[w.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!w||E[1]>w[0]&&E[1]<w[3])){y.label=E[1];break}if(E[0]===6&&y.label<w[1]){y.label=w[1],w=E;break}if(w&&y.label<w[2]){y.label=w[2],y.ops.push(E);break}w[2]&&y.ops.pop(),y.trys.pop();continue}E=v.call(m,y)}catch(C){E=[6,C],x=0}finally{b=w=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=L$,i=Yr,a=$r,o=qe,s=sp,u=oi,l=up;function c(m){var v=a.convertToTensor(m,"x","logicalNot","bool");return i.ENGINE.runKernelFunc(function(y){return y.logicalNot(v)},{$x:v})}function f(m,v){var y=a.convertToTensor(m,"a","logicalAnd","bool"),b=a.convertToTensor(v,"b","logicalAnd","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalAnd(y,b)},{a:y,b},null,"LogicalAnd")}function d(m,v){var y=a.convertToTensor(m,"a","logicalOr","bool"),b=a.convertToTensor(v,"b","logicalOr","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalOr(y,b)},{$a:y,$b:b})}function h(m,v){var y=a.convertToTensor(m,"a","logicalXor","bool"),b=a.convertToTensor(v,"b","logicalXor","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),e.logicalOr(m,v).logicalAnd(e.logicalAnd(m,v).logicalNot())}function p(m,v,y){var b=a.convertToTensor(v,"a","where"),x=a.convertToTensor(y,"b","where"),w=a.convertToTensor(m,"condition","where","bool");o.assertShapesMatch(b.shape,x.shape,"Error in where: "),w.rank===1?o.assert(w.shape[0]===b.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):o.assertShapesMatch(w.shape,x.shape,"Error in where: ");var S=function(A,_){var E=_[0];return{$condition:function(){return l.zerosLike(E).toFloat()},$a:function(){return A.mul(E.cast(A.dtype))},$b:function(){return A.mul(E.logicalNot().cast(A.dtype))}}};return i.ENGINE.runKernelFunc(function(A,_){var E=A.select(w,b,x);return _([w]),E},{$condition:w,$a:b,$b:x},S)}function g(m){return t(this,void 0,void 0,function(){var v,y,b;return n(this,function(x){switch(x.label){case 0:return v=a.convertToTensor(m,"condition","whereAsync","bool"),[4,v.data()];case 1:return y=x.sent(),b=r.whereImpl(v.shape,y),m!==v&&v.dispose(),[2,b]}})})}e.logicalAnd=u.op({logicalAnd_:f}),e.logicalNot=u.op({logicalNot_:c}),e.logicalOr=u.op({logicalOr_:d}),e.logicalXor=u.op({logicalXor_:h}),e.where=u.op({where_:p}),e.whereAsync=g}(yne);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty($$,"__esModule",{value:!0});var uUe=cs,Sne=$r,lUe=yA,cUe=yne,fUe=oi,dUe=up;function hUe(e,t){var n,r=Sne.convertToTensor(e,"a","div"),i=Sne.convertToTensor(t,"b","div");n=uUe.makeTypesMatch(r,i),r=n[0],i=n[1];var a=lUe.div(r,i),o=dUe.zerosLike(a),s=i.equal(o);return cUe.where(s,o,a)}$$.divNoNan=fUe.op({divNoNan_:hUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Z7e,"__esModule",{value:!0});var pUe=$$,gUe=Tr;gUe.Tensor.prototype.divNoNan=function(e){return pUe.divNoNan(this,e)};var mUe={},j$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(j$,"__esModule",{value:!0});var vUe=Yr,yUe=yr,bUe=cs,Ene=$r,xUe=sp,wUe=oi,_Ue=up;function SUe(e,t){var n,r=Ene.convertToTensor(e,"a","squaredDifference"),i=Ene.convertToTensor(t,"b","squaredDifference");n=bUe.makeTypesMatch(r,i),r=n[0],i=n[1],xUe.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(f,d){var h=d[0],p=d[1],g=_Ue.scalar(2),m=function(){return f.mul(h.sub(p).mul(g))},v=function(){return f.mul(p.sub(h).mul(g))};return{a:m,b:v}},o=function(f,d){var h=f.squaredDifference(r,i);return d([r,i]),h},s={a:r,b:i},u={},l=[r,i],c=[];return vUe.ENGINE.runKernelFunc(o,s,a,yUe.SquaredDifference,u,l,c)}j$.squaredDifference=wUe.op({squaredDifference_:SUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(mUe,"__esModule",{value:!0});var EUe=j$,AUe=Tr;AUe.Tensor.prototype.squaredDifference=function(e){return EUe.squaredDifference(this,e)};var CUe={},U$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(U$,"__esModule",{value:!0});var kUe=Yr,TUe=yr,OUe=$r,IUe=qe,NUe=oi;function DUe(e,t){var n=null,r=OUe.convertToTensor(e,"x","tile",n);IUe.assert(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" "+("must match length of reps "+t+".")});var i=function(u,l){var c=u.tile(r,t);return l([r]),c},a=[r],o={x:r},s={reps:t};return kUe.ENGINE.runKernelFunc(i,o,null,TUe.Tile,s,a)}U$.tile=NUe.op({tile_:DUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(CUe,"__esModule",{value:!0});var RUe=U$,FUe=Tr;FUe.Tensor.prototype.tile=function(e){return RUe.tile(this,e)};var MUe={},W$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(W$,"__esModule",{value:!0});var PUe=Yr,$Ue=yr,LUe=$r,BUe=oi;function zUe(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=LUe.convertToTensor(e,"indices","oneHot","int32"),a=i.shape.concat([t]);i=i.flatten();var o=function(c,f){return f([i]),c.oneHot(i,t,n,r)},s={indices:i},u={depth:t,onValue:n,offValue:r},l=PUe.ENGINE.runKernelFunc(o,s,null,$Ue.OneHot,u);return l.reshape(a)}W$.oneHot=BUe.op({oneHot_:zUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(MUe,"__esModule",{value:!0});var jUe=W$,UUe=Tr;UUe.Tensor.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),jUe.oneHot(this,e,t,n)};var WUe={},V$={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(V$,"__esModule",{value:!0});var VUe=Yr,qUe=$r,Ane=qe,HUe=oi;function GUe(e,t){var n=qUe.convertToTensor(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),Ane.assert(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" "+("must match length of perm "+t+".")}),t.forEach(function(i){Ane.assert(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+(" but got "+t)})}),n.rank<=1)return n.clone();var r={perm:t};return VUe.ENGINE.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}V$.transpose=HUe.op({transpose_:GUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(WUe,"__esModule",{value:!0});var KUe=V$,XUe=Tr;XUe.Tensor.prototype.transpose=function(e){return KUe.transpose(this,e)};var YUe={},q$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(q$,"__esModule",{value:!0});var ZUe=Yr,JUe=yr,QUe=$r,eWe=oi;function tWe(e,t,n){n===void 0&&(n=0);var r=QUe.convertToTensor(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=function(s,u){return u([r]),s.pad(r,t,n)},a={paddings:t,constantValue:n},o={x:r};return ZUe.ENGINE.runKernelFunc(i,o,null,JUe.PadV2,a)}q$.pad=eWe.op({pad_:tWe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(YUe,"__esModule",{value:!0});var nWe=q$,rWe=Tr;rWe.Tensor.prototype.pad=function(e,t){return nWe.pad(this,e,t)};var iWe={},wA={},_A={},br={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(br,"__esModule",{value:!0});var Ca=Yr,i1=ov,aWe=Tr,oWe=cs;function sWe(){i1.env().set("PROD",!0)}br.enableProdMode=sWe;function uWe(){i1.env().set("DEBUG",!0)}br.enableDebugMode=uWe;function lWe(){i1.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}br.disableDeprecationWarnings=lWe;function Cne(e){i1.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}br.deprecationWarn=Cne,aWe.setDeprecationWarningFn(Cne);function cWe(){Ca.ENGINE.disposeVariables()}br.disposeVariables=cWe;function fWe(){return Ca.ENGINE}br.engine=fWe;function dWe(){return Ca.ENGINE.memory()}br.memory=dWe;function hWe(e){return Ca.ENGINE.profile(e)}br.profile=hWe;function pWe(e,t){return Ca.ENGINE.tidy(e,t)}br.tidy=pWe;function gWe(e){var t=oWe.getTensorsInContainer(e);t.forEach(function(n){return n.dispose()})}br.dispose=gWe;function mWe(e){return Ca.ENGINE.keep(e)}br.keep=mWe;function vWe(e){return Ca.ENGINE.time(e)}br.time=vWe;function yWe(e){return Ca.ENGINE.setBackend(e)}br.setBackend=yWe;function bWe(){return Ca.ENGINE.ready()}br.ready=bWe;function xWe(){return Ca.ENGINE.backendName}br.getBackend=xWe;function wWe(e){Ca.ENGINE.removeBackend(e)}br.removeBackend=wWe;function _We(e){return Ca.ENGINE.findBackend(e)}br.findBackend=_We;function SWe(e){return Ca.ENGINE.findBackendFactory(e)}br.findBackendFactory=SWe;function EWe(e,t,n){return n===void 0&&(n=1),Ca.ENGINE.registerBackend(e,t,n)}br.registerBackend=EWe;function AWe(){return Ca.ENGINE.backend}br.backend=AWe;function CWe(e,t){i1.env().setPlatform(e,t)}br.setPlatform=CWe,Object.defineProperty(_A,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var kWe=br;function TWe(){kWe.deprecationWarn("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}_A.warnDeprecation=TWe;function OWe(e){var t;return e.rank===0||e.rank===1?t=e.as4D(1,1,1,e.size):e.rank===2?t=e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?t=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):t=e,t}_A.xAs4D=OWe;/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(wA,"__esModule",{value:!0});var IWe=Yr,a1=$r,H$=qe,kne=_A,Tne=oi;function NWe(e,t,n,r,i,a){return r===void 0&&(r=.001),kne.warnDeprecation(),One(e,t,n,a,i,r)}function One(e,t,n,r,i,a){a==null&&(a=.001);var o=a1.convertToTensor(e,"x","batchNorm"),s=a1.convertToTensor(t,"mean","batchNorm"),u=a1.convertToTensor(n,"variance","batchNorm"),l;i!=null&&(l=a1.convertToTensor(i,"scale","batchNorm"));var c;r!=null&&(c=a1.convertToTensor(r,"offset","batchNorm")),H$.assert(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),H$.assert(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),H$.assert(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f=function(g,m){var v=kne.xAs4D(o),y=g.batchNormalization(v,SA(s),SA(u),a,SA(l),SA(c));return m([o,s,u,l]),y},d={x:o,scale:l,offset:c,mean:s,variance:u},h={varianceEpsilon:a},p=IWe.ENGINE.runKernelFunc(f,d,null,"FusedBatchNorm",h);return p.reshape(o.shape)}function SA(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}wA.batchNormalization=Tne.op({batchNormalization_:NWe}),wA.batchNorm=Tne.op({batchNorm_:One}),Object.defineProperty(iWe,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DWe=wA,RWe=Tr;RWe.Tensor.prototype.batchNorm=function(e,t,n,r,i){return DWe.batchNorm(this,e,t,n,r,i)},Object.defineProperty(s8e,"__esModule",{value:!0});var G$={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var FWe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),MWe=Object.prototype.hasOwnProperty;function K$(e,t){return MWe.call(e,t)}function X$(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)K$(e,r)&&n.push(r);return n}function Bo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Y$(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function lp(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Ine(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Z$(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Z$(e[t]))return!0}else if(typeof e=="object"){for(var r=X$(e),i=r.length,t=0;t<i;t++)if(Z$(e[r[t]]))return!0}}return!1}function Nne(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var Dne=function(e){FWe(t,e);function t(n,r,i,a,o){var s=this.constructor,u=e.call(this,Nne(n,{name:r,index:i,operation:a,tree:o}))||this;return u.name=r,u.index=i,u.operation=a,u.tree=o,Object.setPrototypeOf(u,s.prototype),u.message=Nne(n,{name:r,index:i,operation:a,tree:o}),u}return t}(Error),Or=Dne,PWe=Bo,lv={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=EA(n,this.path);r&&(r=Bo(r));var i=cp(n,{op:"remove",path:this.from}).removed;return cp(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=EA(n,this.from);return cp(n,{op:"add",path:this.path,value:Bo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:o1(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},$We={add:function(e,t,n){return Y$(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:lv.move,copy:lv.copy,test:lv.test,_get:lv._get};function EA(e,t){if(t=="")return e;var n={op:"_get",path:t};return cp(e,n),n.value}function cp(e,t,n,r,i,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):CA(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=EA(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=o1(e,t.value),o.test===!1)throw new Or("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Or("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}}else{r||(e=Bo(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=CA;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=Ine(h)),i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Y$(h))throw new Or("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);Y$(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new Or("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var o=$We[t.op].call(t,l,h,e);if(o.test===!1)throw new Or("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(c>=f){var o=lv[t.op].call(t,l,h,e);if(o.test===!1)throw new Or("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new Or("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function AA(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Or("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Bo(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=cp(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function LWe(e,t,n){var r=cp(e,t);if(r.test===!1)throw new Or("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function CA(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Or("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(lv[e.op]){if(typeof e.path!="string")throw new Or("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Or('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Or("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Or("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Z$(e.value))throw new Or("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new Or("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Or("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},s=Rne([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Or("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Or("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Rne(e,t,n){try{if(!Array.isArray(e))throw new Or("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)AA(Bo(t),Bo(e),n||!0);else{n=n||CA;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Or)return i;throw i}}function o1(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){if(a=e.length,a!=t.length)return!1;for(i=a;i--!=0;)if(!o1(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(a=s.length,a!==Object.keys(t).length)return!1;for(i=a;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=a;i--!=0;)if(o=s[i],!o1(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var BWe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:Or,deepClone:PWe,getValueByPointer:EA,applyOperation:cp,applyPatch:AA,applyReducer:LWe,validator:CA,validate:Rne,_areEquals:o1});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var J$=new WeakMap,zWe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),jWe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function UWe(e){return J$.get(e)}function WWe(e,t){return e.observers.get(t)}function VWe(e,t){e.observers.delete(t.callback)}function qWe(e,t){t.unobserve()}function HWe(e,t){var n=[],r,i=UWe(e);if(!i)i=new zWe(e),J$.set(e,i);else{var a=WWe(i,t);r=a&&a.observer}if(r)return r;if(r={},i.value=Bo(e),t){r.callback=t,r.next=null;var o=function(){Q$(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){Q$(r),clearTimeout(r.next),VWe(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new jWe(t,r)),r}function Q$(e,t){t===void 0&&(t=!1);var n=J$.get(e.object);eL(n.value,e.object,e.patches,"",t),e.patches.length&&AA(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function eL(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=X$(t),o=X$(e),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(K$(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?eL(c,f,n,r+"/"+lp(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+lp(l),value:Bo(c)}),n.push({op:"replace",path:r+"/"+lp(l),value:Bo(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+lp(l),value:Bo(c)}),n.push({op:"remove",path:r+"/"+lp(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&a.length==o.length))for(var u=0;u<a.length;u++){var l=a[u];!K$(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+lp(l),value:Bo(t[l])})}}}function GWe(e,t,n){n===void 0&&(n=!1);var r=[];return eL(e,t,r,"",n),r}var KWe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:qWe,observe:HWe,generate:Q$,compare:GWe});Object.assign({},BWe,KWe,{JsonPatchError:Dne,deepClone:Bo,escapePathComponent:lp,unescapePathComponent:Ine});var XWe=/("(?:[^\\"]|\\.)*")|[:,]/g,tL=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,a=n.replacer,function o(s,u,l){var c,f,d,h,p,g,m,v,y,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,a),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(y=x.replace(XWe,function(S,A){return A||S+" "}),y.length<=m))return y;if(a!=null&&(s=JSON.parse(x),a=void 0),typeof s=="object"&&s!==null){if(v=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(o(s[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(s),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=o(s[h],v,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[b,r+d.join(`,
`+v),c].join(`
`+u)}return x}(t,"",0)},Yf={exports:{}};const YWe="2.0.0",ZWe=256,JWe=Number.MAX_SAFE_INTEGER||9007199254740991,QWe=16;var kA={SEMVER_SPEC_VERSION:YWe,MAX_LENGTH:ZWe,MAX_SAFE_INTEGER:JWe,MAX_SAFE_COMPONENT_LENGTH:QWe};const eVe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var TA=eVe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=kA,r=TA;t=e.exports={};const i=t.re=[],a=t.src=[],o=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),o[l]=d,a[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${a[o.NUMERICIDENTIFIER]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${a[o.NUMERICIDENTIFIERLOOSE]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${a[o.PRERELEASEIDENTIFIER]}(?:\\.${a[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${a[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${a[o.BUILDIDENTIFIER]}(?:\\.${a[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${a[o.MAINVERSION]}${a[o.PRERELEASE]}?${a[o.BUILD]}?`),u("FULL",`^${a[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${a[o.MAINVERSIONLOOSE]}${a[o.PRERELEASELOOSE]}?${a[o.BUILD]}?`),u("LOOSE",`^${a[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${a[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${a[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:${a[o.PRERELEASE]})?${a[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:${a[o.PRERELEASELOOSE]})?${a[o.BUILD]}?)?)?`),u("XRANGE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",a[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${a[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${a[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${a[o.LONECARET]}${a[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${a[o.LONECARET]}${a[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${a[o.GTLT]}\\s*(${a[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]}|${a[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${a[o.XRANGEPLAIN]})\\s+-\\s+(${a[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${a[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Yf,Yf.exports);const tVe=["includePrerelease","loose","rtl"],nVe=e=>e?typeof e!="object"?{loose:!0}:tVe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var OA=nVe;const Fne=/^[0-9]+$/,Mne=(e,t)=>{const n=Fne.test(e),r=Fne.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},rVe=(e,t)=>Mne(t,e);var nL={compareIdentifiers:Mne,rcompareIdentifiers:rVe};const IA=TA,{MAX_LENGTH:Pne,MAX_SAFE_INTEGER:NA}=kA,{re:$ne,t:Lne}=Yf.exports,iVe=OA,{compareIdentifiers:s1}=nL;class eu{constructor(t,n){if(n=iVe(n),t instanceof eu){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>Pne)throw new TypeError(`version is longer than ${Pne} characters`);IA("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?$ne[Lne.LOOSE]:$ne[Lne.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>NA||this.major<0)throw new TypeError("Invalid major version");if(this.minor>NA||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>NA||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<NA)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(IA("SemVer.compare",this.version,this.options,t),!(t instanceof eu)){if(typeof t=="string"&&t===this.version)return 0;t=new eu(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof eu||(t=new eu(t,this.options)),s1(this.major,t.major)||s1(this.minor,t.minor)||s1(this.patch,t.patch)}comparePre(t){if(t instanceof eu||(t=new eu(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(IA("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return s1(r,i)}while(++n)}compareBuild(t){t instanceof eu||(t=new eu(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(IA("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return s1(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var ka=eu;const{MAX_LENGTH:aVe}=kA,{re:Bne,t:zne}=Yf.exports,jne=ka,oVe=OA,sVe=(e,t)=>{if(t=oVe(t),e instanceof jne)return e;if(typeof e!="string"||e.length>aVe||!(t.loose?Bne[zne.LOOSE]:Bne[zne.FULL]).test(e))return null;try{return new jne(e,t)}catch(r){return null}};var cv=sVe;const uVe=cv,lVe=(e,t)=>{const n=uVe(e,t);return n?n.version:null};var cVe=lVe;const fVe=cv,dVe=(e,t)=>{const n=fVe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var hVe=dVe;const pVe=ka,gVe=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new pVe(e,n).inc(t,r).version}catch(i){return null}};var mVe=gVe;const Une=ka,vVe=(e,t,n)=>new Une(e,n).compare(new Une(t,n));var tu=vVe;const yVe=tu,bVe=(e,t,n)=>yVe(e,t,n)===0;var rL=bVe;const Wne=cv,xVe=rL,wVe=(e,t)=>{if(xVe(e,t))return null;{const n=Wne(e),r=Wne(t),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return a+s;return o}};var _Ve=wVe;const SVe=ka,EVe=(e,t)=>new SVe(e,t).major;var AVe=EVe;const CVe=ka,kVe=(e,t)=>new CVe(e,t).minor;var TVe=kVe;const OVe=ka,IVe=(e,t)=>new OVe(e,t).patch;var NVe=IVe;const DVe=cv,RVe=(e,t)=>{const n=DVe(e,t);return n&&n.prerelease.length?n.prerelease:null};var FVe=RVe;const MVe=tu,PVe=(e,t,n)=>MVe(t,e,n);var $Ve=PVe;const LVe=tu,BVe=(e,t)=>LVe(e,t,!0);var zVe=BVe;const Vne=ka,jVe=(e,t,n)=>{const r=new Vne(e,n),i=new Vne(t,n);return r.compare(i)||r.compareBuild(i)};var iL=jVe;const UVe=iL,WVe=(e,t)=>e.sort((n,r)=>UVe(n,r,t));var VVe=WVe;const qVe=iL,HVe=(e,t)=>e.sort((n,r)=>qVe(r,n,t));var GVe=HVe;const KVe=tu,XVe=(e,t,n)=>KVe(e,t,n)>0;var DA=XVe;const YVe=tu,ZVe=(e,t,n)=>YVe(e,t,n)<0;var aL=ZVe;const JVe=tu,QVe=(e,t,n)=>JVe(e,t,n)!==0;var qne=QVe;const eqe=tu,tqe=(e,t,n)=>eqe(e,t,n)>=0;var oL=tqe;const nqe=tu,rqe=(e,t,n)=>nqe(e,t,n)<=0;var sL=rqe;const iqe=rL,aqe=qne,oqe=DA,sqe=oL,uqe=aL,lqe=sL,cqe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return iqe(e,n,r);case"!=":return aqe(e,n,r);case">":return oqe(e,n,r);case">=":return sqe(e,n,r);case"<":return uqe(e,n,r);case"<=":return lqe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Hne=cqe;const fqe=ka,dqe=cv,{re:RA,t:FA}=Yf.exports,hqe=(e,t)=>{if(e instanceof fqe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(RA[FA.COERCE]);else{let r;for(;(r=RA[FA.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),RA[FA.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;RA[FA.COERCERTL].lastIndex=-1}return n===null?null:dqe(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var pqe=hqe,gqe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},mqe=wn;wn.Node=fp,wn.create=wn;function wn(e){var t=this;if(t instanceof wn||(t=new wn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}wn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},wn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},wn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},wn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)yqe(this,arguments[e]);return this.length},wn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)bqe(this,arguments[e]);return this.length},wn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},wn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},wn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next},wn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev},wn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},wn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},wn.prototype.map=function(e,t){t=t||this;for(var n=new wn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n},wn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new wn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n},wn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n},wn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n},wn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},wn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},wn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n},wn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n},wn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var a=[],r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=vqe(this,i,n[r]);return a},wn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function vqe(e,t,n){var r=t===e.head?new fp(n,null,t,e):new fp(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function yqe(e,t){e.tail=new fp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function bqe(e,t){e.head=new fp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function fp(e,t,n,r){if(!(this instanceof fp))return new fp(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{gqe(wn)}catch(e){}const xqe=mqe,dp=Symbol("max"),xc=Symbol("length"),fv=Symbol("lengthCalculator"),u1=Symbol("allowStale"),hp=Symbol("maxAge"),wc=Symbol("dispose"),Gne=Symbol("noDisposeOnSet"),bi=Symbol("lruList"),nu=Symbol("cache"),Kne=Symbol("updateAgeOnGet"),uL=()=>1;class wqe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[dp]=t.max||1/0;const n=t.length||uL;if(this[fv]=typeof n!="function"?uL:n,this[u1]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[hp]=t.maxAge||0,this[wc]=t.dispose,this[Gne]=t.noDisposeOnSet||!1,this[Kne]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[dp]=t||1/0,l1(this)}get max(){return this[dp]}set allowStale(t){this[u1]=!!t}get allowStale(){return this[u1]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[hp]=t,l1(this)}get maxAge(){return this[hp]}set lengthCalculator(t){typeof t!="function"&&(t=uL),t!==this[fv]&&(this[fv]=t,this[xc]=0,this[bi].forEach(n=>{n.length=this[fv](n.value,n.key),this[xc]+=n.length})),l1(this)}get lengthCalculator(){return this[fv]}get length(){return this[xc]}get itemCount(){return this[bi].length}rforEach(t,n){n=n||this;for(let r=this[bi].tail;r!==null;){const i=r.prev;Xne(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[bi].head;r!==null;){const i=r.next;Xne(this,t,r,n),r=i}}keys(){return this[bi].toArray().map(t=>t.key)}values(){return this[bi].toArray().map(t=>t.value)}reset(){this[wc]&&this[bi]&&this[bi].length&&this[bi].forEach(t=>this[wc](t.key,t.value)),this[nu]=new Map,this[bi]=new xqe,this[xc]=0}dump(){return this[bi].map(t=>MA(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[bi]}set(t,n,r){if(r=r||this[hp],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,a=this[fv](n,t);if(this[nu].has(t)){if(a>this[dp])return dv(this,this[nu].get(t)),!1;const u=this[nu].get(t).value;return this[wc]&&(this[Gne]||this[wc](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[xc]+=a-u.length,u.length=a,this.get(t),l1(this),!0}const o=new _qe(t,n,a,i,r);return o.length>this[dp]?(this[wc]&&this[wc](t,n),!1):(this[xc]+=o.length,this[bi].unshift(o),this[nu].set(t,this[bi].head),l1(this),!0)}has(t){if(!this[nu].has(t))return!1;const n=this[nu].get(t).value;return!MA(this,n)}get(t){return lL(this,t,!0)}peek(t){return lL(this,t,!1)}pop(){const t=this[bi].tail;return t?(dv(this,t),t.value):null}del(t){dv(this,this[nu].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-n;o>0&&this.set(i.k,i.v,o)}}}prune(){this[nu].forEach((t,n)=>lL(this,n,!1))}}const lL=(e,t,n)=>{const r=e[nu].get(t);if(r){const i=r.value;if(MA(e,i)){if(dv(e,r),!e[u1])return}else n&&(e[Kne]&&(r.value.now=Date.now()),e[bi].unshiftNode(r));return i.value}},MA=(e,t)=>{if(!t||!t.maxAge&&!e[hp])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[hp]&&n>e[hp]},l1=e=>{if(e[xc]>e[dp])for(let t=e[bi].tail;e[xc]>e[dp]&&t!==null;){const n=t.prev;dv(e,t),t=n}},dv=(e,t)=>{if(t){const n=t.value;e[wc]&&e[wc](n.key,n.value),e[xc]-=n.length,e[nu].delete(n.key),e[bi].removeNode(t)}};class _qe{constructor(t,n,r,i,a){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=a||0}}const Xne=(e,t,n,r)=>{let i=n.value;MA(e,i)&&(dv(e,n),e[u1]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var Sqe=wqe;class c1{constructor(t,n){if(n=Aqe(n),t instanceof c1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new c1(t.raw,n);if(t instanceof cL)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!Zne(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&Iqe(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=Yne.get(r);if(i)return i;const a=this.options.loose,o=a?Xi[Pi.HYPHENRANGELOOSE]:Xi[Pi.HYPHENRANGE];t=t.replace(o,zqe(this.options.includePrerelease)),Lr("hyphen replace",t),t=t.replace(Xi[Pi.COMPARATORTRIM],kqe),Lr("comparator trim",t,Xi[Pi.COMPARATORTRIM]),t=t.replace(Xi[Pi.TILDETRIM],Tqe),t=t.replace(Xi[Pi.CARETTRIM],Oqe),t=t.split(/\s+/).join(" ");const s=a?Xi[Pi.COMPARATORLOOSE]:Xi[Pi.COMPARATOR],u=t.split(" ").map(f=>Nqe(f,this.options)).join(" ").split(/\s+/).map(f=>Bqe(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new cL(f,this.options));u.length;const l=new Map;for(const f of u){if(Zne(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return Yne.set(r,c),c}intersects(t,n){if(!(t instanceof c1))throw new TypeError("a Range is required");return this.set.some(r=>Jne(r,n)&&t.set.some(i=>Jne(i,n)&&r.every(a=>i.every(o=>a.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new Cqe(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(jqe(this.set[n],t,this.options))return!0;return!1}}var ru=c1;const Eqe=Sqe,Yne=new Eqe({max:1e3}),Aqe=OA,cL=$A,Lr=TA,Cqe=ka,{re:Xi,t:Pi,comparatorTrimReplace:kqe,tildeTrimReplace:Tqe,caretTrimReplace:Oqe}=Yf.exports,Zne=e=>e.value==="<0.0.0-0",Iqe=e=>e.value==="",Jne=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(a=>i.intersects(a,t)),i=r.pop();return n},Nqe=(e,t)=>(Lr("comp",e,t),e=Fqe(e,t),Lr("caret",e),e=Dqe(e,t),Lr("tildes",e),e=Pqe(e,t),Lr("xrange",e),e=Lqe(e,t),Lr("stars",e),e),Ta=e=>!e||e.toLowerCase()==="x"||e==="*",Dqe=(e,t)=>e.trim().split(/\s+/).map(n=>Rqe(n,t)).join(" "),Rqe=(e,t)=>{const n=t.loose?Xi[Pi.TILDELOOSE]:Xi[Pi.TILDE];return e.replace(n,(r,i,a,o,s)=>{Lr("tilde",e,r,i,a,o,s);let u;return Ta(i)?u="":Ta(a)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:Ta(o)?u=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:s?(Lr("replaceTilde pr",s),u=`>=${i}.${a}.${o}-${s} <${i}.${+a+1}.0-0`):u=`>=${i}.${a}.${o} <${i}.${+a+1}.0-0`,Lr("tilde return",u),u})},Fqe=(e,t)=>e.trim().split(/\s+/).map(n=>Mqe(n,t)).join(" "),Mqe=(e,t)=>{Lr("caret",e,t);const n=t.loose?Xi[Pi.CARETLOOSE]:Xi[Pi.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,a,o,s,u)=>{Lr("caret",e,i,a,o,s,u);let l;return Ta(a)?l="":Ta(o)?l=`>=${a}.0.0${r} <${+a+1}.0.0-0`:Ta(s)?a==="0"?l=`>=${a}.${o}.0${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.0${r} <${+a+1}.0.0-0`:u?(Lr("replaceCaret pr",u),a==="0"?o==="0"?l=`>=${a}.${o}.${s}-${u} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}-${u} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s}-${u} <${+a+1}.0.0-0`):(Lr("no pr"),a==="0"?o==="0"?l=`>=${a}.${o}.${s}${r} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s} <${+a+1}.0.0-0`),Lr("caret return",l),l})},Pqe=(e,t)=>(Lr("replaceXRanges",e,t),e.split(/\s+/).map(n=>$qe(n,t)).join(" ")),$qe=(e,t)=>{e=e.trim();const n=t.loose?Xi[Pi.XRANGELOOSE]:Xi[Pi.XRANGE];return e.replace(n,(r,i,a,o,s,u)=>{Lr("xRange",e,r,i,a,o,s,u);const l=Ta(a),c=l||Ta(o),f=c||Ta(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(o=0),s=0,i===">"?(i=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):i==="<="&&(i="<",c?a=+a+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:f&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),Lr("xRange return",r),r})},Lqe=(e,t)=>(Lr("replaceStars",e,t),e.trim().replace(Xi[Pi.STAR],"")),Bqe=(e,t)=>(Lr("replaceGTE0",e,t),e.trim().replace(Xi[t.includePrerelease?Pi.GTE0PRE:Pi.GTE0],"")),zqe=e=>(t,n,r,i,a,o,s,u,l,c,f,d,h)=>(Ta(r)?n="":Ta(i)?n=`>=${r}.0.0${e?"-0":""}`:Ta(a)?n=`>=${r}.${i}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Ta(l)?u="":Ta(c)?u=`<${+l+1}.0.0-0`:Ta(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),jqe=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(Lr(e[r].semver),e[r].semver!==cL.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},f1=Symbol("SemVer ANY");class PA{static get ANY(){return f1}constructor(t,n){if(n=Uqe(n),t instanceof PA){if(t.loose===!!n.loose)return t;t=t.value}dL("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===f1?this.value="":this.value=this.operator+this.semver.version,dL("comp",this)}parse(t){const n=this.options.loose?Qne[ere.COMPARATORLOOSE]:Qne[ere.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new tre(r[2],this.options.loose):this.semver=f1}toString(){return this.value}test(t){if(dL("Comparator.test",t,this.options.loose),this.semver===f1||t===f1)return!0;if(typeof t=="string")try{t=new tre(t,this.options)}catch(n){return!1}return fL(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof PA))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new nre(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new nre(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),a=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=fL(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=fL(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||s||u}}var $A=PA;const Uqe=OA,{re:Qne,t:ere}=Yf.exports,fL=Hne,dL=TA,tre=ka,nre=ru,Wqe=ru,Vqe=(e,t,n)=>{try{t=new Wqe(t,n)}catch(r){return!1}return t.test(e)};var LA=Vqe;const qqe=ru,Hqe=(e,t)=>new qqe(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var Gqe=Hqe;const Kqe=ka,Xqe=ru,Yqe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new Xqe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new Kqe(r,n))}),r};var Zqe=Yqe;const Jqe=ka,Qqe=ru,eHe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new Qqe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new Jqe(r,n))}),r};var tHe=eHe;const hL=ka,nHe=ru,rre=DA,rHe=(e,t)=>{e=new nHe(e,t);let n=new hL("0.0.0");if(e.test(n)||(n=new hL("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let a=null;i.forEach(o=>{const s=new hL(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||rre(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!n||rre(n,a))&&(n=a)}return n&&e.test(n)?n:null};var iHe=rHe;const aHe=ru,oHe=(e,t)=>{try{return new aHe(e,t).range||"*"}catch(n){return null}};var sHe=oHe;const uHe=ka,ire=$A,{ANY:lHe}=ire,cHe=ru,fHe=LA,are=DA,ore=aL,dHe=sL,hHe=oL,pHe=(e,t,n,r)=>{e=new uHe(e,r),t=new cHe(t,r);let i,a,o,s,u;switch(n){case">":i=are,a=dHe,o=ore,s=">",u=">=";break;case"<":i=ore,a=hHe,o=are,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(fHe(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===lHe&&(h=new ire(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:o(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var pL=pHe;const gHe=pL,mHe=(e,t,n)=>gHe(e,t,">",n);var vHe=mHe;const yHe=pL,bHe=(e,t,n)=>yHe(e,t,"<",n);var xHe=bHe;const sre=ru,wHe=(e,t,n)=>(e=new sre(e,n),t=new sre(t,n),e.intersects(t));var _He=wHe;const SHe=LA,EHe=tu;var AHe=(e,t,n)=>{const r=[];let i=null,a=null;const o=e.sort((c,f)=>EHe(c,f,n));for(const c of o)SHe(c,t,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const ure=ru,BA=$A,{ANY:gL}=BA,d1=LA,mL=tu,CHe=(e,t,n={})=>{if(e===t)return!0;e=new ure(e,n),t=new ure(t,n);let r=!1;e:for(const i of e.set){for(const a of t.set){const o=kHe(i,a,n);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},kHe=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===gL){if(t.length===1&&t[0].semver===gL)return!0;n.includePrerelease?e=[new BA(">=0.0.0-0")]:e=[new BA(">=0.0.0")]}if(t.length===1&&t[0].semver===gL){if(n.includePrerelease)return!0;t=[new BA(">=0.0.0")]}const r=new Set;let i,a;for(const h of e)h.operator===">"||h.operator===">="?i=lre(i,h,n):h.operator==="<"||h.operator==="<="?a=cre(a,h,n):r.add(h.semver);if(r.size>1)return null;let o;if(i&&a){if(o=mL(i.semver,a.semver,n),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!d1(h,String(i),n)||a&&!d1(h,String(a),n))return null;for(const p of t)if(!d1(h,String(p),n))return!1;return!0}let s,u,l,c,f=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=lre(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!d1(i.semver,String(h),n))return!1}if(a){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=cre(a,h,n),u===h&&u!==a)return!1}else if(a.operator==="<="&&!d1(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&o!==0)return!1}return!(i&&l&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},lre=(e,t,n)=>{if(!e)return t;const r=mL(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},cre=(e,t,n)=>{if(!e)return t;const r=mL(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var THe=CHe;const vL=Yf.exports;var fre={re:vL.re,src:vL.src,tokens:vL.t,SEMVER_SPEC_VERSION:kA.SEMVER_SPEC_VERSION,SemVer:ka,compareIdentifiers:nL.compareIdentifiers,rcompareIdentifiers:nL.rcompareIdentifiers,parse:cv,valid:cVe,clean:hVe,inc:mVe,diff:_Ve,major:AVe,minor:TVe,patch:NVe,prerelease:FVe,compare:tu,rcompare:$Ve,compareLoose:zVe,compareBuild:iL,sort:VVe,rsort:GVe,gt:DA,lt:aL,eq:rL,neq:qne,gte:oL,lte:sL,cmp:Hne,coerce:pqe,Comparator:$A,Range:ru,satisfies:LA,toComparators:Gqe,maxSatisfying:Zqe,minSatisfying:tHe,minVersion:iHe,validRange:sHe,outside:pL,gtr:vHe,ltr:xHe,intersects:_He,simplifyRange:AHe,subset:THe};function io(e,t,n){return e.fields=t||[],e.fname=n,e}function Ir(e){return e==null?null:e.fname}function Yi(e){return e==null?null:e.fields}function dre(e){return e.length===1?OHe(e[0]):IHe(e)}const OHe=e=>function(t){return t[e]},IHe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Se(e){throw Error(e)}function zA(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||Se("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&Se("Access path missing closing bracket: "+e),r&&Se("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function ao(e,t,n){const r=zA(e);return e=r.length===1?r[0]:e,io((n&&n.get||dre)(r),[e],t||e)}const h1=ao("id"),Oa=io(e=>e,[],"identity"),Zf=io(()=>0,[],"zero"),hv=io(()=>1,[],"one"),fs=io(()=>!0,[],"true"),Jf=io(()=>!1,[],"false");function jA(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const hre=0,yL=1,pre=2,gre=3,mre=4;function vre(e,t){let n=e||hre;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=yL&&jA(t||"error","ERROR",arguments),this},warn(){return n>=pre&&jA(t||"warn","WARN",arguments),this},info(){return n>=gre&&jA(t||"log","INFO",arguments),this},debug(){return n>=mre&&jA(t||"log","DEBUG",arguments),this}}}var ut=Array.isArray;function Nt(e){return e===Object(e)}const yre=e=>e!=="__proto__";function UA(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=NHe(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;WA(t,r,n[r],i)}return t},{})}function WA(e,t,n,r){if(!yre(t))return;let i,a;if(Nt(n)&&!ut(n)){a=Nt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?WA(a,i,n[i]):yre(i)&&(a[i]=n[i])}else e[t]=n}function NHe(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function sn(e){return e[e.length-1]}function Zi(e){return e==null||e===""?null:+e}const bre=e=>t=>e*Math.exp(t),xre=e=>t=>Math.log(e*t),wre=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),_re=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,VA=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function qA(e,t,n,r){const i=n(e[0]),a=n(sn(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Sre(e,t){return qA(e,t,Zi,Oa)}function Ere(e,t){var n=Math.sign(e[0]);return qA(e,t,xre(n),bre(n))}function Are(e,t,n){return qA(e,t,VA(n),VA(1/n))}function Cre(e,t,n){return qA(e,t,wre(n),_re(n))}function HA(e,t,n,r,i){const a=r(e[0]),o=r(sn(e)),s=t!=null?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function bL(e,t,n){return HA(e,t,n,Zi,Oa)}function xL(e,t,n){const r=Math.sign(e[0]);return HA(e,t,n,xre(r),bre(r))}function GA(e,t,n,r){return HA(e,t,n,VA(r),VA(1/r))}function wL(e,t,n,r){return HA(e,t,n,wre(r),_re(r))}function kre(e){return 1+~~(new Date(e).getMonth()/3)}function Tre(e){return 1+~~(new Date(e).getUTCMonth()/3)}function xt(e){return e!=null?ut(e)?e:[e]:[]}function Ore(e,t,n){let r=e[0],i=e[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function $t(e){return typeof e=="function"}const DHe="descending";function _L(e,t,n){n=n||{},t=xt(t)||[];const r=[],i=[],a={},o=n.comparator||RHe;return xt(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===DHe?-1:1),i.push(s=$t(s)?s:ao(s,null,n)),(Yi(s)||[]).forEach(l=>a[l]=1))}),i.length===0?null:io(o(i,r),Object.keys(a))}const KA=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),RHe=(e,t)=>e.length===1?FHe(e[0],t[0]):MHe(e,t,e.length),FHe=(e,t)=>function(n,r){return KA(e(n),e(r))*t},MHe=(e,t,n)=>(t.push(0),function(r,i){let a,o=0,s=-1;for(;o===0&&++s<n;)a=e[s],o=KA(a(r),a(i));return o*t[s]});function Ji(e){return $t(e)?e:()=>e}function SL(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Rt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function nl(e,t){let n=0,r,i,a,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(a=o=i;n<r;++n)i=e[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(a=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Ire(e,t){const n=e.length;let r=-1,i,a,o,s,u;if(t==null){for(;++r<n;)if(a=e[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=e[r],a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}else{for(;++r<n;)if(a=t(e[r],r,e),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=t(e[r],r,e),a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}return[s,u]}const PHe=Object.prototype.hasOwnProperty;function _t(e,t){return PHe.call(e,t)}const XA={};function pv(e){let t={},n;function r(a){return _t(t,a)&&t[a]!==XA}const i={size:0,empty:0,object:t,has:r,get(a){return r(a)?t[a]:void 0},set(a,o){return r(a)||(++i.size,t[a]===XA&&--i.empty),t[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,t[a]=XA),this},clear(){i.size=i.empty=0,i.object=t={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const s in t){const u=t[s];u!==XA&&(!n||!n(u))&&(a[s]=u,++o)}i.size=o,i.empty=0,i.object=t=a}};return e&&Object.keys(e).forEach(a=>{i.set(a,e[a])}),i}function Nre(e,t,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let s=e[0],u=sn(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:a}function $e(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Rt(r,n)}function gv(e,t,n,r){let i=t[0],a=t[t.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=a:e<a)}function EL(e){return typeof e=="boolean"}function Qf(e){return Object.prototype.toString.call(e)==="[object Date]"}function Dre(e){return e&&$t(e[Symbol.iterator])}function ed(e){return typeof e=="number"}function Rre(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Bn(e){return typeof e=="string"}function AL(e,t,n){e&&(e=t?xt(e).map(s=>s.replace(/\\(.)/g,"$1")):xt(e));const r=e&&e.length,i=n&&n.get||dre,a=s=>i(t?[s]:zA(s));let o;if(!r)o=function(){return""};else if(r===1){const s=a(e[0]);o=function(u){return""+s(u)}}else{const s=e.map(a);o=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return io(o,e,"key")}function Fre(e,t){const n=e[0],r=sn(e),i=+t;return i?i===1?r:n+i*(r-n):n}const $He=1e4;function Mre(e){e=+e||$He;let t,n,r;const i=()=>{t={},n={},r=0},a=(o,s)=>(++r>e&&(n=t,t={},r=1),t[o]=s);return i(),{clear:i,has:o=>_t(t,o)||_t(n,o),get:o=>_t(t,o)?t[o]:_t(n,o)?a(o,n[o]):void 0,set:(o,s)=>_t(t,o)?t[o]=s:a(o,s)}}function Pre(e,t,n,r){const i=t.length,a=n.length;if(!a)return t;if(!i)return n;const o=r||new t.constructor(i+a);let s=0,u=0,l=0;for(;s<i&&u<a;++l)o[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)o[l]=t[s];for(;u<a;++u,++l)o[l]=n[u];return o}function p1(e,t){let n="";for(;--t>=0;)n+=e;return n}function $re(e,t,n,r){const i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?p1(i,o)+a:r==="center"?p1(i,~~(o/2))+a+p1(i,Math.ceil(o/2)):a+p1(i,o)}function g1(e){return e&&sn(e)-e[0]||0}function gt(e){return ut(e)?"["+e.map(gt)+"]":Nt(e)||Bn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function CL(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const LHe=e=>ed(e)||Qf(e)?e:Date.parse(e);function kL(e,t){return t=t||LHe,e==null||e===""?null:t(e)}function TL(e){return e==null||e===""?null:e+""}function iu(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Lre(e,t,n,r){const i=r??"\u2026",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-s):n==="center"?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function td(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const a=t(e[i]);a&&n(a,i,e)}}else e.forEach(n)}const BHe=/^([A-Za-z]+:)?\/\//,zHe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,jHe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bre="file://";function UHe(e,t){return n=>({options:n||{},sanitize:VHe,load:WHe,fileAccess:!!t,file:qHe(t),http:GHe(e)})}async function WHe(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function VHe(e,t){t=Rt({},this.options,t);const n=this.fileAccess,r={href:null};let i,a,o;const s=zHe.test(e.replace(jHe,""));(e==null||typeof e!="string"||!s)&&Se("Sanitize failure, invalid URI: "+gt(e));const u=BHe.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&o[o.length-1]!=="/"&&(e="/"+e),e=o+e),a=(i=e.startsWith(Bre))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(Bre.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!a}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function qHe(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,a)=>{i?r(i):n(a)})}):HHe}async function HHe(){Se("No file system access.")}function GHe(e){return e?async function(t,n){const r=Rt({},this.options.http,n),i=n&&n.response,a=await e(t,r);return a.ok?$t(a[i])?a[i]():a.text():Se(a.status+""+a.statusText)}:KHe}async function KHe(){Se("No HTTP fetch method available.")}const XHe=e=>e!=null&&e===e,YHe=e=>e==="true"||e==="false"||e===!0||e===!1,ZHe=e=>!Number.isNaN(Date.parse(e)),zre=e=>!Number.isNaN(+e)&&!(e instanceof Date),JHe=e=>zre(e)&&Number.isInteger(+e),OL={boolean:CL,integer:Zi,number:Zi,date:kL,string:TL,unknown:Oa},YA=[YHe,JHe,zre,ZHe],QHe=["boolean","integer","number","date"];function jre(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=YA.length,i=YA.map((a,o)=>o+1);for(let a=0,o=0,s,u;a<n;++a)for(u=t?e[a][t]:e[a],s=0;s<r;++s)if(i[s]&&XHe(u)&&!YA[s](u)&&(i[s]=0,++o,o===YA.length))return"string";return QHe[i.reduce((a,o)=>a===0?o:a,0)-1]}function Ure(e,t){return t.reduce((n,r)=>(n[r]=jre(e,r),n),{})}var Wre={},IL={},NL=34,m1=10,DL=13;function Vre(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function eGe(e,t){var n=Vre(e);return function(r,i){return t(n(r),i,e)}}function qre(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function oo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function tGe(e){return e<0?"-"+oo(-e,6):e>9999?"+"+oo(e,6):oo(e,4)}function nGe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":tGe(e.getUTCFullYear())+"-"+oo(e.getUTCMonth()+1,2)+"-"+oo(e.getUTCDate(),2)+(i?"T"+oo(t,2)+":"+oo(n,2)+":"+oo(r,2)+"."+oo(i,3)+"Z":r?"T"+oo(t,2)+":"+oo(n,2)+":"+oo(r,2)+"Z":n||t?"T"+oo(t,2)+":"+oo(n,2)+"Z":"")}function rGe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?eGe(m,d):Vre(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===m1&&--p,f.charCodeAt(p-1)===DL&&--p;function x(){if(y)return IL;if(b)return b=!1,Wre;var S,A=g,_;if(f.charCodeAt(A)===NL){for(;g++<p&&f.charCodeAt(g)!==NL||f.charCodeAt(++g)===NL;);return(S=g)>=p?y=!0:(_=f.charCodeAt(g++))===m1?b=!0:_===DL&&(b=!0,f.charCodeAt(g)===m1&&++g),f.slice(A+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===m1)b=!0;else if(_===DL)b=!0,f.charCodeAt(g)===m1&&++g;else if(_!==n)continue;return f.slice(A,S)}return y=!0,f.slice(A,p)}for(;(v=x())!==IL;){for(var w=[];v!==Wre&&v!==IL;)w.push(v),v=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function a(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=qre(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=qre(f)),a(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?nGe(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function Hre(e){const t=function(n,r){const i={delimiter:e};return RL(n,r?Rt(r,i):i)};return t.responseType="text",t}function RL(e,t){return t.header&&(e=t.header.map(gt).join(t.delimiter)+`
`+e),rGe(t.delimiter).parse(e+"")}RL.responseType="text";function iGe(e){return typeof Buffer=="function"&&$t(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function FL(e,t){const n=t&&t.property?ao(t.property):Oa;return Nt(e)&&!iGe(e)?aGe(n(e),t):n(JSON.parse(e))}FL.responseType="json";function aGe(e,t){return!ut(e)&&Dre(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function oGe(e){return e}function sGe(e){if(e==null)return oGe;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+a,f[1]=(n+=s[1])*i+o;l<c;)f[l]=s[l],++l;return f}}function uGe(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function lGe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Gre(e,n)})}:Gre(e,t)}function Gre(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=Kre(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function Kre(e,t){var n=sGe(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&uGe(f,p)}function a(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function cGe(e,t){var n={},r={},i={},a=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),a.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function fGe(e){return Kre(e,dGe.apply(this,arguments))}function dGe(e,t,n){var r,i,a;if(arguments.length>1)r=hGe(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:cGe(e,r)}}function hGe(e,t,n){var r=[],i=[],a;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:a})}function s(f){f.forEach(o)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(a=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}const pGe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Xre(e,t){let n,r,i,a;return e=FL(e,t),t&&t.feature?(n=lGe,i=t.feature):t&&t.mesh?(n=fGe,i=t.mesh,a=pGe[t.filter]):Se("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,a):Se("Invalid TopoJSON object: "+i),r&&r.features||[r]}Xre.responseType="json";const ZA={dsv:RL,csv:Hre(","),tsv:Hre("	"),json:FL,topojson:Xre};function ML(e,t){return arguments.length>1?(ZA[e]=t,this):_t(ZA,e)?ZA[e]:null}function Yre(e){const t=ML(e);return t&&t.responseType||"text"}function mv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function v1(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=gGe(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function gGe(e){return(t,n)=>mv(e(t),n)}function Zre(e){return e===null?NaN:+e}function*mGe(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const Jre=v1(mv),JA=Jre.right,vGe=Jre.left;v1(Zre).center;var y1=JA;function yGe(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function bGe(e,t){const n=yGe(e,t);return n&&Math.sqrt(n)}class Ia{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function xGe(e,t){return Array.from(t,n=>e[n])}var PL=Math.sqrt(50),$L=Math.sqrt(10),LL=Math.sqrt(2);function BL(e,t,n){var r,i=-1,a,o,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(s=Qre(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)/s}return r&&o.reverse(),o}function Qre(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=PL?10:a>=$L?5:a>=LL?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=PL?10:a>=$L?5:a>=LL?2:1)}function nd(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=PL?i*=10:a>=$L?i*=5:a>=LL&&(i*=2),t<e?-i:i}function pp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function zL(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function eie(e,t,n=0,r=e.length-1,i=mv){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));eie(e,t,h,p,i)}const a=e[t];let o=n,s=r;for(b1(e,n,t),i(e[r],a)>0&&b1(e,n,r);o<s;){for(b1(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?b1(e,n,s):(++s,b1(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function b1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function jL(e,t,n){if(e=Float64Array.from(mGe(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return zL(e);if(t>=1)return pp(e);var r,i=(r-1)*t,a=Math.floor(i),o=pp(eie(e,a).subarray(0,a+1)),s=zL(e.subarray(a+1));return o+(s-o)*(i-a)}}function tie(e,t,n=Zre){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function wGe(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function nie(e,t){return jL(e,.5,t)}function*_Ge(e){for(const t of e)yield*t}function rie(e){return Array.from(_Ge(e))}function zo(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function iie(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function SGe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function QA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function vv(e){return e=QA(Math.abs(e)),e?e[1]:NaN}function EGe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function AGe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var CGe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function x1(e){if(!(t=CGe.exec(e)))throw new Error("invalid format: "+e);var t;return new UL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}x1.prototype=UL.prototype;function UL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}UL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kGe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var aie;function TGe(e,t){var n=QA(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(aie=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+QA(e,Math.max(0,t+a-1))[0]}function oie(e,t){var n=QA(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var sie={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:SGe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>oie(e*100,t),r:oie,s:TGe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uie(e){return e}var lie=Array.prototype.map,cie=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function fie(e){var t=e.grouping===void 0||e.thousands===void 0?uie:EGe(lie.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?uie:AGe(lie.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=x1(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):sie[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",A=g==="$"?r:/[%p]/.test(w)?o:"",_=sie[w],E=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(k){var T=S,I=A,N,O,D;if(w==="c")I=_(k)+I,k="";else{k=+k;var L=k<0||1/k<0;if(k=isNaN(k)?u:_(Math.abs(k),b),x&&(k=kGe(k)),L&&+k==0&&p!=="+"&&(L=!1),T=(L?p==="("?p:s:p==="-"||p==="("?"":p)+T,I=(w==="s"?cie[8+aie/3]:"")+I+(L&&p==="("?")":""),E){for(N=-1,O=k.length;++N<O;)if(D=k.charCodeAt(N),48>D||D>57){I=(D===46?i+k.slice(N+1):k.slice(N))+I,k=k.slice(0,N);break}}}y&&!m&&(k=t(k,1/0));var W=T.length+k.length+I.length,G=W<v?new Array(v-W+1).join(d):"";switch(y&&m&&(k=t(G+k,G.length?v-I.length:1/0),G=""),h){case"<":k=T+k+I+G;break;case"=":k=T+G+k+I;break;case"^":k=G.slice(0,W=G.length>>1)+T+k+I+G.slice(W);break;default:k=G+T+k+I;break}return a(k)}return C.toString=function(){return f+""},C}function c(f,d){var h=l((f=x1(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(vv(d)/3)))*3,g=Math.pow(10,-p),m=cie[8+p/3];return function(v){return h(g*v)+m}}return{format:l,formatPrefix:c}}var eC,die,hie;OGe({thousands:",",grouping:[3],currency:["$",""]});function OGe(e){return eC=fie(e),die=eC.format,hie=eC.formatPrefix,eC}function IGe(e){return Math.max(0,-vv(Math.abs(e)))}function NGe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vv(t)/3)))*3-vv(Math.abs(e)))}function DGe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vv(t)-vv(e))+1}var WL=new Date,VL=new Date;function xi(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return xi(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},n&&(i.count=function(a,o){return WL.setTime(+a),VL.setTime(+o),e(WL),e(VL),Math.floor(n(WL,VL))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a==0}:function(o){return i.count(0,o)%a==0}):i}),i}var qL=xi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});qL.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?xi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):qL};var HL=qL;const _c=1e3,ds=_c*60,Sc=ds*60,gp=Sc*24,GL=gp*7,pie=gp*30,KL=gp*365;var RGe=xi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*_c)},function(e,t){return(t-e)/_c},function(e){return e.getUTCSeconds()}),rd=RGe,FGe=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c)},function(e,t){e.setTime(+e+t*ds)},function(e,t){return(t-e)/ds},function(e){return e.getMinutes()}),XL=FGe,MGe=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*_c-e.getMinutes()*ds)},function(e,t){e.setTime(+e+t*Sc)},function(e,t){return(t-e)/Sc},function(e){return e.getHours()}),YL=MGe,PGe=xi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ds)/gp,e=>e.getDate()-1),id=PGe;function mp(e){return xi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ds)/GL})}var w1=mp(0),ZL=mp(1);mp(2),mp(3);var _1=mp(4);mp(5),mp(6);var $Ge=xi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),tC=$Ge,gie=xi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});gie.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var ad=gie,LGe=xi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ds)},function(e,t){return(t-e)/ds},function(e){return e.getUTCMinutes()}),JL=LGe,BGe=xi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Sc)},function(e,t){return(t-e)/Sc},function(e){return e.getUTCHours()}),QL=BGe,zGe=xi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/gp},function(e){return e.getUTCDate()-1}),od=zGe;function vp(e){return xi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/GL})}var S1=vp(0),e4=vp(1);vp(2),vp(3);var E1=vp(4);vp(5),vp(6);var jGe=xi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),nC=jGe,mie=xi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});mie.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var sd=mie;function vie(e,t,n,r,i,a){const o=[[rd,1,_c],[rd,5,5*_c],[rd,15,15*_c],[rd,30,30*_c],[a,1,ds],[a,5,5*ds],[a,15,15*ds],[a,30,30*ds],[i,1,Sc],[i,3,3*Sc],[i,6,6*Sc],[i,12,12*Sc],[r,1,gp],[r,2,2*gp],[n,1,GL],[t,1,pie],[t,3,3*pie],[e,1,KL]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=v1(([,,m])=>m).right(o,d);if(h===o.length)return e.every(nd(l/KL,c/KL,f));if(h===0)return HL.every(Math.max(nd(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[s,u]}const[UGe,WGe]=vie(sd,nC,S1,od,QL,JL),[VGe,qGe]=vie(ad,tC,w1,id,YL,XL),$i="year",so="quarter",Qi="month",ui="week",uo="date",ea="day",rl="dayofyear",jo="hours",Uo="minutes",hs="seconds",au="milliseconds",t4=[$i,so,Qi,ui,uo,ea,rl,jo,Uo,hs,au],n4=t4.reduce((e,t,n)=>(e[t]=1+n,e),{});function r4(e){const t=xt(e).slice(),n={};return t.length||Se("Missing time unit."),t.forEach(i=>{_t(n4,i)?n[i]=1:Se("Invalid time unit: ".concat(i,"."))}),(n[ui]||n[ea]?1:0)+(n[so]||n[Qi]||n[uo]?1:0)+(n[rl]?1:0)>1&&Se("Incompatible time units: ".concat(e)),t.sort((i,a)=>n4[i]-n4[a]),t}const HGe={[$i]:"%Y ",[so]:"Q%q ",[Qi]:"%b ",[uo]:"%d ",[ui]:"W%U ",[ea]:"%a ",[rl]:"%j ",[jo]:"%H:00",[Uo]:"00:%M",[hs]:":%S",[au]:".%L",["".concat($i,"-").concat(Qi)]:"%Y-%m ",["".concat($i,"-").concat(Qi,"-").concat(uo)]:"%Y-%m-%d ",["".concat(jo,"-").concat(Uo)]:"%H:%M"};function yie(e,t){const n=Rt({},HGe,t),r=r4(e),i=r.length;let a="",o=0,s,u;for(o=0;o<i;)for(s=r.length;s>o;--s)if(u=r.slice(o,s).join("-"),n[u]!=null){a+=n[u],o=s;break}return a.trim()}const yp=new Date;function i4(e){return yp.setFullYear(e),yp.setMonth(0),yp.setDate(1),yp.setHours(0,0,0,0),yp}function bie(e){return wie(new Date(e))}function xie(e){return a4(new Date(e))}function wie(e){return id.count(i4(e.getFullYear())-1,e)}function a4(e){return w1.count(i4(e.getFullYear())-1,e)}function o4(e){return i4(e).getDay()}function GGe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,a,o);return s.setFullYear(e),s}return new Date(e,t,n,r,i,a,o)}function _ie(e){return Eie(new Date(e))}function Sie(e){return s4(new Date(e))}function Eie(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return od.count(t-1,e)}function s4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return S1.count(t-1,e)}function u4(e){return yp.setTime(Date.UTC(e,0,1)),yp.getUTCDay()}function KGe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,a,o));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Aie(e,t,n,r,i){const a=t||1,o=sn(e),s=(v,y,b)=>(b=b||v,XGe(n[b],r[b],v===o&&a,y)),u=new Date,l=iu(e),c=l[$i]?s($i):Ji(2012),f=l[Qi]?s(Qi):l[so]?s(so):Zf,d=l[ui]&&l[ea]?s(ea,1,ui+ea):l[ui]?s(ui,1):l[ea]?s(ea,1):l[uo]?s(uo,1):l[rl]?s(rl,1):hv,h=l[jo]?s(jo):Zf,p=l[Uo]?s(Uo):Zf,g=l[hs]?s(hs):Zf,m=l[au]?s(au):Zf;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function XGe(e,t,n,r){const i=n<=1?e:r?(a,o)=>r+n*Math.floor((e(a,o)-r)/n):(a,o)=>n*Math.floor(e(a,o)/n);return t?(a,o)=>t(i(a,o),o):i}function yv(e,t,n){return t+e*7-(n+6)%7}const YGe={[$i]:e=>e.getFullYear(),[so]:e=>Math.floor(e.getMonth()/3),[Qi]:e=>e.getMonth(),[uo]:e=>e.getDate(),[jo]:e=>e.getHours(),[Uo]:e=>e.getMinutes(),[hs]:e=>e.getSeconds(),[au]:e=>e.getMilliseconds(),[rl]:e=>wie(e),[ui]:e=>a4(e),[ui+ea]:(e,t)=>yv(a4(e),e.getDay(),o4(t)),[ea]:(e,t)=>yv(1,e.getDay(),o4(t))},ZGe={[so]:e=>3*e,[ui]:(e,t)=>yv(e,0,o4(t))};function Cie(e,t){return Aie(e,t||1,YGe,ZGe,GGe)}const JGe={[$i]:e=>e.getUTCFullYear(),[so]:e=>Math.floor(e.getUTCMonth()/3),[Qi]:e=>e.getUTCMonth(),[uo]:e=>e.getUTCDate(),[jo]:e=>e.getUTCHours(),[Uo]:e=>e.getUTCMinutes(),[hs]:e=>e.getUTCSeconds(),[au]:e=>e.getUTCMilliseconds(),[rl]:e=>Eie(e),[ui]:e=>s4(e),[ea]:(e,t)=>yv(1,e.getUTCDay(),u4(t)),[ui+ea]:(e,t)=>yv(s4(e),e.getUTCDay(),u4(t))},QGe={[so]:e=>3*e,[ui]:(e,t)=>yv(e,0,u4(t))};function kie(e,t){return Aie(e,t||1,JGe,QGe,KGe)}const eKe={[$i]:ad,[so]:tC.every(3),[Qi]:tC,[ui]:w1,[uo]:id,[ea]:id,[rl]:id,[jo]:YL,[Uo]:XL,[hs]:rd,[au]:HL},tKe={[$i]:sd,[so]:nC.every(3),[Qi]:nC,[ui]:S1,[uo]:od,[ea]:od,[rl]:od,[jo]:QL,[Uo]:JL,[hs]:rd,[au]:HL};function bv(e){return eKe[e]}function xv(e){return tKe[e]}function Tie(e,t,n){return e?e.offset(t,n):void 0}function Oie(e,t,n){return Tie(bv(e),t,n)}function Iie(e,t,n){return Tie(xv(e),t,n)}function Nie(e,t,n,r){return e?e.range(t,n,r):void 0}function Die(e,t,n,r){return Nie(bv(e),t,n,r)}function Rie(e,t,n,r){return Nie(xv(e),t,n,r)}const A1=1e3,C1=A1*60,k1=C1*60,rC=k1*24,nKe=rC*7,Fie=rC*30,l4=rC*365,Mie=[$i,Qi,uo,jo,Uo,hs,au],T1=Mie.slice(0,-1),O1=T1.slice(0,-1),I1=O1.slice(0,-1),rKe=I1.slice(0,-1),iKe=[$i,ui],Pie=[$i,Qi],$ie=[$i],N1=[[T1,1,A1],[T1,5,5*A1],[T1,15,15*A1],[T1,30,30*A1],[O1,1,C1],[O1,5,5*C1],[O1,15,15*C1],[O1,30,30*C1],[I1,1,k1],[I1,3,3*k1],[I1,6,6*k1],[I1,12,12*k1],[rKe,1,rC],[iKe,1,nKe],[Pie,1,Fie],[Pie,3,3*Fie],[$ie,1,l4]];function Lie(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(g1(t))/n;let i=v1(s=>s[2]).right(N1,r),a,o;return i===N1.length?(a=$ie,o=nd(t[0]/l4,t[1]/l4,n)):i?(i=N1[r/N1[i-1][2]<N1[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=Mie,o=Math.max(nd(t[0],t[1],n),1)),{units:a,step:o}}function c4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function f4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function D1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Bie(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=R1(i),c=F1(i),f=R1(a),d=F1(a),h=R1(o),p=F1(o),g=R1(s),m=F1(s),v=R1(u),y=F1(u),b={a:L,A:W,b:G,B:K,c:null,d:qie,e:qie,f:kKe,g:$Ke,G:BKe,H:EKe,I:AKe,j:CKe,L:Hie,m:TKe,M:OKe,p:ee,q:ce,Q:Jie,s:Qie,S:IKe,u:NKe,U:DKe,V:RKe,w:FKe,W:MKe,x:null,X:null,y:PKe,Y:LKe,Z:zKe,"%":Zie},x={a:he,A:Oe,b:Te,B:Re,c:null,d:Kie,e:Kie,f:VKe,g:eXe,G:nXe,H:jKe,I:UKe,j:WKe,L:Xie,m:qKe,M:HKe,p:me,q:P,Q:Jie,s:Qie,S:GKe,u:KKe,U:XKe,V:YKe,w:ZKe,W:JKe,x:null,X:null,y:QKe,Y:tXe,Z:rXe,"%":Zie},w={a:C,A:k,b:T,B:I,c:N,d:Wie,e:Wie,f:xKe,g:Uie,G:jie,H:Vie,I:Vie,j:mKe,L:bKe,m:gKe,M:vKe,p:E,q:pKe,Q:_Ke,s:SKe,S:yKe,u:lKe,U:cKe,V:fKe,w:uKe,W:dKe,x:O,X:D,y:Uie,Y:jie,Z:hKe,"%":wKe};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(F,V){return function(ae){var Y=[],M=-1,B=0,R=F.length,X,ge,xe;for(ae instanceof Date||(ae=new Date(+ae));++M<R;)F.charCodeAt(M)===37&&(Y.push(F.slice(B,M)),(ge=zie[X=F.charAt(++M)])!=null?X=F.charAt(++M):ge=X==="e"?" ":"0",(xe=V[X])&&(X=xe(ae,ge)),Y.push(X),B=M+1);return Y.push(F.slice(B,M)),Y.join("")}}function A(F,V){return function(ae){var Y=D1(1900,void 0,1),M=_(Y,F,ae+="",0),B,R;if(M!=ae.length)return null;if("Q"in Y)return new Date(Y.Q);if("s"in Y)return new Date(Y.s*1e3+("L"in Y?Y.L:0));if(V&&!("Z"in Y)&&(Y.Z=0),"p"in Y&&(Y.H=Y.H%12+Y.p*12),Y.m===void 0&&(Y.m="q"in Y?Y.q:0),"V"in Y){if(Y.V<1||Y.V>53)return null;"w"in Y||(Y.w=1),"Z"in Y?(B=f4(D1(Y.y,0,1)),R=B.getUTCDay(),B=R>4||R===0?e4.ceil(B):e4(B),B=od.offset(B,(Y.V-1)*7),Y.y=B.getUTCFullYear(),Y.m=B.getUTCMonth(),Y.d=B.getUTCDate()+(Y.w+6)%7):(B=c4(D1(Y.y,0,1)),R=B.getDay(),B=R>4||R===0?ZL.ceil(B):ZL(B),B=id.offset(B,(Y.V-1)*7),Y.y=B.getFullYear(),Y.m=B.getMonth(),Y.d=B.getDate()+(Y.w+6)%7)}else("W"in Y||"U"in Y)&&("w"in Y||(Y.w="u"in Y?Y.u%7:"W"in Y?1:0),R="Z"in Y?f4(D1(Y.y,0,1)).getUTCDay():c4(D1(Y.y,0,1)).getDay(),Y.m=0,Y.d="W"in Y?(Y.w+6)%7+Y.W*7-(R+5)%7:Y.w+Y.U*7-(R+6)%7);return"Z"in Y?(Y.H+=Y.Z/100|0,Y.M+=Y.Z%100,f4(Y)):c4(Y)}}function _(F,V,ae,Y){for(var M=0,B=V.length,R=ae.length,X,ge;M<B;){if(Y>=R)return-1;if(X=V.charCodeAt(M++),X===37){if(X=V.charAt(M++),ge=w[X in zie?V.charAt(M++):X],!ge||(Y=ge(F,ae,Y))<0)return-1}else if(X!=ae.charCodeAt(Y++))return-1}return Y}function E(F,V,ae){var Y=l.exec(V.slice(ae));return Y?(F.p=c.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function C(F,V,ae){var Y=h.exec(V.slice(ae));return Y?(F.w=p.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function k(F,V,ae){var Y=f.exec(V.slice(ae));return Y?(F.w=d.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function T(F,V,ae){var Y=v.exec(V.slice(ae));return Y?(F.m=y.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function I(F,V,ae){var Y=g.exec(V.slice(ae));return Y?(F.m=m.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function N(F,V,ae){return _(F,t,V,ae)}function O(F,V,ae){return _(F,n,V,ae)}function D(F,V,ae){return _(F,r,V,ae)}function L(F){return o[F.getDay()]}function W(F){return a[F.getDay()]}function G(F){return u[F.getMonth()]}function K(F){return s[F.getMonth()]}function ee(F){return i[+(F.getHours()>=12)]}function ce(F){return 1+~~(F.getMonth()/3)}function he(F){return o[F.getUTCDay()]}function Oe(F){return a[F.getUTCDay()]}function Te(F){return u[F.getUTCMonth()]}function Re(F){return s[F.getUTCMonth()]}function me(F){return i[+(F.getUTCHours()>=12)]}function P(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var V=S(F+="",b);return V.toString=function(){return F},V},parse:function(F){var V=A(F+="",!1);return V.toString=function(){return F},V},utcFormat:function(F){var V=S(F+="",x);return V.toString=function(){return F},V},utcParse:function(F){var V=A(F+="",!0);return V.toString=function(){return F},V}}}var zie={"-":"",_:" ","0":"0"},wi=/^\s*\d+/,aKe=/^%/,oKe=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function sKe(e){return e.replace(oKe,"\\$&")}function R1(e){return new RegExp("^(?:"+e.map(sKe).join("|")+")","i")}function F1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function uKe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function lKe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function cKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function fKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function dKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function jie(e,t,n){var r=wi.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Uie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function hKe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function pKe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function gKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Wie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function mKe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Vie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function vKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function yKe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function bKe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function xKe(e,t,n){var r=wi.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function wKe(e,t,n){var r=aKe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function _Ke(e,t,n){var r=wi.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function SKe(e,t,n){var r=wi.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function qie(e,t){return _n(e.getDate(),t,2)}function EKe(e,t){return _n(e.getHours(),t,2)}function AKe(e,t){return _n(e.getHours()%12||12,t,2)}function CKe(e,t){return _n(1+id.count(ad(e),e),t,3)}function Hie(e,t){return _n(e.getMilliseconds(),t,3)}function kKe(e,t){return Hie(e,t)+"000"}function TKe(e,t){return _n(e.getMonth()+1,t,2)}function OKe(e,t){return _n(e.getMinutes(),t,2)}function IKe(e,t){return _n(e.getSeconds(),t,2)}function NKe(e){var t=e.getDay();return t===0?7:t}function DKe(e,t){return _n(w1.count(ad(e)-1,e),t,2)}function Gie(e){var t=e.getDay();return t>=4||t===0?_1(e):_1.ceil(e)}function RKe(e,t){return e=Gie(e),_n(_1.count(ad(e),e)+(ad(e).getDay()===4),t,2)}function FKe(e){return e.getDay()}function MKe(e,t){return _n(ZL.count(ad(e)-1,e),t,2)}function PKe(e,t){return _n(e.getFullYear()%100,t,2)}function $Ke(e,t){return e=Gie(e),_n(e.getFullYear()%100,t,2)}function LKe(e,t){return _n(e.getFullYear()%1e4,t,4)}function BKe(e,t){var n=e.getDay();return e=n>=4||n===0?_1(e):_1.ceil(e),_n(e.getFullYear()%1e4,t,4)}function zKe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function Kie(e,t){return _n(e.getUTCDate(),t,2)}function jKe(e,t){return _n(e.getUTCHours(),t,2)}function UKe(e,t){return _n(e.getUTCHours()%12||12,t,2)}function WKe(e,t){return _n(1+od.count(sd(e),e),t,3)}function Xie(e,t){return _n(e.getUTCMilliseconds(),t,3)}function VKe(e,t){return Xie(e,t)+"000"}function qKe(e,t){return _n(e.getUTCMonth()+1,t,2)}function HKe(e,t){return _n(e.getUTCMinutes(),t,2)}function GKe(e,t){return _n(e.getUTCSeconds(),t,2)}function KKe(e){var t=e.getUTCDay();return t===0?7:t}function XKe(e,t){return _n(S1.count(sd(e)-1,e),t,2)}function Yie(e){var t=e.getUTCDay();return t>=4||t===0?E1(e):E1.ceil(e)}function YKe(e,t){return e=Yie(e),_n(E1.count(sd(e),e)+(sd(e).getUTCDay()===4),t,2)}function ZKe(e){return e.getUTCDay()}function JKe(e,t){return _n(e4.count(sd(e)-1,e),t,2)}function QKe(e,t){return _n(e.getUTCFullYear()%100,t,2)}function eXe(e,t){return e=Yie(e),_n(e.getUTCFullYear()%100,t,2)}function tXe(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function nXe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?E1(e):E1.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function rXe(){return"+0000"}function Zie(){return"%"}function Jie(e){return+e}function Qie(e){return Math.floor(+e/1e3)}var wv,d4,eae,h4,tae;iXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iXe(e){return wv=Bie(e),d4=wv.format,eae=wv.parse,h4=wv.utcFormat,tae=wv.utcParse,wv}function M1(e){const t={};return n=>t[n]||(t[n]=e(n))}function aXe(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let a=oXe(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function oXe(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function nae(e){const t=M1(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=x1(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return aXe(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,a,o){o=x1(o??",f");const s=nd(r,i,a),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=NGe(s,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=DGe(s,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=IGe(s))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let p4;rae();function rae(){return p4=nae({format:die,formatPrefix:hie})}function iae(e){return nae(fie(e))}function iC(e){return arguments.length?p4=iae(e):p4}function aae(e,t,n){n=n||{},Nt(n)||Se("Invalid time multi-format specifier: ".concat(n));const r=t(hs),i=t(Uo),a=t(jo),o=t(uo),s=t(ui),u=t(Qi),l=t(so),c=t($i),f=e(n[au]||".%L"),d=e(n[hs]||":%S"),h=e(n[Uo]||"%I:%M"),p=e(n[jo]||"%I %p"),g=e(n[uo]||n[ea]||"%a %d"),m=e(n[ui]||"%b %d"),v=e(n[Qi]||"%B"),y=e(n[so]||"%B"),b=e(n[$i]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:a(x)<x?h:o(x)<x?p:u(x)<x?s(x)<x?g:m:c(x)<x?l(x)<x?v:y:b)(x)}function oae(e){const t=M1(e.format),n=M1(e.utcFormat);return{timeFormat:r=>Bn(r)?t(r):aae(t,bv,r),utcFormat:r=>Bn(r)?n(r):aae(n,xv,r),timeParse:M1(e.parse),utcParse:M1(e.utcParse)}}let g4;sae();function sae(){return g4=oae({format:d4,parse:eae,utcFormat:h4,utcParse:tae})}function uae(e){return oae(Bie(e))}function P1(e){return arguments.length?g4=uae(e):g4}const m4=(e,t)=>Rt({},e,t);function lae(e,t){const n=e?iae(e):iC(),r=t?uae(t):P1();return m4(n,r)}function v4(e,t){const n=arguments.length;return n&&n!==2&&Se("defaultLocale expects either zero or two arguments."),n?m4(iC(e),P1(t)):m4(iC(),P1())}function sXe(){return rae(),sae(),v4()}function cae(e,t,n,r){t=t||{};const i=ML(t.type||"json");return i||Se("Unknown data format type: "+t.type),e=i(e,t),t.parse&&uXe(e,t.parse,n,r),_t(e,"columns")&&delete e.columns,e}function uXe(e,t,n,r){if(!e.length)return;const i=P1();n=n||i.timeParse,r=r||i.utcParse;let a=e.columns||Object.keys(e[0]),o,s,u,l,c,f;t==="auto"&&(t=Ure(e,a)),a=Object.keys(t);const d=a.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!OL[p])throw Error("Illegal format pattern: "+h+":"+p);return OL[p]});for(u=0,c=e.length,f=a.length;u<c;++u)for(o=e[u],l=0;l<f;++l)s=a[l],o[s]=d[l](o[s])}const aC=UHe(typeof fetch!="undefined"&&fetch,null);function oC(e){const t=e||Oa,n=[],r={};return n.add=i=>{const a=t(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=t(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function sC(e,t){try{await t(e)}catch(n){e.error(n)}}const fae=Symbol("vega_id");let lXe=1;function uC(e){return!!(e&&lt(e))}function lt(e){return e[fae]}function dae(e,t){return e[fae]=t,e}function In(e){const t=e===Object(e)?e:{data:e};return lt(t)?t:dae(t,lXe++)}function y4(e){return lC(e,In({}))}function lC(e,t){for(const n in e)t[n]=e[n];return t}function hae(e,t){return dae(t,lt(e))}function bp(e,t){return e?t?(n,r)=>e(n,r)||lt(t(n))-lt(t(r)):(n,r)=>e(n,r)||lt(n)-lt(r):null}function pae(e){return e&&e.constructor===xp}function xp(){const e=[],t=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:xp,insert(s){const u=xt(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=$t(s)?r:t,l=xt(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Ji(l)};return $t(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return $t(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return a=s,this},reflow(){return o=!0,this},pulse(s,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[lt(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[lt(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[lt(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=lt(g),l[m]?l[m]=1:s.add.push(In(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[lt(g)]<0&&s.rem.push(g);function v(y,b,x){x?y[b]=x(y):s.encode=b,o||(c[lt(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[lt(g)],m>0&&(v(g,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[lt(y)]>0&&v(y,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=t.length||r.length?u.filter(y=>l[lt(y)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(a||a==null&&(t.length||r.length))&&s.clean(!0),s}}}const cC="_:mod:_";function fC(){Object.defineProperty(this,cC,{writable:!0,value:{}})}fC.prototype={set(e,t,n,r){const i=this,a=i[e],o=i[cC];return t!=null&&t>=0?(a[t]!==n||r)&&(a[t]=n,o[t+":"+e]=-1,o[e]=-1):(a!==n||r)&&(i[e]=n,o[e]=ut(n)?1+n.length:-1),i},modified(e,t){const n=this[cC];if(arguments.length){if(ut(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[cC]={},this}};let cXe=0;const fXe="pulse",dXe=new fC,hXe=1,pXe=2;function Yn(e,t,n,r){this.id=++cXe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function gae(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Yn.prototype={targets(){return this._targets||(this._targets=oC(h1))},set(e){return this.value!==e?(this.value=e,1):0},skip:gae(hXe),modified:gae(pXe),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new fC,i=this._argops=this._argops||[],a=[];let o,s,u,l;const c=(f,d,h)=>{h instanceof Yn?(h!==this&&(t&&h.targets().add(this),a.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(s=e[o],o===fXe)xt(s).forEach(f=>{f instanceof Yn?f!==this&&(f.targets().add(this),a.push(f)):Se("Pulse parameters must be operator instances.")}),this.source=s;else if(ut(s))for(r.set(o,-1,Array(u=s.length)),l=0;l<u;++l)c(o,l,s[l]);else c(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(e){const t=this._argval||dXe,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===e,t.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function gXe(e,t,n,r){let i=1,a;return e instanceof Yn?a=e:e&&e.prototype instanceof Yn?a=new e:$t(e)?a=new Yn(null,e):(i=0,a=new Yn(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function mXe(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let vXe=0;function dC(e,t,n){this.id=++vXe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function ud(e,t,n){return new dC(e,t,n)}dC.prototype={_filter:fs,_apply:Oa,targets(){return this._targets||(this._targets=oC(h1))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=ud(e);return this.targets().add(t),t},apply(e){const t=ud(null,e);return this.targets().add(t),t},merge(){const e=ud();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=ud();return this.targets().add(ud(null,null,SL(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(ud(null,null,()=>n=!0)),t.targets().add(ud(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=fs,this._targets=null}};function yXe(e,t,n,r){const i=this,a=ud(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=xt(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,o);return a}function bXe(e,t){const n=this.locale();return cae(e,t,n.timeParse,n.utcParse)}function xXe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function wXe(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:Yre(t&&t.type)});try{i=n.parse(i,t)}catch(a){r=-2,n.warn("Data ingestion failed",e,a)}}catch(a){r=-1,n.warn("Loading failed",e,a)}return{data:i,status:r}}async function _Xe(e,t,n){const r=this,i=r._pending||SXe(r);i.requests+=1;const a=await r.request(t,n);return r.pulse(e,r.changeset().remove(fs).insert(a.data||[])),i.done(),a}function SXe(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const EXe={skip:!0};function AXe(e,t,n,r,i){return(e instanceof Yn?kXe:CXe)(this,e,t,n,r,i),this}function CXe(e,t,n,r,i,a){const o=Rt({},a,EXe);let s,u;$t(n)||(n=Ji(n)),r===void 0?s=l=>e.touch(n(l)):$t(r)?(u=new Yn(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;pae(f)?e.pulse(c,f,a):e.update(c,f,o)}):s=l=>e.update(n(l),r,o),t.apply(s)}function kXe(e,t,n,r,i,a){if(r===void 0)t.targets().add(n);else{const o=a||{},s=new Yn(null,TXe(n,r),i,!1);s.modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function TXe(e,t){return t=$t(t)?t:Ji(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function OXe(e){e.rank=++this._rank}function IXe(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Se("Cycle detected in dataflow graph.")}const hC={},il=1<<0,ld=1<<1,Ec=1<<2,NXe=il|ld,mae=il|Ec,_v=il|ld|Ec,vae=1<<3,$1=1<<4,yae=1<<5,bae=1<<6;function cd(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function b4(e,t){const n=[];return td(e,t,r=>n.push(r)),n}function xae(e,t){const n={};return e.visit(t,r=>{n[lt(r)]=1}),r=>n[lt(r)]?null:r}function pC(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}cd.prototype={StopPropagation:hC,ADD:il,REM:ld,MOD:Ec,ADD_REM:NXe,ADD_MOD:mae,ALL:_v,REFLOW:vae,SOURCE:$1,NO_SOURCE:yae,NO_FIELDS:bae,fork(e){return new cd(this.dataflow).init(this,e)},clone(){const e=this.fork(_v);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(_v|$1)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new cd(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&bae)&&(n.fields=e.fields),t&il?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ld?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ec?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&yae?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||_v;return t&il&&this.add.length||t&ld&&this.rem.length||t&Ec&&this.mod.length},reflow(e){if(e)return this.fork(_v).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ec,xae(this,il))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ut(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ut(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&il&&(n.addF=pC(n.addF,t)),e&ld&&(n.remF=pC(n.remF,t)),e&Ec&&(n.modF=pC(n.modF,t)),e&$1&&(n.srcF=pC(n.srcF,t)),n},materialize(e){e=e||_v;const t=this;return e&il&&t.addF&&(t.add=b4(t.add,t.addF),t.addF=null),e&ld&&t.remF&&(t.rem=b4(t.rem,t.remF),t.remF=null),e&Ec&&t.modF&&(t.mod=b4(t.mod,t.modF),t.modF=null),e&$1&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&$1)return td(n.source,n.srcF,r),n;e&il&&td(n.add,n.addF,r),e&ld&&td(n.rem,n.remF,r),e&Ec&&td(n.mod,n.modF,r);const i=n.source;if(e&vae&&i){const a=n.add.length+n.mod.length;a===i.length||(a?td(i,xae(n,mae),r):td(i,n.srcF,r))}return n}};function x4(e,t,n,r){const i=this,a=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<a;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(o|=i.ADD),u.changed(i.REM)&&(o|=i.REM),u.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}$e(x4,cd,{fork(e){const t=new cd(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ut(e)?e.some(r=>n[r]):n[e]:0},filter(){Se("MultiPulse does not support filtering.")},materialize(){Se("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n}});async function DXe(e,t,n){const r=this,i=[];if(r._pulse)return wae(r);if(r._pending&&await r._pending,t&&await sC(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new cd(r,a,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=oC(h1);let o=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=hC),u!==hC&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await sC(r,c[f].callback)}return n&&await sC(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function RXe(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function FXe(e,t,n){return this._pulse?wae(this):(this.evaluate(e,t,n),this)}function MXe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function wae(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function PXe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function $Xe(e,t){const n=e.source,r=this._clock;return n&&ut(n)?new x4(this,r,n.map(i=>i.pulse),t):this._input[e.id]||LXe(this._pulse,n&&n.pulse)}function LXe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==hC&&(e.source=t.source),e)}const w4={skip:!1,force:!1};function BXe(e,t){const n=t||w4;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function zXe(e,t,n){const r=n||w4;return(e.set(t)||r.force)&&this.touch(e,r),this}function jXe(e,t,n){this.touch(e,n||w4);const r=new cd(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function UXe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),_ae(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,WXe(t,0,e)):r=n,r}}}function _ae(e,t,n,r){let i,a;const o=e[n];for(;n>t;){if(a=n-1>>1,i=e[a],r(o,i)<0){e[n]=i,n=a;continue}break}return e[n]=o}function WXe(e,t,n){const r=t,i=e.length,a=e[t];let o=(t<<1)+1,s;for(;o<i;)s=o+1,s<i&&n(e[o],e[s])>=0&&(o=s),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=a,_ae(e,r,t,n)}function Sv(){this.logger(vre()),this.logLevel(yL),this._clock=0,this._rank=0,this._locale=v4();try{this._loader=aC()}catch(e){}this._touched=oC(h1),this._input={},this._pulse=null,this._heap=UXe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function L1(e){return function(){return this._log[e].apply(this,arguments)}}Sv.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:L1("error"),warn:L1("warn"),info:L1("info"),debug:L1("debug"),logLevel:L1("level"),cleanThreshold:1e4,add:gXe,connect:mXe,rank:OXe,rerank:IXe,pulse:jXe,touch:BXe,update:zXe,changeset:xp,ingest:xXe,parse:bXe,preload:_Xe,request:wXe,events:yXe,on:AXe,evaluate:DXe,run:FXe,runAsync:RXe,runAfter:MXe,_enqueue:PXe,_getPulse:$Xe};function ve(e,t){Yn.call(this,e,null,t)}$e(ve,Yn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Ev={};function Sae(e){const t=Eae(e);return t&&t.Definition||null}function Eae(e){return e=e&&e.toLowerCase(),_t(Ev,e)?Ev[e]:null}function*Aae(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function _4(e,t,n){const r=Float64Array.from(Aae(e,n));return r.sort(mv),t.map(i=>tie(r,i))}function S4(e,t){return _4(e,[.25,.5,.75],t)}function E4(e,t){const n=e.length,r=bGe(e,t),i=S4(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function Cae(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,u,l,c,f,d;const h=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(a/s+g)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}var ps=Math.random;function VXe(e){ps=e}function kae(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Aae(e,r)),a=i.length,o=t;let s,u,l,c;for(l=0,c=Array(o);l<o;++l){for(s=0,u=0;u<a;++u)s+=i[~~(ps()*a)];c[l]=s/a}return c.sort(mv),[jL(c,n/2),jL(c,1-n/2)]}function Tae(e,t,n,r){r=r||(d=>d);const i=e.length,a=new Float64Array(i);let o=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;o<s;++o)a[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<s;++o)a[o]=l;return n?qXe(a,t+t/4):a}function qXe(e,t){const n=e.length;let r=0,i=1,a,o;for(;e[r]===e[i];)++i;for(;i<n;){for(a=i+1;e[i]===e[a];)++a;if(e[i]-e[i-1]<t){for(o=i+(r+a-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=a}return e}function HXe(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function GXe(e,t){t==null&&(t=e,e=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*ps())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const s=Math.floor(o);return s<n?0:s>=r?1:(s-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(e).max(t)}const Oae=Math.sqrt(2*Math.PI),KXe=Math.SQRT2;let B1=NaN;function gC(e,t){e=e||0,t=t??1;let n=0,r=0,i,a;if(B1===B1)n=B1,B1=NaN;else{do n=ps()*2-1,r=ps()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,B1=r*a}return e+n*t}function A4(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Oae)}function mC(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,a=o*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,a=a/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,a=o/s/2.506628274631)}return r>0?1-a:a}function vC(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*KXe*XXe(2*e-1)}function XXe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function C4(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>gC(n,r),pdf:a=>A4(a,n,r),cdf:a=>mC(a,n,r),icdf:a=>vC(a,n,r)};return i.mean(e).stdev(t)}function k4(e,t){const n=C4();let r=0;const i={data(a){return arguments.length?(e=a,r=a?a.length:0,i.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=E4(e)),i):t},sample(){return e[~~(ps()*r)]+t*n.sample()},pdf(a){let o=0,s=0;for(;s<r;++s)o+=n.pdf((a-e[s])/t);return o/t/r},cdf(a){let o=0,s=0;for(;s<r;++s)o+=n.cdf((a-e[s])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function T4(e,t){return e=e||0,t=t??1,Math.exp(e+gC()*t)}function O4(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Oae*e)}function I4(e,t,n){return mC(Math.log(e),t,n)}function N4(e,t,n){return Math.exp(vC(e,t,n))}function Iae(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>T4(n,r),pdf:a=>O4(a,n,r),cdf:a=>I4(a,n,r),icdf:a=>N4(a,n,r)};return i.mean(e).stdev(t)}function Nae(e,t){let n=0,r;function i(o){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)s[l]/=u;return s}const a={weights(o){return arguments.length?(r=i(t=o||[]),a):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),a.weights(t)):e},sample(){const o=ps();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){s=e[l];break}return s.sample()},pdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(o);return s},cdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(o);return s},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function D4(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ps()}function R4(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function F4(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function M4(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Dae(e,t){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a??1,i):r},sample:()=>D4(n,r),pdf:a=>R4(a,n,r),cdf:a=>F4(a,n,r),icdf:a=>M4(a,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function z1(e,t,n,r){const i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function yC(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,a=new Float64Array(i),o=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)a[s]=c=+t(d),o[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)a[s]-=u,o[s]-=l;return[a,o,u,l]}function j1(e,t,n,r){let i=-1,a,o;for(const s of e)a=t(s),o=n(s),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function Av(e,t,n,r,i){let a=0,o=0;return j1(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;a+=l*l,o+=c*c}),1-a/o}function P4(e,t,n){let r=0,i=0,a=0,o=0,s=0;j1(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=z1(r,i,a,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Av(e,t,n,i,l)}}function Rae(e,t,n){let r=0,i=0,a=0,o=0,s=0;j1(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=z1(r,i,a,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Av(e,t,n,i,l)}}function Fae(e,t,n){const[r,i,a,o]=yC(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,p;j1(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,s+=(b*h-s)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=z1(u/o,s/o,l/o,c/o),v=y=>Math.exp(g+m*(y-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:Av(e,t,n,o,v)}}function Mae(e,t,n){let r=0,i=0,a=0,o=0,s=0,u=0;j1(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,a+=(h*p-a)/u,o+=(h*h-o)/u,s+=(d-s)/u});const l=z1(r,i,a,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Av(e,t,n,s,c)}}function $4(e,t,n){const[r,i,a,o]=yC(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<s;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,x=(f*v-d*l)/y,w=-b*u,S=A=>(A=A-a,b*A*A+x*A+w+o);return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:S,rSquared:Av(e,t,n,o,S)}}function Pae(e,t,n,r){if(r===1)return P4(e,t,n);if(r===2)return $4(e,t,n);const[i,a,o,s]=yC(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*a[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=ZXe(c),y=b=>{b-=o;let x=s+v[0]+v[1]*b+v[2]*b*b;for(d=3;d<f;++d)x+=v[d]*Math.pow(b,d);return x};return{coef:YXe(f,v,-o,s),predict:y,rSquared:Av(e,t,n,s,y)}}function YXe(e,t,n,r){const i=Array(e);let a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function ZXe(e){const t=e.length-1,n=[];let r,i,a,o,s;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(a=r;a<t+1;++a)s=e[a][r],e[a][r]=e[a][o],e[a][o]=s;for(i=r+1;i<t;++i)for(a=t;a>=r;a--)e[a][i]-=e[a][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*n[a];n[i]=(e[t][i]-s)/e[i][i]}return n}const $ae=2,Lae=1e-12;function Bae(e,t,n,r){const[i,a,o,s]=yC(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=$ae;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,S=0,A=0,_=0,E=0;const C=1/Math.abs(i[x]-v||1);for(let I=y;I<=b;++I){const N=i[I],O=a[I],D=JXe(Math.abs(v-N)*C)*d[I],L=N*D;w+=D,S+=L,A+=O*D,_+=O*L,E+=N*L}const[k,T]=z1(S/w,A/w,_/w,E/w);c[m]=k+T*v,f[m]=Math.abs(a[m]-c[m]),QXe(i,m+1,p)}if(h===$ae)break;const g=nie(f);if(Math.abs(g)<Lae)break;for(let m=0,v,y;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?Lae:(y=1-v*v)*y}return eYe(i,c,o,s)}function JXe(e){return(e=1-e*e*e)*e*e}function QXe(e,t,n){const r=e[t];let i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}function eYe(e,t,n,r){const i=e.length,a=[];let o=0,s=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[o]],a.push(u));return u[1]+=r,a}const tYe=.1*Math.PI/180;function bC(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=h=>[h,e(h)],a=t[0],o=t[1],s=o-a,u=s/r,l=[i(a)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(a+h/n*s));return l.push(i(o)),l}else{c.push(i(o));for(let h=n;--h>0;)c.push(i(a+h/n*s))}let f=l[0],d=c[c.length-1];for(;d;){const h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&nYe(f,h,d)>tYe?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function nYe(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function rYe(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function L4(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:rYe(e)}function zae(e,t,n){return n||e+(t?"_"+t:"")}const B4=()=>{},iYe={init:B4,add:B4,rem:B4,idx:0},U1={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},W1=Object.keys(U1);function aYe(e,t){return n=>Rt({name:e,out:n||e},iYe,t)}W1.forEach(e=>{U1[e]=aYe(e,U1[e])});function jae(e,t){return U1[e](t)}function Uae(e,t){return e.idx-t.idx}function oYe(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=U1[i]())})};return e.forEach(n),Object.values(t).sort(Uae)}function sYe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function uYe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function lYe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function cYe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function Wae(e,t){const n=t||Oa,r=oYe(e),i=e.slice().sort(Uae);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=sYe,a.prototype.add=uYe,a.prototype.rem=lYe,a.prototype.set=cYe,a.prototype.get=n,a.fields=e.map(o=>o.out),a}function z4(e){this._key=e?ao(e):lt,this.reset()}const Li=z4.prototype;Li.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Li.add=function(e){this._add.push(e)},Li.rem=function(e){this._rem.push(e)},Li.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};let s,u,l;for(s=0;s<i;++s)o[n(t[s])]=1;for(s=0,u=0;s<r;++s)o[n(l=e[s])]?o[n(l)]=0:a[u++]=l;return this._rem=[],this._add=a},Li.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,a;for(;--r>=0;)a=e(t[r])+"",_t(n,a)||(n[a]=1,++i);return i},Li.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Ire(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Li.argmin=function(e){return this.extent(e)[0]||{}},Li.argmax=function(e){return this.extent(e)[1]||{}},Li.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Li.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Li.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=S4(this.values(),e),this._get=e),this._q},Li.q1=function(e){return this.quartile(e)[0]},Li.q2=function(e){return this.quartile(e)[1]},Li.q3=function(e){return this.quartile(e)[2]},Li.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=kae(this.values(),1e3,.05,e),this._get=e),this._ci},Li.ci0=function(e){return this.ci(e)[0]},Li.ci1=function(e){return this.ci(e)[1]};function fd(e){ve.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}fd.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:W1},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},$e(fd,ve,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function a(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}a(e._prev),a(t);function o(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=xt(Yi(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=xt(e.groupby),this._dnames=this._dims.map(m=>{const v=Ir(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:L4(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],o=e.ops||["count"],s=e.as||[],u=a.length,l={};let c,f,d,h,p,g;for(u!==o.length&&Se("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=a[g],f=o[g],c==null&&f!=="count"&&Se("Null aggregate field specified."),h=Ir(c),p=zae(f,h,s[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(jae(f,p))}return this._measures=this._measures.map(m=>Wae(m,m.field)),{}},cellkey:L4(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new z4),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](e);return t?hae(t.tuple,a):In(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const fYe=1e-14;function j4(e){ve.call(this,null,e)}j4.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},$e(j4,ve,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Yi(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+a*(1+(f-i)/a)}:c=>c[s]=r(c)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Cae(e),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,s;(o=e.anchor)!=null&&(s=o-(i+r*Math.floor((o-i)/r)),i+=s,a+=s);const u=function(l){let c=Zi(t(l));return c==null?null:c<i?-1/0:c>a?1/0:(c=Math.max(i,Math.min(c,a-r)),i+r*Math.floor(fYe+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=io(u,Yi(t),e.name||"bin_"+Ir(t))}});function Vae(e,t,n){const r=e;let i=t||[],a=n||[],o={},s=0;return{add:u=>a.push(u),remove:u=>o[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!o[r(c)]),o={},s=0),l&&u&&i.sort(u),a.length&&(i=u?Pre(u,i,a.sort(u)):i.concat(a),a=[]),i)}}function U4(e){ve.call(this,[],e)}U4.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},$e(U4,ve,{transform(e,t){const n=t.fork(t.ALL),r=Vae(lt,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(bp(i),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function qae(e){Yn.call(this,null,dYe,e)}$e(qae,Yn);function dYe(e){return this.value&&!e.modified()?this.value:_L(e.fields,e.orders)}function W4(e){ve.call(this,null,e)}W4.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function hYe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}$e(W4,ve,{transform(e,t){const n=f=>d=>{for(var h=hYe(s(d),e.case,a)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=In({}),u[i]=s,u[a]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==l&&(u[a]=l,o.mod.push(u));return o.modifies(t)}});function V4(e){ve.call(this,null,e)}V4.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},$e(V4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=pYe(s,i,a,e.filter||fs)):n.mod=s,n.source=this.value,n.modifies(r)}});function pYe(e,t,n,r){for(var i=[],a={},o=e.length,s=0,u,l;s<o;++s)for(a[t]=l=e[s],u=0;u<o;++u)a[n]=e[u],r(a)&&(i.push(In(a)),a={},a[t]=l);return i}const Hae={kde:k4,mixture:Nae,normal:C4,lognormal:Iae,uniform:Dae},gYe="distributions",Gae="function",mYe="field";function Kae(e,t){const n=e[Gae];_t(Hae,n)||Se("Unknown distribution function: "+n);const r=Hae[n]();for(const i in e)i===mYe?r.data((e.from||t()).map(e[i])):i===gYe?r[i](e[i].map(a=>Kae(a,t))):typeof r[i]===Gae&&r[i](e[i]);return r}function q4(e){ve.call(this,null,e)}const Xae=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],vYe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Xae},{name:"weights",type:"number",array:!0}]};q4.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Xae.concat(vYe)},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(q4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=Kae(e.distribution,yYe(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Se("Invalid density method: "+o),!e.extent&&!r.data&&Se("Missing density extent parameter."),o=r[o];const s=e.as||["value","density"],u=e.extent||nl(r.data()),l=bC(o,u,i,a).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],In(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function yYe(e){return()=>e.materialize(e.SOURCE).source}function Yae(e,t){return e?e.map((n,r)=>t[r]||Ir(n)):null}function H4(e,t,n){const r=[],i=f=>f(u);let a,o,s,u,l,c;if(t==null)r.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)u=e[o],l=t.map(i),c=a[l],c||(a[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const Zae="bin";function G4(e){ve.call(this,null,e)}G4.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Zae}]};const bYe=(e,t)=>g1(nl(e,t))/30;$e(G4,ve,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=H4(t.source,e.groupby,Oa),i=e.smooth||!1,a=e.field,o=e.step||bYe(n,a),s=bp((p,g)=>a(p)-a(g)),u=e.as||Zae,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(s);h=-1;for(const g of Tae(p,o,i,a))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function Jae(e){Yn.call(this,null,xYe,e),this.modified(!0)}$e(Jae,Yn);function xYe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:io(n=>t(n,e),Yi(t),Ir(t))}function K4(e){ve.call(this,[void 0,void 0],e)}K4.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},$e(K4,ve,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=Zi(r(s));u!=null&&(u<a&&(a=u),u>o&&(o=u))}),!Number.isFinite(a)||!Number.isFinite(o)){let s=Ir(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function X4(e,t){Yn.call(this,e),this.parent=t,this.count=0}$e(X4,Yn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function xC(e){ve.call(this,{},e),this._keys=pv();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}$e(xC,ve,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let a=_t(i,e)&&i[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new X4(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),i[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=lt(u),c=a.get(l);c!==void 0&&(a.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);a.set(lt(u),l),s(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=lt(u),c=a.get(l),f=r(u);c===f?s(f).mod(u):(a.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(a.get(lt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=lt(u),c=a.get(l),f=r(u);c!==f&&(a.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function Qae(e){Yn.call(this,null,wYe,e)}$e(Qae,Yn);function wYe(e){return this.value&&!e.modified()?this.value:ut(e.name)?xt(e.name).map(t=>ao(t)):ao(e.name,e.as)}function Y4(e){ve.call(this,pv(),e)}Y4.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},$e(Y4,ve,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=lt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?a.push(f):r.set(lt(f),1)});function c(f){const d=lt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),a.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function Z4(e){ve.call(this,[],e)}Z4.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},$e(Z4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Yae(r,e.as||[]),a=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(p=>p(s)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=y4(s),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;a&&(d[a]=c),n.add.push(d)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function J4(e){ve.call(this,[],e)}J4.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},$e(J4,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Ir),a=e.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=y4(l),f[o]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(a)}});function Q4(e){ve.call(this,null,e)}Q4.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},$e(Q4,ve,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,o=>o[r]=n(o,e))}});function eoe(e){ve.call(this,[],e)}$e(eoe,ve,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,a=e.size-i.length,o,s,u;if(a>0){for(o=[];--a>=0;)o.push(u=In(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-a);return n.source=this.value=i,n}});const wC={value:"value",median:nie,mean:wGe,min:zL,max:pp},_Ye=[];function eB(e){ve.call(this,[],e)}eB.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function SYe(e){var t=e.method||wC.value,n;if(wC[t]==null)Se("Unrecognized imputation method: "+t);else return t===wC.value?(n=e.value!==void 0?e.value:0,()=>n):wC[t]}function EYe(e){const t=e.field;return n=>n?t(n):NaN}$e(eB,ve,{transform(e,t){var n=t.fork(t.ALL),r=SYe(e),i=EYe(e),a=Ir(e.field),o=Ir(e.key),s=(e.groupby||[]).map(Ir),u=AYe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,v,y,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,y=0;y<f;++y)if(d[y]==null){for(g=u.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[s[v]]=p[v];w[o]=g,w[a]=Number.isNaN(h)?h=r(d,i):h,l.push(In(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function AYe(e,t,n,r){var i=v=>v(m),a=[],o=r?r.slice():[],s={},u={},l,c,f,d,h,p,g,m;for(o.forEach((v,y)=>s[v]=y+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=s[p]||(s[p]=o.push(p)),c=(l=t?t.map(i):_Ye)+"",(f=u[c])||(f=u[c]=[],a.push(f),f.values=l),f[h-1]=m;return a.domain=o,a}function tB(e){fd.call(this,e)}tB.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:W1},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},$e(tB,fd,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Rt(a,i[n.cellkey(a)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function nB(e){ve.call(this,null,e)}nB.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(nB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=H4(r,e.groupby,e.field),a=(e.groupby||[]).map(Ir),o=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&Se("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=nl(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=k4(h,o)[s],g=e.counts?h.length:1,m=c||nl(h);bC(p,m,f,d).forEach(v=>{const y={};for(let b=0;b<a.length;++b)y[a[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(In(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function toe(e){Yn.call(this,null,CYe,e)}$e(toe,Yn);function CYe(e){return this.value&&!e.modified()?this.value:AL(e.fields,e.flat)}function noe(e){ve.call(this,[],e),this._pending=null}$e(noe,ve,{transform(e,t){const n=t.dataflow;return this._pending?rB(this,t,this._pending):kYe(e)?t.StopPropagation:e.values?rB(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=xt(i.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(r=>rB(this,t,xt(r.data)))}});function kYe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function rB(e,t,n){n.forEach(In);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function iB(e){ve.call(this,{},e)}iB.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},$e(iB,ve,{transform(e,t){const n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),s=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&Se('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&Se('The "as" parameter has too few output field names.'),c=c||i.map(Ir),f=function(p){for(var g=0,m=0,v,y;g<s;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<d;++v,++m)p[c[m]]=a;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||Se("Missing output field names."),f=function(p){for(var g=0,m;g<s;++g)m=r.get(n[g](p)),p[c[g]]=m??a}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function roe(e){Yn.call(this,null,TYe,e)}$e(roe,Yn);function TYe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=t[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function ioe(e){Yn.call(this,null,OYe,e)}$e(ioe,Yn);function OYe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function aoe(e){ve.call(this,null,e)}$e(aoe,ve,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function aB(e){fd.call(this,e)}aB.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:W1,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},$e(aB,fd,{_transform:fd.prototype.transform,transform(e,t){return this._transform(IYe(e,t),t)}});function IYe(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Yi(n).concat(Yi(r)),o=DYe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(s=>NYe(s,n,r,a)),as:o.map(s=>s+""),modified:e.modified.bind(e)}}function NYe(e,t,n,r){return io(i=>t(i)===e?n(i):NaN,r,e+"")}function DYe(e,t,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=e(a);r[o]||(r[o]=1,i.push(o))}),i.sort(KA),t?i.slice(0,t):i}function ooe(e){xC.call(this,e)}$e(ooe,xC,{transform(e,t){const n=e.subflow,r=e.field,i=a=>this.subflow(lt(a),n,t,a);return(e.modified("field")||r&&t.modified(Yi(r)))&&Se("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,a=>{const o=i(a);r(a).forEach(s=>o.mod(s))}),t.visit(t.ADD,a=>{const o=i(a);r(a).forEach(s=>o.add(In(s)))}),t.visit(t.REM,a=>{const o=i(a);r(a).forEach(s=>o.rem(s))})):(t.visit(t.MOD,a=>i(a).mod(a)),t.visit(t.ADD,a=>i(a).add(a)),t.visit(t.REM,a=>i(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function oB(e){ve.call(this,null,e)}oB.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},$e(oB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Yae(e.fields,e.as||[]),a=r?(s,u)=>RYe(s,u,r,i):lC;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,s=>{const u=lt(s);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,s=>{const u=a(s,In({}));o[lt(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(a(s,o[lt(s)]))}),n}});function RYe(e,t,n,r){for(let i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}function soe(e){ve.call(this,null,e)}$e(soe,ve,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function sB(e){ve.call(this,null,e)}sB.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const FYe=1e-14;$e(sB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,a=H4(i,e.groupby,e.field),o=(e.groupby||[]).map(Ir),s=[],u=e.step||.01,l=e.probs||zo(u/2,1-FYe,u),c=l.length;return a.forEach(f=>{const d=_4(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],s.push(In(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function uoe(e){ve.call(this,null,e)}$e(uoe,ve,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const a=lt(i);n.rem.push(r[a]),r[a]=null}),t.visit(t.ADD,i=>{const a=y4(i);r[lt(i)]=a,n.add.push(a)}),t.visit(t.MOD,i=>{const a=r[lt(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function uB(e){ve.call(this,[],e),this.count=0}uB.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},$e(uB,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((c,f)=>(c[lt(f)]=1,c),{});let o=this.value,s=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((s+1)*ps()),d<o.length&&d>=u&&(f=o[d],a[lt(f)]&&n.rem.push(f),o[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=lt(c);a[f]&&(a[f]=-1,n.rem.push(c)),--s}),o=o.filter(c=>a[lt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=s=o.length,t.visit(t.SOURCE,c=>{a[lt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)a[lt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{a[lt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!a[lt(c)])),this.count=s,this.value=n.source=o,n}});function lB(e){ve.call(this,null,e)}lB.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},$e(lB,ve,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=zo(e.start,e.stop,e.step||1).map(i=>{const a={};return a[r]=i,In(a)}),n.add=t.add.concat(this.value),n}});function loe(e){ve.call(this,null,e),this.modified(!0)}$e(loe,ve,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function cB(e){ve.call(this,null,e)}const coe=["unit0","unit1"];cB.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:t4,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:coe}]},$e(cB,ve,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",a=this._floor(e,t),o=(i?xv:bv)(a.unit).offset,s=e.as||coe,u=s[0],l=s[1],c=a.step;let f=a.start||1/0,d=a.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Yi(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=a(g),r&&(p[l]=v=o(m,c)),m<f&&(f=m),v>d&&(d=v))}),a.start=f,a.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:Lie({extent:e.extent||nl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=r4(r),o=this.value||{},s=(n?kie:Cie)(a,i);return s.unit=sn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}});function foe(e){ve.call(this,pv(),e)}$e(foe,ve,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,a=s=>i.set(r(s),s);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function doe(e){ve.call(this,null,e)}$e(doe,ve,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(bp(e.sort)):t.source).map(e.field))}});function MYe(e,t,n,r){const i=V1[e](t,n);return{init:i.init||Zf,update:function(a,o){o[r]=i.next(a)}}}const V1={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=V1.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Se("ntile num must be greater than zero.");const n=V1.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Se("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=PYe(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function PYe(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const $Ye=Object.keys(V1);function hoe(e){const t=xt(e.ops),n=xt(e.fields),r=xt(e.params),i=xt(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){xt(Yi(h)).forEach(p=>s[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Ir(g),v=zae(h,m,i[p]);if(d(g),a.push(v),_t(V1,h))o.push(MYe(h,n[p],r[p],v));else{if(g==null&&h!=="count"&&Se("Null aggregate field specified."),h==="count"){l.push(v);return}f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(jae(h,v))}}),(l.length||c.length)&&(this.cell=LYe(c,l,f)),this.inputs=Object.keys(s)}const poe=hoe.prototype;poe.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},poe.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,a=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function LYe(e,t,n){e=e.map(u=>Wae(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var s=r.data=new z4;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)a[l].add(a[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)a[l].rem(a[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=a.length;l<c;++l)a[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)a[u].init()},r}function fB(e){ve.call(this,{},e),this._mlen=0,this._mods=[]}fB.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:$Ye.concat(W1)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},$e(fB,ve,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=bp(e.sort),i=L4(e.groupby),a=s=>this.group(i(s));let o=this.state;(!o||n)&&(o=this.state=new hoe(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,s=>a(s).add(s))):(t.visit(t.REM,s=>a(s).remove(s)),t.visit(t.ADD,s=>a(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)BYe(this._mods[s],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Vae(lt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function BYe(e,t,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=e.data(n),u=s.length,l=a?v1(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ji(-1)};t.init();for(let f=0;f<u;++f)zYe(c,o,f,u),a&&jYe(c,l),t.update(c,s[f])}function zYe(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function jYe(e,t){const n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}var UYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:fd,bin:j4,collect:U4,compare:qae,countpattern:W4,cross:V4,density:q4,dotbin:G4,expression:Jae,extent:K4,facet:xC,field:Qae,filter:Y4,flatten:Z4,fold:J4,formula:Q4,generate:eoe,impute:eB,joinaggregate:tB,kde:nB,key:toe,load:noe,lookup:iB,multiextent:roe,multivalues:ioe,params:aoe,pivot:aB,prefacet:ooe,project:oB,proxy:soe,quantile:sB,relay:uoe,sample:uB,sequence:lB,sieve:loe,subflow:X4,timeunit:cB,tupleindex:foe,values:doe,window:fB});const dB=Math.PI,hB=2*dB,wp=1e-6,WYe=hB-wp;function pB(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function _p(){return new pB}pB.prototype=_p.prototype={constructor:pB,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>wp)if(!(Math.abs(c*s-u*l)>wp)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-a,h=r-o,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((dB-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>wp&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>wp||Math.abs(this._y1-l)>wp)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%hB+hB),f>WYe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>wp&&(this._+="A"+n+","+n+",0,"+ +(f>=dB)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Rn(e){return function(){return e}}var goe=Math.abs,ta=Math.atan2,Sp=Math.cos,VYe=Math.max,gB=Math.min,al=Math.sin,Cv=Math.sqrt,na=1e-12,kv=Math.PI,_C=kv/2,moe=2*kv;function qYe(e){return e>1?0:e<-1?kv:Math.acos(e)}function voe(e){return e>=1?_C:e<=-1?-_C:Math.asin(e)}function HYe(e){return e.innerRadius}function GYe(e){return e.outerRadius}function KYe(e){return e.startAngle}function XYe(e){return e.endAngle}function YYe(e){return e&&e.padAngle}function ZYe(e,t,n,r,i,a,o,s){var u=n-e,l=r-t,c=o-i,f=s-a,d=f*u-c*l;if(!(d*d<na))return d=(c*(t-a)-f*(e-i))/d,[e+d*u,t+d*l]}function SC(e,t,n,r,i,a,o){var s=e-n,u=t-r,l=(o?a:-a)/Cv(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,x=y*y+b*b,w=i-a,S=d*g-p*h,A=(b<0?-1:1)*Cv(VYe(0,w*w*x-S*S)),_=(S*b-y*A)/x,E=(-S*y-b*A)/x,C=(S*b+y*A)/x,k=(-S*y+b*A)/x,T=_-m,I=E-v,N=C-m,O=k-v;return T*T+I*I>N*N+O*O&&(_=C,E=k),{cx:_,cy:E,x01:-c,y01:-f,x11:_*(i/w-1),y11:E*(i/w-1)}}function JYe(){var e=HYe,t=GYe,n=Rn(0),r=null,i=KYe,a=XYe,o=YYe,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-_C,p=a.apply(this,arguments)-_C,g=goe(p-h),m=p>h;if(s||(s=l=_p()),d<f&&(c=d,d=f,f=c),!(d>na))s.moveTo(0,0);else if(g>moe-na)s.moveTo(d*Sp(h),d*al(h)),s.arc(0,0,d,h,p,!m),f>na&&(s.moveTo(f*Sp(p),f*al(p)),s.arc(0,0,f,p,h,m));else{var v=h,y=p,b=h,x=p,w=g,S=g,A=o.apply(this,arguments)/2,_=A>na&&(r?+r.apply(this,arguments):Cv(f*f+d*d)),E=gB(goe(d-f)/2,+n.apply(this,arguments)),C=E,k=E,T,I;if(_>na){var N=voe(_/f*al(A)),O=voe(_/d*al(A));(w-=N*2)>na?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+p)/2),(S-=O*2)>na?(O*=m?1:-1,v+=O,y-=O):(S=0,v=y=(h+p)/2)}var D=d*Sp(v),L=d*al(v),W=f*Sp(x),G=f*al(x);if(E>na){var K=d*Sp(y),ee=d*al(y),ce=f*Sp(b),he=f*al(b),Oe;if(g<kv&&(Oe=ZYe(D,L,ce,he,K,ee,W,G))){var Te=D-Oe[0],Re=L-Oe[1],me=K-Oe[0],P=ee-Oe[1],F=1/al(qYe((Te*me+Re*P)/(Cv(Te*Te+Re*Re)*Cv(me*me+P*P)))/2),V=Cv(Oe[0]*Oe[0]+Oe[1]*Oe[1]);C=gB(E,(f-V)/(F-1)),k=gB(E,(d-V)/(F+1))}}S>na?k>na?(T=SC(ce,he,D,L,d,k,m),I=SC(K,ee,W,G,d,k,m),s.moveTo(T.cx+T.x01,T.cy+T.y01),k<E?s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,d,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),!m),s.arc(I.cx,I.cy,k,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):(s.moveTo(D,L),s.arc(0,0,d,v,y,!m)):s.moveTo(D,L),!(f>na)||!(w>na)?s.lineTo(W,G):C>na?(T=SC(W,G,K,ee,f,-C,m),I=SC(D,L,ce,he,f,-C,m),s.lineTo(T.cx+T.x01,T.cy+T.y01),C<E?s.arc(T.cx,T.cy,C,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,C,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,f,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),m),s.arc(I.cx,I.cy,C,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-kv/2;return[Sp(c)*l,al(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Rn(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Rn(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Rn(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Rn(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Rn(+l),u):i},u.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Rn(+l),u):a},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Rn(+l),u):o},u.context=function(l){return arguments.length?(s=l??null,u):s},u}function yoe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function boe(e){this._context=e}boe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function mB(e){return new boe(e)}function xoe(e){return e[0]}function woe(e){return e[1]}function _oe(e,t){var n=Rn(!0),r=null,i=mB,a=null;e=typeof e=="function"?e:e===void 0?xoe:Rn(e),t=typeof t=="function"?t:t===void 0?woe:Rn(t);function o(s){var u,l=(s=yoe(s)).length,c,f=!1,d;for(r==null&&(a=i(d=_p())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,u,s),+t(c,u,s));if(d)return a=null,d+""||null}return o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Rn(+s),o):e},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:Rn(+s),o):t},o.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Rn(!!s),o):n},o.curve=function(s){return arguments.length?(i=s,r!=null&&(a=i(r)),o):i},o.context=function(s){return arguments.length?(s==null?r=a=null:a=i(r=s),o):r},o}function Soe(e,t,n){var r=null,i=Rn(!0),a=null,o=mB,s=null;e=typeof e=="function"?e:e===void 0?xoe:Rn(+e),t=typeof t=="function"?t:Rn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?woe:Rn(+n);function u(c){var f,d,h,p=(c=yoe(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(a==null&&(s=o(v=_p())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(y[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),s.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return s=null,v+""||null}function l(){return _oe().defined(i).curve(o).context(a)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Rn(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Rn(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Rn(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,a!=null&&(s=o(a)),u):o},u.context=function(c){return arguments.length?(c==null?a=s=null:s=o(a=c),u):a},u}var QYe={draw:function(e,t){var n=Math.sqrt(t/kv);e.moveTo(n,0),e.arc(0,0,n,0,moe)}};function eZe(e,t){var n=null;e=typeof e=="function"?e:Rn(e||QYe),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function r(){var i;if(n||(n=i=_p()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Rn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function dd(){}function EC(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function AC(e){this._context=e}AC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:EC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:EC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tZe(e){return new AC(e)}function Eoe(e){this._context=e}Eoe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:EC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nZe(e){return new Eoe(e)}function Aoe(e){this._context=e}Aoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:EC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rZe(e){return new Aoe(e)}function Coe(e,t){this._basis=new AC(e),this._beta=t}Coe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*a),this._beta*t[s]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var iZe=function e(t){function n(r){return t===1?new AC(r):new Coe(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function CC(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function vB(e,t){this._context=e,this._k=(1-t)/6}vB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:CC(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:CC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var aZe=function e(t){function n(r){return new vB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function yB(e,t){this._context=e,this._k=(1-t)/6}yB.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:CC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oZe=function e(t){function n(r){return new yB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function bB(e,t){this._context=e,this._k=(1-t)/6}bB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:CC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sZe=function e(t){function n(r){return new bB(r,t)}return n.tension=function(r){return e(+r)},n}(0);function xB(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>na){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>na){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function koe(e,t){this._context=e,this._alpha=t}koe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:xB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uZe=function e(t){function n(r){return t?new koe(r,t):new vB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Toe(e,t){this._context=e,this._alpha=t}Toe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:xB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var lZe=function e(t){function n(r){return t?new Toe(r,t):new yB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ooe(e,t){this._context=e,this._alpha=t}Ooe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:xB(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cZe=function e(t){function n(r){return t?new Ooe(r,t):new bB(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ioe(e){this._context=e}Ioe.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function fZe(e){return new Ioe(e)}function Noe(e){return e<0?-1:1}function Doe(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Noe(a)+Noe(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Roe(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function wB(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function kC(e){this._context=e}kC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wB(this,this._t0,Roe(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,wB(this,Roe(this,n=Doe(this,e,t)),n);break;default:wB(this,this._t0,n=Doe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Foe(e){this._context=new Moe(e)}(Foe.prototype=Object.create(kC.prototype)).point=function(e,t){kC.prototype.point.call(this,t,e)};function Moe(e){this._context=e}Moe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function dZe(e){return new kC(e)}function hZe(e){return new Foe(e)}function Poe(e){this._context=e}Poe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=$oe(e),i=$oe(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function $oe(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function pZe(e){return new Poe(e)}function TC(e,t){this._context=e,this._t=t}TC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function gZe(e){return new TC(e,.5)}function mZe(e){return new TC(e,0)}function vZe(e){return new TC(e,1)}function Tv(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const yZe=()=>typeof Image!="undefined"?Image:null;function ol(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const _B=Symbol("implicit");function SB(){var e=new Map,t=[],n=[],r=_B;function i(a){var o=a+"",s=e.get(o);if(!s){if(r!==_B)return r;e.set(o,s=t.push(a))}return n[(s-1)%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of a){const s=o+"";e.has(s)||e.set(s,t.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return SB(t,n).unknown(r)},ol.apply(i,arguments),i}function Ov(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function q1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function pd(){}var Ep=.7,Iv=1/Ep,Nv="\\s*([+-]?\\d+)\\s*",H1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bZe=/^#([0-9a-f]{3,8})$/,xZe=new RegExp("^rgb\\("+[Nv,Nv,Nv]+"\\)$"),wZe=new RegExp("^rgb\\("+[sl,sl,sl]+"\\)$"),_Ze=new RegExp("^rgba\\("+[Nv,Nv,Nv,H1]+"\\)$"),SZe=new RegExp("^rgba\\("+[sl,sl,sl,H1]+"\\)$"),EZe=new RegExp("^hsl\\("+[H1,sl,sl]+"\\)$"),AZe=new RegExp("^hsla\\("+[H1,sl,sl,H1]+"\\)$"),Loe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ov(pd,G1,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Boe,formatHex:Boe,formatHsl:CZe,formatRgb:zoe,toString:zoe});function Boe(){return this.rgb().formatHex()}function CZe(){return qoe(this).formatHsl()}function zoe(){return this.rgb().formatRgb()}function G1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=bZe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?joe(t):n===3?new Bi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?OC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?OC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xZe.exec(e))?new Bi(t[1],t[2],t[3],1):(t=wZe.exec(e))?new Bi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_Ze.exec(e))?OC(t[1],t[2],t[3],t[4]):(t=SZe.exec(e))?OC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=EZe.exec(e))?Voe(t[1],t[2]/100,t[3]/100,1):(t=AZe.exec(e))?Voe(t[1],t[2]/100,t[3]/100,t[4]):Loe.hasOwnProperty(e)?joe(Loe[e]):e==="transparent"?new Bi(NaN,NaN,NaN,0):null}function joe(e){return new Bi(e>>16&255,e>>8&255,e&255,1)}function OC(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bi(e,t,n,r)}function EB(e){return e instanceof pd||(e=G1(e)),e?(e=e.rgb(),new Bi(e.r,e.g,e.b,e.opacity)):new Bi}function gd(e,t,n,r){return arguments.length===1?EB(e):new Bi(e,t,n,r??1)}function Bi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ov(Bi,gd,q1(pd,{brighter:function(e){return e=e==null?Iv:Math.pow(Iv,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ep:Math.pow(Ep,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Uoe,formatHex:Uoe,formatRgb:Woe,toString:Woe}));function Uoe(){return"#"+AB(this.r)+AB(this.g)+AB(this.b)}function Woe(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function AB(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Voe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ul(e,t,n,r)}function qoe(e){if(e instanceof ul)return new ul(e.h,e.s,e.l,e.opacity);if(e instanceof pd||(e=G1(e)),!e)return new ul;if(e instanceof ul)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new ul(o,s,u,e.opacity)}function IC(e,t,n,r){return arguments.length===1?qoe(e):new ul(e,t,n,r??1)}function ul(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ov(ul,IC,q1(pd,{brighter:function(e){return e=e==null?Iv:Math.pow(Iv,e),new ul(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ep:Math.pow(Ep,e),new ul(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bi(CB(e>=240?e-240:e+120,i,r),CB(e,i,r),CB(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function CB(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Hoe=Math.PI/180,Goe=180/Math.PI,NC=18,Koe=.96422,Xoe=1,Yoe=.82521,Zoe=4/29,Dv=6/29,Joe=3*Dv*Dv,kZe=Dv*Dv*Dv;function Qoe(e){if(e instanceof ll)return new ll(e.l,e.a,e.b,e.opacity);if(e instanceof Ac)return ese(e);e instanceof Bi||(e=EB(e));var t=IB(e.r),n=IB(e.g),r=IB(e.b),i=kB((.2225045*t+.7168786*n+.0606169*r)/Xoe),a,o;return t===n&&n===r?a=o=i:(a=kB((.4360747*t+.3850649*n+.1430804*r)/Koe),o=kB((.0139322*t+.0971045*n+.7141733*r)/Yoe)),new ll(116*i-16,500*(a-i),200*(i-o),e.opacity)}function DC(e,t,n,r){return arguments.length===1?Qoe(e):new ll(e,t,n,r??1)}function ll(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Ov(ll,DC,q1(pd,{brighter:function(e){return new ll(this.l+NC*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ll(this.l-NC*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Koe*TB(t),e=Xoe*TB(e),n=Yoe*TB(n),new Bi(OB(3.1338561*t-1.6168667*e-.4906146*n),OB(-.9787684*t+1.9161415*e+.033454*n),OB(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function kB(e){return e>kZe?Math.pow(e,1/3):e/Joe+Zoe}function TB(e){return e>Dv?e*e*e:Joe*(e-Zoe)}function OB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function IB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function TZe(e){if(e instanceof Ac)return new Ac(e.h,e.c,e.l,e.opacity);if(e instanceof ll||(e=Qoe(e)),e.a===0&&e.b===0)return new Ac(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Goe;return new Ac(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function RC(e,t,n,r){return arguments.length===1?TZe(e):new Ac(e,t,n,r??1)}function Ac(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function ese(e){if(isNaN(e.h))return new ll(e.l,0,0,e.opacity);var t=e.h*Hoe;return new ll(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ov(Ac,RC,q1(pd,{brighter:function(e){return new Ac(this.h,this.c,this.l+NC*(e??1),this.opacity)},darker:function(e){return new Ac(this.h,this.c,this.l-NC*(e??1),this.opacity)},rgb:function(){return ese(this).rgb()}}));var tse=-.14861,NB=1.78277,DB=-.29227,FC=-.90649,K1=1.97294,nse=K1*FC,rse=K1*NB,ise=NB*DB-FC*tse;function OZe(e){if(e instanceof Ap)return new Ap(e.h,e.s,e.l,e.opacity);e instanceof Bi||(e=EB(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(ise*r+nse*t-rse*n)/(ise+nse-rse),a=r-i,o=(K1*(n-i)-DB*a)/FC,s=Math.sqrt(o*o+a*a)/(K1*i*(1-i)),u=s?Math.atan2(o,a)*Goe-120:NaN;return new Ap(u<0?u+360:u,s,i,e.opacity)}function RB(e,t,n,r){return arguments.length===1?OZe(e):new Ap(e,t,n,r??1)}function Ap(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ov(Ap,RB,q1(pd,{brighter:function(e){return e=e==null?Iv:Math.pow(Iv,e),new Ap(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ep:Math.pow(Ep,e),new Ap(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Hoe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Bi(255*(t+n*(tse*r+NB*i)),255*(t+n*(DB*r+FC*i)),255*(t+n*(K1*r)),this.opacity)}}));function ase(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function ose(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return ase((n-r/t)*t,o,i,a,s)}}function sse(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return ase((n-r/t)*t,i,a,o,s)}}var MC=e=>()=>e;function use(e,t){return function(n){return e+n*t}}function IZe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function PC(e,t){var n=t-e;return n?use(e,n>180||n<-180?n-360*Math.round(n/360):n):MC(isNaN(e)?t:e)}function NZe(e){return(e=+e)==1?_i:function(t,n){return n-t?IZe(t,n,e):MC(isNaN(t)?n:t)}}function _i(e,t){var n=t-e;return n?use(e,n):MC(isNaN(e)?t:e)}var FB=function e(t){var n=NZe(t);function r(i,a){var o=n((i=gd(i)).r,(a=gd(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=_i(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function lse(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=gd(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=a(u),s+""}}}var DZe=lse(ose),RZe=lse(sse);function MB(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function cse(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function FZe(e,t){return(cse(t)?MB:fse)(e,t)}function fse(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=md(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function dse(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ou(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function hse(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=md(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var PB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$B=new RegExp(PB.source,"g");function MZe(e){return function(){return e}}function PZe(e){return function(t){return e(t)+""}}function pse(e,t){var n=PB.lastIndex=$B.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(e=e+"",t=t+"";(r=PB.exec(e))&&(i=$B.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:ou(r,i)})),n=$B.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?PZe(u[0].x):MZe(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function md(e,t){var n=typeof t,r;return t==null||n==="boolean"?MC(t):(n==="number"?ou:n==="string"?(r=G1(t))?(t=r,FB):pse:t instanceof G1?FB:t instanceof Date?dse:cse(t)?MB:Array.isArray(t)?fse:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?hse:ou)(e,t)}function $Ze(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function LZe(e,t){var n=PC(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function X1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var gse=180/Math.PI,LB={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mse(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*gse,skewX:Math.atan(u)*gse,scaleX:o,scaleY:s}}var $C;function BZe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?LB:mse(t.a,t.b,t.c,t.d,t.e,t.f)}function zZe(e){return e==null||($C||($C=document.createElementNS("http://www.w3.org/2000/svg","g")),$C.setAttribute("transform",e),!(e=$C.transform.baseVal.consolidate()))?LB:(e=e.matrix,mse(e.a,e.b,e.c,e.d,e.e,e.f))}function vse(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:ou(l,f)},{i:g-2,x:ou(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ou(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ou(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:ou(l,f)},{i:g-2,x:ou(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var jZe=vse(BZe,"px, ","px)","deg)"),UZe=vse(zZe,", ",")",")"),WZe=1e-12;function yse(e){return((e=Math.exp(e))+1/e)/2}function VZe(e){return((e=Math.exp(e))-1/e)/2}function qZe(e){return((e=Math.exp(2*e))-1)/(e+1)}var HZe=function e(t,n,r){function i(a,o){var s=a[0],u=a[1],l=a[2],c=o[0],f=o[1],d=o[2],h=c-s,p=f-u,g=h*h+p*p,m,v;if(g<WZe)v=Math.log(d/l)/t,m=function(A){return[s+A*h,u+A*p,l*Math.exp(t*A*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),x=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(x*x+1)-x);v=(S-w)/t,m=function(A){var _=A*v,E=yse(w),C=l/(n*y)*(E*qZe(t*_+w)-VZe(w));return[s+C*h,u+C*p,l*E/yse(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,u=s*s;return e(o,s,u)},i}(Math.SQRT2,2,4);function bse(e){return function(t,n){var r=e((t=IC(t)).h,(n=IC(n)).h),i=_i(t.s,n.s),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var GZe=bse(PC),KZe=bse(_i);function XZe(e,t){var n=_i((e=DC(e)).l,(t=DC(t)).l),r=_i(e.a,t.a),i=_i(e.b,t.b),a=_i(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function xse(e){return function(t,n){var r=e((t=RC(t)).h,(n=RC(n)).h),i=_i(t.c,n.c),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var YZe=xse(PC),ZZe=xse(_i);function wse(e){return function t(n){n=+n;function r(i,a){var o=e((i=RB(i)).h,(a=RB(a)).h),s=_i(i.s,a.s),u=_i(i.l,a.l),l=_i(i.opacity,a.opacity);return function(c){return i.h=o(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var JZe=wse(PC),QZe=wse(_i);function BB(e,t){t===void 0&&(t=e,e=md);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function eJe(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var tJe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:md,interpolateArray:FZe,interpolateBasis:ose,interpolateBasisClosed:sse,interpolateDate:dse,interpolateDiscrete:$Ze,interpolateHue:LZe,interpolateNumber:ou,interpolateNumberArray:MB,interpolateObject:hse,interpolateRound:X1,interpolateString:pse,interpolateTransformCss:jZe,interpolateTransformSvg:UZe,interpolateZoom:HZe,interpolateRgb:FB,interpolateRgbBasis:DZe,interpolateRgbBasisClosed:RZe,interpolateHsl:GZe,interpolateHslLong:KZe,interpolateLab:XZe,interpolateHcl:YZe,interpolateHclLong:ZZe,interpolateCubehelix:JZe,interpolateCubehelixLong:QZe,piecewise:BB,quantize:eJe});function nJe(e){return function(){return e}}function zB(e){return+e}var _se=[0,1];function lo(e){return e}function jB(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:nJe(isNaN(t)?NaN:.5)}function rJe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function iJe(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=jB(i,r),a=n(o,a)):(r=jB(r,i),a=n(a,o)),function(s){return a(r(s))}}function aJe(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=jB(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var u=y1(e,s,1,r)-1;return a[u](i[u](s))}}function Y1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function LC(){var e=_se,t=_se,n=md,r,i,a,o=lo,s,u,l;function c(){var d=Math.min(e.length,t.length);return o!==lo&&(o=rJe(e[0],e[d-1])),s=d>2?aJe:iJe,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?a:(u||(u=s(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=s(t,e.map(r),ou)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,zB),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=X1,c()},f.clamp=function(d){return arguments.length?(o=d?!0:lo,c()):o!==lo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function Sse(){return LC()(lo,lo)}function BC(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Rv(e){return e=BC(Math.abs(e)),e?e[1]:NaN}function oJe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function sJe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var uJe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Z1(e){return new UB(e)}Z1.prototype=UB.prototype;function UB(e){if(!(t=uJe.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}UB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lJe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Ese;function cJe(e,t){var n=BC(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Ese=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+BC(e,Math.max(0,t+a-1))[0]}function Ase(e,t){var n=BC(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Cse={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Ase(e*100,t)},r:Ase,s:cJe,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function kse(e){return e}var Tse=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ose(e){var t=e.grouping&&e.thousands?oJe(e.grouping,e.thousands):kse,n=e.currency,r=e.decimal,i=e.numerals?sJe(e.numerals):kse,a=e.percent||"%";function o(u){u=Z1(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,g=u.comma,m=u.precision,v=u.trim,y=u.type;y==="n"?(g=!0,y="g"):Cse[y]||(m==null&&(m=12),v=!0,y="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var b=d==="$"?n[0]:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(y)?a:"",w=Cse[y],S=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function A(_){var E=b,C=x,k,T,I;if(y==="c")C=w(_)+C,_="";else{_=+_;var N=_<0;if(_=w(Math.abs(_),m),v&&(_=lJe(_)),N&&+_==0&&(N=!1),E=(N?f==="("?f:"-":f==="-"||f==="("?"":f)+E,C=(y==="s"?Tse[8+Ese/3]:"")+C+(N&&f==="("?")":""),S){for(k=-1,T=_.length;++k<T;)if(I=_.charCodeAt(k),48>I||I>57){C=(I===46?r+_.slice(k+1):_.slice(k))+C,_=_.slice(0,k);break}}}g&&!h&&(_=t(_,1/0));var O=E.length+_.length+C.length,D=O<p?new Array(p-O+1).join(l):"";switch(g&&h&&(_=t(D+_,D.length?p-C.length:1/0),D=""),c){case"<":_=E+_+C+D;break;case"=":_=E+D+_+C;break;case"^":_=D.slice(0,O=D.length>>1)+E+_+C+D.slice(O);break;default:_=D+E+_+C;break}return i(_)}return A.toString=function(){return u+""},A}function s(u,l){var c=o((u=Z1(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Rv(l)/3)))*3,d=Math.pow(10,-f),h=Tse[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:s}}var zC,jC,WB;Ise({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function Ise(e){return zC=Ose(e),jC=zC.format,WB=zC.formatPrefix,zC}function Nse(e){return Math.max(0,-Rv(Math.abs(e)))}function Dse(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rv(t)/3)))*3-Rv(Math.abs(e)))}function Rse(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Rv(t)-Rv(e))+1}var fJe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",formatDefaultLocale:Ise,get format(){return jC},get formatPrefix(){return WB},formatLocale:Ose,formatSpecifier:Z1,precisionFixed:Nse,precisionPrefix:Dse,precisionRound:Rse});function Fse(e,t,n,r){var i=nd(e,t,n),a;switch(r=Z1(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=Dse(i,o))&&(r.precision=a),WB(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Rse(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Nse(i))&&(r.precision=a-(r.type==="%")*2);break}}return jC(r)}function Cp(e){var t=e.domain;return e.ticks=function(n){var r=t();return BL(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Fse(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=Qre(o,s,n),l===u)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function Mse(){var e=Sse();return e.copy=function(){return Y1(e,Mse())},ol.apply(e,arguments),Cp(e)}function Pse(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,zB),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Pse(e).unknown(t)},e=arguments.length?Array.from(e,zB):[0,1],Cp(n)}function $se(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function Lse(e){return Math.log(e)}function Bse(e){return Math.exp(e)}function dJe(e){return-Math.log(-e)}function hJe(e){return-Math.exp(-e)}function pJe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function gJe(e){return e===10?pJe:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function mJe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function zse(e){return function(t){return-e(-t)}}function VB(e){var t=e(Lse,Bse),n=t.domain,r=10,i,a;function o(){return i=mJe(r),a=gJe(r),n()[0]<0?(i=zse(i),a=zse(a),e(dJe,hJe)):e(Lse,Bse),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,g,m,v=s==null?10:+s,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=a(d);g<r;++g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=a(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}y.length*2<v&&(y=BL(l,c,v))}else y=BL(d,h,Math.min(h-d,v)).map(a);return f?y.reverse():y},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=jC(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n($se(n(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function jse(){var e=VB(LC()).domain([1,10]);return e.copy=function(){return Y1(e,jse()).base(e.base())},ol.apply(e,arguments),e}function Use(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Wse(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function qB(e){var t=1,n=e(Use(t),Wse(t));return n.constant=function(r){return arguments.length?e(Use(t=+r),Wse(t)):t},Cp(n)}function Vse(){var e=qB(LC());return e.copy=function(){return Y1(e,Vse()).constant(e.constant())},ol.apply(e,arguments)}function qse(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vJe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yJe(e){return e<0?-e*e:e*e}function HB(e){var t=e(lo,lo),n=1;function r(){return n===1?e(lo,lo):n===.5?e(vJe,yJe):e(qse(n),qse(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Cp(t)}function GB(){var e=HB(LC());return e.copy=function(){return Y1(e,GB()).exponent(e.exponent())},ol.apply(e,arguments),e}function bJe(){return GB.apply(null,arguments).exponent(.5)}function Hse(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=tie(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[y1(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(mv),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return Hse().domain(e).range(t).unknown(r)},ol.apply(a,arguments)}function Gse(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(u){return u!=null&&u<=u?i[y1(r,u,0,n)]:a}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Gse().domain([e,t]).range(i).unknown(a)},ol.apply(Cp(o),arguments)}function Kse(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[y1(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Kse().domain(e).range(t).unknown(n)},ol.apply(i,arguments)}function xJe(e){return new Date(e)}function wJe(e){return e instanceof Date?+e:+new Date(+e)}function KB(e,t,n,r,i,a,o,s,u,l){var c=Sse(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:s(S)<S?p:o(S)<S?g:a(S)<S?m:r(S)<S?i(S)<S?v:y:n(S)<S?b:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,wJe)):d().map(xJe)},c.ticks=function(S){var A=d();return e(A[0],A[A.length-1],S??10)},c.tickFormat=function(S,A){return A==null?w:l(A)},c.nice=function(S){var A=d();return(!S||typeof S.range!="function")&&(S=t(A[0],A[A.length-1],S??10)),S?d($se(A,S)):c},c.copy=function(){return Y1(c,KB(e,t,n,r,i,a,o,s,u,l))},c}function _Je(){return ol.apply(KB(VGe,qGe,ad,tC,w1,id,YL,XL,rd,d4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function SJe(){return ol.apply(KB(UGe,WGe,sd,nC,S1,od,QL,JL,rd,h4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function UC(){var e=0,t=1,n,r,i,a,o=lo,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(md),l.rangeRound=c(X1),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function vd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XB(){var e=Cp(UC()(lo));return e.copy=function(){return vd(e,XB())},hd.apply(e,arguments)}function Xse(){var e=VB(UC()).domain([1,10]);return e.copy=function(){return vd(e,Xse()).base(e.base())},hd.apply(e,arguments)}function Yse(){var e=qB(UC());return e.copy=function(){return vd(e,Yse()).constant(e.constant())},hd.apply(e,arguments)}function YB(){var e=HB(UC());return e.copy=function(){return vd(e,YB()).exponent(e.exponent())},hd.apply(e,arguments)}function EJe(){return YB.apply(null,arguments).exponent(.5)}function WC(){var e=0,t=.5,n=1,r=1,i,a,o,s,u,l=lo,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-a)*(r*g<r*a?s:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),a=c(t=+t),o=c(n=+n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=BB(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(md),h.rangeRound=p(X1),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),a=g(t),o=g(n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function Zse(){var e=Cp(WC()(lo));return e.copy=function(){return vd(e,Zse())},hd.apply(e,arguments)}function Jse(){var e=VB(WC()).domain([.1,1,10]);return e.copy=function(){return vd(e,Jse()).base(e.base())},hd.apply(e,arguments)}function Qse(){var e=qB(WC());return e.copy=function(){return vd(e,Qse()).constant(e.constant())},hd.apply(e,arguments)}function ZB(){var e=HB(WC());return e.copy=function(){return vd(e,ZB()).exponent(e.exponent())},hd.apply(e,arguments)}function AJe(){return ZB.apply(null,arguments).exponent(.5)}function JB(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const CJe="identity",Fv="linear",Cc="log",J1="pow",Q1="sqrt",VC="symlog",kp="time",Tp="utc",cl="sequential",Mv="diverging",Pv="quantile",qC="quantize",HC="threshold",QB="ordinal",ez="point",eue="band",tz="bin-ordinal",li="continuous",ex="discrete",tx="discretizing",gs="interpolating",nz="temporal";function kJe(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function TJe(e){return function(t){const n=e.range();let r=t[0],i=t[1],a=-1,o,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(a<0&&(a=u),o=u);if(!(a<0))return r=e.invertExtent(n[a]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function rz(){const e=SB().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,a,o=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=JB(f,s,u);let g=r[d-0];i=(h-g)/(p||1),o&&(i=Math.floor(i)),g+=(h-g-i*(f-s))*l,a=i*(1-s),o&&(g=Math.round(g),a=Math.round(a));const m=zo(f).map(v=>g+i*v);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>r[1-d])))return v=Math.max(0,JA(h,g)-1),y=g===m?v:JA(h,m)-1,g-h[v]>a+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return rz().domain(t()).range(r).round(o).paddingInner(s).paddingOuter(u).align(l)},c()}function tue(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return tue(t())},e}function OJe(){return tue(rz().paddingInner(1))}var IJe=Array.prototype.map;function NJe(e){return IJe.call(e,Zi)}const DJe=Array.prototype.slice;function nue(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(y1(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=NJe(r),n):e.slice()},n.range=function(r){return arguments.length?(t=DJe.call(r),n):t.slice()},n.tickFormat=function(r,i){return Fse(e[0],sn(e),r??10,i)},n.copy=function(){return nue().domain(n.domain()).range(n.range())},n}const GC={};function RJe(e,t,n){const r=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?kJe(a):a.invertExtent?TJe(a):void 0),a.type=e,a};return r.metadata=iu(xt(n)),r}function Sn(e,t,n){return arguments.length>1?(GC[e]=RJe(e,t,n),this):rue(e)?GC[e]:void 0}Sn(CJe,Pse),Sn(Fv,Mse,li),Sn(Cc,jse,[li,Cc]),Sn(J1,GB,li),Sn(Q1,bJe,li),Sn(VC,Vse,li),Sn(kp,_Je,[li,nz]),Sn(Tp,SJe,[li,nz]),Sn(cl,XB,[li,gs]),Sn("".concat(cl,"-").concat(Fv),XB,[li,gs]),Sn("".concat(cl,"-").concat(Cc),Xse,[li,gs,Cc]),Sn("".concat(cl,"-").concat(J1),YB,[li,gs]),Sn("".concat(cl,"-").concat(Q1),EJe,[li,gs]),Sn("".concat(cl,"-").concat(VC),Yse,[li,gs]),Sn("".concat(Mv,"-").concat(Fv),Zse,[li,gs]),Sn("".concat(Mv,"-").concat(Cc),Jse,[li,gs,Cc]),Sn("".concat(Mv,"-").concat(J1),ZB,[li,gs]),Sn("".concat(Mv,"-").concat(Q1),AJe,[li,gs]),Sn("".concat(Mv,"-").concat(VC),Qse,[li,gs]),Sn(Pv,Hse,[tx,Pv]),Sn(qC,Gse,tx),Sn(HC,Kse,tx),Sn(tz,nue,[ex,tx]),Sn(QB,SB,ex),Sn(eue,rz,ex),Sn(ez,OJe,ex);function rue(e){return _t(GC,e)}function Op(e,t){const n=GC[e];return n&&n.metadata[t]}function iz(e){return Op(e,li)}function $v(e){return Op(e,ex)}function az(e){return Op(e,tx)}function iue(e){return Op(e,Cc)}function FJe(e){return Op(e,nz)}function aue(e){return Op(e,gs)}function oue(e){return Op(e,Pv)}const MJe=["clamp","base","constant","exponent"];function sue(e,t){const n=t[0],r=sn(t)-n;return function(i){return e(n+i*r)}}function KC(e,t,n){return BB(oz(t||"rgb",n),e)}function uue(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function lue(e,t,n){const r=n-t;let i,a,o;return!r||!Number.isFinite(r)?Ji(.5):(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Sn(a)().domain([t,n]).range([0,1]),MJe.forEach(s=>e[s]?o[s](e[s]()):0),o)}function oz(e,t){const n=tJe[PJe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function PJe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const $Je={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},LJe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function cue(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function fue(e,t){for(const n in e)sz(n,t(e[n]))}const due={};fue(LJe,cue),fue($Je,e=>KC(cue(e)));function sz(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(due[e]=t,this):due[e]}const XC="symbol",BJe="discrete",zJe="gradient",jJe=e=>ut(e)?e.map(t=>String(t)):String(e),UJe=(e,t)=>e[1]-t[1],WJe=(e,t)=>t[1]-e[1];function uz(e,t,n){let r;return ed(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(g1(e.domain())/n||1)))),Nt(t)&&(r=t.step,t=t.interval),Bn(t)&&(t=e.type===kp?bv(t):e.type==Tp?xv(t):Se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function hue(e,t,n){let r=e.range(),i=r[0],a=sn(r),o=UJe;if(i>a&&(r=a,a=i,i=r,o=WJe),i=Math.floor(i),a=Math.ceil(a),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=a).sort(o).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],sn(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function lz(e,t){return e.bins?hue(e,e.bins):e.ticks?e.ticks(t):e.domain()}function pue(e,t,n,r,i,a){const o=t.type;let s=jJe;if(o===kp||i===kp)s=e.timeFormat(r);else if(o===Tp||i===Tp)s=e.utcFormat(r);else if(iue(o)){const u=e.formatFloat(r);if(a||t.bins)s=u;else{const l=gue(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function gue(e,t,n){const r=lz(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(s):s}const cz={[Pv]:"quantiles",[qC]:"thresholds",[HC]:"domain"},mue={[Pv]:"quantiles",[qC]:"domain"};function vue(e,t){return e.bins?HJe(e.bins):e.type===Cc?gue(e,t,!0):cz[e.type]?qJe(e[cz[e.type]]()):lz(e,t)}function VJe(e,t,n){const r=t[mue[t.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,3*10,n)}function qJe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function HJe(e){const t=e.slice(0,-1);return t.max=sn(e),t}const GJe=e=>cz[e.type]||e.bins;function yue(e,t,n,r,i,a,o){const s=mue[t.type]&&a!==kp&&a!==Tp?VJe(e,t,i):pue(e,t,n,i,a,o);return r===XC&&GJe(t)?KJe(s):r===BJe?XJe(s):YJe(s)}const KJe=e=>(t,n,r)=>{const i=bue(r[n+1],bue(r.max,1/0)),a=xue(t,e),o=xue(i,e);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},bue=(e,t)=>e??t,XJe=e=>(t,n)=>n?e(t):null,YJe=e=>t=>e(t),xue=(e,t)=>Number.isFinite(e)?t(e):null;function ZJe(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+sn(t),a=i-r;if(e.type===HC){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function JJe(e,t,n,r){const i=r||t.type;return Bn(n)&&FJe(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===kp?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Tp?e.utcFormat("%A, %d %B %Y, %X UTC"):yue(e,t,5,null,n,r,!0)}function wue(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=JJe(e,t,n.format,n.formatType);if(az(t.type)){const a=vue(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if($v(t.type)){const a=t.domain(),o=a.length,s=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(s)}else{const a=t.domain();return"values from ".concat(i(a[0])," to ").concat(i(sn(a)))}}let _ue=0;function QJe(){_ue=0}const YC="p_";function fz(e){return e&&e.gradient}function Sue(e,t,n){const r=e.gradient;let i=e.id,a=r==="radial"?YC:"";return i||(i=e.id="gradient_"+_ue++,r==="radial"?(e.x1=fl(e.x1,.5),e.y1=fl(e.y1,.5),e.r1=fl(e.r1,0),e.x2=fl(e.x2,.5),e.y2=fl(e.y2,.5),e.r2=fl(e.r2,.5),a=YC):(e.x1=fl(e.x1,0),e.y1=fl(e.y1,0),e.x2=fl(e.x2,1),e.y2=fl(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+a+i+")"}function fl(e,t){return e??t}function Eue(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const Aue={basis:{curve:tZe},"basis-closed":{curve:nZe},"basis-open":{curve:rZe},bundle:{curve:iZe,tension:"beta",value:.85},cardinal:{curve:aZe,tension:"tension",value:0},"cardinal-open":{curve:sZe,tension:"tension",value:0},"cardinal-closed":{curve:oZe,tension:"tension",value:0},"catmull-rom":{curve:uZe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:lZe,tension:"alpha",value:.5},"catmull-rom-open":{curve:cZe,tension:"alpha",value:.5},linear:{curve:mB},"linear-closed":{curve:fZe},monotone:{horizontal:hZe,vertical:dZe},natural:{curve:pZe},step:{curve:gZe},"step-after":{curve:vZe},"step-before":{curve:mZe}};function dz(e,t,n){var r=_t(Aue,e)&&Aue[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const eQe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},nx=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Lv(e){const t=[];let n,r,i,a,o,s,u,l,c,f;const d=e.slice().replace(nx[0],"###$1").split(nx[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(nx[2],"$1###$2").replace(nx[3],"$1###$2").split(nx[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(s=eQe[o.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=s))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=s)t.push([o].concat(i.slice(l,l+s)))}else t.push(i)}return t}const yd=Math.PI/180,tQe=1e-14,Ip=Math.PI/2,dl=Math.PI*2,Bv=Math.sqrt(3)/2;var hz={},pz={},Cue=[].join;function nQe(e,t,n,r,i,a,o,s,u){const l=Cue.call(arguments);if(hz[l])return hz[l];const c=o*yd,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,x=m*s+v*u,w=y*s+b*u,S=m*e+v*t,A=y*e+b*t,_=(S-x)*(S-x)+(A-w)*(A-w);let E=1/_-.25;E<0&&(E=0);let C=Math.sqrt(E);a==i&&(C=-C);const k=.5*(x+S)-C*(A-w),T=.5*(w+A)+C*(S-x),I=Math.atan2(w-T,x-k);let O=Math.atan2(A-T,S-k)-I;O<0&&a===1?O+=dl:O>0&&a===0&&(O-=dl);const D=Math.ceil(Math.abs(O/(Ip+.001))),L=[];for(let W=0;W<D;++W){const G=I+W*O/D,K=I+(W+1)*O/D;L[W]=[k,T,G,K,n,r,f,d]}return hz[l]=L}function rQe(e){const t=Cue.call(e);if(pz[t])return pz[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7];const c=l*o,f=-u*s,d=u*o,h=l*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,S=r+g+x*p,A=n+m,_=r+v,E=A+x*v,C=_-x*m;return pz[t]=[c*w+f*S,d*w+h*S,c*E+f*C,d*E+h*C,c*A+f*_,d*A+h*_]}const ms=["l",0,0,0,0,0,0,0];function iQe(e,t,n){const r=ms[0]=e[0];if(r==="a"||r==="A")ms[1]=t*e[1],ms[2]=n*e[2],ms[3]=e[3],ms[4]=e[4],ms[5]=e[5],ms[6]=t*e[6],ms[7]=n*e[7];else if(r==="h"||r==="H")ms[1]=t*e[1];else if(r==="v"||r==="V")ms[1]=n*e[1];else for(var i=1,a=e.length;i<a;++i)ms[i]=(i%2==1?t:n)*e[i];return ms}function rx(e,t,n,r,i,a){var o,s=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(o=t[m],(i!==1||a!==1)&&(o=iQe(o,i,a)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-p,f=2*l-g):s[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":kue(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":kue(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}s=o}}function kue(e,t,n,r){const i=nQe(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let a=0;a<i.length;++a){const o=rQe(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Tue=.5773502691896257,Oue={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,dl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n,i=r-n*Tue,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n,i=r-n*Tue;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Bv*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Iue(e){return _t(Oue,e)?Oue[e]:aQe(e)}var gz={};function aQe(e){if(!_t(gz,e)){const t=Lv(e);gz[e]={draw:function(n,r){rx(n,t,0,0,Math.sqrt(r)/2)}}}return gz[e]}const bd=.448084975506;function oQe(e){return e.x}function sQe(e){return e.y}function uQe(e){return e.width}function lQe(e){return e.height}function kc(e){return typeof e=="function"?e:()=>+e}function ZC(e,t,n){return Math.max(t,Math.min(e,n))}function Nue(){var e=oQe,t=sQe,n=uQe,r=lQe,i=kc(0),a=i,o=i,s=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=ZC(+i.call(this,c),0,y),x=ZC(+a.call(this,c),0,y),w=ZC(+o.call(this,c),0,y),S=ZC(+s.call(this,c),0,y);if(u||(u=h=_p()),b<=0&&x<=0&&w<=0&&S<=0)u.rect(p,g,m,v);else{var A=p+m,_=g+v;u.moveTo(p+b,g),u.lineTo(A-x,g),u.bezierCurveTo(A-bd*x,g,A,g+bd*x,A,g+x),u.lineTo(A,_-S),u.bezierCurveTo(A,_-bd*S,A-bd*S,_,A-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+bd*w,_,p,_-bd*w,p,_-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+bd*b,p+bd*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=kc(c),l):e},l.y=function(c){return arguments.length?(t=kc(c),l):t},l.width=function(c){return arguments.length?(n=kc(c),l):n},l.height=function(c){return arguments.length?(r=kc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=kc(c),a=f!=null?kc(f):i,s=d!=null?kc(d):i,o=h!=null?kc(h):a,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function Due(){var e,t,n,r,i=null,a,o,s,u;function l(f,d,h){const p=h/2;if(a){var g=s-d,m=f-o;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,x=Math.atan2(m,g);i.moveTo(o-y,s-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,x-Math.PI,x),i.lineTo(o+y,s+b),i.arc(o,s,u,x,x+Math.PI)}else i.arc(f,d,p,0,dl);i.closePath()}else a=1;o=f,s=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=_p()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(a=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function ix(e,t){return e??t}const ax=e=>e.x||0,ox=e=>e.y||0,cQe=e=>e.width||0,fQe=e=>e.height||0,dQe=e=>(e.x||0)+(e.width||0),hQe=e=>(e.y||0)+(e.height||0),pQe=e=>e.startAngle||0,gQe=e=>e.endAngle||0,mQe=e=>e.padAngle||0,vQe=e=>e.innerRadius||0,yQe=e=>e.outerRadius||0,bQe=e=>e.cornerRadius||0,xQe=e=>ix(e.cornerRadiusTopLeft,e.cornerRadius)||0,wQe=e=>ix(e.cornerRadiusTopRight,e.cornerRadius)||0,_Qe=e=>ix(e.cornerRadiusBottomRight,e.cornerRadius)||0,SQe=e=>ix(e.cornerRadiusBottomLeft,e.cornerRadius)||0,EQe=e=>ix(e.size,64),AQe=e=>e.size||1,JC=e=>e.defined!==!1,CQe=e=>Iue(e.shape||"circle"),kQe=JYe().startAngle(pQe).endAngle(gQe).padAngle(mQe).innerRadius(vQe).outerRadius(yQe).cornerRadius(bQe),TQe=Soe().x(ax).y1(ox).y0(hQe).defined(JC),OQe=Soe().y(ox).x1(ax).x0(dQe).defined(JC),IQe=_oe().x(ax).y(ox).defined(JC),NQe=Nue().x(ax).y(ox).width(cQe).height(fQe).cornerRadius(xQe,wQe,_Qe,SQe),DQe=eZe().type(CQe).size(EQe),RQe=Due().x(ax).y(ox).defined(JC).size(AQe);function mz(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function FQe(e,t){return kQe.context(e)(t)}function MQe(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?OQe:TQe).curve(dz(r,n.orient,n.tension)).context(e)(t)}function PQe(e,t){const n=t[0],r=n.interpolate||"linear";return IQe.curve(dz(r,n.orient,n.tension)).context(e)(t)}function zv(e,t,n,r){return NQe.context(e)(t,n,r)}function $Qe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function LQe(e,t){return DQe.context(e)(t)}function BQe(e,t){return RQe.context(e)(t)}var Rue=1;function Fue(){Rue=1}function vz(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Rue++),o=i.clipping[a]||(i.clipping[a]={id:a});return $t(r)?o.path=r(null):mz(n)?o.path=zv(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function ci(e){this.clear(),e&&this.union(e)}ci.prototype={clone(){return new ci(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*o+l,u*r+s*o+c,s*a-u*i+l,u*a+s*i+c,s*a-u*o+l,u*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function QC(e){this.mark=e,this.bounds=this.bounds||new ci}function ek(e){QC.call(this,e),this.items=this.items||[]}$e(ek,QC);function yz(e){this._pending=0,this._loader=e||aC()}function Mue(e){e._pending+=1}function sx(e){e._pending-=1}yz.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Mue(t),t._loader.sanitize(e,{context:"href"}).then(n=>(sx(t),n)).catch(()=>(sx(t),null))},loadImage(e){const t=this,n=yZe();return Mue(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=_t(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>sx(t),a.onerror=()=>sx(t),a.src=i,a}).catch(r=>(sx(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Tc(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?zQe(t,r):0))}return e}function zQe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const jQe=dl-1e-8;let tk,nk,rk,Np,bz,ik,xz,wz;const xd=(e,t)=>tk.add(e,t),ak=(e,t)=>xd(nk=e,rk=t),Pue=e=>xd(e,tk.y1),$ue=e=>xd(tk.x1,e),Dp=(e,t)=>bz*e+xz*t,Rp=(e,t)=>ik*e+wz*t,_z=(e,t)=>xd(Dp(e,t),Rp(e,t)),Sz=(e,t)=>ak(Dp(e,t),Rp(e,t));function ux(e,t){return tk=e,t?(Np=t*yd,bz=wz=Math.cos(Np),ik=Math.sin(Np),xz=-ik):(bz=wz=1,Np=ik=xz=0),UQe}const UQe={beginPath(){},closePath(){},moveTo:Sz,lineTo:Sz,rect(e,t,n,r){Np?(_z(e+n,t),_z(e+n,t+r),_z(e,t+r),Sz(e,t)):(xd(e+n,t+r),ak(e,t))},quadraticCurveTo(e,t,n,r){const i=Dp(e,t),a=Rp(e,t),o=Dp(n,r),s=Rp(n,r);Lue(nk,i,o,Pue),Lue(rk,a,s,$ue),ak(o,s)},bezierCurveTo(e,t,n,r,i,a){const o=Dp(e,t),s=Rp(e,t),u=Dp(n,r),l=Rp(n,r),c=Dp(i,a),f=Rp(i,a);Bue(nk,o,u,c,Pue),Bue(rk,s,l,f,$ue),ak(c,f)},arc(e,t,n,r,i,a){if(r+=Np,i+=Np,nk=n*Math.cos(i)+e,rk=n*Math.sin(i)+t,Math.abs(i-r)>jQe)xd(e-n,t-n),xd(e+n,t+n);else{const o=l=>xd(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(o(r),o(i),i!==r)if(r=r%dl,r<0&&(r+=dl),i=i%dl,i<0&&(i+=dl),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=dl,s=r-r%Ip,u=0;u<4&&s>i;++u,s-=Ip)o(s);else for(s=r-r%Ip+Ip,u=0;u<4&&s<i;++u,s=s+Ip)o(s)}}};function Lue(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function Bue(e,t,n,r,i){const a=r-e+3*t-3*n,o=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(a)>tQe?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(zue(u,e,t,n,r)),0<l&&l<1&&i(zue(l,e,t,n,r))}function zue(e,t,n,r,i){const a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*r+s*e*i}var wd=(wd=Tv(1,1))?wd.getContext("2d"):null;const Ez=new ci;function Az(e){return function(t,n){if(!wd)return!0;e(wd,t),Ez.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=Ez;for(let s=i;s<=o;++s)for(let u=r;u<=a;++u)if(wd.isPointInPath(u,s))return!0;return!1}}function Cz(e,t){return t.contains(e.x||0,e.y||0)}function jue(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Ez.set(n,r,n+i,r+a))}function Uue(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return jv(t,n,r,i,a)}function jv(e,t,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(a-t)),m===1&&(h=l,p=s-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Uv(e,t){e.globalCompositeOperation=t.blend||"source-over"}function su(e,t){return e??t}function Wue(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function WQe(e,t,n){const r=n.width(),i=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+su(t.x1,.5)*r,n.y1+su(t.y1,.5)*i,Math.max(r,i)*su(t.r1,0),n.x1+su(t.x2,.5)*r,n.y1+su(t.y2,.5)*i,Math.max(r,i)*su(t.r2,.5));else{const o=su(t.x1,0),s=su(t.y1,0),u=su(t.x2,1),l=su(t.y2,0);if(o===u||s===l||r===i)a=e.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=Tv(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=Wue(f.createLinearGradient(o,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return Wue(a,t.stops)}function Vue(e,t,n){return fz(n)?WQe(e,n,t.bounds):n}function ok(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Vue(e,t,t.fill),!0):!1}var VQe=[];function Wv(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Vue(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||VQe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function qQe(e,t){return e.zindex-t.zindex||e.index-t.index}function kz(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(qQe)}function uu(e,t){var n=e.items,r,i;if(!n||!n.length)return;const a=kz(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=a}for(r=0,i=n.length;r<i;++r)t(n[r])}function sk(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const a=kz(e);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===a){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Tz(e){return function(t,n,r){uu(n,i=>{(!r||r.intersects(i.bounds))&&que(e,t,i,i)})}}function HQe(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&que(e,t,n.items[0],n.items)}}function que(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Uv(t,n),n.fill&&ok(t,n,i)&&t.fill(),n.stroke&&Wv(t,n,i)&&t.stroke()))}function uk(e){return e=e||fs,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,sk(n,s=>{const u=s.bounds;if(!(u&&!u.contains(a,o)||!u)&&e(t,s,r,i,a,o))return s})}}function lx(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,s=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:s&&n.isPointInPath(i,a)||u&&n.isPointInStroke(i,a)}}function Oz(e){return uk(lx(e))}function Fp(e,t){return"translate("+e+","+t+")"}function Iz(e){return"rotate("+e+")"}function GQe(e,t){return"scale("+e+","+t+")"}function Hue(e){return Fp(e.x||0,e.y||0)}function KQe(e){return Fp(e.x||0,e.y||0)+(e.angle?" "+Iz(e.angle):"")}function XQe(e){return Fp(e.x||0,e.y||0)+(e.angle?" "+Iz(e.angle):"")+(e.scaleX||e.scaleY?" "+GQe(e.scaleX||1,e.scaleY||1):"")}function Nz(e,t,n){function r(o,s){o("transform",KQe(s)),o("d",t(null,s))}function i(o,s){return t(ux(o,s.angle),s),Tc(o,s).translate(s.x||0,s.y||0)}function a(o,s){var u=s.x||0,l=s.y||0,c=s.angle||0;o.translate(u,l),c&&o.rotate(c*=yd),o.beginPath(),t(o,s),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Tz(a),pick:Oz(a),isect:n||Az(a)}}var YQe=Nz("arc",FQe);function ZQe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=1/0,o,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<a&&(a=s,o=e[i]));return o}function JQe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],a=e[r].y-t[1],o=i*i+a*a,o<n))return e[r];return null}function QQe(e,t){for(var n=e.length,r,i,a;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],a=r*r+i*i,r=e[n].size||1,a<r*r))return e[n];return null}function Dz(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(ux(u),c),Tc(u,c[0]))}function a(u,l){u.beginPath(),t(u,l)}const o=lx(a);function s(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:HQe(a),pick:s,isect:Cz,tip:n}}var eet=Dz("area",MQe,ZQe);function tet(e,t){var n=t.clip;e.save(),$t(n)?(e.beginPath(),n(e),e.clip()):Gue(e,t.group)}function Gue(e,t){e.beginPath(),mz(t)?zv(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Kue(e){const t=su(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function net(e,t){e("transform",Hue(t))}function Xue(e,t){const n=Kue(t);e("d",zv(null,t,n,n))}function ret(e,t){e("class","background"),e("aria-hidden",!0),Xue(e,t)}function iet(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Xue(e,t):e("d","")}function aet(e,t,n){const r=t.clip?vz(n,t,t):null;e("clip-path",r)}function oet(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Tc(e,t),e.translate(t.x||0,t.y||0)}function cx(e,t,n,r){const i=Kue(t);e.beginPath(),zv(e,t,(n||0)+i,(r||0)+i)}const set=lx(cx),uet=lx(cx,!1),cet=lx(cx,!0);function fet(e,t,n){uu(t,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(cx(e,r,i,a),Uv(e,r),r.fill&&ok(e,r,s)&&e.fill(),r.stroke&&!o&&Wv(e,r,s)&&e.stroke()),e.save(),e.translate(i,a),r.clip&&Gue(e,r),n&&n.translate(-i,-a),uu(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,a),e.restore(),o&&r.stroke&&s&&(cx(e,r,i,a),Uv(e,r),Wv(e,r,s)&&e.stroke())})}function det(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;const o=n*e.pixelRatio,s=r*e.pixelRatio;return sk(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,a))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||a<f||a>p))return;if(e.save(),e.translate(c,f),c=i-c,f=a-f,g&&mz(u)&&!cet(e,u,o,s))return e.restore(),null;const m=u.strokeForeground,v=t.interactive!==!1;return v&&m&&u.stroke&&uet(e,u,o,s)?(e.restore(),u):(l=sk(u,y=>het(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&set(e,u,o,s)&&(l=u),e.restore(),l||null)})}function het(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var pet={type:"group",tag:"g",nested:!1,attr:net,bound:oet,draw:fet,pick:det,isect:jue,content:aet,background:ret,foreground:iet},fx={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Rz(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Fz(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Mz(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function lk(e,t){return e==="center"?t/2:e==="right"?t:0}function ck(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function get(e,t,n){const r=Rz(t,n),i=Fz(t,r),a=Mz(t,r),o=(t.x||0)-lk(t.align,i),s=(t.y||0)-ck(t.baseline,a),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,fx["xmlns:xlink"],"xlink:href"),e("transform",Fp(o,s)),e("width",i),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function met(e,t){const n=t.image,r=Fz(t,n),i=Mz(t,n),a=(t.x||0)-lk(t.align,r),o=(t.y||0)-ck(t.baseline,i);return e.set(a,o,a+r,o+i)}function vet(e,t,n){uu(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=Rz(r,this);let a=Fz(r,i),o=Mz(r,i);if(a===0||o===0)return;let s=(r.x||0)-lk(r.align,a),u=(r.y||0)-ck(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=a/c,u+=(o-d)/2,o=d):(d=o*c,s+=(a-d)/2,a=d))),(i.complete||i.toDataURL)&&(Uv(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,a,o))})}var yet={type:"image",tag:"image",nested:!1,attr:get,bound:met,draw:vet,pick:uk(),isect:fs,get:Rz,xOffset:lk,yOffset:ck},bet=Dz("line",PQe,JQe);function xet(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",XQe(t)),e("d",t.path)}function fk(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*yd,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Lv(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),rx(e,u,0,0,a,o),e.rotate(-s),e.translate(-r,-i)):rx(e,u,r,i,a,o)}function wet(e,t){return fk(ux(e,t.angle),t)?e.set(0,0,0,0):Tc(e,t,!0)}var _et={type:"path",tag:"path",nested:!1,attr:xet,bound:wet,draw:Tz(fk),pick:Oz(fk),isect:Az(fk)};function Eet(e,t){e("d",zv(null,t))}function Aet(e,t){var n,r;return Tc(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function Yue(e,t){e.beginPath(),zv(e,t)}var Cet={type:"rect",tag:"path",nested:!1,attr:Eet,bound:Aet,draw:Tz(Yue),pick:Oz(Yue),isect:jue};function ket(e,t){e("transform",Hue(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Tet(e,t){var n,r;return Tc(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Zue(e,t,n){var r,i,a,o;return t.stroke&&Wv(e,t,n)?(r=t.x||0,i=t.y||0,a=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0):!1}function Oet(e,t,n){uu(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&Zue(e,r,i)&&(Uv(e,r),e.stroke())}})}function Iet(e,t,n,r){return e.isPointInStroke?Zue(e,t,1)&&e.isPointInStroke(n,r):!1}var Net={type:"rule",tag:"line",nested:!1,attr:ket,bound:Tet,draw:Oet,pick:uk(Iet),isect:Uue},Det=Nz("shape",$Qe),Ret=Nz("symbol",LQe,Cz);const Jue=Mre();var hl={height:pl,measureWidth:$z,estimateWidth:Pz,width:Pz,canvas:Que};Que(!0);function Que(e){hl.width=e&&wd?$z:Pz}function Pz(e,t){return ele(Sd(e,t),pl(e))}function ele(e,t){return~~(.8*e.length*t)}function $z(e,t){return pl(e)<=0||!(t=Sd(e,t))?0:tle(t,dk(e))}function tle(e,t){const n=`(${t}) ${e}`;let r=Jue.get(n);return r===void 0&&(wd.font=t,r=wd.measureText(e).width,Jue.set(n,r)),r}function pl(e){return e.fontSize!=null?+e.fontSize||0:11}function _d(e){return e.lineHeight!=null?e.lineHeight:pl(e)+2}function Fet(e){return ut(e)?e.length>1?e:e[0]:e}function dx(e){return Fet(e.lineBreak&&e.text&&!ut(e.text)?e.text.split(e.lineBreak):e.text)}function Lz(e){const t=dx(e);return(ut(t)?t.length-1:0)*_d(e)}function Sd(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?Pet(e,n):n}function Met(e){if(hl.width===$z){const t=dk(e);return n=>tle(n,t)}else{const t=pl(e);return n=>ele(n,t)}}function Pet(e,t){var n=+e.limit,r=Met(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",a=e.dir==="rtl",o=0,s=t.length,u;if(n-=r(i),a){for(;o<s;)u=o+s>>>1,r(t.slice(u))>n?o=u+1:s=u;return i+t.slice(o)}else{for(;o<s;)u=1+(o+s>>>1),r(t.slice(0,u))<n?o=u:s=u-1;return t.slice(0,o)+i}}function hx(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function dk(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pl(e)+"px "+hx(e,t)}function Bz(e){var t=e.baseline,n=pl(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*_d(e):t==="line-bottom"?.29*n-.5*_d(e):0)}const $et={left:"start",center:"middle",right:"end"},px=new ci;function hk(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Ip,t+=r*Math.cos(i),n+=r*Math.sin(i)),px.x1=t,px.y1=n,px}function Let(e,t){var n=t.dx||0,r=(t.dy||0)+Bz(t),i=hk(t),a=i.x1,o=i.y1,s=t.angle||0,u;e("text-anchor",$et[t.align]||"start"),s?(u=Fp(a,o)+" "+Iz(s),(n||r)&&(u+=" "+Fp(n,r))):u=Fp(a+n,o+r),e("transform",u)}function zz(e,t,n){var r=hl.height(t),i=t.align,a=hk(t),o=a.x1,s=a.y1,u=t.dx||0,l=(t.dy||0)+Bz(t)-Math.round(.8*r),c=dx(t),f;if(ut(c)?(r+=_d(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,hl.width(t,h)),0)):f=hl.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*yd,o,s);else if(n===2)return e.rotatedPoints(t.angle*yd,o,s);return e}function Bet(e,t,n){uu(t,r=>{var i=r.opacity==null?1:r.opacity,a,o,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=dk(r),e.textAlign=r.align||"left",a=hk(r),o=a.x1,s=a.y1,r.angle&&(e.save(),e.translate(o,s),e.rotate(r.angle*yd),o=s=0),o+=r.dx||0,s+=(r.dy||0)+Bz(r),c=dx(r),Uv(e,r),ut(c))for(l=_d(r),u=0;u<c.length;++u)f=Sd(r,c[u]),r.fill&&ok(e,r,i)&&e.fillText(f,o,s),r.stroke&&Wv(e,r,i)&&e.strokeText(f,o,s),s+=l;else f=Sd(r,c),r.fill&&ok(e,r,i)&&e.fillText(f,o,s),r.stroke&&Wv(e,r,i)&&e.strokeText(f,o,s);r.angle&&e.restore()}})}function zet(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=hk(t),s=o.x1,u=o.y1,l=zz(px,t,1),c=-t.angle*yd,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(s-f*s+d*u),p=d*i+f*a+(u-d*s-f*u);return l.contains(h,p)}function jet(e,t){const n=zz(px,e,2);return jv(t,n[0],n[1],n[2],n[3])||jv(t,n[0],n[1],n[4],n[5])||jv(t,n[4],n[5],n[6],n[7])||jv(t,n[2],n[3],n[6],n[7])}var Uet={type:"text",tag:"text",nested:!1,attr:Let,bound:zz,draw:Bet,pick:uk(zet),isect:jet},Wet=Dz("trail",BQe,QQe),Wo={arc:YQe,area:eet,group:pet,image:yet,line:bet,path:_et,rect:Cet,rule:Net,shape:Det,symbol:Ret,text:Uet,trail:Wet};function jz(e,t,n){var r=Wo[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new ci),e,n)}var nle={mark:null};function rle(e,t,n){var r=Wo[e.marktype],i=r.bound,a=e.items,o=a&&a.length,s,u,l,c;if(r.nested)return o?l=a[0]:(nle.mark=e,l=nle),c=jz(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new ci,o)for(s=0,u=a.length;s<u;++s)t.union(jz(a[s],i,n));return e.bounds=t}const Vet=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function ile(e,t){return JSON.stringify(e,Vet,t)}function ale(e){const t=typeof e=="string"?JSON.parse(e):e;return ole(t)}function ole(e){var t=e.marktype,n=e.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&ole(n[i]);return t&&rle(e),e}function Uz(e){arguments.length?this.root=ale(e):(this.root=sle({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ek(this.root)])}Uz.prototype={toJSON(e){return ile(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=sle(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function sle(e,t){const n={bounds:new ci,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ed(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Wz(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function co(e,t,n,r){var i=e.childNodes[t],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=Ed(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function lu(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function ule(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function pk(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function qet(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Wo[i.marktype]).tip){for(o=pk(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=a.tip(i.items,o)}return e}function Ad(e,t){this._active=null,this._handlers={},this._loader=e||aC(),this._tooltip=t||Het}function Het(e,t,n,r){e.element().setAttribute("title",r||"")}Ad.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),a=Ed(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=qet(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}};function gl(e){this._el=null,this._bgcolor=null,this._loader=new yz(e)}gl.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Get="keydown",Ket="keypress",Xet="keyup",lle="dragenter",gk="dragleave",cle="dragover",Vz="mousedown",Yet="mouseup",mk="mousemove",gx="mouseout",fle="mouseover",vk="click",Zet="dblclick",Jet="wheel",dle="mousewheel",yk="touchstart",bk="touchmove",xk="touchend",Qet=[Get,Ket,Xet,lle,gk,cle,Vz,Yet,mk,gx,fle,vk,Zet,Jet,dle,yk,bk,xk],qz=mk,mx=gx,Hz=vk;function vx(e,t){Ad.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const ett=e=>e===yk||e===bk||e===xk?[yk,bk,xk]:[e];function hle(e,t){ett(t).forEach(n=>ttt(e,n))}function ttt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function ple(e,t,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function gle(e){return function(t){this.fire(e,t),this._active=null}}$e(vx,Ad,{initialize(e,t,n){return this._canvas=e&&Wz(e,"canvas"),[vk,Vz,mk,gx,gk].forEach(r=>hle(this,r)),Ad.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Qet,DOMMouseScroll(e){this.fire(dle,e)},mousemove:ple(mk,fle,gx),dragover:ple(cle,lle,gk),mouseout:gle(gx),dragleave:gle(gk),mousedown(e){this._down=this._active,this.fire(Vz,e)},click(e){this._down===this._active&&(this.fire(vk,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(yk,e,!0)},touchmove(e){this.fire(bk,e,!0)},touchend(e){this.fire(xk,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===Hz&&r&&r.href?this.handleHref(t,r,r.href):(e===qz||e===mx)&&this.handleTooltip(t,r,e!==mx),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(hle(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=pk(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const a=this.context();return Wo[e.marktype].pick.call(this,a,e,t,n,r,i)}});function ntt(){return typeof window!="undefined"&&window.devicePixelRatio||1}var rtt=ntt();function itt(e,t,n,r,i,a){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=o?rtt:i;e.width=t*u,e.height=n*u;for(const l in a)s[l]=a[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function wk(e){gl.call(this,e),this._options={},this._redraw=!1,this._dirty=new ci,this._tempb=new ci}const mle=gl.prototype,att=(e,t,n)=>new ci().set(0,0,t,n).translate(-e[0],-e[1]);function ott(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}$e(wk,gl,{initialize(e,t,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Tv(1,1,this._options.type),e&&this._canvas&&(lu(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),mle.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(mle.resize.call(this,e,t,n,r),this._canvas)itt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||Se("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=att(n,r,i);t.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):ott(t,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),a.clear(),this},draw(e,t,n){const r=Wo[t.marktype];t.clip&&tet(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(e,t,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,r))}});function Gz(e,t){Ad.call(this,e,t);const n=this;n._hrefHandler=Kz(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=Kz(n,(r,i)=>{n.handleTooltip(r,i,r.type!==mx)})}const Kz=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};$e(Gz,Ad,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(Hz,this._hrefHandler),r.removeEventListener(qz,this._tooltipHandler),r.removeEventListener(mx,this._tooltipHandler)),this._svg=r=e&&Wz(e,"svg"),r&&(r.addEventListener(Hz,this._hrefHandler),r.addEventListener(qz,this._tooltipHandler),r.addEventListener(mx,this._tooltipHandler)),Ad.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const a={type:e,handler:t,listener:Kz(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const vle="aria-hidden",Xz="aria-label",Yz="role",Zz="aria-roledescription",yle="graphics-object",Jz="graphics-symbol",ble=(e,t,n)=>({[Yz]:e,[Zz]:t,[Xz]:n||void 0}),stt=iu(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),xle={axis:{desc:"axis",caption:ctt},legend:{desc:"legend",caption:ftt},"title-text":{desc:"title",caption:e=>`Title text '${Ele(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Ele(e)}'`}},wle={ariaRole:Yz,ariaRoleDescription:Zz,description:Xz};function _le(e,t){const n=t.aria===!1;if(e(vle,n||void 0),n||t.description==null)for(const r in wle)e(wle[r],void 0);else{const r=t.mark.marktype;e(Xz,t.description),e(Yz,t.ariaRole||(r==="group"?yle:Jz)),e(Zz,t.ariaRoleDescription||`${r} mark`)}}function Sle(e){return e.aria===!1?{[vle]:!0}:stt[e.role]?null:xle[e.role]?ltt(e,xle[e.role]):utt(e)}function utt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return ble(n?yle:Jz,`${t} mark container`,e.description)}function ltt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return ble(t.role||Jz,t.desc,n.description||r(n))}catch(n){return null}}function Ele(e){return xt(e.text).join(" ")}function ctt(e){const t=e.datum,n=e.orient,r=t.title?Ale(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),s=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${$v(s)?"discrete":s} scale with ${wue(o,a,e)}`}function ftt(e){const t=e.datum,n=t.title?Ale(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,a=Object.keys(i),o=e.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return htt(r)+(n?` titled '${n}'`:"")+` for ${dtt(a)} with ${wue(u,s,e)}`}function Ale(e){try{return xt(sn(e.items).items[0].text).join(" ")}catch(t){return null}}function dtt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+sn(e)}function htt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Cle=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ptt=e=>Cle(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Qz(){let e="",t="",n="";const r=[],i=()=>t=n="",a=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${ptt(l)}"`),s),s={open(u,...l){a(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:o,text:u=>(n+=Cle(u),s),toString:()=>e};return s}const kle=e=>Tle(Qz(),e)+"";function Tle(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?e.text(a.nodeValue):Tle(e,a)}}return e.close()}const _k={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Ole={fill:"none","stroke-miterlimit":10},yx=0,Ile="http://www.w3.org/2000/xmlns/",fi=fx.xmlns;function e5(e){gl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const t5=gl.prototype;$e(e5,gl,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=co(e,0,"svg",fi),this._svg.setAttributeNS(Ile,"xmlns",fi),this._svg.setAttributeNS(Ile,"xmlns:xlink",fx["xmlns:xlink"]),this._svg.setAttribute("version",fx.version),this._svg.setAttribute("class","marks"),lu(e,1),this._root=co(this._svg,yx,"g",fi),Cd(this._root,Ole),lu(this._svg,yx+1)),this.background(this._bgcolor),t5.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),t5.background.apply(this,arguments)},resize(e,t,n,r){return t5.resize.call(this,e,t,n,r),this._svg&&(Cd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=co(e,yx,"rect",fi),Cd(n,{width:this._width,height:this._height,fill:t}));const r=kle(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),lu(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=e.length;o<s;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Wo[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Nle(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Nle(n,t)):this._update(a,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Wo[t.marktype],a=t.interactive===!1?"none":null,o=i.tag==="g";let s=null,u=0;const l=Dle(t,e,n,"g",r);l.setAttribute("class",ule(t));const c=Sle(t);for(const d in c)Na(l,d,c[d]);o||Na(l,"pointer-events",a),Na(l,"clip-path",t.clip?vz(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=Dle(d,l,s,i.tag,r);h&&(this._update(i,p,d),o&&vtt(this,p,d)),s=p,++u};return i.nested?t.items.length&&f(t.items[0]):uu(t,f),lu(l,u),l},_update(e,t,n){Oc=t,ra=t.__values__,_le(bx,n),e.attr(bx,n,this);const r=btt[e.type];r&&r.call(this,e,t,n),Oc&&this.style(Oc,n)},style(e,t){if(t!=null)for(const n in _k){let r=n==="font"?hx(t):t[n];if(r===ra[n])continue;const i=_k[n];r==null?e.removeAttribute(i):(fz(r)&&(r=Sue(r,this._defs.gradient,Rle())),e.setAttribute(i,r+"")),ra[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=co(e,yx+1,"defs",fi)),r=gtt(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=co(e,yx+1,"defs",fi)),r=mtt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):lu(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function Nle(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function gtt(e,t,n){let r,i,a;if(t.gradient==="radial"){let o=co(e,n++,"pattern",fi);Cd(o,{id:YC+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=co(o,0,"rect",fi),Cd(o,{width:1,height:1,fill:`url(${Rle()}#${t.id})`}),e=co(e,n++,"radialGradient",fi),Cd(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=co(e,n++,"linearGradient",fi),Cd(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)a=co(e,r,"stop",fi),a.setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return lu(e,r),n}function mtt(e,t,n){let r;return e=co(e,n,"clipPath",fi),e.setAttribute("id",t.id),t.path?(r=co(e,0,"path",fi),r.setAttribute("d",t.path)):(r=co(e,0,"rect",fi),Cd(r,{x:0,y:0,width:t.width,height:t.height})),lu(e,1),n+1}function vtt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;uu(n,a=>{r=e.mark(t,a,r),++i}),lu(t,1+i)}function Dle(e,t,n,r,i){let a=e._svg,o;if(!a&&(o=t.ownerDocument,a=Ed(o,r,fi),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},r==="g"))){const s=Ed(o,"path",fi);a.appendChild(s),s.__data__=e;const u=Ed(o,"g",fi);a.appendChild(u),u.__data__=e;const l=Ed(o,"path",fi);a.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||ytt(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function ytt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Oc=null,ra=null;const btt={group(e,t,n){const r=Oc=t.childNodes[2];ra=r.__values__,e.foreground(bx,n,this),ra=t.__values__,Oc=t.childNodes[1],e.content(bx,n,this);const i=Oc=t.childNodes[0];e.background(bx,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==ra.events&&(Na(r,"pointer-events",a),Na(i,"pointer-events",a),ra.events=a),n.strokeForeground&&n.stroke){const o=n.fill;Na(r,"display",null),this.style(i,n),Na(i,"stroke",null),o&&(n.fill=null),ra=r.__values__,this.style(r,n),o&&(n.fill=o),Oc=null}else Na(r,"display","none")},image(e,t,n){n.smooth===!1?(n5(t,"image-rendering","optimizeSpeed"),n5(t,"image-rendering","pixelated")):n5(t,"image-rendering",null)},text(e,t,n){const r=dx(n);let i,a,o,s;ut(r)?(a=r.map(u=>Sd(n,u)),i=a.join(`
`),i!==ra.text&&(lu(t,0),o=t.ownerDocument,s=_d(n),a.forEach((u,l)=>{const c=Ed(o,"tspan",fi);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),ra.text=i)):(a=Sd(n,r),a!==ra.text&&(t.textContent=a,ra.text=a)),Na(t,"font-family",hx(n)),Na(t,"font-size",pl(n)+"px"),Na(t,"font-style",n.fontStyle),Na(t,"font-variant",n.fontVariant),Na(t,"font-weight",n.fontWeight)}};function bx(e,t,n){t!==ra[e]&&(n?xtt(Oc,e,t,n):Na(Oc,e,t),ra[e]=t)}function n5(e,t,n){n!==ra[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ra[t]=n)}function Cd(e,t){for(const n in t)Na(e,n,t[n])}function Na(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function xtt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Rle(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function r5(e){gl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}$e(r5,gl,{svg(){return this._text},_render(e){const t=Qz();t.open("svg",Rt({},fx,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Ole,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Wo[t.marktype],r=n.tag,i=[_le,n.attr];e.open("g",{class:ule(t),"clip-path":t.clip?vz(this,t,t.group):null},Sle(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const a=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=dx(o);if(ut(u)){const l={x:0,dy:_d(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Sd(o,u[c])).close()}else e.text(Sd(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),uu(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&a(t.items[0]):uu(t,a),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},a=(o,s,u,l)=>{i[l||o]=s};return Array.isArray(n)?n.forEach(o=>o(a,t,this)):n(a,t,this),r&&wtt(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const a=t[i],o=a.stops;a.gradient==="radial"?(e.open("pattern",{id:YC+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let s=0;s<o.length;++s)e.open("stop",{offset:o[s].offset,"stop-color":o[s].color}).close();e.close()}for(const i in n){const a=n[i];e.open("clipPath",{id:i}),a.path?e.open("path",{d:a.path}).close():e.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),e.close()}e.close()}}});function wtt(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=hx(t),e["font-size"]=pl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in _k){let o=t[a];const s=_k[a];o==="transparent"&&(s==="fill"||s==="stroke")||o!=null&&(fz(o)&&(o=Sue(o,i.gradient,"")),e[s]=o)}return e}const Fle="canvas",Mle="png",Ple="svg",$le="none",kd={Canvas:Fle,PNG:Mle,SVG:Ple,None:$le},Vv={};Vv[Fle]=Vv[Mle]={renderer:wk,headless:wk,handler:vx},Vv[Ple]={renderer:e5,headless:r5,handler:Gz},Vv[$le]={};function Sk(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Vv[e]=t,this):Vv[e]}function Lle(e,t,n){const r=[],i=new ci().union(t),a=e.marktype;return a?Ble(e,i,n,r):a==="group"?zle(e,i,n,r):Se("Intersect scene must be mark node or group item.")}function Ble(e,t,n,r){if(_tt(e,t,n)){const i=e.items,a=e.marktype,o=i.length;let s=0;if(a==="group")for(;s<o;++s)zle(i[s],t,n,r);else for(const u=Wo[a].isect;s<o;++s){const l=i[s];jle(l,t,u)&&r.push(l)}}return r}function _tt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function zle(e,t,n,r){n&&n(e.mark)&&jle(e,t,Wo.group.isect)&&r.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let u=0;u<a;++u)Ble(i[u],t,n,r);t.translate(o,s)}return r}function jle(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const i5=new ci;function Ule(e){const t=e.clip;if($t(t))t(ux(i5.clear()));else if(t)i5.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(i5)}const Stt=1e-9;function a5(e,t,n){return e===t?!0:n==="path"?Wle(e,t):e instanceof Date&&t instanceof Date?+e==+t:ed(e)&&ed(t)?Math.abs(e-t)<=Stt:!e||!t||!Nt(e)&&!Nt(t)?e==t:Ett(e,t)}function Wle(e,t){return a5(Lv(e),Lv(t))}function Ett(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!a5(e[i],t[i],i))return!1;return typeof e==typeof t}function Att(){Fue(),QJe()}const qv="top",cu="left",fu="right",Td="bottom",Ctt="top-left",ktt="top-right",Ttt="bottom-left",Ott="bottom-right",o5="start",s5="middle",Da="end",Itt="x",Ntt="y",Ek="group",u5="axis",l5="title",Dtt="frame",Rtt="scope",c5="legend",Vle="row-header",qle="row-footer",Hle="row-title",Gle="column-header",Kle="column-footer",Xle="column-title",Ftt="padding",Mtt="symbol",Yle="fit",Ptt="fit-x",$tt="fit-y",Ltt="pad",f5="none",Ak="all",d5="each",h5="flush",Od="column",Id="row";function Zle(e){ve.call(this,null,e)}$e(Zle,ve,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,a=Wo[i],o=a.bound;let s=r.bounds,u;if(a.nested)r.items.length&&n.dirty(r.items[0]),s=Ck(r,o),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===Ek||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(Ck(l,o))),r.role){case u5:case c5:case l5:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Ck(l,o))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Ck(l,o))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return Ule(r),t.modifies("bounds")}});function Ck(e,t,n){return t(e.bounds.clear(),e,n)}const Jle=":vega_identifier:";function p5(e){ve.call(this,0,e)}p5.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},$e(p5,ve,{transform(e,t){const n=Btt(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),t}});function Btt(e){return e._signals[Jle]||(e._signals[Jle]=e.add(0))}function Qle(e){ve.call(this,null,e)}$e(Qle,ve,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,ztt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===Ek?ek:QC;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function ztt(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function ece(e){ve.call(this,null,e)}const tce={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!nce(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},nce=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),rce=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n)if(nce(i,a=e[n].bounds,t))return!0},jtt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},Utt=(e,t,n)=>{var r=e.range(),i=new ci;return t===qv||t===Td?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},ice=e=>(e.forEach(t=>t.opacity=1),e),ace=(e,t)=>e.reflow(t.modified()).modifies("opacity");$e(ece,ve,{transform(e,t){const n=tce[e.method]||tce.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(ice(i),t=ace(t,e)),t;if(i=i.filter(jtt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),a=ice(i),t=ace(t,e),a.length>=3&&rce(a,r)){do a=n(a,r);while(a.length>=3&&rce(a,r));a.length<3&&!sn(i).opacity&&(a.length>1&&(sn(a).opacity=0),sn(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=Utt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const s=a[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function oce(e){ve.call(this,null,e)}$e(oce,ve,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ia=new ci;function Hv(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Wtt(e){var t=e.items[0].orient;return t===cu||t===fu}function Vtt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function qtt(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,s=i.orient,u=Vtt(a),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&Lz(p),y=0,b=0,x,w;switch(ia.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case qv:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&kk(e,p,w,g,v,0,-1,m);break;case cu:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&kk(e,p,w,g,v,1,-1,m);break;case fu:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&kk(e,p,w,g,v,1,1,m);break;case Td:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&kk(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Tc(m.translate(y,b),i),Hv(i,"x",y+o)|Hv(i,"y",b+o)&&(i.bounds=ia,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function kk(e,t,n,r,i,a,o,s){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),a?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const sce=(e,t)=>Math.floor(Math.min(e,t)),uce=(e,t)=>Math.ceil(Math.max(e,t));function Htt(e){var t=e.items,n=t.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],a=i.items,i.marktype===Ek)switch(i.role){case u5:case c5:case l5:break;case Vle:o.rowheaders.push(...a);break;case qle:o.rowfooters.push(...a);break;case Gle:o.colheaders.push(...a);break;case Kle:o.colfooters.push(...a);break;case Hle:o.rowtitle=a[0];break;case Xle:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function Gtt(e){return new ci().set(0,0,e.width||0,e.height||0)}function Ktt(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function dr(e,t,n){const r=Nt(e)?e[t]:e;return r??(n!==void 0?n:0)}function lce(e){return e<0?Math.ceil(-e):0}function cce(e,t,n){var r=!n.nodirty,i=n.bounds===h5?Gtt:Ktt,a=ia.set(0,0,0,0),o=dr(n.align,Od),s=dr(n.align,Id),u=dr(n.padding,Od),l=dr(n.padding,Id),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),x=Array(d),w=Array(d),S,A,_,E,C,k,T,I,N,O,D;for(A=0;A<c;++A)p[A]=0;for(A=0;A<f;++A)v[A]=0;for(A=0;A<d;++A)k=t[A],C=w[A]=i(k),k.x=k.x||0,b[A]=0,k.y=k.y||0,x[A]=0,_=A%c,E=~~(A/c),g=Math.max(g,T=Math.ceil(C.x2)),y=Math.max(y,I=Math.ceil(C.y2)),p[_]=Math.max(p[_],T),v[E]=Math.max(v[E],I),h[A]=u+lce(C.x1),m[A]=l+lce(C.y1),r&&e.dirty(t[A]);for(A=0;A<d;++A)A%c==0&&(h[A]=0),A<c&&(m[A]=0);if(o===d5)for(_=1;_<c;++_){for(D=0,A=_;A<d;A+=c)D<h[A]&&(D=h[A]);for(A=_;A<d;A+=c)h[A]=D+p[_-1]}else if(o===Ak){for(D=0,A=0;A<d;++A)A%c&&D<h[A]&&(D=h[A]);for(A=0;A<d;++A)A%c&&(h[A]=D+g)}else for(o=!1,_=1;_<c;++_)for(A=_;A<d;A+=c)h[A]+=p[_-1];if(s===d5)for(E=1;E<f;++E){for(D=0,A=E*c,S=A+c;A<S;++A)D<m[A]&&(D=m[A]);for(A=E*c;A<S;++A)m[A]=D+v[E-1]}else if(s===Ak){for(D=0,A=c;A<d;++A)D<m[A]&&(D=m[A]);for(A=c;A<d;++A)m[A]=D+y}else for(s=!1,E=1;E<f;++E)for(A=E*c,S=A+c;A<S;++A)m[A]+=v[E-1];for(N=0,A=0;A<d;++A)N=h[A]+(A%c?N:0),b[A]+=N-t[A].x;for(_=0;_<c;++_)for(O=0,A=_;A<d;A+=c)O+=m[A],x[A]+=O-t[A].y;if(o&&dr(n.center,Od)&&f>1)for(A=0;A<d;++A)C=o===Ak?g:p[A%c],N=C-w[A].x2-t[A].x-b[A],N>0&&(b[A]+=N/2);if(s&&dr(n.center,Id)&&c!==1)for(A=0;A<d;++A)C=s===Ak?y:v[~~(A/c)],O=C-w[A].y2-t[A].y-x[A],O>0&&(x[A]+=O/2);for(A=0;A<d;++A)a.union(w[A].translate(b[A],x[A]));switch(N=dr(n.anchor,Itt),O=dr(n.anchor,Ntt),dr(n.anchor,Od)){case Da:N-=a.width();break;case s5:N-=a.width()/2}switch(dr(n.anchor,Id)){case Da:O-=a.height();break;case s5:O-=a.height()/2}for(N=Math.round(N),O=Math.round(O),a.clear(),A=0;A<d;++A)t[A].mark.bounds.clear();for(A=0;A<d;++A)k=t[A],k.x+=b[A]+=N,k.y+=x[A]+=O,a.union(k.mark.bounds.union(k.bounds.translate(b[A],x[A]))),r&&e.dirty(k);return a}function Xtt(e,t,n){var r=Htt(t),i=r.marks,a=n.bounds===h5?Ytt:Ztt,o=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,p,g,m;const v=cce(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=dr(n.headerBand,Id,null),c=Tk(e,r.rowheaders,i,s,u,-dr(o,"rowHeader"),sce,0,a,"x1",0,s,1,g)),r.colheaders&&(g=dr(n.headerBand,Od,null),f=Tk(e,r.colheaders,i,s,s,-dr(o,"columnHeader"),sce,1,a,"y1",0,1,s,g)),r.rowfooters&&(g=dr(n.footerBand,Id,null),d=Tk(e,r.rowfooters,i,s,u,dr(o,"rowFooter"),uce,0,a,"x2",s-1,s,1,g)),r.colfooters&&(g=dr(n.footerBand,Od,null),h=Tk(e,r.colfooters,i,s,s,dr(o,"columnFooter"),uce,1,a,"y2",l-s,1,s,g)),r.rowtitle&&(p=dr(n.titleAnchor,Id),m=dr(o,"rowTitle"),m=p===Da?d+m:c-m,g=dr(n.titleBand,Id,.5),fce(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=dr(n.titleAnchor,Od),m=dr(o,"columnTitle"),m=p===Da?h+m:f-m,g=dr(n.titleBand,Od,.5),fce(e,r.coltitle,m,1,v,g))}function Ytt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Ztt(e,t){return e.bounds[t]}function Tk(e,t,n,r,i,a,o,s,u,l,c,f,d,h){var p=n.length,g=0,m=0,v,y,b,x,w,S,A,_,E;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=o(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=a,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(S=t[y],w=S.mark.bounds,b=v;b>=0&&(A=n[b])==null;b-=d);s?(_=h==null?A.x:Math.round(A.bounds.x1+h*A.bounds.width()),E=g):(_=g,E=h==null?A.y:Math.round(A.bounds.y1+h*A.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),E-(S.y||0))),S.x=_,S.y=E,e.dirty(S),m=o(m,w[l])}return m}function fce(e,t,n,r,i,a){if(!!t){e.dirty(t);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}function Jtt(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Qtt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function ent(e,t,n,r,i,a,o){const s=Jtt(n,t),u=Qtt(e,s("offset",0)),l=s("anchor",o5),c=l===Da?1:l===s5?.5:0,f={align:d5,bounds:s("bounds",h5),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case cu:f.anchor={x:Math.floor(r.x1)-u,column:Da,y:c*(o||r.height()+2*r.y1),row:l};break;case fu:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case qv:f.anchor={y:Math.floor(i.y1)-u,row:Da,x:c*(a||i.width()+2*i.x1),column:l};break;case Td:f.anchor={y:Math.ceil(i.y2)+u,x:c*(a||i.width()+2*i.x1),column:l};break;case Ctt:f.anchor={x:u,y:u};break;case ktt:f.anchor={x:a-u,y:u,column:Da};break;case Ttt:f.anchor={x:u,y:o-u,row:Da};break;case Ott:f.anchor={x:a-u,y:o-u,column:Da,row:Da};break}return f}function tnt(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),rnt(e,n,n.items[0].items[0]),a=nnt(n,a),u=2*n.padding,l=2*n.padding,a.empty()||(u=Math.ceil(a.width()+u),l=Math.ceil(a.height()+l)),r.type===Mtt&&int(n.items[0].items[0].items[0].items),i!==f5&&(n.x=o=0,n.y=s=0),n.width=u,n.height=l,Tc(a.set(o,s,o+u,s+l),n),n.mark.bounds.clear().union(a),n}function nnt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function rnt(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title)(i||a)&&xx(e,n,i,a);else{var o=t.items[1].items[0],s=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case cu:i+=Math.ceil(o.bounds.width())+u;break;case fu:case Td:break;default:a+=o.bounds.height()+u}switch((i||a)&&xx(e,n,i,a),o.orient){case cu:c+=Gv(t,n,o,s,1,1);break;case fu:l+=Gv(t,n,o,Da,0,0)+u,c+=Gv(t,n,o,s,1,1);break;case Td:l+=Gv(t,n,o,s,0,0),c+=Gv(t,n,o,Da,-1,0,1)+u;break;default:l+=Gv(t,n,o,s,0,0)}(l||c)&&xx(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(xx(e,n,-l,0),xx(e,o,-l,0))}}function Gv(e,t,n,r,i,a,o){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(a||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&a?c:0,d=u&&a?0:c,h=i<=0?0:Lz(n);return Math.round(r===o5?f:r===Da?d-h:.5*(c-h))}function xx(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function int(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function ant(e,t,n,r,i){var a=t.items[0],o=a.frame,s=a.orient,u=a.anchor,l=a.offset,c=a.padding,f=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=s===cu||s===fu?r:n,p=0,g=0,m=0,v=0,y=0,b;if(o!==Ek?s===cu?(p=i.y2,h=i.y1):s===fu?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):s===cu&&(p=r,h=0),b=u===o5?p:u===Da?h:(p+h)/2,d&&d.text){switch(s){case qv:case Td:y=f.bounds.height()+c;break;case cu:v=f.bounds.width()+c;break;case fu:v=-f.bounds.width()-c;break}ia.clear().union(d.bounds),ia.translate(v-(d.x||0),y-(d.y||0)),Hv(d,"x",v)|Hv(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(ia),d.mark.bounds.clear().union(ia),e.dirty(d)),ia.clear().union(d.bounds)}else ia.clear();switch(ia.union(f.bounds),s){case qv:g=b,m=i.y1-ia.height()-l;break;case cu:g=i.x1-ia.width()-l,m=b;break;case fu:g=i.x2+ia.width()+l,m=b;break;case Td:g=b,m=i.y2+l;break;default:g=a.x,m=a.y}return Hv(a,"x",g)|Hv(a,"y",m)&&(ia.translate(g,m),e.dirty(a),a.bounds.clear().union(ia),t.bounds.clear().union(ia),e.dirty(a)),a.bounds}function dce(e){ve.call(this,null,e)}$e(dce,ve,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Xtt(n,r,e.layout),snt(n,r,e)}),ont(e.mark.group)?t.reflow():t}});function ont(e){return e&&e.mark.role!=="legend-entry"}function snt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=new ci().set(0,0,i,a),s=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case u5:h=Wtt(f)?s:u,h.union(qtt(e,f,i,a));break;case l5:c=f;break;case c5:l.push(tnt(e,f));break;case Dtt:case Rtt:case Vle:case qle:case Hle:case Gle:case Kle:case Xle:s.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{d=v.orient||fu,d!==f5&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];cce(e,y,ent(y,v,n.legends,s,u,i,a))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&n.autosize.type===Yle)switch(v.orient){case cu:case fu:o.add(y.x1,0).add(y.x2,0);break;case qv:case Td:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(s).union(u),c&&o.union(ant(e,c,i,a,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),unt(e,t,o,n)}function unt(e,t,n,r){const i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;let o=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===Ftt){const p=e.padding();o-=p.left+p.right,s-=p.top+p.bottom}a===f5?(l=0,f=0,u=o,c=s):a===Yle?(u=Math.max(0,o-l-d),c=Math.max(0,s-f-h)):a===Ptt?(u=Math.max(0,o-l-d),s=c+f+h):a===$tt?(o=u+l+d,c=Math.max(0,s-f-h)):a===Ltt&&(o=u+l+d,s=c+f+h),e._resizeView(o,s,u,c,[l,f],i.resize)}var lnt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:Zle,identifier:p5,mark:Qle,overlap:ece,render:oce,viewlayout:dce});function hce(e){ve.call(this,null,e)}$e(hce,ve,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,s=uz(a,o,e.minstep),u=e.format||pue(n,a,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?hue(a,e.values,s):lz(a,s);return i&&(r.rem=i),i=l.map((c,f)=>In({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(In({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function pce(e){ve.call(this,null,e)}function cnt(){return In({})}function fnt(e){const t=pv().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}$e(pce,ve,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||cnt,a=e.key||lt,o=this.value;return ut(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(a))&&Se("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=fnt(a)),t.visit(t.ADD,s=>{const u=a(s);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),o.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=a(s),l=o.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=a(s),l=o.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function gce(e){ve.call(this,null,e)}$e(gce,ve,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,a=t.encode;if(ut(a))if(n.changed()||a.every(f=>i[f]))a=a[0],n.encode=null;else return t.StopPropagation;var o=a==="enter",s=i.update||Jf,u=i.enter||Jf,l=i.exit||Jf,c=(a&&!o?i[a]:s)||Jf;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Jf&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Jf&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Jf){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function mce(e){ve.call(this,[],e)}$e(mce,ve,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||XC,o=e.scale,s=+e.limit,u=uz(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===XC,c=e.format||yue(n,o,u,a,e.formatSpecifier,e.formatType,l),f=e.values||vue(o,u),d,h,p,g,m;return i&&(r.rem=i),a===XC?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,$t(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=Ji(g=p||8),i=i.map((v,y)=>In({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(In({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):a===zJe?(d=o.domain(),h=lue(o,d[0],sn(d)),f.length<3&&!e.values&&d[0]!==sn(d)&&(f=[d[0],sn(d)]),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=ZJe(o),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const dnt=e=>e.source.x,hnt=e=>e.source.y,pnt=e=>e.target.x,gnt=e=>e.target.y;function g5(e){ve.call(this,{},e)}g5.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},$e(g5,ve,{transform(e,t){var n=e.sourceX||dnt,r=e.sourceY||hnt,i=e.targetX||pnt,a=e.targetY||gnt,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=xce.get(u+"-"+s)||xce.get(u);return l||Se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),a(c))}),t.reflow(e.modified()).modifies(o)}});const vce=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,mnt=(e,t,n,r)=>vce(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),yce=(e,t,n,r)=>{var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,s=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+s+" 0 1 "+n+","+r},vnt=(e,t,n,r)=>yce(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),bce=(e,t,n,r)=>{const i=n-e,a=r-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},ynt=(e,t,n,r)=>bce(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),bnt=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,xnt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,wnt=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+r*o+","+r*s},_nt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Snt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Ent=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s},xce=pv({line:vce,"line-radial":mnt,arc:yce,"arc-radial":vnt,curve:bce,"curve-radial":ynt,"orthogonal-horizontal":bnt,"orthogonal-vertical":xnt,"orthogonal-radial":wnt,"diagonal-horizontal":_nt,"diagonal-vertical":Snt,"diagonal-radial":Ent});function m5(e){ve.call(this,null,e)}m5.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},$e(m5,ve,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||hv,o=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(a),c=l.length,f=o,d=(s-o)/iie(l),h=zo(c),p,g,m;for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Ant=5;function Cnt(e){const t=e.type;return!e.bins&&(t===Fv||t===J1||t===Q1)}function wce(e){return iz(e)&&e!==cl}const knt=iu(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function _ce(e){ve.call(this,null,e),this.modified(!0)}$e(_ce,ve,{transform(e,t){var n=t.dataflow,r=this.value,i=Tnt(e);(!r||i!==r.type)&&(this.value=r=Sn(i)());for(i in e)if(!knt[i]){if(i==="padding"&&wce(r.type))continue;$t(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return Fnt(r,e,Rnt(r,e,Int(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Tnt(e){var t=e.type,n="",r;return t===cl?cl+"-"+Fv:(Ont(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?cl+"-":r===3?Mv+"-":""),(n+t||Fv).toLowerCase())}function Ont(e){const t=e.type;return iz(t)&&t!==kp&&t!==Tp&&(e.scheme||e.range&&e.range.length&&e.range.every(Bn))}function Int(e,t,n){const r=Nnt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===void 0&&Cnt(e),s,u;if(!i)return 0;if(wce(a)&&t.padding&&i[0]!==sn(i)&&(i=Dnt(a,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(Sce(a,i,n)),a===QB&&e.unknown(t.domainImplicit?_B:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&uz(e,t.nice)||null),i.length}function Nnt(e,t,n){return t?(e.domain(Sce(e.type,t,n)),t.length):-1}function Dnt(e,t,n,r,i,a){var o=Math.abs(sn(n)-n[0]),s=o/(o-2*r),u=e===Cc?xL(t,null,s):e===Q1?GA(t,null,s,.5):e===J1?GA(t,null,s,i||1):e===VC?wL(t,null,s,a||1):bL(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Sce(e,t,n){if(iue(e)){var r=Math.abs(t.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+gt(t))}return t}function Rnt(e,t,n){let r=t.bins;if(r&&!ut(r)){const i=e.domain(),a=i[0],o=sn(i),s=r.step;let u=r.start==null?a:r.start,l=r.stop==null?o:r.stop;s||Se("Scale bins parameter missing step property."),u<a&&(u=s*Math.ceil(a/s)),l>o&&(l=s*Math.floor(o/s)),r=zo(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===tz&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function Fnt(e,t,n){var r=e.type,i=t.round||!1,a=t.range;if(t.rangeStep!=null)a=Mnt(r,t,n);else if(t.scheme&&(a=Pnt(r,t,n),$t(a))){if(e.interpolator)return e.interpolator(a);Se("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&aue(r))return e.interpolator(KC(v5(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(oz(t.interpolate,t.interpolateGamma)):$t(e.round)?e.round(i):$t(e.rangeRound)&&e.interpolate(i?X1:md),a&&e.range(v5(a,t.reverse))}function Mnt(e,t,n){e!==eue&&e!==ez&&Se("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===ez?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*JB(n,i,r)]}function Pnt(e,t,n){var r=t.schemeExtent,i,a;return ut(t.scheme)?a=KC(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),a=sz(i),a||Se("Unrecognized scheme name: ".concat(t.scheme))),n=e===HC?n+1:e===tz?n-1:e===Pv||e===qC?+t.schemeCount||Ant:n,aue(e)?Ece(a,r,t.reverse):$t(a)?uue(Ece(a,r),n):e===QB?a:a.slice(0,n)}function Ece(e,t,n){return $t(e)&&(t||n)?sue(e,v5(t||[0,1],n)):e}function v5(e,t){return t?e.slice().reverse():e}function Ace(e){ve.call(this,null,e)}$e(Ace,ve,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(bp(e.sort)),this.modified(n),t}});const Cce="zero",kce="center",Tce="normalize",Oce=["y0","y1"];function y5(e){ve.call(this,null,e)}y5.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Cce,values:[Cce,kce,Tce]},{name:"as",type:"string",array:!0,length:2,default:Oce}]},$e(y5,ve,{transform(e,t){var n=e.as||Oce,r=n[0],i=n[1],a=bp(e.sort),o=e.field||hv,s=e.offset===kce?$nt:e.offset===Tce?Lnt:Bnt,u,l,c,f;for(u=znt(t.source,e.groupby,a,o),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function $nt(e,t,n,r,i){for(var a=(t-e.sum)/2,o=e.length,s=0,u;s<o;++s)u=e[s],u[r]=a,u[i]=a+=Math.abs(n(u))}function Lnt(e,t,n,r,i){for(var a=1/e.sum,o=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=o,c[i]=o=a*(l+=Math.abs(n(c)))}function Bnt(e,t,n,r,i){for(var a=0,o=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=a,c[i]=a+=l)}function znt(e,t,n,r){var i=[],a=g=>g(c),o,s,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(a),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}var jnt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:hce,datajoin:pce,encode:gce,legendentries:mce,linkpath:g5,pie:m5,scale:_ce,sortitems:Ace,stack:y5}),mt=1e-6,Ok=1e-12,Gt=Math.PI,Nr=Gt/2,Ik=Gt/4,Ra=Gt*2,Br=180/Gt,Kt=Gt/180,hn=Math.abs,Kv=Math.atan,vs=Math.atan2,yt=Math.cos,Nk=Math.ceil,Ice=Math.exp,b5=Math.hypot,Dk=Math.log,x5=Math.pow,ct=Math.sin,ys=Math.sign||function(e){return e>0?1:e<0?-1:0},Fa=Math.sqrt,w5=Math.tan;function Nce(e){return e>1?0:e<-1?Gt:Math.acos(e)}function fo(e){return e>1?Nr:e<-1?-Nr:Math.asin(e)}function zi(){}function Rk(e,t){e&&Rce.hasOwnProperty(e.type)&&Rce[e.type](e,t)}var Dce={Feature:function(e,t){Rk(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Rk(n[r].geometry,t)}},Rce={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){_5(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)_5(n[r],t,0)},Polygon:function(e,t){Fce(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Fce(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Rk(n[r],t)}};function _5(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Fce(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)_5(e[n],t,1);t.polygonEnd()}function Ic(e,t){e&&Dce.hasOwnProperty(e.type)?Dce[e.type](e,t):Rk(e,t)}var Fk=new Ia,Mk=new Ia,Mce,Pce,S5,E5,A5,ml={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Fk=new Ia,ml.lineStart=Unt,ml.lineEnd=Wnt},polygonEnd:function(){var e=+Fk;Mk.add(e<0?Ra+e:e),this.lineStart=this.lineEnd=this.point=zi},sphere:function(){Mk.add(Ra)}};function Unt(){ml.point=Vnt}function Wnt(){$ce(Mce,Pce)}function Vnt(e,t){ml.point=$ce,Mce=e,Pce=t,e*=Kt,t*=Kt,S5=e,E5=yt(t=t/2+Ik),A5=ct(t)}function $ce(e,t){e*=Kt,t*=Kt,t=t/2+Ik;var n=e-S5,r=n>=0?1:-1,i=r*n,a=yt(t),o=ct(t),s=A5*o,u=E5*a+s*yt(i),l=s*r*ct(i);Fk.add(vs(l,u)),S5=e,E5=a,A5=o}function qnt(e){return Mk=new Ia,Ic(e,ml),Mk*2}function Pk(e){return[vs(e[1],e[0]),fo(e[2])]}function Mp(e){var t=e[0],n=e[1],r=yt(n);return[r*yt(t),r*ct(t),ct(n)]}function $k(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Xv(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function C5(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Lk(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Bk(e){var t=Fa(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var xr,ho,Dr,Vo,Pp,Lce,Bce,Yv,wx,Nd,Nc,Dc={point:k5,lineStart:jce,lineEnd:Uce,polygonStart:function(){Dc.point=Wce,Dc.lineStart=Hnt,Dc.lineEnd=Gnt,wx=new Ia,ml.polygonStart()},polygonEnd:function(){ml.polygonEnd(),Dc.point=k5,Dc.lineStart=jce,Dc.lineEnd=Uce,Fk<0?(xr=-(Dr=180),ho=-(Vo=90)):wx>mt?Vo=90:wx<-mt&&(ho=-90),Nc[0]=xr,Nc[1]=Dr},sphere:function(){xr=-(Dr=180),ho=-(Vo=90)}};function k5(e,t){Nd.push(Nc=[xr=e,Dr=e]),t<ho&&(ho=t),t>Vo&&(Vo=t)}function zce(e,t){var n=Mp([e*Kt,t*Kt]);if(Yv){var r=Xv(Yv,n),i=[r[1],-r[0],0],a=Xv(i,r);Bk(a),a=Pk(a);var o=e-Pp,s=o>0?1:-1,u=a[0]*Br*s,l,c=hn(o)>180;c^(s*Pp<u&&u<s*e)?(l=a[1]*Br,l>Vo&&(Vo=l)):(u=(u+360)%360-180,c^(s*Pp<u&&u<s*e)?(l=-a[1]*Br,l<ho&&(ho=l)):(t<ho&&(ho=t),t>Vo&&(Vo=t))),c?e<Pp?qo(xr,e)>qo(xr,Dr)&&(Dr=e):qo(e,Dr)>qo(xr,Dr)&&(xr=e):Dr>=xr?(e<xr&&(xr=e),e>Dr&&(Dr=e)):e>Pp?qo(xr,e)>qo(xr,Dr)&&(Dr=e):qo(e,Dr)>qo(xr,Dr)&&(xr=e)}else Nd.push(Nc=[xr=e,Dr=e]);t<ho&&(ho=t),t>Vo&&(Vo=t),Yv=n,Pp=e}function jce(){Dc.point=zce}function Uce(){Nc[0]=xr,Nc[1]=Dr,Dc.point=k5,Yv=null}function Wce(e,t){if(Yv){var n=e-Pp;wx.add(hn(n)>180?n+(n>0?360:-360):n)}else Lce=e,Bce=t;ml.point(e,t),zce(e,t)}function Hnt(){ml.lineStart()}function Gnt(){Wce(Lce,Bce),ml.lineEnd(),hn(wx)>mt&&(xr=-(Dr=180)),Nc[0]=xr,Nc[1]=Dr,Yv=null}function qo(e,t){return(t-=e)<0?t+360:t}function Knt(e,t){return e[0]-t[0]}function Vce(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Xnt(e){var t,n,r,i,a,o,s;if(Vo=Dr=-(xr=ho=1/0),Nd=[],Ic(e,Dc),n=Nd.length){for(Nd.sort(Knt),t=1,r=Nd[0],a=[r];t<n;++t)i=Nd[t],Vce(r,i[0])||Vce(r,i[1])?(qo(r[0],i[1])>qo(r[0],r[1])&&(r[1]=i[1]),qo(i[0],r[1])>qo(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t)i=a[t],(s=qo(r[1],i[0]))>o&&(o=s,xr=i[0],Dr=r[1])}return Nd=Nc=null,xr===1/0||ho===1/0?[[NaN,NaN],[NaN,NaN]]:[[xr,ho],[Dr,Vo]]}var _x,zk,jk,Uk,Wk,Vk,qk,Hk,T5,O5,I5,qce,Hce,Ma,Pa,$a,du={sphere:zi,point:N5,lineStart:Gce,lineEnd:Kce,polygonStart:function(){du.lineStart=Jnt,du.lineEnd=Qnt},polygonEnd:function(){du.lineStart=Gce,du.lineEnd=Kce}};function N5(e,t){e*=Kt,t*=Kt;var n=yt(t);Sx(n*yt(e),n*ct(e),ct(t))}function Sx(e,t,n){++_x,jk+=(e-jk)/_x,Uk+=(t-Uk)/_x,Wk+=(n-Wk)/_x}function Gce(){du.point=Ynt}function Ynt(e,t){e*=Kt,t*=Kt;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),du.point=Znt,Sx(Ma,Pa,$a)}function Znt(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=vs(Fa((o=Pa*a-$a*i)*o+(o=$a*r-Ma*a)*o+(o=Ma*i-Pa*r)*o),Ma*r+Pa*i+$a*a);zk+=o,Vk+=o*(Ma+(Ma=r)),qk+=o*(Pa+(Pa=i)),Hk+=o*($a+($a=a)),Sx(Ma,Pa,$a)}function Kce(){du.point=N5}function Jnt(){du.point=ert}function Qnt(){Xce(qce,Hce),du.point=N5}function ert(e,t){qce=e,Hce=t,e*=Kt,t*=Kt,du.point=Xce;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),Sx(Ma,Pa,$a)}function Xce(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=Pa*a-$a*i,s=$a*r-Ma*a,u=Ma*i-Pa*r,l=b5(o,s,u),c=fo(l),f=l&&-c/l;T5.add(f*o),O5.add(f*s),I5.add(f*u),zk+=c,Vk+=c*(Ma+(Ma=r)),qk+=c*(Pa+(Pa=i)),Hk+=c*($a+($a=a)),Sx(Ma,Pa,$a)}function trt(e){_x=zk=jk=Uk=Wk=Vk=qk=Hk=0,T5=new Ia,O5=new Ia,I5=new Ia,Ic(e,du);var t=+T5,n=+O5,r=+I5,i=b5(t,n,r);return i<Ok&&(t=Vk,n=qk,r=Hk,zk<mt&&(t=jk,n=Uk,r=Wk),i=b5(t,n,r),i<Ok)?[NaN,NaN]:[vs(n,t)*Br,fo(r/i)*Br]}function D5(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function R5(e,t){return[hn(e)>Gt?e+Math.round(-e/Ra)*Ra:e,t]}R5.invert=R5;function Yce(e,t,n){return(e%=Ra)?t||n?D5(Jce(e),Qce(t,n)):Jce(e):t||n?Qce(t,n):R5}function Zce(e){return function(t,n){return t+=e,[t>Gt?t-Ra:t<-Gt?t+Ra:t,n]}}function Jce(e){var t=Zce(e);return t.invert=Zce(-e),t}function Qce(e,t){var n=yt(e),r=ct(e),i=yt(t),a=ct(t);function o(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*n+c*r;return[vs(f*i-h*a,c*n-d*r),fo(h*i+f*a)]}return o.invert=function(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*i-f*a;return[vs(f*i+d*a,c*n+h*r),fo(h*n-c*r)]},o}function nrt(e){e=Yce(e[0]*Kt,e[1]*Kt,e.length>2?e[2]*Kt:0);function t(n){return n=e(n[0]*Kt,n[1]*Kt),n[0]*=Br,n[1]*=Br,n}return t.invert=function(n){return n=e.invert(n[0]*Kt,n[1]*Kt),n[0]*=Br,n[1]*=Br,n},t}function rrt(e,t,n,r,i,a){if(!!n){var o=yt(t),s=ct(t),u=r*n;i==null?(i=t+r*Ra,a=t-u/2):(i=efe(o,i),a=efe(o,a),(r>0?i<a:i>a)&&(i+=r*Ra));for(var l,c=i;r>0?c>a:c<a;c-=u)l=Pk([o,-s*yt(c),-s*ct(c)]),e.point(l[0],l[1])}}function efe(e,t){t=Mp(t),t[0]-=e,Bk(t);var n=Nce(-t[1]);return((-t[2]<0?-n:n)+Ra-mt)%Ra}function tfe(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:zi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Gk(e,t){return hn(e[0]-t[0])<mt&&hn(e[1]-t[1])<mt}function Kk(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function nfe(e,t,n,r,i){var a=[],o=[],s,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(Gk(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),s=0;s<g;++s)i.point((m=p[s])[0],m[1]);i.lineEnd();return}v[0]+=2*mt}a.push(y=new Kk(m,p,null,!0)),o.push(y.o=new Kk(m,null,y,!1)),a.push(y=new Kk(v,p,null,!1)),o.push(y.o=new Kk(v,null,y,!0))}}),!!a.length){for(o.sort(t),rfe(a),rfe(o),s=0,u=o.length;s<u;++s)o[s].e=n=!n;for(var l=a[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function rfe(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function F5(e){return hn(e[0])<=Gt?e[0]:ys(e[0])*((hn(e[0])+Gt)%Ra-Gt)}function irt(e,t){var n=F5(t),r=t[1],i=ct(r),a=[ct(n),-yt(n),0],o=0,s=0,u=new Ia;i===1?r=Nr+mt:i===-1&&(r=-Nr-mt);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=F5(h),g=h[1]/2+Ik,m=ct(g),v=yt(g),y=0;y<d;++y,p=x,m=S,v=A,h=b){var b=f[y],x=F5(b),w=b[1]/2+Ik,S=ct(w),A=yt(w),_=x-p,E=_>=0?1:-1,C=E*_,k=C>Gt,T=m*S;if(u.add(vs(T*E*ct(C),v*A+T*yt(C))),o+=k?_+E*Ra:_,k^p>=n^x>=n){var I=Xv(Mp(h),Mp(b));Bk(I);var N=Xv(a,I);Bk(N);var O=(k^_>=0?-1:1)*fo(N[2]);(r>O||r===O&&(I[0]||I[1]))&&(s+=k^_>=0?1:-1)}}return(o<-mt||o<mt&&u<-Ok)^s&1}function ife(e,t,n,r){return function(i){var a=t(i),o=tfe(),s=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=rie(c);var x=irt(l,r);c.length?(u||(i.polygonStart(),u=!0),nfe(c,ort,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){a.point(x,w)}function g(){d.point=p,a.lineStart()}function m(){d.point=h,a.lineEnd()}function v(x,w){f.push([x,w]),s.point(x,w)}function y(){s.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=o.result(),S,A=w.length,_,E,C;if(f.pop(),l.push(f),f=null,!!A){if(x&1){if(E=w[0],(_=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((C=E[S])[0],C[1]);i.lineEnd()}return}A>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(art))}}return d}}function art(e){return e.length>1}function ort(e,t){return((e=e.x)[0]<0?e[1]-Nr-mt:Nr-e[1])-((t=t.x)[0]<0?t[1]-Nr-mt:Nr-t[1])}var afe=ife(function(){return!0},srt,lrt,[-Gt,-Nr]);function srt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?Gt:-Gt,u=hn(a-t);hn(u-Gt)<mt?(e.point(t,n=(n+o)/2>0?Nr:-Nr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&u>=Gt&&(hn(t-r)<mt&&(t-=r*mt),hn(a-s)<mt&&(a-=s*mt),n=urt(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function urt(e,t,n,r){var i,a,o=ct(e-n);return hn(o)>mt?Kv((ct(t)*(a=yt(r))*ct(n)-ct(r)*(i=yt(t))*ct(e))/(i*a*o)):(t+r)/2}function lrt(e,t,n,r){var i;if(e==null)i=n*Nr,r.point(-Gt,i),r.point(0,i),r.point(Gt,i),r.point(Gt,0),r.point(Gt,-i),r.point(0,-i),r.point(-Gt,-i),r.point(-Gt,0),r.point(-Gt,i);else if(hn(e[0]-t[0])>mt){var a=e[0]<t[0]?Gt:-Gt;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function crt(e){var t=yt(e),n=6*Kt,r=t>0,i=hn(t)>mt;function a(c,f,d,h){rrt(h,e,n,d,c,f)}function o(c,f){return yt(c)*yt(f)>t}function s(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var y=[m,v],b,x=o(m,v),w=r?x?0:l(m,v):x?l(m+(m<0?Gt:-Gt),v):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,y),(!b||Gk(f,b)||Gk(y,b))&&(y[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!Gk(f,y))&&c.point(y[0],y[1]),f=y,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Mp(c),p=Mp(f),g=[1,0,0],m=Xv(h,p),v=$k(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var x=t*v/b,w=-t*y/b,S=Xv(g,m),A=Lk(g,x),_=Lk(m,w);C5(A,_);var E=S,C=$k(A,E),k=$k(E,E),T=C*C-k*($k(A,A)-1);if(!(T<0)){var I=Fa(T),N=Lk(E,(-C-I)/k);if(C5(N,A),N=Pk(N),!d)return N;var O=c[0],D=f[0],L=c[1],W=f[1],G;D<O&&(G=O,O=D,D=G);var K=D-O,ee=hn(K-Gt)<mt,ce=ee||K<mt;if(!ee&&W<L&&(G=L,L=W,W=G),ce?ee?L+W>0^N[1]<(hn(N[0]-O)<mt?L:W):L<=N[1]&&N[1]<=W:K>Gt^(O<=N[0]&&N[0]<=D)){var he=Lk(E,(-C+I)/k);return C5(he,A),[N,Pk(he)]}}}function l(c,f){var d=r?e:Gt-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return ife(o,s,a,r?[0,-e]:[-Gt,e-Gt])}function frt(e,t,n,r,i,a){var o=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-s,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=a-s,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=s+c*h),f<1&&(t[0]=o+f*d,t[1]=s+f*h),!0}}}}}var Ex=1e9,Xk=-Ex;function ofe(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function a(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return hn(l[0]-e)<mt?c>0?0:3:hn(l[0]-n)<mt?c>0?2:1:hn(l[1]-t)<mt?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=tfe(),d,h,p,g,m,v,y,b,x,w,S,A={point:_,lineStart:T,lineEnd:I,polygonStart:C,polygonEnd:k};function _(O,D){i(O,D)&&c.point(O,D)}function E(){for(var O=0,D=0,L=h.length;D<L;++D)for(var W=h[D],G=1,K=W.length,ee=W[0],ce,he,Oe=ee[0],Te=ee[1];G<K;++G)ce=Oe,he=Te,ee=W[G],Oe=ee[0],Te=ee[1],he<=r?Te>r&&(Oe-ce)*(r-he)>(Te-he)*(e-ce)&&++O:Te<=r&&(Oe-ce)*(r-he)<(Te-he)*(e-ce)&&--O;return O}function C(){c=f,d=[],h=[],S=!0}function k(){var O=E(),D=S&&O,L=(d=rie(d)).length;(D||L)&&(l.polygonStart(),D&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),L&&nfe(d,s,O,a,l),l.polygonEnd()),c=l,d=h=p=null}function T(){A.point=N,h&&h.push(p=[]),w=!0,x=!1,y=b=NaN}function I(){d&&(N(g,m),v&&x&&f.rejoin(),d.push(f.result())),A.point=_,x&&c.lineEnd()}function N(O,D){var L=i(O,D);if(h&&p.push([O,D]),w)g=O,m=D,v=L,w=!1,L&&(c.lineStart(),c.point(O,D));else if(L&&x)c.point(O,D);else{var W=[y=Math.max(Xk,Math.min(Ex,y)),b=Math.max(Xk,Math.min(Ex,b))],G=[O=Math.max(Xk,Math.min(Ex,O)),D=Math.max(Xk,Math.min(Ex,D))];frt(W,G,e,t,n,r)?(x||(c.lineStart(),c.point(W[0],W[1])),c.point(G[0],G[1]),L||c.lineEnd(),S=!1):L&&(c.lineStart(),c.point(O,D),S=!1)}y=O,b=D,x=L}return A}}function sfe(e,t,n){var r=zo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[i,a]})}}function ufe(e,t,n){var r=zo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[a,i]})}}function drt(){var e,t,n,r,i,a,o,s,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return zo(Nk(r/c)*c,n,c).map(p).concat(zo(Nk(s/f)*f,o,f).map(g)).concat(zo(Nk(t/u)*u,e,u).filter(function(b){return hn(b%c)>mt}).map(d)).concat(zo(Nk(a/l)*l,i,l).filter(function(b){return hn(b%f)>mt}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(s).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],o=+b[1][1],r>n&&(b=r,r=n,n=b),s>o&&(b=s,s=o,o=b),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],a=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),a>i&&(b=a,a=i,i=b),v.precision(m)):[[t,a],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=sfe(a,i,90),h=ufe(t,e,m),p=sfe(s,o,90),g=ufe(r,n,m),v):m},v.extentMajor([[-180,-90+mt],[180,90-mt]]).extentMinor([[-180,-80-mt],[180,80+mt]])}var Ax=e=>e,M5=new Ia,P5=new Ia,lfe,cfe,$5,L5,Dd={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Dd.lineStart=hrt,Dd.lineEnd=grt},polygonEnd:function(){Dd.lineStart=Dd.lineEnd=Dd.point=zi,M5.add(hn(P5)),P5=new Ia},result:function(){var e=M5/2;return M5=new Ia,e}};function hrt(){Dd.point=prt}function prt(e,t){Dd.point=ffe,lfe=$5=e,cfe=L5=t}function ffe(e,t){P5.add(L5*e-$5*t),$5=e,L5=t}function grt(){ffe(lfe,cfe)}var dfe=Dd,Zv=1/0,Yk=Zv,Cx=-Zv,Zk=Cx,mrt={point:vrt,lineStart:zi,lineEnd:zi,polygonStart:zi,polygonEnd:zi,result:function(){var e=[[Zv,Yk],[Cx,Zk]];return Cx=Zk=-(Yk=Zv=1/0),e}};function vrt(e,t){e<Zv&&(Zv=e),e>Cx&&(Cx=e),t<Yk&&(Yk=t),t>Zk&&(Zk=t)}var Jk=mrt,B5=0,z5=0,kx=0,Qk=0,eT=0,Jv=0,j5=0,U5=0,Tx=0,hfe,pfe,vl,yl,hu={point:$p,lineStart:gfe,lineEnd:mfe,polygonStart:function(){hu.lineStart=xrt,hu.lineEnd=wrt},polygonEnd:function(){hu.point=$p,hu.lineStart=gfe,hu.lineEnd=mfe},result:function(){var e=Tx?[j5/Tx,U5/Tx]:Jv?[Qk/Jv,eT/Jv]:kx?[B5/kx,z5/kx]:[NaN,NaN];return B5=z5=kx=Qk=eT=Jv=j5=U5=Tx=0,e}};function $p(e,t){B5+=e,z5+=t,++kx}function gfe(){hu.point=yrt}function yrt(e,t){hu.point=brt,$p(vl=e,yl=t)}function brt(e,t){var n=e-vl,r=t-yl,i=Fa(n*n+r*r);Qk+=i*(vl+e)/2,eT+=i*(yl+t)/2,Jv+=i,$p(vl=e,yl=t)}function mfe(){hu.point=$p}function xrt(){hu.point=_rt}function wrt(){vfe(hfe,pfe)}function _rt(e,t){hu.point=vfe,$p(hfe=vl=e,pfe=yl=t)}function vfe(e,t){var n=e-vl,r=t-yl,i=Fa(n*n+r*r);Qk+=i*(vl+e)/2,eT+=i*(yl+t)/2,Jv+=i,i=yl*e-vl*t,j5+=i*(vl+e),U5+=i*(yl+t),Tx+=i*3,$p(vl=e,yl=t)}var yfe=hu;function bfe(e){this._context=e}bfe.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ra);break}}},result:zi};var W5=new Ia,V5,xfe,wfe,Ox,Ix,tT={point:zi,lineStart:function(){tT.point=Srt},lineEnd:function(){V5&&_fe(xfe,wfe),tT.point=zi},polygonStart:function(){V5=!0},polygonEnd:function(){V5=null},result:function(){var e=+W5;return W5=new Ia,e}};function Srt(e,t){tT.point=_fe,xfe=Ox=e,wfe=Ix=t}function _fe(e,t){Ox-=e,Ix-=t,W5.add(Fa(Ox*Ox+Ix*Ix)),Ox=e,Ix=t}var Sfe=tT;function Efe(){this._string=[]}Efe.prototype={_radius:4.5,_circle:Afe(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Afe(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Afe(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Cfe(e,t){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Ic(o,r(i))),i.result()}return a.area=function(o){return Ic(o,r(dfe)),dfe.result()},a.measure=function(o){return Ic(o,r(Sfe)),Sfe.result()},a.bounds=function(o){return Ic(o,r(Jk)),Jk.result()},a.centroid=function(o){return Ic(o,r(yfe)),yfe.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,Ax):(e=o).stream,a):e},a.context=function(o){return arguments.length?(i=o==null?(t=null,new Efe):new bfe(t=o),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(e).context(t)}function nT(e){return function(t){var n=new q5;for(var r in e)n[r]=e[r];return n.stream=t,n}}function q5(){}q5.prototype={constructor:q5,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function H5(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ic(n,e.stream(Jk)),t(Jk.result()),r!=null&&e.clipExtent(r),e}function rT(e,t,n){return H5(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,u])},n)}function G5(e,t,n){return rT(e,[[0,0],t],n)}function K5(e,t,n){return H5(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function X5(e,t,n){return H5(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var kfe=16,Ert=yt(30*Kt);function Tfe(e,t){return+t?Crt(e,t):Art(e)}function Art(e){return nT({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Crt(e,t){function n(r,i,a,o,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=o+d,w=s+h,S=u+p,A=Fa(x*x+w*w+S*S),_=fo(S/=A),E=hn(hn(S)-1)<mt||hn(a-f)<mt?(a+f)/2:vs(w,x),C=e(E,_),k=C[0],T=C[1],I=k-r,N=T-i,O=y*I-v*N;(O*O/b>t||hn((v*I+y*N)/b-.5)>.3||o*d+s*h+u*p<Ert)&&(n(r,i,a,o,s,u,k,T,E,x/=A,w/=A,S,g,m),m.point(k,T),n(k,T,E,x,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,a,o,s,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,E){_=e(_,E),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,E){var C=Mp([_,E]),k=e(_,E);n(f,d,c,h,p,g,f=k[0],d=k[1],c=_,h=C[0],p=C[1],g=C[2],kfe,r),r.point(f,d)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=S,m.lineEnd=A}function S(_,E){b(i=_,E),a=f,o=d,s=h,u=p,l=g,m.point=b}function A(){n(f,d,c,h,p,g,a,o,i,s,u,l,kfe,r),m.lineEnd=x,x()}return m}}var krt=nT({point:function(e,t){this.stream.point(e*Kt,t*Kt)}});function Trt(e){return nT({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function Ort(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function Ofe(e,t,n,r,i,a){if(!a)return Ort(e,t,n,r,i);var o=yt(a),s=ct(a),u=o*e,l=s*e,c=o/e,f=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function bl(e){return Ife(function(){return e})()}function Ife(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=afe,m=null,v,y,b,x=Ax,w=.5,S,A,_,E,C;function k(O){return _(O[0]*Kt,O[1]*Kt)}function T(O){return O=_.invert(O[0],O[1]),O&&[O[0]*Br,O[1]*Br]}k.stream=function(O){return E&&C===O?E:E=krt(Trt(c)(g(S(x(C=O)))))},k.preclip=function(O){return arguments.length?(g=O,p=void 0,N()):g},k.postclip=function(O){return arguments.length?(x=O,m=v=y=b=null,N()):x},k.clipAngle=function(O){return arguments.length?(g=+O?crt(p=O*Kt):(p=null,afe),N()):p*Br},k.clipExtent=function(O){return arguments.length?(x=O==null?(m=v=y=b=null,Ax):ofe(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),N()):m==null?null:[[m,v],[y,b]]},k.scale=function(O){return arguments.length?(n=+O,I()):n},k.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],I()):[r,i]},k.center=function(O){return arguments.length?(a=O[0]%360*Kt,o=O[1]%360*Kt,I()):[a*Br,o*Br]},k.rotate=function(O){return arguments.length?(s=O[0]%360*Kt,u=O[1]%360*Kt,l=O.length>2?O[2]%360*Kt:0,I()):[s*Br,u*Br,l*Br]},k.angle=function(O){return arguments.length?(f=O%360*Kt,I()):f*Br},k.reflectX=function(O){return arguments.length?(d=O?-1:1,I()):d<0},k.reflectY=function(O){return arguments.length?(h=O?-1:1,I()):h<0},k.precision=function(O){return arguments.length?(S=Tfe(A,w=O*O),N()):Fa(w)},k.fitExtent=function(O,D){return rT(k,O,D)},k.fitSize=function(O,D){return G5(k,O,D)},k.fitWidth=function(O,D){return K5(k,O,D)},k.fitHeight=function(O,D){return X5(k,O,D)};function I(){var O=Ofe(n,0,0,d,h,f).apply(null,t(a,o)),D=Ofe(n,r-O[0],i-O[1],d,h,f);return c=Yce(s,u,l),A=D5(t,D),_=D5(c,A),S=Tfe(A,w),N()}function N(){return E=C=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&T,I()}}function Y5(e){var t=0,n=Gt/3,r=Ife(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*Kt,n=a[1]*Kt):[t*Br,n*Br]},i}function Irt(e){var t=yt(e);function n(r,i){return[r*t,ct(i)/t]}return n.invert=function(r,i){return[r/t,fo(i*t)]},n}function Nrt(e,t){var n=ct(e),r=(n+ct(t))/2;if(hn(r)<mt)return Irt(e);var i=1+n*(2*r-n),a=Fa(i)/r;function o(s,u){var l=Fa(i-2*r*ct(u))/r;return[l*ct(s*=r),a-l*yt(s)]}return o.invert=function(s,u){var l=a-u,c=vs(s,hn(l))*ys(l);return l*r<0&&(c-=Gt*ys(s)*ys(l)),[c/r,fo((i-(s*s+l*l)*r*r)/(2*r))]},o}function iT(){return Y5(Nrt).scale(155.424).center([0,33.6442])}function Nfe(){return iT().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Drt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function Rrt(){var e,t,n=Nfe(),r,i=iT().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=iT().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(a.point(h,p),u)||(s.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Drt([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),a=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+mt,g+.12*h+mt],[p-.214*h-mt,g+.234*h-mt]]).stream(l),s=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+mt,g+.166*h+mt],[p-.115*h-mt,g+.234*h-mt]]).stream(l),f()},c.fitExtent=function(d,h){return rT(c,d,h)},c.fitSize=function(d,h){return G5(c,d,h)},c.fitWidth=function(d,h){return K5(c,d,h)},c.fitHeight=function(d,h){return X5(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Dfe(e){return function(t,n){var r=yt(t),i=yt(n),a=e(r*i);return a===1/0?[2,0]:[a*i*ct(t),a*ct(n)]}}function Nx(e){return function(t,n){var r=Fa(t*t+n*n),i=e(r),a=ct(i),o=yt(i);return[vs(t*a,r*o),fo(r&&n*a/r)]}}var Rfe=Dfe(function(e){return Fa(2/(1+e))});Rfe.invert=Nx(function(e){return 2*fo(e/2)});function Frt(){return bl(Rfe).scale(124.75).clipAngle(180-.001)}var Ffe=Dfe(function(e){return(e=Nce(e))&&e/ct(e)});Ffe.invert=Nx(function(e){return e});function Mrt(){return bl(Ffe).scale(79.4188).clipAngle(180-.001)}function aT(e,t){return[e,Dk(w5((Nr+t)/2))]}aT.invert=function(e,t){return[e,2*Kv(Ice(t))-Nr]};function Prt(){return Mfe(aT).scale(961/Ra)}function Mfe(e){var t=bl(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=s=u=l=null:(o=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,s],[u,l]]};function c(){var f=Gt*r(),d=t(nrt(t.rotate()).invert([0,0]));return a(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===aT?[[Math.max(d[0]-f,o),s],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function oT(e){return w5((Nr+e)/2)}function $rt(e,t){var n=yt(e),r=e===t?ct(e):Dk(n/yt(t))/Dk(oT(t)/oT(e)),i=n*x5(oT(e),r)/r;if(!r)return aT;function a(o,s){i>0?s<-Nr+mt&&(s=-Nr+mt):s>Nr-mt&&(s=Nr-mt);var u=i/x5(oT(s),r);return[u*ct(r*o),i-u*yt(r*o)]}return a.invert=function(o,s){var u=i-s,l=ys(r)*Fa(o*o+u*u),c=vs(o,hn(u))*ys(u);return u*r<0&&(c-=Gt*ys(o)*ys(u)),[c/r,2*Kv(x5(i/l,1/r))-Nr]},a}function Lrt(){return Y5($rt).scale(109.5).parallels([30,30])}function sT(e,t){return[e,t]}sT.invert=sT;function Brt(){return bl(sT).scale(152.63)}function zrt(e,t){var n=yt(e),r=e===t?ct(e):(n-yt(t))/(t-e),i=n/r+e;if(hn(r)<mt)return sT;function a(o,s){var u=i-s,l=r*o;return[u*ct(l),i-u*yt(l)]}return a.invert=function(o,s){var u=i-s,l=vs(o,hn(u))*ys(u);return u*r<0&&(l-=Gt*ys(o)*ys(u)),[l/r,i-ys(r)*Fa(o*o+u*u)]},a}function jrt(){return Y5(zrt).scale(131.154).center([0,13.9389])}var Dx=1.340264,Rx=-.081106,Fx=893e-6,Mx=.003796,uT=Fa(3)/2,Urt=12;function Pfe(e,t){var n=fo(uT*ct(t)),r=n*n,i=r*r*r;return[e*yt(n)/(uT*(Dx+3*Rx*r+i*(7*Fx+9*Mx*r))),n*(Dx+Rx*r+i*(Fx+Mx*r))]}Pfe.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,u;a<Urt&&(s=n*(Dx+Rx*r+i*(Fx+Mx*r))-t,u=Dx+3*Rx*r+i*(7*Fx+9*Mx*r),n-=o=s/u,r=n*n,i=r*r*r,!(hn(o)<Ok));++a);return[uT*e*(Dx+3*Rx*r+i*(7*Fx+9*Mx*r))/yt(n),fo(ct(n)/uT)]};function Wrt(){return bl(Pfe).scale(177.158)}function $fe(e,t){var n=yt(t),r=yt(e)*n;return[n*ct(e)/r,ct(t)/r]}$fe.invert=Nx(Kv);function Vrt(){return bl($fe).scale(144.049).clipAngle(60)}function qrt(){var e=1,t=0,n=0,r=1,i=1,a=0,o,s,u=null,l,c,f,d=1,h=1,p=nT({point:function(x,w){var S=b([x,w]);this.stream.point(S[0],S[1])}}),g=Ax,m,v;function y(){return d=e*r,h=e*i,m=v=null,b}function b(x){var w=x[0]*d,S=x[1]*h;if(a){var A=S*o-w*s;w=w*o+S*s,S=A}return[w+t,S+n]}return b.invert=function(x){var w=x[0]-t,S=x[1]-n;if(a){var A=S*o+w*s;w=w*o-S*s,S=A}return[w/d,S/h]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,Ax):ofe(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(a=x%360*Kt,s=ct(a),o=yt(a),y()):a*Br},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return rT(b,x,w)},b.fitSize=function(x,w){return G5(b,x,w)},b.fitWidth=function(x,w){return K5(b,x,w)},b.fitHeight=function(x,w){return X5(b,x,w)},b}function Lfe(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Lfe.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(hn(i)>mt&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Hrt(){return bl(Lfe).scale(175.295)}function Bfe(e,t){return[yt(t)*ct(e),ct(t)]}Bfe.invert=Nx(fo);function Grt(){return bl(Bfe).scale(249.5).clipAngle(90+mt)}function zfe(e,t){var n=yt(t),r=1+yt(e)*n;return[n*ct(e)/r,ct(t)/r]}zfe.invert=Nx(function(e){return 2*Kv(e)});function Krt(){return bl(zfe).scale(250).clipAngle(142)}function jfe(e,t){return[Dk(w5((Nr+t)/2)),-e]}jfe.invert=function(e,t){return[-t,2*Kv(Ice(e))-Nr]};function Xrt(){var e=Mfe(jfe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Yrt=Math.abs,Z5=Math.cos,lT=Math.sin,Zrt=1e-6,Ufe=Math.PI,J5=Ufe/2,Wfe=Jrt(2);function Vfe(e){return e>1?J5:e<-1?-J5:Math.asin(e)}function Jrt(e){return e>0?Math.sqrt(e):0}function Qrt(e,t){var n=e*lT(t),r=30,i;do t-=i=(t+lT(t)-n)/(1+Z5(t));while(Yrt(i)>Zrt&&--r>0);return t/2}function eit(e,t,n){function r(i,a){return[e*i*Z5(a=Qrt(n,a)),t*lT(a)]}return r.invert=function(i,a){return a=Vfe(a/t),[i/(e*Z5(a)),Vfe((2*a+lT(2*a))/n)]},r}var tit=eit(Wfe/J5,Wfe,Ufe);function nit(){return bl(tit).scale(169.529)}const rit=Cfe(),Q5=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function iit(e,t){return function n(){const r=t();return r.type=e,r.path=Cfe().projection(r),r.copy=r.copy||function(){const i=n();return Q5.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function e6(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(cT[e]=iit(e,t),this):cT[e]||null}function qfe(e){return e&&e.path||rit}const cT={albers:Nfe,albersusa:Rrt,azimuthalequalarea:Frt,azimuthalequidistant:Mrt,conicconformal:Lrt,conicequalarea:iT,conicequidistant:jrt,equalEarth:Wrt,equirectangular:Brt,gnomonic:Vrt,identity:qrt,mercator:Prt,mollweide:nit,naturalEarth1:Hrt,orthographic:Grt,stereographic:Krt,transversemercator:Xrt};for(const e in cT)e6(e,cT[e]);function ait(){}const Rc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Hfe(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return a(u,l,d=>{n(d,u,l),oit(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(sit((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function a(u,l,c){var f=new Array,d=new Array,h,p,g,m,v,y;for(h=p=-1,m=u[0]>=l,Rc[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,Rc[g|m<<1].forEach(b);for(Rc[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,v=u[p*e]>=l,Rc[m<<1|v<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,y=v,v=u[p*e+h+1]>=l,Rc[g|m<<1|v<<2|y<<3].forEach(b);Rc[m|v<<3].forEach(b)}for(h=-1,v=u[p*e]>=l,Rc[v<<2].forEach(b);++h<e-1;)y=v,v=u[p*e+h+1]>=l,Rc[v<<2|y<<3].forEach(b);Rc[v<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],S=[x[1][0]+h,x[1][1]+p],A=o(w),_=o(S),E,C;(E=d[A])?(C=f[_])?(delete d[E.end],delete f[C.start],E===C?(E.ring.push(S),c(E.ring)):f[E.start]=d[C.end]={start:E.start,end:C.end,ring:E.ring.concat(C.ring)}):(delete d[E.end],E.ring.push(S),d[E.end=_]=E):(E=f[_])?(C=d[A])?(delete f[E.start],delete d[C.end],E===C?(E.ring.push(S),c(E.ring)):f[C.start]=d[E.end]={start:C.start,end:E.end,ring:C.ring.concat(E.ring)}):(delete f[E.start],E.ring.unshift(w),f[E.start=A]=E):f[A]=d[_]={start:A,end:_,ring:[w,S]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,v=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(v-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||Se("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:ait,r):n===s},r}function oit(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function sit(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=uit(e,t[n]))return i;return 0}function uit(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var u=e[a],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(lit(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function lit(e,t,n){var r;return cit(e,t,n)&&fit(e[r=+(e[0]===t[0])],n[r],t[r])}function cit(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function fit(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Gfe(e,t,n){return function(r){var i=nl(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=t?nd(a,o,e):s/(e+1);return zo(a+u,o,u)}}function t6(e){ve.call(this,null,e)}t6.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},$e(t6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Oa,a=Hfe().smooth(e.smooth!==!1),o=e.thresholds||dit(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=a.size([c.width,c.height])(c.values,ut(o)?o:o(c.values));hit(f,c,l,e),f.forEach(d=>{u.push(lC(l,In(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function dit(e,t,n){const r=Gfe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>pp(t(i).values)))}function hit(e,t,n,r){let i=r.scale||t.scale,a=r.translate||t.translate;if($t(i)&&(i=i(n,r)),$t(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(ed(i)?i:i[0])||1,s=(ed(i)?i:i[1])||1,u=a&&a[0]||0,l=a&&a[1]||0;e.forEach(Kfe(t,o,s,u,l))}function Kfe(e,t,n,r,i){const a=e.x1||0,o=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-a)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function Xfe(e,t,n){const r=e>=0?e:E4(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function n6(e){return $t(e)?e:Ji(+e)}function Yfe(){var e=u=>u[0],t=u=>u[1],n=hv,r=[-1,-1],i=960,a=500,o=2;function s(u,l){const c=Xfe(r[0],u,e)>>o,f=Xfe(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),g=2*h+(a>>o),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(x=>{const w=d+(+e(x)>>o),S=h+(+t(x)>>o);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(x))}),c>0&&f>0?(Qv(p,g,m,v,c),e0(p,g,v,m,f),Qv(p,g,m,v,c),e0(p,g,v,m,f),Qv(p,g,m,v,c),e0(p,g,v,m,f)):c>0?(Qv(p,g,m,v,c),Qv(p,g,v,m,c),Qv(p,g,m,v,c),y=v):f>0&&(e0(p,g,m,v,f),e0(p,g,v,m,f),e0(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*o):1/iie(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(i>>o),y2:h+(a>>o)}}return s.x=function(u){return arguments.length?(e=n6(u),s):e},s.y=function(u){return arguments.length?(t=n6(u),s):t},s.weight=function(u){return arguments.length?(n=n6(u),s):n},s.size=function(u){if(!arguments.length)return[i,a];var l=+u[0],c=+u[1];return l>=0&&c>=0||Se("invalid size"),i=l,a=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||Se("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),s):1<<o},s.bandwidth=function(u){return arguments.length?(u=xt(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&Se("invalid bandwidth"),r=u,s):r},s}function Qv(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+o*e]),s>=i&&(s>=a&&(u-=n[s-a+o*e]),r[s-i+o*e]=u/Math.min(s+1,e-1+a-s,a))}function e0(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[o+s*e]),s>=i&&(s>=a&&(u-=n[o+(s-a)*e]),r[o+(s-i)*e]=u/Math.min(s+1,t-1+a-s,a))}function r6(e){ve.call(this,null,e)}r6.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const pit=["x","y","weight","size","cellSize","bandwidth"];function Zfe(e,t){return pit.forEach(n=>t[n]!=null?e[n](t[n]):0),e}$e(r6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=git(r,e.groupby),a=(e.groupby||[]).map(Ir),o=Zfe(Yfe(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<a.length;++d)c[a[d]]=f[d];return c}return u=i.map(c=>In(l({[s]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function git(e,t){var n=[],r=c=>c(s),i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function i6(e){ve.call(this,null,e)}i6.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},$e(i6,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Hfe().smooth(e.smooth!==!1),i=e.values,a=e.thresholds||Gfe(e.count||10,e.nice,!!i),o=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=Zfe(Yfe(),e)(i,!0),u=Kfe(s,s.scale||1,s.scale||1,0,0),o=[s.width,s.height],i=s.values),a=ut(a)?a:a(i),i=r.size(o)(i,a),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(In),n}});const a6="Feature",o6="FeatureCollection",mit="MultiPoint";function s6(e){ve.call(this,null,e)}s6.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},$e(s6,ve,{transform(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],s=e.geojson||!i&&Oa,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Yi(s))||a&&t.modified(Yi(a))||o&&t.modified(Yi(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),a&&o&&(t.visit(u,c=>{var f=a(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:a6,geometry:{type:mit,coordinates:r}})),this.value={type:o6,features:n}}});function u6(e){ve.call(this,null,e)}u6.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},$e(u6,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Oa,a=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=qfe(e.projection),n.materialize().reflow()):o=i===Oa||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=vit(r,e.pointRadius);return n.visit(o,u=>u[a]=r(i(u))),r.pointRadius(s),n.modifies(a)}});function vit(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function l6(e){ve.call(this,null,e)}l6.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},$e(l6,ve,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],s=a[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[s]=f[1]):(c[o]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(a)}});function c6(e){ve.call(this,null,e)}c6.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},$e(c6,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;return(!r||e.modified())&&(this.value=r=yit(qfe(e.projection),e.field||ao("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function yit(e,t,n){const r=n==null?i=>e(t(i)):i=>{var a=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(a),o};return r.context=i=>(e.context(i),r),r}function f6(e){ve.call(this,[],e),this.generator=drt()}f6.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},$e(f6,ve,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const a in e)$t(r[a])&&r[a](e[a]);return i=r(),n.length?t.mod.push(hae(n[0],i)):t.add.push(In(i)),n[0]=i,t}});function d6(e){ve.call(this,null,e)}d6.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},$e(d6,ve,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||Oa,a=xit(e.opacity,e),o=bit(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?pp(n.map(l=>pp(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Rt({},l,u);r||(f.$max=pp(c.values||[])),l[s]=wit(c,f,o.dep?o:Ji(o(f)),a.dep?a:Ji(a(f)))}),t.reflow(!0).modifies(s)}});function bit(e,t){let n;return $t(e)?(n=r=>gd(e(r,t)),n.dep=Jfe(e)):n=Ji(gd(e||"#888")),n}function xit(e,t){let n;return $t(e)?(n=r=>e(r,t),n.dep=Jfe(e)):e?n=Ji(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function Jfe(e){if(!$t(e))return!1;const t=iu(Yi(e));return t.$x||t.$y||t.$value||t.$max}function wit(e,t,n,r){const i=e.width,a=e.height,o=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||a,c=e.values,f=c?m=>c[m]:Zf,d=Tv(u-o,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-s),g=p.data;for(let m=s,v=0;m<l;++m){t.$y=m-s;for(let y=o,b=m*i;y<u;++y,v+=4){t.$x=y-o,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function Qfe(e){ve.call(this,null,e),this.modified(!0)}$e(Qfe,ve,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Sit(e.type),Q5.forEach(r=>{e[r]!=null&&ede(n,r,e[r])})):Q5.forEach(r=>{e.modified(r)&&ede(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&_it(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function _it(e,t){const n=Eit(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Sit(e){const t=e6((e||"mercator").toLowerCase());return t||Se("Unrecognized projection type: "+e),t()}function ede(e,t,n){$t(e[t])&&e[t](n)}function Eit(e){return e=xt(e),e.length===1?e[0]:{type:o6,features:e.reduce((t,n)=>t.concat(Ait(n)),[])}}function Ait(e){return e.type===o6?e.features:xt(e).filter(t=>t!=null).map(t=>t.type===a6?t:{type:a6,geometry:t})}var Cit=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:i6,geojson:s6,geopath:u6,geopoint:l6,geoshape:c6,graticule:f6,heatmap:d6,isocontour:t6,kde2d:r6,projection:Qfe});function kit(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,u=0,l=0;for(a=0;a<o;++a)s=n[a],u+=s.x,l+=s.y;for(u=(u/o-e)*r,l=(l/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=u,s.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function Tit(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return tde(this.cover(t,n),t,n,e)}function tde(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,v,y;if(!a)return e._root=o,e;for(;a.length;)if((g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,e;if(h=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===h&&n===p)return o.next=a,i?i[v]=o:e._root=o,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=a,i[v]=o,e}function Oit(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>f&&(f=a));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)tde(this,o[n],s[n],e[n]);return this}function Iit(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function Nit(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Dit(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function La(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Rit(e,t,n){var r,i=this._x0,a=this._y0,o,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new La(h,i,a,c,f)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(u=p.x1)<i||(l=p.y1)<a))if(h.length){var m=(o+u)/2,v=(s+l)/2;d.push(new La(h[3],m,v,u,l),new La(h[2],o,v,m,l),new La(h[1],m,s,u,v),new La(h[0],o,s,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,a=t-w,c=e+w,f=t+w,r=h.data}}return r}function Fit(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function Mit(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Pit(){return this._root}function $it(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Lit(e){var t=[],n,r=this._root,i,a,o,s,u;for(r&&t.push(new La(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(a+s)/2,c=(o+u)/2;(i=r[3])&&t.push(new La(i,l,c,s,u)),(i=r[2])&&t.push(new La(i,a,c,l,u)),(i=r[1])&&t.push(new La(i,l,o,s,c)),(i=r[0])&&t.push(new La(i,a,o,l,c))}return this}function Bit(e){var t=[],n=[],r;for(this._root&&t.push(new La(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(s+l)/2;(a=i[0])&&t.push(new La(a,o,s,c,f)),(a=i[1])&&t.push(new La(a,c,s,u,f)),(a=i[2])&&t.push(new La(a,o,f,c,l)),(a=i[3])&&t.push(new La(a,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function zit(e){return e[0]}function jit(e){return arguments.length?(this._x=e,this):this._x}function Uit(e){return e[1]}function Wit(e){return arguments.length?(this._y=e,this):this._y}function h6(e,t,n){var r=new p6(t??zit,n??Uit,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function p6(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function nde(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ba=h6.prototype=p6.prototype;Ba.copy=function(){var e=new p6(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=nde(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=nde(r));return e},Ba.add=Tit,Ba.addAll=Oit,Ba.cover=Iit,Ba.data=Nit,Ba.extent=Dit,Ba.find=Rit,Ba.remove=Fit,Ba.removeAll=Mit,Ba.root=Pit,Ba.size=$it,Ba.visit=Lit,Ba.visitAfter=Bit,Ba.x=jit,Ba.y=Wit;function za(e){return function(){return e}}function Rd(e){return(e()-.5)*1e-6}function Vit(e){return e.x+e.vx}function qit(e){return e.y+e.vy}function Hit(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=za(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,v=0;v<a;++v)for(f=h6(t,Vit,qit).visitAfter(s),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,x,w,S,A){var _=b.data,E=b.r,C=g+E;if(_){if(_.index>d.index){var k=h-_.x-_.vx,T=p-_.y-_.vy,I=k*k+T*T;I<C*C&&(k===0&&(k=Rd(r),I+=k*k),T===0&&(T=Rd(r),I+=T*T),I=(C-(I=Math.sqrt(I)))/I*i,d.vx+=(k*=I)*(C=(E*=E)/(m+E)),d.vy+=(T*=I)*C,_.vx-=k*(C=1-C),_.vy-=T*C)}return}return x>h+C||S<h-C||w>p+C||A<p-C}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:za(+l),u(),o):e},o}function Git(e){return e.index}function rde(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Kit(e){var t=Git,n=f,r,i=za(30),a,o,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,S,A,_,E,C;b<y;++b)x=e[b],w=x.source,S=x.target,A=S.x+S.vx-w.x-w.vx||Rd(l),_=S.y+S.vy-w.y-w.vy||Rd(l),E=Math.sqrt(A*A+_*_),E=(E-a[b])/E*m*r[b],A*=E,_*=E,S.vx-=A*(C=u[b]),S.vy-=_*C,w.vx+=A*(C=1-C),w.vy+=_*C}function h(){if(!!o){var m,v=o.length,y=e.length,b=new Map(o.map((w,S)=>[t(w,S,o),w])),x;for(m=0,s=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=rde(b,x.source)),typeof x.target!="object"&&(x.target=rde(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(!!o)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!o)for(var m=0,v=e.length;m<v;++m)a[m]=+i(e[m],m,e)}return d.initialize=function(m,v){o=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:za(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:za(+m),g(),d):i},d}var Xit={value:()=>{}};function ide(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new fT(n)}function fT(e){this._=e}function Yit(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}fT.prototype=ide.prototype={constructor:fT,on:function(e,t){var n=this._,r=Yit(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Zit(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=ade(n[i],e.name,t);else if(t==null)for(i in n)n[i]=ade(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new fT(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Zit(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function ade(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Xit,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var t0=0,Px=0,$x=0,ode=1e3,dT,Lx,hT=0,Lp=0,pT=0,Bx=typeof performance=="object"&&performance.now?performance:Date,sde=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function g6(){return Lp||(sde(Jit),Lp=Bx.now()+pT)}function Jit(){Lp=0}function gT(){this._call=this._time=this._next=null}gT.prototype=ude.prototype={constructor:gT,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?g6():+n)+(t==null?0:+t),!this._next&&Lx!==this&&(Lx?Lx._next=this:dT=this,Lx=this),this._call=e,this._time=n,m6()},stop:function(){this._call&&(this._call=null,this._time=1/0,m6())}};function ude(e,t,n){var r=new gT;return r.restart(e,t,n),r}function Qit(){g6(),++t0;for(var e=dT,t;e;)(t=Lp-e._time)>=0&&e._call.call(null,t),e=e._next;--t0}function lde(){Lp=(hT=Bx.now())+pT,t0=Px=0;try{Qit()}finally{t0=0,tat(),Lp=0}}function eat(){var e=Bx.now(),t=e-hT;t>ode&&(pT-=t,hT=e)}function tat(){for(var e,t=dT,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:dT=n);Lx=e,m6(r)}function m6(e){if(!t0){Px&&(Px=clearTimeout(Px));var t=e-Lp;t>24?(e<1/0&&(Px=setTimeout(lde,e-Bx.now()-pT)),$x&&($x=clearInterval($x))):($x||(hT=Bx.now(),$x=setInterval(eat,ode)),t0=1,sde(lde))}}function nat(e,t,n){var r=new gT,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(a,o,s){o=+o,s=s==null?g6():+s,r._restart(function u(l){l+=i,r._restart(u,i+=o,s),a(l)},o,s)},r.restart(e,t,n),r)}const rat=1664525,iat=1013904223,cde=4294967296;function aat(){let e=1;return()=>(e=(rat*e+iat)%cde)/cde}function oat(e){return e.x}function sat(e){return e.y}var uat=10,lat=Math.PI*(3-Math.sqrt(5));function cat(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=ude(f),l=ide("tick","end"),c=aat();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(a-n)*i,s.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=uat*Math.sqrt(.5+g),b=g*lat;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(a=+g,t):a},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,s.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?s.delete(g):s.set(g,p(m)),t):s.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,S,A,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)A=e[y],x=g-A.x,w=m-A.y,S=x*x+w*w,S<v&&(_=A,v=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function fat(){var e,t,n,r,i=za(-30),a,o=1,s=1/0,u=.81;function l(h){var p,g=e.length,m=h6(e,oat,sat).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(a=new Array(p),h=0;h<p;++h)g=e[h],a[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,v=0,y,b,x;if(h.length){for(y=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,x=v*v+y*y;if(b*b/u<x)return x<s&&(v===0&&(v=Rd(n),x+=v*v),y===0&&(y=Rd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)),t.vx+=v*h.value*r/x,t.vy+=y*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(v===0&&(v=Rd(n),x+=v*v),y===0&&(y=Rd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=a[h.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:za(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function dat(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}function hat(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}const fde={center:kit,collide:Hit,nbody:fat,link:Kit,x:dat,y:hat},zx="forces",v6=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],pat=["static","iterations"],dde=["x","y","vx","vy"];function y6(e){ve.call(this,null,e)}y6.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:dde}]},$e(y6,ve,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(v6),a=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&hde(n,e,0,t)):(this.value=n=mat(t.source,e),n.on("tick",gat(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(pat)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==zx||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(dde)}});function gat(e,t){return()=>e.touch(t).run()}function mat(e,t){const n=cat(e),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),hde(n,t,!0).on("end",()=>a=!0)}function hde(e,t,n,r){var i=xt(t.forces),a,o,s,u;for(a=0,o=v6.length;a<o;++a)s=v6[a],s!==zx&&t.modified(s)&&e[s](t[s]);for(a=0,o=i.length;a<o;++a)u=zx+a,s=n||t.modified(zx,a)?yat(i[a]):r&&vat(i[a],r)?e.force(u):null,s&&e.force(u,s);for(o=e.numForces||0;a<o;++a)e.force(zx+a,null);return e.numForces=i.length,e}function vat(e,t){var n,r;for(n in e)if($t(r=e[n])&&t.modified(Yi(r)))return 1;return 0}function yat(e){var t,n;_t(fde,e.force)||Se("Unrecognized force: "+e.force),t=fde[e.force]();for(n in e)$t(t[n])&&bat(t[n],e[n],e);return t}function bat(e,t,n){e($t(t)?r=>t(r,n):t)}var xat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:y6});function wat(e,t){return e.parent===t.parent?1:2}function _at(e){return e.reduce(Sat,0)/e.length}function Sat(e,t){return e+t.x}function Eat(e){return 1+e.reduce(Aat,0)}function Aat(e,t){return Math.max(e,t.y)}function Cat(e){for(var t;t=e.children;)e=t[0];return e}function kat(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Tat(){var e=wat,t=1,n=1,r=!1;function i(a){var o,s=0;a.eachAfter(function(d){var h=d.children;h?(d.x=_at(h),d.y=Eat(h)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var u=Cat(a),l=kat(a),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return a.eachAfter(r?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],i):r?null:[t,n]},i.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],i):r?[t,n]:null},i}function Oat(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function Iat(){return this.eachAfter(Oat)}function Nat(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function Dat(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function Rat(e,t){for(var n=this,r=[n],i=[],a,o,s,u=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function Fat(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function Mat(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function Pat(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function $at(e){for(var t=this,n=Lat(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function Lat(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function Bat(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function zat(){return Array.from(this)}function jat(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Uat(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Wat(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function b6(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Hat)):t===void 0&&(t=qat);for(var n=new n0(e),r,i=[n],a,o,s,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new n0(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(pde)}function Vat(){return b6(this).eachBefore(Gat)}function qat(e){return e.children}function Hat(e){return Array.isArray(e)?e[1]:null}function Gat(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function pde(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function n0(e){this.data=e,this.depth=this.height=0,this.parent=null}n0.prototype=b6.prototype={constructor:n0,count:Iat,each:Nat,eachAfter:Rat,eachBefore:Dat,find:Fat,sum:Mat,sort:Pat,path:$at,ancestors:Bat,descendants:zat,leaves:jat,links:Uat,copy:Vat,[Symbol.iterator]:Wat};function Kat(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xat(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function Yat(e){for(var t=0,n=(e=Xat(Array.from(e))).length,r=[],i,a;t<n;)i=e[t],a&&gde(a,i)?++t:(a=Jat(r=Zat(r,i)),t=0);return a}function Zat(e,t){var n,r;if(x6(t,e))return[t];for(n=0;n<e.length;++n)if(mT(t,e[n])&&x6(jx(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(mT(jx(e[n],e[r]),t)&&mT(jx(e[n],t),e[r])&&mT(jx(e[r],t),e[n])&&x6(mde(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function mT(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function gde(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function x6(e,t){for(var n=0;n<t.length;++n)if(!gde(e,t[n]))return!1;return!0}function Jat(e){switch(e.length){case 1:return Qat(e[0]);case 2:return jx(e[0],e[1]);case 3:return mde(e[0],e[1],e[2])}}function Qat(e){return{x:e.x,y:e.y,r:e.r}}function jx(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,u=a-n,l=o-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+a+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+s)/2}}function mde(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-s,g=i-c,m=u-a,v=f-a,y=r*r+i*i-a*a,b=y-o*o-s*s+u*u,x=y-l*l-c*c+f*f,w=h*p-d*g,S=(p*x-g*b)/(w*2)-r,A=(g*m-p*v)/w,_=(h*b-d*x)/(w*2)-i,E=(d*v-h*m)/w,C=A*A+E*E-1,k=2*(a+S*A+_*E),T=S*S+_*_-a*a,I=-(C?(k+Math.sqrt(k*k-4*C*T))/(2*C):T/k);return{x:r+S+A*I,y:i+_+E*I,r:I}}function vde(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,s,u,l=r*r+o*o;l?(a=t.r+n.r,a*=a,u=e.r+n.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*o,n.y=e.y-i*o+s*r):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x+i*r-s*o,n.y=t.y+i*o+s*r)):(n.x=t.x+n.r,n.y=t.y)}function yde(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function bde(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function vT(e){this._=e,this.next=null,this.previous=null}function eot(e){if(!(i=(e=Kat(e)).length))return 0;var t,n,r,i,a,o,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;vde(n,t,r=e[2]),t=new vT(t),n=new vT(n),r=new vT(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){vde(t._,n._,r=e[s]),r=new vT(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(yde(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(yde(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,a=bde(t);(r=r.next)!==n;)(o=bde(r))<a&&(t=r,a=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=Yat(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function tot(e){return e==null?null:yT(e)}function yT(e){if(typeof e!="function")throw new Error;return e}function Bp(){return 0}function r0(e){return function(){return e}}function not(e){return Math.sqrt(e.value)}function rot(){var e=null,t=1,n=1,r=Bp;function i(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(xde(e)).eachAfter(w6(r,.5)).eachBefore(wde(1)):a.eachBefore(xde(not)).eachAfter(w6(Bp,1)).eachAfter(w6(r,a.r/Math.min(t,n))).eachBefore(wde(Math.min(t,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=tot(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],n=+a[1],i):[t,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:r0(+a),i):r},i}function xde(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function w6(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,s;if(o)for(i=0;i<a;++i)r[i].r+=o;if(s=eot(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=s+o}}}function wde(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function _de(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Ux(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)o=a[s],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function iot(){var e=1,t=1,n=0,r=!1;function i(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),r&&o.eachBefore(_de),o}function a(o,s){return function(u){u.children&&Ux(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var aot={depth:-1},Sde={};function oot(e){return e.id}function sot(e){return e.parentId}function Ede(){var e=oot,t=sot;function n(r){var i=Array.from(r),a=i.length,o,s,u,l,c,f,d,h=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new n0(o),(f=e(o,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Sde:c)),(f=t(o,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Sde)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=aot,u.eachBefore(function(p){p.depth=p.parent.depth+1,--a}).eachBefore(pde),u.parent=null,a>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=yT(r),n):e},n.parentId=function(r){return arguments.length?(t=yT(r),n):t},n}function uot(e,t){return e.parent===t.parent?1:2}function _6(e){var t=e.children;return t?t[0]:e.t}function S6(e){var t=e.children;return t?t[t.length-1]:e.t}function lot(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function cot(e){for(var t=0,n=0,r=e.children,i=r.length,a;--i>=0;)a=r[i],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function fot(e,t,n){return e.a.parent===t.parent?e.a:n}function bT(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}bT.prototype=Object.create(n0.prototype);function dot(e){for(var t=new bT(e,0),n,r=[t],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new bT(a[o],o)),i.parent=n;return(t.parent=new bT(null,0)).children=[t],t}function hot(){var e=uot,t=1,n=1,r=null;function i(l){var c=dot(l);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function a(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){cot(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m,x;p=S6(p),d=_6(d),p&&d;)g=_6(g),h=S6(h),h.a=l,x=p.z+y-d.z-m+e(p._,d._),x>0&&(lot(fot(p,l,f),l,x),m+=x,v+=x),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!S6(h)&&(h.t=p,h.m+=y-v),d&&!_6(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function xT(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)o=a[s],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var Ade=(1+Math.sqrt(5))/2;function Cde(e,t,n,r,i,a){for(var o=[],s=t.children,u,l,c=0,f=0,d=s.length,h,p,g=t.value,m,v,y,b,x,w,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=y=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,x=Math.max(y/S,S/v);f<d;++f){if(m+=l=s[f].value,l<v&&(v=l),l>y&&(y=l),S=m*m*w,b=Math.max(y/S,S/v),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:s.slice(c,f)}),u.dice?Ux(u,n,r,i,g?r+=p*m/g:a):xT(u,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}var kde=function e(t){function n(r,i,a,o,s){Cde(t,r,i,a,o,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Ade);function pot(){var e=kde,t=!1,n=1,r=1,i=[0],a=Bp,o=Bp,s=Bp,u=Bp,l=Bp;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(_de),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=l(d)-h,g+=o(d)-h,m-=s(d)-h,v-=u(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=yT(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:r0(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:r0(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:r0(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:r0(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:r0(+d),c):l},c}function got(e,t,n,r,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,p,g,m,v){if(f>=d-1){var y=a[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=l[f],x=h/2+b,w=f+1,S=d-1;w<S;){var A=w+S>>>1;l[A]<x?w=A+1:S=A}x-l[w-1]<l[w]-x&&f+1<w&&--w;var _=l[w]-b,E=h-_;if(m-p>v-g){var C=h?(p*E+m*_)/h:m;c(f,w,_,p,g,C,v),c(w,d,E,C,g,m,v)}else{var k=h?(g*E+v*_)/h:v;c(f,w,_,p,g,m,k),c(w,d,E,p,k,m,v)}}}function mot(e,t,n,r,i){(e.depth&1?xT:Ux)(e,t,n,r,i)}var vot=function e(t){function n(r,i,a,o,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Ux(l,i,a,o,g?a+=(s-a)*l.value/g:s):xT(l,i,a,g?i+=(o-i)*l.value/g:o,s),g-=l.value}else r._squarify=u=Cde(t,r,i,a,o,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(Ade);function E6(e,t,n){const r={};return e.each(i=>{const a=i.data;n(a)&&(r[t(a)]=i)}),e.lookup=r,e}function A6(e){ve.call(this,null,e)}A6.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const yot=e=>e.values;$e(A6,ve,{transform(e,t){t.source||Se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;return(!a||r||t.changed())&&(a&&a.each(o=>{o.children&&uC(o.data)&&i.rem.push(o.data)}),this.value=a=b6({values:xt(e.keys).reduce((o,s)=>(o.key(s),o),bot()).entries(i.source)},yot),n&&a.each(o=>{o.children&&(o=In(o.data),i.add.push(o),i.source.push(o))}),E6(a,lt,lt)),i.source.root=a,i}});function bot(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,a){if(a>=e.length)return i;const o=i.length,s=e[a++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],a);return l}function r(i,a){if(++a>e.length)return i;const o=[];for(const s in i)o.push({key:s,values:r(i[s],a)});return o}return t}function Fc(e){ve.call(this,null,e)}const xot=(e,t)=>e.parent===t.parent?1:2;$e(Fc,ve,{transform(e,t){(!t.source||!t.source.root)&&Se(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(bp(e.sort,o=>o.data)),wot(n,this.params,e),n.separation&&n.separation(e.separation!==!1?xot:hv);try{this.value=n(i)}catch(o){Se(o)}return i.each(o=>_ot(o,r,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function wot(e,t,n){for(let r,i=0,a=t.length;i<a;++i)r=t[i],r in n&&e[r](n[r])}function _ot(e,t,n){const r=e.data,i=t.length-1;for(let a=0;a<i;++a)r[n[a]]=e[t[a]];r[n[i]]=e.children?e.children.length:0}const C6=["x","y","r","depth","children"];function k6(e){Fc.call(this,e)}k6.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:C6.length,default:C6}]},$e(k6,Fc,{layout:rot,params:["radius","size","padding"],fields:C6});const T6=["x0","y0","x1","y1","depth","children"];function O6(e){Fc.call(this,e)}O6.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:T6.length,default:T6}]},$e(O6,Fc,{layout:iot,params:["size","round","padding"],fields:T6});function I6(e){ve.call(this,null,e)}I6.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},$e(I6,ve,{transform(e,t){t.source||Se("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?E6(Ede().id(e.key).parentId(e.parentKey)(i.source),e.key,fs):E6(Ede()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Tde={tidy:hot,cluster:Tat},N6=["x","y","depth","children"];function D6(e){Fc.call(this,e)}D6.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:N6.length,default:N6}]},$e(D6,Fc,{layout(e){const t=e||"tidy";if(_t(Tde,t))return Tde[t]();Se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:N6});function R6(e){ve.call(this,[],e)}R6.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},$e(R6,ve,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return r||Se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>a[lt(o)]=1),r.each(o=>{const s=o.data,u=o.parent&&o.parent.data;u&&a[lt(s)]&&a[lt(u)]&&i.add.push(In({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>a[lt(o)]=1),n.forEach(o=>{(a[lt(o.source)]||a[lt(o.target)])&&i.mod.push(o)})),i}});const Ode={binary:got,dice:Ux,slice:xT,slicedice:mot,squarify:kde,resquarify:vot},F6=["x0","y0","x1","y1","depth","children"];function M6(e){Fc.call(this,e)}M6.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:F6.length,default:F6}]},$e(M6,Fc,{layout(){const e=pot();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{_t(Ode,t)?e.tile(Ode[t]):Se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:F6});var Sot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:A6,pack:k6,partition:O6,stratify:I6,tree:D6,treelinks:R6,treemap:M6});const Eot=4278190080,Aot=268435456,Cot=.0625;function kot(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Tot(e,t,n,r){const i=e.width,a=e.height,o=n||r,s=Tv(i,a).getContext("2d");t.forEach(m=>Ide(s,m,o));const u=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,g;for(d=0;d<a;++d)for(f=0;f<i;++f)g=u[d*i+f]&Eot,g&&(h=e(f),p=e(d),r||l.set(h,p),o&&g^Aot&&c.set(h,p));return[l,c]}function Ide(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(a=>Ide(e,a.items,n))}):Wo[r].draw(e,{items:n?t.map(Oot):t})}function Oot(e){const t=lC(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=Cot,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Mc=5,ja=31,Wx=32,Fd=new Uint32Array(Wx+1),pu=new Uint32Array(Wx+1);pu[0]=0,Fd[0]=~pu[0];for(let e=1;e<=Wx;++e)pu[e]=pu[e-1]<<1|1,Fd[e]=~pu[e];function Iot(e,t){const n=new Uint32Array(~~((e*t+Wx)/Wx));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const s=o*e+a;return n[s>>>Mc]&1<<(s&ja)},set:(a,o)=>{const s=o*e+a;r(s>>>Mc,1<<(s&ja))},clear:(a,o)=>{const s=o*e+a;i(s>>>Mc,~(1<<(s&ja)))},getRange:(a,o,s,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+a,f=l*e+s,d=c>>>Mc,h=f>>>Mc,d===h){if(n[d]&Fd[c&ja]&pu[(f&ja)+1])return!0}else{if(n[d]&Fd[c&ja]||n[h]&pu[(f&ja)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Mc,d=c>>>Mc,f===d)r(f,Fd[l&ja]&pu[(c&ja)+1]);else for(r(f,Fd[l&ja]),r(d,pu[(c&ja)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Mc,d=c>>>Mc,f===d)i(f,pu[l&ja]|Fd[(c&ja)+1]);else for(i(f,pu[l&ja]),i(d,Fd[(c&ja)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(a,o,s,u)=>a<0||o<0||u>=t||s>=e}}function Not(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=s=>~~((s+n)/r);return o.invert=s=>s*r-n,o.bitmap=()=>Iot(i,a),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function Dot(e,t,n,r){const i=e.width,a=e.height;return function(o){const s=o.datum.datum.items[r].items,u=s.length,l=o.datum.fontSize,c=hl.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,v,y;for(let b=0;b<u;++b)d=s[b].x,p=s[b].y,h=s[b].x2===void 0?d:s[b].x2,g=s[b].y2===void 0?p:s[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=v);return m=c/2,v=l/2,d=o.x-m,h=o.x+m,p=o.y-v,g=o.y+v,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&g<=a?o.baseline="top":0<=p&&a<g&&(o.baseline="bottom"),!0}}function wT(e,t,n,r,i,a){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function Md(e,t,n,r,i,a,o,s){const u=i*a/(r*2),l=e(t-u),c=e(t+u),f=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function Rot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,v=a,y;if(!wT(p,g,d,h,i,a)&&!Md(e,p,g,h,d,m,o,s)&&!Md(e,p,g,h,d,h,o,null)){for(;v-m>=1;)y=(m+v)/2,Md(e,p,g,h,d,y,o,s)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=hl.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,v=0,y,b,x,w,S,A,_,E,C,k,T,I,N,O,D,L,W;for(let G=0;G<f;++G){for(y=c[G].x,x=c[G].y,b=c[G].x2===void 0?y:c[G].x2,w=c[G].y2===void 0?x:c[G].y2,y>b&&(W=y,y=b,b=W),x>w&&(W=x,x=w,w=W),C=e(y),T=e(b),k=~~((C+T)/2),I=e(x),O=e(w),N=~~((I+O)/2),_=k;_>=C;--_)for(E=N;E>=I;--E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);for(_=k;_<=T;++_)for(E=N;E<=O;++E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);!g&&!n&&(D=Math.abs(b-y+w-x),S=(y+b)/2,A=(x+w)/2,D>=v&&!wT(S,A,h,d,i,a)&&!Md(e,S,A,d,h,d,o,null)&&(v=D,l.x=S,l.y=A,m=!0))}return g||m?(S=h/2,A=d/2,o.setRange(e(l.x-S),e(l.y-A),e(l.x+S),e(l.y+A)),l.align="center",l.baseline="middle",!0):!1}}const Fot=[-1,-1,1,1],Mot=[-1,1,-1,1];function Pot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=hl.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,v=!1,y=0,b,x,w,S,A,_,E,C,k,T,I,N;for(let O=0;O<f;++O){for(b=c[O].x,w=c[O].y,x=c[O].x2===void 0?b:c[O].x2,S=c[O].y2===void 0?w:c[O].y2,p.push([e((b+x)/2),e((w+S)/2)]);p.length;)if([E,C]=p.pop(),!(o.get(E,C)||s.get(E,C)||u.get(E,C))){u.set(E,C);for(let D=0;D<4;++D)A=E+Fot[D],_=C+Mot[D],u.outOfBounds(A,_,A,_)||p.push([A,_]);if(A=e.invert(E),_=e.invert(C),k=g,T=a,!wT(A,_,h,d,i,a)&&!Md(e,A,_,d,h,k,o,s)&&!Md(e,A,_,d,h,d,o,null)){for(;T-k>=1;)I=(k+T)/2,Md(e,A,_,d,h,I,o,s)?T=I:k=I;k>g&&(l.x=A,l.y=_,g=k,m=!0)}}!m&&!n&&(N=Math.abs(x-b+S-w),A=(b+x)/2,_=(w+S)/2,N>=y&&!wT(A,_,h,d,i,a)&&!Md(e,A,_,d,h,d,o,null)&&(y=N,l.x=A,l.y=_,v=!0))}return m||v?(A=h/2,_=d/2,o.setRange(e(l.x-A),e(l.y-_),e(l.x+A),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const $ot=["right","center","left"],Lot=["bottom","middle","top"];function Bot(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>a)return!1;let d=0,h,p,g,m,v,y,b,x,w,S,A,_,E,C,k;for(let T=0;T<u;++T){if(h=(n[T]&3)-1,p=(n[T]>>>2&3)-1,g=h===0&&p===0||r[T]<0,m=h&&p?Math.SQRT1_2:1,v=r[T]<0?-1:1,y=c[1+h]+r[T]*h*m,A=c[4+p]+v*f*p/2+r[T]*p*m,x=A-f/2,w=A+f/2,_=e(y),C=e(x),k=e(w),!d)if(Nde(_,_,C,k,o,s,y,y,x,w,c,g))d=hl.width(l.datum,l.datum.text);else continue;if(S=y+v*d*h/2,y=S-d/2,b=S+d/2,_=e(y),E=e(b),Nde(_,E,C,k,o,s,y,b,x,w,c,g))return l.x=h?h*v<0?b:y:S,l.y=p?p*v<0?w:x:A,l.align=$ot[h*v+1],l.baseline=Lot[p*v+1],o.setRange(_,C,E,k),!0}return!1}}function Nde(e,t,n,r,i,a,o,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&a?a.getRange(e,n,t,r)||!zot(o,u,s,l,c):i.getRange(e,n,t,r)))}function zot(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const P6=0,$6=4,L6=8,B6=0,z6=1,j6=2,jot={"top-left":P6+B6,top:P6+z6,"top-right":P6+j6,left:$6+B6,middle:$6+z6,right:$6+j6,"bottom-left":L6+B6,bottom:L6+z6,"bottom-right":L6+j6},Uot={naive:Dot,"reduced-search":Rot,floodfill:Pot};function Wot(e,t,n,r,i,a,o,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=Vot(r,f),h=qot(i,f),p=Hot(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",v=Got(p,g,s,u),y=Not(t[0],t[1],l),b=m&&c==="naive",x=e.map(A=>({datum:A,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(A)}));let w;if(!b){n&&x.sort((_,E)=>n(_.datum,E.datum));let A=!1;for(let _=0;_<h.length&&!A;++_)A=h[_]===5||d[_]<0;p&&(o||m)&&(a=[e.map(_=>_.datum)].concat(a)),w=a.length?Tot(y,a,A,m):kot(y,o&&x)}const S=m?Uot[c](y,w,o,u):Bot(y,w,h,d);return x.forEach(A=>A.opacity=+S(A)),x}function Vot(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function qot(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=jot[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Hot(e){return e&&e.mark&&e.mark.marktype}function Got(e,t,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>i(a.datum):t==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const U6=["x","y","opacity","align","baseline"],Dde=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function W6(e){ve.call(this,null,e)}W6.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Dde},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:U6.length,default:U6}]},$e(W6,ve,{transform(e,t){function n(a){const o=e[a];return $t(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Se("Size parameter should be specified as a [width, height] array.");const i=e.as||U6;return Wot(t.materialize(t.SOURCE).source,e.size,e.sort,xt(e.offset||1),xt(e.anchor||Dde),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),t.reflow(r).modifies(i)}});var Kot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:W6});function Rde(e,t){var n=[],r=function(c){return c(s)},i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function V6(e){ve.call(this,null,e)}V6.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},$e(V6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Rde(r,e.groupby),a=(e.groupby||[]).map(Ir),o=a.length,s=e.as||[Ir(e.x),Ir(e.y)],u=[];i.forEach(l=>{Bae(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[a[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(In(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const q6={linear:P4,log:Rae,exp:Fae,pow:Mae,quad:$4,poly:Pae},Xot=(e,t)=>e==="poly"?t:e==="quad"?2:1;function H6(e){ve.call(this,null,e)}H6.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(q6)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},$e(H6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Rde(r,e.groupby),a=(e.groupby||[]).map(Ir),o=e.method||"linear",s=e.order||3,u=Xot(o,s),l=e.as||[Ir(e.x),Ir(e.y)],c=q6[o],f=[];let d=e.extent;_t(q6,o)||Se("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,s);if(e.params){f.push(In({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||nl(h,e.x),v=y=>{const b={};for(let x=0;x<a.length;++x)b[a[x]]=h.dims[x];b[l[0]]=y[0],b[l[1]]=y[1],f.push(In(b))};o==="linear"?m.forEach(y=>v([y,g.predict(y)])):bC(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var Yot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:V6,regression:H6});const Fde=Math.pow(2,-52),_T=new Uint32Array(512);class ST{static from(t,n=tst,r=nst){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new ST(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let C=0;C<o;C++){const k=t[2*C],T=t[2*C+1];k<s&&(s=k),T<u&&(u=T),k>l&&(l=k),T>c&&(c=T),this._ids[C]=C}const f=(s+l)/2,d=(u+c)/2;let h=1/0,p,g,m;for(let C=0;C<o;C++){const k=G6(f,d,t[2*C],t[2*C+1]);k<h&&(p=C,h=k)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let C=0;C<o;C++){if(C===p)continue;const k=G6(v,y,t[2*C],t[2*C+1]);k<h&&k>0&&(g=C,h=k)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let C=0;C<o;C++){if(C===p||C===g)continue;const k=Qot(v,y,b,x,t[2*C],t[2*C+1]);k<w&&(m=C,w=k)}let S=t[2*m],A=t[2*m+1];if(w===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];i0(this._ids,this._dists,0,o-1);const C=new Uint32Array(o);let k=0;for(let T=0,I=-1/0;T<o;T++){const N=this._ids[T];this._dists[N]>I&&(C[k++]=N,I=this._dists[N])}this.hull=C.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(ET(v,y,b,x,S,A)){const C=g,k=b,T=x;g=m,b=S,x=A,m=C,S=k,A=T}const _=est(v,y,b,x,S,A);this._cx=_.x,this._cy=_.y;for(let C=0;C<o;C++)this._dists[C]=G6(t[2*C],t[2*C+1],_.x,_.y);i0(this._ids,this._dists,0,o-1),this._hullStart=p;let E=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,a.fill(-1),a[this._hashKey(v,y)]=p,a[this._hashKey(b,x)]=g,a[this._hashKey(S,A)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let C=0,k,T;C<this._ids.length;C++){const I=this._ids[C],N=t[2*I],O=t[2*I+1];if(C>0&&Math.abs(N-k)<=Fde&&Math.abs(O-T)<=Fde||(k=N,T=O,I===p||I===g||I===m))continue;let D=0;for(let ee=0,ce=this._hashKey(N,O);ee<this._hashSize&&(D=a[(ce+ee)%this._hashSize],!(D!==-1&&D!==r[D]));ee++);D=n[D];let L=D,W;for(;W=r[L],!ET(N,O,t[2*L],t[2*L+1],t[2*W],t[2*W+1]);)if(L=W,L===D){L=-1;break}if(L===-1)continue;let G=this._addTriangle(L,I,r[L],-1,-1,i[L]);i[I]=this._legalize(G+2),i[L]=G,E++;let K=r[L];for(;W=r[K],ET(N,O,t[2*K],t[2*K+1],t[2*W],t[2*W+1]);)G=this._addTriangle(K,I,W,i[I],-1,i[K]),i[I]=this._legalize(G+2),r[K]=K,E--,K=W;if(L===D)for(;W=n[L],ET(N,O,t[2*W],t[2*W+1],t[2*L],t[2*L+1]);)G=this._addTriangle(W,I,L,-1,i[L],i[W]),this._legalize(G+2),i[W]=G,r[L]=L,E--,L=W;this._hullStart=n[I]=L,r[L]=n[K]=I,r[I]=K,a[this._hashKey(N,O)]=I,a[this._hashKey(t[2*L],t[2*L+1])]=L}this.hull=new Uint32Array(E);for(let C=0,k=this._hullStart;C<E;C++)this.hull[C]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Zot(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const s=r[t],u=t-t%3;if(o=u+(t+2)%3,s===-1){if(a===0)break;t=_T[--a];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(Jot(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[s]=d;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(s,r[o]),this._link(o,f);const y=l+(s+1)%3;a<_T.length&&(_T[a++]=y)}else{if(a===0)break;t=_T[--a]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,a,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,a),this._link(s+2,o),this.trianglesLen+=3,s}}function Zot(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function G6(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function K6(e,t,n,r,i,a){const o=(r-t)*(i-e),s=(n-e)*(a-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function ET(e,t,n,r,i,a){return(K6(i,a,e,t,n,r)||K6(e,t,n,r,i,a)||K6(n,r,i,a,e,t))<0}function Jot(e,t,n,r,i,a,o,s){const u=e-o,l=t-s,c=n-o,f=r-s,d=i-o,h=a-s,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function Qot(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=(l*c-s*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function est(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=e+(l*c-s*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function i0(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=e[i],o=t[a];let s=i-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{const i=n+r>>1;let a=n+1,o=r;Vx(e,i,a),t[e[n]]>t[e[r]]&&Vx(e,n,r),t[e[a]]>t[e[r]]&&Vx(e,a,r),t[e[n]]>t[e[a]]&&Vx(e,n,a);const s=e[a],u=t[s];for(;;){do a++;while(t[e[a]]<u);do o--;while(t[e[o]]>u);if(o<a)break;Vx(e,a,o)}e[n+1]=e[o],e[o]=s,r-a+1>=o-n?(i0(e,t,a,r),i0(e,t,n,o-1)):(i0(e,t,n,o-1),i0(e,t,a,r))}}function Vx(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function tst(e){return e[0]}function nst(e){return e[1]}const Mde=1e-6;class zp{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>Mde||Math.abs(this._y1-a)>Mde)&&(this._+="L"+i+","+a),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class X6{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class rst{constructor(t,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,g=r.length,m,v;h<g;h+=3,p+=2){const y=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[y],S=t[y+1],A=t[b],_=t[b+1],E=t[x],C=t[x+1],k=A-w,T=_-S,I=E-w,N=C-S,O=k*k+T*T,D=I*I+N*N,L=(k*N-T*I)*2;if(!L)m=(w+E)/2-1e8*N,v=(S+C)/2+1e8*I;else if(Math.abs(L)<1e-8)m=(w+E)/2,v=(S+C)/2;else{const W=1/L;m=w+(N*O-T*D)*W,v=S+(k*D-I*O)*W}a[p]=m,a[p+1]=v}let o=n[n.length-1],s,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],s=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new zp:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:s}=this;if(a.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],v=o[p],y=o[p+1];this._renderSegment(g,m,v,y,t)}let u,l=a[a.length-1];for(let c=0;c<a.length;++c){u=l,l=a[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,s[p+2],s[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new zp:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new zp:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new X6;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,a){let o;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(a.moveTo(t,n),a.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,s,u))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let a=0,o=n.length;a<o;a+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[a]==i[s]&&n[a+1]==i[s+1]&&n[(a+2)%o]==i[(s+u-2)%u]&&n[(a+3)%o]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[t];if(o===-1)return null;const s=[];let u=o;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,a[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,a,o,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(a=s,o=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let p,g,m,v,y;if(l===0){if((p=this._clipSegment(a,o,s,u,l,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(s,u,a,o,c,l))===null)continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,a,o){for(;;){if(a===0&&o===0)return[t,n,r,i];if(a&o)return null;let s,u,l=a||o;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),a?(t=s,n=u,a=this._regioncode(t,n)):(r=s,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,a,o){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],a,o))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,a){for(;n!==r;){let o,s;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,s=this.ymin;break}(i[a]!==o||i[a+1]!==s)&&this.contains(t,o,s)&&(i.splice(a,0,o,s),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const s=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[s]&&i[s]===i[u]||i[o+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),o-=2)}return a}_project(t,n,r,i){let a=1/0,o,s,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(u=this.ymin,s=t+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(u=this.ymax,s=t+(a=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<a&&(s=this.xmax,u=n+(a=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<a&&(s=this.xmin,u=n+(a=o)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const ist=2*Math.PI,a0=Math.pow;function ast(e){return e[0]}function ost(e){return e[1]}function sst(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function ust(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class Y6{static from(t,n=ast,r=ost,i){return new Y6("length"in t?lst(t,n,r,i):Float64Array.from(cst(t,n,r,i)))}constructor(t){this._delaunator=new ST(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&sst(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=ust(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new ST(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=a[u%3==2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new rst(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=a[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,t,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(t,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=a0(n-l[t*2],2)+a0(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=a0(n-l[p*2],2)+a0(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=a[(o[t]+1)%a.length],h!==p&&a0(n-l[h*2],2)+a0(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new zp:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,s=i.length;o<s;++o){const u=i[o];if(u<o)continue;const l=a[o]*2,c=a[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new zp:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const s=i[a],u=i[a+1];t.moveTo(s+n,u),t.arc(s,u,n,0,ist)}return r&&r.value()}renderHull(t){const n=t==null?t=new zp:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;t.moveTo(i[a],i[a+1]);for(let s=1;s<o;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new X6;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new zp:void 0,{points:i,triangles:a}=this,o=a[t*=3]*2,s=a[t+1]*2,u=a[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new X6;return this.renderTriangle(t,n),n.value()}}function lst(e,t,n,r){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const s=e[o];a[o*2]=t.call(r,s,o,e),a[o*2+1]=n.call(r,s,o,e)}return a}function*cst(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}function Z6(e){ve.call(this,null,e)}Z6.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const fst=[-1e5,-1e5,1e5,1e5];$e(Z6,ve,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:fst;const a=this.value=Y6.from(r,e.x,e.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const u=a.cellPolygon(o);r[o][n]=u?dst(u):null}return t.reflow(e.modified()).modifies(n)}});function dst(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var hst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:Z6}),J6=Math.PI/180,qx=1<<11>>5,AT=1<<11;function pst(){var e=[256,256],t,n,r,i,a,o,s,u=Pde,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Tv()),g=xst((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],x=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:a(S),rotate:o(S),size:~~(r(S)+1e-14),padding:s(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,A)=>A.size-S.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,gst(p,w,x,y),w.hasText&&h(g,w,m)&&(b.push(w),m?vst(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(qx<<5)/g,p.height=AT/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,A,_,E;(A=x(S+=w))&&(_=~~A[0],E=~~A[1],!(Math.min(Math.abs(_),Math.abs(E))>=b));)if(g.x=v+_,g.y=y+E,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!mst(g,p,e[0]))&&(!m||yst(g,m))){for(var C=g.sprite,k=g.width>>5,T=e[0]>>5,I=g.x-(k<<4),N=I&127,O=32-N,D=g.y1-g.y0,L=(g.y+g.y0)*T+(I>>5),W,G=0;G<D;G++){W=0;for(var K=0;K<=k;K++)p[L+K]|=W<<O|(K<k?(W=C[G*k+K])>>>N:0);L+=T}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=jp(p),f):n},f.fontStyle=function(p){return arguments.length?(i=jp(p),f):i},f.fontWeight=function(p){return arguments.length?(a=jp(p),f):a},f.rotate=function(p){return arguments.length?(o=jp(p),f):o},f.text=function(p){return arguments.length?(t=jp(p),f):t},f.spiral=function(p){return arguments.length?(u=wst[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=jp(p),f):r},f.padding=function(p){return arguments.length?(s=jp(p),f):s},f.random=function(p){return arguments.length?(c=p,f):c},f}function gst(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(qx<<5)/a,AT/a);var o=0,s=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,c=i.measureText(t.text+"m").width*a,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*J6),m=Math.cos(t.rotate*J6),v=c*m,y=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=qx<<5&&(o=0,s+=u,u=0),s+d>=AT)break;i.translate((o+(c>>1))/a,(s+(d>>1))/a),t.rotate&&i.rotate(t.rotate*J6),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(qx<<5)/a,AT/a).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;s=t.yoff;var A=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),C=w[(s+p)*(qx<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=C,A|=C}A?_=p:(t.y0++,d--,p--,s++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function mst(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function vst(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function yst(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Pde(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function bst(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function xst(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function jp(e){return typeof e=="function"?e:function(){return e}}var wst={archimedean:Pde,rectangular:bst};const $de=["x","y","font","fontSize","fontStyle","fontWeight","angle"],_st=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Q6(e){ve.call(this,pst(),e)}Q6.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:$de}]},$e(Q6,ve,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Se("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return $t(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||_st.some(n)))return;const i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||$de;let s=e.fontSize||14,u;if($t(s)?u=e.fontSizeRange:s=Ji(s),u){const p=s,g=Sn("sqrt")().domain(nl(i,p)).range(u);s=m=>g(p(m))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(ps).layout(),c=a.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(r).modifies(o)}});var Sst=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:Q6});const Est=e=>new Uint8Array(e),Ast=e=>new Uint16Array(e),Hx=e=>new Uint32Array(e);function Cst(){let e=8,t=[],n=Hx(0),r=CT(0,e),i=CT(0,e);return{data:()=>t,seen:()=>n=kst(n,t.length),add(a){for(let o=0,s=t.length,u=a.length,l;o<u;++o)l=a[o],l._index=s++,t.push(l)},remove(a,o){const s=t.length,u=Array(s-a),l=t;let c,f,d;for(f=0;!o[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const s=r.length;(a>s||o>e)&&(e=Math.max(o,e),r=CT(a,e,r),i=CT(a,e))}}}function kst(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function CT(e,t,n){const r=(t<257?Est:t<65537?Ast:Hx)(e);return n&&r.set(n),r}function Lde(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,a){const o=this,s=o.bisect(o.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)a[u[d]]|=r;for(d=c;d<f;++d)a[u[d]]|=r;return o}}}function Bde(){let e=Hx(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Hx(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=Tst(h,d),c)p=t,g=e,t=Array(c+f),e=Hx(c+f),Ost(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function a(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function o(s,u){let l;return u?l=u.length:(u=t,l=n),[vGe(u,s[0],0,l),JA(u,s[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>e,size:()=>n}}function Tst(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],a=e[r];return i<a?-1:i>a?1:0}),xGe(e,t)}function Ost(e,t,n,r,i,a,o,s,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}function ej(e){ve.call(this,Cst(),e),this._indices=null,this._dims=null}ej.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},$e(ej,ve,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;let s=0,u,l;for(;s<o;++s)u=n[s].fname,l=i[u]||(i[u]=Bde()),a.push(Lde(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,x,w,S,A;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,S=y.length;w<S;++w)x[y[w]._index]=1;for(w=0;w<h;++w)A=r[w],(!o[w]||e.modified("fields",w)||t.modified(A.fields))&&(v=A.fname,(g=p[v])||(a[v]=m=Bde(),p[v]=g=m.insert(A,t.source,0)),o[w]=Lde(m,w,i[w]).onAdd(g,u));for(w=0,S=s.data().length;w<S;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,a=this._dims,o=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=a.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=s[h].fname,g=u[p]||(u[p]=o[p].insert(s[h],r,d)),a[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;let s,u,l;for(s=0,u=o.length;s<u;++s)l=o[s]._index,i[l]!==a&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const a=i.remove(t,n);for(const o in r)r[o].reindex(a)})},update(e,t,n){const r=this._dims,i=e.query,a=t.stamp,o=r.length;let s=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<o;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,a=i.curr(),o=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],a[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],a[m]^=h,r.push(m);e.range=t.slice()}});function tj(e){ve.call(this,null,e)}tj.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},$e(tj,ve,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const a=t.fork(t.ALL),o=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:o[c];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?o[c]:null}),a.filter(a.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(a.filter(a.ADD,l),a.filter(a.REM,c=>(s[c]&n)===i?o[c]:null)),a.filter(a.SOURCE,c=>l(c._index))}});var Ist=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:ej,resolvefilter:tj});const Nst="RawCode",Up="Literal",Dst="Property",Rst="Identifier",Fst="ArrayExpression",Mst="BinaryExpression",zde="CallExpression",Pst="ConditionalExpression",$st="LogicalExpression",Lst="MemberExpression",Bst="ObjectExpression",zst="UnaryExpression";function gu(e){this.type=e}gu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=jst(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function jst(e){switch(e.type){case Fst:return e.elements;case Mst:case $st:return[e.left,e.right];case zde:return[e.callee].concat(e.arguments);case Pst:return[e.test,e.consequent,e.alternate];case Lst:return[e.object,e.property];case Bst:return e.properties;case Dst:return[e.key,e.value];case zst:return[e.argument];case Rst:case Up:case Nst:default:return[]}}var xl,at,we,aa,zn,kT=1,Gx=2,Wp=3,Pd=4,TT=5,Vp=6,po=7,Kx=8,Ust=9;xl={},xl[kT]="Boolean",xl[Gx]="<end>",xl[Wp]="Identifier",xl[Pd]="Keyword",xl[TT]="Null",xl[Vp]="Numeric",xl[po]="Punctuator",xl[Kx]="String",xl[Ust]="RegularExpression";var Wst="ArrayExpression",Vst="BinaryExpression",qst="CallExpression",Hst="ConditionalExpression",jde="Identifier",Gst="Literal",Kst="LogicalExpression",Xst="MemberExpression",Yst="ObjectExpression",Zst="Property",Jst="UnaryExpression",Si="Unexpected token %0",Qst="Unexpected number",eut="Unexpected string",tut="Unexpected identifier",nut="Unexpected reserved word",rut="Unexpected end of input",nj="Invalid regular expression",rj="Invalid regular expression: missing /",Ude="Octal literals are not allowed in strict mode.",iut="Duplicate data property in object literal not allowed in strict mode",ji="ILLEGAL",Xx="Disabled.",aut=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),out=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function OT(e,t){if(!e)throw new Error("ASSERT: "+t)}function Pc(e){return e>=48&&e<=57}function ij(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Yx(e){return"01234567".indexOf(e)>=0}function sut(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Zx(e){return e===10||e===13||e===8232||e===8233}function Jx(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&aut.test(String.fromCharCode(e))}function IT(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&out.test(String.fromCharCode(e))}const uut={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Wde(){for(;we<aa;){const e=at.charCodeAt(we);if(sut(e)||Zx(e))++we;else break}}function aj(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<aa&&ij(at[we])?(r=at[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):En({},Si,ji);return String.fromCharCode(i)}function lut(){var e,t,n,r;for(e=at[we],t=0,e==="}"&&En({},Si,ji);we<aa&&(e=at[we++],!!ij(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&En({},Si,ji),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Vde(){var e,t;for(e=at.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=aj("u"),(!e||e==="\\"||!Jx(e.charCodeAt(0)))&&En({},Si,ji),t=e);we<aa&&(e=at.charCodeAt(we),!!IT(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=aj("u"),(!e||e==="\\"||!IT(e.charCodeAt(0)))&&En({},Si,ji),t+=e);return t}function cut(){var e,t;for(e=we++;we<aa;){if(t=at.charCodeAt(we),t===92)return we=e,Vde();if(IT(t))++we;else break}return at.slice(e,we)}function fut(){var e,t,n;return e=we,t=at.charCodeAt(we)===92?Vde():cut(),t.length===1?n=Wp:uut.hasOwnProperty(t)?n=Pd:t==="null"?n=TT:t==="true"||t==="false"?n=kT:n=Wp,{type:n,value:t,start:e,end:we}}function oj(){var e=we,t=at.charCodeAt(we),n,r=at[we],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:po,value:String.fromCharCode(t),start:e,end:we};default:if(n=at.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:po,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,at.charCodeAt(we)===61&&++we,{type:po,value:at.slice(e,we),start:e,end:we}}}if(o=at.substr(we,4),o===">>>=")return we+=4,{type:po,value:o,start:e,end:we};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return we+=3,{type:po,value:a,start:e,end:we};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:po,value:i,start:e,end:we};if(i==="//"&&En({},Si,ji),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:po,value:r,start:e,end:we};En({},Si,ji)}function dut(e){let t="";for(;we<aa&&ij(at[we]);)t+=at[we++];return t.length===0&&En({},Si,ji),Jx(at.charCodeAt(we))&&En({},Si,ji),{type:Vp,value:parseInt("0x"+t,16),start:e,end:we}}function hut(e){let t="0"+at[we++];for(;we<aa&&Yx(at[we]);)t+=at[we++];return(Jx(at.charCodeAt(we))||Pc(at.charCodeAt(we)))&&En({},Si,ji),{type:Vp,value:parseInt(t,8),octal:!0,start:e,end:we}}function qde(){var e,t,n;if(n=at[we],OT(Pc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=at[we++],n=at[we],e==="0"){if(n==="x"||n==="X")return++we,dut(t);if(Yx(n))return hut(t);n&&Pc(n.charCodeAt(0))&&En({},Si,ji)}for(;Pc(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="."){for(e+=at[we++];Pc(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="e"||n==="E")if(e+=at[we++],n=at[we],(n==="+"||n==="-")&&(e+=at[we++]),Pc(at.charCodeAt(we)))for(;Pc(at.charCodeAt(we));)e+=at[we++];else En({},Si,ji);return Jx(at.charCodeAt(we))&&En({},Si,ji),{type:Vp,value:parseFloat(e),start:t,end:we}}function put(){var e="",t,n,r,i,a=!1;for(t=at[we],OT(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<aa;)if(r=at[we++],r===t){t="";break}else if(r==="\\")if(r=at[we++],!r||!Zx(r.charCodeAt(0)))switch(r){case"u":case"x":at[we]==="{"?(++we,e+=lut()):e+=aj(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Yx(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),we<aa&&Yx(at[we])&&(a=!0,i=i*8+"01234567".indexOf(at[we++]),"0123".indexOf(r)>=0&&we<aa&&Yx(at[we])&&(i=i*8+"01234567".indexOf(at[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&at[we]===`
`&&++we;else{if(Zx(r.charCodeAt(0)))break;e+=r}return t!==""&&En({},Si,ji),{type:Kx,value:e,octal:a,start:n,end:we}}function gut(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";En({},nj)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){En({},nj)}try{return new RegExp(e,t)}catch(r){return null}}function mut(){var e,t,n,r,i;for(e=at[we],OT(e==="/","Regular expression literal must start with a slash"),t=at[we++],n=!1,r=!1;we<aa;)if(e=at[we++],t+=e,e==="\\")e=at[we++],Zx(e.charCodeAt(0))&&En({},rj),t+=e;else if(Zx(e.charCodeAt(0)))En({},rj);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||En({},rj),i=t.substr(1,t.length-2),{value:i,literal:t}}function vut(){var e,t,n;for(t="",n="";we<aa&&(e=at[we],!!IT(e.charCodeAt(0)));)++we,e==="\\"&&we<aa?En({},Si,ji):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&En({},nj,n),{value:n,literal:t}}function yut(){var e,t,n,r;return zn=null,Wde(),e=we,t=mut(),n=vut(),r=gut(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function but(e){return e.type===Wp||e.type===Pd||e.type===kT||e.type===TT}function Hde(){if(Wde(),we>=aa)return{type:Gx,start:we,end:we};const e=at.charCodeAt(we);return Jx(e)?fut():e===40||e===41||e===59?oj():e===39||e===34?put():e===46?Pc(at.charCodeAt(we+1))?qde():oj():Pc(e)?qde():oj()}function go(){const e=zn;return we=e.end,zn=Hde(),we=e.end,e}function Gde(){const e=we;zn=Hde(),we=e}function xut(e){const t=new gu(Wst);return t.elements=e,t}function Kde(e,t,n){const r=new gu(e==="||"||e==="&&"?Kst:Vst);return r.operator=e,r.left=t,r.right=n,r}function wut(e,t){const n=new gu(qst);return n.callee=e,n.arguments=t,n}function _ut(e,t,n){const r=new gu(Hst);return r.test=e,r.consequent=t,r.alternate=n,r}function sj(e){const t=new gu(jde);return t.name=e,t}function Qx(e){const t=new gu(Gst);return t.value=e.value,t.raw=at.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Xde(e,t,n){const r=new gu(Xst);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Sut(e){const t=new gu(Yst);return t.properties=e,t}function Yde(e,t,n){const r=new gu(Zst);return r.key=t,r.value=n,r.kind=e,r}function Eut(e,t){const n=new gu(Jst);return n.operator=e,n.argument=t,n.prefix=!0,n}function En(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(a,o)=>(OT(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=we,n.description=i,n}function NT(e){e.type===Gx&&En(e,rut),e.type===Vp&&En(e,Qst),e.type===Kx&&En(e,eut),e.type===Wp&&En(e,tut),e.type===Pd&&En(e,nut),En(e,Si,e.value)}function oa(e){const t=go();(t.type!==po||t.value!==e)&&NT(t)}function ar(e){return zn.type===po&&zn.value===e}function uj(e){return zn.type===Pd&&zn.value===e}function Aut(){const e=[];for(we=zn.start,oa("[");!ar("]");)ar(",")?(go(),e.push(null)):(e.push(qp()),ar("]")||oa(","));return go(),xut(e)}function Zde(){we=zn.start;const e=go();return e.type===Kx||e.type===Vp?(e.octal&&En(e,Ude),Qx(e)):sj(e.value)}function Cut(){var e,t,n,r;if(we=zn.start,e=zn,e.type===Wp)return n=Zde(),oa(":"),r=qp(),Yde("init",n,r);if(e.type===Gx||e.type===po)NT(e);else return t=Zde(),oa(":"),r=qp(),Yde("init",t,r)}function kut(){var e=[],t,n,r,i={},a=String;for(we=zn.start,oa("{");!ar("}");)t=Cut(),t.key.type===jde?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?En({},iut):i[r]=!0,e.push(t),ar("}")||oa(",");return oa("}"),Sut(e)}function Tut(){oa("(");const e=lj();return oa(")"),e}const Out={if:1};function Iut(){var e,t,n;if(ar("("))return Tut();if(ar("["))return Aut();if(ar("{"))return kut();if(e=zn.type,we=zn.start,e===Wp||Out[zn.value])n=sj(go().value);else if(e===Kx||e===Vp)zn.octal&&En(zn,Ude),n=Qx(go());else{if(e===Pd)throw new Error(Xx);e===kT?(t=go(),t.value=t.value==="true",n=Qx(t)):e===TT?(t=go(),t.value=null,n=Qx(t)):ar("/")||ar("/=")?(n=Qx(yut()),Gde()):NT(go())}return n}function Nut(){const e=[];if(oa("("),!ar(")"))for(;we<aa&&(e.push(qp()),!ar(")"));)oa(",");return oa(")"),e}function Dut(){we=zn.start;const e=go();return but(e)||NT(e),sj(e.value)}function Rut(){return oa("."),Dut()}function Fut(){oa("[");const e=lj();return oa("]"),e}function Mut(){var e,t,n;for(e=Iut();;)if(ar("."))n=Rut(),e=Xde(".",e,n);else if(ar("("))t=Nut(),e=wut(e,t);else if(ar("["))n=Fut(),e=Xde("[",e,n);else break;return e}function Jde(){const e=Mut();if(zn.type===po&&(ar("++")||ar("--")))throw new Error(Xx);return e}function DT(){var e,t;if(zn.type!==po&&zn.type!==Pd)t=Jde();else{if(ar("++")||ar("--"))throw new Error(Xx);if(ar("+")||ar("-")||ar("~")||ar("!"))e=go(),t=DT(),t=Eut(e.value,t);else{if(uj("delete")||uj("void")||uj("typeof"))throw new Error(Xx);t=Jde()}}return t}function Qde(e){let t=0;if(e.type!==po&&e.type!==Pd)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Put(){var e,t,n,r,i,a,o,s,u,l;if(e=zn,u=DT(),r=zn,i=Qde(r),i===0)return u;for(r.prec=i,go(),t=[e,zn],o=DT(),a=[u,r,o];(i=Qde(zn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=Kde(s,u,o),a.push(n);r=go(),r.prec=i,a.push(r),t.push(zn),n=DT(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=Kde(a[l-1].value,a[l-2],n),l-=2;return n}function qp(){var e,t,n;return e=Put(),ar("?")&&(go(),t=qp(),oa(":"),n=qp(),e=_ut(e,t,n)),e}function lj(){const e=qp();if(ar(","))throw new Error(Xx);return e}function ehe(e){at=e,we=0,aa=at.length,zn=null,Gde();const t=lj();if(zn.type!==Gx)throw new Error("Unexpect token after expression.");return t}var the={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function nhe(e){function t(o,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(o,s,u){return l=>t(o,l,s,u)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Se("Missing arguments to clamp function."),o.length>3&&Se("Too many arguments to clamp function.");const s=o.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&Se("Missing arguments to if function."),o.length>3&&Se("Too many arguments to if function.");const s=o.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function $ut(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function rhe(e){e=e||{};const t=e.allowed?iu(e.allowed):{},n=e.forbidden?iu(e.forbidden):{},r=e.constants||the,i=(e.functions||nhe)(f),a=e.globalvar,o=e.fieldvar,s=$t(a)?a:p=>"".concat(a,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(Bn(p))return p;const g=d[p.type];return g==null&&Se("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:_t(n,g)?Se("Illegal identifier: "+g):_t(r,g)?r[g]:_t(t,g)?g:(u[g]=1,s(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===o&&(l[$ut(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Se("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=_t(i,g)&&i[g];return v||Se("Unrecognized function: "+g),$t(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function Lut(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function But(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=zut(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function zut(e){return(t,n)=>Lut(e(t),n)}const cj="intersect",ihe="union",jut="vlMulti",Uut="vlPoint",ahe="or",Wut="and",Vut="_vgsid_",qut="E",Hut="R",Gut="R-E",Kut="R-LE",Xut="R-RE",RT="index:unit";function ohe(e,t){for(var n=t.fields,r=t.values,i=n.length,a=0,o,s;a<i;++a)if(s=n[a],s.getter=ao.getter||ao(s.field),o=s.getter(e),Qf(o)&&(o=Zi(o)),Qf(r[a])&&(r[a]=Zi(r[a])),Qf(r[a][0])&&(r[a]=r[a].map(Zi)),s.type===qut){if(ut(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(s.type===Hut){if(!gv(o,r[a]))return!1}else if(s.type===Xut){if(!gv(o,r[a],!0,!1))return!1}else if(s.type===Gut){if(!gv(o,r[a],!1,!1))return!1}else if(s.type===Kut&&!gv(o,r[a],!1,!0))return!1;return!0}function Yut(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],a=r?r[RT]&&r[RT].value:void 0,o=n===cj,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],a&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=ohe(t,l),c[d]=h?-1:++f,h&&a.size===1)return!0;if(!h&&f===a.get(d).count)return!1}else if(h=ohe(t,l),o^h)return h;return s&&o}const fj=ao(Vut),she=But(fj),Zut=she.left,Jut=she.right;function Qut(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],a=r?r[RT]&&r[RT].value:void 0,o=n===cj,s=fj(t),u=Zut(i,s);if(u===i.length||fj(i[u])!==s)return!1;if(a&&o){if(a.size===1)return!0;if(Jut(i,s)-u<a.size)return!1}return!0}function elt(e,t){return e.map(n=>Rt({values:t.fields.map(r=>(r.getter||(r.getter=ao(r.field)))(n.datum))},t))}function tlt(e,t,n,r){for(var i=this.context.data[e],a=i?i.values.value:[],o={},s={},u={},l,c,f,d,h,p,g,m,v,y=a.length,b=0,x,w;b<y;++b){for(l=a[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],p=o[h.field]||(o[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),v=uhe[m+"_union"],p[d]=v(g,xt(f[x]));n&&(g=s[d]||(s[d]=[]),g.push(xt(f).reduce((S,A,_)=>(S[c[_].field]=A,S),{})))}if(t=t||ihe,Object.keys(o).forEach(S=>{o[S]=Object.keys(o[S]).map(A=>o[S][A]).reduce((A,_)=>A===void 0?_:uhe[u[S]+"_"+t](A,_))}),a=Object.keys(s),n&&a.length){const S=r?Uut:jut;o[S]=t===ihe?{[ahe]:a.reduce((A,_)=>(A.push(...s[_]),A),[])}:{[Wut]:a.map(A=>({[ahe]:s[A]}))}}return o}var uhe={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const nlt=":",rlt="@";function dj(e,t,n,r){t[0].type!==Up&&Se("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&sn(t).value,o="unit",s=rlt+o,u=nlt+i;a===cj&&!_t(r,s)&&(r[s]=n.getData(i).indataRef(n,o)),_t(r,u)||(r[u]=n.getData(i).tuplesRef())}function lhe(e){const t=this.context.data[e];return t?t.values.value:[]}function ilt(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function alt(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(fs).insert(t)),1}function olt(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const ew=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},slt=ew("format"),che=ew("timeFormat"),ult=ew("utcFormat"),llt=ew("timeParse"),clt=ew("utcParse"),FT=new Date(2e3,0,1);function MT(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(FT.setYear(2e3),FT.setMonth(e),FT.setDate(t),che.call(this,FT,n))}function flt(e){return MT.call(this,e,1,"%B")}function dlt(e){return MT.call(this,e,1,"%b")}function hlt(e){return MT.call(this,0,2+e,"%A")}function plt(e){return MT.call(this,0,2+e,"%a")}const glt=":",mlt="@",hj="%",fhe="$";function pj(e,t,n,r){t[0].type!==Up&&Se("First argument to data functions must be a string literal.");const i=t[0].value,a=glt+i;if(!_t(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function vlt(e,t,n,r){t[0].type!==Up&&Se("First argument to indata must be a string literal."),t[1].type!==Up&&Se("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=mlt+a;_t(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function mo(e,t,n,r){if(t[0].type===Up)dhe(n,r,t[0].value);else for(e in n.scales)dhe(n,r,e)}function dhe(e,t,n){const r=hj+n;if(!_t(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function $c(e,t){let n;return $t(e)?e:Bn(e)?(n=t.scales[e])&&n.value:void 0}function ylt(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=mo,n._range=mo,n._scale=mo;const r=i=>"_["+(i.type===Up?gt(hj+i.value):gt(hj)+"+"+e(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(e(i[1]),")")}}function gj(e,t){return function(n,r,i){if(n){const a=$c(n,(i||this).context);return a&&a.path[e](r)}else return t(r)}}const blt=gj("area",qnt),xlt=gj("bounds",Xnt),wlt=gj("centroid",trt);function _lt(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function mj(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Slt(){return mj(this.context.dataflow,"warn",arguments)}function Elt(){return mj(this.context.dataflow,"info",arguments)}function Alt(){return mj(this.context.dataflow,"debug",arguments)}function vj(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function yj(e){const t=gd(e),n=vj(t.r),r=vj(t.g),i=vj(t.b);return .2126*n+.7152*r+.0722*i}function Clt(e,t){const n=yj(e),r=yj(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function klt(){const e=[].slice.call(arguments);return e.unshift({}),Rt(...e)}function hhe(e,t){return e===t||e!==e&&t!==t?!0:ut(e)?ut(t)&&e.length===t.length?Tlt(e,t):!1:Nt(e)&&Nt(t)?phe(e,t):!1}function Tlt(e,t){for(let n=0,r=e.length;n<r;++n)if(!hhe(e[n],t[n]))return!1;return!0}function phe(e,t){for(const n in e)if(!hhe(e[n],t[n]))return!1;return!0}function ghe(e){return t=>phe(e,t)}function Olt(e,t,n,r,i,a){const o=this.context.dataflow,s=this.context.data[e],u=s.input,l=o.stamp();let c=s.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{s.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?fs:ut(n)||uC(n)?n:ghe(n),c.remove(f)),t&&c.insert(t),r&&(f=ghe(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in a)c.modify(i,d,a[d]);return 1}function Ilt(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function Nlt(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const mhe={};function Dlt(e,t){const n=mhe[t]||(mhe[t]=ao(t));return ut(e)?e.map(n):n(e)}function bj(e){return ut(e)||ArrayBuffer.isView(e)?e:null}function xj(e){return bj(e)||(Bn(e)?e:null)}function Rlt(e,...t){return bj(e).join(...t)}function Flt(e,...t){return xj(e).indexOf(...t)}function Mlt(e,...t){return xj(e).lastIndexOf(...t)}function Plt(e,...t){return xj(e).slice(...t)}function $lt(e,t,n){return $t(n)&&Se("Function argument passed to replace."),String(e).replace(t,n)}function Llt(e){return bj(e).slice().reverse()}function Blt(e,t,n){return JB(e||0,t||0,n||0)}function zlt(e,t){const n=$c(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function jlt(e,t){const n=$c(e,(t||this).context);return n?n.copy():void 0}function Ult(e,t){const n=$c(e,(t||this).context);return n?n.domain():[]}function Wlt(e,t,n){const r=$c(e,(n||this).context);return r?ut(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function Vlt(e,t){const n=$c(e,(t||this).context);return n&&n.range?n.range():[]}function qlt(e,t,n){const r=$c(e,(n||this).context);return r?r(t):void 0}function Hlt(e,t,n,r,i){e=$c(e,(i||this).context);const a=Eue(t,n);let o=e.domain(),s=o[0],u=sn(o),l=Oa;return u-s?l=lue(e,s,u):e=(e.interpolator?Sn("sequential")().interpolator(e.interpolator()):Sn("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(o=e.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==sn(o)&&o.push(u)),o.forEach(c=>a.stop(l(c),e(c))),a}function Glt(e,t,n){const r=$c(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Klt(e){let t=null;return function(n){return n?rx(n,t=t||Lv(e)):e}}const vhe=e=>e.data;function yhe(e,t){const n=lhe.call(t,e);return n.root&&n.root.lookup||{}}function Xlt(e,t,n){const r=yhe(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(vhe):void 0}function Ylt(e,t){const n=yhe(e,this)[t];return n?n.ancestors().map(vhe):void 0}const bhe=()=>typeof window!="undefined"&&window||null;function Zlt(){const e=bhe();return e?e.screen:{}}function Jlt(){const e=bhe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Qlt(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function ect(e,t,n){if(!e)return[];const[r,i]=e,a=new ci().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Lle(o,a,tct(t))}function tct(e){let t=null;if(e){const n=xt(e.marktype),r=xt(e.markname);t=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return t}const tw={random(){return ps()},cumulativeNormal:mC,cumulativeLogNormal:I4,cumulativeUniform:F4,densityNormal:A4,densityLogNormal:O4,densityUniform:R4,quantileNormal:vC,quantileLogNormal:N4,quantileUniform:M4,sampleNormal:gC,sampleLogNormal:T4,sampleUniform:D4,isArray:ut,isBoolean:EL,isDate:Qf,isDefined(e){return e!==void 0},isNumber:ed,isObject:Nt,isRegExp:Rre,isString:Bn,isTuple:uC,isValid(e){return e!=null&&e===e},toBoolean:CL,toDate:kL,toNumber:Zi,toString:TL,indexof:Flt,join:Rlt,lastindexof:Mlt,replace:$lt,reverse:Llt,slice:Plt,flush:Nre,lerp:Fre,merge:klt,pad:$re,peek:sn,pluck:Dlt,span:g1,inrange:gv,truncate:Lre,rgb:gd,lab:DC,hcl:RC,hsl:IC,luminance:yj,contrast:Clt,sequence:zo,format:slt,utcFormat:ult,utcParse:clt,utcOffset:Iie,utcSequence:Rie,timeFormat:che,timeParse:llt,timeOffset:Oie,timeSequence:Die,timeUnitSpecifier:yie,monthFormat:flt,monthAbbrevFormat:dlt,dayFormat:hlt,dayAbbrevFormat:plt,quarter:kre,utcquarter:Tre,week:xie,utcweek:Sie,dayofyear:bie,utcdayofyear:_ie,warn:Slt,info:Elt,debug:Alt,extent:nl,inScope:_lt,intersect:ect,clampRange:Ore,pinchDistance:Ilt,pinchAngle:Nlt,screen:Zlt,containerSize:Qlt,windowSize:Jlt,bandspace:Blt,setdata:alt,pathShape:Klt,panLinear:Sre,panLog:Ere,panPow:Are,panSymlog:Cre,zoomLinear:bL,zoomLog:xL,zoomPow:GA,zoomSymlog:wL,encode:olt,modify:Olt},nct=["view","item","group","xy","x","y"],rct="event.vega.",xhe="this.",wj={},whe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(gt(fhe+e),"]"),functions:ict,constants:the,visitors:wj},_j=rhe(whe);function ict(e){const t=nhe(e);nct.forEach(n=>t[n]=rct+n);for(const n in tw)t[n]=xhe+n;return Rt(t,ylt(e,tw,wj)),t}function Jr(e,t,n){return arguments.length===1?tw[e]:(tw[e]=t,n&&(wj[e]=n),_j&&(_j.functions[e]=xhe+e),this)}Jr("bandwidth",zlt,mo),Jr("copy",jlt,mo),Jr("domain",Ult,mo),Jr("range",Vlt,mo),Jr("invert",Wlt,mo),Jr("scale",qlt,mo),Jr("gradient",Hlt,mo),Jr("geoArea",blt,mo),Jr("geoBounds",xlt,mo),Jr("geoCentroid",wlt,mo),Jr("geoShape",Glt,mo),Jr("indata",ilt,vlt),Jr("data",lhe,pj),Jr("treePath",Xlt,pj),Jr("treeAncestors",Ylt,pj),Jr("vlSelectionTest",Yut,dj),Jr("vlSelectionIdTest",Qut,dj),Jr("vlSelectionResolve",tlt,dj),Jr("vlSelectionTuples",elt);function wl(e,t){const n={};let r;try{e=Bn(e)?e:gt(e)+"",r=ehe(e)}catch(a){Se("Expression parse error: "+e)}r.visit(a=>{if(a.type!==zde)return;const o=a.callee.name,s=whe.visitors[o];s&&s(o,a.arguments,t,n)});const i=_j(r);return i.globals.forEach(a=>{const o=fhe+a;!_t(n,o)&&t.getSignal(a)&&(n[o]=t.signalRef(a))}),{$expr:Rt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function act(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const oct=iu(["rule"]),_he=iu(["group","image","rect"]);function sct(e,t){let n="";return oct[t]||(e.x2&&(e.x?(_he[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(_he[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Sj(e){return(e+"").toLowerCase()}function uct(e){return Sj(e)==="operator"}function lct(e){return Sj(e)==="collect"}function nw(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function cct(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var fct={operator:(e,t)=>nw(e,["_"],t.code),parameter:(e,t)=>nw(e,["datum","_"],t.code),event:(e,t)=>nw(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return nw(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+gt(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=sct(r,n),i+="return m;",nw(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(gt).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(a,o)=>{const s=t[o];let u,l;return a.path?(u="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),cct(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function dct(e){const t=this;uct(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function hct(e){const t=this;if(e.params){const n=t.get(e.id);n||Se("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function pct(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ut(i)?i.map(a=>She(a,n,t)):She(i,n,t)}return t}function She(e,t,n){if(!e||!Nt(e))return e;for(let r=0,i=Ehe.length,a;r<i;++r)if(a=Ehe[r],_t(e,a.key))return a.parse(e,t,n);return e}var Ehe=[{key:"$ref",parse:gct},{key:"$key",parse:vct},{key:"$expr",parse:mct},{key:"$field",parse:yct},{key:"$encode",parse:xct},{key:"$compare",parse:bct},{key:"$context",parse:wct},{key:"$subflow",parse:_ct},{key:"$tupleid",parse:Sct}];function gct(e,t){return t.get(e.$ref)||Se("Operator not defined: "+e.$ref)}function mct(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=io(t.parameterExpression(e.$expr),e.$fields,e.$name))}function vct(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=AL(e.$key,e.$flat,t.expr.codegen))}function yct(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ao(e.$field,e.$name,t.expr.codegen))}function bct(e,t){const n="c:"+e.$compare+"_"+e.$order,r=xt(e.$compare).map(i=>i&&i.$tupleid?lt:i);return t.fn[n]||(t.fn[n]=_L(r,e.$order,t.expr.codegen))}function xct(e,t){const n=e.$encode,r={};for(const i in n){const a=n[i];r[i]=io(t.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function wct(e,t){return t}function _ct(e,t){const n=e.$subflow;return function(r,i,a){const o=t.fork().parse(n),s=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(a),s.detachSubflow=()=>t.detach(o),s}}function Sct(){return lt}function Ect(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(a=>t.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(a=>t.get(a)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Se("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function Act(e){var t=this,n=Nt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=void 0;r||Se("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(o=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,r,i,a,o)}const Cct={skip:!0};function kct(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(a=>{const o=t.signals[a];e.signals(a,o)&&(r[a]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(a=>{const o=t.data[a];e.data(a,o)&&(i[a]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function Tct(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(a=>{n.update(t.signals[a],i[a],Cct)}),Object.keys(r||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(fs).insert(r[a]))}),(e.subcontext||[]).forEach((a,o)=>{const s=t.subcontext[o];s&&s.setState(a)})}function Ahe(e,t,n,r){return new Che(e,t,n,r)}function Che(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||fct,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function khe(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Che.prototype=khe.prototype={fork(){const e=new khe(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),lct(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(r.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),r.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const o=n.data[a]||(n.data[a]={});e.data[a].forEach(s=>o[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Sj(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:act,parseOperator:dct,parseOperatorParameters:hct,parseParameters:pct,parseStream:Ect,parseUpdate:Act,getState:kct,setState:Tct};function Oct(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),The(t,e.description()))}function The(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Ict(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Ej="default";function Nct(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Ej,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,a=i?Bn(i)?i:i.user:Ej,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Bn(r)||(i=r.item,r=r.user),Aj(e,r&&r!==Ej?r:i||r),i},{cursor:t})}function Aj(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function PT(e,t){var n=e._runtime.data;return _t(n,t)||Se("Unrecognized data set: "+t),n[t]}function Dct(e,t){return arguments.length<2?PT(this,e).values.value:$T.call(this,e,xp().remove(fs).insert(t))}function $T(e,t){pae(t)||Se("Second argument to changes must be a changeset.");const n=PT(this,e);return n.modified=!0,this.pulse(n.input,t)}function Rct(e,t){return $T.call(this,e,xp().insert(t))}function Fct(e,t){return $T.call(this,e,xp().remove(t))}function Ohe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Ihe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function LT(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Mct(e){var t=LT(e),n=Ohe(e),r=Ihe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){e.error(a)}})}function Pct(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,s;return i&&(s=LT(e),o=t.changedTouches?t.changedTouches[0]:t,a=pk(o,i),a[0]-=s[0],a[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=$ct(e,n,a),t}function $ct(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var s=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function a(o){if(!o)return n;Bn(o)&&(o=i(o));const s=n.slice();for(;o;)s[0]-=o.x||0,s[1]-=o.y||0,o=o.mark&&o.mark.group;return s}return{view:Ji(e),item:Ji(t||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const Nhe="view",Lct="timer",Bct="window",zct={trap:!1};function jct(e){const t=Rt({defaults:{}},e),n=(r,i)=>{i.forEach(a=>{ut(r[a])&&(r[a]=iu(r[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function Dhe(e,t,n,r){e._eventListeners.push({type:n,sources:xt(t),handler:r})}function Uct(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function BT(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Nt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Wct(e,t,n){var r=this,i=new dC(n),a=function(l,c){r.runAsync(null,()=>{e===Nhe&&Uct(r,t)&&l.preventDefault(),i.receive(Pct(r,l,c))})},o;if(e===Lct)BT(r,"timer",t)&&r.timer(a,t);else if(e===Nhe)BT(r,"view",t)&&r.addEventListener(t,a,zct);else if(e===Bct?BT(r,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&BT(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=o.length;s<u;++s)o[s].addEventListener(t,a);Dhe(r,o,t,a)}return i}function Rhe(e){return e.item}function Fhe(e){return e.item.mark.source}function Mhe(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Vct(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Rhe),Fhe,Mhe(e)),this.on(this.events("view","mouseout",Rhe),Fhe,Mhe(t)),this}function qct(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return e&&e.call(this,this._handler,null,null,null),this}function Ho(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Hct="vega-bind",Gct="vega-bind-name",Kct="vega-bind-radio";function Xct(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=SL(r.debounce,i.update))),(r.input==null&&r.element?Yct:Jct)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Yct(e,t,n,r){const i=n.event||"input",a=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,a),Dhe(r,t,i,a),e.set=o=>{t.value=o,t.dispatchEvent(Zct(i))}}function Zct(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Jct(e,t,n,r){const i=r.signal(n.signal),a=Ho("div",{class:Hct}),o=n.input==="radio"?a:a.appendChild(Ho("label"));o.appendChild(Ho("span",{class:Gct},n.name||n.signal)),t.appendChild(a);let s=Qct;switch(n.input){case"checkbox":s=eft;break;case"select":s=tft;break;case"radio":s=nft;break;case"range":s=rft;break}s(e,o,n,i)}function Qct(e,t,n,r){const i=Ho("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=a=>i.value=a}function eft(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Ho("input",i);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=o=>a.checked=!!o||null}function tft(e,t,n,r){const i=Ho("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,s)=>{const u={value:o};zT(o,r)&&(u.selected=!0),i.appendChild(Ho("option",u,(a[s]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let s=0,u=n.options.length;s<u;++s)if(zT(n.options[s],o)){i.selectedIndex=s;return}}}function nft(e,t,n,r){const i=Ho("span",{class:Kct}),a=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,s)=>{const u={type:"radio",name:n.signal,value:o};zT(o,r)&&(u.checked=!0);const l=Ho("input",u);l.addEventListener("change",()=>e.update(o));const c=Ho("label",{},(a[s]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)zT(s[l].value,o)&&(s[l].checked=!0)}}function rft(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||nd(a,i,100),s=Ho("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=Ho("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function zT(e,t){return e===t||e+""==t+""}function Phe(e,t,n,r,i,a){return t=t||new r(e.loader()),t.initialize(n,Ohe(e),Ihe(e),LT(e),i,a).background(e.background())}function Cj(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function ift(e,t,n,r){const i=new r(e.loader(),Cj(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,LT(e),e);return t&&t.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function aft(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,a=Sk(r);e=n._el=e?kj(n,e,!0):null,Oct(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||vx,s=e?a.renderer:a.headless;return n._renderer=s?Phe(n,n._renderer,e,s):null,n._handler=ift(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=kj(n,t,!0):e.appendChild(Ho("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=kj(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Xct(n,u.element||t,u)})),n}function kj(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const rw=e=>+e||0,oft=e=>({top:e,bottom:e,left:e,right:e});function $he(e){return Nt(e)?{top:rw(e.top),bottom:rw(e.bottom),left:rw(e.left),right:rw(e.right)}:oft(rw(e))}async function Tj(e,t,n,r){const i=Sk(t),a=i&&i.headless;return a||Se("Unrecognized renderer type: "+t),await e.runAsync(),Phe(e,null,null,a,n,r).renderAsync(e._scenegraph.root)}async function sft(e,t){e!==kd.Canvas&&e!==kd.SVG&&e!==kd.PNG&&Se("Unrecognized image type: "+e);const n=await Tj(this,e,t);return e===kd.SVG?uft(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function uft(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function lft(e,t){return(await Tj(this,kd.Canvas,e,t)).canvas()}async function cft(e){return(await Tj(this,kd.SVG,e)).svg()}function fft(e,t,n){return Ahe(e,Ev,tw,n).parse(t)}function dft(e){var t=this._runtime.scales;return _t(t,e)||Se("Unrecognized scale or projection: "+e),t[e].value}var Lhe="width",Bhe="height",Oj="padding",zhe={skip:!0};function jhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Oj?r.left+r.right:0)}function Uhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Oj?r.top+r.bottom:0)}function hft(e){var t=e._signals,n=t[Lhe],r=t[Bhe],i=t[Oj];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=jhe(e,s.size),a()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=Uhe(e,s.size),a()},{size:r});const o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function pft(e,t,n,r,i,a){this.runAfter(o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Lhe,n,zhe),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal(Bhe,r,zhe),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(u=>u.resize())},!1,1)}function gft(e){return this._runtime.getState(e||{data:mft,signals:vft,recurse:!0})}function mft(e,t){return t.modified&&ut(t.input.value)&&e.indexOf("_:vega:_")}function vft(e,t){return!(e==="parent"||t instanceof Ev.proxy)}function yft(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function bft(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(nat(n,t))}function xft(e,t,n,r){const i=e.element();i&&i.setAttribute("title",wft(r))}function wft(e){return e==null?"":ut(e)?Whe(e):Nt(e)&&!Qf(e)?_ft(e):e+""}function _ft(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ut(n)?Whe(n):Vhe(n))}).join(`
`)}function Whe(e){return"["+e.map(Vhe).join(", ")+"]"}function Vhe(e){return ut(e)?"[\u2026]":Nt(e)&&!Qf(e)?"{\u2026}":e}function qhe(e,t){const n=this;if(t=t||{},Sv.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Rt({},e.locale,t.locale);n.locale(lae(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||kd.Canvas,n._scenegraph=new Uz;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||xft,n._redraw=!0,n._handler=new vx().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=jct(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=fft(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Rt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=jhe(n,n._width),n._viewHeight=Uhe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,hft(n),Ict(n),Nct(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function jT(e,t){return _t(e._signals,t)?e._signals[t]:Se("Unrecognized signal name: "+gt(t))}function Hhe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function Ghe(e,t,n,r){let i=Hhe(n,r);return i||(i=Cj(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function Khe(e,t,n){const r=Hhe(t,n);return r&&t._targets.remove(r),e}$e(qhe,Sv,{async evaluate(e,t,n){if(await Sv.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,Mct(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&sC(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&The(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=jT(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",$he(e)):$he(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Sk(e)||Se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Sv.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(jT(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:pft,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=Cj(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Ghe(this,e,jT(this,e),t)},removeSignalListener(e,t){return Khe(this,jT(this,e),t)},addDataListener(e,t){return Ghe(this,e,PT(this,e).values,t)},removeDataListener(e,t){return Khe(this,PT(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Aj(this,null);this._globalCursor=!!e,t&&Aj(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:bft,events:Wct,finalize:qct,hover:Vct,data:Dct,change:$T,insert:Rct,remove:Fct,scale:dft,initialize:aft,toImageURL:sft,toCanvas:lft,toSVG:cft,getState:gft,setState:yft});const Sft="view",UT="[",WT="]",Xhe="{",Yhe="}",Eft=":",Zhe=",",Aft="@",Cft=">",kft=/[[\]{}]/,Tft={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Jhe,Qhe;function $d(e,t,n){return Jhe=t||Sft,Qhe=n||Tft,epe(e.trim()).map(Ij)}function Oft(e){return Qhe[e]}function iw(e,t,n,r,i){const a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;i&&i.indexOf(s)>=0?--o:r&&r.indexOf(s)>=0&&++o}return t}function epe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=iw(e,i,Zhe,UT+Xhe,WT+Yhe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function Ij(e){return e[0]==="["?Ift(e):Nft(e)}function Ift(e){const t=e.length;let n=1,r;if(n=iw(e,n,WT,UT,WT),n===t)throw"Empty between selector: "+e;if(r=epe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Cft)throw"Expected '>' after between selector: "+e;r=r.map(Ij);const i=Ij(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function Nft(e){const t={source:Jhe},n=[];let r=[0,0],i=0,a=0,o=e.length,s=0,u,l;if(e[o-1]===Yhe){if(s=e.lastIndexOf(Xhe),s>=0){try{r=Dft(e.substring(s+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),o=e.length}else throw"Unmatched right brace: "+e;s=0}if(!o)throw e;if(e[0]===Aft&&(i=++s),u=iw(e,s,Eft),u<o&&(n.push(e.substring(a,u).trim()),a=s=++u),s=iw(e,s,UT),s===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),l=[],a=++s,a===o)throw"Unmatched left bracket: "+e;for(;s<o;){if(s=iw(e,s,WT),s===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==UT)throw"Expected left bracket: "+e;a=++s}if(!(o=n.length)||kft.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):Oft(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function Dft(e){const t=e.split(Zhe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function Rft(e){return Nt(e)?e:{type:e||"pad"}}const aw=e=>+e||0,Fft=e=>({top:e,bottom:e,left:e,right:e});function Mft(e){return Nt(e)?e.signal?e:{top:aw(e.top),bottom:aw(e.bottom),left:aw(e.left),right:aw(e.right)}:Fft(aw(e))}const Ei=e=>Nt(e)&&!ut(e)?Rt({},e):{value:e};function tpe(e,t,n,r){return n!=null?(Nt(n)&&!ut(n)||ut(n)&&n.length&&Nt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Ui(e,t,n){for(const r in t)tpe(e,r,t[r]);for(const r in n)tpe(e,r,n[r],"update")}function o0(e,t,n){for(const r in t)n&&_t(n,r)||(e[r]=Rt(e[r]||{},t[r]));return e}function s0(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const Nj="mark",Dj="frame",Rj="scope",Pft="axis",$ft="axis-domain",Lft="axis-grid",Bft="axis-label",zft="axis-tick",jft="axis-title",Uft="legend",Wft="legend-band",Vft="legend-entry",qft="legend-gradient",npe="legend-label",Hft="legend-symbol",Gft="legend-title",Kft="title",Xft="title-text",Yft="title-subtitle";function Zft(e,t,n,r,i){const a={},o={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!s0(u,e)&&Fj(a,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===Dj?i.group:n===Nj?Rt({},i.mark,i[t]):null;for(u in c)l=s0(u,e)||(u==="fill"||u==="stroke")&&(s0("fill",e)||s0("stroke",e)),l||Fj(a,u,c[u]);xt(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)s0(h,e)||Fj(a,h,d[h])}),e=Rt({},e);for(u in a)c=a[u],c.signal?(s=s||{})[u]=c:o[u]=c;return e.enter=Rt(o,e.enter),s&&(e.update=Rt(s,e.update)),e}function Fj(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const rpe=e=>Bn(e)?gt(e):e.signal?"(".concat(e.signal,")"):ipe(e);function VT(e){if(e.gradient!=null)return Qft(e);let t=e.signal?"(".concat(e.signal,")"):e.color?Jft(e.color):e.field!=null?ipe(e.field):e.value!==void 0?gt(e.value):void 0;return e.scale!=null&&(t=edt(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat(HT(e.exponent),")")),e.mult!=null&&(t+="*".concat(HT(e.mult))),e.offset!=null&&(t+="+".concat(HT(e.offset))),e.round&&(t="round(".concat(t,")")),t}const qT=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(VT).join(","),")+'')");function Jft(e){return e.c?qT("hcl",e.h,e.c,e.l):e.h||e.s?qT("hsl",e.h,e.s,e.l):e.l||e.a?qT("lab",e.l,e.a,e.b):e.r||e.g||e.b?qT("rgb",e.r,e.g,e.b):null}function Qft(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:gt(n));for(;t.length&&sn(t)==null;)t.pop();return t.unshift(rpe(e.gradient)),"gradient(".concat(t.join(","),")")}function HT(e){return Nt(e)?"("+VT(e)+")":e}function ipe(e){return ape(Nt(e)?e:{datum:e})}function ape(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Se("Invalid field reference: "+gt(e));return e.signal||(r=Bn(r)?zA(r).map(gt).join("]["):ape(r)),t+"["+r+"]"}function edt(e,t){const n=rpe(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+HT(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function tdt(e){let t="";return e.forEach(n=>{const r=VT(n);t+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),sn(t)===":"&&(t+="null"),t}function ope(e,t,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},e=Zft(e,t,n,r,i.config);for(const s in e)o[s]=ndt(e[s],t,a,i);return a}function ndt(e,t,n,r){const i={},a={};for(const o in e)e[o]!=null&&(i[o]=idt(rdt(e[o]),r,n,a));return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function rdt(e){return ut(e)?tdt(e):VT(e)}function idt(e,t,n,r){const i=wl(e,t);return i.$fields.forEach(a=>r[a]=1),Rt(n,i.$params),i.$expr}const adt="outer",odt=["value","update","init","react","bind"];function spe(e,t){Se(e+' for "outer" push: '+gt(t))}function upe(e,t){const n=e.name;if(e.push===adt)t.signals[n]||spe("No prior signal definition",n),odt.forEach(r=>{e[r]!==void 0&&spe("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Mj(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function GT(e,t,n,r){return new Mj(e,t,n,r)}function KT(e,t){return GT("operator",e,t)}function ft(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function ow(e,t){return t?{$field:e,$name:t}:{$field:e}}const Pj=ow("key");function lpe(e,t){return{$compare:e,$order:t}}function sdt(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const udt="ascending",ldt="descending";function cdt(e){return Nt(e)?(e.order===ldt?"-":"+")+XT(e.op,e.field):""}function XT(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const $j="scope",Lj="view";function di(e){return e&&e.signal}function fdt(e){return e&&e.expr}function YT(e){if(di(e))return!0;if(Nt(e)){for(const t in e)if(YT(e[t]))return!0}return!1}function mu(e,t){return e??t}function Hp(e){return e&&e.signal||e}const cpe="timer";function sw(e,t){return(e.merge?hdt:e.stream?pdt:e.type?gdt:Se("Invalid stream specification: "+gt(e)))(e,t)}function ddt(e){return e===$j?Lj:e||Lj}function hdt(e,t){const n=e.merge.map(i=>sw(i,t)),r=Bj({merge:n},e,t);return t.addStream(r).id}function pdt(e,t){const n=sw(e.stream,t),r=Bj({stream:n},e,t);return t.addStream(r).id}function gdt(e,t){let n;e.type===cpe?(n=t.event(cpe,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(ddt(e.source),e.type);const r=Bj({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function Bj(e,t,n){let r=t.between;return r&&(r.length!==2&&Se('Stream "between" parameter must have 2 entries: '+gt(t)),e.between=[sw(r[0],n),sw(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(mdt(t.marktype,t.markname,t.markrole)),t.source===$j&&r.push("inScope(event.item)"),r.length&&(e.filter=wl("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function mdt(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const vdt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function ydt(e,t,n){const r=e.encode,i={target:n};let a=e.events,o=e.update,s=[];a||Se("Signal update missing events specification."),Bn(a)&&(a=$d(a,t.isSubscope()?$j:Lj)),a=xt(a).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[xdt(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&Se("Signal encode and update are mutually exclusive."),o="encode(item(),"+gt(r)+")"),i.update=Bn(o)?wl(o,t):o.expr!=null?wl(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:vdt,$params:{$value:t.signalRef(o.signal)}}:Se("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(Rt(bdt(u,t),i)))}function bdt(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):sw(e,t)}}function xdt(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function wdt(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=wl(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>ydt(i,t,n.id))}const Wn=e=>(t,n,r)=>GT(e,n,t||void 0,r),fpe=Wn("aggregate"),_dt=Wn("axisticks"),dpe=Wn("bound"),vu=Wn("collect"),hpe=Wn("compare"),Sdt=Wn("datajoin"),ppe=Wn("encode"),Edt=Wn("expression"),Adt=Wn("facet"),Cdt=Wn("field"),kdt=Wn("key"),Tdt=Wn("legendentries"),Odt=Wn("load"),Idt=Wn("mark"),Ndt=Wn("multiextent"),Ddt=Wn("multivalues"),Rdt=Wn("overlap"),Fdt=Wn("params"),gpe=Wn("prefacet"),Mdt=Wn("projection"),Pdt=Wn("proxy"),$dt=Wn("relay"),mpe=Wn("render"),Ldt=Wn("scale"),Gp=Wn("sieve"),Bdt=Wn("sortitems"),vpe=Wn("viewlayout"),zdt=Wn("values");let jdt=0;const ype={min:"min",max:"max",count:"sum"};function Udt(e,t){const n=e.type||"linear";rue(n)||Se("Unrecognized scale type: "+gt(n)),t.addScale(e.name,{type:n,domain:void 0})}function Wdt(e,t){const n=t.getScale(e.name).params;let r;n.domain=bpe(e.domain,e,t),e.range!=null&&(n.range=wpe(e,t,n)),e.interpolate!=null&&Qdt(e.interpolate,n),e.nice!=null&&(n.nice=Jdt(e.nice)),e.bins!=null&&(n.bins=Zdt(e.bins,t));for(r in e)_t(n,r)||r==="name"||(n[r]=bs(e[r],t))}function bs(e,t){return Nt(e)?e.signal?t.signalRef(e.signal):Se("Unsupported object: "+gt(e)):e}function ZT(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>bs(n,t))}function JT(e){Se("Can not find data set: "+gt(e))}function bpe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Se("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ut(e)?Vdt:e.fields?Hdt:qdt)(e,t,n)}function Vdt(e,t,n){return e.map(r=>bs(r,n))}function qdt(e,t,n){const r=n.getData(e.data);return r||JT(e.data),$v(t.type)?r.valuesRef(n,e.field,xpe(e.sort,!1)):oue(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Hdt(e,t,n){const r=e.data,i=e.fields.reduce((a,o)=>(o=Bn(o)?{data:r,field:o}:ut(o)||o.signal?Gdt(o,n):o,a.push(o),a),[]);return($v(t.type)?Kdt:oue(t.type)?Xdt:Ydt)(e,n,i)}function Gdt(e,t){const n="_:vega:_"+jdt++,r=vu({});if(ut(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+gt(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Gp({})]),{data:n,field:"data"}}function Kdt(e,t,n){const r=xpe(e.sort,!0);let i,a;const o=n.map(l=>{const c=t.getData(l.data);return c||JT(l.data),c.countsRef(t,l.field,r)}),s={groupby:Pj,pulse:o};r&&(i=r.op||"count",a=r.field?XT(i,r.field):"count",s.ops=[ype[i]],s.fields=[t.fieldRef(a)],s.as=[a]),i=t.add(fpe(s));const u=t.add(vu({pulse:ft(i)}));return a=t.add(zdt({field:Pj,sort:t.sortRef(r),pulse:ft(u)})),ft(a)}function xpe(e,t){return e&&(!e.field&&!e.op?Nt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Se("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!ype[e.op]&&Se("Multiple domain scales can not be sorted using "+e.op)),e}function Xdt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||JT(i.data),a.domainRef(t,i.field)});return ft(t.add(Ddt({values:r})))}function Ydt(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||JT(i.data),a.extentRef(t,i.field)});return ft(t.add(Ndt({extents:r})))}function Zdt(e,t){return e.signal||ut(e)?ZT(e,t):t.objectProperty(e)}function Jdt(e){return Nt(e)?{interval:bs(e.interval),step:bs(e.step)}:bs(e)}function Qdt(e,t){t.interpolate=bs(e.type||e),e.gamma!=null&&(t.interpolateGamma=bs(e.gamma))}function wpe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Bn(i)){if(r&&_t(r,i))return e=Rt({},e,{range:r[i]}),wpe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=$v(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Se("Unrecognized scale range value: "+gt(i))}else if(i.scheme){n.scheme=ut(i.scheme)?ZT(i.scheme,t):bs(i.scheme,t),i.extent&&(n.schemeExtent=ZT(i.extent,t)),i.count&&(n.schemeCount=bs(i.count,t));return}else if(i.step){n.rangeStep=bs(i.step,t);return}else{if($v(e.type)&&!ut(i))return bpe(i,e,t);ut(i)||Se("Unsupported range type: "+gt(i))}return i.map(a=>(ut(a)?ZT:bs)(a,t))}function eht(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=zj(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=zj(n[i],i,t));t.addProjection(e.name,r)}function zj(e,t,n){return ut(e)?e.map(r=>zj(r,t,n)):Nt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Se("Unsupported parameter object: "+gt(e)):e}const yu="top",u0="left",l0="right",Ld="bottom",_pe="center",tht="vertical",nht="start",rht="middle",iht="end",jj="index",Uj="label",aht="offset",c0="perc",oht="perc2",xs="value",uw="guide-label",Wj="guide-title",sht="group-title",uht="group-subtitle",Spe="symbol",QT="gradient",Vj="discrete",qj="size",lht="shape",cht="fill",fht="stroke",dht="strokeWidth",hht="strokeDash",pht="opacity",Hj=[qj,lht,cht,fht,dht,hht,pht],lw={name:1,style:1,interactive:1},pn={value:0},ws={value:1},eO="group",Epe="rect",Gj="rule",ght="symbol",Kp="text";function cw(e){return e.type=eO,e.interactive=e.interactive||!1,e}function vo(e,t){const n=(r,i)=>mu(e[r],mu(t[r],i));return n.isVertical=r=>tht===mu(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>mu(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>mu(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>mu(e.columns,mu(t.columns,+n.isVertical(!0))),n}function Ape(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function mht(e,t,n){const r=t.config.style[n];return r&&r[e]}function tO(e,t,n){return"item.anchor === '".concat(nht,"' ? ").concat(e," : item.anchor === '").concat(iht,"' ? ").concat(t," : ").concat(n)}const Kj=tO(gt(u0),gt(l0),gt(_pe));function vht(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(t.signal,") === 'extent'")},Nt(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function Cpe(e,t){return t?e?Nt(e)?Object.assign({},e,{offset:Cpe(e.offset,t)}):{value:e,offset:t}:t:e}function Go(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=o0(e.encode,t,lw)):e.interactive=!1,e}function yht(e,t,n,r){const i=vo(e,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;a?(l=[0,1],c=[0,0],f=o,d=s):(l=[0,0],c=[1,0],f=s,d=o);const h={enter:u={opacity:pn,x:pn,y:pn,width:Ei(f),height:Ei(d)},update:Rt({},u,{opacity:ws,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:pn}};return Ui(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Go({type:Epe,role:qft,encode:h},r)}function bht(e,t,n,r,i){const a=vo(e,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:pn,fill:{scale:t,field:xs}};p[l]={signal:h+"datum."+c0,mult:u},p[c]=pn,p[f]={signal:h+"datum."+oht,mult:u},p[d]=Ei(s);const g={enter:p,update:Rt({},p,{opacity:ws}),exit:{opacity:pn}};return Ui(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Go({type:Epe,role:Wft,key:xs,from:i,encode:g},r)}const xht="datum.".concat(c0,'<=0?"').concat(u0,'":datum.').concat(c0,'>=1?"').concat(l0,'":"').concat(_pe,'"'),wht="datum.".concat(c0,'<=0?"').concat(Ld,'":datum.').concat(c0,'>=1?"').concat(yu,'":"').concat(rht,'"');function kpe(e,t,n,r){const i=vo(e,t),a=i.isVertical(),o=Ei(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:pn},update:c={opacity:ws,text:{field:Uj}},exit:{opacity:pn}};return Ui(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:mu(e.labelLimit,t.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=c.baseline={signal:wht},f="y",d="x",h="1-"):(l.align=c.align={signal:xht},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+c0,mult:s},l[d]=c[d]=o,o.offset=mu(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+jj}:void 0,Go({type:Kp,role:npe,style:uw,key:xs,from:r,encode:p,overlap:u},n)}function _ht(e,t,n,r,i){const a=vo(e,t),o=n.entries,s=!!(o&&o.interactive),u=o?o.name:void 0,l=a("clipHeight"),c=a("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat(aht," : datum.").concat(qj),h=l?Ei(l):{field:qj},p="datum.".concat(jj),g="max(1, ".concat(i,")");let m,v,y,b,x;h.mult=.5,m={enter:v={opacity:pn,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:ws,x:v.x,y:v.y},exit:{opacity:pn}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Ui(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",S),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),Hj.forEach(C=>{e[C]&&(y[C]=v[C]={scale:e[C],field:xs})});const A=Go({type:ght,role:Hft,key:xs,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=Ei(c);_.offset=a("labelOffset"),m={enter:v={opacity:pn,x:{signal:d,offset:_},y:h},update:y={opacity:ws,text:{field:Uj},x:v.x,y:v.y},exit:{opacity:pn}},Ui(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const E=Go({type:Kp,role:npe,style:uw,key:xs,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:pn,height:l?Ei(l):pn,opacity:pn},exit:{opacity:pn},update:y={opacity:ws,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),r={facet:{data:r,name:"value",groupby:jj}},cw({role:Rj,from:r,encode:o0(m,o,lw),marks:[A,E],name:u,interactive:s,sort:x})}function Sht(e,t){const n=vo(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Xj='item.orient === "left"',Yj='item.orient === "right"',nO="(".concat(Xj," || ").concat(Yj,")"),Eht="datum.vgrad && ".concat(nO),Aht=tO('"top"','"bottom"','"middle"'),Cht=tO('"right"','"left"','"center"'),kht="datum.vgrad && ".concat(Yj," ? (").concat(Cht,") : (").concat(nO," && !(datum.vgrad && ").concat(Xj,')) ? "left" : ').concat(Kj),Tht="item._anchor || (".concat(nO,' ? "middle" : "start")'),Oht="".concat(Eht," ? (").concat(Xj," ? -90 : 90) : 0"),Iht="".concat(nO," ? (datum.vgrad ? (").concat(Yj,' ? "bottom" : "top") : ').concat(Aht,') : "top"');function Nht(e,t,n,r){const i=vo(e,t),a={enter:{opacity:pn},update:{opacity:ws,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:pn}};return Ui(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Tht},angle:{signal:Oht},align:{signal:kht},baseline:{signal:Iht},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Go({type:Kp,role:Gft,style:Wj,from:r,encode:a},n)}function Dht(e,t){let n;return Nt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Tpe(e.path)+")":e.sphere&&(n="geoShape("+Tpe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Tpe(e){return Nt(e)&&e.signal?e.signal:gt(e)}function Ope(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===eO?Rj:t||Nj}function Rht(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Ope(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Fht(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Zj(e,t){const n=Sae(e.type);n||Se("Unrecognized transform type: "+gt(e.type));const r=GT(n.type.toLowerCase(),null,Ipe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function Ipe(e,t,n){const r={},i=e.params.length;for(let a=0;a<i;++a){const o=e.params[a];r[o.name]=Mht(o,t,n)}return r}function Mht(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return Pht(e,t,n);if(i===void 0){e.required&&Se("Missing required "+gt(t.type)+" parameter: "+gt(e.name));return}else{if(r==="param")return $ht(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!di(i)?i.map(a=>Npe(e,a,n)):Npe(e,i,n)}function Npe(e,t,n){const r=e.type;if(di(t))return Rpe(r)?Se("Expression references can not be signals."):Jj(r)?n.fieldRef(t):Fpe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||Jj(r);return i&&Lht(t)?n.exprRef(t.expr,t.as):i&&Bht(t)?ow(t.field,t.as):Rpe(r)?wl(t,n):zht(r)?ft(n.getData(t).values):Jj(r)?ow(t):Fpe(r)?n.compareRef(t):t}}function Pht(e,t,n){return Bn(t.from)||Se('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function $ht(e,t,n){const r=t[e.name];return e.array?(ut(r)||Se("Expected an array of sub-parameters. Instead: "+gt(r)),r.map(i=>Dpe(e,i,n))):Dpe(e,r,n)}function Dpe(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||Se("Unsupported parameter: "+gt(t));const a=Rt(Ipe(i,t,n),i.key);return ft(n.add(Fdt(a)))}const Lht=e=>e&&e.expr,Bht=e=>e&&e.field,zht=e=>e==="data",Rpe=e=>e==="expr",Jj=e=>e==="field",Fpe=e=>e==="compare";function jht(e,t,n){let r,i,a,o,s;return e?(r=e.facet)&&(t||Se("Only group marks can be faceted."),r.field!=null?o=s=rO(r,n):(e.data?s=ft(n.getData(e.data).aggregate):(a=Zj(Rt({type:"aggregate",groupby:xt(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=rO(r,n),o=s=ft(n.add(a))),i=n.keyRef(r.groupby,!0))):o=ft(n.add(vu(null,[{}]))),o||(o=rO(e,n)),{key:i,pulse:o,parent:s}}function rO(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ft(t.getData(e.data).output)}function Xp(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Xp.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let a=t[0],o=null,s=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ft(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(o=t[s]);return new Xp(e,a,i,r,o)};function Mpe(e){return Bn(e)?e:null}function Ppe(e,t,n){const r=XT(n.op,n.field);let i;if(t.ops){for(let a=0,o=t.as.length;a<o;++a)if(t.as[a]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function fw(e,t,n,r,i,a,o){const s=t[n]||(t[n]={}),u=cdt(a);let l=Mpe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=a?{field:Pj,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:ft(t.output)};u&&(d.sort=e.sortRef(a)),f=e.add(GT(r,void 0,d)),o&&(t.index[i]=f),c=ft(f),l!=null&&(s[l]=c)}return c}Xp.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),a=Mpe(t);let o,s,u;return a!=null&&(e=r.scope,o=i[a]),o?n&&n.field&&Ppe(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ft(r.output)},n&&n.field&&Ppe(e,u,n),s=e.add(fpe(u)),o=e.add(vu({pulse:ft(s)})),o={agg:s,ref:ft(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return ft(this.values)},extentRef(e,t){return fw(e,this,"extent","extent",t,!1)},domainRef(e,t){return fw(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return fw(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return fw(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return fw(e,this,"indata","tupleindex",t,!0,!0)}};function Uht(e,t,n){const r=e.from.facet,i=r.name,a=rO(r,t);let o;r.name||Se("Facet must have a name: "+gt(r)),r.data||Se("Facet must reference a data set: "+gt(r)),r.field?o=t.add(gpe({field:t.fieldRef(r.field),pulse:a})):r.groupby?o=t.add(Adt({key:t.keyRef(r.groupby),group:ft(t.proxy(n.parent)),pulse:a})):Se("Facet must specify groupby or field: "+gt(r));const s=t.fork(),u=s.add(vu()),l=s.add(Gp({pulse:ft(u)}));s.addData(i,new Xp(s,u,u,l)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(e).toRuntime()}}function Wht(e,t,n){const r=t.add(gpe({pulse:n.pulse})),i=t.fork();i.add(Gp()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function $pe(e,t,n){const r=e.remove,i=e.insert,a=e.toggle,o=e.modify,s=e.values,u=t.add(KT()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(f=>f??"null").join(",")+"),0)",c=wl(l,t);u.update=c.$expr,u.params=c.$params}function iO(e,t){const n=Ope(e),r=e.type===eO,i=e.from&&e.from.facet,a=e.overlap;let o=e.layout||n===Rj||n===Dj,s,u,l,c,f,d,h;const p=n===Nj||o||i,g=jht(e.from,r,t);u=t.add(Sdt({key:g.key||(e.key?ow(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ft(u);u=l=t.add(vu({pulse:m})),u=t.add(Idt({markdef:Rht(e),interactive:Fht(e.interactive,t),clip:Dht(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ft(u)}));const v=ft(u);u=c=t.add(ppe(ope(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const A=Zj(S,t),_=A.metadata;(_.generates||_.changes)&&Se("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),A.params.pulse=ft(u),t.add(u=A)}),e.sort&&(u=t.add(Bdt({sort:t.compareRef(e.sort),pulse:ft(u)})));const y=ft(u);(i||o)&&(o=t.add(vpe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=ft(o));const b=t.add(dpe({mark:v,pulse:d||y}));h=ft(b),r&&(p&&(s=t.operators,s.pop(),o&&s.pop()),t.pushState(y,d||h,m),i?Uht(e,t,g):p?Wht(e,t,g):t.parse(e),t.popState(),p&&(o&&s.push(o),s.push(b))),a&&(h=Vht(a,h,t));const x=t.add(mpe({pulse:h})),w=t.add(Gp({pulse:ft(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Xp(t,l,x,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&Se("Marks only support modify triggers."),$pe(S,t,f)}))}function Vht(e,t,n){const r=e.method,i=e.bound,a=e.separation,o={separation:di(a)?n.signalRef(a.signal):a,method:di(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;o.boundTolerance=di(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return ft(n.add(Rdt(o)))}function qht(e,t){const n=t.config.legend,r=e.encode||{},i=vo(e,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,l={};let c=0,f,d,h;Hj.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||Se("Missing valid scale for legend.");const p=Hht(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ft(t.add(vu(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=ft(t.add(Tdt(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===QT?(h=[yht(e,c,n,r.gradient),kpe(e,n,r.labels,y)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(Hp(i.gradientLength()),")/100))"))):p===Vj?h=[bht(e,c,n,r.gradient,y),kpe(e,n,r.labels,y)]:(f=Sht(e,n),h=[_ht(e,n,r,y,Hp(f.columns))],d.size=Xht(e,t,h[0].marks)),h=[cw({role:Vft,from:m,encode:v,marks:h,layout:f,interactive:s})],g.title&&h.push(Nht(e,n,r.title,m)),iO(cw({role:Uft,from:m,encode:o0(Kht(i,e,n),a,lw),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),t)}function Hht(e,t){let n=e.type||Spe;return!e.type&&Ght(e)===1&&(e.fill||e.stroke)&&(n=iz(t)?QT:az(t)?Vj:Spe),n!==QT?n:az(t)?Vj:QT}function Ght(e){return Hj.reduce((t,n)=>t+(e[n]?1:0),0)}function Kht(e,t,n){const r={enter:{},update:{}};return Ui(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Xht(e,t,n){const r=Hp(Lpe("size",e,n)),i=Hp(Lpe("strokeWidth",e,n)),a=Hp(Yht(n[1].encode,t,uw));return wl("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function Lpe(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):Ape(e,n[0].encode)}function Yht(e,t,n){return Ape("fontSize",e)||mht("fontSize",t,n)}const Zht='item.orient==="'.concat(u0,'"?-90:item.orient==="').concat(l0,'"?90:0');function Jht(e,t){e=Bn(e)?{text:e}:e;const n=vo(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],l={},c=ft(t.add(vu(null,[l])));return u.push(tpt(e,n,Qht(e),c)),e.subtitle&&u.push(npt(e,n,r.subtitle,c)),iO(cw({role:Kft,from:c,encode:ept(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),t)}function Qht(e){const t=e.encode;return t&&t.title||Rt({name:e.name,interactive:e.interactive,style:e.style},t)}function ept(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Kj},angle:{signal:Zht},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),o0(n,t,lw)}function tpt(e,t,n,r){const i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Go({type:Kp,role:Xft,style:sht,from:r,encode:o},n)}function npt(e,t,n,r){const i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Go({type:Kp,role:Yft,style:uht,from:r,encode:o},n)}function rpt(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(Zj(r,t))}),e.on&&e.on.forEach(r=>{$pe(r,t,e.name)}),t.addDataPipeline(e.name,ipt(e,t,n))}function ipt(e,t,n){const r=[];let i=null,a=!1,o=!1,s,u,l,c,f;for(e.values?di(e.values)||YT(e.format)?(r.push(Bpe(t,e)),r.push(i=Yp())):r.push(i=Yp({$ingest:e.values,$format:e.format})):e.url?YT(e.url)||YT(e.format)?(r.push(Bpe(t,e)),r.push(i=Yp())):r.push(i=Yp({$request:e.url,$format:e.format})):e.source&&(i=s=xt(e.source).map(d=>ft(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Yp()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(a=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=$dt({derive:a,pulse:l?s:s[0]}),(a||l)&&r.splice(1,0,Yp())),i||r.push(Yp()),r.push(Gp({})),r}function Yp(e){const t=vu({},e);return t.metadata={source:!0},t}function Bpe(e,t){return Odt({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const zpe=e=>e===Ld||e===yu,aO=(e,t,n)=>di(e)?upt(e.signal,t,n):e===u0||e===yu?t:n,Ai=(e,t,n)=>di(e)?opt(e.signal,t,n):zpe(e)?t:n,bu=(e,t,n)=>di(e)?spt(e.signal,t,n):zpe(e)?n:t,jpe=(e,t,n)=>di(e)?lpt(e.signal,t,n):e===yu?{value:t}:{value:n},apt=(e,t,n)=>di(e)?cpt(e.signal,t,n):e===l0?{value:t}:{value:n},opt=(e,t,n)=>Upe("".concat(e," === '").concat(yu,"' || ").concat(e," === '").concat(Ld,"'"),t,n),spt=(e,t,n)=>Upe("".concat(e," !== '").concat(yu,"' && ").concat(e," !== '").concat(Ld,"'"),t,n),upt=(e,t,n)=>Qj("".concat(e," === '").concat(u0,"' || ").concat(e," === '").concat(yu,"'"),t,n),lpt=(e,t,n)=>Qj("".concat(e," === '").concat(yu,"'"),t,n),cpt=(e,t,n)=>Qj("".concat(e," === '").concat(l0,"'"),t,n),Upe=(e,t,n)=>(t=t!=null?Ei(t):t,n=n!=null?Ei(n):n,Wpe(t)&&Wpe(n)?(t=t?t.signal||gt(t.value):null,n=n?n.signal||gt(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Rt({test:e},t)].concat(n||[])),Wpe=e=>e==null||Object.keys(e).length===1,Qj=(e,t,n)=>({signal:"".concat(e," ? (").concat(f0(t),") : (").concat(f0(n),")")}),fpt=(e,t,n,r,i)=>({signal:(r!=null?"".concat(e," === '").concat(u0,"' ? (").concat(f0(r),") : "):"")+(n!=null?"".concat(e," === '").concat(Ld,"' ? (").concat(f0(n),") : "):"")+(i!=null?"".concat(e," === '").concat(l0,"' ? (").concat(f0(i),") : "):"")+(t!=null?"".concat(e," === '").concat(yu,"' ? (").concat(f0(t),") : "):"")+"(null)"}),f0=e=>di(e)?e.signal:e==null?null:gt(e),dpt=(e,t)=>t===0?0:di(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},d0=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function h0(e,t,n,r){let i;if(t&&_t(t,e))return t[e];if(_t(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[Wj][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[uw][i]}return null}function Vpe(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function hpt(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,s,u,l;if(di(o)){const f=Vpe([n.axisX,n.axisY]),d=Vpe([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=Ai(o,h0(l,n.axisX,i,r),h0(l,n.axisY,i,r));u={};for(l of d)u[l]=fpt(o.signal,h0(l,n.axisTop,i,r),h0(l,n.axisBottom,i,r),h0(l,n.axisLeft,i,r),h0(l,n.axisRight,i,r))}else s=o===yu||o===Ld?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return s||u||a?Rt({},i,s,u,a):i}function ppt(e,t,n,r){const i=vo(e,t),a=e.orient;let o,s;const u={enter:o={opacity:pn},update:s={opacity:ws},exit:{opacity:pn}};Ui(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=qpe(e,0),c=qpe(e,1);return o.x=s.x=Ai(a,l,pn),o.x2=s.x2=Ai(a,c),o.y=s.y=bu(a,l,pn),o.y2=s.y2=bu(a,c),Go({type:Gj,role:$ft,from:r,encode:u},n)}function qpe(e,t){return{scale:e.scale,range:t}}function gpt(e,t,n,r,i){const a=vo(e,t),o=e.orient,s=e.gridScale,u=aO(o,1,-1),l=mpt(e.offset,u);let c,f,d;const h={enter:c={opacity:pn},update:d={opacity:ws},exit:f={opacity:pn}};Ui(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:e.scale,field:xs,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=Ai(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},v=s?{scale:s,range:1,mult:u,offset:l}:Rt(g,{mult:u,offset:l});return c.x=d.x=Ai(o,p,m),c.y=d.y=bu(o,p,m),c.x2=d.x2=bu(o,v),c.y2=d.y2=Ai(o,v),f.x=Ai(o,p),f.y=bu(o,p),Go({type:Gj,role:Lft,key:xs,from:r,encode:h},n)}function mpt(e,t){if(t!==1)if(!Nt(e))e=di(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=Rt({},e);for(;n.mult!=null;)if(Nt(n.mult))n=n.mult=Rt({},n.mult);else return n.mult=di(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function vpt(e,t,n,r,i,a){const o=vo(e,t),s=e.orient,u=aO(s,-1,1);let l,c,f;const d={enter:l={opacity:pn},update:f={opacity:ws},exit:c={opacity:pn}};Ui(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Ei(i);h.mult=u;const p={scale:e.scale,field:xs,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return f.y=l.y=Ai(s,pn,p),f.y2=l.y2=Ai(s,h),c.x=Ai(s,p),f.x=l.x=bu(s,pn,p),f.x2=l.x2=bu(s,h),c.y=bu(s,p),Go({type:Gj,role:zft,key:xs,from:r,encode:d},n)}function e8(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function ypt(e,t,n,r,i,a){const o=vo(e,t),s=e.orient,u=e.scale,l=aO(s,-1,1),c=Hp(o("labelFlush")),f=Hp(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=Ei(i);m.mult=l,m.offset=Ei(o("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:xs,band:.5,offset:Cpe(a.offset,o("labelOffset"))},y=Ai(s,p?e8(u,c,'"left"','"right"','"center"'):{value:"center"},apt(s,"left","right")),b=Ai(s,jpe(s,"bottom","top"),p?e8(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=e8(u,c,"-(".concat(f,")"),f,0);p=p&&f;const w={opacity:pn,x:Ai(s,v,m),y:bu(s,v,m)},S={enter:w,update:g={opacity:ws,text:{field:Uj},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:pn,x:w.x,y:w.y}};Ui(S,{dx:!d&&p?Ai(s,x):null,dy:!h&&p?bu(s,x):null}),Ui(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const A=o("labelBound");let _=o("labelOverlap");return _=_||A?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:A?{scale:u,orient:s,tolerance:A}:null}:void 0,g.align!==y&&(g.align=d0(g.align,y)),g.baseline!==b&&(g.baseline=d0(g.baseline,b)),Go({type:Kp,role:Bft,style:uw,key:xs,from:r,encode:S,overlap:_},n)}function bpt(e,t,n,r){const i=vo(e,t),a=e.orient,o=aO(a,-1,1);let s,u;const l={enter:s={opacity:pn,anchor:Ei(i("titleAnchor",null)),align:{signal:Kj}},update:u=Rt({},s,{opacity:ws,text:Ei(e.title)}),exit:{opacity:pn}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(tO(0,1,.5),")")};return u.x=Ai(a,c),u.y=bu(a,c),s.angle=Ai(a,pn,dpt(o,90)),s.baseline=Ai(a,jpe(a,Ld,yu),{value:Ld}),u.angle=s.angle,u.baseline=s.baseline,Ui(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),xpt(i,a,l,n),l.update.align=d0(l.update.align,s.align),l.update.angle=d0(l.update.angle,s.angle),l.update.baseline=d0(l.update.baseline,s.baseline),Go({type:Kp,role:jft,style:Wj,from:r,encode:l},n)}function xpt(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=d0(Ei(s),n.update[u]),!1):!s0(u,r),a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?Ei(o):Ai(t,Ei(o),Ei(a))}function wpt(e,t){const n=hpt(e,t),r=e.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=vo(e,n),l=vht(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ft(t.add(vu({},[c]))),d=ft(t.add(_dt({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(gpt(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(vpt(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(ypt(e,n,r.labels,d,p,l))),c.domain&&h.push(ppt(e,n,r.domain,f)),c.title&&h.push(bpt(e,n,r.title,f)),iO(cw({role:Pft,from:f,encode:o0(_pt(u,e),i,lw),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),t)}function _pt(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),offset:e("offset")||0,position:mu(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Hpe(e,t,n){const r=xt(e.signals),i=xt(e.scales);return n||r.forEach(a=>upe(a,t)),xt(e.projections).forEach(a=>eht(a,t)),i.forEach(a=>Udt(a,t)),xt(e.data).forEach(a=>rpt(a,t)),i.forEach(a=>Wdt(a,t)),(n||r).forEach(a=>wdt(a,t)),xt(e.axes).forEach(a=>wpt(a,t)),xt(e.marks).forEach(a=>iO(a,t)),xt(e.legends).forEach(a=>qht(a,t)),e.title&&Jht(e.title,t),t.parseLambdas(),t}const Spt=e=>o0({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Ept(e,t){const n=t.config,r=ft(t.root=t.add(KT())),i=Apt(e,n);i.forEach(l=>upe(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(vu()),o=t.add(ppe(ope(Spt(e.encode),eO,Dj,e.style,t,{pulse:ft(a)}))),s=t.add(vpe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ft(o)}));t.operators.pop(),t.pushState(ft(o),ft(s),null),Hpe(e,t,i),t.operators.push(s);let u=t.add(dpe({mark:r,pulse:ft(s)}));return u=t.add(mpe({pulse:ft(u)})),u=t.add(Gp({pulse:ft(u)})),t.addData("root",new Xp(t,a,a,u)),t}function dw(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Apt(e,t){const n=o=>mu(e[o],t[o]),r=[dw("background",n("background")),dw("autosize",Rft(n("autosize"))),dw("padding",Mft(n("padding"))),dw("width",n("width")||0),dw("height",n("height")||0)],i=r.reduce((o,s)=>(o[s.name]=s,o),{}),a={};return xt(e.signals).forEach(o=>{_t(i,o.name)?o=Rt(i[o.name],o):r.push(o),a[o.name]=o}),xt(t.signals).forEach(o=>{!_t(a,o.name)&&!_t(i,o.name)&&r.push(o)}),r}function Gpe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Kpe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}Gpe.prototype=Kpe.prototype={parse(e){return Hpe(e,this)},fork(){return new Kpe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Mj?ft(e):e;return this.add(Pdt({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,a){let o,s;r&&(o=r.data||(r.data={}),s=o[i]||(o[i]=[]),s.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ft(this.add(Gp({pulse:e})))),this._parent.push(t),this._lookup.push(n?ft(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return sn(this._parent)},encode(){return sn(this._encode)},lookup(){return sn(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Bn(e))return ow(e,t);e.signal||Se("Unsupported field reference: "+gt(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ft(this.add(Cdt(i)))}return r},compareRef(e){let t=!1;const n=a=>di(a)?(t=!0,this.signalRef(a.signal)):fdt(a)?(t=!0,this.exprRef(a.expr)):a,r=xt(e.field).map(n),i=xt(e.order).map(n);return t?ft(this.add(hpe({fields:r,orders:i}))):lpe(r,i)},keyRef(e,t){let n=!1;const r=a=>di(a)?(n=!0,ft(i[a.signal])):a,i=this.signals;return e=xt(e).map(r),n?ft(this.add(kdt({fields:e,flat:t}))):sdt(e,t)},sortRef(e){if(!e)return e;const t=XT(e.op,e.field),n=e.order||udt;return n.signal?ft(this.add(hpe({fields:t,orders:this.signalRef(n.signal)}))):lpe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return _t(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Se("Duplicate signal name: "+gt(e));const n=t instanceof Mj?t:this.add(KT(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Se("Unrecognized signal name: "+gt(e)),this.signals[e]},signalRef(e){return this.signals[e]?ft(this.signals[e]):(_t(this.lambdas,e)||(this.lambdas[e]=this.add(KT(null))),ft(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=wl(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Nt(e)?e:this.signalRef(e.signal||t8(e))},exprRef(e,t){const n={expr:wl(e,this)};return t&&(n.expr.$name=t),ft(this.add(Edt(n)))},addBinding(e,t){this.bindings||Se("Nested signals do not support binding: "+gt(e)),this.bindings.push(Rt({signal:e},t))},addScaleProj(e,t){_t(this.scales,e)&&Se("Duplicate scale or projection name: "+gt(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Ldt(t))},addProjection(e,t){this.addScaleProj(e,Mdt(t))},getScale(e){return this.scales[e]||Se("Unrecognized scale name: "+gt(e)),this.scales[e]},scaleRef(e){return ft(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.data[e]=t},getData(e){return this.data[e]||Se("Undefined data set name: "+gt(e)),this.data[e]},addDataPipeline(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.addData(e,Xp.fromEntries(this,t))}};function t8(e){return(ut(e)?Cpt:kpt)(e)}function Cpt(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Nt(i)?i.signal||t8(i):gt(i))}return n+"]"}function kpt(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+gt(r)+":"+(Nt(i)?i.signal||t8(i):gt(i));return t+"}"}function Tpt(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Opt(e,t,n){return Nt(e)||Se("Input Vega specification must be an object."),t=UA(Tpt(),t,e.config),Ept(e,new Gpe(t,n)).toRuntime()}var Ipt="vega",Npt="5.20.0",Dpt="The Vega visualization grammar.",Rpt=["vega","visualization","interaction","dataflow","library","data","d3"],Fpt="BSD-3-Clause",Mpt="UW Interactive Data Lab (http://idl.cs.washington.edu)",Ppt="build/vega-node.js",$pt="build/vega.module.js",Lpt="build/vega.min.js",Bpt="build/vega.min.js",zpt="index.d.ts",jpt="vega/vega",Upt={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Wpt={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Vpt={"vega-schema":"*"},qpt="f262105e75449760b0f35fda70e6b576a31d68a4",Hpt={name:Ipt,version:Npt,description:Dpt,keywords:Rpt,license:Fpt,author:Mpt,main:Ppt,module:$pt,unpkg:Lpt,jsdelivr:Bpt,types:zpt,repository:jpt,scripts:Upt,dependencies:Wpt,devDependencies:Vpt,gitHead:qpt};Rt(Ev,UYe,lnt,jnt,Cit,xat,Kot,Sot,Yot,hst,Sst,Ist);const Gpt=Hpt.version;var Kpt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Gpt,Dataflow:Sv,EventStream:dC,MultiPulse:x4,Operator:Yn,Parameters:fC,Pulse:cd,Transform:ve,changeset:xp,definition:Sae,ingest:In,isTuple:uC,transform:Eae,transforms:Ev,tupleid:lt,interpolate:oz,interpolateColors:KC,interpolateRange:sue,quantizeInterpolator:uue,scale:Sn,scheme:sz,projection:e6,View:qhe,defaultLocale:v4,formatLocale:iC,locale:lae,resetDefaultLocale:sXe,timeFormatLocale:P1,expressionFunction:Jr,parse:Opt,runtimeContext:Ahe,codegenExpression:rhe,parseExpression:ehe,parseSelector:$d,Debug:mre,Error:yL,Info:gre,None:hre,Warn:pre,accessor:io,accessorFields:Yi,accessorName:Ir,array:xt,ascending:KA,clampRange:Ore,compare:_L,constant:Ji,debounce:SL,error:Se,extend:Rt,extent:nl,extentIndex:Ire,falsy:Jf,fastmap:pv,field:ao,flush:Nre,hasOwnProperty:_t,id:h1,identity:Oa,inherits:$e,inrange:gv,isArray:ut,isBoolean:EL,isDate:Qf,isFunction:$t,isIterable:Dre,isNumber:ed,isObject:Nt,isRegExp:Rre,isString:Bn,key:AL,lerp:Fre,logger:vre,lruCache:Mre,merge:Pre,mergeConfig:UA,one:hv,pad:$re,panLinear:Sre,panLog:Ere,panPow:Are,panSymlog:Cre,peek:sn,quarter:kre,repeat:p1,span:g1,splitAccessPath:zA,stringValue:gt,toBoolean:CL,toDate:kL,toNumber:Zi,toSet:iu,toString:TL,truncate:Lre,truthy:fs,utcquarter:Tre,visitArray:td,writeConfig:WA,zero:Zf,zoomLinear:bL,zoomLog:xL,zoomPow:GA,zoomSymlog:wL,bandwidthNRD:E4,bin:Cae,bootstrapCI:kae,cumulativeLogNormal:I4,cumulativeNormal:mC,cumulativeUniform:F4,densityLogNormal:O4,densityNormal:A4,densityUniform:R4,dotbin:Tae,quantileLogNormal:N4,quantileNormal:vC,quantileUniform:M4,quantiles:_4,quartiles:S4,get random(){return ps},randomInteger:GXe,randomKDE:k4,randomLCG:HXe,randomLogNormal:Iae,randomMixture:Nae,randomNormal:C4,randomUniform:Dae,regressionExp:Fae,regressionLinear:P4,regressionLoess:Bae,regressionLog:Rae,regressionPoly:Pae,regressionPow:Mae,regressionQuad:$4,sampleCurve:bC,sampleLogNormal:T4,sampleNormal:gC,sampleUniform:D4,setRandom:VXe,DATE:uo,DAY:ea,DAYOFYEAR:rl,HOURS:jo,MILLISECONDS:au,MINUTES:Uo,MONTH:Qi,QUARTER:so,SECONDS:hs,TIME_UNITS:t4,WEEK:ui,YEAR:$i,dayofyear:bie,timeBin:Lie,timeFloor:Cie,timeInterval:bv,timeOffset:Oie,timeSequence:Die,timeUnitSpecifier:yie,timeUnits:r4,utcFloor:kie,utcInterval:xv,utcOffset:Iie,utcSequence:Rie,utcdayofyear:_ie,utcweek:Sie,week:xie,read:cae,inferType:jre,inferTypes:Ure,typeParsers:OL,format:ZA,formats:ML,responseType:Yre,loader:aC,Bounds:ci,CanvasHandler:vx,CanvasRenderer:wk,Gradient:Eue,GroupItem:ek,Handler:Ad,Item:QC,Marks:Wo,RenderType:kd,Renderer:gl,ResourceLoader:yz,SVGHandler:Gz,SVGRenderer:e5,SVGStringRenderer:r5,Scenegraph:Uz,boundClip:Ule,boundContext:ux,boundItem:jz,boundMark:rle,boundStroke:Tc,domChild:co,domClear:lu,domCreate:Ed,domFind:Wz,font:dk,fontFamily:hx,fontSize:pl,intersect:Lle,intersectBoxLine:jv,intersectPath:Az,intersectPoint:Cz,intersectRule:Uue,lineHeight:_d,markup:Qz,multiLineOffset:Lz,pathCurves:dz,pathEqual:Wle,pathParse:Lv,pathRectangle:Nue,pathRender:rx,pathSymbols:Iue,pathTrail:Due,point:pk,renderModule:Sk,resetSVGClipId:Fue,resetSVGDefIds:Att,sceneEqual:a5,sceneFromJSON:ale,scenePickVisit:sk,sceneToJSON:ile,sceneVisit:uu,sceneZOrder:kz,serializeXML:kle,textMetrics:hl});const Xpt="vega-lite",Ypt='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Zpt="4.13.1",Jpt=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Qpt="https://vega.github.io/vega-lite/",egt="Vega-Lite is a concise high-level language for interactive visualization.",tgt="build/vega-lite.js",ngt="build/vega-lite.min.js",rgt="build/vega-lite.min.js",igt="build/src/index",agt="build/src/index.d.ts",ogt={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},sgt={test:"test"},ugt={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},lgt={type:"git",url:"https://github.com/vega/vega-lite.git"},cgt="BSD-3-Clause",fgt={url:"https://github.com/vega/vega-lite/issues"},dgt={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},hgt={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},pgt={vega:"^5.12.1"},ggt={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1};var mgt={name:Xpt,author:Ypt,version:Zpt,collaborators:Jpt,homepage:Qpt,description:egt,main:tgt,unpkg:ngt,jsdelivr:rgt,module:igt,types:agt,bin:ogt,directories:sgt,scripts:ugt,repository:lgt,license:cgt,bugs:fgt,devDependencies:dgt,dependencies:hgt,peerDependencies:pgt,jest:ggt};function p0(e,t,n){return e.fields=t||[],e.fname=n,e}function vgt(e){return e.length===1?ygt(e[0]):bgt(e)}const ygt=e=>function(t){return t[e]},bgt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function n8(e){throw Error(e)}function Zp(e){var t=[],n=null,r=0,i=e.length,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<i;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=s+1,n=u):u==="."&&!r?s>o?l():o=s+1:u==="["?(s>o&&l(),r=o=s+1):u==="]"&&(r||n8("Access path missing open bracket: "+e),r>0&&l(),r=0,o=s+1)}return r&&n8("Access path missing closing bracket: "+e),n&&n8("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function xgt(e,t,n){const r=Zp(e);return e=r.length===1?r[0]:e,p0((n&&n.get||vgt)(r),[e],t||e)}var hw=[];xgt("id");var wgt=p0(function(e){return e},hw,"identity");p0(function(){return 0},hw,"zero"),p0(function(){return 1},hw,"one"),p0(function(){return!0},hw,"true"),p0(function(){return!1},hw,"false");function oO(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var _gt=0,Sgt=1,Xpe=2,Egt=3,Agt=4;function Cgt(e,t){var n=e||_gt;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=Sgt&&oO(t||"error","ERROR",arguments),this},warn:function(){return n>=Xpe&&oO(t||"warn","WARN",arguments),this},info:function(){return n>=Egt&&oO(t||"log","INFO",arguments),this},debug:function(){return n>=Agt&&oO(t||"log","DEBUG",arguments),this}}}var vt=Array.isArray;function Ci(e){return e===Object(e)}const Ype=e=>e!=="__proto__";function Zpe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=kgt(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;r8(t,r,n[r],i)}return t},{})}function r8(e,t,n,r){if(!!Ype(t)){var i,a;if(Ci(n)&&!vt(n)){a=Ci(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?r8(a,i,n[i]):Ype(i)&&(a[i]=n[i])}else e[t]=n}}function kgt(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function zr(e){return e!=null?vt(e)?e:[e]:[]}function Tgt(e){return typeof e=="function"}const Ogt=Object.prototype.hasOwnProperty;function Jp(e,t){return Ogt.call(e,t)}function pw(e){return typeof e=="boolean"}function Qr(e){return typeof e=="number"}function Xt(e){return typeof e=="string"}function gn(e){return vt(e)?"["+e.map(gn)+"]":Ci(e)||Xt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Qp(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Jpe={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var a;try{a=Promise}catch(d){a=function(){}}function o(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var v=[],y=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var A,_;if(typeof w!="object")return w;if(n(w,r))A=new r;else if(n(w,i))A=new i;else if(n(w,a))A=new a(function(L,W){w.then(function(G){L(x(G,S-1))},function(G){W(x(G,S-1))})});else if(o.__isArray(w))A=[];else if(o.__isRegExp(w))A=new RegExp(w.source,f(w)),w.lastIndex&&(A.lastIndex=w.lastIndex);else if(o.__isDate(w))A=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?A=Buffer.allocUnsafe(w.length):A=new Buffer(w.length),w.copy(A),A;n(w,Error)?A=Object.create(w):typeof g=="undefined"?(_=Object.getPrototypeOf(w),A=Object.create(_)):(A=Object.create(g),_=g)}if(h){var E=v.indexOf(w);if(E!=-1)return y[E];v.push(w),y.push(A)}n(w,r)&&w.forEach(function(L,W){var G=x(W,S-1),K=x(L,S-1);A.set(G,K)}),n(w,i)&&w.forEach(function(L){var W=x(L,S-1);A.add(W)});for(var C in w){var k;_&&(k=Object.getOwnPropertyDescriptor(_,C)),!(k&&k.set==null)&&(A[C]=x(w[C],S-1))}if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(w),C=0;C<T.length;C++){var I=T[C],N=Object.getOwnPropertyDescriptor(w,I);N&&!N.enumerable&&!m||(A[I]=x(w[I],S-1),N.enumerable||Object.defineProperty(A,I,{enumerable:!1}))}if(m)for(var O=Object.getOwnPropertyNames(w),C=0;C<O.length;C++){var D=O[C],N=Object.getOwnPropertyDescriptor(w,D);N&&N.enumerable||(A[D]=x(w[D],S-1),Object.defineProperty(A,D,{enumerable:!1}))}return A}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function s(d){return Object.prototype.toString.call(d)}o.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(Jpe);var Igt=Jpe.exports,Ngt=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!=0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},gw=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(a){return function(o){return function(s,u){var l={key:s,value:o[s]},c={key:u,value:o[u]};return a(l,c)}}}(t.cmp),i=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var s,u;if(Array.isArray(o)){for(u="[",s=0;s<o.length;s++)s&&(u+=","),u+=a(o[s])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",s=0;s<c.length;s++){var f=c[s],d=a(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function i8(e){return!!e.or}function a8(e){return!!e.and}function o8(e){return!!e.not}function sO(e,t){if(o8(e))sO(e.not,t);else if(a8(e))for(const n of e.and)sO(n,t);else if(i8(e))for(const n of e.or)sO(n,t);else t(e)}function uO(e,t){return o8(e)?{not:uO(e.not,t)}:a8(e)?{and:e.and.map(n=>uO(n,t))}:i8(e)?{or:e.or.map(n=>uO(n,t))}:t(e)}const mw=Ngt,Yt=Igt;function vw(e,t){const n={};for(const r of t)Jp(e,r)&&(n[r]=e[r]);return n}function Lc(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>gw(e)).join(",")})`};const hr=gw;function yn(e){if(Qr(e))return e;const t=Xt(e)?e:gw(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function Qpe(e){return e===!1||e===null}function bt(e,t){return e.indexOf(t)>-1}function yw(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function ege(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function Dgt(e,...t){for(const n of t)Rgt(e,n??{});return e}function Rgt(e,t){for(const n of Be(t))r8(e,n,t[n],!0)}function Bd(e,t){const n=[],r={};let i;for(const a of e)i=t(a),!(i in r)&&(r[i]=1,n.push(a));return n}function Fgt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function tge(e,t){for(const n of e)if(t.has(n))return!0;return!1}function nge(e){const t=new Set;for(const n of e){const i=Zp(n).map((o,s)=>s===0?o:`[${o}]`),a=i.map((o,s)=>i.slice(0,s+1).join(""));for(const o of a)t.add(o)}return t}function rge(e,t){return e===void 0||t===void 0?!0:tge(nge(e),nge(t))}function Zn(e){return Be(e).length===0}const Be=Object.keys,zd=Object.values;function ige(e){const t=[];for(const n in e)Jp(e,n)&&t.push({key:n,value:e[n]});return t}function lO(e){return e===!0||e===!1}function pr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function bw(e,t){return o8(e)?"!("+bw(e.not,t)+")":a8(e)?"("+e.and.map(n=>bw(n,t)).join(") && (")+")":i8(e)?"("+e.or.map(n=>bw(n,t)).join(") || (")+")":t(e)}function s8(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&s8(e[n],t)&&delete e[n],Zn(e)}function cO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function age(e,t="datum"){const n=Zp(e),r=[];for(let i=1;i<=n.length;i++){const a=`[${n.slice(0,i).map(gn).join("][")}]`;r.push(`${t}${a}`)}return r.join(" && ")}function Mgt(e,t="datum"){return`${t}[${gn(Zp(e).join("."))}]`}function Pgt(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function jd(e){return`${Zp(e).map(Pgt).join("\\.")}`}function g0(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function oge(e){return`${Zp(e).join(".")}`}function xw(e){return e?Zp(e).length:0}function ei(...e){for(const t of e)if(t!==void 0)return t}let $gt=42;function Lgt(e){const t=++$gt;return e?String(e)+t:t}function Bgt(e){return zgt(e)?e:`__${e}`}function zgt(e){return e.indexOf("__")===0}function fO(e){if(e!==void 0)return(e%360+360)%360}function u8(e){return Qr(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const sge={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function l8(e){return e&&e.condition}const uge=["domain","grid","labels","ticks","title"],jgt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},lge={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Ugt=Object.assign(Object.assign({},lge),{style:1,labelExpr:1,encoding:1});function cge(e){return!!Ugt[e]}const Ua={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},fge=Ua.arc,dO=Ua.area,hO=Ua.bar,Wgt=Ua.image,pO=Ua.line,gO=Ua.point,Vgt=Ua.rect,mO=Ua.rule,dge=Ua.text,c8=Ua.tick,qgt=Ua.trail,f8=Ua.circle,d8=Ua.square,hge=Ua.geoshape;function eg(e){return bt(["line","area","trail"],e)}function pge(e){return bt(["rect","bar","image","arc"],e)}const gge=Be(Ua);function _l(e){return e.type}Qp(gge);const Hgt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Ggt=["fill","fillOpacity"],Kgt=[...Hgt,...Ggt],Xgt={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},mge=Be(Xgt),Ygt={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Zgt={color:"#4c78a8",invalid:"filter",timeUnitBand:1},Jgt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},vge=5,Qgt={binSpacing:1,continuousBandSize:vge,timeUnitBandPosition:.5},emt={binSpacing:0,continuousBandSize:vge,timeUnitBandPosition:.5},tmt={thickness:1};function nmt(e){return _l(e)?e.type:e}function Bc(e){return"mark"in e}class vO{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Bc(t)?nmt(t.mark)===this.name:!1}}const rmt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},imt={count:1,min:1,max:1};function Ud(e){return!!e&&!!e.argmin}function tg(e){return!!e&&!!e.argmax}function h8(e){return Xt(e)&&!!rmt[e]}const amt=["count","valid","missing","distinct"];function yge(e){return Xt(e)&&bt(amt,e)}function omt(e){return Xt(e)&&bt(["min","max"],e)}const smt=["count","sum","distinct","valid","missing"],umt=["mean","average","median","q1","q3","min","max"],lmt=Qp(umt),zc="row",jc="column",yO="facet",wr="x",hi="y",xu="x2",Sl="y2",El="radius",Uc="radius2",wu="theta",Wc="theta2",Al="latitude",Cl="longitude",_u="latitude2",_s="longitude2",yo="color",kl="fill",Tl="stroke",bo="shape",Vc="size",ng="angle",qc="opacity",Wd="fillOpacity",Vd="strokeOpacity",qd="strokeWidth",Hd="strokeDash",ww="text",_w="order",Sw="detail",bO="key",rg="tooltip",xO="href",wO="url",_O="description",cmt={x:1,y:1,x2:1,y2:1},bge={theta:1,theta2:1,radius:1,radius2:1};function xge(e){return e in bge}const p8={longitude:1,longitude2:1,latitude:1,latitude2:1};function fmt(e){switch(e){case Al:return"y";case _u:return"y2";case Cl:return"x";case _s:return"x2"}}function dmt(e){return e in p8}const hmt=Be(p8),wge=Object.assign(Object.assign(Object.assign(Object.assign({},cmt),bge),p8),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function m0(e){return e===yo||e===kl||e===Tl}const _ge={row:1,column:1,facet:1},Ss=Be(_ge),g8=Object.assign(Object.assign({},wge),_ge),Sge=Be(g8),pmt=dt(g8,["order","detail","tooltip"]),gmt=dt(pmt,["row","column","facet"]);function mmt(e){return!!gmt[e]}function Ege(e){return!!g8[e]}const vmt=[xu,Sl,_u,_s,Wc,Uc];function Age(e){return ig(e)!==e}function ig(e){switch(e){case xu:return wr;case Sl:return hi;case _u:return Al;case _s:return Cl;case Wc:return wu;case Uc:return El}return e}function Gd(e){if(xge(e))switch(e){case wu:return"startAngle";case Wc:return"endAngle";case El:return"outerRadius";case Uc:return"innerRadius"}return e}function Ol(e){switch(e){case wr:return xu;case hi:return Sl;case Al:return _u;case Cl:return _s;case wu:return Wc;case El:return Uc}}function Il(e){switch(e){case wr:case xu:return"width";case hi:case Sl:return"height"}}function ymt(e){switch(e){case wr:return"xOffset";case hi:return"yOffset";case xu:return"x2Offset";case Sl:return"y2Offset";case wu:return"thetaOffset";case El:return"radiusOffset";case Wc:return"theta2Offset";case Uc:return"radius2Offset"}}const m8=dt(wge,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),bmt=Be(m8),Kd={x:1,y:1},Es=Be(Kd);function Nl(e){return e in Kd}const v8={theta:1,radius:1},xmt=Be(v8);function SO(e){return e==="width"?wr:hi}const Cge=dt(m8,["text","tooltip","href","url","description","detail","key","order"]),wmt=Be(Cge);function _mt(e){return!!m8[e]}function Smt(e){switch(e){case yo:case kl:case Tl:case Vc:case bo:case qc:case qd:case Hd:return!0;case Wd:case Vd:case ng:return!1}}const kge=Object.assign(Object.assign(Object.assign({},Kd),v8),Cge),EO=Be(kge);function Xd(e){return!!kge[e]}function Emt(e,t){return Cmt(e)[t]}const Tge={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Amt=dt(Tge,["geoshape"]);function Cmt(e){switch(e){case yo:case kl:case Tl:case _O:case Sw:case bO:case rg:case xO:case _w:case qc:case Wd:case Vd:case qd:case yO:case zc:case jc:return Tge;case wr:case hi:case Al:case Cl:return Amt;case xu:case Sl:case _u:case _s:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Vc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Hd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case bo:return{point:"always",geoshape:"always"};case ww:return{text:"always"};case ng:return{point:"always",square:"always",text:"always"};case wO:return{image:"always"};case wu:return{text:"always",arc:"always"};case El:return{text:"always",arc:"always"};case Wc:case Uc:return{arc:"always"}}}function AO(e){switch(e){case wr:case hi:case wu:case El:case Vc:case ng:case qd:case qc:case Wd:case Vd:case xu:case Sl:case Wc:case Uc:return;case yO:case zc:case jc:case bo:case Hd:case ww:case rg:case xO:case wO:case _O:return"discrete";case yo:case kl:case Tl:return"flexible";case Al:case Cl:case _u:case _s:case Sw:case bO:case _w:return}}function Oge(e){return pw(e)&&(e=$O(e,void 0)),"bin"+Be(e).map(t=>CO(e[t])?pr(`_${t}_${Object.entries(e[t])}`):pr(`_${t}_${e[t]}`)).join("")}function er(e){return e===!0||Ew(e)&&!e.binned}function Wa(e){return e==="binned"||Ew(e)&&e.binned===!0}function Ew(e){return Ci(e)}function CO(e){return e==null?void 0:e.selection}function Ige(e){switch(e){case zc:case jc:case Vc:case yo:case kl:case Tl:case qd:case qc:case Wd:case Vd:case bo:return 6;case Hd:return 4;default:return 10}}function y8(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const kmt='Autosize "fit" only works for single views and layered views.';function Nge(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function Dge(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Rge(e){return e?`Dropping "fit-${e}" because spec has discrete ${Il(e)}.`:'Dropping "fit" because spec has discrete size.'}function Fge(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Tmt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Omt(e){return`The "nearest" transform is not supported for ${e} marks.`}function Mge(e){return`Selection not supported for ${e} yet.`}function Imt(e){return`Cannot find a selection named "${e}".`}const Nmt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Dmt="Legend bindings are only supported for selections over an individual field or encoding channel.";function Rmt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function Fmt(e){return`Unknown repeated value "${e}".`}function Pge(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Mmt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Pmt(e){return`Unrecognized parse "${e}".`}function $ge(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function $mt(e){return`Ignoring an invalid transform: ${hr(e)}.`}const Lmt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Lge(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Bmt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function zmt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${hr(t)} is overridden by a child projection ${hr(n)}.`}const jmt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Umt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${hr(n)}}.`}function Bge(e){return`Invalid field type "${e}".`}function Wmt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Vmt(e){return`Invalid aggregation operator "${e}".`}function qmt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function zge(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function b8(e,t){return`Dropping ${hr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Hmt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function kO(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Gmt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Kmt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Xmt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function x8(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Ymt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Zmt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const Jmt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function Qmt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function evt(e){return`Using unaggregated domain with raw field has no effect (${hr(e)}).`}function tvt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function nvt(e){return`Unaggregated domain is currently unsupported for log scale (${hr(e)}).`}function rvt(e){return`Cannot apply size to non-oriented mark "${e}".`}function ivt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function avt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function jge(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Uge(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function ovt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hr(n)} and ${hr(r)}). Using ${hr(n)}.`}function svt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${hr(n)} and ${hr(r)}). Using the union of the two domains.`}function uvt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function lvt(e){return`Dropping sort property ${hr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const Wge="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",cvt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",fvt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",dvt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function hvt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function pvt(e){return`Cannot stack non-linear scale (${e}).`}function gvt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function TO(e,t){return`Invalid ${e}: ${hr(t)}.`}function mvt(e){return`Dropping day from datetime ${hr(e)} as day cannot be combined with other units.`}function vvt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function yvt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function bvt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function xvt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function Vge(e){return`1D error band does not support ${e}.`}function qge(e){return`Channel ${e} is required for "binned" bin.`}function wvt(e){return`Domain for ${e} is required for threshold scale.`}const Hge=Cgt(Xpe);let v0=Hge;function _vt(e){return v0=e,v0}function Svt(){return v0=Hge,v0}function Me(...e){v0.warn(...e)}function Evt(...e){v0.debug(...e)}function y0(e){if(e&&Ci(e)){for(const t of _8)if(t in e)return!0}return!1}const Gge=["january","february","march","april","may","june","july","august","september","october","november","december"],Avt=Gge.map(e=>e.substr(0,3)),Kge=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Cvt=Kge.map(e=>e.substr(0,3));function kvt(e){if(u8(e)&&(e=+e),Qr(e))return e>4&&Me(TO("quarter",e)),e-1;throw new Error(TO("quarter",e))}function Tvt(e){if(u8(e)&&(e=+e),Qr(e))return e-1;{const t=e.toLowerCase(),n=Gge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Avt.indexOf(r);if(i!==-1)return i;throw new Error(TO("month",e))}}function Ovt(e){if(u8(e)&&(e=+e),Qr(e))return e%7;{const t=e.toLowerCase(),n=Kge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Cvt.indexOf(r);if(i!==-1)return i;throw new Error(TO("day",e))}}function w8(e,t){const n=[];if(t&&e.day!==void 0&&Be(e).length>1&&(Me(mvt(e)),e=Yt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?Tvt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?kvt(e.quarter):e.quarter;n.push(Qr(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?Ovt(e.day):e.day;n.push(Qr(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function Aw(e){const n=w8(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Ivt(e){const n=w8(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Nvt(e){const t=w8(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const Xge={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},_8=Be(Xge);function Dvt(e){return!!Xge[e]}function S8(e){return e.startsWith("utc")}function Rvt(e){return e.substr(3)}const Fvt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function E8(e){const t=[];for(const n of _8)Yge(e,n)&&t.push(n);return t}function Yge(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Mvt(e,t,{end:n}={end:!1}){const r=age(t),i=S8(e)?"utc":"";function a(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const s={};for(const u of _8)Yge(e,u)&&(s[u]=a(u),o=u);return n&&(s[o]+="+1"),Ivt(s)}function Zge(e){if(!e)return;const t=E8(e);return`timeUnitSpecifier(${gw(t)}, ${gw(Fvt)})`}function Pvt(e,t,n){if(!e)return;const r=Zge(e);return`${n||S8(e)?"utc":"time"}Format(${t}, ${r})`}function Va(e){if(!e)return;let t;return Xt(e)?t={unit:e}:Ci(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),S8(t.unit)&&(t.utc=!0,t.unit=Rvt(t.unit)),t}function $vt(e){const t=Va(e),{utc:n}=t,r=dt(t,["utc"]);return r.unit?(n?"utc":"")+Be(r).map(i=>pr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Be(r).map(i=>pr(`_${i}_${r[i]}`)).join("")}function Et(e){return e&&!!e.signal}function Yd(e){return!!e.step}function Lvt(e){return vt(e)?!1:"fields"in e&&!("data"in e)}function Bvt(e){return vt(e)?!1:"fields"in e&&"data"in e}function Zd(e){return vt(e)?!1:"field"in e&&"data"in e}const zvt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},jvt=Be(zvt),Uvt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},A8=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Wvt(e){return e==null?void 0:e.selection}function C8(e){return e&&!!e.field&&e.equal!==void 0}function Jge(e){return e&&!!e.field&&e.lt!==void 0}function Qge(e){return e&&!!e.field&&e.lte!==void 0}function eme(e){return e&&!!e.field&&e.gt!==void 0}function tme(e){return e&&!!e.field&&e.gte!==void 0}function k8(e){if(e&&e.field){if(vt(e.range)&&e.range.length===2)return!0;if(Et(e.range))return!0}return!1}function T8(e){return e&&!!e.field&&(vt(e.oneOf)||vt(e.in))}function Vvt(e){return e&&!!e.field&&e.valid!==void 0}function nme(e){return T8(e)||C8(e)||k8(e)||Jge(e)||eme(e)||Qge(e)||tme(e)}function Dl(e,t){return H8(e,{timeUnit:t,wrapTime:!0})}function qvt(e,t){return e.map(n=>Dl(n,t))}function rme(e,t=!0){var n;const{field:r}=e,i=(n=Va(e.timeUnit))===null||n===void 0?void 0:n.unit,a=i?"time("+Mvt(i,r)+")":Ue(e,{expr:"datum"});if(C8(e))return a+"==="+Dl(e.equal,i);if(Jge(e)){const o=e.lt;return`${a}<${Dl(o,i)}`}else if(eme(e)){const o=e.gt;return`${a}>${Dl(o,i)}`}else if(Qge(e)){const o=e.lte;return`${a}<=${Dl(o,i)}`}else if(tme(e)){const o=e.gte;return`${a}>=${Dl(o,i)}`}else{if(T8(e))return`indexof([${qvt(e.oneOf,i).join(",")}], ${a}) !== -1`;if(Vvt(e))return O8(a,e.valid);if(k8(e)){const{range:o}=e,s=Et(o)?{signal:`${o.signal}[0]`}:o[0],u=Et(o)?{signal:`${o.signal}[1]`}:o[1];if(s!==null&&u!==null&&t)return"inrange("+a+", ["+Dl(s,i)+", "+Dl(u,i)+"])";const l=[];return s!==null&&l.push(`${a} >= ${Dl(s,i)}`),u!==null&&l.push(`${a} <= ${Dl(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function O8(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Hvt(e){var t;return nme(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Va(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const b0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},ag=b0.quantitative,I8=b0.ordinal,x0=b0.temporal,N8=b0.nominal,w0=b0.geojson,Gvt=Be(b0);function Kvt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case ag:return"quantitative";case"t":case x0:return"temporal";case"o":case I8:return"ordinal";case"n":case N8:return"nominal";case w0:return"geojson"}}const ti={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},D8={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},Xvt=Be(D8);function Yvt(e,t){const n=D8[e],r=D8[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const Zvt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function ime(e){return Zvt[e]}const ame=["linear","log","pow","sqrt","symlog","time","utc"],Jvt=Qp(ame),Qvt=["linear","log","pow","sqrt","symlog"],e0t=Qp(Qvt);function t0t(e){return e in e0t}const n0t=["quantile","quantize","threshold"],r0t=Qp(n0t),i0t=ame.concat(["quantile","quantize","threshold","sequential","identity"]),a0t=Qp(i0t),o0t=["ordinal","bin-ordinal","point","band"],s0t=Qp(o0t);function xo(e){return e in s0t}function As(e){return e in a0t}function Su(e){return e in Jvt}function OO(e){return e in r0t}const u0t={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function l0t(e){return!Xt(e)&&!!e.name}function ome(e){return e==null?void 0:e.selection}function c0t(e){return e&&e.unionWith}const f0t={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},d0t=dt(f0t,["type","domain","range","scheme"]),h0t=Be(d0t);p0t();function sme(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!bt(["point","band","identity"],e);case"bins":return!bt(["point","band","identity","ordinal"],e);case"round":return Su(e)||e==="band"||e==="point";case"padding":return Su(e)||bt(["point","band"],e);case"paddingOuter":case"align":return bt(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Su(e);case"nice":return Su(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return As(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function ume(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return m0(e)?void 0:Qmt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function lme(e,t){return bt([I8,N8],t)?e===void 0||xo(e):t===x0?bt([ti.TIME,ti.UTC,void 0],e):t===ag?bt([ti.LOG,ti.POW,ti.SQRT,ti.SYMLOG,ti.QUANTILE,ti.QUANTIZE,ti.THRESHOLD,ti.LINEAR,void 0],e):!0}function cme(e,t){if(!Xd(e))return!1;switch(e){case wr:case hi:case wu:case El:return Su(t)||bt(["band","point"],t);case Vc:case qd:case qc:case Wd:case Vd:case ng:return Su(t)||OO(t)||bt(["band","point","ordinal"],t);case yo:case kl:case Tl:return t!=="band";case Hd:return t==="ordinal"||OO(t);case bo:return t==="ordinal"}}function p0t(){var e;const t={};for(const n of Sge)for(const r of Gvt)for(const i of Xvt){const a=g0t(n,r);cme(n,i)&&lme(i,r)&&(t[a]=(e=t[a])!==null&&e!==void 0?e:[],t[a].push(i))}return t}function g0t(e,t){return e+"_"+t}function R8(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:a}=e,o=dme(e);return We(n)&&!yge(n.aggregate)&&i&&Su(i.get("type"))&&i.get("zero")===!1?fme({fieldDef:n,channel:t,markDef:r,ref:o,config:a}):o}function fme({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return eg(n.type)||Fn("invalid",n,i)===null?r:[m0t(e,t),r]}function m0t(e,t){const n=F8(e,!0),i=ig(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function F8(e,t=!0){return O8(Xt(e)?e:Ue(e,{expr:"datum"}),!t)}function v0t(e){const{datum:t}=e;return y0(t)?Aw(t):`${JSON.stringify(t)}`}function og(e,t,n,r){const i={};if(t&&(i.scale=t),Qd(e)){const{datum:a}=e;y0(a)?i.signal=Aw(a):Et(a)?i.signal=a.signal:i.value=a}else i.field=Ue(e,n);if(r){const{offset:a,band:o}=r;a&&(i.offset=a),o&&(i.band=o)}return i}function IO({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=Ue(t,{expr:o,suffix:i}),u=n!==void 0?Ue(n,{expr:o}):Ue(t,{suffix:"end",expr:o}),l={};if(a===0||a===1){l.scale=e;const c=a===0?s:u;l.field=c}else{const c=`${a} * ${s} + ${1-a} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function dme({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l,band:c}){var f;if(t){if(It(t)){if(Ko(t)){c=c??Tw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:g}=t;if(er(h)||c&&p&&g===x0)return s&&s.impute?og(t,a,{binSuffix:"mid"},{offset:u}):c?IO({scaleName:a,fieldOrDatumDef:t,band:c,offset:u}):og(t,a,Ow(t,e)?{binSuffix:"range"}:{},{offset:u});if(Wa(h)){if(We(n))return IO({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});Me(qge(e===wr?xu:Sl))}}const d=o==null?void 0:o.get("type");return og(t,a,xo(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Hc(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},Cw(e,d)),h)}}return Tgt(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Cw(e,t){return bt(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:bt(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:jr(t)}function sg(e){return e&&e!=="number"&&e!=="time"}function hme(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const y0t=" \u2013 ";function M8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(sg(n))return P8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:a});const u=pme(e,r,i);if(LO(e)){const l=x0t(u,We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,a.timeFormat,U8(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ti.UTC);return l?{signal:l}:void 0}if(t=vme(Jd(e),t,a),We(e)&&er(e.bin)){const l=Ue(e,{expr:r,binSuffix:"end"});return{signal:NO(u,l,t,n,a)}}else return t||Jd(e)==="quantitative"?{signal:`${yme(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function pme(e,t,n){return We(e)?n?`${Ue(e,{expr:t,suffix:"end"})}-${Ue(e,{expr:t,suffix:"start"})}`:Ue(e,{expr:t}):v0t(e)}function P8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=o??pme(e,r,i),We(e)&&er(e.bin)){const s=Ue(e,{expr:r,binSuffix:"end"});return{signal:NO(o,s,t,n,a)}}return{signal:hme(n,o,t)}}function gme(e,t,n,r,i,a){var o;if(!sg(r)){if(LO(e)){const s=We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return b0t(n,s,i,a)}return vme(t,n,i)}}function mme(e,t,n){if(e&&(Et(e)||e==="number"||e==="time"))return e;if(LO(t)&&n!=="time"&&n!=="utc")return"time"}function vme(e,t,n){if(Xt(t))return t;if(e===ag)return n.numberFormat}function b0t(e,t,n,r){return e||(t?{signal:Zge(t)}:r?void 0:n.timeFormat)}function yme(e,t){return`format(${e}, "${t||""}")`}function bme(e,t,n,r){var i;return sg(n)?hme(n,e,t):yme(e,(i=Xt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function NO(e,t,n,r,i){const a=bme(e,n,r,i),o=bme(t,n,r,i);return`${O8(e,!1)} ? "null" : ${a} + "${y0t}" + ${o}`}function x0t(e,t,n,r,i){return!t||n?(n=Xt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):Pvt(t,e,i)}const DO="min",w0t={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function xme(e){return e in w0t}function wme(e){return!!e&&!!e.encoding}function Rl(e){return!!e&&(e.op==="count"||!!e.field)}function _me(e){return!!e&&vt(e)}function kw(e){return"row"in e||"column"in e}function $8(e){return!!e&&"header"in e}function RO(e){return"facet"in e}function _0t(e){return e.selection}function S0t(e){return e&&!Xt(e)&&"repeat"in e}function Sme(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Eme(e){return Ko(e)&&"sort"in e}function Tw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(It(t)&&t.band!==void 0)return t.band;if(We(t)){const{timeUnit:s,bin:u}=t;if(s&&!n)return o?cg("timeUnitBandPosition",r,a):pge(r.type)?cg("timeUnitBand",r,a):0;if(er(u))return pge(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function L8(e,t,n,r,i,a){return er(t.bin)||t.timeUnit&&Ko(t)&&t.type==="temporal"?!!Tw({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a}):!1}function B8(e){return!!e&&"condition"in e}function FO(e){const t=e&&e.condition;return!!t&&!vt(t)&&We(t)}function z8(e){const t=e&&e.condition;return!!t&&!vt(t)&&It(t)}function E0t(e){const t=e&&e.condition;return!!t&&(vt(t)||Hc(t))}function We(e){return!!e&&(!!e.field||e.aggregate==="count")}function Jd(e){return e&&e.type}function Qd(e){return!!e&&"datum"in e}function Fl(e){return Ko(e)&&Tme(e)||j8(e)}function j8(e){return Qd(e)&&Qr(e.datum)}function It(e){return We(e)||Qd(e)}function Ko(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Hc(e){return e&&"value"in e&&"value"in e}function U8(e){return!!e&&("scale"in e||"sort"in e)}function W8(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Ame(e){return!!e&&"legend"in e}function Cme(e){return!!e&&("format"in e||"formatType"in e)}function A0t(e){return"op"in e}function Ue(e,t={}){var n,r,i;let a=e.field;const o=t.prefix;let s=t.suffix,u="";if(C0t(e))a=Bgt("count");else{let l;if(!t.nofn)if(A0t(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;er(c)?(l=Oge(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?tg(f)?(u=`["${a}"]`,a=`argmax_${f.argmax}`):Ud(f)?(u=`["${a}"]`,a=`argmin_${f.argmin}`):l=String(f):d&&(l=$vt(d),s=(!bt(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(a=a?`${l}_${a}`:l)}return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),t.forAs?oge(a):t.expr?Mgt(a,t.expr)+u:jd(a)+u}function kme(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return We(e)&&!!e.bin;case"temporal":return!1}throw new Error(Bge(e.type))}function Tme(e){return!kme(e)}function C0t(e){return e.aggregate==="count"}function k0t(e,t){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=e;if(o==="count")return t.countTitle;if(er(i))return`${r} (binned)`;if(a){const s=(n=Va(a))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${E8(s).join("-")})`}else if(o)return tg(o)?`${r} for max ${o.argmax}`:Ud(o)?`${r} for min ${o.argmin}`:`${cO(o)} of ${r}`;return r}function T0t(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(tg(t))return`${i} for argmax(${t.argmax})`;if(Ud(t))return`${i} for argmin(${t.argmin})`;const a=Va(r),o=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||er(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const Ome=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return T0t(e);default:return k0t(e,t)}};let Ime=Ome;function Nme(e){Ime=e}function O0t(){Nme(Ome)}function ug(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,a;const s=((i=V8(e))!==null&&i!==void 0?i:{}).title;if(!We(e))return s;const u=e,l=r?Dme(u,t):void 0;return n?ei(s,u.title,l):(a=s??u.title)!==null&&a!==void 0?a:l}function V8(e){if(W8(e)&&e.axis)return e.axis;if(Ame(e)&&e.legend)return e.legend;if($8(e)&&e.header)return e.header}function Dme(e,t){return Ime(e,t)}function MO(e){var t;if(Cme(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=V8(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function I0t(e,t){if(e.timeUnit)return"temporal";if(er(e.bin))return"quantitative";switch(AO(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Ml(e){if(We(e))return e;if(FO(e))return e.condition}function pi(e){if(It(e))return e;if(z8(e))return e.condition}function q8(e,t,n){if(Xt(e)||Qr(e)||pw(e)){const r=Xt(e)?"string":Qr(e)?"number":"boolean";return Me(Umt(t,r,e)),{value:e}}return It(e)?PO(e,t,n):z8(e)?Object.assign(Object.assign({},e),{condition:PO(e.condition,t,n)}):e}function PO(e,t,n){if(Cme(e)){const{format:r,formatType:i}=e,a=dt(e,["format","formatType"]);if(sg(i)&&!n.customFormatTypes)return Me(Lge(t)),PO(a,t,n)}else{const r=W8(e)?"axis":Ame(e)?"legend":$8(e)?"header":null;if(r&&e[r]){const i=e[r],{format:a,formatType:o}=i,s=dt(i,["format","formatType"]);if(sg(o)&&!n.customFormatTypes)return Me(Lge(t)),PO(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return We(e)?Rme(e,t):N0t(e)}function N0t(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Qr(n)?"quantitative":Xt(n)?"nominal":y0(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function Rme(e,t){const{aggregate:n,timeUnit:r,bin:i,field:a}=e,o=Object.assign({},e);if(n&&!h8(n)&&!tg(n)&&!Ud(n)&&(Me(Vmt(n)),delete o.aggregate),r&&(o.timeUnit=Va(r)),a&&(o.field=`${a}`),er(i)&&(o.bin=$O(i,t)),Wa(i)&&!Nl(t)&&Me(`Channel ${t} should not be used with "binned" bin.`),Ko(o)){const{type:s}=o,u=Kvt(s);s!==u&&(o.type=u),s!=="quantitative"&&yge(n)&&(Me(Wmt(s,n)),o.type="quantitative")}else if(!Age(t)){const s=I0t(o,t);Me(qmt(t,s)),o.type=s}if(Ko(o)){const{compatible:s,warning:u}=D0t(o,t);s||Me(u)}if(Eme(o)&&Xt(o.sort)){const{sort:s}=o;if(xme(s))return Object.assign(Object.assign({},o),{sort:{encoding:s}});const u=s.substr(1);if(s.charAt(0)==="-"&&xme(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if($8(o)){const{header:s}=o,{orient:u}=s,l=dt(s,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:s.labelOrient||u,titleOrient:s.titleOrient||u})})}return o}function $O(e,t){return pw(e)?{maxbins:Ige(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:Ige(t)}):e}const lg={compatible:!0};function D0t(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case zc:case jc:case yO:return Tme(e)?{compatible:!1,warning:Kmt(t)}:lg;case wr:case hi:case yo:case kl:case Tl:case ww:case Sw:case bO:case rg:case xO:case wO:case ng:case wu:case El:case _O:return lg;case Cl:case _s:case Al:case _u:return n!==ag?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:lg;case qc:case Wd:case Vd:case qd:case Vc:case Wc:case Uc:case xu:case Sl:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:lg;case Hd:return bt(["ordinal","nominal"],e.type)?lg:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case bo:return bt(["ordinal","nominal","geojson"],e.type)?lg:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case _w:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:lg}}function LO(e){const{formatType:t}=MO(e);return t==="time"||!t&&R0t(e)}function R0t(e){return e&&(e.type==="temporal"||We(e)&&!!e.timeUnit)}function H8(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=t&&((a=Va(t))===null||a===void 0?void 0:a.unit);let s=o||n==="temporal",u;return Et(e)?u=e.signal:y0(e)?(s=!0,u=Aw(e)):(Xt(e)||Qr(e))&&s&&(u=`datetime(${JSON.stringify(e)})`,Dvt(o)&&(Qr(e)&&e<1e4||Xt(e)&&isNaN(Date.parse(e)))&&(u=Aw({[o]:e}))),u?r&&s?`time(${u})`:u:i?void 0:JSON.stringify(e)}function Fme(e,t){const{type:n}=e;return t.map(r=>{const i=H8(r,{timeUnit:We(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Ow(e,t){return er(e.bin)?Xd(t)&&bt(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Mme(e){const{anchor:t,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=dt(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),v=vw(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function eh(e){return Xt(e)||vt(e)&&Xt(e[0])}function jr(e){return Et(e)?e:e!==void 0?{value:e}:void 0}function Pme(e){return Et(e)?e.signal:gn(e.value)}function Iw(e){return Et(e)?e.signal:e==null?null:gn(e)}function F0t(e,t,n){for(const r of n){const i=cg(r,t.markDef,t.config);i!==void 0&&(e[r]=jr(i))}return e}function $me(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Fn(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:a&&(!i||i===e)?void 0:cg(e,t,n,r)}function cg(e,t,n,{vgChannel:r}={}){return ei(r?BO(e,t,n.style):void 0,BO(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function BO(e,t,n){return Lme(e,$me(t),n)}function Lme(e,t,n){t=zr(t);let r;for(const i of t){const a=n[i];a&&a[e]!==void 0&&(r=a[e])}return r}function Bme(e,t){return zr(e).reduce((n,r)=>{var i;return n.field.push(Ue(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function zme(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(mw(i,r))return;n.push(r)}),n}function jme(e,t){return mw(e,t)||!t?e:e?[...zr(e),...zr(t)].join(", "):t}function Ume(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((eh(n)||Et(n))&&(eh(r)||Et(r)))return{explicit:e.explicit,value:jme(n,r)};if(eh(n)||Et(n))return{explicit:e.explicit,value:n};if(eh(r)||Et(r))return{explicit:e.explicit,value:r};if(!eh(n)&&!Et(n)&&!eh(r)&&!Et(r))return{explicit:e.explicit,value:zme(n,r)};throw new Error("It should never reach here")}function fg(e,t){const n=e&&e[t];return n?vt(n)?yw(n,r=>!!r.field):We(n)||FO(n):!1}function G8(e){return yw(Sge,t=>{if(fg(e,t)){const n=e[t];if(vt(n))return yw(n,r=>!!r.aggregate);{const r=Ml(n);return r&&!!r.aggregate}}return!1})}function K8(e,t){const n=[],r=[],i=[],a=[],o={};return X8(e,(s,u)=>{if(We(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=dt(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=V8(s),g=p&&p.title;let m=Ue(s,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:ug(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(tg(c)?(y="argmax",m=Ue({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):Ud(c)?(y="argmin",m=Ue({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),a.push(b)}}else if(n.push(m),Ko(s)&&er(f)){if(r.push({bin:f,field:l,as:m}),n.push(Ue(s,{binSuffix:"end"})),Ow(s,u)&&n.push(Ue(s,{binSuffix:"range"})),Nl(u)){const y={field:m+"_end"};o[u+"2"]=y}v.bin="binned",Age(u)||(v.type=ag)}else if(d){i.push({timeUnit:d,field:l,as:m});const y=Ko(s)&&s.type!==x0&&"time";y&&(u===ww||u===rg?v.formatType=y:_mt(u)?v.legend=Object.assign({formatType:y},v.legend):Nl(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}o[u]=v}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function M0t(e,t,n){const r=Emt(t,n);if(r){if(r==="binned"){const i=e[t===xu?wr:hi];return!!(We(i)&&We(e[t])&&Wa(i.bin))}}else return!1;return!0}function P0t(e,t,n){const r=t.type;return Be(e).reduce((i,a)=>{if(!Ege(a))return Me(Gmt(a)),i;const o=e[a];if(a==="angle"&&r==="arc"&&!e.theta&&(Me(jmt),a=wu),!M0t(e,a,r))return Me(kO(a,r)),i;if(a===Vc&&r==="line"){const s=Ml(e[a]);if(s==null?void 0:s.aggregate)return Me(Hmt),i}if(a===yo&&(t.filled?"fill"in e:"stroke"in e))return Me(zge("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(a===Sw||a===_w&&!vt(o)&&!Hc(o)||a===rg&&vt(o))o&&(i[a]=zr(o).reduce((s,u)=>(We(u)?s.push(Rme(u,a)):Me(b8(u,a)),s),[]));else{if(a===rg&&o===null)i[a]=null;else if(!We(o)&&!Qd(o)&&!Hc(o)&&!B8(o)&&!Et(o))return Me(b8(o,a)),i;i[a]=q8(o,a,n)}return i},{})}function $0t(e){const t=[];for(const n of Be(e))if(fg(e,n)){const r=e[n],i=zr(r);for(const a of i)We(a)?t.push(a):FO(a)&&t.push(a.condition)}return t}function X8(e,t,n){if(!!e)for(const r of Be(e)){const i=e[r];if(vt(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function Wme(e,t,n,r){return e?Be(e).reduce((i,a)=>{const o=e[a];return vt(o)?o.reduce((s,u)=>t.call(r,s,u,a),i):t.call(r,i,o,a)},n):n}function Vme(e,t){return Be(t).reduce((n,r)=>{switch(r){case wr:case hi:case xO:case _O:case wO:case xu:case Sl:case wu:case Wc:case El:case Uc:case Al:case Cl:case _u:case _s:case ww:case bo:case ng:case rg:return n;case _w:if(e==="line"||e==="trail")return n;case Sw:case bO:{const i=t[r];if(vt(i)||We(i))for(const a of zr(i))a.aggregate||n.push(Ue(a,{}));return n}case Vc:if(e==="trail")return n;case yo:case kl:case Tl:case qc:case Wd:case Vd:case Hd:case qd:{const i=Ml(t[r]);return i&&!i.aggregate&&n.push(Ue(i,{})),n}}},[])}function L0t(e){const{tooltip:t}=e,n=dt(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(vt(t)){for(const a of t)a.aggregate?(r||(r=[]),r.push(a)):(i||(i=[]),i.push(a));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return vt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function Y8(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:a,titlePrefix:o})=>{const s=r?` of ${t.field}`:"";return{field:a+t.field,type:t.type,title:Et(o)?{signal:o+`"${escape(s)}"`}:o+s}}),...$0t(n)]}}function qme(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:ei(n,r)}function Z8(e,t,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=qme(n);return Hme(e,s,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),a!==void 0?{scale:a}:{}),o!==void 0?{axis:o}:{})},Xt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function Hme(e,t,n,r,i){const{clip:a,color:o,opacity:s}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),_l(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),pw(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function Gme(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:zO(a,n),continuousAxisChannelDef2:zO(o,n),continuousAxisChannelDefError:zO(s,n),continuousAxisChannelDefError2:zO(u,n),continuousAxis:i}}function zO(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=dt(e,["aggregate"]);return n!==t&&Me(bvt(n,t)),r}else return e}function Kme(e,t){const{mark:n,encoding:r}=e,{x:i,y:a}=r;if(Fl(i)){if(Fl(a)){const o=We(i)&&i.aggregate,s=We(a)&&a.aggregate;if(!o&&s===t)return"vertical";if(!s&&o===t)return"horizontal";if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");return _l(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Fl(a))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const jO="boxplot",B0t=["box","median","outliers","rule","ticks"],z0t=new vO(jO,Yme);function Xme(e){return Qr(e)?"tukey":e}function Yme(e,{config:t}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=_l(i)?i:{type:i};o&&Me(Mge("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Fn("size",l,t),d=Xme(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=j0t(e,c,t),{color:S,size:A}=y,_=dt(y,["color","size"]),E=G=>Z8(l,g,p,G,t.boxplot),C=E(_),k=E(y),T=E(Object.assign(Object.assign({},_),A?{size:A}:{})),I=Y8([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),N={type:"tick",color:"black",opacity:1,orient:b,invalid:null},O=d==="min-max"?I:Y8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),D=[...C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...C({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...C({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...C({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],L=[...d!=="tukey"?D:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:I}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ci(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:I})];let W;if(d!=="min-max"){const G=`datum["lower_box_${p.field}"]`,K=`datum["upper_box_${p.field}"]`,ee=`(${K} - ${G})`,ce=`${G} - ${c} * ${ee}`,he=`${K} + ${c} * ${ee}`,Oe=`datum["${p.field}"]`,Te={joinaggregate:Zme(p.field),groupby:m};let Re;d==="tukey"&&(Re={transform:[{filter:`(${ce} <= ${Oe}) && (${Oe} <= ${he})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:D});const me=dt(_,["tooltip"]),{scale:P,axis:F}=p,V=qme(p),ae=Hme(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Oe} < ${ce}) || (${Oe} > ${he})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},V!==void 0?{title:V}:{}),P!==void 0?{scale:P}:{}),F!==void 0?{axis:F}:{})},me),w?{tooltip:w}:{})})[0];ae&&Re?W={transform:[Te],layer:[ae,Re]}:ae?(W=ae,W.transform.unshift(Te)):Re&&(W=Re,W.transform.unshift(Te))}return W?Object.assign(Object.assign({},u),{layer:[W,{transform:h,layer:L}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:L})}function Zme(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function j0t(e,t,n){const r=Kme(e,jO),{continuousAxisChannelDef:i,continuousAxis:a}=Gme(e,r,jO),o=i.field,s=Xme(t),u=[...Zme(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(s==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(s==="min-max"?"upper_whisker_":"max_")+o}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=a;c[f];const d=dt(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=L0t(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=K8(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...u],groupby:y},...l],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const J8="errorbar",U0t=["ticks","rule"],W0t=new vO(J8,Jme);function Jme(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:l}=Qme(e,J8,t),c=Z8(s,i,r,a,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function V0t(e,t){const{encoding:n}=e;if(q0t(n))return{orient:Kme(e,t),inputType:"raw"};const r=H0t(n),i=G0t(n),a=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(It(s)&&It(u))throw new Error(`${t} cannot have both x2 and y2`);if(It(s)){if(Fl(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(It(u)){if(Fl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(It(u)&&!It(s))throw new Error(`${t} cannot have xError2 without xError`);if(It(c)&&!It(l))throw new Error(`${t} cannot have yError2 without yError`);if(It(s)&&It(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(It(s)){if(Fl(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(It(l)){if(Fl(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function q0t(e){return(It(e.x)||It(e.y))&&!It(e.x2)&&!It(e.y2)&&!It(e.xError)&&!It(e.xError2)&&!It(e.yError)&&!It(e.yError2)}function H0t(e){return It(e.x2)||It(e.y2)}function G0t(e){return It(e.xError)||It(e.xError2)||It(e.yError)||It(e.yError2)}function Qme(e,t,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=_l(i)?i:{type:i};o&&Me(Mge(t));const{orient:c,inputType:f}=V0t(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=Gme(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=K0t(l,d,h,p,g,f,t,n),w=a,S=m;w[S];const A=m==="x"?"x2":"y2";w[A];const _=m==="x"?"xError":"yError";w[_];const E=m==="x"?"xError2":"yError2";w[E];const C=dt(w,[typeof S=="symbol"?S:S+"",typeof A=="symbol"?A:A+"",typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+""]),{bins:k,timeUnits:T,aggregate:I,groupby:N,encoding:O}=K8(C,n),D=[...I,...v],L=f!=="raw"?[]:N,W=Y8(b,d,O,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...k,...T,...D.length===0?[]:[{aggregate:D,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:W}}function K0t(e,t,n,r,i,a,o,s){let u=[],l=[];const c=t.field;let f,d=!1;if(a==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Me(yvt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:cO(h)},{fieldPrefix:"upper_",titlePrefix:eve(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:eve(h,p,"-")}],d=!0;else{e.center&&e.extent&&Me(xvt(e.extent,o));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:ug({field:c,aggregate:v,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ug({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ug({field:c,aggregate:g,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Me(vvt(e.center,e.extent)),a==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):a==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:g0(g0(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function eve(e,t,n){return cO(e)+" "+n+" "+t}const Q8="errorband",X0t=["band","borders"],Y0t=new vO(Q8,tve);function tve(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=Qme(e,Q8,t),l=o,c=Z8(l,i,r,a,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?Me(Vge("interpolate")):l.tension&&Me(Vge("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const nve={};function e9(e,t,n){const r=new vO(e,t);nve[e]={normalizer:r,parts:n}}function Z0t(){return Be(nve)}e9(jO,Yme,B0t),e9(J8,Jme,U0t),e9(Q8,tve,X0t);const J0t=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],rve=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Q0t={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},eyt={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},tyt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},_0="_vgsid_",nyt={single:{on:"click",fields:[_0],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[_0],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function t9(e){return!!e&&(e==="legend"||!!e.legend)}function n9(e){return t9(e)&&Ci(e)}function ryt(e){return UO(e)||i9(e)||r9(e)}function r9(e){return"concat"in e}function UO(e){return"vconcat"in e}function i9(e){return"hconcat"in e}function Pl(e){return Ci(e)&&e.step!==void 0}function ive(e){return e.view||e.width||e.height}const ave=20,iyt={align:1,bounds:1,center:1,columns:1,spacing:1},ayt=Be(iyt);function oyt(e,t,n){var r,i;const a=n[t],o={},{spacing:s,columns:u}=a;s!==void 0&&(o.spacing=s),u!==void 0&&(RO(e)&&!kw(e.facet)||r9(e))&&(o.columns=u),UO(e)&&(o.columns=1);for(const l of ayt)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Qr(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else o[l]=e[l];return o}function a9(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function WO(e,t){const n=Nw(e,t);return Pl(n)?n.step:o9}function Nw(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return ei(r,{step:e.step})}const o9=20,syt={continuousWidth:200,continuousHeight:200,step:o9},uyt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:syt,mark:Zgt,arc:{},area:{},bar:Qgt,circle:{},geoshape:{},image:{},line:{},point:{},rect:emt,rule:{color:"black"},square:{},text:{color:"black"},tick:tmt,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:u0t,projection:{},legend:eyt,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:nyt,style:{},title:{},facet:{spacing:ave},concat:{spacing:ave}},Gc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],ove={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},sve={blue:Gc[0],orange:Gc[1],red:Gc[2],teal:Gc[3],green:Gc[4],yellow:Gc[5],purple:Gc[6],pink:Gc[7],brown:Gc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function lyt(e={}){return{signals:[{name:"color",value:Ci(e)?Object.assign(Object.assign({},sve),e):sve}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function cyt(e){return{signals:[{name:"fontSize",value:Ci(e)?Object.assign(Object.assign({},ove),e):ove}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function fyt(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function uve(e={}){const{color:t,font:n,fontSize:r}=e,i=dt(e,["color","font","fontSize"]);return Zpe({},uyt,n?fyt(n):{},t?lyt(t):{},r?cyt(r):{},i||{})}const dyt=["view",...gge],hyt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],pyt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Ygt);function gyt(e){e=Yt(e);for(const t of hyt)delete e[t];if(e.axis)for(const t in e.axis)l8(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of J0t)delete e.legend[t];if(e.mark){for(const t of mge)delete e.mark[t];e.mark.tooltip&&Ci(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of dyt){for(const r of mge)delete e[t][r];const n=pyt[t];if(n)for(const r of n)delete e[t][r];vyt(e,t)}for(const t of Z0t())delete e[t];myt(e);for(const t in e)Ci(e[t])&&Zn(e[t])&&delete e[t];return Zn(e)?void 0:e}function myt(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Mme(e.title);Zn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Zn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Zn(r)?delete e.title:e.title=r}function vyt(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const a=Object.assign(Object.assign({},i),e.style[n??t]);Zn(a)||(e.style[n??t]=a),r||delete e[t]}function VO(e){return"layer"in e}function yyt(e){return"repeat"in e}function byt(e){return!vt(e.repeat)&&e.repeat.layer}class lve{map(t,n){return RO(t)?this.mapFacet(t,n):yyt(t)?this.mapRepeat(t,n):i9(t)?this.mapHConcat(t,n):UO(t)?this.mapVConcat(t,n):r9(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(VO(t))return this.mapLayer(t,n);if(Bc(t))return this.mapUnit(t,n);throw new Error(y8(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=dt(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(a=>this.map(a,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const xyt={zero:1,center:1,normalize:1};function wyt(e){return e in xyt}const _yt=new Set([fge,hO,dO,mO,gO,f8,d8,pO,dge,c8]),Syt=new Set([hO,dO,fge]);function cve(e,t){var n,r;const i=t==="x"?"y":"radius",a=e[t],o=e[i];if(We(a)&&We(o))if(Jd(a)==="quantitative"&&Jd(o)==="quantitative"){if(a.stack)return t;if(o.stack)return i;const s=We(a)&&!!a.aggregate,u=We(o)&&!!o.aggregate;if(s!==u)return s?t:i;{const l=(n=a.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Jd(a)==="quantitative")return t;if(Jd(o)==="quantitative")return i}else{if(Jd(a)==="quantitative")return t;if(Jd(o)==="quantitative")return i}}function Eyt(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function fve(e,t,n={}){const r=_l(e)?e.type:e;if(!_yt.has(r))return null;const i=cve(t,"x")||cve(t,"theta");if(!i)return null;const a=t[i],o=We(a)?Ue(a,{}):void 0;let s=Eyt(i),u=t[s],l=We(u)?Ue(u,{}):void 0;l===o&&(l=void 0,u=void 0,s=void 0);const c=bmt.reduce((d,h)=>{if(h!=="tooltip"&&fg(t,h)){const p=t[h];for(const g of zr(p)){const m=Ml(g);if(m.aggregate)continue;const v=Ue(m,{});(!v||v!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(a.stack!==void 0?pw(a.stack)?f=a.stack?"zero":null:f=a.stack:c.length>0&&Syt.has(r)&&(f="zero"),!f||!wyt(f)||G8(t)&&c.length===0)return null;if(a.scale&&a.scale.type&&a.scale.type!==ti.LINEAR){if(n.disallowNonLinearStack)return null;Me(pvt(a.scale.type))}return It(t[Ol(i)])?(a.stack!==void 0&&Me(hvt(i)),null):(We(a)&&a.aggregate&&!bt(smt,a.aggregate)&&Me(gvt(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:a.impute===null?!1:eg(r),stackBy:c,offset:f})}function Ayt(e){const t=dt(e,["point","line"]);return Be(t).length>1?t:t.type}function Cyt(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Lc(e[t],["point","line"])}));return e}function s9(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ci(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ci(t.point)?t.point:{}:void 0}function dve(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class kyt{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Bc(t)){const{mark:r,encoding:i}=t,a=_l(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!s9(a,n[a.type],i);case"area":return!!s9(a,n[a.type],i)||!!dve(a,n[a.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:a,projection:o,encoding:s,mark:u}=t,l=dt(t,["selection","projection","encoding","mark"]),c=_l(u)?u:{type:u},f=s9(c,i[c.type],s),d=c.type==="area"&&dve(c,i[c.type]),h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:Ayt(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:Lc(s,["shape"])})],p=fve(c,s);let g=s;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},s),{[m]:Object.assign(Object.assign({},s[m]),v?{stack:v}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},vw(c,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},vw(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:Cyt(i)}))}}class Tyt{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(Bc(t)&&t.encoding)for(const r of Es){const i=t.encoding[r];if(i&&It(i)&&((n=i==null?void 0:i.scale)===null||n===void 0?void 0:n.rangeStep))return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const a of Es){const o=Il(a),s=i[a];if(s&&It(s)&&((n=s==null?void 0:s.scale)===null||n===void 0?void 0:n.rangeStep)){const{scale:u}=s,l=dt(s,["scale"]),c=u,f=dt(c,["rangeStep"]);r[o]={step:u.rangeStep},Me(Jmt),i=Object.assign(Object.assign({},i),{[a]:Object.assign(Object.assign({},l),Zn(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function Oyt(e,t){return t?kw(e)?mve(e,t):hve(e,t):e}function u9(e,t){return t?mve(e,t):e}function l9(e,t,n){const r=t[e];if(S0t(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Me(Fmt(r.repeat));return}return t}function hve(e,t){if(e=l9("field",e,t),e!==void 0){if(e===null)return null;if(Eme(e)&&Rl(e.sort)){const n=l9("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function pve(e,t){if(We(e))return hve(e,t);{const n=l9("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function gve(e,t){if(It(e)){const n=pve(e,t);if(n)return n;if(B8(e))return{condition:e.condition}}else{if(z8(e)){const n=pve(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):dt(e,["condition"])}return e}}function mve(e,t){const n={};for(const r in e)if(Jp(e,r)){const i=e[r];if(vt(i))n[r]=i.map(a=>gve(a,t)).filter(a=>a);else{const a=gve(i,t);a!==void 0&&(n[r]=a)}}return n}class Iyt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Bc(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of vmt){const a=ig(i),o=n[a];if(n[i]&&(We(o)&&!Wa(o.bin)||Qd(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Me(Ymt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class Nyt extends lve{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[z0t,W0t,Y0t,new kyt,new Iyt,new Tyt]}map(t,n){if(Bc(t)){const r=fg(t.encoding,zc),i=fg(t.encoding,jc),a=fg(t.encoding,yO);if(r||i||a)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,a=Object.assign(Object.assign({},t),{encoding:u9(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,n.config))return s.run(a,n,o);return a}mapRepeat(t,n){return byt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,a=dt(t,["repeat","spec"]),{row:o,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},a),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${pr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:a,data:o}=t,s=dt(t,["repeat","spec","data"]);!vt(i)&&t.columns&&(t=Lc(t,["columns"]),Me(Pge("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!vt(i)&&i.row||[l?l.row:null],d=!vt(i)&&i.column||[l?l.column:null],h=vt(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(a.name||"")+c+"child__"+(vt(i)?`${pr(g)}`:(i.row?`row_${pr(m)}`:"")+(i.column?`column_${pr(v)}`:"")),x=this.map(a,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,u.push(Lc(x,["data"]))}const p=vt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=a.data)!==null&&r!==void 0?r:o,align:"all"},s),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return kw(r)&&t.columns&&(t=Lc(t,["columns"]),Me(Pge("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:a,parentProjection:o,config:s}=n,u=yve({parentProjection:o,projection:i}),l=vve({parentEncoding:a,encoding:u9(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:a,facet:o}=r,s=dt(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,g=dt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:a,facet:o},n),y=u9(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:a,facet:o}=t;if(i||a){o&&Me(Xmt([...i?[zc]:[],...a?[jc]:[]]));const s={},u={};for(const l of[zc,jc]){const c=t[l];if(c){const f=dt(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=o,f=dt(o,["align","center","spacing","columns"]);return{facetMapping:Oyt(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,a=dt(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,u=dt(t,["encoding","projection"]),l=Object.assign(Object.assign({},a),{parentEncoding:vve({parentEncoding:r,encoding:o}),parentProjection:yve({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function vve(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Be(t).reduce((a,o)=>(n[o]&&a.push(o),a),[]);i.length>0&&Me(Bmt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return Zn(r)?void 0:r}function yve(e){const{parentProjection:t,projection:n}=e;return t&&n&&Me(zmt({parentProjection:t,projection:n})),n??t}function bve(e,t){t===void 0&&(t=uve(e.config));const n=Ryt(e,t),{width:r,height:i}=e,a=Fyt(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const Dyt=new Nyt;function Ryt(e,t={}){return Dyt.map(e,{config:t})}function xve(e){return Xt(e)?{type:e}:e??{}}function Fyt(e,t,n){let{width:r,height:i}=t;const a=Bc(e)||VO(e),o={};a?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(Me(Nge("width")),r=void 0),i=="container"&&(Me(Nge("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?xve(n.autosize):{}),xve(e.autosize));if(s.type==="fit"&&!a&&(Me(kmt),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&Me(Dge("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&Me(Dge("height")),!mw(s,{type:"pad"}))return s}function Myt(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Pyt(e){return e?`fit-${SO(e)}`:"fit"}const $yt=["background","padding"];function wve(e){return $yt.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class Kc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Kc(Yt(this.explicit),Yt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return ei(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Be(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function dg(e){return{explicit:!0,value:e}}function Xo(e){return{explicit:!1,value:e}}function _ve(e){return(t,n,r,i)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:qO(t,n,r,i)}}function qO(e,t,n,r){return e.explicit&&t.explicit&&Me(ovt(n,r,e.value,t.value)),e}function th(e,t,n,r,i=qO){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:mw(e.value,t.value)?e:i(e,t,n,r)}class Lyt extends Kc{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Dw(e){return"url"in e}function HO(e){return"values"in e}function Sve(e){return"name"in e&&!Dw(e)&&!HO(e)&&!hg(e)}function hg(e){return e&&(Eve(e)||Ave(e)||c9(e))}function Eve(e){return"sequence"in e}function Ave(e){return"sphere"in e}function c9(e){return"graticule"in e}const sa="main",GO="raw";function Cve(e){return"filter"in e}function Byt(e){return(e==null?void 0:e.stop)!==void 0}function zyt(e){return"lookup"in e}function jyt(e){return"data"in e}function Uyt(e){return"selection"in e}function Wyt(e){return"pivot"in e}function Vyt(e){return"density"in e}function qyt(e){return"quantile"in e}function Hyt(e){return"regression"in e}function Gyt(e){return"loess"in e}function Kyt(e){return"sample"in e}function Xyt(e){return"window"in e}function Yyt(e){return"joinaggregate"in e}function Zyt(e){return"flatten"in e}function Jyt(e){return"calculate"in e}function Qyt(e){return"bin"in e}function ebt(e){return"impute"in e}function tbt(e){return"timeUnit"in e}function nbt(e){return"aggregate"in e}function rbt(e){return"stack"in e}function ibt(e){return"fold"in e}function abt(e){return e.map(t=>Cve(t)?{filter:uO(t.filter,Hvt)}:t)}function Rw(e,t,n,r){const i=B8(t)&&t.condition,a=r(t);if(i){const s=zr(i).map(u=>{const l=r(u),c=_0t(u)?f0e(e,u.selection):aI(e,u.test);return Object.assign({test:c},l)});return{[n]:[...s,...a!==void 0?[a]:[]]}}else return a!==void 0?{[n]:a}:{}}function f9(e,t="text"){const n=e.encoding[t];return Rw(e,n,t,r=>KO(r,e.config))}function KO(e,t,n="datum"){if(e){if(Hc(e))return jr(e.value);if(It(e)){const{format:r,formatType:i}=MO(e);return M8({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function kve(e,t={}){const{encoding:n,markDef:r,config:i,stack:a}=e,o=n.tooltip;if(vt(o))return{tooltip:Ove({tooltip:o},a,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Rw(e,o,"tooltip",u=>{const l=KO(u,i,s);if(l)return l;if(u===null)return;let c=Fn("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),Xt(c))return{value:c};if(Ci(c))return c.content==="encoding"?Ove(n,a,i,t):{signal:s}})}}function Tve(e,t,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(l,c){const f=ig(c),d=Ko(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=zr(ug(d,n,{allowDisabling:!1})).join(", ");let p;if(Nl(c)){const g=c==="x"?"x2":"y2",m=Ml(e[g]);if(Wa(d.bin)&&m){const v=Ue(d,{expr:a}),y=Ue(m,{expr:a}),{format:b,formatType:x}=MO(d);p=NO(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=MO(d);p=M8({fieldOrDatumDef:d,format:v,formatType:y,expr:a,config:n,normalizeStack:!0}).signal}}p=p??KO(d,n,a).signal,o.push({channel:c,key:h,value:p})}X8(e,(l,c)=>{We(l)?s(l,c):FO(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[gn(c)]=f);return u}function Ove(e,t,n,{reactiveGeom:r}={}){const i=Tve(e,t,n,{reactiveGeom:r}),a=ige(i).map(({key:o,value:s})=>`${o}: ${s}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function obt(e){const{markDef:t,config:n}=e,r=Fn("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),sbt(e)),ubt(e))}function sbt(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Fn("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Uvt?{}:{ariaRoleDescription:{value:t}}}function ubt(e){const{encoding:t,markDef:n,config:r,stack:i}=e,a=t.description;if(a)return Rw(e,a,"description",u=>KO(u,e.config));const o=Fn("description",n,r);if(o!=null)return{description:jr(o)};if(r.aria===!1)return{};const s=Tve(t,i,r);if(!Zn(s))return{description:{signal:ige(s).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function ki(e,t,n={}){const{markDef:r,encoding:i,config:a}=t,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u=u??Fn(e,r,a,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(s=jr(u)));const l=i[e];return Rw(t,l,o??e,c=>dme({channel:e,channelDef:c,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function Ive(e,t={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Fn("filled",o,u),f=bt(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=Fn(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(a=Fn(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&a!==void 0?a:u.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:jr(d)}:{}),h?{stroke:jr(h)}:{});return o.color&&(c?o.fill:o.stroke)&&Me(zge("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),ki("color",e,{vgChannel:p,defaultValue:c?d:h})),ki("fill",e,{defaultValue:s.fill?d:void 0})),ki("stroke",e,{defaultValue:s.stroke?h:void 0}))}function Fw(e,t){const n=ymt(e),r=t[n];if(r)return r}function ua(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=t,l=a[e],c=a[Ol(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=Fw(e,o),p=d9({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!l&&Nl(e)&&(a.latitude||a.longitude)?{field:t.getName(e)}:lbt({channel:e,channelDef:l,channel2Def:c,markDef:o,config:s,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[r||e]:g}:void 0}function lbt(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=e;if(It(n)&&a&&t===a.fieldChannel){if(We(n)){const l=Tw({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(l!==void 0)return IO({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return og(n,i,{suffix:"end"},{offset:o})}return R8(e)}function d9({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=e;return()=>{const s=ig(n),u=Gd(n),l=Fn(n,a,o,{vgChannel:u});if(l!==void 0)return Cw(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!bt([ti.LOG,ti.TIME,ti.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Il(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const cbt={left:"x",center:"xc",right:"x2"},fbt={top:"y",middle:"yc",bottom:"y2"};function Nve(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Gd(e);const a=Fn(e==="x"?"align":"baseline",t,n);return e==="x"?cbt[a||(r==="top"?"left":"center")]:fbt[a||r]}function XO(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?Dve(e,t,{defaultPos:n,defaultPos2:r}):ua(e,t,{defaultPos:n})}function Dve(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=t,o=Ol(e),s=Il(e),u=dbt(t,r,o),l=u[s]?Nve(e,i,a):Gd(e);return Object.assign(Object.assign({},ua(e,t,{defaultPos:n,vgChannel:l})),u)}function dbt(e,t,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=e,u=ig(n),l=Il(n),c=Gd(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in a?Fw(n,e.markDef):Fw(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=hbt({channel:n,channelDef:f,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:YO(n,a)||YO(n,{[n]:BO(n,a,s.style),[l]:BO(l,a,s.style)})||YO(n,s[i])||YO(n,s.mark)||{[c]:d9({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function hbt({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l}){return It(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?og(t,a,{suffix:"start"},{offset:u}):R8({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function YO(e,t){const n=Il(e),r=Gd(e);if(t[r]!==void 0)return{[r]:Cw(e,t[r])};if(t[e]!==void 0)return{[r]:Cw(e,t[e])};if(t[n])return{[n]:Cw(e,t[n])}}function nh(e,t,n){var r,i,a,o;const{config:s,encoding:u,markDef:l,stack:c}=e,f=Ol(t),d=Il(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=l.orient,b=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:Fn("size",l,s,{vgChannel:d}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(We(h)&&(er(h.bin)||Wa(h.bin)||h.timeUnit&&!p)&&!b&&!xo(m)){const w=Tw({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),S=(a=e.component.axes[t])===null||a===void 0?void 0:a[0],A=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return mbt({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:v,band:w,axisTranslate:A,spacing:Nl(t)?Fn("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(It(h)&&xo(m)||x)&&!p?gbt(n,h,t,e):Dve(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function pbt(e,t,n,r,i,a){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===ti.POINT){const l=r.get("range");return Yd(l)&&Qr(l.step)?{value:l.step-2}:{value:o9-2}}else return{scale:n,band:a}}else return{value:i[e].continuousBandSize}}const o=WO(i.view,t),s=ei(i[e].discreteBandSize,o-2);return s!==void 0?{value:s}:void 0}function gbt(e,t,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,l=a.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=Il(n),h=Ol(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",g=Fn(p?"size":d,a,s,{vgChannel:d});let m;(o.size||g!==void 0)&&(p?m=ki("size",r,{vgChannel:d,defaultValue:g}):Me(rvt(a.type)));const v=(i=It(t)?Tw({channel:n,fieldDef:t,markDef:a,stack:u,config:s}):void 0)!==null&&i!==void 0?i:1;m=m||{[d]:pbt(e,d,c,f,s,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),b=Nve(n,a,s,y?"middle":"top"),x=Fw(n,a),w=R8({channel:n,channelDef:t,markDef:a,config:s,scaleName:c,scale:f,stack:u,offset:x,defaultRef:d9({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const S=Gd(h),A=m[d],_=x?Object.assign(Object.assign({},A),{offset:x}):A;return{[b]:w,[S]:vt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function Mw(e,t,n,r,i){if(xge(e))return 0;const a=e==="x"||e==="y2"?-t/2:t/2;if(Et(n)){const o=Iw(i);return{signal:`${n.signal} ? ${r-a}${o?"-"+o:""} : ${r+a}${o?"+"+o:""}`}}else{if(Et(i)){const o=r+(n?-a:a);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}}function mbt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:l}){const c=Ol(n),f=Gd(n),d=Gd(c),h=Fw(n,a);if(er(e.bin)||e.timeUnit)return{[d]:Rve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:(1-r)/2,offset:Mw(c,o,u,s,h),config:l}),[f]:Rve({channel:n,fieldDef:e,scaleName:i,markDef:a,band:1-(1-r)/2,offset:Mw(n,o,u,s,h),config:l})};if(Wa(e.bin)){const p=og(e,i,{},{offset:Mw(c,o,u,s,h)});if(We(t))return{[d]:p,[f]:og(t,i,{},{offset:Mw(n,o,u,s,h)})};if(Ew(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Ue(e,{expr:"datum"})} + ${e.bin.step})`,offset:Mw(n,o,u,s,h)}}}Me(qge(c))}function Rve({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:a,config:o}){const s=IO({scaleName:n,fieldOrDatumDef:t,band:i,offset:a});return fme({fieldDef:t,channel:e,markDef:r,ref:s,config:o})}const vbt=new Set(["aria"]);function Cs(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?Ive(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ybt(e.markDef,t)),Fve(e,"fill",n)),Fve(e,"stroke",r)),ki("opacity",e)),ki("fillOpacity",e)),ki("strokeOpacity",e)),ki("strokeWidth",e)),ki("strokeDash",e)),kve(e)),f9(e,"href")),obt(e))}function Fve(e,t,n){const{config:r,mark:i,markDef:a}=e;if(Fn("invalid",a,r)==="hide"&&n&&!eg(i)){const s=bbt(e,{invalid:!0,channels:EO});if(s)return{[t]:[{test:s,value:null},...zr(n)]}}return n?{[t]:n}:{}}function ybt(e,t){return jvt.reduce((n,r)=>(!vbt.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=jr(e[r])),n),{})}function bbt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&As(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>F8(o,t)).join(` ${a} `)}}function h9(e){const{config:t,markDef:n}=e;if(Fn("invalid",n,t)){const i=xbt(e,{channels:Es});if(i)return{defined:{signal:i}}}return{}}function xbt(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&As(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>F8(o,t)).join(` ${a} `)}}function Mve(e,t){if(t!==void 0)return{[e]:jr(t)}}const p9="voronoi",Pve={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(p9)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,a=e.mark;if(eg(a))return Me(Omt(a)),n;const o={name:e.getName(p9),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},kve(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(p9)>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class Vn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qa extends Vn{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Lgt()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class $l extends Vn{constructor(t,n){super(t);this.formula=n}clone(){return new $l(null,Yt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{const{field:s,timeUnit:u}=a,l=Rr(n)?n.encoding[Ol(o)]:void 0,c=Rr(n)&&L8(o,a,l,n.stack,n.markDef,n.config);if(u){const f=Ue(a,{forAs:!0});i[yn({as:f,field:s,timeUnit:u})]=Object.assign({as:f,field:s,timeUnit:u},c?{band:!0}:{})}return i},{});return Zn(r)?null:new $l(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,a=dt(r,["timeUnit"]),o=Va(i),s=Object.assign(Object.assign({},a),{timeUnit:o});return new $l(t,{[yn(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(zd(this.formula).map(t=>t.as))}dependentFields(){return new Set(zd(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${yn(this.formula)}`}assemble(){const t=[];for(const n of zd(this.formula)){const{field:r,as:i,timeUnit:a}=n,o=Va(a),{unit:s,utc:u}=o,l=dt(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:jd(r),type:"timeunit"},s?{units:E8(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const Pw="_tuple_fields";class wbt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const _bt={has:()=>!0,parse:(e,t,n)=>{var r,i,a;const o=t.name,s=(r=t.project)!==null&&r!==void 0?r:t.project=new wbt,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let g=pr(`${o}_${p}`);for(let m=1;c.has(g);m++)g=pr(`${o}_${p}_${m}`);return c.add(g),{[h]:g}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of zr(n.init))for(const p of Be(h))mmt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Me('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),s.items.push(h),s.hasField[d]=h}for(const d of(a=n.encodings)!==null&&a!==void 0?a:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){Me(Tmt(d,h.aggregate));continue}else if(!p){Me(Fge(d));continue}if(h.timeUnit){p=e.vgField(d);const g={timeUnit:h.timeUnit,as:p,field:h.field};l[yn(g)]=g}if(!u[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(d).get("type");As(v)&&(g="R")}else h.bin&&(g="R-RE");const m={field:p,channel:d,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),s.items.push(u[p]=m),s.hasField[p]=s.hasChannel[d]=u[p]}}else Me(Fge(d))}if(n.init){const d=h=>s.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=zr(n.init);t.init=h.map(d)}}Zn(l)||(s.timeUnit=new $l(null,l))},signals:(e,t,n)=>{const r=t.name+Pw;return n.filter(a=>a.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(a=>{const o=dt(a,["signals","hasLegend"]);return o.field=jd(o.field),o})})}},$ve={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!t9(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],s=Pve.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=pr(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:S0(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${gn(u.field)}] : null`}]:[],bind:(f=(c=a[u.field])!==null&&c!==void 0?c:a[u.channel])!==null&&f!==void 0?f:a}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.filter(l=>l.name===r+Ll)[0],o=r+Pw,s=i.items.map(l=>pr(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}},ZO="_toggle",Lve={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+ZO,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ll,r=t.name+ZO;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Xc(e)}}, `)+`${r} ? ${n} : null`}},Sbt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=Xt(n.clear)?$d(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if($ve.has(t))for(const r of t.project.items){const i=n.findIndex(a=>a.name===pr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,a){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const i of t.project.items){const a=n.findIndex(o=>o.name===i.signals.visual);if(r(a,"[0, 0]"),a===-1){const o=n.findIndex(s=>s.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(a=>a.name===t.name+Ll);r(i,"null"),Lve.has(t)&&(i=n.findIndex(a=>a.name===t.name+ZO),r(i,"false"))}return n}},rh={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Xd(i))continue;const a=e.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!As(o)){Me(Nmt);continue}const s={selection:t.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(s=>s.name===o.signals.data).length===0);if(!e.parent||m9(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let a=i.update;if(a.indexOf(Xve)>=0)i.update=`{${r.map(o=>`${gn(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const s=`${gn(o.field)}: ${o.signals.data}`;a.indexOf(s)<0&&(a=`${a.substring(0,a.length-1)}, ${s}}`)}i.update=a}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!m9(e))for(const r of t.scales){const i=n.filter(a=>a.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function g9(e,t){return`domain(${gn(e.scaleName(t))})`}function m9(e){var t;return e.parent&&D0(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:m9(e.parent.parent))}const Bve={has:e=>{const t=e.resolve==="global"&&e.bind&&t9(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==_0;return t&&!n&&Me(Dmt),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=zr((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(s)<0&&u.filter.push(s)}const a=n9(t.bind)?t.bind.legend:"click",o=Xt(a)?$d(a,"view"):zr(a);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=n9(t.bind)&&t.bind.legend,a=o=>s=>{const u=Yt(s);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${pr(o.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(a(`${s}_symbols`)).concat(i.merge.map(a(`${s}_labels`))).concat(i.merge.map(a(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.find(d=>d.name===r+Ll),o=r+Pw,s=i.items.filter(d=>d.hasLegend).map(d=>pr(`${r}_${pr(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?a.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(a.update=l,delete a.value,delete a.on);const c=n.find(d=>d.name===r+ZO),f=n9(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function Ebt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;gg(e,a=>{var o,s;const u=(o=a.project.hasField[i])!==null&&o!==void 0?o:a.project.hasChannel[t];if(u&&Bve.has(a)){const l=(s=n.get("selections"))!==null&&s!==void 0?s:[];l.push(a.name),n.set("selections",l,!1),u.hasLegend=!0}})}const zve="_translate_anchor",jve="_translate_delta",Abt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=rh.has(t),a=r+zve,{x:o,y:s}=t.project.hasChannel;let u=$d(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+$w,l))),n.push({name:a,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?g9(e,wr):`slice(${o.signals.visual})`):"")+(s!==void 0?", extent_y: "+(i?g9(e,hi):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+jve,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),o!==void 0&&Uve(e,t,o,"width",n),s!==void 0&&Uve(e,t,s,"height",n),n}};function Uve(e,t,n,r,i){var a;const o=t.name,s=o+zve,u=o+jve,l=n.channel,c=rh.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),g=c&&l===wr?"-":"",m=`${s}.extent_${l}`,v=`${g}${u}.${l} / `+(c?`${d}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(a=h.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";f.on.push({events:{signal:u},update:c?b:`clampRange(${b}, 0, ${d})`})}const Wve="_zoom_anchor",Vve="_zoom_delta",Cbt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=rh.has(t),a=r+Vve,{x:o,y:s}=t.project.hasChannel,u=gn(e.scaleName(wr)),l=gn(e.scaleName(hi));let c=$d(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+$w,f))),n.push({name:r+Wve,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&qve(e,t,o,"width",n),s!==void 0&&qve(e,t,s,"height",n),n}};function qve(e,t,n,r,i){var a;const o=t.name,s=n.channel,u=rh.has(t),l=i.filter(y=>y.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?g9(e,s):l.name,p=o+Vve,g=`${o}${Wve}.${s}`,v=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${g}, ${p}`+(u&&d==="pow"?`, ${(a=f.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";l.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${c})`})}const kbt=[_bt,Lve,rh,Bve,Abt,Cbt,$ve,Pve,Sbt];function JO(e,t){for(const n of kbt)n.has(e)&&t(n)}function S0(e,t=!0,n=wgt){if(vt(e)){const r=e.map(i=>S0(i,t,n));return t?`[${r.join(", ")}]`:r}else if(y0(e))return n(t?Aw(e):Nvt(e));return t?n(JSON.stringify(e)):e}function Tbt(e,t){return gg(e,(n,r)=>{const i=n.name;let a=r.modifyExpr(e,n);t.push(...r.signals(e,n)),JO(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(a=o.modifyExpr(e,n,a))}),t.push({name:i+Lbt,on:[{events:{signal:n.name+Ll},update:`modify(${gn(n.name+pg)}, ${a})`}]})}),v9(t)}function Obt(e,t){if(e.component.selection&&Be(e.component.selection).length){const n=gn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:$d("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return v9(t)}function Ibt(e,t){let n=!1;return gg(e,(r,i)=>{const a=r.name,o=gn(a+pg);if(t.filter(u=>u.name===a).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${Xve}(${o}, ${gn(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),JO(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),v9(t)}function Nbt(e,t){const n=[...t];return gg(e,r=>{const i={name:r.name+pg};if(r.init){const o=r.project.items.map(u=>dt(u,["signals"])),s=r.init.map(u=>S0(u,!1));i.values=r.type==="interval"?[{unit:Xc(e,{escape:!1}),fields:o,values:s}]:s.map(u=>({unit:Xc(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+pg).length||n.push(i)}),n}function Hve(e,t){return gg(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,JO(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function Dbt(e,t){for(const n of e.children)Rr(n)&&(t=Hve(n,t));return t}function Rbt(e,t){const n=t.selection,r=e.getSelectionComponent(n,pr(n));return{signal:d0e(r,t)}}function v9(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const $w="_brush",y9="_scale_trigger",Fbt={signals:(e,t)=>{const n=t.name,r=n+Pw,i=rh.has(t),a=[],o=[],s=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${gn(n+$w)}`;Gve(t,(f,d)=>{var h;const p=zr((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==wr&&d!==hi){Me("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=Mbt(e,t,c,h),g=c.signals.data,m=c.signals.visual,v=gn(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),b=As(y)?"+":"";a.push(...p),o.push(g),s.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||a.push({name:n+y9,value:{},on:[{events:s.map(c=>({scale:c.scaleName})),update:s.map(c=>c.expr).join(" && ")+` ? ${n+y9} : {}`}]});const u=t.init,l=`unit: ${Xc(e)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+Ll},u?{init:`{${l}: ${S0(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"true":`{unit: ${Xc(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:a}=t.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${gn(t.name+pg)})`;if(rh.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:a!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Be(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Xc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=dt(c,["fill","fillOpacity","cursor"]),g=Be(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,a!==void 0&&`${s}[0] !== ${s}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+$w+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+$w,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function Mbt(e,t,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=rh.has(t),u=gn(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===wr?"width":"height").signal,h=`${i}(unit)`,p=Gve(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${a}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+y9},update:As(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:S0(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:S0(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}function Gve(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Me(`${r} is not an ordered event stream for interval selections.`),n),[])}function Kve(e,t){const n=t.name,r=n+Pw,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${a}[${gn(e.vgField(l.channel,{}))}], ${a}[${gn(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${a}[${gn(l.field)}]`}).join(", "),s=`unit: ${Xc(e)}, fields: ${r}, values`,u=t.events;return[{name:n+Ll,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const Pbt={signals:Kve,modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"null":`{unit: ${Xc(e)}}`)},$bt={signals:Kve,modifyExpr:(e,t)=>t.name+Ll+", "+(t.resolve==="global"?"true":`{unit: ${Xc(e)}}`)},pg="_store",Ll="_tuple",Lbt="_modify",Xve="vlSelectionResolve",Bbt={single:$bt,multi:Pbt,interval:Fbt};function gg(e,t){const n=e.component.selection;if(n){for(const r of zd(n))if(t(r,Bbt[r.type])===!0)break}}function zbt(e){let t=e.parent;for(;t&&!ku(t);)t=t.parent;return t}function Xc(e,{escape:t}={escape:!0}){let n=t?gn(e.name):e.name;const r=zbt(e);if(r){const{facet:i}=r;for(const a of Ss)i[a]&&(n+=` + '__facet_${a}_' + (facet[${gn(r.vgField(a))}])`)}return n}function b9(e){let t=!1;return gg(e,n=>{t=t||n.project.items.some(r=>r.field===_0)}),t}const jbt="RawCode",Ubt="Literal",Wbt="Property",Vbt="Identifier",qbt="ArrayExpression",Hbt="BinaryExpression",Gbt="CallExpression",Kbt="ConditionalExpression",Xbt="LogicalExpression",Ybt="MemberExpression",Zbt="ObjectExpression",Jbt="UnaryExpression";function Eu(e){this.type=e}Eu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Qbt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Qbt(e){switch(e.type){case qbt:return e.elements;case Hbt:case Xbt:return[e.left,e.right];case Gbt:return[e.callee].concat(e.arguments);case Kbt:return[e.test,e.consequent,e.alternate];case Ybt:return[e.object,e.property];case Zbt:return e.properties;case Wbt:return[e.key,e.value];case Jbt:return[e.argument];case Vbt:case Ubt:case jbt:default:return[]}}var Bl,ot,_e,la,jn,QO=1,Lw=2,mg=3,ih=4,eI=5,vg=6,wo=7,Bw=8,e1t=9;Bl={},Bl[QO]="Boolean",Bl[Lw]="<end>",Bl[mg]="Identifier",Bl[ih]="Keyword",Bl[eI]="Null",Bl[vg]="Numeric",Bl[wo]="Punctuator",Bl[Bw]="String",Bl[e1t]="RegularExpression";var t1t="ArrayExpression",n1t="BinaryExpression",r1t="CallExpression",i1t="ConditionalExpression",Yve="Identifier",a1t="Literal",o1t="LogicalExpression",s1t="MemberExpression",u1t="ObjectExpression",l1t="Property",c1t="UnaryExpression",Wi="Unexpected token %0",f1t="Unexpected number",d1t="Unexpected string",h1t="Unexpected identifier",p1t="Unexpected reserved word",g1t="Unexpected end of input",x9="Invalid regular expression",w9="Invalid regular expression: missing /",Zve="Octal literals are not allowed in strict mode.",m1t="Duplicate data property in object literal not allowed in strict mode",ca="ILLEGAL",zw="Disabled.",v1t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),y1t=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function tI(e,t){if(!e)throw new Error("ASSERT: "+t)}function Yc(e){return e>=48&&e<=57}function _9(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function jw(e){return"01234567".indexOf(e)>=0}function b1t(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Uw(e){return e===10||e===13||e===8232||e===8233}function Ww(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&v1t.test(String.fromCharCode(e))}function nI(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&y1t.test(String.fromCharCode(e))}var x1t={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Jve(){for(var e;_e<la&&(e=ot.charCodeAt(_e),b1t(e)||Uw(e));)++_e}function S9(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)_e<la&&_9(ot[_e])?(r=ot[_e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Nn({},Wi,ca);return String.fromCharCode(i)}function w1t(){var e,t,n,r;for(e=ot[_e],t=0,e==="}"&&Nn({},Wi,ca);_e<la&&(e=ot[_e++],!!_9(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Nn({},Wi,ca),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Qve(){var e,t;for(e=ot.charCodeAt(_e++),t=String.fromCharCode(e),e===92&&(ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=S9("u"),(!e||e==="\\"||!Ww(e.charCodeAt(0)))&&Nn({},Wi,ca),t=e);_e<la&&(e=ot.charCodeAt(_e),!!nI(e));)++_e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=S9("u"),(!e||e==="\\"||!nI(e.charCodeAt(0)))&&Nn({},Wi,ca),t+=e);return t}function _1t(){var e,t;for(e=_e++;_e<la;){if(t=ot.charCodeAt(_e),t===92)return _e=e,Qve();if(nI(t))++_e;else break}return ot.slice(e,_e)}function S1t(){var e,t,n;return e=_e,t=ot.charCodeAt(_e)===92?Qve():_1t(),t.length===1?n=mg:x1t.hasOwnProperty(t)?n=ih:t==="null"?n=eI:t==="true"||t==="false"?n=QO:n=mg,{type:n,value:t,start:e,end:_e}}function E9(){var e=_e,t=ot.charCodeAt(_e),n,r=ot[_e],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,{type:wo,value:String.fromCharCode(t),start:e,end:_e};default:if(n=ot.charCodeAt(_e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:wo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:_e};case 33:case 61:return _e+=2,ot.charCodeAt(_e)===61&&++_e,{type:wo,value:ot.slice(e,_e),start:e,end:_e}}}if(o=ot.substr(_e,4),o===">>>=")return _e+=4,{type:wo,value:o,start:e,end:_e};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return _e+=3,{type:wo,value:a,start:e,end:_e};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return _e+=2,{type:wo,value:i,start:e,end:_e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++_e,{type:wo,value:r,start:e,end:_e};Nn({},Wi,ca)}function E1t(e){for(var t="";_e<la&&_9(ot[_e]);)t+=ot[_e++];return t.length===0&&Nn({},Wi,ca),Ww(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:vg,value:parseInt("0x"+t,16),start:e,end:_e}}function A1t(e){for(var t="0"+ot[_e++];_e<la&&jw(ot[_e]);)t+=ot[_e++];return(Ww(ot.charCodeAt(_e))||Yc(ot.charCodeAt(_e)))&&Nn({},Wi,ca),{type:vg,value:parseInt(t,8),octal:!0,start:e,end:_e}}function e0e(){var e,t,n;if(n=ot[_e],tI(Yc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="",n!=="."){if(e=ot[_e++],n=ot[_e],e==="0"){if(n==="x"||n==="X")return++_e,E1t(t);if(jw(n))return A1t(t);n&&Yc(n.charCodeAt(0))&&Nn({},Wi,ca)}for(;Yc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="."){for(e+=ot[_e++];Yc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="e"||n==="E")if(e+=ot[_e++],n=ot[_e],(n==="+"||n==="-")&&(e+=ot[_e++]),Yc(ot.charCodeAt(_e)))for(;Yc(ot.charCodeAt(_e));)e+=ot[_e++];else Nn({},Wi,ca);return Ww(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:vg,value:parseFloat(e),start:t,end:_e}}function C1t(){var e="",t,n,r,i,a=!1;for(t=ot[_e],tI(t==="'"||t==='"',"String literal must starts with a quote"),n=_e,++_e;_e<la;)if(r=ot[_e++],r===t){t="";break}else if(r==="\\")if(r=ot[_e++],!r||!Uw(r.charCodeAt(0)))switch(r){case"u":case"x":ot[_e]==="{"?(++_e,e+=w1t()):e+=S9(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:jw(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),_e<la&&jw(ot[_e])&&(a=!0,i=i*8+"01234567".indexOf(ot[_e++]),"0123".indexOf(r)>=0&&_e<la&&jw(ot[_e])&&(i=i*8+"01234567".indexOf(ot[_e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ot[_e]===`
`&&++_e;else{if(Uw(r.charCodeAt(0)))break;e+=r}return t!==""&&Nn({},Wi,ca),{type:Bw,value:e,octal:a,start:n,end:_e}}function k1t(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";Nn({},x9)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Nn({},x9)}try{return new RegExp(e,t)}catch(r){return null}}function T1t(){var e,t,n,r,i;for(e=ot[_e],tI(e==="/","Regular expression literal must start with a slash"),t=ot[_e++],n=!1,r=!1;_e<la;)if(e=ot[_e++],t+=e,e==="\\")e=ot[_e++],Uw(e.charCodeAt(0))&&Nn({},w9),t+=e;else if(Uw(e.charCodeAt(0)))Nn({},w9);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Nn({},w9),i=t.substr(1,t.length-2),{value:i,literal:t}}function O1t(){var e,t,n;for(t="",n="";_e<la&&(e=ot[_e],!!nI(e.charCodeAt(0)));)++_e,e==="\\"&&_e<la?Nn({},Wi,ca):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Nn({},x9,n),{value:n,literal:t}}function I1t(){var e,t,n,r;return jn=null,Jve(),e=_e,t=T1t(),n=O1t(),r=k1t(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_e}}function N1t(e){return e.type===mg||e.type===ih||e.type===QO||e.type===eI}function t0e(){var e;return Jve(),_e>=la?{type:Lw,start:_e,end:_e}:(e=ot.charCodeAt(_e),Ww(e)?S1t():e===40||e===41||e===59?E9():e===39||e===34?C1t():e===46?Yc(ot.charCodeAt(_e+1))?e0e():E9():Yc(e)?e0e():E9())}function _o(){var e;return e=jn,_e=e.end,jn=t0e(),_e=e.end,e}function n0e(){var e;e=_e,jn=t0e(),_e=e}function D1t(e){var t=new Eu(t1t);return t.elements=e,t}function r0e(e,t,n){var r=new Eu(e==="||"||e==="&&"?o1t:n1t);return r.operator=e,r.left=t,r.right=n,r}function R1t(e,t){var n=new Eu(r1t);return n.callee=e,n.arguments=t,n}function F1t(e,t,n){var r=new Eu(i1t);return r.test=e,r.consequent=t,r.alternate=n,r}function A9(e){var t=new Eu(Yve);return t.name=e,t}function Vw(e){var t=new Eu(a1t);return t.value=e.value,t.raw=ot.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function i0e(e,t,n){var r=new Eu(s1t);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function M1t(e){var t=new Eu(u1t);return t.properties=e,t}function a0e(e,t,n){var r=new Eu(l1t);return r.key=t,r.value=n,r.kind=e,r}function P1t(e,t){var n=new Eu(c1t);return n.operator=e,n.argument=t,n.prefix=!0,n}function Nn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(a,o){return tI(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=_e,n.description=i,n}function rI(e){e.type===Lw&&Nn(e,g1t),e.type===vg&&Nn(e,f1t),e.type===Bw&&Nn(e,d1t),e.type===mg&&Nn(e,h1t),e.type===ih&&Nn(e,p1t),Nn(e,Wi,e.value)}function fa(e){var t=_o();(t.type!==wo||t.value!==e)&&rI(t)}function or(e){return jn.type===wo&&jn.value===e}function C9(e){return jn.type===ih&&jn.value===e}function $1t(){var e=[];for(_e=jn.start,fa("[");!or("]");)or(",")?(_o(),e.push(null)):(e.push(yg()),or("]")||fa(","));return _o(),D1t(e)}function o0e(){var e;return _e=jn.start,e=_o(),e.type===Bw||e.type===vg?(e.octal&&Nn(e,Zve),Vw(e)):A9(e.value)}function L1t(){var e,t,n,r;if(_e=jn.start,e=jn,e.type===mg)return n=o0e(),fa(":"),r=yg(),a0e("init",n,r);if(e.type===Lw||e.type===wo)rI(e);else return t=o0e(),fa(":"),r=yg(),a0e("init",t,r)}function B1t(){var e=[],t,n,r,i={},a=String;for(_e=jn.start,fa("{");!or("}");)t=L1t(),t.key.type===Yve?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Nn({},m1t):i[r]=!0,e.push(t),or("}")||fa(",");return fa("}"),M1t(e)}function z1t(){var e;return fa("("),e=k9(),fa(")"),e}var j1t={if:1};function U1t(){var e,t,n;if(or("("))return z1t();if(or("["))return $1t();if(or("{"))return B1t();if(e=jn.type,_e=jn.start,e===mg||j1t[jn.value])n=A9(_o().value);else if(e===Bw||e===vg)jn.octal&&Nn(jn,Zve),n=Vw(_o());else{if(e===ih)throw new Error(zw);e===QO?(t=_o(),t.value=t.value==="true",n=Vw(t)):e===eI?(t=_o(),t.value=null,n=Vw(t)):or("/")||or("/=")?(n=Vw(I1t()),n0e()):rI(_o())}return n}function W1t(){var e=[];if(fa("("),!or(")"))for(;_e<la&&(e.push(yg()),!or(")"));)fa(",");return fa(")"),e}function V1t(){var e;return _e=jn.start,e=_o(),N1t(e)||rI(e),A9(e.value)}function q1t(){return fa("."),V1t()}function H1t(){var e;return fa("["),e=k9(),fa("]"),e}function G1t(){var e,t,n;for(e=U1t();;)if(or("."))n=q1t(),e=i0e(".",e,n);else if(or("("))t=W1t(),e=R1t(e,t);else if(or("["))n=H1t(),e=i0e("[",e,n);else break;return e}function s0e(){var e=G1t();if(jn.type===wo&&(or("++")||or("--")))throw new Error(zw);return e}function iI(){var e,t;if(jn.type!==wo&&jn.type!==ih)t=s0e();else{if(or("++")||or("--"))throw new Error(zw);if(or("+")||or("-")||or("~")||or("!"))e=_o(),t=iI(),t=P1t(e.value,t);else{if(C9("delete")||C9("void")||C9("typeof"))throw new Error(zw);t=s0e()}}return t}function u0e(e){var t=0;if(e.type!==wo&&e.type!==ih)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function K1t(){var e,t,n,r,i,a,o,s,u,l;if(e=jn,u=iI(),r=jn,i=u0e(r),i===0)return u;for(r.prec=i,_o(),t=[e,jn],o=iI(),a=[u,r,o];(i=u0e(jn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=r0e(s,u,o),a.push(n);r=_o(),r.prec=i,a.push(r),t.push(jn),n=iI(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=r0e(a[l-1].value,a[l-2],n),l-=2;return n}function yg(){var e,t,n;return e=K1t(),or("?")&&(_o(),t=yg(),fa(":"),n=yg(),e=F1t(e,t,n)),e}function k9(){var e=yg();if(or(","))throw new Error(zw);return e}function X1t(e){ot=e,_e=0,la=ot.length,jn=null,n0e();var t=k9();if(jn.type!==Lw)throw new Error("Unexpect token after expression.");return t}function E0(e,t,n){return e.fields=t||[],e.fname=n,e}function Y1t(e){return e.length===1?Z1t(e[0]):J1t(e)}const Z1t=e=>function(t){return t[e]},J1t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function T9(e){throw Error(e)}function Q1t(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||T9("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&T9("Access path missing closing bracket: "+e),r&&T9("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function ext(e,t,n){const r=Q1t(e);return e=r.length===1?r[0]:e,E0((n&&n.get||Y1t)(r),[e],t||e)}ext("id"),E0(e=>e,[],"identity"),E0(()=>0,[],"zero"),E0(()=>1,[],"one"),E0(()=>!0,[],"true"),E0(()=>!1,[],"false");function O9(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...O9(e.object)),t.push(...O9(e.property))),t)}function l0e(e){return e.object.type==="MemberExpression"?l0e(e.object):e.object.name==="datum"}function c0e(e){const t=X1t(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&l0e(r)&&n.add(O9(r).slice(1).join("."))}),n}class A0 extends Vn{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=aI(this.model,this.filter,this),this._dependentFields=c0e(this.expr)}clone(){return new A0(null,this.model,Yt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function txt(e,t){var n;const r={},i=e.config.selection;for(const a of Be(t??{})){const o=Yt(t[a]),s=i[o.type],u=dt(s,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=pr(a),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:Xt(o.on)?$d(o.on,"scope"):Yt(o.on)});JO(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[a])})}return r}function f0e(e,t,n,r="datum"){const i=[];function a(s){const u=pr(s),l=e.getSelectionComponent(u,s),c=gn(u+pg);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${gn(l.resolve)})`)}const o=bw(t,a);return(i.length?"!("+i.map(s=>`length(data(${s}))`).join(" || ")+") || ":"")+`(${o})`}function d0e(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Me(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${gn(r)}.`);else if(n&&!r){const i=e.project.items.filter(a=>a.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Me((i.length?"Multiple ":"No ")+`matching ${gn(n)} encoding found for selection ${gn(t.selection)}. Using "field": ${gn(r)}.`)):r=i[0].field}return`${e.name}[${gn(r)}]`}function nxt(e,t){gg(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new qa(new A0(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function aI(e,t,n){return bw(t,r=>Xt(r)?r:Wvt(r)?f0e(e,r.selection,n):rme(r))}function rxt(e,t){if(!!e)return vt(e)&&!eh(e)?e.map(n=>Dme(n,t)).join(", "):e}function I9(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function qw(e,t,n,r={header:!1}){var i,a;const o=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=dt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const p in h){const g=jgt[p],m=h[p];if(g&&g!==t&&g!=="both")delete h[p];else if(l8(m)){const{condition:v}=m,y=dt(m,["condition"]),b=zr(v),x=sge[p];if(x){const{vgProp:w,part:S}=x,A=[...b.map(_=>{const{test:E}=_,C=dt(_,["test"]);return Object.assign({test:aI(null,E)},C)}),y];I9(h,S,w,A),delete h[p]}else if(x===null){const w={signal:b.map(S=>{const{test:A}=S,_=dt(S,["test"]);return`${aI(null,A)} ? ${Pme(_)} : `}).join("")+Pme(y)};h[p]=w}}else if(Et(m)){const v=sge[p];if(v){const{vgProp:y,part:b}=v;I9(h,b,y,m),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Zn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ei(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&Et(h.encode.labels.update.text)&&(g=g0(c,"datum.label",h.encode.labels.update.text.signal)),I9(h,"labels","text",{signal:g})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const g of uge)e.hasAxisPart(g)||delete h.encode[g];Zn(h.encode)&&delete h.encode}const p=rxt(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:ei(d,0)})}}}function h0e(e){const{axes:t}=e.component,n=[];for(const r of Es)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const a=r==="x"?"height":"width",o=e.getSizeSignalRef(a).signal;a!==o&&n.push({name:a,update:o})}}return n}function ixt(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>qw(i,"grid",t)),...r.map(i=>qw(i,"grid",t)),...n.map(i=>qw(i,"main",t)),...r.map(i=>qw(i,"main",t))].filter(i=>i)}const p0e={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},g0e={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},axt=Be(p0e),oxt=Be(g0e);function m0e(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const a=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Be(o),...Be(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${a}" ? ${Iw(o[c])} : ${Iw(s[c])}`};return l}return t[i]})])}function sxt(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:t0t(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",o=Et(n)?"axisOrient":"axis"+cO(n),s=[...i,...i.map(l=>a+l.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:m0e(s,r,e,n),vgAxisConfig:m0e(u,r,e,n),axisConfigStyle:uxt([...u,...s],r)}}function uxt(e,t){var n;const r=[{}];for(const i of e){let a=(n=t[i])===null||n===void 0?void 0:n.style;if(a){a=zr(a);for(const o of a)r.push(t.style[o])}}return Object.assign.apply(null,r)}function N9(e,t,n,r={}){var i;const a=Lme(e,n,t.style);if(a!==void 0)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const v0e={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return gme(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return mme(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return We(e)&&Wa(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:lxt(n,e)},gridScale:({model:e,channel:t})=>cxt(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||b0e(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||y0e(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:dxt(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:hxt(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!==null&&a!==void 0?a:gxt({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=x0e(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),a=n==="x"?"x2":"y2",o=t.fieldDef(a);return zme(i?[Sme(i)]:[],We(o)?[Sme(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>mxt(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:vxt(n,t)}};function lxt(e,t){return!xo(e)&&We(t)&&!er(t==null?void 0:t.bin)}function cxt(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function fxt(e,t,n,r,i){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Et(a)?a:fO(a);{const{configValue:o}=N9("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?fO(o):n===wr&&bt([N8,I8],r.type)?270:void 0}}function D9(e){return`(((${e.signal} % 360) + 360) % 360)`}function y0e(e,t,n,r){if(e!==void 0)if(n==="x"){if(Et(e)){const i=D9(e),a=Et(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Et(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Et(e)){const i=D9(e),a=Et(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Et(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function b0e(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,a=r?"bottom":"left";if(Et(e)){const o=D9(e),s=Et(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(Et(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${a}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===a)?"left":"right"}function dxt(e,t){if(t==="x"&&bt(["quantitative","temporal"],e))return!0}function hxt(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function pxt(e){return e==="x"?"bottom":"left"}function gxt({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!xo(t)&&t!=="log"){if(We(e)){if(er(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],(i=Va(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function x0e(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;if(a&&o)return jme(a,o);if(a)return a;if(o)return o;if(a!==void 0)return a;if(o!==void 0)return o}function mxt(e,t){const n=e.values;if(vt(n))return Fme(t,n);if(Et(n))return n}function vxt(e,t){return e==="rect"&&kme(t)?1:0}class C0 extends Vn{constructor(t,n){super(t);this.transform=n,this._dependentFields=c0e(this.transform.calculate)}clone(){return new C0(null,Yt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!U8(r)&&_me(r.sort)){const{field:a,timeUnit:o}=r,s=r.sort,u=s.map((l,c)=>`${rme({field:a,timeUnit:o,equal:l})} ? ${c} : `).join("")+s.length;t=new C0(t,{calculate:u,as:k0(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${yn(this.transform)}`}}function k0(e,t,n){return Ue(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function oI(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||e==="row"?"row":"column"}function T0(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return ei(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function sI(e,t,n,r){const i={};for(const a of e){const o=T0(a,t,n,r);o!==void 0&&(i[a]=o)}return i}const R9=["row","column"],F9=["header","footer"];function yxt(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=sI(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=oI(t,s),l=fO(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),_0e(l,u)),w0e(u,l,a)),S0e(r,i,t,axt,p0e))}}function w0e(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=b0e(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function _0e(e,t){const n=y0e(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function bxt(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of F9)if(n[i])for(const a of n[i]){const o=wxt(e,t,i,n,a);o!=null&&r.push(o)}return r}function xxt(e,t){var n;const{sort:r}=e;return Rl(r)?{field:Ue(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:vt(r)?{field:k0(e,t,{expr:"datum"}),order:"ascending"}:{field:Ue(e,{expr:"datum"}),order:r??"ascending"}}function M9(e,t,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=sI(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=M8({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=oI(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?g0(g0(u,"datum.label",l),"datum.value",Ue(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),_0e(a,c)),w0e(c,a,o)),S0e(n,e,t,oxt,g0e))}function wxt(e,t,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=sI(["labelOrient"],o,s,t);(t==="row"&&!bt(["top","bottom"],f)||t==="column"&&!bt(["left","right"],f))&&(a=M9(o,t,s))}const u=ku(e)&&!kw(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(a||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:xxt(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const _xt={column:{start:0,end:1},row:{start:1,end:0}};function Sxt(e,t){return _xt[t][e]}function Ext(e,t){const n={};for(const r of Ss){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:a,titleOrient:o}=sI(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),s=oI(r,o),u=Sxt(a,s);u!==void 0&&(n[s]=u)}}return Zn(n)?void 0:n}function S0e(e,t,n,r,i){const a={};for(const o of r){if(!i[o])continue;const s=T0(o,t,e,n);s!==void 0&&(a[i[o]]=s)}return a}function P9(e){return[...uI(e,"width"),...uI(e,"height"),...uI(e,"childWidth"),...uI(e,"childHeight")]}function uI(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const a=e.getScaleComponent(n);if(a){const o=a.get("type"),s=a.get("range");if(xo(o)&&Yd(s)){const u=e.scaleName(n);return ku(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[E0e(u,s)]:[E0e(u,s),{name:i,update:A0e(u,a,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const a=i.endsWith("width"),o=a?"containerSize()[0]":"containerSize()[1]",s=a9(e.config.view,a?"width":"height"),u=`isFinite(${o}) ? ${o} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function E0e(e,t){return{name:e+"_step",value:t.step}}function A0e(e,t,n){const r=t.get("type"),i=t.get("padding"),a=ei(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${e}_step`}function C0e(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function k0e(e,t){return Be(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Rw(t,i,r,a=>Et(a)?a:{value:a.value}))},{})}function Axt(e,t){if(D0(t)||ku(t))return"shared";if(X9(t))return Nl(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function $9(e,t){const n=e.scale[t],r=Nl(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Me(uvt(t)),"independent"):e[r][t]||"shared"}const Cxt=Object.assign(Object.assign({},tyt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),T0e=Be(Cxt);class kxt extends Kc{}const O0e={symbols:Txt,gradient:Oxt,labels:Ixt,entries:Nxt};function Txt(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,l,c;if(a!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},F0t({},n,Kgt)),Ive(n,{filled:g}));const v=(o=I0e(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(r==="fill"||g&&r===yo)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=jr((s=h.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black"),m.fillOpacity=jr(v??1));else if(vt(m.fill)){const y=(c=(l=L9((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=jr(y))}}if(m.stroke){if(r==="stroke"||!g&&r===yo)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(vt(m.stroke)){const y=ei(L9(d.stroke||d.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==qc){const y=We(t)&&D0e(n,i,t);y?m.opacity=[Object.assign({test:y},jr(v??1)),jr(h.legend.unselectedOpacity)]:v&&(m.opacity=jr(v))}return m=Object.assign(Object.assign({},m),e),Zn(m)?void 0:m}function Oxt(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=I0e(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=jr(i)),r=Object.assign(Object.assign({},r),e),Zn(r)?void 0:r}function Ixt(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=We(t)?D0e(n,i,t):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=a,f=sg(c)?P8({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Zn(d)?void 0:d}function Nxt(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function I0e(e){return N0e(e,(t,n)=>Math.max(t,n.value))}function L9(e){return N0e(e,(t,n)=>ei(t,n.value))}function N0e(e,t){if(E0t(e))return zr(e.condition).reduce(t,e.value);if(Hc(e))return e.value}function D0e(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=gn(n.field);return r.map(a=>`(!length(data(${gn(pr(a)+pg)})) || (${a}[${i}] && indexof(${a}[${i}], datum.value) >= 0))`).join(" || ")}const R0e={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return gme(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return mme(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:Lxt(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:Bxt(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:Rxt(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>ug(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(m0(n)&&Su(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Dxt(t,e)};function Dxt(e,t){const n=e.values;if(vt(n))return Fme(t,n);if(Et(n))return n}function Rxt(e,t,n,r){var i;if(t!=="shape"){const a=(i=L9(n))!==null&&i!==void 0?i:r;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Fxt(e){const{legend:t}=e;return ei(t.type,Mxt(e))}function Mxt({channel:e,timeUnit:t,scaleType:n}){if(m0(e)){if(bt(["quarter","month","day"],t))return"symbol";if(Su(n))return"gradient"}return"symbol"}function Pxt({legendConfig:e,legendType:t,orient:n,legend:r}){var i,a;return(a=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&a!==void 0?a:$xt(n,t)}function $xt(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Lxt({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(Su(i))return n==="horizontal"?r==="top"||r==="bottom"?F0e(t,"width",o,a):o:F0e(t,"height",u,s)}function F0e(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Bxt(e){if(bt(["quantile","threshold","log"],e))return"greedy"}function M0e(e){const t=Rr(e)?zxt(e):Vxt(e);return e.component.legends=t,t}function zxt(e){const{encoding:t}=e,n={};for(const r of[yo,...rve]){const i=pi(t[r]);!i||!e.getScaleComponent(r)||r===bo&&We(i)&&i.type===w0||(n[r]=Wxt(e,r))}return n}function jxt(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Uxt(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function Wxt(e,t){var n,r,i;let a=e.legend(t);const{markDef:o,encoding:s,config:u}=e,l=u.legend,c=new kxt({},jxt(e,t));Ebt(e,t,c);const f=a!==void 0?!a:l.disable;if(c.set("disable",f,a!==void 0),f)return c;a=a||{};const d=e.getScaleComponent(t).get("type"),h=pi(s[t]),p=We(h)?(n=Va(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",m=Fxt({legend:a,channel:t,timeUnit:p,scaleType:d}),v=Pxt({legend:a,legendType:m,orient:g,legendConfig:l}),y={legend:a,channel:t,model:e,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const A of T0e){const _=A in R0e?R0e[A](y):a[A];if(_!==void 0){const E=Uxt(_,A,a,e.fieldDef(t));(E||u.legend[A]===void 0)&&c.set(A,_,E)}}const b=(r=a==null?void 0:a.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},S={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const A of["labels","legend","title","symbols","gradient","entries"]){const _=k0e((i=b[A])!==null&&i!==void 0?i:{},e),E=A in O0e?O0e[A](_,S):_;E!==void 0&&!Zn(E)&&(w[A]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&We(h)?{name:`${pr(h.field)}_legend_${A}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:E}))}return Zn(w)||c.set("encode",w,!!(a==null?void 0:a.encoding)),c}function Vxt(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){M0e(r);for(const i of Be(r.component.legends))n.legend[i]=$9(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=P0e(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Be(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function P0e(e,t){var n,r,i,a;if(!e)return t.clone();const o=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const l of T0e){const c=th(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return qxt(f,d);case"title":return Ume(f,d);case"type":return u=!0,Xo("symbol")}return qO(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&s8(e.implicit,["encode","gradient"]),((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient)&&s8(e.explicit,["encode","gradient"])),e}function qxt(e,t){return t.value==="circle"?t:e}function $0e(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function L0e(e){const t=e.component.legends,n={};for(const i of Be(t)){const a=e.getScaleComponent(i),o=hr(a.get("domains"));if(n[o])for(const s of n[o])P0e(s,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return zd(n).flat().map(i=>Hxt(i,e.config)).filter(i=>i!==void 0)}function Hxt(e,t){var n,r,i;const a=e.combine(),{disable:o,labelExpr:s,selections:u}=a,l=dt(a,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of rve)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&Et(l.encode.labels.update.text)&&(c=g0(s,"datum.label",l.encode.labels.update.text.signal)),$0e(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(Et(f)){const d=Q0t[c];if(d){const{vgProp:h,part:p}=d;$0e(l,p,h,f),delete l[c]}}}return l}}function Gxt(e){return D0(e)||X9(e)?Kxt(e):B0e(e)}function Kxt(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),B0e(e))}function B0e(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},a=t.data.reduce((o,s)=>{const u=Et(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return bt(o,u)||o.push(u),o},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Xxt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class z0e extends Kc{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function j0e(e){e.component.projection=Rr(e)?Yxt(e):Qxt(e)}function Yxt(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,a=r?Zxt(e):void 0;return new z0e(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,a)}}function Zxt(e){const t=[],{encoding:n}=e;for(const r of[[Cl,Al],[_s,_u]])(pi(n[r[0]])||pi(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(bo)&&e.typedFieldDef(bo).type===w0&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(sa)),t}function Jxt(e,t){const n=ege(Xxt,i=>!!(!Jp(e.explicit,i)&&!Jp(t.explicit,i)||Jp(e.explicit,i)&&Jp(t.explicit,i)&&hr(e.get(i))===hr(t.get(i))));if(hr(e.size)===hr(t.size)){if(n)return e;if(hr(e.explicit)===hr({}))return t;if(hr(t.explicit)===hr({}))return e}return null}function Qxt(e){if(e.children.length===0)return;let t;for(const r of e.children)j0e(r);const n=ege(e.children,r=>{const i=r.component.projection;if(i)if(t){const a=Jxt(t,i);return a&&(t=a),!!a}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new z0e(r,t.specifiedProjection,t.size,Yt(t.data));for(const a of e.children){const o=a.component.projection;o&&(o.isFit&&i.data.push(...a.component.projection.data),a.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function ewt(e,t,n,r){var i,a;if(Ow(t,n)){const o=Rr(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{},s=Ue(t,{expr:"datum"}),u=Ue(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ue(t,{binSuffix:"range",forAs:!0}),formula:NO(s,u,o.format,o.formatType,r)}}return{}}function U0e(e,t){return`${Oge(e)}_${t}`}function twt(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function B9(e,t,n){var r;const i=(r=$O(n,void 0))!==null&&r!==void 0?r:{},a=U0e(i,t);return e.getName(`${a}_bins`)}function nwt(e){return"as"in e}function W0e(e,t,n){let r,i;nwt(e)?r=Xt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ue(e,{forAs:!0}),Ue(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},$O(t,void 0)),o=U0e(a,e.field),{signal:s,extentSignal:u}=twt(n,o);if(CO(a.extent)){const c=a.extent,f=c.selection;i=d0e(n.getSelectionComponent(pr(f),f),c),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class zl extends Vn{constructor(t,n){super(t);this.bins=n}clone(){return new zl(null,Yt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{if(Ko(a)&&er(a.bin)){const{key:s,binComponent:u}=W0e(a,a.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),ewt(n,a,o,n.config))}return i},{});return Zn(r)?null:new zl(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:a}=W0e(n,n.bin,r);return new zl(t,{[i]:a})}merge(t,n){for(const r of Be(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Bd([...this.bins[r].as,...t.bins[r].as],yn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(zd(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(zd(this.bins).map(t=>t.field))}hash(){return`Bin ${yn(this.bins)}`}assemble(){return zd(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,a=t.bin,{extent:o}=a,s=dt(a,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:jd(t.field),as:r,signal:t.signal},CO(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:jd(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ue({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class O0 extends Vn{constructor(t){super(null);t=t??{name:"source"};let n;if(hg(t)||(n=t.format?Object.assign({},Lc(t.format,["parse"])):{}),HO(t))this._data={values:t.values};else if(Dw(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else Ave(t)?this._data={values:[{type:"Sphere"}]}:(Sve(t)||hg(t))&&(this._data={});this._generator=hg(t),t.name&&(this._name=t.name),n&&!Zn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function z9(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!z9(t.children))return!1}return!0}class Hw extends Vn{constructor(t,n){super(t);this.params=n}clone(){return new Hw(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${yn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Gw extends Vn{constructor(t,n){super(t);this.params=n}clone(){return new Gw(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${yn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function lI(e){return e instanceof O0||e instanceof Hw||e instanceof Gw}class V0e{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Zc extends V0e{constructor(){super();this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(lI(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class j9 extends V0e{}function rwt(e,t,n,r){const i=Rr(r)?r.encoding[Ol(t)]:void 0;if(Ko(n)&&Rr(r)&&L8(t,n,i,r.stack,r.markDef,r.config))e.add(Ue(n,{})),e.add(Ue(n,{suffix:"end"})),n.bin&&Ow(n,t)&&e.add(Ue(n,{binSuffix:"range"}));else if(dmt(t)){const a=fmt(t);e.add(r.getName(a))}else e.add(Ue(n));return e}function iwt(e,t){var n;for(const r of Be(t)){const i=t[r];for(const a of Be(i))r in e?e[r][a]=new Set([...(n=e[r][a])!==null&&n!==void 0?n:[],...i[a]]):e[r]={[a]:i[a]}}}class Au extends Vn{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new Au(null,new Set(this.dimensions),Yt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},a=new Set;return!r||(n.forEachFieldDef((o,s)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Ue(o,{forAs:!0})]);else{if(Ud(d)||tg(d)){const p=Ud(d)?"argmin":"argmax",g=d[p];i[g]=(l=i[g])!==null&&l!==void 0?l:{},i[g][p]=new Set([Ue({op:p,field:g},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Ue(o,{forAs:!0})]);Xd(s)&&n.scaleDomain(s)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Ue({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Ue({field:h,aggregate:"max"},{forAs:!0})]))}else rwt(a,s,o,n)}),a.size+Be(i).length===0)?null:new Au(t,a,i)}static makeFromTransform(t,n){var r,i,a;const o=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(s["*"]=(r=s["*"])!==null&&r!==void 0?r:{},s["*"].count=new Set([f||Ue(u,{forAs:!0})])):(s[c]=(i=s[c])!==null&&i!==void 0?i:{},s[c][l]=new Set([f||Ue(u,{forAs:!0})])))}for(const u of(a=n.groupby)!==null&&a!==void 0?a:[])o.add(u);return o.size+Be(s).length===0?null:new Au(t,o,s)}merge(t){return Fgt(this.dimensions,t.dimensions)?(iwt(this.measures,t.measures),!0):(Evt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Be(this.measures)])}producedFields(){const t=new Set;for(const n of Be(this.measures))for(const r of Be(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${yn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const a of Be(this.measures))for(const o of Be(this.measures[a]))for(const s of this.measures[a][o])r.push(s),t.push(o),n.push(a==="*"?null:jd(a));return{type:"aggregate",groupby:[...this.dimensions].map(jd),ops:t,fields:n,as:r}}}class I0 extends Vn{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const a of Ss){const o=n.facet[a];if(o){const{bin:s,sort:u}=o;this[a]=Object.assign({name:n.getName(`${a}_domain`),fields:[Ue(o),...er(s)?[Ue(o,{binSuffix:"end"})]:[]]},Rl(u)?{sortField:u}:vt(u)?{sortIndexField:k0(o,a)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ss)this[n]&&(t+=` ${n.charAt(0)}:${yn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Ss)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ss)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Es){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),a=r.get("range");if(xo(i)&&Yd(a)){const o=fI(this.childModel,n),s=G9(o);s?t[n]=s:Me(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],a=[],o=[],s=[];r&&r[i]&&(n?(a.push(`distinct_${r[i]}`),o.push("max")):(a.push(r[i]),o.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=DO,field:f}=u;a.push(f),o.push(c),s.push(Ue(u,{forAs:!0}))}else l&&(a.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},a.length?{fields:a,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:a}=this.model.component,o=[],s={};for(const c of R9){for(const f of F9){const d=(n=a[c]&&a[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const a=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:u}=this;if(o&&s&&(a.x||a.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=a.x)!==null&&t!==void 0?t:[],(n=a.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[jc,zc])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,a));if(u){const l=this.assembleFacetHeaderData(a);l&&r.push(...l)}return r}}function q0e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function awt(e,t){const n=age(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=q0e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=q0e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Me(Pmt(t)),null}function owt(e){const t={};return sO(e.filter,n=>{var r;if(nme(n)){let i=null;C8(n)?i=n.equal:k8(n)?i=n.range[0]:T8(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(y0(i)?t[n.field]="date":Qr(i)?t[n.field]="number":Xt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function swt(e){const t={};function n(r){LO(r)?t[r.field]="date":r.type==="quantitative"&&omt(r.aggregate)?t[r.field]="number":xw(r.field)>1?r.field in t||(t[r.field]="flatten"):U8(r)&&Rl(r.sort)&&xw(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Rr(e)||ku(e))&&e.forEachFieldDef((r,i)=>{if(Ko(r))n(r);else{const a=ig(i),o=e.fieldDef(a);n(Object.assign(Object.assign({},r),{type:o.type}))}}),Rr(e)){const{mark:r,markDef:i,encoding:a}=e;if(eg(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",s=a[o];We(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function uwt(e){const t={};if(Rr(e)&&e.component.selection)for(const n of Be(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&xw(i.field)>1&&(t[i.field]="flatten")}return t}class da extends Vn{constructor(t,n){super(t);this._parse=n}clone(){return new da(null,Yt(this._parse))}hash(){return`Parse ${yn(this._parse)}`}static makeExplicit(t,n,r){let i={};const a=n.data;return!hg(a)&&a&&a.format&&a.format.parse&&(i=a.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const s of Be(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:Me($ge(s,r[s],u.value)))}for(const s of Be(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:Me($ge(s,n[s],u)))}const a=new Kc(n,r);i.copyAll(a);const o={};for(const s of Be(a.combine())){const u=a.get(s);u!==null&&(o[s]=u)}return Be(o).length===0||i.parseNothing?null:new da(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Be(this._parse)){const r=this._parse[n];xw(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Be(this._parse))}dependentFields(){return new Set(Be(this._parse))}assembleTransforms(t=!1){return Be(this._parse).filter(n=>t?xw(n)>1:!0).map(n=>{const r=awt(n,this._parse[n]);return r?{type:"formula",expr:r,as:oge(n)}:null}).filter(n=>n!==null)}}class ah extends Vn{clone(){return new ah(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([_0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:_0}}}class bg extends Vn{constructor(t,n){super(t);this.transform=n}clone(){return new bg(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Bd(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`JoinAggregateTransform ${yn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const a of this.transform.joinaggregate)n.push(a.op),r.push(this.getDefaultName(a)),t.push(a.field===void 0?null:a.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function lwt(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Ue(r);return i&&t.push(i),t},[])}function cwt(e){return vt(e)&&e.every(t=>Xt(t))&&e.length>1}class Jc extends Vn{constructor(t,n){super(t);this._stack=n}clone(){return new Jc(null,Yt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:a,offset:o="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(ei(f.order,"ascending"));const l={field:s,order:u};let c;return cwt(a)?c=a:Xt(a)?c=[a,a+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Jc(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:a,fieldChannel:o,offset:s,impute:u}=r;let l;if(a){const h=i[a];l=Ml(h)}const c=lwt(n),f=n.encoding.order;let d;return vt(f)||We(f)?d=Bme(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Jc(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${yn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ue(t,{binSuffix:"mid"})]:[Ue(t,{}),Ue(t,{binSuffix:"end"})]:[Ue(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:a,sort:o,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ue(r,{expr:"datum"})+`+${1-c}*`+Ue(r,{expr:"datum",binSuffix:"end"}),as:Ue(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...a,...n],key:Ue(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:s}),t}}class N0 extends Vn{constructor(t,n){super(t);this.transform=n}clone(){return new N0(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Bd(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`WindowTransform ${yn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],a=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),a.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>h8(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}class fwt extends Zc{run(t){const n=t.parent;if(t instanceof da){if(lI(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof da)this.setMutated(),n.merge(t);else{if(rge(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class dwt extends j9{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Be(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class hwt extends Zc{run(t){return t instanceof qa||t.numChildren()>0||t instanceof I0?this.flags:(this.setMutated(),t.remove(),this.flags)}}class pwt extends Zc{constructor(){super(...arguments);this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof $l){const n=t.producedFields();tge(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class gwt extends Zc{run(t){this.setContinue();const r=t.parent.children.filter(a=>a instanceof $l),i=r.pop();for(const a of r)this.setMutated(),i.merge(a);return this.flags}}function mwt(e){function t(n){if(!(n instanceof I0)){const r=n.clone();if(r instanceof qa){const i=W9+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Au||r instanceof Jc||r instanceof N0||r instanceof bg)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function U9(e){if(e instanceof I0)if(e.numChildren()===1&&!(e.children[0]instanceof qa)){const t=e.children[0];(t instanceof Au||t instanceof Jc||t instanceof N0||t instanceof bg)&&t.addDimensions(e.fields),t.swapWithParent(),U9(e)}else{const t=e.model.component.data.main;H0e(t);const n=mwt(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(U9)}function H0e(e){if(e instanceof qa&&e.type===sa&&e.numChildren()===1){const t=e.children[0];t instanceof I0||(t.swapWithParent(),H0e(e))}}class vwt extends j9{constructor(){super()}run(t){t instanceof qa&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class ywt extends j9{constructor(t){super();this.requiresSelectionId=t&&b9(t)}run(t){t instanceof ah&&(this.requiresSelectionId&&(lI(t.parent)||t.parent instanceof Au||t.parent instanceof da)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class bwt extends Zc{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(a=>a instanceof da);if(n.numChildren()>1&&i.length>=1){const a={},o=new Set;for(const s of i){const u=s.parse;for(const l of Be(u))l in a?a[l]!==u[l]&&o.add(l):a[l]=u[l]}for(const s of o)delete a[s];if(!Zn(a)){this.setMutated();const s=new da(n,a);for(const u of r){if(u instanceof da)for(const l of Be(a))delete u.parse[l];n.removeChild(u),u.parent=s,u instanceof da&&Be(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class xwt extends Zc{run(t){const n=t.parent,r=n.children.filter(a=>a instanceof Au),i={};for(const a of r){const o=yn(a.groupBy);o in i||(i[o]=[]),i[o].push(a)}for(const a of Be(i)){const o=i[a];if(o.length>1){const s=o.pop();for(const u of o)s.merge(u)&&(n.removeChild(u),u.parent=s,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class wwt extends Zc{constructor(t){super();this.model=t}run(t){const n=t.parent,r=!(lI(n)||n instanceof A0||n instanceof da||n instanceof ah),i=[],a=[];for(const o of n.children)o instanceof zl&&(r&&!rge(n.producedFields(),o.dependentFields())?i.push(o):a.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof zl?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(a.length>1){const o=a.pop();for(const s of a)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class _wt extends Zc{run(t){const n=t.parent,r=[...n.children];if(!yw(r,s=>s instanceof qa)||n.numChildren()<=1)return this.setContinue(),this.flags;const a=[];let o;for(const s of r)if(s instanceof qa){let u=s;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof qa)u=l;else break}a.push(...u.children),o?(n.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else a.push(s);if(a.length){this.setMutated();for(const s of a)s.parent.removeChild(s),s.parent=o}return this.setContinue(),this.flags}}const W9="scale_",cI=5;function oh(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function Swt(e){return e}function Cu(e,t){return t.map(r=>{if(e instanceof Zc){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(Swt)}function G0e(e,t){let n=e.sources;const r=new Set;return r.add(Cu(new vwt,n)),r.add(Cu(new ywt(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(Cu(new hwt,oh(n))),n=n.filter(i=>i.numChildren()>0),r.add(Cu(new fwt,oh(n))),r.add(Cu(new wwt(t),oh(n))),r.add(Cu(new pwt,oh(n))),r.add(Cu(new bwt,oh(n))),r.add(Cu(new xwt,oh(n))),r.add(Cu(new gwt,oh(n))),r.add(Cu(new dwt,n)),r.add(Cu(new _wt,oh(n))),e.sources=n,r.has(!0)}function Ewt(e,t){z9(e.sources);let n=0,r=0;for(let i=0;i<cI&&G0e(e,t);i++)n++;e.sources.map(U9);for(let i=0;i<cI&&G0e(e,t);i++)r++;z9(e.sources),Math.max(n,r)===cI&&Me(`Maximum optimization runs(${cI}) reached.`)}class Yo{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Yo(()=>t(n))}}function K0e(e){Rr(e)?Awt(e):Cwt(e)}function Awt(e){const t=e.component.scales;for(const n of Be(t)){const r=Twt(e,n);if(t[n].setWithExplicit("domains",r),Iwt(e,n),e.component.data.isFaceted){let a=e;for(;!ku(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const s of r.value)Zd(s)&&(s.data=W9+s.data.replace(W9,""))}}}function Cwt(e){for(const n of e.children)K0e(n);const t=e.component.scales;for(const n of Be(t)){let r,i=null;for(const a of e.children){const o=a.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=th(r,o.getWithExplicit("domains"),"domains","scale",H9);const s=o.get("selectionExtent");i&&s&&i.selection!==s.selection&&Me("The same selection must be used to override scale domains in a layered view."),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function kwt(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:a}=X0e(t,n);if(!i){Me(a);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=X0e(t,n);if(i)return"unaggregated"}return e}function Twt(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=kwt(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&pi(r.x2)?pi(r.x)?th(sh(n,i,e,"x"),sh(n,i,e,"x2"),"domain","scale",H9):sh(n,i,e,"x2"):t==="y"&&pi(r.y2)?pi(r.y)?th(sh(n,i,e,"y"),sh(n,i,e,"y2"),"domain","scale",H9):sh(n,i,e,"y2"):sh(n,i,e,t)}function Owt(e,t,n){return e.map(r=>({signal:`{data: ${H8(r,{timeUnit:n,type:t})}}`}))}function V9(e,t,n){var r;const i=(r=Va(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?Owt(e,t,i):[e]}function sh(e,t,n,r){const{encoding:i}=n,a=pi(i[r]),{type:o}=a,s=a.timeUnit;if(c0t(t)){const f=sh(e,void 0,n,r),d=V9(t.unionWith,o,s);return dg([...f.value,...d])}else{if(Et(t))return dg([t]);if(t&&t!=="unaggregated"&&!ome(t))return dg(V9(t,o,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Xo([[0,1]]);const f=n.requestDataName(sa);return Xo([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Xd(r)&&We(a)?Nwt(n,r,e):void 0;if(Qd(a)){const f=V9([a.datum],o,s);return Xo(f)}const c=a;if(t==="unaggregated"){const f=n.requestDataName(sa),{field:d}=a;return Xo([{data:f,field:Ue({field:d,aggregate:"min"})},{data:f,field:Ue({field:d,aggregate:"max"})}])}else if(er(c.bin)){if(xo(e))return Xo(e==="bin-ordinal"?[]:[{data:lO(l)?n.requestDataName(sa):n.requestDataName(GO),field:n.vgField(r,Ow(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!Ci(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(er(f)){const d=B9(n,c.field,f);return Xo([new Yo(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Xo([{data:n.requestDataName(sa),field:n.vgField(r,{})}])}}else if(c.timeUnit&&bt(["time","utc"],e)&&L8(r,c,Rr(n)?n.encoding[Ol(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(sa);return Xo([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Xo(l?[{data:lO(l)?n.requestDataName(sa):n.requestDataName(GO),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(sa),field:n.vgField(r)}])}function q9(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":DO)},r?{field:jd(r)}:{}),i?{order:i}:{})}function Iwt(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=ome(i)&&i,s=Ew(a)&&CO(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",o??s,!0)}function Nwt(e,t,n){if(!xo(n))return;const r=e.fieldDef(t),i=r.sort;if(_me(i))return{op:"min",field:k0(r,t),order:"ascending"};const{stack:a}=e,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Rl(i)){const s=a&&!bt(o,i.field);return q9(i,s)}else if(wme(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=a&&!bt(o,f);if(Ud(c)||tg(c))return q9({field:Ue(l),order:u},d);if(h8(c)||!c)return q9({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],i))return!0}}function X0e(e,t){const{aggregate:n,type:r}=e;return n?Xt(n)&&!lmt[n]?{valid:!1,reason:tvt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:nvt(e)}:{valid:!0}:{valid:!1,reason:evt(e)}}function H9(e,t,n,r){return e.explicit&&t.explicit&&Me(svt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Dwt(e){const t=Bd(e.map(o=>Zd(o)?dt(o,["sort"]):o),yn),n=Bd(e.map(o=>{if(Zd(o)){const s=o.sort;return s!==void 0&&!lO(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(o=>o!==void 0),yn);if(t.length===0)return;if(t.length===1){const o=e[0];if(Zd(o)&&n.length>0){let s=n[0];if(n.length>1)Me(Wge),s=!0;else if(Ci(s)&&"field"in s){const u=s.field;o.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},o),{sort:s})}return o}const r=Bd(n.map(o=>lO(o)||!("op"in o)||o.op in imt?o:(Me(lvt(o)),!0)),yn);let i;r.length===1?i=r[0]:r.length>1&&(Me(Wge),i=!0);const a=Bd(e.map(o=>Zd(o)?o.data:null),o=>o);return a.length===1&&a[0]!==null?Object.assign({data:a[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function G9(e){if(Zd(e)&&Xt(e.field))return e.field;if(Lvt(e)){let t;for(const n of e.fields)if(Zd(n)&&Xt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Me(cvt),t}return Me(fvt),t}else if(Bvt(e)){Me(dvt);const t=e.fields[0];return Xt(t)?t:void 0}}function fI(e,t){const r=e.component.scales[t].get("domains").map(i=>(Zd(i)&&(i.data=e.lookupDataSource(i.data)),i));return Dwt(r)}function Y0e(e){return D0(e)||X9(e)?e.children.reduce((t,n)=>t.concat(Y0e(n)),Z0e(e)):Z0e(e)}function Z0e(e){return Be(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=dt(i,["name","type","selectionExtent","domains","range","reverse"]),d=Rwt(i.range,a,n);let h;s&&(h=Rbt(e,s));const p=fI(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Rwt(e,t,n){return Nl(n)&&Yd(e)?{step:{signal:t+"_step"}}:e}class J0e extends Kc{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:yw(this.get("domains"),t=>vt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Fwt=["range","scheme"];function Q0e(e){return e==="x"?"width":e==="y"?"height":void 0}function Mwt(e){const t=e.component.scales;for(const n of EO){const r=t[n];if(!r)continue;const i=Pwt(n,e);r.setWithExplicit("range",i)}}function eye(e,t){const n=e.fieldDef(t);if(n&&n.bin&&er(n.bin)){const r=B9(e,n.field,n.bin),i=Q0e(t),a=e.getName(i);return new Yo(()=>{const o=e.getSignalName(r),s=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(a)} / (${s})`})}}function Pwt(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e).get("type");for(const o of Fwt)if(n[o]!==void 0){const s=sme(a,o),u=ume(e,o);if(!s)Me(jge(a,o,e));else if(u)Me(u);else switch(o){case"range":return vt(n.range)&&Nl(e)?dg(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return Yo.fromName(f,c)}return l})):dg(n.range);case"scheme":return dg($wt(n[o]))}}if(e===wr||e===hi){const o=e===wr?"width":"height",s=r[o];if(Pl(s)){if(xo(a))return dg({step:s.step});Me(Uge(o))}}return Xo(Lwt(e,t))}function $wt(e){return l0t(e)?Object.assign({scheme:e.name},Lc(e,["name"])):{scheme:e}}function Lwt(e,t){const{size:n,config:r,mark:i,encoding:a}=t,o=t.getSignalName.bind(t),{type:s}=pi(a[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case wr:case hi:{if(bt(["point","band"],l)){if(e===wr&&!n.width){const p=Nw(r.view,"width");if(Pl(p))return p}else if(e===hi&&!n.height){const p=Nw(r.view,"height");if(Pl(p))return p}}const d=Q0e(e),h=t.getName(d);return e===hi&&As(l)?[Yo.fromName(o,h),0]:[0,Yo.fromName(o,h)]}case Vc:{const d=t.component.scales[e].get("zero"),h=tye(i,d,r),p=jwt(i,n,t,r);return OO(l)?zwt(h,p,Bwt(l,r,c,e)):[h,p]}case wu:return[0,Math.PI*2];case ng:return[0,360];case El:return[0,new Yo(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case qd:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Hd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case bo:return"symbol";case yo:case kl:case Tl:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case qc:case Wd:case Vd:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function Bwt(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&vt(n)?n.length+1:(Me(wvt(r)),3)}}function zwt(e,t,n){const r=()=>{const i=Iw(t),a=Iw(e),o=`(${i} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${i} + ${o}, ${o})`};return Et(t)?new Yo(r):{signal:r()}}function tye(e,t,n){if(t)return Et(t)?{signal:`${t.signal} ? 0 : ${tye(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(kO("size",e))}const nye=.95;function jwt(e,t,n,r){const i={x:eye(n,"x"),y:eye(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const a=rye(t,i,r.view);return Qr(a)?a-1:new Yo(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const a=rye(t,i,r.view);return Qr(a)?Math.pow(nye*a,2):new Yo(()=>`pow(${nye} * ${a.signal}, 2)`)}}throw new Error(kO("size",e))}function rye(e,t,n){const r=Pl(e.width)?e.width.step:WO(n,"width"),i=Pl(e.height)?e.height.step:WO(n,"height");return t.x||t.y?new Yo(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function iye(e,t){Rr(e)?Uwt(e,t):sye(e,t)}function Uwt(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=e;for(const s of Be(n)){const u=o[s],l=n[s],c=e.getScaleComponent(s),f=pi(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=sme(h,t),v=ume(s,t);if(d!==void 0&&(m?v&&Me(v):Me(jge(h,t,s))),m&&v===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const y=t in aye?aye[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:a,config:r}):r.scale[t];y!==void 0&&l.set(t,y,!1)}}}const aye={bins:({model:e,fieldOrDatumDef:t})=>We(t)?Wwt(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Vwt(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>qwt(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>Hwt(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>Gwt(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>Kwt(e,t,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=We(e)?e.sort:void 0;return Xwt(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>Ywt(e,t,n,r,i)};function oye(e){Rr(e)?Mwt(e):sye(e,"range")}function sye(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?oye(r):iye(r,t);for(const r of Be(n)){let i;for(const a of e.children){const o=a.component.scales[r];if(o){const s=o.getWithExplicit(t);i=th(i,s,t,"scale",_ve((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function Wwt(e,t){const n=t.bin;if(er(n)){const r=B9(e,t.field,n);return new Yo(()=>e.getSignalName(r))}else if(Wa(n)&&Ew(n)&&n.step!==void 0)return{step:n.step}}function Vwt(e,t){if(bt([yo,kl,Tl],e)&&t!=="nominal")return"hcl"}function qwt(e,t,n){var r;if(!(((r=Ml(n))===null||r===void 0?void 0:r.bin)||bt([ti.TIME,ti.UTC],e)))return t in Kd?!0:void 0}function Hwt(e,t,n,r,i,a){if(e in Kd){if(Su(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:s}=i;if(o==="bar"&&!(We(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===ti.POINT)return n.pointPadding}}function Gwt(e,t,n,r){if(e===void 0&&t in Kd){const{bandPaddingInner:i,barBandPaddingInner:a,rectBandPaddingInner:o}=r;return ei(i,n==="bar"?a:o)}}function Kwt(e,t,n,r,i,a){if(e===void 0&&t in Kd&&n===ti.BAND){const{bandPaddingOuter:o}=a;return ei(o,Et(i)?{signal:`${i.signal}/2`}:i/2)}}function Xwt(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return As(e)&&t==="descending"?Et(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(As(e)&&t==="descending")return!0}function Ywt(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&As(i)){if(vt(n)){const o=n[0],s=n[n.length-1];if(o<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!OO(i))return!0;if(!(We(t)&&t.bin)&&bt([...Es,...xmt],e)){const{orient:o,type:s}=r;return!(bt(["bar","area","line","trail"],s)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function Zwt(e,t,n,r){const i=Jwt(t,n,r),{type:a}=e;return Xd(t)?a!==void 0?cme(t,a)?We(n)&&!lme(a,n.type)?(Me(avt(a,i)),i):a:(Me(ivt(t,a,i)),i):i:null}function Jwt(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(m0(e)||AO(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Me(x8(e,"ordinal")),"ordinal";if(e in Kd){if(bt(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in v8)return"band";return t.band!==void 0||W8(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return m0(e)?"time":AO(e)==="discrete"?(Me(x8(e,"temporal")),"ordinal"):We(t)&&t.timeUnit&&Va(t.timeUnit).utc?"utc":"time";case"quantitative":return m0(e)?We(t)&&er(t.bin)?"bin-ordinal":"linear":AO(e)==="discrete"?(Me(x8(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Bge(t.type))}function Qwt(e,{ignoreRange:t}={}){uye(e),K0e(e);for(const n of h0t)iye(e,n);t||oye(e)}function uye(e){Rr(e)?e.component.scales=e2t(e):e.component.scales=n2t(e)}function e2t(e){const{encoding:t,mark:n}=e;return EO.reduce((r,i)=>{const a=pi(t[i]);if(a&&n===hge&&i===bo&&a.type===w0)return r;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o=o??{};const s=Zwt(o,i,a,n);r[i]=new J0e(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}const t2t=_ve((e,t)=>ime(e)-ime(t));function n2t(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const a of e.children){uye(a);for(const o of Be(a.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:Axt(o,e),i.scale[o]==="shared"){const s=r[o],u=a.component.scales[o].getWithExplicit("type");s?Yvt(s.value,u.value)?r[o]=th(s,u,"type","scale",t2t):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const a of Be(r)){const o=e.scaleName(a,!0),s=r[a];n[a]=new J0e(o,s);for(const u of e.children){const l=u.component.scales[a];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class K9{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Rr(e){return(e==null?void 0:e.type)==="unit"}function ku(e){return(e==null?void 0:e.type)==="facet"}function X9(e){return(e==null?void 0:e.type)==="concat"}function D0(e){return(e==null?void 0:e.type)==="layer"}class Y9{constructor(t,n,r,i,a,o,s){var u,l;this.type=n,this.parent=r,this.config=a,this.view=s,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=a,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=eh(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new K9,this.projectionNameMap=r?r.projectionNameMap:new K9,this.signalNameMap=r?r.signalNameMap:new K9,this.data=t.data,this.description=t.description,this.transforms=abt((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:oyt(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:RO(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Kc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Yt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Qwt(this)}parseProjection(){j0e(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){M0e(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=dt(t,["style"]),r={};for(const i of Be(n)){const a=n[i];a!==void 0&&(r[i]=jr(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=jr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Zn(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=dt(t,["spacing"]),{component:i,config:a}=this,o=Ext(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Ss)t[r].title&&n.push(yxt(this,r));for(const r of R9)n=n.concat(bxt(this,r));return n}assembleAxes(){return ixt(this.component.axes,this.config)}assembleLegends(){return L0e(this)}assembleProjections(){return Gxt(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:a}=i,o=dt(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},Mme(this.config.title).nonMark),o),a?{encode:{update:a}}:{});if(s.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],s.anchor)&&(s.frame=(n=s.frame)!==null&&n!==void 0?n:"group"):s.anchor=(r=s.anchor)!==null&&r!==void 0?r:"start",Zn(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||ku(this.parent)?Y0e(this):[];i.length>0&&(n.scales=i);const a=this.assembleAxes();a.length>0&&(n.axes=a);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return pr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(ku(this.parent)){const n=C0e(t),r=SO(n),i=this.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(xo(a)&&Yd(o)){const s=i.get("name"),u=fI(this,r),l=G9(u);if(l){const c=Ue({aggregate:"distinct",field:l},{expr:"datum"});return{signal:A0e(s,i,c)}}else return Me(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Ege(t)&&Xd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Imt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class lye extends Y9{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Ue(r,n)}reduceFieldDef(t,n){return Wme(this.getMapping(),(r,i,a)=>{const o=Ml(i);return o?t(r,o,a):r},n)}forEachFieldDef(t,n){X8(this.getMapping(),(r,i)=>{const a=Ml(r);a&&t(a,i)},n)}}class dI extends Vn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(a=o[1])!==null&&a!==void 0?a:"density"]}clone(){return new dI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=dt(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class Kw extends Vn{constructor(t,n){super(t);this.filter=n}clone(){return new Kw(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:a}=n;if(Fn("invalid",a,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Xd(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");As(d)&&l.aggregate!=="count"&&!eg(i)&&(u[l.field]=l)}return u},{});return Be(s).length?new Kw(t,s):null}dependentFields(){return new Set(Be(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${yn(this.filter)}`}assemble(){const t=Be(this.filter).reduce((n,r)=>{const i=this.filter[r],a=Ue(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${a}) || (isValid(${a}) && isFinite(+${a})))`):i.type==="quantitative"&&(n.push(`isValid(${a})`),n.push(`isFinite(+${a})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class hI extends Vn{constructor(t,n){super(t);this.transform=n,this.transform=Yt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((a,o)=>{var s;return(s=i[o])!==null&&s!==void 0?s:a})}clone(){return new hI(this.parent,Yt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${yn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class pI extends Vn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new pI(null,Yt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${yn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class R0 extends Vn{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new R0(null,Yt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Cl,Al],[_s,_u]]){const a=i.map(o=>{const s=pi(n.encoding[o]);return We(s)?s.field:Qd(s)?{expr:`${s.datum}`}:Hc(s)?{expr:`${s.value}`}:void 0});(a[0]||a[1])&&(t=new R0(t,a,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(bo)){const i=n.typedFieldDef(bo);i.type===w0&&(t=new R0(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(Xt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${yn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class Xw extends Vn{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new Xw(null,this.projection,Yt(this.fields),Yt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Cl,Al],[_s,_u]]){const i=r.map(o=>{const s=pi(n.encoding[o]);return We(s)?s.field:Qd(s)?{expr:`${s.datum}`}:Hc(s)?{expr:`${s.value}`}:void 0}),a=r[0]===_s?"2":"";(i[0]||i[1])&&(t=new Xw(t,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}return t}dependentFields(){return new Set(this.fields.filter(Xt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${yn(this.fields)} ${yn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class xg extends Vn{constructor(t,n){super(t);this.transform=n}clone(){return new xg(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new xg(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,a=r.y;if(We(i)&&We(a)){const o=i.impute?i:a.impute?a:void 0;if(o===void 0)return;const s=i.impute?a:a.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=Vme(n.mark,r);return new xg(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${yn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:a,value:o,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:Byt(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},a?{groupby:a}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class gI extends Vn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.loess]}clone(){return new gI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=dt(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class Yw extends Vn{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new Yw(null,Yt(this.transform),this.secondary)}static make(t,n,r,i){const a=n.component.data.sources,{from:o}=r;let s=null;if(jyt(o)){let u=hye(o.data,a);u||(u=new O0(o.data),a.push(u));const l=n.getName(`lookup_${i}`);s=new qa(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(Uyt(o)){const u=o.selection;if(r=Object.assign({as:u},r),s=n.getSelectionComponent(pr(u),u).materialized,!s)throw new Error(Rmt(u))}return new Yw(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?zr(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${yn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:zr(this.transform.as)}:{});else{let n=this.transform.as;Xt(n)||(Me(Lmt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class mI extends Vn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new mI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=dt(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class vI extends Vn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.regression]}clone(){return new vI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=dt(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class yI extends Vn{constructor(t,n){super(t);this.transform=n}clone(){return new yI(null,Yt(this.transform))}addDimensions(t){var n;this.transform.groupby=Bd(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${yn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:a}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),a!==void 0?{op:a}:{}),r!==void 0?{groupby:r}:{})}}class bI extends Vn{constructor(t,n){super(t);this.transform=n}clone(){return new bI(null,Yt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${yn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function cye(e){let t=0;function n(r,i){var a;if(r instanceof O0&&!r.isGenerator&&!Dw(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof da&&(r.parent instanceof O0&&!i.source?(i.format=Object.assign(Object.assign({},(a=i.format)!==null&&a!==void 0?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof I0){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof Hw||r instanceof Gw||r instanceof Kw||r instanceof A0||r instanceof C0||r instanceof Xw||r instanceof R0||r instanceof Au||r instanceof Yw||r instanceof N0||r instanceof bg||r instanceof pI||r instanceof hI||r instanceof dI||r instanceof gI||r instanceof mI||r instanceof vI||r instanceof ah||r instanceof bI||r instanceof yI)&&i.transform.push(r.assemble()),(r instanceof zl||r instanceof $l||r instanceof xg||r instanceof Jc)&&i.transform.push(...r.assemble()),r instanceof qa&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof qa?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof qa&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function r2t(e){const t=[],n=cye(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function i2t(e,t){var n,r;const i=[],a=cye(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();a(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function a2t(e){return e==="top"||e==="left"||Et(e)?"header":"footer"}function o2t(e){for(const t of Ss)s2t(e,t);dye(e,"x"),dye(e,"y")}function s2t(e,t){var n;const{facet:r,config:i,child:a,component:o}=e;if(e.channelHasField(t)){const s=r[t],u=T0("title",null,i,t);let l=ug(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});a.component.layoutHeaders[t].title&&(l=vt(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const c=T0("labelOrient",s,i,t),f=(n=s.header)!==null&&n!==void 0?n:{},d=ei(f.labels,i.header.labels,!0),h=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:s,[h]:t==="facet"?[]:[fye(e,t,d)]}}}function fye(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function dye(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:a}=e.component;if(a.axis[t]=$9(a,t),a.axis[t]==="shared"){const o=t==="x"?"column":"row",s=i[o];for(const u of r.component.axes[t]){const l=a2t(u.get("orient"));s[l]=(n=s[l])!==null&&n!==void 0?n:[fye(e,o,!1)];const c=qw(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function u2t(e){Z9(e),xI(e,"width"),xI(e,"height")}function l2t(e){Z9(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";xI(e,t),xI(e,n)}function Z9(e){for(const t of e.children)t.parseLayoutSize()}function xI(e,t){const n=C0e(t),r=SO(n),i=e.component.resolve,a=e.component.layoutSize;let o;for(const s of e.children){const u=s.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=th(o,u,n,"")}else o=u}if(o){for(const s of e.children)e.renameSignal(s.getName(n),e.getName(t)),s.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function c2t(e){const{size:t,component:n}=e;for(const r of Es){const i=Il(r);if(t[i]){const a=t[i];n.layoutSize.set(i,Pl(a)?"step":a,!0)}else{const a=f2t(e,i);n.layoutSize.set(i,a,!1)}}}function f2t(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const a=i.get("type"),o=i.get("range");if(xo(a)){const s=Nw(r.view,t);return Yd(o)||Pl(s)?"step":s}else return a9(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return a9(r.view,t);{const a=Nw(r.view,t);return Pl(a)?a.step:a}}}function J9(e,t,n){return Ue(t,Object.assign({suffix:`by_${Ue(e)}`},n??{}))}class Zw extends lye{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=n7(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return kw(t)?Wme(t,(r,i,a)=>bt([zc,jc],a)?i.field===void 0?(Me(b8(i,a)),r):(r[a]=q8(i,a,n),r):(Me(kO(a,"facet")),r),{}):{facet:q8(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=wI(this),this.child.parseData()}parseLayoutSize(){Z9(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),o2t(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const a of Ss)for(const o of F9){const s=this.component.layoutHeaders[a],u=s[o],{facetFieldDef:l}=s;if(l){const c=T0("titleOrient",l,this.config,a);if(bt(["right","bottom"],c)){const f=oI(a,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=a==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";a!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][a]=.5),s.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[a==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Zw))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof Zw?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ue(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Zw){if(this.child.channelHasField("column")){const i=Ue(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Es){const a=this.child.component.scales[i];if(a&&!a.merged){const o=a.get("type"),s=a.get("range");if(xo(o)&&Yd(s)){const u=fI(this.child,i),l=G9(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):Me(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:a,ops:o,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ss){const f=this.facet[c];if(f){u.push(Ue(f));const{bin:d,sort:h}=f;if(er(d)&&u.push(Ue(f,{binSuffix:"end"})),Rl(h)){const{field:p,op:g=DO}=h,m=J9(f,h);r&&i?(a.push(m),o.push("max"),s.push(m)):(a.push(p),o.push(g),s.push(m))}else if(vt(h)){const p=k0(f,c);a.push(p),o.push("max"),s.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||a.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),a.length?{fields:a,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Rl(r.sort)?[J9(r,r.sort,{expr:"datum"})]:vt(r.sort)?[k0(r,t,{expr:"datum"})]:[Ue(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Rl(i)?i.order:!vt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return M9(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of R9)if(t[i]){const a=T0("labelOrient",t[i],n,i);if(bt(r[i],a))return M9(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=r2t(n),i=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ss.map(u=>this.facetSortFields(u)).flat(),order:Ss.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(Obt(this,[])))]}getMapping(){return this.facet}}function d2t(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const a of[n,r])if(Rl(a.sort)){const{field:o,op:s=DO}=a.sort;e=i=new bg(e,{joinaggregate:[{op:s,field:o,as:J9(a,a.sort,{forAs:!0})}],groupby:[Ue(a)]})}return i}return null}function hye(e,t){var n,r,i,a,o,s,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=h.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((a=h.format)===null||a===void 0?void 0:a.feature))&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((s=h.format)===null||s===void 0?void 0:s.feature))&&!((((u=e.format)===null||u===void 0?void 0:u.mesh)||((l=h.format)===null||l===void 0?void 0:l.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(HO(e)&&HO(h)){if(mw(e.values,h.values))return d}else if(Dw(e)&&Dw(h)){if(e.url===h.url)return d}else if(Sve(e)&&e.name===d.dataName)return d}}return null}function h2t(e,t){if(e.data||!e.parent){if(e.data===null){const r=new O0({values:[]});return t.push(r),r}const n=hye(e.data,t);if(n)return hg(e.data)||(n.data.format=Dgt({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new O0(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function p2t(e,t,n){var r,i;let a=0;for(const o of t.transforms){let s,u;if(Jyt(o))u=e=new C0(e,o),s="derived";else if(Cve(o)){const l=owt(o);u=e=(r=da.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new A0(e,t,o.filter)}else if(Qyt(o))u=e=zl.makeFromTransform(e,o,t),s="number";else if(tbt(o))s="date",n.getWithExplicit(o.field).value===void 0&&(e=new da(e,{[o.field]:s}),n.set(o.field,s,!1)),u=e=$l.makeFromTransform(e,o);else if(nbt(o))u=e=Au.makeFromTransform(e,o),s="number",b9(t)&&(e=new ah(e));else if(zyt(o))u=e=Yw.make(e,t,o,a++),s="derived";else if(Xyt(o))u=e=new N0(e,o),s="number";else if(Yyt(o))u=e=new bg(e,o),s="number";else if(rbt(o))u=e=Jc.makeFromTransform(e,o),s="derived";else if(ibt(o))u=e=new pI(e,o),s="derived";else if(Zyt(o))u=e=new hI(e,o),s="derived";else if(Wyt(o))u=e=new yI(e,o),s="derived";else if(Kyt(o))e=new bI(e,o);else if(ebt(o))u=e=xg.makeFromTransform(e,o),s="derived";else if(Vyt(o))u=e=new dI(e,o),s="derived";else if(qyt(o))u=e=new mI(e,o),s="derived";else if(Hyt(o))u=e=new vI(e,o),s="derived";else if(Gyt(o))u=e=new gI(e,o),s="derived";else{Me($mt(o));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function wI(e){var t,n,r,i,a,o,s,u,l,c;let f=h2t(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new Lyt,g=e.data;hg(g)?(Eve(g)?f=new Gw(f,g.sequence):c9(g)&&(f=new Hw(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=da.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new ah(f);const m=e.parent&&D0(e.parent);(Rr(e)||ku(e))&&m&&(f=(r=zl.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=p2t(f,e,p));const v=uwt(e),y=swt(e);f=(i=da.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,Rr(e)&&(f=R0.parseAll(f,e),f=Xw.parseAll(f,e)),(Rr(e)||ku(e))&&(m||(f=(a=zl.makeFromEncoding(f,e))!==null&&a!==void 0?a:f),f=(o=$l.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=C0.parseAllForSortIndex(f,e));const b=e.getName(GO),x=new qa(f,b,GO,h);if(d[b]=x,f=x,Rr(e)){const _=Au.makeFromEncoding(f,e);_&&(f=_,b9(e)&&(f=new ah(f))),f=(s=xg.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=Jc.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}Rr(e)&&(f=(l=Kw.make(f,e))!==null&&l!==void 0?l:f);const w=e.getName(sa),S=new qa(f,w,sa,h);d[w]=S,f=S,Rr(e)&&nxt(e,S);let A=null;if(ku(e)){const _=e.getName("facet");f=(c=d2t(f,e.facet))!==null&&c!==void 0?c:f,A=new I0(f,e,_,S.getSource()),d[_]=A}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:S,facetRoot:A,ancestorParse:p})}class g2t extends Y9{constructor(t,n,r,i){var a,o,s,u;super(t,"concat",n,r,i,t.resolve);(((o=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&Me(Mmt),this.children=this.getChildren(t).map((l,c)=>n7(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=wI(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return UO(t)?t.vconcat:i9(t)?t.hconcat:t.concat}parseLayoutSize(){l2t(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=P9(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function m2t(e){return e===!1||e===null}const v2t=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},lge),{labelExpr:1,encode:1}),pye=Be(v2t);class Q9 extends Kc{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new Q9(Yt(this.explicit),Yt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!m2t(this.get(t))}hasOrientSignalRef(){return Et(this.explicit.orient)}}function y2t(e,t,n){var r;const{encoding:i,config:a}=e,o=(r=pi(i[t]))!==null&&r!==void 0?r:pi(i[Ol(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return sg(l)?Object.assign({text:P8({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:a})},n):n}function b2t(e){return Es.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[C2t(n,e)]),t),{})}const x2t={bottom:"top",top:"bottom",left:"right",right:"left"};function w2t(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const o of Be(a.component.axes))r.axis[o]=$9(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=_2t(n[o],a.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const a of Es){for(const o of e.children)if(!!o.component.axes[a]){if(r.axis[a]==="independent"){n[a]=((t=n[a])!==null&&t!==void 0?t:[]).concat(o.component.axes[a]);for(const s of o.component.axes[a]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!Et(u)){if(i[u]>0&&!l){const c=x2t[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete o.component.axes[a]}if(r.axis[a]==="independent"&&n[a]&&n[a].length>1)for(const o of n[a])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function _2t(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){const o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=S2t(i,a)}}}else return t.map(n=>n.clone());return e}function S2t(e,t){for(const n of pye){const r=th(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,a)=>{switch(n){case"title":return Ume(i,a);case"gridScale":return{explicit:i.explicit,value:ei(i.value,a.value)}}return qO(i,a,n,"axis")});e.setWithExplicit(n,r)}return e}function E2t(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Et(n.labelAngle)?n.labelAngle:fO(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===x0e(r,i))return!0}return e===n[t]}const A2t=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function C2t(e,t){var n,r,i;let a=t.axis(e);const o=new Q9,s=pi(t.encoding[e]),{mark:u,config:l}=t,c=(a==null?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||pxt(e),f=t.getScaleComponent(e).get("type"),d=sxt(e,f,c,t.config),h=a!==void 0?!a:N9("disable",l,a==null?void 0:a.style,d).configValue;if(o.set("disable",h,a!==void 0),h)return o;a=a||{};const p=fxt(t,a,e,s,d),g={fieldOrDatumDef:s,axis:a,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of pye){const b=y in v0e?v0e[y](g):cge(y)?a[y]:void 0,x=b!==void 0,w=E2t(b,y,a,t,e);if(x&&w)o.set(y,b,w);else{const{configValue:S=void 0,configFrom:A=void 0}=cge(y)&&y!=="values"?N9(y,t.config,a.style,d):{},_=S!==void 0;x&&!_?o.set(y,b,w):(A!=="vgAxisConfig"||A2t.has(y)&&_||l8(S)||Et(S))&&o.set(y,S,!1)}}const m=(i=a.encoding)!==null&&i!==void 0?i:{},v=uge.reduce((y,b)=>{var x;if(!o.hasAxisPart(b))return y;const w=k0e((x=m[b])!==null&&x!==void 0?x:{},t),S=b==="labels"?y2t(t,e,w):w;return S!==void 0&&!Zn(S)&&(y[b]={update:S}),y},{});return Zn(v)||o.set("encode",v,!!a.encoding||a.labelAngle!==void 0),o}function k2t({encoding:e,size:t}){for(const n of Es){const r=Il(n);Pl(t[r])&&Fl(e[n])&&(delete t[r],Me(Uge(r)))}return t}function T2t(e,t,n,{graticule:r}){const i=_l(e)?Object.assign({},e):{type:e},a=Fn("orient",i,n);if(i.orient=D2t(i.type,t,a),a!==void 0&&a!==i.orient&&Me(Zmt(i.orient,a)),i.type==="bar"&&i.orient){const l=Fn("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:Jgt[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Fn("opacity",i,n)===void 0&&(i.opacity=I2t(i.type,t)),i.filled===void 0&&(i.filled=r?!1:N2t(i,n)),Fn("cursor",i,n)===void 0&&(i.cursor=O2t(i,t,n)),i}function O2t(e,t,n){return t.href||e.href||Fn("href",e,n)?"pointer":e.cursor}function I2t(e,t){if(bt([gO,c8,f8,d8],e)&&!G8(t))return .7}function N2t(e,t){const n=cg("filled",e,t),r=e.type;return ei(n,r!==gO&&r!==pO&&r!==mO)}function D2t(e,t,n){switch(e){case gO:case f8:case d8:case dge:case Vgt:case Wgt:return}const{x:r,y:i,x2:a,y2:o}=t;switch(e){case hO:if(We(r)&&(Wa(r.bin)||We(i)&&i.aggregate&&!r.aggregate))return"vertical";if(We(i)&&(Wa(i.bin)||We(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(We(r)&&r.type===ag&&!er(r.bin)||j8(r)))return"horizontal";if(!o&&(We(i)&&i.type===ag&&!er(i.bin)||j8(i)))return"vertical"}case mO:if(a&&!(We(r)&&Wa(r.bin))&&o&&!(We(i)&&Wa(i.bin)))return;case dO:if(o)return We(i)&&Wa(i.bin)?"horizontal":"vertical";if(a)return We(r)&&Wa(r.bin)?"vertical":"horizontal";if(e===mO){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case pO:case c8:{const s=Fl(r),u=Fl(i);if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===x0,d=c.type===x0;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const R2t={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),nh(e,"radius","arc")),nh(e,"theta","arc"))},F2t={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),XO("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),XO("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),h9(e))},M2t={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","bar")),nh(e,"y","bar"))},P2t={vgMark:"shape",encodeEntry:e=>Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&We(n)&&n.type===w0?{field:Ue(n,{expr:"datum"})}:{})]}},$2t={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","image")),nh(e,"y","image")),f9(e,"url"))},L2t={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e,{vgChannel:"strokeWidth"})),h9(e))},B2t={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),h9(e))};function e7(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),ki("angle",e)),z2t(e,n,t))}function z2t(e,t,n){return n?{shape:{value:n}}:ki("shape",e)}const j2t={vgMark:"symbol",encodeEntry:e=>e7(e)},U2t={vgMark:"symbol",encodeEntry:e=>e7(e,"circle")},W2t={vgMark:"symbol",encodeEntry:e=>e7(e,"square")},V2t={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),nh(e,"x","rect")),nh(e,"y","rect"))},q2t={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),XO("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),XO("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),ki("size",e,{vgChannel:"strokeWidth"}))}},H2t={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),f9(e)),ki("size",e,{vgChannel:"fontSize"})),ki("angle",e)),Mve("align",G2t(e.markDef,n,t))),Mve("baseline",K2t(e.markDef,n,t))),ua("radius",e,{defaultPos:null,isMidPoint:!0})),ua("theta",e,{defaultPos:null,isMidPoint:!0}))}};function G2t(e,t,n){if(Fn("align",e,n)===void 0)return"center"}function K2t(e,t,n){if(Fn("baseline",e,n)===void 0)return"middle"}const X2t={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",a=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid",vgChannel:"xc"})),ua("y",e,{defaultPos:"mid",vgChannel:"yc"})),ki("size",e,{defaultValue:Y2t(e),vgChannel:i})),{[a]:jr(Fn("thickness",n,t))})}};function Y2t(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,a=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=Fn("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&Yd(u)&&Qr(u.step)?u.step*3/4:WO(n.view,a)*3/4}}const _I={arc:R2t,area:F2t,bar:M2t,circle:U2t,geoshape:P2t,image:$2t,line:L2t,point:j2t,rect:V2t,rule:q2t,square:W2t,text:H2t,tick:X2t,trail:B2t};function Z2t(e){return bt([pO,dO,qgt],e.mark)?J2t(e):bt([hO],e.mark)?Q2t(e):SI(e)}const gye="faceted_path_";function J2t(e){const t=Vme(e.mark,e.encoding),n=SI(e,{fromPrefix:t.length>0?gye:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:gye+e.requestDataName(sa),data:e.requestDataName(sa),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const mye="stack_group_";function Q2t(e){const t=A8.some(n=>Fn(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=SI(e,{fromPrefix:mye}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),a=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},vw(n.encode.update,["y","yc","y2","height",...A8])),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Lc(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},vw(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Lc(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of A8){const d=cg(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=jr(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Ue(u)?[Ue(u)]:[];return((u==null?void 0:u.bin)||(u==null?void 0:u.timeUnit))&&l.push(Ue(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=cg(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:jr(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(sa),name:mye+e.requestDataName(sa),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}else return SI(e)}function e_t(e){const{encoding:t,stack:n,mark:r,markDef:i,config:a}=e,o=t.order;if(!(!vt(o)&&Hc(o)&&Qpe(o.value)||!o&&Qpe(Fn("order",i,a)))){if((vt(o)||We(o))&&!n)return Bme(o,{expr:"datum"});if(eg(r)){const s=i.orient==="horizontal"?"y":"x",u=t[s];if(We(u)){const l=u.sort;if(vt(l))return{field:Ue(u,{prefix:s,suffix:"sort_index",expr:"datum"})};if(Rl(l))return{field:Ue({aggregate:G8(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(wme(l)){const c=e.fieldDef(l.encoding);return{field:Ue(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Ue(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function SI(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,a=ei(r.clip,t_t(e),n_t(e)),o=$me(r),s=e.encoding.key,u=e_t(e),l=r_t(e),c=Fn("aria",r,i),f=_I[n].postEncodingTransform?_I[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:_I[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(sa)},encode:{update:_I[n].encodeEntry(e)}}),f?{transform:f}:{})]}function t_t(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function n_t(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function r_t(e){if(!e.component.selection)return null;const t=Be(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Be(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class vye extends lye{constructor(t,n,r,i={},a){var o,s;super(t,"unit",n,r,a,void 0,ive(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=_l(t.mark)?t.mark.type:t.mark;this.markDef=T2t(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},a,{graticule:t.data&&c9(t.data)});const l=this.encoding=P0t((s=t.encoding)!==null&&s!==void 0?s:{},this.markDef,a);this.size=k2t({encoding:l,size:ive(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=fve(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===hge,r=t&&hmt.some(i=>It(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return EO.reduce((r,i)=>{var a;const o=pi(n[i]);return o&&(r[i]=(a=o.scale)!==null&&a!==void 0?a:{}),r},{})}initAxes(t){return Es.reduce((n,r)=>{const i=t[r];if(It(i)||r===wr&&It(t.x2)||r===hi&&It(t.y2)){const a=It(i)?i.axis:void 0;n[r]=a&&Object.assign({},a)}return n},{})}initLegend(t){return wmt.reduce((n,r)=>{const i=pi(t[r]);if(i&&Smt(r)){const a=i.legend;n[r]=a&&Object.assign({},a)}return n},{})}parseData(){this.component.data=wI(this)}parseLayoutSize(){c2t(this)}parseSelections(){this.component.selection=txt(this,this.selection)}parseMarkGroup(){this.component.mark=Z2t(this)}parseAxesAndHeaders(){this.component.axes=b2t(this)}assembleSelectionTopLevelSignals(t){return Ibt(this,t)}assembleSignals(){return[...h0e(this),...Tbt(this,[])]}assembleSelectionData(t){return Nbt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return P9(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!D0(this.parent))&&(n=Hve(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return fg(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Ml(n)}typedFieldDef(t){const n=this.fieldDef(t);return Ko(n)?n:null}}class t7 extends Y9{constructor(t,n,r,i,a){super(t,"layer",n,r,a,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(VO(s))return new t7(s,this,this.getName("layer_"+u),o,a);if(Bc(s))return new vye(s,this,this.getName("layer_"+u),o,a);throw new Error(y8(s))})}parseData(){this.component.data=wI(this);for(const t of this.children)t.parseData()}parseLayoutSize(){u2t(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){w2t(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),h0e(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),P9(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Dbt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),L0e(this))}}function n7(e,t,n,r,i){if(RO(e))return new Zw(e,t,n,i);if(VO(e))return new t7(e,t,n,r,i);if(Bc(e))return new vye(e,t,n,r,i);if(ryt(e))return new g2t(e,t,n,i);throw new Error(y8(e))}function i_t(e,t={}){t.logger&&_vt(t.logger),t.fieldTitle&&Nme(t.fieldTitle);try{const n=uve(Zpe(t.config,e.config)),r=bve(e,n),i=n7(r,null,"",void 0,n);return i.parse(),Ewt(i.component.data,i),{spec:o_t(i,a_t(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Svt(),t.fieldTitle&&O0t()}}function a_t(e,t,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Xt(t)&&(t={type:t}),i&&a&&Myt(t.type)){if(i==="step"&&a==="step")Me(Rge()),t.type="pad";else if(i==="step"||a==="step"){const o=i==="step"?"width":"height";Me(Rge(SO(o)));const s=o==="width"?"height":"width";t.type=Pyt(s)}}return Object.assign(Object.assign(Object.assign({},Be(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),wve(n)),wve(e))}function o_t(e,t,n={},r){const i=e.config?gyt(e.config):void 0,a=[].concat(e.assembleSelectionData([]),i2t(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class s_t extends lve{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:a,timeUnits:o,aggregate:s,groupby:u,encoding:l}=K8(r,n),c=[...i||[],...a,...o,...s.length===0?[]:[{aggregate:s,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const u_t=new s_t;function l_t(e,t){return u_t.map(e,{config:t})}const c_t=mgt.version;var f_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",normalize:bve,version:c_t,compile:i_t,extractTransforms:l_t});function yye(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var d_t="vega-themes",h_t="2.10.0",p_t="Themes for stylized Vega and Vega-Lite visualizations.",g_t=["vega","vega-lite","themes","style"],m_t="BSD-3-Clause",v_t={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},y_t=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],b_t="build/vega-themes.js",x_t="build/vega-themes.module.js",w_t="build/vega-themes.min.js",__t="build/vega-themes.min.js",S_t="build/vega-themes.module.d.ts",E_t={type:"git",url:"https://github.com/vega/vega-themes.git"},A_t=["src","build"],C_t={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},k_t={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},T_t={vega:"*","vega-lite":"*"},O_t={name:d_t,version:h_t,description:p_t,keywords:g_t,license:m_t,author:v_t,contributors:y_t,main:b_t,module:x_t,unpkg:w_t,jsdelivr:__t,types:S_t,repository:E_t,files:A_t,scripts:C_t,devDependencies:k_t,peerDependencies:T_t};const F0="#fff",I_t="#888",N_t={background:"#333",title:{color:F0,subtitleColor:F0},style:{"guide-label":{fill:F0},"guide-title":{fill:F0}},axis:{domainColor:F0,gridColor:I_t,tickColor:F0}},wg="#4572a7",D_t={background:"#fff",arc:{fill:wg},area:{fill:wg},line:{stroke:wg,strokeWidth:2},path:{stroke:wg},rect:{fill:wg},shape:{stroke:wg},symbol:{fill:wg,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},_g="#30a2da",r7="#cbcbcb",R_t="#999",F_t="#333",bye="#f0f0f0",xye="#333",M_t={arc:{fill:_g},area:{fill:_g},axis:{domainColor:r7,grid:!0,gridColor:r7,gridWidth:1,labelColor:R_t,labelFontSize:10,titleColor:F_t,tickColor:r7,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:bye,group:{fill:bye},legend:{labelColor:xye,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:xye,titleFontSize:14,titlePadding:10},line:{stroke:_g,strokeWidth:2},path:{stroke:_g,strokeWidth:.5},rect:{fill:_g},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:_g},bar:{binSpacing:2,fill:_g,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Sg="#000",P_t={group:{fill:"#e5e5e5"},arc:{fill:Sg},area:{fill:Sg},line:{stroke:Sg},path:{stroke:Sg},rect:{fill:Sg},shape:{stroke:Sg},symbol:{fill:Sg,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},$_t=22,L_t="normal",wye="Benton Gothic, sans-serif",_ye=11.5,B_t="normal",Eg="#82c6df",i7="Benton Gothic Bold, sans-serif",Sye="normal",Eye=13,Jw={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},z_t={background:"#ffffff",title:{anchor:"start",color:"#000000",font:i7,fontSize:$_t,fontWeight:L_t},arc:{fill:Eg},area:{fill:Eg},line:{stroke:Eg,strokeWidth:2},path:{stroke:Eg},rect:{fill:Eg},shape:{stroke:Eg},symbol:{fill:Eg,size:30},axis:{labelFont:wye,labelFontSize:_ye,labelFontWeight:B_t,titleFont:i7,titleFontSize:Eye,titleFontWeight:Sye},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:wye,labelFontSize:_ye,symbolType:"square",titleFont:i7,titleFontSize:Eye,titleFontWeight:Sye},range:{category:Jw["category-6"],diverging:Jw["fireandice-6"],heatmap:Jw["fire-7"],ordinal:Jw["fire-7"],ramp:Jw["fire-7"]}},Ag="#ab5787",EI="#979797",j_t={background:"#f9f9f9",arc:{fill:Ag},area:{fill:Ag},line:{stroke:Ag},path:{stroke:Ag},rect:{fill:Ag},shape:{stroke:Ag},symbol:{fill:Ag,size:30},axis:{domainColor:EI,domainWidth:.5,gridWidth:.2,labelColor:EI,tickColor:EI,tickWidth:.2,titleColor:EI},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Cg="#3e5c69",U_t={background:"#fff",arc:{fill:Cg},area:{fill:Cg},line:{stroke:Cg},path:{stroke:Cg},rect:{fill:Cg},shape:{stroke:Cg},symbol:{fill:Cg},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ks="#1696d2",Aye="#000000",W_t="#FFFFFF",AI="Lato",a7="Lato",V_t="Lato",q_t="#DEDDDD",H_t=18,Qw={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},G_t={background:W_t,title:{anchor:"start",fontSize:H_t,font:AI},axisX:{domain:!0,domainColor:Aye,domainWidth:1,grid:!1,labelFontSize:12,labelFont:a7,labelAngle:0,tickColor:Aye,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:AI},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:q_t,gridWidth:1,labelFontSize:12,labelFont:a7,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:AI,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:a7,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:AI,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Qw["six-groups-cat-1"],diverging:Qw["diverging-colors"],heatmap:Qw["diverging-colors"],ordinal:Qw["six-groups-seq"],ramp:Qw["shades-blue"]},area:{fill:ks},rect:{fill:ks},line:{color:ks,stroke:ks,strokeWidth:5},trail:{color:ks,stroke:ks,strokeWidth:0,size:1},path:{stroke:ks,strokeWidth:.5},point:{filled:!0},text:{font:V_t,color:ks,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ks,stroke:null}},arc:{fill:ks},shape:{stroke:ks},symbol:{fill:ks,size:30}},kg="#3366CC",Cye="#ccc",CI="Arial, sans-serif",K_t={arc:{fill:kg},area:{fill:kg},path:{stroke:kg},rect:{fill:kg},shape:{stroke:kg},symbol:{stroke:kg},circle:{fill:kg},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:CI,fontSize:12},"guide-title":{font:CI,fontSize:12},"group-title":{font:CI,fontSize:12}},title:{font:CI,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Cye,tickColor:Cye,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},X_t=O_t.version;var Y_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:N_t,excel:D_t,fivethirtyeight:M_t,ggplot2:P_t,googlecharts:K_t,latimes:z_t,quartz:j_t,urbaninstitute:G_t,version:X_t,vox:U_t}),Z_t=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const kye="vg-tooltip-element",J_t={offsetX:10,offsetY:10,id:kye,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:Q_t,maxDepth:2};function Q_t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function eSt(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return Z_t.toString().replace(kye,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function tSt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function nSt(e,t,n){if(ut(e))return`[${e.map(r=>t(Bn(r)?r:Tye(r,n))).join(", ")}]`;if(Nt(e)){let r="";const i=e,{title:a,image:o}=i,s=tSt(i,["title","image"]);a&&(r+=`<h2>${t(a)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Nt(c)&&(c=Tye(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function rSt(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function Tye(e,t){return JSON.stringify(e,rSt(t))}function iSt(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}class aSt{constructor(t){this.options=Object.assign(Object.assign({},J_t),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=eSt(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=nSt(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=iSt(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function kI(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function oSt(e,t,n){const r=e.open(t),i=1e4,a=250,{origin:o}=new URL(t);let s=~~(i/a);function u(c){c.source===r&&(s=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){s<=0||(r.postMessage(n,o),setTimeout(l,a),s-=1)}setTimeout(l,a)}var sSt=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function Oye(e,...t){for(const n of t)uSt(e,n);return e}function uSt(e,t){for(const n of Object.keys(t))WA(e,n,t[n],!0)}var o7;const Qc=Kpt;let M0=f_t;const TI=typeof window!="undefined"?window:void 0;M0===void 0&&((o7=TI==null?void 0:TI.vl)===null||o7===void 0?void 0:o7.compile)&&(M0=TI.vl);const Iye={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},lSt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},e2={vega:"Vega","vega-lite":"Vega-Lite"},OI={vega:Qc.version,"vega-lite":M0?M0.version:"not available"},cSt={vega:e=>e,"vega-lite":(e,t)=>M0.compile(e,{config:t}).spec},fSt=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,dSt="chart-wrapper";function hSt(e){return typeof e=="function"}function Nye(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+a),o.document.title=`${e2[r]} JSON Source`}function Dye(e,t){var n;if(e.$schema){const r=yye(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${e2[r.library]}, but mode argument sets ${(n=e2[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return fre.satisfies(OI[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${e2[i]} ${r.version}, but the current version of ${e2[i]} is v${OI[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function pSt(e){return!!(e&&"load"in e)}function Rye(e){return pSt(e)?e:Qc.loader(e)}function Fye(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function gSt(e,t,n={}){var r,i,a;return kI(this,void 0,void 0,function*(){let o,s;Bn(t)?(s=Rye(n.loader),o=JSON.parse(yield s.load(t))):o=t;const u=Fye(o).loader;(!s||u)&&(s=Rye((r=n.loader)!==null&&r!==void 0?r:u));const l=yield Mye(Fye(o),s),c=yield Mye(n,s),f=Object.assign(Object.assign({},Oye(c,l)),{config:UA((i=c.config)!==null&&i!==void 0?i:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield vSt(e,o,f,s)})}function Mye(e,t){var n;return kI(this,void 0,void 0,function*(){const r=Bn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=Bn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function mSt(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function vSt(e,t,n={},r){var i,a,o,s,u,l;return kI(this,void 0,void 0,function*(){const c=n.theme?UA(Y_t[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=EL(n.actions)?n.actions:Oye({},Iye,(a=n.actions)!==null&&a!==void 0?a:{}),d=Object.assign(Object.assign({},lSt),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(s=n.logLevel)!==null&&s!==void 0?s:Qc.Warn,g=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:T,rootContainer:I}=mSt(m);if(!T.getElementById(k)){const N=document.createElement("style");N.id=k,N.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?sSt.toString():n.defaultStyle,I.appendChild(N)}}const v=Dye(t,n.mode);let y=cSt[v](t,c);if(v==="vega-lite"&&y.$schema){const k=yye(y.$schema);fre.satisfies(OI.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${OI.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const k=document.createElement("div");k.classList.add(dSt),m.appendChild(k),b=k}const x=n.patch;x&&(x instanceof Function?y=x(y):y=AA(y,x,!0,!1).newDocument),n.formatLocale&&Qc.formatLocale(n.formatLocale),n.timeFormatLocale&&Qc.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,S=Qc.parse(y,v==="vega-lite"?{}:c,{ast:w}),A=new(n.viewClass||Qc.View)(S,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:Qc.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;hSt(n.tooltip)?k=n.tooltip:k=new aSt(n.tooltip===!0?{}:n.tooltip).call,A.tooltip(k)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:k,updateSet:T}=typeof _=="boolean"?{}:_;A.hover(k,T)}n&&(n.width!=null&&A.width(n.width),n.height!=null&&A.height(n.height),n.padding!=null&&A.padding(n.padding)),yield A.initialize(b,n.bind).runAsync();let E;if(f!==!1){let k=m;if(n.defaultStyle!==!1){const I=document.createElement("details");I.title=d.CLICK_TO_VIEW_ACTIONS,m.append(I),k=I;const N=document.createElement("summary");N.innerHTML=fSt,I.append(N),E=O=>{I.contains(O.target)||I.removeAttribute("open")},document.addEventListener("click",E)}const T=document.createElement("div");if(k.append(T),T.classList.add("vega-actions"),f===!0||f.export!==!1){for(const I of["svg","png"])if(f===!0||f.export===!0||f.export[I]){const N=d[`${I.toUpperCase()}_ACTION`],O=document.createElement("a");O.text=N,O.href="#",O.target="_blank",O.download=`${g}.${I}`,O.addEventListener("mousedown",function(D){return kI(this,void 0,void 0,function*(){D.preventDefault();const L=yield A.toImageURL(I,n.scaleFactor);this.href=L})}),T.append(O)}}if(f===!0||f.source!==!1){const I=document.createElement("a");I.text=d.SOURCE_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;Nye(tL(t),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"",v),N.preventDefault()}),T.append(I)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const I=document.createElement("a");I.text=d.COMPILED_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;Nye(tL(y),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"","vega"),N.preventDefault()}),T.append(I)}if(f===!0||f.editor!==!1){const I=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",N=document.createElement("a");N.text=d.EDITOR_ACTION,N.href="#",N.addEventListener("click",function(O){oSt(window,I,{config:c,mode:v,renderer:h,spec:tL(t)}),O.preventDefault()}),T.append(N)}}function C(){E&&document.removeEventListener("click",E),A.finalize()}return{view:A,spec:t,vgSpec:y,finalize:C}})}var ySt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:gSt,DEFAULT_ACTIONS:Iye,guessMode:Dye,vega:Qc,get vegaLite(){return M0}}),P0=vh(ySt),Ts={},Le={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Pye=Object.getOwnPropertySymbols,bSt=Object.prototype.hasOwnProperty,xSt=Object.prototype.propertyIsEnumerable;function wSt(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function _St(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(a){return!1}}var s7=_St()?Object.assign:function(e,t){for(var n,r=wSt(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)bSt.call(n,o)&&(r[o]=n[o]);if(Pye){i=Pye(n);for(var s=0;s<i.length;s++)xSt.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},u7={};Object.defineProperty(u7,"__esModule",{value:!0}),u7.StyleSheet=Bye;var SSt=s7,ESt=ASt(SSt);function ASt(e){return e&&e.__esModule?e:{default:e}}function CSt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function l7(e){return e[e.length-1]}function $ye(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var Tg=typeof window!="undefined",kSt=!1,TSt=function(){if(Tg){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function Lye(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function Bye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!kSt:t,r=e.maxLength,i=r===void 0?Tg&&TSt?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,ESt.default)(Bye.prototype,{getSheet:function(){return $ye(l7(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");Tg?this.tags[0]=Lye():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch(r){}},insert:function(t){if(Tg)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=l7(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else l7(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,Tg&&this.ctr%this.maxLength==0&&this.tags.push(Lye()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){Tg?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!Tg)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(CSt(Array.from($ye(n).cssRules))))}),t}});var $0={},OSt=/-(.)/g;function ISt(e){return e.replace(OSt,function(t,n){return n.toUpperCase()})}var NSt=ISt,DSt=NSt,RSt=/^-ms-/;function FSt(e){return DSt(e.replace(RSt,"ms-"))}var MSt=FSt,c7={},f7={};Object.defineProperty(f7,"__esModule",{value:!0});var II={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function PSt(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var $St=["Webkit","ms","Moz","O"];Object.keys(II).forEach(function(e){$St.forEach(function(t){II[PSt(t,e)]=II[e]})});var LSt={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},BSt={isUnitlessNumber:II,shorthandPropertyExpansions:LSt};f7.default=BSt;function NI(e){return function(){return e}}var Og=function(){};Og.thatReturns=NI,Og.thatReturnsFalse=NI(!1),Og.thatReturnsTrue=NI(!0),Og.thatReturnsNull=NI(null),Og.thatReturnsThis=function(){return this},Og.thatReturnsArgument=function(e){return e};var zSt=Og,jSt=zSt,USt=jSt,zye=USt;Object.defineProperty(c7,"__esModule",{value:!0});var WSt=f7,VSt=jye(WSt),qSt=zye;jye(qSt);function jye(e){return e&&e.__esModule?e:{default:e}}var Uye=VSt.default.isUnitlessNumber;function HSt(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||Uye.hasOwnProperty(e)&&Uye[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}c7.default=HSt;var GSt=/([A-Z])/g;function KSt(e){return e.replace(GSt,"-$1").toLowerCase()}var XSt=KSt,YSt=XSt,ZSt=/^ms-/;function JSt(e){return YSt(e).replace(ZSt,"-ms-")}var QSt=JSt;function eEt(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var tEt=eEt;Object.defineProperty($0,"__esModule",{value:!0}),$0.processStyleName=void 0,$0.createMarkupForStyles=fEt;var nEt=MSt;t2(nEt);var rEt=c7,iEt=t2(rEt),aEt=QSt,oEt=t2(aEt),sEt=tEt,uEt=t2(sEt),lEt=zye;t2(lEt);function t2(e){return e&&e.__esModule?e:{default:e}}var cEt=$0.processStyleName=(0,uEt.default)(oEt.default);function fEt(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var a=e[r];a!=null&&(i?n+=r+":"+a+";":(n+=cEt(r)+":",n+=(0,iEt.default)(r,a,t)+";"))}}return n||null}var d7={};Object.defineProperty(d7,"__esModule",{value:!0});var Wye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};d7.default=h7;function dEt(e){return e==null||e===!1||(typeof e=="undefined"?"undefined":Wye(e))==="object"&&Object.keys(e).length===0}function hEt(e){if(dEt(e))return null;if((typeof e=="undefined"?"undefined":Wye(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var a=e[n[i]],o=h7(a);(o===null||o!==a)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function pEt(e){var t=!1,n=[];return e.forEach(function(r){var i=h7(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function h7(e){return Array.isArray(e)?pEt(e):hEt(e)}var L0={},p7={},g7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(g7,g7.exports);var m7={exports:{}},DI={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(DI,DI.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=DI.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u){if(o.hasOwnProperty(s))for(var l=o[s],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(s)]=u[s]}e.exports=t.default}(m7,m7.exports);var v7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,a,o,s){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,a,o,s);if(c)return c}}e.exports=t.default})(v7,v7.exports);var y7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(a,o){if(a==="cursor"&&r.hasOwnProperty(o))return n.map(function(s){return s+o})}e.exports=t.default})(y7,y7.exports);var b7={exports:{}},Ig={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(Ig,Ig.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ig.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return a.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(b7,b7.exports);var x7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ig.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return a.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(x7,x7.exports);var w7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,a){if(i==="display"&&n.hasOwnProperty(a))return n[a]}e.exports=t.default})(w7,w7.exports);var _7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(a,o,s){a==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?s.WebkitBoxOrient="vertical":s.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?s.WebkitBoxDirection="reverse":s.WebkitBoxDirection="normal"),r.hasOwnProperty(a)&&(s[r[a]]=n[o]||o)}e.exports=t.default})(_7,_7.exports);var S7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=Ig.exports,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var a=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function s(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return a.map(function(c){return c+l})}e.exports=t.default})(S7,S7.exports);var E7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Ig.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return a.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(E7,E7.exports);var A7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(A7,A7.exports);var C7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function a(o,s){if(r.hasOwnProperty(o)&&i.hasOwnProperty(s))return n.map(function(u){return u+s})}e.exports=t.default})(C7,C7.exports);var k7={exports:{}},T7={exports:{}},gEt=/[A-Z]/g,mEt=/^ms-/,O7={};function vEt(e){return"-"+e.toLowerCase()}function yEt(e){if(O7.hasOwnProperty(e))return O7[e];var t=e.replace(gEt,vEt);return O7[e]=mEt.test(t)?"-"+t:t}var bEt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:yEt}),xEt=vh(bEt);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=xEt,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return(0,r.default)(o)}e.exports=t.default})(T7,T7.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=T7.exports,r=u(n),i=Ig.exports,a=u(i),o=DI.exports,s=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,a.default)(h))return h;for(var g=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var S=p[x],A=0,_=S.length;A<_;++A)b.unshift(y.replace(w,c[S[A]]+w))}g[m]=b.join(",")}return g.join(",")}function d(h,p,g,m){if(typeof p=="string"&&l.hasOwnProperty(h)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?b:(g["Webkit"+(0,s.default)(h)]=y,g["Moz"+(0,s.default)(h)]=b,v)}}e.exports=t.default}(k7,k7.exports),Object.defineProperty(p7,"__esModule",{value:!0}),p7.default=KEt;var wEt=g7.exports,_Et=Zo(wEt),SEt=m7.exports,EEt=Zo(SEt),AEt=v7.exports,CEt=Zo(AEt),kEt=y7.exports,TEt=Zo(kEt),OEt=b7.exports,IEt=Zo(OEt),NEt=x7.exports,DEt=Zo(NEt),REt=w7.exports,FEt=Zo(REt),MEt=_7.exports,PEt=Zo(MEt),$Et=S7.exports,LEt=Zo($Et),BEt=E7.exports,zEt=Zo(BEt),jEt=A7.exports,UEt=Zo(jEt),WEt=C7.exports,VEt=Zo(WEt),qEt=k7.exports,HEt=Zo(qEt);function Zo(e){return e&&e.__esModule?e:{default:e}}var GEt=[IEt.default,TEt.default,DEt.default,PEt.default,LEt.default,zEt.default,UEt.default,VEt.default,HEt.default,FEt.default],Vye=_Et.default.prefixMap;function KEt(e){for(var t in e){var n=e[t],r=(0,CEt.default)(GEt,t,n,e,Vye);r&&(e[t]=r),(0,EEt.default)(Vye,t,e)}return e}Object.defineProperty(L0,"__esModule",{value:!0});var I7=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};L0.PluginSet=Hye,L0.fallbacks=eAt,L0.contentWrap=nAt,L0.prefixes=rAt;var XEt=s7,N7=qye(XEt),YEt=$0,ZEt=p7,JEt=qye(ZEt);function qye(e){return e&&e.__esModule?e:{default:e}}var QEt=function(e){return e==="development"||!e}("production");function Hye(e){this.fns=e||[]}(0,N7.default)(Hye.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(a){t.fns.indexOf(a)>=0?QEt&&console.warn("adding the same plugin again, ignoring"):t.fns=[a].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function eAt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,a){return i[a]=Array.isArray(n[a])?n[a].join("; "+(0,YEt.processStyleName)(a)+": "):n[a],i},{});return(0,N7.default)({},e,{style:r})}return e}var tAt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function nAt(e){if(e.style.content){var t=e.style.content;return tAt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:I7({},e,{style:I7({},e.style,{content:'"'+t+'"'})})}return e}function rAt(e){return(0,N7.default)({},e,{style:(0,JEt.default)(I7({},e.style))})}var D7={};Object.defineProperty(D7,"__esModule",{value:!0}),D7.default=iAt;function iAt(e,t){for(var n=1540483477,r=24,i=t^e.length,a=e.length,o=0;a>=4;){var s=aAt(e,o);s=Ng(s,n),s^=s>>>r,s=Ng(s,n),i=Ng(i,n),i^=s,o+=4,a-=4}switch(a){case 3:i^=Gye(e,o),i^=e.charCodeAt(o+2)<<16,i=Ng(i,n);break;case 2:i^=Gye(e,o),i=Ng(i,n);break;case 1:i^=e.charCodeAt(o),i=Ng(i,n);break}return i^=i>>>13,i=Ng(i,n),i^=i>>>15,i>>>0}function aAt(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function Gye(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function Ng(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(Le,"__esModule",{value:!0}),Le.compose=Le.merge=Le.$=Le.style=Le.presets=Le.keyframes=Le.fontFace=Le.insertGlobal=Le.insertRule=Le.plugins=Le.styleSheet=void 0,Le.speedy=dAt,Le.simulations=hAt,Le.simulate=pAt,Le.cssLabels=gAt,Le.isLikeRule=$7,Le.idFor=L7,Le.css=Ti,Le.rehydrate=OAt,Le.flush=IAt,Le.select=j7,Le.parent=DAt,Le.media=RAt,Le.pseudo=kt,Le.active=FAt,Le.any=MAt,Le.checked=PAt,Le.disabled=$At,Le.empty=LAt,Le.enabled=BAt,Le._default=zAt,Le.first=jAt,Le.firstChild=UAt,Le.firstOfType=WAt,Le.fullscreen=VAt,Le.focus=qAt,Le.hover=HAt,Le.indeterminate=GAt,Le.inRange=KAt,Le.invalid=XAt,Le.lastChild=YAt,Le.lastOfType=ZAt,Le.left=JAt,Le.link=QAt,Le.onlyChild=eCt,Le.onlyOfType=tCt,Le.optional=nCt,Le.outOfRange=rCt,Le.readOnly=iCt,Le.readWrite=aCt,Le.required=oCt,Le.right=sCt,Le.root=uCt,Le.scope=lCt,Le.target=cCt,Le.valid=fCt,Le.visited=dCt,Le.dir=hCt,Le.lang=pCt,Le.not=gCt,Le.nthChild=mCt,Le.nthLastChild=vCt,Le.nthLastOfType=yCt,Le.nthOfType=bCt,Le.after=xCt,Le.before=wCt,Le.firstLetter=_Ct,Le.firstLine=SCt,Le.selection=ECt,Le.backdrop=ACt,Le.placeholder=CCt,Le.cssFor=kCt,Le.attribsFor=TCt;var oAt=s7,sAt=F7(oAt),uAt=u7,R7=$0,lAt=d7,uh=F7(lAt),ef=L0,cAt=D7,fAt=F7(cAt);function F7(e){return e&&e.__esModule?e:{default:e}}function n2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jo=Le.styleSheet=new uAt.StyleSheet;Jo.inject();function dAt(e){return Jo.speedy(e)}var r2=Le.plugins=Jo.plugins=new ef.PluginSet([ef.prefixes,ef.contentWrap,ef.fallbacks]);r2.media=new ef.PluginSet,r2.fontFace=new ef.PluginSet,r2.keyframes=new ef.PluginSet([ef.prefixes,ef.fallbacks]);var M7=!1,RI=typeof window!="undefined",P7=M7,Kye=!1,Xye=!1;function hAt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;P7=!!e}function pAt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,uh.default)(t),t?P7?t.reduce(function(r,i){return r["data-simulate-"+FI(i)]="",r},{}):(Kye||(console.warn("can't simulate without once calling simulations(true)"),Kye=!0),Xye||(console.warn("don't use simulation outside dev"),Xye=!0),{}):{}}var i2=M7;function gAt(e){i2=!!e}function FI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function a2(e){var t=JSON.stringify(e),n=(0,fAt.default)(t).toString(36);return e.label&&e.label.length>0&&M7?FI(e.label.join("."),"-")+"-"+n:n}function $7(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function L7(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var mAt=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function B7(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=mAt.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function Yye(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=B7(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return P7&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+FI(t)+"],[data-css-"+e+"][data-simulate-"+FI(t)+"]"),n}function z7(e){var t=e.selector,n=e.style,r=r2.transform({selector:t,style:n});return r.selector+"{"+(0,R7.createMarkupForStyles)(r.style)+"}"}function MI(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(a){a.indexOf("&")>=0?(n=n||{},n[a]=e[a]):a.indexOf("@media")===0?(r=r||{},r[a]=MI(e[a])):a.indexOf("@supports")===0?(i=i||{},i[a]=MI(e[a])):a==="label"?e.label.length>0&&(t=t||{},t.label=i2?e.label.join("."):""):(t=t||{},t[a]=e[a])}),{plain:t,selects:n,medias:r,supports:i}}function PI(e,t){var n=[],r=t.plain,i=t.selects,a=t.medias,o=t.supports;return r&&n.push(z7({style:r,selector:Yye(e)})),i&&Object.keys(i).forEach(function(s){return n.push(z7({style:i[s],selector:Yye(e,s)}))}),a&&Object.keys(a).forEach(function(s){return n.push(s+"{"+PI(e,a[s]).join("")+"}")}),o&&Object.keys(o).forEach(function(s){return n.push(s+"{"+PI(e,o[s]).join("")+"}")}),n}var Tu=Jo.inserted={};function vAt(e){if(!Tu[e.id]){Tu[e.id]=!0;var t=MI(e.style),n=PI(e.id,t);Tu[e.id]=RI?!0:n,n.forEach(function(r){return Jo.insert(r)})}}var o2=Jo.registered={};function $I(e){o2[e.id]||(o2[e.id]=e)}function yAt(e){if($7(e)){var t=o2[L7(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var LI={};function bAt(e){if($I(e),vAt(e),LI[e.id])return LI[e.id];var t=n2({},"data-css-"+e.id,i2&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),LI[e.id]=t,t}function xAt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function Zye(e,t){var n=B7(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=B7(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,a){return i.concat(n.map(function(o){return a.replace(/\&/g,o)}))},[]).join(",")}function wAt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function _At(e){return e.indexOf("@media")===0}function SAt(e){return e.indexOf("@supports")===0}function EAt(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function Jye(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(Jye(e[n])):t=t.concat(e[n]);return t}var Qye={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function Dg(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,a=i===void 0?"":i,o=t.supp,s=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=Jye(l),l.forEach(function(c){if($7(c)){var f=yAt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,uh.default)(c),c&&c.composes&&Dg(e,{selector:r,mq:a,supp:s,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(xAt(d))Qye[d]&&Qye[d].forEach(function(p){return Dg(e,{selector:Zye(r,p),mq:a,supp:s,src:c[d]})}),Dg(e,{selector:Zye(r,d),mq:a,supp:s,src:c[d]});else if(_At(d))Dg(e,{selector:r,mq:wAt(a,d),supp:s,src:c[d]});else if(SAt(d))Dg(e,{selector:r,mq:a,supp:EAt(s,d),src:c[d]});else if(d!=="composes"){var h=e;s&&(h[s]=h[s]||{},h=h[s]),a&&(h[a]=h[a]||{},h=h[a]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?i2&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function ebe(e){var t={label:[]};Dg(t,{src:e});var n={id:a2(t),style:t,label:i2?t.label.join("."):"",type:"css"};return bAt(n)}var BI={};Object.defineProperty(BI,"toString",{enumerable:!1,value:function(){return"css-nil"}});var zI=typeof WeakMap!="undefined"?[BI,new WeakMap,new WeakMap,new WeakMap]:[BI];function AAt(e){return function(t){if(zI[t.length]){for(var n=zI[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(o2[i.toString().substring(4)])return i}}var a=e(t);if(zI[t.length]){for(var o=0,s=zI[t.length];o<t.length-1;)s=s.get(t[o]),o++;try{s.set(t[o],a)}catch(u){}}return a}}var CAt=typeof WeakMap!="undefined"?AAt(ebe):ebe;function Ti(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,uh.default)(t),t?CAt(t):BI}Ti.insert=function(e){var t={id:a2(e),css:e,type:"raw"};$I(t),Tu[t.id]||(Jo.insert(t.css),Tu[t.id]=RI?!0:[t.css])},Le.insertRule=Ti.insert,Ti.global=function(e,t){if(t=(0,uh.default)(t),t)return Ti.insert(z7({selector:e,style:t}))},Le.insertGlobal=Ti.global;function kAt(e){if(!Tu[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=r2.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,R7.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Jo.insert(r)}),Tu[e.id]=RI?!0:n}}Ti.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,uh.default)(t)||{};var n={id:a2({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return $I(n),kAt(n),e+"_"+n.id},Ti.fontFace=function(e){e=(0,uh.default)(e);var t={id:a2(e),type:"font-face",font:e};return $I(t),TAt(t),e.fontFamily},Le.fontFace=Ti.fontFace,Le.keyframes=Ti.keyframes;function TAt(e){if(!Tu[e.id]){var t="@font-face{"+(0,R7.createMarkupForStyles)(e.font)+"}";Jo.insert(t),Tu[e.id]=RI?!0:[t]}}function OAt(e){(0,sAt.default)(Tu,e.reduce(function(t,n){return t[n]=!0,t},{}))}function IAt(){Tu=Jo.inserted={},o2=Jo.registered={},LI={},Jo.flush(),Jo.inject()}Le.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var NAt=Le.style=Ti;function j7(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Ti(n2({},e,n)):NAt(n)}Le.$=j7;function DAt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(n2({},e+" &",n))}Le.merge=Ti,Le.compose=Ti;function RAt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(n2({},"@media "+e,n))}function kt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(n2({},e,n))}function FAt(e){return kt(":active",e)}function MAt(e){return kt(":any",e)}function PAt(e){return kt(":checked",e)}function $At(e){return kt(":disabled",e)}function LAt(e){return kt(":empty",e)}function BAt(e){return kt(":enabled",e)}function zAt(e){return kt(":default",e)}function jAt(e){return kt(":first",e)}function UAt(e){return kt(":first-child",e)}function WAt(e){return kt(":first-of-type",e)}function VAt(e){return kt(":fullscreen",e)}function qAt(e){return kt(":focus",e)}function HAt(e){return kt(":hover",e)}function GAt(e){return kt(":indeterminate",e)}function KAt(e){return kt(":in-range",e)}function XAt(e){return kt(":invalid",e)}function YAt(e){return kt(":last-child",e)}function ZAt(e){return kt(":last-of-type",e)}function JAt(e){return kt(":left",e)}function QAt(e){return kt(":link",e)}function eCt(e){return kt(":only-child",e)}function tCt(e){return kt(":only-of-type",e)}function nCt(e){return kt(":optional",e)}function rCt(e){return kt(":out-of-range",e)}function iCt(e){return kt(":read-only",e)}function aCt(e){return kt(":read-write",e)}function oCt(e){return kt(":required",e)}function sCt(e){return kt(":right",e)}function uCt(e){return kt(":root",e)}function lCt(e){return kt(":scope",e)}function cCt(e){return kt(":target",e)}function fCt(e){return kt(":valid",e)}function dCt(e){return kt(":visited",e)}function hCt(e,t){return kt(":dir("+e+")",t)}function pCt(e,t){return kt(":lang("+e+")",t)}function gCt(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?kt(":not("+e+")",t):j7(n.join(""),t)}function mCt(e,t){return kt(":nth-child("+e+")",t)}function vCt(e,t){return kt(":nth-last-child("+e+")",t)}function yCt(e,t){return kt(":nth-last-of-type("+e+")",t)}function bCt(e,t){return kt(":nth-of-type("+e+")",t)}function xCt(e){return kt("::after",e)}function wCt(e){return kt("::before",e)}function _Ct(e){return kt("::first-letter",e)}function SCt(e){return kt("::first-line",e)}function ECt(e){return kt("::selection",e)}function ACt(e){return kt("::backdrop",e)}function CCt(e){return Ti({"::placeholder":e})}function kCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,uh.default)(t),t?t.map(function(r){var i={label:[]};return Dg(i,{src:r}),PI(a2(i),MI(i)).join("")}).join(""):""}function TCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,uh.default)(t);var r=t?t.map(function(i){L7(i);var a=Object.keys(i)[0],o=i[a];return a+'="'+(o||"")+'"'}).join(" "):"";return r}var Ha={},s2={};Object.defineProperty(s2,"__esModule",{value:!0});function OCt(e){return e.name!=null}s2.isSurfaceInfo=OCt;function ICt(e){return e.drawArea instanceof HTMLElement}s2.isSurface=ICt;var u2={},U7={};function NCt(){}var So={},B0=[],tbe=[];function l2(e,t){var n=tbe,r,i,a,o;for(o=arguments.length;o-- >2;)B0.push(arguments[o]);for(t&&t.children!=null&&(B0.length||B0.push(t.children),delete t.children);B0.length;)if((i=B0.pop())&&i.pop!==void 0)for(o=i.length;o--;)B0.push(i[o]);else typeof i=="boolean"&&(i=null),(a=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(a=!1)),a&&r?n[n.length-1]+=i:n===tbe?n=[i]:n.push(i),r=a;var s=new NCt;return s.nodeName=e,s.children=n,s.attributes=t??void 0,s.key=t==null?void 0:t.key,So.vnode!==void 0&&So.vnode(s),s}function lh(e,t){for(var n in t)e[n]=t[n];return e}var DCt=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function nbe(e,t){return l2(e.nodeName,lh(lh({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var RCt=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,W7=[];function rbe(e){!e._dirty&&(e._dirty=!0)&&W7.push(e)==1&&(So.debounceRendering||DCt)(V7)}function V7(){var e,t=W7;for(W7=[];e=t.pop();)e._dirty&&WI(e)}function FCt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&ibe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function ibe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function abe(e){var t=lh({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function MCt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function q7(e){var t=e.parentNode;t&&t.removeChild(e)}function obe(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]=typeof r[a]=="number"&&RCt.test(a)===!1?r[a]+"px":r[a]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,sbe,o):e.removeEventListener(t,sbe,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)PCt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function PCt(e,t,n){try{e[t]=n}catch(r){}}function sbe(e){return this._listeners[e.type](So.event&&So.event(e)||e)}var ube=[],H7=0,ch=!1,jI=!1;function lbe(){for(var e;e=ube.pop();)So.afterMount&&So.afterMount(e),e.componentDidMount&&e.componentDidMount()}function cbe(e,t,n,r,i,a){H7++||(ch=i!=null&&i.ownerSVGElement!==void 0,jI=e!=null&&!("__preactattr_"in e));var o=fbe(e,t,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--H7||(jI=!1,a||lbe()),o}function fbe(e,t,n,r,i){var a=e,o=ch;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),Rg(e,!0))),a.__preactattr_=!0,a;var s=t.nodeName;if(typeof s=="function")return jCt(e,t,n,r);if(ch=s==="svg"?!0:s==="foreignObject"?!1:ch,s=String(s),(!e||!ibe(e,s))&&(a=MCt(s,ch),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),Rg(e,!0)}var u=a.firstChild,l=a.__preactattr_,c=t.children;if(l==null){l=a.__preactattr_={};for(var f=a.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!jI&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&$Ct(a,c,n,r,jI||l.dangerouslySetInnerHTML!=null),LCt(a,t.attributes,l),ch=o,a}function $Ct(e,t,n,r,i){var a=e.childNodes,o=[],s={},u=0,l=0,c=a.length,f=0,d=t?t.length:0,h,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=a[y],x=b.__preactattr_,w=d&&x?b._component?b._component.__key:x.key:null;w!=null?(u++,s[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(o[f++]=b)}if(d!==0)for(var y=0;y<d;y++){m=t[y],v=null;var w=m.key;if(w!=null)u&&s[w]!==void 0&&(v=s[w],s[w]=void 0,u--);else if(!v&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&FCt(p=o[h],m,i)){v=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}v=fbe(v,m,n,r),g=a[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?q7(g):e.insertBefore(v,g))}if(u)for(var y in s)s[y]!==void 0&&Rg(s[y],!1);for(;l<=f;)(v=o[f--])!==void 0&&Rg(v,!1)}function Rg(e,t){var n=e._component;n?VI(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&q7(e),dbe(e))}function dbe(e){for(e=e.lastChild;e;){var t=e.previousSibling;Rg(e,!0),e=t}}function LCt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&obe(e,r,n[r],n[r]=void 0,ch);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&obe(e,r,n[r],n[r]=t[r],ch)}var G7={};function BCt(e){var t=e.constructor.name;(G7[t]||(G7[t]=[])).push(e)}function hbe(e,t,n){var r=G7[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),c2.call(i,t,n)):(i=new c2(t,n),i.constructor=e,i.render=zCt),r){for(var a=r.length;a--;)if(r[a].constructor===e){i.nextBase=r[a].nextBase,r.splice(a,1);break}}return i}function zCt(e,t,n){return this.constructor(e,n)}function UI(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||So.syncComponentUpdates!==!1||!e.base?WI(e,1,i):rbe(e)),e.__ref&&e.__ref(e))}function WI(e,t,n,r){if(!e._disable){var i=e.props,a=e.state,o=e.context,s=e.prevProps||i,u=e.prevState||a,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,g,m,v;if(c&&(e.props=s,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,a,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,a,o),e.props=i,e.state=a,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,a,o),e.getChildContext&&(o=lh(lh({},o),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=abe(g);m=h,m&&m.constructor===y&&w.key==m.__key?UI(m,w,1,o,!1):(b=m,e._component=m=hbe(y,w,o),m.nextBase=m.nextBase||f,m._parentComponent=e,UI(m,w,0,o,!1),WI(m,1,n,!0)),x=m.base}else v=d,b=h,b&&(v=e._component=null),(d||t===1)&&(v&&(v._component=null),x=cbe(v,g,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&m!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),b||(d._component=null,Rg(d,!1)))}if(b&&VI(b),e.base=x,x&&!r){for(var A=e,_=e;_=_._parentComponent;)(A=_).base=x;x._component=A,x._componentConstructor=A.constructor}}if(!c||n?ube.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(s,u,l),So.afterUpdate&&So.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!H7&&!r&&lbe()}}function jCt(e,t,n,r){for(var i=e&&e._component,a=i,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=abe(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(UI(i,l,3,n,r),e=i.base):(a&&!s&&(VI(a),e=o=null),i=hbe(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),UI(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Rg(o,!1))),e}function VI(e){So.beforeUnmount&&So.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?VI(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,q7(t),BCt(e),dbe(t)),e.__ref&&e.__ref(null)}function c2(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}lh(c2.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=lh({},r)),lh(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),rbe(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),WI(this,2)},render:function(){}});function pbe(e,t,n){return cbe(n,e,{},!1,t,!1)}var UCt={h:l2,createElement:l2,cloneElement:nbe,Component:c2,render:pbe,rerender:V7,options:So},WCt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:UCt,h:l2,createElement:l2,cloneElement:nbe,Component:c2,render:pbe,rerender:V7,options:So}),K7=vh(WCt),X7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(X7,"__esModule",{value:!0});const qI=K7,Y7=Le;class z0 extends qI.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},z0.defaultStyles,r),{width:a,height:o}=i;let{maxHeight:s,maxWidth:u}=i;s=o===z0.defaultStyles.height?s:o,u=a===z0.defaultStyles.width?u:a;const l=Y7.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:a,maxHeight:s,maxWidth:u,overflow:"auto"}),c=Y7.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=Y7.css({boxSizing:"border-box"});return qI.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},qI.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),qI.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}z0.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},X7.SurfaceComponent=z0;var Z7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Z7,"__esModule",{value:!0});const f2=K7,gbe=Le;class VCt extends f2.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>f2.h(qCt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,a=gbe.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return f2.h("div",{className:`${a} visor-tabs`},i)}}Z7.Tabs=VCt;class qCt extends f2.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,a=gbe.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return f2.h("a",{className:`${a} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(U7,"__esModule",{value:!0});const Ou=K7,Fg=Le,HCt=X7,GCt=Z7;class J7 extends Ou.Component{static render(t,n,r){return Ou.render(Ou.h(J7,Object.assign({},r)),t,n)}constructor(t){super(t);this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(a=>a.tab),r=this.state.tabs;let i;for(const a of n)r.has(a)||(r.add(a),i=a);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){const n=192;t.keyCode===n&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,a=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=Fg.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=Fg.css({right:"0"}),f=Fg.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=Fg.css({});return Ou.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},Ou.h(KCt,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),Ou.h(GCt.Tabs,{tabNames:a,activeTab:r,handleClick:this.setActiveTab.bind(this)}),Ou.h("div",{className:`${h} visor-surfaces`},i.map(p=>Ou.h(HCt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}U7.VisorComponent=J7;function KCt(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=Fg.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),a=Fg.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=Fg.css({marginLeft:"auto"});return Ou.h("div",{className:`${i} visor-controls`},Ou.h("button",{className:`${a}`,onClick:n},t?"Minimize":"Maximize"),Ou.h("button",{className:`${a} ${o}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(u2,"__esModule",{value:!0});const XCt=U7;let HI;const YCt="Visor",Q7="tfjs-visor-container";function ZCt(){if(typeof document=="undefined")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(Q7)&&HI!=null)return HI;let e=document.getElementById(Q7);e==null&&(e=document.createElement("div"),e.id=Q7,document.body.appendChild(e));let t;function n(a,o){let s=null;return t=XCt.VisorComponent.render(a,t,{ref:u=>s=u,surfaceList:Array.from(o.values())}),s}const r=new Map,i=n(e,r);return HI=new mbe(i,e,r,n),HI}u2.visor=ZCt;class mbe{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?YCt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),a=`${n}-${r}`;return this.surfaceList.has(a)||this.surfaceList.set(a,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}u2.Visor=mbe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var JCt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ha,"__esModule",{value:!0});const vbe=s2,QCt=u2;function ekt(e){if(e instanceof HTMLElement)return e;if(vbe.isSurface(e))return e.drawArea;if(vbe.isSurfaceInfo(e))return QCt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Ha.getDrawArea=ekt;function tkt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a])return!1}return!0}Ha.shallowEquals=tkt;function nkt(){return JCt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Ha.nextFrame=nkt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Ts,"__esModule",{value:!0});const ybe=Le,rkt=Ha,ikt={prepend:!1};function akt(e,t,n={}){const r=rkt.getDrawArea(e),i=ybe.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),a=ybe.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},ikt,n);let s=r.querySelector(`div[data-name=${t}]`);if(!s){if(s=document.createElement("div"),s.setAttribute("class",`${i}`),s.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${a}`),u.innerText=o.title,s.appendChild(u)}o.prepend?r.insertBefore(s,r.firstChild):r.appendChild(s)}return s}Ts.subSurface=akt;function okt(e){const t=50;let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=t;return r.clientWidth-n}Ts.getDefaultWidth=okt;function skt(e){return e.clientHeight===0?200:e.clientHeight}Ts.getDefaultHeight=skt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ukt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},lkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(G$,"__esModule",{value:!0});const ckt=lkt(P0),bbe=Ts,GI=Ha;function fkt(e,t,n={}){return ukt(this,void 0,void 0,function*(){const r=GI.getDrawArea(e),i=t,a=Object.assign({},dkt,n);if(eU.has(r)){const m=eU.get(r);if(GI.shallowEquals(a,m.lastOptions)){yield GI.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:o,yLabel:s,xType:u,yType:l}=a;let c=null;o!=null&&(c={title:o});let f=null;s!=null&&(f={title:s});const d={actions:!1,mode:"vega-lite",defaultStyle:!1};let h;a.color!=null?Array.isArray(a.color)?h={field:"index",type:"nominal",scale:{range:a.color}}:h={value:a.color}:h={value:"#4C78A0"};const p={width:a.width||bbe.getDefaultWidth(r),height:a.height||bbe.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f},color:h}};yield GI.nextFrame();const g=yield ckt.default(r,p,d);eU.set(r,{view:g.view,lastOptions:a})})}G$.barchart=fkt;const dkt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},eU=new Map;var tU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hkt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},pkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tU,"__esModule",{value:!0});const gkt=pkt(P0),xbe=Ts,mkt=Ha;function vkt(e,t,n={}){return hkt(this,void 0,void 0,function*(){const r=Object.assign({},ykt,n),i=mkt.getDrawArea(e),a=[],o=t.values,s=t.tickLabels||[],u=s.length===0;let l=!0;for(let h=0;h<o.length;h++){const p=u?`Class ${h}`:s[h];u&&s.push(p);for(let g=0;g<o[h].length;g++){const m=u?`Class ${g}`:s[g],v=o[h][g];h===g&&!r.shadeDiagonal?a.push({label:p,prediction:m,count:v,noFill:!0}):(a.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const h of a)h.noFill===!0&&(h.noFill=!1,h.scaleCount=h.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||xbe.getDefaultWidth(i),height:r.height||xbe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:a},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:s}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:s}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield gkt.default(i,f,c)})}tU.confusionMatrix=vkt;const ykt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var nU={},tf={};Object.defineProperty(tf,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}tf.assert=wbe;function bkt(e,t,n=""){wbe(_be(e,t),n+` Shapes ${e} and ${t} must match`)}tf.assertShapesMatch=bkt;function _be(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}tf.arraysEqual=_be,tf.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},xkt=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},wkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nU,"__esModule",{value:!0});const d2=xkt(jte),_kt=wkt(P0),Ebe=Ts,h2=tf,Skt=Ha;function Ekt(e,t,n={}){return Sbe(this,void 0,void 0,function*(){const r=Object.assign({},Ckt,n),i=Skt.getDrawArea(e);let a=t.values;r.rowMajor&&(a=yield Akt(t.values));const{xTickLabels:o,yTickLabels:s}=t;o!=null&&Abe(a,o,0),s!=null&&Abe(a,s,1);const u="@tfidx@",l=[];if(a instanceof d2.Tensor){h2.assert(a.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield a.data(),[m,v]=a.shape;for(let y=0;y<m;y++){const b=o?`${o[y]}${u}${y}`:y;for(let x=0;x<v;x++){const w=s?`${s[x]}${u}${x}`:x,S=y*v+x,A=g[S];l.push({x:b,y:w,value:A})}}}else{const g=a;for(let m=0;m<g.length;m++){const v=o?`${o[m]}${u}${m}`:m;for(let y=0;y<g[m].length;y++){const b=s?`${s[y]}${u}${y}`:y,x=g[m][y];l.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Ebe.getDefaultWidth(i),height:r.height||Ebe.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:l},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${u}\\d+$`,h=new RegExp(d);o&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),s&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(o||s)&&(c.tooltip={sanitize:g=>String(g).replace(h,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield _kt.default(i,f,c)})}nU.heatmap=Ekt;function Akt(e){return Sbe(this,void 0,void 0,function*(){let t,n;e instanceof d2.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=d2.tidy(()=>d2.tensor2d(e).transpose())),h2.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return h2.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function Abe(e,t,n){const r=e instanceof d2.Tensor?e.shape:[e.length,e[0].length];n===0?h2.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&h2.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const Ckt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var p2={},Cbe=vh(fJe),jl={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var KI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(jl,"__esModule",{value:!0});const Mg=jte,fh=tf;function kkt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?a+=1:isFinite(l)||(o+=1)}const s={numVals:t,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s}jl.arrayStats=kkt;function Tkt(e){return KI(this,void 0,void 0,function*(){const[t,n,r]=Mg.tidy(()=>{const i=Mg.scalar(0,e.dtype),a=e.min(),o=e.max(),s=e.equal(i).sum();return[a,o,s]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,a,o,s])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const g=i[p];isNaN(g)?l+=1:isFinite(g)||(c+=1)}let f=a[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:s[0],numNans:l,min:f,max:d,numInfs:c}})})}jl.tensorStats=Tkt;function Okt(e,t,n,r){return KI(this,void 0,void 0,function*(){fh.assert(e.rank===1,"labels must be a 1D tensor"),fh.assert(t.rank===1,"predictions must be a 1D tensor"),fh.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&fh.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),a=t.cast("int32");n==null&&(n=Mg.tidy(()=>Mg.maximum(i.max(),a.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),a.data(),o]).then(([s,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<s.length;f++){const d=s[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}jl.confusionMatrix=Okt;function Ikt(e,t){return KI(this,void 0,void 0,function*(){fh.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Mg.dispose([n,r]),i})}jl.accuracy=Ikt;function Nkt(e,t,n){return KI(this,void 0,void 0,function*(){return fh.assert(e.rank===1,"labels must be a 1D tensor"),fh.assert(t.rank===1,"predictions must be a 1D tensor"),fh.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Mg.tidy(()=>Mg.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const a=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];a[l]+=1,l===c&&(o[l]+=1)}const s=[];for(let u=0;u<a.length;u++)s.push({count:a[u],accuracy:a[u]===0?0:o[u]/a[u]});return s})})}jl.perClassAccuracy=Nkt;var j0={},rU="http://www.w3.org/1999/xhtml",iU={svg:"http://www.w3.org/2000/svg",xhtml:rU,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function aU(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),iU.hasOwnProperty(t)?{space:iU[t],local:e}:e}function Dkt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===rU&&t.documentElement.namespaceURI===rU?t.createElement(e):t.createElementNS(n,e)}}function Rkt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function XI(e){var t=aU(e);return(t.local?Rkt:Dkt)(t)}function Fkt(){}function oU(e){return e==null?Fkt:function(){return this.querySelector(e)}}function Mkt(e){typeof e!="function"&&(e=oU(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=e.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new Ga(r,this._parents)}function Pkt(){return[]}function kbe(e){return e==null?Pkt:function(){return this.querySelectorAll(e)}}function $kt(e){typeof e!="function"&&(e=kbe(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Ga(r,i)}var Tbe=function(e){return function(){return this.matches(e)}};if(typeof document!="undefined"){var g2=document.documentElement;if(!g2.matches){var Lkt=g2.webkitMatchesSelector||g2.msMatchesSelector||g2.mozMatchesSelector||g2.oMatchesSelector;Tbe=function(e){return function(){return Lkt.call(this,e)}}}}var Obe=Tbe;function Bkt(e){typeof e!="function"&&(e=Obe(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&e.call(u,u.__data__,l,a)&&s.push(u);return new Ga(r,this._parents)}function Ibe(e){return new Array(e.length)}function zkt(){return new Ga(this._enter||this._groups.map(Ibe),this._parents)}function YI(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}YI.prototype={constructor:YI,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function jkt(e){return function(){return e}}var Nbe="$";function Ukt(e,t,n,r,i,a){for(var o=0,s,u=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new YI(e,a[o]);for(;o<u;++o)(s=t[o])&&(i[o]=s)}function Wkt(e,t,n,r,i,a,o){var s,u,l={},c=t.length,f=a.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=Nbe+o.call(u,u.__data__,s,t),h in l?i[s]=u:l[h]=u);for(s=0;s<f;++s)h=Nbe+o.call(e,a[s],s,a),(u=l[h])?(r[s]=u,u.__data__=a[s],l[h]=null):n[s]=new YI(e,a[s]);for(s=0;s<c;++s)(u=t[s])&&l[d[s]]===u&&(i[s]=u)}function Vkt(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?Wkt:Ukt,r=this._parents,i=this._groups;typeof e!="function"&&(e=jkt(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=o[l]=new Array(p),v=u[l]=new Array(d);n(c,f,g,m,v,h,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return o=new Ga(o,r),o._enter=s,o._exit=u,o}function qkt(){return new Ga(this._exit||this._groups.map(Ibe),this._parents)}function Hkt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=t[s],l=n[s],c=u.length,f=o[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)o[s]=t[s];return new Ga(o,this._parents)}function Gkt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&a!==o.nextSibling&&a.parentNode.insertBefore(o,a),a=o);return this}function Kkt(e){e||(e=Xkt);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Ga(i,this._parents).order()}function Xkt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ykt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Zkt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function Jkt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Qkt(){var e=0;return this.each(function(){++e}),e}function eTt(){return!this.node()}function tTt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function nTt(e){return function(){this.removeAttribute(e)}}function rTt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function iTt(e,t){return function(){this.setAttribute(e,t)}}function aTt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function oTt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function sTt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function uTt(e,t){var n=aU(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?rTt:nTt:typeof t=="function"?n.local?sTt:oTt:n.local?aTt:iTt)(n,t))}function sU(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function lTt(e){return function(){this.style.removeProperty(e)}}function cTt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function fTt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function dTt(e,t,n){return arguments.length>1?this.each((t==null?lTt:typeof t=="function"?fTt:cTt)(e,t,n??"")):Dbe(this.node(),e)}function Dbe(e,t){return e.style.getPropertyValue(t)||sU(e).getComputedStyle(e,null).getPropertyValue(t)}function hTt(e){return function(){delete this[e]}}function pTt(e,t){return function(){this[e]=t}}function gTt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function mTt(e,t){return arguments.length>1?this.each((t==null?hTt:typeof t=="function"?gTt:pTt)(e,t)):this.node()[e]}function Rbe(e){return e.trim().split(/^|\s+/)}function uU(e){return e.classList||new Fbe(e)}function Fbe(e){this._node=e,this._names=Rbe(e.getAttribute("class")||"")}Fbe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Mbe(e,t){for(var n=uU(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Pbe(e,t){for(var n=uU(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function vTt(e){return function(){Mbe(this,e)}}function yTt(e){return function(){Pbe(this,e)}}function bTt(e,t){return function(){(t.apply(this,arguments)?Mbe:Pbe)(this,e)}}function xTt(e,t){var n=Rbe(e+"");if(arguments.length<2){for(var r=uU(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?bTt:t?vTt:yTt)(n,t))}function wTt(){this.textContent=""}function _Tt(e){return function(){this.textContent=e}}function STt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ETt(e){return arguments.length?this.each(e==null?wTt:(typeof e=="function"?STt:_Tt)(e)):this.node().textContent}function ATt(){this.innerHTML=""}function CTt(e){return function(){this.innerHTML=e}}function kTt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function TTt(e){return arguments.length?this.each(e==null?ATt:(typeof e=="function"?kTt:CTt)(e)):this.node().innerHTML}function OTt(){this.nextSibling&&this.parentNode.appendChild(this)}function ITt(){return this.each(OTt)}function NTt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function DTt(){return this.each(NTt)}function RTt(e){var t=typeof e=="function"?e:XI(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function FTt(){return null}function MTt(e,t){var n=typeof e=="function"?e:XI(e),r=t==null?FTt:typeof t=="function"?t:oU(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function PTt(){var e=this.parentNode;e&&e.removeChild(this)}function $Tt(){return this.each(PTt)}function LTt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function BTt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function zTt(e){return this.select(e?BTt:LTt)}function jTt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var $be={},nf=null;if(typeof document!="undefined"){var UTt=document.documentElement;"onmouseenter"in UTt||($be={mouseenter:"mouseover",mouseleave:"mouseout"})}function WTt(e,t,n){return e=Lbe(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function Lbe(e,t,n){return function(r){var i=nf;nf=r;try{e.call(this,this.__data__,t,n)}finally{nf=i}}}function VTt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function qTt(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function HTt(e,t,n){var r=$be.hasOwnProperty(e.type)?WTt:Lbe;return function(i,a,o){var s=this.__on,u,l=r(t,a,o);if(s){for(var c=0,f=s.length;c<f;++c)if((u=s[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},s?s.push(u):this.__on=[u]}}function GTt(e,t,n){var r=VTt(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?HTt:qTt,n==null&&(n=!1),i=0;i<a;++i)this.each(s(r[i],t,n));return this}function KTt(e,t,n,r){var i=nf;e.sourceEvent=nf,nf=e;try{return t.apply(n,r)}finally{nf=i}}function Bbe(e,t,n){var r=sU(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function XTt(e,t){return function(){return Bbe(this,e,t)}}function YTt(e,t){return function(){return Bbe(this,e,t.apply(this,arguments))}}function ZTt(e,t){return this.each((typeof t=="function"?YTt:XTt)(e,t))}var lU=[null];function Ga(e,t){this._groups=e,this._parents=t}function zbe(){return new Ga([[document.documentElement]],lU)}Ga.prototype=zbe.prototype={constructor:Ga,select:Mkt,selectAll:$kt,filter:Bkt,data:Vkt,enter:zkt,exit:qkt,merge:Hkt,order:Gkt,sort:Kkt,call:Ykt,nodes:Zkt,node:Jkt,size:Qkt,empty:eTt,each:tTt,attr:uTt,style:dTt,property:mTt,classed:xTt,text:ETt,html:TTt,raise:ITt,lower:DTt,append:RTt,insert:MTt,remove:$Tt,clone:zTt,datum:jTt,on:GTt,dispatch:ZTt};function jbe(e){return typeof e=="string"?new Ga([[document.querySelector(e)]],[document.documentElement]):new Ga([[e]],lU)}function JTt(e){return jbe(XI(e).call(document.documentElement))}var QTt=0;function Ube(){return new cU}function cU(){this._="@"+(++QTt).toString(36)}cU.prototype=Ube.prototype={constructor:cU,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function fU(){for(var e=nf,t;t=e.sourceEvent;)e=t;return e}function ZI(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function eOt(e){var t=fU();return t.changedTouches&&(t=t.changedTouches[0]),ZI(e,t)}function tOt(e){return typeof e=="string"?new Ga([document.querySelectorAll(e)],[document.documentElement]):new Ga([e??[]],lU)}function nOt(e,t,n){arguments.length<3&&(n=t,t=fU().changedTouches);for(var r=0,i=t?t.length:0,a;r<i;++r)if((a=t[r]).identifier===n)return ZI(e,a);return null}function rOt(e,t){t==null&&(t=fU().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=ZI(e,t[n]);return i}var iOt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:JTt,creator:XI,local:Ube,matcher:Obe,mouse:eOt,namespace:aU,namespaces:iU,clientPoint:ZI,select:jbe,selectAll:tOt,selection:zbe,selector:oU,selectorAll:kbe,style:Dbe,touch:nOt,touches:rOt,window:sU,get event(){return nf},customEvent:KTt}),aOt=vh(iOt);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(j0,"__esModule",{value:!0});const oOt=Cbe,Wbe=aOt,dU=Le,sOt=Ha;function uOt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=sOt.getDrawArea(e),i=Object.assign({},lOt,n);let a=Wbe.select(r).select("table.tf-table");const o=dU.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(a.size()===0&&(a=Wbe.select(r).append("table"),a.attr("class",` ${o} tf-table`),a.append("thead").append("tr"),a.append("tbody")),a.size()!==1)throw new Error("Error inserting table");const s=dU.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),u=a.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${s}`);u.merge(l).html(m=>m),u.exit().remove();const c=oOt.format(",.4~f"),f=a.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=dU.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(d).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${h}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}j0.table=uOt;const lOt={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var cOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},fOt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p2,"__esModule",{value:!0});const Vbe=Cbe,dOt=fOt(P0),JI=Ts,hOt=jl,pOt=j0,gOt={maxBins:12,fontSize:11};function mOt(e,t,n={}){return cOt(this,void 0,void 0,function*(){const r=yOt(t),i=Object.assign({},gOt,n),a={actions:!1,mode:"vega-lite",defaultStyle:!1},o=JI.subSurface(e,"histogram");if(n.stats!==!1){const l=JI.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=hOt.arrayStats(r.map(f=>f.value)),vOt(c,l,{fontSize:i.fontSize})}if(r.length===0)return;const s=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&s.push(r[l])}const u={width:i.width||JI.getDefaultWidth(o),height:i.height||JI.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:s},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return dOt.default(o,u,a)})}p2.histogram=mOt;function vOt(e,t,n){const r=Vbe.format(",.4~f"),i=Vbe.format(".4~p"),a=[],o=[];if(e.numVals!=null&&(a.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(a.push("Min"),o.push(r(e.min))),e.max!=null&&(a.push("Max"),o.push(r(e.max))),e.numZeros!=null){a.push("# Zeros");let s="";e.numVals&&(s=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${s}`)}if(e.numNans!=null){a.push("# NaNs");let s="";e.numVals&&(s=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${s}`)}if(e.numInfs!=null){a.push("# Infinity");let s="";e.numVals&&(s=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${s}`)}pOt.table(t,{headers:a,values:[o]},n)}function yOt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var QI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},xOt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(QI,"__esModule",{value:!0});const wOt=xOt(P0),qbe=Ts,Hbe=tf,_Ot=Ha;function SOt(e,t,n={}){return bOt(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,a=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);Hbe.assert(a.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&Hbe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=[];for(let g=0;g<i;g++){const m={x:g};a.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),o.push(m)}const s=Object.assign({},EOt,n),u=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},l={x:{field:"x",type:s.xType,title:s.xLabel},tooltip:[{field:"x",type:"quantitative"},...a.map(g=>({field:g,type:"quantitative"}))]},c=a.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:s.yType,title:s.yLabel,scale:u()},color:{field:`${g}-name`,type:"nominal",legend:{values:a,title:null},scale:{range:s.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=_Ot.getDrawArea(e),h={width:s.width||qbe.getDefaultWidth(d),height:s.height||qbe.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:o},encoding:l,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield wOt.default(d,h,p),Promise.resolve()})}QI.linechart=SOt;const EOt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var hU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},COt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hU,"__esModule",{value:!0});const kOt=COt(P0),Gbe=Ts,TOt=tf,OOt=Ha;function IOt(e,t,n={}){return AOt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const a=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,g=d.map(m=>Object.assign({},m,{series:p}));a.push(...g)}),n.seriesColors!=null&&TOt.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=OOt.getDrawArea(e),s=Object.assign({},NOt,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(s.zoomToFit)return{zero:!1};if(s.xAxisDomain!=null)return{domain:s.xAxisDomain}},c=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},f={width:s.width||Gbe.getDefaultWidth(o),height:s.height||Gbe.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:a},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:s.xType,title:s.xLabel,scale:l()},y:{field:"y",type:s.yType,title:s.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:s.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield kOt.default(o,f,u),Promise.resolve()})}hU.scatterplot=IOt;const NOt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var eN={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(eN,"__esModule",{value:!0});const DOt=QI,pU=Ha,Xbe=Ts;function Ybe(e,t,n,r={}){return Kbe(this,void 0,void 0,function*(){const i=pU.getDrawArea(e),a={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");Zbe(a,c);const f=Jbe(t,l,n.indexOf(l));a[c].series.push(l),a[c].values.push(f)}else{const c=Jbe(t,l,n.indexOf(l));Zbe(a,l),a[l].series.push(l),a[l].values.push(c)}const o=Object.keys(a),s=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=Xbe.subSurface(i,l),f=a[l].series,d=a[l].values;f.every(p=>Boolean(p.match("acc")))&&(s.zoomToFitAccuracy?s.zoomToFit=!0:(s.yAxisDomain=[0,1],delete s.zoomToFit));const h=DOt.linechart(c,{values:d,series:f},s);u.push(h)}yield Promise.all(u)})}eN.history=Ybe;function Zbe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function Jbe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let a=0;a<r.length;a++){const o=r[a];i.push({x:a,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function ROt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],a=pU.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function s(l){return(c,f)=>Kbe(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const g of t)if(f[g]!=null){h.push(g);const m=FOt(r,l,g);m.push({[g]:f[g]}),d.push(m)}const p=Xbe.subSurface(a,l,{title:l});Ybe(p,d,h,o),yield pU.nextFrame()})}const u={};return i.forEach(l=>{u[l]=s(l)}),u}eN.fitCallbacks=ROt;function FOt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var tN={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nN=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(tN,"__esModule",{value:!0});const MOt=p2,Qbe=Ha,e1e=j0,gU=Ts,POt=jl;function $Ot(e,t){return nN(this,void 0,void 0,function*(){const n=Qbe.getDrawArea(e),r=BOt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],a=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);e1e.table(n,{headers:i,values:a})})}tN.modelSummary=$Ot;function LOt(e,t){return nN(this,void 0,void 0,function*(){const n=Qbe.getDrawArea(e),r=yield jOt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],a=gU.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);e1e.table(a,{headers:i,values:o});const s=gU.subSurface(n,"select-layer"),u=gU.subSurface(n,"param-distribution"),l=c=>nN(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();MOt.histogram(u,d,{height:150,width:460,stats:!1})});UOt(r.map(c=>c.name),s,l)})}tN.layer=LOt;function BOt(e){return{layers:e.layers.map(zOt)}}function zOt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>mU(r)).join(", ")}]`:t=mU(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function jOt(e){return nN(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(POt.tensorStats),i=yield Promise.all(r),a=t.map(o=>o.shape);return t.map((o,s)=>({name:n[s].name,stats:i[s],shape:mU(a[s]),weight:o}))})}function mU(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function UOt(e,t,n){const a=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=a;const o=t.querySelector("button"),s=t.querySelector("select");o.addEventListener("click",()=>{n(s.selectedOptions[0].label)})}var vU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var WOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(vU,"__esModule",{value:!0});const VOt=Ha,qOt=j0;function HOt(e,t,n){return WOt(this,void 0,void 0,function*(){const r=VOt.getDrawArea(e),i=["Class","Accuracy","# Samples"],a=[];for(let o=0;o<t.length;o++){const s=n?n[o]:o.toString(),u=t[o];a.push([s,u.accuracy,u.count])}return qOt.table(r,{headers:i,values:a})})}vU.perClassAccuracy=HOt;var yU={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var GOt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(yU,"__esModule",{value:!0});const KOt=p2,XOt=Ha,YOt=jl;function ZOt(e,t){return GOt(this,void 0,void 0,function*(){const n=XOt.getDrawArea(e),r=yield YOt.tensorStats(t),i=yield t.data();KOt.histogram(n,i,{height:150,stats:r})})}yU.valuesDistribution=ZOt;var bU={};/** @license See the LICENSE file. */Object.defineProperty(bU,"__esModule",{value:!0});const JOt="1.5.1";bU.version=JOt,function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=G$,r=tU,i=nU,a=p2,o=QI,s=hU,u=j0,l=eN,c=tN,f=vU,d=yU,h=jl,p=bU;e.version_vis=p.version;const g={barchart:n.barchart,table:u.table,histogram:a.histogram,linechart:o.linechart,scatterplot:s.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=u2;e.visor=y.visor,t(s2)}(zte);for(var U0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m2=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),rN=0;rN<U0.length;rN++)m2[U0.charCodeAt(rN)]=rN;var QOt=function(e){var t=new Uint8Array(e),n,r=t.length,i="";for(n=0;n<r;n+=3)i+=U0[t[n]>>2],i+=U0[(t[n]&3)<<4|t[n+1]>>4],i+=U0[(t[n+1]&15)<<2|t[n+2]>>6],i+=U0[t[n+2]&63];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},eIt=function(e){var t=e.length*.75,n=e.length,r,i=0,a,o,s,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),c=new Uint8Array(l);for(r=0;r<n;r+=4)a=m2[e.charCodeAt(r)],o=m2[e.charCodeAt(r+1)],s=m2[e.charCodeAt(r+2)],u=m2[e.charCodeAt(r+3)],c[i++]=a<<2|o>>4,c[i++]=(o&15)<<4|s>>2,c[i++]=(s&3)<<6|u&63;return l},t1e={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof cf=="function"&&cf;if(!c&&f)return f(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var g=r[l][1][p];return o(g||p)},h,h.exports,n,r,i,a)}return i[l].exports}for(var s=typeof cf=="function"&&cf,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,s;if(o){var u=0,l=new o(p),c=a.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var f=new a.MessageChannel;f.port1.onmessage=p,s=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?s=function(){var m=a.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:s=function(){setTimeout(p,0)};var d,h=[];function p(){d=!0;for(var m,v,y=h.length;y;){for(v=h,h=[],m=-1;++m<y;)v[m]();y=h.length}d=!1}r.exports=g;function g(m){h.push(m)===1&&!d&&s()}}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=f;function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,S){if(typeof w!="function"&&this.state===l||typeof S!="function"&&this.state===u)return this;var A=new this.constructor(o);if(this.state!==c){var _=this.state===l?w:S;h(A,_,this.outcome)}else this.queue.push(new d(A,w,S));return A};function d(w,S,A){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){s.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){s.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)};function h(w,S,A){a(function(){var _;try{_=S(A)}catch(E){return s.reject(w,E)}_===w?s.reject(w,new TypeError("Cannot resolve promise with itself")):s.resolve(w,_)})}s.resolve=function(w,S){var A=m(p,S);if(A.status==="error")return s.reject(w,A.value);var _=A.value;if(_)g(w,_);else{w.state=l,w.outcome=S;for(var E=-1,C=w.queue.length;++E<C;)w.queue[E].callFulfilled(S)}return w},s.reject=function(w,S){w.state=u,w.outcome=S;for(var A=-1,_=w.queue.length;++A<_;)w.queue[A].callRejected(S);return w};function p(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var A=!1;function _(T){A||(A=!0,s.reject(w,T))}function E(T){A||(A=!0,s.resolve(w,T))}function C(){S(E,_)}var k=m(C);k.status==="error"&&_(k.value)}function m(w,S){var A={};try{A.value=w(S),A.status="success"}catch(_){A.status="error",A.value=_}return A}f.resolve=v;function v(w){return w instanceof this?w:s.resolve(new this(o),w)}f.reject=y;function y(w){var S=new this(o);return s.reject(S,w)}f.all=b;function b(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,_=!1;if(!A)return this.resolve([]);for(var E=new Array(A),C=0,k=-1,T=new this(o);++k<A;)I(w[k],k);return T;function I(N,O){S.resolve(N).then(D,function(L){_||(_=!0,s.reject(T,L))});function D(L){E[O]=L,++C===A&&!_&&(_=!0,s.resolve(T,E))}}}f.race=x;function x(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=w.length,_=!1;if(!A)return this.resolve([]);for(var E=-1,C=new this(o);++E<A;)k(w[E]);return C;function k(T){S.resolve(T).then(function(I){_||(_=!0,s.resolve(C,I))},function(I){_||(_=!0,s.reject(C,I))})}}},{"1":1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z};function o(z,Z){if(!(z instanceof Z))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(z){return}}var u=s();function l(){try{if(!u||!u.open)return!1;var z=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Z=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!z||Z)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(q){return!1}}function c(z,Z){z=z||[],Z=Z||{};try{return new Blob(z,Z)}catch(te){if(te.name!=="TypeError")throw te;for(var q=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,re=new q,oe=0;oe<z.length;oe+=1)re.append(z[oe]);return re.getBlob(Z.type)}}typeof Promise=="undefined"&&n(3);var f=Promise;function d(z,Z){Z&&z.then(function(q){Z(null,q)},function(q){Z(q)})}function h(z,Z,q){typeof Z=="function"&&z.then(Z),typeof q=="function"&&z.catch(q)}function p(z){return typeof z!="string"&&(console.warn(z+" used as a key, but it is not a string."),z=String(z)),z}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",v=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function S(z){for(var Z=z.length,q=new ArrayBuffer(Z),re=new Uint8Array(q),oe=0;oe<Z;oe++)re[oe]=z.charCodeAt(oe);return q}function A(z){return new f(function(Z){var q=z.transaction(m,w),re=c([""]);q.objectStore(m).put(re,"key"),q.onabort=function(oe){oe.preventDefault(),oe.stopPropagation(),Z(!1)},q.oncomplete=function(){var oe=navigator.userAgent.match(/Chrome\/(\d+)/),te=navigator.userAgent.match(/Edge\//);Z(te||!oe||parseInt(oe[1],10)>=43)}}).catch(function(){return!1})}function _(z){return typeof v=="boolean"?f.resolve(v):A(z).then(function(Z){return v=Z,v})}function E(z){var Z=y[z.name],q={};q.promise=new f(function(re,oe){q.resolve=re,q.reject=oe}),Z.deferredOperations.push(q),Z.dbReady?Z.dbReady=Z.dbReady.then(function(){return q.promise}):Z.dbReady=q.promise}function C(z){var Z=y[z.name],q=Z.deferredOperations.pop();if(q)return q.resolve(),q.promise}function k(z,Z){var q=y[z.name],re=q.deferredOperations.pop();if(re)return re.reject(Z),re.promise}function T(z,Z){return new f(function(q,re){if(y[z.name]=y[z.name]||ce(),z.db)if(Z)E(z),z.db.close();else return q(z.db);var oe=[z.name];Z&&oe.push(z.version);var te=u.open.apply(u,oe);Z&&(te.onupgradeneeded=function(Ae){var De=te.result;try{De.createObjectStore(z.storeName),Ae.oldVersion<=1&&De.createObjectStore(m)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+z.name+'" has been upgraded from version '+Ae.oldVersion+" to version "+Ae.newVersion+', but the storage "'+z.storeName+'" already exists.');else throw Fe}}),te.onerror=function(Ae){Ae.preventDefault(),re(te.error)},te.onsuccess=function(){var Ae=te.result;Ae.onversionchange=function(De){De.target.close()},q(Ae),C(z)}})}function I(z){return T(z,!1)}function N(z){return T(z,!0)}function O(z,Z){if(!z.db)return!0;var q=!z.db.objectStoreNames.contains(z.storeName),re=z.version<z.db.version,oe=z.version>z.db.version;if(re&&(z.version!==Z&&console.warn('The database "'+z.name+`" can't be downgraded from version `+z.db.version+" to version "+z.version+"."),z.version=z.db.version),oe||q){if(q){var te=z.db.version+1;te>z.version&&(z.version=te)}return!0}return!1}function D(z){return new f(function(Z,q){var re=new FileReader;re.onerror=q,re.onloadend=function(oe){var te=btoa(oe.target.result||"");Z({__local_forage_encoded_blob:!0,data:te,type:z.type})},re.readAsBinaryString(z)})}function L(z){var Z=S(atob(z.data));return c([Z],{type:z.type})}function W(z){return z&&z.__local_forage_encoded_blob}function G(z){var Z=this,q=Z._initReady().then(function(){var re=y[Z._dbInfo.name];if(re&&re.dbReady)return re.dbReady});return h(q,z,z),q}function K(z){E(z);for(var Z=y[z.name],q=Z.forages,re=0;re<q.length;re++){var oe=q[re];oe._dbInfo.db&&(oe._dbInfo.db.close(),oe._dbInfo.db=null)}return z.db=null,I(z).then(function(te){return z.db=te,O(z)?N(z):te}).then(function(te){z.db=Z.db=te;for(var Ae=0;Ae<q.length;Ae++)q[Ae]._dbInfo.db=te}).catch(function(te){throw k(z,te),te})}function ee(z,Z,q,re){re===void 0&&(re=1);try{var oe=z.db.transaction(z.storeName,Z);q(null,oe)}catch(te){if(re>0&&(!z.db||te.name==="InvalidStateError"||te.name==="NotFoundError"))return f.resolve().then(function(){if(!z.db||te.name==="NotFoundError"&&!z.db.objectStoreNames.contains(z.storeName)&&z.version<=z.db.version)return z.db&&(z.version=z.db.version+1),N(z)}).then(function(){return K(z).then(function(){ee(z,Z,q,re-1)})}).catch(q);q(te)}}function ce(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function he(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=z[re];var oe=y[q.name];oe||(oe=ce(),y[q.name]=oe),oe.forages.push(Z),Z._initReady||(Z._initReady=Z.ready,Z.ready=G);var te=[];function Ae(){return f.resolve()}for(var De=0;De<oe.forages.length;De++){var Fe=oe.forages[De];Fe!==Z&&te.push(Fe._initReady().catch(Ae))}var Pe=oe.forages.slice(0);return f.all(te).then(function(){return q.db=oe.db,I(q)}).then(function(je){return q.db=je,O(q,Z._defaultConfig.version)?N(q):je}).then(function(je){q.db=oe.db=je,Z._dbInfo=q;for(var it=0;it<Pe.length;it++){var Ft=Pe[it];Ft!==Z&&(Ft._dbInfo.db=q.db,Ft._dbInfo.version=q.version)}})}function Oe(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.get(z);Pe.onsuccess=function(){var je=Pe.result;je===void 0&&(je=null),W(je)&&(je=L(je)),oe(je)},Pe.onerror=function(){te(Pe.error)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function Te(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.openCursor(),je=1;Pe.onsuccess=function(){var it=Pe.result;if(it){var Ft=it.value;W(Ft)&&(Ft=L(Ft));var bn=z(Ft,it.key,je++);bn!==void 0?oe(bn):it.continue()}else oe()},Pe.onerror=function(){te(Pe.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function Re(z,Z,q){var re=this;z=p(z);var oe=new f(function(te,Ae){var De;re.ready().then(function(){return De=re._dbInfo,b.call(Z)==="[object Blob]"?_(De.db).then(function(Fe){return Fe?Z:D(Z)}):Z}).then(function(Fe){ee(re._dbInfo,w,function(Pe,je){if(Pe)return Ae(Pe);try{var it=je.objectStore(re._dbInfo.storeName);Fe===null&&(Fe=void 0);var Ft=it.put(Fe,z);je.oncomplete=function(){Fe===void 0&&(Fe=null),te(Fe)},je.onabort=je.onerror=function(){var bn=Ft.error?Ft.error:Ft.transaction.error;Ae(bn)}}catch(bn){Ae(bn)}})}).catch(Ae)});return d(oe,q),oe}function me(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,w,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=Fe.delete(z);De.oncomplete=function(){oe()},De.onerror=function(){te(Pe.error)},De.onabort=function(){var je=Pe.error?Pe.error:Pe.transaction.error;te(je)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function P(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,w,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.clear();Ae.oncomplete=function(){re()},Ae.onabort=Ae.onerror=function(){var Pe=Fe.error?Fe.error:Fe.transaction.error;oe(Pe)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function F(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.count();Fe.onsuccess=function(){re(Fe.result)},Fe.onerror=function(){oe(Fe.error)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function V(z,Z){var q=this,re=new f(function(oe,te){if(z<0){oe(null);return}q.ready().then(function(){ee(q._dbInfo,x,function(Ae,De){if(Ae)return te(Ae);try{var Fe=De.objectStore(q._dbInfo.storeName),Pe=!1,je=Fe.openKeyCursor();je.onsuccess=function(){var it=je.result;if(!it){oe(null);return}z===0||Pe?oe(it.key):(Pe=!0,it.advance(z))},je.onerror=function(){te(je.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function ae(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ae){if(te)return oe(te);try{var De=Ae.objectStore(Z._dbInfo.storeName),Fe=De.openKeyCursor(),Pe=[];Fe.onsuccess=function(){var je=Fe.result;if(!je){re(Pe);return}Pe.push(je.key),je.continue()},Fe.onerror=function(){oe(Fe.error)}}catch(je){oe(je)}})}).catch(oe)});return d(q,z),q}function Y(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;if(!z.name)oe=f.reject("Invalid arguments");else{var te=z.name===q.name&&re._dbInfo.db,Ae=te?f.resolve(re._dbInfo.db):I(z).then(function(De){var Fe=y[z.name],Pe=Fe.forages;Fe.db=De;for(var je=0;je<Pe.length;je++)Pe[je]._dbInfo.db=De;return De});z.storeName?oe=Ae.then(function(De){if(!!De.objectStoreNames.contains(z.storeName)){var Fe=De.version+1;E(z);var Pe=y[z.name],je=Pe.forages;De.close();for(var it=0;it<je.length;it++){var Ft=je[it];Ft._dbInfo.db=null,Ft._dbInfo.version=Fe}var bn=new f(function(An,_r){var sr=u.open(z.name,Fe);sr.onerror=function(Xa){var ph=sr.result;ph.close(),_r(Xa)},sr.onupgradeneeded=function(){var Xa=sr.result;Xa.deleteObjectStore(z.storeName)},sr.onsuccess=function(){var Xa=sr.result;Xa.close(),An(Xa)}});return bn.then(function(An){Pe.db=An;for(var _r=0;_r<je.length;_r++){var sr=je[_r];sr._dbInfo.db=An,C(sr._dbInfo)}}).catch(function(An){throw(k(z,An)||f.resolve()).catch(function(){}),An})}}):oe=Ae.then(function(De){E(z);var Fe=y[z.name],Pe=Fe.forages;De.close();for(var je=0;je<Pe.length;je++){var it=Pe[je];it._dbInfo.db=null}var Ft=new f(function(bn,An){var _r=u.deleteDatabase(z.name);_r.onerror=function(){var sr=_r.result;sr&&sr.close(),An(_r.error)},_r.onblocked=function(){console.warn('dropInstance blocked for database "'+z.name+'" until all open connections are closed')},_r.onsuccess=function(){var sr=_r.result;sr&&sr.close(),bn(sr)}});return Ft.then(function(bn){Fe.db=bn;for(var An=0;An<Pe.length;An++){var _r=Pe[An];C(_r._dbInfo)}}).catch(function(bn){throw(k(z,bn)||f.resolve()).catch(function(){}),bn})})}return d(oe,Z),oe}var M={_driver:"asyncStorage",_initStorage:he,_support:l(),iterate:Te,getItem:Oe,setItem:Re,removeItem:me,clear:P,length:F,key:V,keys:ae,dropInstance:Y};function B(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",ge=/^~~local_forage_type~([^~]+)~/,xe="__lfsc__:",ze=xe.length,Ke="arbf",Ze="blob",Lt="si08",Je="ui08",Zt="uic8",mn="si16",qn="si32",ni="ur16",tr="ui32",Dn="fl32",Qo="fl64",Ka=ze+Ke.length,Ul=Object.prototype.toString;function Os(z){var Z=z.length*.75,q=z.length,re,oe=0,te,Ae,De,Fe;z[z.length-1]==="="&&(Z--,z[z.length-2]==="="&&Z--);var Pe=new ArrayBuffer(Z),je=new Uint8Array(Pe);for(re=0;re<q;re+=4)te=R.indexOf(z[re]),Ae=R.indexOf(z[re+1]),De=R.indexOf(z[re+2]),Fe=R.indexOf(z[re+3]),je[oe++]=te<<2|Ae>>4,je[oe++]=(Ae&15)<<4|De>>2,je[oe++]=(De&3)<<6|Fe&63;return Pe}function Is(z){var Z=new Uint8Array(z),q="",re;for(re=0;re<Z.length;re+=3)q+=R[Z[re]>>2],q+=R[(Z[re]&3)<<4|Z[re+1]>>4],q+=R[(Z[re+1]&15)<<2|Z[re+2]>>6],q+=R[Z[re+2]&63];return Z.length%3==2?q=q.substring(0,q.length-1)+"=":Z.length%3==1&&(q=q.substring(0,q.length-2)+"=="),q}function Wl(z,Z){var q="";if(z&&(q=Ul.call(z)),z&&(q==="[object ArrayBuffer]"||z.buffer&&Ul.call(z.buffer)==="[object ArrayBuffer]")){var re,oe=xe;z instanceof ArrayBuffer?(re=z,oe+=Ke):(re=z.buffer,q==="[object Int8Array]"?oe+=Lt:q==="[object Uint8Array]"?oe+=Je:q==="[object Uint8ClampedArray]"?oe+=Zt:q==="[object Int16Array]"?oe+=mn:q==="[object Uint16Array]"?oe+=ni:q==="[object Int32Array]"?oe+=qn:q==="[object Uint32Array]"?oe+=tr:q==="[object Float32Array]"?oe+=Dn:q==="[object Float64Array]"?oe+=Qo:Z(new Error("Failed to get type for BinaryArray"))),Z(oe+Is(re))}else if(q==="[object Blob]"){var te=new FileReader;te.onload=function(){var Ae=X+z.type+"~"+Is(this.result);Z(xe+Ze+Ae)},te.readAsArrayBuffer(z)}else try{Z(JSON.stringify(z))}catch(Ae){console.error("Couldn't convert value into a JSON string: ",z),Z(null,Ae)}}function Vl(z){if(z.substring(0,ze)!==xe)return JSON.parse(z);var Z=z.substring(Ka),q=z.substring(ze,Ka),re;if(q===Ze&&ge.test(Z)){var oe=Z.match(ge);re=oe[1],Z=Z.substring(oe[0].length)}var te=Os(Z);switch(q){case Ke:return te;case Ze:return c([te],{type:re});case Lt:return new Int8Array(te);case Je:return new Uint8Array(te);case Zt:return new Uint8ClampedArray(te);case mn:return new Int16Array(te);case ni:return new Uint16Array(te);case qn:return new Int32Array(te);case tr:return new Uint32Array(te);case Dn:return new Float32Array(te);case Qo:return new Float64Array(te);default:throw new Error("Unkown type: "+q)}}var rf={serialize:Wl,deserialize:Vl,stringToBuffer:Os,bufferToString:Is};function v2(z,Z,q,re){z.executeSql("CREATE TABLE IF NOT EXISTS "+Z.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,re)}function y2(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=typeof z[re]!="string"?z[re].toString():z[re];var oe=new f(function(te,Ae){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(De){return Ae(De)}q.db.transaction(function(De){v2(De,q,function(){Z._dbInfo=q,te()},function(Fe,Pe){Ae(Pe)})},Ae)});return q.serializer=rf,oe}function Iu(z,Z,q,re,oe,te){z.executeSql(q,re,oe,function(Ae,De){De.code===De.SYNTAX_ERR?Ae.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Z.storeName],function(Fe,Pe){Pe.rows.length?te(Fe,De):v2(Fe,Z,function(){Fe.executeSql(q,re,oe,te)},te)},te):te(Ae,De)},te)}function b2(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT * FROM "+Ae.storeName+" WHERE key = ? LIMIT 1",[z],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).value:null;je&&(je=Ae.serializer.deserialize(je)),oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function dh(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT * FROM "+Ae.storeName,[],function(Fe,Pe){for(var je=Pe.rows,it=je.length,Ft=0;Ft<it;Ft++){var bn=je.item(Ft),An=bn.value;if(An&&(An=Ae.serializer.deserialize(An)),An=z(An,bn.key,Ft+1),An!==void 0){oe(An);return}}oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function x2(z,Z,q,re){var oe=this;z=p(z);var te=new f(function(Ae,De){oe.ready().then(function(){Z===void 0&&(Z=null);var Fe=Z,Pe=oe._dbInfo;Pe.serializer.serialize(Z,function(je,it){it?De(it):Pe.db.transaction(function(Ft){Iu(Ft,Pe,"INSERT OR REPLACE INTO "+Pe.storeName+" (key, value) VALUES (?, ?)",[z,je],function(){Ae(Fe)},function(bn,An){De(An)})},function(Ft){if(Ft.code===Ft.QUOTA_ERR){if(re>0){Ae(x2.apply(oe,[z,Fe,q,re-1]));return}De(Ft)}})})}).catch(De)});return d(te,q),te}function ql(z,Z,q){return x2.apply(this,[z,Z,q,1])}function iN(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"DELETE FROM "+Ae.storeName+" WHERE key = ?",[z],function(){oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function aN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"DELETE FROM "+te.storeName,[],function(){re()},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function oN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"SELECT COUNT(key) as c FROM "+te.storeName,[],function(De,Fe){var Pe=Fe.rows.item(0).c;re(Pe)},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function sN(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ae=q._dbInfo;Ae.db.transaction(function(De){Iu(De,Ae,"SELECT key FROM "+Ae.storeName+" WHERE id = ? LIMIT 1",[z+1],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).key:null;oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function uN(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ae){Iu(Ae,te,"SELECT key FROM "+te.storeName,[],function(De,Fe){for(var Pe=[],je=0;je<Fe.rows.length;je++)Pe.push(Fe.rows.item(je).key);re(Pe)},function(De,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function Ns(z){return new f(function(Z,q){z.transaction(function(re){re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(oe,te){for(var Ae=[],De=0;De<te.rows.length;De++)Ae.push(te.rows.item(De).name);Z({db:z,storeNames:Ae})},function(oe,te){q(te)})},function(re){q(re)})})}function lN(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;return z.name?oe=new f(function(te){var Ae;z.name===q.name?Ae=re._dbInfo.db:Ae=openDatabase(z.name,"","",0),z.storeName?te({db:Ae,storeNames:[z.storeName]}):te(Ns(Ae))}).then(function(te){return new f(function(Ae,De){te.db.transaction(function(Fe){function Pe(bn){return new f(function(An,_r){Fe.executeSql("DROP TABLE IF EXISTS "+bn,[],function(){An()},function(sr,Xa){_r(Xa)})})}for(var je=[],it=0,Ft=te.storeNames.length;it<Ft;it++)je.push(Pe(te.storeNames[it]));f.all(je).then(function(){Ae()}).catch(function(bn){De(bn)})},function(Fe){De(Fe)})})}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var cN={_driver:"webSQLStorage",_initStorage:y2,_support:B(),iterate:dh,getItem:b2,setItem:ql,removeItem:iN,clear:aN,length:oN,key:sN,keys:uN,dropInstance:lN};function fN(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(z){return!1}}function w2(z,Z){var q=z.name+"/";return z.storeName!==Z.storeName&&(q+=z.storeName+"/"),q}function dN(){var z="_localforage_support_test";try{return localStorage.setItem(z,!0),localStorage.removeItem(z),!1}catch(Z){return!0}}function af(){return!dN()||localStorage.length>0}function hN(z){var Z=this,q={};if(z)for(var re in z)q[re]=z[re];return q.keyPrefix=w2(z,Z._defaultConfig),af()?(Z._dbInfo=q,q.serializer=rf,f.resolve()):f.reject()}function pN(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo.keyPrefix,oe=localStorage.length-1;oe>=0;oe--){var te=localStorage.key(oe);te.indexOf(re)===0&&localStorage.removeItem(te)}});return d(q,z),q}function gN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo,te=localStorage.getItem(oe.keyPrefix+z);return te&&(te=oe.serializer.deserialize(te)),te});return d(re,Z),re}function mN(z,Z){var q=this,re=q.ready().then(function(){for(var oe=q._dbInfo,te=oe.keyPrefix,Ae=te.length,De=localStorage.length,Fe=1,Pe=0;Pe<De;Pe++){var je=localStorage.key(Pe);if(je.indexOf(te)===0){var it=localStorage.getItem(je);if(it&&(it=oe.serializer.deserialize(it)),it=z(it,je.substring(Ae),Fe++),it!==void 0)return it}}});return d(re,Z),re}function vN(z,Z){var q=this,re=q.ready().then(function(){var oe=q._dbInfo,te;try{te=localStorage.key(z)}catch(Ae){te=null}return te&&(te=te.substring(oe.keyPrefix.length)),te});return d(re,Z),re}function of(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo,oe=localStorage.length,te=[],Ae=0;Ae<oe;Ae++){var De=localStorage.key(Ae);De.indexOf(re.keyPrefix)===0&&te.push(De.substring(re.keyPrefix.length))}return te});return d(q,z),q}function yN(z){var Z=this,q=Z.keys().then(function(re){return re.length});return d(q,z),q}function bN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo;localStorage.removeItem(oe.keyPrefix+z)});return d(re,Z),re}function xN(z,Z,q){var re=this;z=p(z);var oe=re.ready().then(function(){Z===void 0&&(Z=null);var te=Z;return new f(function(Ae,De){var Fe=re._dbInfo;Fe.serializer.serialize(Z,function(Pe,je){if(je)De(je);else try{localStorage.setItem(Fe.keyPrefix+z,Pe),Ae(te)}catch(it){(it.name==="QuotaExceededError"||it.name==="NS_ERROR_DOM_QUOTA_REACHED")&&De(it),De(it)}})})});return d(oe,q),oe}function wN(z,Z){if(Z=g.apply(this,arguments),z=typeof z!="function"&&z||{},!z.name){var q=this.config();z.name=z.name||q.name,z.storeName=z.storeName||q.storeName}var re=this,oe;return z.name?oe=new f(function(te){z.storeName?te(w2(z,re._defaultConfig)):te(z.name+"/")}).then(function(te){for(var Ae=localStorage.length-1;Ae>=0;Ae--){var De=localStorage.key(Ae);De.indexOf(te)===0&&localStorage.removeItem(De)}}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var _N={_driver:"localStorageWrapper",_initStorage:hN,_support:fN(),iterate:mN,getItem:gN,setItem:xN,removeItem:bN,clear:pN,length:yN,key:vN,keys:of,dropInstance:wN},SN=function(Z,q){return Z===q||typeof Z=="number"&&typeof q=="number"&&isNaN(Z)&&isNaN(q)},W0=function(Z,q){for(var re=Z.length,oe=0;oe<re;){if(SN(Z[oe],q))return!0;oe++}return!1},_2=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"},Nu={},Pg={},sf={INDEXEDDB:M,WEBSQL:cN,LOCALSTORAGE:_N},$g=[sf.INDEXEDDB._driver,sf.WEBSQL._driver,sf.LOCALSTORAGE._driver],hh=["dropInstance"],V0=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(hh),EN={description:"",driver:$g.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function AN(z,Z){z[Z]=function(){var q=arguments;return z.ready().then(function(){return z[Z].apply(z,q)})}}function Lg(){for(var z=1;z<arguments.length;z++){var Z=arguments[z];if(Z)for(var q in Z)Z.hasOwnProperty(q)&&(_2(Z[q])?arguments[0][q]=Z[q].slice():arguments[0][q]=Z[q])}return arguments[0]}var CN=function(){function z(Z){o(this,z);for(var q in sf)if(sf.hasOwnProperty(q)){var re=sf[q],oe=re._driver;this[q]=oe,Nu[oe]||this.defineDriver(re)}this._defaultConfig=Lg({},EN),this._config=Lg({},this._defaultConfig,Z),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return z.prototype.config=function(q){if((typeof q=="undefined"?"undefined":a(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var re in q){if(re==="storeName"&&(q[re]=q[re].replace(/\W/g,"_")),re==="version"&&typeof q[re]!="number")return new Error("Database version must be a number.");this._config[re]=q[re]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},z.prototype.defineDriver=function(q,re,oe){var te=new f(function(Ae,De){try{var Fe=q._driver,Pe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){De(Pe);return}for(var je=V0.concat("_initStorage"),it=0,Ft=je.length;it<Ft;it++){var bn=je[it],An=!W0(hh,bn);if((An||q[bn])&&typeof q[bn]!="function"){De(Pe);return}}var _r=function(){for(var ph=function(TN){return function(){var Bg=new Error("Method "+TN+" is not implemented by the current driver"),zg=f.reject(Bg);return d(zg,arguments[arguments.length-1]),zg}},q0=0,H0=hh.length;q0<H0;q0++){var G0=hh[q0];q[G0]||(q[G0]=ph(G0))}};_r();var sr=function(ph){Nu[Fe]&&console.info("Redefining LocalForage driver: "+Fe),Nu[Fe]=q,Pg[Fe]=ph,Ae()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(sr,De):sr(!!q._support):sr(!0)}catch(Xa){De(Xa)}});return h(te,re,oe),te},z.prototype.driver=function(){return this._driver||null},z.prototype.getDriver=function(q,re,oe){var te=Nu[q]?f.resolve(Nu[q]):f.reject(new Error("Driver not found."));return h(te,re,oe),te},z.prototype.getSerializer=function(q){var re=f.resolve(rf);return h(re,q),re},z.prototype.ready=function(q){var re=this,oe=re._driverSet.then(function(){return re._ready===null&&(re._ready=re._initDriver()),re._ready});return h(oe,q,q),oe},z.prototype.setDriver=function(q,re,oe){var te=this;_2(q)||(q=[q]);var Ae=this._getSupportedDrivers(q);function De(){te._config.driver=te.driver()}function Fe(it){return te._extend(it),De(),te._ready=te._initStorage(te._config),te._ready}function Pe(it){return function(){var Ft=0;function bn(){for(;Ft<it.length;){var An=it[Ft];return Ft++,te._dbInfo=null,te._ready=null,te.getDriver(An).then(Fe).catch(bn)}De();var _r=new Error("No available storage method found.");return te._driverSet=f.reject(_r),te._driverSet}return bn()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=je.then(function(){var it=Ae[0];return te._dbInfo=null,te._ready=null,te.getDriver(it).then(function(Ft){te._driver=Ft._driver,De(),te._wrapLibraryMethodsWithReady(),te._initDriver=Pe(Ae)})}).catch(function(){De();var it=new Error("No available storage method found.");return te._driverSet=f.reject(it),te._driverSet}),h(this._driverSet,re,oe),this._driverSet},z.prototype.supports=function(q){return!!Pg[q]},z.prototype._extend=function(q){Lg(this,q)},z.prototype._getSupportedDrivers=function(q){for(var re=[],oe=0,te=q.length;oe<te;oe++){var Ae=q[oe];this.supports(Ae)&&re.push(Ae)}return re},z.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,re=V0.length;q<re;q++)AN(this,V0[q])},z.prototype.createInstance=function(q){return new z(q)},z}(),kN=new CN;r.exports=kN},{"3":3}]},{},[4])(4)})})(t1e);var tIt=t1e.exports;export{Ixe as $,st as A,wa as B,bRe as C,xRe as D,AMe as E,EMe as F,SMe as G,_Me as H,wMe as I,BRe as J,S2e as K,VRe as L,P1e as M,$Re as N,OMe as O,MS as P,jRe as Q,kMe as R,gK as S,iFe as T,WRe as U,YRe as V,HRe as W,iS as X,tIt as Y,ue as Z,Ug as _,aK as a,xq as a0,Wu as b,o8e as c,fze as d,q5e as e,zte as f,dze as g,QOt as h,Nxe as i,eIt as j,Oxe as k,an as l,M1e as m,aFe as n,DMe as o,uFe as p,sFe as q,Uf as r,pt as s,oFe as t,fW as u,le as v,lFe as w,yRe as x,Vt as y,wRe as z};
//# sourceMappingURL=vendor.ceb94e99.js.map
